[True]
Run timestamp: 09102023_204915_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6573; val_auprc_score: 0.6375; val_best_acc_score: 0.5161; val_best_f1_score: 0.6727; train_kl_reg_loss: 53920.4817; train_edge_recon_loss: 3512122.3106; train_gene_expr_recon_loss: 14062803.2121; train_masked_gp_l1_reg_loss: 130100.3023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4665652.6705; train_chrom_access_recon_loss: 2335543.5057; train_global_loss: 24760142.4848; train_optim_loss: 24760142.4848; val_kl_reg_loss: 95701.7646; val_edge_recon_loss: 4064628.7188; val_gene_expr_recon_loss: 12904717.5000; val_masked_gp_l1_reg_loss: 103707.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2268365.2500; val_chrom_access_recon_loss: 2200485.6875; val_global_loss: 21637607.2500; val_optim_loss: 21637607.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6808; val_auprc_score: 0.6672; val_best_acc_score: 0.5965; val_best_f1_score: 0.6995; train_kl_reg_loss: 98422.5561; train_edge_recon_loss: 3520869.6970; train_gene_expr_recon_loss: 12821789.9848; train_masked_gp_l1_reg_loss: 98371.1027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1092358.9271; train_chrom_access_recon_loss: 2210810.3485; train_global_loss: 19842622.6061; train_optim_loss: 19842622.6061; val_kl_reg_loss: 82840.0332; val_edge_recon_loss: 4059682.2812; val_gene_expr_recon_loss: 12754161.1250; val_masked_gp_l1_reg_loss: 96995.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 448749.6562; val_chrom_access_recon_loss: 2226478.2812; val_global_loss: 19668907.2500; val_optim_loss: 19668907.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7431; val_auprc_score: 0.7282; val_best_acc_score: 0.6771; val_best_f1_score: 0.6963; train_kl_reg_loss: 87715.5204; train_edge_recon_loss: 3514885.8447; train_gene_expr_recon_loss: 12674783.9848; train_masked_gp_l1_reg_loss: 97304.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 289765.6593; train_chrom_access_recon_loss: 2194889.2273; train_global_loss: 18859344.6061; train_optim_loss: 18859344.6061; val_kl_reg_loss: 79678.0186; val_edge_recon_loss: 4028290.1562; val_gene_expr_recon_loss: 12678541.7500; val_masked_gp_l1_reg_loss: 98077.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193374.3594; val_chrom_access_recon_loss: 2200781.0625; val_global_loss: 19278743.0000; val_optim_loss: 19278743.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8214; val_auprc_score: 0.8056; val_best_acc_score: 0.7458; val_best_f1_score: 0.7596; train_kl_reg_loss: 75118.4866; train_edge_recon_loss: 3486245.3939; train_gene_expr_recon_loss: 12604504.8333; train_masked_gp_l1_reg_loss: 99705.0616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154688.4901; train_chrom_access_recon_loss: 2184215.8826; train_global_loss: 18604478.1515; train_optim_loss: 18604478.1515; val_kl_reg_loss: 66895.0142; val_edge_recon_loss: 3712656.8125; val_gene_expr_recon_loss: 12566728.1250; val_masked_gp_l1_reg_loss: 101928.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127410.7344; val_chrom_access_recon_loss: 2187776.0781; val_global_loss: 18763396.0000; val_optim_loss: 18763396.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8396; val_auprc_score: 0.8085; val_best_acc_score: 0.7566; val_best_f1_score: 0.7869; train_kl_reg_loss: 84410.4471; train_edge_recon_loss: 3113039.2311; train_gene_expr_recon_loss: 12541506.0455; train_masked_gp_l1_reg_loss: 107451.9983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114443.6071; train_chrom_access_recon_loss: 2172282.9356; train_global_loss: 18133134.2121; train_optim_loss: 18133134.2121; val_kl_reg_loss: 107852.3652; val_edge_recon_loss: 3013092.0312; val_gene_expr_recon_loss: 12385712.3750; val_masked_gp_l1_reg_loss: 111475.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104510.9609; val_chrom_access_recon_loss: 2160028.6562; val_global_loss: 17882671.7500; val_optim_loss: 17882671.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8615; val_auprc_score: 0.8180; val_best_acc_score: 0.7891; val_best_f1_score: 0.8123; train_kl_reg_loss: 103284.9013; train_edge_recon_loss: 2919174.8902; train_gene_expr_recon_loss: 12449118.7424; train_masked_gp_l1_reg_loss: 112749.8710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99964.8305; train_chrom_access_recon_loss: 2158124.8314; train_global_loss: 17842417.9091; train_optim_loss: 17842417.9091; val_kl_reg_loss: 98271.3408; val_edge_recon_loss: 2918359.5000; val_gene_expr_recon_loss: 12552838.0000; val_masked_gp_l1_reg_loss: 113871.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96234.1016; val_chrom_access_recon_loss: 2176815.7656; val_global_loss: 17956389.7500; val_optim_loss: 17956389.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8731; val_auprc_score: 0.8391; val_best_acc_score: 0.8055; val_best_f1_score: 0.8238; train_kl_reg_loss: 103289.5500; train_edge_recon_loss: 2883738.0985; train_gene_expr_recon_loss: 12379315.9091; train_masked_gp_l1_reg_loss: 115497.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91357.2266; train_chrom_access_recon_loss: 2147077.7330; train_global_loss: 17720275.9394; train_optim_loss: 17720275.9394; val_kl_reg_loss: 108711.9961; val_edge_recon_loss: 2888897.4062; val_gene_expr_recon_loss: 12425359.5000; val_masked_gp_l1_reg_loss: 117102.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87426.9766; val_chrom_access_recon_loss: 2156020.4375; val_global_loss: 17783519.2500; val_optim_loss: 17783519.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8774; val_auprc_score: 0.8393; val_best_acc_score: 0.8130; val_best_f1_score: 0.8311; train_kl_reg_loss: 106112.9179; train_edge_recon_loss: 2844952.2424; train_gene_expr_recon_loss: 12317327.9394; train_masked_gp_l1_reg_loss: 118348.5225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85092.0021; train_chrom_access_recon_loss: 2134001.6742; train_global_loss: 17605835.2424; train_optim_loss: 17605835.2424; val_kl_reg_loss: 110409.5264; val_edge_recon_loss: 2904111.0625; val_gene_expr_recon_loss: 12346305.1250; val_masked_gp_l1_reg_loss: 119722.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83336.2422; val_chrom_access_recon_loss: 2135438.3125; val_global_loss: 17699321.7500; val_optim_loss: 17699321.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8865; val_auprc_score: 0.8456; val_best_acc_score: 0.8289; val_best_f1_score: 0.8422; train_kl_reg_loss: 104713.9502; train_edge_recon_loss: 2830769.6553; train_gene_expr_recon_loss: 12262524.7424; train_masked_gp_l1_reg_loss: 120603.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82541.4983; train_chrom_access_recon_loss: 2127474.7500; train_global_loss: 17528627.5152; train_optim_loss: 17528627.5152; val_kl_reg_loss: 102793.4082; val_edge_recon_loss: 2858067.8125; val_gene_expr_recon_loss: 12377486.1250; val_masked_gp_l1_reg_loss: 121666.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82263.5547; val_chrom_access_recon_loss: 2138581.3125; val_global_loss: 17680859.5000; val_optim_loss: 17680859.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8945; val_auprc_score: 0.8586; val_best_acc_score: 0.8356; val_best_f1_score: 0.8519; train_kl_reg_loss: 102144.2795; train_edge_recon_loss: 2814223.0682; train_gene_expr_recon_loss: 12211172.2879; train_masked_gp_l1_reg_loss: 122818.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83387.8954; train_chrom_access_recon_loss: 2116939.9242; train_global_loss: 17450685.8788; train_optim_loss: 17450685.8788; val_kl_reg_loss: 101250.2549; val_edge_recon_loss: 2830476.4062; val_gene_expr_recon_loss: 12320760.3750; val_masked_gp_l1_reg_loss: 123701.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84235.5312; val_chrom_access_recon_loss: 2158514.2344; val_global_loss: 17618938.2500; val_optim_loss: 17618938.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8981; val_auprc_score: 0.8658; val_best_acc_score: 0.8310; val_best_f1_score: 0.8441; train_kl_reg_loss: 102748.6495; train_edge_recon_loss: 2802517.3295; train_gene_expr_recon_loss: 12148304.7273; train_masked_gp_l1_reg_loss: 124667.1647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83551.1778; train_chrom_access_recon_loss: 2111254.4943; train_global_loss: 17373043.6364; train_optim_loss: 17373043.6364; val_kl_reg_loss: 104021.4238; val_edge_recon_loss: 2835711.7500; val_gene_expr_recon_loss: 12181993.3750; val_masked_gp_l1_reg_loss: 125342.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83565.7031; val_chrom_access_recon_loss: 2101572.2812; val_global_loss: 17432207.5000; val_optim_loss: 17432207.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8969; val_auprc_score: 0.8652; val_best_acc_score: 0.8350; val_best_f1_score: 0.8501; train_kl_reg_loss: 100002.2087; train_edge_recon_loss: 2796926.0076; train_gene_expr_recon_loss: 12108695.9091; train_masked_gp_l1_reg_loss: 125921.5208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82402.3494; train_chrom_access_recon_loss: 2104839.8902; train_global_loss: 17318787.7576; train_optim_loss: 17318787.7576; val_kl_reg_loss: 98310.1104; val_edge_recon_loss: 2875036.4688; val_gene_expr_recon_loss: 12053832.2500; val_masked_gp_l1_reg_loss: 126632.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81327.4922; val_chrom_access_recon_loss: 2101506.5312; val_global_loss: 17336645.6250; val_optim_loss: 17336645.6250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9066; val_auprc_score: 0.8766; val_best_acc_score: 0.8439; val_best_f1_score: 0.8580; train_kl_reg_loss: 95393.1036; train_edge_recon_loss: 2826924.9811; train_gene_expr_recon_loss: 12126399.0303; train_masked_gp_l1_reg_loss: 130998.8040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82873.2247; train_chrom_access_recon_loss: 2100936.2311; train_global_loss: 17363525.2879; train_optim_loss: 17363525.2879; val_kl_reg_loss: 96385.7480; val_edge_recon_loss: 2843971.0312; val_gene_expr_recon_loss: 12228966.8750; val_masked_gp_l1_reg_loss: 135430.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84297.1797; val_chrom_access_recon_loss: 2106878.7500; val_global_loss: 17495930.5000; val_optim_loss: 17495930.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9026; val_auprc_score: 0.8610; val_best_acc_score: 0.8466; val_best_f1_score: 0.8581; train_kl_reg_loss: 96366.3767; train_edge_recon_loss: 2794480.4735; train_gene_expr_recon_loss: 12070085.4848; train_masked_gp_l1_reg_loss: 135053.7502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81767.5309; train_chrom_access_recon_loss: 2093350.6856; train_global_loss: 17271104.1515; train_optim_loss: 17271104.1515; val_kl_reg_loss: 98810.4023; val_edge_recon_loss: 2824688.5312; val_gene_expr_recon_loss: 12049172.6250; val_masked_gp_l1_reg_loss: 135163.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80255.5234; val_chrom_access_recon_loss: 2086728.2031; val_global_loss: 17274819.7500; val_optim_loss: 17274819.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9162; val_auprc_score: 0.8871; val_best_acc_score: 0.8552; val_best_f1_score: 0.8660; train_kl_reg_loss: 97270.6411; train_edge_recon_loss: 2778913.2803; train_gene_expr_recon_loss: 12035065.4242; train_masked_gp_l1_reg_loss: 135011.4041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79545.5043; train_chrom_access_recon_loss: 2084183.6477; train_global_loss: 17209989.8182; train_optim_loss: 17209989.8182; val_kl_reg_loss: 97241.5566; val_edge_recon_loss: 2798574.5938; val_gene_expr_recon_loss: 12002572.5000; val_masked_gp_l1_reg_loss: 135717.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79038.6953; val_chrom_access_recon_loss: 2090784.4062; val_global_loss: 17203929.7500; val_optim_loss: 17203929.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9139; val_auprc_score: 0.8820; val_best_acc_score: 0.8555; val_best_f1_score: 0.8650; train_kl_reg_loss: 95413.1599; train_edge_recon_loss: 2771476.0379; train_gene_expr_recon_loss: 12006855.3030; train_masked_gp_l1_reg_loss: 135546.1056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78729.9229; train_chrom_access_recon_loss: 2081080.1723; train_global_loss: 17169100.6364; train_optim_loss: 17169100.6364; val_kl_reg_loss: 93647.8623; val_edge_recon_loss: 2838704.5312; val_gene_expr_recon_loss: 12029452.8750; val_masked_gp_l1_reg_loss: 135854.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78171.9062; val_chrom_access_recon_loss: 2089898.9375; val_global_loss: 17265731.0000; val_optim_loss: 17265731.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9201; val_auprc_score: 0.8896; val_best_acc_score: 0.8563; val_best_f1_score: 0.8677; train_kl_reg_loss: 95027.9755; train_edge_recon_loss: 2749124.8788; train_gene_expr_recon_loss: 11964892.5758; train_masked_gp_l1_reg_loss: 135879.0083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77814.0589; train_chrom_access_recon_loss: 2074796.6837; train_global_loss: 17097535.0455; train_optim_loss: 17097535.0455; val_kl_reg_loss: 96271.0654; val_edge_recon_loss: 2802014.0312; val_gene_expr_recon_loss: 11895595.1250; val_masked_gp_l1_reg_loss: 136014.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77222.6406; val_chrom_access_recon_loss: 2068502.3906; val_global_loss: 17075619.3750; val_optim_loss: 17075619.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9193; val_auprc_score: 0.8891; val_best_acc_score: 0.8589; val_best_f1_score: 0.8697; train_kl_reg_loss: 94409.1989; train_edge_recon_loss: 2762628.8371; train_gene_expr_recon_loss: 11946929.8182; train_masked_gp_l1_reg_loss: 136091.1366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77381.0678; train_chrom_access_recon_loss: 2070840.3883; train_global_loss: 17088280.4545; train_optim_loss: 17088280.4545; val_kl_reg_loss: 91221.9629; val_edge_recon_loss: 2795242.8125; val_gene_expr_recon_loss: 11934619.5000; val_masked_gp_l1_reg_loss: 136448.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78475.8828; val_chrom_access_recon_loss: 2061889.4375; val_global_loss: 17097898.6250; val_optim_loss: 17097898.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9245; val_auprc_score: 0.8990; val_best_acc_score: 0.8638; val_best_f1_score: 0.8729; train_kl_reg_loss: 95204.6107; train_edge_recon_loss: 2752536.5341; train_gene_expr_recon_loss: 11910871.1212; train_masked_gp_l1_reg_loss: 136062.6546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77615.4336; train_chrom_access_recon_loss: 2064468.1723; train_global_loss: 17036758.3788; train_optim_loss: 17036758.3788; val_kl_reg_loss: 97236.6709; val_edge_recon_loss: 2750586.9062; val_gene_expr_recon_loss: 11913762.2500; val_masked_gp_l1_reg_loss: 136342.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77479.5391; val_chrom_access_recon_loss: 2061160.2500; val_global_loss: 17036567.8750; val_optim_loss: 17036567.8750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9291; val_auprc_score: 0.9012; val_best_acc_score: 0.8751; val_best_f1_score: 0.8829; train_kl_reg_loss: 95911.8509; train_edge_recon_loss: 2752120.2386; train_gene_expr_recon_loss: 11870741.4091; train_masked_gp_l1_reg_loss: 136092.9422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77479.9289; train_chrom_access_recon_loss: 2057954.6799; train_global_loss: 16990300.8788; train_optim_loss: 16990300.8788; val_kl_reg_loss: 98546.4443; val_edge_recon_loss: 2753363.3750; val_gene_expr_recon_loss: 11913197.5000; val_masked_gp_l1_reg_loss: 135850.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77515.7734; val_chrom_access_recon_loss: 2077247.7812; val_global_loss: 17055721.3750; val_optim_loss: 17055721.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9335; val_auprc_score: 0.9081; val_best_acc_score: 0.8740; val_best_f1_score: 0.8827; train_kl_reg_loss: 94983.1808; train_edge_recon_loss: 2750313.8409; train_gene_expr_recon_loss: 11842323.1515; train_masked_gp_l1_reg_loss: 135446.8151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77545.0195; train_chrom_access_recon_loss: 2054447.5473; train_global_loss: 16955059.5606; train_optim_loss: 16955059.5606; val_kl_reg_loss: 94108.4980; val_edge_recon_loss: 2748687.8125; val_gene_expr_recon_loss: 11830931.5000; val_masked_gp_l1_reg_loss: 135191.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77981.0859; val_chrom_access_recon_loss: 2068768.8750; val_global_loss: 16955669.6250; val_optim_loss: 16955669.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9398; val_auprc_score: 0.9140; val_best_acc_score: 0.8818; val_best_f1_score: 0.8884; train_kl_reg_loss: 92353.5017; train_edge_recon_loss: 2751456.4735; train_gene_expr_recon_loss: 11822466.4848; train_masked_gp_l1_reg_loss: 135059.7436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78340.3415; train_chrom_access_recon_loss: 2050816.4489; train_global_loss: 16930493.0152; train_optim_loss: 16930493.0152; val_kl_reg_loss: 89816.5391; val_edge_recon_loss: 2753706.8750; val_gene_expr_recon_loss: 11871973.8750; val_masked_gp_l1_reg_loss: 134948.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78560.0156; val_chrom_access_recon_loss: 2051285.5469; val_global_loss: 16980291.8750; val_optim_loss: 16980291.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9310; val_auprc_score: 0.9033; val_best_acc_score: 0.8767; val_best_f1_score: 0.8845; train_kl_reg_loss: 92684.2296; train_edge_recon_loss: 2742398.8561; train_gene_expr_recon_loss: 11779682.6970; train_masked_gp_l1_reg_loss: 135007.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78562.5589; train_chrom_access_recon_loss: 2046858.2955; train_global_loss: 16875194.1667; train_optim_loss: 16875194.1667; val_kl_reg_loss: 97100.8828; val_edge_recon_loss: 2773010.1250; val_gene_expr_recon_loss: 11809492.2500; val_masked_gp_l1_reg_loss: 134878.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78948.9297; val_chrom_access_recon_loss: 2055222.2812; val_global_loss: 16948653.3750; val_optim_loss: 16948653.3750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9379; val_auprc_score: 0.9162; val_best_acc_score: 0.8812; val_best_f1_score: 0.8878; train_kl_reg_loss: 94034.8794; train_edge_recon_loss: 2739339.4015; train_gene_expr_recon_loss: 11758530.9697; train_masked_gp_l1_reg_loss: 134537.4214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78906.6500; train_chrom_access_recon_loss: 2041330.6080; train_global_loss: 16846680.0152; train_optim_loss: 16846680.0152; val_kl_reg_loss: 93382.5508; val_edge_recon_loss: 2767150.1562; val_gene_expr_recon_loss: 11751114.0000; val_masked_gp_l1_reg_loss: 134423.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78651.5938; val_chrom_access_recon_loss: 2031528.9375; val_global_loss: 16856251.3750; val_optim_loss: 16856251.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9348; val_auprc_score: 0.9097; val_best_acc_score: 0.8769; val_best_f1_score: 0.8849; train_kl_reg_loss: 93153.1383; train_edge_recon_loss: 2726549.1364; train_gene_expr_recon_loss: 11742197.2879; train_masked_gp_l1_reg_loss: 134098.7661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78735.4377; train_chrom_access_recon_loss: 2037807.7064; train_global_loss: 16812541.5152; train_optim_loss: 16812541.5152; val_kl_reg_loss: 93829.3604; val_edge_recon_loss: 2758797.0312; val_gene_expr_recon_loss: 11789502.3750; val_masked_gp_l1_reg_loss: 134229.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78708.4141; val_chrom_access_recon_loss: 2048339.9531; val_global_loss: 16903406.3750; val_optim_loss: 16903406.3750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9308; val_auprc_score: 0.9026; val_best_acc_score: 0.8694; val_best_f1_score: 0.8796; train_kl_reg_loss: 117417.1000; train_edge_recon_loss: 2821098.5000; train_gene_expr_recon_loss: 11033173.5303; train_masked_gp_l1_reg_loss: 134079.6397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74365.9711; train_chrom_access_recon_loss: 1953739.8636; train_global_loss: 16133874.7121; train_optim_loss: 16133874.7121; val_kl_reg_loss: 44535.1587; val_edge_recon_loss: 2834512.7812; val_gene_expr_recon_loss: 10899520.0000; val_masked_gp_l1_reg_loss: 134129.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73932.8125; val_chrom_access_recon_loss: 1922107.8281; val_global_loss: 15908738.8750; val_optim_loss: 15908738.8750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9422; val_auprc_score: 0.9156; val_best_acc_score: 0.8898; val_best_f1_score: 0.8946; train_kl_reg_loss: 100405.6404; train_edge_recon_loss: 2763703.7159; train_gene_expr_recon_loss: 10940364.8939; train_masked_gp_l1_reg_loss: 133732.4318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74578.8018; train_chrom_access_recon_loss: 1919991.2027; train_global_loss: 15932776.8636; train_optim_loss: 15932776.8636; val_kl_reg_loss: 53125.2173; val_edge_recon_loss: 2740122.5625; val_gene_expr_recon_loss: 10974461.0000; val_masked_gp_l1_reg_loss: 133220.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75184.5078; val_chrom_access_recon_loss: 1929768.4531; val_global_loss: 15905883.2500; val_optim_loss: 15905883.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9393; val_auprc_score: 0.9160; val_best_acc_score: 0.8853; val_best_f1_score: 0.8920; train_kl_reg_loss: 89155.8709; train_edge_recon_loss: 2736176.7955; train_gene_expr_recon_loss: 10916144.1515; train_masked_gp_l1_reg_loss: 132170.4354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74696.7778; train_chrom_access_recon_loss: 1915489.6496; train_global_loss: 15863833.5455; train_optim_loss: 15863833.5455; val_kl_reg_loss: 59471.5229; val_edge_recon_loss: 2764877.6875; val_gene_expr_recon_loss: 10991208.2500; val_masked_gp_l1_reg_loss: 131448.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75318.2500; val_chrom_access_recon_loss: 1917981.4219; val_global_loss: 15940305.0000; val_optim_loss: 15940305.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9477; val_auprc_score: 0.9254; val_best_acc_score: 0.8923; val_best_f1_score: 0.8957; train_kl_reg_loss: 83081.1495; train_edge_recon_loss: 2741203.3295; train_gene_expr_recon_loss: 10896049.0303; train_masked_gp_l1_reg_loss: 130270.7241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74854.6519; train_chrom_access_recon_loss: 1911917.8144; train_global_loss: 15837376.7727; train_optim_loss: 15837376.7727; val_kl_reg_loss: 62834.0376; val_edge_recon_loss: 2745580.7500; val_gene_expr_recon_loss: 10871764.6250; val_masked_gp_l1_reg_loss: 129297.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74511.2344; val_chrom_access_recon_loss: 1918722.0469; val_global_loss: 15802709.2500; val_optim_loss: 15802709.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9420; val_auprc_score: 0.9203; val_best_acc_score: 0.8896; val_best_f1_score: 0.8959; train_kl_reg_loss: 78521.6835; train_edge_recon_loss: 2739047.3674; train_gene_expr_recon_loss: 10872840.6212; train_masked_gp_l1_reg_loss: 128157.2978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74696.8232; train_chrom_access_recon_loss: 1907485.5246; train_global_loss: 15800749.2576; train_optim_loss: 15800749.2576; val_kl_reg_loss: 63635.1050; val_edge_recon_loss: 2752385.5938; val_gene_expr_recon_loss: 10940831.8750; val_masked_gp_l1_reg_loss: 127253.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74723.2656; val_chrom_access_recon_loss: 1923110.2812; val_global_loss: 15881940.0000; val_optim_loss: 15881940.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9417; val_auprc_score: 0.9174; val_best_acc_score: 0.8842; val_best_f1_score: 0.8894; train_kl_reg_loss: 78466.6976; train_edge_recon_loss: 2720505.3902; train_gene_expr_recon_loss: 10863136.2879; train_masked_gp_l1_reg_loss: 126352.5584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74568.1045; train_chrom_access_recon_loss: 1905607.0000; train_global_loss: 15768636.0000; train_optim_loss: 15768636.0000; val_kl_reg_loss: 66599.0234; val_edge_recon_loss: 2778836.5000; val_gene_expr_recon_loss: 10833098.3750; val_masked_gp_l1_reg_loss: 125546.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74380.8359; val_chrom_access_recon_loss: 1916052.4375; val_global_loss: 15794514.5000; val_optim_loss: 15794514.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9419; val_auprc_score: 0.9185; val_best_acc_score: 0.8818; val_best_f1_score: 0.8902; train_kl_reg_loss: 76846.2956; train_edge_recon_loss: 2725356.6098; train_gene_expr_recon_loss: 10846598.6970; train_masked_gp_l1_reg_loss: 124863.4928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74360.6412; train_chrom_access_recon_loss: 1902316.4148; train_global_loss: 15750342.2121; train_optim_loss: 15750342.2121; val_kl_reg_loss: 65976.7539; val_edge_recon_loss: 2769718.0938; val_gene_expr_recon_loss: 10925935.6250; val_masked_gp_l1_reg_loss: 124348.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74386.8672; val_chrom_access_recon_loss: 1913690.4062; val_global_loss: 15874056.5000; val_optim_loss: 15874056.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9429; val_auprc_score: 0.9144; val_best_acc_score: 0.8861; val_best_f1_score: 0.8927; train_kl_reg_loss: 76375.7467; train_edge_recon_loss: 2710739.6667; train_gene_expr_recon_loss: 10826588.5000; train_masked_gp_l1_reg_loss: 123704.2454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74284.5952; train_chrom_access_recon_loss: 1898364.3125; train_global_loss: 15710056.9545; train_optim_loss: 15710056.9545; val_kl_reg_loss: 68281.2930; val_edge_recon_loss: 2757516.5312; val_gene_expr_recon_loss: 10867357.3750; val_masked_gp_l1_reg_loss: 122979.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73994.8672; val_chrom_access_recon_loss: 1900043.0938; val_global_loss: 15790173.0000; val_optim_loss: 15790173.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9554; val_auprc_score: 0.9363; val_best_acc_score: 0.9046; val_best_f1_score: 0.9087; train_kl_reg_loss: 77495.8018; train_edge_recon_loss: 2709341.5530; train_gene_expr_recon_loss: 10815055.5303; train_masked_gp_l1_reg_loss: 122491.7987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73996.5553; train_chrom_access_recon_loss: 1894722.1610; train_global_loss: 15693103.4697; train_optim_loss: 15693103.4697; val_kl_reg_loss: 70414.1660; val_edge_recon_loss: 2722175.2500; val_gene_expr_recon_loss: 10809848.6250; val_masked_gp_l1_reg_loss: 121965.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73875.3984; val_chrom_access_recon_loss: 1901425.2969; val_global_loss: 15699704.5000; val_optim_loss: 15699704.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9491; val_auprc_score: 0.9240; val_best_acc_score: 0.9006; val_best_f1_score: 0.9045; train_kl_reg_loss: 76630.2565; train_edge_recon_loss: 2705057.2689; train_gene_expr_recon_loss: 10791359.8333; train_masked_gp_l1_reg_loss: 121437.6925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74142.9349; train_chrom_access_recon_loss: 1891904.6080; train_global_loss: 15660532.5909; train_optim_loss: 15660532.5909; val_kl_reg_loss: 69595.5469; val_edge_recon_loss: 2727649.4688; val_gene_expr_recon_loss: 10844220.1250; val_masked_gp_l1_reg_loss: 120957.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73697.2031; val_chrom_access_recon_loss: 1900428.2031; val_global_loss: 15736547.6250; val_optim_loss: 15736547.6250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9561; val_auprc_score: 0.9367; val_best_acc_score: 0.9030; val_best_f1_score: 0.9078; train_kl_reg_loss: 77351.8485; train_edge_recon_loss: 2712273.3674; train_gene_expr_recon_loss: 10788656.4242; train_masked_gp_l1_reg_loss: 120361.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73719.1579; train_chrom_access_recon_loss: 1889361.6648; train_global_loss: 15661723.4242; train_optim_loss: 15661723.4242; val_kl_reg_loss: 71010.5234; val_edge_recon_loss: 2703035.4375; val_gene_expr_recon_loss: 10911985.1250; val_masked_gp_l1_reg_loss: 119791.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73707.7188; val_chrom_access_recon_loss: 1906902.6094; val_global_loss: 15786433.7500; val_optim_loss: 15786433.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9539; val_auprc_score: 0.9334; val_best_acc_score: 0.8968; val_best_f1_score: 0.9023; train_kl_reg_loss: 75611.9254; train_edge_recon_loss: 2713683.5720; train_gene_expr_recon_loss: 10783226.9394; train_masked_gp_l1_reg_loss: 119422.5949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73579.5623; train_chrom_access_recon_loss: 1889322.7614; train_global_loss: 15654847.1818; train_optim_loss: 15654847.1818; val_kl_reg_loss: 68973.2080; val_edge_recon_loss: 2725589.4062; val_gene_expr_recon_loss: 10882063.3750; val_masked_gp_l1_reg_loss: 119237.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73736.7109; val_chrom_access_recon_loss: 1902451.9062; val_global_loss: 15772053.1250; val_optim_loss: 15772053.1250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9490; val_auprc_score: 0.9297; val_best_acc_score: 0.8941; val_best_f1_score: 0.8997; train_kl_reg_loss: 75664.5790; train_edge_recon_loss: 2704913.2008; train_gene_expr_recon_loss: 10744639.0455; train_masked_gp_l1_reg_loss: 118843.4960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73511.7411; train_chrom_access_recon_loss: 1883177.2140; train_global_loss: 15600749.2424; train_optim_loss: 15600749.2424; val_kl_reg_loss: 70966.0322; val_edge_recon_loss: 2750321.0938; val_gene_expr_recon_loss: 10862019.1250; val_masked_gp_l1_reg_loss: 118626.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73485.6406; val_chrom_access_recon_loss: 1913528.8594; val_global_loss: 15788948.1250; val_optim_loss: 15788948.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9572; val_auprc_score: 0.9410; val_best_acc_score: 0.9044; val_best_f1_score: 0.9092; train_kl_reg_loss: 76382.9614; train_edge_recon_loss: 2703330.1477; train_gene_expr_recon_loss: 10731174.9394; train_masked_gp_l1_reg_loss: 115679.2148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60694.8096; train_chrom_access_recon_loss: 1880771.2576; train_global_loss: 15568033.3485; train_optim_loss: 15568033.3485; val_kl_reg_loss: 71813.1455; val_edge_recon_loss: 2697071.5938; val_gene_expr_recon_loss: 10808505.7500; val_masked_gp_l1_reg_loss: 114752.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58030.4648; val_chrom_access_recon_loss: 1891992.1562; val_global_loss: 15642165.5000; val_optim_loss: 15642165.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9496; val_auprc_score: 0.9298; val_best_acc_score: 0.8971; val_best_f1_score: 0.9013; train_kl_reg_loss: 77046.3925; train_edge_recon_loss: 2700891.5227; train_gene_expr_recon_loss: 10723743.9091; train_masked_gp_l1_reg_loss: 114598.4982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57727.8630; train_chrom_access_recon_loss: 1876526.3428; train_global_loss: 15550534.5606; train_optim_loss: 15550534.5606; val_kl_reg_loss: 71641.8584; val_edge_recon_loss: 2742865.7500; val_gene_expr_recon_loss: 10665233.5000; val_masked_gp_l1_reg_loss: 114499.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57471.5078; val_chrom_access_recon_loss: 1867920.5469; val_global_loss: 15519632.8750; val_optim_loss: 15519632.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9530; val_auprc_score: 0.9342; val_best_acc_score: 0.9027; val_best_f1_score: 0.9074; train_kl_reg_loss: 77736.8213; train_edge_recon_loss: 2694291.0682; train_gene_expr_recon_loss: 10722856.3485; train_masked_gp_l1_reg_loss: 114396.4744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57332.3057; train_chrom_access_recon_loss: 1877328.7500; train_global_loss: 15543941.8182; train_optim_loss: 15543941.8182; val_kl_reg_loss: 72577.4209; val_edge_recon_loss: 2740118.8438; val_gene_expr_recon_loss: 10779456.7500; val_masked_gp_l1_reg_loss: 114328.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57154.3672; val_chrom_access_recon_loss: 1889681.0625; val_global_loss: 15653317.0000; val_optim_loss: 15653317.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9462; val_auprc_score: 0.9255; val_best_acc_score: 0.8933; val_best_f1_score: 0.9004; train_kl_reg_loss: 78226.4892; train_edge_recon_loss: 2702315.9129; train_gene_expr_recon_loss: 10727015.7273; train_masked_gp_l1_reg_loss: 114255.2396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57095.0189; train_chrom_access_recon_loss: 1879376.4735; train_global_loss: 15558284.8030; train_optim_loss: 15558284.8030; val_kl_reg_loss: 73086.0010; val_edge_recon_loss: 2757703.8125; val_gene_expr_recon_loss: 10841744.5000; val_masked_gp_l1_reg_loss: 114203.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56956.8008; val_chrom_access_recon_loss: 1894300.5469; val_global_loss: 15737996.0000; val_optim_loss: 15737996.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9471; val_auprc_score: 0.9277; val_best_acc_score: 0.8958; val_best_f1_score: 0.9016; train_kl_reg_loss: 78177.5392; train_edge_recon_loss: 2699645.5795; train_gene_expr_recon_loss: 10708840.5303; train_masked_gp_l1_reg_loss: 114145.8246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56862.8219; train_chrom_access_recon_loss: 1875776.0682; train_global_loss: 15533448.2576; train_optim_loss: 15533448.2576; val_kl_reg_loss: 72677.9434; val_edge_recon_loss: 2741737.0312; val_gene_expr_recon_loss: 10735579.3750; val_masked_gp_l1_reg_loss: 114094.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56789.9570; val_chrom_access_recon_loss: 1881949.5781; val_global_loss: 15602828.7500; val_optim_loss: 15602828.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9523; val_auprc_score: 0.9308; val_best_acc_score: 0.8979; val_best_f1_score: 0.9045; train_kl_reg_loss: 78501.9141; train_edge_recon_loss: 2692989.2765; train_gene_expr_recon_loss: 10718531.3182; train_masked_gp_l1_reg_loss: 114027.7912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56671.0527; train_chrom_access_recon_loss: 1874540.4924; train_global_loss: 15535261.8485; train_optim_loss: 15535261.8485; val_kl_reg_loss: 73127.5020; val_edge_recon_loss: 2726762.0625; val_gene_expr_recon_loss: 10793443.3750; val_masked_gp_l1_reg_loss: 113984.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56599.9297; val_chrom_access_recon_loss: 1891729.2812; val_global_loss: 15655647.1250; val_optim_loss: 15655647.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9545; val_auprc_score: 0.9342; val_best_acc_score: 0.9041; val_best_f1_score: 0.9088; train_kl_reg_loss: 78777.8823; train_edge_recon_loss: 2693033.3561; train_gene_expr_recon_loss: 10711343.2273; train_masked_gp_l1_reg_loss: 113686.4988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55265.4511; train_chrom_access_recon_loss: 1874799.0606; train_global_loss: 15526905.4697; train_optim_loss: 15526905.4697; val_kl_reg_loss: 72925.7646; val_edge_recon_loss: 2729477.9688; val_gene_expr_recon_loss: 10783784.1250; val_masked_gp_l1_reg_loss: 113581.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54998.0938; val_chrom_access_recon_loss: 1889783.5000; val_global_loss: 15644551.2500; val_optim_loss: 15644551.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9542; val_auprc_score: 0.9356; val_best_acc_score: 0.9025; val_best_f1_score: 0.9076; train_kl_reg_loss: 78549.1006; train_edge_recon_loss: 2701981.4621; train_gene_expr_recon_loss: 10717086.4545; train_masked_gp_l1_reg_loss: 113554.5365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54966.3867; train_chrom_access_recon_loss: 1876165.9602; train_global_loss: 15542303.8636; train_optim_loss: 15542303.8636; val_kl_reg_loss: 73226.4941; val_edge_recon_loss: 2704866.5625; val_gene_expr_recon_loss: 10725034.8750; val_masked_gp_l1_reg_loss: 113529.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54939.6875; val_chrom_access_recon_loss: 1884742.4844; val_global_loss: 15556340.3750; val_optim_loss: 15556340.3750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9447; val_auprc_score: 0.9119; val_best_acc_score: 0.8928; val_best_f1_score: 0.9007; train_kl_reg_loss: 78565.2463; train_edge_recon_loss: 2685877.8636; train_gene_expr_recon_loss: 10721976.9697; train_masked_gp_l1_reg_loss: 113515.9400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54913.1071; train_chrom_access_recon_loss: 1877139.3144; train_global_loss: 15531988.3636; train_optim_loss: 15531988.3636; val_kl_reg_loss: 73250.5371; val_edge_recon_loss: 2742733.4375; val_gene_expr_recon_loss: 10785429.7500; val_masked_gp_l1_reg_loss: 113503.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54887.4062; val_chrom_access_recon_loss: 1883893.6250; val_global_loss: 15653698.2500; val_optim_loss: 15653698.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9519; val_auprc_score: 0.9307; val_best_acc_score: 0.8995; val_best_f1_score: 0.9043; train_kl_reg_loss: 78628.7185; train_edge_recon_loss: 2693934.1515; train_gene_expr_recon_loss: 10712884.0606; train_masked_gp_l1_reg_loss: 113495.2888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54876.3967; train_chrom_access_recon_loss: 1875361.2027; train_global_loss: 15529179.7727; train_optim_loss: 15529179.7727; val_kl_reg_loss: 72328.3496; val_edge_recon_loss: 2738510.2500; val_gene_expr_recon_loss: 10700716.7500; val_masked_gp_l1_reg_loss: 113486.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54853.1875; val_chrom_access_recon_loss: 1875833.5469; val_global_loss: 15555729.1250; val_optim_loss: 15555729.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 18 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9510
val AUPRC score: 0.9324
val best accuracy score: 0.8976
val best F1 score: 0.9034
val target rna MSE score: 1.7937
val source rna MSE score: 0.9322
val target atac MSE score: 0.3226
val source atac MSE score: 0.1349
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
