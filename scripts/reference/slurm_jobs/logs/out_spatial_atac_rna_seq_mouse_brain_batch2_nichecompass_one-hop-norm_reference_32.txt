[True]
Run timestamp: 07092023_152119_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6309; val_auprc_score: 0.6244; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 56954.6367; train_edge_recon_loss: 3558455.9091; train_gene_expr_recon_loss: 16919128.9242; train_masked_gp_l1_reg_loss: 176356.3127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9920547.2083; train_chrom_access_recon_loss: 8989737.6061; train_global_loss: 39621180.5152; train_optim_loss: 39621180.5152; val_kl_reg_loss: 114626.4668; val_edge_recon_loss: 4065385.0000; val_gene_expr_recon_loss: 15352659.0000; val_masked_gp_l1_reg_loss: 161125.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3508140.7500; val_chrom_access_recon_loss: 8612241.7500; val_global_loss: 31814178.0000; val_optim_loss: 31814178.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6404; val_auprc_score: 0.6312; val_best_acc_score: 0.5371; val_best_f1_score: 0.6794; train_kl_reg_loss: 122129.3724; train_edge_recon_loss: 3554313.6780; train_gene_expr_recon_loss: 15011984.3333; train_masked_gp_l1_reg_loss: 153263.6375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1298988.9323; train_chrom_access_recon_loss: 8551394.3030; train_global_loss: 28692074.6061; train_optim_loss: 28692074.6061; val_kl_reg_loss: 133908.1660; val_edge_recon_loss: 4063279.2812; val_gene_expr_recon_loss: 14851671.1250; val_masked_gp_l1_reg_loss: 146412.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 449985.0312; val_chrom_access_recon_loss: 8416506.6250; val_global_loss: 28061763.5000; val_optim_loss: 28061763.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6611; val_auprc_score: 0.6496; val_best_acc_score: 0.5760; val_best_f1_score: 0.6839; train_kl_reg_loss: 128077.0505; train_edge_recon_loss: 3544483.7386; train_gene_expr_recon_loss: 14675717.1667; train_masked_gp_l1_reg_loss: 145097.5232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 326784.7924; train_chrom_access_recon_loss: 8440358.0227; train_global_loss: 27260518.3030; train_optim_loss: 27260518.3030; val_kl_reg_loss: 124638.3506; val_edge_recon_loss: 4059833.7500; val_gene_expr_recon_loss: 14540550.7500; val_masked_gp_l1_reg_loss: 144931.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 254304.5000; val_chrom_access_recon_loss: 8391943.3125; val_global_loss: 27516202.2500; val_optim_loss: 27516202.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7450; val_auprc_score: 0.7247; val_best_acc_score: 0.6698; val_best_f1_score: 0.6956; train_kl_reg_loss: 120585.4517; train_edge_recon_loss: 3535055.8295; train_gene_expr_recon_loss: 14554747.8788; train_masked_gp_l1_reg_loss: 145600.8127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223153.2926; train_chrom_access_recon_loss: 8389068.8030; train_global_loss: 26968212.0606; train_optim_loss: 26968212.0606; val_kl_reg_loss: 117335.9316; val_edge_recon_loss: 4033793.4688; val_gene_expr_recon_loss: 14451350.7500; val_masked_gp_l1_reg_loss: 146551.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 198957.7969; val_chrom_access_recon_loss: 8329697.3750; val_global_loss: 27277687.2500; val_optim_loss: 27277687.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8064; val_auprc_score: 0.7766; val_best_acc_score: 0.7308; val_best_f1_score: 0.7569; train_kl_reg_loss: 110440.8983; train_edge_recon_loss: 3514633.0000; train_gene_expr_recon_loss: 14468711.0303; train_masked_gp_l1_reg_loss: 148345.7893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185356.8904; train_chrom_access_recon_loss: 8341244.9091; train_global_loss: 26768732.8485; train_optim_loss: 26768732.8485; val_kl_reg_loss: 102326.8242; val_edge_recon_loss: 3866719.7812; val_gene_expr_recon_loss: 14341398.8750; val_masked_gp_l1_reg_loss: 150982.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172972.8125; val_chrom_access_recon_loss: 8337134.6250; val_global_loss: 26971534.2500; val_optim_loss: 26971534.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8302; val_auprc_score: 0.7771; val_best_acc_score: 0.7668; val_best_f1_score: 0.7972; train_kl_reg_loss: 97712.1816; train_edge_recon_loss: 3339033.4356; train_gene_expr_recon_loss: 14406940.7121; train_masked_gp_l1_reg_loss: 155947.0964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165384.1454; train_chrom_access_recon_loss: 8281893.2879; train_global_loss: 26446910.9394; train_optim_loss: 26446910.9394; val_kl_reg_loss: 91913.5791; val_edge_recon_loss: 3272976.3438; val_gene_expr_recon_loss: 14390261.0000; val_masked_gp_l1_reg_loss: 163674.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161340.3281; val_chrom_access_recon_loss: 8251235.1250; val_global_loss: 26331400.0000; val_optim_loss: 26331400.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8285; val_auprc_score: 0.7849; val_best_acc_score: 0.7526; val_best_f1_score: 0.7867; train_kl_reg_loss: 112504.4382; train_edge_recon_loss: 3130682.0038; train_gene_expr_recon_loss: 14406627.5606; train_masked_gp_l1_reg_loss: 173288.6373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160421.8480; train_chrom_access_recon_loss: 8262192.8864; train_global_loss: 26245717.2727; train_optim_loss: 26245717.2727; val_kl_reg_loss: 122101.8135; val_edge_recon_loss: 3075287.5312; val_gene_expr_recon_loss: 14255478.1250; val_masked_gp_l1_reg_loss: 177784.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154326.5312; val_chrom_access_recon_loss: 8205599.8750; val_global_loss: 25990577.7500; val_optim_loss: 25990577.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8351; val_auprc_score: 0.7910; val_best_acc_score: 0.7534; val_best_f1_score: 0.7911; train_kl_reg_loss: 133856.1430; train_edge_recon_loss: 3000306.0303; train_gene_expr_recon_loss: 14264536.5606; train_masked_gp_l1_reg_loss: 177305.1844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148316.7230; train_chrom_access_recon_loss: 8195950.1667; train_global_loss: 25920270.5455; train_optim_loss: 25920270.5455; val_kl_reg_loss: 133208.1094; val_edge_recon_loss: 3015739.7812; val_gene_expr_recon_loss: 14078634.3750; val_masked_gp_l1_reg_loss: 177468.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143851.2031; val_chrom_access_recon_loss: 8023683.6250; val_global_loss: 25572585.7500; val_optim_loss: 25572585.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8450; val_auprc_score: 0.8090; val_best_acc_score: 0.7673; val_best_f1_score: 0.7886; train_kl_reg_loss: 137603.9040; train_edge_recon_loss: 2964069.6894; train_gene_expr_recon_loss: 14194843.5303; train_masked_gp_l1_reg_loss: 177657.2038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140934.9160; train_chrom_access_recon_loss: 8161979.1212; train_global_loss: 25777088.3333; train_optim_loss: 25777088.3333; val_kl_reg_loss: 124626.9238; val_edge_recon_loss: 3008511.5938; val_gene_expr_recon_loss: 14106013.2500; val_masked_gp_l1_reg_loss: 178259.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138431.2500; val_chrom_access_recon_loss: 8099096.7500; val_global_loss: 25654940.2500; val_optim_loss: 25654940.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8498; val_auprc_score: 0.8105; val_best_acc_score: 0.7740; val_best_f1_score: 0.7963; train_kl_reg_loss: 131068.1817; train_edge_recon_loss: 2962357.3295; train_gene_expr_recon_loss: 14148603.2879; train_masked_gp_l1_reg_loss: 178684.1844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136591.2524; train_chrom_access_recon_loss: 8130127.5076; train_global_loss: 25687431.9697; train_optim_loss: 25687431.9697; val_kl_reg_loss: 131680.4395; val_edge_recon_loss: 2975499.9375; val_gene_expr_recon_loss: 14146055.0000; val_masked_gp_l1_reg_loss: 179476.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134727.9375; val_chrom_access_recon_loss: 8112209.8750; val_global_loss: 25679649.2500; val_optim_loss: 25679649.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8609; val_auprc_score: 0.8169; val_best_acc_score: 0.7856; val_best_f1_score: 0.8104; train_kl_reg_loss: 131647.0730; train_edge_recon_loss: 2951672.5985; train_gene_expr_recon_loss: 14096281.4394; train_masked_gp_l1_reg_loss: 180039.8516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133349.1520; train_chrom_access_recon_loss: 8098399.1970; train_global_loss: 25591389.3939; train_optim_loss: 25591389.3939; val_kl_reg_loss: 128047.7617; val_edge_recon_loss: 2944107.0938; val_gene_expr_recon_loss: 13944475.1250; val_masked_gp_l1_reg_loss: 180331.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131946.2031; val_chrom_access_recon_loss: 7994406.1875; val_global_loss: 25323314.0000; val_optim_loss: 25323314.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8581; val_auprc_score: 0.8112; val_best_acc_score: 0.7929; val_best_f1_score: 0.8143; train_kl_reg_loss: 128995.9483; train_edge_recon_loss: 2930193.3636; train_gene_expr_recon_loss: 14038643.5152; train_masked_gp_l1_reg_loss: 180815.9723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131135.0282; train_chrom_access_recon_loss: 8068004.5530; train_global_loss: 25477788.4545; train_optim_loss: 25477788.4545; val_kl_reg_loss: 125678.1221; val_edge_recon_loss: 2972880.7188; val_gene_expr_recon_loss: 13919213.8750; val_masked_gp_l1_reg_loss: 181862.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130546.8750; val_chrom_access_recon_loss: 8009499.3125; val_global_loss: 25339680.5000; val_optim_loss: 25339680.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8763; val_auprc_score: 0.8396; val_best_acc_score: 0.8114; val_best_f1_score: 0.8252; train_kl_reg_loss: 128833.5514; train_edge_recon_loss: 2906466.3674; train_gene_expr_recon_loss: 13994199.3182; train_masked_gp_l1_reg_loss: 182615.0833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129579.9744; train_chrom_access_recon_loss: 8041575.6288; train_global_loss: 25383270.2121; train_optim_loss: 25383270.2121; val_kl_reg_loss: 125611.1504; val_edge_recon_loss: 2911601.9688; val_gene_expr_recon_loss: 13776528.6250; val_masked_gp_l1_reg_loss: 183103.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129176.6953; val_chrom_access_recon_loss: 7909764.9375; val_global_loss: 25035787.5000; val_optim_loss: 25035787.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8774; val_auprc_score: 0.8332; val_best_acc_score: 0.8141; val_best_f1_score: 0.8325; train_kl_reg_loss: 130315.7282; train_edge_recon_loss: 2875543.3902; train_gene_expr_recon_loss: 13947003.0152; train_masked_gp_l1_reg_loss: 183859.3321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128586.3519; train_chrom_access_recon_loss: 8016292.7576; train_global_loss: 25281600.5455; train_optim_loss: 25281600.5455; val_kl_reg_loss: 129344.4961; val_edge_recon_loss: 2883996.2188; val_gene_expr_recon_loss: 13823374.7500; val_masked_gp_l1_reg_loss: 184348.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128214.3594; val_chrom_access_recon_loss: 7913485.0625; val_global_loss: 25062762.2500; val_optim_loss: 25062762.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8896; val_auprc_score: 0.8502; val_best_acc_score: 0.8286; val_best_f1_score: 0.8424; train_kl_reg_loss: 128491.6367; train_edge_recon_loss: 2864798.2462; train_gene_expr_recon_loss: 13907714.1212; train_masked_gp_l1_reg_loss: 185165.3968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127774.9531; train_chrom_access_recon_loss: 7984244.4848; train_global_loss: 25198188.8788; train_optim_loss: 25198188.8788; val_kl_reg_loss: 126198.4014; val_edge_recon_loss: 2871781.3125; val_gene_expr_recon_loss: 13853300.0000; val_masked_gp_l1_reg_loss: 186097.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127013.1875; val_chrom_access_recon_loss: 7905015.8750; val_global_loss: 25069406.5000; val_optim_loss: 25069406.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9049; val_auprc_score: 0.8728; val_best_acc_score: 0.8420; val_best_f1_score: 0.8546; train_kl_reg_loss: 132549.5156; train_edge_recon_loss: 2857609.0606; train_gene_expr_recon_loss: 13865676.6970; train_masked_gp_l1_reg_loss: 186594.7554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126880.7718; train_chrom_access_recon_loss: 7964042.4394; train_global_loss: 25133353.3333; train_optim_loss: 25133353.3333; val_kl_reg_loss: 129573.2432; val_edge_recon_loss: 2836767.0312; val_gene_expr_recon_loss: 13925507.8750; val_masked_gp_l1_reg_loss: 187116.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127096.1016; val_chrom_access_recon_loss: 7984896.7500; val_global_loss: 25190956.7500; val_optim_loss: 25190956.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9050; val_auprc_score: 0.8761; val_best_acc_score: 0.8431; val_best_f1_score: 0.8557; train_kl_reg_loss: 131356.1436; train_edge_recon_loss: 2834134.9697; train_gene_expr_recon_loss: 13840488.1970; train_masked_gp_l1_reg_loss: 187706.3037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127015.1114; train_chrom_access_recon_loss: 7940830.3030; train_global_loss: 25061531.1818; train_optim_loss: 25061531.1818; val_kl_reg_loss: 130994.7100; val_edge_recon_loss: 2842127.0625; val_gene_expr_recon_loss: 13839259.0000; val_masked_gp_l1_reg_loss: 188544.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127220.6172; val_chrom_access_recon_loss: 8022232.6250; val_global_loss: 25150377.7500; val_optim_loss: 25150377.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9029; val_auprc_score: 0.8670; val_best_acc_score: 0.8428; val_best_f1_score: 0.8526; train_kl_reg_loss: 134082.9838; train_edge_recon_loss: 2820055.9091; train_gene_expr_recon_loss: 13800861.8333; train_masked_gp_l1_reg_loss: 183728.2519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91521.5735; train_chrom_access_recon_loss: 7915851.2955; train_global_loss: 24946102.0303; train_optim_loss: 24946102.0303; val_kl_reg_loss: 135390.2637; val_edge_recon_loss: 2852634.9688; val_gene_expr_recon_loss: 13780998.8750; val_masked_gp_l1_reg_loss: 181854.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84957.5625; val_chrom_access_recon_loss: 7830235.7500; val_global_loss: 24866072.0000; val_optim_loss: 24866072.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9006; val_auprc_score: 0.8631; val_best_acc_score: 0.8380; val_best_f1_score: 0.8492; train_kl_reg_loss: 135580.9318; train_edge_recon_loss: 2825696.8106; train_gene_expr_recon_loss: 13798771.5152; train_masked_gp_l1_reg_loss: 181530.9451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84686.8838; train_chrom_access_recon_loss: 7914694.2576; train_global_loss: 24940961.5455; train_optim_loss: 24940961.5455; val_kl_reg_loss: 134072.6230; val_edge_recon_loss: 2871973.7812; val_gene_expr_recon_loss: 13767834.8750; val_masked_gp_l1_reg_loss: 181424.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84427.3203; val_chrom_access_recon_loss: 7932213.5000; val_global_loss: 24971947.5000; val_optim_loss: 24971947.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9023; val_auprc_score: 0.8643; val_best_acc_score: 0.8426; val_best_f1_score: 0.8529; train_kl_reg_loss: 136032.5911; train_edge_recon_loss: 2815815.5909; train_gene_expr_recon_loss: 13787620.0000; train_masked_gp_l1_reg_loss: 181308.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84240.6629; train_chrom_access_recon_loss: 7910048.5758; train_global_loss: 24915066.2727; train_optim_loss: 24915066.2727; val_kl_reg_loss: 135125.0547; val_edge_recon_loss: 2853371.0938; val_gene_expr_recon_loss: 13709456.0000; val_masked_gp_l1_reg_loss: 181299.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84135.3438; val_chrom_access_recon_loss: 7893811.8125; val_global_loss: 24857199.5000; val_optim_loss: 24857199.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9011; val_auprc_score: 0.8678; val_best_acc_score: 0.8375; val_best_f1_score: 0.8527; train_kl_reg_loss: 136335.4280; train_edge_recon_loss: 2817617.9091; train_gene_expr_recon_loss: 13781796.1061; train_masked_gp_l1_reg_loss: 181289.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83997.9164; train_chrom_access_recon_loss: 7901739.5909; train_global_loss: 24902776.4242; train_optim_loss: 24902776.4242; val_kl_reg_loss: 136737.2090; val_edge_recon_loss: 2836209.7500; val_gene_expr_recon_loss: 13856050.1250; val_masked_gp_l1_reg_loss: 181285.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83828.6562; val_chrom_access_recon_loss: 7921796.1250; val_global_loss: 25015907.0000; val_optim_loss: 25015907.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8975; val_auprc_score: 0.8535; val_best_acc_score: 0.8340; val_best_f1_score: 0.8474; train_kl_reg_loss: 135943.5791; train_edge_recon_loss: 2816147.0189; train_gene_expr_recon_loss: 13789537.1667; train_masked_gp_l1_reg_loss: 181295.2081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83673.2842; train_chrom_access_recon_loss: 7902083.2955; train_global_loss: 24908679.6364; train_optim_loss: 24908679.6364; val_kl_reg_loss: 134743.6738; val_edge_recon_loss: 2852951.8438; val_gene_expr_recon_loss: 13734423.7500; val_masked_gp_l1_reg_loss: 181313.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83564.6094; val_chrom_access_recon_loss: 7840186.2500; val_global_loss: 24827183.2500; val_optim_loss: 24827183.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9046; val_auprc_score: 0.8663; val_best_acc_score: 0.8474; val_best_f1_score: 0.8567; train_kl_reg_loss: 135276.7853; train_edge_recon_loss: 2818483.0038; train_gene_expr_recon_loss: 13782773.2424; train_masked_gp_l1_reg_loss: 181350.6491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83512.2634; train_chrom_access_recon_loss: 7896281.8939; train_global_loss: 24897678.0000; train_optim_loss: 24897678.0000; val_kl_reg_loss: 135156.8184; val_edge_recon_loss: 2840136.7812; val_gene_expr_recon_loss: 13805333.3750; val_masked_gp_l1_reg_loss: 181331.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83407.8125; val_chrom_access_recon_loss: 7820661.6250; val_global_loss: 24866028.7500; val_optim_loss: 24866028.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9002; val_auprc_score: 0.8610; val_best_acc_score: 0.8436; val_best_f1_score: 0.8544; train_kl_reg_loss: 136136.5601; train_edge_recon_loss: 2813697.9508; train_gene_expr_recon_loss: 13788113.2879; train_masked_gp_l1_reg_loss: 181363.7718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83270.1699; train_chrom_access_recon_loss: 7900336.9621; train_global_loss: 24902918.6061; train_optim_loss: 24902918.6061; val_kl_reg_loss: 135238.5576; val_edge_recon_loss: 2840975.8125; val_gene_expr_recon_loss: 13822990.7500; val_masked_gp_l1_reg_loss: 181441.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83216.0391; val_chrom_access_recon_loss: 7831288.5000; val_global_loss: 24895151.2500; val_optim_loss: 24895151.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8992; val_auprc_score: 0.8574; val_best_acc_score: 0.8380; val_best_f1_score: 0.8500; train_kl_reg_loss: 136169.3529; train_edge_recon_loss: 2815280.8182; train_gene_expr_recon_loss: 13775702.1061; train_masked_gp_l1_reg_loss: 181478.4820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83125.8954; train_chrom_access_recon_loss: 7901013.7045; train_global_loss: 24892770.4242; train_optim_loss: 24892770.4242; val_kl_reg_loss: 134799.2324; val_edge_recon_loss: 2875139.9688; val_gene_expr_recon_loss: 13702007.5000; val_masked_gp_l1_reg_loss: 181487.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83029.8125; val_chrom_access_recon_loss: 7932601.1250; val_global_loss: 24909065.5000; val_optim_loss: 24909065.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9029; val_auprc_score: 0.8583; val_best_acc_score: 0.8455; val_best_f1_score: 0.8565; train_kl_reg_loss: 128207.0966; train_edge_recon_loss: 2923681.4167; train_gene_expr_recon_loss: 13561872.6970; train_masked_gp_l1_reg_loss: 182604.3163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86917.5359; train_chrom_access_recon_loss: 8211097.3409; train_global_loss: 25094380.4848; train_optim_loss: 25094380.4848; val_kl_reg_loss: 68523.6182; val_edge_recon_loss: 2919837.8750; val_gene_expr_recon_loss: 13353430.3750; val_masked_gp_l1_reg_loss: 182731.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90797.9062; val_chrom_access_recon_loss: 7853910.6875; val_global_loss: 24469232.0000; val_optim_loss: 24469232.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9105; val_auprc_score: 0.8744; val_best_acc_score: 0.8563; val_best_f1_score: 0.8654; train_kl_reg_loss: 149692.1297; train_edge_recon_loss: 2873455.8182; train_gene_expr_recon_loss: 13431105.7121; train_masked_gp_l1_reg_loss: 182561.1387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90558.9186; train_chrom_access_recon_loss: 7835160.0833; train_global_loss: 24562533.6364; train_optim_loss: 24562533.6364; val_kl_reg_loss: 76661.3271; val_edge_recon_loss: 2883747.1250; val_gene_expr_recon_loss: 13403137.8750; val_masked_gp_l1_reg_loss: 182425.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89443.6328; val_chrom_access_recon_loss: 7712451.8125; val_global_loss: 24347868.5000; val_optim_loss: 24347868.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9133; val_auprc_score: 0.8839; val_best_acc_score: 0.8487; val_best_f1_score: 0.8591; train_kl_reg_loss: 156839.9503; train_edge_recon_loss: 2872510.7841; train_gene_expr_recon_loss: 13398829.3030; train_masked_gp_l1_reg_loss: 182323.2564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87664.1929; train_chrom_access_recon_loss: 7739791.6364; train_global_loss: 24437958.9697; train_optim_loss: 24437958.9697; val_kl_reg_loss: 80757.3203; val_edge_recon_loss: 2893533.3125; val_gene_expr_recon_loss: 13305850.5000; val_masked_gp_l1_reg_loss: 182222.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85921.6250; val_chrom_access_recon_loss: 7642389.1875; val_global_loss: 24190674.7500; val_optim_loss: 24190674.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9070; val_auprc_score: 0.8678; val_best_acc_score: 0.8509; val_best_f1_score: 0.8627; train_kl_reg_loss: 158393.6323; train_edge_recon_loss: 2862584.4394; train_gene_expr_recon_loss: 13383287.1970; train_masked_gp_l1_reg_loss: 182169.5410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84585.1873; train_chrom_access_recon_loss: 7699416.4621; train_global_loss: 24370436.4848; train_optim_loss: 24370436.4848; val_kl_reg_loss: 83017.9756; val_edge_recon_loss: 2885819.7500; val_gene_expr_recon_loss: 13454559.7500; val_masked_gp_l1_reg_loss: 182145.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83335.8125; val_chrom_access_recon_loss: 7761917.3125; val_global_loss: 24450796.0000; val_optim_loss: 24450796.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9134; val_auprc_score: 0.8708; val_best_acc_score: 0.8589; val_best_f1_score: 0.8690; train_kl_reg_loss: 157926.2966; train_edge_recon_loss: 2857920.5530; train_gene_expr_recon_loss: 13369782.5152; train_masked_gp_l1_reg_loss: 182121.3750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82487.7018; train_chrom_access_recon_loss: 7696975.7197; train_global_loss: 24347214.1818; train_optim_loss: 24347214.1818; val_kl_reg_loss: 85067.2080; val_edge_recon_loss: 2850914.5625; val_gene_expr_recon_loss: 13296881.3750; val_masked_gp_l1_reg_loss: 182110.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81635.4688; val_chrom_access_recon_loss: 7649509.5000; val_global_loss: 24146119.0000; val_optim_loss: 24146119.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9171; val_auprc_score: 0.8809; val_best_acc_score: 0.8568; val_best_f1_score: 0.8659; train_kl_reg_loss: 156427.3812; train_edge_recon_loss: 2861748.1136; train_gene_expr_recon_loss: 13371493.8333; train_masked_gp_l1_reg_loss: 182115.2734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81084.1571; train_chrom_access_recon_loss: 7685374.4167; train_global_loss: 24338243.0606; train_optim_loss: 24338243.0606; val_kl_reg_loss: 85596.2695; val_edge_recon_loss: 2845540.5938; val_gene_expr_recon_loss: 13318151.1250; val_masked_gp_l1_reg_loss: 182144.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80593.7188; val_chrom_access_recon_loss: 7717591.0000; val_global_loss: 24229618.5000; val_optim_loss: 24229618.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9139; val_auprc_score: 0.8833; val_best_acc_score: 0.8541; val_best_f1_score: 0.8641; train_kl_reg_loss: 154439.5803; train_edge_recon_loss: 2843607.1591; train_gene_expr_recon_loss: 13359186.2879; train_masked_gp_l1_reg_loss: 182193.9437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80217.2799; train_chrom_access_recon_loss: 7679367.5379; train_global_loss: 24299011.9394; train_optim_loss: 24299011.9394; val_kl_reg_loss: 86709.3906; val_edge_recon_loss: 2853822.6250; val_gene_expr_recon_loss: 13506499.1250; val_masked_gp_l1_reg_loss: 182252.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79905.6250; val_chrom_access_recon_loss: 7696305.2500; val_global_loss: 24405494.0000; val_optim_loss: 24405494.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9109; val_auprc_score: 0.8730; val_best_acc_score: 0.8541; val_best_f1_score: 0.8626; train_kl_reg_loss: 153338.4976; train_edge_recon_loss: 2854207.8523; train_gene_expr_recon_loss: 13355846.3939; train_masked_gp_l1_reg_loss: 182296.3224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79627.4677; train_chrom_access_recon_loss: 7676251.0530; train_global_loss: 24301567.6970; train_optim_loss: 24301567.6970; val_kl_reg_loss: 87677.7471; val_edge_recon_loss: 2869024.2500; val_gene_expr_recon_loss: 13392336.5000; val_masked_gp_l1_reg_loss: 182336.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79379.2188; val_chrom_access_recon_loss: 7642030.8750; val_global_loss: 24252784.5000; val_optim_loss: 24252784.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9157; val_auprc_score: 0.8797; val_best_acc_score: 0.8571; val_best_f1_score: 0.8666; train_kl_reg_loss: 151496.3859; train_edge_recon_loss: 2828521.6477; train_gene_expr_recon_loss: 13347442.9697; train_masked_gp_l1_reg_loss: 182444.9171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79227.1813; train_chrom_access_recon_loss: 7675384.1212; train_global_loss: 24264517.3030; train_optim_loss: 24264517.3030; val_kl_reg_loss: 88920.1943; val_edge_recon_loss: 2840145.7812; val_gene_expr_recon_loss: 13263896.3750; val_masked_gp_l1_reg_loss: 182503.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79025.7578; val_chrom_access_recon_loss: 7610881.6250; val_global_loss: 24065373.5000; val_optim_loss: 24065373.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9075; val_auprc_score: 0.8659; val_best_acc_score: 0.8517; val_best_f1_score: 0.8632; train_kl_reg_loss: 150912.9439; train_edge_recon_loss: 2843346.5227; train_gene_expr_recon_loss: 13342173.1364; train_masked_gp_l1_reg_loss: 182550.5959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78922.6123; train_chrom_access_recon_loss: 7676776.4091; train_global_loss: 24274682.0606; train_optim_loss: 24274682.0606; val_kl_reg_loss: 90026.2461; val_edge_recon_loss: 2873987.6250; val_gene_expr_recon_loss: 13186467.3750; val_masked_gp_l1_reg_loss: 182587.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78847.2188; val_chrom_access_recon_loss: 7580275.0000; val_global_loss: 23992191.5000; val_optim_loss: 23992191.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9108; val_auprc_score: 0.8774; val_best_acc_score: 0.8501; val_best_f1_score: 0.8617; train_kl_reg_loss: 148546.3568; train_edge_recon_loss: 2834529.2159; train_gene_expr_recon_loss: 13353473.1667; train_masked_gp_l1_reg_loss: 182652.0272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78762.4109; train_chrom_access_recon_loss: 7680550.9924; train_global_loss: 24278514.1212; train_optim_loss: 24278514.1212; val_kl_reg_loss: 91286.6953; val_edge_recon_loss: 2881300.5312; val_gene_expr_recon_loss: 13420410.1250; val_masked_gp_l1_reg_loss: 182712.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78687.0391; val_chrom_access_recon_loss: 7658603.2500; val_global_loss: 24313000.0000; val_optim_loss: 24313000.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9119; val_auprc_score: 0.8720; val_best_acc_score: 0.8533; val_best_f1_score: 0.8620; train_kl_reg_loss: 146295.7708; train_edge_recon_loss: 2830559.5265; train_gene_expr_recon_loss: 13332478.2424; train_masked_gp_l1_reg_loss: 182779.3965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78611.8788; train_chrom_access_recon_loss: 7670132.2121; train_global_loss: 24240857.0303; train_optim_loss: 24240857.0303; val_kl_reg_loss: 92450.0908; val_edge_recon_loss: 2847715.7812; val_gene_expr_recon_loss: 13258412.6250; val_masked_gp_l1_reg_loss: 182875.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78601.7109; val_chrom_access_recon_loss: 7623860.9375; val_global_loss: 24083916.5000; val_optim_loss: 24083916.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9157; val_auprc_score: 0.8810; val_best_acc_score: 0.8600; val_best_f1_score: 0.8660; train_kl_reg_loss: 145767.8108; train_edge_recon_loss: 2830800.5871; train_gene_expr_recon_loss: 13324470.4848; train_masked_gp_l1_reg_loss: 182883.2857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78458.8352; train_chrom_access_recon_loss: 7663701.3788; train_global_loss: 24226082.3939; train_optim_loss: 24226082.3939; val_kl_reg_loss: 94046.9297; val_edge_recon_loss: 2856606.5312; val_gene_expr_recon_loss: 13399858.1250; val_masked_gp_l1_reg_loss: 182931.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78380.5156; val_chrom_access_recon_loss: 7638788.7500; val_global_loss: 24250612.7500; val_optim_loss: 24250612.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9204; val_auprc_score: 0.8827; val_best_acc_score: 0.8616; val_best_f1_score: 0.8673; train_kl_reg_loss: 144892.3172; train_edge_recon_loss: 2828109.5000; train_gene_expr_recon_loss: 13333159.5303; train_masked_gp_l1_reg_loss: 182953.4856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78324.2586; train_chrom_access_recon_loss: 7668176.1894; train_global_loss: 24235615.2424; train_optim_loss: 24235615.2424; val_kl_reg_loss: 94277.7832; val_edge_recon_loss: 2838301.9375; val_gene_expr_recon_loss: 13297950.3750; val_masked_gp_l1_reg_loss: 182990.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78287.1641; val_chrom_access_recon_loss: 7617314.6250; val_global_loss: 24109122.2500; val_optim_loss: 24109122.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9146; val_auprc_score: 0.8791; val_best_acc_score: 0.8546; val_best_f1_score: 0.8654; train_kl_reg_loss: 143002.8994; train_edge_recon_loss: 2826470.8523; train_gene_expr_recon_loss: 13317873.6970; train_masked_gp_l1_reg_loss: 182682.7533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75327.8461; train_chrom_access_recon_loss: 7661855.3636; train_global_loss: 24207213.3333; train_optim_loss: 24207213.3333; val_kl_reg_loss: 94754.9541; val_edge_recon_loss: 2843733.5312; val_gene_expr_recon_loss: 13390120.6250; val_masked_gp_l1_reg_loss: 182554.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74833.7891; val_chrom_access_recon_loss: 7759831.6250; val_global_loss: 24345829.0000; val_optim_loss: 24345829.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9143; val_auprc_score: 0.8786; val_best_acc_score: 0.8555; val_best_f1_score: 0.8638; train_kl_reg_loss: 143099.4399; train_edge_recon_loss: 2824790.6439; train_gene_expr_recon_loss: 13323656.1818; train_masked_gp_l1_reg_loss: 182523.4763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74819.3808; train_chrom_access_recon_loss: 7665221.8485; train_global_loss: 24214110.9394; train_optim_loss: 24214110.9394; val_kl_reg_loss: 94947.1621; val_edge_recon_loss: 2844747.5625; val_gene_expr_recon_loss: 13351100.8750; val_masked_gp_l1_reg_loss: 182498.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74814.0938; val_chrom_access_recon_loss: 7663481.7500; val_global_loss: 24211590.0000; val_optim_loss: 24211590.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9152; val_auprc_score: 0.8867; val_best_acc_score: 0.8549; val_best_f1_score: 0.8651; train_kl_reg_loss: 143044.2476; train_edge_recon_loss: 2823342.7311; train_gene_expr_recon_loss: 13318817.8788; train_masked_gp_l1_reg_loss: 182488.5062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74807.3210; train_chrom_access_recon_loss: 7664526.8182; train_global_loss: 24207027.3939; train_optim_loss: 24207027.3939; val_kl_reg_loss: 94754.9648; val_edge_recon_loss: 2843281.9688; val_gene_expr_recon_loss: 13289711.3750; val_masked_gp_l1_reg_loss: 182476.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74791.8594; val_chrom_access_recon_loss: 7645008.5000; val_global_loss: 24130025.0000; val_optim_loss: 24130025.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9162; val_auprc_score: 0.8855; val_best_acc_score: 0.8563; val_best_f1_score: 0.8643; train_kl_reg_loss: 142589.0114; train_edge_recon_loss: 2822086.8068; train_gene_expr_recon_loss: 13315643.4091; train_masked_gp_l1_reg_loss: 182471.9280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74786.9383; train_chrom_access_recon_loss: 7654350.2652; train_global_loss: 24191928.2424; train_optim_loss: 24191928.2424; val_kl_reg_loss: 93861.8125; val_edge_recon_loss: 2854935.2812; val_gene_expr_recon_loss: 13234976.3750; val_masked_gp_l1_reg_loss: 182468.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74778.8359; val_chrom_access_recon_loss: 7630409.4375; val_global_loss: 24071431.2500; val_optim_loss: 24071431.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 23 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9111
val AUPRC score: 0.8802
val best accuracy score: 0.8487
val best F1 score: 0.8589
val target rna MSE score: 1.1427
val source rna MSE score: 0.4309
val target atac MSE score: 0.3285
val source atac MSE score: 0.0743
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
