[True]
Run timestamp: 24072023_163013_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9610; val_auprc_score: 0.9660; val_best_acc_score: 0.5318; val_best_f1_score: 0.6810; train_kl_reg_loss: 3816.4909; train_edge_recon_loss: 3472926.4722; train_gene_expr_recon_loss: 313150.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10741762.4444; train_global_loss: 14531655.4444; train_optim_loss: 14531655.4444; val_kl_reg_loss: 13575.0000; val_edge_recon_loss: 4062427.2500; val_gene_expr_recon_loss: 297364.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10730463.0000; val_global_loss: 15103830.0000; val_optim_loss: 15103830.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9466; val_auprc_score: 0.9518; val_best_acc_score: 0.5170; val_best_f1_score: 0.6741; train_kl_reg_loss: 24758.8758; train_edge_recon_loss: 3491259.3611; train_gene_expr_recon_loss: 292471.8819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10604126.4444; train_global_loss: 14412616.4444; train_optim_loss: 14412616.4444; val_kl_reg_loss: 27561.1016; val_edge_recon_loss: 4063890.7500; val_gene_expr_recon_loss: 273062.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10508358.0000; val_global_loss: 14872872.0000; val_optim_loss: 14872872.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9372; val_auprc_score: 0.9417; val_best_acc_score: 0.5230; val_best_f1_score: 0.6768; train_kl_reg_loss: 48136.0549; train_edge_recon_loss: 3505760.0000; train_gene_expr_recon_loss: 268314.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10348188.7778; train_global_loss: 14170399.1111; train_optim_loss: 14170399.1111; val_kl_reg_loss: 38945.7031; val_edge_recon_loss: 4063644.0000; val_gene_expr_recon_loss: 255203.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10297806.0000; val_global_loss: 14655600.0000; val_optim_loss: 14655600.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9239; val_auprc_score: 0.9286; val_best_acc_score: 0.5364; val_best_f1_score: 0.6828; train_kl_reg_loss: 65314.6241; train_edge_recon_loss: 3516781.5833; train_gene_expr_recon_loss: 252667.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10188481.2222; train_global_loss: 14023244.7778; train_optim_loss: 14023244.7778; val_kl_reg_loss: 57464.2500; val_edge_recon_loss: 4062762.7500; val_gene_expr_recon_loss: 242988.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10153084.0000; val_global_loss: 14516300.0000; val_optim_loss: 14516300.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9080; val_auprc_score: 0.9110; val_best_acc_score: 0.5674; val_best_f1_score: 0.6970; train_kl_reg_loss: 82128.3750; train_edge_recon_loss: 3521506.9444; train_gene_expr_recon_loss: 243095.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9997410.2222; train_global_loss: 13844140.6667; train_optim_loss: 13844140.6667; val_kl_reg_loss: 54912.8516; val_edge_recon_loss: 4061334.2500; val_gene_expr_recon_loss: 236172.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10049139.0000; val_global_loss: 14401558.0000; val_optim_loss: 14401558.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8985; val_auprc_score: 0.9015; val_best_acc_score: 0.6144; val_best_f1_score: 0.7196; train_kl_reg_loss: 81528.7049; train_edge_recon_loss: 3525981.7778; train_gene_expr_recon_loss: 235571.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9910554.3333; train_global_loss: 13753636.2222; train_optim_loss: 13753636.2222; val_kl_reg_loss: 67843.3672; val_edge_recon_loss: 4059096.7500; val_gene_expr_recon_loss: 231031.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9970994.0000; val_global_loss: 14328966.0000; val_optim_loss: 14328966.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8899; val_auprc_score: 0.8888; val_best_acc_score: 0.6823; val_best_f1_score: 0.7546; train_kl_reg_loss: 86250.0651; train_edge_recon_loss: 3520570.8056; train_gene_expr_recon_loss: 231832.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9877972.0000; train_global_loss: 13716625.6667; train_optim_loss: 13716625.6667; val_kl_reg_loss: 74338.5156; val_edge_recon_loss: 4054436.0000; val_gene_expr_recon_loss: 227271.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9918480.0000; val_global_loss: 14274526.0000; val_optim_loss: 14274526.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8809; val_auprc_score: 0.8751; val_best_acc_score: 0.7606; val_best_f1_score: 0.7963; train_kl_reg_loss: 87295.7205; train_edge_recon_loss: 3519164.9444; train_gene_expr_recon_loss: 228591.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9821654.4444; train_global_loss: 13656706.8889; train_optim_loss: 13656706.8889; val_kl_reg_loss: 56347.1953; val_edge_recon_loss: 4043382.7500; val_gene_expr_recon_loss: 226406.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9922526.0000; val_global_loss: 14248662.0000; val_optim_loss: 14248662.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8812; val_auprc_score: 0.8779; val_best_acc_score: 0.7912; val_best_f1_score: 0.8044; train_kl_reg_loss: 82517.2795; train_edge_recon_loss: 3521008.3889; train_gene_expr_recon_loss: 227932.0851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9823034.2222; train_global_loss: 13654492.0000; train_optim_loss: 13654492.0000; val_kl_reg_loss: 59081.6953; val_edge_recon_loss: 4026189.2500; val_gene_expr_recon_loss: 223592.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9874251.0000; val_global_loss: 14183115.0000; val_optim_loss: 14183115.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8861; val_auprc_score: 0.8766; val_best_acc_score: 0.7844; val_best_f1_score: 0.7882; train_kl_reg_loss: 80628.6211; train_edge_recon_loss: 3509544.2778; train_gene_expr_recon_loss: 224282.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9820811.8889; train_global_loss: 13635267.7778; train_optim_loss: 13635267.7778; val_kl_reg_loss: 58609.1172; val_edge_recon_loss: 3968527.5000; val_gene_expr_recon_loss: 221977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9845960.0000; val_global_loss: 14095074.0000; val_optim_loss: 14095074.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8881; val_auprc_score: 0.8750; val_best_acc_score: 0.8068; val_best_f1_score: 0.8198; train_kl_reg_loss: 73188.1254; train_edge_recon_loss: 3488171.9167; train_gene_expr_recon_loss: 223412.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9705581.7778; train_global_loss: 13490354.5556; train_optim_loss: 13490354.5556; val_kl_reg_loss: 48666.2578; val_edge_recon_loss: 3780878.0000; val_gene_expr_recon_loss: 222380.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9848732.0000; val_global_loss: 13900656.0000; val_optim_loss: 13900656.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8737; val_auprc_score: 0.8539; val_best_acc_score: 0.7886; val_best_f1_score: 0.8099; train_kl_reg_loss: 52814.0165; train_edge_recon_loss: 3380517.2778; train_gene_expr_recon_loss: 224972.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9792741.1111; train_global_loss: 13451044.5556; train_optim_loss: 13451044.5556; val_kl_reg_loss: 43743.8672; val_edge_recon_loss: 3220741.2500; val_gene_expr_recon_loss: 228012.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9887396.0000; val_global_loss: 13379893.0000; val_optim_loss: 13379893.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8704; val_auprc_score: 0.8515; val_best_acc_score: 0.7816; val_best_f1_score: 0.8072; train_kl_reg_loss: 71132.5503; train_edge_recon_loss: 3042252.1944; train_gene_expr_recon_loss: 230807.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9823753.5556; train_global_loss: 13167946.0000; train_optim_loss: 13167946.0000; val_kl_reg_loss: 109157.9766; val_edge_recon_loss: 2951389.2500; val_gene_expr_recon_loss: 226774.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9876699.0000; val_global_loss: 13164020.0000; val_optim_loss: 13164020.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8784; val_auprc_score: 0.8541; val_best_acc_score: 0.7964; val_best_f1_score: 0.8153; train_kl_reg_loss: 115889.3481; train_edge_recon_loss: 2941499.8611; train_gene_expr_recon_loss: 226759.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9712627.1111; train_global_loss: 12996775.8889; train_optim_loss: 12996775.8889; val_kl_reg_loss: 101066.2188; val_edge_recon_loss: 2936846.5000; val_gene_expr_recon_loss: 223699.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9840024.0000; val_global_loss: 13101636.0000; val_optim_loss: 13101636.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8961; val_auprc_score: 0.8716; val_best_acc_score: 0.8151; val_best_f1_score: 0.8287; train_kl_reg_loss: 101263.5720; train_edge_recon_loss: 2908402.8056; train_gene_expr_recon_loss: 225406.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776605.8889; train_global_loss: 13011678.6667; train_optim_loss: 13011678.6667; val_kl_reg_loss: 99144.3672; val_edge_recon_loss: 2894232.7500; val_gene_expr_recon_loss: 222446.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9830843.0000; val_global_loss: 13046667.0000; val_optim_loss: 13046667.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9086; val_auprc_score: 0.8816; val_best_acc_score: 0.8397; val_best_f1_score: 0.8512; train_kl_reg_loss: 101854.9592; train_edge_recon_loss: 2880661.0833; train_gene_expr_recon_loss: 223819.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9712748.2222; train_global_loss: 12919083.2222; train_optim_loss: 12919083.2222; val_kl_reg_loss: 98572.7266; val_edge_recon_loss: 2850583.2500; val_gene_expr_recon_loss: 221341.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810687.0000; val_global_loss: 12981184.0000; val_optim_loss: 12981184.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9143; val_auprc_score: 0.8838; val_best_acc_score: 0.8511; val_best_f1_score: 0.8625; train_kl_reg_loss: 102460.7465; train_edge_recon_loss: 2845197.6944; train_gene_expr_recon_loss: 223657.8455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9747880.3333; train_global_loss: 12919196.5556; train_optim_loss: 12919196.5556; val_kl_reg_loss: 97795.1562; val_edge_recon_loss: 2840386.2500; val_gene_expr_recon_loss: 220601.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9779944.0000; val_global_loss: 12938727.0000; val_optim_loss: 12938727.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9266; val_auprc_score: 0.9068; val_best_acc_score: 0.8684; val_best_f1_score: 0.8782; train_kl_reg_loss: 101972.2960; train_edge_recon_loss: 2837292.9444; train_gene_expr_recon_loss: 221419.4497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686394.4444; train_global_loss: 12847079.0000; train_optim_loss: 12847079.0000; val_kl_reg_loss: 101053.6172; val_edge_recon_loss: 2812997.5000; val_gene_expr_recon_loss: 219237.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9771452.0000; val_global_loss: 12904741.0000; val_optim_loss: 12904741.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9285; val_auprc_score: 0.9017; val_best_acc_score: 0.8727; val_best_f1_score: 0.8824; train_kl_reg_loss: 105856.7083; train_edge_recon_loss: 2823540.6389; train_gene_expr_recon_loss: 220969.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9688138.1111; train_global_loss: 12838505.0000; train_optim_loss: 12838505.0000; val_kl_reg_loss: 101851.2578; val_edge_recon_loss: 2798193.7500; val_gene_expr_recon_loss: 218967.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9780344.0000; val_global_loss: 12899356.0000; val_optim_loss: 12899356.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9296; val_auprc_score: 0.9081; val_best_acc_score: 0.8724; val_best_f1_score: 0.8816; train_kl_reg_loss: 102930.5955; train_edge_recon_loss: 2808763.2500; train_gene_expr_recon_loss: 219404.1840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9656426.1111; train_global_loss: 12787524.1111; train_optim_loss: 12787524.1111; val_kl_reg_loss: 99278.8906; val_edge_recon_loss: 2813351.2500; val_gene_expr_recon_loss: 218621.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9777086.0000; val_global_loss: 12908338.0000; val_optim_loss: 12908338.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9396; val_auprc_score: 0.9204; val_best_acc_score: 0.8812; val_best_f1_score: 0.8890; train_kl_reg_loss: 103047.9193; train_edge_recon_loss: 2790344.8889; train_gene_expr_recon_loss: 219336.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9613108.1111; train_global_loss: 12725837.3333; train_optim_loss: 12725837.3333; val_kl_reg_loss: 100189.8750; val_edge_recon_loss: 2791515.5000; val_gene_expr_recon_loss: 217142.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9736040.0000; val_global_loss: 12844888.0000; val_optim_loss: 12844888.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9404; val_auprc_score: 0.9198; val_best_acc_score: 0.8795; val_best_f1_score: 0.8876; train_kl_reg_loss: 98688.7387; train_edge_recon_loss: 2788779.1389; train_gene_expr_recon_loss: 218541.6215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9646237.0000; train_global_loss: 12752246.4444; train_optim_loss: 12752246.4444; val_kl_reg_loss: 92667.9688; val_edge_recon_loss: 2812685.7500; val_gene_expr_recon_loss: 217533.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9750606.0000; val_global_loss: 12873494.0000; val_optim_loss: 12873494.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9523; val_auprc_score: 0.9357; val_best_acc_score: 0.8965; val_best_f1_score: 0.9009; train_kl_reg_loss: 99514.1328; train_edge_recon_loss: 2773999.5278; train_gene_expr_recon_loss: 219146.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9638913.5556; train_global_loss: 12731573.1111; train_optim_loss: 12731573.1111; val_kl_reg_loss: 97945.5156; val_edge_recon_loss: 2751651.0000; val_gene_expr_recon_loss: 216627.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9737867.0000; val_global_loss: 12804091.0000; val_optim_loss: 12804091.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9541; val_auprc_score: 0.9404; val_best_acc_score: 0.8980; val_best_f1_score: 0.9050; train_kl_reg_loss: 98762.0026; train_edge_recon_loss: 2766522.1944; train_gene_expr_recon_loss: 217353.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624715.2222; train_global_loss: 12707352.7778; train_optim_loss: 12707352.7778; val_kl_reg_loss: 92687.7500; val_edge_recon_loss: 2744918.5000; val_gene_expr_recon_loss: 215695.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9698861.0000; val_global_loss: 12752163.0000; val_optim_loss: 12752163.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9567; val_auprc_score: 0.9436; val_best_acc_score: 0.9026; val_best_f1_score: 0.9077; train_kl_reg_loss: 93310.6788; train_edge_recon_loss: 2765806.4722; train_gene_expr_recon_loss: 218564.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9672883.8889; train_global_loss: 12750565.5556; train_optim_loss: 12750565.5556; val_kl_reg_loss: 91257.4375; val_edge_recon_loss: 2756584.0000; val_gene_expr_recon_loss: 216610.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9722813.0000; val_global_loss: 12787265.0000; val_optim_loss: 12787265.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9599; val_auprc_score: 0.9435; val_best_acc_score: 0.9092; val_best_f1_score: 0.9137; train_kl_reg_loss: 104443.2578; train_edge_recon_loss: 2786244.4167; train_gene_expr_recon_loss: 219202.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645598.0000; train_global_loss: 12755488.5556; train_optim_loss: 12755488.5556; val_kl_reg_loss: 71604.8594; val_edge_recon_loss: 2776428.5000; val_gene_expr_recon_loss: 217096.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714114.0000; val_global_loss: 12779244.0000; val_optim_loss: 12779244.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9646; val_auprc_score: 0.9506; val_best_acc_score: 0.9143; val_best_f1_score: 0.9178; train_kl_reg_loss: 107428.1944; train_edge_recon_loss: 2756986.4722; train_gene_expr_recon_loss: 218562.9149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9616395.0000; train_global_loss: 12699372.5556; train_optim_loss: 12699372.5556; val_kl_reg_loss: 69120.9062; val_edge_recon_loss: 2777689.5000; val_gene_expr_recon_loss: 217184.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9718251.0000; val_global_loss: 12782246.0000; val_optim_loss: 12782246.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9603; val_auprc_score: 0.9439; val_best_acc_score: 0.9108; val_best_f1_score: 0.9148; train_kl_reg_loss: 103893.8741; train_edge_recon_loss: 2756183.2500; train_gene_expr_recon_loss: 218260.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625027.6667; train_global_loss: 12703365.2222; train_optim_loss: 12703365.2222; val_kl_reg_loss: 71750.8125; val_edge_recon_loss: 2776301.7500; val_gene_expr_recon_loss: 218259.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9727586.0000; val_global_loss: 12793898.0000; val_optim_loss: 12793898.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9672; val_auprc_score: 0.9536; val_best_acc_score: 0.9193; val_best_f1_score: 0.9233; train_kl_reg_loss: 98108.3238; train_edge_recon_loss: 2757741.8056; train_gene_expr_recon_loss: 217705.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9573333.5556; train_global_loss: 12646888.7778; train_optim_loss: 12646888.7778; val_kl_reg_loss: 74708.6094; val_edge_recon_loss: 2771638.0000; val_gene_expr_recon_loss: 215340.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9697089.0000; val_global_loss: 12758776.0000; val_optim_loss: 12758776.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9637; val_auprc_score: 0.9522; val_best_acc_score: 0.9130; val_best_f1_score: 0.9168; train_kl_reg_loss: 99230.7300; train_edge_recon_loss: 2755184.0000; train_gene_expr_recon_loss: 216979.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590795.5556; train_global_loss: 12662190.0000; train_optim_loss: 12662190.0000; val_kl_reg_loss: 71759.1562; val_edge_recon_loss: 2778457.7500; val_gene_expr_recon_loss: 216292.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9695941.0000; val_global_loss: 12762450.0000; val_optim_loss: 12762450.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9658; val_auprc_score: 0.9501; val_best_acc_score: 0.9175; val_best_f1_score: 0.9213; train_kl_reg_loss: 97099.3655; train_edge_recon_loss: 2750645.6944; train_gene_expr_recon_loss: 217454.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9596143.3333; train_global_loss: 12661343.1111; train_optim_loss: 12661343.1111; val_kl_reg_loss: 73228.0703; val_edge_recon_loss: 2757937.5000; val_gene_expr_recon_loss: 215760.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696322.0000; val_global_loss: 12743248.0000; val_optim_loss: 12743248.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9650; val_auprc_score: 0.9516; val_best_acc_score: 0.9162; val_best_f1_score: 0.9201; train_kl_reg_loss: 97833.3507; train_edge_recon_loss: 2738303.8056; train_gene_expr_recon_loss: 216623.1476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9556688.6667; train_global_loss: 12609448.7778; train_optim_loss: 12609448.7778; val_kl_reg_loss: 73539.3438; val_edge_recon_loss: 2749484.5000; val_gene_expr_recon_loss: 215979.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9698964.0000; val_global_loss: 12737967.0000; val_optim_loss: 12737967.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9656; val_auprc_score: 0.9540; val_best_acc_score: 0.9174; val_best_f1_score: 0.9215; train_kl_reg_loss: 97684.9036; train_edge_recon_loss: 2746637.9444; train_gene_expr_recon_loss: 217876.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9605735.6667; train_global_loss: 12667935.0000; train_optim_loss: 12667935.0000; val_kl_reg_loss: 73004.0156; val_edge_recon_loss: 2757212.7500; val_gene_expr_recon_loss: 215866.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9682954.0000; val_global_loss: 12729038.0000; val_optim_loss: 12729038.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9658; val_auprc_score: 0.9522; val_best_acc_score: 0.9179; val_best_f1_score: 0.9221; train_kl_reg_loss: 97327.5295; train_edge_recon_loss: 2745024.9167; train_gene_expr_recon_loss: 216930.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602162.4444; train_global_loss: 12661445.0000; train_optim_loss: 12661445.0000; val_kl_reg_loss: 73406.3984; val_edge_recon_loss: 2750949.5000; val_gene_expr_recon_loss: 215789.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9691447.0000; val_global_loss: 12731592.0000; val_optim_loss: 12731592.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9669; val_auprc_score: 0.9561; val_best_acc_score: 0.9188; val_best_f1_score: 0.9228; train_kl_reg_loss: 97309.5842; train_edge_recon_loss: 2748771.8333; train_gene_expr_recon_loss: 215927.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9543908.1111; train_global_loss: 12605917.4444; train_optim_loss: 12605917.4444; val_kl_reg_loss: 74227.2969; val_edge_recon_loss: 2769605.7500; val_gene_expr_recon_loss: 215841.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9698143.0000; val_global_loss: 12757818.0000; val_optim_loss: 12757818.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9644; val_auprc_score: 0.9495; val_best_acc_score: 0.9147; val_best_f1_score: 0.9184; train_kl_reg_loss: 96954.2804; train_edge_recon_loss: 2735715.9722; train_gene_expr_recon_loss: 217425.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9543619.2222; train_global_loss: 12593714.6667; train_optim_loss: 12593714.6667; val_kl_reg_loss: 74673.7969; val_edge_recon_loss: 2760694.5000; val_gene_expr_recon_loss: 215879.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696753.0000; val_global_loss: 12748000.0000; val_optim_loss: 12748000.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9653; val_auprc_score: 0.9518; val_best_acc_score: 0.9167; val_best_f1_score: 0.9210; train_kl_reg_loss: 97083.3707; train_edge_recon_loss: 2745978.7222; train_gene_expr_recon_loss: 216623.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561874.7778; train_global_loss: 12621560.8889; train_optim_loss: 12621560.8889; val_kl_reg_loss: 74851.6719; val_edge_recon_loss: 2774427.0000; val_gene_expr_recon_loss: 215554.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9687019.0000; val_global_loss: 12751852.0000; val_optim_loss: 12751852.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9699; val_auprc_score: 0.9598; val_best_acc_score: 0.9214; val_best_f1_score: 0.9246; train_kl_reg_loss: 96893.7526; train_edge_recon_loss: 2739712.3611; train_gene_expr_recon_loss: 216110.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9586023.7778; train_global_loss: 12638740.0000; train_optim_loss: 12638740.0000; val_kl_reg_loss: 74467.2969; val_edge_recon_loss: 2761879.5000; val_gene_expr_recon_loss: 215566.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9679577.0000; val_global_loss: 12731490.0000; val_optim_loss: 12731490.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9639; val_auprc_score: 0.9497; val_best_acc_score: 0.9165; val_best_f1_score: 0.9205; train_kl_reg_loss: 96973.9149; train_edge_recon_loss: 2742171.1111; train_gene_expr_recon_loss: 217084.5955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587354.1111; train_global_loss: 12643583.7778; train_optim_loss: 12643583.7778; val_kl_reg_loss: 74745.8906; val_edge_recon_loss: 2756020.7500; val_gene_expr_recon_loss: 215767.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9689996.0000; val_global_loss: 12736530.0000; val_optim_loss: 12736530.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9682; val_auprc_score: 0.9571; val_best_acc_score: 0.9223; val_best_f1_score: 0.9257; train_kl_reg_loss: 96881.7300; train_edge_recon_loss: 2738649.3056; train_gene_expr_recon_loss: 217645.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627728.3333; train_global_loss: 12680905.2222; train_optim_loss: 12680905.2222; val_kl_reg_loss: 74445.0938; val_edge_recon_loss: 2741636.0000; val_gene_expr_recon_loss: 215726.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9687467.0000; val_global_loss: 12719275.0000; val_optim_loss: 12719275.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9668; val_auprc_score: 0.9531; val_best_acc_score: 0.9221; val_best_f1_score: 0.9253; train_kl_reg_loss: 96695.0217; train_edge_recon_loss: 2751487.0000; train_gene_expr_recon_loss: 216441.9497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9545805.2222; train_global_loss: 12610429.1111; train_optim_loss: 12610429.1111; val_kl_reg_loss: 74866.6562; val_edge_recon_loss: 2759452.2500; val_gene_expr_recon_loss: 215524.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673430.0000; val_global_loss: 12723274.0000; val_optim_loss: 12723274.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9687; val_auprc_score: 0.9576; val_best_acc_score: 0.9209; val_best_f1_score: 0.9243; train_kl_reg_loss: 96477.9280; train_edge_recon_loss: 2737677.8056; train_gene_expr_recon_loss: 214849.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9500412.0000; train_global_loss: 12549417.0000; train_optim_loss: 12549417.0000; val_kl_reg_loss: 74660.9062; val_edge_recon_loss: 2767724.7500; val_gene_expr_recon_loss: 215585.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683383.0000; val_global_loss: 12741354.0000; val_optim_loss: 12741354.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9667; val_auprc_score: 0.9543; val_best_acc_score: 0.9188; val_best_f1_score: 0.9222; train_kl_reg_loss: 96843.3898; train_edge_recon_loss: 2730670.6389; train_gene_expr_recon_loss: 216570.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9598419.8889; train_global_loss: 12642504.0000; train_optim_loss: 12642504.0000; val_kl_reg_loss: 75133.2891; val_edge_recon_loss: 2755260.5000; val_gene_expr_recon_loss: 215724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9694023.0000; val_global_loss: 12740141.0000; val_optim_loss: 12740141.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9674; val_auprc_score: 0.9518; val_best_acc_score: 0.9241; val_best_f1_score: 0.9270; train_kl_reg_loss: 96922.1797; train_edge_recon_loss: 2733871.9444; train_gene_expr_recon_loss: 217726.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627541.1111; train_global_loss: 12676062.1111; train_optim_loss: 12676062.1111; val_kl_reg_loss: 75325.9531; val_edge_recon_loss: 2728834.2500; val_gene_expr_recon_loss: 215648.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9690439.0000; val_global_loss: 12710248.0000; val_optim_loss: 12710248.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9648; val_auprc_score: 0.9489; val_best_acc_score: 0.9186; val_best_f1_score: 0.9226; train_kl_reg_loss: 97270.2014; train_edge_recon_loss: 2739825.8333; train_gene_expr_recon_loss: 217476.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9606126.4444; train_global_loss: 12660699.4444; train_optim_loss: 12660699.4444; val_kl_reg_loss: 75358.8125; val_edge_recon_loss: 2756879.7500; val_gene_expr_recon_loss: 215619.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9693092.0000; val_global_loss: 12740950.0000; val_optim_loss: 12740950.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9676; val_auprc_score: 0.9546; val_best_acc_score: 0.9188; val_best_f1_score: 0.9227; train_kl_reg_loss: 97048.4071; train_edge_recon_loss: 2735563.8889; train_gene_expr_recon_loss: 217152.3003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561044.5556; train_global_loss: 12610809.1111; train_optim_loss: 12610809.1111; val_kl_reg_loss: 74875.5703; val_edge_recon_loss: 2748752.5000; val_gene_expr_recon_loss: 215636.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683658.0000; val_global_loss: 12722923.0000; val_optim_loss: 12722923.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9702; val_auprc_score: 0.9617; val_best_acc_score: 0.9223; val_best_f1_score: 0.9258; train_kl_reg_loss: 96629.8958; train_edge_recon_loss: 2735061.9444; train_gene_expr_recon_loss: 215716.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9559665.3333; train_global_loss: 12607073.5556; train_optim_loss: 12607073.5556; val_kl_reg_loss: 75234.3906; val_edge_recon_loss: 2751715.5000; val_gene_expr_recon_loss: 215501.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683058.0000; val_global_loss: 12725510.0000; val_optim_loss: 12725510.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9683; val_auprc_score: 0.9571; val_best_acc_score: 0.9206; val_best_f1_score: 0.9244; train_kl_reg_loss: 97148.5816; train_edge_recon_loss: 2744375.4444; train_gene_expr_recon_loss: 215910.2830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591286.2222; train_global_loss: 12648720.4444; train_optim_loss: 12648720.4444; val_kl_reg_loss: 75225.5000; val_edge_recon_loss: 2745416.7500; val_gene_expr_recon_loss: 215338.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9676938.0000; val_global_loss: 12712919.0000; val_optim_loss: 12712919.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9724; val_auprc_score: 0.9615; val_best_acc_score: 0.9251; val_best_f1_score: 0.9284; train_kl_reg_loss: 96714.5738; train_edge_recon_loss: 2739985.5833; train_gene_expr_recon_loss: 216445.8455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9589127.8889; train_global_loss: 12642274.0000; train_optim_loss: 12642274.0000; val_kl_reg_loss: 75240.1562; val_edge_recon_loss: 2738852.7500; val_gene_expr_recon_loss: 215691.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9682430.0000; val_global_loss: 12712215.0000; val_optim_loss: 12712215.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9698; val_auprc_score: 0.9589; val_best_acc_score: 0.9214; val_best_f1_score: 0.9251; train_kl_reg_loss: 96888.9462; train_edge_recon_loss: 2749441.5556; train_gene_expr_recon_loss: 217831.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9566715.3333; train_global_loss: 12630876.8889; train_optim_loss: 12630876.8889; val_kl_reg_loss: 75152.7969; val_edge_recon_loss: 2732388.5000; val_gene_expr_recon_loss: 215578.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9680766.0000; val_global_loss: 12703886.0000; val_optim_loss: 12703886.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9658; val_auprc_score: 0.9490; val_best_acc_score: 0.9174; val_best_f1_score: 0.9216; train_kl_reg_loss: 97175.4835; train_edge_recon_loss: 2741353.9444; train_gene_expr_recon_loss: 216867.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9578178.4444; train_global_loss: 12633575.6667; train_optim_loss: 12633575.6667; val_kl_reg_loss: 75448.2031; val_edge_recon_loss: 2765788.7500; val_gene_expr_recon_loss: 215613.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9695161.0000; val_global_loss: 12752011.0000; val_optim_loss: 12752011.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9721; val_auprc_score: 0.9624; val_best_acc_score: 0.9255; val_best_f1_score: 0.9287; train_kl_reg_loss: 97028.4783; train_edge_recon_loss: 2743774.8611; train_gene_expr_recon_loss: 216107.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9542043.7778; train_global_loss: 12598954.2222; train_optim_loss: 12598954.2222; val_kl_reg_loss: 75522.8281; val_edge_recon_loss: 2731421.2500; val_gene_expr_recon_loss: 215732.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9686388.0000; val_global_loss: 12709064.0000; val_optim_loss: 12709064.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9626; val_auprc_score: 0.9472; val_best_acc_score: 0.9150; val_best_f1_score: 0.9192; train_kl_reg_loss: 97226.5035; train_edge_recon_loss: 2756265.3056; train_gene_expr_recon_loss: 216866.4149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9558764.3333; train_global_loss: 12629122.5556; train_optim_loss: 12629122.5556; val_kl_reg_loss: 75713.0625; val_edge_recon_loss: 2770837.2500; val_gene_expr_recon_loss: 215682.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9694307.0000; val_global_loss: 12756540.0000; val_optim_loss: 12756540.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9643; val_auprc_score: 0.9505; val_best_acc_score: 0.9162; val_best_f1_score: 0.9205; train_kl_reg_loss: 96847.7370; train_edge_recon_loss: 2740074.2500; train_gene_expr_recon_loss: 217335.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9606061.3333; train_global_loss: 12660319.4444; train_optim_loss: 12660319.4444; val_kl_reg_loss: 75369.8203; val_edge_recon_loss: 2780880.0000; val_gene_expr_recon_loss: 215574.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9688124.0000; val_global_loss: 12759948.0000; val_optim_loss: 12759948.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9654; val_auprc_score: 0.9522; val_best_acc_score: 0.9192; val_best_f1_score: 0.9230; train_kl_reg_loss: 96896.7769; train_edge_recon_loss: 2744813.0556; train_gene_expr_recon_loss: 216488.1684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9585644.1111; train_global_loss: 12643842.2222; train_optim_loss: 12643842.2222; val_kl_reg_loss: 75435.5859; val_edge_recon_loss: 2752006.2500; val_gene_expr_recon_loss: 215659.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9689831.0000; val_global_loss: 12732932.0000; val_optim_loss: 12732932.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9704; val_auprc_score: 0.9605; val_best_acc_score: 0.9224; val_best_f1_score: 0.9260; train_kl_reg_loss: 97086.8498; train_edge_recon_loss: 2741192.4444; train_gene_expr_recon_loss: 215490.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9572522.1111; train_global_loss: 12626291.7778; train_optim_loss: 12626291.7778; val_kl_reg_loss: 75148.3047; val_edge_recon_loss: 2748944.2500; val_gene_expr_recon_loss: 215615.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9686500.0000; val_global_loss: 12726208.0000; val_optim_loss: 12726208.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9672; val_auprc_score: 0.9553; val_best_acc_score: 0.9188; val_best_f1_score: 0.9228; train_kl_reg_loss: 97198.9497; train_edge_recon_loss: 2735232.1111; train_gene_expr_recon_loss: 217307.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628422.6667; train_global_loss: 12678160.8889; train_optim_loss: 12678160.8889; val_kl_reg_loss: 75234.3906; val_edge_recon_loss: 2749241.2500; val_gene_expr_recon_loss: 215606.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9687418.0000; val_global_loss: 12727500.0000; val_optim_loss: 12727500.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9653; val_auprc_score: 0.9516; val_best_acc_score: 0.9178; val_best_f1_score: 0.9219; train_kl_reg_loss: 97079.6849; train_edge_recon_loss: 2745737.2500; train_gene_expr_recon_loss: 216643.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9573974.1111; train_global_loss: 12633434.1111; train_optim_loss: 12633434.1111; val_kl_reg_loss: 75556.0234; val_edge_recon_loss: 2752988.0000; val_gene_expr_recon_loss: 215697.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9699007.0000; val_global_loss: 12743249.0000; val_optim_loss: 12743249.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 16 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
Val AUROC score: 0.9687
Val AUPRC score: 0.9557
Val best accuracy score: 0.9216
Val best F1 score: 0.9252
Val gene expr MSE score: 0.5620
Val chrom access MSE score: 0.0878
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
