[True]
Run timestamp: 26072023_233304_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8656; val_auprc_score: 0.9719; val_best_acc_score: 0.8612; val_best_f1_score: 0.9247; train_kl_reg_loss: 91961.2621; train_edge_recon_loss: 1083267.2549; train_gene_expr_recon_loss: 1683387.4512; train_masked_gp_l1_reg_loss: 6943.2068; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2865559.1721; train_optim_loss: 2865559.1721; val_kl_reg_loss: 75943.5915; val_edge_recon_loss: 1190245.4193; val_gene_expr_recon_loss: 1096507.3229; val_masked_gp_l1_reg_loss: 6634.9404; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2369331.3438; val_optim_loss: 2369331.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8734; val_auprc_score: 0.9721; val_best_acc_score: 0.8783; val_best_f1_score: 0.9328; train_kl_reg_loss: 67531.5544; train_edge_recon_loss: 1055544.7962; train_gene_expr_recon_loss: 1056525.1128; train_masked_gp_l1_reg_loss: 6545.7515; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2186147.2116; train_optim_loss: 2186147.2116; val_kl_reg_loss: 53057.8394; val_edge_recon_loss: 1184016.1120; val_gene_expr_recon_loss: 1020349.8021; val_masked_gp_l1_reg_loss: 6642.2700; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2264066.0312; val_optim_loss: 2264066.0312
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8592; val_auprc_score: 0.9688; val_best_acc_score: 0.8920; val_best_f1_score: 0.9396; train_kl_reg_loss: 53847.9188; train_edge_recon_loss: 1004269.1206; train_gene_expr_recon_loss: 1002541.5436; train_masked_gp_l1_reg_loss: 6884.0885; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2067542.6674; train_optim_loss: 2067542.6674; val_kl_reg_loss: 59681.6460; val_edge_recon_loss: 954642.4740; val_gene_expr_recon_loss: 983724.6068; val_masked_gp_l1_reg_loss: 7242.5303; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2005291.2240; val_optim_loss: 2005291.2240
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8597; val_auprc_score: 0.9678; val_best_acc_score: 0.9027; val_best_f1_score: 0.9456; train_kl_reg_loss: 58362.7628; train_edge_recon_loss: 916535.6363; train_gene_expr_recon_loss: 965480.3506; train_masked_gp_l1_reg_loss: 7676.9733; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1948055.7163; train_optim_loss: 1948055.7163; val_kl_reg_loss: 51479.9717; val_edge_recon_loss: 919219.2422; val_gene_expr_recon_loss: 945369.8464; val_masked_gp_l1_reg_loss: 8086.6577; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1924155.6823; val_optim_loss: 1924155.6823
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8839; val_auprc_score: 0.9731; val_best_acc_score: 0.9067; val_best_f1_score: 0.9475; train_kl_reg_loss: 50474.0120; train_edge_recon_loss: 889093.5131; train_gene_expr_recon_loss: 933470.8151; train_masked_gp_l1_reg_loss: 8431.9060; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1881470.2465; train_optim_loss: 1881470.2465; val_kl_reg_loss: 45980.4894; val_edge_recon_loss: 909939.4036; val_gene_expr_recon_loss: 919802.5677; val_masked_gp_l1_reg_loss: 8752.4707; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1884474.9635; val_optim_loss: 1884474.9635
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9091; val_auprc_score: 0.9797; val_best_acc_score: 0.9245; val_best_f1_score: 0.9566; train_kl_reg_loss: 47343.0882; train_edge_recon_loss: 853074.7657; train_gene_expr_recon_loss: 907262.0677; train_masked_gp_l1_reg_loss: 9057.1224; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1816737.0401; train_optim_loss: 1816737.0401; val_kl_reg_loss: 45006.1924; val_edge_recon_loss: 874921.8021; val_gene_expr_recon_loss: 894230.0260; val_masked_gp_l1_reg_loss: 9379.1270; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1823537.1406; val_optim_loss: 1823537.1406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9117; val_auprc_score: 0.9801; val_best_acc_score: 0.9278; val_best_f1_score: 0.9587; train_kl_reg_loss: 44368.2965; train_edge_recon_loss: 837756.8988; train_gene_expr_recon_loss: 883145.4672; train_masked_gp_l1_reg_loss: 9667.2373; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1774937.8988; train_optim_loss: 1774937.8988; val_kl_reg_loss: 41220.3268; val_edge_recon_loss: 827912.6823; val_gene_expr_recon_loss: 872168.2839; val_masked_gp_l1_reg_loss: 9944.4248; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1751245.6667; val_optim_loss: 1751245.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9222; val_auprc_score: 0.9829; val_best_acc_score: 0.9281; val_best_f1_score: 0.9588; train_kl_reg_loss: 39220.0212; train_edge_recon_loss: 830397.2442; train_gene_expr_recon_loss: 862518.9480; train_masked_gp_l1_reg_loss: 10181.5972; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1742317.8163; train_optim_loss: 1742317.8163; val_kl_reg_loss: 35314.1672; val_edge_recon_loss: 826779.4870; val_gene_expr_recon_loss: 854825.1927; val_masked_gp_l1_reg_loss: 10403.1787; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1727321.9583; val_optim_loss: 1727321.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9276; val_auprc_score: 0.9827; val_best_acc_score: 0.9291; val_best_f1_score: 0.9592; train_kl_reg_loss: 34854.3540; train_edge_recon_loss: 818345.0497; train_gene_expr_recon_loss: 844028.4116; train_masked_gp_l1_reg_loss: 10584.4211; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1707812.2390; train_optim_loss: 1707812.2390; val_kl_reg_loss: 32484.4753; val_edge_recon_loss: 845910.7969; val_gene_expr_recon_loss: 835211.5911; val_masked_gp_l1_reg_loss: 10756.6680; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1724363.4792; val_optim_loss: 1724363.4792
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9359; val_auprc_score: 0.9860; val_best_acc_score: 0.9338; val_best_f1_score: 0.9620; train_kl_reg_loss: 30736.8411; train_edge_recon_loss: 815423.3674; train_gene_expr_recon_loss: 828162.5759; train_masked_gp_l1_reg_loss: 10862.3188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1685185.1099; train_optim_loss: 1685185.1099; val_kl_reg_loss: 27543.8136; val_edge_recon_loss: 813856.6016; val_gene_expr_recon_loss: 820195.7422; val_masked_gp_l1_reg_loss: 10932.9844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1672529.1562; val_optim_loss: 1672529.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9339; val_auprc_score: 0.9851; val_best_acc_score: 0.9364; val_best_f1_score: 0.9634; train_kl_reg_loss: 26607.3488; train_edge_recon_loss: 801545.7497; train_gene_expr_recon_loss: 815007.2235; train_masked_gp_l1_reg_loss: 10972.6467; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1654132.9634; train_optim_loss: 1654132.9634; val_kl_reg_loss: 23979.5895; val_edge_recon_loss: 810785.6172; val_gene_expr_recon_loss: 808200.7578; val_masked_gp_l1_reg_loss: 10986.5186; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1653952.4583; val_optim_loss: 1653952.4583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9447; val_auprc_score: 0.9881; val_best_acc_score: 0.9398; val_best_f1_score: 0.9655; train_kl_reg_loss: 23822.0851; train_edge_recon_loss: 796736.4657; train_gene_expr_recon_loss: 803254.9241; train_masked_gp_l1_reg_loss: 10941.3123; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1634754.7866; train_optim_loss: 1634754.7866; val_kl_reg_loss: 22075.2454; val_edge_recon_loss: 777761.0911; val_gene_expr_recon_loss: 798003.3333; val_masked_gp_l1_reg_loss: 10881.8848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1608721.5417; val_optim_loss: 1608721.5417
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9394; val_auprc_score: 0.9863; val_best_acc_score: 0.9341; val_best_f1_score: 0.9621; train_kl_reg_loss: 21541.1222; train_edge_recon_loss: 790017.8956; train_gene_expr_recon_loss: 792627.1523; train_masked_gp_l1_reg_loss: 10768.0310; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1614954.1959; train_optim_loss: 1614954.1959; val_kl_reg_loss: 19112.4250; val_edge_recon_loss: 827856.3464; val_gene_expr_recon_loss: 788137.9635; val_masked_gp_l1_reg_loss: 10635.3076; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1645741.9792; val_optim_loss: 1645741.9792
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9509; val_auprc_score: 0.9889; val_best_acc_score: 0.9421; val_best_f1_score: 0.9664; train_kl_reg_loss: 19053.7349; train_edge_recon_loss: 795426.2744; train_gene_expr_recon_loss: 783996.2849; train_masked_gp_l1_reg_loss: 10475.4548; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1608951.7500; train_optim_loss: 1608951.7500; val_kl_reg_loss: 17385.5162; val_edge_recon_loss: 799878.5339; val_gene_expr_recon_loss: 777811.5078; val_masked_gp_l1_reg_loss: 10291.6230; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1605367.1771; val_optim_loss: 1605367.1771
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9549; val_auprc_score: 0.9903; val_best_acc_score: 0.9429; val_best_f1_score: 0.9670; train_kl_reg_loss: 17356.9793; train_edge_recon_loss: 785968.0738; train_gene_expr_recon_loss: 774635.2203; train_masked_gp_l1_reg_loss: 10099.3198; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1588059.6006; train_optim_loss: 1588059.6006; val_kl_reg_loss: 14811.2107; val_edge_recon_loss: 783183.2109; val_gene_expr_recon_loss: 771147.8385; val_masked_gp_l1_reg_loss: 9921.5713; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1579063.8854; val_optim_loss: 1579063.8854
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9558; val_auprc_score: 0.9896; val_best_acc_score: 0.9472; val_best_f1_score: 0.9694; train_kl_reg_loss: 15637.3644; train_edge_recon_loss: 777334.0677; train_gene_expr_recon_loss: 767166.6506; train_masked_gp_l1_reg_loss: 9691.0245; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1569829.1052; train_optim_loss: 1569829.1052; val_kl_reg_loss: 13886.1488; val_edge_recon_loss: 767972.8464; val_gene_expr_recon_loss: 763216.1016; val_masked_gp_l1_reg_loss: 9479.0312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554554.1094; val_optim_loss: 1554554.1094
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9538; val_auprc_score: 0.9886; val_best_acc_score: 0.9431; val_best_f1_score: 0.9670; train_kl_reg_loss: 14570.7800; train_edge_recon_loss: 776462.6788; train_gene_expr_recon_loss: 760065.6427; train_masked_gp_l1_reg_loss: 9243.0909; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1560342.1930; train_optim_loss: 1560342.1930; val_kl_reg_loss: 14289.8466; val_edge_recon_loss: 802740.2760; val_gene_expr_recon_loss: 757449.0052; val_masked_gp_l1_reg_loss: 9030.1582; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1583509.2656; val_optim_loss: 1583509.2656
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9616; val_auprc_score: 0.9908; val_best_acc_score: 0.9495; val_best_f1_score: 0.9708; train_kl_reg_loss: 13654.7584; train_edge_recon_loss: 777782.1323; train_gene_expr_recon_loss: 754049.0131; train_masked_gp_l1_reg_loss: 8799.6740; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1554285.5773; train_optim_loss: 1554285.5773; val_kl_reg_loss: 12629.7798; val_edge_recon_loss: 779826.1536; val_gene_expr_recon_loss: 751791.9870; val_masked_gp_l1_reg_loss: 8554.4688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1552802.4271; val_optim_loss: 1552802.4271
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9590; val_auprc_score: 0.9902; val_best_acc_score: 0.9504; val_best_f1_score: 0.9712; train_kl_reg_loss: 12802.1410; train_edge_recon_loss: 778757.6953; train_gene_expr_recon_loss: 748152.7407; train_masked_gp_l1_reg_loss: 8364.0611; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1548076.6424; train_optim_loss: 1548076.6424; val_kl_reg_loss: 12440.4748; val_edge_recon_loss: 784740.7266; val_gene_expr_recon_loss: 746899.8047; val_masked_gp_l1_reg_loss: 8152.3818; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1552233.3750; val_optim_loss: 1552233.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9569; val_auprc_score: 0.9903; val_best_acc_score: 0.9521; val_best_f1_score: 0.9723; train_kl_reg_loss: 12335.2292; train_edge_recon_loss: 768379.1695; train_gene_expr_recon_loss: 743522.8526; train_masked_gp_l1_reg_loss: 7976.3916; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1532213.6424; train_optim_loss: 1532213.6424; val_kl_reg_loss: 11338.3906; val_edge_recon_loss: 784634.4714; val_gene_expr_recon_loss: 740758.8047; val_masked_gp_l1_reg_loss: 7802.8359; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1544534.5469; val_optim_loss: 1544534.5469
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9576; val_auprc_score: 0.9900; val_best_acc_score: 0.9510; val_best_f1_score: 0.9715; train_kl_reg_loss: 11731.7923; train_edge_recon_loss: 768920.2660; train_gene_expr_recon_loss: 738874.0773; train_masked_gp_l1_reg_loss: 7635.3797; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1527161.5110; train_optim_loss: 1527161.5110; val_kl_reg_loss: 11544.0891; val_edge_recon_loss: 802344.5130; val_gene_expr_recon_loss: 737096.2083; val_masked_gp_l1_reg_loss: 7475.6396; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1558460.4375; val_optim_loss: 1558460.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9631; val_auprc_score: 0.9913; val_best_acc_score: 0.9555; val_best_f1_score: 0.9742; train_kl_reg_loss: 11631.6675; train_edge_recon_loss: 777659.5648; train_gene_expr_recon_loss: 734646.5218; train_masked_gp_l1_reg_loss: 7312.0966; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1531249.8500; train_optim_loss: 1531249.8500; val_kl_reg_loss: 11156.1776; val_edge_recon_loss: 772788.9583; val_gene_expr_recon_loss: 732862.9792; val_masked_gp_l1_reg_loss: 7176.2686; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1523984.3750; val_optim_loss: 1523984.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9651; val_auprc_score: 0.9924; val_best_acc_score: 0.9534; val_best_f1_score: 0.9730; train_kl_reg_loss: 11431.5417; train_edge_recon_loss: 775103.9015; train_gene_expr_recon_loss: 730917.2669; train_masked_gp_l1_reg_loss: 7041.2267; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1524493.9407; train_optim_loss: 1524493.9407; val_kl_reg_loss: 11112.8903; val_edge_recon_loss: 790046.4609; val_gene_expr_recon_loss: 729042.8594; val_masked_gp_l1_reg_loss: 6912.8135; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537115.0833; val_optim_loss: 1537115.0833
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9630; val_auprc_score: 0.9898; val_best_acc_score: 0.9533; val_best_f1_score: 0.9727; train_kl_reg_loss: 11202.1119; train_edge_recon_loss: 770072.7299; train_gene_expr_recon_loss: 727063.0674; train_masked_gp_l1_reg_loss: 6794.4072; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1515132.3116; train_optim_loss: 1515132.3116; val_kl_reg_loss: 10869.8506; val_edge_recon_loss: 801355.2083; val_gene_expr_recon_loss: 725625.7604; val_masked_gp_l1_reg_loss: 6672.6636; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1544523.4531; val_optim_loss: 1544523.4531
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9674; val_auprc_score: 0.9917; val_best_acc_score: 0.9588; val_best_f1_score: 0.9759; train_kl_reg_loss: 11109.0064; train_edge_recon_loss: 763080.3244; train_gene_expr_recon_loss: 724116.3747; train_masked_gp_l1_reg_loss: 6576.9919; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504882.7128; train_optim_loss: 1504882.7128; val_kl_reg_loss: 10520.3801; val_edge_recon_loss: 792475.0859; val_gene_expr_recon_loss: 722926.5677; val_masked_gp_l1_reg_loss: 6469.7144; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1532391.7865; val_optim_loss: 1532391.7865
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9643; val_auprc_score: 0.9904; val_best_acc_score: 0.9579; val_best_f1_score: 0.9755; train_kl_reg_loss: 8713.7205; train_edge_recon_loss: 765944.6049; train_gene_expr_recon_loss: 745292.6279; train_masked_gp_l1_reg_loss: 6616.1977; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1526567.1488; train_optim_loss: 1526567.1488; val_kl_reg_loss: 4844.2605; val_edge_recon_loss: 781087.0443; val_gene_expr_recon_loss: 739205.4375; val_masked_gp_l1_reg_loss: 6499.4150; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1531636.1250; val_optim_loss: 1531636.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9634; val_auprc_score: 0.9913; val_best_acc_score: 0.9558; val_best_f1_score: 0.9744; train_kl_reg_loss: 7899.1061; train_edge_recon_loss: 768367.3718; train_gene_expr_recon_loss: 737574.5317; train_masked_gp_l1_reg_loss: 6457.8513; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520298.8605; train_optim_loss: 1520298.8605; val_kl_reg_loss: 4975.9837; val_edge_recon_loss: 773373.4089; val_gene_expr_recon_loss: 737785.1901; val_masked_gp_l1_reg_loss: 6443.3301; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522577.9635; val_optim_loss: 1522577.9635
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9629; val_auprc_score: 0.9907; val_best_acc_score: 0.9545; val_best_f1_score: 0.9736; train_kl_reg_loss: 7836.0826; train_edge_recon_loss: 761059.2811; train_gene_expr_recon_loss: 736795.4328; train_masked_gp_l1_reg_loss: 6426.3266; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512117.1227; train_optim_loss: 1512117.1227; val_kl_reg_loss: 4870.8874; val_edge_recon_loss: 795032.5911; val_gene_expr_recon_loss: 736613.2266; val_masked_gp_l1_reg_loss: 6410.8105; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1542927.4479; val_optim_loss: 1542927.4479
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9608; val_auprc_score: 0.9907; val_best_acc_score: 0.9548; val_best_f1_score: 0.9738; train_kl_reg_loss: 7757.4808; train_edge_recon_loss: 764011.8596; train_gene_expr_recon_loss: 736122.0567; train_masked_gp_l1_reg_loss: 6392.9743; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514284.3762; train_optim_loss: 1514284.3762; val_kl_reg_loss: 4849.1623; val_edge_recon_loss: 789141.5964; val_gene_expr_recon_loss: 735755.4115; val_masked_gp_l1_reg_loss: 6375.1299; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1536121.2917; val_optim_loss: 1536121.2917
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9632; val_auprc_score: 0.9916; val_best_acc_score: 0.9556; val_best_f1_score: 0.9744; train_kl_reg_loss: 7543.8884; train_edge_recon_loss: 764020.2227; train_gene_expr_recon_loss: 735587.6247; train_masked_gp_l1_reg_loss: 6362.6292; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513514.3669; train_optim_loss: 1513514.3669; val_kl_reg_loss: 4729.9950; val_edge_recon_loss: 760778.5208; val_gene_expr_recon_loss: 735735.6510; val_masked_gp_l1_reg_loss: 6351.5205; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507595.6875; val_optim_loss: 1507595.6875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9653; val_auprc_score: 0.9911; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 7456.9364; train_edge_recon_loss: 765992.9468; train_gene_expr_recon_loss: 735170.5334; train_masked_gp_l1_reg_loss: 6334.9618; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514955.3814; train_optim_loss: 1514955.3814; val_kl_reg_loss: 4689.0005; val_edge_recon_loss: 781904.0833; val_gene_expr_recon_loss: 735437.1979; val_masked_gp_l1_reg_loss: 6318.4307; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1528348.6615; val_optim_loss: 1528348.6615
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9685; val_auprc_score: 0.9924; val_best_acc_score: 0.9555; val_best_f1_score: 0.9740; train_kl_reg_loss: 7327.4755; train_edge_recon_loss: 758260.9265; train_gene_expr_recon_loss: 734633.0608; train_masked_gp_l1_reg_loss: 6302.3631; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506523.8262; train_optim_loss: 1506523.8262; val_kl_reg_loss: 4697.1842; val_edge_recon_loss: 804129.7526; val_gene_expr_recon_loss: 734639.3151; val_masked_gp_l1_reg_loss: 6283.9072; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549750.1458; val_optim_loss: 1549750.1458
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9626; val_auprc_score: 0.9917; val_best_acc_score: 0.9569; val_best_f1_score: 0.9752; train_kl_reg_loss: 7294.2449; train_edge_recon_loss: 764441.8552; train_gene_expr_recon_loss: 734454.0038; train_masked_gp_l1_reg_loss: 6261.4761; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512451.5779; train_optim_loss: 1512451.5779; val_kl_reg_loss: 4704.9700; val_edge_recon_loss: 745113.7734; val_gene_expr_recon_loss: 734289.5964; val_masked_gp_l1_reg_loss: 6243.4785; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1490351.8385; val_optim_loss: 1490351.8385
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9635; val_auprc_score: 0.9912; val_best_acc_score: 0.9550; val_best_f1_score: 0.9738; train_kl_reg_loss: 7226.7129; train_edge_recon_loss: 757895.2497; train_gene_expr_recon_loss: 734119.6657; train_masked_gp_l1_reg_loss: 6220.9000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505462.5285; train_optim_loss: 1505462.5285; val_kl_reg_loss: 4666.1420; val_edge_recon_loss: 796070.4479; val_gene_expr_recon_loss: 734431.4193; val_masked_gp_l1_reg_loss: 6197.7949; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1541365.7604; val_optim_loss: 1541365.7604
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9673; val_auprc_score: 0.9928; val_best_acc_score: 0.9575; val_best_f1_score: 0.9754; train_kl_reg_loss: 7086.0826; train_edge_recon_loss: 760527.4381; train_gene_expr_recon_loss: 733497.7029; train_masked_gp_l1_reg_loss: 6177.7831; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507289.0076; train_optim_loss: 1507289.0076; val_kl_reg_loss: 4693.4828; val_edge_recon_loss: 758913.7031; val_gene_expr_recon_loss: 732748.8698; val_masked_gp_l1_reg_loss: 6155.3784; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502511.4375; val_optim_loss: 1502511.4375
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9644; val_auprc_score: 0.9919; val_best_acc_score: 0.9554; val_best_f1_score: 0.9742; train_kl_reg_loss: 6975.9125; train_edge_recon_loss: 763945.9535; train_gene_expr_recon_loss: 732887.5590; train_masked_gp_l1_reg_loss: 6132.6673; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509942.0890; train_optim_loss: 1509942.0890; val_kl_reg_loss: 4571.0923; val_edge_recon_loss: 775013.8307; val_gene_expr_recon_loss: 733981.9010; val_masked_gp_l1_reg_loss: 6110.7480; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1519677.5677; val_optim_loss: 1519677.5677
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9661; val_auprc_score: 0.9925; val_best_acc_score: 0.9560; val_best_f1_score: 0.9747; train_kl_reg_loss: 6909.6605; train_edge_recon_loss: 758429.5029; train_gene_expr_recon_loss: 732365.9532; train_masked_gp_l1_reg_loss: 6083.0650; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503788.1802; train_optim_loss: 1503788.1802; val_kl_reg_loss: 4562.2934; val_edge_recon_loss: 751948.1589; val_gene_expr_recon_loss: 733108.8750; val_masked_gp_l1_reg_loss: 6058.6187; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1495677.9271; val_optim_loss: 1495677.9271

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9674; val_auprc_score: 0.9923; val_best_acc_score: 0.9583; val_best_f1_score: 0.9759; train_kl_reg_loss: 6809.2627; train_edge_recon_loss: 767401.3884; train_gene_expr_recon_loss: 732127.1887; train_masked_gp_l1_reg_loss: 6051.5250; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512389.3727; train_optim_loss: 1512389.3727; val_kl_reg_loss: 4558.6061; val_edge_recon_loss: 742681.4714; val_gene_expr_recon_loss: 732545.7422; val_masked_gp_l1_reg_loss: 6048.4429; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1485834.3125; val_optim_loss: 1485834.3125
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9675; val_auprc_score: 0.9924; val_best_acc_score: 0.9570; val_best_f1_score: 0.9751; train_kl_reg_loss: 6825.5740; train_edge_recon_loss: 762896.5875; train_gene_expr_recon_loss: 732013.8392; train_masked_gp_l1_reg_loss: 6045.4289; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507781.4244; train_optim_loss: 1507781.4244; val_kl_reg_loss: 4571.3989; val_edge_recon_loss: 774012.4115; val_gene_expr_recon_loss: 732321.3880; val_masked_gp_l1_reg_loss: 6042.4629; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516947.7188; val_optim_loss: 1516947.7188
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9675; val_auprc_score: 0.9926; val_best_acc_score: 0.9573; val_best_f1_score: 0.9752; train_kl_reg_loss: 6789.9181; train_edge_recon_loss: 762656.6724; train_gene_expr_recon_loss: 731771.7215; train_masked_gp_l1_reg_loss: 6039.7542; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507258.0663; train_optim_loss: 1507258.0663; val_kl_reg_loss: 4575.7919; val_edge_recon_loss: 775062.9115; val_gene_expr_recon_loss: 732382.1432; val_masked_gp_l1_reg_loss: 6036.9160; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1518057.7240; val_optim_loss: 1518057.7240
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9662; val_auprc_score: 0.9919; val_best_acc_score: 0.9565; val_best_f1_score: 0.9747; train_kl_reg_loss: 6796.2388; train_edge_recon_loss: 762691.3765; train_gene_expr_recon_loss: 732041.7172; train_masked_gp_l1_reg_loss: 6034.0669; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507563.3988; train_optim_loss: 1507563.3988; val_kl_reg_loss: 4573.2210; val_edge_recon_loss: 786651.5625; val_gene_expr_recon_loss: 733104.2630; val_masked_gp_l1_reg_loss: 6031.0640; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1530360.1615; val_optim_loss: 1530360.1615
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9613; val_auprc_score: 0.9906; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 6745.4538; train_edge_recon_loss: 769062.5424; train_gene_expr_recon_loss: 732023.3081; train_masked_gp_l1_reg_loss: 6028.1293; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513859.4419; train_optim_loss: 1513859.4419; val_kl_reg_loss: 4536.7930; val_edge_recon_loss: 772231.4323; val_gene_expr_recon_loss: 732694.8281; val_masked_gp_l1_reg_loss: 6025.1191; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1515488.1771; val_optim_loss: 1515488.1771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9647; val_auprc_score: 0.9919; val_best_acc_score: 0.9566; val_best_f1_score: 0.9748; train_kl_reg_loss: 6733.0019; train_edge_recon_loss: 767710.0927; train_gene_expr_recon_loss: 731585.2157; train_masked_gp_l1_reg_loss: 6024.2047; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512052.5151; train_optim_loss: 1512052.5151; val_kl_reg_loss: 4543.6598; val_edge_recon_loss: 780470.6979; val_gene_expr_recon_loss: 732796.4922; val_masked_gp_l1_reg_loss: 6023.7148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1523834.5938; val_optim_loss: 1523834.5938
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9637; val_auprc_score: 0.9917; val_best_acc_score: 0.9549; val_best_f1_score: 0.9740; train_kl_reg_loss: 6736.2333; train_edge_recon_loss: 769923.8741; train_gene_expr_recon_loss: 731702.8794; train_masked_gp_l1_reg_loss: 6023.3376; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514386.3256; train_optim_loss: 1514386.3256; val_kl_reg_loss: 4545.5526; val_edge_recon_loss: 773338.9089; val_gene_expr_recon_loss: 732647.7083; val_masked_gp_l1_reg_loss: 6022.9419; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516555.1667; val_optim_loss: 1516555.1667
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9640; val_auprc_score: 0.9914; val_best_acc_score: 0.9563; val_best_f1_score: 0.9747; train_kl_reg_loss: 6738.0888; train_edge_recon_loss: 767621.6689; train_gene_expr_recon_loss: 731860.2826; train_masked_gp_l1_reg_loss: 6022.5613; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512242.6064; train_optim_loss: 1512242.6064; val_kl_reg_loss: 4558.3279; val_edge_recon_loss: 763231.3594; val_gene_expr_recon_loss: 732206.8359; val_masked_gp_l1_reg_loss: 6022.1621; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506018.6562; val_optim_loss: 1506018.6562
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9661; val_auprc_score: 0.9918; val_best_acc_score: 0.9561; val_best_f1_score: 0.9746; train_kl_reg_loss: 6732.3738; train_edge_recon_loss: 769142.5270; train_gene_expr_recon_loss: 731681.9936; train_masked_gp_l1_reg_loss: 6021.7893; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513578.6866; train_optim_loss: 1513578.6866; val_kl_reg_loss: 4552.9879; val_edge_recon_loss: 773843.5208; val_gene_expr_recon_loss: 731990.4193; val_masked_gp_l1_reg_loss: 6021.3501; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516408.3073; val_optim_loss: 1516408.3073

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 56 min 15 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9666
Val AUPRC score: 0.9920
Val best accuracy score: 0.9597
Val best F1 score: 0.9765
Val gene expr MSE score: 21260.9309
Val cat covariate0 mean sim diff: 0.0010

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
