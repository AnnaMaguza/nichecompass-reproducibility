[True]
Run timestamp: 08082023_050524_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9186; val_auprc_score: 0.9836; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 187766.6554; train_edge_recon_loss: 1131500.2506; train_gene_expr_recon_loss: 3996637.1394; train_masked_gp_l1_reg_loss: 10867.0544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176822.1098; train_global_loss: 5503593.2308; train_optim_loss: 5503593.2308; val_kl_reg_loss: 139022.4596; val_edge_recon_loss: 1193661.5938; val_gene_expr_recon_loss: 2526642.5000; val_masked_gp_l1_reg_loss: 11119.6963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168946.0625; val_global_loss: 4039392.2708; val_optim_loss: 4039392.2708
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9250; val_auprc_score: 0.9849; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 206798.6412; train_edge_recon_loss: 1161976.7837; train_gene_expr_recon_loss: 2788751.9591; train_masked_gp_l1_reg_loss: 10726.9989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158311.3098; train_global_loss: 4326565.7019; train_optim_loss: 4326565.7019; val_kl_reg_loss: 172074.1133; val_edge_recon_loss: 1186769.7604; val_gene_expr_recon_loss: 2596476.8125; val_masked_gp_l1_reg_loss: 10326.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147115.5469; val_global_loss: 4112762.2292; val_optim_loss: 4112762.2292
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9193; val_auprc_score: 0.9840; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 151138.1549; train_edge_recon_loss: 1133443.4002; train_gene_expr_recon_loss: 2846253.5000; train_masked_gp_l1_reg_loss: 10435.1820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136432.6865; train_global_loss: 4277702.9303; train_optim_loss: 4277702.9303; val_kl_reg_loss: 111753.4518; val_edge_recon_loss: 1204201.6354; val_gene_expr_recon_loss: 2682068.0625; val_masked_gp_l1_reg_loss: 10617.9473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126012.0312; val_global_loss: 4134653.1250; val_optim_loss: 4134653.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9174; val_auprc_score: 0.9841; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 96629.7438; train_edge_recon_loss: 1092265.2710; train_gene_expr_recon_loss: 2640484.1611; train_masked_gp_l1_reg_loss: 10608.0393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116825.2573; train_global_loss: 3956812.4663; train_optim_loss: 3956812.4663; val_kl_reg_loss: 84159.3815; val_edge_recon_loss: 1187264.2604; val_gene_expr_recon_loss: 2585550.4792; val_masked_gp_l1_reg_loss: 10598.9355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107943.7812; val_global_loss: 3975516.8958; val_optim_loss: 3975516.8958
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9084; val_auprc_score: 0.9819; val_best_acc_score: 0.8554; val_best_f1_score: 0.9216; train_kl_reg_loss: 81575.4755; train_edge_recon_loss: 1075697.2097; train_gene_expr_recon_loss: 2546922.9784; train_masked_gp_l1_reg_loss: 10545.3750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100185.1283; train_global_loss: 3814926.1659; train_optim_loss: 3814926.1659; val_kl_reg_loss: 70601.5938; val_edge_recon_loss: 1214499.4688; val_gene_expr_recon_loss: 2482206.3333; val_masked_gp_l1_reg_loss: 10534.9902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92894.9609; val_global_loss: 3870737.3958; val_optim_loss: 3870737.3958
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8916; val_auprc_score: 0.9779; val_best_acc_score: 0.8649; val_best_f1_score: 0.9261; train_kl_reg_loss: 69992.0623; train_edge_recon_loss: 1060497.4820; train_gene_expr_recon_loss: 2415456.8389; train_masked_gp_l1_reg_loss: 10564.0682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86840.8619; train_global_loss: 3643351.2957; train_optim_loss: 3643351.2957; val_kl_reg_loss: 63961.7057; val_edge_recon_loss: 1200848.7917; val_gene_expr_recon_loss: 2307055.9792; val_masked_gp_l1_reg_loss: 10600.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81075.2656; val_global_loss: 3663541.9792; val_optim_loss: 3663541.9792
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8771; val_auprc_score: 0.9729; val_best_acc_score: 0.8884; val_best_f1_score: 0.9348; train_kl_reg_loss: 62202.5337; train_edge_recon_loss: 1051943.2849; train_gene_expr_recon_loss: 2218322.2716; train_masked_gp_l1_reg_loss: 10690.1064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76357.1732; train_global_loss: 3419515.3798; train_optim_loss: 3419515.3798; val_kl_reg_loss: 59128.9355; val_edge_recon_loss: 1183471.3542; val_gene_expr_recon_loss: 2163737.3542; val_masked_gp_l1_reg_loss: 10734.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71828.0859; val_global_loss: 3488899.6667; val_optim_loss: 3488899.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8778; val_auprc_score: 0.9706; val_best_acc_score: 0.9075; val_best_f1_score: 0.9475; train_kl_reg_loss: 56118.7568; train_edge_recon_loss: 1041815.6154; train_gene_expr_recon_loss: 2152087.1202; train_masked_gp_l1_reg_loss: 10777.8004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67923.0477; train_global_loss: 3328722.3293; train_optim_loss: 3328722.3293; val_kl_reg_loss: 50987.7594; val_edge_recon_loss: 1090741.3385; val_gene_expr_recon_loss: 2129335.5833; val_masked_gp_l1_reg_loss: 10843.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64181.1406; val_global_loss: 3346088.9375; val_optim_loss: 3346088.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8731; val_auprc_score: 0.9697; val_best_acc_score: 0.9070; val_best_f1_score: 0.9474; train_kl_reg_loss: 56087.6361; train_edge_recon_loss: 985652.1022; train_gene_expr_recon_loss: 2121525.6370; train_masked_gp_l1_reg_loss: 10986.6207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60967.1600; train_global_loss: 3235219.1538; train_optim_loss: 3235219.1538; val_kl_reg_loss: 60461.7594; val_edge_recon_loss: 964904.6615; val_gene_expr_recon_loss: 2101362.6458; val_masked_gp_l1_reg_loss: 11153.7744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57884.0664; val_global_loss: 3195766.8125; val_optim_loss: 3195766.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8768; val_auprc_score: 0.9708; val_best_acc_score: 0.9064; val_best_f1_score: 0.9472; train_kl_reg_loss: 62594.1005; train_edge_recon_loss: 943474.0084; train_gene_expr_recon_loss: 2092723.3714; train_masked_gp_l1_reg_loss: 11314.2382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55234.3334; train_global_loss: 3165340.0673; train_optim_loss: 3165340.0673; val_kl_reg_loss: 60553.1032; val_edge_recon_loss: 937475.4271; val_gene_expr_recon_loss: 2072572.4792; val_masked_gp_l1_reg_loss: 11466.9053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52678.8242; val_global_loss: 3134746.7292; val_optim_loss: 3134746.7292
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8691; val_auprc_score: 0.9697; val_best_acc_score: 0.9076; val_best_f1_score: 0.9480; train_kl_reg_loss: 59980.9623; train_edge_recon_loss: 926860.0823; train_gene_expr_recon_loss: 2066394.0974; train_masked_gp_l1_reg_loss: 11607.7708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50491.8925; train_global_loss: 3115334.8077; train_optim_loss: 3115334.8077; val_kl_reg_loss: 57093.5462; val_edge_recon_loss: 916549.4688; val_gene_expr_recon_loss: 2048256.6458; val_masked_gp_l1_reg_loss: 11746.6738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48383.7148; val_global_loss: 3082030.1458; val_optim_loss: 3082030.1458
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8724; val_auprc_score: 0.9704; val_best_acc_score: 0.9089; val_best_f1_score: 0.9489; train_kl_reg_loss: 56256.7918; train_edge_recon_loss: 910844.0024; train_gene_expr_recon_loss: 2040887.3510; train_masked_gp_l1_reg_loss: 11877.3478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46532.1084; train_global_loss: 3066397.6106; train_optim_loss: 3066397.6106; val_kl_reg_loss: 53640.8385; val_edge_recon_loss: 913825.6615; val_gene_expr_recon_loss: 2022295.3229; val_masked_gp_l1_reg_loss: 12007.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44760.7578; val_global_loss: 3046530.0833; val_optim_loss: 3046530.0833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8744; val_auprc_score: 0.9715; val_best_acc_score: 0.9102; val_best_f1_score: 0.9497; train_kl_reg_loss: 52463.8121; train_edge_recon_loss: 905867.3612; train_gene_expr_recon_loss: 2016344.9291; train_masked_gp_l1_reg_loss: 12123.4271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43144.5787; train_global_loss: 3029944.1010; train_optim_loss: 3029944.1010; val_kl_reg_loss: 49054.0837; val_edge_recon_loss: 897324.4010; val_gene_expr_recon_loss: 1999742.2292; val_masked_gp_l1_reg_loss: 12234.8418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41540.6445; val_global_loss: 2999896.2083; val_optim_loss: 2999896.2083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8745; val_auprc_score: 0.9716; val_best_acc_score: 0.9103; val_best_f1_score: 0.9496; train_kl_reg_loss: 48328.5750; train_edge_recon_loss: 894669.0415; train_gene_expr_recon_loss: 1992453.5060; train_masked_gp_l1_reg_loss: 12338.8775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40083.6478; train_global_loss: 2987873.6346; train_optim_loss: 2987873.6346; val_kl_reg_loss: 45137.1048; val_edge_recon_loss: 897913.0938; val_gene_expr_recon_loss: 1976824.5833; val_masked_gp_l1_reg_loss: 12445.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38673.2578; val_global_loss: 2970993.7708; val_optim_loss: 2970993.7708
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8807; val_auprc_score: 0.9735; val_best_acc_score: 0.9132; val_best_f1_score: 0.9512; train_kl_reg_loss: 44061.9174; train_edge_recon_loss: 891997.6004; train_gene_expr_recon_loss: 1969880.8918; train_masked_gp_l1_reg_loss: 12552.8068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37384.3667; train_global_loss: 2955877.5817; train_optim_loss: 2955877.5817; val_kl_reg_loss: 41267.2493; val_edge_recon_loss: 879944.1771; val_gene_expr_recon_loss: 1955411.7396; val_masked_gp_l1_reg_loss: 12663.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36154.2148; val_global_loss: 2925440.9583; val_optim_loss: 2925440.9583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8900; val_auprc_score: 0.9757; val_best_acc_score: 0.9166; val_best_f1_score: 0.9530; train_kl_reg_loss: 40537.3110; train_edge_recon_loss: 874640.0625; train_gene_expr_recon_loss: 1947657.0889; train_masked_gp_l1_reg_loss: 12770.3297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35021.9815; train_global_loss: 2910626.7524; train_optim_loss: 2910626.7524; val_kl_reg_loss: 37880.1400; val_edge_recon_loss: 869508.4323; val_gene_expr_recon_loss: 1932707.8854; val_masked_gp_l1_reg_loss: 12878.3496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33935.5469; val_global_loss: 2886910.2083; val_optim_loss: 2886910.2083
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9045; val_auprc_score: 0.9787; val_best_acc_score: 0.9180; val_best_f1_score: 0.9538; train_kl_reg_loss: 38056.7096; train_edge_recon_loss: 866521.7254; train_gene_expr_recon_loss: 1926116.6887; train_masked_gp_l1_reg_loss: 12982.8483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32917.3245; train_global_loss: 2876595.2885; train_optim_loss: 2876595.2885; val_kl_reg_loss: 36890.8766; val_edge_recon_loss: 858598.0208; val_gene_expr_recon_loss: 1912842.0208; val_masked_gp_l1_reg_loss: 13086.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31915.1523; val_global_loss: 2853332.1667; val_optim_loss: 2853332.1667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9166; val_auprc_score: 0.9816; val_best_acc_score: 0.9192; val_best_f1_score: 0.9539; train_kl_reg_loss: 36172.6088; train_edge_recon_loss: 853316.5511; train_gene_expr_recon_loss: 1906612.6334; train_masked_gp_l1_reg_loss: 13169.6091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31015.8373; train_global_loss: 2840287.2236; train_optim_loss: 2840287.2236; val_kl_reg_loss: 34648.4821; val_edge_recon_loss: 847272.7292; val_gene_expr_recon_loss: 1892923.3125; val_masked_gp_l1_reg_loss: 13242.3926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30123.8086; val_global_loss: 2818210.7917; val_optim_loss: 2818210.7917
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9299; val_auprc_score: 0.9848; val_best_acc_score: 0.9271; val_best_f1_score: 0.9582; train_kl_reg_loss: 33885.3273; train_edge_recon_loss: 842881.4465; train_gene_expr_recon_loss: 1888629.0986; train_masked_gp_l1_reg_loss: 13297.8510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29334.8652; train_global_loss: 2808028.5769; train_optim_loss: 2808028.5769; val_kl_reg_loss: 32345.5262; val_edge_recon_loss: 829909.6198; val_gene_expr_recon_loss: 1877188.8854; val_masked_gp_l1_reg_loss: 13338.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28540.6523; val_global_loss: 2781323.5417; val_optim_loss: 2781323.5417
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9324; val_auprc_score: 0.9850; val_best_acc_score: 0.9303; val_best_f1_score: 0.9600; train_kl_reg_loss: 31822.6555; train_edge_recon_loss: 828552.2272; train_gene_expr_recon_loss: 1871445.8029; train_masked_gp_l1_reg_loss: 13350.6220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27860.5039; train_global_loss: 2773031.8053; train_optim_loss: 2773031.8053; val_kl_reg_loss: 30601.4456; val_edge_recon_loss: 834369.7448; val_gene_expr_recon_loss: 1861152.5833; val_masked_gp_l1_reg_loss: 13350.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27206.9922; val_global_loss: 2766681.5417; val_optim_loss: 2766681.5417
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9395; val_auprc_score: 0.9871; val_best_acc_score: 0.9354; val_best_f1_score: 0.9630; train_kl_reg_loss: 30081.9595; train_edge_recon_loss: 819945.4868; train_gene_expr_recon_loss: 1854885.0565; train_masked_gp_l1_reg_loss: 13315.8630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26620.6253; train_global_loss: 2744848.9832; train_optim_loss: 2744848.9832; val_kl_reg_loss: 28434.6613; val_edge_recon_loss: 812677.5104; val_gene_expr_recon_loss: 1842683.3646; val_masked_gp_l1_reg_loss: 13263.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26086.2344; val_global_loss: 2723145.5417; val_optim_loss: 2723145.5417
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9451; val_auprc_score: 0.9880; val_best_acc_score: 0.9380; val_best_f1_score: 0.9645; train_kl_reg_loss: 28041.6152; train_edge_recon_loss: 817606.6550; train_gene_expr_recon_loss: 1839026.1058; train_masked_gp_l1_reg_loss: 13182.9455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25597.9409; train_global_loss: 2723455.2668; train_optim_loss: 2723455.2668; val_kl_reg_loss: 25969.9580; val_edge_recon_loss: 807957.0417; val_gene_expr_recon_loss: 1828123.3958; val_masked_gp_l1_reg_loss: 13088.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25170.8711; val_global_loss: 2700309.3958; val_optim_loss: 2700309.3958
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9470; val_auprc_score: 0.9879; val_best_acc_score: 0.9379; val_best_f1_score: 0.9642; train_kl_reg_loss: 25763.7134; train_edge_recon_loss: 811429.1863; train_gene_expr_recon_loss: 1823538.0072; train_masked_gp_l1_reg_loss: 12969.1722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24786.2176; train_global_loss: 2698486.2909; train_optim_loss: 2698486.2909; val_kl_reg_loss: 24814.6857; val_edge_recon_loss: 818194.3698; val_gene_expr_recon_loss: 1811632.6146; val_masked_gp_l1_reg_loss: 12835.5850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24442.7500; val_global_loss: 2691919.9167; val_optim_loss: 2691919.9167
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9503; val_auprc_score: 0.9885; val_best_acc_score: 0.9406; val_best_f1_score: 0.9657; train_kl_reg_loss: 23409.3671; train_edge_recon_loss: 806776.9856; train_gene_expr_recon_loss: 1808330.5757; train_masked_gp_l1_reg_loss: 12682.0792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24102.8953; train_global_loss: 2675301.8726; train_optim_loss: 2675301.8726; val_kl_reg_loss: 22264.6839; val_edge_recon_loss: 814027.4167; val_gene_expr_recon_loss: 1798127.1771; val_masked_gp_l1_reg_loss: 12518.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23785.1523; val_global_loss: 2670723.2708; val_optim_loss: 2670723.2708
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9527; val_auprc_score: 0.9892; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 21770.6024; train_edge_recon_loss: 797511.7758; train_gene_expr_recon_loss: 1794032.8293; train_masked_gp_l1_reg_loss: 12336.1796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23435.0245; train_global_loss: 2649086.4207; train_optim_loss: 2649086.4207; val_kl_reg_loss: 20633.6660; val_edge_recon_loss: 814463.6250; val_gene_expr_recon_loss: 1784381.5417; val_masked_gp_l1_reg_loss: 12144.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23088.8301; val_global_loss: 2654712.3333; val_optim_loss: 2654712.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9498; val_auprc_score: 0.9885; val_best_acc_score: 0.9415; val_best_f1_score: 0.9662; train_kl_reg_loss: 16831.5349; train_edge_recon_loss: 821093.0331; train_gene_expr_recon_loss: 2383765.4567; train_masked_gp_l1_reg_loss: 11931.8664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19991.2513; train_global_loss: 3253613.1490; train_optim_loss: 3253613.1490; val_kl_reg_loss: 7356.4444; val_edge_recon_loss: 814464.0052; val_gene_expr_recon_loss: 1994580.3438; val_masked_gp_l1_reg_loss: 11623.7832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17095.6797; val_global_loss: 2845120.3125; val_optim_loss: 2845120.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9556; val_auprc_score: 0.9899; val_best_acc_score: 0.9464; val_best_f1_score: 0.9690; train_kl_reg_loss: 15002.5096; train_edge_recon_loss: 795309.5144; train_gene_expr_recon_loss: 1943018.3137; train_masked_gp_l1_reg_loss: 11278.6060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15074.6085; train_global_loss: 2779683.5649; train_optim_loss: 2779683.5649; val_kl_reg_loss: 6605.4744; val_edge_recon_loss: 792896.5521; val_gene_expr_recon_loss: 1904423.6667; val_masked_gp_l1_reg_loss: 10934.6182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13294.8418; val_global_loss: 2728154.9583; val_optim_loss: 2728154.9583
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9610; val_auprc_score: 0.9913; val_best_acc_score: 0.9497; val_best_f1_score: 0.9709; train_kl_reg_loss: 11854.9651; train_edge_recon_loss: 790418.8978; train_gene_expr_recon_loss: 1891189.3678; train_masked_gp_l1_reg_loss: 10618.1761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11961.9432; train_global_loss: 2716043.3341; train_optim_loss: 2716043.3341; val_kl_reg_loss: 5452.6402; val_edge_recon_loss: 794035.6667; val_gene_expr_recon_loss: 1872133.1771; val_masked_gp_l1_reg_loss: 10307.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10747.6807; val_global_loss: 2692676.9792; val_optim_loss: 2692676.9792
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9640; val_auprc_score: 0.9919; val_best_acc_score: 0.9521; val_best_f1_score: 0.9723; train_kl_reg_loss: 9424.6223; train_edge_recon_loss: 787058.2488; train_gene_expr_recon_loss: 1867898.3618; train_masked_gp_l1_reg_loss: 10029.5656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9779.5156; train_global_loss: 2684190.3005; train_optim_loss: 2684190.3005; val_kl_reg_loss: 4648.1850; val_edge_recon_loss: 786763.5052; val_gene_expr_recon_loss: 1854144.6250; val_masked_gp_l1_reg_loss: 9758.3486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8890.3701; val_global_loss: 2664204.8125; val_optim_loss: 2664204.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9619; val_auprc_score: 0.9913; val_best_acc_score: 0.9510; val_best_f1_score: 0.9717; train_kl_reg_loss: 8500.8381; train_edge_recon_loss: 782344.0841; train_gene_expr_recon_loss: 1859230.5950; train_masked_gp_l1_reg_loss: 9714.4745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8688.4869; train_global_loss: 2668478.4832; train_optim_loss: 2668478.4832; val_kl_reg_loss: 4536.3626; val_edge_recon_loss: 789009.7188; val_gene_expr_recon_loss: 1852231.9688; val_masked_gp_l1_reg_loss: 9684.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8595.0508; val_global_loss: 2664057.8542; val_optim_loss: 2664057.8542
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9653; val_auprc_score: 0.9925; val_best_acc_score: 0.9536; val_best_f1_score: 0.9732; train_kl_reg_loss: 8282.9036; train_edge_recon_loss: 780745.9832; train_gene_expr_recon_loss: 1857086.2788; train_masked_gp_l1_reg_loss: 9657.6126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8515.0392; train_global_loss: 2664287.8197; train_optim_loss: 2664287.8197; val_kl_reg_loss: 4421.8845; val_edge_recon_loss: 775276.9323; val_gene_expr_recon_loss: 1850076.2188; val_masked_gp_l1_reg_loss: 9629.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8432.3799; val_global_loss: 2647837.5833; val_optim_loss: 2647837.5833
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9641; val_auprc_score: 0.9919; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 8034.4345; train_edge_recon_loss: 778127.3407; train_gene_expr_recon_loss: 1855296.9507; train_masked_gp_l1_reg_loss: 9602.4861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8351.2753; train_global_loss: 2659412.4976; train_optim_loss: 2659412.4976; val_kl_reg_loss: 4344.5632; val_edge_recon_loss: 796822.2865; val_gene_expr_recon_loss: 1849474.0625; val_masked_gp_l1_reg_loss: 9574.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8268.2412; val_global_loss: 2668483.6667; val_optim_loss: 2668483.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9628; val_auprc_score: 0.9918; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 7850.8346; train_edge_recon_loss: 783176.8588; train_gene_expr_recon_loss: 1854450.2632; train_masked_gp_l1_reg_loss: 9546.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8185.4642; train_global_loss: 2663209.6611; train_optim_loss: 2663209.6611; val_kl_reg_loss: 4273.4737; val_edge_recon_loss: 771454.9323; val_gene_expr_recon_loss: 1847637.4583; val_masked_gp_l1_reg_loss: 9516.7598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8100.9790; val_global_loss: 2640983.5833; val_optim_loss: 2640983.5833
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9644; val_auprc_score: 0.9920; val_best_acc_score: 0.9531; val_best_f1_score: 0.9729; train_kl_reg_loss: 7604.8684; train_edge_recon_loss: 776821.1773; train_gene_expr_recon_loss: 1852636.6791; train_masked_gp_l1_reg_loss: 9487.2843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8017.6076; train_global_loss: 2654567.6058; train_optim_loss: 2654567.6058; val_kl_reg_loss: 4194.0653; val_edge_recon_loss: 784141.8646; val_gene_expr_recon_loss: 1848383.4167; val_masked_gp_l1_reg_loss: 9457.2207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7931.8237; val_global_loss: 2654108.3542; val_optim_loss: 2654108.3542
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9624; val_auprc_score: 0.9914; val_best_acc_score: 0.9527; val_best_f1_score: 0.9727; train_kl_reg_loss: 7446.7365; train_edge_recon_loss: 779644.7758; train_gene_expr_recon_loss: 1851133.3810; train_masked_gp_l1_reg_loss: 9427.2395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7847.5034; train_global_loss: 2655499.6466; train_optim_loss: 2655499.6466; val_kl_reg_loss: 4153.3856; val_edge_recon_loss: 788182.4375; val_gene_expr_recon_loss: 1847638.8854; val_masked_gp_l1_reg_loss: 9395.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7761.2397; val_global_loss: 2657131.9583; val_optim_loss: 2657131.9583
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9648; val_auprc_score: 0.9919; val_best_acc_score: 0.9543; val_best_f1_score: 0.9736; train_kl_reg_loss: 7237.6146; train_edge_recon_loss: 779548.7722; train_gene_expr_recon_loss: 1850623.4591; train_masked_gp_l1_reg_loss: 9365.7726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7675.4840; train_global_loss: 2654451.0889; train_optim_loss: 2654451.0889; val_kl_reg_loss: 3959.1017; val_edge_recon_loss: 782726.5885; val_gene_expr_recon_loss: 1843372.2500; val_masked_gp_l1_reg_loss: 9335.0410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7587.7832; val_global_loss: 2646980.7292; val_optim_loss: 2646980.7292
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9653; val_auprc_score: 0.9923; val_best_acc_score: 0.9540; val_best_f1_score: 0.9734; train_kl_reg_loss: 7066.6499; train_edge_recon_loss: 777870.4081; train_gene_expr_recon_loss: 1848744.1875; train_masked_gp_l1_reg_loss: 9304.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7502.1405; train_global_loss: 2650487.5673; train_optim_loss: 2650487.5673; val_kl_reg_loss: 3926.6461; val_edge_recon_loss: 782449.4375; val_gene_expr_recon_loss: 1842608.6146; val_masked_gp_l1_reg_loss: 9272.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7414.4355; val_global_loss: 2645671.4375; val_optim_loss: 2645671.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9647; val_auprc_score: 0.9918; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 6979.4990; train_edge_recon_loss: 778027.4291; train_gene_expr_recon_loss: 1847660.4603; train_masked_gp_l1_reg_loss: 9266.6747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7389.9139; train_global_loss: 2649323.9712; train_optim_loss: 2649323.9712; val_kl_reg_loss: 3920.9435; val_edge_recon_loss: 781050.5104; val_gene_expr_recon_loss: 1842517.0625; val_masked_gp_l1_reg_loss: 9263.0361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7379.1875; val_global_loss: 2644130.7708; val_optim_loss: 2644130.7708
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9641; val_auprc_score: 0.9920; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 6946.9441; train_edge_recon_loss: 781300.0156; train_gene_expr_recon_loss: 1848142.0300; train_masked_gp_l1_reg_loss: 9259.6081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7370.0401; train_global_loss: 2653018.6394; train_optim_loss: 2653018.6394; val_kl_reg_loss: 3887.7125; val_edge_recon_loss: 780795.3594; val_gene_expr_recon_loss: 1842776.3333; val_masked_gp_l1_reg_loss: 9256.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7360.5361; val_global_loss: 2644075.8958; val_optim_loss: 2644075.8958
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9651; val_auprc_score: 0.9922; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 6923.1543; train_edge_recon_loss: 778634.2139; train_gene_expr_recon_loss: 1847982.7716; train_masked_gp_l1_reg_loss: 9252.5126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7351.0072; train_global_loss: 2650143.6707; train_optim_loss: 2650143.6707; val_kl_reg_loss: 3882.1665; val_edge_recon_loss: 783362.5677; val_gene_expr_recon_loss: 1841233.9167; val_masked_gp_l1_reg_loss: 9248.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7341.1514; val_global_loss: 2645068.6458; val_optim_loss: 2645068.6458
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9654; val_auprc_score: 0.9923; val_best_acc_score: 0.9555; val_best_f1_score: 0.9743; train_kl_reg_loss: 6894.0656; train_edge_recon_loss: 776478.4657; train_gene_expr_recon_loss: 1847772.6406; train_masked_gp_l1_reg_loss: 9245.1001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7331.1626; train_global_loss: 2647721.4447; train_optim_loss: 2647721.4447; val_kl_reg_loss: 3868.5593; val_edge_recon_loss: 778970.6354; val_gene_expr_recon_loss: 1844109.1979; val_masked_gp_l1_reg_loss: 9241.2588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7320.8438; val_global_loss: 2643510.3750; val_optim_loss: 2643510.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 8 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9659
val AUPRC score: 0.9925
val best accuracy score: 0.9537
val best F1 score: 0.9732
val target rna MSE score: 4.4277
val source rna MSE score: 26.5487
Val cat covariate0 mean sim diff: -0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
