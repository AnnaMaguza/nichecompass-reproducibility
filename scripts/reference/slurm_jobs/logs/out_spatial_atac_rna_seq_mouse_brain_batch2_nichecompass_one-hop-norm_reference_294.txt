[True]
Run timestamp: 07092023_072234_294.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_294']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2393 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5107, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6159; val_auprc_score: 0.6084; val_best_acc_score: 0.5008; val_best_f1_score: 0.6669; train_kl_reg_loss: 24147.8786; train_edge_recon_loss: 3570621.5227; train_gene_expr_recon_loss: 12720453.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 821252.4659; train_chrom_access_recon_loss: 10343243.1667; train_global_loss: 27479718.0909; train_optim_loss: 27479718.0909; val_kl_reg_loss: 19397.1099; val_edge_recon_loss: 4065330.1562; val_gene_expr_recon_loss: 11759950.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 636680.8750; val_chrom_access_recon_loss: 10106042.0000; val_global_loss: 26587401.2500; val_optim_loss: 26587401.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7190; val_auprc_score: 0.6949; val_best_acc_score: 0.5618; val_best_f1_score: 0.6886; train_kl_reg_loss: 66902.4475; train_edge_recon_loss: 3535717.6970; train_gene_expr_recon_loss: 11452288.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 470792.3935; train_chrom_access_recon_loss: 9801802.6818; train_global_loss: 25327503.9697; train_optim_loss: 25327503.9697; val_kl_reg_loss: 80862.0137; val_edge_recon_loss: 4061677.8438; val_gene_expr_recon_loss: 11269352.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 329522.2500; val_chrom_access_recon_loss: 9793180.7500; val_global_loss: 25534595.5000; val_optim_loss: 25534595.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7694; val_auprc_score: 0.7497; val_best_acc_score: 0.7034; val_best_f1_score: 0.7175; train_kl_reg_loss: 79990.3214; train_edge_recon_loss: 3507420.0379; train_gene_expr_recon_loss: 11182902.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246868.9946; train_chrom_access_recon_loss: 9653164.1364; train_global_loss: 24670345.6364; train_optim_loss: 24670345.6364; val_kl_reg_loss: 70539.8438; val_edge_recon_loss: 4036989.8750; val_gene_expr_recon_loss: 11103695.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182661.3125; val_chrom_access_recon_loss: 9687784.7500; val_global_loss: 25081670.5000; val_optim_loss: 25081670.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8215; val_auprc_score: 0.7888; val_best_acc_score: 0.7466; val_best_f1_score: 0.7762; train_kl_reg_loss: 69215.4063; train_edge_recon_loss: 3484796.1326; train_gene_expr_recon_loss: 11065471.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147202.9599; train_chrom_access_recon_loss: 9579959.2121; train_global_loss: 24346645.6364; train_optim_loss: 24346645.6364; val_kl_reg_loss: 60985.9165; val_edge_recon_loss: 3732601.8750; val_gene_expr_recon_loss: 11081055.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119109.3594; val_chrom_access_recon_loss: 9699569.1250; val_global_loss: 24693321.7500; val_optim_loss: 24693321.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8368; val_auprc_score: 0.8011; val_best_acc_score: 0.7534; val_best_f1_score: 0.7939; train_kl_reg_loss: 55633.9786; train_edge_recon_loss: 3205166.8106; train_gene_expr_recon_loss: 11014414.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102297.5501; train_chrom_access_recon_loss: 9544584.5606; train_global_loss: 23922097.0606; train_optim_loss: 23922097.0606; val_kl_reg_loss: 67701.8262; val_edge_recon_loss: 3000774.5312; val_gene_expr_recon_loss: 11034583.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87765.7266; val_chrom_access_recon_loss: 9626426.1250; val_global_loss: 23817251.2500; val_optim_loss: 23817251.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8426; val_auprc_score: 0.8130; val_best_acc_score: 0.7504; val_best_f1_score: 0.7953; train_kl_reg_loss: 78534.5879; train_edge_recon_loss: 2972530.3712; train_gene_expr_recon_loss: 10930349.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77571.3325; train_chrom_access_recon_loss: 9472221.8485; train_global_loss: 23531207.4848; train_optim_loss: 23531207.4848; val_kl_reg_loss: 84354.5205; val_edge_recon_loss: 2939245.9062; val_gene_expr_recon_loss: 10916545.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68474.3125; val_chrom_access_recon_loss: 9547088.8750; val_global_loss: 23555708.5000; val_optim_loss: 23555708.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8454; val_auprc_score: 0.8164; val_best_acc_score: 0.7585; val_best_f1_score: 0.7921; train_kl_reg_loss: 84126.5057; train_edge_recon_loss: 2947849.2121; train_gene_expr_recon_loss: 10858649.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61856.7412; train_chrom_access_recon_loss: 9422107.8485; train_global_loss: 23374589.9394; train_optim_loss: 23374589.9394; val_kl_reg_loss: 77806.7129; val_edge_recon_loss: 2950842.3125; val_gene_expr_recon_loss: 10838165.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56115.8828; val_chrom_access_recon_loss: 9471250.0000; val_global_loss: 23394180.2500; val_optim_loss: 23394180.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8587; val_auprc_score: 0.8188; val_best_acc_score: 0.7781; val_best_f1_score: 0.7974; train_kl_reg_loss: 82139.0271; train_edge_recon_loss: 2930915.9432; train_gene_expr_recon_loss: 10797002.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51960.6233; train_chrom_access_recon_loss: 9383266.2424; train_global_loss: 23245284.7879; train_optim_loss: 23245284.7879; val_kl_reg_loss: 76826.9531; val_edge_recon_loss: 2908084.4062; val_gene_expr_recon_loss: 10700973.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48594.4141; val_chrom_access_recon_loss: 9394531.1250; val_global_loss: 23129010.0000; val_optim_loss: 23129010.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8680; val_auprc_score: 0.8271; val_best_acc_score: 0.7931; val_best_f1_score: 0.8097; train_kl_reg_loss: 79759.3063; train_edge_recon_loss: 2913919.1515; train_gene_expr_recon_loss: 10752727.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45625.6306; train_chrom_access_recon_loss: 9336605.6667; train_global_loss: 23128637.3030; train_optim_loss: 23128637.3030; val_kl_reg_loss: 76538.5928; val_edge_recon_loss: 2908999.9375; val_gene_expr_recon_loss: 10690246.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43290.9102; val_chrom_access_recon_loss: 9344932.5000; val_global_loss: 23064009.0000; val_optim_loss: 23064009.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8912; val_auprc_score: 0.8545; val_best_acc_score: 0.8184; val_best_f1_score: 0.8341; train_kl_reg_loss: 76034.8139; train_edge_recon_loss: 2881130.3220; train_gene_expr_recon_loss: 10698528.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41183.4084; train_chrom_access_recon_loss: 9298559.9394; train_global_loss: 22995436.5758; train_optim_loss: 22995436.5758; val_kl_reg_loss: 74948.2246; val_edge_recon_loss: 2848031.9062; val_gene_expr_recon_loss: 10677992.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39231.1641; val_chrom_access_recon_loss: 9405133.2500; val_global_loss: 23045336.7500; val_optim_loss: 23045336.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9037; val_auprc_score: 0.8783; val_best_acc_score: 0.8361; val_best_f1_score: 0.8497; train_kl_reg_loss: 76121.2024; train_edge_recon_loss: 2843161.5038; train_gene_expr_recon_loss: 10660875.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37785.2820; train_chrom_access_recon_loss: 9265189.4545; train_global_loss: 22883133.4242; train_optim_loss: 22883133.4242; val_kl_reg_loss: 75097.5889; val_edge_recon_loss: 2840039.8438; val_gene_expr_recon_loss: 10672838.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36682.2500; val_chrom_access_recon_loss: 9339159.2500; val_global_loss: 22963817.0000; val_optim_loss: 22963817.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9013; val_auprc_score: 0.8690; val_best_acc_score: 0.8337; val_best_f1_score: 0.8492; train_kl_reg_loss: 77032.1204; train_edge_recon_loss: 2814265.1629; train_gene_expr_recon_loss: 10617146.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35574.3282; train_chrom_access_recon_loss: 9233684.5606; train_global_loss: 22777702.3636; train_optim_loss: 22777702.3636; val_kl_reg_loss: 76418.9883; val_edge_recon_loss: 2806586.2812; val_gene_expr_recon_loss: 10702652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34610.4492; val_chrom_access_recon_loss: 9406141.3750; val_global_loss: 23026408.5000; val_optim_loss: 23026408.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8982; val_auprc_score: 0.8670; val_best_acc_score: 0.8361; val_best_f1_score: 0.8476; train_kl_reg_loss: 77456.8844; train_edge_recon_loss: 2798690.0720; train_gene_expr_recon_loss: 10573014.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33956.2717; train_chrom_access_recon_loss: 9198895.0758; train_global_loss: 22682012.5455; train_optim_loss: 22682012.5455; val_kl_reg_loss: 77203.7041; val_edge_recon_loss: 2824843.9062; val_gene_expr_recon_loss: 10563491.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33573.8047; val_chrom_access_recon_loss: 9255676.5000; val_global_loss: 22754789.5000; val_optim_loss: 22754789.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9035; val_auprc_score: 0.8787; val_best_acc_score: 0.8372; val_best_f1_score: 0.8525; train_kl_reg_loss: 75654.9010; train_edge_recon_loss: 2785522.6477; train_gene_expr_recon_loss: 10525692.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32621.6117; train_chrom_access_recon_loss: 9158820.3788; train_global_loss: 22578312.2121; train_optim_loss: 22578312.2121; val_kl_reg_loss: 79244.9678; val_edge_recon_loss: 2803186.7188; val_gene_expr_recon_loss: 10424623.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31978.9648; val_chrom_access_recon_loss: 9255686.6250; val_global_loss: 22594720.5000; val_optim_loss: 22594720.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9098; val_auprc_score: 0.8757; val_best_acc_score: 0.8514; val_best_f1_score: 0.8626; train_kl_reg_loss: 75506.6616; train_edge_recon_loss: 2783050.6174; train_gene_expr_recon_loss: 10504967.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31482.6117; train_chrom_access_recon_loss: 9144657.7879; train_global_loss: 22539665.3030; train_optim_loss: 22539665.3030; val_kl_reg_loss: 71215.7314; val_edge_recon_loss: 2799265.6875; val_gene_expr_recon_loss: 10544621.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31259.5098; val_chrom_access_recon_loss: 9148148.3750; val_global_loss: 22594511.2500; val_optim_loss: 22594511.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9102; val_auprc_score: 0.8735; val_best_acc_score: 0.8495; val_best_f1_score: 0.8620; train_kl_reg_loss: 73663.6615; train_edge_recon_loss: 2753913.4470; train_gene_expr_recon_loss: 10469496.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30782.0668; train_chrom_access_recon_loss: 9116600.6818; train_global_loss: 22444456.8485; train_optim_loss: 22444456.8485; val_kl_reg_loss: 70477.3994; val_edge_recon_loss: 2828998.6562; val_gene_expr_recon_loss: 10448300.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30381.8242; val_chrom_access_recon_loss: 9192092.6250; val_global_loss: 22570251.0000; val_optim_loss: 22570251.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9146; val_auprc_score: 0.8834; val_best_acc_score: 0.8576; val_best_f1_score: 0.8677; train_kl_reg_loss: 73106.1793; train_edge_recon_loss: 2758449.0265; train_gene_expr_recon_loss: 10440581.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30081.5279; train_chrom_access_recon_loss: 9088870.4545; train_global_loss: 22391089.1515; train_optim_loss: 22391089.1515; val_kl_reg_loss: 72126.2793; val_edge_recon_loss: 2769020.1562; val_gene_expr_recon_loss: 10453293.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29839.9727; val_chrom_access_recon_loss: 9225040.2500; val_global_loss: 22549319.5000; val_optim_loss: 22549319.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9212; val_auprc_score: 0.8996; val_best_acc_score: 0.8619; val_best_f1_score: 0.8695; train_kl_reg_loss: 71463.3969; train_edge_recon_loss: 2751606.3826; train_gene_expr_recon_loss: 10416897.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29560.0961; train_chrom_access_recon_loss: 9065155.8788; train_global_loss: 22334683.0303; train_optim_loss: 22334683.0303; val_kl_reg_loss: 70812.7314; val_edge_recon_loss: 2799736.3125; val_gene_expr_recon_loss: 10411114.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29473.5391; val_chrom_access_recon_loss: 9074938.3750; val_global_loss: 22386075.7500; val_optim_loss: 22386075.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9232; val_auprc_score: 0.8948; val_best_acc_score: 0.8675; val_best_f1_score: 0.8743; train_kl_reg_loss: 71025.6590; train_edge_recon_loss: 2741290.0114; train_gene_expr_recon_loss: 10383831.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29221.3593; train_chrom_access_recon_loss: 9034540.1515; train_global_loss: 22259908.5758; train_optim_loss: 22259908.5758; val_kl_reg_loss: 69715.2363; val_edge_recon_loss: 2801730.9062; val_gene_expr_recon_loss: 10391713.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29185.9141; val_chrom_access_recon_loss: 9154291.6250; val_global_loss: 22446636.7500; val_optim_loss: 22446636.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9218; val_auprc_score: 0.8897; val_best_acc_score: 0.8646; val_best_f1_score: 0.8721; train_kl_reg_loss: 70509.1198; train_edge_recon_loss: 2735046.7500; train_gene_expr_recon_loss: 10352454.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28973.5711; train_chrom_access_recon_loss: 9005266.1818; train_global_loss: 22192250.2424; train_optim_loss: 22192250.2424; val_kl_reg_loss: 70008.2559; val_edge_recon_loss: 2744887.0625; val_gene_expr_recon_loss: 10399194.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28793.7988; val_chrom_access_recon_loss: 9092409.8750; val_global_loss: 22335293.5000; val_optim_loss: 22335293.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9239; val_auprc_score: 0.8974; val_best_acc_score: 0.8641; val_best_f1_score: 0.8732; train_kl_reg_loss: 68346.2674; train_edge_recon_loss: 2723328.4962; train_gene_expr_recon_loss: 10327170.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28682.0484; train_chrom_access_recon_loss: 8982765.8939; train_global_loss: 22130293.5758; train_optim_loss: 22130293.5758; val_kl_reg_loss: 67111.1792; val_edge_recon_loss: 2799797.5312; val_gene_expr_recon_loss: 10357129.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28410.7109; val_chrom_access_recon_loss: 9025154.0000; val_global_loss: 22277602.7500; val_optim_loss: 22277602.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9321; val_auprc_score: 0.9069; val_best_acc_score: 0.8721; val_best_f1_score: 0.8790; train_kl_reg_loss: 68290.9451; train_edge_recon_loss: 2721310.7045; train_gene_expr_recon_loss: 10309610.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28307.3832; train_chrom_access_recon_loss: 8966888.3333; train_global_loss: 22094408.1212; train_optim_loss: 22094408.1212; val_kl_reg_loss: 68594.1768; val_edge_recon_loss: 2776082.7500; val_gene_expr_recon_loss: 10405193.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28211.1055; val_chrom_access_recon_loss: 9120203.0000; val_global_loss: 22398284.0000; val_optim_loss: 22398284.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9322; val_auprc_score: 0.9031; val_best_acc_score: 0.8753; val_best_f1_score: 0.8815; train_kl_reg_loss: 67089.1990; train_edge_recon_loss: 2732909.1477; train_gene_expr_recon_loss: 10277790.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28096.0439; train_chrom_access_recon_loss: 8941042.2273; train_global_loss: 22046927.2121; train_optim_loss: 22046927.2121; val_kl_reg_loss: 65768.0889; val_edge_recon_loss: 2759443.3438; val_gene_expr_recon_loss: 10252102.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28003.4883; val_chrom_access_recon_loss: 8996464.6250; val_global_loss: 22101781.2500; val_optim_loss: 22101781.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9367; val_auprc_score: 0.9150; val_best_acc_score: 0.8818; val_best_f1_score: 0.8883; train_kl_reg_loss: 66383.6567; train_edge_recon_loss: 2717182.1439; train_gene_expr_recon_loss: 10252657.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27817.0348; train_chrom_access_recon_loss: 8907576.9773; train_global_loss: 21971616.7879; train_optim_loss: 21971616.7879; val_kl_reg_loss: 66099.5581; val_edge_recon_loss: 2753210.4062; val_gene_expr_recon_loss: 10211795.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27786.0723; val_chrom_access_recon_loss: 8890196.2500; val_global_loss: 21949088.0000; val_optim_loss: 21949088.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9414; val_auprc_score: 0.9214; val_best_acc_score: 0.8874; val_best_f1_score: 0.8929; train_kl_reg_loss: 65208.9927; train_edge_recon_loss: 2717793.7083; train_gene_expr_recon_loss: 10238174.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27573.8454; train_chrom_access_recon_loss: 8898353.1970; train_global_loss: 21947104.8182; train_optim_loss: 21947104.8182; val_kl_reg_loss: 64224.1953; val_edge_recon_loss: 2731117.9688; val_gene_expr_recon_loss: 10287949.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27544.9395; val_chrom_access_recon_loss: 9098118.6250; val_global_loss: 22208955.0000; val_optim_loss: 22208955.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9322; val_auprc_score: 0.9069; val_best_acc_score: 0.8788; val_best_f1_score: 0.8863; train_kl_reg_loss: 92329.6162; train_edge_recon_loss: 2816068.1515; train_gene_expr_recon_loss: 9184334.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23526.8043; train_chrom_access_recon_loss: 7987033.1742; train_global_loss: 20103291.9394; train_optim_loss: 20103291.9394; val_kl_reg_loss: 18811.3040; val_edge_recon_loss: 2839161.2188; val_gene_expr_recon_loss: 8611221.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21798.9961; val_chrom_access_recon_loss: 7508554.6875; val_global_loss: 18999547.7500; val_optim_loss: 18999547.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9272; val_auprc_score: 0.8980; val_best_acc_score: 0.8646; val_best_f1_score: 0.8743; train_kl_reg_loss: 100247.8967; train_edge_recon_loss: 2798728.5455; train_gene_expr_recon_loss: 8091471.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21296.7032; train_chrom_access_recon_loss: 6972515.4848; train_global_loss: 17984259.9242; train_optim_loss: 17984259.9242; val_kl_reg_loss: 15010.6821; val_edge_recon_loss: 2856514.7500; val_gene_expr_recon_loss: 7501316.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21021.5723; val_chrom_access_recon_loss: 6416234.3750; val_global_loss: 16810098.2500; val_optim_loss: 16810098.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9306; val_auprc_score: 0.9002; val_best_acc_score: 0.8786; val_best_f1_score: 0.8859; train_kl_reg_loss: 90151.1585; train_edge_recon_loss: 2773240.3409; train_gene_expr_recon_loss: 7103360.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20817.3839; train_chrom_access_recon_loss: 5967852.7197; train_global_loss: 15955422.4091; train_optim_loss: 15955422.4091; val_kl_reg_loss: 15810.2701; val_edge_recon_loss: 2788515.8125; val_gene_expr_recon_loss: 6970107.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20608.6211; val_chrom_access_recon_loss: 5880933.8750; val_global_loss: 15675976.6250; val_optim_loss: 15675976.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9345; val_auprc_score: 0.9100; val_best_acc_score: 0.8769; val_best_f1_score: 0.8835; train_kl_reg_loss: 72158.6254; train_edge_recon_loss: 2749369.5152; train_gene_expr_recon_loss: 6737451.1894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20540.6284; train_chrom_access_recon_loss: 5638921.5682; train_global_loss: 15218441.6061; train_optim_loss: 15218441.6061; val_kl_reg_loss: 17708.0239; val_edge_recon_loss: 2779015.7188; val_gene_expr_recon_loss: 6580516.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20428.3535; val_chrom_access_recon_loss: 5608780.7500; val_global_loss: 15006449.2500; val_optim_loss: 15006449.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9278; val_auprc_score: 0.8915; val_best_acc_score: 0.8748; val_best_f1_score: 0.8826; train_kl_reg_loss: 60207.5836; train_edge_recon_loss: 2723028.0606; train_gene_expr_recon_loss: 6547544.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20277.2662; train_chrom_access_recon_loss: 5479352.9015; train_global_loss: 14830410.2879; train_optim_loss: 14830410.2879; val_kl_reg_loss: 20225.2151; val_edge_recon_loss: 2748808.6875; val_gene_expr_recon_loss: 6491539.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20160.9590; val_chrom_access_recon_loss: 5436651.5000; val_global_loss: 14717385.6250; val_optim_loss: 14717385.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9306; val_auprc_score: 0.9015; val_best_acc_score: 0.8772; val_best_f1_score: 0.8839; train_kl_reg_loss: 54126.8858; train_edge_recon_loss: 2721714.0227; train_gene_expr_recon_loss: 6465420.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20047.3508; train_chrom_access_recon_loss: 5364246.6894; train_global_loss: 14625555.2576; train_optim_loss: 14625555.2576; val_kl_reg_loss: 22130.5891; val_edge_recon_loss: 2746197.0312; val_gene_expr_recon_loss: 6444851.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19990.9570; val_chrom_access_recon_loss: 5360404.2500; val_global_loss: 14593574.0000; val_optim_loss: 14593574.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9343; val_auprc_score: 0.9075; val_best_acc_score: 0.8791; val_best_f1_score: 0.8868; train_kl_reg_loss: 48703.1467; train_edge_recon_loss: 2706356.1894; train_gene_expr_recon_loss: 6411288.6742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19916.2136; train_chrom_access_recon_loss: 5301846.6515; train_global_loss: 14488110.8788; train_optim_loss: 14488110.8788; val_kl_reg_loss: 24262.2046; val_edge_recon_loss: 2734476.2500; val_gene_expr_recon_loss: 6396944.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19827.0820; val_chrom_access_recon_loss: 5261228.1250; val_global_loss: 14436738.5000; val_optim_loss: 14436738.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9254; val_auprc_score: 0.8919; val_best_acc_score: 0.8772; val_best_f1_score: 0.8830; train_kl_reg_loss: 44897.1288; train_edge_recon_loss: 2696195.3030; train_gene_expr_recon_loss: 6342891.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19764.3461; train_chrom_access_recon_loss: 5219460.5076; train_global_loss: 14323208.9394; train_optim_loss: 14323208.9394; val_kl_reg_loss: 25386.4934; val_edge_recon_loss: 2749596.0938; val_gene_expr_recon_loss: 6284649.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19695.0195; val_chrom_access_recon_loss: 5191261.7500; val_global_loss: 14270588.7500; val_optim_loss: 14270588.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9272; val_auprc_score: 0.8919; val_best_acc_score: 0.8769; val_best_f1_score: 0.8853; train_kl_reg_loss: 39747.2527; train_edge_recon_loss: 2698515.7348; train_gene_expr_recon_loss: 6243040.6894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19666.7349; train_chrom_access_recon_loss: 5124732.5152; train_global_loss: 14125702.9848; train_optim_loss: 14125702.9848; val_kl_reg_loss: 25561.3901; val_edge_recon_loss: 2753171.1562; val_gene_expr_recon_loss: 6225298.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19606.3789; val_chrom_access_recon_loss: 5186768.6875; val_global_loss: 14210405.3750; val_optim_loss: 14210405.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9370; val_auprc_score: 0.9090; val_best_acc_score: 0.8872; val_best_f1_score: 0.8935; train_kl_reg_loss: 39447.3717; train_edge_recon_loss: 2693173.2652; train_gene_expr_recon_loss: 6229419.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19595.6614; train_chrom_access_recon_loss: 5110556.0530; train_global_loss: 14092191.9091; train_optim_loss: 14092191.9091; val_kl_reg_loss: 27415.1873; val_edge_recon_loss: 2702681.5312; val_gene_expr_recon_loss: 6286134.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19598.8691; val_chrom_access_recon_loss: 5280059.6875; val_global_loss: 14315889.5000; val_optim_loss: 14315889.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9218; val_auprc_score: 0.8989; val_best_acc_score: 0.8643; val_best_f1_score: 0.8747; train_kl_reg_loss: 34290.7678; train_edge_recon_loss: 2783405.4091; train_gene_expr_recon_loss: 6262168.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19808.7766; train_chrom_access_recon_loss: 5103088.6894; train_global_loss: 14202761.8333; train_optim_loss: 14202761.8333; val_kl_reg_loss: 23282.3306; val_edge_recon_loss: 2761147.5000; val_gene_expr_recon_loss: 6226648.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19775.4297; val_chrom_access_recon_loss: 5148503.7500; val_global_loss: 14179357.1250; val_optim_loss: 14179357.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9325; val_auprc_score: 0.9020; val_best_acc_score: 0.8786; val_best_f1_score: 0.8854; train_kl_reg_loss: 37176.7575; train_edge_recon_loss: 2707167.0985; train_gene_expr_recon_loss: 6207881.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19768.2507; train_chrom_access_recon_loss: 5076509.7727; train_global_loss: 14048503.3485; train_optim_loss: 14048503.3485; val_kl_reg_loss: 25286.8547; val_edge_recon_loss: 2740469.5938; val_gene_expr_recon_loss: 6214968.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19787.2246; val_chrom_access_recon_loss: 5140619.2500; val_global_loss: 14141131.0000; val_optim_loss: 14141131.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9331; val_auprc_score: 0.9016; val_best_acc_score: 0.8812; val_best_f1_score: 0.8894; train_kl_reg_loss: 38485.3702; train_edge_recon_loss: 2697747.2235; train_gene_expr_recon_loss: 6140021.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19770.5048; train_chrom_access_recon_loss: 4993787.5303; train_global_loss: 13889812.5152; train_optim_loss: 13889812.5152; val_kl_reg_loss: 25693.5566; val_edge_recon_loss: 2740108.4375; val_gene_expr_recon_loss: 6118628.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19766.2109; val_chrom_access_recon_loss: 5003724.8750; val_global_loss: 13907921.0000; val_optim_loss: 13907921.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9364; val_auprc_score: 0.9055; val_best_acc_score: 0.8885; val_best_f1_score: 0.8953; train_kl_reg_loss: 37431.0005; train_edge_recon_loss: 2692077.7765; train_gene_expr_recon_loss: 6114193.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19798.1275; train_chrom_access_recon_loss: 4960955.8788; train_global_loss: 13824456.6212; train_optim_loss: 13824456.6212; val_kl_reg_loss: 26428.7454; val_edge_recon_loss: 2708374.0938; val_gene_expr_recon_loss: 6129716.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19814.1133; val_chrom_access_recon_loss: 4998393.5625; val_global_loss: 13882726.7500; val_optim_loss: 13882726.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9413; val_auprc_score: 0.9164; val_best_acc_score: 0.8915; val_best_f1_score: 0.8973; train_kl_reg_loss: 36246.8197; train_edge_recon_loss: 2680932.4773; train_gene_expr_recon_loss: 6106649.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19807.7686; train_chrom_access_recon_loss: 4952171.3864; train_global_loss: 13795808.4242; train_optim_loss: 13795808.4242; val_kl_reg_loss: 27429.4080; val_edge_recon_loss: 2682061.2500; val_gene_expr_recon_loss: 6165648.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19807.6875; val_chrom_access_recon_loss: 5071880.5625; val_global_loss: 13966828.2500; val_optim_loss: 13966828.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9366; val_auprc_score: 0.9094; val_best_acc_score: 0.8888; val_best_f1_score: 0.8945; train_kl_reg_loss: 35164.8848; train_edge_recon_loss: 2682342.7045; train_gene_expr_recon_loss: 6102351.6742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19810.4303; train_chrom_access_recon_loss: 4950275.6667; train_global_loss: 13789945.4394; train_optim_loss: 13789945.4394; val_kl_reg_loss: 26662.5215; val_edge_recon_loss: 2703666.3438; val_gene_expr_recon_loss: 6082403.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19814.3398; val_chrom_access_recon_loss: 4986932.1875; val_global_loss: 13819479.0000; val_optim_loss: 13819479.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9434; val_auprc_score: 0.9173; val_best_acc_score: 0.8936; val_best_f1_score: 0.8985; train_kl_reg_loss: 35295.7094; train_edge_recon_loss: 2682035.5682; train_gene_expr_recon_loss: 6092040.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19826.9132; train_chrom_access_recon_loss: 4938675.7803; train_global_loss: 13767874.3485; train_optim_loss: 13767874.3485; val_kl_reg_loss: 27334.7498; val_edge_recon_loss: 2665553.3125; val_gene_expr_recon_loss: 6077080.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19837.1406; val_chrom_access_recon_loss: 4983064.6250; val_global_loss: 13772870.7500; val_optim_loss: 13772870.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9413; val_auprc_score: 0.9189; val_best_acc_score: 0.8912; val_best_f1_score: 0.8970; train_kl_reg_loss: 34976.0490; train_edge_recon_loss: 2678259.0038; train_gene_expr_recon_loss: 6004169.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19860.7359; train_chrom_access_recon_loss: 4878442.5682; train_global_loss: 13615708.0303; train_optim_loss: 13615708.0303; val_kl_reg_loss: 28313.4849; val_edge_recon_loss: 2693761.8750; val_gene_expr_recon_loss: 6028307.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19885.1445; val_chrom_access_recon_loss: 5016967.8750; val_global_loss: 13787235.2500; val_optim_loss: 13787235.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9463; val_auprc_score: 0.9201; val_best_acc_score: 0.8933; val_best_f1_score: 0.8979; train_kl_reg_loss: 34516.6486; train_edge_recon_loss: 2671444.8371; train_gene_expr_recon_loss: 5998559.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19883.4072; train_chrom_access_recon_loss: 4869402.1439; train_global_loss: 13593806.2879; train_optim_loss: 13593806.2879; val_kl_reg_loss: 25106.9536; val_edge_recon_loss: 2689346.1250; val_gene_expr_recon_loss: 6056061.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19883.3164; val_chrom_access_recon_loss: 4920754.0625; val_global_loss: 13711150.8750; val_optim_loss: 13711150.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9445; val_auprc_score: 0.9218; val_best_acc_score: 0.8917; val_best_f1_score: 0.8960; train_kl_reg_loss: 33188.7889; train_edge_recon_loss: 2677957.2803; train_gene_expr_recon_loss: 5998650.4621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19935.3529; train_chrom_access_recon_loss: 4865926.8333; train_global_loss: 13595658.7424; train_optim_loss: 13595658.7424; val_kl_reg_loss: 27327.2644; val_edge_recon_loss: 2695264.5000; val_gene_expr_recon_loss: 5980968.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19982.6621; val_chrom_access_recon_loss: 4879711.6875; val_global_loss: 13603255.3750; val_optim_loss: 13603255.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9413; val_auprc_score: 0.9142; val_best_acc_score: 0.8890; val_best_f1_score: 0.8947; train_kl_reg_loss: 34077.5841; train_edge_recon_loss: 2677357.6061; train_gene_expr_recon_loss: 5984443.7803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19989.6667; train_chrom_access_recon_loss: 4857570.5000; train_global_loss: 13573439.1818; train_optim_loss: 13573439.1818; val_kl_reg_loss: 27986.2749; val_edge_recon_loss: 2704046.3125; val_gene_expr_recon_loss: 6021340.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19988.7266; val_chrom_access_recon_loss: 4928099.4375; val_global_loss: 13701461.7500; val_optim_loss: 13701461.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9368; val_auprc_score: 0.9034; val_best_acc_score: 0.8869; val_best_f1_score: 0.8952; train_kl_reg_loss: 33542.9193; train_edge_recon_loss: 2675886.9508; train_gene_expr_recon_loss: 5977010.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20029.8976; train_chrom_access_recon_loss: 4854586.8030; train_global_loss: 13561057.5758; train_optim_loss: 13561057.5758; val_kl_reg_loss: 26737.8591; val_edge_recon_loss: 2712931.7188; val_gene_expr_recon_loss: 5994837.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20068.8086; val_chrom_access_recon_loss: 4935724.0625; val_global_loss: 13690299.6250; val_optim_loss: 13690299.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9436; val_auprc_score: 0.9167; val_best_acc_score: 0.8966; val_best_f1_score: 0.8999; train_kl_reg_loss: 32447.8700; train_edge_recon_loss: 2676348.6061; train_gene_expr_recon_loss: 5977118.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20107.3411; train_chrom_access_recon_loss: 4853909.4167; train_global_loss: 13559932.0152; train_optim_loss: 13559932.0152; val_kl_reg_loss: 26703.8047; val_edge_recon_loss: 2712865.2188; val_gene_expr_recon_loss: 6025197.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20136.5508; val_chrom_access_recon_loss: 4944129.0000; val_global_loss: 13729032.6250; val_optim_loss: 13729032.6250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9405; val_auprc_score: 0.9055; val_best_acc_score: 0.8949; val_best_f1_score: 0.8998; train_kl_reg_loss: 32394.6747; train_edge_recon_loss: 2677836.0871; train_gene_expr_recon_loss: 5974344.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20174.2167; train_chrom_access_recon_loss: 4851092.2197; train_global_loss: 13555841.9394; train_optim_loss: 13555841.9394; val_kl_reg_loss: 27173.1904; val_edge_recon_loss: 2696063.4062; val_gene_expr_recon_loss: 5951230.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20207.8281; val_chrom_access_recon_loss: 4854446.2500; val_global_loss: 13549121.6250; val_optim_loss: 13549121.6250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9473; val_auprc_score: 0.9270; val_best_acc_score: 0.8896; val_best_f1_score: 0.8958; train_kl_reg_loss: 32721.7748; train_edge_recon_loss: 2667176.9583; train_gene_expr_recon_loss: 5965839.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20211.1974; train_chrom_access_recon_loss: 4845836.7576; train_global_loss: 13531786.3636; train_optim_loss: 13531786.3636; val_kl_reg_loss: 27260.8152; val_edge_recon_loss: 2703333.3750; val_gene_expr_recon_loss: 5998572.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20209.7871; val_chrom_access_recon_loss: 4915030.2500; val_global_loss: 13664407.1250; val_optim_loss: 13664407.1250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9440; val_auprc_score: 0.9188; val_best_acc_score: 0.8907; val_best_f1_score: 0.8973; train_kl_reg_loss: 32527.5289; train_edge_recon_loss: 2666046.0303; train_gene_expr_recon_loss: 5957767.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20268.4773; train_chrom_access_recon_loss: 4837870.5530; train_global_loss: 13514479.6667; train_optim_loss: 13514479.6667; val_kl_reg_loss: 28147.7847; val_edge_recon_loss: 2690701.3438; val_gene_expr_recon_loss: 5985812.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20294.7617; val_chrom_access_recon_loss: 4928281.6250; val_global_loss: 13653238.2500; val_optim_loss: 13653238.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9426; val_auprc_score: 0.9168; val_best_acc_score: 0.8901; val_best_f1_score: 0.8941; train_kl_reg_loss: 30889.2506; train_edge_recon_loss: 2662995.7992; train_gene_expr_recon_loss: 5961459.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20307.6071; train_chrom_access_recon_loss: 4843139.2045; train_global_loss: 13518790.9394; train_optim_loss: 13518790.9394; val_kl_reg_loss: 25566.1531; val_edge_recon_loss: 2702332.0000; val_gene_expr_recon_loss: 5965568.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20390.9980; val_chrom_access_recon_loss: 4866811.6250; val_global_loss: 13580669.0000; val_optim_loss: 13580669.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9443; val_auprc_score: 0.9185; val_best_acc_score: 0.8923; val_best_f1_score: 0.8958; train_kl_reg_loss: 30927.7592; train_edge_recon_loss: 2673190.5947; train_gene_expr_recon_loss: 5958420.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20391.5935; train_chrom_access_recon_loss: 4840797.1970; train_global_loss: 13523727.6970; train_optim_loss: 13523727.6970; val_kl_reg_loss: 27420.5281; val_edge_recon_loss: 2701940.0000; val_gene_expr_recon_loss: 6005053.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20403.6934; val_chrom_access_recon_loss: 4953888.7500; val_global_loss: 13708707.0000; val_optim_loss: 13708707.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9410; val_auprc_score: 0.9127; val_best_acc_score: 0.8888; val_best_f1_score: 0.8948; train_kl_reg_loss: 31419.8319; train_edge_recon_loss: 2671654.4242; train_gene_expr_recon_loss: 5950843.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18806.2379; train_chrom_access_recon_loss: 4836329.2727; train_global_loss: 13509053.2273; train_optim_loss: 13509053.2273; val_kl_reg_loss: 26902.8823; val_edge_recon_loss: 2709371.5938; val_gene_expr_recon_loss: 5943705.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18526.2090; val_chrom_access_recon_loss: 4889097.6875; val_global_loss: 13587604.1250; val_optim_loss: 13587604.1250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9483; val_auprc_score: 0.9262; val_best_acc_score: 0.8947; val_best_f1_score: 0.9002; train_kl_reg_loss: 31495.4348; train_edge_recon_loss: 2665754.2348; train_gene_expr_recon_loss: 5946876.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18514.0649; train_chrom_access_recon_loss: 4825545.0076; train_global_loss: 13488185.4091; train_optim_loss: 13488185.4091; val_kl_reg_loss: 27349.8950; val_edge_recon_loss: 2660669.5312; val_gene_expr_recon_loss: 5908620.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18508.0391; val_chrom_access_recon_loss: 4807837.6875; val_global_loss: 13422985.5000; val_optim_loss: 13422985.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9382; val_auprc_score: 0.9032; val_best_acc_score: 0.8898; val_best_f1_score: 0.8955; train_kl_reg_loss: 31467.9443; train_edge_recon_loss: 2660402.8220; train_gene_expr_recon_loss: 5927715.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18503.6198; train_chrom_access_recon_loss: 4793725.0227; train_global_loss: 13431814.6364; train_optim_loss: 13431814.6364; val_kl_reg_loss: 27021.8398; val_edge_recon_loss: 2701059.9688; val_gene_expr_recon_loss: 5965017.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18500.9629; val_chrom_access_recon_loss: 4895415.5625; val_global_loss: 13607016.1250; val_optim_loss: 13607016.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9435; val_auprc_score: 0.9153; val_best_acc_score: 0.8907; val_best_f1_score: 0.8979; train_kl_reg_loss: 31318.2875; train_edge_recon_loss: 2661203.1364; train_gene_expr_recon_loss: 5927915.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18500.0046; train_chrom_access_recon_loss: 4796565.4242; train_global_loss: 13435502.4394; train_optim_loss: 13435502.4394; val_kl_reg_loss: 27063.2209; val_edge_recon_loss: 2680373.3125; val_gene_expr_recon_loss: 5944105.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18498.3730; val_chrom_access_recon_loss: 4836630.1875; val_global_loss: 13506670.1250; val_optim_loss: 13506670.1250
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9465; val_auprc_score: 0.9168; val_best_acc_score: 0.9009; val_best_f1_score: 0.9052; train_kl_reg_loss: 31117.2986; train_edge_recon_loss: 2663332.2500; train_gene_expr_recon_loss: 5928468.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18501.2990; train_chrom_access_recon_loss: 4795106.1894; train_global_loss: 13436525.7727; train_optim_loss: 13436525.7727; val_kl_reg_loss: 26970.3784; val_edge_recon_loss: 2637226.1250; val_gene_expr_recon_loss: 5916080.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18502.1250; val_chrom_access_recon_loss: 4851171.8750; val_global_loss: 13449950.8750; val_optim_loss: 13449950.8750
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9458; val_auprc_score: 0.9198; val_best_acc_score: 0.8936; val_best_f1_score: 0.8996; train_kl_reg_loss: 31271.1035; train_edge_recon_loss: 2668311.2235; train_gene_expr_recon_loss: 5924909.1894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18495.6185; train_chrom_access_recon_loss: 4796920.0758; train_global_loss: 13439907.2576; train_optim_loss: 13439907.2576; val_kl_reg_loss: 26980.0986; val_edge_recon_loss: 2679183.9688; val_gene_expr_recon_loss: 5953257.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18494.3730; val_chrom_access_recon_loss: 4858891.5625; val_global_loss: 13536807.2500; val_optim_loss: 13536807.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9455; val_auprc_score: 0.9197; val_best_acc_score: 0.8909; val_best_f1_score: 0.8962; train_kl_reg_loss: 31262.4014; train_edge_recon_loss: 2666356.2121; train_gene_expr_recon_loss: 5926495.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18324.6019; train_chrom_access_recon_loss: 4790611.1894; train_global_loss: 13433049.9848; train_optim_loss: 13433049.9848; val_kl_reg_loss: 26770.1138; val_edge_recon_loss: 2708575.5312; val_gene_expr_recon_loss: 5898635.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18295.0820; val_chrom_access_recon_loss: 4837501.0000; val_global_loss: 13489777.5000; val_optim_loss: 13489777.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9498; val_auprc_score: 0.9271; val_best_acc_score: 0.8968; val_best_f1_score: 0.9017; train_kl_reg_loss: 31223.3557; train_edge_recon_loss: 2665019.2841; train_gene_expr_recon_loss: 5928887.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18294.2839; train_chrom_access_recon_loss: 4797742.7727; train_global_loss: 13441166.9545; train_optim_loss: 13441166.9545; val_kl_reg_loss: 26932.3091; val_edge_recon_loss: 2696763.5938; val_gene_expr_recon_loss: 5927363.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18293.8633; val_chrom_access_recon_loss: 4831180.2500; val_global_loss: 13500533.1250; val_optim_loss: 13500533.1250
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9441; val_auprc_score: 0.9136; val_best_acc_score: 0.8920; val_best_f1_score: 0.8959; train_kl_reg_loss: 31220.3704; train_edge_recon_loss: 2664882.6515; train_gene_expr_recon_loss: 5924370.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18293.0432; train_chrom_access_recon_loss: 4788048.6742; train_global_loss: 13426815.4091; train_optim_loss: 13426815.4091; val_kl_reg_loss: 27067.6843; val_edge_recon_loss: 2683239.7500; val_gene_expr_recon_loss: 5901810.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18292.4062; val_chrom_access_recon_loss: 4806851.9375; val_global_loss: 13437261.7500; val_optim_loss: 13437261.7500
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9464; val_auprc_score: 0.9180; val_best_acc_score: 0.8912; val_best_f1_score: 0.8984; train_kl_reg_loss: 31125.9975; train_edge_recon_loss: 2661949.7879; train_gene_expr_recon_loss: 5929014.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18292.1813; train_chrom_access_recon_loss: 4790359.8182; train_global_loss: 13430742.2576; train_optim_loss: 13430742.2576; val_kl_reg_loss: 26887.7820; val_edge_recon_loss: 2696863.9375; val_gene_expr_recon_loss: 5925764.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18292.1387; val_chrom_access_recon_loss: 4840611.9375; val_global_loss: 13508419.6250; val_optim_loss: 13508419.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 15 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9386
val AUPRC score: 0.9060
val best accuracy score: 0.8904
val best F1 score: 0.8972
val target rna MSE score: 6.5621
val source rna MSE score: 2.0288
val target atac MSE score: 0.3608
val source atac MSE score: 0.0732
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
