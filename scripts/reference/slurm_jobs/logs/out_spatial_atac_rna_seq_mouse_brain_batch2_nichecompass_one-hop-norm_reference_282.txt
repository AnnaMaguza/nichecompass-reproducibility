[True]
Run timestamp: 07092023_062246_282.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_282']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2863 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6459, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6464; val_auprc_score: 0.6399; val_best_acc_score: 0.5046; val_best_f1_score: 0.6683; train_kl_reg_loss: 58300.9916; train_edge_recon_loss: 3552555.5758; train_gene_expr_recon_loss: 14865406.6667; train_masked_gp_l1_reg_loss: 41686.3062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7614748.2917; train_chrom_access_recon_loss: 12396495.1667; train_global_loss: 38529193.0909; train_optim_loss: 38529193.0909; val_kl_reg_loss: 88947.1338; val_edge_recon_loss: 4065192.6562; val_gene_expr_recon_loss: 13665645.2500; val_masked_gp_l1_reg_loss: 38743.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2703399.0000; val_chrom_access_recon_loss: 11882154.3750; val_global_loss: 32444082.7500; val_optim_loss: 32444082.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6610; val_auprc_score: 0.6596; val_best_acc_score: 0.5285; val_best_f1_score: 0.6754; train_kl_reg_loss: 120853.1377; train_edge_recon_loss: 3540085.4621; train_gene_expr_recon_loss: 13241149.4848; train_masked_gp_l1_reg_loss: 35569.5563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 989138.9593; train_chrom_access_recon_loss: 11791609.1818; train_global_loss: 29718405.7576; train_optim_loss: 29718405.7576; val_kl_reg_loss: 129463.8896; val_edge_recon_loss: 4063354.9688; val_gene_expr_recon_loss: 13258435.6250; val_masked_gp_l1_reg_loss: 33618.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 327819.9062; val_chrom_access_recon_loss: 11793714.5000; val_global_loss: 29606407.2500; val_optim_loss: 29606407.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6982; val_auprc_score: 0.6870; val_best_acc_score: 0.6177; val_best_f1_score: 0.7040; train_kl_reg_loss: 115258.1191; train_edge_recon_loss: 3531626.9091; train_gene_expr_recon_loss: 12999934.5606; train_masked_gp_l1_reg_loss: 33408.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244559.1626; train_chrom_access_recon_loss: 11687289.5455; train_global_loss: 28612076.5152; train_optim_loss: 28612076.5152; val_kl_reg_loss: 103715.9102; val_edge_recon_loss: 4054968.3125; val_gene_expr_recon_loss: 13079187.0000; val_masked_gp_l1_reg_loss: 33629.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194454.0781; val_chrom_access_recon_loss: 11796145.5000; val_global_loss: 29262100.7500; val_optim_loss: 29262100.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7609; val_auprc_score: 0.7405; val_best_acc_score: 0.6824; val_best_f1_score: 0.7115; train_kl_reg_loss: 103351.1787; train_edge_recon_loss: 3521351.7083; train_gene_expr_recon_loss: 12886149.0909; train_masked_gp_l1_reg_loss: 34628.0973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171525.4794; train_chrom_access_recon_loss: 11609425.0152; train_global_loss: 28326430.5455; train_optim_loss: 28326430.5455; val_kl_reg_loss: 92364.1973; val_edge_recon_loss: 3995256.4688; val_gene_expr_recon_loss: 12947988.1250; val_masked_gp_l1_reg_loss: 35875.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153771.4531; val_chrom_access_recon_loss: 11630196.1250; val_global_loss: 28855452.7500; val_optim_loss: 28855452.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8304; val_auprc_score: 0.7981; val_best_acc_score: 0.7560; val_best_f1_score: 0.7887; train_kl_reg_loss: 86426.3194; train_edge_recon_loss: 3463865.0909; train_gene_expr_recon_loss: 12797071.0152; train_masked_gp_l1_reg_loss: 36941.7179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143325.5322; train_chrom_access_recon_loss: 11537030.5909; train_global_loss: 28064660.2727; train_optim_loss: 28064660.2727; val_kl_reg_loss: 70361.2119; val_edge_recon_loss: 3524267.0625; val_gene_expr_recon_loss: 12926593.0000; val_masked_gp_l1_reg_loss: 37859.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134166.3125; val_chrom_access_recon_loss: 11519822.3750; val_global_loss: 28213069.7500; val_optim_loss: 28213069.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8329; val_auprc_score: 0.8045; val_best_acc_score: 0.7477; val_best_f1_score: 0.7948; train_kl_reg_loss: 88125.1519; train_edge_recon_loss: 3140045.6364; train_gene_expr_recon_loss: 12747757.3030; train_masked_gp_l1_reg_loss: 39672.0911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130010.7404; train_chrom_access_recon_loss: 11481822.9697; train_global_loss: 27627434.0000; train_optim_loss: 27627434.0000; val_kl_reg_loss: 110536.2070; val_edge_recon_loss: 2983617.1562; val_gene_expr_recon_loss: 12983783.5000; val_masked_gp_l1_reg_loss: 41823.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127086.7109; val_chrom_access_recon_loss: 11577981.1250; val_global_loss: 27824828.0000; val_optim_loss: 27824828.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8240; val_auprc_score: 0.7821; val_best_acc_score: 0.7448; val_best_f1_score: 0.7890; train_kl_reg_loss: 115285.9744; train_edge_recon_loss: 2991194.8674; train_gene_expr_recon_loss: 12690609.6970; train_masked_gp_l1_reg_loss: 42389.1384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123195.4048; train_chrom_access_recon_loss: 11424310.9394; train_global_loss: 27386986.1212; train_optim_loss: 27386986.1212; val_kl_reg_loss: 119927.1631; val_edge_recon_loss: 2974829.6250; val_gene_expr_recon_loss: 12711222.7500; val_masked_gp_l1_reg_loss: 42753.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118960.2344; val_chrom_access_recon_loss: 11479041.1250; val_global_loss: 27446733.7500; val_optim_loss: 27446733.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8385; val_auprc_score: 0.8033; val_best_acc_score: 0.7507; val_best_f1_score: 0.7910; train_kl_reg_loss: 114425.5736; train_edge_recon_loss: 2956005.4432; train_gene_expr_recon_loss: 12615962.5606; train_masked_gp_l1_reg_loss: 43445.9132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116146.1209; train_chrom_access_recon_loss: 11371855.2273; train_global_loss: 27217840.7879; train_optim_loss: 27217840.7879; val_kl_reg_loss: 113375.8975; val_edge_recon_loss: 2970288.6250; val_gene_expr_recon_loss: 12809418.3750; val_masked_gp_l1_reg_loss: 44128.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113795.6328; val_chrom_access_recon_loss: 11380474.8750; val_global_loss: 27431482.5000; val_optim_loss: 27431482.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8514; val_auprc_score: 0.8119; val_best_acc_score: 0.7689; val_best_f1_score: 0.7928; train_kl_reg_loss: 112778.8629; train_edge_recon_loss: 2951122.1098; train_gene_expr_recon_loss: 12549595.5606; train_masked_gp_l1_reg_loss: 44739.8809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112219.3406; train_chrom_access_recon_loss: 11317289.3788; train_global_loss: 27087745.2121; train_optim_loss: 27087745.2121; val_kl_reg_loss: 111524.0625; val_edge_recon_loss: 2941396.7500; val_gene_expr_recon_loss: 12755509.5000; val_masked_gp_l1_reg_loss: 45513.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110819.2969; val_chrom_access_recon_loss: 11343018.2500; val_global_loss: 27307781.2500; val_optim_loss: 27307781.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8621; val_auprc_score: 0.8286; val_best_acc_score: 0.7845; val_best_f1_score: 0.8012; train_kl_reg_loss: 107130.5083; train_edge_recon_loss: 2936552.2614; train_gene_expr_recon_loss: 12486569.6818; train_masked_gp_l1_reg_loss: 46140.7854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109523.6051; train_chrom_access_recon_loss: 11259890.6818; train_global_loss: 26945807.4242; train_optim_loss: 26945807.4242; val_kl_reg_loss: 108457.6855; val_edge_recon_loss: 2989902.5312; val_gene_expr_recon_loss: 12692372.0000; val_masked_gp_l1_reg_loss: 46840.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108355.3125; val_chrom_access_recon_loss: 11390491.1250; val_global_loss: 27336419.5000; val_optim_loss: 27336419.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8950; val_auprc_score: 0.8556; val_best_acc_score: 0.8262; val_best_f1_score: 0.8397; train_kl_reg_loss: 104152.3873; train_edge_recon_loss: 2898172.5833; train_gene_expr_recon_loss: 12437221.2424; train_masked_gp_l1_reg_loss: 47453.4447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107520.4409; train_chrom_access_recon_loss: 11221617.9091; train_global_loss: 26816137.8788; train_optim_loss: 26816137.8788; val_kl_reg_loss: 104246.6992; val_edge_recon_loss: 2861252.8750; val_gene_expr_recon_loss: 12616917.6250; val_masked_gp_l1_reg_loss: 48125.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106894.4531; val_chrom_access_recon_loss: 11269331.0000; val_global_loss: 27006768.2500; val_optim_loss: 27006768.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8881; val_auprc_score: 0.8540; val_best_acc_score: 0.8189; val_best_f1_score: 0.8353; train_kl_reg_loss: 107582.4794; train_edge_recon_loss: 2849424.7955; train_gene_expr_recon_loss: 12389863.4697; train_masked_gp_l1_reg_loss: 48706.8194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106046.4760; train_chrom_access_recon_loss: 11181851.1970; train_global_loss: 26683475.1818; train_optim_loss: 26683475.1818; val_kl_reg_loss: 113959.2773; val_edge_recon_loss: 2897801.5312; val_gene_expr_recon_loss: 12527286.6250; val_masked_gp_l1_reg_loss: 49269.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105728.6797; val_chrom_access_recon_loss: 11248375.2500; val_global_loss: 26942421.7500; val_optim_loss: 26942421.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9013; val_auprc_score: 0.8704; val_best_acc_score: 0.8380; val_best_f1_score: 0.8511; train_kl_reg_loss: 108269.0389; train_edge_recon_loss: 2829300.6364; train_gene_expr_recon_loss: 12354105.7879; train_masked_gp_l1_reg_loss: 49825.6533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105698.8906; train_chrom_access_recon_loss: 11151637.3636; train_global_loss: 26598837.5455; train_optim_loss: 26598837.5455; val_kl_reg_loss: 111960.8340; val_edge_recon_loss: 2846213.6562; val_gene_expr_recon_loss: 12463844.8750; val_masked_gp_l1_reg_loss: 50407.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105992.1797; val_chrom_access_recon_loss: 11202299.8750; val_global_loss: 26780719.5000; val_optim_loss: 26780719.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9056; val_auprc_score: 0.8678; val_best_acc_score: 0.8461; val_best_f1_score: 0.8595; train_kl_reg_loss: 106600.7479; train_edge_recon_loss: 2822627.5417; train_gene_expr_recon_loss: 12319218.4545; train_masked_gp_l1_reg_loss: 50956.9194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105826.3345; train_chrom_access_recon_loss: 11104927.9242; train_global_loss: 26510157.9697; train_optim_loss: 26510157.9697; val_kl_reg_loss: 106045.5430; val_edge_recon_loss: 2826452.7500; val_gene_expr_recon_loss: 12492684.5000; val_masked_gp_l1_reg_loss: 51536.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105662.4453; val_chrom_access_recon_loss: 11264233.8750; val_global_loss: 26846616.2500; val_optim_loss: 26846616.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9044; val_auprc_score: 0.8713; val_best_acc_score: 0.8399; val_best_f1_score: 0.8532; train_kl_reg_loss: 108356.3707; train_edge_recon_loss: 2805386.8485; train_gene_expr_recon_loss: 12272686.0000; train_masked_gp_l1_reg_loss: 51991.0462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105395.4951; train_chrom_access_recon_loss: 11076283.7576; train_global_loss: 26420099.4242; train_optim_loss: 26420099.4242; val_kl_reg_loss: 107157.3545; val_edge_recon_loss: 2849831.8750; val_gene_expr_recon_loss: 12386461.0000; val_masked_gp_l1_reg_loss: 52432.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105782.5000; val_chrom_access_recon_loss: 11214706.6250; val_global_loss: 26716370.7500; val_optim_loss: 26716370.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9187; val_auprc_score: 0.8914; val_best_acc_score: 0.8576; val_best_f1_score: 0.8670; train_kl_reg_loss: 105909.1420; train_edge_recon_loss: 2794854.6288; train_gene_expr_recon_loss: 12234634.4394; train_masked_gp_l1_reg_loss: 52976.1387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105919.3666; train_chrom_access_recon_loss: 11034635.3182; train_global_loss: 26328928.9697; train_optim_loss: 26328928.9697; val_kl_reg_loss: 101858.4902; val_edge_recon_loss: 2799270.6562; val_gene_expr_recon_loss: 12420979.8750; val_masked_gp_l1_reg_loss: 53390.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106026.4531; val_chrom_access_recon_loss: 11138799.7500; val_global_loss: 26620324.2500; val_optim_loss: 26620324.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9219; val_auprc_score: 0.8948; val_best_acc_score: 0.8595; val_best_f1_score: 0.8713; train_kl_reg_loss: 104191.5793; train_edge_recon_loss: 2791268.4508; train_gene_expr_recon_loss: 12198419.2424; train_masked_gp_l1_reg_loss: 53882.5784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106019.6999; train_chrom_access_recon_loss: 11001185.5152; train_global_loss: 26254966.8788; train_optim_loss: 26254966.8788; val_kl_reg_loss: 102605.3506; val_edge_recon_loss: 2771131.1562; val_gene_expr_recon_loss: 12276028.7500; val_masked_gp_l1_reg_loss: 54345.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106346.1484; val_chrom_access_recon_loss: 11104125.7500; val_global_loss: 26414583.5000; val_optim_loss: 26414583.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9235; val_auprc_score: 0.8941; val_best_acc_score: 0.8635; val_best_f1_score: 0.8747; train_kl_reg_loss: 103150.5315; train_edge_recon_loss: 2780332.3902; train_gene_expr_recon_loss: 12170537.3636; train_masked_gp_l1_reg_loss: 54789.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106052.3219; train_chrom_access_recon_loss: 10971193.2424; train_global_loss: 26186055.7576; train_optim_loss: 26186055.7576; val_kl_reg_loss: 102306.8096; val_edge_recon_loss: 2783765.4375; val_gene_expr_recon_loss: 12241132.1250; val_masked_gp_l1_reg_loss: 55175.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106194.1484; val_chrom_access_recon_loss: 10942290.0000; val_global_loss: 26230863.2500; val_optim_loss: 26230863.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9183; val_auprc_score: 0.8893; val_best_acc_score: 0.8598; val_best_f1_score: 0.8694; train_kl_reg_loss: 102095.4422; train_edge_recon_loss: 2766903.3902; train_gene_expr_recon_loss: 12135523.7879; train_masked_gp_l1_reg_loss: 55626.3064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106191.3003; train_chrom_access_recon_loss: 10937904.8333; train_global_loss: 26104245.0909; train_optim_loss: 26104245.0909; val_kl_reg_loss: 102715.3467; val_edge_recon_loss: 2813709.9375; val_gene_expr_recon_loss: 12238715.0000; val_masked_gp_l1_reg_loss: 56115.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106396.7422; val_chrom_access_recon_loss: 10898092.6250; val_global_loss: 26215745.2500; val_optim_loss: 26215745.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9219; val_auprc_score: 0.8963; val_best_acc_score: 0.8616; val_best_f1_score: 0.8714; train_kl_reg_loss: 102919.0806; train_edge_recon_loss: 2762696.5568; train_gene_expr_recon_loss: 12118380.0152; train_masked_gp_l1_reg_loss: 56395.7878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106352.5547; train_chrom_access_recon_loss: 10920752.0758; train_global_loss: 26067496.1515; train_optim_loss: 26067496.1515; val_kl_reg_loss: 99082.0576; val_edge_recon_loss: 2786548.5000; val_gene_expr_recon_loss: 12247361.0000; val_masked_gp_l1_reg_loss: 56883.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106446.4844; val_chrom_access_recon_loss: 10928052.5000; val_global_loss: 26224374.0000; val_optim_loss: 26224374.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9279; val_auprc_score: 0.9027; val_best_acc_score: 0.8684; val_best_f1_score: 0.8768; train_kl_reg_loss: 100721.7029; train_edge_recon_loss: 2759602.8030; train_gene_expr_recon_loss: 12087627.7879; train_masked_gp_l1_reg_loss: 57175.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106239.4316; train_chrom_access_recon_loss: 10883085.3485; train_global_loss: 25994452.3939; train_optim_loss: 25994452.3939; val_kl_reg_loss: 102021.3096; val_edge_recon_loss: 2793764.3125; val_gene_expr_recon_loss: 12383172.1250; val_masked_gp_l1_reg_loss: 57559.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106051.7891; val_chrom_access_recon_loss: 11089836.0000; val_global_loss: 26532406.0000; val_optim_loss: 26532406.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9286; val_auprc_score: 0.9054; val_best_acc_score: 0.8702; val_best_f1_score: 0.8804; train_kl_reg_loss: 99268.5640; train_edge_recon_loss: 2754519.7500; train_gene_expr_recon_loss: 12053593.8333; train_masked_gp_l1_reg_loss: 57928.9980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106061.8803; train_chrom_access_recon_loss: 10859011.0758; train_global_loss: 25930384.0606; train_optim_loss: 25930384.0606; val_kl_reg_loss: 101789.1523; val_edge_recon_loss: 2777722.9688; val_gene_expr_recon_loss: 12183876.3750; val_masked_gp_l1_reg_loss: 58320.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106425.9453; val_chrom_access_recon_loss: 10862012.2500; val_global_loss: 26090147.7500; val_optim_loss: 26090147.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9326; val_auprc_score: 0.9119; val_best_acc_score: 0.8700; val_best_f1_score: 0.8787; train_kl_reg_loss: 99621.1828; train_edge_recon_loss: 2746642.4242; train_gene_expr_recon_loss: 12034833.4697; train_masked_gp_l1_reg_loss: 58563.2398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106102.9862; train_chrom_access_recon_loss: 10836116.2273; train_global_loss: 25881879.3030; train_optim_loss: 25881879.3030; val_kl_reg_loss: 97657.0000; val_edge_recon_loss: 2764844.0312; val_gene_expr_recon_loss: 12142001.2500; val_masked_gp_l1_reg_loss: 58979.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106251.0156; val_chrom_access_recon_loss: 10872831.2500; val_global_loss: 26042564.5000; val_optim_loss: 26042564.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9417; val_auprc_score: 0.9225; val_best_acc_score: 0.8842; val_best_f1_score: 0.8914; train_kl_reg_loss: 98558.9322; train_edge_recon_loss: 2745591.4811; train_gene_expr_recon_loss: 12001846.4394; train_masked_gp_l1_reg_loss: 59258.4511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106149.9993; train_chrom_access_recon_loss: 10802758.5000; train_global_loss: 25814163.7879; train_optim_loss: 25814163.7879; val_kl_reg_loss: 99495.1357; val_edge_recon_loss: 2741021.7812; val_gene_expr_recon_loss: 12156486.3750; val_masked_gp_l1_reg_loss: 59598.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105746.2578; val_chrom_access_recon_loss: 10954104.5000; val_global_loss: 26116451.7500; val_optim_loss: 26116451.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9384; val_auprc_score: 0.9192; val_best_acc_score: 0.8778; val_best_f1_score: 0.8847; train_kl_reg_loss: 97990.8800; train_edge_recon_loss: 2744731.0455; train_gene_expr_recon_loss: 11981418.4091; train_masked_gp_l1_reg_loss: 59876.1650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105990.9349; train_chrom_access_recon_loss: 10773278.0152; train_global_loss: 25763285.3333; train_optim_loss: 25763285.3333; val_kl_reg_loss: 99866.2461; val_edge_recon_loss: 2764010.0938; val_gene_expr_recon_loss: 12098352.2500; val_masked_gp_l1_reg_loss: 60170.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105812.0547; val_chrom_access_recon_loss: 10887593.3750; val_global_loss: 26015805.2500; val_optim_loss: 26015805.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9372; val_auprc_score: 0.9126; val_best_acc_score: 0.8831; val_best_f1_score: 0.8889; train_kl_reg_loss: 94553.8222; train_edge_recon_loss: 2772475.4659; train_gene_expr_recon_loss: 11811362.1212; train_masked_gp_l1_reg_loss: 59908.2236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110046.9612; train_chrom_access_recon_loss: 10723163.6818; train_global_loss: 25571510.3030; train_optim_loss: 25571510.3030; val_kl_reg_loss: 70170.5215; val_edge_recon_loss: 2794771.4688; val_gene_expr_recon_loss: 11908615.0000; val_masked_gp_l1_reg_loss: 59679.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110288.3906; val_chrom_access_recon_loss: 10624036.2500; val_global_loss: 25567561.2500; val_optim_loss: 25567561.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9352; val_auprc_score: 0.9078; val_best_acc_score: 0.8829; val_best_f1_score: 0.8886; train_kl_reg_loss: 98892.2459; train_edge_recon_loss: 2756441.9621; train_gene_expr_recon_loss: 11753872.5303; train_masked_gp_l1_reg_loss: 59741.6267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109209.7578; train_chrom_access_recon_loss: 10608340.5455; train_global_loss: 25386498.6061; train_optim_loss: 25386498.6061; val_kl_reg_loss: 73381.6426; val_edge_recon_loss: 2756502.9062; val_gene_expr_recon_loss: 11901483.1250; val_masked_gp_l1_reg_loss: 59855.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108303.0234; val_chrom_access_recon_loss: 10721891.6250; val_global_loss: 25621417.7500; val_optim_loss: 25621417.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9378; val_auprc_score: 0.9158; val_best_acc_score: 0.8818; val_best_f1_score: 0.8890; train_kl_reg_loss: 98124.9386; train_edge_recon_loss: 2741341.8750; train_gene_expr_recon_loss: 11732405.5606; train_masked_gp_l1_reg_loss: 59935.8292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107341.0629; train_chrom_access_recon_loss: 10584958.5000; train_global_loss: 25324107.5455; train_optim_loss: 25324107.5455; val_kl_reg_loss: 74463.2090; val_edge_recon_loss: 2769159.8750; val_gene_expr_recon_loss: 11827895.1250; val_masked_gp_l1_reg_loss: 60094.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106869.2969; val_chrom_access_recon_loss: 10643432.7500; val_global_loss: 25481913.5000; val_optim_loss: 25481913.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9394; val_auprc_score: 0.9167; val_best_acc_score: 0.8821; val_best_f1_score: 0.8897; train_kl_reg_loss: 95016.4316; train_edge_recon_loss: 2733802.2008; train_gene_expr_recon_loss: 11693290.5000; train_masked_gp_l1_reg_loss: 60174.3958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106530.8429; train_chrom_access_recon_loss: 10530600.1515; train_global_loss: 25219414.5455; train_optim_loss: 25219414.5455; val_kl_reg_loss: 75742.1758; val_edge_recon_loss: 2776274.3750; val_gene_expr_recon_loss: 11858386.6250; val_masked_gp_l1_reg_loss: 60266.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106236.9844; val_chrom_access_recon_loss: 10612110.5000; val_global_loss: 25489017.5000; val_optim_loss: 25489017.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9456; val_auprc_score: 0.9208; val_best_acc_score: 0.8941; val_best_f1_score: 0.8976; train_kl_reg_loss: 93416.7753; train_edge_recon_loss: 2738694.0985; train_gene_expr_recon_loss: 11662795.2879; train_masked_gp_l1_reg_loss: 60409.6945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105788.2840; train_chrom_access_recon_loss: 10495955.2576; train_global_loss: 25157059.4545; train_optim_loss: 25157059.4545; val_kl_reg_loss: 77203.1133; val_edge_recon_loss: 2733667.7188; val_gene_expr_recon_loss: 11840622.1250; val_masked_gp_l1_reg_loss: 60482.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105013.4766; val_chrom_access_recon_loss: 10580339.5000; val_global_loss: 25397327.7500; val_optim_loss: 25397327.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9385; val_auprc_score: 0.9164; val_best_acc_score: 0.8802; val_best_f1_score: 0.8875; train_kl_reg_loss: 91461.6821; train_edge_recon_loss: 2737072.5227; train_gene_expr_recon_loss: 11637190.5000; train_masked_gp_l1_reg_loss: 60608.2485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105352.6630; train_chrom_access_recon_loss: 10484850.5303; train_global_loss: 25116536.0606; train_optim_loss: 25116536.0606; val_kl_reg_loss: 79426.6533; val_edge_recon_loss: 2778907.8125; val_gene_expr_recon_loss: 11810254.2500; val_masked_gp_l1_reg_loss: 60707.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105281.3438; val_chrom_access_recon_loss: 10621042.7500; val_global_loss: 25455619.0000; val_optim_loss: 25455619.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9489; val_auprc_score: 0.9278; val_best_acc_score: 0.8912; val_best_f1_score: 0.8952; train_kl_reg_loss: 90232.0371; train_edge_recon_loss: 2724475.3144; train_gene_expr_recon_loss: 11609045.1667; train_masked_gp_l1_reg_loss: 60817.2518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104848.4302; train_chrom_access_recon_loss: 10453834.5909; train_global_loss: 25043252.8182; train_optim_loss: 25043252.8182; val_kl_reg_loss: 77766.3477; val_edge_recon_loss: 2752755.2812; val_gene_expr_recon_loss: 11778348.8750; val_masked_gp_l1_reg_loss: 60986.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105145.2578; val_chrom_access_recon_loss: 10513416.2500; val_global_loss: 25288417.2500; val_optim_loss: 25288417.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9430; val_auprc_score: 0.9252; val_best_acc_score: 0.8812; val_best_f1_score: 0.8884; train_kl_reg_loss: 90456.6194; train_edge_recon_loss: 2712190.4280; train_gene_expr_recon_loss: 11582392.6364; train_masked_gp_l1_reg_loss: 61085.1563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104410.0808; train_chrom_access_recon_loss: 10432214.6364; train_global_loss: 24982749.3636; train_optim_loss: 24982749.3636; val_kl_reg_loss: 79837.0430; val_edge_recon_loss: 2747247.0625; val_gene_expr_recon_loss: 11710081.2500; val_masked_gp_l1_reg_loss: 61226.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104671.8984; val_chrom_access_recon_loss: 10572732.0000; val_global_loss: 25275796.0000; val_optim_loss: 25275796.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9496; val_auprc_score: 0.9308; val_best_acc_score: 0.8904; val_best_f1_score: 0.8935; train_kl_reg_loss: 87818.3866; train_edge_recon_loss: 2721448.2803; train_gene_expr_recon_loss: 11556795.9697; train_masked_gp_l1_reg_loss: 61335.8315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104382.8106; train_chrom_access_recon_loss: 10395797.3030; train_global_loss: 24927578.6364; train_optim_loss: 24927578.6364; val_kl_reg_loss: 78045.0957; val_edge_recon_loss: 2771600.8750; val_gene_expr_recon_loss: 11718893.1250; val_masked_gp_l1_reg_loss: 61493.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103716.5625; val_chrom_access_recon_loss: 10402328.1250; val_global_loss: 25136077.5000; val_optim_loss: 25136077.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9482; val_auprc_score: 0.9258; val_best_acc_score: 0.8915; val_best_f1_score: 0.8964; train_kl_reg_loss: 88029.3374; train_edge_recon_loss: 2705741.3561; train_gene_expr_recon_loss: 11534831.6970; train_masked_gp_l1_reg_loss: 61597.9494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103952.9203; train_chrom_access_recon_loss: 10366103.3788; train_global_loss: 24860256.4545; train_optim_loss: 24860256.4545; val_kl_reg_loss: 79924.3271; val_edge_recon_loss: 2747251.0000; val_gene_expr_recon_loss: 11673051.3750; val_masked_gp_l1_reg_loss: 61709.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104219.1641; val_chrom_access_recon_loss: 10414448.6250; val_global_loss: 25080602.7500; val_optim_loss: 25080602.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9548; val_auprc_score: 0.9361; val_best_acc_score: 0.8992; val_best_f1_score: 0.9037; train_kl_reg_loss: 86892.5308; train_edge_recon_loss: 2714640.1212; train_gene_expr_recon_loss: 11526756.9091; train_masked_gp_l1_reg_loss: 61862.6930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103690.4318; train_chrom_access_recon_loss: 10353115.1970; train_global_loss: 24846957.6970; train_optim_loss: 24846957.6970; val_kl_reg_loss: 79972.2334; val_edge_recon_loss: 2749582.0312; val_gene_expr_recon_loss: 11669289.3750; val_masked_gp_l1_reg_loss: 61988.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104211.5781; val_chrom_access_recon_loss: 10351029.0000; val_global_loss: 25016072.7500; val_optim_loss: 25016072.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9527; val_auprc_score: 0.9396; val_best_acc_score: 0.8925; val_best_f1_score: 0.8973; train_kl_reg_loss: 86974.2229; train_edge_recon_loss: 2706483.1553; train_gene_expr_recon_loss: 11494031.8182; train_masked_gp_l1_reg_loss: 62125.8229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103695.0663; train_chrom_access_recon_loss: 10322014.5758; train_global_loss: 24775324.8182; train_optim_loss: 24775324.8182; val_kl_reg_loss: 77092.0586; val_edge_recon_loss: 2741222.5625; val_gene_expr_recon_loss: 11604780.8750; val_masked_gp_l1_reg_loss: 62226.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103945.9062; val_chrom_access_recon_loss: 10315417.8750; val_global_loss: 24904686.2500; val_optim_loss: 24904686.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9495; val_auprc_score: 0.9300; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 85169.0379; train_edge_recon_loss: 2709470.6326; train_gene_expr_recon_loss: 11482048.0455; train_masked_gp_l1_reg_loss: 62374.1582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103787.7112; train_chrom_access_recon_loss: 10301388.6667; train_global_loss: 24744238.0606; train_optim_loss: 24744238.0606; val_kl_reg_loss: 77179.1885; val_edge_recon_loss: 2739746.5312; val_gene_expr_recon_loss: 11678582.2500; val_masked_gp_l1_reg_loss: 62510.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103379.3828; val_chrom_access_recon_loss: 10455741.2500; val_global_loss: 25117138.2500; val_optim_loss: 25117138.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9555; val_auprc_score: 0.9319; val_best_acc_score: 0.9073; val_best_f1_score: 0.9106; train_kl_reg_loss: 84922.1656; train_edge_recon_loss: 2716059.3902; train_gene_expr_recon_loss: 11456855.1515; train_masked_gp_l1_reg_loss: 62667.4074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103526.4130; train_chrom_access_recon_loss: 10282828.4242; train_global_loss: 24706858.9697; train_optim_loss: 24706858.9697; val_kl_reg_loss: 79449.3691; val_edge_recon_loss: 2702451.3438; val_gene_expr_recon_loss: 11548681.8750; val_masked_gp_l1_reg_loss: 62763.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103132.9766; val_chrom_access_recon_loss: 10350854.5000; val_global_loss: 24847334.2500; val_optim_loss: 24847334.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9468; val_auprc_score: 0.9217; val_best_acc_score: 0.8939; val_best_f1_score: 0.8987; train_kl_reg_loss: 84742.9924; train_edge_recon_loss: 2706480.8220; train_gene_expr_recon_loss: 11448114.5909; train_masked_gp_l1_reg_loss: 62873.2511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103254.3319; train_chrom_access_recon_loss: 10267813.7121; train_global_loss: 24673279.6667; train_optim_loss: 24673279.6667; val_kl_reg_loss: 79574.8457; val_edge_recon_loss: 2769080.0312; val_gene_expr_recon_loss: 11702617.6250; val_masked_gp_l1_reg_loss: 63026.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103605.6953; val_chrom_access_recon_loss: 10361714.8750; val_global_loss: 25079619.2500; val_optim_loss: 25079619.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9561; val_auprc_score: 0.9330; val_best_acc_score: 0.9087; val_best_f1_score: 0.9118; train_kl_reg_loss: 83783.3478; train_edge_recon_loss: 2694132.8902; train_gene_expr_recon_loss: 11430700.1515; train_masked_gp_l1_reg_loss: 63117.1918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103193.1617; train_chrom_access_recon_loss: 10252527.8030; train_global_loss: 24627454.6061; train_optim_loss: 24627454.6061; val_kl_reg_loss: 76836.0713; val_edge_recon_loss: 2729042.0312; val_gene_expr_recon_loss: 11496413.2500; val_masked_gp_l1_reg_loss: 63230.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102635.8672; val_chrom_access_recon_loss: 10283428.3750; val_global_loss: 24751586.5000; val_optim_loss: 24751586.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9610; val_auprc_score: 0.9444; val_best_acc_score: 0.9132; val_best_f1_score: 0.9152; train_kl_reg_loss: 82330.2750; train_edge_recon_loss: 2710586.5303; train_gene_expr_recon_loss: 11427619.1212; train_masked_gp_l1_reg_loss: 63332.9319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103093.8981; train_chrom_access_recon_loss: 10255597.8333; train_global_loss: 24642560.5758; train_optim_loss: 24642560.5758; val_kl_reg_loss: 80508.2871; val_edge_recon_loss: 2715200.7500; val_gene_expr_recon_loss: 11631455.2500; val_masked_gp_l1_reg_loss: 63464.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103298.4219; val_chrom_access_recon_loss: 10336103.2500; val_global_loss: 24930029.5000; val_optim_loss: 24930029.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9576; val_auprc_score: 0.9404; val_best_acc_score: 0.9065; val_best_f1_score: 0.9109; train_kl_reg_loss: 82927.2205; train_edge_recon_loss: 2700752.6818; train_gene_expr_recon_loss: 11408270.7424; train_masked_gp_l1_reg_loss: 63592.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103100.1992; train_chrom_access_recon_loss: 10227589.0606; train_global_loss: 24586232.0606; train_optim_loss: 24586232.0606; val_kl_reg_loss: 76934.1338; val_edge_recon_loss: 2728502.1562; val_gene_expr_recon_loss: 11583567.2500; val_masked_gp_l1_reg_loss: 63707.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103328.8281; val_chrom_access_recon_loss: 10428021.0000; val_global_loss: 24984060.5000; val_optim_loss: 24984060.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9591; val_auprc_score: 0.9456; val_best_acc_score: 0.9033; val_best_f1_score: 0.9081; train_kl_reg_loss: 82027.1819; train_edge_recon_loss: 2702806.4848; train_gene_expr_recon_loss: 11392965.0758; train_masked_gp_l1_reg_loss: 63863.1070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103103.6174; train_chrom_access_recon_loss: 10217565.7727; train_global_loss: 24562331.3333; train_optim_loss: 24562331.3333; val_kl_reg_loss: 77753.4551; val_edge_recon_loss: 2740910.8125; val_gene_expr_recon_loss: 11633096.3750; val_masked_gp_l1_reg_loss: 63977.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102712.2188; val_chrom_access_recon_loss: 10299711.8750; val_global_loss: 24918162.5000; val_optim_loss: 24918162.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9565; val_auprc_score: 0.9365; val_best_acc_score: 0.9113; val_best_f1_score: 0.9137; train_kl_reg_loss: 81704.3432; train_edge_recon_loss: 2699832.7955; train_gene_expr_recon_loss: 11382428.2424; train_masked_gp_l1_reg_loss: 64072.9446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103052.6261; train_chrom_access_recon_loss: 10206955.7727; train_global_loss: 24538047.0303; train_optim_loss: 24538047.0303; val_kl_reg_loss: 78347.7617; val_edge_recon_loss: 2736643.0625; val_gene_expr_recon_loss: 11575011.0000; val_masked_gp_l1_reg_loss: 64241.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103001.6172; val_chrom_access_recon_loss: 10262053.7500; val_global_loss: 24819299.5000; val_optim_loss: 24819299.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9630; val_auprc_score: 0.9487; val_best_acc_score: 0.9130; val_best_f1_score: 0.9152; train_kl_reg_loss: 82647.5790; train_edge_recon_loss: 2690217.0000; train_gene_expr_recon_loss: 11364009.1970; train_masked_gp_l1_reg_loss: 63940.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79964.2533; train_chrom_access_recon_loss: 10191627.9394; train_global_loss: 24472405.9091; train_optim_loss: 24472405.9091; val_kl_reg_loss: 78472.2715; val_edge_recon_loss: 2724132.8750; val_gene_expr_recon_loss: 11507595.3750; val_masked_gp_l1_reg_loss: 63788.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75733.0547; val_chrom_access_recon_loss: 10229125.0000; val_global_loss: 24678847.7500; val_optim_loss: 24678847.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9554; val_auprc_score: 0.9383; val_best_acc_score: 0.9060; val_best_f1_score: 0.9110; train_kl_reg_loss: 82525.5002; train_edge_recon_loss: 2688071.9394; train_gene_expr_recon_loss: 11364241.6061; train_masked_gp_l1_reg_loss: 63749.7551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75473.9813; train_chrom_access_recon_loss: 10187338.8485; train_global_loss: 24461401.5455; train_optim_loss: 24461401.5455; val_kl_reg_loss: 78617.9678; val_edge_recon_loss: 2722998.8750; val_gene_expr_recon_loss: 11456497.5000; val_masked_gp_l1_reg_loss: 63713.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75393.5703; val_chrom_access_recon_loss: 10197768.8750; val_global_loss: 24594990.0000; val_optim_loss: 24594990.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9554; val_auprc_score: 0.9379; val_best_acc_score: 0.9062; val_best_f1_score: 0.9094; train_kl_reg_loss: 83376.5195; train_edge_recon_loss: 2688321.1667; train_gene_expr_recon_loss: 11364713.5455; train_masked_gp_l1_reg_loss: 63707.7101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75186.9973; train_chrom_access_recon_loss: 10189622.7424; train_global_loss: 24464928.4848; train_optim_loss: 24464928.4848; val_kl_reg_loss: 80206.7754; val_edge_recon_loss: 2722492.8125; val_gene_expr_recon_loss: 11537527.3750; val_masked_gp_l1_reg_loss: 63702.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75010.2500; val_chrom_access_recon_loss: 10311119.6250; val_global_loss: 24790058.7500; val_optim_loss: 24790058.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9634; val_auprc_score: 0.9486; val_best_acc_score: 0.9146; val_best_f1_score: 0.9168; train_kl_reg_loss: 83402.7856; train_edge_recon_loss: 2693506.9848; train_gene_expr_recon_loss: 11355586.8182; train_masked_gp_l1_reg_loss: 63697.4640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74943.2494; train_chrom_access_recon_loss: 10179105.6212; train_global_loss: 24450242.9394; train_optim_loss: 24450242.9394; val_kl_reg_loss: 79017.5410; val_edge_recon_loss: 2702198.8125; val_gene_expr_recon_loss: 11527280.7500; val_masked_gp_l1_reg_loss: 63699.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74894.0781; val_chrom_access_recon_loss: 10251054.0000; val_global_loss: 24698144.2500; val_optim_loss: 24698144.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9526; val_auprc_score: 0.9303; val_best_acc_score: 0.9054; val_best_f1_score: 0.9089; train_kl_reg_loss: 83082.4116; train_edge_recon_loss: 2687688.7235; train_gene_expr_recon_loss: 11353058.0152; train_masked_gp_l1_reg_loss: 63709.2533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74862.5901; train_chrom_access_recon_loss: 10178321.6515; train_global_loss: 24440722.4242; train_optim_loss: 24440722.4242; val_kl_reg_loss: 79458.5654; val_edge_recon_loss: 2735444.5625; val_gene_expr_recon_loss: 11532100.6250; val_masked_gp_l1_reg_loss: 63712.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74857.8125; val_chrom_access_recon_loss: 10263481.6250; val_global_loss: 24749055.0000; val_optim_loss: 24749055.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9541; val_auprc_score: 0.9335; val_best_acc_score: 0.9041; val_best_f1_score: 0.9076; train_kl_reg_loss: 83469.4464; train_edge_recon_loss: 2706690.5644; train_gene_expr_recon_loss: 11355876.8030; train_masked_gp_l1_reg_loss: 63726.6284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74693.9171; train_chrom_access_recon_loss: 10184267.6515; train_global_loss: 24468724.8485; train_optim_loss: 24468724.8485; val_kl_reg_loss: 78837.2295; val_edge_recon_loss: 2725917.8125; val_gene_expr_recon_loss: 11508916.8750; val_masked_gp_l1_reg_loss: 63732.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74568.6562; val_chrom_access_recon_loss: 10251761.8750; val_global_loss: 24703735.0000; val_optim_loss: 24703735.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9611; val_auprc_score: 0.9465; val_best_acc_score: 0.9111; val_best_f1_score: 0.9138; train_kl_reg_loss: 82915.3151; train_edge_recon_loss: 2690880.2197; train_gene_expr_recon_loss: 11341171.5455; train_masked_gp_l1_reg_loss: 63704.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71988.1044; train_chrom_access_recon_loss: 10162723.2273; train_global_loss: 24413382.9394; train_optim_loss: 24413382.9394; val_kl_reg_loss: 79567.6230; val_edge_recon_loss: 2709509.9375; val_gene_expr_recon_loss: 11469284.7500; val_masked_gp_l1_reg_loss: 63690.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71520.3359; val_chrom_access_recon_loss: 10179325.2500; val_global_loss: 24572898.2500; val_optim_loss: 24572898.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9598; val_auprc_score: 0.9432; val_best_acc_score: 0.9116; val_best_f1_score: 0.9142; train_kl_reg_loss: 83111.7082; train_edge_recon_loss: 2696057.7765; train_gene_expr_recon_loss: 11352791.2121; train_masked_gp_l1_reg_loss: 63684.5707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71492.0607; train_chrom_access_recon_loss: 10162350.5455; train_global_loss: 24429488.0000; train_optim_loss: 24429488.0000; val_kl_reg_loss: 79110.5186; val_edge_recon_loss: 2715425.7188; val_gene_expr_recon_loss: 11545003.5000; val_masked_gp_l1_reg_loss: 63679.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71474.6484; val_chrom_access_recon_loss: 10196815.6250; val_global_loss: 24671510.5000; val_optim_loss: 24671510.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9592; val_auprc_score: 0.9423; val_best_acc_score: 0.9108; val_best_f1_score: 0.9136; train_kl_reg_loss: 83030.9225; train_edge_recon_loss: 2697785.3409; train_gene_expr_recon_loss: 11353066.3333; train_masked_gp_l1_reg_loss: 63677.7671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71454.0808; train_chrom_access_recon_loss: 10158328.3939; train_global_loss: 24427342.8182; train_optim_loss: 24427342.8182; val_kl_reg_loss: 79521.6680; val_edge_recon_loss: 2710842.9375; val_gene_expr_recon_loss: 11540411.3750; val_masked_gp_l1_reg_loss: 63674.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71434.1406; val_chrom_access_recon_loss: 10237735.8750; val_global_loss: 24703619.7500; val_optim_loss: 24703619.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9592; val_auprc_score: 0.9431; val_best_acc_score: 0.9138; val_best_f1_score: 0.9161; train_kl_reg_loss: 82963.8955; train_edge_recon_loss: 2686454.3144; train_gene_expr_recon_loss: 11346556.7576; train_masked_gp_l1_reg_loss: 63673.3155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71428.0062; train_chrom_access_recon_loss: 10161882.3788; train_global_loss: 24412958.4848; train_optim_loss: 24412958.4848; val_kl_reg_loss: 79897.9121; val_edge_recon_loss: 2710444.5938; val_gene_expr_recon_loss: 11513693.6250; val_masked_gp_l1_reg_loss: 63672.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71414.8203; val_chrom_access_recon_loss: 10362601.7500; val_global_loss: 24801724.7500; val_optim_loss: 24801724.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9576; val_auprc_score: 0.9409; val_best_acc_score: 0.9073; val_best_f1_score: 0.9105; train_kl_reg_loss: 83083.1796; train_edge_recon_loss: 2691061.1061; train_gene_expr_recon_loss: 11345518.3788; train_masked_gp_l1_reg_loss: 63672.1048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71402.6006; train_chrom_access_recon_loss: 10160345.1212; train_global_loss: 24415082.5758; train_optim_loss: 24415082.5758; val_kl_reg_loss: 79471.8623; val_edge_recon_loss: 2712290.5000; val_gene_expr_recon_loss: 11529205.6250; val_masked_gp_l1_reg_loss: 63671.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71397.2031; val_chrom_access_recon_loss: 10311413.0000; val_global_loss: 24767449.0000; val_optim_loss: 24767449.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9583; val_auprc_score: 0.9434; val_best_acc_score: 0.9108; val_best_f1_score: 0.9135; train_kl_reg_loss: 83130.1942; train_edge_recon_loss: 2682141.5227; train_gene_expr_recon_loss: 11344949.6818; train_masked_gp_l1_reg_loss: 63668.3236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71132.3562; train_chrom_access_recon_loss: 10163575.1667; train_global_loss: 24408597.3030; train_optim_loss: 24408597.3030; val_kl_reg_loss: 79351.2266; val_edge_recon_loss: 2714320.4688; val_gene_expr_recon_loss: 11447286.6250; val_masked_gp_l1_reg_loss: 63667.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71083.5000; val_chrom_access_recon_loss: 10202010.3750; val_global_loss: 24577719.0000; val_optim_loss: 24577719.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9513; val_auprc_score: 0.9269; val_best_acc_score: 0.9006; val_best_f1_score: 0.9047; train_kl_reg_loss: 83062.2313; train_edge_recon_loss: 2685498.9773; train_gene_expr_recon_loss: 11343672.8939; train_masked_gp_l1_reg_loss: 63666.4708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71080.8613; train_chrom_access_recon_loss: 10156778.1061; train_global_loss: 24403759.5455; train_optim_loss: 24403759.5455; val_kl_reg_loss: 79774.4971; val_edge_recon_loss: 2743633.5312; val_gene_expr_recon_loss: 11464465.3750; val_masked_gp_l1_reg_loss: 63665.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71078.5469; val_chrom_access_recon_loss: 10248313.6250; val_global_loss: 24670931.7500; val_optim_loss: 24670931.7500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9610; val_auprc_score: 0.9436; val_best_acc_score: 0.9132; val_best_f1_score: 0.9157; train_kl_reg_loss: 83036.9029; train_edge_recon_loss: 2688305.2083; train_gene_expr_recon_loss: 11342718.7273; train_masked_gp_l1_reg_loss: 63665.7588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71076.2521; train_chrom_access_recon_loss: 10159398.1970; train_global_loss: 24408201.1818; train_optim_loss: 24408201.1818; val_kl_reg_loss: 79555.9062; val_edge_recon_loss: 2730780.9375; val_gene_expr_recon_loss: 11499292.2500; val_masked_gp_l1_reg_loss: 63665.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71074.4766; val_chrom_access_recon_loss: 10235717.2500; val_global_loss: 24680085.7500; val_optim_loss: 24680085.7500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9593; val_auprc_score: 0.9419; val_best_acc_score: 0.9113; val_best_f1_score: 0.9135; train_kl_reg_loss: 83121.6314; train_edge_recon_loss: 2698004.6970; train_gene_expr_recon_loss: 11345659.4394; train_masked_gp_l1_reg_loss: 63665.2966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71072.9759; train_chrom_access_recon_loss: 10161308.5152; train_global_loss: 24422832.1515; train_optim_loss: 24422832.1515; val_kl_reg_loss: 80017.3984; val_edge_recon_loss: 2729326.4688; val_gene_expr_recon_loss: 11516256.7500; val_masked_gp_l1_reg_loss: 63665.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71071.5938; val_chrom_access_recon_loss: 10217822.6250; val_global_loss: 24678160.0000; val_optim_loss: 24678160.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 14 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9547
val AUPRC score: 0.9383
val best accuracy score: 0.9006
val best F1 score: 0.9051
val target rna MSE score: 1.1102
val source rna MSE score: 0.4297
val target atac MSE score: 0.3278
val source atac MSE score: 0.0724
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
