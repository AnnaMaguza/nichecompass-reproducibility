[True]
Run timestamp: 21072023_093719_1028.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '20', '--filter_genes', '--n_hvg', '2000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.0', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1028']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 2034 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 2034, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1471, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 4068
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8834; val_auprc_score: 0.9743; val_best_acc_score: 0.8895; val_best_f1_score: 0.9389; train_kl_reg_loss: 54356.6805; train_edge_recon_loss: 117253.9391; train_gene_expr_recon_loss: 1379583.1950; train_masked_gp_l1_reg_loss: 4328.6031; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1555522.4201; train_optim_loss: 1555522.4201; val_kl_reg_loss: 43277.1552; val_edge_recon_loss: 116388.9771; val_gene_expr_recon_loss: 906308.0129; val_masked_gp_l1_reg_loss: 3816.8608; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1069791.0151; val_optim_loss: 1069791.0151
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9189; val_auprc_score: 0.9812; val_best_acc_score: 0.9238; val_best_f1_score: 0.9567; train_kl_reg_loss: 36619.3315; train_edge_recon_loss: 113866.8294; train_gene_expr_recon_loss: 887656.4015; train_masked_gp_l1_reg_loss: 3668.4915; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1041811.0557; train_optim_loss: 1041811.0557; val_kl_reg_loss: 34077.3114; val_edge_recon_loss: 115444.2885; val_gene_expr_recon_loss: 860414.1293; val_masked_gp_l1_reg_loss: 3709.1899; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1013644.9181; val_optim_loss: 1013644.9181
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9273; val_auprc_score: 0.9827; val_best_acc_score: 0.9334; val_best_f1_score: 0.9618; train_kl_reg_loss: 28760.9182; train_edge_recon_loss: 110587.8451; train_gene_expr_recon_loss: 836948.9213; train_masked_gp_l1_reg_loss: 3716.9441; train_group_lasso_reg_loss: 0.0000; train_global_loss: 980014.6293; train_optim_loss: 980014.6293; val_kl_reg_loss: 26562.8215; val_edge_recon_loss: 110051.7697; val_gene_expr_recon_loss: 820240.8772; val_masked_gp_l1_reg_loss: 3795.6382; val_group_lasso_reg_loss: 0.0000; val_global_loss: 960651.0948; val_optim_loss: 960651.0948
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9365; val_auprc_score: 0.9858; val_best_acc_score: 0.9404; val_best_f1_score: 0.9659; train_kl_reg_loss: 25133.1022; train_edge_recon_loss: 104829.9149; train_gene_expr_recon_loss: 808360.1178; train_masked_gp_l1_reg_loss: 3919.0603; train_group_lasso_reg_loss: 0.0000; train_global_loss: 942242.1933; train_optim_loss: 942242.1933; val_kl_reg_loss: 23931.0062; val_edge_recon_loss: 102566.1266; val_gene_expr_recon_loss: 796551.8491; val_masked_gp_l1_reg_loss: 4065.1672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 927114.1638; val_optim_loss: 927114.1638
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9431; val_auprc_score: 0.9872; val_best_acc_score: 0.9410; val_best_f1_score: 0.9661; train_kl_reg_loss: 22892.5084; train_edge_recon_loss: 101479.9711; train_gene_expr_recon_loss: 787604.7872; train_masked_gp_l1_reg_loss: 4219.4711; train_group_lasso_reg_loss: 0.0000; train_global_loss: 916196.7391; train_optim_loss: 916196.7391; val_kl_reg_loss: 21800.9999; val_edge_recon_loss: 101691.2958; val_gene_expr_recon_loss: 778225.7608; val_masked_gp_l1_reg_loss: 4373.6416; val_group_lasso_reg_loss: 0.0000; val_global_loss: 906091.6853; val_optim_loss: 906091.6853
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9479; val_auprc_score: 0.9883; val_best_acc_score: 0.9461; val_best_f1_score: 0.9691; train_kl_reg_loss: 21089.9112; train_edge_recon_loss: 98552.8198; train_gene_expr_recon_loss: 770652.7222; train_masked_gp_l1_reg_loss: 4525.9416; train_group_lasso_reg_loss: 0.0000; train_global_loss: 894821.3929; train_optim_loss: 894821.3929; val_kl_reg_loss: 19909.1751; val_edge_recon_loss: 97290.6474; val_gene_expr_recon_loss: 763551.6078; val_masked_gp_l1_reg_loss: 4677.5894; val_group_lasso_reg_loss: 0.0000; val_global_loss: 885428.9978; val_optim_loss: 885428.9978
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9529; val_auprc_score: 0.9895; val_best_acc_score: 0.9488; val_best_f1_score: 0.9706; train_kl_reg_loss: 19601.9869; train_edge_recon_loss: 97374.6189; train_gene_expr_recon_loss: 756638.9546; train_masked_gp_l1_reg_loss: 4820.3089; train_group_lasso_reg_loss: 0.0000; train_global_loss: 878435.8675; train_optim_loss: 878435.8675; val_kl_reg_loss: 19045.4394; val_edge_recon_loss: 95740.1113; val_gene_expr_recon_loss: 749560.9310; val_masked_gp_l1_reg_loss: 4963.8423; val_group_lasso_reg_loss: 0.0000; val_global_loss: 869310.2888; val_optim_loss: 869310.2888
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9552; val_auprc_score: 0.9901; val_best_acc_score: 0.9497; val_best_f1_score: 0.9710; train_kl_reg_loss: 18314.3926; train_edge_recon_loss: 95617.9252; train_gene_expr_recon_loss: 744655.2237; train_masked_gp_l1_reg_loss: 5101.4910; train_group_lasso_reg_loss: 0.0000; train_global_loss: 863689.0326; train_optim_loss: 863689.0326; val_kl_reg_loss: 17658.8903; val_edge_recon_loss: 95690.4006; val_gene_expr_recon_loss: 737983.5948; val_masked_gp_l1_reg_loss: 5237.6738; val_group_lasso_reg_loss: 0.0000; val_global_loss: 856570.5690; val_optim_loss: 856570.5690
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9619; val_auprc_score: 0.9913; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 17193.2318; train_edge_recon_loss: 93793.5180; train_gene_expr_recon_loss: 733392.4399; train_masked_gp_l1_reg_loss: 5350.5365; train_group_lasso_reg_loss: 0.0000; train_global_loss: 849729.7266; train_optim_loss: 849729.7266; val_kl_reg_loss: 16644.6564; val_edge_recon_loss: 93825.4863; val_gene_expr_recon_loss: 727907.6444; val_masked_gp_l1_reg_loss: 5472.1426; val_group_lasso_reg_loss: 0.0000; val_global_loss: 843849.9116; val_optim_loss: 843849.9116
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9646; val_auprc_score: 0.9919; val_best_acc_score: 0.9560; val_best_f1_score: 0.9747; train_kl_reg_loss: 16222.2786; train_edge_recon_loss: 92872.6920; train_gene_expr_recon_loss: 725008.8656; train_masked_gp_l1_reg_loss: 5603.5492; train_group_lasso_reg_loss: 0.0000; train_global_loss: 839707.3844; train_optim_loss: 839707.3844; val_kl_reg_loss: 15862.4365; val_edge_recon_loss: 91403.7861; val_gene_expr_recon_loss: 718895.2931; val_masked_gp_l1_reg_loss: 5695.9619; val_group_lasso_reg_loss: 0.0000; val_global_loss: 831857.4526; val_optim_loss: 831857.4526
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9684; val_auprc_score: 0.9924; val_best_acc_score: 0.9597; val_best_f1_score: 0.9767; train_kl_reg_loss: 15296.5881; train_edge_recon_loss: 90848.6059; train_gene_expr_recon_loss: 715451.9247; train_masked_gp_l1_reg_loss: 5778.7559; train_group_lasso_reg_loss: 0.0000; train_global_loss: 827375.8736; train_optim_loss: 827375.8736; val_kl_reg_loss: 14985.7646; val_edge_recon_loss: 90809.0458; val_gene_expr_recon_loss: 710879.8685; val_masked_gp_l1_reg_loss: 5878.4971; val_group_lasso_reg_loss: 0.0000; val_global_loss: 822553.1746; val_optim_loss: 822553.1746
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9706; val_auprc_score: 0.9933; val_best_acc_score: 0.9616; val_best_f1_score: 0.9778; train_kl_reg_loss: 14481.6005; train_edge_recon_loss: 90408.2854; train_gene_expr_recon_loss: 708515.7780; train_masked_gp_l1_reg_loss: 5965.0644; train_group_lasso_reg_loss: 0.0000; train_global_loss: 819370.7295; train_optim_loss: 819370.7295; val_kl_reg_loss: 13820.0614; val_edge_recon_loss: 89948.8626; val_gene_expr_recon_loss: 705228.1056; val_masked_gp_l1_reg_loss: 6082.6992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 815079.7155; val_optim_loss: 815079.7155
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9744; val_auprc_score: 0.9939; val_best_acc_score: 0.9659; val_best_f1_score: 0.9802; train_kl_reg_loss: 13708.5974; train_edge_recon_loss: 88728.9141; train_gene_expr_recon_loss: 701100.2884; train_masked_gp_l1_reg_loss: 6104.7057; train_group_lasso_reg_loss: 0.0000; train_global_loss: 809642.5043; train_optim_loss: 809642.5043; val_kl_reg_loss: 13704.1541; val_edge_recon_loss: 89425.8957; val_gene_expr_recon_loss: 698126.4720; val_masked_gp_l1_reg_loss: 6169.7651; val_group_lasso_reg_loss: 0.0000; val_global_loss: 807426.2759; val_optim_loss: 807426.2759
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9751; val_auprc_score: 0.9941; val_best_acc_score: 0.9667; val_best_f1_score: 0.9807; train_kl_reg_loss: 12943.2254; train_edge_recon_loss: 88071.2049; train_gene_expr_recon_loss: 694973.9665; train_masked_gp_l1_reg_loss: 6233.1407; train_group_lasso_reg_loss: 0.0000; train_global_loss: 802221.5389; train_optim_loss: 802221.5389; val_kl_reg_loss: 12512.3679; val_edge_recon_loss: 87777.3435; val_gene_expr_recon_loss: 691754.8707; val_masked_gp_l1_reg_loss: 6312.1689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 798356.7651; val_optim_loss: 798356.7651
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9752; val_auprc_score: 0.9942; val_best_acc_score: 0.9672; val_best_f1_score: 0.9810; train_kl_reg_loss: 12133.3432; train_edge_recon_loss: 86935.4563; train_gene_expr_recon_loss: 689682.5688; train_masked_gp_l1_reg_loss: 6369.5746; train_group_lasso_reg_loss: 0.0000; train_global_loss: 795120.9443; train_optim_loss: 795120.9443; val_kl_reg_loss: 11311.9203; val_edge_recon_loss: 86239.3516; val_gene_expr_recon_loss: 687053.4073; val_masked_gp_l1_reg_loss: 6446.6592; val_group_lasso_reg_loss: 0.0000; val_global_loss: 791051.3707; val_optim_loss: 791051.3707
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9746; val_auprc_score: 0.9939; val_best_acc_score: 0.9671; val_best_f1_score: 0.9809; train_kl_reg_loss: 11419.0886; train_edge_recon_loss: 85882.6829; train_gene_expr_recon_loss: 683997.8434; train_masked_gp_l1_reg_loss: 6473.9358; train_group_lasso_reg_loss: 0.0000; train_global_loss: 787773.5538; train_optim_loss: 787773.5538; val_kl_reg_loss: 10920.4470; val_edge_recon_loss: 86612.1369; val_gene_expr_recon_loss: 682642.0647; val_masked_gp_l1_reg_loss: 6526.3242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 786700.9612; val_optim_loss: 786700.9612
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9761; val_auprc_score: 0.9943; val_best_acc_score: 0.9687; val_best_f1_score: 0.9818; train_kl_reg_loss: 10722.2398; train_edge_recon_loss: 85410.6933; train_gene_expr_recon_loss: 679890.9208; train_masked_gp_l1_reg_loss: 6537.9731; train_group_lasso_reg_loss: 0.0000; train_global_loss: 782561.8299; train_optim_loss: 782561.8299; val_kl_reg_loss: 10042.9861; val_edge_recon_loss: 84615.8235; val_gene_expr_recon_loss: 676456.6228; val_masked_gp_l1_reg_loss: 6567.4272; val_group_lasso_reg_loss: 0.0000; val_global_loss: 777682.8707; val_optim_loss: 777682.8707
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9744; val_auprc_score: 0.9939; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 9954.4746; train_edge_recon_loss: 87020.2253; train_gene_expr_recon_loss: 692175.7230; train_masked_gp_l1_reg_loss: 6797.6068; train_group_lasso_reg_loss: 0.0000; train_global_loss: 795948.0302; train_optim_loss: 795948.0302; val_kl_reg_loss: 9616.8115; val_edge_recon_loss: 83992.5361; val_gene_expr_recon_loss: 676605.4159; val_masked_gp_l1_reg_loss: 6616.0801; val_group_lasso_reg_loss: 0.0000; val_global_loss: 776830.8341; val_optim_loss: 776830.8341
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9761; val_auprc_score: 0.9943; val_best_acc_score: 0.9683; val_best_f1_score: 0.9816; train_kl_reg_loss: 9344.3269; train_edge_recon_loss: 83513.8121; train_gene_expr_recon_loss: 674177.5596; train_masked_gp_l1_reg_loss: 6566.2158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 773601.9146; train_optim_loss: 773601.9146; val_kl_reg_loss: 9041.2896; val_edge_recon_loss: 82872.1034; val_gene_expr_recon_loss: 671235.2866; val_masked_gp_l1_reg_loss: 6534.2646; val_group_lasso_reg_loss: 0.0000; val_global_loss: 769682.9289; val_optim_loss: 769682.9289
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9748; val_auprc_score: 0.9934; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 8840.9636; train_edge_recon_loss: 83268.6931; train_gene_expr_recon_loss: 670556.0427; train_masked_gp_l1_reg_loss: 6493.0981; train_group_lasso_reg_loss: 0.0000; train_global_loss: 769158.7980; train_optim_loss: 769158.7980; val_kl_reg_loss: 8705.3956; val_edge_recon_loss: 83404.3109; val_gene_expr_recon_loss: 669077.5862; val_masked_gp_l1_reg_loss: 6443.4023; val_group_lasso_reg_loss: 0.0000; val_global_loss: 767630.6638; val_optim_loss: 767630.6638
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9764; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9824; train_kl_reg_loss: 8359.1889; train_edge_recon_loss: 82288.4578; train_gene_expr_recon_loss: 666875.7722; train_masked_gp_l1_reg_loss: 6390.2637; train_group_lasso_reg_loss: 0.0000; train_global_loss: 763913.6824; train_optim_loss: 763913.6824; val_kl_reg_loss: 8022.3229; val_edge_recon_loss: 81355.9275; val_gene_expr_recon_loss: 665095.3017; val_masked_gp_l1_reg_loss: 6330.2905; val_group_lasso_reg_loss: 0.0000; val_global_loss: 760803.8599; val_optim_loss: 760803.8599
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9774; val_auprc_score: 0.9948; val_best_acc_score: 0.9705; val_best_f1_score: 0.9829; train_kl_reg_loss: 7934.2405; train_edge_recon_loss: 81481.5880; train_gene_expr_recon_loss: 663800.2384; train_masked_gp_l1_reg_loss: 6254.3721; train_group_lasso_reg_loss: 0.0000; train_global_loss: 759470.4377; train_optim_loss: 759470.4377; val_kl_reg_loss: 7613.2307; val_edge_recon_loss: 79998.8502; val_gene_expr_recon_loss: 662241.7953; val_masked_gp_l1_reg_loss: 6191.9590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 756045.8103; val_optim_loss: 756045.8103
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9758; val_auprc_score: 0.9942; val_best_acc_score: 0.9690; val_best_f1_score: 0.9820; train_kl_reg_loss: 7562.5961; train_edge_recon_loss: 80664.4831; train_gene_expr_recon_loss: 660790.1204; train_masked_gp_l1_reg_loss: 6106.2884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 755123.4913; train_optim_loss: 755123.4913; val_kl_reg_loss: 7309.6477; val_edge_recon_loss: 81185.8834; val_gene_expr_recon_loss: 659298.4483; val_masked_gp_l1_reg_loss: 6041.3857; val_group_lasso_reg_loss: 0.0000; val_global_loss: 753835.3513; val_optim_loss: 753835.3513
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9776; val_auprc_score: 0.9941; val_best_acc_score: 0.9709; val_best_f1_score: 0.9831; train_kl_reg_loss: 7233.6035; train_edge_recon_loss: 80250.2396; train_gene_expr_recon_loss: 658899.6810; train_masked_gp_l1_reg_loss: 5922.4156; train_group_lasso_reg_loss: 0.0000; train_global_loss: 752305.9394; train_optim_loss: 752305.9394; val_kl_reg_loss: 7049.0794; val_edge_recon_loss: 80183.6255; val_gene_expr_recon_loss: 657304.1401; val_masked_gp_l1_reg_loss: 5821.0522; val_group_lasso_reg_loss: 0.0000; val_global_loss: 750357.9073; val_optim_loss: 750357.9073
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9783; val_auprc_score: 0.9948; val_best_acc_score: 0.9708; val_best_f1_score: 0.9830; train_kl_reg_loss: 7023.7306; train_edge_recon_loss: 79853.1986; train_gene_expr_recon_loss: 656308.4196; train_masked_gp_l1_reg_loss: 5727.3937; train_group_lasso_reg_loss: 0.0000; train_global_loss: 748912.7403; train_optim_loss: 748912.7403; val_kl_reg_loss: 7122.2076; val_edge_recon_loss: 79289.1166; val_gene_expr_recon_loss: 657226.1509; val_masked_gp_l1_reg_loss: 5637.9521; val_group_lasso_reg_loss: 0.0000; val_global_loss: 749275.4073; val_optim_loss: 749275.4073
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9724; val_auprc_score: 0.9933; val_best_acc_score: 0.9637; val_best_f1_score: 0.9790; train_kl_reg_loss: 5339.5111; train_edge_recon_loss: 80407.1176; train_gene_expr_recon_loss: 678787.2983; train_masked_gp_l1_reg_loss: 5704.8520; train_group_lasso_reg_loss: 0.0000; train_global_loss: 770238.7790; train_optim_loss: 770238.7790; val_kl_reg_loss: 3474.6938; val_edge_recon_loss: 79791.4362; val_gene_expr_recon_loss: 672481.6573; val_masked_gp_l1_reg_loss: 5547.1509; val_group_lasso_reg_loss: 0.0000; val_global_loss: 761294.9138; val_optim_loss: 761294.9138
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9751; val_auprc_score: 0.9938; val_best_acc_score: 0.9672; val_best_f1_score: 0.9809; train_kl_reg_loss: 4785.6344; train_edge_recon_loss: 79299.9589; train_gene_expr_recon_loss: 670606.1450; train_masked_gp_l1_reg_loss: 5387.8103; train_group_lasso_reg_loss: 0.0000; train_global_loss: 760079.5485; train_optim_loss: 760079.5485; val_kl_reg_loss: 3515.8647; val_edge_recon_loss: 78739.4044; val_gene_expr_recon_loss: 669829.8858; val_masked_gp_l1_reg_loss: 5239.9072; val_group_lasso_reg_loss: 0.0000; val_global_loss: 757325.0927; val_optim_loss: 757325.0927
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9765; val_auprc_score: 0.9946; val_best_acc_score: 0.9679; val_best_f1_score: 0.9814; train_kl_reg_loss: 4456.7975; train_edge_recon_loss: 78769.1440; train_gene_expr_recon_loss: 667911.8132; train_masked_gp_l1_reg_loss: 5111.1623; train_group_lasso_reg_loss: 0.0000; train_global_loss: 756248.9172; train_optim_loss: 756248.9172; val_kl_reg_loss: 3697.1295; val_edge_recon_loss: 78587.6765; val_gene_expr_recon_loss: 667320.3470; val_masked_gp_l1_reg_loss: 4999.0830; val_group_lasso_reg_loss: 0.0000; val_global_loss: 754604.2134; val_optim_loss: 754604.2134
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9753; val_auprc_score: 0.9940; val_best_acc_score: 0.9686; val_best_f1_score: 0.9818; train_kl_reg_loss: 4225.9701; train_edge_recon_loss: 78383.5134; train_gene_expr_recon_loss: 666137.6441; train_masked_gp_l1_reg_loss: 4894.5984; train_group_lasso_reg_loss: 0.0000; train_global_loss: 753641.7218; train_optim_loss: 753641.7218; val_kl_reg_loss: 3640.0127; val_edge_recon_loss: 78710.3526; val_gene_expr_recon_loss: 665546.0216; val_masked_gp_l1_reg_loss: 4790.9150; val_group_lasso_reg_loss: 0.0000; val_global_loss: 752687.3190; val_optim_loss: 752687.3190

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9752; val_auprc_score: 0.9939; val_best_acc_score: 0.9680; val_best_f1_score: 0.9814; train_kl_reg_loss: 4164.9413; train_edge_recon_loss: 78427.7974; train_gene_expr_recon_loss: 663746.2978; train_masked_gp_l1_reg_loss: 4750.9508; train_group_lasso_reg_loss: 0.0000; train_global_loss: 751089.9891; train_optim_loss: 751089.9891; val_kl_reg_loss: 3648.1351; val_edge_recon_loss: 78499.0143; val_gene_expr_recon_loss: 663675.3491; val_masked_gp_l1_reg_loss: 4735.3711; val_group_lasso_reg_loss: 0.0000; val_global_loss: 750557.8772; val_optim_loss: 750557.8772
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9754; val_auprc_score: 0.9939; val_best_acc_score: 0.9681; val_best_f1_score: 0.9815; train_kl_reg_loss: 4146.5937; train_edge_recon_loss: 78270.5097; train_gene_expr_recon_loss: 663412.7184; train_masked_gp_l1_reg_loss: 4724.6168; train_group_lasso_reg_loss: 0.0000; train_global_loss: 750554.4375; train_optim_loss: 750554.4375; val_kl_reg_loss: 3639.3912; val_edge_recon_loss: 78345.0377; val_gene_expr_recon_loss: 663974.3685; val_masked_gp_l1_reg_loss: 4714.6816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 750673.4828; val_optim_loss: 750673.4828
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9760; val_auprc_score: 0.9943; val_best_acc_score: 0.9684; val_best_f1_score: 0.9816; train_kl_reg_loss: 4127.3713; train_edge_recon_loss: 78351.0495; train_gene_expr_recon_loss: 663930.8919; train_masked_gp_l1_reg_loss: 4703.2198; train_group_lasso_reg_loss: 0.0000; train_global_loss: 751112.5326; train_optim_loss: 751112.5326; val_kl_reg_loss: 3683.3222; val_edge_recon_loss: 79160.6703; val_gene_expr_recon_loss: 663651.6875; val_masked_gp_l1_reg_loss: 4693.4092; val_group_lasso_reg_loss: 0.0000; val_global_loss: 751189.1207; val_optim_loss: 751189.1207
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9744; val_auprc_score: 0.9941; val_best_acc_score: 0.9670; val_best_f1_score: 0.9809; train_kl_reg_loss: 4105.0719; train_edge_recon_loss: 78127.0577; train_gene_expr_recon_loss: 663492.3439; train_masked_gp_l1_reg_loss: 4681.1571; train_group_lasso_reg_loss: 0.0000; train_global_loss: 750405.6301; train_optim_loss: 750405.6301; val_kl_reg_loss: 3615.4173; val_edge_recon_loss: 78263.8731; val_gene_expr_recon_loss: 663437.3685; val_masked_gp_l1_reg_loss: 4670.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 749986.8448; val_optim_loss: 749986.8448

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 115 min 9 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9724
Val AUPRC score: 0.9935
Val best accuracy score: 0.9614
Val best F1 score: 0.9777
Val gene expr MSE score: 8860.0203
Val cat covariate0 mean sim diff: -0.0054

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
