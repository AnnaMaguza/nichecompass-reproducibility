[True]
Run timestamp: 07082023_215535_145.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_145']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9608; val_auprc_score: 0.9641; val_best_acc_score: 0.6822; val_best_f1_score: 0.7574; train_kl_reg_loss: 7501.7223; train_edge_recon_loss: 3468541.7500; train_gene_expr_recon_loss: 633707.5278; train_masked_gp_l1_reg_loss: 4545.1297; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 268442.6840; train_global_loss: 4382738.8333; train_optim_loss: 4382738.8333; val_kl_reg_loss: 3407.6919; val_edge_recon_loss: 4057325.7500; val_gene_expr_recon_loss: 628013.2500; val_masked_gp_l1_reg_loss: 3942.2354; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 266009.9375; val_global_loss: 4958699.0000; val_optim_loss: 4958699.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9525; val_auprc_score: 0.9539; val_best_acc_score: 0.8604; val_best_f1_score: 0.8716; train_kl_reg_loss: 2781.6905; train_edge_recon_loss: 3468083.3333; train_gene_expr_recon_loss: 607050.1667; train_masked_gp_l1_reg_loss: 3713.6364; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265622.1597; train_global_loss: 4347250.9444; train_optim_loss: 4347250.9444; val_kl_reg_loss: 3473.8789; val_edge_recon_loss: 4038734.5000; val_gene_expr_recon_loss: 602248.5000; val_masked_gp_l1_reg_loss: 3510.0222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263848.3750; val_global_loss: 4911815.5000; val_optim_loss: 4911815.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9345; val_auprc_score: 0.9274; val_best_acc_score: 0.8448; val_best_f1_score: 0.8610; train_kl_reg_loss: 4530.3150; train_edge_recon_loss: 3466766.3333; train_gene_expr_recon_loss: 575449.9722; train_masked_gp_l1_reg_loss: 3470.2068; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261867.2014; train_global_loss: 4312084.0556; train_optim_loss: 4312084.0556; val_kl_reg_loss: 6931.1108; val_edge_recon_loss: 3843236.5000; val_gene_expr_recon_loss: 564862.2500; val_masked_gp_l1_reg_loss: 3455.8093; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260944.0938; val_global_loss: 4679430.0000; val_optim_loss: 4679430.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8889; val_auprc_score: 0.8817; val_best_acc_score: 0.7894; val_best_f1_score: 0.8042; train_kl_reg_loss: 4680.1280; train_edge_recon_loss: 3311434.8333; train_gene_expr_recon_loss: 561091.0347; train_masked_gp_l1_reg_loss: 3458.0576; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260551.7240; train_global_loss: 4141215.8056; train_optim_loss: 4141215.8056; val_kl_reg_loss: 7717.2158; val_edge_recon_loss: 2930361.0000; val_gene_expr_recon_loss: 568967.1250; val_masked_gp_l1_reg_loss: 3463.7512; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260640.9219; val_global_loss: 3771150.2500; val_optim_loss: 3771150.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8958; val_auprc_score: 0.8770; val_best_acc_score: 0.8088; val_best_f1_score: 0.8151; train_kl_reg_loss: 24035.1931; train_edge_recon_loss: 2873815.6111; train_gene_expr_recon_loss: 558842.3472; train_masked_gp_l1_reg_loss: 3473.3340; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260416.0382; train_global_loss: 3720582.5833; train_optim_loss: 3720582.5833; val_kl_reg_loss: 44466.9141; val_edge_recon_loss: 2819862.2500; val_gene_expr_recon_loss: 553726.2500; val_masked_gp_l1_reg_loss: 3473.3550; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258660.1094; val_global_loss: 3680188.7500; val_optim_loss: 3680188.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9124; val_auprc_score: 0.8864; val_best_acc_score: 0.8420; val_best_f1_score: 0.8517; train_kl_reg_loss: 44397.7287; train_edge_recon_loss: 2801564.3333; train_gene_expr_recon_loss: 540653.5972; train_masked_gp_l1_reg_loss: 3475.7816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257781.3750; train_global_loss: 3647872.8056; train_optim_loss: 3647872.8056; val_kl_reg_loss: 30462.6113; val_edge_recon_loss: 2767263.0000; val_gene_expr_recon_loss: 545518.1250; val_masked_gp_l1_reg_loss: 3486.9097; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257293.2812; val_global_loss: 3604023.7500; val_optim_loss: 3604023.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9250; val_auprc_score: 0.9031; val_best_acc_score: 0.8634; val_best_f1_score: 0.8708; train_kl_reg_loss: 26446.7177; train_edge_recon_loss: 2768679.5833; train_gene_expr_recon_loss: 542025.2708; train_masked_gp_l1_reg_loss: 3515.0060; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256600.6892; train_global_loss: 3597267.3333; train_optim_loss: 3597267.3333; val_kl_reg_loss: 28432.7422; val_edge_recon_loss: 2756297.0000; val_gene_expr_recon_loss: 544458.6875; val_masked_gp_l1_reg_loss: 3538.0298; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257240.6719; val_global_loss: 3589967.2500; val_optim_loss: 3589967.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9253; val_auprc_score: 0.9023; val_best_acc_score: 0.8658; val_best_f1_score: 0.8747; train_kl_reg_loss: 33202.7498; train_edge_recon_loss: 2726540.4167; train_gene_expr_recon_loss: 532040.1667; train_masked_gp_l1_reg_loss: 3551.9543; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256112.4201; train_global_loss: 3551447.6389; train_optim_loss: 3551447.6389; val_kl_reg_loss: 37858.4219; val_edge_recon_loss: 2750911.5000; val_gene_expr_recon_loss: 527642.0000; val_masked_gp_l1_reg_loss: 3569.3850; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255241.5469; val_global_loss: 3575223.0000; val_optim_loss: 3575223.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9328; val_auprc_score: 0.9160; val_best_acc_score: 0.8739; val_best_f1_score: 0.8827; train_kl_reg_loss: 35805.3468; train_edge_recon_loss: 2721457.8611; train_gene_expr_recon_loss: 519504.4271; train_masked_gp_l1_reg_loss: 3584.0861; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254867.8715; train_global_loss: 3535219.6389; train_optim_loss: 3535219.6389; val_kl_reg_loss: 32858.9531; val_edge_recon_loss: 2748707.2500; val_gene_expr_recon_loss: 522690.6250; val_masked_gp_l1_reg_loss: 3604.6743; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254374.7812; val_global_loss: 3562236.5000; val_optim_loss: 3562236.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9402; val_auprc_score: 0.9201; val_best_acc_score: 0.8814; val_best_f1_score: 0.8892; train_kl_reg_loss: 31491.0373; train_edge_recon_loss: 2726456.5556; train_gene_expr_recon_loss: 513241.8194; train_masked_gp_l1_reg_loss: 3628.7041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253869.2951; train_global_loss: 3528687.4722; train_optim_loss: 3528687.4722; val_kl_reg_loss: 30941.4023; val_edge_recon_loss: 2717375.7500; val_gene_expr_recon_loss: 518282.2500; val_masked_gp_l1_reg_loss: 3658.1470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253754.3281; val_global_loss: 3524012.0000; val_optim_loss: 3524012.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9358; val_auprc_score: 0.9157; val_best_acc_score: 0.8787; val_best_f1_score: 0.8860; train_kl_reg_loss: 31494.9358; train_edge_recon_loss: 2716491.3611; train_gene_expr_recon_loss: 507602.4201; train_masked_gp_l1_reg_loss: 3694.0203; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252639.6267; train_global_loss: 3511922.3056; train_optim_loss: 3511922.3056; val_kl_reg_loss: 31691.6602; val_edge_recon_loss: 2730937.5000; val_gene_expr_recon_loss: 509830.6250; val_masked_gp_l1_reg_loss: 3739.0830; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252784.3750; val_global_loss: 3528983.5000; val_optim_loss: 3528983.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9481; val_auprc_score: 0.9273; val_best_acc_score: 0.8956; val_best_f1_score: 0.9006; train_kl_reg_loss: 31261.6981; train_edge_recon_loss: 2703791.6389; train_gene_expr_recon_loss: 503791.1528; train_masked_gp_l1_reg_loss: 3775.7959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252874.2865; train_global_loss: 3495494.5278; train_optim_loss: 3495494.5278; val_kl_reg_loss: 29992.5352; val_edge_recon_loss: 2692359.5000; val_gene_expr_recon_loss: 503788.5938; val_masked_gp_l1_reg_loss: 3820.1724; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252109.9844; val_global_loss: 3482070.7500; val_optim_loss: 3482070.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9482; val_auprc_score: 0.9328; val_best_acc_score: 0.8937; val_best_f1_score: 0.8996; train_kl_reg_loss: 28918.2418; train_edge_recon_loss: 2704522.7778; train_gene_expr_recon_loss: 497393.1458; train_masked_gp_l1_reg_loss: 3864.4862; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251367.9462; train_global_loss: 3486066.5833; train_optim_loss: 3486066.5833; val_kl_reg_loss: 29688.8867; val_edge_recon_loss: 2710773.7500; val_gene_expr_recon_loss: 514439.7500; val_masked_gp_l1_reg_loss: 3912.5015; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252519.1875; val_global_loss: 3511334.2500; val_optim_loss: 3511334.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9574; val_auprc_score: 0.9422; val_best_acc_score: 0.9085; val_best_f1_score: 0.9120; train_kl_reg_loss: 30041.5812; train_edge_recon_loss: 2677095.1944; train_gene_expr_recon_loss: 494261.3681; train_masked_gp_l1_reg_loss: 3952.6859; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250773.3056; train_global_loss: 3456124.1944; train_optim_loss: 3456124.1944; val_kl_reg_loss: 30497.6914; val_edge_recon_loss: 2676396.2500; val_gene_expr_recon_loss: 501326.8750; val_masked_gp_l1_reg_loss: 3995.5813; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251168.9375; val_global_loss: 3463385.5000; val_optim_loss: 3463385.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9642; val_auprc_score: 0.9532; val_best_acc_score: 0.9108; val_best_f1_score: 0.9151; train_kl_reg_loss: 30418.3811; train_edge_recon_loss: 2673657.3889; train_gene_expr_recon_loss: 493597.0035; train_masked_gp_l1_reg_loss: 4029.7822; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251273.9983; train_global_loss: 3452976.6111; train_optim_loss: 3452976.6111; val_kl_reg_loss: 32148.6133; val_edge_recon_loss: 2690272.2500; val_gene_expr_recon_loss: 499623.6250; val_masked_gp_l1_reg_loss: 4071.0032; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250463.8438; val_global_loss: 3476579.2500; val_optim_loss: 3476579.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9586; val_auprc_score: 0.9441; val_best_acc_score: 0.9070; val_best_f1_score: 0.9113; train_kl_reg_loss: 32022.5801; train_edge_recon_loss: 2663250.8056; train_gene_expr_recon_loss: 485743.6111; train_masked_gp_l1_reg_loss: 4095.4831; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249188.8351; train_global_loss: 3434301.3056; train_optim_loss: 3434301.3056; val_kl_reg_loss: 31264.8340; val_edge_recon_loss: 2678131.7500; val_gene_expr_recon_loss: 490400.9062; val_masked_gp_l1_reg_loss: 4119.7646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249348.0938; val_global_loss: 3453265.2500; val_optim_loss: 3453265.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9650; val_auprc_score: 0.9547; val_best_acc_score: 0.9128; val_best_f1_score: 0.9161; train_kl_reg_loss: 30761.6029; train_edge_recon_loss: 2661079.8056; train_gene_expr_recon_loss: 482146.6632; train_masked_gp_l1_reg_loss: 4150.1800; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248392.0226; train_global_loss: 3426530.2500; train_optim_loss: 3426530.2500; val_kl_reg_loss: 31561.6992; val_edge_recon_loss: 2674059.2500; val_gene_expr_recon_loss: 490354.0625; val_masked_gp_l1_reg_loss: 4177.3726; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248898.9688; val_global_loss: 3449051.2500; val_optim_loss: 3449051.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9631; val_auprc_score: 0.9476; val_best_acc_score: 0.9120; val_best_f1_score: 0.9158; train_kl_reg_loss: 31949.6730; train_edge_recon_loss: 2663159.9444; train_gene_expr_recon_loss: 476493.9236; train_masked_gp_l1_reg_loss: 4202.7193; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248400.0764; train_global_loss: 3424206.3333; train_optim_loss: 3424206.3333; val_kl_reg_loss: 31901.8672; val_edge_recon_loss: 2679044.5000; val_gene_expr_recon_loss: 486033.4375; val_masked_gp_l1_reg_loss: 4231.8022; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248218.0156; val_global_loss: 3449429.5000; val_optim_loss: 3449429.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9644; val_auprc_score: 0.9526; val_best_acc_score: 0.9136; val_best_f1_score: 0.9170; train_kl_reg_loss: 30772.6322; train_edge_recon_loss: 2662591.0278; train_gene_expr_recon_loss: 477365.6458; train_masked_gp_l1_reg_loss: 4261.4420; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248084.3733; train_global_loss: 3423075.0556; train_optim_loss: 3423075.0556; val_kl_reg_loss: 29212.8711; val_edge_recon_loss: 2664978.5000; val_gene_expr_recon_loss: 481748.4688; val_masked_gp_l1_reg_loss: 4292.2549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247560.0156; val_global_loss: 3427792.0000; val_optim_loss: 3427792.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9665; val_auprc_score: 0.9523; val_best_acc_score: 0.9175; val_best_f1_score: 0.9206; train_kl_reg_loss: 30213.3498; train_edge_recon_loss: 2665465.1389; train_gene_expr_recon_loss: 470829.8299; train_masked_gp_l1_reg_loss: 4321.4980; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247507.8802; train_global_loss: 3418337.7222; train_optim_loss: 3418337.7222; val_kl_reg_loss: 30749.6367; val_edge_recon_loss: 2675116.7500; val_gene_expr_recon_loss: 485751.8750; val_masked_gp_l1_reg_loss: 4350.5986; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247904.5625; val_global_loss: 3443873.5000; val_optim_loss: 3443873.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9707; val_auprc_score: 0.9580; val_best_acc_score: 0.9240; val_best_f1_score: 0.9255; train_kl_reg_loss: 30334.6730; train_edge_recon_loss: 2664278.3056; train_gene_expr_recon_loss: 470276.7326; train_masked_gp_l1_reg_loss: 4373.0435; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247635.7483; train_global_loss: 3416898.5556; train_optim_loss: 3416898.5556; val_kl_reg_loss: 29417.0742; val_edge_recon_loss: 2659112.7500; val_gene_expr_recon_loss: 474569.0938; val_masked_gp_l1_reg_loss: 4399.9849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246825.6562; val_global_loss: 3414324.5000; val_optim_loss: 3414324.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9693; val_auprc_score: 0.9566; val_best_acc_score: 0.9206; val_best_f1_score: 0.9235; train_kl_reg_loss: 28815.6806; train_edge_recon_loss: 2652344.1111; train_gene_expr_recon_loss: 470494.1944; train_masked_gp_l1_reg_loss: 4423.4525; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246742.6389; train_global_loss: 3402820.0556; train_optim_loss: 3402820.0556; val_kl_reg_loss: 28739.7500; val_edge_recon_loss: 2652253.7500; val_gene_expr_recon_loss: 481251.4062; val_masked_gp_l1_reg_loss: 4448.5669; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247146.4844; val_global_loss: 3413840.0000; val_optim_loss: 3413840.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9713; val_auprc_score: 0.9626; val_best_acc_score: 0.9258; val_best_f1_score: 0.9279; train_kl_reg_loss: 28174.5200; train_edge_recon_loss: 2639584.8611; train_gene_expr_recon_loss: 467552.4583; train_masked_gp_l1_reg_loss: 4471.5648; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246236.6875; train_global_loss: 3386020.1111; train_optim_loss: 3386020.1111; val_kl_reg_loss: 28110.9609; val_edge_recon_loss: 2682146.7500; val_gene_expr_recon_loss: 470640.3750; val_masked_gp_l1_reg_loss: 4487.1943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245741.0469; val_global_loss: 3431126.2500; val_optim_loss: 3431126.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9729; val_auprc_score: 0.9612; val_best_acc_score: 0.9312; val_best_f1_score: 0.9336; train_kl_reg_loss: 28664.8822; train_edge_recon_loss: 2639848.3611; train_gene_expr_recon_loss: 463908.7674; train_masked_gp_l1_reg_loss: 4502.3702; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245357.5642; train_global_loss: 3382281.9444; train_optim_loss: 3382281.9444; val_kl_reg_loss: 28254.0000; val_edge_recon_loss: 2638317.7500; val_gene_expr_recon_loss: 477553.0625; val_masked_gp_l1_reg_loss: 4512.6470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246528.1562; val_global_loss: 3395165.7500; val_optim_loss: 3395165.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9734; val_auprc_score: 0.9602; val_best_acc_score: 0.9263; val_best_f1_score: 0.9285; train_kl_reg_loss: 28260.1847; train_edge_recon_loss: 2640024.0278; train_gene_expr_recon_loss: 463100.1493; train_masked_gp_l1_reg_loss: 4525.8223; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245315.3351; train_global_loss: 3381225.6389; train_optim_loss: 3381225.6389; val_kl_reg_loss: 29280.6719; val_edge_recon_loss: 2662198.5000; val_gene_expr_recon_loss: 474087.0625; val_masked_gp_l1_reg_loss: 4539.4248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245919.5781; val_global_loss: 3416025.2500; val_optim_loss: 3416025.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9751; val_auprc_score: 0.9669; val_best_acc_score: 0.9321; val_best_f1_score: 0.9345; train_kl_reg_loss: 29062.9692; train_edge_recon_loss: 2646905.9167; train_gene_expr_recon_loss: 482165.0972; train_masked_gp_l1_reg_loss: 4556.9581; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247335.5399; train_global_loss: 3410026.4167; train_optim_loss: 3410026.4167; val_kl_reg_loss: 16257.5020; val_edge_recon_loss: 2648399.5000; val_gene_expr_recon_loss: 495763.6250; val_masked_gp_l1_reg_loss: 4555.3657; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247933.8906; val_global_loss: 3412909.7500; val_optim_loss: 3412909.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9764; val_auprc_score: 0.9685; val_best_acc_score: 0.9306; val_best_f1_score: 0.9326; train_kl_reg_loss: 29035.2344; train_edge_recon_loss: 2635303.8889; train_gene_expr_recon_loss: 477100.4618; train_masked_gp_l1_reg_loss: 4551.0218; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246962.1667; train_global_loss: 3392952.7778; train_optim_loss: 3392952.7778; val_kl_reg_loss: 16647.1543; val_edge_recon_loss: 2656104.5000; val_gene_expr_recon_loss: 486653.1250; val_masked_gp_l1_reg_loss: 4544.9458; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246867.6719; val_global_loss: 3410817.7500; val_optim_loss: 3410817.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9744; val_auprc_score: 0.9632; val_best_acc_score: 0.9303; val_best_f1_score: 0.9320; train_kl_reg_loss: 27672.0553; train_edge_recon_loss: 2631487.9167; train_gene_expr_recon_loss: 474302.9236; train_masked_gp_l1_reg_loss: 4547.2920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246448.0538; train_global_loss: 3384458.2222; train_optim_loss: 3384458.2222; val_kl_reg_loss: 16682.5898; val_edge_recon_loss: 2662872.0000; val_gene_expr_recon_loss: 484973.6250; val_masked_gp_l1_reg_loss: 4548.2676; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246672.4062; val_global_loss: 3415748.7500; val_optim_loss: 3415748.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9779; val_auprc_score: 0.9716; val_best_acc_score: 0.9368; val_best_f1_score: 0.9388; train_kl_reg_loss: 26232.1341; train_edge_recon_loss: 2626093.2778; train_gene_expr_recon_loss: 470203.1597; train_masked_gp_l1_reg_loss: 4535.1776; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245933.7865; train_global_loss: 3372997.5833; train_optim_loss: 3372997.5833; val_kl_reg_loss: 16564.3242; val_edge_recon_loss: 2647724.5000; val_gene_expr_recon_loss: 480770.5000; val_masked_gp_l1_reg_loss: 4519.8384; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246118.4375; val_global_loss: 3395697.5000; val_optim_loss: 3395697.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9784; val_auprc_score: 0.9710; val_best_acc_score: 0.9363; val_best_f1_score: 0.9377; train_kl_reg_loss: 26084.2895; train_edge_recon_loss: 2636894.7222; train_gene_expr_recon_loss: 472410.5694; train_masked_gp_l1_reg_loss: 4513.4996; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245883.7743; train_global_loss: 3385786.7778; train_optim_loss: 3385786.7778; val_kl_reg_loss: 16597.6465; val_edge_recon_loss: 2623759.7500; val_gene_expr_recon_loss: 482038.6875; val_masked_gp_l1_reg_loss: 4505.4321; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246272.8281; val_global_loss: 3373174.5000; val_optim_loss: 3373174.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9766; val_auprc_score: 0.9651; val_best_acc_score: 0.9329; val_best_f1_score: 0.9342; train_kl_reg_loss: 25927.2439; train_edge_recon_loss: 2635753.2500; train_gene_expr_recon_loss: 466708.7882; train_masked_gp_l1_reg_loss: 4500.8462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245157.0972; train_global_loss: 3378047.3056; train_optim_loss: 3378047.3056; val_kl_reg_loss: 16644.7676; val_edge_recon_loss: 2648999.5000; val_gene_expr_recon_loss: 479968.9375; val_masked_gp_l1_reg_loss: 4495.9575; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245940.9219; val_global_loss: 3396050.2500; val_optim_loss: 3396050.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9777; val_auprc_score: 0.9677; val_best_acc_score: 0.9378; val_best_f1_score: 0.9397; train_kl_reg_loss: 25720.7036; train_edge_recon_loss: 2636943.9444; train_gene_expr_recon_loss: 467314.4896; train_masked_gp_l1_reg_loss: 4493.4725; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244776.8455; train_global_loss: 3379249.4167; train_optim_loss: 3379249.4167; val_kl_reg_loss: 16614.2246; val_edge_recon_loss: 2636870.5000; val_gene_expr_recon_loss: 481517.0312; val_masked_gp_l1_reg_loss: 4490.5508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246127.6562; val_global_loss: 3385620.0000; val_optim_loss: 3385620.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9771; val_auprc_score: 0.9662; val_best_acc_score: 0.9371; val_best_f1_score: 0.9390; train_kl_reg_loss: 25611.8774; train_edge_recon_loss: 2621705.3889; train_gene_expr_recon_loss: 467390.1354; train_masked_gp_l1_reg_loss: 4488.6755; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244476.7656; train_global_loss: 3363672.8611; train_optim_loss: 3363672.8611; val_kl_reg_loss: 16773.6523; val_edge_recon_loss: 2636812.7500; val_gene_expr_recon_loss: 479986.0625; val_masked_gp_l1_reg_loss: 4486.3984; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245867.7812; val_global_loss: 3383926.7500; val_optim_loss: 3383926.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9808; val_auprc_score: 0.9741; val_best_acc_score: 0.9402; val_best_f1_score: 0.9423; train_kl_reg_loss: 25559.4551; train_edge_recon_loss: 2625984.8333; train_gene_expr_recon_loss: 469753.6806; train_masked_gp_l1_reg_loss: 4485.2159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245496.2587; train_global_loss: 3371279.5278; train_optim_loss: 3371279.5278; val_kl_reg_loss: 16761.5352; val_edge_recon_loss: 2620703.2500; val_gene_expr_recon_loss: 480927.1875; val_masked_gp_l1_reg_loss: 4483.8496; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246111.0312; val_global_loss: 3368986.7500; val_optim_loss: 3368986.7500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9787; val_auprc_score: 0.9725; val_best_acc_score: 0.9373; val_best_f1_score: 0.9395; train_kl_reg_loss: 25361.2632; train_edge_recon_loss: 2629653.0278; train_gene_expr_recon_loss: 467790.3229; train_masked_gp_l1_reg_loss: 4483.0237; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245078.0747; train_global_loss: 3372365.6667; train_optim_loss: 3372365.6667; val_kl_reg_loss: 16761.0391; val_edge_recon_loss: 2643523.2500; val_gene_expr_recon_loss: 480172.0000; val_masked_gp_l1_reg_loss: 4482.0640; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245896.6875; val_global_loss: 3390835.0000; val_optim_loss: 3390835.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9779; val_auprc_score: 0.9699; val_best_acc_score: 0.9349; val_best_f1_score: 0.9371; train_kl_reg_loss: 25299.5406; train_edge_recon_loss: 2628577.0556; train_gene_expr_recon_loss: 470017.0035; train_masked_gp_l1_reg_loss: 4481.6647; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245287.6979; train_global_loss: 3373662.9167; train_optim_loss: 3373662.9167; val_kl_reg_loss: 16760.6250; val_edge_recon_loss: 2626116.7500; val_gene_expr_recon_loss: 480353.3125; val_masked_gp_l1_reg_loss: 4481.0039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245950.9688; val_global_loss: 3373662.7500; val_optim_loss: 3373662.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9784; val_auprc_score: 0.9685; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 25121.5482; train_edge_recon_loss: 2633573.7222; train_gene_expr_recon_loss: 468815.9965; train_masked_gp_l1_reg_loss: 4480.5256; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245733.1615; train_global_loss: 3377725.0278; train_optim_loss: 3377725.0278; val_kl_reg_loss: 16830.0840; val_edge_recon_loss: 2627599.7500; val_gene_expr_recon_loss: 479821.4375; val_masked_gp_l1_reg_loss: 4479.7300; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245786.7188; val_global_loss: 3374517.7500; val_optim_loss: 3374517.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9760; val_auprc_score: 0.9643; val_best_acc_score: 0.9384; val_best_f1_score: 0.9407; train_kl_reg_loss: 25115.8685; train_edge_recon_loss: 2621138.3611; train_gene_expr_recon_loss: 468497.7535; train_masked_gp_l1_reg_loss: 4479.5730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246307.7066; train_global_loss: 3365539.2500; train_optim_loss: 3365539.2500; val_kl_reg_loss: 16889.0449; val_edge_recon_loss: 2633030.5000; val_gene_expr_recon_loss: 479725.3750; val_masked_gp_l1_reg_loss: 4479.1978; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245844.4844; val_global_loss: 3379968.7500; val_optim_loss: 3379968.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9795; val_auprc_score: 0.9700; val_best_acc_score: 0.9406; val_best_f1_score: 0.9423; train_kl_reg_loss: 25052.0720; train_edge_recon_loss: 2624048.3333; train_gene_expr_recon_loss: 466697.8438; train_masked_gp_l1_reg_loss: 4477.8869; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244843.6111; train_global_loss: 3365119.6944; train_optim_loss: 3365119.6944; val_kl_reg_loss: 16931.1465; val_edge_recon_loss: 2631196.0000; val_gene_expr_recon_loss: 480096.1250; val_masked_gp_l1_reg_loss: 4476.6636; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245912.2812; val_global_loss: 3378612.5000; val_optim_loss: 3378612.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9777; val_auprc_score: 0.9679; val_best_acc_score: 0.9361; val_best_f1_score: 0.9382; train_kl_reg_loss: 25037.0983; train_edge_recon_loss: 2624801.7500; train_gene_expr_recon_loss: 468172.3542; train_masked_gp_l1_reg_loss: 4476.3346; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245246.3247; train_global_loss: 3367733.8889; train_optim_loss: 3367733.8889; val_kl_reg_loss: 16943.5508; val_edge_recon_loss: 2635985.0000; val_gene_expr_recon_loss: 480137.0625; val_masked_gp_l1_reg_loss: 4475.8120; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245829.1250; val_global_loss: 3383370.5000; val_optim_loss: 3383370.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9773; val_auprc_score: 0.9683; val_best_acc_score: 0.9349; val_best_f1_score: 0.9370; train_kl_reg_loss: 24986.2630; train_edge_recon_loss: 2622608.1667; train_gene_expr_recon_loss: 467849.1424; train_masked_gp_l1_reg_loss: 4475.5521; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244182.0434; train_global_loss: 3364101.1389; train_optim_loss: 3364101.1389; val_kl_reg_loss: 16964.6035; val_edge_recon_loss: 2647301.0000; val_gene_expr_recon_loss: 480146.7188; val_masked_gp_l1_reg_loss: 4475.2490; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245834.4219; val_global_loss: 3394722.0000; val_optim_loss: 3394722.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9785; val_auprc_score: 0.9694; val_best_acc_score: 0.9365; val_best_f1_score: 0.9386; train_kl_reg_loss: 25043.8631; train_edge_recon_loss: 2625641.8611; train_gene_expr_recon_loss: 467456.7257; train_masked_gp_l1_reg_loss: 4475.0732; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244300.5642; train_global_loss: 3366918.1111; train_optim_loss: 3366918.1111; val_kl_reg_loss: 16940.2559; val_edge_recon_loss: 2633405.2500; val_gene_expr_recon_loss: 479735.5625; val_masked_gp_l1_reg_loss: 4474.8818; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245823.6562; val_global_loss: 3380379.7500; val_optim_loss: 3380379.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 29 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9782
val AUPRC score: 0.9684
val best accuracy score: 0.9355
val best F1 score: 0.9375
val target rna MSE score: 0.4332
val source rna MSE score: 0.2962
val target atac MSE score: 0.1345
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
