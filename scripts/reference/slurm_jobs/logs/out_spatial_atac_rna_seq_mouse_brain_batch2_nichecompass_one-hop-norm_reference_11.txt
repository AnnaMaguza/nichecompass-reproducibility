[True]
Run timestamp: 10082023_145555_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7857; val_auprc_score: 0.8088; val_best_acc_score: 0.5671; val_best_f1_score: 0.6913; train_kl_reg_loss: 100579.8223; train_edge_recon_loss: 3639364.4332; train_gene_expr_recon_loss: 15514826.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 33516426.7328; train_global_loss: 52771198.1374; train_optim_loss: 52771198.1374; val_kl_reg_loss: 71874.6974; val_edge_recon_loss: 4061192.8833; val_gene_expr_recon_loss: 13301699.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 31792720.1333; val_global_loss: 49227487.2000; val_optim_loss: 49227487.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8141; val_auprc_score: 0.8318; val_best_acc_score: 0.7332; val_best_f1_score: 0.7150; train_kl_reg_loss: 117281.1848; train_edge_recon_loss: 3589132.1240; train_gene_expr_recon_loss: 12789313.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30951951.4656; train_global_loss: 47447678.0458; train_optim_loss: 47447678.0458; val_kl_reg_loss: 105325.9354; val_edge_recon_loss: 4024950.8833; val_gene_expr_recon_loss: 12756920.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 31416206.2667; val_global_loss: 48303402.6667; val_optim_loss: 48303402.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8509; val_auprc_score: 0.8489; val_best_acc_score: 0.7518; val_best_f1_score: 0.7848; train_kl_reg_loss: 109378.6274; train_edge_recon_loss: 3399180.7958; train_gene_expr_recon_loss: 12463250.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30531542.5038; train_global_loss: 46503351.7252; train_optim_loss: 46503351.7252; val_kl_reg_loss: 140225.8161; val_edge_recon_loss: 3077909.9500; val_gene_expr_recon_loss: 12474787.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30944677.8667; val_global_loss: 46637602.1333; val_optim_loss: 46637602.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8724; val_auprc_score: 0.8601; val_best_acc_score: 0.7792; val_best_f1_score: 0.8000; train_kl_reg_loss: 142585.2963; train_edge_recon_loss: 2999047.2156; train_gene_expr_recon_loss: 12284315.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30240342.7634; train_global_loss: 45666291.3282; train_optim_loss: 45666291.3282; val_kl_reg_loss: 136323.0177; val_edge_recon_loss: 2994360.3500; val_gene_expr_recon_loss: 12347130.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30736127.8667; val_global_loss: 46213941.8667; val_optim_loss: 46213941.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8971; val_auprc_score: 0.8846; val_best_acc_score: 0.8119; val_best_f1_score: 0.8256; train_kl_reg_loss: 131258.9004; train_edge_recon_loss: 2940341.8092; train_gene_expr_recon_loss: 12143593.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29931495.5573; train_global_loss: 45146689.5573; train_optim_loss: 45146689.5573; val_kl_reg_loss: 130415.9438; val_edge_recon_loss: 2922262.4500; val_gene_expr_recon_loss: 12266924.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30504778.8000; val_global_loss: 45824381.0667; val_optim_loss: 45824381.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9158; val_auprc_score: 0.8994; val_best_acc_score: 0.8416; val_best_f1_score: 0.8550; train_kl_reg_loss: 125010.4940; train_edge_recon_loss: 2893410.1298; train_gene_expr_recon_loss: 12018239.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29700397.0229; train_global_loss: 44737056.8550; train_optim_loss: 44737056.8550; val_kl_reg_loss: 122115.9984; val_edge_recon_loss: 2889241.9333; val_gene_expr_recon_loss: 12077286.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30055771.0667; val_global_loss: 45144416.0000; val_optim_loss: 45144416.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9282; val_auprc_score: 0.9111; val_best_acc_score: 0.8624; val_best_f1_score: 0.8716; train_kl_reg_loss: 124887.9273; train_edge_recon_loss: 2830660.8626; train_gene_expr_recon_loss: 11922066.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29484845.4809; train_global_loss: 44362460.4885; train_optim_loss: 44362460.4885; val_kl_reg_loss: 127472.0057; val_edge_recon_loss: 2854353.3000; val_gene_expr_recon_loss: 12008987.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29931688.4000; val_global_loss: 44922501.0667; val_optim_loss: 44922501.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9402; val_auprc_score: 0.9230; val_best_acc_score: 0.8751; val_best_f1_score: 0.8821; train_kl_reg_loss: 122474.5330; train_edge_recon_loss: 2803580.6260; train_gene_expr_recon_loss: 11845082.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29312370.8244; train_global_loss: 44083508.0916; train_optim_loss: 44083508.0916; val_kl_reg_loss: 121703.5323; val_edge_recon_loss: 2801235.4333; val_gene_expr_recon_loss: 11977804.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29977479.3333; val_global_loss: 44878222.9333; val_optim_loss: 44878222.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9460; val_auprc_score: 0.9341; val_best_acc_score: 0.8821; val_best_f1_score: 0.8892; train_kl_reg_loss: 119273.1268; train_edge_recon_loss: 2777433.0821; train_gene_expr_recon_loss: 11754693.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29099357.0382; train_global_loss: 43750757.4351; train_optim_loss: 43750757.4351; val_kl_reg_loss: 118371.9599; val_edge_recon_loss: 2787712.2667; val_gene_expr_recon_loss: 11861400.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29624509.0667; val_global_loss: 44391993.8667; val_optim_loss: 44391993.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9486; val_auprc_score: 0.9337; val_best_acc_score: 0.8891; val_best_f1_score: 0.8969; train_kl_reg_loss: 117159.0683; train_edge_recon_loss: 2762254.4198; train_gene_expr_recon_loss: 11685428.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28947159.7710; train_global_loss: 43512001.7710; train_optim_loss: 43512001.7710; val_kl_reg_loss: 116587.4193; val_edge_recon_loss: 2765892.7833; val_gene_expr_recon_loss: 11775522.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29390774.1333; val_global_loss: 44048776.2667; val_optim_loss: 44048776.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9493; val_auprc_score: 0.9366; val_best_acc_score: 0.8914; val_best_f1_score: 0.8989; train_kl_reg_loss: 112944.5902; train_edge_recon_loss: 2755023.6164; train_gene_expr_recon_loss: 11616881.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28764647.3588; train_global_loss: 43249496.7328; train_optim_loss: 43249496.7328; val_kl_reg_loss: 110331.1661; val_edge_recon_loss: 2768592.0500; val_gene_expr_recon_loss: 11716584.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29292144.5333; val_global_loss: 43887652.0000; val_optim_loss: 43887652.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9518; val_auprc_score: 0.9369; val_best_acc_score: 0.8906; val_best_f1_score: 0.8967; train_kl_reg_loss: 108866.7673; train_edge_recon_loss: 2751464.5134; train_gene_expr_recon_loss: 11557434.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28606618.6260; train_global_loss: 43024384.1527; train_optim_loss: 43024384.1527; val_kl_reg_loss: 106716.4594; val_edge_recon_loss: 2782022.4833; val_gene_expr_recon_loss: 11714391.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29093320.6667; val_global_loss: 43696451.2000; val_optim_loss: 43696451.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9554; val_auprc_score: 0.9414; val_best_acc_score: 0.8969; val_best_f1_score: 0.9005; train_kl_reg_loss: 106426.0638; train_edge_recon_loss: 2743600.4504; train_gene_expr_recon_loss: 11512411.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28490303.9084; train_global_loss: 42852742.1679; train_optim_loss: 42852742.1679; val_kl_reg_loss: 103678.3760; val_edge_recon_loss: 2769208.6500; val_gene_expr_recon_loss: 11623401.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28882654.0000; val_global_loss: 43378943.2000; val_optim_loss: 43378943.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9544; val_auprc_score: 0.9412; val_best_acc_score: 0.8977; val_best_f1_score: 0.9037; train_kl_reg_loss: 103650.7008; train_edge_recon_loss: 2743858.6985; train_gene_expr_recon_loss: 11457813.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28323863.0229; train_global_loss: 42629185.5878; train_optim_loss: 42629185.5878; val_kl_reg_loss: 100420.5432; val_edge_recon_loss: 2765050.5667; val_gene_expr_recon_loss: 11587071.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28839706.4000; val_global_loss: 43292248.8000; val_optim_loss: 43292248.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9601; val_auprc_score: 0.9485; val_best_acc_score: 0.9035; val_best_f1_score: 0.9095; train_kl_reg_loss: 99671.1766; train_edge_recon_loss: 2734523.5763; train_gene_expr_recon_loss: 11402045.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28181138.1069; train_global_loss: 42417378.0763; train_optim_loss: 42417378.0763; val_kl_reg_loss: 99116.5240; val_edge_recon_loss: 2731233.5667; val_gene_expr_recon_loss: 11480418.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28758544.4000; val_global_loss: 43069312.5333; val_optim_loss: 43069312.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9622; val_auprc_score: 0.9506; val_best_acc_score: 0.9056; val_best_f1_score: 0.9112; train_kl_reg_loss: 97906.2984; train_edge_recon_loss: 2723389.7366; train_gene_expr_recon_loss: 11369736.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28086992.8397; train_global_loss: 42278025.6183; train_optim_loss: 42278025.6183; val_kl_reg_loss: 97092.8057; val_edge_recon_loss: 2716797.2333; val_gene_expr_recon_loss: 11517595.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28565368.0000; val_global_loss: 42896852.8000; val_optim_loss: 42896852.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9661; val_auprc_score: 0.9578; val_best_acc_score: 0.9123; val_best_f1_score: 0.9165; train_kl_reg_loss: 95647.2012; train_edge_recon_loss: 2732173.0344; train_gene_expr_recon_loss: 11338404.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27983389.8626; train_global_loss: 42149615.0534; train_optim_loss: 42149615.0534; val_kl_reg_loss: 96345.4880; val_edge_recon_loss: 2723724.0667; val_gene_expr_recon_loss: 11462912.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28489562.8000; val_global_loss: 42772545.3333; val_optim_loss: 42772545.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9681; val_auprc_score: 0.9584; val_best_acc_score: 0.9173; val_best_f1_score: 0.9207; train_kl_reg_loss: 93127.5248; train_edge_recon_loss: 2719848.8702; train_gene_expr_recon_loss: 11298648.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27882722.6565; train_global_loss: 41994347.5725; train_optim_loss: 41994347.5725; val_kl_reg_loss: 94132.1083; val_edge_recon_loss: 2695043.1000; val_gene_expr_recon_loss: 11432852.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28522611.2000; val_global_loss: 42744638.6667; val_optim_loss: 42744638.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9662; val_auprc_score: 0.9576; val_best_acc_score: 0.9138; val_best_f1_score: 0.9185; train_kl_reg_loss: 92211.4210; train_edge_recon_loss: 2713407.9905; train_gene_expr_recon_loss: 11264986.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27763164.7634; train_global_loss: 41833770.9924; train_optim_loss: 41833770.9924; val_kl_reg_loss: 89741.2953; val_edge_recon_loss: 2728086.3333; val_gene_expr_recon_loss: 11402421.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28290772.9333; val_global_loss: 42511021.6000; val_optim_loss: 42511021.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9683; val_auprc_score: 0.9601; val_best_acc_score: 0.9182; val_best_f1_score: 0.9213; train_kl_reg_loss: 89369.1660; train_edge_recon_loss: 2711896.0344; train_gene_expr_recon_loss: 11233204.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27685210.5038; train_global_loss: 41719680.5802; train_optim_loss: 41719680.5802; val_kl_reg_loss: 89158.7802; val_edge_recon_loss: 2711113.1333; val_gene_expr_recon_loss: 11354596.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28267336.4000; val_global_loss: 42422205.3333; val_optim_loss: 42422205.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9706; val_auprc_score: 0.9609; val_best_acc_score: 0.9201; val_best_f1_score: 0.9241; train_kl_reg_loss: 87098.8233; train_edge_recon_loss: 2707510.6431; train_gene_expr_recon_loss: 11207414.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27591980.7328; train_global_loss: 41594004.7939; train_optim_loss: 41594004.7939; val_kl_reg_loss: 84906.4729; val_edge_recon_loss: 2715034.3000; val_gene_expr_recon_loss: 11322814.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28073700.8000; val_global_loss: 42196455.2000; val_optim_loss: 42196455.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9709; val_auprc_score: 0.9628; val_best_acc_score: 0.9212; val_best_f1_score: 0.9247; train_kl_reg_loss: 85538.7956; train_edge_recon_loss: 2707463.7214; train_gene_expr_recon_loss: 11192559.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27534763.5573; train_global_loss: 41520325.5878; train_optim_loss: 41520325.5878; val_kl_reg_loss: 86418.1667; val_edge_recon_loss: 2701432.6333; val_gene_expr_recon_loss: 11346595.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28147866.1333; val_global_loss: 42282312.2667; val_optim_loss: 42282312.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9752; val_auprc_score: 0.9697; val_best_acc_score: 0.9298; val_best_f1_score: 0.9320; train_kl_reg_loss: 84509.9294; train_edge_recon_loss: 2700252.5668; train_gene_expr_recon_loss: 11167002.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27452808.8244; train_global_loss: 41404574.1069; train_optim_loss: 41404574.1069; val_kl_reg_loss: 82975.4937; val_edge_recon_loss: 2710484.3167; val_gene_expr_recon_loss: 11308870.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28044989.7333; val_global_loss: 42147320.2667; val_optim_loss: 42147320.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9728; val_auprc_score: 0.9651; val_best_acc_score: 0.9247; val_best_f1_score: 0.9259; train_kl_reg_loss: 82814.4728; train_edge_recon_loss: 2706601.9809; train_gene_expr_recon_loss: 11138378.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27344393.9542; train_global_loss: 41272188.6412; train_optim_loss: 41272188.6412; val_kl_reg_loss: 82400.0036; val_edge_recon_loss: 2705557.5667; val_gene_expr_recon_loss: 11320563.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28011796.2667; val_global_loss: 42120317.0667; val_optim_loss: 42120317.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9744; val_auprc_score: 0.9676; val_best_acc_score: 0.9251; val_best_f1_score: 0.9283; train_kl_reg_loss: 82479.3763; train_edge_recon_loss: 2694598.1221; train_gene_expr_recon_loss: 11127521.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27305660.1679; train_global_loss: 41210258.6565; train_optim_loss: 41210258.6565; val_kl_reg_loss: 81606.0344; val_edge_recon_loss: 2705944.8000; val_gene_expr_recon_loss: 11249125.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27785994.4000; val_global_loss: 41822670.9333; val_optim_loss: 41822670.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9726; val_auprc_score: 0.9673; val_best_acc_score: 0.9231; val_best_f1_score: 0.9259; train_kl_reg_loss: 98319.0141; train_edge_recon_loss: 2763333.2691; train_gene_expr_recon_loss: 11708131.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27840811.6031; train_global_loss: 42410595.2061; train_optim_loss: 42410595.2061; val_kl_reg_loss: 37892.2180; val_edge_recon_loss: 2733634.8000; val_gene_expr_recon_loss: 11766043.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28308002.1333; val_global_loss: 42845572.0000; val_optim_loss: 42845572.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9731; val_auprc_score: 0.9662; val_best_acc_score: 0.9210; val_best_f1_score: 0.9248; train_kl_reg_loss: 89032.4440; train_edge_recon_loss: 2715220.5115; train_gene_expr_recon_loss: 11589417.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27717697.1603; train_global_loss: 42111367.3588; train_optim_loss: 42111367.3588; val_kl_reg_loss: 40127.1365; val_edge_recon_loss: 2721839.1500; val_gene_expr_recon_loss: 11752013.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28312528.9333; val_global_loss: 42826509.0667; val_optim_loss: 42826509.0667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9705; val_auprc_score: 0.9615; val_best_acc_score: 0.9190; val_best_f1_score: 0.9213; train_kl_reg_loss: 80968.0443; train_edge_recon_loss: 2712781.1698; train_gene_expr_recon_loss: 11554276.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27655027.8779; train_global_loss: 42003053.7710; train_optim_loss: 42003053.7710; val_kl_reg_loss: 42829.4279; val_edge_recon_loss: 2725840.3833; val_gene_expr_recon_loss: 11681716.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28151481.8667; val_global_loss: 42601868.2667; val_optim_loss: 42601868.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9715; val_auprc_score: 0.9642; val_best_acc_score: 0.9206; val_best_f1_score: 0.9240; train_kl_reg_loss: 75429.5347; train_edge_recon_loss: 2708509.5420; train_gene_expr_recon_loss: 11513731.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27602961.9542; train_global_loss: 41900632.5496; train_optim_loss: 41900632.5496; val_kl_reg_loss: 40826.8461; val_edge_recon_loss: 2708478.1167; val_gene_expr_recon_loss: 11656106.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28169538.5333; val_global_loss: 42574949.6000; val_optim_loss: 42574949.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9695; val_auprc_score: 0.9591; val_best_acc_score: 0.9197; val_best_f1_score: 0.9233; train_kl_reg_loss: 75420.6990; train_edge_recon_loss: 2701732.9103; train_gene_expr_recon_loss: 11508041.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27560179.6183; train_global_loss: 41845375.0229; train_optim_loss: 41845375.0229; val_kl_reg_loss: 41830.5414; val_edge_recon_loss: 2711492.4333; val_gene_expr_recon_loss: 11691999.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28205004.4000; val_global_loss: 42650326.9333; val_optim_loss: 42650326.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9722; val_auprc_score: 0.9641; val_best_acc_score: 0.9214; val_best_f1_score: 0.9250; train_kl_reg_loss: 74967.3865; train_edge_recon_loss: 2690096.7538; train_gene_expr_recon_loss: 11501084.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27535677.3893; train_global_loss: 41801826.3511; train_optim_loss: 41801826.3511; val_kl_reg_loss: 42856.1464; val_edge_recon_loss: 2703814.4833; val_gene_expr_recon_loss: 11670164.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28154932.2667; val_global_loss: 42571767.4667; val_optim_loss: 42571767.4667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9687; val_auprc_score: 0.9566; val_best_acc_score: 0.9209; val_best_f1_score: 0.9240; train_kl_reg_loss: 74367.0209; train_edge_recon_loss: 2688469.5802; train_gene_expr_recon_loss: 11509980.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27543333.9389; train_global_loss: 41816150.8702; train_optim_loss: 41816150.8702; val_kl_reg_loss: 43142.9758; val_edge_recon_loss: 2705079.0667; val_gene_expr_recon_loss: 11661049.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27999429.3333; val_global_loss: 42408700.2667; val_optim_loss: 42408700.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9706; val_auprc_score: 0.9606; val_best_acc_score: 0.9210; val_best_f1_score: 0.9234; train_kl_reg_loss: 73613.4929; train_edge_recon_loss: 2688614.5401; train_gene_expr_recon_loss: 11505491.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27543227.5267; train_global_loss: 41810946.9008; train_optim_loss: 41810946.9008; val_kl_reg_loss: 43793.9992; val_edge_recon_loss: 2709992.2000; val_gene_expr_recon_loss: 11643949.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28094318.6667; val_global_loss: 42492054.6667; val_optim_loss: 42492054.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9757
val AUPRC score: 0.9702
val best accuracy score: 0.9279
val best F1 score: 0.9304
val target rna MSE score: 1.4072
val source rna MSE score: 40.2750
val target atac MSE score: 0.1309
val source atac MSE score: 0.1877
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
