[True]
Run timestamp: 07082023_172240_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8726; val_auprc_score: 0.8958; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17262.5859; train_edge_recon_loss: 36268.4193; train_gene_expr_recon_loss: 1495709.8194; train_masked_gp_l1_reg_loss: 4475.3048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119519.9991; train_chrom_access_recon_loss: 3267292.0556; train_global_loss: 4940528.1944; train_optim_loss: 4940528.1944; val_kl_reg_loss: 9938.4961; val_edge_recon_loss: 40660.9609; val_gene_expr_recon_loss: 1103680.7500; val_masked_gp_l1_reg_loss: 3772.7632; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117212.5938; val_chrom_access_recon_loss: 1790466.5000; val_global_loss: 3065732.0000; val_optim_loss: 3065732.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8799; val_auprc_score: 0.8997; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7713.2267; train_edge_recon_loss: 37022.4054; train_gene_expr_recon_loss: 1070085.6736; train_masked_gp_l1_reg_loss: 3612.0041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115902.8811; train_chrom_access_recon_loss: 1604284.1667; train_global_loss: 2838620.2778; train_optim_loss: 2838620.2778; val_kl_reg_loss: 5101.6323; val_edge_recon_loss: 40660.1562; val_gene_expr_recon_loss: 989353.1875; val_masked_gp_l1_reg_loss: 3603.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114409.1406; val_chrom_access_recon_loss: 1439476.1250; val_global_loss: 2592603.5000; val_optim_loss: 2592603.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8763; val_auprc_score: 0.8917; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5877.9023; train_edge_recon_loss: 36631.2292; train_gene_expr_recon_loss: 980608.7569; train_masked_gp_l1_reg_loss: 3831.1490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113321.5165; train_chrom_access_recon_loss: 1453902.0972; train_global_loss: 2594172.6667; train_optim_loss: 2594172.6667; val_kl_reg_loss: 8031.1245; val_edge_recon_loss: 40661.3242; val_gene_expr_recon_loss: 899113.2500; val_masked_gp_l1_reg_loss: 4131.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111966.5469; val_chrom_access_recon_loss: 1404283.7500; val_global_loss: 2468187.5000; val_optim_loss: 2468187.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8976; val_auprc_score: 0.9060; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13265.1772; train_edge_recon_loss: 37948.6984; train_gene_expr_recon_loss: 867475.7153; train_masked_gp_l1_reg_loss: 4263.7405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110855.5842; train_chrom_access_recon_loss: 1420036.4306; train_global_loss: 2453845.3611; train_optim_loss: 2453845.3611; val_kl_reg_loss: 18331.3887; val_edge_recon_loss: 40661.8516; val_gene_expr_recon_loss: 794281.7500; val_masked_gp_l1_reg_loss: 4354.1904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109423.2891; val_chrom_access_recon_loss: 1376647.3750; val_global_loss: 2343700.0000; val_optim_loss: 2343700.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8889; val_auprc_score: 0.8985; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20974.4748; train_edge_recon_loss: 38898.3537; train_gene_expr_recon_loss: 789320.0486; train_masked_gp_l1_reg_loss: 4361.1929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108161.7882; train_chrom_access_recon_loss: 1396059.7361; train_global_loss: 2357775.6111; train_optim_loss: 2357775.6111; val_kl_reg_loss: 20224.7637; val_edge_recon_loss: 40661.4648; val_gene_expr_recon_loss: 744908.5000; val_masked_gp_l1_reg_loss: 4348.8452; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106498.5000; val_chrom_access_recon_loss: 1347586.5000; val_global_loss: 2264228.5000; val_optim_loss: 2264228.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8746; val_auprc_score: 0.8798; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21227.3394; train_edge_recon_loss: 38926.7153; train_gene_expr_recon_loss: 750324.9306; train_masked_gp_l1_reg_loss: 4331.3381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105041.3255; train_chrom_access_recon_loss: 1362443.3611; train_global_loss: 2282295.0556; train_optim_loss: 2282295.0556; val_kl_reg_loss: 20533.6562; val_edge_recon_loss: 40659.7656; val_gene_expr_recon_loss: 719545.8750; val_masked_gp_l1_reg_loss: 4305.5708; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103149.1875; val_chrom_access_recon_loss: 1327182.0000; val_global_loss: 2215376.0000; val_optim_loss: 2215376.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8551; val_auprc_score: 0.8595; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 21947.6851; train_edge_recon_loss: 38956.2973; train_gene_expr_recon_loss: 722139.5764; train_masked_gp_l1_reg_loss: 4288.1442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101547.7509; train_chrom_access_recon_loss: 1336560.9583; train_global_loss: 2225440.3333; train_optim_loss: 2225440.3333; val_kl_reg_loss: 21905.7383; val_edge_recon_loss: 40657.1641; val_gene_expr_recon_loss: 699955.2500; val_masked_gp_l1_reg_loss: 4261.0181; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99509.9609; val_chrom_access_recon_loss: 1316277.5000; val_global_loss: 2182566.5000; val_optim_loss: 2182566.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8516; val_auprc_score: 0.8475; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 23119.6367; train_edge_recon_loss: 39056.5582; train_gene_expr_recon_loss: 710981.3472; train_masked_gp_l1_reg_loss: 4239.3074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97839.5894; train_chrom_access_recon_loss: 1336800.7500; train_global_loss: 2212037.1667; train_optim_loss: 2212037.1667; val_kl_reg_loss: 21567.8262; val_edge_recon_loss: 40651.1328; val_gene_expr_recon_loss: 687180.6875; val_masked_gp_l1_reg_loss: 4209.6152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95736.4062; val_chrom_access_recon_loss: 1308318.2500; val_global_loss: 2157664.0000; val_optim_loss: 2157664.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8409; val_auprc_score: 0.8344; val_best_acc_score: 0.5143; val_best_f1_score: 0.6731; train_kl_reg_loss: 22596.5681; train_edge_recon_loss: 39014.5013; train_gene_expr_recon_loss: 698287.6389; train_masked_gp_l1_reg_loss: 4199.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94043.9991; train_chrom_access_recon_loss: 1333104.3750; train_global_loss: 2191246.2500; train_optim_loss: 2191246.2500; val_kl_reg_loss: 21566.9727; val_edge_recon_loss: 40644.1406; val_gene_expr_recon_loss: 676598.0625; val_masked_gp_l1_reg_loss: 4184.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91926.7812; val_chrom_access_recon_loss: 1302350.0000; val_global_loss: 2137270.0000; val_optim_loss: 2137270.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8253; val_auprc_score: 0.8138; val_best_acc_score: 0.5334; val_best_f1_score: 0.6812; train_kl_reg_loss: 23075.3503; train_edge_recon_loss: 39056.7973; train_gene_expr_recon_loss: 685054.2569; train_masked_gp_l1_reg_loss: 4175.1561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90240.5738; train_chrom_access_recon_loss: 1323452.9167; train_global_loss: 2165055.0556; train_optim_loss: 2165055.0556; val_kl_reg_loss: 21861.1992; val_edge_recon_loss: 40632.3477; val_gene_expr_recon_loss: 667373.3750; val_masked_gp_l1_reg_loss: 4155.8687; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88139.2031; val_chrom_access_recon_loss: 1297397.0000; val_global_loss: 2119559.0000; val_optim_loss: 2119559.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8199; val_auprc_score: 0.8136; val_best_acc_score: 0.5687; val_best_f1_score: 0.6966; train_kl_reg_loss: 23142.1200; train_edge_recon_loss: 39084.1150; train_gene_expr_recon_loss: 679665.0903; train_masked_gp_l1_reg_loss: 4139.7009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86479.3038; train_chrom_access_recon_loss: 1316406.8333; train_global_loss: 2148917.1389; train_optim_loss: 2148917.1389; val_kl_reg_loss: 22281.8828; val_edge_recon_loss: 40613.4414; val_gene_expr_recon_loss: 659333.0000; val_masked_gp_l1_reg_loss: 4119.9624; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84418.2031; val_chrom_access_recon_loss: 1292755.3750; val_global_loss: 2103521.7500; val_optim_loss: 2103521.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8103; val_auprc_score: 0.8043; val_best_acc_score: 0.5954; val_best_f1_score: 0.7069; train_kl_reg_loss: 23400.7554; train_edge_recon_loss: 39102.0100; train_gene_expr_recon_loss: 671254.7986; train_masked_gp_l1_reg_loss: 4115.5960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82803.4323; train_chrom_access_recon_loss: 1311763.8333; train_global_loss: 2132440.3889; train_optim_loss: 2132440.3889; val_kl_reg_loss: 22575.7051; val_edge_recon_loss: 40591.1562; val_gene_expr_recon_loss: 652971.5000; val_masked_gp_l1_reg_loss: 4105.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80802.1797; val_chrom_access_recon_loss: 1288523.8750; val_global_loss: 2089570.0000; val_optim_loss: 2089570.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7951; val_auprc_score: 0.7900; val_best_acc_score: 0.6292; val_best_f1_score: 0.7225; train_kl_reg_loss: 23557.6513; train_edge_recon_loss: 39112.8702; train_gene_expr_recon_loss: 668169.7708; train_masked_gp_l1_reg_loss: 4096.1249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79240.1172; train_chrom_access_recon_loss: 1312413.9583; train_global_loss: 2126590.5000; train_optim_loss: 2126590.5000; val_kl_reg_loss: 22542.2695; val_edge_recon_loss: 40563.4180; val_gene_expr_recon_loss: 648444.2500; val_masked_gp_l1_reg_loss: 4078.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77312.6875; val_chrom_access_recon_loss: 1284802.7500; val_global_loss: 2077744.1250; val_optim_loss: 2077744.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7910; val_auprc_score: 0.7804; val_best_acc_score: 0.6543; val_best_f1_score: 0.7329; train_kl_reg_loss: 23394.8544; train_edge_recon_loss: 39107.8767; train_gene_expr_recon_loss: 661866.4583; train_masked_gp_l1_reg_loss: 4071.0764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75814.5981; train_chrom_access_recon_loss: 1308875.3194; train_global_loss: 2113130.1944; train_optim_loss: 2113130.1944; val_kl_reg_loss: 21716.3633; val_edge_recon_loss: 40528.6172; val_gene_expr_recon_loss: 646066.7500; val_masked_gp_l1_reg_loss: 4056.0435; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73967.0781; val_chrom_access_recon_loss: 1282237.7500; val_global_loss: 2068572.6250; val_optim_loss: 2068572.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7891; val_auprc_score: 0.7793; val_best_acc_score: 0.6696; val_best_f1_score: 0.7399; train_kl_reg_loss: 23057.1339; train_edge_recon_loss: 39099.5994; train_gene_expr_recon_loss: 659263.5625; train_masked_gp_l1_reg_loss: 4050.7586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72539.6233; train_chrom_access_recon_loss: 1303532.6250; train_global_loss: 2101543.2778; train_optim_loss: 2101543.2778; val_kl_reg_loss: 21622.6406; val_edge_recon_loss: 40519.2695; val_gene_expr_recon_loss: 642783.6250; val_masked_gp_l1_reg_loss: 4040.2639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70779.0547; val_chrom_access_recon_loss: 1279709.6250; val_global_loss: 2059454.5000; val_optim_loss: 2059454.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7904; val_auprc_score: 0.7858; val_best_acc_score: 0.6698; val_best_f1_score: 0.7389; train_kl_reg_loss: 22465.3655; train_edge_recon_loss: 39066.3108; train_gene_expr_recon_loss: 653178.2361; train_masked_gp_l1_reg_loss: 4041.4076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69424.4340; train_chrom_access_recon_loss: 1301412.5972; train_global_loss: 2089588.3333; train_optim_loss: 2089588.3333; val_kl_reg_loss: 21614.2285; val_edge_recon_loss: 40515.0430; val_gene_expr_recon_loss: 639953.6250; val_masked_gp_l1_reg_loss: 4036.8774; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67759.4688; val_chrom_access_recon_loss: 1277092.3750; val_global_loss: 2050971.6250; val_optim_loss: 2050971.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7927; val_auprc_score: 0.7883; val_best_acc_score: 0.6859; val_best_f1_score: 0.7437; train_kl_reg_loss: 21909.4633; train_edge_recon_loss: 39028.6589; train_gene_expr_recon_loss: 653364.3681; train_masked_gp_l1_reg_loss: 4037.3534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66475.4757; train_chrom_access_recon_loss: 1302280.7639; train_global_loss: 2087096.1250; train_optim_loss: 2087096.1250; val_kl_reg_loss: 20798.3105; val_edge_recon_loss: 40488.2422; val_gene_expr_recon_loss: 638136.5625; val_masked_gp_l1_reg_loss: 4031.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64897.1953; val_chrom_access_recon_loss: 1274761.1250; val_global_loss: 2043113.2500; val_optim_loss: 2043113.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8015; val_auprc_score: 0.7949; val_best_acc_score: 0.7040; val_best_f1_score: 0.7502; train_kl_reg_loss: 21555.9395; train_edge_recon_loss: 39002.3038; train_gene_expr_recon_loss: 650081.8472; train_masked_gp_l1_reg_loss: 4030.3169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63683.8103; train_chrom_access_recon_loss: 1296123.5833; train_global_loss: 2074477.8056; train_optim_loss: 2074477.8056; val_kl_reg_loss: 20184.4961; val_edge_recon_loss: 40461.4062; val_gene_expr_recon_loss: 636473.7500; val_masked_gp_l1_reg_loss: 4022.7324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62193.9883; val_chrom_access_recon_loss: 1273025.8750; val_global_loss: 2036362.2500; val_optim_loss: 2036362.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8172; val_auprc_score: 0.8102; val_best_acc_score: 0.7208; val_best_f1_score: 0.7557; train_kl_reg_loss: 21068.5206; train_edge_recon_loss: 38964.8286; train_gene_expr_recon_loss: 651052.6319; train_masked_gp_l1_reg_loss: 4023.9367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61052.3290; train_chrom_access_recon_loss: 1294846.7917; train_global_loss: 2071009.0417; train_optim_loss: 2071009.0417; val_kl_reg_loss: 19884.2520; val_edge_recon_loss: 40412.0859; val_gene_expr_recon_loss: 634888.1875; val_masked_gp_l1_reg_loss: 4024.5823; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59649.4375; val_chrom_access_recon_loss: 1271069.0000; val_global_loss: 2029927.5000; val_optim_loss: 2029927.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8254; val_auprc_score: 0.8162; val_best_acc_score: 0.7366; val_best_f1_score: 0.7629; train_kl_reg_loss: 20697.7329; train_edge_recon_loss: 38908.1714; train_gene_expr_recon_loss: 650911.6528; train_masked_gp_l1_reg_loss: 4032.1845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58573.1354; train_chrom_access_recon_loss: 1291073.7639; train_global_loss: 2064196.6250; train_optim_loss: 2064196.6250; val_kl_reg_loss: 19841.5898; val_edge_recon_loss: 40386.6953; val_gene_expr_recon_loss: 632901.6250; val_masked_gp_l1_reg_loss: 4034.2019; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57250.0469; val_chrom_access_recon_loss: 1268832.8750; val_global_loss: 2023247.0000; val_optim_loss: 2023247.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8458; val_auprc_score: 0.8388; val_best_acc_score: 0.7639; val_best_f1_score: 0.7742; train_kl_reg_loss: 20360.3121; train_edge_recon_loss: 38854.4297; train_gene_expr_recon_loss: 646838.6667; train_masked_gp_l1_reg_loss: 4039.5483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56237.5586; train_chrom_access_recon_loss: 1292780.7778; train_global_loss: 2059111.3333; train_optim_loss: 2059111.3333; val_kl_reg_loss: 18914.4590; val_edge_recon_loss: 40306.6172; val_gene_expr_recon_loss: 632201.0000; val_masked_gp_l1_reg_loss: 4041.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54991.1797; val_chrom_access_recon_loss: 1269478.8750; val_global_loss: 2019933.5000; val_optim_loss: 2019933.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8558; val_auprc_score: 0.8504; val_best_acc_score: 0.7788; val_best_f1_score: 0.7803; train_kl_reg_loss: 19964.6204; train_edge_recon_loss: 38797.0095; train_gene_expr_recon_loss: 647037.0486; train_masked_gp_l1_reg_loss: 4047.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54038.1029; train_chrom_access_recon_loss: 1292764.2639; train_global_loss: 2056648.5278; train_optim_loss: 2056648.5278; val_kl_reg_loss: 18351.8945; val_edge_recon_loss: 40238.5117; val_gene_expr_recon_loss: 631384.8750; val_masked_gp_l1_reg_loss: 4047.3657; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52861.1406; val_chrom_access_recon_loss: 1267905.8750; val_global_loss: 2014789.6250; val_optim_loss: 2014789.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8725; val_auprc_score: 0.8672; val_best_acc_score: 0.7956; val_best_f1_score: 0.7938; train_kl_reg_loss: 19639.7086; train_edge_recon_loss: 38744.9388; train_gene_expr_recon_loss: 641826.3958; train_masked_gp_l1_reg_loss: 4056.6271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51963.8633; train_chrom_access_recon_loss: 1287191.9306; train_global_loss: 2043423.4583; train_optim_loss: 2043423.4583; val_kl_reg_loss: 18730.3398; val_edge_recon_loss: 40213.1172; val_gene_expr_recon_loss: 629005.1875; val_masked_gp_l1_reg_loss: 4057.6812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50853.3516; val_chrom_access_recon_loss: 1265392.6250; val_global_loss: 2008252.2500; val_optim_loss: 2008252.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8754; val_auprc_score: 0.8652; val_best_acc_score: 0.7987; val_best_f1_score: 0.7946; train_kl_reg_loss: 19166.6096; train_edge_recon_loss: 38687.2435; train_gene_expr_recon_loss: 640387.4236; train_masked_gp_l1_reg_loss: 4063.6623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50000.8628; train_chrom_access_recon_loss: 1282422.2083; train_global_loss: 2034728.0139; train_optim_loss: 2034728.0139; val_kl_reg_loss: 18798.8047; val_edge_recon_loss: 40194.2500; val_gene_expr_recon_loss: 627583.6250; val_masked_gp_l1_reg_loss: 4062.6858; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48956.3203; val_chrom_access_recon_loss: 1264081.3750; val_global_loss: 2003677.0000; val_optim_loss: 2003677.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8812; val_auprc_score: 0.8757; val_best_acc_score: 0.7991; val_best_f1_score: 0.7888; train_kl_reg_loss: 19027.9540; train_edge_recon_loss: 38627.0343; train_gene_expr_recon_loss: 641599.3819; train_masked_gp_l1_reg_loss: 4066.9655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48152.0039; train_chrom_access_recon_loss: 1287534.5278; train_global_loss: 2039007.8750; train_optim_loss: 2039007.8750; val_kl_reg_loss: 18381.1328; val_edge_recon_loss: 40124.3633; val_gene_expr_recon_loss: 626637.1250; val_masked_gp_l1_reg_loss: 4069.3862; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47160.0195; val_chrom_access_recon_loss: 1261902.6250; val_global_loss: 1998274.6250; val_optim_loss: 1998274.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8837; val_auprc_score: 0.8832; val_best_acc_score: 0.7820; val_best_f1_score: 0.8045; train_kl_reg_loss: 16597.7080; train_edge_recon_loss: 40094.9058; train_gene_expr_recon_loss: 954547.7986; train_masked_gp_l1_reg_loss: 4133.8169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46294.4392; train_chrom_access_recon_loss: 1359071.1667; train_global_loss: 2420739.7778; train_optim_loss: 2420739.7778; val_kl_reg_loss: 14553.6621; val_edge_recon_loss: 40433.1953; val_gene_expr_recon_loss: 924736.6250; val_masked_gp_l1_reg_loss: 4259.2817; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45166.0781; val_chrom_access_recon_loss: 1329598.0000; val_global_loss: 2358747.0000; val_optim_loss: 2358747.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8819; val_auprc_score: 0.8757; val_best_acc_score: 0.7909; val_best_f1_score: 0.8072; train_kl_reg_loss: 15702.0944; train_edge_recon_loss: 40116.6241; train_gene_expr_recon_loss: 944080.3819; train_masked_gp_l1_reg_loss: 4374.9475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44238.8841; train_chrom_access_recon_loss: 1355530.9167; train_global_loss: 2404043.8333; train_optim_loss: 2404043.8333; val_kl_reg_loss: 13976.4844; val_edge_recon_loss: 40393.1992; val_gene_expr_recon_loss: 917913.3125; val_masked_gp_l1_reg_loss: 4511.4873; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43087.7188; val_chrom_access_recon_loss: 1327434.6250; val_global_loss: 2347317.0000; val_optim_loss: 2347317.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8804; val_auprc_score: 0.8774; val_best_acc_score: 0.7862; val_best_f1_score: 0.8019; train_kl_reg_loss: 15364.2983; train_edge_recon_loss: 40122.0048; train_gene_expr_recon_loss: 938788.3889; train_masked_gp_l1_reg_loss: 4599.8660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42196.2279; train_chrom_access_recon_loss: 1348758.6389; train_global_loss: 2389829.4167; train_optim_loss: 2389829.4167; val_kl_reg_loss: 13724.5215; val_edge_recon_loss: 40388.6680; val_gene_expr_recon_loss: 913169.6250; val_masked_gp_l1_reg_loss: 4696.0933; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41101.6328; val_chrom_access_recon_loss: 1325971.0000; val_global_loss: 2339051.5000; val_optim_loss: 2339051.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8811; val_auprc_score: 0.8722; val_best_acc_score: 0.7974; val_best_f1_score: 0.8090; train_kl_reg_loss: 15329.9240; train_edge_recon_loss: 40126.0720; train_gene_expr_recon_loss: 935872.8194; train_masked_gp_l1_reg_loss: 4755.3292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40261.8503; train_chrom_access_recon_loss: 1350909.6528; train_global_loss: 2387255.6389; train_optim_loss: 2387255.6389; val_kl_reg_loss: 13803.4863; val_edge_recon_loss: 40370.7031; val_gene_expr_recon_loss: 908986.8750; val_masked_gp_l1_reg_loss: 4818.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39234.7734; val_chrom_access_recon_loss: 1324075.8750; val_global_loss: 2331290.0000; val_optim_loss: 2331290.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8829; val_auprc_score: 0.8814; val_best_acc_score: 0.7905; val_best_f1_score: 0.8054; train_kl_reg_loss: 15070.3539; train_edge_recon_loss: 40117.1497; train_gene_expr_recon_loss: 926695.3472; train_masked_gp_l1_reg_loss: 4808.5093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39123.1024; train_chrom_access_recon_loss: 1350658.6250; train_global_loss: 2376473.0556; train_optim_loss: 2376473.0556; val_kl_reg_loss: 14257.4766; val_edge_recon_loss: 40390.2930; val_gene_expr_recon_loss: 908155.0625; val_masked_gp_l1_reg_loss: 4800.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38987.8359; val_chrom_access_recon_loss: 1323539.2500; val_global_loss: 2330130.2500; val_optim_loss: 2330130.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8805; val_auprc_score: 0.8735; val_best_acc_score: 0.7933; val_best_f1_score: 0.8072; train_kl_reg_loss: 15475.9261; train_edge_recon_loss: 40135.5508; train_gene_expr_recon_loss: 931358.9583; train_masked_gp_l1_reg_loss: 4800.0913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38891.1940; train_chrom_access_recon_loss: 1351880.4028; train_global_loss: 2382542.1667; train_optim_loss: 2382542.1667; val_kl_reg_loss: 14234.9365; val_edge_recon_loss: 40381.3984; val_gene_expr_recon_loss: 907811.3750; val_masked_gp_l1_reg_loss: 4797.7959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38769.6211; val_chrom_access_recon_loss: 1323339.1250; val_global_loss: 2329334.2500; val_optim_loss: 2329334.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8823; val_auprc_score: 0.8801; val_best_acc_score: 0.7912; val_best_f1_score: 0.8049; train_kl_reg_loss: 15201.4825; train_edge_recon_loss: 40119.9562; train_gene_expr_recon_loss: 925700.5069; train_masked_gp_l1_reg_loss: 4797.2128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38677.2201; train_chrom_access_recon_loss: 1351506.5556; train_global_loss: 2376002.9444; train_optim_loss: 2376002.9444; val_kl_reg_loss: 14070.3379; val_edge_recon_loss: 40378.3320; val_gene_expr_recon_loss: 907600.6250; val_masked_gp_l1_reg_loss: 4796.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38563.0117; val_chrom_access_recon_loss: 1323257.7500; val_global_loss: 2328667.0000; val_optim_loss: 2328667.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8843; val_auprc_score: 0.8790; val_best_acc_score: 0.8011; val_best_f1_score: 0.8126; train_kl_reg_loss: 15241.1857; train_edge_recon_loss: 40113.6623; train_gene_expr_recon_loss: 930671.3889; train_masked_gp_l1_reg_loss: 4797.4830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38473.7695; train_chrom_access_recon_loss: 1347477.1806; train_global_loss: 2376774.6667; train_optim_loss: 2376774.6667; val_kl_reg_loss: 14230.2285; val_edge_recon_loss: 40383.0156; val_gene_expr_recon_loss: 907080.6250; val_masked_gp_l1_reg_loss: 4798.4341; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38365.0938; val_chrom_access_recon_loss: 1322886.6250; val_global_loss: 2327744.0000; val_optim_loss: 2327744.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8843
val AUPRC score: 0.8813
val best accuracy score: 0.7734
val best F1 score: 0.8004
val target rna MSE score: 3.6712
val source rna MSE score: 3.1472
val target atac MSE score: 0.1284
val source atac MSE score: 0.0190
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
