[True]
Run timestamp: 09102023_191618_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6656; val_auprc_score: 0.6469; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 41164.3131; train_edge_recon_loss: 3500837.0152; train_gene_expr_recon_loss: 14012755.2727; train_masked_gp_l1_reg_loss: 45945.1725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5483341.6856; train_chrom_access_recon_loss: 1002099.7131; train_global_loss: 24086143.1212; train_optim_loss: 24086143.1212; val_kl_reg_loss: 75218.4199; val_edge_recon_loss: 4065220.4375; val_gene_expr_recon_loss: 12856065.3750; val_masked_gp_l1_reg_loss: 52633.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2478320.7500; val_chrom_access_recon_loss: 965601.7891; val_global_loss: 20493060.5000; val_optim_loss: 20493060.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7074; val_auprc_score: 0.6842; val_best_acc_score: 0.6306; val_best_f1_score: 0.7101; train_kl_reg_loss: 84391.1789; train_edge_recon_loss: 3511427.5152; train_gene_expr_recon_loss: 12857930.5152; train_masked_gp_l1_reg_loss: 54057.3810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1117411.0791; train_chrom_access_recon_loss: 957785.9081; train_global_loss: 18583003.6364; train_optim_loss: 18583003.6364; val_kl_reg_loss: 89157.5137; val_edge_recon_loss: 4057569.3125; val_gene_expr_recon_loss: 12646787.2500; val_masked_gp_l1_reg_loss: 55466.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 436552.9062; val_chrom_access_recon_loss: 951581.0781; val_global_loss: 18237113.5000; val_optim_loss: 18237113.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7467; val_auprc_score: 0.7186; val_best_acc_score: 0.6805; val_best_f1_score: 0.7269; train_kl_reg_loss: 79712.0449; train_edge_recon_loss: 3504218.8902; train_gene_expr_recon_loss: 12683995.3788; train_masked_gp_l1_reg_loss: 56824.0978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 296056.6027; train_chrom_access_recon_loss: 946068.6989; train_global_loss: 17566875.6970; train_optim_loss: 17566875.6970; val_kl_reg_loss: 80913.1543; val_edge_recon_loss: 3955523.1562; val_gene_expr_recon_loss: 12496732.1250; val_masked_gp_l1_reg_loss: 58364.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209994.2031; val_chrom_access_recon_loss: 943352.4453; val_global_loss: 17744879.2500; val_optim_loss: 17744879.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7625; val_auprc_score: 0.7613; val_best_acc_score: 0.6749; val_best_f1_score: 0.7296; train_kl_reg_loss: 60408.4129; train_edge_recon_loss: 3355850.3220; train_gene_expr_recon_loss: 12624066.3333; train_masked_gp_l1_reg_loss: 60570.0268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172975.5916; train_chrom_access_recon_loss: 942536.1174; train_global_loss: 17216406.6667; train_optim_loss: 17216406.6667; val_kl_reg_loss: 65594.2432; val_edge_recon_loss: 3284204.2812; val_gene_expr_recon_loss: 12505666.3750; val_masked_gp_l1_reg_loss: 63531.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143815.7656; val_chrom_access_recon_loss: 944875.2188; val_global_loss: 17007687.1250; val_optim_loss: 17007687.1250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7921; val_auprc_score: 0.7787; val_best_acc_score: 0.7117; val_best_f1_score: 0.7414; train_kl_reg_loss: 81705.1361; train_edge_recon_loss: 3094080.2159; train_gene_expr_recon_loss: 12565548.1970; train_masked_gp_l1_reg_loss: 65454.1093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126623.4663; train_chrom_access_recon_loss: 938029.1259; train_global_loss: 16871440.3333; train_optim_loss: 16871440.3333; val_kl_reg_loss: 93601.6533; val_edge_recon_loss: 3163092.8750; val_gene_expr_recon_loss: 12378472.3750; val_masked_gp_l1_reg_loss: 67533.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115093.6719; val_chrom_access_recon_loss: 927202.1484; val_global_loss: 16744996.0000; val_optim_loss: 16744996.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8297; val_auprc_score: 0.8137; val_best_acc_score: 0.7507; val_best_f1_score: 0.7679; train_kl_reg_loss: 85994.8667; train_edge_recon_loss: 3027757.5038; train_gene_expr_recon_loss: 12482888.7576; train_masked_gp_l1_reg_loss: 69389.8138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108276.2418; train_chrom_access_recon_loss: 932579.9527; train_global_loss: 16706887.0000; train_optim_loss: 16706887.0000; val_kl_reg_loss: 86543.3740; val_edge_recon_loss: 3031037.8125; val_gene_expr_recon_loss: 12396360.2500; val_masked_gp_l1_reg_loss: 71525.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104912.5156; val_chrom_access_recon_loss: 933093.8281; val_global_loss: 16623473.6250; val_optim_loss: 16623473.6250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8629; val_auprc_score: 0.8348; val_best_acc_score: 0.7843; val_best_f1_score: 0.8097; train_kl_reg_loss: 91466.1072; train_edge_recon_loss: 2920178.3523; train_gene_expr_recon_loss: 12415135.8182; train_masked_gp_l1_reg_loss: 73360.1591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104862.8913; train_chrom_access_recon_loss: 927572.0398; train_global_loss: 16532575.3182; train_optim_loss: 16532575.3182; val_kl_reg_loss: 93263.5371; val_edge_recon_loss: 2915044.5938; val_gene_expr_recon_loss: 12227591.5000; val_masked_gp_l1_reg_loss: 75212.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104841.7500; val_chrom_access_recon_loss: 918268.6172; val_global_loss: 16334222.2500; val_optim_loss: 16334222.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8737; val_auprc_score: 0.8394; val_best_acc_score: 0.7974; val_best_f1_score: 0.8205; train_kl_reg_loss: 95907.0344; train_edge_recon_loss: 2870218.1818; train_gene_expr_recon_loss: 12344118.5606; train_masked_gp_l1_reg_loss: 76620.5709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102170.4264; train_chrom_access_recon_loss: 923918.9943; train_global_loss: 16412953.7879; train_optim_loss: 16412953.7879; val_kl_reg_loss: 95023.3965; val_edge_recon_loss: 2848617.2500; val_gene_expr_recon_loss: 12084496.6250; val_masked_gp_l1_reg_loss: 77666.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99629.0000; val_chrom_access_recon_loss: 912344.8828; val_global_loss: 16117777.1250; val_optim_loss: 16117777.1250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8742; val_auprc_score: 0.8428; val_best_acc_score: 0.8017; val_best_f1_score: 0.8201; train_kl_reg_loss: 96199.8540; train_edge_recon_loss: 2829951.4470; train_gene_expr_recon_loss: 12288566.9394; train_masked_gp_l1_reg_loss: 78474.9751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97189.5253; train_chrom_access_recon_loss: 918400.3097; train_global_loss: 16308783.2273; train_optim_loss: 16308783.2273; val_kl_reg_loss: 89879.6104; val_edge_recon_loss: 2881487.9375; val_gene_expr_recon_loss: 12244813.0000; val_masked_gp_l1_reg_loss: 79397.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95974.7344; val_chrom_access_recon_loss: 921129.8203; val_global_loss: 16312682.2500; val_optim_loss: 16312682.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8914; val_auprc_score: 0.8569; val_best_acc_score: 0.8143; val_best_f1_score: 0.8342; train_kl_reg_loss: 91412.0058; train_edge_recon_loss: 2820357.5492; train_gene_expr_recon_loss: 12238168.5000; train_masked_gp_l1_reg_loss: 80247.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95508.0922; train_chrom_access_recon_loss: 916021.2131; train_global_loss: 16241714.5303; train_optim_loss: 16241714.5303; val_kl_reg_loss: 84845.1465; val_edge_recon_loss: 2842952.8125; val_gene_expr_recon_loss: 12094495.6250; val_masked_gp_l1_reg_loss: 81006.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95980.3047; val_chrom_access_recon_loss: 914786.4297; val_global_loss: 16114066.7500; val_optim_loss: 16114066.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9037; val_auprc_score: 0.8712; val_best_acc_score: 0.8380; val_best_f1_score: 0.8500; train_kl_reg_loss: 90440.1326; train_edge_recon_loss: 2810568.8333; train_gene_expr_recon_loss: 12172121.6818; train_masked_gp_l1_reg_loss: 81600.4392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96655.0558; train_chrom_access_recon_loss: 910979.9811; train_global_loss: 16162366.1364; train_optim_loss: 16162366.1364; val_kl_reg_loss: 88693.2871; val_edge_recon_loss: 2801442.1250; val_gene_expr_recon_loss: 12063124.3750; val_masked_gp_l1_reg_loss: 82380.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97080.0469; val_chrom_access_recon_loss: 906675.7422; val_global_loss: 16039396.7500; val_optim_loss: 16039396.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8967; val_auprc_score: 0.8576; val_best_acc_score: 0.8356; val_best_f1_score: 0.8463; train_kl_reg_loss: 90047.8512; train_edge_recon_loss: 2795159.7386; train_gene_expr_recon_loss: 12123867.5000; train_masked_gp_l1_reg_loss: 82927.4567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95738.0146; train_chrom_access_recon_loss: 908048.5559; train_global_loss: 16095789.2121; train_optim_loss: 16095789.2121; val_kl_reg_loss: 90446.2422; val_edge_recon_loss: 2840372.2812; val_gene_expr_recon_loss: 11914082.8750; val_masked_gp_l1_reg_loss: 83500.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95029.5312; val_chrom_access_recon_loss: 902469.7969; val_global_loss: 15925901.2500; val_optim_loss: 15925901.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9122; val_auprc_score: 0.8883; val_best_acc_score: 0.8463; val_best_f1_score: 0.8564; train_kl_reg_loss: 88948.2719; train_edge_recon_loss: 2782580.9015; train_gene_expr_recon_loss: 12090135.8182; train_masked_gp_l1_reg_loss: 84104.9943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94107.5373; train_chrom_access_recon_loss: 905420.4318; train_global_loss: 16045298.0000; train_optim_loss: 16045298.0000; val_kl_reg_loss: 86815.7393; val_edge_recon_loss: 2828486.0312; val_gene_expr_recon_loss: 11985750.7500; val_masked_gp_l1_reg_loss: 84663.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93464.1094; val_chrom_access_recon_loss: 897637.5547; val_global_loss: 15976817.2500; val_optim_loss: 15976817.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9109; val_auprc_score: 0.8831; val_best_acc_score: 0.8501; val_best_f1_score: 0.8580; train_kl_reg_loss: 89456.5694; train_edge_recon_loss: 2785256.9848; train_gene_expr_recon_loss: 12041917.0152; train_masked_gp_l1_reg_loss: 85186.6338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92575.2670; train_chrom_access_recon_loss: 902028.3059; train_global_loss: 15996420.6364; train_optim_loss: 15996420.6364; val_kl_reg_loss: 89501.6865; val_edge_recon_loss: 2804804.5312; val_gene_expr_recon_loss: 11878293.7500; val_masked_gp_l1_reg_loss: 85602.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92738.2344; val_chrom_access_recon_loss: 892550.7891; val_global_loss: 15843491.6250; val_optim_loss: 15843491.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9113; val_auprc_score: 0.8808; val_best_acc_score: 0.8482; val_best_f1_score: 0.8600; train_kl_reg_loss: 88878.8332; train_edge_recon_loss: 2767152.6742; train_gene_expr_recon_loss: 12010505.3333; train_masked_gp_l1_reg_loss: 86085.0125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91527.9292; train_chrom_access_recon_loss: 899473.4299; train_global_loss: 15943623.3333; train_optim_loss: 15943623.3333; val_kl_reg_loss: 87896.1279; val_edge_recon_loss: 2799551.6562; val_gene_expr_recon_loss: 11759493.7500; val_masked_gp_l1_reg_loss: 86632.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90665.4531; val_chrom_access_recon_loss: 889470.4297; val_global_loss: 15713708.8750; val_optim_loss: 15713708.8750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9129; val_auprc_score: 0.8761; val_best_acc_score: 0.8544; val_best_f1_score: 0.8644; train_kl_reg_loss: 87858.8874; train_edge_recon_loss: 2757196.6818; train_gene_expr_recon_loss: 11984626.6970; train_masked_gp_l1_reg_loss: 86967.9625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90287.8612; train_chrom_access_recon_loss: 896921.1477; train_global_loss: 15903859.2424; train_optim_loss: 15903859.2424; val_kl_reg_loss: 87496.3750; val_edge_recon_loss: 2798520.6250; val_gene_expr_recon_loss: 11857218.7500; val_masked_gp_l1_reg_loss: 87558.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90768.4453; val_chrom_access_recon_loss: 888769.1250; val_global_loss: 15810331.7500; val_optim_loss: 15810331.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9194; val_auprc_score: 0.8898; val_best_acc_score: 0.8576; val_best_f1_score: 0.8640; train_kl_reg_loss: 86698.8059; train_edge_recon_loss: 2752744.3598; train_gene_expr_recon_loss: 11937805.2576; train_masked_gp_l1_reg_loss: 87856.9818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90167.3400; train_chrom_access_recon_loss: 893047.1042; train_global_loss: 15848319.8788; train_optim_loss: 15848319.8788; val_kl_reg_loss: 88121.4023; val_edge_recon_loss: 2804165.7812; val_gene_expr_recon_loss: 11794697.5000; val_masked_gp_l1_reg_loss: 88044.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89934.6641; val_chrom_access_recon_loss: 896170.2344; val_global_loss: 15761134.1250; val_optim_loss: 15761134.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9281; val_auprc_score: 0.9016; val_best_acc_score: 0.8662; val_best_f1_score: 0.8751; train_kl_reg_loss: 85745.6396; train_edge_recon_loss: 2756247.4318; train_gene_expr_recon_loss: 11918860.9394; train_masked_gp_l1_reg_loss: 88428.7661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89391.9183; train_chrom_access_recon_loss: 891723.5966; train_global_loss: 15830398.3636; train_optim_loss: 15830398.3636; val_kl_reg_loss: 82919.9297; val_edge_recon_loss: 2753153.9688; val_gene_expr_recon_loss: 11826080.1250; val_masked_gp_l1_reg_loss: 88727.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89057.0781; val_chrom_access_recon_loss: 887695.4922; val_global_loss: 15727633.6250; val_optim_loss: 15727633.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9283; val_auprc_score: 0.9070; val_best_acc_score: 0.8635; val_best_f1_score: 0.8693; train_kl_reg_loss: 85443.5401; train_edge_recon_loss: 2746113.0644; train_gene_expr_recon_loss: 11889316.5152; train_masked_gp_l1_reg_loss: 89025.2525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88738.1899; train_chrom_access_recon_loss: 888820.5625; train_global_loss: 15787457.1515; train_optim_loss: 15787457.1515; val_kl_reg_loss: 85491.4766; val_edge_recon_loss: 2760028.4062; val_gene_expr_recon_loss: 11807840.5000; val_masked_gp_l1_reg_loss: 89350.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88643.5859; val_chrom_access_recon_loss: 885742.4141; val_global_loss: 15717097.0000; val_optim_loss: 15717097.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9217; val_auprc_score: 0.8872; val_best_acc_score: 0.8606; val_best_f1_score: 0.8686; train_kl_reg_loss: 85407.6589; train_edge_recon_loss: 2741940.8447; train_gene_expr_recon_loss: 11874935.4697; train_masked_gp_l1_reg_loss: 88374.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67989.5742; train_chrom_access_recon_loss: 888065.4943; train_global_loss: 15746713.0000; train_optim_loss: 15746713.0000; val_kl_reg_loss: 84779.6152; val_edge_recon_loss: 2776633.8125; val_gene_expr_recon_loss: 11849935.6250; val_masked_gp_l1_reg_loss: 87929.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63467.4570; val_chrom_access_recon_loss: 883505.4141; val_global_loss: 15746250.5000; val_optim_loss: 15746250.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9275; val_auprc_score: 0.9020; val_best_acc_score: 0.8635; val_best_f1_score: 0.8738; train_kl_reg_loss: 86143.2762; train_edge_recon_loss: 2745637.6402; train_gene_expr_recon_loss: 11856391.8485; train_masked_gp_l1_reg_loss: 87868.0830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63108.3554; train_chrom_access_recon_loss: 885800.7292; train_global_loss: 15724949.9545; train_optim_loss: 15724949.9545; val_kl_reg_loss: 85457.3770; val_edge_recon_loss: 2760453.0312; val_gene_expr_recon_loss: 11800164.1250; val_masked_gp_l1_reg_loss: 87854.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62887.2930; val_chrom_access_recon_loss: 891462.1641; val_global_loss: 15688277.5000; val_optim_loss: 15688277.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9260; val_auprc_score: 0.8981; val_best_acc_score: 0.8654; val_best_f1_score: 0.8745; train_kl_reg_loss: 86805.5361; train_edge_recon_loss: 2744041.7879; train_gene_expr_recon_loss: 11866466.1212; train_masked_gp_l1_reg_loss: 87832.2623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62755.6586; train_chrom_access_recon_loss: 886689.9631; train_global_loss: 15734591.1818; train_optim_loss: 15734591.1818; val_kl_reg_loss: 86336.4990; val_edge_recon_loss: 2755601.6562; val_gene_expr_recon_loss: 11749781.6250; val_masked_gp_l1_reg_loss: 87819.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62583.4102; val_chrom_access_recon_loss: 881731.1562; val_global_loss: 15623854.1250; val_optim_loss: 15623854.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9213; val_auprc_score: 0.8889; val_best_acc_score: 0.8624; val_best_f1_score: 0.8698; train_kl_reg_loss: 86821.8243; train_edge_recon_loss: 2744726.0341; train_gene_expr_recon_loss: 11862604.5909; train_masked_gp_l1_reg_loss: 87821.6542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62471.3933; train_chrom_access_recon_loss: 886036.2036; train_global_loss: 15730481.6061; train_optim_loss: 15730481.6061; val_kl_reg_loss: 86780.7422; val_edge_recon_loss: 2784570.3438; val_gene_expr_recon_loss: 11724820.2500; val_masked_gp_l1_reg_loss: 87847.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62413.9336; val_chrom_access_recon_loss: 888083.6719; val_global_loss: 15634516.7500; val_optim_loss: 15634516.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9310; val_auprc_score: 0.9057; val_best_acc_score: 0.8697; val_best_f1_score: 0.8773; train_kl_reg_loss: 87193.5508; train_edge_recon_loss: 2742050.6136; train_gene_expr_recon_loss: 11854520.5152; train_masked_gp_l1_reg_loss: 87835.7392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62276.8819; train_chrom_access_recon_loss: 885628.1752; train_global_loss: 15719505.6212; train_optim_loss: 15719505.6212; val_kl_reg_loss: 86859.6230; val_edge_recon_loss: 2755912.3750; val_gene_expr_recon_loss: 11870521.7500; val_masked_gp_l1_reg_loss: 87842.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62171.1719; val_chrom_access_recon_loss: 888437.1328; val_global_loss: 15751745.0000; val_optim_loss: 15751745.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9332; val_auprc_score: 0.9086; val_best_acc_score: 0.8686; val_best_f1_score: 0.8760; train_kl_reg_loss: 87041.7862; train_edge_recon_loss: 2739088.3788; train_gene_expr_recon_loss: 11848607.2273; train_masked_gp_l1_reg_loss: 87857.2325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62109.9240; train_chrom_access_recon_loss: 884761.1307; train_global_loss: 15709465.7576; train_optim_loss: 15709465.7576; val_kl_reg_loss: 86527.6025; val_edge_recon_loss: 2738479.1875; val_gene_expr_recon_loss: 11683960.7500; val_masked_gp_l1_reg_loss: 87872.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62062.1445; val_chrom_access_recon_loss: 880172.0078; val_global_loss: 15539074.5000; val_optim_loss: 15539074.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9186; val_auprc_score: 0.8902; val_best_acc_score: 0.8555; val_best_f1_score: 0.8649; train_kl_reg_loss: 100810.2454; train_edge_recon_loss: 3049057.2614; train_gene_expr_recon_loss: 10632291.8788; train_masked_gp_l1_reg_loss: 87903.5019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60974.1480; train_chrom_access_recon_loss: 854599.2225; train_global_loss: 14785636.3333; train_optim_loss: 14785636.3333; val_kl_reg_loss: 15293.0894; val_edge_recon_loss: 3008042.7812; val_gene_expr_recon_loss: 10481768.8750; val_masked_gp_l1_reg_loss: 88061.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60194.1680; val_chrom_access_recon_loss: 809351.1719; val_global_loss: 14462712.0000; val_optim_loss: 14462712.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9197; val_auprc_score: 0.8963; val_best_acc_score: 0.8509; val_best_f1_score: 0.8597; train_kl_reg_loss: 116008.4395; train_edge_recon_loss: 2924521.9129; train_gene_expr_recon_loss: 10539178.8485; train_masked_gp_l1_reg_loss: 88112.1071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59901.2505; train_chrom_access_recon_loss: 802892.8589; train_global_loss: 14530615.3636; train_optim_loss: 14530615.3636; val_kl_reg_loss: 17260.1909; val_edge_recon_loss: 2967780.0312; val_gene_expr_recon_loss: 10394532.0000; val_masked_gp_l1_reg_loss: 88126.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59663.9727; val_chrom_access_recon_loss: 791264.1016; val_global_loss: 14318626.3750; val_optim_loss: 14318626.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9273; val_auprc_score: 0.8997; val_best_acc_score: 0.8643; val_best_f1_score: 0.8730; train_kl_reg_loss: 118764.3865; train_edge_recon_loss: 2886467.4280; train_gene_expr_recon_loss: 10537406.6818; train_masked_gp_l1_reg_loss: 88071.0309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59595.6090; train_chrom_access_recon_loss: 795421.6383; train_global_loss: 14485726.8030; train_optim_loss: 14485726.8030; val_kl_reg_loss: 18661.9441; val_edge_recon_loss: 2879804.3750; val_gene_expr_recon_loss: 10479913.7500; val_masked_gp_l1_reg_loss: 88014.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59646.5664; val_chrom_access_recon_loss: 802190.4219; val_global_loss: 14328231.7500; val_optim_loss: 14328231.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9213; val_auprc_score: 0.8958; val_best_acc_score: 0.8541; val_best_f1_score: 0.8655; train_kl_reg_loss: 117365.9979; train_edge_recon_loss: 2861338.7462; train_gene_expr_recon_loss: 10518797.8030; train_masked_gp_l1_reg_loss: 87933.5108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59683.4254; train_chrom_access_recon_loss: 792008.5436; train_global_loss: 14437128.1061; train_optim_loss: 14437128.1061; val_kl_reg_loss: 19669.2068; val_edge_recon_loss: 2892596.8750; val_gene_expr_recon_loss: 10406334.7500; val_masked_gp_l1_reg_loss: 87840.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59707.6289; val_chrom_access_recon_loss: 790354.9844; val_global_loss: 14256504.7500; val_optim_loss: 14256504.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9178; val_auprc_score: 0.8920; val_best_acc_score: 0.8568; val_best_f1_score: 0.8656; train_kl_reg_loss: 113129.8860; train_edge_recon_loss: 2849810.3902; train_gene_expr_recon_loss: 10508721.7576; train_masked_gp_l1_reg_loss: 87741.8826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59796.4147; train_chrom_access_recon_loss: 790741.4773; train_global_loss: 14409941.8333; train_optim_loss: 14409941.8333; val_kl_reg_loss: 20672.4556; val_edge_recon_loss: 2906664.5312; val_gene_expr_recon_loss: 10374409.6250; val_masked_gp_l1_reg_loss: 87637.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59837.8281; val_chrom_access_recon_loss: 778650.7578; val_global_loss: 14227873.2500; val_optim_loss: 14227873.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9097; val_auprc_score: 0.8733; val_best_acc_score: 0.8493; val_best_f1_score: 0.8603; train_kl_reg_loss: 108438.5795; train_edge_recon_loss: 2833502.8826; train_gene_expr_recon_loss: 10505715.8182; train_masked_gp_l1_reg_loss: 87523.6016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59864.7718; train_chrom_access_recon_loss: 789749.4555; train_global_loss: 14384795.1212; train_optim_loss: 14384795.1212; val_kl_reg_loss: 21947.9995; val_edge_recon_loss: 2876046.6875; val_gene_expr_recon_loss: 10360496.3750; val_masked_gp_l1_reg_loss: 87404.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59948.5703; val_chrom_access_recon_loss: 779936.3438; val_global_loss: 14185780.3750; val_optim_loss: 14185780.3750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9108; val_auprc_score: 0.8687; val_best_acc_score: 0.8600; val_best_f1_score: 0.8686; train_kl_reg_loss: 104608.8899; train_edge_recon_loss: 2826320.8068; train_gene_expr_recon_loss: 10491089.5909; train_masked_gp_l1_reg_loss: 87274.7704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59997.9245; train_chrom_access_recon_loss: 788411.6913; train_global_loss: 14357703.7576; train_optim_loss: 14357703.7576; val_kl_reg_loss: 23351.8645; val_edge_recon_loss: 2853978.6562; val_gene_expr_recon_loss: 10328413.6250; val_masked_gp_l1_reg_loss: 87159.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60018.5430; val_chrom_access_recon_loss: 781545.6719; val_global_loss: 14134468.0000; val_optim_loss: 14134468.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9175; val_auprc_score: 0.8951; val_best_acc_score: 0.8563; val_best_f1_score: 0.8650; train_kl_reg_loss: 101362.7174; train_edge_recon_loss: 2807898.3750; train_gene_expr_recon_loss: 10477654.5303; train_masked_gp_l1_reg_loss: 87028.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60087.3824; train_chrom_access_recon_loss: 788146.1080; train_global_loss: 14322177.4091; train_optim_loss: 14322177.4091; val_kl_reg_loss: 24555.8923; val_edge_recon_loss: 2843491.6562; val_gene_expr_recon_loss: 10413202.2500; val_masked_gp_l1_reg_loss: 86877.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60152.5859; val_chrom_access_recon_loss: 786920.0938; val_global_loss: 14215201.1250; val_optim_loss: 14215201.1250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9213; val_auprc_score: 0.8920; val_best_acc_score: 0.8608; val_best_f1_score: 0.8714; train_kl_reg_loss: 96505.0675; train_edge_recon_loss: 2823148.5985; train_gene_expr_recon_loss: 10473715.8333; train_masked_gp_l1_reg_loss: 86732.5179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60206.1821; train_chrom_access_recon_loss: 788319.0095; train_global_loss: 14328627.3485; train_optim_loss: 14328627.3485; val_kl_reg_loss: 25023.2710; val_edge_recon_loss: 2811789.1250; val_gene_expr_recon_loss: 10342253.3750; val_masked_gp_l1_reg_loss: 86578.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60205.7266; val_chrom_access_recon_loss: 784863.9219; val_global_loss: 14110714.8750; val_optim_loss: 14110714.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9173; val_auprc_score: 0.8838; val_best_acc_score: 0.8614; val_best_f1_score: 0.8707; train_kl_reg_loss: 91080.0932; train_edge_recon_loss: 2794688.7879; train_gene_expr_recon_loss: 10477121.2576; train_masked_gp_l1_reg_loss: 86421.1514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60311.7193; train_chrom_access_recon_loss: 788745.2140; train_global_loss: 14298368.1970; train_optim_loss: 14298368.1970; val_kl_reg_loss: 25836.7651; val_edge_recon_loss: 2826448.6250; val_gene_expr_recon_loss: 10268067.8750; val_masked_gp_l1_reg_loss: 86252.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60306.2891; val_chrom_access_recon_loss: 784779.7500; val_global_loss: 14051691.1250; val_optim_loss: 14051691.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9239; val_auprc_score: 0.8957; val_best_acc_score: 0.8651; val_best_f1_score: 0.8711; train_kl_reg_loss: 87302.9328; train_edge_recon_loss: 2788750.8902; train_gene_expr_recon_loss: 10473303.1212; train_masked_gp_l1_reg_loss: 86087.9732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60377.7113; train_chrom_access_recon_loss: 787862.4422; train_global_loss: 14283685.0606; train_optim_loss: 14283685.0606; val_kl_reg_loss: 27310.3650; val_edge_recon_loss: 2832856.2188; val_gene_expr_recon_loss: 10357961.1250; val_masked_gp_l1_reg_loss: 85906.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60454.6836; val_chrom_access_recon_loss: 782489.1719; val_global_loss: 14146978.0000; val_optim_loss: 14146978.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9246; val_auprc_score: 0.8939; val_best_acc_score: 0.8662; val_best_f1_score: 0.8740; train_kl_reg_loss: 83010.6184; train_edge_recon_loss: 2796048.7348; train_gene_expr_recon_loss: 10457807.1364; train_masked_gp_l1_reg_loss: 85729.5129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60456.9328; train_chrom_access_recon_loss: 786798.7150; train_global_loss: 14269851.6364; train_optim_loss: 14269851.6364; val_kl_reg_loss: 28506.2988; val_edge_recon_loss: 2810098.6875; val_gene_expr_recon_loss: 10340733.1250; val_masked_gp_l1_reg_loss: 85545.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60482.1641; val_chrom_access_recon_loss: 785450.9766; val_global_loss: 14110817.1250; val_optim_loss: 14110817.1250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9200; val_auprc_score: 0.8873; val_best_acc_score: 0.8627; val_best_f1_score: 0.8723; train_kl_reg_loss: 80434.3221; train_edge_recon_loss: 2769741.2348; train_gene_expr_recon_loss: 10457976.0455; train_masked_gp_l1_reg_loss: 85366.0745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60484.6668; train_chrom_access_recon_loss: 786550.8722; train_global_loss: 14240553.2424; train_optim_loss: 14240553.2424; val_kl_reg_loss: 29392.8015; val_edge_recon_loss: 2792485.9062; val_gene_expr_recon_loss: 10365041.8750; val_masked_gp_l1_reg_loss: 85187.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60464.8008; val_chrom_access_recon_loss: 787574.1641; val_global_loss: 14120147.7500; val_optim_loss: 14120147.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9246; val_auprc_score: 0.8930; val_best_acc_score: 0.8638; val_best_f1_score: 0.8730; train_kl_reg_loss: 77860.8762; train_edge_recon_loss: 2777208.2197; train_gene_expr_recon_loss: 10463862.4091; train_masked_gp_l1_reg_loss: 85011.0220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60500.8909; train_chrom_access_recon_loss: 787155.6525; train_global_loss: 14251599.1667; train_optim_loss: 14251599.1667; val_kl_reg_loss: 30661.5925; val_edge_recon_loss: 2834411.5625; val_gene_expr_recon_loss: 10486261.0000; val_masked_gp_l1_reg_loss: 84837.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60527.7109; val_chrom_access_recon_loss: 792710.6484; val_global_loss: 14289410.7500; val_optim_loss: 14289410.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9272; val_auprc_score: 0.8992; val_best_acc_score: 0.8670; val_best_f1_score: 0.8739; train_kl_reg_loss: 75951.7630; train_edge_recon_loss: 2783638.3030; train_gene_expr_recon_loss: 10451145.4242; train_masked_gp_l1_reg_loss: 84776.0704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59040.0503; train_chrom_access_recon_loss: 786258.1335; train_global_loss: 14240809.7424; train_optim_loss: 14240809.7424; val_kl_reg_loss: 30339.5144; val_edge_recon_loss: 2784543.4062; val_gene_expr_recon_loss: 10460744.7500; val_masked_gp_l1_reg_loss: 84740.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58763.4297; val_chrom_access_recon_loss: 786161.6016; val_global_loss: 14205292.8750; val_optim_loss: 14205292.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9234; val_auprc_score: 0.8905; val_best_acc_score: 0.8641; val_best_f1_score: 0.8722; train_kl_reg_loss: 75748.1894; train_edge_recon_loss: 2780301.2083; train_gene_expr_recon_loss: 10452138.7879; train_masked_gp_l1_reg_loss: 84718.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58736.7304; train_chrom_access_recon_loss: 786277.3845; train_global_loss: 14237920.4242; train_optim_loss: 14237920.4242; val_kl_reg_loss: 30590.4106; val_edge_recon_loss: 2802104.4688; val_gene_expr_recon_loss: 10267620.5000; val_masked_gp_l1_reg_loss: 84696.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58720.4258; val_chrom_access_recon_loss: 785847.9609; val_global_loss: 14029579.3750; val_optim_loss: 14029579.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9209; val_auprc_score: 0.8910; val_best_acc_score: 0.8619; val_best_f1_score: 0.8700; train_kl_reg_loss: 75412.8802; train_edge_recon_loss: 2776823.7500; train_gene_expr_recon_loss: 10458331.1667; train_masked_gp_l1_reg_loss: 84676.2307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58703.8504; train_chrom_access_recon_loss: 786892.3778; train_global_loss: 14240840.1818; train_optim_loss: 14240840.1818; val_kl_reg_loss: 30557.3792; val_edge_recon_loss: 2809054.5000; val_gene_expr_recon_loss: 10326907.5000; val_masked_gp_l1_reg_loss: 84655.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58686.3711; val_chrom_access_recon_loss: 775928.5859; val_global_loss: 14085788.8750; val_optim_loss: 14085788.8750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9246; val_auprc_score: 0.9006; val_best_acc_score: 0.8614; val_best_f1_score: 0.8694; train_kl_reg_loss: 75209.5531; train_edge_recon_loss: 2775128.4886; train_gene_expr_recon_loss: 10452442.5303; train_masked_gp_l1_reg_loss: 84636.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58680.2620; train_chrom_access_recon_loss: 786541.3608; train_global_loss: 14232638.5909; train_optim_loss: 14232638.5909; val_kl_reg_loss: 30758.2942; val_edge_recon_loss: 2806592.1562; val_gene_expr_recon_loss: 10336178.0000; val_masked_gp_l1_reg_loss: 84616.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58673.2930; val_chrom_access_recon_loss: 779159.3906; val_global_loss: 14095978.1250; val_optim_loss: 14095978.1250
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9284; val_auprc_score: 0.9063; val_best_acc_score: 0.8673; val_best_f1_score: 0.8744; train_kl_reg_loss: 74815.9587; train_edge_recon_loss: 2768346.2159; train_gene_expr_recon_loss: 10450876.1970; train_masked_gp_l1_reg_loss: 84598.2350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58668.3668; train_chrom_access_recon_loss: 785238.2131; train_global_loss: 14222543.0758; train_optim_loss: 14222543.0758; val_kl_reg_loss: 30927.8547; val_edge_recon_loss: 2823975.7500; val_gene_expr_recon_loss: 10294015.6250; val_masked_gp_l1_reg_loss: 84578.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58667.0547; val_chrom_access_recon_loss: 786015.8750; val_global_loss: 14078180.8750; val_optim_loss: 14078180.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9235; val_auprc_score: 0.8926; val_best_acc_score: 0.8665; val_best_f1_score: 0.8721; train_kl_reg_loss: 74562.6098; train_edge_recon_loss: 2774766.6477; train_gene_expr_recon_loss: 10442617.0909; train_masked_gp_l1_reg_loss: 84558.7396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58653.1268; train_chrom_access_recon_loss: 785546.4062; train_global_loss: 14220704.7121; train_optim_loss: 14220704.7121; val_kl_reg_loss: 31197.6008; val_edge_recon_loss: 2819008.0312; val_gene_expr_recon_loss: 10379630.5000; val_masked_gp_l1_reg_loss: 84538.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58645.7656; val_chrom_access_recon_loss: 778871.0703; val_global_loss: 14151891.1250; val_optim_loss: 14151891.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9266; val_auprc_score: 0.9001; val_best_acc_score: 0.8665; val_best_f1_score: 0.8737; train_kl_reg_loss: 74648.2560; train_edge_recon_loss: 2766191.5038; train_gene_expr_recon_loss: 10461922.5303; train_masked_gp_l1_reg_loss: 84531.4214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58486.3379; train_chrom_access_recon_loss: 786158.4280; train_global_loss: 14231938.3030; train_optim_loss: 14231938.3030; val_kl_reg_loss: 30967.9314; val_edge_recon_loss: 2774881.3438; val_gene_expr_recon_loss: 10302185.6250; val_masked_gp_l1_reg_loss: 84527.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58457.5156; val_chrom_access_recon_loss: 784861.5234; val_global_loss: 14035882.2500; val_optim_loss: 14035882.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9150; val_auprc_score: 0.8833; val_best_acc_score: 0.8598; val_best_f1_score: 0.8672; train_kl_reg_loss: 74636.3828; train_edge_recon_loss: 2784211.5417; train_gene_expr_recon_loss: 10449210.3030; train_masked_gp_l1_reg_loss: 84525.5571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58455.5603; train_chrom_access_recon_loss: 785870.1458; train_global_loss: 14236909.3636; train_optim_loss: 14236909.3636; val_kl_reg_loss: 31149.0051; val_edge_recon_loss: 2842347.3750; val_gene_expr_recon_loss: 10294223.5000; val_masked_gp_l1_reg_loss: 84523.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58454.5820; val_chrom_access_recon_loss: 779870.6875; val_global_loss: 14090568.6250; val_optim_loss: 14090568.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9200; val_auprc_score: 0.8913; val_best_acc_score: 0.8592; val_best_f1_score: 0.8690; train_kl_reg_loss: 74463.0631; train_edge_recon_loss: 2768254.6705; train_gene_expr_recon_loss: 10455360.5303; train_masked_gp_l1_reg_loss: 84521.0214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58453.1644; train_chrom_access_recon_loss: 786518.7074; train_global_loss: 14227571.1515; train_optim_loss: 14227571.1515; val_kl_reg_loss: 31186.3179; val_edge_recon_loss: 2814925.4375; val_gene_expr_recon_loss: 10298503.5000; val_masked_gp_l1_reg_loss: 84518.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58451.9570; val_chrom_access_recon_loss: 786210.5078; val_global_loss: 14073797.0000; val_optim_loss: 14073797.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9155; val_auprc_score: 0.8820; val_best_acc_score: 0.8565; val_best_f1_score: 0.8657; train_kl_reg_loss: 74508.3904; train_edge_recon_loss: 2769606.8977; train_gene_expr_recon_loss: 10446138.8939; train_masked_gp_l1_reg_loss: 84516.9109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58451.7154; train_chrom_access_recon_loss: 785593.4479; train_global_loss: 14218816.3636; train_optim_loss: 14218816.3636; val_kl_reg_loss: 31264.0825; val_edge_recon_loss: 2796015.5312; val_gene_expr_recon_loss: 10411135.1250; val_masked_gp_l1_reg_loss: 84514.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58450.7656; val_chrom_access_recon_loss: 793027.5625; val_global_loss: 14174408.5000; val_optim_loss: 14174408.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 33 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9161
val AUPRC score: 0.8799
val best accuracy score: 0.8589
val best F1 score: 0.8683
val target rna MSE score: 3.0843
val source rna MSE score: 1.5902
val target atac MSE score: 0.4897
val source atac MSE score: 0.1947
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
