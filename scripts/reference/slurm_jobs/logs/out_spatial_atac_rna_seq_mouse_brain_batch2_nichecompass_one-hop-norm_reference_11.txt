[True]
Run timestamp: 07092023_135041_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2376 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5103, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7492; val_auprc_score: 0.7758; val_best_acc_score: 0.5129; val_best_f1_score: 0.6706; train_kl_reg_loss: 64531.2458; train_edge_recon_loss: 3542609.4408; train_gene_expr_recon_loss: 12820783.8626; train_masked_gp_l1_reg_loss: 110070.7198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3197820.0768; train_chrom_access_recon_loss: 2152141.5286; train_global_loss: 21887956.8702; train_optim_loss: 21887956.8702; val_kl_reg_loss: 126885.6469; val_edge_recon_loss: 4064092.6500; val_gene_expr_recon_loss: 12118265.2667; val_masked_gp_l1_reg_loss: 105926.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 293852.0000; val_chrom_access_recon_loss: 2098212.6250; val_global_loss: 18807234.1333; val_optim_loss: 18807234.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7950; val_auprc_score: 0.8117; val_best_acc_score: 0.7156; val_best_f1_score: 0.7133; train_kl_reg_loss: 86398.0171; train_edge_recon_loss: 3512448.5248; train_gene_expr_recon_loss: 11885717.0153; train_masked_gp_l1_reg_loss: 105083.4040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173041.4825; train_chrom_access_recon_loss: 2054940.8836; train_global_loss: 17817629.4046; train_optim_loss: 17817629.4046; val_kl_reg_loss: 80520.6630; val_edge_recon_loss: 3992153.2333; val_gene_expr_recon_loss: 11848317.6000; val_masked_gp_l1_reg_loss: 107246.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122232.3281; val_chrom_access_recon_loss: 2056125.4583; val_global_loss: 18206594.6667; val_optim_loss: 18206594.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8403; val_auprc_score: 0.8288; val_best_acc_score: 0.7466; val_best_f1_score: 0.7819; train_kl_reg_loss: 84930.1925; train_edge_recon_loss: 3236694.6069; train_gene_expr_recon_loss: 11690192.3130; train_masked_gp_l1_reg_loss: 113608.9141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107956.5265; train_chrom_access_recon_loss: 2025194.7223; train_global_loss: 17258577.2366; train_optim_loss: 17258577.2366; val_kl_reg_loss: 100802.3938; val_edge_recon_loss: 3014869.3667; val_gene_expr_recon_loss: 11702908.0000; val_masked_gp_l1_reg_loss: 119498.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97361.3594; val_chrom_access_recon_loss: 2022389.7333; val_global_loss: 17057828.2000; val_optim_loss: 17057828.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8589; val_auprc_score: 0.8489; val_best_acc_score: 0.7560; val_best_f1_score: 0.7869; train_kl_reg_loss: 107691.9799; train_edge_recon_loss: 2967424.6527; train_gene_expr_recon_loss: 11544208.8397; train_masked_gp_l1_reg_loss: 121814.8518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92157.4647; train_chrom_access_recon_loss: 1999355.2719; train_global_loss: 16832653.1221; train_optim_loss: 16832653.1221; val_kl_reg_loss: 108776.3781; val_edge_recon_loss: 2987036.8167; val_gene_expr_recon_loss: 11545414.2667; val_masked_gp_l1_reg_loss: 124084.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88127.7031; val_chrom_access_recon_loss: 2004046.4667; val_global_loss: 16857486.7333; val_optim_loss: 16857486.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8892; val_auprc_score: 0.8806; val_best_acc_score: 0.8005; val_best_f1_score: 0.8036; train_kl_reg_loss: 101562.0920; train_edge_recon_loss: 2937533.2385; train_gene_expr_recon_loss: 11432305.0229; train_masked_gp_l1_reg_loss: 125702.0312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86369.8030; train_chrom_access_recon_loss: 1981075.5878; train_global_loss: 16664547.7939; train_optim_loss: 16664547.7939; val_kl_reg_loss: 99454.9609; val_edge_recon_loss: 2945816.9333; val_gene_expr_recon_loss: 11442170.2000; val_masked_gp_l1_reg_loss: 127405.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85321.5469; val_chrom_access_recon_loss: 1987139.7500; val_global_loss: 16687309.6667; val_optim_loss: 16687309.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8964; val_auprc_score: 0.8865; val_best_acc_score: 0.8100; val_best_f1_score: 0.8183; train_kl_reg_loss: 98345.6176; train_edge_recon_loss: 2904083.2214; train_gene_expr_recon_loss: 11313025.2977; train_masked_gp_l1_reg_loss: 128826.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85324.6740; train_chrom_access_recon_loss: 1961208.4485; train_global_loss: 16490813.8473; train_optim_loss: 16490813.8473; val_kl_reg_loss: 96204.1656; val_edge_recon_loss: 2922578.2500; val_gene_expr_recon_loss: 11360030.0000; val_masked_gp_l1_reg_loss: 131710.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86495.4219; val_chrom_access_recon_loss: 1972744.0583; val_global_loss: 16569761.6000; val_optim_loss: 16569761.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9198; val_auprc_score: 0.9047; val_best_acc_score: 0.8518; val_best_f1_score: 0.8623; train_kl_reg_loss: 94442.7029; train_edge_recon_loss: 2870303.2195; train_gene_expr_recon_loss: 11228775.6565; train_masked_gp_l1_reg_loss: 136933.1345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87423.7628; train_chrom_access_recon_loss: 1948591.8826; train_global_loss: 16366470.3359; train_optim_loss: 16366470.3359; val_kl_reg_loss: 96332.3073; val_edge_recon_loss: 2845184.6833; val_gene_expr_recon_loss: 11275704.7333; val_masked_gp_l1_reg_loss: 139741.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88443.6250; val_chrom_access_recon_loss: 1954750.5500; val_global_loss: 16400158.2000; val_optim_loss: 16400158.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9194; val_auprc_score: 0.9010; val_best_acc_score: 0.8498; val_best_f1_score: 0.8613; train_kl_reg_loss: 97792.4275; train_edge_recon_loss: 2828715.4027; train_gene_expr_recon_loss: 11172348.0840; train_masked_gp_l1_reg_loss: 142795.0642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89217.1727; train_chrom_access_recon_loss: 1934895.5019; train_global_loss: 16265763.6107; train_optim_loss: 16265763.6107; val_kl_reg_loss: 101925.9990; val_edge_recon_loss: 2892103.5000; val_gene_expr_recon_loss: 11243348.8000; val_masked_gp_l1_reg_loss: 149256.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91747.6406; val_chrom_access_recon_loss: 1953879.7250; val_global_loss: 16432262.2000; val_optim_loss: 16432262.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9307; val_auprc_score: 0.9190; val_best_acc_score: 0.8588; val_best_f1_score: 0.8668; train_kl_reg_loss: 96943.9179; train_edge_recon_loss: 2823321.3282; train_gene_expr_recon_loss: 11119334.9313; train_masked_gp_l1_reg_loss: 146201.3390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89271.8505; train_chrom_access_recon_loss: 1921843.9027; train_global_loss: 16196917.2977; train_optim_loss: 16196917.2977; val_kl_reg_loss: 101103.8297; val_edge_recon_loss: 2822735.6500; val_gene_expr_recon_loss: 11151674.5333; val_masked_gp_l1_reg_loss: 145881.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88505.1406; val_chrom_access_recon_loss: 1920704.6417; val_global_loss: 16230604.4000; val_optim_loss: 16230604.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9384; val_auprc_score: 0.9224; val_best_acc_score: 0.8742; val_best_f1_score: 0.8788; train_kl_reg_loss: 101016.3011; train_edge_recon_loss: 2780200.5115; train_gene_expr_recon_loss: 11041059.8015; train_masked_gp_l1_reg_loss: 145906.3585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87078.3131; train_chrom_access_recon_loss: 1910043.0649; train_global_loss: 16065304.4046; train_optim_loss: 16065304.4046; val_kl_reg_loss: 106751.9589; val_edge_recon_loss: 2784610.9333; val_gene_expr_recon_loss: 11114284.3333; val_masked_gp_l1_reg_loss: 147392.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86041.3047; val_chrom_access_recon_loss: 1918784.3417; val_global_loss: 16157865.4667; val_optim_loss: 16157865.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9422; val_auprc_score: 0.9314; val_best_acc_score: 0.8787; val_best_f1_score: 0.8839; train_kl_reg_loss: 103381.0711; train_edge_recon_loss: 2764254.0916; train_gene_expr_recon_loss: 10987357.2061; train_masked_gp_l1_reg_loss: 146250.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85460.1769; train_chrom_access_recon_loss: 1899282.7624; train_global_loss: 15985985.4046; train_optim_loss: 15985985.4046; val_kl_reg_loss: 103681.6531; val_edge_recon_loss: 2774475.1000; val_gene_expr_recon_loss: 11030172.9333; val_masked_gp_l1_reg_loss: 146551.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85106.3984; val_chrom_access_recon_loss: 1911757.6333; val_global_loss: 16051745.1333; val_optim_loss: 16051745.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9419; val_auprc_score: 0.9281; val_best_acc_score: 0.8777; val_best_f1_score: 0.8830; train_kl_reg_loss: 99320.0564; train_edge_recon_loss: 2760851.7634; train_gene_expr_recon_loss: 10923727.5344; train_masked_gp_l1_reg_loss: 147241.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84396.3133; train_chrom_access_recon_loss: 1888565.7214; train_global_loss: 15904102.4580; train_optim_loss: 15904102.4580; val_kl_reg_loss: 101797.6266; val_edge_recon_loss: 2761680.2333; val_gene_expr_recon_loss: 10968429.8667; val_masked_gp_l1_reg_loss: 147520.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84560.7891; val_chrom_access_recon_loss: 1894846.9167; val_global_loss: 15958835.7333; val_optim_loss: 15958835.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9461; val_auprc_score: 0.9285; val_best_acc_score: 0.8866; val_best_f1_score: 0.8915; train_kl_reg_loss: 100781.5950; train_edge_recon_loss: 2753835.4905; train_gene_expr_recon_loss: 10864246.8397; train_masked_gp_l1_reg_loss: 147796.3387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83331.7706; train_chrom_access_recon_loss: 1878709.2042; train_global_loss: 15828701.2137; train_optim_loss: 15828701.2137; val_kl_reg_loss: 98716.5036; val_edge_recon_loss: 2746694.6667; val_gene_expr_recon_loss: 10901736.2667; val_masked_gp_l1_reg_loss: 147934.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82669.6562; val_chrom_access_recon_loss: 1896836.8417; val_global_loss: 15874589.3333; val_optim_loss: 15874589.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9478; val_auprc_score: 0.9370; val_best_acc_score: 0.8800; val_best_f1_score: 0.8848; train_kl_reg_loss: 99976.2455; train_edge_recon_loss: 2751013.8817; train_gene_expr_recon_loss: 10823519.5191; train_masked_gp_l1_reg_loss: 148072.8698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82377.2995; train_chrom_access_recon_loss: 1872578.3197; train_global_loss: 15777538.1756; train_optim_loss: 15777538.1756; val_kl_reg_loss: 101266.2625; val_edge_recon_loss: 2747433.2833; val_gene_expr_recon_loss: 10887062.2000; val_masked_gp_l1_reg_loss: 148099.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82082.6641; val_chrom_access_recon_loss: 1885214.8750; val_global_loss: 15851159.6000; val_optim_loss: 15851159.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9515; val_auprc_score: 0.9416; val_best_acc_score: 0.8868; val_best_f1_score: 0.8900; train_kl_reg_loss: 98718.9853; train_edge_recon_loss: 2744808.7958; train_gene_expr_recon_loss: 10783351.1679; train_masked_gp_l1_reg_loss: 148363.4728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81962.1196; train_chrom_access_recon_loss: 1864504.3511; train_global_loss: 15721708.9389; train_optim_loss: 15721708.9389; val_kl_reg_loss: 94729.6562; val_edge_recon_loss: 2762735.0000; val_gene_expr_recon_loss: 10792627.6000; val_masked_gp_l1_reg_loss: 148432.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81604.8672; val_chrom_access_recon_loss: 1875255.8167; val_global_loss: 15755385.1333; val_optim_loss: 15755385.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9517; val_auprc_score: 0.9401; val_best_acc_score: 0.8905; val_best_f1_score: 0.8952; train_kl_reg_loss: 96237.1139; train_edge_recon_loss: 2733423.0744; train_gene_expr_recon_loss: 10746541.8092; train_masked_gp_l1_reg_loss: 148852.5088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81511.3953; train_chrom_access_recon_loss: 1857007.4790; train_global_loss: 15663573.3969; train_optim_loss: 15663573.3969; val_kl_reg_loss: 93242.1687; val_edge_recon_loss: 2764895.2167; val_gene_expr_recon_loss: 10851593.4667; val_masked_gp_l1_reg_loss: 149326.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81808.3906; val_chrom_access_recon_loss: 1877697.9583; val_global_loss: 15818562.6667; val_optim_loss: 15818562.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9582; val_auprc_score: 0.9484; val_best_acc_score: 0.8963; val_best_f1_score: 0.9010; train_kl_reg_loss: 96030.6033; train_edge_recon_loss: 2727306.6260; train_gene_expr_recon_loss: 10700837.4122; train_masked_gp_l1_reg_loss: 149603.5953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81360.4386; train_chrom_access_recon_loss: 1851735.1975; train_global_loss: 15606873.8473; train_optim_loss: 15606873.8473; val_kl_reg_loss: 98469.8807; val_edge_recon_loss: 2743543.5333; val_gene_expr_recon_loss: 10782429.6667; val_masked_gp_l1_reg_loss: 150043.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81583.8516; val_chrom_access_recon_loss: 1868134.9417; val_global_loss: 15724205.1333; val_optim_loss: 15724205.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9597; val_auprc_score: 0.9494; val_best_acc_score: 0.9019; val_best_f1_score: 0.9062; train_kl_reg_loss: 95324.5493; train_edge_recon_loss: 2736921.3702; train_gene_expr_recon_loss: 10659856.6489; train_masked_gp_l1_reg_loss: 149501.6446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80894.3179; train_chrom_access_recon_loss: 1846079.4781; train_global_loss: 15568578.0916; train_optim_loss: 15568578.0916; val_kl_reg_loss: 94333.4786; val_edge_recon_loss: 2742102.1000; val_gene_expr_recon_loss: 10731799.0000; val_masked_gp_l1_reg_loss: 149067.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80485.4219; val_chrom_access_recon_loss: 1861707.0333; val_global_loss: 15659494.8000; val_optim_loss: 15659494.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9608; val_auprc_score: 0.9512; val_best_acc_score: 0.9002; val_best_f1_score: 0.9036; train_kl_reg_loss: 96149.1762; train_edge_recon_loss: 2723604.6851; train_gene_expr_recon_loss: 10633860.5496; train_masked_gp_l1_reg_loss: 149315.9441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80946.3310; train_chrom_access_recon_loss: 1840963.5000; train_global_loss: 15524840.1069; train_optim_loss: 15524840.1069; val_kl_reg_loss: 97148.3708; val_edge_recon_loss: 2742578.2000; val_gene_expr_recon_loss: 10689126.6667; val_masked_gp_l1_reg_loss: 148927.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80807.5859; val_chrom_access_recon_loss: 1854704.5000; val_global_loss: 15613292.8000; val_optim_loss: 15613292.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9651; val_auprc_score: 0.9563; val_best_acc_score: 0.9056; val_best_f1_score: 0.9083; train_kl_reg_loss: 95538.1867; train_edge_recon_loss: 2721121.7176; train_gene_expr_recon_loss: 10610934.8321; train_masked_gp_l1_reg_loss: 149023.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80707.1606; train_chrom_access_recon_loss: 1835331.5802; train_global_loss: 15492657.0840; train_optim_loss: 15492657.0840; val_kl_reg_loss: 95084.4307; val_edge_recon_loss: 2718185.1333; val_gene_expr_recon_loss: 10717143.6667; val_masked_gp_l1_reg_loss: 149337.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81024.5078; val_chrom_access_recon_loss: 1861381.2417; val_global_loss: 15622157.4000; val_optim_loss: 15622157.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9618; val_auprc_score: 0.9498; val_best_acc_score: 0.9054; val_best_f1_score: 0.9096; train_kl_reg_loss: 94463.3391; train_edge_recon_loss: 2724350.4256; train_gene_expr_recon_loss: 10586199.2214; train_masked_gp_l1_reg_loss: 149203.3062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80799.4553; train_chrom_access_recon_loss: 1831437.3531; train_global_loss: 15466453.0611; train_optim_loss: 15466453.0611; val_kl_reg_loss: 94531.1880; val_edge_recon_loss: 2734208.4833; val_gene_expr_recon_loss: 10630172.2667; val_masked_gp_l1_reg_loss: 149381.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80967.5703; val_chrom_access_recon_loss: 1847521.0000; val_global_loss: 15536782.2667; val_optim_loss: 15536782.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9661; val_auprc_score: 0.9569; val_best_acc_score: 0.9119; val_best_f1_score: 0.9146; train_kl_reg_loss: 95449.7495; train_edge_recon_loss: 2716723.6336; train_gene_expr_recon_loss: 10567621.7863; train_masked_gp_l1_reg_loss: 149101.2320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80480.3771; train_chrom_access_recon_loss: 1828096.9676; train_global_loss: 15437473.6260; train_optim_loss: 15437473.6260; val_kl_reg_loss: 95826.8281; val_edge_recon_loss: 2728975.0333; val_gene_expr_recon_loss: 10650724.8667; val_masked_gp_l1_reg_loss: 149149.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80817.6875; val_chrom_access_recon_loss: 1845936.2500; val_global_loss: 15551430.1333; val_optim_loss: 15551430.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9659; val_auprc_score: 0.9543; val_best_acc_score: 0.9112; val_best_f1_score: 0.9148; train_kl_reg_loss: 94126.8542; train_edge_recon_loss: 2729810.6202; train_gene_expr_recon_loss: 10534145.7863; train_masked_gp_l1_reg_loss: 149005.7068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80634.6579; train_chrom_access_recon_loss: 1823283.9609; train_global_loss: 15411007.6565; train_optim_loss: 15411007.6565; val_kl_reg_loss: 95883.1917; val_edge_recon_loss: 2727211.3000; val_gene_expr_recon_loss: 10629436.4667; val_masked_gp_l1_reg_loss: 148972.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80561.4375; val_chrom_access_recon_loss: 1837535.3917; val_global_loss: 15519599.2000; val_optim_loss: 15519599.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9669; val_auprc_score: 0.9572; val_best_acc_score: 0.9146; val_best_f1_score: 0.9186; train_kl_reg_loss: 95188.0082; train_edge_recon_loss: 2712845.6393; train_gene_expr_recon_loss: 10518012.0076; train_masked_gp_l1_reg_loss: 148727.5872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80779.3101; train_chrom_access_recon_loss: 1817887.8025; train_global_loss: 15373440.2672; train_optim_loss: 15373440.2672; val_kl_reg_loss: 96776.5307; val_edge_recon_loss: 2738418.9500; val_gene_expr_recon_loss: 10594529.6000; val_masked_gp_l1_reg_loss: 148709.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80723.3281; val_chrom_access_recon_loss: 1834912.3417; val_global_loss: 15494070.2667; val_optim_loss: 15494070.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9678; val_auprc_score: 0.9562; val_best_acc_score: 0.9157; val_best_f1_score: 0.9190; train_kl_reg_loss: 95201.1149; train_edge_recon_loss: 2706353.2385; train_gene_expr_recon_loss: 10500943.9313; train_masked_gp_l1_reg_loss: 148685.9355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81220.3870; train_chrom_access_recon_loss: 1815839.3120; train_global_loss: 15348243.8779; train_optim_loss: 15348243.8779; val_kl_reg_loss: 97092.3010; val_edge_recon_loss: 2720941.3833; val_gene_expr_recon_loss: 10578166.1333; val_masked_gp_l1_reg_loss: 148833.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81862.1875; val_chrom_access_recon_loss: 1830335.9667; val_global_loss: 15457231.8000; val_optim_loss: 15457231.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9689; val_auprc_score: 0.9588; val_best_acc_score: 0.9196; val_best_f1_score: 0.9226; train_kl_reg_loss: 103998.4580; train_edge_recon_loss: 2730180.7729; train_gene_expr_recon_loss: 10181911.5878; train_masked_gp_l1_reg_loss: 146600.6808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79216.9978; train_chrom_access_recon_loss: 1759345.3168; train_global_loss: 15001253.8397; train_optim_loss: 15001253.8397; val_kl_reg_loss: 69427.8531; val_edge_recon_loss: 2715975.6500; val_gene_expr_recon_loss: 10208402.8000; val_masked_gp_l1_reg_loss: 146622.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79894.1953; val_chrom_access_recon_loss: 1760799.8333; val_global_loss: 14981121.9333; val_optim_loss: 14981121.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9708; val_auprc_score: 0.9632; val_best_acc_score: 0.9181; val_best_f1_score: 0.9207; train_kl_reg_loss: 96513.0349; train_edge_recon_loss: 2718002.2385; train_gene_expr_recon_loss: 10147755.0305; train_masked_gp_l1_reg_loss: 146493.6112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79799.7696; train_chrom_access_recon_loss: 1750488.0181; train_global_loss: 14939051.7252; train_optim_loss: 14939051.7252; val_kl_reg_loss: 77235.8141; val_edge_recon_loss: 2714391.7500; val_gene_expr_recon_loss: 10221067.9333; val_masked_gp_l1_reg_loss: 146368.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79957.3984; val_chrom_access_recon_loss: 1774132.5000; val_global_loss: 15013152.8667; val_optim_loss: 15013152.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9734; val_auprc_score: 0.9649; val_best_acc_score: 0.9266; val_best_f1_score: 0.9275; train_kl_reg_loss: 91198.5849; train_edge_recon_loss: 2705295.6603; train_gene_expr_recon_loss: 10125906.7863; train_masked_gp_l1_reg_loss: 145824.5323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79564.6006; train_chrom_access_recon_loss: 1747395.7195; train_global_loss: 14895185.7939; train_optim_loss: 14895185.7939; val_kl_reg_loss: 77532.3432; val_edge_recon_loss: 2712581.2333; val_gene_expr_recon_loss: 10163077.0000; val_masked_gp_l1_reg_loss: 145225.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78931.1406; val_chrom_access_recon_loss: 1756941.2250; val_global_loss: 14934288.7333; val_optim_loss: 14934288.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9681; val_auprc_score: 0.9605; val_best_acc_score: 0.9189; val_best_f1_score: 0.9213; train_kl_reg_loss: 89548.3229; train_edge_recon_loss: 2710817.5973; train_gene_expr_recon_loss: 10109382.2137; train_masked_gp_l1_reg_loss: 144742.7193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79096.9091; train_chrom_access_recon_loss: 1744380.6660; train_global_loss: 14877968.3893; train_optim_loss: 14877968.3893; val_kl_reg_loss: 79133.2922; val_edge_recon_loss: 2723921.1000; val_gene_expr_recon_loss: 10162253.7333; val_masked_gp_l1_reg_loss: 144088.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78739.8750; val_chrom_access_recon_loss: 1756171.1917; val_global_loss: 14944308.2667; val_optim_loss: 14944308.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9730; val_auprc_score: 0.9634; val_best_acc_score: 0.9287; val_best_f1_score: 0.9312; train_kl_reg_loss: 88799.2342; train_edge_recon_loss: 2701268.5134; train_gene_expr_recon_loss: 10081281.3053; train_masked_gp_l1_reg_loss: 143590.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78527.3244; train_chrom_access_recon_loss: 1739885.7080; train_global_loss: 14833352.8779; train_optim_loss: 14833352.8779; val_kl_reg_loss: 81555.9896; val_edge_recon_loss: 2700202.1333; val_gene_expr_recon_loss: 10164286.3333; val_masked_gp_l1_reg_loss: 143452.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78913.7656; val_chrom_access_recon_loss: 1751293.1083; val_global_loss: 14919704.4667; val_optim_loss: 14919704.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9720; val_auprc_score: 0.9621; val_best_acc_score: 0.9241; val_best_f1_score: 0.9270; train_kl_reg_loss: 87545.2261; train_edge_recon_loss: 2707875.8626; train_gene_expr_recon_loss: 10071422.4733; train_masked_gp_l1_reg_loss: 142850.2884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78318.1198; train_chrom_access_recon_loss: 1738581.3635; train_global_loss: 14826593.3435; train_optim_loss: 14826593.3435; val_kl_reg_loss: 83308.5443; val_edge_recon_loss: 2717256.8833; val_gene_expr_recon_loss: 10171015.0667; val_masked_gp_l1_reg_loss: 142390.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77879.3984; val_chrom_access_recon_loss: 1758713.0833; val_global_loss: 14950563.5333; val_optim_loss: 14950563.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9744; val_auprc_score: 0.9677; val_best_acc_score: 0.9299; val_best_f1_score: 0.9316; train_kl_reg_loss: 87128.6211; train_edge_recon_loss: 2697423.4332; train_gene_expr_recon_loss: 10056153.5649; train_masked_gp_l1_reg_loss: 142112.6578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78013.1658; train_chrom_access_recon_loss: 1735189.2786; train_global_loss: 14796020.7328; train_optim_loss: 14796020.7328; val_kl_reg_loss: 83133.6354; val_edge_recon_loss: 2706665.3667; val_gene_expr_recon_loss: 10158171.2000; val_masked_gp_l1_reg_loss: 141883.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77992.4375; val_chrom_access_recon_loss: 1756279.6750; val_global_loss: 14924125.7333; val_optim_loss: 14924125.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9730; val_auprc_score: 0.9627; val_best_acc_score: 0.9276; val_best_f1_score: 0.9299; train_kl_reg_loss: 87859.5320; train_edge_recon_loss: 2702983.7080; train_gene_expr_recon_loss: 10048256.2901; train_masked_gp_l1_reg_loss: 141623.5026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77885.7851; train_chrom_access_recon_loss: 1735117.9227; train_global_loss: 14793726.7863; train_optim_loss: 14793726.7863; val_kl_reg_loss: 82546.8568; val_edge_recon_loss: 2701550.4667; val_gene_expr_recon_loss: 10138577.4667; val_masked_gp_l1_reg_loss: 141080.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77779.6484; val_chrom_access_recon_loss: 1744100.9333; val_global_loss: 14885636.6000; val_optim_loss: 14885636.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9760; val_auprc_score: 0.9673; val_best_acc_score: 0.9314; val_best_f1_score: 0.9332; train_kl_reg_loss: 86186.2172; train_edge_recon_loss: 2704561.1851; train_gene_expr_recon_loss: 10028363.5115; train_masked_gp_l1_reg_loss: 141103.3771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77925.4951; train_chrom_access_recon_loss: 1727298.2920; train_global_loss: 14765438.1145; train_optim_loss: 14765438.1145; val_kl_reg_loss: 87170.7240; val_edge_recon_loss: 2701643.2333; val_gene_expr_recon_loss: 10116184.0000; val_masked_gp_l1_reg_loss: 140621.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77547.3906; val_chrom_access_recon_loss: 1740498.9583; val_global_loss: 14863664.9333; val_optim_loss: 14863664.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9766; val_auprc_score: 0.9688; val_best_acc_score: 0.9303; val_best_f1_score: 0.9315; train_kl_reg_loss: 87292.6056; train_edge_recon_loss: 2691248.6298; train_gene_expr_recon_loss: 10021765.6870; train_masked_gp_l1_reg_loss: 140576.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77778.3289; train_chrom_access_recon_loss: 1725210.1116; train_global_loss: 14743871.7863; train_optim_loss: 14743871.7863; val_kl_reg_loss: 85563.1198; val_edge_recon_loss: 2701419.8667; val_gene_expr_recon_loss: 10114541.4000; val_masked_gp_l1_reg_loss: 140458.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77708.7734; val_chrom_access_recon_loss: 1743935.7417; val_global_loss: 14863628.2667; val_optim_loss: 14863628.2667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9729; val_auprc_score: 0.9615; val_best_acc_score: 0.9267; val_best_f1_score: 0.9290; train_kl_reg_loss: 88112.3591; train_edge_recon_loss: 2697473.7137; train_gene_expr_recon_loss: 10005333.3359; train_masked_gp_l1_reg_loss: 140297.2387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77665.5843; train_chrom_access_recon_loss: 1724225.6279; train_global_loss: 14733107.7557; train_optim_loss: 14733107.7557; val_kl_reg_loss: 84371.9167; val_edge_recon_loss: 2728214.0667; val_gene_expr_recon_loss: 10085745.6000; val_masked_gp_l1_reg_loss: 139947.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78110.5781; val_chrom_access_recon_loss: 1738017.5583; val_global_loss: 14854408.0667; val_optim_loss: 14854408.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9755; val_auprc_score: 0.9665; val_best_acc_score: 0.9303; val_best_f1_score: 0.9319; train_kl_reg_loss: 87384.3376; train_edge_recon_loss: 2700073.6660; train_gene_expr_recon_loss: 10000722.9924; train_masked_gp_l1_reg_loss: 139857.0317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77760.4300; train_chrom_access_recon_loss: 1723662.2338; train_global_loss: 14729460.7023; train_optim_loss: 14729460.7023; val_kl_reg_loss: 84305.0911; val_edge_recon_loss: 2712914.2167; val_gene_expr_recon_loss: 10104415.1333; val_masked_gp_l1_reg_loss: 139734.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78156.6016; val_chrom_access_recon_loss: 1736504.3833; val_global_loss: 14856029.8667; val_optim_loss: 14856029.8667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9756; val_auprc_score: 0.9687; val_best_acc_score: 0.9290; val_best_f1_score: 0.9309; train_kl_reg_loss: 88345.2958; train_edge_recon_loss: 2693651.9237; train_gene_expr_recon_loss: 9989184.0076; train_masked_gp_l1_reg_loss: 139457.1017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77599.8647; train_chrom_access_recon_loss: 1722730.3865; train_global_loss: 14710968.5115; train_optim_loss: 14710968.5115; val_kl_reg_loss: 88318.7370; val_edge_recon_loss: 2707631.9167; val_gene_expr_recon_loss: 10063225.3333; val_masked_gp_l1_reg_loss: 139096.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77111.6719; val_chrom_access_recon_loss: 1741743.2333; val_global_loss: 14817128.4000; val_optim_loss: 14817128.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9759; val_auprc_score: 0.9682; val_best_acc_score: 0.9303; val_best_f1_score: 0.9323; train_kl_reg_loss: 87923.1887; train_edge_recon_loss: 2693565.4828; train_gene_expr_recon_loss: 9975115.6794; train_masked_gp_l1_reg_loss: 138818.5911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77505.4187; train_chrom_access_recon_loss: 1718409.0258; train_global_loss: 14691337.3359; train_optim_loss: 14691337.3359; val_kl_reg_loss: 87186.8625; val_edge_recon_loss: 2718195.6000; val_gene_expr_recon_loss: 10037980.2000; val_masked_gp_l1_reg_loss: 138717.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77523.6172; val_chrom_access_recon_loss: 1728480.9500; val_global_loss: 14788084.6000; val_optim_loss: 14788084.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9783; val_auprc_score: 0.9736; val_best_acc_score: 0.9341; val_best_f1_score: 0.9356; train_kl_reg_loss: 86992.3744; train_edge_recon_loss: 2685883.4294; train_gene_expr_recon_loss: 9969834.3435; train_masked_gp_l1_reg_loss: 138546.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77562.4552; train_chrom_access_recon_loss: 1717342.8979; train_global_loss: 14676162.3206; train_optim_loss: 14676162.3206; val_kl_reg_loss: 85801.0406; val_edge_recon_loss: 2693437.6667; val_gene_expr_recon_loss: 10072563.4667; val_masked_gp_l1_reg_loss: 138374.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77759.1719; val_chrom_access_recon_loss: 1738962.5500; val_global_loss: 14806897.7333; val_optim_loss: 14806897.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9756; val_auprc_score: 0.9661; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 87167.6550; train_edge_recon_loss: 2692251.6508; train_gene_expr_recon_loss: 9958932.9389; train_masked_gp_l1_reg_loss: 138178.4006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77625.5486; train_chrom_access_recon_loss: 1714524.7958; train_global_loss: 14668681.0763; train_optim_loss: 14668681.0763; val_kl_reg_loss: 86572.2016; val_edge_recon_loss: 2702784.5833; val_gene_expr_recon_loss: 10017725.2667; val_masked_gp_l1_reg_loss: 137986.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77224.8672; val_chrom_access_recon_loss: 1719435.5000; val_global_loss: 14741728.6667; val_optim_loss: 14741728.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9766; val_auprc_score: 0.9674; val_best_acc_score: 0.9314; val_best_f1_score: 0.9335; train_kl_reg_loss: 86806.8792; train_edge_recon_loss: 2695380.8817; train_gene_expr_recon_loss: 9950296.1374; train_masked_gp_l1_reg_loss: 137799.7965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77617.0115; train_chrom_access_recon_loss: 1713761.5954; train_global_loss: 14661662.2519; train_optim_loss: 14661662.2519; val_kl_reg_loss: 82938.4964; val_edge_recon_loss: 2698466.6667; val_gene_expr_recon_loss: 10079749.6667; val_masked_gp_l1_reg_loss: 137755.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77983.3125; val_chrom_access_recon_loss: 1731750.7833; val_global_loss: 14808644.4667; val_optim_loss: 14808644.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9763; val_auprc_score: 0.9705; val_best_acc_score: 0.9290; val_best_f1_score: 0.9308; train_kl_reg_loss: 86605.9643; train_edge_recon_loss: 2701056.0095; train_gene_expr_recon_loss: 9946167.1527; train_masked_gp_l1_reg_loss: 137485.2180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77581.8643; train_chrom_access_recon_loss: 1713884.7242; train_global_loss: 14662780.9847; train_optim_loss: 14662780.9847; val_kl_reg_loss: 84209.0031; val_edge_recon_loss: 2727560.4833; val_gene_expr_recon_loss: 10048573.4000; val_masked_gp_l1_reg_loss: 137387.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78037.9453; val_chrom_access_recon_loss: 1734245.4917; val_global_loss: 14810013.1333; val_optim_loss: 14810013.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9775; val_auprc_score: 0.9706; val_best_acc_score: 0.9316; val_best_f1_score: 0.9326; train_kl_reg_loss: 86505.3826; train_edge_recon_loss: 2685575.8454; train_gene_expr_recon_loss: 9943581.4809; train_masked_gp_l1_reg_loss: 137133.4071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77700.4679; train_chrom_access_recon_loss: 1711848.9704; train_global_loss: 14642345.6412; train_optim_loss: 14642345.6412; val_kl_reg_loss: 87764.2698; val_edge_recon_loss: 2707290.4333; val_gene_expr_recon_loss: 10065406.8000; val_masked_gp_l1_reg_loss: 136802.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77708.6797; val_chrom_access_recon_loss: 1728015.3500; val_global_loss: 14802988.6667; val_optim_loss: 14802988.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9771; val_auprc_score: 0.9717; val_best_acc_score: 0.9322; val_best_f1_score: 0.9336; train_kl_reg_loss: 87905.8250; train_edge_recon_loss: 2686757.9256; train_gene_expr_recon_loss: 9937793.1145; train_masked_gp_l1_reg_loss: 136436.0041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77632.2319; train_chrom_access_recon_loss: 1710452.3893; train_global_loss: 14636977.4962; train_optim_loss: 14636977.4962; val_kl_reg_loss: 85028.4234; val_edge_recon_loss: 2713361.1833; val_gene_expr_recon_loss: 10013535.1333; val_masked_gp_l1_reg_loss: 136240.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77539.6797; val_chrom_access_recon_loss: 1724829.6750; val_global_loss: 14750534.2000; val_optim_loss: 14750534.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9791; val_auprc_score: 0.9737; val_best_acc_score: 0.9340; val_best_f1_score: 0.9353; train_kl_reg_loss: 87863.1356; train_edge_recon_loss: 2683189.7977; train_gene_expr_recon_loss: 9925702.6412; train_masked_gp_l1_reg_loss: 133607.6409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58940.3680; train_chrom_access_recon_loss: 1708056.6937; train_global_loss: 14597360.2748; train_optim_loss: 14597360.2748; val_kl_reg_loss: 87745.4271; val_edge_recon_loss: 2699967.3667; val_gene_expr_recon_loss: 10001628.9333; val_masked_gp_l1_reg_loss: 132904.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57023.9258; val_chrom_access_recon_loss: 1723393.8417; val_global_loss: 14702664.4667; val_optim_loss: 14702664.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9790; val_auprc_score: 0.9739; val_best_acc_score: 0.9312; val_best_f1_score: 0.9325; train_kl_reg_loss: 89476.6998; train_edge_recon_loss: 2683979.8874; train_gene_expr_recon_loss: 9919193.9542; train_masked_gp_l1_reg_loss: 132724.8568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56783.4998; train_chrom_access_recon_loss: 1708466.4418; train_global_loss: 14590625.3588; train_optim_loss: 14590625.3588; val_kl_reg_loss: 88053.1099; val_edge_recon_loss: 2705051.5500; val_gene_expr_recon_loss: 10021588.3333; val_masked_gp_l1_reg_loss: 132602.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56565.7109; val_chrom_access_recon_loss: 1720573.3083; val_global_loss: 14724435.2000; val_optim_loss: 14724435.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9815; val_auprc_score: 0.9774; val_best_acc_score: 0.9373; val_best_f1_score: 0.9387; train_kl_reg_loss: 88900.7452; train_edge_recon_loss: 2685990.3263; train_gene_expr_recon_loss: 9917656.9771; train_masked_gp_l1_reg_loss: 132522.0060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56391.9712; train_chrom_access_recon_loss: 1706934.0382; train_global_loss: 14588396.1374; train_optim_loss: 14588396.1374; val_kl_reg_loss: 86820.9552; val_edge_recon_loss: 2698888.2000; val_gene_expr_recon_loss: 10016521.8667; val_masked_gp_l1_reg_loss: 132462.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56283.2734; val_chrom_access_recon_loss: 1722382.5250; val_global_loss: 14713359.4000; val_optim_loss: 14713359.4000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9793; val_auprc_score: 0.9715; val_best_acc_score: 0.9353; val_best_f1_score: 0.9367; train_kl_reg_loss: 88985.4195; train_edge_recon_loss: 2681097.4752; train_gene_expr_recon_loss: 9914484.3664; train_masked_gp_l1_reg_loss: 132437.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56161.2596; train_chrom_access_recon_loss: 1707289.6651; train_global_loss: 14580455.8321; train_optim_loss: 14580455.8321; val_kl_reg_loss: 87938.7318; val_edge_recon_loss: 2690838.4500; val_gene_expr_recon_loss: 10032420.2000; val_masked_gp_l1_reg_loss: 132381.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56088.9805; val_chrom_access_recon_loss: 1728725.9917; val_global_loss: 14728394.4667; val_optim_loss: 14728394.4667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9779; val_auprc_score: 0.9711; val_best_acc_score: 0.9344; val_best_f1_score: 0.9359; train_kl_reg_loss: 89194.2437; train_edge_recon_loss: 2684515.7634; train_gene_expr_recon_loss: 9916444.7176; train_masked_gp_l1_reg_loss: 132374.9196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55928.1245; train_chrom_access_recon_loss: 1707194.5363; train_global_loss: 14585652.2595; train_optim_loss: 14585652.2595; val_kl_reg_loss: 88062.6724; val_edge_recon_loss: 2707810.5500; val_gene_expr_recon_loss: 10004075.6000; val_masked_gp_l1_reg_loss: 132318.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55763.3203; val_chrom_access_recon_loss: 1723438.7917; val_global_loss: 14711469.4667; val_optim_loss: 14711469.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9777; val_auprc_score: 0.9708; val_best_acc_score: 0.9321; val_best_f1_score: 0.9330; train_kl_reg_loss: 89187.7468; train_edge_recon_loss: 2684880.9504; train_gene_expr_recon_loss: 9907776.8473; train_masked_gp_l1_reg_loss: 132051.0358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53748.0944; train_chrom_access_recon_loss: 1706366.8597; train_global_loss: 14574011.5649; train_optim_loss: 14574011.5649; val_kl_reg_loss: 88043.5104; val_edge_recon_loss: 2704729.7167; val_gene_expr_recon_loss: 10007217.6000; val_masked_gp_l1_reg_loss: 131960.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53521.7031; val_chrom_access_recon_loss: 1715344.9000; val_global_loss: 14700818.0667; val_optim_loss: 14700818.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9799; val_auprc_score: 0.9748; val_best_acc_score: 0.9387; val_best_f1_score: 0.9399; train_kl_reg_loss: 89418.3671; train_edge_recon_loss: 2684996.9962; train_gene_expr_recon_loss: 9911666.1221; train_masked_gp_l1_reg_loss: 131932.5364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53486.5855; train_chrom_access_recon_loss: 1708047.1756; train_global_loss: 14579547.7863; train_optim_loss: 14579547.7863; val_kl_reg_loss: 88164.5880; val_edge_recon_loss: 2691023.1500; val_gene_expr_recon_loss: 10022859.0000; val_masked_gp_l1_reg_loss: 131906.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53455.1094; val_chrom_access_recon_loss: 1731120.7417; val_global_loss: 14718528.6000; val_optim_loss: 14718528.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9769; val_auprc_score: 0.9695; val_best_acc_score: 0.9328; val_best_f1_score: 0.9345; train_kl_reg_loss: 89487.0351; train_edge_recon_loss: 2677612.0573; train_gene_expr_recon_loss: 9915523.4809; train_masked_gp_l1_reg_loss: 131893.4070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53421.0004; train_chrom_access_recon_loss: 1707245.4857; train_global_loss: 14575182.3740; train_optim_loss: 14575182.3740; val_kl_reg_loss: 89039.2276; val_edge_recon_loss: 2708565.6667; val_gene_expr_recon_loss: 10049361.5333; val_masked_gp_l1_reg_loss: 131880.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53404.9219; val_chrom_access_recon_loss: 1727014.9833; val_global_loss: 14759267.4667; val_optim_loss: 14759267.4667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9761; val_auprc_score: 0.9646; val_best_acc_score: 0.9351; val_best_f1_score: 0.9365; train_kl_reg_loss: 89797.5643; train_edge_recon_loss: 2684223.5439; train_gene_expr_recon_loss: 9910400.2366; train_masked_gp_l1_reg_loss: 131870.5558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53395.1485; train_chrom_access_recon_loss: 1706075.8655; train_global_loss: 14575762.9008; train_optim_loss: 14575762.9008; val_kl_reg_loss: 88423.2630; val_edge_recon_loss: 2711731.9167; val_gene_expr_recon_loss: 10045713.6667; val_masked_gp_l1_reg_loss: 131859.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53376.4023; val_chrom_access_recon_loss: 1732438.3833; val_global_loss: 14763542.0667; val_optim_loss: 14763542.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9788; val_auprc_score: 0.9706; val_best_acc_score: 0.9344; val_best_f1_score: 0.9364; train_kl_reg_loss: 89733.8706; train_edge_recon_loss: 2685406.2252; train_gene_expr_recon_loss: 9911459.5420; train_masked_gp_l1_reg_loss: 131852.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53361.2882; train_chrom_access_recon_loss: 1707702.2767; train_global_loss: 14579516.1985; train_optim_loss: 14579516.1985; val_kl_reg_loss: 88465.9203; val_edge_recon_loss: 2691292.8333; val_gene_expr_recon_loss: 10010766.1333; val_masked_gp_l1_reg_loss: 131846.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53343.3672; val_chrom_access_recon_loss: 1725431.6083; val_global_loss: 14701145.6000; val_optim_loss: 14701145.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9790; val_auprc_score: 0.9727; val_best_acc_score: 0.9351; val_best_f1_score: 0.9358; train_kl_reg_loss: 89725.0057; train_edge_recon_loss: 2687009.2156; train_gene_expr_recon_loss: 9914835.2824; train_masked_gp_l1_reg_loss: 131819.1224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53141.8960; train_chrom_access_recon_loss: 1707909.1689; train_global_loss: 14584439.6565; train_optim_loss: 14584439.6565; val_kl_reg_loss: 88258.7089; val_edge_recon_loss: 2705847.5000; val_gene_expr_recon_loss: 10061911.0000; val_masked_gp_l1_reg_loss: 131810.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53121.8711; val_chrom_access_recon_loss: 1728680.5417; val_global_loss: 14769629.9333; val_optim_loss: 14769629.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9772; val_auprc_score: 0.9700; val_best_acc_score: 0.9353; val_best_f1_score: 0.9365; train_kl_reg_loss: 89815.3911; train_edge_recon_loss: 2685373.7233; train_gene_expr_recon_loss: 9920349.6107; train_masked_gp_l1_reg_loss: 131806.5592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53118.7421; train_chrom_access_recon_loss: 1708714.0878; train_global_loss: 14589178.2137; train_optim_loss: 14589178.2137; val_kl_reg_loss: 88370.6620; val_edge_recon_loss: 2698584.8167; val_gene_expr_recon_loss: 10032723.2667; val_masked_gp_l1_reg_loss: 131803.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53115.5156; val_chrom_access_recon_loss: 1728096.2500; val_global_loss: 14732694.8667; val_optim_loss: 14732694.8667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9778; val_auprc_score: 0.9688; val_best_acc_score: 0.9341; val_best_f1_score: 0.9355; train_kl_reg_loss: 89814.2065; train_edge_recon_loss: 2680943.4275; train_gene_expr_recon_loss: 9916147.0992; train_masked_gp_l1_reg_loss: 131801.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53113.6210; train_chrom_access_recon_loss: 1708507.6116; train_global_loss: 14580327.5725; train_optim_loss: 14580327.5725; val_kl_reg_loss: 88417.8714; val_edge_recon_loss: 2709634.9167; val_gene_expr_recon_loss: 10007243.4667; val_masked_gp_l1_reg_loss: 131800.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53110.6797; val_chrom_access_recon_loss: 1725493.4083; val_global_loss: 14715700.6000; val_optim_loss: 14715700.6000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9813; val_auprc_score: 0.9761; val_best_acc_score: 0.9368; val_best_f1_score: 0.9381; train_kl_reg_loss: 89730.4026; train_edge_recon_loss: 2683786.2156; train_gene_expr_recon_loss: 9912924.6870; train_masked_gp_l1_reg_loss: 131798.8579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53108.4404; train_chrom_access_recon_loss: 1706975.4590; train_global_loss: 14578324.0534; train_optim_loss: 14578324.0534; val_kl_reg_loss: 88436.0203; val_edge_recon_loss: 2696538.7333; val_gene_expr_recon_loss: 10020392.5333; val_masked_gp_l1_reg_loss: 131797.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53106.3008; val_chrom_access_recon_loss: 1730343.9000; val_global_loss: 14720614.1333; val_optim_loss: 14720614.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 82 min 21 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9792
val AUPRC score: 0.9732
val best accuracy score: 0.9355
val best F1 score: 0.9373
val target rna MSE score: 1.3778
val source rna MSE score: 0.3615
val target atac MSE score: 0.3403
val source atac MSE score: 0.0568
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
