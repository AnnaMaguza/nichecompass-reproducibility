[True]
Run timestamp: 07082023_182636_39.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_39']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8819; val_auprc_score: 0.9002; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11145.1992; train_edge_recon_loss: 35832.2070; train_gene_expr_recon_loss: 1189196.6458; train_masked_gp_l1_reg_loss: 4608.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167168.4462; train_chrom_access_recon_loss: 754025.1632; train_global_loss: 2161976.0278; train_optim_loss: 2161976.0278; val_kl_reg_loss: 5823.6616; val_edge_recon_loss: 40658.2969; val_gene_expr_recon_loss: 996579.7500; val_masked_gp_l1_reg_loss: 4173.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162749.0469; val_chrom_access_recon_loss: 515605.2188; val_global_loss: 1725589.8750; val_optim_loss: 1725589.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8962; val_auprc_score: 0.9095; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7390.8706; train_edge_recon_loss: 36819.1766; train_gene_expr_recon_loss: 922034.4028; train_masked_gp_l1_reg_loss: 4113.1975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160001.5625; train_chrom_access_recon_loss: 490018.2812; train_global_loss: 1620377.5000; train_optim_loss: 1620377.5000; val_kl_reg_loss: 12172.9062; val_edge_recon_loss: 40660.5977; val_gene_expr_recon_loss: 831988.8750; val_masked_gp_l1_reg_loss: 4126.9888; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156578.3125; val_chrom_access_recon_loss: 479997.8438; val_global_loss: 1525525.5000; val_optim_loss: 1525525.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8933; val_auprc_score: 0.9070; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16602.2172; train_edge_recon_loss: 38380.4071; train_gene_expr_recon_loss: 805459.8472; train_masked_gp_l1_reg_loss: 4204.4968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153573.5312; train_chrom_access_recon_loss: 468711.6458; train_global_loss: 1486932.1806; train_optim_loss: 1486932.1806; val_kl_reg_loss: 16152.2402; val_edge_recon_loss: 40660.4727; val_gene_expr_recon_loss: 766246.3125; val_masked_gp_l1_reg_loss: 4277.7222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149531.7812; val_chrom_access_recon_loss: 461802.0938; val_global_loss: 1438670.6250; val_optim_loss: 1438670.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8847; val_auprc_score: 0.9003; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16202.7240; train_edge_recon_loss: 38395.2700; train_gene_expr_recon_loss: 758056.8611; train_masked_gp_l1_reg_loss: 4297.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145943.9080; train_chrom_access_recon_loss: 457199.5556; train_global_loss: 1420095.4028; train_optim_loss: 1420095.4028; val_kl_reg_loss: 18965.3672; val_edge_recon_loss: 40659.2773; val_gene_expr_recon_loss: 733822.6250; val_masked_gp_l1_reg_loss: 4305.1309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141316.3438; val_chrom_access_recon_loss: 456053.8438; val_global_loss: 1395122.6250; val_optim_loss: 1395122.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8890; val_auprc_score: 0.8997; val_best_acc_score: 0.5047; val_best_f1_score: 0.6688; train_kl_reg_loss: 20364.3362; train_edge_recon_loss: 38819.8806; train_gene_expr_recon_loss: 724384.4653; train_masked_gp_l1_reg_loss: 4276.6546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137412.7535; train_chrom_access_recon_loss: 452077.8542; train_global_loss: 1377335.9306; train_optim_loss: 1377335.9306; val_kl_reg_loss: 18364.9453; val_edge_recon_loss: 40657.5430; val_gene_expr_recon_loss: 713084.7500; val_masked_gp_l1_reg_loss: 4221.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132442.5156; val_chrom_access_recon_loss: 451843.4062; val_global_loss: 1360615.1250; val_optim_loss: 1360615.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8906; val_auprc_score: 0.8987; val_best_acc_score: 0.5081; val_best_f1_score: 0.6703; train_kl_reg_loss: 18963.3314; train_edge_recon_loss: 38705.9431; train_gene_expr_recon_loss: 708683.4792; train_masked_gp_l1_reg_loss: 4196.8837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128428.2005; train_chrom_access_recon_loss: 446664.1354; train_global_loss: 1345641.9861; train_optim_loss: 1345641.9861; val_kl_reg_loss: 19691.5039; val_edge_recon_loss: 40654.7852; val_gene_expr_recon_loss: 697578.8750; val_masked_gp_l1_reg_loss: 4168.9497; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123423.9375; val_chrom_access_recon_loss: 448966.4688; val_global_loss: 1334484.5000; val_optim_loss: 1334484.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8817; val_auprc_score: 0.8891; val_best_acc_score: 0.5117; val_best_f1_score: 0.6719; train_kl_reg_loss: 19714.3770; train_edge_recon_loss: 38796.0720; train_gene_expr_recon_loss: 695041.8472; train_masked_gp_l1_reg_loss: 4142.5498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119468.6545; train_chrom_access_recon_loss: 444292.3056; train_global_loss: 1321455.8194; train_optim_loss: 1321455.8194; val_kl_reg_loss: 19320.2520; val_edge_recon_loss: 40651.1445; val_gene_expr_recon_loss: 686462.3125; val_masked_gp_l1_reg_loss: 4108.9697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114582.0781; val_chrom_access_recon_loss: 446955.2812; val_global_loss: 1312080.0000; val_optim_loss: 1312080.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8714; val_auprc_score: 0.8776; val_best_acc_score: 0.5136; val_best_f1_score: 0.6726; train_kl_reg_loss: 19699.2661; train_edge_recon_loss: 38802.6992; train_gene_expr_recon_loss: 684320.9653; train_masked_gp_l1_reg_loss: 4095.6171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110781.3837; train_chrom_access_recon_loss: 442561.0903; train_global_loss: 1300261.0278; train_optim_loss: 1300261.0278; val_kl_reg_loss: 18879.5625; val_edge_recon_loss: 40646.6836; val_gene_expr_recon_loss: 678128.5000; val_masked_gp_l1_reg_loss: 4073.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106107.6719; val_chrom_access_recon_loss: 445210.0000; val_global_loss: 1293045.8750; val_optim_loss: 1293045.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8629; val_auprc_score: 0.8659; val_best_acc_score: 0.5233; val_best_f1_score: 0.6767; train_kl_reg_loss: 20094.0825; train_edge_recon_loss: 38881.0647; train_gene_expr_recon_loss: 678753.8958; train_masked_gp_l1_reg_loss: 4059.8179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102520.5538; train_chrom_access_recon_loss: 441557.5833; train_global_loss: 1285867.0417; train_optim_loss: 1285867.0417; val_kl_reg_loss: 19376.0273; val_edge_recon_loss: 40640.0000; val_gene_expr_recon_loss: 670458.8750; val_masked_gp_l1_reg_loss: 4038.1128; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98130.9375; val_chrom_access_recon_loss: 443716.1250; val_global_loss: 1276360.0000; val_optim_loss: 1276360.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8646; val_auprc_score: 0.8707; val_best_acc_score: 0.5383; val_best_f1_score: 0.6832; train_kl_reg_loss: 20162.5441; train_edge_recon_loss: 38862.5920; train_gene_expr_recon_loss: 674365.1806; train_masked_gp_l1_reg_loss: 4028.9540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94795.6484; train_chrom_access_recon_loss: 440887.1215; train_global_loss: 1273102.0556; train_optim_loss: 1273102.0556; val_kl_reg_loss: 19464.0781; val_edge_recon_loss: 40630.2148; val_gene_expr_recon_loss: 665044.6875; val_masked_gp_l1_reg_loss: 4013.6421; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90729.7656; val_chrom_access_recon_loss: 442346.8750; val_global_loss: 1262229.2500; val_optim_loss: 1262229.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8563; val_auprc_score: 0.8603; val_best_acc_score: 0.5559; val_best_f1_score: 0.6910; train_kl_reg_loss: 20418.2567; train_edge_recon_loss: 38926.0473; train_gene_expr_recon_loss: 665894.4792; train_masked_gp_l1_reg_loss: 4007.7648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87670.5868; train_chrom_access_recon_loss: 436736.8750; train_global_loss: 1253654.0278; train_optim_loss: 1253654.0278; val_kl_reg_loss: 19600.6055; val_edge_recon_loss: 40621.1836; val_gene_expr_recon_loss: 660399.0000; val_masked_gp_l1_reg_loss: 3996.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83959.0469; val_chrom_access_recon_loss: 440818.5938; val_global_loss: 1249394.6250; val_optim_loss: 1249394.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8547; val_auprc_score: 0.8579; val_best_acc_score: 0.5825; val_best_f1_score: 0.7035; train_kl_reg_loss: 20135.6406; train_edge_recon_loss: 38894.0799; train_gene_expr_recon_loss: 662454.6528; train_masked_gp_l1_reg_loss: 3991.8070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81195.7943; train_chrom_access_recon_loss: 436942.5278; train_global_loss: 1243614.5278; train_optim_loss: 1243614.5278; val_kl_reg_loss: 19326.7715; val_edge_recon_loss: 40609.1562; val_gene_expr_recon_loss: 657141.8750; val_masked_gp_l1_reg_loss: 3982.9097; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77848.1719; val_chrom_access_recon_loss: 439734.5625; val_global_loss: 1238643.5000; val_optim_loss: 1238643.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8550; val_auprc_score: 0.8575; val_best_acc_score: 0.6037; val_best_f1_score: 0.7131; train_kl_reg_loss: 19998.6137; train_edge_recon_loss: 38902.7235; train_gene_expr_recon_loss: 657722.1111; train_masked_gp_l1_reg_loss: 3980.1955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75352.4036; train_chrom_access_recon_loss: 435297.3576; train_global_loss: 1231253.3889; train_optim_loss: 1231253.3889; val_kl_reg_loss: 18861.2207; val_edge_recon_loss: 40596.1055; val_gene_expr_recon_loss: 654698.6875; val_masked_gp_l1_reg_loss: 3974.6597; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72326.9219; val_chrom_access_recon_loss: 438872.9375; val_global_loss: 1229330.5000; val_optim_loss: 1229330.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8676; val_auprc_score: 0.8697; val_best_acc_score: 0.6424; val_best_f1_score: 0.7328; train_kl_reg_loss: 19795.7007; train_edge_recon_loss: 38883.5430; train_gene_expr_recon_loss: 658694.4375; train_masked_gp_l1_reg_loss: 3975.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70077.5590; train_chrom_access_recon_loss: 436775.4861; train_global_loss: 1228202.6389; train_optim_loss: 1228202.6389; val_kl_reg_loss: 19016.5547; val_edge_recon_loss: 40577.5977; val_gene_expr_recon_loss: 651542.3750; val_masked_gp_l1_reg_loss: 3969.7236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67347.8203; val_chrom_access_recon_loss: 437656.9688; val_global_loss: 1220111.0000; val_optim_loss: 1220111.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8792; val_auprc_score: 0.8777; val_best_acc_score: 0.6952; val_best_f1_score: 0.7591; train_kl_reg_loss: 19546.2433; train_edge_recon_loss: 38857.8620; train_gene_expr_recon_loss: 651755.8472; train_masked_gp_l1_reg_loss: 3970.0090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65309.0777; train_chrom_access_recon_loss: 434725.0139; train_global_loss: 1214164.0278; train_optim_loss: 1214164.0278; val_kl_reg_loss: 18205.5586; val_edge_recon_loss: 40540.9805; val_gene_expr_recon_loss: 650163.7500; val_masked_gp_l1_reg_loss: 3965.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62832.6602; val_chrom_access_recon_loss: 436892.4375; val_global_loss: 1212600.7500; val_optim_loss: 1212600.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8908; val_auprc_score: 0.8866; val_best_acc_score: 0.7480; val_best_f1_score: 0.7897; train_kl_reg_loss: 19211.1923; train_edge_recon_loss: 38805.5881; train_gene_expr_recon_loss: 653395.2292; train_masked_gp_l1_reg_loss: 3968.1395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60988.9345; train_chrom_access_recon_loss: 433459.4757; train_global_loss: 1209828.5556; train_optim_loss: 1209828.5556; val_kl_reg_loss: 18163.9043; val_edge_recon_loss: 40496.0938; val_gene_expr_recon_loss: 647751.0000; val_masked_gp_l1_reg_loss: 3965.9604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58744.5156; val_chrom_access_recon_loss: 436777.0625; val_global_loss: 1205898.5000; val_optim_loss: 1205898.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9018; val_auprc_score: 0.8944; val_best_acc_score: 0.7983; val_best_f1_score: 0.8203; train_kl_reg_loss: 18910.7941; train_edge_recon_loss: 38751.8207; train_gene_expr_recon_loss: 649676.0208; train_masked_gp_l1_reg_loss: 3970.9998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57069.9978; train_chrom_access_recon_loss: 433848.6806; train_global_loss: 1202228.3194; train_optim_loss: 1202228.3194; val_kl_reg_loss: 18169.6836; val_edge_recon_loss: 40411.0000; val_gene_expr_recon_loss: 645639.6250; val_masked_gp_l1_reg_loss: 3972.7222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55026.1758; val_chrom_access_recon_loss: 435916.4062; val_global_loss: 1199135.6250; val_optim_loss: 1199135.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9100; val_auprc_score: 0.9014; val_best_acc_score: 0.8387; val_best_f1_score: 0.8466; train_kl_reg_loss: 18578.5165; train_edge_recon_loss: 38661.9874; train_gene_expr_recon_loss: 644959.2500; train_masked_gp_l1_reg_loss: 3980.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53494.7166; train_chrom_access_recon_loss: 431140.5139; train_global_loss: 1190815.2917; train_optim_loss: 1190815.2917; val_kl_reg_loss: 17580.3789; val_edge_recon_loss: 40292.9648; val_gene_expr_recon_loss: 644373.1250; val_masked_gp_l1_reg_loss: 3982.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51624.1758; val_chrom_access_recon_loss: 435189.3438; val_global_loss: 1193042.7500; val_optim_loss: 1193042.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9141; val_auprc_score: 0.9073; val_best_acc_score: 0.8455; val_best_f1_score: 0.8465; train_kl_reg_loss: 18379.7954; train_edge_recon_loss: 38567.4544; train_gene_expr_recon_loss: 647895.7639; train_masked_gp_l1_reg_loss: 3989.3714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50222.4262; train_chrom_access_recon_loss: 432222.8750; train_global_loss: 1191277.6806; train_optim_loss: 1191277.6806; val_kl_reg_loss: 16984.0781; val_edge_recon_loss: 40190.0039; val_gene_expr_recon_loss: 643797.8750; val_masked_gp_l1_reg_loss: 3993.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48512.6406; val_chrom_access_recon_loss: 434692.0312; val_global_loss: 1188169.8750; val_optim_loss: 1188169.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9203; val_auprc_score: 0.9123; val_best_acc_score: 0.8434; val_best_f1_score: 0.8425; train_kl_reg_loss: 18105.1443; train_edge_recon_loss: 38499.3511; train_gene_expr_recon_loss: 647235.6944; train_masked_gp_l1_reg_loss: 4002.2447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47240.7300; train_chrom_access_recon_loss: 432344.7708; train_global_loss: 1187427.9306; train_optim_loss: 1187427.9306; val_kl_reg_loss: 17292.8555; val_edge_recon_loss: 40122.2188; val_gene_expr_recon_loss: 641060.3125; val_masked_gp_l1_reg_loss: 4006.8552; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45679.1602; val_chrom_access_recon_loss: 433692.9062; val_global_loss: 1181854.3750; val_optim_loss: 1181854.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9295; val_auprc_score: 0.9243; val_best_acc_score: 0.8494; val_best_f1_score: 0.8439; train_kl_reg_loss: 17940.3342; train_edge_recon_loss: 38409.3021; train_gene_expr_recon_loss: 642978.6736; train_masked_gp_l1_reg_loss: 4016.4484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44503.8034; train_chrom_access_recon_loss: 430921.8056; train_global_loss: 1178770.3472; train_optim_loss: 1178770.3472; val_kl_reg_loss: 17181.0742; val_edge_recon_loss: 40003.0938; val_gene_expr_recon_loss: 639655.5000; val_masked_gp_l1_reg_loss: 4023.3052; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43066.6836; val_chrom_access_recon_loss: 433115.9688; val_global_loss: 1177045.6250; val_optim_loss: 1177045.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9319; val_auprc_score: 0.9228; val_best_acc_score: 0.8444; val_best_f1_score: 0.8351; train_kl_reg_loss: 17685.8038; train_edge_recon_loss: 38322.0699; train_gene_expr_recon_loss: 639955.1667; train_masked_gp_l1_reg_loss: 4031.2611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41987.5521; train_chrom_access_recon_loss: 430352.3889; train_global_loss: 1172334.2778; train_optim_loss: 1172334.2778; val_kl_reg_loss: 17029.4492; val_edge_recon_loss: 39904.4180; val_gene_expr_recon_loss: 638357.1875; val_masked_gp_l1_reg_loss: 4038.2825; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40668.9414; val_chrom_access_recon_loss: 432349.4688; val_global_loss: 1172347.7500; val_optim_loss: 1172347.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9313; val_auprc_score: 0.9224; val_best_acc_score: 0.8325; val_best_f1_score: 0.8245; train_kl_reg_loss: 17568.2572; train_edge_recon_loss: 38245.6042; train_gene_expr_recon_loss: 643042.1250; train_masked_gp_l1_reg_loss: 4051.1147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39675.7500; train_chrom_access_recon_loss: 430189.1701; train_global_loss: 1172772.0278; train_optim_loss: 1172772.0278; val_kl_reg_loss: 16574.7109; val_edge_recon_loss: 39828.0664; val_gene_expr_recon_loss: 637552.5625; val_masked_gp_l1_reg_loss: 4058.8462; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38464.1641; val_chrom_access_recon_loss: 431697.1562; val_global_loss: 1168175.5000; val_optim_loss: 1168175.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9346; val_auprc_score: 0.9252; val_best_acc_score: 0.8306; val_best_f1_score: 0.8313; train_kl_reg_loss: 17347.4412; train_edge_recon_loss: 38171.2695; train_gene_expr_recon_loss: 641704.6944; train_masked_gp_l1_reg_loss: 4069.2079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37556.4887; train_chrom_access_recon_loss: 429790.9757; train_global_loss: 1168640.0556; train_optim_loss: 1168640.0556; val_kl_reg_loss: 16549.1113; val_edge_recon_loss: 39730.2188; val_gene_expr_recon_loss: 636129.5000; val_masked_gp_l1_reg_loss: 4075.1733; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36433.6250; val_chrom_access_recon_loss: 430950.5938; val_global_loss: 1163868.2500; val_optim_loss: 1163868.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9395; val_auprc_score: 0.9300; val_best_acc_score: 0.8283; val_best_f1_score: 0.8432; train_kl_reg_loss: 17191.5718; train_edge_recon_loss: 38106.2947; train_gene_expr_recon_loss: 636896.1667; train_masked_gp_l1_reg_loss: 4084.6099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35594.8286; train_chrom_access_recon_loss: 426615.8958; train_global_loss: 1158489.3889; train_optim_loss: 1158489.3889; val_kl_reg_loss: 16389.9922; val_edge_recon_loss: 39631.1094; val_gene_expr_recon_loss: 635058.8750; val_masked_gp_l1_reg_loss: 4087.8152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34560.0156; val_chrom_access_recon_loss: 430415.3750; val_global_loss: 1160143.2500; val_optim_loss: 1160143.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9366; val_auprc_score: 0.9285; val_best_acc_score: 0.8657; val_best_f1_score: 0.8682; train_kl_reg_loss: 14327.2703; train_edge_recon_loss: 39704.7031; train_gene_expr_recon_loss: 928799.8194; train_masked_gp_l1_reg_loss: 4155.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33654.5230; train_chrom_access_recon_loss: 455528.6076; train_global_loss: 1476169.9861; train_optim_loss: 1476169.9861; val_kl_reg_loss: 11214.4531; val_edge_recon_loss: 40196.3281; val_gene_expr_recon_loss: 918484.6250; val_masked_gp_l1_reg_loss: 4280.2456; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32445.7617; val_chrom_access_recon_loss: 455228.7500; val_global_loss: 1461850.1250; val_optim_loss: 1461850.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9390; val_auprc_score: 0.9302; val_best_acc_score: 0.8746; val_best_f1_score: 0.8783; train_kl_reg_loss: 13257.9723; train_edge_recon_loss: 39845.9475; train_gene_expr_recon_loss: 923654.6806; train_masked_gp_l1_reg_loss: 4397.5406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31459.8155; train_chrom_access_recon_loss: 450269.5799; train_global_loss: 1462885.5417; train_optim_loss: 1462885.5417; val_kl_reg_loss: 11355.5996; val_edge_recon_loss: 40250.6328; val_gene_expr_recon_loss: 910953.1250; val_masked_gp_l1_reg_loss: 4531.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30248.9453; val_chrom_access_recon_loss: 454384.2812; val_global_loss: 1451724.1250; val_optim_loss: 1451724.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9435; val_auprc_score: 0.9366; val_best_acc_score: 0.8750; val_best_f1_score: 0.8772; train_kl_reg_loss: 12963.5154; train_edge_recon_loss: 39840.3442; train_gene_expr_recon_loss: 917289.9236; train_masked_gp_l1_reg_loss: 4619.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29329.2515; train_chrom_access_recon_loss: 452319.3194; train_global_loss: 1456361.8472; train_optim_loss: 1456361.8472; val_kl_reg_loss: 11430.6357; val_edge_recon_loss: 40204.6484; val_gene_expr_recon_loss: 905444.7500; val_masked_gp_l1_reg_loss: 4712.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28211.7188; val_chrom_access_recon_loss: 453618.9375; val_global_loss: 1443623.2500; val_optim_loss: 1443623.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9404; val_auprc_score: 0.9302; val_best_acc_score: 0.8692; val_best_f1_score: 0.8686; train_kl_reg_loss: 12865.8390; train_edge_recon_loss: 39785.0851; train_gene_expr_recon_loss: 909808.5694; train_masked_gp_l1_reg_loss: 4767.5607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27375.4436; train_chrom_access_recon_loss: 452242.4514; train_global_loss: 1446844.9583; train_optim_loss: 1446844.9583; val_kl_reg_loss: 11577.9453; val_edge_recon_loss: 40083.4648; val_gene_expr_recon_loss: 900780.5000; val_masked_gp_l1_reg_loss: 4827.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26361.4492; val_chrom_access_recon_loss: 452966.7500; val_global_loss: 1436597.2500; val_optim_loss: 1436597.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9478; val_auprc_score: 0.9418; val_best_acc_score: 0.8739; val_best_f1_score: 0.8729; train_kl_reg_loss: 12772.8825; train_edge_recon_loss: 39725.2865; train_gene_expr_recon_loss: 905543.7292; train_masked_gp_l1_reg_loss: 4817.2883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26197.1072; train_chrom_access_recon_loss: 449194.2951; train_global_loss: 1438250.5972; train_optim_loss: 1438250.5972; val_kl_reg_loss: 11857.4863; val_edge_recon_loss: 40069.9727; val_gene_expr_recon_loss: 900057.9375; val_masked_gp_l1_reg_loss: 4809.1670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26017.2812; val_chrom_access_recon_loss: 452869.4375; val_global_loss: 1435681.2500; val_optim_loss: 1435681.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9448; val_auprc_score: 0.9381; val_best_acc_score: 0.8719; val_best_f1_score: 0.8708; train_kl_reg_loss: 12970.3325; train_edge_recon_loss: 39736.0894; train_gene_expr_recon_loss: 903466.9028; train_masked_gp_l1_reg_loss: 4808.8548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25912.4321; train_chrom_access_recon_loss: 449245.8194; train_global_loss: 1436140.4306; train_optim_loss: 1436140.4306; val_kl_reg_loss: 11885.0625; val_edge_recon_loss: 40075.6211; val_gene_expr_recon_loss: 899727.5000; val_masked_gp_l1_reg_loss: 4806.9521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25775.9199; val_chrom_access_recon_loss: 452840.4688; val_global_loss: 1435111.5000; val_optim_loss: 1435111.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9444; val_auprc_score: 0.9312; val_best_acc_score: 0.8740; val_best_f1_score: 0.8725; train_kl_reg_loss: 12903.9046; train_edge_recon_loss: 39725.4518; train_gene_expr_recon_loss: 903248.4097; train_masked_gp_l1_reg_loss: 4806.2346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25677.5421; train_chrom_access_recon_loss: 449703.3264; train_global_loss: 1436064.8611; train_optim_loss: 1436064.8611; val_kl_reg_loss: 11799.2520; val_edge_recon_loss: 40074.4961; val_gene_expr_recon_loss: 899364.1250; val_masked_gp_l1_reg_loss: 4805.6021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25557.4453; val_chrom_access_recon_loss: 452718.5000; val_global_loss: 1434319.5000; val_optim_loss: 1434319.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9464; val_auprc_score: 0.9404; val_best_acc_score: 0.8746; val_best_f1_score: 0.8728; train_kl_reg_loss: 12866.6472; train_edge_recon_loss: 39716.4002; train_gene_expr_recon_loss: 900284.3750; train_masked_gp_l1_reg_loss: 4805.7948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25466.2292; train_chrom_access_recon_loss: 448626.6424; train_global_loss: 1431766.0972; train_optim_loss: 1431766.0972; val_kl_reg_loss: 11838.6035; val_edge_recon_loss: 40062.8008; val_gene_expr_recon_loss: 899076.3750; val_masked_gp_l1_reg_loss: 4806.4692; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25356.8398; val_chrom_access_recon_loss: 452778.9062; val_global_loss: 1433920.0000; val_optim_loss: 1433920.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 52 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9418
val AUPRC score: 0.9365
val best accuracy score: 0.8701
val best F1 score: 0.8713
val target rna MSE score: 3.8004
val source rna MSE score: 3.1346
val target atac MSE score: 0.1340
val source atac MSE score: 0.0205
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
