[True]
Run timestamp: 24072023_164123_39.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_39']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9206; val_auprc_score: 0.9300; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12434.5027; train_edge_recon_loss: 3477484.7778; train_gene_expr_recon_loss: 3138756.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1096168.4306; train_global_loss: 7724844.1667; train_optim_loss: 7724844.1667; val_kl_reg_loss: 23832.9883; val_edge_recon_loss: 4065447.2500; val_gene_expr_recon_loss: 3011712.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076993.2500; val_global_loss: 8177986.0000; val_optim_loss: 8177986.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9109; val_auprc_score: 0.9237; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 30836.1860; train_edge_recon_loss: 3495422.1389; train_gene_expr_recon_loss: 2857690.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075692.8611; train_global_loss: 7459642.0000; train_optim_loss: 7459642.0000; val_kl_reg_loss: 28110.8887; val_edge_recon_loss: 4065320.7500; val_gene_expr_recon_loss: 2804980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060490.3750; val_global_loss: 7958902.5000; val_optim_loss: 7958902.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9081; val_auprc_score: 0.9196; val_best_acc_score: 0.5034; val_best_f1_score: 0.6682; train_kl_reg_loss: 35749.6343; train_edge_recon_loss: 3507519.9722; train_gene_expr_recon_loss: 2667906.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043853.4792; train_global_loss: 7255029.8333; train_optim_loss: 7255029.8333; val_kl_reg_loss: 54315.2266; val_edge_recon_loss: 4065258.7500; val_gene_expr_recon_loss: 2638871.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043590.1875; val_global_loss: 7802035.0000; val_optim_loss: 7802035.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9110; val_auprc_score: 0.9181; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 57277.1576; train_edge_recon_loss: 3510416.3056; train_gene_expr_recon_loss: 2524570.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027912.2500; train_global_loss: 7120175.7778; train_optim_loss: 7120175.7778; val_kl_reg_loss: 48547.3711; val_edge_recon_loss: 4064882.0000; val_gene_expr_recon_loss: 2493945.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028808.6250; val_global_loss: 7636182.5000; val_optim_loss: 7636182.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9117; val_auprc_score: 0.9132; val_best_acc_score: 0.5197; val_best_f1_score: 0.6755; train_kl_reg_loss: 62365.3203; train_edge_recon_loss: 3513574.0000; train_gene_expr_recon_loss: 2407328.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012766.3889; train_global_loss: 6996034.0556; train_optim_loss: 6996034.0556; val_kl_reg_loss: 60003.0352; val_edge_recon_loss: 4063965.0000; val_gene_expr_recon_loss: 2398187.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016961.9375; val_global_loss: 7539117.0000; val_optim_loss: 7539117.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9102; val_auprc_score: 0.9093; val_best_acc_score: 0.5519; val_best_f1_score: 0.6900; train_kl_reg_loss: 69774.8859; train_edge_recon_loss: 3515699.7500; train_gene_expr_recon_loss: 2333894.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007745.7222; train_global_loss: 6927114.7778; train_optim_loss: 6927114.7778; val_kl_reg_loss: 55364.2461; val_edge_recon_loss: 4062218.2500; val_gene_expr_recon_loss: 2340670.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010434.8750; val_global_loss: 7468687.5000; val_optim_loss: 7468687.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9101; val_auprc_score: 0.9087; val_best_acc_score: 0.5903; val_best_f1_score: 0.7080; train_kl_reg_loss: 69348.6033; train_edge_recon_loss: 3516545.9167; train_gene_expr_recon_loss: 2275711.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000657.2639; train_global_loss: 6862263.5556; train_optim_loss: 6862263.5556; val_kl_reg_loss: 68225.0312; val_edge_recon_loss: 4060368.2500; val_gene_expr_recon_loss: 2288280.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1002979.2500; val_global_loss: 7419853.0000; val_optim_loss: 7419853.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9132; val_auprc_score: 0.9090; val_best_acc_score: 0.6609; val_best_f1_score: 0.7442; train_kl_reg_loss: 72411.7426; train_edge_recon_loss: 3514573.0000; train_gene_expr_recon_loss: 2230001.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994438.7778; train_global_loss: 6811424.7778; train_optim_loss: 6811424.7778; val_kl_reg_loss: 62964.3516; val_edge_recon_loss: 4056747.2500; val_gene_expr_recon_loss: 2256164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998588.3750; val_global_loss: 7374464.0000; val_optim_loss: 7374464.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9111; val_auprc_score: 0.9023; val_best_acc_score: 0.7588; val_best_f1_score: 0.8007; train_kl_reg_loss: 72665.9792; train_edge_recon_loss: 3512632.4444; train_gene_expr_recon_loss: 2197721.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991550.9097; train_global_loss: 6774570.6111; train_optim_loss: 6774570.6111; val_kl_reg_loss: 57773.9922; val_edge_recon_loss: 4046979.7500; val_gene_expr_recon_loss: 2232647.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997938.4375; val_global_loss: 7335339.5000; val_optim_loss: 7335339.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9108; val_auprc_score: 0.9014; val_best_acc_score: 0.8261; val_best_f1_score: 0.8394; train_kl_reg_loss: 70771.2374; train_edge_recon_loss: 3510967.1944; train_gene_expr_recon_loss: 2177697.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987055.8611; train_global_loss: 6746491.9444; train_optim_loss: 6746491.9444; val_kl_reg_loss: 60656.2344; val_edge_recon_loss: 4023801.0000; val_gene_expr_recon_loss: 2213685.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 994767.3125; val_global_loss: 7292909.5000; val_optim_loss: 7292909.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9160; val_auprc_score: 0.9062; val_best_acc_score: 0.8212; val_best_f1_score: 0.8093; train_kl_reg_loss: 66570.2752; train_edge_recon_loss: 3502972.6111; train_gene_expr_recon_loss: 2159693.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982503.1944; train_global_loss: 6711739.2778; train_optim_loss: 6711739.2778; val_kl_reg_loss: 56733.1797; val_edge_recon_loss: 3955111.0000; val_gene_expr_recon_loss: 2201868.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 993344.7500; val_global_loss: 7207057.0000; val_optim_loss: 7207057.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9066; val_auprc_score: 0.8914; val_best_acc_score: 0.8265; val_best_f1_score: 0.8369; train_kl_reg_loss: 58207.6584; train_edge_recon_loss: 3479402.8611; train_gene_expr_recon_loss: 2159004.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983830.9167; train_global_loss: 6680446.2778; train_optim_loss: 6680446.2778; val_kl_reg_loss: 50737.7422; val_edge_recon_loss: 3744804.5000; val_gene_expr_recon_loss: 2202509.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 992367.7500; val_global_loss: 6990419.0000; val_optim_loss: 6990419.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8938; val_auprc_score: 0.8837; val_best_acc_score: 0.8025; val_best_f1_score: 0.8186; train_kl_reg_loss: 42629.4132; train_edge_recon_loss: 3354317.7778; train_gene_expr_recon_loss: 2186648.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991903.5764; train_global_loss: 6575499.3889; train_optim_loss: 6575499.3889; val_kl_reg_loss: 34167.3047; val_edge_recon_loss: 3213703.7500; val_gene_expr_recon_loss: 2262239.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001286.3750; val_global_loss: 6511396.5000; val_optim_loss: 6511396.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8762; val_auprc_score: 0.8664; val_best_acc_score: 0.7714; val_best_f1_score: 0.8018; train_kl_reg_loss: 52081.1098; train_edge_recon_loss: 3022883.5000; train_gene_expr_recon_loss: 2214285.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988258.6458; train_global_loss: 6277508.4444; train_optim_loss: 6277508.4444; val_kl_reg_loss: 82293.3438; val_edge_recon_loss: 2951870.7500; val_gene_expr_recon_loss: 2255723.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 996826.8125; val_global_loss: 6286714.0000; val_optim_loss: 6286714.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8858; val_auprc_score: 0.8764; val_best_acc_score: 0.7819; val_best_f1_score: 0.8018; train_kl_reg_loss: 102051.7196; train_edge_recon_loss: 2918453.0833; train_gene_expr_recon_loss: 2182786.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984757.2500; train_global_loss: 6188048.1111; train_optim_loss: 6188048.1111; val_kl_reg_loss: 101380.7500; val_edge_recon_loss: 2926560.0000; val_gene_expr_recon_loss: 2221374.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 992154.5000; val_global_loss: 6241469.5000; val_optim_loss: 6241469.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8984; val_auprc_score: 0.8897; val_best_acc_score: 0.7998; val_best_f1_score: 0.8149; train_kl_reg_loss: 91383.7188; train_edge_recon_loss: 2913556.9444; train_gene_expr_recon_loss: 2161982.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979289.5069; train_global_loss: 6146212.6111; train_optim_loss: 6146212.6111; val_kl_reg_loss: 83448.5938; val_edge_recon_loss: 2909828.7500; val_gene_expr_recon_loss: 2208285.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990889.6250; val_global_loss: 6192452.5000; val_optim_loss: 6192452.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9019; val_auprc_score: 0.8905; val_best_acc_score: 0.8075; val_best_f1_score: 0.8204; train_kl_reg_loss: 87957.0781; train_edge_recon_loss: 2904860.7222; train_gene_expr_recon_loss: 2158801.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981482.2014; train_global_loss: 6133101.9444; train_optim_loss: 6133101.9444; val_kl_reg_loss: 84180.3438; val_edge_recon_loss: 2931341.5000; val_gene_expr_recon_loss: 2195804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988043.0625; val_global_loss: 6199369.0000; val_optim_loss: 6199369.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9144; val_auprc_score: 0.8961; val_best_acc_score: 0.8370; val_best_f1_score: 0.8417; train_kl_reg_loss: 85340.5434; train_edge_recon_loss: 2881564.2500; train_gene_expr_recon_loss: 2164128.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983532.8125; train_global_loss: 6114566.3333; train_optim_loss: 6114566.3333; val_kl_reg_loss: 82794.5078; val_edge_recon_loss: 2854157.7500; val_gene_expr_recon_loss: 2191141.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986974.8750; val_global_loss: 6115069.0000; val_optim_loss: 6115069.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9190; val_auprc_score: 0.9001; val_best_acc_score: 0.8451; val_best_f1_score: 0.8542; train_kl_reg_loss: 82178.8550; train_edge_recon_loss: 2867895.5556; train_gene_expr_recon_loss: 2146268.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983056.5625; train_global_loss: 6079399.0556; train_optim_loss: 6079399.0556; val_kl_reg_loss: 80190.9375; val_edge_recon_loss: 2866516.7500; val_gene_expr_recon_loss: 2191567.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988737.3750; val_global_loss: 6127013.0000; val_optim_loss: 6127013.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9287; val_auprc_score: 0.9062; val_best_acc_score: 0.8628; val_best_f1_score: 0.8700; train_kl_reg_loss: 83799.6102; train_edge_recon_loss: 2826036.8333; train_gene_expr_recon_loss: 2136360.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976546.1944; train_global_loss: 6022743.1111; train_optim_loss: 6022743.1111; val_kl_reg_loss: 85998.6250; val_edge_recon_loss: 2833287.0000; val_gene_expr_recon_loss: 2186458.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986367.3125; val_global_loss: 6092111.5000; val_optim_loss: 6092111.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9202; val_best_acc_score: 0.8724; val_best_f1_score: 0.8782; train_kl_reg_loss: 91211.9323; train_edge_recon_loss: 2781834.1667; train_gene_expr_recon_loss: 2133971.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976136.7986; train_global_loss: 5983154.7778; train_optim_loss: 5983154.7778; val_kl_reg_loss: 93628.1328; val_edge_recon_loss: 2794557.5000; val_gene_expr_recon_loss: 2181775.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985128.6875; val_global_loss: 6055090.0000; val_optim_loss: 6055090.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9401; val_auprc_score: 0.9230; val_best_acc_score: 0.8758; val_best_f1_score: 0.8823; train_kl_reg_loss: 93001.7934; train_edge_recon_loss: 2788120.8333; train_gene_expr_recon_loss: 2128188.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971732.4514; train_global_loss: 5981043.1667; train_optim_loss: 5981043.1667; val_kl_reg_loss: 87623.5469; val_edge_recon_loss: 2792710.0000; val_gene_expr_recon_loss: 2179539.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985878.8125; val_global_loss: 6045752.0000; val_optim_loss: 6045752.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9491; val_auprc_score: 0.9314; val_best_acc_score: 0.8848; val_best_f1_score: 0.8906; train_kl_reg_loss: 86941.3741; train_edge_recon_loss: 2771372.1111; train_gene_expr_recon_loss: 2119675.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970803.8542; train_global_loss: 5948792.7222; train_optim_loss: 5948792.7222; val_kl_reg_loss: 84006.6875; val_edge_recon_loss: 2772636.7500; val_gene_expr_recon_loss: 2171594.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982696.7500; val_global_loss: 6010935.0000; val_optim_loss: 6010935.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9543; val_auprc_score: 0.9393; val_best_acc_score: 0.8930; val_best_f1_score: 0.8976; train_kl_reg_loss: 85016.7561; train_edge_recon_loss: 2770858.2778; train_gene_expr_recon_loss: 2115567.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974970.4931; train_global_loss: 5946413.5556; train_optim_loss: 5946413.5556; val_kl_reg_loss: 82476.4531; val_edge_recon_loss: 2783835.2500; val_gene_expr_recon_loss: 2169311.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982237.6250; val_global_loss: 6017861.0000; val_optim_loss: 6017861.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9565; val_auprc_score: 0.9413; val_best_acc_score: 0.8984; val_best_f1_score: 0.9038; train_kl_reg_loss: 82283.0382; train_edge_recon_loss: 2747543.9167; train_gene_expr_recon_loss: 2113422.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971375.1875; train_global_loss: 5914624.3333; train_optim_loss: 5914624.3333; val_kl_reg_loss: 81233.0938; val_edge_recon_loss: 2757621.0000; val_gene_expr_recon_loss: 2169271.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982482.4375; val_global_loss: 5990607.5000; val_optim_loss: 5990607.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9601; val_auprc_score: 0.9434; val_best_acc_score: 0.9045; val_best_f1_score: 0.9078; train_kl_reg_loss: 99833.1866; train_edge_recon_loss: 2860970.8611; train_gene_expr_recon_loss: 2158780.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976012.4097; train_global_loss: 6095596.6667; train_optim_loss: 6095596.6667; val_kl_reg_loss: 34962.9453; val_edge_recon_loss: 2807847.2500; val_gene_expr_recon_loss: 2218269.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988995.4375; val_global_loss: 6050075.0000; val_optim_loss: 6050075.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9612; val_auprc_score: 0.9478; val_best_acc_score: 0.9064; val_best_f1_score: 0.9107; train_kl_reg_loss: 106412.1649; train_edge_recon_loss: 2796327.4722; train_gene_expr_recon_loss: 2151976.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978016.1667; train_global_loss: 6032732.7778; train_optim_loss: 6032732.7778; val_kl_reg_loss: 32218.6367; val_edge_recon_loss: 2810908.2500; val_gene_expr_recon_loss: 2216717.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988401.8125; val_global_loss: 6048246.0000; val_optim_loss: 6048246.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9641; val_auprc_score: 0.9499; val_best_acc_score: 0.9150; val_best_f1_score: 0.9184; train_kl_reg_loss: 91877.0104; train_edge_recon_loss: 2791148.7778; train_gene_expr_recon_loss: 2155383.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979331.6944; train_global_loss: 6017741.4444; train_optim_loss: 6017741.4444; val_kl_reg_loss: 35364.7383; val_edge_recon_loss: 2774637.2500; val_gene_expr_recon_loss: 2210163.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987487.4375; val_global_loss: 6007653.0000; val_optim_loss: 6007653.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9700; val_auprc_score: 0.9579; val_best_acc_score: 0.9184; val_best_f1_score: 0.9212; train_kl_reg_loss: 90168.2760; train_edge_recon_loss: 2766248.3333; train_gene_expr_recon_loss: 2139244.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971212.9236; train_global_loss: 5966873.6667; train_optim_loss: 5966873.6667; val_kl_reg_loss: 35871.2656; val_edge_recon_loss: 2762074.5000; val_gene_expr_recon_loss: 2206726.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987998.3125; val_global_loss: 5992670.5000; val_optim_loss: 5992670.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9673; val_auprc_score: 0.9546; val_best_acc_score: 0.9209; val_best_f1_score: 0.9237; train_kl_reg_loss: 84245.3802; train_edge_recon_loss: 2769975.3611; train_gene_expr_recon_loss: 2137981.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977239.7778; train_global_loss: 5969442.0556; train_optim_loss: 5969442.0556; val_kl_reg_loss: 36248.9141; val_edge_recon_loss: 2765807.2500; val_gene_expr_recon_loss: 2192381.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985103.6250; val_global_loss: 5979541.5000; val_optim_loss: 5979541.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9677; val_auprc_score: 0.9566; val_best_acc_score: 0.9201; val_best_f1_score: 0.9231; train_kl_reg_loss: 84682.5990; train_edge_recon_loss: 2769766.5833; train_gene_expr_recon_loss: 2141711.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977972.3333; train_global_loss: 5974132.8333; train_optim_loss: 5974132.8333; val_kl_reg_loss: 36272.9961; val_edge_recon_loss: 2765281.5000; val_gene_expr_recon_loss: 2196338.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985551.1250; val_global_loss: 5983444.0000; val_optim_loss: 5983444.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9664; val_auprc_score: 0.9560; val_best_acc_score: 0.9161; val_best_f1_score: 0.9194; train_kl_reg_loss: 83767.2708; train_edge_recon_loss: 2760759.3889; train_gene_expr_recon_loss: 2152944.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982042.4097; train_global_loss: 5979513.7222; train_optim_loss: 5979513.7222; val_kl_reg_loss: 36685.9219; val_edge_recon_loss: 2785406.5000; val_gene_expr_recon_loss: 2197882.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985775.3125; val_global_loss: 6005750.5000; val_optim_loss: 6005750.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9668; val_auprc_score: 0.9557; val_best_acc_score: 0.9181; val_best_f1_score: 0.9211; train_kl_reg_loss: 83023.5182; train_edge_recon_loss: 2756960.4167; train_gene_expr_recon_loss: 2130961.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975244.3958; train_global_loss: 5946189.5556; train_optim_loss: 5946189.5556; val_kl_reg_loss: 37071.7422; val_edge_recon_loss: 2792717.2500; val_gene_expr_recon_loss: 2189952.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984139.0000; val_global_loss: 6003881.0000; val_optim_loss: 6003881.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9660; val_auprc_score: 0.9531; val_best_acc_score: 0.9174; val_best_f1_score: 0.9206; train_kl_reg_loss: 82888.2786; train_edge_recon_loss: 2756822.0278; train_gene_expr_recon_loss: 2141302.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977137.4375; train_global_loss: 5958150.6667; train_optim_loss: 5958150.6667; val_kl_reg_loss: 36929.5820; val_edge_recon_loss: 2762170.5000; val_gene_expr_recon_loss: 2194838.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986486.8750; val_global_loss: 5980425.0000; val_optim_loss: 5980425.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9662; val_auprc_score: 0.9531; val_best_acc_score: 0.9185; val_best_f1_score: 0.9215; train_kl_reg_loss: 82112.1918; train_edge_recon_loss: 2762043.8056; train_gene_expr_recon_loss: 2144375.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976295.2222; train_global_loss: 5964826.1667; train_optim_loss: 5964826.1667; val_kl_reg_loss: 36765.4844; val_edge_recon_loss: 2770375.2500; val_gene_expr_recon_loss: 2195426.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985639.0625; val_global_loss: 5988206.0000; val_optim_loss: 5988206.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9672; val_auprc_score: 0.9535; val_best_acc_score: 0.9184; val_best_f1_score: 0.9214; train_kl_reg_loss: 82299.7561; train_edge_recon_loss: 2759086.0833; train_gene_expr_recon_loss: 2148993.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977813.0625; train_global_loss: 5968192.1667; train_optim_loss: 5968192.1667; val_kl_reg_loss: 36848.8359; val_edge_recon_loss: 2757695.5000; val_gene_expr_recon_loss: 2194366.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984619.0625; val_global_loss: 5973529.5000; val_optim_loss: 5973529.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9655; val_auprc_score: 0.9526; val_best_acc_score: 0.9163; val_best_f1_score: 0.9196; train_kl_reg_loss: 82273.9635; train_edge_recon_loss: 2758148.0833; train_gene_expr_recon_loss: 2140719.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974020.2014; train_global_loss: 5955161.5000; train_optim_loss: 5955161.5000; val_kl_reg_loss: 36753.1172; val_edge_recon_loss: 2787969.5000; val_gene_expr_recon_loss: 2192248.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983734.5000; val_global_loss: 6000705.5000; val_optim_loss: 6000705.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9670; val_auprc_score: 0.9534; val_best_acc_score: 0.9186; val_best_f1_score: 0.9216; train_kl_reg_loss: 81774.9618; train_edge_recon_loss: 2759559.5833; train_gene_expr_recon_loss: 2134496.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970245.7778; train_global_loss: 5946076.2778; train_optim_loss: 5946076.2778; val_kl_reg_loss: 36905.5625; val_edge_recon_loss: 2770170.2500; val_gene_expr_recon_loss: 2192933.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983364.5625; val_global_loss: 5983374.0000; val_optim_loss: 5983374.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9683; val_auprc_score: 0.9574; val_best_acc_score: 0.9182; val_best_f1_score: 0.9222; train_kl_reg_loss: 81759.5217; train_edge_recon_loss: 2759695.3889; train_gene_expr_recon_loss: 2138532.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975763.3333; train_global_loss: 5955750.7222; train_optim_loss: 5955750.7222; val_kl_reg_loss: 37175.2148; val_edge_recon_loss: 2755326.0000; val_gene_expr_recon_loss: 2194949.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984923.1250; val_global_loss: 5972374.0000; val_optim_loss: 5972374.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9648; val_auprc_score: 0.9494; val_best_acc_score: 0.9120; val_best_f1_score: 0.9152; train_kl_reg_loss: 81912.8064; train_edge_recon_loss: 2756141.4722; train_gene_expr_recon_loss: 2146665.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977310.6181; train_global_loss: 5962030.7778; train_optim_loss: 5962030.7778; val_kl_reg_loss: 37057.2188; val_edge_recon_loss: 2797839.0000; val_gene_expr_recon_loss: 2193003.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984468.3125; val_global_loss: 6012368.5000; val_optim_loss: 6012368.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9649; val_auprc_score: 0.9492; val_best_acc_score: 0.9150; val_best_f1_score: 0.9184; train_kl_reg_loss: 81831.3776; train_edge_recon_loss: 2760474.2778; train_gene_expr_recon_loss: 2134601.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976360.3681; train_global_loss: 5953267.3889; train_optim_loss: 5953267.3889; val_kl_reg_loss: 36999.6719; val_edge_recon_loss: 2760967.5000; val_gene_expr_recon_loss: 2193712.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985070.3125; val_global_loss: 5976750.5000; val_optim_loss: 5976750.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9672; val_auprc_score: 0.9531; val_best_acc_score: 0.9194; val_best_f1_score: 0.9223; train_kl_reg_loss: 81847.4740; train_edge_recon_loss: 2760146.4167; train_gene_expr_recon_loss: 2131807.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973433.6319; train_global_loss: 5947235.3889; train_optim_loss: 5947235.3889; val_kl_reg_loss: 37004.8242; val_edge_recon_loss: 2770569.0000; val_gene_expr_recon_loss: 2191982.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984133.7500; val_global_loss: 5983690.0000; val_optim_loss: 5983690.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9693; val_auprc_score: 0.9580; val_best_acc_score: 0.9184; val_best_f1_score: 0.9221; train_kl_reg_loss: 81914.4227; train_edge_recon_loss: 2766039.1944; train_gene_expr_recon_loss: 2136504.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970423.2083; train_global_loss: 5954881.6111; train_optim_loss: 5954881.6111; val_kl_reg_loss: 36839.0234; val_edge_recon_loss: 2771446.7500; val_gene_expr_recon_loss: 2192615.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984666.1875; val_global_loss: 5985567.5000; val_optim_loss: 5985567.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9675; val_auprc_score: 0.9558; val_best_acc_score: 0.9192; val_best_f1_score: 0.9221; train_kl_reg_loss: 81586.8854; train_edge_recon_loss: 2753993.5556; train_gene_expr_recon_loss: 2132945.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973243.6806; train_global_loss: 5941769.1667; train_optim_loss: 5941769.1667; val_kl_reg_loss: 36773.2109; val_edge_recon_loss: 2765610.5000; val_gene_expr_recon_loss: 2192362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984732.3750; val_global_loss: 5979478.5000; val_optim_loss: 5979478.5000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9690; val_auprc_score: 0.9596; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 81792.6285; train_edge_recon_loss: 2762769.3333; train_gene_expr_recon_loss: 2138115.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976895.6111; train_global_loss: 5959573.5556; train_optim_loss: 5959573.5556; val_kl_reg_loss: 36434.3242; val_edge_recon_loss: 2761602.0000; val_gene_expr_recon_loss: 2190365.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984069.3125; val_global_loss: 5972471.0000; val_optim_loss: 5972471.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9685; val_auprc_score: 0.9587; val_best_acc_score: 0.9182; val_best_f1_score: 0.9213; train_kl_reg_loss: 82138.9123; train_edge_recon_loss: 2762977.3056; train_gene_expr_recon_loss: 2141370.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975405.2431; train_global_loss: 5961892.3333; train_optim_loss: 5961892.3333; val_kl_reg_loss: 36519.9297; val_edge_recon_loss: 2775409.2500; val_gene_expr_recon_loss: 2194189.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985779.8750; val_global_loss: 5991899.0000; val_optim_loss: 5991899.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9692; val_auprc_score: 0.9572; val_best_acc_score: 0.9178; val_best_f1_score: 0.9209; train_kl_reg_loss: 81921.2578; train_edge_recon_loss: 2767086.4722; train_gene_expr_recon_loss: 2141767.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980756.6667; train_global_loss: 5971532.0556; train_optim_loss: 5971532.0556; val_kl_reg_loss: 36338.8984; val_edge_recon_loss: 2779609.0000; val_gene_expr_recon_loss: 2192402.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984720.0625; val_global_loss: 5993070.0000; val_optim_loss: 5993070.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 51 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9683
Val AUPRC score: 0.9572
Val best accuracy score: 0.9184
Val best F1 score: 0.9214
Val gene expr MSE score: 0.5749
Val chrom access MSE score: 0.0885
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
