[True]
Run timestamp: 10082023_205635_47.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_47']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6792; val_auprc_score: 0.7267; val_best_acc_score: 0.5016; val_best_f1_score: 0.6670; train_kl_reg_loss: 97718.3903; train_edge_recon_loss: 3706303.2824; train_gene_expr_recon_loss: 27125001.8015; train_masked_gp_l1_reg_loss: 80201.8541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241804.2128; train_chrom_access_recon_loss: 6816412.1107; train_global_loss: 38067441.8015; train_optim_loss: 38067441.8015; val_kl_reg_loss: 61460.2982; val_edge_recon_loss: 4065219.6833; val_gene_expr_recon_loss: 23656190.5333; val_masked_gp_l1_reg_loss: 83865.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233478.2969; val_chrom_access_recon_loss: 6415762.1667; val_global_loss: 34515976.1333; val_optim_loss: 34515976.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7511; val_auprc_score: 0.7796; val_best_acc_score: 0.5453; val_best_f1_score: 0.6835; train_kl_reg_loss: 150568.7990; train_edge_recon_loss: 3611584.2519; train_gene_expr_recon_loss: 22961817.2824; train_masked_gp_l1_reg_loss: 80400.8123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222830.9701; train_chrom_access_recon_loss: 6418199.2824; train_global_loss: 33445401.5420; train_optim_loss: 33445401.5420; val_kl_reg_loss: 158856.6969; val_edge_recon_loss: 4062694.8500; val_gene_expr_recon_loss: 22268984.0000; val_masked_gp_l1_reg_loss: 77809.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211573.9531; val_chrom_access_recon_loss: 6252941.2667; val_global_loss: 33032860.6667; val_optim_loss: 33032860.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8226; val_auprc_score: 0.8329; val_best_acc_score: 0.7216; val_best_f1_score: 0.7466; train_kl_reg_loss: 157811.0339; train_edge_recon_loss: 3552259.8626; train_gene_expr_recon_loss: 22254888.8702; train_masked_gp_l1_reg_loss: 76124.3090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200601.5559; train_chrom_access_recon_loss: 6321960.5000; train_global_loss: 32563646.0611; train_optim_loss: 32563646.0611; val_kl_reg_loss: 144990.5854; val_edge_recon_loss: 4040511.3333; val_gene_expr_recon_loss: 22037400.4000; val_masked_gp_l1_reg_loss: 75651.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189856.7188; val_chrom_access_recon_loss: 6224927.0333; val_global_loss: 32713337.2000; val_optim_loss: 32713337.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8963; val_auprc_score: 0.8877; val_best_acc_score: 0.8211; val_best_f1_score: 0.8328; train_kl_reg_loss: 134403.3118; train_edge_recon_loss: 3511612.4027; train_gene_expr_recon_loss: 22018730.4122; train_masked_gp_l1_reg_loss: 76996.1180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180234.0966; train_chrom_access_recon_loss: 6284168.4046; train_global_loss: 32206144.6107; train_optim_loss: 32206144.6107; val_kl_reg_loss: 108888.4688; val_edge_recon_loss: 3541939.0667; val_gene_expr_recon_loss: 21778830.4000; val_masked_gp_l1_reg_loss: 78979.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171074.2500; val_chrom_access_recon_loss: 6165380.1667; val_global_loss: 31845092.2667; val_optim_loss: 31845092.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8868; val_auprc_score: 0.8734; val_best_acc_score: 0.7978; val_best_f1_score: 0.8201; train_kl_reg_loss: 136001.9460; train_edge_recon_loss: 3124010.7004; train_gene_expr_recon_loss: 21902451.6794; train_masked_gp_l1_reg_loss: 82389.7389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163751.9891; train_chrom_access_recon_loss: 6263875.0305; train_global_loss: 31672481.0840; train_optim_loss: 31672481.0840; val_kl_reg_loss: 153592.1979; val_edge_recon_loss: 3008462.9333; val_gene_expr_recon_loss: 21668664.5333; val_masked_gp_l1_reg_loss: 85194.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157237.6250; val_chrom_access_recon_loss: 6156336.3667; val_global_loss: 31229488.0000; val_optim_loss: 31229488.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9062; val_auprc_score: 0.8871; val_best_acc_score: 0.8252; val_best_f1_score: 0.8378; train_kl_reg_loss: 158907.1425; train_edge_recon_loss: 2956033.0706; train_gene_expr_recon_loss: 21716392.3206; train_masked_gp_l1_reg_loss: 85408.9454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151233.7595; train_chrom_access_recon_loss: 6231738.8282; train_global_loss: 31299714.0916; train_optim_loss: 31299714.0916; val_kl_reg_loss: 149493.5417; val_edge_recon_loss: 2957377.5333; val_gene_expr_recon_loss: 21481264.9333; val_masked_gp_l1_reg_loss: 86329.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145187.8281; val_chrom_access_recon_loss: 6120241.7333; val_global_loss: 30939896.1333; val_optim_loss: 30939896.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9121; val_auprc_score: 0.8971; val_best_acc_score: 0.8335; val_best_f1_score: 0.8471; train_kl_reg_loss: 156572.5497; train_edge_recon_loss: 2923246.1718; train_gene_expr_recon_loss: 21551475.0840; train_masked_gp_l1_reg_loss: 87341.8994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139408.4474; train_chrom_access_recon_loss: 6196047.2863; train_global_loss: 31054091.3130; train_optim_loss: 31054091.3130; val_kl_reg_loss: 151641.2104; val_edge_recon_loss: 2920164.0000; val_gene_expr_recon_loss: 21396899.4667; val_masked_gp_l1_reg_loss: 88826.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133717.2656; val_chrom_access_recon_loss: 6089566.8000; val_global_loss: 30780815.3333; val_optim_loss: 30780815.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9189; val_auprc_score: 0.9034; val_best_acc_score: 0.8477; val_best_f1_score: 0.8588; train_kl_reg_loss: 153006.0358; train_edge_recon_loss: 2897796.1202; train_gene_expr_recon_loss: 21465223.4962; train_masked_gp_l1_reg_loss: 89693.3949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128504.2345; train_chrom_access_recon_loss: 6174947.8282; train_global_loss: 30909171.0382; train_optim_loss: 30909171.0382; val_kl_reg_loss: 147224.3760; val_edge_recon_loss: 2908845.3167; val_gene_expr_recon_loss: 21282410.1333; val_masked_gp_l1_reg_loss: 91341.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123501.4531; val_chrom_access_recon_loss: 6086791.5000; val_global_loss: 30640115.0667; val_optim_loss: 30640115.0667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9274; val_auprc_score: 0.9143; val_best_acc_score: 0.8533; val_best_f1_score: 0.8633; train_kl_reg_loss: 144908.5191; train_edge_recon_loss: 2888969.3302; train_gene_expr_recon_loss: 21420047.1450; train_masked_gp_l1_reg_loss: 91967.5148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119303.1952; train_chrom_access_recon_loss: 6160142.2099; train_global_loss: 30825337.8626; train_optim_loss: 30825337.8626; val_kl_reg_loss: 149416.5021; val_edge_recon_loss: 2851161.5000; val_gene_expr_recon_loss: 21201051.2000; val_masked_gp_l1_reg_loss: 92670.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114524.8750; val_chrom_access_recon_loss: 6078817.4000; val_global_loss: 30487640.8000; val_optim_loss: 30487640.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9348; val_auprc_score: 0.9234; val_best_acc_score: 0.8642; val_best_f1_score: 0.8714; train_kl_reg_loss: 147582.4046; train_edge_recon_loss: 2862390.7615; train_gene_expr_recon_loss: 21275027.9695; train_masked_gp_l1_reg_loss: 93632.9230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110338.2058; train_chrom_access_recon_loss: 6141276.9466; train_global_loss: 30630249.1603; train_optim_loss: 30630249.1603; val_kl_reg_loss: 148668.4427; val_edge_recon_loss: 2852241.4500; val_gene_expr_recon_loss: 21059592.2667; val_masked_gp_l1_reg_loss: 94579.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106495.7891; val_chrom_access_recon_loss: 6033093.3667; val_global_loss: 30294671.2000; val_optim_loss: 30294671.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9379; val_auprc_score: 0.9269; val_best_acc_score: 0.8672; val_best_f1_score: 0.8742; train_kl_reg_loss: 143251.9123; train_edge_recon_loss: 2840564.2805; train_gene_expr_recon_loss: 21216358.5038; train_masked_gp_l1_reg_loss: 95467.2519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103218.0212; train_chrom_access_recon_loss: 6130338.4160; train_global_loss: 30529198.4122; train_optim_loss: 30529198.4122; val_kl_reg_loss: 144925.2906; val_edge_recon_loss: 2839072.6333; val_gene_expr_recon_loss: 21027717.2000; val_masked_gp_l1_reg_loss: 96451.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100099.9297; val_chrom_access_recon_loss: 6023818.3333; val_global_loss: 30232085.0667; val_optim_loss: 30232085.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9391; val_auprc_score: 0.9256; val_best_acc_score: 0.8700; val_best_f1_score: 0.8762; train_kl_reg_loss: 138211.5633; train_edge_recon_loss: 2831068.9561; train_gene_expr_recon_loss: 21159424.6565; train_masked_gp_l1_reg_loss: 97404.8671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97184.0453; train_chrom_access_recon_loss: 6119740.0153; train_global_loss: 30443034.0305; train_optim_loss: 30443034.0305; val_kl_reg_loss: 135607.0703; val_edge_recon_loss: 2840085.2500; val_gene_expr_recon_loss: 21018421.7333; val_masked_gp_l1_reg_loss: 98333.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94210.7344; val_chrom_access_recon_loss: 6019269.6000; val_global_loss: 30205927.8667; val_optim_loss: 30205927.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9442; val_auprc_score: 0.9305; val_best_acc_score: 0.8783; val_best_f1_score: 0.8854; train_kl_reg_loss: 133064.9400; train_edge_recon_loss: 2824385.9752; train_gene_expr_recon_loss: 21103896.1832; train_masked_gp_l1_reg_loss: 99268.2872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91500.5036; train_chrom_access_recon_loss: 6107696.1832; train_global_loss: 30359812.0763; train_optim_loss: 30359812.0763; val_kl_reg_loss: 131795.2724; val_edge_recon_loss: 2811101.8500; val_gene_expr_recon_loss: 20881870.2667; val_masked_gp_l1_reg_loss: 100018.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88742.0078; val_chrom_access_recon_loss: 5989532.9333; val_global_loss: 30003060.8000; val_optim_loss: 30003060.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9473; val_auprc_score: 0.9346; val_best_acc_score: 0.8798; val_best_f1_score: 0.8852; train_kl_reg_loss: 129704.9650; train_edge_recon_loss: 2814755.8454; train_gene_expr_recon_loss: 21019975.1298; train_masked_gp_l1_reg_loss: 100867.1030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86152.0428; train_chrom_access_recon_loss: 6086233.0534; train_global_loss: 30237688.0916; train_optim_loss: 30237688.0916; val_kl_reg_loss: 127292.1286; val_edge_recon_loss: 2822439.1167; val_gene_expr_recon_loss: 20833317.6000; val_masked_gp_l1_reg_loss: 101984.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83603.7734; val_chrom_access_recon_loss: 5995568.1000; val_global_loss: 29964204.9333; val_optim_loss: 29964204.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9556; val_auprc_score: 0.9465; val_best_acc_score: 0.8891; val_best_f1_score: 0.8933; train_kl_reg_loss: 125752.1126; train_edge_recon_loss: 2804608.5210; train_gene_expr_recon_loss: 20988016.8092; train_masked_gp_l1_reg_loss: 102749.0112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81220.8968; train_chrom_access_recon_loss: 6082127.6756; train_global_loss: 30184475.0687; train_optim_loss: 30184475.0687; val_kl_reg_loss: 125600.3911; val_edge_recon_loss: 2796849.7500; val_gene_expr_recon_loss: 20800702.2667; val_masked_gp_l1_reg_loss: 103642.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78922.5469; val_chrom_access_recon_loss: 5978431.8000; val_global_loss: 29884148.1333; val_optim_loss: 29884148.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9538; val_auprc_score: 0.9443; val_best_acc_score: 0.8878; val_best_f1_score: 0.8926; train_kl_reg_loss: 124598.2460; train_edge_recon_loss: 2790758.0859; train_gene_expr_recon_loss: 20929977.2519; train_masked_gp_l1_reg_loss: 104414.0390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76791.9455; train_chrom_access_recon_loss: 6068394.2863; train_global_loss: 30094933.7252; train_optim_loss: 30094933.7252; val_kl_reg_loss: 124171.5693; val_edge_recon_loss: 2809547.2667; val_gene_expr_recon_loss: 20700904.4000; val_masked_gp_l1_reg_loss: 105370.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74789.5000; val_chrom_access_recon_loss: 5963617.5333; val_global_loss: 29778400.6667; val_optim_loss: 29778400.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9480; val_best_acc_score: 0.8890; val_best_f1_score: 0.8945; train_kl_reg_loss: 124163.6342; train_edge_recon_loss: 2788401.2271; train_gene_expr_recon_loss: 20907518.9771; train_masked_gp_l1_reg_loss: 106018.4289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72918.9925; train_chrom_access_recon_loss: 6066395.9046; train_global_loss: 30065417.1450; train_optim_loss: 30065417.1450; val_kl_reg_loss: 121365.8750; val_edge_recon_loss: 2801641.8167; val_gene_expr_recon_loss: 20819170.4000; val_masked_gp_l1_reg_loss: 106883.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71068.9922; val_chrom_access_recon_loss: 5989482.0000; val_global_loss: 29909612.1333; val_optim_loss: 29909612.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9615; val_auprc_score: 0.9537; val_best_acc_score: 0.9018; val_best_f1_score: 0.9043; train_kl_reg_loss: 119922.8885; train_edge_recon_loss: 2777008.8435; train_gene_expr_recon_loss: 20893763.3130; train_masked_gp_l1_reg_loss: 107641.3607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69374.5048; train_chrom_access_recon_loss: 6066932.7595; train_global_loss: 30034643.7863; train_optim_loss: 30034643.7863; val_kl_reg_loss: 119179.2047; val_edge_recon_loss: 2787813.8500; val_gene_expr_recon_loss: 20702673.6000; val_masked_gp_l1_reg_loss: 108688.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67786.0703; val_chrom_access_recon_loss: 5981005.9667; val_global_loss: 29767146.8000; val_optim_loss: 29767146.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9652; val_auprc_score: 0.9580; val_best_acc_score: 0.9093; val_best_f1_score: 0.9110; train_kl_reg_loss: 117671.3548; train_edge_recon_loss: 2772706.4695; train_gene_expr_recon_loss: 20854153.9847; train_masked_gp_l1_reg_loss: 109336.1102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66182.4530; train_chrom_access_recon_loss: 6057550.0649; train_global_loss: 29977600.4733; train_optim_loss: 29977600.4733; val_kl_reg_loss: 115692.7911; val_edge_recon_loss: 2778947.4500; val_gene_expr_recon_loss: 20735564.9333; val_masked_gp_l1_reg_loss: 110114.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64657.9297; val_chrom_access_recon_loss: 5983078.1667; val_global_loss: 29788055.3333; val_optim_loss: 29788055.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9635; val_auprc_score: 0.9523; val_best_acc_score: 0.9025; val_best_f1_score: 0.9050; train_kl_reg_loss: 117391.2492; train_edge_recon_loss: 2755009.9809; train_gene_expr_recon_loss: 20812647.6794; train_masked_gp_l1_reg_loss: 110810.2844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63274.7505; train_chrom_access_recon_loss: 6048004.8130; train_global_loss: 29907138.6718; train_optim_loss: 29907138.6718; val_kl_reg_loss: 115672.6474; val_edge_recon_loss: 2777569.2667; val_gene_expr_recon_loss: 20708868.0000; val_masked_gp_l1_reg_loss: 111514.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61835.3438; val_chrom_access_recon_loss: 5980103.6000; val_global_loss: 29755563.3333; val_optim_loss: 29755563.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9689; val_auprc_score: 0.9617; val_best_acc_score: 0.9097; val_best_f1_score: 0.9130; train_kl_reg_loss: 115570.1412; train_edge_recon_loss: 2754616.8989; train_gene_expr_recon_loss: 20763480.0763; train_masked_gp_l1_reg_loss: 112292.9258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60598.0403; train_chrom_access_recon_loss: 6038509.8244; train_global_loss: 29845067.9389; train_optim_loss: 29845067.9389; val_kl_reg_loss: 116279.3370; val_edge_recon_loss: 2747801.3833; val_gene_expr_recon_loss: 20630470.0000; val_masked_gp_l1_reg_loss: 113158.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59430.9922; val_chrom_access_recon_loss: 5959651.6667; val_global_loss: 29626790.4000; val_optim_loss: 29626790.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9687; val_auprc_score: 0.9606; val_best_acc_score: 0.9167; val_best_f1_score: 0.9195; train_kl_reg_loss: 114173.8341; train_edge_recon_loss: 2747910.3779; train_gene_expr_recon_loss: 20755956.0916; train_masked_gp_l1_reg_loss: 113773.1854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58264.2366; train_chrom_access_recon_loss: 6034875.3740; train_global_loss: 29824953.0840; train_optim_loss: 29824953.0840; val_kl_reg_loss: 113059.8516; val_edge_recon_loss: 2754019.6667; val_gene_expr_recon_loss: 20663971.4667; val_masked_gp_l1_reg_loss: 114623.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57147.3203; val_chrom_access_recon_loss: 5951786.7000; val_global_loss: 29654609.8667; val_optim_loss: 29654609.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9702; val_auprc_score: 0.9618; val_best_acc_score: 0.9219; val_best_f1_score: 0.9235; train_kl_reg_loss: 113235.7520; train_edge_recon_loss: 2745075.0210; train_gene_expr_recon_loss: 20712079.1145; train_masked_gp_l1_reg_loss: 115259.3822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56171.6344; train_chrom_access_recon_loss: 6023631.6679; train_global_loss: 29765452.6565; train_optim_loss: 29765452.6565; val_kl_reg_loss: 111284.3698; val_edge_recon_loss: 2750917.1333; val_gene_expr_recon_loss: 20503779.8667; val_masked_gp_l1_reg_loss: 115940.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55204.1367; val_chrom_access_recon_loss: 5909258.3000; val_global_loss: 29446383.6000; val_optim_loss: 29446383.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9703; val_auprc_score: 0.9634; val_best_acc_score: 0.9189; val_best_f1_score: 0.9209; train_kl_reg_loss: 111112.1922; train_edge_recon_loss: 2740007.6374; train_gene_expr_recon_loss: 20692464.5191; train_masked_gp_l1_reg_loss: 116609.3737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54289.0059; train_chrom_access_recon_loss: 6022010.4313; train_global_loss: 29736493.0534; train_optim_loss: 29736493.0534; val_kl_reg_loss: 110879.3151; val_edge_recon_loss: 2763225.8167; val_gene_expr_recon_loss: 20576676.6667; val_masked_gp_l1_reg_loss: 117481.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53473.2617; val_chrom_access_recon_loss: 5940604.8667; val_global_loss: 29562342.5333; val_optim_loss: 29562342.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9723; val_auprc_score: 0.9651; val_best_acc_score: 0.9182; val_best_f1_score: 0.9202; train_kl_reg_loss: 109767.4184; train_edge_recon_loss: 2738732.1469; train_gene_expr_recon_loss: 20650450.1374; train_masked_gp_l1_reg_loss: 118047.5397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52635.3069; train_chrom_access_recon_loss: 6013980.0992; train_global_loss: 29683612.4122; train_optim_loss: 29683612.4122; val_kl_reg_loss: 108675.5714; val_edge_recon_loss: 2741669.1333; val_gene_expr_recon_loss: 20481680.5333; val_masked_gp_l1_reg_loss: 118755.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51800.3789; val_chrom_access_recon_loss: 5902650.8333; val_global_loss: 29405231.8667; val_optim_loss: 29405231.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9649; val_auprc_score: 0.9543; val_best_acc_score: 0.9123; val_best_f1_score: 0.9145; train_kl_reg_loss: 125414.4675; train_edge_recon_loss: 2890741.4866; train_gene_expr_recon_loss: 22358186.1069; train_masked_gp_l1_reg_loss: 121093.9488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54047.1625; train_chrom_access_recon_loss: 6198318.1450; train_global_loss: 31747801.4046; train_optim_loss: 31747801.4046; val_kl_reg_loss: 33386.5280; val_edge_recon_loss: 2826992.6167; val_gene_expr_recon_loss: 21904444.1333; val_masked_gp_l1_reg_loss: 122417.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53630.9648; val_chrom_access_recon_loss: 6074720.3667; val_global_loss: 31015591.6000; val_optim_loss: 31015591.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9635; val_auprc_score: 0.9565; val_best_acc_score: 0.9054; val_best_f1_score: 0.9088; train_kl_reg_loss: 111447.3038; train_edge_recon_loss: 2781217.6851; train_gene_expr_recon_loss: 22001384.2137; train_masked_gp_l1_reg_loss: 122265.0273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52369.8411; train_chrom_access_recon_loss: 6154109.2366; train_global_loss: 31222793.3282; train_optim_loss: 31222793.3282; val_kl_reg_loss: 38649.1904; val_edge_recon_loss: 2801138.1833; val_gene_expr_recon_loss: 21752070.0000; val_masked_gp_l1_reg_loss: 121911.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51165.8594; val_chrom_access_recon_loss: 6013494.5000; val_global_loss: 30778429.7333; val_optim_loss: 30778429.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9566; val_auprc_score: 0.9442; val_best_acc_score: 0.9008; val_best_f1_score: 0.9049; train_kl_reg_loss: 100777.1711; train_edge_recon_loss: 2792104.8263; train_gene_expr_recon_loss: 22211892.6107; train_masked_gp_l1_reg_loss: 122031.7755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50683.9256; train_chrom_access_recon_loss: 6235075.9046; train_global_loss: 31512566.1985; train_optim_loss: 31512566.1985; val_kl_reg_loss: 39608.3242; val_edge_recon_loss: 2792854.2000; val_gene_expr_recon_loss: 22318333.7333; val_masked_gp_l1_reg_loss: 122242.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50485.0273; val_chrom_access_recon_loss: 6162450.0333; val_global_loss: 31485974.4000; val_optim_loss: 31485974.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9597; val_auprc_score: 0.9500; val_best_acc_score: 0.8989; val_best_f1_score: 0.9038; train_kl_reg_loss: 94234.7486; train_edge_recon_loss: 2771041.8989; train_gene_expr_recon_loss: 22740706.3511; train_masked_gp_l1_reg_loss: 121888.8544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50208.3118; train_chrom_access_recon_loss: 6261123.6679; train_global_loss: 32039203.8168; train_optim_loss: 32039203.8168; val_kl_reg_loss: 34403.1742; val_edge_recon_loss: 2771853.6333; val_gene_expr_recon_loss: 23127803.0667; val_masked_gp_l1_reg_loss: 121330.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49772.9766; val_chrom_access_recon_loss: 6199420.0333; val_global_loss: 32304582.1333; val_optim_loss: 32304582.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9576; val_auprc_score: 0.9446; val_best_acc_score: 0.8998; val_best_f1_score: 0.9036; train_kl_reg_loss: 97283.0184; train_edge_recon_loss: 2773093.9599; train_gene_expr_recon_loss: 23260723.8626; train_masked_gp_l1_reg_loss: 120933.3073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49653.4778; train_chrom_access_recon_loss: 6277095.5344; train_global_loss: 32578783.2061; train_optim_loss: 32578783.2061; val_kl_reg_loss: 35189.4724; val_edge_recon_loss: 2786821.3167; val_gene_expr_recon_loss: 23043215.7333; val_masked_gp_l1_reg_loss: 120748.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49540.1094; val_chrom_access_recon_loss: 6180546.3000; val_global_loss: 32216061.0667; val_optim_loss: 32216061.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9564; val_auprc_score: 0.9395; val_best_acc_score: 0.9020; val_best_f1_score: 0.9058; train_kl_reg_loss: 96219.9647; train_edge_recon_loss: 2762166.9828; train_gene_expr_recon_loss: 23282245.4198; train_masked_gp_l1_reg_loss: 120582.9963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49428.2787; train_chrom_access_recon_loss: 6281994.0878; train_global_loss: 32592637.8473; train_optim_loss: 32592637.8473; val_kl_reg_loss: 33905.7030; val_edge_recon_loss: 2769140.7500; val_gene_expr_recon_loss: 23060678.5333; val_masked_gp_l1_reg_loss: 120405.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49309.6953; val_chrom_access_recon_loss: 6162383.9333; val_global_loss: 32195824.6667; val_optim_loss: 32195824.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9595; val_auprc_score: 0.9455; val_best_acc_score: 0.9058; val_best_f1_score: 0.9094; train_kl_reg_loss: 93976.0279; train_edge_recon_loss: 2756073.5134; train_gene_expr_recon_loss: 23296839.2977; train_masked_gp_l1_reg_loss: 120212.3986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49187.1069; train_chrom_access_recon_loss: 6284434.3664; train_global_loss: 32600722.8550; train_optim_loss: 32600722.8550; val_kl_reg_loss: 34700.8284; val_edge_recon_loss: 2777535.3500; val_gene_expr_recon_loss: 23156807.3333; val_masked_gp_l1_reg_loss: 120017.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49051.9414; val_chrom_access_recon_loss: 6195670.1000; val_global_loss: 32333783.4667; val_optim_loss: 32333783.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9625; val_auprc_score: 0.9529; val_best_acc_score: 0.9080; val_best_f1_score: 0.9114; train_kl_reg_loss: 92038.2535; train_edge_recon_loss: 2752039.6794; train_gene_expr_recon_loss: 23289225.5267; train_masked_gp_l1_reg_loss: 119810.1538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48914.6315; train_chrom_access_recon_loss: 6283658.6832; train_global_loss: 32585686.7176; train_optim_loss: 32585686.7176; val_kl_reg_loss: 35220.6326; val_edge_recon_loss: 2750382.3667; val_gene_expr_recon_loss: 23111245.8667; val_masked_gp_l1_reg_loss: 119592.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48758.7812; val_chrom_access_recon_loss: 6208440.0000; val_global_loss: 32273639.0667; val_optim_loss: 32273639.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 52 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9733
val AUPRC score: 0.9661
val best accuracy score: 0.9241
val best F1 score: 0.9260
val target rna MSE score: 1.3327
val source rna MSE score: 338.3893
val target atac MSE score: 0.5635
val source atac MSE score: 5.1000
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
