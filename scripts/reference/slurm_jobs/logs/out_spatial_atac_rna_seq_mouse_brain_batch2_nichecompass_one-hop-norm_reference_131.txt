[True]
Run timestamp: 07082023_212843_131.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_131']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8634; val_auprc_score: 0.8746; val_best_acc_score: 0.5668; val_best_f1_score: 0.6959; train_kl_reg_loss: 135710.3878; train_edge_recon_loss: 3480030.1389; train_gene_expr_recon_loss: 1283343.4444; train_masked_gp_l1_reg_loss: 8887.3168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119506.2682; train_chrom_access_recon_loss: 2250579.1806; train_global_loss: 7278056.6111; train_optim_loss: 7278056.6111; val_kl_reg_loss: 36506.2266; val_edge_recon_loss: 4060647.7500; val_gene_expr_recon_loss: 1088412.8750; val_masked_gp_l1_reg_loss: 7599.1987; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116895.4297; val_chrom_access_recon_loss: 1611488.1250; val_global_loss: 6921549.5000; val_optim_loss: 6921549.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8554; val_auprc_score: 0.8672; val_best_acc_score: 0.6523; val_best_f1_score: 0.7349; train_kl_reg_loss: 31599.1853; train_edge_recon_loss: 3481551.1667; train_gene_expr_recon_loss: 1065640.4583; train_masked_gp_l1_reg_loss: 7128.0314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115318.8785; train_chrom_access_recon_loss: 1517664.7778; train_global_loss: 6218902.4444; train_optim_loss: 6218902.4444; val_kl_reg_loss: 105963.1562; val_edge_recon_loss: 4053339.2500; val_gene_expr_recon_loss: 980441.5000; val_masked_gp_l1_reg_loss: 6758.2905; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113470.1562; val_chrom_access_recon_loss: 1459645.1250; val_global_loss: 6719617.5000; val_optim_loss: 6719617.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8342; val_auprc_score: 0.8432; val_best_acc_score: 0.7118; val_best_f1_score: 0.7599; train_kl_reg_loss: 46156.7843; train_edge_recon_loss: 3482670.0833; train_gene_expr_recon_loss: 964828.4097; train_masked_gp_l1_reg_loss: 6785.0151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112061.8082; train_chrom_access_recon_loss: 1488360.1528; train_global_loss: 6100862.1667; train_optim_loss: 6100862.1667; val_kl_reg_loss: 16494.7383; val_edge_recon_loss: 4041566.0000; val_gene_expr_recon_loss: 887811.3750; val_masked_gp_l1_reg_loss: 6840.1436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110297.3594; val_chrom_access_recon_loss: 1428119.0000; val_global_loss: 6491128.5000; val_optim_loss: 6491128.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8103; val_auprc_score: 0.8088; val_best_acc_score: 0.7224; val_best_f1_score: 0.7445; train_kl_reg_loss: 26837.3691; train_edge_recon_loss: 3482147.0833; train_gene_expr_recon_loss: 883978.7778; train_masked_gp_l1_reg_loss: 6800.9556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108828.2821; train_chrom_access_recon_loss: 1436013.9028; train_global_loss: 5944606.4444; train_optim_loss: 5944606.4444; val_kl_reg_loss: 25480.5508; val_edge_recon_loss: 4018512.2500; val_gene_expr_recon_loss: 841534.3125; val_masked_gp_l1_reg_loss: 6738.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106915.4844; val_chrom_access_recon_loss: 1392321.2500; val_global_loss: 6391502.0000; val_optim_loss: 6391502.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8061; val_auprc_score: 0.7957; val_best_acc_score: 0.7047; val_best_f1_score: 0.7582; train_kl_reg_loss: 27333.6599; train_edge_recon_loss: 3476566.7222; train_gene_expr_recon_loss: 845437.8472; train_masked_gp_l1_reg_loss: 6708.1251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105234.5104; train_chrom_access_recon_loss: 1398175.2917; train_global_loss: 5859456.2222; train_optim_loss: 5859456.2222; val_kl_reg_loss: 22884.9961; val_edge_recon_loss: 3948698.2500; val_gene_expr_recon_loss: 822988.0000; val_masked_gp_l1_reg_loss: 6672.4370; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103043.1562; val_chrom_access_recon_loss: 1368867.6250; val_global_loss: 6273154.0000; val_optim_loss: 6273154.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8108; val_auprc_score: 0.7906; val_best_acc_score: 0.7385; val_best_f1_score: 0.7746; train_kl_reg_loss: 17641.2352; train_edge_recon_loss: 3452752.7778; train_gene_expr_recon_loss: 826011.9514; train_masked_gp_l1_reg_loss: 6659.3044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101194.8689; train_chrom_access_recon_loss: 1372945.3472; train_global_loss: 5777205.2778; train_optim_loss: 5777205.2778; val_kl_reg_loss: 13391.5928; val_edge_recon_loss: 3702564.5000; val_gene_expr_recon_loss: 807724.5625; val_masked_gp_l1_reg_loss: 6631.4458; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98848.0625; val_chrom_access_recon_loss: 1361246.0000; val_global_loss: 5990406.0000; val_optim_loss: 5990406.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8281; val_auprc_score: 0.8114; val_best_acc_score: 0.7491; val_best_f1_score: 0.7755; train_kl_reg_loss: 10766.4939; train_edge_recon_loss: 3253210.2500; train_gene_expr_recon_loss: 832257.8681; train_masked_gp_l1_reg_loss: 6587.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96920.7743; train_chrom_access_recon_loss: 1377777.4306; train_global_loss: 5577520.3889; train_optim_loss: 5577520.3889; val_kl_reg_loss: 12055.8477; val_edge_recon_loss: 3063680.0000; val_gene_expr_recon_loss: 849978.8750; val_masked_gp_l1_reg_loss: 6502.1968; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94493.3125; val_chrom_access_recon_loss: 1371938.1250; val_global_loss: 5398648.0000; val_optim_loss: 5398648.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8561; val_auprc_score: 0.8445; val_best_acc_score: 0.7661; val_best_f1_score: 0.7904; train_kl_reg_loss: 19393.0480; train_edge_recon_loss: 2950547.3056; train_gene_expr_recon_loss: 843610.6944; train_masked_gp_l1_reg_loss: 6458.9230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92577.6042; train_chrom_access_recon_loss: 1380239.5000; train_global_loss: 5292827.1667; train_optim_loss: 5292827.1667; val_kl_reg_loss: 25918.0742; val_edge_recon_loss: 2915223.5000; val_gene_expr_recon_loss: 815273.1250; val_masked_gp_l1_reg_loss: 6433.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90209.7500; val_chrom_access_recon_loss: 1359586.1250; val_global_loss: 5212644.0000; val_optim_loss: 5212644.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8733; val_auprc_score: 0.8466; val_best_acc_score: 0.8029; val_best_f1_score: 0.8197; train_kl_reg_loss: 32405.2847; train_edge_recon_loss: 2876991.0833; train_gene_expr_recon_loss: 809537.3542; train_masked_gp_l1_reg_loss: 6419.0592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88302.5625; train_chrom_access_recon_loss: 1362467.6111; train_global_loss: 5176123.0000; train_optim_loss: 5176123.0000; val_kl_reg_loss: 35813.5859; val_edge_recon_loss: 2819476.7500; val_gene_expr_recon_loss: 790665.3750; val_masked_gp_l1_reg_loss: 6387.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85909.8047; val_chrom_access_recon_loss: 1349824.7500; val_global_loss: 5088078.0000; val_optim_loss: 5088078.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8870; val_auprc_score: 0.8600; val_best_acc_score: 0.8263; val_best_f1_score: 0.8432; train_kl_reg_loss: 39977.2817; train_edge_recon_loss: 2800295.5278; train_gene_expr_recon_loss: 792843.5694; train_masked_gp_l1_reg_loss: 6365.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84015.1207; train_chrom_access_recon_loss: 1357171.8472; train_global_loss: 5080668.7778; train_optim_loss: 5080668.7778; val_kl_reg_loss: 39744.8203; val_edge_recon_loss: 2792894.2500; val_gene_expr_recon_loss: 771870.8750; val_masked_gp_l1_reg_loss: 6345.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81661.7031; val_chrom_access_recon_loss: 1342534.3750; val_global_loss: 5035052.0000; val_optim_loss: 5035052.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9089; val_auprc_score: 0.8816; val_best_acc_score: 0.8422; val_best_f1_score: 0.8557; train_kl_reg_loss: 42046.6506; train_edge_recon_loss: 2755147.1389; train_gene_expr_recon_loss: 769387.9653; train_masked_gp_l1_reg_loss: 6334.1133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79807.6128; train_chrom_access_recon_loss: 1345324.9028; train_global_loss: 4998048.4444; train_optim_loss: 4998048.4444; val_kl_reg_loss: 40769.6562; val_edge_recon_loss: 2757334.5000; val_gene_expr_recon_loss: 755092.3750; val_masked_gp_l1_reg_loss: 6311.5991; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77500.7734; val_chrom_access_recon_loss: 1336594.7500; val_global_loss: 4973603.5000; val_optim_loss: 4973603.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9195; val_auprc_score: 0.8970; val_best_acc_score: 0.8525; val_best_f1_score: 0.8637; train_kl_reg_loss: 42498.4071; train_edge_recon_loss: 2743687.7222; train_gene_expr_recon_loss: 758343.4444; train_masked_gp_l1_reg_loss: 6304.6476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75675.8021; train_chrom_access_recon_loss: 1345924.2500; train_global_loss: 4972434.3889; train_optim_loss: 4972434.3889; val_kl_reg_loss: 40962.5312; val_edge_recon_loss: 2748940.0000; val_gene_expr_recon_loss: 743953.4375; val_masked_gp_l1_reg_loss: 6299.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73411.5000; val_chrom_access_recon_loss: 1331493.2500; val_global_loss: 4945060.0000; val_optim_loss: 4945060.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9240; val_auprc_score: 0.9047; val_best_acc_score: 0.8565; val_best_f1_score: 0.8666; train_kl_reg_loss: 43750.7361; train_edge_recon_loss: 2736313.8056; train_gene_expr_recon_loss: 746193.6181; train_masked_gp_l1_reg_loss: 6316.0685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71647.3542; train_chrom_access_recon_loss: 1338327.5833; train_global_loss: 4942549.2222; train_optim_loss: 4942549.2222; val_kl_reg_loss: 42112.0273; val_edge_recon_loss: 2779484.5000; val_gene_expr_recon_loss: 735133.7500; val_masked_gp_l1_reg_loss: 6335.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69469.1328; val_chrom_access_recon_loss: 1327135.7500; val_global_loss: 4959670.5000; val_optim_loss: 4959670.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9337; val_auprc_score: 0.9181; val_best_acc_score: 0.8677; val_best_f1_score: 0.8773; train_kl_reg_loss: 44616.3277; train_edge_recon_loss: 2728268.8056; train_gene_expr_recon_loss: 733054.6458; train_masked_gp_l1_reg_loss: 6355.1660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67793.6962; train_chrom_access_recon_loss: 1333115.1667; train_global_loss: 4913203.6667; train_optim_loss: 4913203.6667; val_kl_reg_loss: 43006.5625; val_edge_recon_loss: 2737217.0000; val_gene_expr_recon_loss: 726792.2500; val_masked_gp_l1_reg_loss: 6383.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65736.1094; val_chrom_access_recon_loss: 1323542.7500; val_global_loss: 4902678.0000; val_optim_loss: 4902678.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9400; val_auprc_score: 0.9240; val_best_acc_score: 0.8766; val_best_f1_score: 0.8831; train_kl_reg_loss: 44090.2543; train_edge_recon_loss: 2725065.6389; train_gene_expr_recon_loss: 725815.8889; train_masked_gp_l1_reg_loss: 6399.4638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64156.5573; train_chrom_access_recon_loss: 1335911.4444; train_global_loss: 4901439.2222; train_optim_loss: 4901439.2222; val_kl_reg_loss: 42907.8438; val_edge_recon_loss: 2725617.5000; val_gene_expr_recon_loss: 722276.6250; val_masked_gp_l1_reg_loss: 6416.5869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62226.9062; val_chrom_access_recon_loss: 1320433.5000; val_global_loss: 4879879.0000; val_optim_loss: 4879879.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9434; val_auprc_score: 0.9253; val_best_acc_score: 0.8845; val_best_f1_score: 0.8918; train_kl_reg_loss: 43931.5395; train_edge_recon_loss: 2722970.4444; train_gene_expr_recon_loss: 723077.4722; train_masked_gp_l1_reg_loss: 6436.8030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60763.6484; train_chrom_access_recon_loss: 1327561.4306; train_global_loss: 4884741.3889; train_optim_loss: 4884741.3889; val_kl_reg_loss: 41997.7656; val_edge_recon_loss: 2709868.0000; val_gene_expr_recon_loss: 719712.2500; val_masked_gp_l1_reg_loss: 6461.1035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58979.8359; val_chrom_access_recon_loss: 1317776.2500; val_global_loss: 4854795.0000; val_optim_loss: 4854795.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9443; val_auprc_score: 0.9275; val_best_acc_score: 0.8852; val_best_f1_score: 0.8914; train_kl_reg_loss: 43729.4692; train_edge_recon_loss: 2715772.8056; train_gene_expr_recon_loss: 722122.5139; train_masked_gp_l1_reg_loss: 6489.9897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57633.9397; train_chrom_access_recon_loss: 1328096.5278; train_global_loss: 4873845.1111; train_optim_loss: 4873845.1111; val_kl_reg_loss: 41763.3359; val_edge_recon_loss: 2727608.7500; val_gene_expr_recon_loss: 714353.1250; val_masked_gp_l1_reg_loss: 6522.3774; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55988.0156; val_chrom_access_recon_loss: 1315183.8750; val_global_loss: 4861419.5000; val_optim_loss: 4861419.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9474; val_auprc_score: 0.9304; val_best_acc_score: 0.8855; val_best_f1_score: 0.8930; train_kl_reg_loss: 43084.4162; train_edge_recon_loss: 2706372.6667; train_gene_expr_recon_loss: 717134.5139; train_masked_gp_l1_reg_loss: 6555.2345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54744.5690; train_chrom_access_recon_loss: 1324550.3750; train_global_loss: 4852441.8333; train_optim_loss: 4852441.8333; val_kl_reg_loss: 40703.6328; val_edge_recon_loss: 2728778.0000; val_gene_expr_recon_loss: 710916.5000; val_masked_gp_l1_reg_loss: 6593.3892; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53232.9297; val_chrom_access_recon_loss: 1312631.0000; val_global_loss: 4852856.0000; val_optim_loss: 4852856.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9531; val_auprc_score: 0.9365; val_best_acc_score: 0.8946; val_best_f1_score: 0.9010; train_kl_reg_loss: 42248.7791; train_edge_recon_loss: 2702059.7500; train_gene_expr_recon_loss: 708982.5347; train_masked_gp_l1_reg_loss: 6627.8298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52089.9106; train_chrom_access_recon_loss: 1317474.9444; train_global_loss: 4829483.7222; train_optim_loss: 4829483.7222; val_kl_reg_loss: 40466.2266; val_edge_recon_loss: 2699006.2500; val_gene_expr_recon_loss: 708241.0000; val_masked_gp_l1_reg_loss: 6656.6841; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50694.5352; val_chrom_access_recon_loss: 1310151.3750; val_global_loss: 4815216.0000; val_optim_loss: 4815216.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9595; val_auprc_score: 0.9437; val_best_acc_score: 0.9054; val_best_f1_score: 0.9097; train_kl_reg_loss: 41663.5451; train_edge_recon_loss: 2698741.6389; train_gene_expr_recon_loss: 713636.9444; train_masked_gp_l1_reg_loss: 6679.2326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49632.1571; train_chrom_access_recon_loss: 1321173.6944; train_global_loss: 4831527.1111; train_optim_loss: 4831527.1111; val_kl_reg_loss: 39347.4414; val_edge_recon_loss: 2667692.0000; val_gene_expr_recon_loss: 705028.6250; val_masked_gp_l1_reg_loss: 6703.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48342.0391; val_chrom_access_recon_loss: 1307823.0000; val_global_loss: 4774936.0000; val_optim_loss: 4774936.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9541; val_auprc_score: 0.9367; val_best_acc_score: 0.8953; val_best_f1_score: 0.9001; train_kl_reg_loss: 41127.6836; train_edge_recon_loss: 2703518.2222; train_gene_expr_recon_loss: 707818.2708; train_masked_gp_l1_reg_loss: 6737.0505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47373.6385; train_chrom_access_recon_loss: 1320735.3611; train_global_loss: 4827310.2222; train_optim_loss: 4827310.2222; val_kl_reg_loss: 39317.0781; val_edge_recon_loss: 2728862.7500; val_gene_expr_recon_loss: 699951.8125; val_masked_gp_l1_reg_loss: 6763.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46190.6641; val_chrom_access_recon_loss: 1304631.7500; val_global_loss: 4825718.0000; val_optim_loss: 4825718.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9581; val_auprc_score: 0.9444; val_best_acc_score: 0.9037; val_best_f1_score: 0.9072; train_kl_reg_loss: 41253.4141; train_edge_recon_loss: 2680052.3889; train_gene_expr_recon_loss: 709830.9722; train_masked_gp_l1_reg_loss: 6793.3874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45298.4614; train_chrom_access_recon_loss: 1314571.2222; train_global_loss: 4797799.8333; train_optim_loss: 4797799.8333; val_kl_reg_loss: 39731.0430; val_edge_recon_loss: 2698839.0000; val_gene_expr_recon_loss: 705724.2500; val_masked_gp_l1_reg_loss: 6819.7651; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44197.9336; val_chrom_access_recon_loss: 1303938.7500; val_global_loss: 4799251.0000; val_optim_loss: 4799251.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9650; val_auprc_score: 0.9541; val_best_acc_score: 0.9076; val_best_f1_score: 0.9112; train_kl_reg_loss: 41594.8954; train_edge_recon_loss: 2674875.9444; train_gene_expr_recon_loss: 706813.8194; train_masked_gp_l1_reg_loss: 6856.6941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43376.5482; train_chrom_access_recon_loss: 1312190.8333; train_global_loss: 4785708.6111; train_optim_loss: 4785708.6111; val_kl_reg_loss: 38818.6289; val_edge_recon_loss: 2706625.7500; val_gene_expr_recon_loss: 697396.6875; val_masked_gp_l1_reg_loss: 6889.9390; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42357.9492; val_chrom_access_recon_loss: 1300522.0000; val_global_loss: 4792611.0000; val_optim_loss: 4792611.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9667; val_auprc_score: 0.9533; val_best_acc_score: 0.9154; val_best_f1_score: 0.9185; train_kl_reg_loss: 41332.4644; train_edge_recon_loss: 2672486.8611; train_gene_expr_recon_loss: 701951.8264; train_masked_gp_l1_reg_loss: 6919.6605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41596.6936; train_chrom_access_recon_loss: 1311897.8750; train_global_loss: 4776185.4444; train_optim_loss: 4776185.4444; val_kl_reg_loss: 38387.4258; val_edge_recon_loss: 2673244.0000; val_gene_expr_recon_loss: 698766.8750; val_masked_gp_l1_reg_loss: 6938.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40653.1133; val_chrom_access_recon_loss: 1299475.5000; val_global_loss: 4757466.0000; val_optim_loss: 4757466.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9667; val_auprc_score: 0.9480; val_best_acc_score: 0.9182; val_best_f1_score: 0.9208; train_kl_reg_loss: 40860.5282; train_edge_recon_loss: 2670792.6389; train_gene_expr_recon_loss: 700525.7500; train_masked_gp_l1_reg_loss: 6961.9518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39940.7131; train_chrom_access_recon_loss: 1310170.3194; train_global_loss: 4769251.8333; train_optim_loss: 4769251.8333; val_kl_reg_loss: 38650.9844; val_edge_recon_loss: 2684682.5000; val_gene_expr_recon_loss: 693038.1250; val_masked_gp_l1_reg_loss: 6979.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39059.1445; val_chrom_access_recon_loss: 1296077.0000; val_global_loss: 4758487.0000; val_optim_loss: 4758487.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9720; val_auprc_score: 0.9629; val_best_acc_score: 0.9221; val_best_f1_score: 0.9243; train_kl_reg_loss: 38748.4887; train_edge_recon_loss: 2681078.1389; train_gene_expr_recon_loss: 1015057.3264; train_masked_gp_l1_reg_loss: 7008.6013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38171.1372; train_chrom_access_recon_loss: 1385398.3889; train_global_loss: 5165462.0556; train_optim_loss: 5165462.0556; val_kl_reg_loss: 15339.3145; val_edge_recon_loss: 2690812.2500; val_gene_expr_recon_loss: 1013508.2500; val_masked_gp_l1_reg_loss: 7023.2964; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36953.2461; val_chrom_access_recon_loss: 1371546.3750; val_global_loss: 5135182.5000; val_optim_loss: 5135182.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9708; val_auprc_score: 0.9568; val_best_acc_score: 0.9232; val_best_f1_score: 0.9259; train_kl_reg_loss: 36689.2214; train_edge_recon_loss: 2664253.0556; train_gene_expr_recon_loss: 1010596.3542; train_masked_gp_l1_reg_loss: 7034.6954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35915.5191; train_chrom_access_recon_loss: 1379614.0139; train_global_loss: 5134102.7778; train_optim_loss: 5134102.7778; val_kl_reg_loss: 14962.6758; val_edge_recon_loss: 2675988.7500; val_gene_expr_recon_loss: 1011553.5000; val_masked_gp_l1_reg_loss: 7061.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34624.6797; val_chrom_access_recon_loss: 1370491.8750; val_global_loss: 5114683.5000; val_optim_loss: 5114683.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9720; val_auprc_score: 0.9585; val_best_acc_score: 0.9291; val_best_f1_score: 0.9314; train_kl_reg_loss: 34750.2387; train_edge_recon_loss: 2660476.4444; train_gene_expr_recon_loss: 1011193.5069; train_masked_gp_l1_reg_loss: 7092.2693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33632.5002; train_chrom_access_recon_loss: 1380428.3194; train_global_loss: 5127573.2222; train_optim_loss: 5127573.2222; val_kl_reg_loss: 14469.0488; val_edge_recon_loss: 2668818.7500; val_gene_expr_recon_loss: 1005134.5000; val_masked_gp_l1_reg_loss: 7137.5581; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32424.8867; val_chrom_access_recon_loss: 1368053.3750; val_global_loss: 5096038.0000; val_optim_loss: 5096038.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9602; val_best_acc_score: 0.9289; val_best_f1_score: 0.9315; train_kl_reg_loss: 33428.1806; train_edge_recon_loss: 2659261.1389; train_gene_expr_recon_loss: 1005608.6250; train_masked_gp_l1_reg_loss: 7117.1764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32291.1124; train_chrom_access_recon_loss: 1375936.8889; train_global_loss: 5113643.0000; train_optim_loss: 5113643.0000; val_kl_reg_loss: 14646.8193; val_edge_recon_loss: 2662012.2500; val_gene_expr_recon_loss: 1001491.3750; val_masked_gp_l1_reg_loss: 7096.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32127.4141; val_chrom_access_recon_loss: 1367210.6250; val_global_loss: 5084585.0000; val_optim_loss: 5084585.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9728; val_auprc_score: 0.9631; val_best_acc_score: 0.9282; val_best_f1_score: 0.9305; train_kl_reg_loss: 33693.2192; train_edge_recon_loss: 2655846.3889; train_gene_expr_recon_loss: 1008603.9861; train_masked_gp_l1_reg_loss: 7091.8028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32009.1237; train_chrom_access_recon_loss: 1384623.4583; train_global_loss: 5121868.0556; train_optim_loss: 5121868.0556; val_kl_reg_loss: 14621.5332; val_edge_recon_loss: 2674976.0000; val_gene_expr_recon_loss: 1002362.6250; val_masked_gp_l1_reg_loss: 7085.4048; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31860.8691; val_chrom_access_recon_loss: 1367212.7500; val_global_loss: 5098119.0000; val_optim_loss: 5098119.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9731; val_auprc_score: 0.9639; val_best_acc_score: 0.9245; val_best_f1_score: 0.9265; train_kl_reg_loss: 33166.7671; train_edge_recon_loss: 2653832.8056; train_gene_expr_recon_loss: 1003292.6111; train_masked_gp_l1_reg_loss: 7082.6736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31749.1072; train_chrom_access_recon_loss: 1375205.3611; train_global_loss: 5104329.4444; train_optim_loss: 5104329.4444; val_kl_reg_loss: 14550.3018; val_edge_recon_loss: 2689574.2500; val_gene_expr_recon_loss: 1001360.5000; val_masked_gp_l1_reg_loss: 7080.2046; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31611.6641; val_chrom_access_recon_loss: 1366664.0000; val_global_loss: 5110841.0000; val_optim_loss: 5110841.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9710; val_auprc_score: 0.9593; val_best_acc_score: 0.9263; val_best_f1_score: 0.9288; train_kl_reg_loss: 33101.1385; train_edge_recon_loss: 2652974.2222; train_gene_expr_recon_loss: 1006005.2917; train_masked_gp_l1_reg_loss: 7080.2728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31507.0315; train_chrom_access_recon_loss: 1375624.5417; train_global_loss: 5106292.4444; train_optim_loss: 5106292.4444; val_kl_reg_loss: 14578.3975; val_edge_recon_loss: 2672335.7500; val_gene_expr_recon_loss: 1001580.3125; val_masked_gp_l1_reg_loss: 7081.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31380.9883; val_chrom_access_recon_loss: 1366868.8750; val_global_loss: 5093825.5000; val_optim_loss: 5093825.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 20 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9702
val AUPRC score: 0.9602
val best accuracy score: 0.9190
val best F1 score: 0.9216
val target rna MSE score: 3.8458
val source rna MSE score: 3.1552
val target atac MSE score: 0.1340
val source atac MSE score: 0.0207
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
