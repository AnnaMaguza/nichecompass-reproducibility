[True]
Run timestamp: 10082023_145555_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7827; val_auprc_score: 0.7999; val_best_acc_score: 0.5131; val_best_f1_score: 0.6716; train_kl_reg_loss: 100830.8024; train_edge_recon_loss: 3610119.7519; train_gene_expr_recon_loss: 15488557.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 33472180.3511; train_global_loss: 52671688.9466; train_optim_loss: 52671688.9466; val_kl_reg_loss: 168836.6823; val_edge_recon_loss: 4063799.7500; val_gene_expr_recon_loss: 12829784.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 31004545.2000; val_global_loss: 48066966.6667; val_optim_loss: 48066966.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8442; val_auprc_score: 0.8508; val_best_acc_score: 0.7472; val_best_f1_score: 0.7728; train_kl_reg_loss: 130381.9150; train_edge_recon_loss: 3548579.0878; train_gene_expr_recon_loss: 12716965.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 31057019.8626; train_global_loss: 47452946.0153; train_optim_loss: 47452946.0153; val_kl_reg_loss: 134142.4865; val_edge_recon_loss: 4048531.0000; val_gene_expr_recon_loss: 12324249.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30432685.6000; val_global_loss: 46939609.3333; val_optim_loss: 46939609.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8685; val_auprc_score: 0.8634; val_best_acc_score: 0.7755; val_best_f1_score: 0.7949; train_kl_reg_loss: 105961.6000; train_edge_recon_loss: 3465004.5630; train_gene_expr_recon_loss: 12442301.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30633127.5115; train_global_loss: 46646394.8092; train_optim_loss: 46646394.8092; val_kl_reg_loss: 101246.0411; val_edge_recon_loss: 3144035.2333; val_gene_expr_recon_loss: 12197542.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30322635.6000; val_global_loss: 45765459.4667; val_optim_loss: 45765459.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8730; val_auprc_score: 0.8595; val_best_acc_score: 0.7804; val_best_f1_score: 0.7982; train_kl_reg_loss: 130591.7929; train_edge_recon_loss: 3015519.0592; train_gene_expr_recon_loss: 12294549.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30354335.1908; train_global_loss: 45794995.2977; train_optim_loss: 45794995.2977; val_kl_reg_loss: 130656.7307; val_edge_recon_loss: 2981423.7833; val_gene_expr_recon_loss: 12036837.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29897423.7333; val_global_loss: 45046341.6000; val_optim_loss: 45046341.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9019; val_auprc_score: 0.8873; val_best_acc_score: 0.8147; val_best_f1_score: 0.8321; train_kl_reg_loss: 129761.3742; train_edge_recon_loss: 2937802.3531; train_gene_expr_recon_loss: 12160673.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30094177.5267; train_global_loss: 45322414.9924; train_optim_loss: 45322414.9924; val_kl_reg_loss: 128571.9094; val_edge_recon_loss: 2908666.5333; val_gene_expr_recon_loss: 11940110.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29818796.6667; val_global_loss: 44796145.8667; val_optim_loss: 44796145.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9188; val_auprc_score: 0.9023; val_best_acc_score: 0.8521; val_best_f1_score: 0.8628; train_kl_reg_loss: 127907.2818; train_edge_recon_loss: 2867974.1145; train_gene_expr_recon_loss: 12050063.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29852522.3053; train_global_loss: 44898467.0229; train_optim_loss: 44898467.0229; val_kl_reg_loss: 127343.7724; val_edge_recon_loss: 2858147.9500; val_gene_expr_recon_loss: 11847400.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29566396.6667; val_global_loss: 44399289.0667; val_optim_loss: 44399289.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9283; val_auprc_score: 0.9106; val_best_acc_score: 0.8605; val_best_f1_score: 0.8695; train_kl_reg_loss: 125388.7221; train_edge_recon_loss: 2831784.4847; train_gene_expr_recon_loss: 11947218.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29603274.1679; train_global_loss: 44507665.5878; train_optim_loss: 44507665.5878; val_kl_reg_loss: 123044.3438; val_edge_recon_loss: 2847404.7500; val_gene_expr_recon_loss: 11705397.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29258462.4000; val_global_loss: 43934308.2667; val_optim_loss: 43934308.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9405; val_auprc_score: 0.9279; val_best_acc_score: 0.8750; val_best_f1_score: 0.8829; train_kl_reg_loss: 121571.9949; train_edge_recon_loss: 2808973.7786; train_gene_expr_recon_loss: 11849929.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29362163.9542; train_global_loss: 44142639.3588; train_optim_loss: 44142639.3588; val_kl_reg_loss: 112498.9479; val_edge_recon_loss: 2798487.9000; val_gene_expr_recon_loss: 11584521.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28855356.8000; val_global_loss: 43350865.6000; val_optim_loss: 43350865.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9426; val_auprc_score: 0.9299; val_best_acc_score: 0.8774; val_best_f1_score: 0.8841; train_kl_reg_loss: 115597.2529; train_edge_recon_loss: 2794905.2481; train_gene_expr_recon_loss: 11774463.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29208946.0305; train_global_loss: 43893912.0305; train_optim_loss: 43893912.0305; val_kl_reg_loss: 114020.8677; val_edge_recon_loss: 2796447.7167; val_gene_expr_recon_loss: 11565018.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28934111.8667; val_global_loss: 43409598.4000; val_optim_loss: 43409598.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9443; val_auprc_score: 0.9297; val_best_acc_score: 0.8783; val_best_f1_score: 0.8874; train_kl_reg_loss: 111535.2721; train_edge_recon_loss: 2787084.1031; train_gene_expr_recon_loss: 11712282.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29041311.1450; train_global_loss: 43652213.1298; train_optim_loss: 43652213.1298; val_kl_reg_loss: 107858.1635; val_edge_recon_loss: 2779578.4500; val_gene_expr_recon_loss: 11498956.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28676040.8000; val_global_loss: 43062434.4000; val_optim_loss: 43062434.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9504; val_auprc_score: 0.9383; val_best_acc_score: 0.8859; val_best_f1_score: 0.8927; train_kl_reg_loss: 109319.9828; train_edge_recon_loss: 2765968.0668; train_gene_expr_recon_loss: 11639146.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28849516.0305; train_global_loss: 43363950.4427; train_optim_loss: 43363950.4427; val_kl_reg_loss: 109008.5005; val_edge_recon_loss: 2777099.5500; val_gene_expr_recon_loss: 11471002.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28624566.9333; val_global_loss: 42981677.6000; val_optim_loss: 42981677.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9535; val_auprc_score: 0.9413; val_best_acc_score: 0.8905; val_best_f1_score: 0.8980; train_kl_reg_loss: 105766.4707; train_edge_recon_loss: 2760993.4313; train_gene_expr_recon_loss: 11573675.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28694445.1450; train_global_loss: 43134880.6412; train_optim_loss: 43134880.6412; val_kl_reg_loss: 106060.8453; val_edge_recon_loss: 2770290.6500; val_gene_expr_recon_loss: 11375061.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28211076.2667; val_global_loss: 42462489.3333; val_optim_loss: 42462489.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9559; val_auprc_score: 0.9431; val_best_acc_score: 0.8963; val_best_f1_score: 0.9017; train_kl_reg_loss: 103272.2382; train_edge_recon_loss: 2750324.7576; train_gene_expr_recon_loss: 11521507.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28562658.3206; train_global_loss: 42937763.1756; train_optim_loss: 42937763.1756; val_kl_reg_loss: 101989.9792; val_edge_recon_loss: 2751726.1000; val_gene_expr_recon_loss: 11310009.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28205877.6000; val_global_loss: 42369603.2000; val_optim_loss: 42369603.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9561; val_auprc_score: 0.9430; val_best_acc_score: 0.9004; val_best_f1_score: 0.9069; train_kl_reg_loss: 101476.3989; train_edge_recon_loss: 2738527.2996; train_gene_expr_recon_loss: 11470391.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28410370.8397; train_global_loss: 42720765.6183; train_optim_loss: 42720765.6183; val_kl_reg_loss: 100266.6635; val_edge_recon_loss: 2747593.2167; val_gene_expr_recon_loss: 11316866.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28073084.2667; val_global_loss: 42237810.1333; val_optim_loss: 42237810.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9615; val_auprc_score: 0.9506; val_best_acc_score: 0.9047; val_best_f1_score: 0.9085; train_kl_reg_loss: 98357.2179; train_edge_recon_loss: 2738162.7653; train_gene_expr_recon_loss: 11431145.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28314116.5649; train_global_loss: 42581781.6794; train_optim_loss: 42581781.6794; val_kl_reg_loss: 99623.1667; val_edge_recon_loss: 2742395.3000; val_gene_expr_recon_loss: 11254630.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27999476.5333; val_global_loss: 42096124.8000; val_optim_loss: 42096124.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9619; val_auprc_score: 0.9535; val_best_acc_score: 0.9080; val_best_f1_score: 0.9120; train_kl_reg_loss: 96406.7253; train_edge_recon_loss: 2736373.1489; train_gene_expr_recon_loss: 11388658.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28169568.6870; train_global_loss: 42391006.9008; train_optim_loss: 42391006.9008; val_kl_reg_loss: 92834.2354; val_edge_recon_loss: 2752145.5333; val_gene_expr_recon_loss: 11232159.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27896631.0667; val_global_loss: 41973770.9333; val_optim_loss: 41973770.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9656; val_auprc_score: 0.9568; val_best_acc_score: 0.9092; val_best_f1_score: 0.9133; train_kl_reg_loss: 94333.0638; train_edge_recon_loss: 2725426.8683; train_gene_expr_recon_loss: 11353193.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28062493.1603; train_global_loss: 42235446.8702; train_optim_loss: 42235446.8702; val_kl_reg_loss: 92919.4849; val_edge_recon_loss: 2741895.0333; val_gene_expr_recon_loss: 11183049.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27759839.2000; val_global_loss: 41777703.2000; val_optim_loss: 41777703.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9670; val_auprc_score: 0.9562; val_best_acc_score: 0.9135; val_best_f1_score: 0.9169; train_kl_reg_loss: 93025.6462; train_edge_recon_loss: 2712731.6947; train_gene_expr_recon_loss: 11319060.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27982318.2901; train_global_loss: 42107135.7252; train_optim_loss: 42107135.7252; val_kl_reg_loss: 91958.2740; val_edge_recon_loss: 2720187.8167; val_gene_expr_recon_loss: 11149331.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27713286.9333; val_global_loss: 41674763.4667; val_optim_loss: 41674763.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9645; val_auprc_score: 0.9529; val_best_acc_score: 0.9107; val_best_f1_score: 0.9143; train_kl_reg_loss: 90805.1093; train_edge_recon_loss: 2713377.0305; train_gene_expr_recon_loss: 11291366.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27860779.1603; train_global_loss: 41956327.4809; train_optim_loss: 41956327.4809; val_kl_reg_loss: 90711.0115; val_edge_recon_loss: 2742425.8000; val_gene_expr_recon_loss: 11145693.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27586758.9333; val_global_loss: 41565588.5333; val_optim_loss: 41565588.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9703; val_auprc_score: 0.9629; val_best_acc_score: 0.9186; val_best_f1_score: 0.9214; train_kl_reg_loss: 89389.7257; train_edge_recon_loss: 2712809.0992; train_gene_expr_recon_loss: 11252388.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27745364.5649; train_global_loss: 41799952.0000; train_optim_loss: 41799952.0000; val_kl_reg_loss: 88674.1271; val_edge_recon_loss: 2723333.1167; val_gene_expr_recon_loss: 11062318.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27519260.8000; val_global_loss: 41393586.4000; val_optim_loss: 41393586.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9716; val_auprc_score: 0.9637; val_best_acc_score: 0.9258; val_best_f1_score: 0.9291; train_kl_reg_loss: 87659.0536; train_edge_recon_loss: 2708270.3950; train_gene_expr_recon_loss: 11228705.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27670788.1069; train_global_loss: 41695423.0229; train_optim_loss: 41695423.0229; val_kl_reg_loss: 84878.5526; val_edge_recon_loss: 2709749.6500; val_gene_expr_recon_loss: 11131432.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27606825.3333; val_global_loss: 41532886.1333; val_optim_loss: 41532886.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9695; val_auprc_score: 0.9601; val_best_acc_score: 0.9197; val_best_f1_score: 0.9234; train_kl_reg_loss: 85007.5155; train_edge_recon_loss: 2708234.6756; train_gene_expr_recon_loss: 11207459.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27592920.3359; train_global_loss: 41593622.1985; train_optim_loss: 41593622.1985; val_kl_reg_loss: 83799.6922; val_edge_recon_loss: 2738610.2000; val_gene_expr_recon_loss: 11068751.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27397996.0000; val_global_loss: 41289156.8000; val_optim_loss: 41289156.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9756; val_auprc_score: 0.9682; val_best_acc_score: 0.9341; val_best_f1_score: 0.9365; train_kl_reg_loss: 84542.3981; train_edge_recon_loss: 2693113.6355; train_gene_expr_recon_loss: 11176534.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27491113.9084; train_global_loss: 41445304.3359; train_optim_loss: 41445304.3359; val_kl_reg_loss: 84196.7510; val_edge_recon_loss: 2687116.5500; val_gene_expr_recon_loss: 11026008.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27264124.2667; val_global_loss: 41061446.4000; val_optim_loss: 41061446.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9787; val_auprc_score: 0.9728; val_best_acc_score: 0.9317; val_best_f1_score: 0.9347; train_kl_reg_loss: 83466.3388; train_edge_recon_loss: 2692208.9294; train_gene_expr_recon_loss: 11151390.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27421959.0992; train_global_loss: 41349024.7328; train_optim_loss: 41349024.7328; val_kl_reg_loss: 83889.3396; val_edge_recon_loss: 2697351.6500; val_gene_expr_recon_loss: 11043490.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27347202.4000; val_global_loss: 41171933.0667; val_optim_loss: 41171933.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9744; val_auprc_score: 0.9660; val_best_acc_score: 0.9295; val_best_f1_score: 0.9312; train_kl_reg_loss: 82408.4686; train_edge_recon_loss: 2692486.2615; train_gene_expr_recon_loss: 11148149.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27388079.4504; train_global_loss: 41311123.3588; train_optim_loss: 41311123.3588; val_kl_reg_loss: 80959.4010; val_edge_recon_loss: 2723144.9833; val_gene_expr_recon_loss: 11053587.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27338945.8667; val_global_loss: 41196637.8667; val_optim_loss: 41196637.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9751; val_auprc_score: 0.9676; val_best_acc_score: 0.9301; val_best_f1_score: 0.9327; train_kl_reg_loss: 97514.7507; train_edge_recon_loss: 2734265.7615; train_gene_expr_recon_loss: 11544343.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27768806.4885; train_global_loss: 42144930.7786; train_optim_loss: 42144930.7786; val_kl_reg_loss: 36035.4297; val_edge_recon_loss: 2736936.8667; val_gene_expr_recon_loss: 11420995.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27593354.9333; val_global_loss: 41787322.6667; val_optim_loss: 41787322.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9727; val_auprc_score: 0.9623; val_best_acc_score: 0.9196; val_best_f1_score: 0.9221; train_kl_reg_loss: 98345.9412; train_edge_recon_loss: 2730630.0286; train_gene_expr_recon_loss: 11620227.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27794901.9389; train_global_loss: 42244105.6489; train_optim_loss: 42244105.6489; val_kl_reg_loss: 26027.8777; val_edge_recon_loss: 2776052.6167; val_gene_expr_recon_loss: 11490590.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27529713.6000; val_global_loss: 41822384.8000; val_optim_loss: 41822384.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9712; val_auprc_score: 0.9649; val_best_acc_score: 0.9193; val_best_f1_score: 0.9222; train_kl_reg_loss: 100070.1350; train_edge_recon_loss: 2745652.4828; train_gene_expr_recon_loss: 11687201.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27826361.2519; train_global_loss: 42359286.1374; train_optim_loss: 42359286.1374; val_kl_reg_loss: 28748.0072; val_edge_recon_loss: 2753151.8000; val_gene_expr_recon_loss: 11507779.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27658681.3333; val_global_loss: 41948360.2667; val_optim_loss: 41948360.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9690; val_auprc_score: 0.9590; val_best_acc_score: 0.9138; val_best_f1_score: 0.9178; train_kl_reg_loss: 100732.3086; train_edge_recon_loss: 2737907.5496; train_gene_expr_recon_loss: 11679035.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27775027.2061; train_global_loss: 42292702.5038; train_optim_loss: 42292702.5038; val_kl_reg_loss: 30063.1133; val_edge_recon_loss: 2746229.9333; val_gene_expr_recon_loss: 11531077.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27575851.6000; val_global_loss: 41883221.8667; val_optim_loss: 41883221.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9695; val_auprc_score: 0.9623; val_best_acc_score: 0.9165; val_best_f1_score: 0.9182; train_kl_reg_loss: 99197.0369; train_edge_recon_loss: 2739042.9637; train_gene_expr_recon_loss: 11672719.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27782847.4656; train_global_loss: 42293807.4504; train_optim_loss: 42293807.4504; val_kl_reg_loss: 29267.6880; val_edge_recon_loss: 2755699.1667; val_gene_expr_recon_loss: 11558602.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27617793.6000; val_global_loss: 41961362.6667; val_optim_loss: 41961362.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9664; val_auprc_score: 0.9577; val_best_acc_score: 0.9131; val_best_f1_score: 0.9161; train_kl_reg_loss: 96420.9876; train_edge_recon_loss: 2730911.8073; train_gene_expr_recon_loss: 11675282.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27789251.1298; train_global_loss: 42291866.7786; train_optim_loss: 42291866.7786; val_kl_reg_loss: 29840.1307; val_edge_recon_loss: 2754471.2333; val_gene_expr_recon_loss: 11523033.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27617789.3333; val_global_loss: 41925133.8667; val_optim_loss: 41925133.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 19 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9766
val AUPRC score: 0.9709
val best accuracy score: 0.9286
val best F1 score: 0.9314
val target rna MSE score: 1.0548
val source rna MSE score: 1.0433
val target atac MSE score: 0.1226
val source atac MSE score: 0.0224
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
