[True]
Run timestamp: 10082023_220312_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8032; val_auprc_score: 0.8199; val_best_acc_score: 0.5672; val_best_f1_score: 0.6953; train_kl_reg_loss: 107181.2767; train_edge_recon_loss: 3716648.9065; train_gene_expr_recon_loss: 47829879.7252; train_masked_gp_l1_reg_loss: 93409.4532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246448.1019; train_chrom_access_recon_loss: 25493722.2901; train_global_loss: 77487289.2519; train_optim_loss: 77487289.2519; val_kl_reg_loss: 228605.7323; val_edge_recon_loss: 4061629.9000; val_gene_expr_recon_loss: 38592400.0000; val_masked_gp_l1_reg_loss: 89569.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242818.1875; val_chrom_access_recon_loss: 23416645.3333; val_global_loss: 66631668.5333; val_optim_loss: 66631668.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8256; val_auprc_score: 0.8399; val_best_acc_score: 0.7352; val_best_f1_score: 0.7415; train_kl_reg_loss: 225245.1559; train_edge_recon_loss: 3627601.7462; train_gene_expr_recon_loss: 37855887.4504; train_masked_gp_l1_reg_loss: 82165.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237784.6616; train_chrom_access_recon_loss: 23184612.4122; train_global_loss: 65213297.1908; train_optim_loss: 65213297.1908; val_kl_reg_loss: 194542.5646; val_edge_recon_loss: 4038232.7333; val_gene_expr_recon_loss: 37221217.6000; val_masked_gp_l1_reg_loss: 78110.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232488.7969; val_chrom_access_recon_loss: 23173268.9333; val_global_loss: 64937860.8000; val_optim_loss: 64937860.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8816; val_auprc_score: 0.8822; val_best_acc_score: 0.7855; val_best_f1_score: 0.7917; train_kl_reg_loss: 186952.5098; train_edge_recon_loss: 3510909.9847; train_gene_expr_recon_loss: 37053271.5115; train_masked_gp_l1_reg_loss: 78240.0401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227156.0379; train_chrom_access_recon_loss: 22923994.8702; train_global_loss: 63980525.0687; train_optim_loss: 63980525.0687; val_kl_reg_loss: 174104.9281; val_edge_recon_loss: 3285788.9000; val_gene_expr_recon_loss: 36841233.0667; val_masked_gp_l1_reg_loss: 79508.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221790.4844; val_chrom_access_recon_loss: 22997472.1333; val_global_loss: 63599899.4667; val_optim_loss: 63599899.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8891; val_auprc_score: 0.8807; val_best_acc_score: 0.7999; val_best_f1_score: 0.8158; train_kl_reg_loss: 210790.5348; train_edge_recon_loss: 3100689.3721; train_gene_expr_recon_loss: 36684118.9924; train_masked_gp_l1_reg_loss: 80635.5633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216500.4846; train_chrom_access_recon_loss: 22754612.5038; train_global_loss: 63047347.4504; train_optim_loss: 63047347.4504; val_kl_reg_loss: 209836.2854; val_edge_recon_loss: 3086009.1167; val_gene_expr_recon_loss: 36392672.0000; val_masked_gp_l1_reg_loss: 81592.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211164.5469; val_chrom_access_recon_loss: 22762718.1333; val_global_loss: 62743991.4667; val_optim_loss: 62743991.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9064; val_auprc_score: 0.8964; val_best_acc_score: 0.8204; val_best_f1_score: 0.8338; train_kl_reg_loss: 208106.7854; train_edge_recon_loss: 3010876.0496; train_gene_expr_recon_loss: 36431238.0458; train_masked_gp_l1_reg_loss: 82672.0970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206091.4259; train_chrom_access_recon_loss: 22648802.6870; train_global_loss: 62587787.2061; train_optim_loss: 62587787.2061; val_kl_reg_loss: 200754.4583; val_edge_recon_loss: 2975100.0833; val_gene_expr_recon_loss: 36146800.5333; val_masked_gp_l1_reg_loss: 84382.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201028.4844; val_chrom_access_recon_loss: 22668434.5333; val_global_loss: 62276501.3333; val_optim_loss: 62276501.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9260; val_auprc_score: 0.9158; val_best_acc_score: 0.8480; val_best_f1_score: 0.8570; train_kl_reg_loss: 194171.9365; train_edge_recon_loss: 2966570.0153; train_gene_expr_recon_loss: 36213186.5649; train_masked_gp_l1_reg_loss: 85347.5511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196254.7420; train_chrom_access_recon_loss: 22553392.3817; train_global_loss: 62208923.0840; train_optim_loss: 62208923.0840; val_kl_reg_loss: 194228.0292; val_edge_recon_loss: 2946263.2167; val_gene_expr_recon_loss: 35979876.5333; val_masked_gp_l1_reg_loss: 86548.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191579.5625; val_chrom_access_recon_loss: 22570017.8667; val_global_loss: 61968513.0667; val_optim_loss: 61968513.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9418; val_auprc_score: 0.9307; val_best_acc_score: 0.8762; val_best_f1_score: 0.8829; train_kl_reg_loss: 191135.2223; train_edge_recon_loss: 2914803.1221; train_gene_expr_recon_loss: 36014428.0611; train_masked_gp_l1_reg_loss: 87733.2086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187264.5066; train_chrom_access_recon_loss: 22464500.5496; train_global_loss: 61859864.6107; train_optim_loss: 61859864.6107; val_kl_reg_loss: 184330.2802; val_edge_recon_loss: 2902027.6333; val_gene_expr_recon_loss: 36049146.1333; val_masked_gp_l1_reg_loss: 89150.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183078.3906; val_chrom_access_recon_loss: 22714054.4000; val_global_loss: 62121790.1333; val_optim_loss: 62121790.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9496; val_auprc_score: 0.9392; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 187739.7422; train_edge_recon_loss: 2861691.1355; train_gene_expr_recon_loss: 35759395.6336; train_masked_gp_l1_reg_loss: 90584.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179203.1039; train_chrom_access_recon_loss: 22295655.4962; train_global_loss: 61374269.7405; train_optim_loss: 61374269.7405; val_kl_reg_loss: 187964.8667; val_edge_recon_loss: 2854980.4333; val_gene_expr_recon_loss: 35490501.6000; val_masked_gp_l1_reg_loss: 91767.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175332.3750; val_chrom_access_recon_loss: 22298106.4000; val_global_loss: 61098654.1333; val_optim_loss: 61098654.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9536; val_auprc_score: 0.9396; val_best_acc_score: 0.8934; val_best_f1_score: 0.8980; train_kl_reg_loss: 183504.8639; train_edge_recon_loss: 2843469.5649; train_gene_expr_recon_loss: 35576524.7939; train_masked_gp_l1_reg_loss: 93242.0044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171636.2166; train_chrom_access_recon_loss: 22175237.5115; train_global_loss: 61043614.8702; train_optim_loss: 61043614.8702; val_kl_reg_loss: 175730.6896; val_edge_recon_loss: 2820090.9333; val_gene_expr_recon_loss: 35410026.9333; val_masked_gp_l1_reg_loss: 94638.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167945.8594; val_chrom_access_recon_loss: 22251000.9333; val_global_loss: 60919432.8000; val_optim_loss: 60919432.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9533; val_auprc_score: 0.9424; val_best_acc_score: 0.8892; val_best_f1_score: 0.8941; train_kl_reg_loss: 176480.6455; train_edge_recon_loss: 2830443.4752; train_gene_expr_recon_loss: 35429885.6031; train_masked_gp_l1_reg_loss: 96037.7390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164297.6815; train_chrom_access_recon_loss: 22094118.7023; train_global_loss: 60791264.0611; train_optim_loss: 60791264.0611; val_kl_reg_loss: 173750.1792; val_edge_recon_loss: 2858046.5500; val_gene_expr_recon_loss: 35203153.8667; val_masked_gp_l1_reg_loss: 97245.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160650.9062; val_chrom_access_recon_loss: 22150600.0000; val_global_loss: 60643446.6667; val_optim_loss: 60643446.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9598; val_auprc_score: 0.9485; val_best_acc_score: 0.9011; val_best_f1_score: 0.9044; train_kl_reg_loss: 172116.3031; train_edge_recon_loss: 2820616.4542; train_gene_expr_recon_loss: 35332244.5038; train_masked_gp_l1_reg_loss: 98542.1474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157162.5607; train_chrom_access_recon_loss: 22059680.9008; train_global_loss: 60640362.7786; train_optim_loss: 60640362.7786; val_kl_reg_loss: 172233.8406; val_edge_recon_loss: 2809121.7667; val_gene_expr_recon_loss: 35209725.6000; val_masked_gp_l1_reg_loss: 99679.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153766.2344; val_chrom_access_recon_loss: 22092750.0000; val_global_loss: 60537278.9333; val_optim_loss: 60537278.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9626; val_auprc_score: 0.9555; val_best_acc_score: 0.9043; val_best_f1_score: 0.9074; train_kl_reg_loss: 168082.0666; train_edge_recon_loss: 2804072.4943; train_gene_expr_recon_loss: 35150781.4962; train_masked_gp_l1_reg_loss: 101009.1708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150517.5536; train_chrom_access_recon_loss: 21926685.2214; train_global_loss: 60301147.7863; train_optim_loss: 60301147.7863; val_kl_reg_loss: 166774.9698; val_edge_recon_loss: 2816188.8667; val_gene_expr_recon_loss: 35049800.0000; val_masked_gp_l1_reg_loss: 102279.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147335.4531; val_chrom_access_recon_loss: 22004333.3333; val_global_loss: 60286713.8667; val_optim_loss: 60286713.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9672; val_auprc_score: 0.9618; val_best_acc_score: 0.9065; val_best_f1_score: 0.9113; train_kl_reg_loss: 163688.8459; train_edge_recon_loss: 2790821.0496; train_gene_expr_recon_loss: 35051216.1069; train_masked_gp_l1_reg_loss: 103476.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144310.8275; train_chrom_access_recon_loss: 21903789.2366; train_global_loss: 60157302.4427; train_optim_loss: 60157302.4427; val_kl_reg_loss: 160578.4990; val_edge_recon_loss: 2797021.1667; val_gene_expr_recon_loss: 34964160.0000; val_masked_gp_l1_reg_loss: 104556.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141365.7031; val_chrom_access_recon_loss: 22033072.0000; val_global_loss: 60200752.0000; val_optim_loss: 60200752.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9644; val_auprc_score: 0.9586; val_best_acc_score: 0.9023; val_best_f1_score: 0.9085; train_kl_reg_loss: 157547.6862; train_edge_recon_loss: 2799511.8454; train_gene_expr_recon_loss: 34993814.0305; train_masked_gp_l1_reg_loss: 105938.1371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138654.8866; train_chrom_access_recon_loss: 21874162.1679; train_global_loss: 60069628.7634; train_optim_loss: 60069628.7634; val_kl_reg_loss: 158656.9792; val_edge_recon_loss: 2785393.1833; val_gene_expr_recon_loss: 34888997.3333; val_masked_gp_l1_reg_loss: 107042.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135836.1719; val_chrom_access_recon_loss: 21897001.2000; val_global_loss: 59972928.5333; val_optim_loss: 59972928.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9663; val_auprc_score: 0.9601; val_best_acc_score: 0.9066; val_best_f1_score: 0.9116; train_kl_reg_loss: 156201.7418; train_edge_recon_loss: 2786900.7595; train_gene_expr_recon_loss: 34902508.3359; train_masked_gp_l1_reg_loss: 108178.0986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133193.9797; train_chrom_access_recon_loss: 21796113.3130; train_global_loss: 59883096.1527; train_optim_loss: 59883096.1527; val_kl_reg_loss: 155161.1740; val_edge_recon_loss: 2777078.5167; val_gene_expr_recon_loss: 34919292.0000; val_masked_gp_l1_reg_loss: 108988.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130536.8750; val_chrom_access_recon_loss: 21929731.6000; val_global_loss: 60020787.7333; val_optim_loss: 60020787.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9716; val_auprc_score: 0.9670; val_best_acc_score: 0.9155; val_best_f1_score: 0.9183; train_kl_reg_loss: 152165.1896; train_edge_recon_loss: 2778536.4351; train_gene_expr_recon_loss: 34776589.2214; train_masked_gp_l1_reg_loss: 110131.8625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128002.5912; train_chrom_access_recon_loss: 21739848.4580; train_global_loss: 59685273.7099; train_optim_loss: 59685273.7099; val_kl_reg_loss: 153949.2104; val_edge_recon_loss: 2764681.0500; val_gene_expr_recon_loss: 34612448.5333; val_masked_gp_l1_reg_loss: 111080.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125672.7031; val_chrom_access_recon_loss: 21722373.8667; val_global_loss: 59490205.0667; val_optim_loss: 59490205.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9684; val_auprc_score: 0.9615; val_best_acc_score: 0.9108; val_best_f1_score: 0.9130; train_kl_reg_loss: 150828.6051; train_edge_recon_loss: 2771774.6317; train_gene_expr_recon_loss: 34688558.9008; train_masked_gp_l1_reg_loss: 112204.1598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123470.5495; train_chrom_access_recon_loss: 21699011.7863; train_global_loss: 59545848.3359; train_optim_loss: 59545848.3359; val_kl_reg_loss: 153330.7344; val_edge_recon_loss: 2802856.0667; val_gene_expr_recon_loss: 34597345.8667; val_masked_gp_l1_reg_loss: 113626.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121384.6953; val_chrom_access_recon_loss: 21833735.2000; val_global_loss: 59622280.2667; val_optim_loss: 59622280.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9723; val_auprc_score: 0.9691; val_best_acc_score: 0.9128; val_best_f1_score: 0.9152; train_kl_reg_loss: 147234.0089; train_edge_recon_loss: 2777490.2634; train_gene_expr_recon_loss: 34595589.2061; train_masked_gp_l1_reg_loss: 114543.6458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119262.9458; train_chrom_access_recon_loss: 21639004.4427; train_global_loss: 59393124.7634; train_optim_loss: 59393124.7634; val_kl_reg_loss: 147599.3229; val_edge_recon_loss: 2791428.3667; val_gene_expr_recon_loss: 34607958.9333; val_masked_gp_l1_reg_loss: 115600.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117325.4062; val_chrom_access_recon_loss: 21770514.5333; val_global_loss: 59550425.8667; val_optim_loss: 59550425.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9731; val_auprc_score: 0.9668; val_best_acc_score: 0.9181; val_best_f1_score: 0.9201; train_kl_reg_loss: 144034.8671; train_edge_recon_loss: 2768935.3149; train_gene_expr_recon_loss: 34524462.6260; train_masked_gp_l1_reg_loss: 116567.4113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115424.8143; train_chrom_access_recon_loss: 21607176.7939; train_global_loss: 59276601.6794; train_optim_loss: 59276601.6794; val_kl_reg_loss: 145768.2417; val_edge_recon_loss: 2765155.1167; val_gene_expr_recon_loss: 34571020.5333; val_masked_gp_l1_reg_loss: 117654.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113580.0547; val_chrom_access_recon_loss: 21807996.8000; val_global_loss: 59521177.0667; val_optim_loss: 59521177.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9735; val_auprc_score: 0.9669; val_best_acc_score: 0.9190; val_best_f1_score: 0.9232; train_kl_reg_loss: 142963.0976; train_edge_recon_loss: 2763285.4046; train_gene_expr_recon_loss: 34487487.5573; train_masked_gp_l1_reg_loss: 118770.7459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111802.3484; train_chrom_access_recon_loss: 21583907.6947; train_global_loss: 59208216.9160; train_optim_loss: 59208216.9160; val_kl_reg_loss: 145583.8354; val_edge_recon_loss: 2767394.1833; val_gene_expr_recon_loss: 34422582.9333; val_masked_gp_l1_reg_loss: 119603.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109962.0938; val_chrom_access_recon_loss: 21585820.1333; val_global_loss: 59150949.3333; val_optim_loss: 59150949.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9694; val_auprc_score: 0.9647; val_best_acc_score: 0.9120; val_best_f1_score: 0.9142; train_kl_reg_loss: 141140.7524; train_edge_recon_loss: 2758329.9103; train_gene_expr_recon_loss: 34411669.1298; train_masked_gp_l1_reg_loss: 120712.2454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108177.9125; train_chrom_access_recon_loss: 21568967.5267; train_global_loss: 59108997.8321; train_optim_loss: 59108997.8321; val_kl_reg_loss: 141008.5917; val_edge_recon_loss: 2799930.6000; val_gene_expr_recon_loss: 34416302.6667; val_masked_gp_l1_reg_loss: 121688.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106430.9297; val_chrom_access_recon_loss: 21768083.6000; val_global_loss: 59353445.6000; val_optim_loss: 59353445.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9761; val_auprc_score: 0.9710; val_best_acc_score: 0.9216; val_best_f1_score: 0.9238; train_kl_reg_loss: 139189.6927; train_edge_recon_loss: 2759793.7958; train_gene_expr_recon_loss: 34293520.1221; train_masked_gp_l1_reg_loss: 122807.2167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104833.6517; train_chrom_access_recon_loss: 21478565.2366; train_global_loss: 58898709.7099; train_optim_loss: 58898709.7099; val_kl_reg_loss: 137312.9438; val_edge_recon_loss: 2771157.8000; val_gene_expr_recon_loss: 34326712.8000; val_masked_gp_l1_reg_loss: 123787.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103234.6953; val_chrom_access_recon_loss: 21681587.7333; val_global_loss: 59143794.6667; val_optim_loss: 59143794.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9749; val_auprc_score: 0.9706; val_best_acc_score: 0.9198; val_best_f1_score: 0.9223; train_kl_reg_loss: 136636.8006; train_edge_recon_loss: 2753808.1126; train_gene_expr_recon_loss: 34326046.6870; train_masked_gp_l1_reg_loss: 124834.7952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101771.9728; train_chrom_access_recon_loss: 21483084.6718; train_global_loss: 58926183.2061; train_optim_loss: 58926183.2061; val_kl_reg_loss: 143410.6646; val_edge_recon_loss: 2771078.6000; val_gene_expr_recon_loss: 34382640.8000; val_masked_gp_l1_reg_loss: 125351.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99977.4297; val_chrom_access_recon_loss: 21653463.6000; val_global_loss: 59175921.6000; val_optim_loss: 59175921.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9756; val_auprc_score: 0.9718; val_best_acc_score: 0.9208; val_best_f1_score: 0.9232; train_kl_reg_loss: 138955.0823; train_edge_recon_loss: 2748245.5744; train_gene_expr_recon_loss: 34217452.2290; train_masked_gp_l1_reg_loss: 126198.3294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98479.9319; train_chrom_access_recon_loss: 21430681.4046; train_global_loss: 58760012.6718; train_optim_loss: 58760012.6718; val_kl_reg_loss: 140290.2521; val_edge_recon_loss: 2780686.5500; val_gene_expr_recon_loss: 34243450.4000; val_masked_gp_l1_reg_loss: 126953.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96971.3750; val_chrom_access_recon_loss: 21528433.7333; val_global_loss: 58916785.3333; val_optim_loss: 58916785.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9801; val_auprc_score: 0.9763; val_best_acc_score: 0.9281; val_best_f1_score: 0.9290; train_kl_reg_loss: 138024.8780; train_edge_recon_loss: 2748068.5000; train_gene_expr_recon_loss: 34163692.2901; train_masked_gp_l1_reg_loss: 127914.9874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95540.5196; train_chrom_access_recon_loss: 21415525.6183; train_global_loss: 58688766.5344; train_optim_loss: 58688766.5344; val_kl_reg_loss: 137490.6125; val_edge_recon_loss: 2751735.2167; val_gene_expr_recon_loss: 34259729.4667; val_masked_gp_l1_reg_loss: 128795.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94283.9453; val_chrom_access_recon_loss: 21523176.4000; val_global_loss: 58895211.4667; val_optim_loss: 58895211.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9601; val_auprc_score: 0.9534; val_best_acc_score: 0.8965; val_best_f1_score: 0.8989; train_kl_reg_loss: 165547.5387; train_edge_recon_loss: 2931638.3645; train_gene_expr_recon_loss: 38537741.1603; train_masked_gp_l1_reg_loss: 128581.4903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100645.5802; train_chrom_access_recon_loss: 22096864.7176; train_global_loss: 63961018.8702; train_optim_loss: 63961018.8702; val_kl_reg_loss: 34986.0863; val_edge_recon_loss: 2890321.9667; val_gene_expr_recon_loss: 37957734.1333; val_masked_gp_l1_reg_loss: 127456.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101931.9922; val_chrom_access_recon_loss: 22141782.1333; val_global_loss: 63254212.8000; val_optim_loss: 63254212.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9402; val_auprc_score: 0.9292; val_best_acc_score: 0.8748; val_best_f1_score: 0.8816; train_kl_reg_loss: 136891.5936; train_edge_recon_loss: 2843878.1221; train_gene_expr_recon_loss: 38742933.4351; train_masked_gp_l1_reg_loss: 126362.1104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101262.9167; train_chrom_access_recon_loss: 22106478.8397; train_global_loss: 64057807.2672; train_optim_loss: 64057807.2672; val_kl_reg_loss: 37461.9367; val_edge_recon_loss: 2858192.4833; val_gene_expr_recon_loss: 39862705.6000; val_masked_gp_l1_reg_loss: 125401.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100858.2188; val_chrom_access_recon_loss: 22361388.1333; val_global_loss: 65346008.2667; val_optim_loss: 65346008.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9381; val_auprc_score: 0.9190; val_best_acc_score: 0.8797; val_best_f1_score: 0.8855; train_kl_reg_loss: 101632.2814; train_edge_recon_loss: 2796737.9943; train_gene_expr_recon_loss: 39981644.0611; train_masked_gp_l1_reg_loss: 123352.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98405.2079; train_chrom_access_recon_loss: 22249943.4809; train_global_loss: 65351715.5115; train_optim_loss: 65351715.5115; val_kl_reg_loss: 37934.0276; val_edge_recon_loss: 2782089.8500; val_gene_expr_recon_loss: 39728699.4667; val_masked_gp_l1_reg_loss: 120737.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95783.0156; val_chrom_access_recon_loss: 22337898.6667; val_global_loss: 65103142.6667; val_optim_loss: 65103142.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9297; val_auprc_score: 0.9141; val_best_acc_score: 0.8618; val_best_f1_score: 0.8672; train_kl_reg_loss: 82958.1496; train_edge_recon_loss: 2802061.9714; train_gene_expr_recon_loss: 39731666.3817; train_masked_gp_l1_reg_loss: 118290.1053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93510.1625; train_chrom_access_recon_loss: 22222424.3511; train_global_loss: 65050911.1450; train_optim_loss: 65050911.1450; val_kl_reg_loss: 32132.9618; val_edge_recon_loss: 2801130.8833; val_gene_expr_recon_loss: 39561898.4000; val_masked_gp_l1_reg_loss: 116021.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91198.7188; val_chrom_access_recon_loss: 22177858.6667; val_global_loss: 64780240.5333; val_optim_loss: 64780240.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9305; val_auprc_score: 0.9119; val_best_acc_score: 0.8705; val_best_f1_score: 0.8757; train_kl_reg_loss: 80386.2546; train_edge_recon_loss: 2769567.6947; train_gene_expr_recon_loss: 39685311.3893; train_masked_gp_l1_reg_loss: 115511.2178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90874.0262; train_chrom_access_recon_loss: 22161330.1069; train_global_loss: 64902980.4275; train_optim_loss: 64902980.4275; val_kl_reg_loss: 33198.8923; val_edge_recon_loss: 2778501.2333; val_gene_expr_recon_loss: 39825260.8000; val_masked_gp_l1_reg_loss: 115208.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90553.7266; val_chrom_access_recon_loss: 22395240.9333; val_global_loss: 65237962.4000; val_optim_loss: 65237962.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9263; val_auprc_score: 0.9045; val_best_acc_score: 0.8631; val_best_f1_score: 0.8734; train_kl_reg_loss: 78366.1226; train_edge_recon_loss: 2764267.5038; train_gene_expr_recon_loss: 39668465.4962; train_masked_gp_l1_reg_loss: 114924.0651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90261.0330; train_chrom_access_recon_loss: 22146362.8855; train_global_loss: 64862647.3588; train_optim_loss: 64862647.3588; val_kl_reg_loss: 33630.1320; val_edge_recon_loss: 2791593.3167; val_gene_expr_recon_loss: 39549850.4000; val_masked_gp_l1_reg_loss: 114633.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89951.4297; val_chrom_access_recon_loss: 22281723.2000; val_global_loss: 64861380.0000; val_optim_loss: 64861380.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9307; val_auprc_score: 0.9115; val_best_acc_score: 0.8676; val_best_f1_score: 0.8764; train_kl_reg_loss: 76462.0569; train_edge_recon_loss: 2765957.8511; train_gene_expr_recon_loss: 39633662.6870; train_masked_gp_l1_reg_loss: 114332.3016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89655.0279; train_chrom_access_recon_loss: 22181521.8321; train_global_loss: 64861592.0916; train_optim_loss: 64861592.0916; val_kl_reg_loss: 33995.7850; val_edge_recon_loss: 2785388.9500; val_gene_expr_recon_loss: 39552116.5333; val_masked_gp_l1_reg_loss: 114026.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89352.2969; val_chrom_access_recon_loss: 22267222.1333; val_global_loss: 64842102.9333; val_optim_loss: 64842102.9333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9342; val_auprc_score: 0.9176; val_best_acc_score: 0.8709; val_best_f1_score: 0.8798; train_kl_reg_loss: 74148.7860; train_edge_recon_loss: 2767622.8721; train_gene_expr_recon_loss: 39584263.9084; train_masked_gp_l1_reg_loss: 113714.8306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89048.9920; train_chrom_access_recon_loss: 22141472.0916; train_global_loss: 64770271.6947; train_optim_loss: 64770271.6947; val_kl_reg_loss: 34142.1288; val_edge_recon_loss: 2765839.0333; val_gene_expr_recon_loss: 39366014.6667; val_masked_gp_l1_reg_loss: 113388.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88738.2031; val_chrom_access_recon_loss: 22218185.3333; val_global_loss: 64586308.8000; val_optim_loss: 64586308.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9771
val AUPRC score: 0.9733
val best accuracy score: 0.9270
val best F1 score: 0.9286
val target rna MSE score: 1.6142
val source rna MSE score: 90.9537
val target atac MSE score: 0.1292
val source atac MSE score: 2.2284
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
