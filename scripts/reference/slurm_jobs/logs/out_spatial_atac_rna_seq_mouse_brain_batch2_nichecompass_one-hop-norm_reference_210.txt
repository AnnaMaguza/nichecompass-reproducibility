[True]
Run timestamp: 08082023_081246_210.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_210']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7172; val_auprc_score: 0.7448; val_best_acc_score: 0.5546; val_best_f1_score: 0.6794; train_kl_reg_loss: 13182.1567; train_edge_recon_loss: 354792.0634; train_gene_expr_recon_loss: 853538.4119; train_masked_gp_l1_reg_loss: 6808.5521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104659.0634; train_chrom_access_recon_loss: 485372.6539; train_global_loss: 1818352.9053; train_optim_loss: 1818352.9053; val_kl_reg_loss: 20459.9275; val_edge_recon_loss: 406023.5586; val_gene_expr_recon_loss: 713130.2344; val_masked_gp_l1_reg_loss: 6892.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85336.9609; val_chrom_access_recon_loss: 457538.3789; val_global_loss: 1689381.2500; val_optim_loss: 1689381.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8197; val_auprc_score: 0.8224; val_best_acc_score: 0.7352; val_best_f1_score: 0.7267; train_kl_reg_loss: 19260.8119; train_edge_recon_loss: 358145.3149; train_gene_expr_recon_loss: 688311.5634; train_masked_gp_l1_reg_loss: 7035.6443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67190.9234; train_chrom_access_recon_loss: 452085.9981; train_global_loss: 1592030.2500; train_optim_loss: 1592030.2500; val_kl_reg_loss: 18944.1233; val_edge_recon_loss: 403434.7109; val_gene_expr_recon_loss: 680338.5547; val_masked_gp_l1_reg_loss: 7179.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50823.1641; val_chrom_access_recon_loss: 451759.9375; val_global_loss: 1612479.7188; val_optim_loss: 1612479.7188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8894; val_auprc_score: 0.8797; val_best_acc_score: 0.8091; val_best_f1_score: 0.8208; train_kl_reg_loss: 19460.2801; train_edge_recon_loss: 341099.1203; train_gene_expr_recon_loss: 671220.4205; train_masked_gp_l1_reg_loss: 7336.8023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39915.6288; train_chrom_access_recon_loss: 446682.9152; train_global_loss: 1525715.1610; train_optim_loss: 1525715.1610; val_kl_reg_loss: 24848.8367; val_edge_recon_loss: 309291.5273; val_gene_expr_recon_loss: 668701.9062; val_masked_gp_l1_reg_loss: 7527.1650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31063.4023; val_chrom_access_recon_loss: 445485.5195; val_global_loss: 1486918.3594; val_optim_loss: 1486918.3594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9185; val_auprc_score: 0.9021; val_best_acc_score: 0.8490; val_best_f1_score: 0.8600; train_kl_reg_loss: 26193.4291; train_edge_recon_loss: 300969.9010; train_gene_expr_recon_loss: 664098.1184; train_masked_gp_l1_reg_loss: 7672.0016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25674.3465; train_chrom_access_recon_loss: 442228.1184; train_global_loss: 1466835.9167; train_optim_loss: 1466835.9167; val_kl_reg_loss: 24980.9426; val_edge_recon_loss: 297675.7305; val_gene_expr_recon_loss: 663820.8281; val_masked_gp_l1_reg_loss: 7815.9722; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21185.2637; val_chrom_access_recon_loss: 443036.7305; val_global_loss: 1458515.4844; val_optim_loss: 1458515.4844
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9211; val_auprc_score: 0.9056; val_best_acc_score: 0.8548; val_best_f1_score: 0.8628; train_kl_reg_loss: 25473.8201; train_edge_recon_loss: 295673.2992; train_gene_expr_recon_loss: 657216.7311; train_masked_gp_l1_reg_loss: 7930.6742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18234.2056; train_chrom_access_recon_loss: 438823.2727; train_global_loss: 1443352.0114; train_optim_loss: 1443352.0114; val_kl_reg_loss: 24994.8149; val_edge_recon_loss: 296098.8320; val_gene_expr_recon_loss: 658550.2109; val_masked_gp_l1_reg_loss: 8046.1768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15697.6172; val_chrom_access_recon_loss: 438183.0664; val_global_loss: 1441570.7344; val_optim_loss: 1441570.7344
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9285; val_auprc_score: 0.9124; val_best_acc_score: 0.8646; val_best_f1_score: 0.8727; train_kl_reg_loss: 24738.6849; train_edge_recon_loss: 293682.1435; train_gene_expr_recon_loss: 651134.7955; train_masked_gp_l1_reg_loss: 8137.3222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13979.3818; train_chrom_access_recon_loss: 435306.9735; train_global_loss: 1426979.2992; train_optim_loss: 1426979.2992; val_kl_reg_loss: 25177.4351; val_edge_recon_loss: 294487.6406; val_gene_expr_recon_loss: 649440.1172; val_masked_gp_l1_reg_loss: 8219.9326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12433.3574; val_chrom_access_recon_loss: 433892.1484; val_global_loss: 1423650.6562; val_optim_loss: 1423650.6562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9400; val_auprc_score: 0.9263; val_best_acc_score: 0.8777; val_best_f1_score: 0.8836; train_kl_reg_loss: 24186.3323; train_edge_recon_loss: 292334.6487; train_gene_expr_recon_loss: 645250.5019; train_masked_gp_l1_reg_loss: 8291.7896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11315.4434; train_chrom_access_recon_loss: 432047.9214; train_global_loss: 1413426.6496; train_optim_loss: 1413426.6496; val_kl_reg_loss: 23440.0659; val_edge_recon_loss: 291222.3438; val_gene_expr_recon_loss: 640472.9297; val_masked_gp_l1_reg_loss: 8370.7920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10364.7070; val_chrom_access_recon_loss: 429976.6562; val_global_loss: 1403847.4688; val_optim_loss: 1403847.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9479; val_auprc_score: 0.9337; val_best_acc_score: 0.8884; val_best_f1_score: 0.8943; train_kl_reg_loss: 23597.2756; train_edge_recon_loss: 289932.1491; train_gene_expr_recon_loss: 640485.8504; train_masked_gp_l1_reg_loss: 8433.4400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9625.1629; train_chrom_access_recon_loss: 429177.1728; train_global_loss: 1401251.0587; train_optim_loss: 1401251.0587; val_kl_reg_loss: 23580.0017; val_edge_recon_loss: 289775.8711; val_gene_expr_recon_loss: 645850.6250; val_masked_gp_l1_reg_loss: 8505.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.0586; val_chrom_access_recon_loss: 429458.9766; val_global_loss: 1406170.2812; val_optim_loss: 1406170.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9560; val_auprc_score: 0.9433; val_best_acc_score: 0.9007; val_best_f1_score: 0.9054; train_kl_reg_loss: 23246.2976; train_edge_recon_loss: 288756.4285; train_gene_expr_recon_loss: 636526.7206; train_masked_gp_l1_reg_loss: 8558.6022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8489.9888; train_chrom_access_recon_loss: 426846.5445; train_global_loss: 1392424.5795; train_optim_loss: 1392424.5795; val_kl_reg_loss: 23431.6550; val_edge_recon_loss: 286395.2031; val_gene_expr_recon_loss: 632358.4844; val_masked_gp_l1_reg_loss: 8626.0176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8045.6875; val_chrom_access_recon_loss: 425180.1172; val_global_loss: 1384037.1250; val_optim_loss: 1384037.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9606; val_auprc_score: 0.9506; val_best_acc_score: 0.9056; val_best_f1_score: 0.9100; train_kl_reg_loss: 22897.0384; train_edge_recon_loss: 286565.0748; train_gene_expr_recon_loss: 632058.2008; train_masked_gp_l1_reg_loss: 8666.5538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7606.3859; train_chrom_access_recon_loss: 422702.0052; train_global_loss: 1380495.2652; train_optim_loss: 1380495.2652; val_kl_reg_loss: 23220.9380; val_edge_recon_loss: 285815.1016; val_gene_expr_recon_loss: 628758.1562; val_masked_gp_l1_reg_loss: 8731.5127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7226.8301; val_chrom_access_recon_loss: 425071.9414; val_global_loss: 1378824.4375; val_optim_loss: 1378824.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9679; val_auprc_score: 0.9596; val_best_acc_score: 0.9119; val_best_f1_score: 0.9153; train_kl_reg_loss: 22913.6104; train_edge_recon_loss: 284230.8835; train_gene_expr_recon_loss: 629142.9129; train_masked_gp_l1_reg_loss: 8765.3197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6874.1286; train_chrom_access_recon_loss: 421096.6098; train_global_loss: 1373023.4602; train_optim_loss: 1373023.4602; val_kl_reg_loss: 22761.3523; val_edge_recon_loss: 284793.7344; val_gene_expr_recon_loss: 629764.3984; val_masked_gp_l1_reg_loss: 8818.2139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6565.8008; val_chrom_access_recon_loss: 422465.4297; val_global_loss: 1375168.8906; val_optim_loss: 1375168.8906
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9711; val_auprc_score: 0.9632; val_best_acc_score: 0.9227; val_best_f1_score: 0.9246; train_kl_reg_loss: 22436.8670; train_edge_recon_loss: 283631.3812; train_gene_expr_recon_loss: 625927.5142; train_masked_gp_l1_reg_loss: 8855.4356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6289.8430; train_chrom_access_recon_loss: 418772.6951; train_global_loss: 1365913.7424; train_optim_loss: 1365913.7424; val_kl_reg_loss: 21969.7004; val_edge_recon_loss: 283055.9258; val_gene_expr_recon_loss: 636285.3984; val_masked_gp_l1_reg_loss: 8894.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6064.2275; val_chrom_access_recon_loss: 421825.8359; val_global_loss: 1378095.4219; val_optim_loss: 1378095.4219
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9703; val_auprc_score: 0.9629; val_best_acc_score: 0.9205; val_best_f1_score: 0.9238; train_kl_reg_loss: 22208.5494; train_edge_recon_loss: 282236.3002; train_gene_expr_recon_loss: 622724.4678; train_masked_gp_l1_reg_loss: 8932.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5866.5676; train_chrom_access_recon_loss: 417153.7292; train_global_loss: 1359122.2027; train_optim_loss: 1359122.2027; val_kl_reg_loss: 21887.1277; val_edge_recon_loss: 280845.7148; val_gene_expr_recon_loss: 624887.5078; val_masked_gp_l1_reg_loss: 8964.3447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5666.8794; val_chrom_access_recon_loss: 417797.9922; val_global_loss: 1360049.5938; val_optim_loss: 1360049.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9766; val_auprc_score: 0.9703; val_best_acc_score: 0.9301; val_best_f1_score: 0.9327; train_kl_reg_loss: 21769.0040; train_edge_recon_loss: 282167.8073; train_gene_expr_recon_loss: 619702.7841; train_masked_gp_l1_reg_loss: 8996.9035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5519.3442; train_chrom_access_recon_loss: 415199.1061; train_global_loss: 1353354.9432; train_optim_loss: 1353354.9432; val_kl_reg_loss: 21957.1843; val_edge_recon_loss: 281337.0000; val_gene_expr_recon_loss: 627173.0078; val_masked_gp_l1_reg_loss: 9035.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5385.1909; val_chrom_access_recon_loss: 413711.4180; val_global_loss: 1358598.9219; val_optim_loss: 1358598.9219
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9729; val_auprc_score: 0.9648; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 21569.1811; train_edge_recon_loss: 280674.4299; train_gene_expr_recon_loss: 617177.6922; train_masked_gp_l1_reg_loss: 9065.6990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5279.9204; train_chrom_access_recon_loss: 413517.5502; train_global_loss: 1347284.4773; train_optim_loss: 1347284.4773; val_kl_reg_loss: 21629.9312; val_edge_recon_loss: 280809.4805; val_gene_expr_recon_loss: 624364.0781; val_masked_gp_l1_reg_loss: 9095.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5187.0889; val_chrom_access_recon_loss: 413428.0625; val_global_loss: 1354513.8594; val_optim_loss: 1354513.8594
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9788; val_auprc_score: 0.9735; val_best_acc_score: 0.9364; val_best_f1_score: 0.9386; train_kl_reg_loss: 21206.4020; train_edge_recon_loss: 280273.3570; train_gene_expr_recon_loss: 614670.6525; train_masked_gp_l1_reg_loss: 9114.9684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5100.3662; train_chrom_access_recon_loss: 411627.8144; train_global_loss: 1341993.5758; train_optim_loss: 1341993.5758; val_kl_reg_loss: 21112.7224; val_edge_recon_loss: 278358.6602; val_gene_expr_recon_loss: 617928.9844; val_masked_gp_l1_reg_loss: 9136.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5044.9463; val_chrom_access_recon_loss: 407875.6875; val_global_loss: 1339457.0469; val_optim_loss: 1339457.0469
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9807; val_auprc_score: 0.9737; val_best_acc_score: 0.9411; val_best_f1_score: 0.9430; train_kl_reg_loss: 21001.4430; train_edge_recon_loss: 279887.9119; train_gene_expr_recon_loss: 611980.2888; train_masked_gp_l1_reg_loss: 9162.4437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4972.1954; train_chrom_access_recon_loss: 410678.5833; train_global_loss: 1337682.8712; train_optim_loss: 1337682.8712; val_kl_reg_loss: 20527.3252; val_edge_recon_loss: 279559.5625; val_gene_expr_recon_loss: 617643.4141; val_masked_gp_l1_reg_loss: 9180.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4927.0820; val_chrom_access_recon_loss: 409772.1602; val_global_loss: 1341610.4531; val_optim_loss: 1341610.4531
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9814; val_auprc_score: 0.9749; val_best_acc_score: 0.9414; val_best_f1_score: 0.9432; train_kl_reg_loss: 20882.2874; train_edge_recon_loss: 278258.6420; train_gene_expr_recon_loss: 609075.2509; train_masked_gp_l1_reg_loss: 9194.1523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4867.6192; train_chrom_access_recon_loss: 408531.7116; train_global_loss: 1330809.6477; train_optim_loss: 1330809.6477; val_kl_reg_loss: 21207.2275; val_edge_recon_loss: 278558.3320; val_gene_expr_recon_loss: 608763.7500; val_masked_gp_l1_reg_loss: 9216.6230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4818.4761; val_chrom_access_recon_loss: 407225.7266; val_global_loss: 1329790.1875; val_optim_loss: 1329790.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9833; val_auprc_score: 0.9788; val_best_acc_score: 0.9464; val_best_f1_score: 0.9479; train_kl_reg_loss: 20684.1415; train_edge_recon_loss: 278409.9844; train_gene_expr_recon_loss: 606850.8570; train_masked_gp_l1_reg_loss: 9227.2525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4779.3450; train_chrom_access_recon_loss: 407650.1795; train_global_loss: 1327601.7689; train_optim_loss: 1327601.7689; val_kl_reg_loss: 20642.9299; val_edge_recon_loss: 278399.2695; val_gene_expr_recon_loss: 609040.6016; val_masked_gp_l1_reg_loss: 9237.2607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4755.6890; val_chrom_access_recon_loss: 410244.7461; val_global_loss: 1332320.5000; val_optim_loss: 1332320.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9831; val_auprc_score: 0.9783; val_best_acc_score: 0.9481; val_best_f1_score: 0.9497; train_kl_reg_loss: 20471.0006; train_edge_recon_loss: 277422.6832; train_gene_expr_recon_loss: 604464.5956; train_masked_gp_l1_reg_loss: 9251.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4711.3463; train_chrom_access_recon_loss: 406459.7812; train_global_loss: 1322780.4830; train_optim_loss: 1322780.4830; val_kl_reg_loss: 20740.6658; val_edge_recon_loss: 277819.0547; val_gene_expr_recon_loss: 612179.5156; val_masked_gp_l1_reg_loss: 9272.2549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4677.0049; val_chrom_access_recon_loss: 408684.9258; val_global_loss: 1333373.3906; val_optim_loss: 1333373.3906
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9861; val_auprc_score: 0.9820; val_best_acc_score: 0.9526; val_best_f1_score: 0.9537; train_kl_reg_loss: 20166.8205; train_edge_recon_loss: 277230.9716; train_gene_expr_recon_loss: 601730.8390; train_masked_gp_l1_reg_loss: 9286.3942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4655.1129; train_chrom_access_recon_loss: 404636.0824; train_global_loss: 1317706.2178; train_optim_loss: 1317706.2178; val_kl_reg_loss: 19934.6450; val_edge_recon_loss: 277437.5547; val_gene_expr_recon_loss: 608818.8125; val_masked_gp_l1_reg_loss: 9294.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4629.5972; val_chrom_access_recon_loss: 409021.3750; val_global_loss: 1329136.9219; val_optim_loss: 1329136.9219
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9867; val_auprc_score: 0.9823; val_best_acc_score: 0.9516; val_best_f1_score: 0.9527; train_kl_reg_loss: 20166.3854; train_edge_recon_loss: 275968.0019; train_gene_expr_recon_loss: 599402.3314; train_masked_gp_l1_reg_loss: 9300.4537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4600.8091; train_chrom_access_recon_loss: 404303.9205; train_global_loss: 1313741.8977; train_optim_loss: 1313741.8977; val_kl_reg_loss: 20362.8137; val_edge_recon_loss: 276820.3477; val_gene_expr_recon_loss: 603960.1953; val_masked_gp_l1_reg_loss: 9311.3271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4596.5977; val_chrom_access_recon_loss: 405470.4648; val_global_loss: 1320521.7812; val_optim_loss: 1320521.7812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9875; val_auprc_score: 0.9838; val_best_acc_score: 0.9558; val_best_f1_score: 0.9564; train_kl_reg_loss: 19963.8645; train_edge_recon_loss: 276036.1989; train_gene_expr_recon_loss: 597469.7850; train_masked_gp_l1_reg_loss: 9313.5528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4570.2531; train_chrom_access_recon_loss: 403070.0980; train_global_loss: 1310423.7462; train_optim_loss: 1310423.7462; val_kl_reg_loss: 20202.5774; val_edge_recon_loss: 276107.1836; val_gene_expr_recon_loss: 607510.3203; val_masked_gp_l1_reg_loss: 9320.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4559.4297; val_chrom_access_recon_loss: 402752.8711; val_global_loss: 1320452.8906; val_optim_loss: 1320452.8906
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9860; val_auprc_score: 0.9791; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 19831.6085; train_edge_recon_loss: 276241.9337; train_gene_expr_recon_loss: 595581.2718; train_masked_gp_l1_reg_loss: 9318.3879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4537.6651; train_chrom_access_recon_loss: 401901.7689; train_global_loss: 1307412.6364; train_optim_loss: 1307412.6364; val_kl_reg_loss: 20149.7578; val_edge_recon_loss: 275554.3047; val_gene_expr_recon_loss: 607380.5781; val_masked_gp_l1_reg_loss: 9328.2451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4520.5596; val_chrom_access_recon_loss: 402528.3711; val_global_loss: 1319461.8281; val_optim_loss: 1319461.8281
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9891; val_auprc_score: 0.9853; val_best_acc_score: 0.9576; val_best_f1_score: 0.9588; train_kl_reg_loss: 19642.9626; train_edge_recon_loss: 275750.1288; train_gene_expr_recon_loss: 593787.6070; train_masked_gp_l1_reg_loss: 9331.3625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4496.7933; train_chrom_access_recon_loss: 402275.5322; train_global_loss: 1305284.3826; train_optim_loss: 1305284.3826; val_kl_reg_loss: 19760.5813; val_edge_recon_loss: 275059.2969; val_gene_expr_recon_loss: 603829.0391; val_masked_gp_l1_reg_loss: 9339.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4478.8633; val_chrom_access_recon_loss: 404819.1641; val_global_loss: 1317286.8906; val_optim_loss: 1317286.8906
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9863; val_auprc_score: 0.9830; val_best_acc_score: 0.9507; val_best_f1_score: 0.9522; train_kl_reg_loss: 14557.1353; train_edge_recon_loss: 274110.4380; train_gene_expr_recon_loss: 995111.9242; train_masked_gp_l1_reg_loss: 10110.3063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3645.8584; train_chrom_access_recon_loss: 434971.7666; train_global_loss: 1732507.4205; train_optim_loss: 1732507.4205; val_kl_reg_loss: 9662.1205; val_edge_recon_loss: 273214.3984; val_gene_expr_recon_loss: 980439.5234; val_masked_gp_l1_reg_loss: 10841.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2950.4722; val_chrom_access_recon_loss: 436063.0234; val_global_loss: 1713170.9375; val_optim_loss: 1713170.9375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9831; val_auprc_score: 0.9782; val_best_acc_score: 0.9487; val_best_f1_score: 0.9502; train_kl_reg_loss: 13023.9956; train_edge_recon_loss: 270764.8565; train_gene_expr_recon_loss: 962839.4725; train_masked_gp_l1_reg_loss: 11205.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2478.9579; train_chrom_access_recon_loss: 434000.0634; train_global_loss: 1694312.5947; train_optim_loss: 1694312.5947; val_kl_reg_loss: 10490.7573; val_edge_recon_loss: 271970.3320; val_gene_expr_recon_loss: 961437.1172; val_masked_gp_l1_reg_loss: 11481.0732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2050.9263; val_chrom_access_recon_loss: 432357.0039; val_global_loss: 1689787.2188; val_optim_loss: 1689787.2188
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9860; val_auprc_score: 0.9826; val_best_acc_score: 0.9519; val_best_f1_score: 0.9533; train_kl_reg_loss: 12698.0765; train_edge_recon_loss: 270660.7396; train_gene_expr_recon_loss: 944356.2841; train_masked_gp_l1_reg_loss: 11661.0991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1737.7253; train_chrom_access_recon_loss: 432626.7955; train_global_loss: 1673740.7292; train_optim_loss: 1673740.7292; val_kl_reg_loss: 10823.8049; val_edge_recon_loss: 271472.0312; val_gene_expr_recon_loss: 934217.5000; val_masked_gp_l1_reg_loss: 11809.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1473.9062; val_chrom_access_recon_loss: 431720.1133; val_global_loss: 1661517.0625; val_optim_loss: 1661517.0625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9853; val_auprc_score: 0.9781; val_best_acc_score: 0.9550; val_best_f1_score: 0.9563; train_kl_reg_loss: 12437.6501; train_edge_recon_loss: 270592.0724; train_gene_expr_recon_loss: 928855.1032; train_masked_gp_l1_reg_loss: 11927.8497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1321.9013; train_chrom_access_recon_loss: 431302.2505; train_global_loss: 1656436.8352; train_optim_loss: 1656436.8352; val_kl_reg_loss: 11177.0814; val_edge_recon_loss: 270508.1992; val_gene_expr_recon_loss: 928378.9062; val_masked_gp_l1_reg_loss: 12039.5527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1195.0356; val_chrom_access_recon_loss: 430438.2188; val_global_loss: 1653736.9062; val_optim_loss: 1653736.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9848; val_auprc_score: 0.9792; val_best_acc_score: 0.9547; val_best_f1_score: 0.9559; train_kl_reg_loss: 12269.5760; train_edge_recon_loss: 269494.4645; train_gene_expr_recon_loss: 923116.6506; train_masked_gp_l1_reg_loss: 11967.5265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1065.3749; train_chrom_access_recon_loss: 432115.9062; train_global_loss: 1650029.4792; train_optim_loss: 1650029.4792; val_kl_reg_loss: 11225.2908; val_edge_recon_loss: 270383.8008; val_gene_expr_recon_loss: 927931.7344; val_masked_gp_l1_reg_loss: 11957.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1034.6722; val_chrom_access_recon_loss: 437362.2070; val_global_loss: 1659894.7812; val_optim_loss: 1659894.7812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9873; val_auprc_score: 0.9839; val_best_acc_score: 0.9557; val_best_f1_score: 0.9565; train_kl_reg_loss: 12233.8307; train_edge_recon_loss: 269547.3598; train_gene_expr_recon_loss: 920505.6856; train_masked_gp_l1_reg_loss: 11962.5954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1024.2205; train_chrom_access_recon_loss: 431525.2296; train_global_loss: 1646798.9205; train_optim_loss: 1646798.9205; val_kl_reg_loss: 11243.2896; val_edge_recon_loss: 269578.9883; val_gene_expr_recon_loss: 924616.3594; val_masked_gp_l1_reg_loss: 11969.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1013.8972; val_chrom_access_recon_loss: 435384.6641; val_global_loss: 1653806.4062; val_optim_loss: 1653806.4062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9880; val_auprc_score: 0.9832; val_best_acc_score: 0.9590; val_best_f1_score: 0.9600; train_kl_reg_loss: 12216.7164; train_edge_recon_loss: 269572.7661; train_gene_expr_recon_loss: 919589.3153; train_masked_gp_l1_reg_loss: 11975.8085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1003.5950; train_chrom_access_recon_loss: 431698.5189; train_global_loss: 1646056.7273; train_optim_loss: 1646056.7273; val_kl_reg_loss: 11275.7150; val_edge_recon_loss: 269100.8086; val_gene_expr_recon_loss: 922313.8125; val_masked_gp_l1_reg_loss: 11983.0059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 992.9906; val_chrom_access_recon_loss: 432213.4961; val_global_loss: 1647879.8438; val_optim_loss: 1647879.8438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9905; val_auprc_score: 0.9888; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 12120.8033; train_edge_recon_loss: 269798.5104; train_gene_expr_recon_loss: 918120.7879; train_masked_gp_l1_reg_loss: 11989.7927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 983.0809; train_chrom_access_recon_loss: 431421.7637; train_global_loss: 1644434.7386; train_optim_loss: 1644434.7386; val_kl_reg_loss: 11259.9778; val_edge_recon_loss: 270966.6562; val_gene_expr_recon_loss: 924876.0156; val_masked_gp_l1_reg_loss: 11996.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 972.8340; val_chrom_access_recon_loss: 429313.3984; val_global_loss: 1649385.8906; val_optim_loss: 1649385.8906

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 46 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9885
val AUPRC score: 0.9860
val best accuracy score: 0.9550
val best F1 score: 0.9561
val target rna MSE score: 3.9818
val source rna MSE score: 3.5707
val target atac MSE score: 0.1372
val source atac MSE score: 0.0270
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
