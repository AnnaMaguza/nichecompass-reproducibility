[True, False, True]
Run timestamp: 03092023_010847_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.003125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9019; val_auprc_score: 0.9790; val_best_acc_score: 0.9193; val_best_f1_score: 0.9548; train_kl_reg_loss: 17014.0999; train_edge_recon_loss: 724266.7314; train_cat_covariates_contrastive_loss: 948575.4832; train_gene_expr_recon_loss: 2579272.0051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59251.4063; train_global_loss: 4328379.7264; train_optim_loss: 4328379.7264; val_kl_reg_loss: 17237.5395; val_edge_recon_loss: 720088.9247; val_cat_covariates_contrastive_loss: 948981.9412; val_gene_expr_recon_loss: 2247716.8243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14336.1328; val_global_loss: 3948361.4755; val_optim_loss: 3948361.4755
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9111; val_auprc_score: 0.9802; val_best_acc_score: 0.9242; val_best_f1_score: 0.9574; train_kl_reg_loss: 19516.1584; train_edge_recon_loss: 696141.8767; train_cat_covariates_contrastive_loss: 948566.8583; train_gene_expr_recon_loss: 2108888.7173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14806.5402; train_global_loss: 3787920.1532; train_optim_loss: 3787920.1532; val_kl_reg_loss: 21731.5391; val_edge_recon_loss: 714689.5491; val_cat_covariates_contrastive_loss: 947856.2996; val_gene_expr_recon_loss: 2013174.1381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15042.9014; val_global_loss: 3712494.5236; val_optim_loss: 3712494.5236
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9159; val_auprc_score: 0.9815; val_best_acc_score: 0.9242; val_best_f1_score: 0.9574; train_kl_reg_loss: 21866.6081; train_edge_recon_loss: 690034.9121; train_cat_covariates_contrastive_loss: 948837.7253; train_gene_expr_recon_loss: 1974184.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15066.9193; train_global_loss: 3649990.1834; train_optim_loss: 3649990.1834; val_kl_reg_loss: 22178.0147; val_edge_recon_loss: 713756.9932; val_cat_covariates_contrastive_loss: 949103.8123; val_gene_expr_recon_loss: 1943712.7749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15217.5459; val_global_loss: 3643969.0970; val_optim_loss: 3643969.0970
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9211; val_auprc_score: 0.9822; val_best_acc_score: 0.9277; val_best_f1_score: 0.9592; train_kl_reg_loss: 22834.2378; train_edge_recon_loss: 691245.0898; train_cat_covariates_contrastive_loss: 948898.5582; train_gene_expr_recon_loss: 1926554.7974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15316.5674; train_global_loss: 3604849.2494; train_optim_loss: 3604849.2494; val_kl_reg_loss: 22326.8997; val_edge_recon_loss: 714683.0813; val_cat_covariates_contrastive_loss: 949433.7544; val_gene_expr_recon_loss: 1912769.3741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15595.2822; val_global_loss: 3614808.3558; val_optim_loss: 3614808.3558
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9208; val_auprc_score: 0.9824; val_best_acc_score: 0.9304; val_best_f1_score: 0.9608; train_kl_reg_loss: 23389.9519; train_edge_recon_loss: 688314.8545; train_cat_covariates_contrastive_loss: 949139.2578; train_gene_expr_recon_loss: 1901382.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15524.3436; train_global_loss: 3577750.9105; train_optim_loss: 3577750.9105; val_kl_reg_loss: 24060.0081; val_edge_recon_loss: 706963.8381; val_cat_covariates_contrastive_loss: 949613.0367; val_gene_expr_recon_loss: 1891748.1451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15668.8457; val_global_loss: 3588053.7753; val_optim_loss: 3588053.7753
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9240; val_auprc_score: 0.9826; val_best_acc_score: 0.9310; val_best_f1_score: 0.9610; train_kl_reg_loss: 23915.1590; train_edge_recon_loss: 689309.0723; train_cat_covariates_contrastive_loss: 949111.4512; train_gene_expr_recon_loss: 1884296.9441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15565.4751; train_global_loss: 3562198.1050; train_optim_loss: 3562198.1050; val_kl_reg_loss: 25072.9862; val_edge_recon_loss: 713279.2854; val_cat_covariates_contrastive_loss: 948919.2531; val_gene_expr_recon_loss: 1876148.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15542.8877; val_global_loss: 3578963.3855; val_optim_loss: 3578963.3855
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9219; val_auprc_score: 0.9820; val_best_acc_score: 0.9313; val_best_f1_score: 0.9613; train_kl_reg_loss: 24368.5994; train_edge_recon_loss: 688815.2154; train_cat_covariates_contrastive_loss: 949092.3739; train_gene_expr_recon_loss: 1869960.6766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15709.0185; train_global_loss: 3547945.8815; train_optim_loss: 3547945.8815; val_kl_reg_loss: 25270.9592; val_edge_recon_loss: 711218.9412; val_cat_covariates_contrastive_loss: 948343.1285; val_gene_expr_recon_loss: 1860685.3689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15765.7832; val_global_loss: 3561284.1460; val_optim_loss: 3561284.1460
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9263; val_auprc_score: 0.9830; val_best_acc_score: 0.9324; val_best_f1_score: 0.9618; train_kl_reg_loss: 24737.5738; train_edge_recon_loss: 688942.7462; train_cat_covariates_contrastive_loss: 949264.4522; train_gene_expr_recon_loss: 1858401.2644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15928.0706; train_global_loss: 3537274.1050; train_optim_loss: 3537274.1050; val_kl_reg_loss: 24811.9699; val_edge_recon_loss: 716527.0746; val_cat_covariates_contrastive_loss: 949087.7607; val_gene_expr_recon_loss: 1851977.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16037.6221; val_global_loss: 3558441.9292; val_optim_loss: 3558441.9292
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9230; val_auprc_score: 0.9822; val_best_acc_score: 0.9318; val_best_f1_score: 0.9615; train_kl_reg_loss: 25112.4241; train_edge_recon_loss: 688961.6620; train_cat_covariates_contrastive_loss: 949481.7494; train_gene_expr_recon_loss: 1848720.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16038.9675; train_global_loss: 3528315.6484; train_optim_loss: 3528315.6484; val_kl_reg_loss: 25799.8337; val_edge_recon_loss: 715512.6534; val_cat_covariates_contrastive_loss: 949253.1204; val_gene_expr_recon_loss: 1845911.4628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16088.3369; val_global_loss: 3552565.3208; val_optim_loss: 3552565.3208
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9254; val_auprc_score: 0.9827; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 25407.5060; train_edge_recon_loss: 687947.2682; train_cat_covariates_contrastive_loss: 949530.5017; train_gene_expr_recon_loss: 1839352.5194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16079.8290; train_global_loss: 3518317.6267; train_optim_loss: 3518317.6267; val_kl_reg_loss: 26205.2530; val_edge_recon_loss: 712981.2463; val_cat_covariates_contrastive_loss: 949048.6558; val_gene_expr_recon_loss: 1836575.0184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16156.6426; val_global_loss: 3540966.9170; val_optim_loss: 3540966.9170
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9250; val_auprc_score: 0.9827; val_best_acc_score: 0.9321; val_best_f1_score: 0.9617; train_kl_reg_loss: 25704.3569; train_edge_recon_loss: 688554.0458; train_cat_covariates_contrastive_loss: 949732.1399; train_gene_expr_recon_loss: 1834497.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16146.0860; train_global_loss: 3514634.4043; train_optim_loss: 3514634.4043; val_kl_reg_loss: 25808.4753; val_edge_recon_loss: 715300.9049; val_cat_covariates_contrastive_loss: 949778.6451; val_gene_expr_recon_loss: 1827800.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16200.8721; val_global_loss: 3534889.1696; val_optim_loss: 3534889.1696
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9298; val_auprc_score: 0.9839; val_best_acc_score: 0.9349; val_best_f1_score: 0.9632; train_kl_reg_loss: 25922.5819; train_edge_recon_loss: 688712.7891; train_cat_covariates_contrastive_loss: 949569.1721; train_gene_expr_recon_loss: 1827782.1501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16244.4830; train_global_loss: 3508231.1760; train_optim_loss: 3508231.1760; val_kl_reg_loss: 26396.3928; val_edge_recon_loss: 710045.7704; val_cat_covariates_contrastive_loss: 949406.0317; val_gene_expr_recon_loss: 1829013.3794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16288.8682; val_global_loss: 3531150.3252; val_optim_loss: 3531150.3252
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9311; val_auprc_score: 0.9844; val_best_acc_score: 0.9360; val_best_f1_score: 0.9638; train_kl_reg_loss: 26161.5207; train_edge_recon_loss: 688598.6640; train_cat_covariates_contrastive_loss: 949780.0496; train_gene_expr_recon_loss: 1822169.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16390.6809; train_global_loss: 3503099.9421; train_optim_loss: 3503099.9421; val_kl_reg_loss: 25143.0859; val_edge_recon_loss: 702500.2504; val_cat_covariates_contrastive_loss: 951847.2279; val_gene_expr_recon_loss: 1821076.8309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16435.3223; val_global_loss: 3517002.6364; val_optim_loss: 3517002.6364
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9300; val_auprc_score: 0.9838; val_best_acc_score: 0.9355; val_best_f1_score: 0.9635; train_kl_reg_loss: 26305.3965; train_edge_recon_loss: 687089.6978; train_cat_covariates_contrastive_loss: 949826.3963; train_gene_expr_recon_loss: 1817869.7712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16540.1626; train_global_loss: 3497631.4232; train_optim_loss: 3497631.4232; val_kl_reg_loss: 26184.0839; val_edge_recon_loss: 710149.1490; val_cat_covariates_contrastive_loss: 951095.2015; val_gene_expr_recon_loss: 1817433.0975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16674.2402; val_global_loss: 3521535.7736; val_optim_loss: 3521535.7736
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9283; val_auprc_score: 0.9832; val_best_acc_score: 0.9351; val_best_f1_score: 0.9634; train_kl_reg_loss: 26434.0018; train_edge_recon_loss: 689080.2867; train_cat_covariates_contrastive_loss: 949967.3724; train_gene_expr_recon_loss: 1813785.9122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16638.5165; train_global_loss: 3495906.0886; train_optim_loss: 3495906.0886; val_kl_reg_loss: 26785.2045; val_edge_recon_loss: 713393.2308; val_cat_covariates_contrastive_loss: 949327.3899; val_gene_expr_recon_loss: 1813396.2605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16792.7207; val_global_loss: 3519694.8453; val_optim_loss: 3519694.8453
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9300; val_auprc_score: 0.9840; val_best_acc_score: 0.9349; val_best_f1_score: 0.9632; train_kl_reg_loss: 26641.7587; train_edge_recon_loss: 687664.2017; train_cat_covariates_contrastive_loss: 949881.6085; train_gene_expr_recon_loss: 1810027.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16660.1887; train_global_loss: 3490874.9335; train_optim_loss: 3490874.9335; val_kl_reg_loss: 26511.8945; val_edge_recon_loss: 711997.8328; val_cat_covariates_contrastive_loss: 950358.9355; val_gene_expr_recon_loss: 1808970.6962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16471.7324; val_global_loss: 3514311.1093; val_optim_loss: 3514311.1093
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9282; val_auprc_score: 0.9833; val_best_acc_score: 0.9347; val_best_f1_score: 0.9630; train_kl_reg_loss: 26743.6128; train_edge_recon_loss: 687758.7050; train_cat_covariates_contrastive_loss: 949891.9454; train_gene_expr_recon_loss: 1807549.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16706.4048; train_global_loss: 3488650.6080; train_optim_loss: 3488650.6080; val_kl_reg_loss: 27022.4799; val_edge_recon_loss: 711377.6935; val_cat_covariates_contrastive_loss: 950104.4775; val_gene_expr_recon_loss: 1809090.7902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16753.9355; val_global_loss: 3514349.4476; val_optim_loss: 3514349.4476
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9303; val_auprc_score: 0.9839; val_best_acc_score: 0.9354; val_best_f1_score: 0.9634; train_kl_reg_loss: 27172.9964; train_edge_recon_loss: 690062.5217; train_cat_covariates_contrastive_loss: 949933.4138; train_gene_expr_recon_loss: 1808779.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16716.5786; train_global_loss: 3492665.4102; train_optim_loss: 3492665.4102; val_kl_reg_loss: 26841.1666; val_edge_recon_loss: 712177.6700; val_cat_covariates_contrastive_loss: 952019.6093; val_gene_expr_recon_loss: 1809258.9537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16821.4883; val_global_loss: 3517118.9100; val_optim_loss: 3517118.9100
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9328; val_auprc_score: 0.9847; val_best_acc_score: 0.9367; val_best_f1_score: 0.9643; train_kl_reg_loss: 27340.4543; train_edge_recon_loss: 688489.9557; train_cat_covariates_contrastive_loss: 949989.8275; train_gene_expr_recon_loss: 1801161.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16752.9305; train_global_loss: 3483734.8225; train_optim_loss: 3483734.8225; val_kl_reg_loss: 26692.1169; val_edge_recon_loss: 707474.6108; val_cat_covariates_contrastive_loss: 951950.0245; val_gene_expr_recon_loss: 1802262.9838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16986.9766; val_global_loss: 3505366.7448; val_optim_loss: 3505366.7448
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9324; val_auprc_score: 0.9844; val_best_acc_score: 0.9362; val_best_f1_score: 0.9639; train_kl_reg_loss: 27185.2164; train_edge_recon_loss: 688208.5390; train_cat_covariates_contrastive_loss: 949969.2957; train_gene_expr_recon_loss: 1800256.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16774.8614; train_global_loss: 3482394.7417; train_optim_loss: 3482394.7417; val_kl_reg_loss: 26637.7611; val_edge_recon_loss: 714993.5461; val_cat_covariates_contrastive_loss: 951487.6372; val_gene_expr_recon_loss: 1802088.7666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16743.8652; val_global_loss: 3511951.4712; val_optim_loss: 3511951.4712
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9324; val_auprc_score: 0.9845; val_best_acc_score: 0.9375; val_best_f1_score: 0.9648; train_kl_reg_loss: 27201.6313; train_edge_recon_loss: 690286.8167; train_cat_covariates_contrastive_loss: 949993.4679; train_gene_expr_recon_loss: 1798256.4628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16828.1814; train_global_loss: 3482566.5606; train_optim_loss: 3482566.5606; val_kl_reg_loss: 27939.7743; val_edge_recon_loss: 706835.3134; val_cat_covariates_contrastive_loss: 949518.2172; val_gene_expr_recon_loss: 1800600.5503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16806.0000; val_global_loss: 3501699.8540; val_optim_loss: 3501699.8540
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9320; val_auprc_score: 0.9844; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 27247.6220; train_edge_recon_loss: 686103.2594; train_cat_covariates_contrastive_loss: 950095.0362; train_gene_expr_recon_loss: 1795385.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16876.1605; train_global_loss: 3475707.1951; train_optim_loss: 3475707.1951; val_kl_reg_loss: 28471.7355; val_edge_recon_loss: 703303.0816; val_cat_covariates_contrastive_loss: 949530.2994; val_gene_expr_recon_loss: 1801242.9309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16787.7715; val_global_loss: 3499335.7946; val_optim_loss: 3499335.7946
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9331; val_auprc_score: 0.9846; val_best_acc_score: 0.9353; val_best_f1_score: 0.9633; train_kl_reg_loss: 27530.3125; train_edge_recon_loss: 687256.5639; train_cat_covariates_contrastive_loss: 950081.9877; train_gene_expr_recon_loss: 1795614.1737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16894.2131; train_global_loss: 3477377.2514; train_optim_loss: 3477377.2514; val_kl_reg_loss: 27725.0274; val_edge_recon_loss: 712052.1796; val_cat_covariates_contrastive_loss: 950958.5750; val_gene_expr_recon_loss: 1799790.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16919.7109; val_global_loss: 3507445.7115; val_optim_loss: 3507445.7115
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9300; val_auprc_score: 0.9838; val_best_acc_score: 0.9361; val_best_f1_score: 0.9639; train_kl_reg_loss: 26972.6101; train_edge_recon_loss: 688540.0231; train_cat_covariates_contrastive_loss: 949888.5226; train_gene_expr_recon_loss: 1891161.6414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17132.5879; train_global_loss: 3573695.3866; train_optim_loss: 3573695.3866; val_kl_reg_loss: 28462.6149; val_edge_recon_loss: 707647.3157; val_cat_covariates_contrastive_loss: 949034.9058; val_gene_expr_recon_loss: 1916386.3566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17112.9492; val_global_loss: 3618644.1932; val_optim_loss: 3618644.1932
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9280; val_auprc_score: 0.9830; val_best_acc_score: 0.9360; val_best_f1_score: 0.9638; train_kl_reg_loss: 28145.8578; train_edge_recon_loss: 687263.0137; train_cat_covariates_contrastive_loss: 950333.6297; train_gene_expr_recon_loss: 1838953.8384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17013.9736; train_global_loss: 3521710.3125; train_optim_loss: 3521710.3125; val_kl_reg_loss: 29386.2959; val_edge_recon_loss: 716173.9720; val_cat_covariates_contrastive_loss: 948299.8960; val_gene_expr_recon_loss: 1810468.2823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16876.3496; val_global_loss: 3521204.6993; val_optim_loss: 3521204.6993
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9237; val_auprc_score: 0.9826; val_best_acc_score: 0.9284; val_best_f1_score: 0.9596; train_kl_reg_loss: 24322.1783; train_edge_recon_loss: 692570.5042; train_cat_covariates_contrastive_loss: 950622.7281; train_gene_expr_recon_loss: 1619077.4574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13686.9100; train_global_loss: 3300279.7765; train_optim_loss: 3300279.7765; val_kl_reg_loss: 21648.4599; val_edge_recon_loss: 718844.6809; val_cat_covariates_contrastive_loss: 949530.7485; val_gene_expr_recon_loss: 1598505.9117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13567.0420; val_global_loss: 3302096.8016; val_optim_loss: 3302096.8016
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9245; val_auprc_score: 0.9828; val_best_acc_score: 0.9315; val_best_f1_score: 0.9614; train_kl_reg_loss: 23068.8859; train_edge_recon_loss: 688683.4948; train_cat_covariates_contrastive_loss: 949379.7595; train_gene_expr_recon_loss: 1585466.2579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13614.0581; train_global_loss: 3260212.4568; train_optim_loss: 3260212.4568; val_kl_reg_loss: 21746.8569; val_edge_recon_loss: 701747.5927; val_cat_covariates_contrastive_loss: 948713.3521; val_gene_expr_recon_loss: 1571775.6674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13663.9873; val_global_loss: 3257647.4642; val_optim_loss: 3257647.4642
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9215; val_auprc_score: 0.9815; val_best_acc_score: 0.9317; val_best_f1_score: 0.9615; train_kl_reg_loss: 20325.7934; train_edge_recon_loss: 687613.1854; train_cat_covariates_contrastive_loss: 948437.8877; train_gene_expr_recon_loss: 1725387.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13276.5729; train_global_loss: 3395041.2522; train_optim_loss: 3395041.2522; val_kl_reg_loss: 20563.6713; val_edge_recon_loss: 715457.4382; val_cat_covariates_contrastive_loss: 948499.1031; val_gene_expr_recon_loss: 1593686.5201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12859.1836; val_global_loss: 3291065.9921; val_optim_loss: 3291065.9921
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9275; val_auprc_score: 0.9836; val_best_acc_score: 0.9323; val_best_f1_score: 0.9618; train_kl_reg_loss: 21185.3201; train_edge_recon_loss: 685925.6938; train_cat_covariates_contrastive_loss: 948639.2414; train_gene_expr_recon_loss: 1565443.9361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13020.8237; train_global_loss: 3234215.0154; train_optim_loss: 3234215.0154; val_kl_reg_loss: 20618.2048; val_edge_recon_loss: 702702.3081; val_cat_covariates_contrastive_loss: 949299.7015; val_gene_expr_recon_loss: 1543411.5660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13026.1445; val_global_loss: 3229058.0323; val_optim_loss: 3229058.0323
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9249; val_auprc_score: 0.9826; val_best_acc_score: 0.9299; val_best_f1_score: 0.9604; train_kl_reg_loss: 21236.0526; train_edge_recon_loss: 688864.7424; train_cat_covariates_contrastive_loss: 948593.0343; train_gene_expr_recon_loss: 1532031.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13010.8601; train_global_loss: 3203736.3484; train_optim_loss: 3203736.3484; val_kl_reg_loss: 21120.2184; val_edge_recon_loss: 718525.6858; val_cat_covariates_contrastive_loss: 948648.4159; val_gene_expr_recon_loss: 1515382.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13049.9805; val_global_loss: 3216726.8374; val_optim_loss: 3216726.8374
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9266; val_auprc_score: 0.9828; val_best_acc_score: 0.9332; val_best_f1_score: 0.9622; train_kl_reg_loss: 21573.4069; train_edge_recon_loss: 686590.7130; train_cat_covariates_contrastive_loss: 948456.4391; train_gene_expr_recon_loss: 1511505.0007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13019.6936; train_global_loss: 3181145.2543; train_optim_loss: 3181145.2543; val_kl_reg_loss: 22018.7828; val_edge_recon_loss: 715314.6290; val_cat_covariates_contrastive_loss: 947841.4014; val_gene_expr_recon_loss: 1502765.6722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13101.4814; val_global_loss: 3201041.9851; val_optim_loss: 3201041.9851
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9275; val_auprc_score: 0.9830; val_best_acc_score: 0.9354; val_best_f1_score: 0.9635; train_kl_reg_loss: 21511.1414; train_edge_recon_loss: 686147.0616; train_cat_covariates_contrastive_loss: 948489.3108; train_gene_expr_recon_loss: 1506133.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13025.3781; train_global_loss: 3175306.5752; train_optim_loss: 3175306.5752; val_kl_reg_loss: 21992.3314; val_edge_recon_loss: 703429.3888; val_cat_covariates_contrastive_loss: 948082.3285; val_gene_expr_recon_loss: 1504756.3378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13121.0078; val_global_loss: 3191381.3995; val_optim_loss: 3191381.3995
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9277; val_auprc_score: 0.9830; val_best_acc_score: 0.9337; val_best_f1_score: 0.9625; train_kl_reg_loss: 22106.1827; train_edge_recon_loss: 684518.2295; train_cat_covariates_contrastive_loss: 948507.9202; train_gene_expr_recon_loss: 1499710.9484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13036.2688; train_global_loss: 3167879.5519; train_optim_loss: 3167879.5519; val_kl_reg_loss: 21509.4147; val_edge_recon_loss: 712738.5579; val_cat_covariates_contrastive_loss: 948630.4172; val_gene_expr_recon_loss: 1493443.1158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13124.5215; val_global_loss: 3189445.9983; val_optim_loss: 3189445.9983
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9237; val_auprc_score: 0.9823; val_best_acc_score: 0.9331; val_best_f1_score: 0.9622; train_kl_reg_loss: 41038.9381; train_edge_recon_loss: 690658.3746; train_cat_covariates_contrastive_loss: 948680.4117; train_gene_expr_recon_loss: 1522245.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13063.6297; train_global_loss: 3215686.5769; train_optim_loss: 3215686.5769; val_kl_reg_loss: 23797.5139; val_edge_recon_loss: 712041.9569; val_cat_covariates_contrastive_loss: 948338.2402; val_gene_expr_recon_loss: 1513372.0424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13119.9854; val_global_loss: 3210669.7570; val_optim_loss: 3210669.7570
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9277; val_auprc_score: 0.9833; val_best_acc_score: 0.9334; val_best_f1_score: 0.9625; train_kl_reg_loss: 23226.0088; train_edge_recon_loss: 688156.6153; train_cat_covariates_contrastive_loss: 949169.0639; train_gene_expr_recon_loss: 1469533.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12979.2445; train_global_loss: 3143064.3789; train_optim_loss: 3143064.3789; val_kl_reg_loss: 21427.9647; val_edge_recon_loss: 704776.2889; val_cat_covariates_contrastive_loss: 948666.9288; val_gene_expr_recon_loss: 1455336.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13016.7500; val_global_loss: 3143223.9904; val_optim_loss: 3143223.9904
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9291; val_auprc_score: 0.9834; val_best_acc_score: 0.9322; val_best_f1_score: 0.9616; train_kl_reg_loss: 23125.4721; train_edge_recon_loss: 689154.9126; train_cat_covariates_contrastive_loss: 948764.0980; train_gene_expr_recon_loss: 1456480.0415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12967.6427; train_global_loss: 3130492.1684; train_optim_loss: 3130492.1684; val_kl_reg_loss: 21791.5223; val_edge_recon_loss: 715104.2087; val_cat_covariates_contrastive_loss: 949497.7391; val_gene_expr_recon_loss: 1451039.8339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13026.9668; val_global_loss: 3150460.3173; val_optim_loss: 3150460.3173
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9261; val_auprc_score: 0.9827; val_best_acc_score: 0.9332; val_best_f1_score: 0.9623; train_kl_reg_loss: 22623.2732; train_edge_recon_loss: 687608.0223; train_cat_covariates_contrastive_loss: 948653.3911; train_gene_expr_recon_loss: 1451853.3049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12997.6805; train_global_loss: 3123735.6741; train_optim_loss: 3123735.6741; val_kl_reg_loss: 35978.0937; val_edge_recon_loss: 709342.6478; val_cat_covariates_contrastive_loss: 948105.4764; val_gene_expr_recon_loss: 1549449.2452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13229.0430; val_global_loss: 3256104.4720; val_optim_loss: 3256104.4720
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9254; val_auprc_score: 0.9822; val_best_acc_score: 0.9324; val_best_f1_score: 0.9618; train_kl_reg_loss: 132999.6087; train_edge_recon_loss: 691349.5027; train_cat_covariates_contrastive_loss: 949271.7728; train_gene_expr_recon_loss: 1618293.5193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13122.5129; train_global_loss: 3405036.9119; train_optim_loss: 3405036.9119; val_kl_reg_loss: 24527.1912; val_edge_recon_loss: 714530.4279; val_cat_covariates_contrastive_loss: 948164.6095; val_gene_expr_recon_loss: 1462557.1119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13027.3057; val_global_loss: 3162806.6014; val_optim_loss: 3162806.6014
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9260; val_auprc_score: 0.9829; val_best_acc_score: 0.9327; val_best_f1_score: 0.9620; train_kl_reg_loss: 23748.5236; train_edge_recon_loss: 686377.7111; train_cat_covariates_contrastive_loss: 948916.1195; train_gene_expr_recon_loss: 1447657.3578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12993.4826; train_global_loss: 3119693.1940; train_optim_loss: 3119693.1940; val_kl_reg_loss: 22957.8823; val_edge_recon_loss: 710576.8835; val_cat_covariates_contrastive_loss: 948635.8647; val_gene_expr_recon_loss: 1433636.4642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12931.5977; val_global_loss: 3128738.5953; val_optim_loss: 3128738.5953
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9274; val_auprc_score: 0.9834; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 23337.0798; train_edge_recon_loss: 689589.3867; train_cat_covariates_contrastive_loss: 948911.9015; train_gene_expr_recon_loss: 1426312.5231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13019.1972; train_global_loss: 3101170.0881; train_optim_loss: 3101170.0881; val_kl_reg_loss: 22229.8293; val_edge_recon_loss: 708858.3337; val_cat_covariates_contrastive_loss: 948359.7478; val_gene_expr_recon_loss: 1423076.1455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12935.0342; val_global_loss: 3115459.0638; val_optim_loss: 3115459.0638
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9311; val_auprc_score: 0.9843; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 22779.9354; train_edge_recon_loss: 687980.9889; train_cat_covariates_contrastive_loss: 948738.3225; train_gene_expr_recon_loss: 1414765.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13072.1135; train_global_loss: 3087336.7063; train_optim_loss: 3087336.7063; val_kl_reg_loss: 25124.7188; val_edge_recon_loss: 703845.2823; val_cat_covariates_contrastive_loss: 949227.9882; val_gene_expr_recon_loss: 1411143.2207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13174.3330; val_global_loss: 3102515.4615; val_optim_loss: 3102515.4615
