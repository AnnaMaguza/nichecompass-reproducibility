[True, False, True]
Run timestamp: 05092023_121353_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '500000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9016; val_auprc_score: 0.9805; val_best_acc_score: 0.9193; val_best_f1_score: 0.9548; train_kl_reg_loss: 16947.5027; train_edge_recon_loss: 722249.3804; train_cat_covariates_contrastive_loss: 478221.0511; train_gene_expr_recon_loss: 2557912.8273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58052.6760; train_global_loss: 3833383.4328; train_optim_loss: 3833383.4328; val_kl_reg_loss: 17087.2088; val_edge_recon_loss: 724684.0039; val_cat_covariates_contrastive_loss: 478374.4810; val_gene_expr_recon_loss: 2234039.6941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14183.3496; val_global_loss: 3468368.6469; val_optim_loss: 3468368.6469
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9169; val_auprc_score: 0.9835; val_best_acc_score: 0.9275; val_best_f1_score: 0.9594; train_kl_reg_loss: 19034.5006; train_edge_recon_loss: 696590.5974; train_cat_covariates_contrastive_loss: 477991.9246; train_gene_expr_recon_loss: 2092604.1850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14503.6370; train_global_loss: 3300724.8438; train_optim_loss: 3300724.8438; val_kl_reg_loss: 19832.1427; val_edge_recon_loss: 714891.6840; val_cat_covariates_contrastive_loss: 479201.8443; val_gene_expr_recon_loss: 2014382.9462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14553.0264; val_global_loss: 3242861.6066; val_optim_loss: 3242861.6066
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9222; val_auprc_score: 0.9847; val_best_acc_score: 0.9290; val_best_f1_score: 0.9600; train_kl_reg_loss: 20954.0959; train_edge_recon_loss: 694335.2086; train_cat_covariates_contrastive_loss: 478300.5167; train_gene_expr_recon_loss: 1971095.7426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14836.4547; train_global_loss: 3179522.0190; train_optim_loss: 3179522.0190; val_kl_reg_loss: 21010.6939; val_edge_recon_loss: 721915.7439; val_cat_covariates_contrastive_loss: 479047.9395; val_gene_expr_recon_loss: 1954355.2111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14889.0029; val_global_loss: 3191218.5883; val_optim_loss: 3191218.5883
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9276; val_auprc_score: 0.9858; val_best_acc_score: 0.9318; val_best_f1_score: 0.9617; train_kl_reg_loss: 21861.5500; train_edge_recon_loss: 691531.0138; train_cat_covariates_contrastive_loss: 478296.7197; train_gene_expr_recon_loss: 1925175.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15246.9660; train_global_loss: 3132111.8456; train_optim_loss: 3132111.8456; val_kl_reg_loss: 21515.9751; val_edge_recon_loss: 712016.3920; val_cat_covariates_contrastive_loss: 479512.4149; val_gene_expr_recon_loss: 1923365.9921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15333.3193; val_global_loss: 3151744.0288; val_optim_loss: 3151744.0288
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9223; val_auprc_score: 0.9843; val_best_acc_score: 0.9298; val_best_f1_score: 0.9606; train_kl_reg_loss: 22523.2742; train_edge_recon_loss: 689749.5205; train_cat_covariates_contrastive_loss: 478479.0966; train_gene_expr_recon_loss: 1898301.4418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15623.0668; train_global_loss: 3104676.4008; train_optim_loss: 3104676.4008; val_kl_reg_loss: 23325.8817; val_edge_recon_loss: 713774.3879; val_cat_covariates_contrastive_loss: 477599.6420; val_gene_expr_recon_loss: 1898649.2247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15666.1650; val_global_loss: 3129015.3846; val_optim_loss: 3129015.3846
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9274; val_auprc_score: 0.9855; val_best_acc_score: 0.9321; val_best_f1_score: 0.9619; train_kl_reg_loss: 23140.3499; train_edge_recon_loss: 692762.1423; train_cat_covariates_contrastive_loss: 478684.7523; train_gene_expr_recon_loss: 1881221.9332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15915.6905; train_global_loss: 3091724.8708; train_optim_loss: 3091724.8708; val_kl_reg_loss: 23109.1089; val_edge_recon_loss: 712994.0116; val_cat_covariates_contrastive_loss: 479574.7308; val_gene_expr_recon_loss: 1881977.2609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15936.8301; val_global_loss: 3113591.8566; val_optim_loss: 3113591.8566
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9267; val_auprc_score: 0.9851; val_best_acc_score: 0.9321; val_best_f1_score: 0.9617; train_kl_reg_loss: 23627.6127; train_edge_recon_loss: 687537.5331; train_cat_covariates_contrastive_loss: 478886.6406; train_gene_expr_recon_loss: 1865449.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16194.9221; train_global_loss: 3071696.3024; train_optim_loss: 3071696.3024; val_kl_reg_loss: 24058.7252; val_edge_recon_loss: 717298.7012; val_cat_covariates_contrastive_loss: 478572.8797; val_gene_expr_recon_loss: 1866858.4480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16399.6113; val_global_loss: 3103188.2552; val_optim_loss: 3103188.2552
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9233; val_auprc_score: 0.9841; val_best_acc_score: 0.9323; val_best_f1_score: 0.9619; train_kl_reg_loss: 24072.5808; train_edge_recon_loss: 688909.3972; train_cat_covariates_contrastive_loss: 479062.6065; train_gene_expr_recon_loss: 1854186.9110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16389.8812; train_global_loss: 3062621.3790; train_optim_loss: 3062621.3790; val_kl_reg_loss: 25486.2088; val_edge_recon_loss: 712392.5491; val_cat_covariates_contrastive_loss: 477455.4559; val_gene_expr_recon_loss: 1857841.8129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16521.8438; val_global_loss: 3089697.7736; val_optim_loss: 3089697.7736
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9308; val_auprc_score: 0.9863; val_best_acc_score: 0.9348; val_best_f1_score: 0.9633; train_kl_reg_loss: 24540.9611; train_edge_recon_loss: 690331.6843; train_cat_covariates_contrastive_loss: 479153.0492; train_gene_expr_recon_loss: 1846014.5097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16524.8590; train_global_loss: 3056565.0608; train_optim_loss: 3056565.0608; val_kl_reg_loss: 25272.4245; val_edge_recon_loss: 704000.0479; val_cat_covariates_contrastive_loss: 478270.4396; val_gene_expr_recon_loss: 1854354.6390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16500.5938; val_global_loss: 3078398.0481; val_optim_loss: 3078398.0481
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9296; val_auprc_score: 0.9855; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 24892.7914; train_edge_recon_loss: 688328.3328; train_cat_covariates_contrastive_loss: 479250.1037; train_gene_expr_recon_loss: 1837216.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16623.9340; train_global_loss: 3046311.9694; train_optim_loss: 3046311.9694; val_kl_reg_loss: 25380.1552; val_edge_recon_loss: 718942.7633; val_cat_covariates_contrastive_loss: 478606.7873; val_gene_expr_recon_loss: 1841740.3112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16661.3242; val_global_loss: 3081331.2675; val_optim_loss: 3081331.2675
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9316; val_auprc_score: 0.9863; val_best_acc_score: 0.9346; val_best_f1_score: 0.9632; train_kl_reg_loss: 25168.8869; train_edge_recon_loss: 689835.2643; train_cat_covariates_contrastive_loss: 479411.3141; train_gene_expr_recon_loss: 1830455.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16672.7310; train_global_loss: 3041543.2973; train_optim_loss: 3041543.2973; val_kl_reg_loss: 25062.3209; val_edge_recon_loss: 709199.6368; val_cat_covariates_contrastive_loss: 479561.0091; val_gene_expr_recon_loss: 1838002.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16775.5234; val_global_loss: 3068600.7185; val_optim_loss: 3068600.7185
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9331; val_auprc_score: 0.9865; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 25413.4204; train_edge_recon_loss: 692304.4355; train_cat_covariates_contrastive_loss: 479475.9340; train_gene_expr_recon_loss: 1826498.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16759.6519; train_global_loss: 3040451.8941; train_optim_loss: 3040451.8941; val_kl_reg_loss: 26333.1213; val_edge_recon_loss: 711035.9679; val_cat_covariates_contrastive_loss: 478985.0928; val_gene_expr_recon_loss: 1833827.1897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16659.1367; val_global_loss: 3066840.6154; val_optim_loss: 3066840.6154
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9340; val_auprc_score: 0.9868; val_best_acc_score: 0.9340; val_best_f1_score: 0.9627; train_kl_reg_loss: 25588.2221; train_edge_recon_loss: 693187.5369; train_cat_covariates_contrastive_loss: 479634.1865; train_gene_expr_recon_loss: 1821124.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16773.8696; train_global_loss: 3036308.1228; train_optim_loss: 3036308.1228; val_kl_reg_loss: 25097.7563; val_edge_recon_loss: 712436.3295; val_cat_covariates_contrastive_loss: 480270.1903; val_gene_expr_recon_loss: 1828477.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16729.7676; val_global_loss: 3063011.8733; val_optim_loss: 3063011.8733
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9350; val_auprc_score: 0.9872; val_best_acc_score: 0.9358; val_best_f1_score: 0.9637; train_kl_reg_loss: 25678.7109; train_edge_recon_loss: 689098.4451; train_cat_covariates_contrastive_loss: 479605.7681; train_gene_expr_recon_loss: 1817429.2379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16863.4741; train_global_loss: 3028675.6354; train_optim_loss: 3028675.6354; val_kl_reg_loss: 25749.7242; val_edge_recon_loss: 709721.5493; val_cat_covariates_contrastive_loss: 480168.4427; val_gene_expr_recon_loss: 1828049.5621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16854.5840; val_global_loss: 3060543.7780; val_optim_loss: 3060543.7780
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9356; val_auprc_score: 0.9869; val_best_acc_score: 0.9367; val_best_f1_score: 0.9643; train_kl_reg_loss: 25855.0751; train_edge_recon_loss: 688834.0773; train_cat_covariates_contrastive_loss: 479526.0480; train_gene_expr_recon_loss: 1812267.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16918.9573; train_global_loss: 3023402.0546; train_optim_loss: 3023402.0546; val_kl_reg_loss: 25451.2956; val_edge_recon_loss: 716890.7461; val_cat_covariates_contrastive_loss: 479414.1329; val_gene_expr_recon_loss: 1818679.4283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17022.5352; val_global_loss: 3057458.1093; val_optim_loss: 3057458.1093
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9333; val_auprc_score: 0.9862; val_best_acc_score: 0.9378; val_best_f1_score: 0.9650; train_kl_reg_loss: 26007.9457; train_edge_recon_loss: 689827.2030; train_cat_covariates_contrastive_loss: 479654.2688; train_gene_expr_recon_loss: 1811631.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16976.3506; train_global_loss: 3024097.5992; train_optim_loss: 3024097.5992; val_kl_reg_loss: 27049.3999; val_edge_recon_loss: 713538.2651; val_cat_covariates_contrastive_loss: 478358.1286; val_gene_expr_recon_loss: 1815777.4952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17126.1934; val_global_loss: 3051849.5455; val_optim_loss: 3051849.5455
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9321; val_auprc_score: 0.9861; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 26258.6049; train_edge_recon_loss: 689204.4557; train_cat_covariates_contrastive_loss: 479693.0515; train_gene_expr_recon_loss: 1810932.2042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17005.5746; train_global_loss: 3023093.8914; train_optim_loss: 3023093.8914; val_kl_reg_loss: 27119.0968; val_edge_recon_loss: 710308.2147; val_cat_covariates_contrastive_loss: 478577.7315; val_gene_expr_recon_loss: 1816075.9685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16953.0586; val_global_loss: 3049034.0175; val_optim_loss: 3049034.0175
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9354; val_auprc_score: 0.9872; val_best_acc_score: 0.9357; val_best_f1_score: 0.9638; train_kl_reg_loss: 26242.8486; train_edge_recon_loss: 688588.3562; train_cat_covariates_contrastive_loss: 479703.1157; train_gene_expr_recon_loss: 1803905.9088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17049.1268; train_global_loss: 3015489.3524; train_optim_loss: 3015489.3524; val_kl_reg_loss: 26556.4744; val_edge_recon_loss: 705043.1230; val_cat_covariates_contrastive_loss: 479921.5582; val_gene_expr_recon_loss: 1811703.4235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17111.3184; val_global_loss: 3040335.8295; val_optim_loss: 3040335.8295
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9342; val_auprc_score: 0.9863; val_best_acc_score: 0.9381; val_best_f1_score: 0.9651; train_kl_reg_loss: 26297.5218; train_edge_recon_loss: 687898.9643; train_cat_covariates_contrastive_loss: 479756.3952; train_gene_expr_recon_loss: 1802425.7181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17122.6528; train_global_loss: 3013501.2562; train_optim_loss: 3013501.2562; val_kl_reg_loss: 26742.3611; val_edge_recon_loss: 714746.8538; val_cat_covariates_contrastive_loss: 478957.4508; val_gene_expr_recon_loss: 1813679.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17158.2441; val_global_loss: 3051284.9003; val_optim_loss: 3051284.9003
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9857; val_best_acc_score: 0.9362; val_best_f1_score: 0.9640; train_kl_reg_loss: 26349.3972; train_edge_recon_loss: 687366.8600; train_cat_covariates_contrastive_loss: 479703.2361; train_gene_expr_recon_loss: 1800608.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17173.0378; train_global_loss: 3011201.2684; train_optim_loss: 3011201.2684; val_kl_reg_loss: 27722.3773; val_edge_recon_loss: 711951.9111; val_cat_covariates_contrastive_loss: 478406.7242; val_gene_expr_recon_loss: 1811715.5179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17135.9863; val_global_loss: 3046932.5306; val_optim_loss: 3046932.5306
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9373; val_auprc_score: 0.9876; val_best_acc_score: 0.9367; val_best_f1_score: 0.9642; train_kl_reg_loss: 26471.3218; train_edge_recon_loss: 689571.4662; train_cat_covariates_contrastive_loss: 479697.9826; train_gene_expr_recon_loss: 1797473.9560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17232.5340; train_global_loss: 3010447.2587; train_optim_loss: 3010447.2587; val_kl_reg_loss: 26680.4819; val_edge_recon_loss: 707871.5710; val_cat_covariates_contrastive_loss: 480295.1329; val_gene_expr_recon_loss: 1812569.9585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17252.1953; val_global_loss: 3044669.3934; val_optim_loss: 3044669.3934
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9362; val_auprc_score: 0.9871; val_best_acc_score: 0.9374; val_best_f1_score: 0.9647; train_kl_reg_loss: 26703.9551; train_edge_recon_loss: 686044.6229; train_cat_covariates_contrastive_loss: 479868.1576; train_gene_expr_recon_loss: 1795542.1678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17260.1055; train_global_loss: 3005419.0098; train_optim_loss: 3005419.0098; val_kl_reg_loss: 26968.9962; val_edge_recon_loss: 712505.5273; val_cat_covariates_contrastive_loss: 479642.4504; val_gene_expr_recon_loss: 1813970.7059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17296.6230; val_global_loss: 3050384.1836; val_optim_loss: 3050384.1836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9381; val_auprc_score: 0.9873; val_best_acc_score: 0.9378; val_best_f1_score: 0.9648; train_kl_reg_loss: 26729.1249; train_edge_recon_loss: 687238.4862; train_cat_covariates_contrastive_loss: 479884.5441; train_gene_expr_recon_loss: 1768291.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8850.8845; train_global_loss: 2970994.2386; train_optim_loss: 2970994.2386; val_kl_reg_loss: 26960.0009; val_edge_recon_loss: 715441.4884; val_cat_covariates_contrastive_loss: 479869.3837; val_gene_expr_recon_loss: 1779085.2928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8787.9727; val_global_loss: 3010144.1635; val_optim_loss: 3010144.1635
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9383; val_auprc_score: 0.9873; val_best_acc_score: 0.9396; val_best_f1_score: 0.9659; train_kl_reg_loss: 26604.7564; train_edge_recon_loss: 687227.6918; train_cat_covariates_contrastive_loss: 479612.0203; train_gene_expr_recon_loss: 1761342.6032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8823.6113; train_global_loss: 2963610.6819; train_optim_loss: 2963610.6819; val_kl_reg_loss: 26495.8420; val_edge_recon_loss: 707482.2998; val_cat_covariates_contrastive_loss: 479862.7849; val_gene_expr_recon_loss: 1775872.6088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8854.9199; val_global_loss: 2998568.5358; val_optim_loss: 2998568.5358
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9411; val_auprc_score: 0.9881; val_best_acc_score: 0.9399; val_best_f1_score: 0.9661; train_kl_reg_loss: 26380.6332; train_edge_recon_loss: 688036.5486; train_cat_covariates_contrastive_loss: 479615.9950; train_gene_expr_recon_loss: 1759523.6028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8864.2338; train_global_loss: 2962421.0167; train_optim_loss: 2962421.0167; val_kl_reg_loss: 26399.9698; val_edge_recon_loss: 706848.3428; val_cat_covariates_contrastive_loss: 479550.4059; val_gene_expr_recon_loss: 1774474.6351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8887.0039; val_global_loss: 2996160.3497; val_optim_loss: 2996160.3497
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9197; val_auprc_score: 0.9838; val_best_acc_score: 0.9278; val_best_f1_score: 0.9595; train_kl_reg_loss: 24546.0017; train_edge_recon_loss: 696754.8059; train_cat_covariates_contrastive_loss: 480676.5093; train_gene_expr_recon_loss: 1611510.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6742.9697; train_global_loss: 2820230.6921; train_optim_loss: 2820230.6921; val_kl_reg_loss: 16972.4389; val_edge_recon_loss: 720296.5392; val_cat_covariates_contrastive_loss: 479836.6316; val_gene_expr_recon_loss: 1611065.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5998.5420; val_global_loss: 2834169.9493; val_optim_loss: 2834169.9493
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9205; val_auprc_score: 0.9838; val_best_acc_score: 0.9286; val_best_f1_score: 0.9599; train_kl_reg_loss: 22250.8543; train_edge_recon_loss: 692349.1059; train_cat_covariates_contrastive_loss: 479140.7795; train_gene_expr_recon_loss: 1595498.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5957.4842; train_global_loss: 2795197.0329; train_optim_loss: 2795197.0329; val_kl_reg_loss: 17740.2643; val_edge_recon_loss: 720811.9209; val_cat_covariates_contrastive_loss: 479002.0049; val_gene_expr_recon_loss: 1602955.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5926.2734; val_global_loss: 2826436.0481; val_optim_loss: 2826436.0481
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9262; val_auprc_score: 0.9851; val_best_acc_score: 0.9315; val_best_f1_score: 0.9614; train_kl_reg_loss: 21247.8431; train_edge_recon_loss: 690500.8159; train_cat_covariates_contrastive_loss: 478526.3536; train_gene_expr_recon_loss: 1585349.2276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5939.2064; train_global_loss: 2781563.4456; train_optim_loss: 2781563.4456; val_kl_reg_loss: 18419.1538; val_edge_recon_loss: 715786.9920; val_cat_covariates_contrastive_loss: 478454.0290; val_gene_expr_recon_loss: 1592748.7684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5959.0928; val_global_loss: 2811367.9458; val_optim_loss: 2811367.9458
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9260; val_auprc_score: 0.9850; val_best_acc_score: 0.9315; val_best_f1_score: 0.9615; train_kl_reg_loss: 20692.7777; train_edge_recon_loss: 690866.4991; train_cat_covariates_contrastive_loss: 478299.0019; train_gene_expr_recon_loss: 1576334.6219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5955.3915; train_global_loss: 2772148.2924; train_optim_loss: 2772148.2924; val_kl_reg_loss: 18675.5816; val_edge_recon_loss: 712038.7389; val_cat_covariates_contrastive_loss: 478427.1742; val_gene_expr_recon_loss: 1583864.2006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6017.5815; val_global_loss: 2799023.1932; val_optim_loss: 2799023.1932
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9269; val_auprc_score: 0.9851; val_best_acc_score: 0.9317; val_best_f1_score: 0.9615; train_kl_reg_loss: 20542.6264; train_edge_recon_loss: 687747.6496; train_cat_covariates_contrastive_loss: 478213.1790; train_gene_expr_recon_loss: 1566321.6869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5957.4739; train_global_loss: 2758782.6118; train_optim_loss: 2758782.6118; val_kl_reg_loss: 18871.7642; val_edge_recon_loss: 714009.0579; val_cat_covariates_contrastive_loss: 477981.4100; val_gene_expr_recon_loss: 1573358.9467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5956.4688; val_global_loss: 2790177.6862; val_optim_loss: 2790177.6862
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9286; val_auprc_score: 0.9856; val_best_acc_score: 0.9335; val_best_f1_score: 0.9626; train_kl_reg_loss: 20215.3482; train_edge_recon_loss: 688841.1370; train_cat_covariates_contrastive_loss: 478219.8027; train_gene_expr_recon_loss: 1561532.7354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5988.5788; train_global_loss: 2754797.5993; train_optim_loss: 2754797.5993; val_kl_reg_loss: 19050.4545; val_edge_recon_loss: 702982.9561; val_cat_covariates_contrastive_loss: 477705.2437; val_gene_expr_recon_loss: 1569522.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5987.9863; val_global_loss: 2775248.7194; val_optim_loss: 2775248.7194
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9311; val_auprc_score: 0.9862; val_best_acc_score: 0.9335; val_best_f1_score: 0.9625; train_kl_reg_loss: 20114.3377; train_edge_recon_loss: 689929.4820; train_cat_covariates_contrastive_loss: 478110.8868; train_gene_expr_recon_loss: 1557622.9912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5995.1116; train_global_loss: 2751772.8089; train_optim_loss: 2751772.8089; val_kl_reg_loss: 18804.1027; val_edge_recon_loss: 712395.0011; val_cat_covariates_contrastive_loss: 478596.9458; val_gene_expr_recon_loss: 1567101.0044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6025.9497; val_global_loss: 2782923.0551; val_optim_loss: 2782923.0551
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9274; val_auprc_score: 0.9852; val_best_acc_score: 0.9340; val_best_f1_score: 0.9629; train_kl_reg_loss: 19972.1946; train_edge_recon_loss: 688805.6104; train_cat_covariates_contrastive_loss: 478017.2979; train_gene_expr_recon_loss: 1554630.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6021.6685; train_global_loss: 2747447.6186; train_optim_loss: 2747447.6186; val_kl_reg_loss: 19210.0468; val_edge_recon_loss: 703236.4983; val_cat_covariates_contrastive_loss: 477605.2543; val_gene_expr_recon_loss: 1565343.3724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5992.0381; val_global_loss: 2771387.1687; val_optim_loss: 2771387.1687
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9310; val_auprc_score: 0.9863; val_best_acc_score: 0.9335; val_best_f1_score: 0.9626; train_kl_reg_loss: 19854.5187; train_edge_recon_loss: 688134.4001; train_cat_covariates_contrastive_loss: 477970.4711; train_gene_expr_recon_loss: 1547245.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6037.8556; train_global_loss: 2739243.1585; train_optim_loss: 2739243.1585; val_kl_reg_loss: 19026.8736; val_edge_recon_loss: 706379.2660; val_cat_covariates_contrastive_loss: 478494.4411; val_gene_expr_recon_loss: 1556953.3628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6053.4155; val_global_loss: 2766907.4423; val_optim_loss: 2766907.4423
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9305; val_auprc_score: 0.9857; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 19835.7963; train_edge_recon_loss: 688647.9804; train_cat_covariates_contrastive_loss: 477977.4931; train_gene_expr_recon_loss: 1543902.1683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6042.2669; train_global_loss: 2736405.7072; train_optim_loss: 2736405.7072; val_kl_reg_loss: 19124.0546; val_edge_recon_loss: 713191.2841; val_cat_covariates_contrastive_loss: 477755.2969; val_gene_expr_recon_loss: 1554630.5201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6029.5649; val_global_loss: 2770730.6582; val_optim_loss: 2770730.6582
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9299; val_auprc_score: 0.9857; val_best_acc_score: 0.9335; val_best_f1_score: 0.9625; train_kl_reg_loss: 19736.0174; train_edge_recon_loss: 687500.7201; train_cat_covariates_contrastive_loss: 477843.8094; train_gene_expr_recon_loss: 1542279.4677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6060.7777; train_global_loss: 2733420.7928; train_optim_loss: 2733420.7928; val_kl_reg_loss: 19019.0547; val_edge_recon_loss: 715558.6567; val_cat_covariates_contrastive_loss: 478047.0990; val_gene_expr_recon_loss: 1551721.1132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6050.3311; val_global_loss: 2770396.1740; val_optim_loss: 2770396.1740
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9309; val_auprc_score: 0.9861; val_best_acc_score: 0.9340; val_best_f1_score: 0.9629; train_kl_reg_loss: 19656.7308; train_edge_recon_loss: 688168.4575; train_cat_covariates_contrastive_loss: 477770.1349; train_gene_expr_recon_loss: 1538181.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6081.1518; train_global_loss: 2729857.9056; train_optim_loss: 2729857.9056; val_kl_reg_loss: 19162.1980; val_edge_recon_loss: 705657.1123; val_cat_covariates_contrastive_loss: 477543.6042; val_gene_expr_recon_loss: 1544543.3396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6054.9380; val_global_loss: 2752961.2430; val_optim_loss: 2752961.2430
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9299; val_auprc_score: 0.9855; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 19564.7913; train_edge_recon_loss: 690072.6072; train_cat_covariates_contrastive_loss: 477721.2911; train_gene_expr_recon_loss: 1531249.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6088.3730; train_global_loss: 2724696.5957; train_optim_loss: 2724696.5957; val_kl_reg_loss: 19162.7149; val_edge_recon_loss: 712626.3042; val_cat_covariates_contrastive_loss: 477486.9059; val_gene_expr_recon_loss: 1542916.6346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6049.3213; val_global_loss: 2758241.8094; val_optim_loss: 2758241.8094
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9327; val_auprc_score: 0.9865; val_best_acc_score: 0.9353; val_best_f1_score: 0.9636; train_kl_reg_loss: 19511.7409; train_edge_recon_loss: 686687.7768; train_cat_covariates_contrastive_loss: 477668.3024; train_gene_expr_recon_loss: 1529814.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6100.2094; train_global_loss: 2719782.2441; train_optim_loss: 2719782.2441; val_kl_reg_loss: 19077.0005; val_edge_recon_loss: 701882.7941; val_cat_covariates_contrastive_loss: 477662.3535; val_gene_expr_recon_loss: 1541068.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6146.2417; val_global_loss: 2745837.2124; val_optim_loss: 2745837.2124
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9294; val_auprc_score: 0.9856; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 19461.1195; train_edge_recon_loss: 684436.6844; train_cat_covariates_contrastive_loss: 477614.8420; train_gene_expr_recon_loss: 1527723.8856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6111.1165; train_global_loss: 2715347.6492; train_optim_loss: 2715347.6492; val_kl_reg_loss: 19251.3198; val_edge_recon_loss: 705648.6204; val_cat_covariates_contrastive_loss: 477282.2110; val_gene_expr_recon_loss: 1538774.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6154.7358; val_global_loss: 2747111.0691; val_optim_loss: 2747111.0691
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9322; val_auprc_score: 0.9861; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 19395.8030; train_edge_recon_loss: 688900.3214; train_cat_covariates_contrastive_loss: 477668.9748; train_gene_expr_recon_loss: 1526876.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6127.6908; train_global_loss: 2718968.9792; train_optim_loss: 2718968.9792; val_kl_reg_loss: 18936.0286; val_edge_recon_loss: 713197.5341; val_cat_covariates_contrastive_loss: 477813.8502; val_gene_expr_recon_loss: 1539493.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6146.3838; val_global_loss: 2755587.5087; val_optim_loss: 2755587.5087
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9329; val_auprc_score: 0.9866; val_best_acc_score: 0.9353; val_best_f1_score: 0.9636; train_kl_reg_loss: 19371.3240; train_edge_recon_loss: 684056.2101; train_cat_covariates_contrastive_loss: 477593.5001; train_gene_expr_recon_loss: 1525688.3325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6143.8546; train_global_loss: 2712853.2241; train_optim_loss: 2712853.2241; val_kl_reg_loss: 19112.6797; val_edge_recon_loss: 706090.3700; val_cat_covariates_contrastive_loss: 477498.7528; val_gene_expr_recon_loss: 1536871.0686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6180.1035; val_global_loss: 2745752.8654; val_optim_loss: 2745752.8654
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9311; val_auprc_score: 0.9859; val_best_acc_score: 0.9344; val_best_f1_score: 0.9630; train_kl_reg_loss: 19320.8906; train_edge_recon_loss: 683460.7400; train_cat_covariates_contrastive_loss: 477468.6973; train_gene_expr_recon_loss: 1525054.9418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6157.1539; train_global_loss: 2711462.4240; train_optim_loss: 2711462.4240; val_kl_reg_loss: 19144.0209; val_edge_recon_loss: 710548.0806; val_cat_covariates_contrastive_loss: 477570.3432; val_gene_expr_recon_loss: 1535530.1827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6139.5796; val_global_loss: 2748932.1180; val_optim_loss: 2748932.1180
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9342; val_auprc_score: 0.9866; val_best_acc_score: 0.9348; val_best_f1_score: 0.9632; train_kl_reg_loss: 19269.4421; train_edge_recon_loss: 687218.3163; train_cat_covariates_contrastive_loss: 477506.8528; train_gene_expr_recon_loss: 1523267.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6174.2114; train_global_loss: 2713436.0277; train_optim_loss: 2713436.0277; val_kl_reg_loss: 18895.7633; val_edge_recon_loss: 714632.3811; val_cat_covariates_contrastive_loss: 477581.7138; val_gene_expr_recon_loss: 1535935.6740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6171.0581; val_global_loss: 2753216.5446; val_optim_loss: 2753216.5446
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9315; val_auprc_score: 0.9858; val_best_acc_score: 0.9351; val_best_f1_score: 0.9633; train_kl_reg_loss: 19200.9548; train_edge_recon_loss: 686872.6483; train_cat_covariates_contrastive_loss: 477490.1149; train_gene_expr_recon_loss: 1522476.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6195.4897; train_global_loss: 2712235.8846; train_optim_loss: 2712235.8846; val_kl_reg_loss: 19235.2249; val_edge_recon_loss: 714322.9814; val_cat_covariates_contrastive_loss: 476944.3573; val_gene_expr_recon_loss: 1535234.4987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.5850; val_global_loss: 2751902.5577; val_optim_loss: 2751902.5577
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9325; val_auprc_score: 0.9865; val_best_acc_score: 0.9346; val_best_f1_score: 0.9631; train_kl_reg_loss: 19188.8620; train_edge_recon_loss: 686957.3808; train_cat_covariates_contrastive_loss: 477411.2036; train_gene_expr_recon_loss: 1521370.8407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6198.7395; train_global_loss: 2711127.0255; train_optim_loss: 2711127.0255; val_kl_reg_loss: 19007.9019; val_edge_recon_loss: 707472.2237; val_cat_covariates_contrastive_loss: 477281.1672; val_gene_expr_recon_loss: 1531916.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6191.7734; val_global_loss: 2741869.2745; val_optim_loss: 2741869.2745
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9316; val_auprc_score: 0.9860; val_best_acc_score: 0.9355; val_best_f1_score: 0.9637; train_kl_reg_loss: 19148.0636; train_edge_recon_loss: 688972.2272; train_cat_covariates_contrastive_loss: 477413.0773; train_gene_expr_recon_loss: 1520734.3669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6211.4840; train_global_loss: 2712479.2197; train_optim_loss: 2712479.2197; val_kl_reg_loss: 18987.3077; val_edge_recon_loss: 705178.9729; val_cat_covariates_contrastive_loss: 476994.5573; val_gene_expr_recon_loss: 1531381.7679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6220.0825; val_global_loss: 2738762.6005; val_optim_loss: 2738762.6005
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9347; val_auprc_score: 0.9869; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 19096.0680; train_edge_recon_loss: 684925.1823; train_cat_covariates_contrastive_loss: 477388.1223; train_gene_expr_recon_loss: 1520018.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6236.3076; train_global_loss: 2707663.8105; train_optim_loss: 2707663.8105; val_kl_reg_loss: 18818.7721; val_edge_recon_loss: 704130.6255; val_cat_covariates_contrastive_loss: 477460.0233; val_gene_expr_recon_loss: 1532333.5778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6251.2852; val_global_loss: 2738994.2535; val_optim_loss: 2738994.2535
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9325; val_auprc_score: 0.9864; val_best_acc_score: 0.9360; val_best_f1_score: 0.9640; train_kl_reg_loss: 19056.3991; train_edge_recon_loss: 688388.7156; train_cat_covariates_contrastive_loss: 477322.8967; train_gene_expr_recon_loss: 1518259.3064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6251.1579; train_global_loss: 2709278.4781; train_optim_loss: 2709278.4781; val_kl_reg_loss: 18941.4176; val_edge_recon_loss: 702322.1141; val_cat_covariates_contrastive_loss: 476728.2377; val_gene_expr_recon_loss: 1529651.9148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6261.8604; val_global_loss: 2733905.4362; val_optim_loss: 2733905.4362
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9317; val_auprc_score: 0.9858; val_best_acc_score: 0.9351; val_best_f1_score: 0.9634; train_kl_reg_loss: 19042.5750; train_edge_recon_loss: 683876.0947; train_cat_covariates_contrastive_loss: 477309.9488; train_gene_expr_recon_loss: 1518497.9891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6266.8640; train_global_loss: 2704993.4714; train_optim_loss: 2704993.4714; val_kl_reg_loss: 18889.9764; val_edge_recon_loss: 711233.8979; val_cat_covariates_contrastive_loss: 477041.4598; val_gene_expr_recon_loss: 1529093.4213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6288.7744; val_global_loss: 2742547.5114; val_optim_loss: 2742547.5114
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9345; val_auprc_score: 0.9867; val_best_acc_score: 0.9356; val_best_f1_score: 0.9638; train_kl_reg_loss: 18982.4011; train_edge_recon_loss: 686489.9785; train_cat_covariates_contrastive_loss: 477235.7203; train_gene_expr_recon_loss: 1518541.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6284.7319; train_global_loss: 2707534.3121; train_optim_loss: 2707534.3121; val_kl_reg_loss: 18859.7935; val_edge_recon_loss: 710535.2188; val_cat_covariates_contrastive_loss: 477135.0066; val_gene_expr_recon_loss: 1530510.2478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6322.7622; val_global_loss: 2743363.0245; val_optim_loss: 2743363.0245
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9343; val_auprc_score: 0.9865; val_best_acc_score: 0.9356; val_best_f1_score: 0.9637; train_kl_reg_loss: 18968.0733; train_edge_recon_loss: 687267.0765; train_cat_covariates_contrastive_loss: 477180.8882; train_gene_expr_recon_loss: 1517061.4389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6290.9638; train_global_loss: 2706768.4393; train_optim_loss: 2706768.4393; val_kl_reg_loss: 18586.1374; val_edge_recon_loss: 711655.3123; val_cat_covariates_contrastive_loss: 477467.9691; val_gene_expr_recon_loss: 1527694.3330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6300.6577; val_global_loss: 2741704.5061; val_optim_loss: 2741704.5061
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9339; val_auprc_score: 0.9865; val_best_acc_score: 0.9365; val_best_f1_score: 0.9641; train_kl_reg_loss: 18967.4599; train_edge_recon_loss: 684009.3044; train_cat_covariates_contrastive_loss: 477254.5563; train_gene_expr_recon_loss: 1516765.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6289.5091; train_global_loss: 2703285.9925; train_optim_loss: 2703285.9925; val_kl_reg_loss: 18786.2123; val_edge_recon_loss: 707909.8161; val_cat_covariates_contrastive_loss: 477425.6741; val_gene_expr_recon_loss: 1527546.5752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6310.9775; val_global_loss: 2737979.2832; val_optim_loss: 2737979.2832

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9340; val_auprc_score: 0.9865; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 18891.7534; train_edge_recon_loss: 685996.2741; train_cat_covariates_contrastive_loss: 477183.3236; train_gene_expr_recon_loss: 1512834.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5576.7114; train_global_loss: 2700483.0037; train_optim_loss: 2700483.0037; val_kl_reg_loss: 18773.8540; val_edge_recon_loss: 705678.6594; val_cat_covariates_contrastive_loss: 477239.2721; val_gene_expr_recon_loss: 1525089.9628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5564.9854; val_global_loss: 2732346.7448; val_optim_loss: 2732346.7448
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9339; val_auprc_score: 0.9864; val_best_acc_score: 0.9366; val_best_f1_score: 0.9643; train_kl_reg_loss: 18923.9993; train_edge_recon_loss: 685044.1213; train_cat_covariates_contrastive_loss: 477096.8081; train_gene_expr_recon_loss: 1512748.8579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5563.0243; train_global_loss: 2699376.8133; train_optim_loss: 2699376.8133; val_kl_reg_loss: 18773.5905; val_edge_recon_loss: 704554.3162; val_cat_covariates_contrastive_loss: 477288.6415; val_gene_expr_recon_loss: 1526260.4755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5572.1299; val_global_loss: 2732449.2701; val_optim_loss: 2732449.2701
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9350; val_auprc_score: 0.9869; val_best_acc_score: 0.9367; val_best_f1_score: 0.9644; train_kl_reg_loss: 18939.0236; train_edge_recon_loss: 685584.8833; train_cat_covariates_contrastive_loss: 477138.2718; train_gene_expr_recon_loss: 1512552.3713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5564.0764; train_global_loss: 2699778.6300; train_optim_loss: 2699778.6300; val_kl_reg_loss: 18799.7074; val_edge_recon_loss: 700049.7180; val_cat_covariates_contrastive_loss: 476990.5838; val_gene_expr_recon_loss: 1523815.1906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5556.6665; val_global_loss: 2725211.9528; val_optim_loss: 2725211.9528
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9372; val_auprc_score: 0.9872; val_best_acc_score: 0.9365; val_best_f1_score: 0.9641; train_kl_reg_loss: 18917.7424; train_edge_recon_loss: 686235.9492; train_cat_covariates_contrastive_loss: 477102.3639; train_gene_expr_recon_loss: 1512238.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5561.4885; train_global_loss: 2700056.4519; train_optim_loss: 2700056.4519; val_kl_reg_loss: 18833.8783; val_edge_recon_loss: 709172.2208; val_cat_covariates_contrastive_loss: 477186.3254; val_gene_expr_recon_loss: 1525748.0170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5564.6226; val_global_loss: 2736504.9414; val_optim_loss: 2736504.9414
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9357; val_auprc_score: 0.9867; val_best_acc_score: 0.9368; val_best_f1_score: 0.9643; train_kl_reg_loss: 18936.5146; train_edge_recon_loss: 684779.8617; train_cat_covariates_contrastive_loss: 477161.7489; train_gene_expr_recon_loss: 1512424.5699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5562.0103; train_global_loss: 2698864.7045; train_optim_loss: 2698864.7045; val_kl_reg_loss: 18724.4480; val_edge_recon_loss: 707611.0095; val_cat_covariates_contrastive_loss: 477440.2987; val_gene_expr_recon_loss: 1525551.7325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5575.9702; val_global_loss: 2734903.4895; val_optim_loss: 2734903.4895
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9355; val_auprc_score: 0.9869; val_best_acc_score: 0.9367; val_best_f1_score: 0.9643; train_kl_reg_loss: 18915.5812; train_edge_recon_loss: 683755.5601; train_cat_covariates_contrastive_loss: 477204.2972; train_gene_expr_recon_loss: 1512188.2894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5567.8796; train_global_loss: 2697631.6060; train_optim_loss: 2697631.6060; val_kl_reg_loss: 18735.6630; val_edge_recon_loss: 707701.5050; val_cat_covariates_contrastive_loss: 476908.2744; val_gene_expr_recon_loss: 1523578.0677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5579.1885; val_global_loss: 2732502.7622; val_optim_loss: 2732502.7622
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9330; val_auprc_score: 0.9862; val_best_acc_score: 0.9363; val_best_f1_score: 0.9641; train_kl_reg_loss: 18911.0292; train_edge_recon_loss: 682765.6158; train_cat_covariates_contrastive_loss: 477021.5003; train_gene_expr_recon_loss: 1511799.9919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5564.9454; train_global_loss: 2696063.0869; train_optim_loss: 2696063.0869; val_kl_reg_loss: 18804.8918; val_edge_recon_loss: 708076.0640; val_cat_covariates_contrastive_loss: 476837.8144; val_gene_expr_recon_loss: 1524942.8431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5576.7480; val_global_loss: 2734238.3698; val_optim_loss: 2734238.3698

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9351; val_auprc_score: 0.9870; val_best_acc_score: 0.9368; val_best_f1_score: 0.9644; train_kl_reg_loss: 18894.6405; train_edge_recon_loss: 684272.8081; train_cat_covariates_contrastive_loss: 477068.9255; train_gene_expr_recon_loss: 1511538.1402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5492.1157; train_global_loss: 2697266.6314; train_optim_loss: 2697266.6314; val_kl_reg_loss: 18765.7618; val_edge_recon_loss: 701815.5271; val_cat_covariates_contrastive_loss: 477387.6658; val_gene_expr_recon_loss: 1525300.1276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5488.7212; val_global_loss: 2728757.8252; val_optim_loss: 2728757.8252
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9345; val_auprc_score: 0.9866; val_best_acc_score: 0.9363; val_best_f1_score: 0.9640; train_kl_reg_loss: 18902.1254; train_edge_recon_loss: 684144.8226; train_cat_covariates_contrastive_loss: 477105.1489; train_gene_expr_recon_loss: 1511226.5969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5487.4653; train_global_loss: 2696866.1624; train_optim_loss: 2696866.1624; val_kl_reg_loss: 18796.9822; val_edge_recon_loss: 708719.2398; val_cat_covariates_contrastive_loss: 476978.7222; val_gene_expr_recon_loss: 1523959.1377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5488.8154; val_global_loss: 2733942.8357; val_optim_loss: 2733942.8357
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9350; val_auprc_score: 0.9868; val_best_acc_score: 0.9370; val_best_f1_score: 0.9645; train_kl_reg_loss: 18887.5440; train_edge_recon_loss: 687191.0869; train_cat_covariates_contrastive_loss: 477138.7565; train_gene_expr_recon_loss: 1511508.2596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5488.3568; train_global_loss: 2700214.0026; train_optim_loss: 2700214.0026; val_kl_reg_loss: 18774.1231; val_edge_recon_loss: 705684.9681; val_cat_covariates_contrastive_loss: 477262.6001; val_gene_expr_recon_loss: 1523912.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5487.0786; val_global_loss: 2731121.0935; val_optim_loss: 2731121.0935
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9338; val_auprc_score: 0.9864; val_best_acc_score: 0.9365; val_best_f1_score: 0.9641; train_kl_reg_loss: 18902.4027; train_edge_recon_loss: 683643.7602; train_cat_covariates_contrastive_loss: 477112.6917; train_gene_expr_recon_loss: 1511045.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5487.6450; train_global_loss: 2696192.2268; train_optim_loss: 2696192.2268; val_kl_reg_loss: 18789.9693; val_edge_recon_loss: 709320.8955; val_cat_covariates_contrastive_loss: 476953.8988; val_gene_expr_recon_loss: 1522862.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5485.9336; val_global_loss: 2733413.0044; val_optim_loss: 2733413.0044
