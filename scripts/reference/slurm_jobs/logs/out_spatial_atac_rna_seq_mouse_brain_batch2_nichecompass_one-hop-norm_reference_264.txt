[True]
Run timestamp: 10102023_123116_264.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_264']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6645; val_auprc_score: 0.6423; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 59631.2892; train_edge_recon_loss: 754817.0758; train_gene_expr_recon_loss: 23178970.6970; train_masked_gp_l1_reg_loss: 102685.3355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3379122.7614; train_chrom_access_recon_loss: 11523446.4394; train_global_loss: 38998673.9394; train_optim_loss: 38998673.9394; val_kl_reg_loss: 95314.1025; val_edge_recon_loss: 813142.8203; val_gene_expr_recon_loss: 21455083.2500; val_masked_gp_l1_reg_loss: 77872.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2370737.0000; val_chrom_access_recon_loss: 11141352.8750; val_global_loss: 35953501.0000; val_optim_loss: 35953501.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6772; val_auprc_score: 0.6686; val_best_acc_score: 0.5167; val_best_f1_score: 0.6725; train_kl_reg_loss: 93580.0271; train_edge_recon_loss: 752686.1184; train_gene_expr_recon_loss: 21251468.7273; train_masked_gp_l1_reg_loss: 71075.5668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1602769.5606; train_chrom_access_recon_loss: 10969994.6364; train_global_loss: 34741574.6061; train_optim_loss: 34741574.6061; val_kl_reg_loss: 97890.5791; val_edge_recon_loss: 812836.2656; val_gene_expr_recon_loss: 21086290.2500; val_masked_gp_l1_reg_loss: 67755.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1001557.7500; val_chrom_access_recon_loss: 10921137.8750; val_global_loss: 33987469.0000; val_optim_loss: 33987469.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7883; val_auprc_score: 0.7824; val_best_acc_score: 0.6241; val_best_f1_score: 0.7131; train_kl_reg_loss: 85687.2286; train_edge_recon_loss: 743000.5199; train_gene_expr_recon_loss: 21054432.0909; train_masked_gp_l1_reg_loss: 67122.5308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 703328.5819; train_chrom_access_recon_loss: 10895198.9545; train_global_loss: 33548770.3030; train_optim_loss: 33548770.3030; val_kl_reg_loss: 87757.4453; val_edge_recon_loss: 811391.9844; val_gene_expr_recon_loss: 21176310.0000; val_masked_gp_l1_reg_loss: 67109.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 484860.2500; val_chrom_access_recon_loss: 11024869.8750; val_global_loss: 33652299.7500; val_optim_loss: 33652299.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8541; val_auprc_score: 0.8264; val_best_acc_score: 0.7407; val_best_f1_score: 0.7590; train_kl_reg_loss: 77994.5545; train_edge_recon_loss: 735193.1515; train_gene_expr_recon_loss: 20890067.1515; train_masked_gp_l1_reg_loss: 67950.3356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 374577.0956; train_chrom_access_recon_loss: 10821365.7424; train_global_loss: 32967148.1212; train_optim_loss: 32967148.1212; val_kl_reg_loss: 76297.2041; val_edge_recon_loss: 800283.9844; val_gene_expr_recon_loss: 20785725.7500; val_masked_gp_l1_reg_loss: 69393.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 292681.6250; val_chrom_access_recon_loss: 10848298.0000; val_global_loss: 32872681.0000; val_optim_loss: 32872681.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8859; val_auprc_score: 0.8605; val_best_acc_score: 0.8106; val_best_f1_score: 0.8299; train_kl_reg_loss: 70947.3740; train_edge_recon_loss: 725072.7140; train_gene_expr_recon_loss: 20743828.3030; train_masked_gp_l1_reg_loss: 71122.4004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 249757.7876; train_chrom_access_recon_loss: 10744154.5152; train_global_loss: 32604883.1212; train_optim_loss: 32604883.1212; val_kl_reg_loss: 67348.0586; val_edge_recon_loss: 761922.5000; val_gene_expr_recon_loss: 20726982.7500; val_masked_gp_l1_reg_loss: 72756.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213596.2656; val_chrom_access_recon_loss: 10789583.7500; val_global_loss: 32632189.0000; val_optim_loss: 32632189.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8956; val_auprc_score: 0.8676; val_best_acc_score: 0.8264; val_best_f1_score: 0.8377; train_kl_reg_loss: 67715.8192; train_edge_recon_loss: 698191.8400; train_gene_expr_recon_loss: 20596146.0606; train_masked_gp_l1_reg_loss: 74310.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188720.6792; train_chrom_access_recon_loss: 10687966.5455; train_global_loss: 32313051.5758; train_optim_loss: 32313051.5758; val_kl_reg_loss: 68604.1143; val_edge_recon_loss: 678617.8438; val_gene_expr_recon_loss: 20309573.5000; val_masked_gp_l1_reg_loss: 75780.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167094.4219; val_chrom_access_recon_loss: 10708409.7500; val_global_loss: 32008079.0000; val_optim_loss: 32008079.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8865; val_auprc_score: 0.8533; val_best_acc_score: 0.8208; val_best_f1_score: 0.8344; train_kl_reg_loss: 76480.5703; train_edge_recon_loss: 649311.1430; train_gene_expr_recon_loss: 20507385.0303; train_masked_gp_l1_reg_loss: 77106.2231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151295.6757; train_chrom_access_recon_loss: 10650695.8030; train_global_loss: 32112274.4545; train_optim_loss: 32112274.4545; val_kl_reg_loss: 75237.4893; val_edge_recon_loss: 648079.4766; val_gene_expr_recon_loss: 20522881.2500; val_masked_gp_l1_reg_loss: 78298.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138292.4531; val_chrom_access_recon_loss: 10779920.1250; val_global_loss: 32242708.5000; val_optim_loss: 32242708.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8886; val_auprc_score: 0.8534; val_best_acc_score: 0.8149; val_best_f1_score: 0.8350; train_kl_reg_loss: 79593.3374; train_edge_recon_loss: 634791.5710; train_gene_expr_recon_loss: 20389450.1212; train_masked_gp_l1_reg_loss: 79327.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128338.7860; train_chrom_access_recon_loss: 10593892.3485; train_global_loss: 31905393.6970; train_optim_loss: 31905393.6970; val_kl_reg_loss: 79711.9141; val_edge_recon_loss: 632310.4531; val_gene_expr_recon_loss: 20171028.5000; val_masked_gp_l1_reg_loss: 80302.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120059.8281; val_chrom_access_recon_loss: 10590528.6250; val_global_loss: 31673941.5000; val_optim_loss: 31673941.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9009; val_auprc_score: 0.8686; val_best_acc_score: 0.8364; val_best_f1_score: 0.8530; train_kl_reg_loss: 78547.0883; train_edge_recon_loss: 624572.4744; train_gene_expr_recon_loss: 20312491.5455; train_masked_gp_l1_reg_loss: 81282.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113866.3838; train_chrom_access_recon_loss: 10563680.7273; train_global_loss: 31774440.8182; train_optim_loss: 31774440.8182; val_kl_reg_loss: 81284.4961; val_edge_recon_loss: 618675.2031; val_gene_expr_recon_loss: 20315417.5000; val_masked_gp_l1_reg_loss: 82226.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107482.2578; val_chrom_access_recon_loss: 10682023.0000; val_global_loss: 31887107.7500; val_optim_loss: 31887107.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8988; val_auprc_score: 0.8711; val_best_acc_score: 0.8227; val_best_f1_score: 0.8377; train_kl_reg_loss: 78115.6509; train_edge_recon_loss: 617247.6108; train_gene_expr_recon_loss: 20244913.0303; train_masked_gp_l1_reg_loss: 82852.5244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103595.9601; train_chrom_access_recon_loss: 10523600.3182; train_global_loss: 31650325.0606; train_optim_loss: 31650325.0606; val_kl_reg_loss: 79275.8779; val_edge_recon_loss: 618337.2578; val_gene_expr_recon_loss: 20234122.5000; val_masked_gp_l1_reg_loss: 83805.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100003.1172; val_chrom_access_recon_loss: 10662331.1250; val_global_loss: 31777876.7500; val_optim_loss: 31777876.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9091; val_auprc_score: 0.8854; val_best_acc_score: 0.8369; val_best_f1_score: 0.8508; train_kl_reg_loss: 76504.5882; train_edge_recon_loss: 612416.5616; train_gene_expr_recon_loss: 20156765.6970; train_masked_gp_l1_reg_loss: 84274.0903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96999.0703; train_chrom_access_recon_loss: 10484872.0758; train_global_loss: 31511832.0303; train_optim_loss: 31511832.0303; val_kl_reg_loss: 76325.8662; val_edge_recon_loss: 611549.8125; val_gene_expr_recon_loss: 20251419.0000; val_masked_gp_l1_reg_loss: 85169.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94773.7422; val_chrom_access_recon_loss: 10705917.6250; val_global_loss: 31825156.0000; val_optim_loss: 31825156.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9112; val_auprc_score: 0.8802; val_best_acc_score: 0.8482; val_best_f1_score: 0.8579; train_kl_reg_loss: 75477.9645; train_edge_recon_loss: 610836.9650; train_gene_expr_recon_loss: 20086940.6970; train_masked_gp_l1_reg_loss: 85687.5128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92494.2782; train_chrom_access_recon_loss: 10451393.8788; train_global_loss: 31402831.2121; train_optim_loss: 31402831.2121; val_kl_reg_loss: 74632.4434; val_edge_recon_loss: 613563.8906; val_gene_expr_recon_loss: 20208146.5000; val_masked_gp_l1_reg_loss: 86278.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90672.2656; val_chrom_access_recon_loss: 10580766.0000; val_global_loss: 31654058.7500; val_optim_loss: 31654058.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9211; val_auprc_score: 0.9012; val_best_acc_score: 0.8514; val_best_f1_score: 0.8615; train_kl_reg_loss: 74170.4740; train_edge_recon_loss: 605082.9100; train_gene_expr_recon_loss: 20022210.1515; train_masked_gp_l1_reg_loss: 86876.7966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88958.6392; train_chrom_access_recon_loss: 10413138.8030; train_global_loss: 31290437.7273; train_optim_loss: 31290437.7273; val_kl_reg_loss: 74270.0596; val_edge_recon_loss: 605231.3672; val_gene_expr_recon_loss: 19951110.5000; val_masked_gp_l1_reg_loss: 87365.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86877.8750; val_chrom_access_recon_loss: 10395573.2500; val_global_loss: 31200429.5000; val_optim_loss: 31200429.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9162; val_auprc_score: 0.8928; val_best_acc_score: 0.8485; val_best_f1_score: 0.8587; train_kl_reg_loss: 73151.1139; train_edge_recon_loss: 603441.4072; train_gene_expr_recon_loss: 19944392.8182; train_masked_gp_l1_reg_loss: 88044.3300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85598.7597; train_chrom_access_recon_loss: 10373196.2879; train_global_loss: 31167824.6061; train_optim_loss: 31167824.6061; val_kl_reg_loss: 71563.6836; val_edge_recon_loss: 609825.1172; val_gene_expr_recon_loss: 19886460.0000; val_masked_gp_l1_reg_loss: 88738.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84529.5781; val_chrom_access_recon_loss: 10493197.5000; val_global_loss: 31234314.5000; val_optim_loss: 31234314.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9302; val_auprc_score: 0.9101; val_best_acc_score: 0.8665; val_best_f1_score: 0.8746; train_kl_reg_loss: 71831.3300; train_edge_recon_loss: 601017.2642; train_gene_expr_recon_loss: 19889830.6364; train_masked_gp_l1_reg_loss: 89115.5818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82910.7009; train_chrom_access_recon_loss: 10339210.0455; train_global_loss: 31073915.5455; train_optim_loss: 31073915.5455; val_kl_reg_loss: 70815.1309; val_edge_recon_loss: 601449.2656; val_gene_expr_recon_loss: 19744065.0000; val_masked_gp_l1_reg_loss: 89788.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81729.5234; val_chrom_access_recon_loss: 10416869.1250; val_global_loss: 31004716.7500; val_optim_loss: 31004716.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9283; val_auprc_score: 0.9066; val_best_acc_score: 0.8697; val_best_f1_score: 0.8775; train_kl_reg_loss: 70680.2429; train_edge_recon_loss: 599256.6392; train_gene_expr_recon_loss: 19820880.7879; train_masked_gp_l1_reg_loss: 90213.3318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80416.3922; train_chrom_access_recon_loss: 10290488.8485; train_global_loss: 30951936.3636; train_optim_loss: 30951936.3636; val_kl_reg_loss: 70923.7197; val_edge_recon_loss: 604495.2344; val_gene_expr_recon_loss: 19774473.2500; val_masked_gp_l1_reg_loss: 90730.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79265.7109; val_chrom_access_recon_loss: 10310444.0000; val_global_loss: 30930332.0000; val_optim_loss: 30930332.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9239; val_auprc_score: 0.9002; val_best_acc_score: 0.8600; val_best_f1_score: 0.8695; train_kl_reg_loss: 70181.3923; train_edge_recon_loss: 597629.0066; train_gene_expr_recon_loss: 19765797.4242; train_masked_gp_l1_reg_loss: 91157.9783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78277.8538; train_chrom_access_recon_loss: 10260785.8939; train_global_loss: 30863829.6667; train_optim_loss: 30863829.6667; val_kl_reg_loss: 68613.6348; val_edge_recon_loss: 601606.2500; val_gene_expr_recon_loss: 19758254.5000; val_masked_gp_l1_reg_loss: 91469.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77189.2188; val_chrom_access_recon_loss: 10394579.0000; val_global_loss: 30991713.5000; val_optim_loss: 30991713.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9399; val_auprc_score: 0.9177; val_best_acc_score: 0.8810; val_best_f1_score: 0.8860; train_kl_reg_loss: 69664.8365; train_edge_recon_loss: 595284.5985; train_gene_expr_recon_loss: 19717397.5152; train_masked_gp_l1_reg_loss: 91931.1405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76448.8046; train_chrom_access_recon_loss: 10227883.5758; train_global_loss: 30778610.6364; train_optim_loss: 30778610.6364; val_kl_reg_loss: 67900.1572; val_edge_recon_loss: 593358.9766; val_gene_expr_recon_loss: 19724418.7500; val_masked_gp_l1_reg_loss: 92514.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75902.5078; val_chrom_access_recon_loss: 10314167.2500; val_global_loss: 30868261.0000; val_optim_loss: 30868261.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9317; val_auprc_score: 0.9116; val_best_acc_score: 0.8654; val_best_f1_score: 0.8733; train_kl_reg_loss: 68686.8099; train_edge_recon_loss: 592478.7812; train_gene_expr_recon_loss: 19664055.8182; train_masked_gp_l1_reg_loss: 92893.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75063.6261; train_chrom_access_recon_loss: 10195856.5303; train_global_loss: 30689035.5758; train_optim_loss: 30689035.5758; val_kl_reg_loss: 67529.6211; val_edge_recon_loss: 605935.6641; val_gene_expr_recon_loss: 19666346.2500; val_masked_gp_l1_reg_loss: 93570.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75006.0859; val_chrom_access_recon_loss: 10248277.2500; val_global_loss: 30756664.7500; val_optim_loss: 30756664.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9253; val_auprc_score: 0.8959; val_best_acc_score: 0.8670; val_best_f1_score: 0.8763; train_kl_reg_loss: 67994.5776; train_edge_recon_loss: 591187.8267; train_gene_expr_recon_loss: 19614129.7576; train_masked_gp_l1_reg_loss: 94031.4638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74201.4710; train_chrom_access_recon_loss: 10163697.4848; train_global_loss: 30605242.8182; train_optim_loss: 30605242.8182; val_kl_reg_loss: 66760.7041; val_edge_recon_loss: 601573.9688; val_gene_expr_recon_loss: 19876648.5000; val_masked_gp_l1_reg_loss: 94478.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73579.2109; val_chrom_access_recon_loss: 10453356.6250; val_global_loss: 31166397.7500; val_optim_loss: 31166397.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9381; val_auprc_score: 0.9157; val_best_acc_score: 0.8796; val_best_f1_score: 0.8867; train_kl_reg_loss: 67008.9282; train_edge_recon_loss: 592011.7396; train_gene_expr_recon_loss: 19585245.4242; train_masked_gp_l1_reg_loss: 94927.6895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72968.9149; train_chrom_access_recon_loss: 10129271.2576; train_global_loss: 30541433.9697; train_optim_loss: 30541433.9697; val_kl_reg_loss: 67601.6416; val_edge_recon_loss: 593641.8047; val_gene_expr_recon_loss: 19573223.7500; val_masked_gp_l1_reg_loss: 95553.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72626.3984; val_chrom_access_recon_loss: 10237867.7500; val_global_loss: 30640514.2500; val_optim_loss: 30640514.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9396; val_auprc_score: 0.9195; val_best_acc_score: 0.8842; val_best_f1_score: 0.8884; train_kl_reg_loss: 66631.0479; train_edge_recon_loss: 589209.4280; train_gene_expr_recon_loss: 19521402.9697; train_masked_gp_l1_reg_loss: 95966.8955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72301.9732; train_chrom_access_recon_loss: 10086209.0303; train_global_loss: 30431721.2424; train_optim_loss: 30431721.2424; val_kl_reg_loss: 65959.9194; val_edge_recon_loss: 595028.8750; val_gene_expr_recon_loss: 19680197.2500; val_masked_gp_l1_reg_loss: 96485.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72308.9688; val_chrom_access_recon_loss: 10197930.1250; val_global_loss: 30707910.0000; val_optim_loss: 30707910.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9449; val_auprc_score: 0.9251; val_best_acc_score: 0.8941; val_best_f1_score: 0.8981; train_kl_reg_loss: 65530.2132; train_edge_recon_loss: 591329.1723; train_gene_expr_recon_loss: 19480905.5455; train_masked_gp_l1_reg_loss: 97055.7391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71866.9083; train_chrom_access_recon_loss: 10044587.3333; train_global_loss: 30351274.8788; train_optim_loss: 30351274.8788; val_kl_reg_loss: 67186.0957; val_edge_recon_loss: 593476.8984; val_gene_expr_recon_loss: 19536110.7500; val_masked_gp_l1_reg_loss: 97673.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71358.1250; val_chrom_access_recon_loss: 10164832.1250; val_global_loss: 30530637.7500; val_optim_loss: 30530637.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9291; val_auprc_score: 0.9032; val_best_acc_score: 0.8753; val_best_f1_score: 0.8818; train_kl_reg_loss: 65606.1609; train_edge_recon_loss: 586526.7140; train_gene_expr_recon_loss: 19430850.2727; train_masked_gp_l1_reg_loss: 98010.9831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71142.6712; train_chrom_access_recon_loss: 10000062.8182; train_global_loss: 30252199.6364; train_optim_loss: 30252199.6364; val_kl_reg_loss: 65899.3818; val_edge_recon_loss: 606731.1172; val_gene_expr_recon_loss: 19613383.0000; val_masked_gp_l1_reg_loss: 98605.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71142.0859; val_chrom_access_recon_loss: 10235040.2500; val_global_loss: 30690801.7500; val_optim_loss: 30690801.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9400; val_auprc_score: 0.9221; val_best_acc_score: 0.8842; val_best_f1_score: 0.8886; train_kl_reg_loss: 64866.0921; train_edge_recon_loss: 589351.3684; train_gene_expr_recon_loss: 19364528.6970; train_masked_gp_l1_reg_loss: 99078.0509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70852.4476; train_chrom_access_recon_loss: 9942690.9848; train_global_loss: 30131367.7273; train_optim_loss: 30131367.7273; val_kl_reg_loss: 64910.4814; val_edge_recon_loss: 596658.3984; val_gene_expr_recon_loss: 19447300.2500; val_masked_gp_l1_reg_loss: 99732.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71020.6094; val_chrom_access_recon_loss: 10087137.5000; val_global_loss: 30366759.2500; val_optim_loss: 30366759.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8507; val_auprc_score: 0.8177; val_best_acc_score: 0.7826; val_best_f1_score: 0.8037; train_kl_reg_loss: 47446.8480; train_edge_recon_loss: 718392.0095; train_gene_expr_recon_loss: 19063470.6364; train_masked_gp_l1_reg_loss: 101235.8140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74203.0129; train_chrom_access_recon_loss: 9881958.4545; train_global_loss: 29886706.7879; train_optim_loss: 29886706.7879; val_kl_reg_loss: 14920.3169; val_edge_recon_loss: 783466.9844; val_gene_expr_recon_loss: 19030937.0000; val_masked_gp_l1_reg_loss: 105794.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87650.7031; val_chrom_access_recon_loss: 9973803.6250; val_global_loss: 29996571.7500; val_optim_loss: 29996571.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8656; val_auprc_score: 0.8308; val_best_acc_score: 0.7966; val_best_f1_score: 0.8213; train_kl_reg_loss: 25647.1670; train_edge_recon_loss: 732313.0530; train_gene_expr_recon_loss: 18843212.7576; train_masked_gp_l1_reg_loss: 105653.4783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90360.9981; train_chrom_access_recon_loss: 9774045.5606; train_global_loss: 29571232.8485; train_optim_loss: 29571232.8485; val_kl_reg_loss: 22685.3550; val_edge_recon_loss: 741974.7109; val_gene_expr_recon_loss: 18325962.1250; val_masked_gp_l1_reg_loss: 104762.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87223.4922; val_chrom_access_recon_loss: 9653460.2500; val_global_loss: 28936068.2500; val_optim_loss: 28936068.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8654; val_auprc_score: 0.8257; val_best_acc_score: 0.7939; val_best_f1_score: 0.8220; train_kl_reg_loss: 28605.5331; train_edge_recon_loss: 707642.3504; train_gene_expr_recon_loss: 18639068.4545; train_masked_gp_l1_reg_loss: 102819.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84486.8124; train_chrom_access_recon_loss: 9728179.8485; train_global_loss: 29290802.3333; train_optim_loss: 29290802.3333; val_kl_reg_loss: 24379.2761; val_edge_recon_loss: 715258.6094; val_gene_expr_recon_loss: 18670530.0000; val_masked_gp_l1_reg_loss: 100907.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81739.2969; val_chrom_access_recon_loss: 9841476.8750; val_global_loss: 29434292.7500; val_optim_loss: 29434292.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8666; val_auprc_score: 0.8270; val_best_acc_score: 0.8041; val_best_f1_score: 0.8292; train_kl_reg_loss: 29869.1137; train_edge_recon_loss: 688745.4981; train_gene_expr_recon_loss: 18596105.5455; train_masked_gp_l1_reg_loss: 99847.1487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79718.8789; train_chrom_access_recon_loss: 9705110.8636; train_global_loss: 29199397.3030; train_optim_loss: 29199397.3030; val_kl_reg_loss: 23853.7092; val_edge_recon_loss: 690345.1484; val_gene_expr_recon_loss: 18543215.5000; val_masked_gp_l1_reg_loss: 98889.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78096.4141; val_chrom_access_recon_loss: 9731925.8750; val_global_loss: 29166326.5000; val_optim_loss: 29166326.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8747; val_auprc_score: 0.8428; val_best_acc_score: 0.8039; val_best_f1_score: 0.8279; train_kl_reg_loss: 31097.5627; train_edge_recon_loss: 659152.7756; train_gene_expr_recon_loss: 18540241.6667; train_masked_gp_l1_reg_loss: 97941.2586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76480.9587; train_chrom_access_recon_loss: 9683375.5000; train_global_loss: 29088289.9394; train_optim_loss: 29088289.9394; val_kl_reg_loss: 25914.9529; val_edge_recon_loss: 649256.4219; val_gene_expr_recon_loss: 18488328.7500; val_masked_gp_l1_reg_loss: 97187.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74999.3750; val_chrom_access_recon_loss: 9745956.6250; val_global_loss: 29081645.0000; val_optim_loss: 29081645.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8637; val_auprc_score: 0.8266; val_best_acc_score: 0.8017; val_best_f1_score: 0.8277; train_kl_reg_loss: 35235.4327; train_edge_recon_loss: 632811.8068; train_gene_expr_recon_loss: 18489769.4848; train_masked_gp_l1_reg_loss: 96378.7293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73631.3796; train_chrom_access_recon_loss: 9664007.2121; train_global_loss: 28991834.0909; train_optim_loss: 28991834.0909; val_kl_reg_loss: 32986.8242; val_edge_recon_loss: 626222.9766; val_gene_expr_recon_loss: 18394744.5000; val_masked_gp_l1_reg_loss: 95778.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72552.9219; val_chrom_access_recon_loss: 9717866.7500; val_global_loss: 28940151.5000; val_optim_loss: 28940151.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8599; val_auprc_score: 0.8223; val_best_acc_score: 0.8025; val_best_f1_score: 0.8262; train_kl_reg_loss: 39441.4755; train_edge_recon_loss: 621915.7244; train_gene_expr_recon_loss: 18528131.5455; train_masked_gp_l1_reg_loss: 93954.9077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64724.4501; train_chrom_access_recon_loss: 9748001.5455; train_global_loss: 29096169.5152; train_optim_loss: 29096169.5152; val_kl_reg_loss: 35400.9634; val_edge_recon_loss: 630878.6562; val_gene_expr_recon_loss: 18598511.2500; val_masked_gp_l1_reg_loss: 93151.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62040.5547; val_chrom_access_recon_loss: 9874780.3750; val_global_loss: 29294763.2500; val_optim_loss: 29294763.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8731; val_auprc_score: 0.8442; val_best_acc_score: 0.8095; val_best_f1_score: 0.8331; train_kl_reg_loss: 40082.0231; train_edge_recon_loss: 622810.7472; train_gene_expr_recon_loss: 18479928.6061; train_masked_gp_l1_reg_loss: 92892.5669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61245.2743; train_chrom_access_recon_loss: 9678328.4242; train_global_loss: 28975287.5758; train_optim_loss: 28975287.5758; val_kl_reg_loss: 35119.3511; val_edge_recon_loss: 619351.6172; val_gene_expr_recon_loss: 18504114.2500; val_masked_gp_l1_reg_loss: 92711.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60635.4570; val_chrom_access_recon_loss: 9877189.5000; val_global_loss: 29189122.2500; val_optim_loss: 29189122.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8658; val_auprc_score: 0.8336; val_best_acc_score: 0.8001; val_best_f1_score: 0.8254; train_kl_reg_loss: 39836.4880; train_edge_recon_loss: 622605.4138; train_gene_expr_recon_loss: 18452195.0606; train_masked_gp_l1_reg_loss: 92557.2025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60270.5285; train_chrom_access_recon_loss: 9655665.7273; train_global_loss: 28923130.4545; train_optim_loss: 28923130.4545; val_kl_reg_loss: 35677.7378; val_edge_recon_loss: 625920.9375; val_gene_expr_recon_loss: 18618721.2500; val_masked_gp_l1_reg_loss: 92417.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59973.8164; val_chrom_access_recon_loss: 9810140.0000; val_global_loss: 29242852.0000; val_optim_loss: 29242852.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8683; val_auprc_score: 0.8317; val_best_acc_score: 0.8076; val_best_f1_score: 0.8313; train_kl_reg_loss: 39991.6520; train_edge_recon_loss: 619159.3883; train_gene_expr_recon_loss: 18455632.3939; train_masked_gp_l1_reg_loss: 92313.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59746.9437; train_chrom_access_recon_loss: 9655655.7879; train_global_loss: 28922500.2121; train_optim_loss: 28922500.2121; val_kl_reg_loss: 36178.1348; val_edge_recon_loss: 622221.3906; val_gene_expr_recon_loss: 18574073.5000; val_masked_gp_l1_reg_loss: 92228.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59559.8203; val_chrom_access_recon_loss: 9834202.2500; val_global_loss: 29218463.2500; val_optim_loss: 29218463.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 28 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.8632
val AUPRC score: 0.8259
val best accuracy score: 0.7945
val best F1 score: 0.8216
val target rna MSE score: 2.3350
val source rna MSE score: 2.0219
val target atac MSE score: 0.3330
val source atac MSE score: 0.1591
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
