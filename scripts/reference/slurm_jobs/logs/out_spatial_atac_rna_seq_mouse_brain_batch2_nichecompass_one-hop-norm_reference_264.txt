[True]
Run timestamp: 07092023_045158_264.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_264']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2863 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6459, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6449; val_auprc_score: 0.6292; val_best_acc_score: 0.5005; val_best_f1_score: 0.6667; train_kl_reg_loss: 45488.4335; train_edge_recon_loss: 3543154.6894; train_gene_expr_recon_loss: 14710361.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1120177.7528; train_chrom_access_recon_loss: 12484962.6364; train_global_loss: 31904144.6667; train_optim_loss: 31904144.6667; val_kl_reg_loss: 98637.9082; val_edge_recon_loss: 4065259.7812; val_gene_expr_recon_loss: 13419470.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 845578.8125; val_chrom_access_recon_loss: 12013539.0000; val_global_loss: 30442485.0000; val_optim_loss: 30442485.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6957; val_auprc_score: 0.6793; val_best_acc_score: 0.5196; val_best_f1_score: 0.6731; train_kl_reg_loss: 101401.7795; train_edge_recon_loss: 3531195.8068; train_gene_expr_recon_loss: 13174147.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 611399.4815; train_chrom_access_recon_loss: 11841443.1515; train_global_loss: 29259587.4242; train_optim_loss: 29259587.4242; val_kl_reg_loss: 104248.9590; val_edge_recon_loss: 4063923.6875; val_gene_expr_recon_loss: 13024415.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 417260.2188; val_chrom_access_recon_loss: 11699665.7500; val_global_loss: 29309513.5000; val_optim_loss: 29309513.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7530; val_auprc_score: 0.7350; val_best_acc_score: 0.6776; val_best_f1_score: 0.7240; train_kl_reg_loss: 97835.8432; train_edge_recon_loss: 3519700.6288; train_gene_expr_recon_loss: 12955348.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 309159.4685; train_chrom_access_recon_loss: 11721412.2576; train_global_loss: 28603456.3939; train_optim_loss: 28603456.3939; val_kl_reg_loss: 95298.2383; val_edge_recon_loss: 4043445.6875; val_gene_expr_recon_loss: 12821744.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225905.5000; val_chrom_access_recon_loss: 11663940.2500; val_global_loss: 28850335.0000; val_optim_loss: 28850335.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8148; val_auprc_score: 0.7854; val_best_acc_score: 0.7501; val_best_f1_score: 0.7710; train_kl_reg_loss: 85649.9601; train_edge_recon_loss: 3500333.0189; train_gene_expr_recon_loss: 12827402.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181156.6742; train_chrom_access_recon_loss: 11631759.7121; train_global_loss: 28226301.9697; train_optim_loss: 28226301.9697; val_kl_reg_loss: 76682.6670; val_edge_recon_loss: 3857824.5938; val_gene_expr_recon_loss: 12722886.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145911.0781; val_chrom_access_recon_loss: 11480537.0000; val_global_loss: 28283842.5000; val_optim_loss: 28283842.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8332; val_auprc_score: 0.8056; val_best_acc_score: 0.7480; val_best_f1_score: 0.7908; train_kl_reg_loss: 69346.1124; train_edge_recon_loss: 3239128.2917; train_gene_expr_recon_loss: 12762492.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124401.7317; train_chrom_access_recon_loss: 11577258.4091; train_global_loss: 27772626.5758; train_optim_loss: 27772626.5758; val_kl_reg_loss: 93801.8350; val_edge_recon_loss: 3010786.3438; val_gene_expr_recon_loss: 12866549.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106795.1641; val_chrom_access_recon_loss: 11654423.2500; val_global_loss: 27732356.7500; val_optim_loss: 27732356.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8363; val_auprc_score: 0.8004; val_best_acc_score: 0.7609; val_best_f1_score: 0.7875; train_kl_reg_loss: 101339.4540; train_edge_recon_loss: 2980902.4583; train_gene_expr_recon_loss: 12686108.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94244.6694; train_chrom_access_recon_loss: 11522527.9091; train_global_loss: 27385123.3333; train_optim_loss: 27385123.3333; val_kl_reg_loss: 95365.8701; val_edge_recon_loss: 2998485.0938; val_gene_expr_recon_loss: 12687452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83397.3594; val_chrom_access_recon_loss: 11399931.6250; val_global_loss: 27264632.0000; val_optim_loss: 27264632.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8444; val_auprc_score: 0.8100; val_best_acc_score: 0.7636; val_best_f1_score: 0.7907; train_kl_reg_loss: 99469.8153; train_edge_recon_loss: 2948631.9318; train_gene_expr_recon_loss: 12605798.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75859.9448; train_chrom_access_recon_loss: 11440928.5606; train_global_loss: 27170688.3636; train_optim_loss: 27170688.3636; val_kl_reg_loss: 99812.5371; val_edge_recon_loss: 3021572.8750; val_gene_expr_recon_loss: 12510958.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69461.7422; val_chrom_access_recon_loss: 11441580.6250; val_global_loss: 27143386.5000; val_optim_loss: 27143386.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8576; val_auprc_score: 0.8179; val_best_acc_score: 0.7883; val_best_f1_score: 0.8126; train_kl_reg_loss: 97359.4195; train_edge_recon_loss: 2919800.5720; train_gene_expr_recon_loss: 12528895.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64740.0388; train_chrom_access_recon_loss: 11387470.6061; train_global_loss: 26998266.2424; train_optim_loss: 26998266.2424; val_kl_reg_loss: 95795.2197; val_edge_recon_loss: 2923166.8750; val_gene_expr_recon_loss: 12477581.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60873.8281; val_chrom_access_recon_loss: 11316513.8750; val_global_loss: 26873931.5000; val_optim_loss: 26873931.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8563; val_auprc_score: 0.8126; val_best_acc_score: 0.7877; val_best_f1_score: 0.8147; train_kl_reg_loss: 91210.9741; train_edge_recon_loss: 2910924.0758; train_gene_expr_recon_loss: 12485526.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57584.1657; train_chrom_access_recon_loss: 11340336.3636; train_global_loss: 26885581.6061; train_optim_loss: 26885581.6061; val_kl_reg_loss: 90120.8271; val_edge_recon_loss: 2931558.1875; val_gene_expr_recon_loss: 12301514.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54794.3008; val_chrom_access_recon_loss: 11248049.5000; val_global_loss: 26626037.2500; val_optim_loss: 26626037.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8805; val_auprc_score: 0.8475; val_best_acc_score: 0.8084; val_best_f1_score: 0.8271; train_kl_reg_loss: 90160.4232; train_edge_recon_loss: 2869247.0455; train_gene_expr_recon_loss: 12428568.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52675.1449; train_chrom_access_recon_loss: 11298098.7576; train_global_loss: 26738749.5455; train_optim_loss: 26738749.5455; val_kl_reg_loss: 86573.8545; val_edge_recon_loss: 2862539.2188; val_gene_expr_recon_loss: 12399542.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50804.7891; val_chrom_access_recon_loss: 11418983.2500; val_global_loss: 26818444.5000; val_optim_loss: 26818444.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8885; val_auprc_score: 0.8508; val_best_acc_score: 0.8256; val_best_f1_score: 0.8415; train_kl_reg_loss: 88648.8024; train_edge_recon_loss: 2837059.6364; train_gene_expr_recon_loss: 12378533.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49074.0869; train_chrom_access_recon_loss: 11252850.6212; train_global_loss: 26606166.2424; train_optim_loss: 26606166.2424; val_kl_reg_loss: 88034.6104; val_edge_recon_loss: 2858962.1562; val_gene_expr_recon_loss: 12286585.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47881.0742; val_chrom_access_recon_loss: 11260922.2500; val_global_loss: 26542385.7500; val_optim_loss: 26542385.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9058; val_auprc_score: 0.8836; val_best_acc_score: 0.8313; val_best_f1_score: 0.8473; train_kl_reg_loss: 88614.8486; train_edge_recon_loss: 2807533.6667; train_gene_expr_recon_loss: 12337196.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46414.2163; train_chrom_access_recon_loss: 11203864.4091; train_global_loss: 26483623.3939; train_optim_loss: 26483623.3939; val_kl_reg_loss: 87388.3438; val_edge_recon_loss: 2815643.2188; val_gene_expr_recon_loss: 12177416.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45490.0469; val_chrom_access_recon_loss: 11138765.6250; val_global_loss: 26264703.2500; val_optim_loss: 26264703.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9130; val_auprc_score: 0.8877; val_best_acc_score: 0.8442; val_best_f1_score: 0.8550; train_kl_reg_loss: 86265.1162; train_edge_recon_loss: 2803002.7197; train_gene_expr_recon_loss: 12291323.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44476.2147; train_chrom_access_recon_loss: 11174683.9242; train_global_loss: 26399751.7273; train_optim_loss: 26399751.7273; val_kl_reg_loss: 86764.3350; val_edge_recon_loss: 2829098.1250; val_gene_expr_recon_loss: 12190913.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43399.9102; val_chrom_access_recon_loss: 11086429.2500; val_global_loss: 26236605.2500; val_optim_loss: 26236605.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9184; val_auprc_score: 0.8867; val_best_acc_score: 0.8581; val_best_f1_score: 0.8696; train_kl_reg_loss: 86652.8144; train_edge_recon_loss: 2777628.6742; train_gene_expr_recon_loss: 12250857.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42708.2534; train_chrom_access_recon_loss: 11131330.6818; train_global_loss: 26289177.6364; train_optim_loss: 26289177.6364; val_kl_reg_loss: 86817.4141; val_edge_recon_loss: 2784986.4062; val_gene_expr_recon_loss: 12125830.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42049.6953; val_chrom_access_recon_loss: 11100208.6250; val_global_loss: 26139893.5000; val_optim_loss: 26139893.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9281; val_auprc_score: 0.8963; val_best_acc_score: 0.8681; val_best_f1_score: 0.8759; train_kl_reg_loss: 87151.8182; train_edge_recon_loss: 2768528.2311; train_gene_expr_recon_loss: 12212941.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41372.3591; train_chrom_access_recon_loss: 11103467.0303; train_global_loss: 26213460.9697; train_optim_loss: 26213460.9697; val_kl_reg_loss: 85430.5166; val_edge_recon_loss: 2773532.0938; val_gene_expr_recon_loss: 12257213.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41030.9922; val_chrom_access_recon_loss: 11048610.8750; val_global_loss: 26205817.7500; val_optim_loss: 26205817.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9239; val_auprc_score: 0.8962; val_best_acc_score: 0.8654; val_best_f1_score: 0.8763; train_kl_reg_loss: 86404.5296; train_edge_recon_loss: 2759501.6818; train_gene_expr_recon_loss: 12164449.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40441.0486; train_chrom_access_recon_loss: 11054753.6061; train_global_loss: 26105550.3333; train_optim_loss: 26105550.3333; val_kl_reg_loss: 85929.6426; val_edge_recon_loss: 2788886.7188; val_gene_expr_recon_loss: 12181659.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40090.4766; val_chrom_access_recon_loss: 11048541.2500; val_global_loss: 26145107.2500; val_optim_loss: 26145107.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9310; val_auprc_score: 0.8994; val_best_acc_score: 0.8743; val_best_f1_score: 0.8825; train_kl_reg_loss: 85280.0024; train_edge_recon_loss: 2747350.7159; train_gene_expr_recon_loss: 12142447.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39406.6224; train_chrom_access_recon_loss: 11033080.4848; train_global_loss: 26047565.0606; train_optim_loss: 26047565.0606; val_kl_reg_loss: 85830.0840; val_edge_recon_loss: 2754093.3438; val_gene_expr_recon_loss: 12133145.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39080.0039; val_chrom_access_recon_loss: 11005802.5000; val_global_loss: 26017951.7500; val_optim_loss: 26017951.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9280; val_auprc_score: 0.8933; val_best_acc_score: 0.8735; val_best_f1_score: 0.8810; train_kl_reg_loss: 84283.7257; train_edge_recon_loss: 2747759.1705; train_gene_expr_recon_loss: 12107492.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38611.4466; train_chrom_access_recon_loss: 10995119.8485; train_global_loss: 25973266.4242; train_optim_loss: 25973266.4242; val_kl_reg_loss: 84199.6299; val_edge_recon_loss: 2731951.9375; val_gene_expr_recon_loss: 12018995.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38246.2266; val_chrom_access_recon_loss: 10972725.1250; val_global_loss: 25846117.7500; val_optim_loss: 25846117.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9369; val_auprc_score: 0.9136; val_best_acc_score: 0.8807; val_best_f1_score: 0.8855; train_kl_reg_loss: 81782.6068; train_edge_recon_loss: 2728564.2765; train_gene_expr_recon_loss: 12072385.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37832.7228; train_chrom_access_recon_loss: 10964746.1212; train_global_loss: 25885311.3939; train_optim_loss: 25885311.3939; val_kl_reg_loss: 83498.9795; val_edge_recon_loss: 2737896.9375; val_gene_expr_recon_loss: 12000394.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37464.9180; val_chrom_access_recon_loss: 10950304.7500; val_global_loss: 25809560.0000; val_optim_loss: 25809560.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9383; val_auprc_score: 0.9149; val_best_acc_score: 0.8823; val_best_f1_score: 0.8886; train_kl_reg_loss: 81186.1907; train_edge_recon_loss: 2742200.9811; train_gene_expr_recon_loss: 12048718.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37078.4338; train_chrom_access_recon_loss: 10932519.4091; train_global_loss: 25841703.1212; train_optim_loss: 25841703.1212; val_kl_reg_loss: 80607.8682; val_edge_recon_loss: 2735260.5938; val_gene_expr_recon_loss: 12063681.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36854.7773; val_chrom_access_recon_loss: 10977764.5000; val_global_loss: 25894168.7500; val_optim_loss: 25894168.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9353; val_auprc_score: 0.9121; val_best_acc_score: 0.8807; val_best_f1_score: 0.8882; train_kl_reg_loss: 78372.5391; train_edge_recon_loss: 2730349.8826; train_gene_expr_recon_loss: 12020741.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36537.2280; train_chrom_access_recon_loss: 10904447.5152; train_global_loss: 25770448.9394; train_optim_loss: 25770448.9394; val_kl_reg_loss: 79315.0557; val_edge_recon_loss: 2741933.3438; val_gene_expr_recon_loss: 11994234.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36109.9844; val_chrom_access_recon_loss: 10851359.6250; val_global_loss: 25702952.5000; val_optim_loss: 25702952.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9325; val_auprc_score: 0.9047; val_best_acc_score: 0.8772; val_best_f1_score: 0.8852; train_kl_reg_loss: 78589.6214; train_edge_recon_loss: 2711138.3598; train_gene_expr_recon_loss: 11997346.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35924.8678; train_chrom_access_recon_loss: 10883337.4848; train_global_loss: 25706336.8485; train_optim_loss: 25706336.8485; val_kl_reg_loss: 80406.6865; val_edge_recon_loss: 2757277.3125; val_gene_expr_recon_loss: 12004251.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35612.6484; val_chrom_access_recon_loss: 10854200.2500; val_global_loss: 25731749.0000; val_optim_loss: 25731749.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9390; val_auprc_score: 0.9173; val_best_acc_score: 0.8772; val_best_f1_score: 0.8832; train_kl_reg_loss: 77729.7831; train_edge_recon_loss: 2720951.5189; train_gene_expr_recon_loss: 11966901.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35451.0920; train_chrom_access_recon_loss: 10848493.1515; train_global_loss: 25649526.6364; train_optim_loss: 25649526.6364; val_kl_reg_loss: 77423.0156; val_edge_recon_loss: 2736783.7812; val_gene_expr_recon_loss: 11809329.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35203.9180; val_chrom_access_recon_loss: 10749552.8750; val_global_loss: 25408293.0000; val_optim_loss: 25408293.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9297; val_auprc_score: 0.8951; val_best_acc_score: 0.8735; val_best_f1_score: 0.8814; train_kl_reg_loss: 75840.7163; train_edge_recon_loss: 2714995.7689; train_gene_expr_recon_loss: 11951835.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35015.8052; train_chrom_access_recon_loss: 10826460.7576; train_global_loss: 25604148.5152; train_optim_loss: 25604148.5152; val_kl_reg_loss: 75341.9639; val_edge_recon_loss: 2789476.9375; val_gene_expr_recon_loss: 11974488.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34835.2109; val_chrom_access_recon_loss: 10868052.1250; val_global_loss: 25742195.0000; val_optim_loss: 25742195.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9464; val_auprc_score: 0.9240; val_best_acc_score: 0.8866; val_best_f1_score: 0.8936; train_kl_reg_loss: 74956.8617; train_edge_recon_loss: 2713151.3144; train_gene_expr_recon_loss: 11936780.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34474.1059; train_chrom_access_recon_loss: 10815257.5000; train_global_loss: 25574620.0000; train_optim_loss: 25574620.0000; val_kl_reg_loss: 74443.9180; val_edge_recon_loss: 2707493.5625; val_gene_expr_recon_loss: 11932984.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34484.3555; val_chrom_access_recon_loss: 10805796.6250; val_global_loss: 25555202.5000; val_optim_loss: 25555202.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9477; val_auprc_score: 0.9239; val_best_acc_score: 0.8925; val_best_f1_score: 0.8978; train_kl_reg_loss: 74049.4429; train_edge_recon_loss: 2712880.0644; train_gene_expr_recon_loss: 11899652.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31826.3196; train_chrom_access_recon_loss: 10842533.6364; train_global_loss: 25560942.1212; train_optim_loss: 25560942.1212; val_kl_reg_loss: 65224.6406; val_edge_recon_loss: 2716215.0625; val_gene_expr_recon_loss: 11826460.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31292.0957; val_chrom_access_recon_loss: 10797581.6250; val_global_loss: 25436773.7500; val_optim_loss: 25436773.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9446; val_auprc_score: 0.9232; val_best_acc_score: 0.8869; val_best_f1_score: 0.8928; train_kl_reg_loss: 73728.4296; train_edge_recon_loss: 2707064.4886; train_gene_expr_recon_loss: 11853425.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30913.3918; train_chrom_access_recon_loss: 10767491.7879; train_global_loss: 25432623.1818; train_optim_loss: 25432623.1818; val_kl_reg_loss: 63289.2256; val_edge_recon_loss: 2737690.9062; val_gene_expr_recon_loss: 11791621.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30649.1582; val_chrom_access_recon_loss: 10679091.8750; val_global_loss: 25302341.5000; val_optim_loss: 25302341.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9494; val_auprc_score: 0.9330; val_best_acc_score: 0.8920; val_best_f1_score: 0.8969; train_kl_reg_loss: 73125.3782; train_edge_recon_loss: 2712661.8561; train_gene_expr_recon_loss: 11825106.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30455.5149; train_chrom_access_recon_loss: 10730141.3788; train_global_loss: 25371490.1515; train_optim_loss: 25371490.1515; val_kl_reg_loss: 65660.9702; val_edge_recon_loss: 2743342.9062; val_gene_expr_recon_loss: 11822899.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30269.2051; val_chrom_access_recon_loss: 10710097.5000; val_global_loss: 25372270.0000; val_optim_loss: 25372270.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9527; val_auprc_score: 0.9353; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 71810.4020; train_edge_recon_loss: 2699737.7008; train_gene_expr_recon_loss: 11802869.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30155.6562; train_chrom_access_recon_loss: 10705955.1818; train_global_loss: 25310528.9091; train_optim_loss: 25310528.9091; val_kl_reg_loss: 65018.6108; val_edge_recon_loss: 2724954.6250; val_gene_expr_recon_loss: 11786687.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29955.7402; val_chrom_access_recon_loss: 10704412.5000; val_global_loss: 25311029.7500; val_optim_loss: 25311029.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9462; val_auprc_score: 0.9219; val_best_acc_score: 0.8912; val_best_f1_score: 0.8962; train_kl_reg_loss: 70578.6299; train_edge_recon_loss: 2700607.7348; train_gene_expr_recon_loss: 11778885.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29825.8882; train_chrom_access_recon_loss: 10675415.1212; train_global_loss: 25255313.1515; train_optim_loss: 25255313.1515; val_kl_reg_loss: 61335.7900; val_edge_recon_loss: 2724739.9062; val_gene_expr_recon_loss: 11732782.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29678.7441; val_chrom_access_recon_loss: 10684057.2500; val_global_loss: 25232595.2500; val_optim_loss: 25232595.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9445; val_auprc_score: 0.9212; val_best_acc_score: 0.8869; val_best_f1_score: 0.8943; train_kl_reg_loss: 69256.9879; train_edge_recon_loss: 2706055.0341; train_gene_expr_recon_loss: 11774998.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29655.1312; train_chrom_access_recon_loss: 10662003.3939; train_global_loss: 25241968.7273; train_optim_loss: 25241968.7273; val_kl_reg_loss: 63061.4360; val_edge_recon_loss: 2734099.9688; val_gene_expr_recon_loss: 11807352.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29602.7676; val_chrom_access_recon_loss: 10617556.7500; val_global_loss: 25251673.7500; val_optim_loss: 25251673.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9538; val_auprc_score: 0.9386; val_best_acc_score: 0.9038; val_best_f1_score: 0.9083; train_kl_reg_loss: 67492.4112; train_edge_recon_loss: 2698123.4280; train_gene_expr_recon_loss: 11741310.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29558.2513; train_chrom_access_recon_loss: 10630344.3485; train_global_loss: 25166828.8182; train_optim_loss: 25166828.8182; val_kl_reg_loss: 63410.0410; val_edge_recon_loss: 2701200.5000; val_gene_expr_recon_loss: 11664068.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29451.6660; val_chrom_access_recon_loss: 10589443.7500; val_global_loss: 25047574.5000; val_optim_loss: 25047574.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9497; val_auprc_score: 0.9191; val_best_acc_score: 0.9011; val_best_f1_score: 0.9065; train_kl_reg_loss: 67699.0398; train_edge_recon_loss: 2682306.6250; train_gene_expr_recon_loss: 11722175.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29375.4344; train_chrom_access_recon_loss: 10623053.6970; train_global_loss: 25124610.4848; train_optim_loss: 25124610.4848; val_kl_reg_loss: 61376.6851; val_edge_recon_loss: 2712464.9688; val_gene_expr_recon_loss: 11666942.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29331.2871; val_chrom_access_recon_loss: 10499408.6250; val_global_loss: 24969524.0000; val_optim_loss: 24969524.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9491; val_auprc_score: 0.9243; val_best_acc_score: 0.8960; val_best_f1_score: 0.9016; train_kl_reg_loss: 66608.5856; train_edge_recon_loss: 2693936.6553; train_gene_expr_recon_loss: 11713678.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29269.8082; train_chrom_access_recon_loss: 10600213.8636; train_global_loss: 25103707.2121; train_optim_loss: 25103707.2121; val_kl_reg_loss: 60020.3599; val_edge_recon_loss: 2721950.8750; val_gene_expr_recon_loss: 11703449.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29198.3164; val_chrom_access_recon_loss: 10531211.0000; val_global_loss: 25045829.2500; val_optim_loss: 25045829.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9555; val_auprc_score: 0.9402; val_best_acc_score: 0.8990; val_best_f1_score: 0.9044; train_kl_reg_loss: 65499.0372; train_edge_recon_loss: 2692339.4697; train_gene_expr_recon_loss: 11688843.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29122.2832; train_chrom_access_recon_loss: 10576272.7576; train_global_loss: 25052076.8485; train_optim_loss: 25052076.8485; val_kl_reg_loss: 61041.7798; val_edge_recon_loss: 2713593.5938; val_gene_expr_recon_loss: 11785371.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29060.1738; val_chrom_access_recon_loss: 10550242.0000; val_global_loss: 25139308.5000; val_optim_loss: 25139308.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9543; val_auprc_score: 0.9343; val_best_acc_score: 0.9011; val_best_f1_score: 0.9052; train_kl_reg_loss: 65279.1790; train_edge_recon_loss: 2682950.6136; train_gene_expr_recon_loss: 11680058.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28995.2019; train_chrom_access_recon_loss: 10562144.1515; train_global_loss: 25019427.6061; train_optim_loss: 25019427.6061; val_kl_reg_loss: 60677.7427; val_edge_recon_loss: 2708750.7188; val_gene_expr_recon_loss: 11660578.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28980.6406; val_chrom_access_recon_loss: 10539018.6250; val_global_loss: 24998006.7500; val_optim_loss: 24998006.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9533; val_auprc_score: 0.9296; val_best_acc_score: 0.9022; val_best_f1_score: 0.9067; train_kl_reg_loss: 65122.9445; train_edge_recon_loss: 2681096.8182; train_gene_expr_recon_loss: 11657699.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28942.0995; train_chrom_access_recon_loss: 10535314.3636; train_global_loss: 24968175.4242; train_optim_loss: 24968175.4242; val_kl_reg_loss: 62497.4609; val_edge_recon_loss: 2718086.5312; val_gene_expr_recon_loss: 11698409.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28849.1445; val_chrom_access_recon_loss: 10640457.2500; val_global_loss: 25148299.2500; val_optim_loss: 25148299.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9483; val_auprc_score: 0.9206; val_best_acc_score: 0.8958; val_best_f1_score: 0.9012; train_kl_reg_loss: 64999.1721; train_edge_recon_loss: 2680627.0341; train_gene_expr_recon_loss: 11641984.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26642.2494; train_chrom_access_recon_loss: 10518412.2727; train_global_loss: 24932665.6970; train_optim_loss: 24932665.6970; val_kl_reg_loss: 62352.9907; val_edge_recon_loss: 2729968.4375; val_gene_expr_recon_loss: 11661086.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26125.5859; val_chrom_access_recon_loss: 10615185.6250; val_global_loss: 25094719.5000; val_optim_loss: 25094719.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9512; val_auprc_score: 0.9283; val_best_acc_score: 0.9052; val_best_f1_score: 0.9105; train_kl_reg_loss: 65191.0153; train_edge_recon_loss: 2673171.1023; train_gene_expr_recon_loss: 11631566.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26033.6849; train_chrom_access_recon_loss: 10511867.0455; train_global_loss: 24907829.2121; train_optim_loss: 24907829.2121; val_kl_reg_loss: 62498.1094; val_edge_recon_loss: 2710482.8438; val_gene_expr_recon_loss: 11656202.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25953.9375; val_chrom_access_recon_loss: 10533260.3750; val_global_loss: 24988398.5000; val_optim_loss: 24988398.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9486; val_auprc_score: 0.9269; val_best_acc_score: 0.8960; val_best_f1_score: 0.9015; train_kl_reg_loss: 65289.9506; train_edge_recon_loss: 2674092.5833; train_gene_expr_recon_loss: 11629328.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25903.4288; train_chrom_access_recon_loss: 10506658.0455; train_global_loss: 24901273.0606; train_optim_loss: 24901273.0606; val_kl_reg_loss: 62103.0225; val_edge_recon_loss: 2733393.6562; val_gene_expr_recon_loss: 11674481.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25851.6602; val_chrom_access_recon_loss: 10647897.1250; val_global_loss: 25143726.7500; val_optim_loss: 25143726.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9565; val_auprc_score: 0.9380; val_best_acc_score: 0.9049; val_best_f1_score: 0.9085; train_kl_reg_loss: 64945.6284; train_edge_recon_loss: 2678732.0455; train_gene_expr_recon_loss: 11626670.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25825.1493; train_chrom_access_recon_loss: 10506260.4697; train_global_loss: 24902433.4848; train_optim_loss: 24902433.4848; val_kl_reg_loss: 61598.9126; val_edge_recon_loss: 2691089.3125; val_gene_expr_recon_loss: 11725288.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25787.2070; val_chrom_access_recon_loss: 10588459.3750; val_global_loss: 25092222.5000; val_optim_loss: 25092222.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 43 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9530
val AUPRC score: 0.9331
val best accuracy score: 0.8982
val best F1 score: 0.9040
val target rna MSE score: 1.0166
val source rna MSE score: 0.3258
val target atac MSE score: 0.3264
val source atac MSE score: 0.0719
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
