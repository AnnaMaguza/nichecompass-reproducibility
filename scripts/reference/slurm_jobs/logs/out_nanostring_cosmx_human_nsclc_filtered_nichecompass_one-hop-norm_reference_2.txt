[True, False]
Run timestamp: 17082023_162948_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_filtered', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '20', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 883, n_cat_covariates_embed_input: 0, n_hidden: 883, n_latent: 1484, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 23, n_output: 883
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 23, n_output: 883

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9503; val_auprc_score: 0.9787; val_best_acc_score: 0.9210; val_best_f1_score: 0.9487; train_kl_reg_loss: 11460.8450; train_edge_recon_loss: 1373143.6059; train_gene_expr_recon_loss: 2272845.4971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3657449.9483; train_optim_loss: 3657449.9483; val_kl_reg_loss: 11053.5271; val_edge_recon_loss: 1353474.4370; val_gene_expr_recon_loss: 2086190.1014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3450718.0650; val_optim_loss: 3450718.0650
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9640; val_auprc_score: 0.9845; val_best_acc_score: 0.9368; val_best_f1_score: 0.9586; train_kl_reg_loss: 11986.4553; train_edge_recon_loss: 1325935.3475; train_gene_expr_recon_loss: 1952589.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3290511.3642; train_optim_loss: 3290511.3642; val_kl_reg_loss: 13786.9286; val_edge_recon_loss: 1343255.3701; val_gene_expr_recon_loss: 1829215.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3186258.0827; val_optim_loss: 3186258.0827
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9653; val_auprc_score: 0.9852; val_best_acc_score: 0.9385; val_best_f1_score: 0.9598; train_kl_reg_loss: 14482.1351; train_edge_recon_loss: 1320732.2243; train_gene_expr_recon_loss: 1759674.5765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3094888.9386; train_optim_loss: 3094888.9386; val_kl_reg_loss: 15030.9362; val_edge_recon_loss: 1333128.0955; val_gene_expr_recon_loss: 1699590.3848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3047749.4134; val_optim_loss: 3047749.4134
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9684; val_auprc_score: 0.9861; val_best_acc_score: 0.9422; val_best_f1_score: 0.9621; train_kl_reg_loss: 15791.8801; train_edge_recon_loss: 1322481.3431; train_gene_expr_recon_loss: 1662272.2801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3000545.5037; train_optim_loss: 3000545.5037; val_kl_reg_loss: 15891.5870; val_edge_recon_loss: 1337331.4262; val_gene_expr_recon_loss: 1627517.8819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2980740.8937; val_optim_loss: 2980740.8937
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9683; val_auprc_score: 0.9861; val_best_acc_score: 0.9417; val_best_f1_score: 0.9619; train_kl_reg_loss: 16463.9083; train_edge_recon_loss: 1319625.7103; train_gene_expr_recon_loss: 1609808.6976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2945898.3129; train_optim_loss: 2945898.3129; val_kl_reg_loss: 16463.4070; val_edge_recon_loss: 1341792.3839; val_gene_expr_recon_loss: 1589429.6841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2947685.4724; val_optim_loss: 2947685.4724
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9705; val_auprc_score: 0.9872; val_best_acc_score: 0.9443; val_best_f1_score: 0.9636; train_kl_reg_loss: 16970.1230; train_edge_recon_loss: 1318776.1993; train_gene_expr_recon_loss: 1579773.2010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2915519.5220; train_optim_loss: 2915519.5220; val_kl_reg_loss: 16708.7734; val_edge_recon_loss: 1337023.3976; val_gene_expr_recon_loss: 1565858.9626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2919591.1260; val_optim_loss: 2919591.1260
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9701; val_auprc_score: 0.9871; val_best_acc_score: 0.9440; val_best_f1_score: 0.9633; train_kl_reg_loss: 17169.9135; train_edge_recon_loss: 1319153.6506; train_gene_expr_recon_loss: 1558167.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2894490.6906; train_optim_loss: 2894490.6906; val_kl_reg_loss: 17711.4864; val_edge_recon_loss: 1335184.2608; val_gene_expr_recon_loss: 1555619.4104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2908515.1614; val_optim_loss: 2908515.1614
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9713; val_auprc_score: 0.9878; val_best_acc_score: 0.9446; val_best_f1_score: 0.9638; train_kl_reg_loss: 17454.0373; train_edge_recon_loss: 1321082.0198; train_gene_expr_recon_loss: 1542543.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2881079.1378; train_optim_loss: 2881079.1378; val_kl_reg_loss: 17659.7597; val_edge_recon_loss: 1330865.0659; val_gene_expr_recon_loss: 1539655.2067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2888180.0354; val_optim_loss: 2888180.0354
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9732; val_auprc_score: 0.9887; val_best_acc_score: 0.9462; val_best_f1_score: 0.9647; train_kl_reg_loss: 17683.5163; train_edge_recon_loss: 1318581.6292; train_gene_expr_recon_loss: 1530166.9853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2866432.1338; train_optim_loss: 2866432.1338; val_kl_reg_loss: 17689.0226; val_edge_recon_loss: 1327414.7333; val_gene_expr_recon_loss: 1528303.3169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2873407.0787; val_optim_loss: 2873407.0787
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9735; val_auprc_score: 0.9886; val_best_acc_score: 0.9472; val_best_f1_score: 0.9654; train_kl_reg_loss: 17793.2402; train_edge_recon_loss: 1316284.4210; train_gene_expr_recon_loss: 1522634.6776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2856712.3418; train_optim_loss: 2856712.3418; val_kl_reg_loss: 17697.8413; val_edge_recon_loss: 1334922.7776; val_gene_expr_recon_loss: 1535590.1496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2888210.7717; val_optim_loss: 2888210.7717
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9730; val_auprc_score: 0.9882; val_best_acc_score: 0.9468; val_best_f1_score: 0.9652; train_kl_reg_loss: 17961.3481; train_edge_recon_loss: 1317886.3452; train_gene_expr_recon_loss: 1513823.6869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2849671.3781; train_optim_loss: 2849671.3781; val_kl_reg_loss: 17870.5150; val_edge_recon_loss: 1332682.4035; val_gene_expr_recon_loss: 1514265.1585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2864818.0866; val_optim_loss: 2864818.0866
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9723; val_auprc_score: 0.9881; val_best_acc_score: 0.9463; val_best_f1_score: 0.9648; train_kl_reg_loss: 18013.5727; train_edge_recon_loss: 1315491.3787; train_gene_expr_recon_loss: 1508166.3136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2841671.2676; train_optim_loss: 2841671.2676; val_kl_reg_loss: 18473.2393; val_edge_recon_loss: 1336121.3041; val_gene_expr_recon_loss: 1522164.8878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2876759.4291; val_optim_loss: 2876759.4291
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9749; val_auprc_score: 0.9893; val_best_acc_score: 0.9483; val_best_f1_score: 0.9661; train_kl_reg_loss: 18240.4160; train_edge_recon_loss: 1316329.7893; train_gene_expr_recon_loss: 1502938.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2837508.8697; train_optim_loss: 2837508.8697; val_kl_reg_loss: 18171.3762; val_edge_recon_loss: 1326884.4124; val_gene_expr_recon_loss: 1503396.5118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2848452.2894; val_optim_loss: 2848452.2894
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9737; val_auprc_score: 0.9888; val_best_acc_score: 0.9476; val_best_f1_score: 0.9655; train_kl_reg_loss: 18314.9905; train_edge_recon_loss: 1316125.2901; train_gene_expr_recon_loss: 1499605.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2834045.3308; train_optim_loss: 2834045.3308; val_kl_reg_loss: 18568.0459; val_edge_recon_loss: 1341121.1693; val_gene_expr_recon_loss: 1500825.4646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2860514.6870; val_optim_loss: 2860514.6870
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9742; val_auprc_score: 0.9887; val_best_acc_score: 0.9487; val_best_f1_score: 0.9663; train_kl_reg_loss: 18430.7950; train_edge_recon_loss: 1314730.4714; train_gene_expr_recon_loss: 1493875.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2827036.9278; train_optim_loss: 2827036.9278; val_kl_reg_loss: 18735.2150; val_edge_recon_loss: 1337056.7293; val_gene_expr_recon_loss: 1499432.8770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2855224.8110; val_optim_loss: 2855224.8110
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9740; val_auprc_score: 0.9888; val_best_acc_score: 0.9481; val_best_f1_score: 0.9659; train_kl_reg_loss: 18515.4280; train_edge_recon_loss: 1318939.9397; train_gene_expr_recon_loss: 1489101.4009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2826556.7676; train_optim_loss: 2826556.7676; val_kl_reg_loss: 18167.8457; val_edge_recon_loss: 1339511.0226; val_gene_expr_recon_loss: 1492886.0797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2850564.9626; val_optim_loss: 2850564.9626
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9740; val_auprc_score: 0.9887; val_best_acc_score: 0.9475; val_best_f1_score: 0.9655; train_kl_reg_loss: 18568.1220; train_edge_recon_loss: 1317378.9418; train_gene_expr_recon_loss: 1487844.3029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2823791.3684; train_optim_loss: 2823791.3684; val_kl_reg_loss: 18794.7747; val_edge_recon_loss: 1339351.9213; val_gene_expr_recon_loss: 1492928.2293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2851074.9311; val_optim_loss: 2851074.9311

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9749; val_auprc_score: 0.9891; val_best_acc_score: 0.9499; val_best_f1_score: 0.9670; train_kl_reg_loss: 18397.6743; train_edge_recon_loss: 1312003.7300; train_gene_expr_recon_loss: 1466789.1950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2797190.6019; train_optim_loss: 2797190.6019; val_kl_reg_loss: 18370.4293; val_edge_recon_loss: 1332213.5581; val_gene_expr_recon_loss: 1475978.7382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2826562.7323; val_optim_loss: 2826562.7323
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9757; val_auprc_score: 0.9897; val_best_acc_score: 0.9497; val_best_f1_score: 0.9670; train_kl_reg_loss: 18309.3443; train_edge_recon_loss: 1313030.6899; train_gene_expr_recon_loss: 1463385.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2794725.0931; train_optim_loss: 2794725.0931; val_kl_reg_loss: 18431.4715; val_edge_recon_loss: 1327273.8652; val_gene_expr_recon_loss: 1474157.9892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2819863.3268; val_optim_loss: 2819863.3268
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9763; val_auprc_score: 0.9897; val_best_acc_score: 0.9507; val_best_f1_score: 0.9676; train_kl_reg_loss: 18224.1406; train_edge_recon_loss: 1315807.3234; train_gene_expr_recon_loss: 1461070.9454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2795102.4076; train_optim_loss: 2795102.4076; val_kl_reg_loss: 18134.9640; val_edge_recon_loss: 1332101.4006; val_gene_expr_recon_loss: 1473055.5659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2823291.9173; val_optim_loss: 2823291.9173
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9762; val_auprc_score: 0.9897; val_best_acc_score: 0.9510; val_best_f1_score: 0.9679; train_kl_reg_loss: 18216.6494; train_edge_recon_loss: 1311447.2281; train_gene_expr_recon_loss: 1460302.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789965.9012; train_optim_loss: 2789965.9012; val_kl_reg_loss: 18200.5935; val_edge_recon_loss: 1323572.3632; val_gene_expr_recon_loss: 1470921.9370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2812694.8996; val_optim_loss: 2812694.8996
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9758; val_auprc_score: 0.9896; val_best_acc_score: 0.9502; val_best_f1_score: 0.9673; train_kl_reg_loss: 18143.6660; train_edge_recon_loss: 1312602.3275; train_gene_expr_recon_loss: 1458626.9694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789372.9615; train_optim_loss: 2789372.9615; val_kl_reg_loss: 18104.3376; val_edge_recon_loss: 1328944.7510; val_gene_expr_recon_loss: 1470320.0167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2817369.1024; val_optim_loss: 2817369.1024
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9754; val_auprc_score: 0.9895; val_best_acc_score: 0.9499; val_best_f1_score: 0.9671; train_kl_reg_loss: 18043.1174; train_edge_recon_loss: 1312681.7905; train_gene_expr_recon_loss: 1457946.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2788671.6248; train_optim_loss: 2788671.6248; val_kl_reg_loss: 18061.4055; val_edge_recon_loss: 1330786.6801; val_gene_expr_recon_loss: 1468721.0374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2817569.1319; val_optim_loss: 2817569.1319
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9756; val_auprc_score: 0.9895; val_best_acc_score: 0.9502; val_best_f1_score: 0.9674; train_kl_reg_loss: 17934.8369; train_edge_recon_loss: 1314587.2548; train_gene_expr_recon_loss: 1456515.1652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789037.2568; train_optim_loss: 2789037.2568; val_kl_reg_loss: 17984.4084; val_edge_recon_loss: 1329474.5659; val_gene_expr_recon_loss: 1466662.3760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814121.3465; val_optim_loss: 2814121.3465
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9893; val_best_acc_score: 0.9502; val_best_f1_score: 0.9673; train_kl_reg_loss: 17934.6506; train_edge_recon_loss: 1314055.9313; train_gene_expr_recon_loss: 1456163.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2788153.6857; train_optim_loss: 2788153.6857; val_kl_reg_loss: 17969.8809; val_edge_recon_loss: 1334546.1033; val_gene_expr_recon_loss: 1466668.6654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2819184.6457; val_optim_loss: 2819184.6457

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9770; val_auprc_score: 0.9899; val_best_acc_score: 0.9522; val_best_f1_score: 0.9686; train_kl_reg_loss: 17910.1268; train_edge_recon_loss: 1311371.1479; train_gene_expr_recon_loss: 1452613.5215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781894.7940; train_optim_loss: 2781894.7940; val_kl_reg_loss: 17937.5354; val_edge_recon_loss: 1325253.5817; val_gene_expr_recon_loss: 1468125.2283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2811316.3386; val_optim_loss: 2811316.3386
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9769; val_auprc_score: 0.9903; val_best_acc_score: 0.9515; val_best_f1_score: 0.9681; train_kl_reg_loss: 17908.5431; train_edge_recon_loss: 1312013.5197; train_gene_expr_recon_loss: 1453073.2860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782995.3471; train_optim_loss: 2782995.3471; val_kl_reg_loss: 17891.6597; val_edge_recon_loss: 1327577.4823; val_gene_expr_recon_loss: 1465996.5669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2811465.7008; val_optim_loss: 2811465.7008
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9766; val_auprc_score: 0.9899; val_best_acc_score: 0.9513; val_best_f1_score: 0.9679; train_kl_reg_loss: 17899.2005; train_edge_recon_loss: 1314134.3886; train_gene_expr_recon_loss: 1452544.5410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784578.1329; train_optim_loss: 2784578.1329; val_kl_reg_loss: 17922.9342; val_edge_recon_loss: 1331064.1516; val_gene_expr_recon_loss: 1466660.3150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815647.3878; val_optim_loss: 2815647.3878
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9766; val_auprc_score: 0.9901; val_best_acc_score: 0.9506; val_best_f1_score: 0.9675; train_kl_reg_loss: 17880.7532; train_edge_recon_loss: 1314168.2953; train_gene_expr_recon_loss: 1452614.1012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784663.1479; train_optim_loss: 2784663.1479; val_kl_reg_loss: 17883.4525; val_edge_recon_loss: 1330888.1368; val_gene_expr_recon_loss: 1466801.5630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815573.1516; val_optim_loss: 2815573.1516
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9759; val_auprc_score: 0.9897; val_best_acc_score: 0.9507; val_best_f1_score: 0.9676; train_kl_reg_loss: 17878.0777; train_edge_recon_loss: 1310909.3418; train_gene_expr_recon_loss: 1452531.6949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781319.1144; train_optim_loss: 2781319.1144; val_kl_reg_loss: 17875.2414; val_edge_recon_loss: 1331090.7992; val_gene_expr_recon_loss: 1464782.0856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2813748.1358; val_optim_loss: 2813748.1358

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9764; val_auprc_score: 0.9897; val_best_acc_score: 0.9511; val_best_f1_score: 0.9678; train_kl_reg_loss: 17860.6755; train_edge_recon_loss: 1314376.6042; train_gene_expr_recon_loss: 1451966.8476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784204.1270; train_optim_loss: 2784204.1270; val_kl_reg_loss: 17878.4186; val_edge_recon_loss: 1332326.6850; val_gene_expr_recon_loss: 1466356.0098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2816561.1083; val_optim_loss: 2816561.1083
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9766; val_auprc_score: 0.9900; val_best_acc_score: 0.9512; val_best_f1_score: 0.9679; train_kl_reg_loss: 17868.5908; train_edge_recon_loss: 1313919.3119; train_gene_expr_recon_loss: 1452535.5309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784323.4364; train_optim_loss: 2784323.4364; val_kl_reg_loss: 17876.3473; val_edge_recon_loss: 1328566.7844; val_gene_expr_recon_loss: 1465260.4281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2811703.5689; val_optim_loss: 2811703.5689
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9759; val_auprc_score: 0.9897; val_best_acc_score: 0.9506; val_best_f1_score: 0.9676; train_kl_reg_loss: 17862.6437; train_edge_recon_loss: 1313488.0357; train_gene_expr_recon_loss: 1451921.5947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783272.2738; train_optim_loss: 2783272.2738; val_kl_reg_loss: 17863.3214; val_edge_recon_loss: 1334997.2667; val_gene_expr_recon_loss: 1466168.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2819029.3819; val_optim_loss: 2819029.3819
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9768; val_auprc_score: 0.9899; val_best_acc_score: 0.9523; val_best_f1_score: 0.9687; train_kl_reg_loss: 17858.4883; train_edge_recon_loss: 1315031.7662; train_gene_expr_recon_loss: 1452132.9339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2785023.1884; train_optim_loss: 2785023.1884; val_kl_reg_loss: 17875.7573; val_edge_recon_loss: 1326048.1545; val_gene_expr_recon_loss: 1465739.3159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2809663.2244; val_optim_loss: 2809663.2244
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9764; val_auprc_score: 0.9896; val_best_acc_score: 0.9513; val_best_f1_score: 0.9679; train_kl_reg_loss: 17852.5861; train_edge_recon_loss: 1314726.1751; train_gene_expr_recon_loss: 1452536.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2785115.3732; train_optim_loss: 2785115.3732; val_kl_reg_loss: 17867.0373; val_edge_recon_loss: 1332736.5571; val_gene_expr_recon_loss: 1465350.1909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815953.7736; val_optim_loss: 2815953.7736
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9773; val_auprc_score: 0.9903; val_best_acc_score: 0.9517; val_best_f1_score: 0.9683; train_kl_reg_loss: 17849.4170; train_edge_recon_loss: 1310842.7196; train_gene_expr_recon_loss: 1452029.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2780721.3281; train_optim_loss: 2780721.3281; val_kl_reg_loss: 17867.7273; val_edge_recon_loss: 1328402.7923; val_gene_expr_recon_loss: 1465839.6496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2812110.1732; val_optim_loss: 2812110.1732
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9765; val_auprc_score: 0.9897; val_best_acc_score: 0.9517; val_best_f1_score: 0.9682; train_kl_reg_loss: 17857.8617; train_edge_recon_loss: 1312465.5075; train_gene_expr_recon_loss: 1451712.8972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782036.2639; train_optim_loss: 2782036.2639; val_kl_reg_loss: 17861.9438; val_edge_recon_loss: 1331385.9902; val_gene_expr_recon_loss: 1468162.5768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2817410.5079; val_optim_loss: 2817410.5079
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9765; val_auprc_score: 0.9898; val_best_acc_score: 0.9512; val_best_f1_score: 0.9679; train_kl_reg_loss: 17860.0636; train_edge_recon_loss: 1312469.0087; train_gene_expr_recon_loss: 1452170.2599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782499.3336; train_optim_loss: 2782499.3336; val_kl_reg_loss: 17877.2457; val_edge_recon_loss: 1328486.4636; val_gene_expr_recon_loss: 1465802.2343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2812165.9449; val_optim_loss: 2812165.9449

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9768; val_auprc_score: 0.9902; val_best_acc_score: 0.9508; val_best_f1_score: 0.9677; train_kl_reg_loss: 17857.4959; train_edge_recon_loss: 1310807.2987; train_gene_expr_recon_loss: 1452061.6534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2780726.4461; train_optim_loss: 2780726.4461; val_kl_reg_loss: 17880.7878; val_edge_recon_loss: 1331525.6506; val_gene_expr_recon_loss: 1465822.6063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815229.0433; val_optim_loss: 2815229.0433
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9764; val_auprc_score: 0.9899; val_best_acc_score: 0.9514; val_best_f1_score: 0.9681; train_kl_reg_loss: 17859.5976; train_edge_recon_loss: 1313073.4838; train_gene_expr_recon_loss: 1451928.8173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782861.8937; train_optim_loss: 2782861.8937; val_kl_reg_loss: 17884.2863; val_edge_recon_loss: 1327645.0551; val_gene_expr_recon_loss: 1464957.8346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810487.1831; val_optim_loss: 2810487.1831
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9767; val_auprc_score: 0.9900; val_best_acc_score: 0.9517; val_best_f1_score: 0.9682; train_kl_reg_loss: 17857.7416; train_edge_recon_loss: 1313771.8540; train_gene_expr_recon_loss: 1452689.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784319.0191; train_optim_loss: 2784319.0191; val_kl_reg_loss: 17884.8119; val_edge_recon_loss: 1326034.9094; val_gene_expr_recon_loss: 1464334.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2808254.4075; val_optim_loss: 2808254.4075
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9761; val_auprc_score: 0.9898; val_best_acc_score: 0.9512; val_best_f1_score: 0.9679; train_kl_reg_loss: 17858.0555; train_edge_recon_loss: 1312560.7850; train_gene_expr_recon_loss: 1452058.7120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782477.5526; train_optim_loss: 2782477.5526; val_kl_reg_loss: 17868.1228; val_edge_recon_loss: 1329647.4016; val_gene_expr_recon_loss: 1465038.2795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2812553.7992; val_optim_loss: 2812553.7992
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9766; val_auprc_score: 0.9901; val_best_acc_score: 0.9516; val_best_f1_score: 0.9682; train_kl_reg_loss: 17857.2186; train_edge_recon_loss: 1314060.3220; train_gene_expr_recon_loss: 1451874.9266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783792.4685; train_optim_loss: 2783792.4685; val_kl_reg_loss: 17875.4362; val_edge_recon_loss: 1321784.7156; val_gene_expr_recon_loss: 1467727.7717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807387.9272; val_optim_loss: 2807387.9272
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9765; val_auprc_score: 0.9898; val_best_acc_score: 0.9516; val_best_f1_score: 0.9681; train_kl_reg_loss: 17861.7649; train_edge_recon_loss: 1310733.5923; train_gene_expr_recon_loss: 1451712.1722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2780307.5346; train_optim_loss: 2780307.5346; val_kl_reg_loss: 17869.0664; val_edge_recon_loss: 1332806.8081; val_gene_expr_recon_loss: 1465824.8593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2816500.7441; val_optim_loss: 2816500.7441
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9763; val_auprc_score: 0.9899; val_best_acc_score: 0.9511; val_best_f1_score: 0.9679; train_kl_reg_loss: 17858.4027; train_edge_recon_loss: 1311206.0827; train_gene_expr_recon_loss: 1451972.2317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781036.7157; train_optim_loss: 2781036.7157; val_kl_reg_loss: 17879.0680; val_edge_recon_loss: 1322414.2096; val_gene_expr_recon_loss: 1466270.8159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2806564.0846; val_optim_loss: 2806564.0846
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9772; val_auprc_score: 0.9902; val_best_acc_score: 0.9516; val_best_f1_score: 0.9683; train_kl_reg_loss: 17858.3671; train_edge_recon_loss: 1314517.9773; train_gene_expr_recon_loss: 1451542.1624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783918.5068; train_optim_loss: 2783918.5068; val_kl_reg_loss: 17879.3792; val_edge_recon_loss: 1321376.7963; val_gene_expr_recon_loss: 1466696.9941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2805953.1654; val_optim_loss: 2805953.1654
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9763; val_auprc_score: 0.9898; val_best_acc_score: 0.9514; val_best_f1_score: 0.9681; train_kl_reg_loss: 17861.7866; train_edge_recon_loss: 1313968.2208; train_gene_expr_recon_loss: 1451735.7173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783565.7256; train_optim_loss: 2783565.7256; val_kl_reg_loss: 17872.1449; val_edge_recon_loss: 1324513.5049; val_gene_expr_recon_loss: 1464784.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807170.4783; val_optim_loss: 2807170.4783
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9767; val_auprc_score: 0.9901; val_best_acc_score: 0.9518; val_best_f1_score: 0.9683; train_kl_reg_loss: 17857.5559; train_edge_recon_loss: 1313777.8937; train_gene_expr_recon_loss: 1451670.9964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783306.4399; train_optim_loss: 2783306.4399; val_kl_reg_loss: 17870.5863; val_edge_recon_loss: 1320221.7313; val_gene_expr_recon_loss: 1463924.0659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802016.3780; val_optim_loss: 2802016.3780
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9773; val_auprc_score: 0.9903; val_best_acc_score: 0.9518; val_best_f1_score: 0.9683; train_kl_reg_loss: 17856.7163; train_edge_recon_loss: 1312246.9045; train_gene_expr_recon_loss: 1452355.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782458.8228; train_optim_loss: 2782458.8228; val_kl_reg_loss: 17868.2530; val_edge_recon_loss: 1326635.3740; val_gene_expr_recon_loss: 1465453.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2809957.2815; val_optim_loss: 2809957.2815
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9760; val_auprc_score: 0.9898; val_best_acc_score: 0.9501; val_best_f1_score: 0.9672; train_kl_reg_loss: 17858.3970; train_edge_recon_loss: 1311878.6949; train_gene_expr_recon_loss: 1452276.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782013.4903; train_optim_loss: 2782013.4903; val_kl_reg_loss: 17879.9658; val_edge_recon_loss: 1331666.1998; val_gene_expr_recon_loss: 1466078.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815624.3858; val_optim_loss: 2815624.3858
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9767; val_auprc_score: 0.9901; val_best_acc_score: 0.9518; val_best_f1_score: 0.9684; train_kl_reg_loss: 17856.1521; train_edge_recon_loss: 1310758.8164; train_gene_expr_recon_loss: 1451655.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2780270.7368; train_optim_loss: 2780270.7368; val_kl_reg_loss: 17866.9423; val_edge_recon_loss: 1318110.0492; val_gene_expr_recon_loss: 1465813.0974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2801790.0866; val_optim_loss: 2801790.0866
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9763; val_auprc_score: 0.9898; val_best_acc_score: 0.9516; val_best_f1_score: 0.9682; train_kl_reg_loss: 17855.2345; train_edge_recon_loss: 1312079.4783; train_gene_expr_recon_loss: 1452027.1987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781961.9100; train_optim_loss: 2781961.9100; val_kl_reg_loss: 17881.5307; val_edge_recon_loss: 1332854.3573; val_gene_expr_recon_loss: 1465765.0994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2816500.9823; val_optim_loss: 2816500.9823
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9762; val_auprc_score: 0.9897; val_best_acc_score: 0.9500; val_best_f1_score: 0.9672; train_kl_reg_loss: 17857.9815; train_edge_recon_loss: 1312630.5968; train_gene_expr_recon_loss: 1451165.0936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781653.6741; train_optim_loss: 2781653.6741; val_kl_reg_loss: 17863.1754; val_edge_recon_loss: 1331519.2963; val_gene_expr_recon_loss: 1464844.0138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814226.4941; val_optim_loss: 2814226.4941
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9763; val_auprc_score: 0.9899; val_best_acc_score: 0.9507; val_best_f1_score: 0.9677; train_kl_reg_loss: 17861.3417; train_edge_recon_loss: 1313194.4118; train_gene_expr_recon_loss: 1452017.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783073.0971; train_optim_loss: 2783073.0971; val_kl_reg_loss: 17874.9128; val_edge_recon_loss: 1322950.7343; val_gene_expr_recon_loss: 1466474.0030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807299.6535; val_optim_loss: 2807299.6535
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9767; val_auprc_score: 0.9900; val_best_acc_score: 0.9514; val_best_f1_score: 0.9681; train_kl_reg_loss: 17858.9536; train_edge_recon_loss: 1311670.7373; train_gene_expr_recon_loss: 1451820.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781350.1798; train_optim_loss: 2781350.1798; val_kl_reg_loss: 17890.1665; val_edge_recon_loss: 1329048.0866; val_gene_expr_recon_loss: 1467541.3868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814479.6555; val_optim_loss: 2814479.6555

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9762; val_auprc_score: 0.9897; val_best_acc_score: 0.9511; val_best_f1_score: 0.9679; train_kl_reg_loss: 17854.4389; train_edge_recon_loss: 1313185.4050; train_gene_expr_recon_loss: 1451802.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2782842.7832; train_optim_loss: 2782842.7832; val_kl_reg_loss: 17869.6920; val_edge_recon_loss: 1328924.6191; val_gene_expr_recon_loss: 1466968.8937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2813763.1988; val_optim_loss: 2813763.1988
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9762; val_auprc_score: 0.9897; val_best_acc_score: 0.9511; val_best_f1_score: 0.9679; train_kl_reg_loss: 17858.0310; train_edge_recon_loss: 1312883.5924; train_gene_expr_recon_loss: 1452613.5021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783355.1272; train_optim_loss: 2783355.1272; val_kl_reg_loss: 17868.5324; val_edge_recon_loss: 1326340.1427; val_gene_expr_recon_loss: 1467572.6781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2811781.3386; val_optim_loss: 2811781.3386
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9762; val_auprc_score: 0.9896; val_best_acc_score: 0.9515; val_best_f1_score: 0.9680; train_kl_reg_loss: 17856.2578; train_edge_recon_loss: 1311637.0150; train_gene_expr_recon_loss: 1451982.6948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2781475.9661; train_optim_loss: 2781475.9661; val_kl_reg_loss: 17874.3233; val_edge_recon_loss: 1335070.1427; val_gene_expr_recon_loss: 1465902.9823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2818847.4370; val_optim_loss: 2818847.4370
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9771; val_auprc_score: 0.9902; val_best_acc_score: 0.9517; val_best_f1_score: 0.9683; train_kl_reg_loss: 17857.0268; train_edge_recon_loss: 1313874.7920; train_gene_expr_recon_loss: 1451704.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783436.4901; train_optim_loss: 2783436.4901; val_kl_reg_loss: 17881.3915; val_edge_recon_loss: 1323984.7421; val_gene_expr_recon_loss: 1465292.7795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807158.9094; val_optim_loss: 2807158.9094

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1157 min 34 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9767
val AUPRC score: 0.9900
val best accuracy score: 0.9520
val best F1 score: 0.9684
val target rna MSE score: 0.4086
val source rna MSE score: 0.0480
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.0900

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
