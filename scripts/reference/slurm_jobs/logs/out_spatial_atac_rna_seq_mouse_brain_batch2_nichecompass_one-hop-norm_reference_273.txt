[True]
Run timestamp: 10102023_130644_273.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_273']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7831; val_auprc_score: 0.8032; val_best_acc_score: 0.5955; val_best_f1_score: 0.7052; train_kl_reg_loss: 74423.2786; train_edge_recon_loss: 747562.9346; train_gene_expr_recon_loss: 22070284.6718; train_masked_gp_l1_reg_loss: 40446.5851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2763734.1302; train_chrom_access_recon_loss: 4751435.5992; train_global_loss: 30447887.0992; train_optim_loss: 30447887.0992; val_kl_reg_loss: 85509.7646; val_edge_recon_loss: 811956.6250; val_gene_expr_recon_loss: 21121032.4000; val_masked_gp_l1_reg_loss: 44245.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 922664.1875; val_chrom_access_recon_loss: 4658304.5333; val_global_loss: 27643713.0667; val_optim_loss: 27643713.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8594; val_auprc_score: 0.8605; val_best_acc_score: 0.7534; val_best_f1_score: 0.7751; train_kl_reg_loss: 72509.4627; train_edge_recon_loss: 729415.2996; train_gene_expr_recon_loss: 20914322.6565; train_masked_gp_l1_reg_loss: 45880.4580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 484576.4974; train_chrom_access_recon_loss: 4593423.0344; train_global_loss: 26840127.4504; train_optim_loss: 26840127.4504; val_kl_reg_loss: 73564.9000; val_edge_recon_loss: 782695.5458; val_gene_expr_recon_loss: 20755797.6000; val_masked_gp_l1_reg_loss: 47780.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 263612.1562; val_chrom_access_recon_loss: 4583840.0333; val_global_loss: 26507290.1333; val_optim_loss: 26507290.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9102; val_auprc_score: 0.8994; val_best_acc_score: 0.8298; val_best_f1_score: 0.8388; train_kl_reg_loss: 64233.5122; train_edge_recon_loss: 692923.4981; train_gene_expr_recon_loss: 20626401.2366; train_masked_gp_l1_reg_loss: 49655.0886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207872.2927; train_chrom_access_recon_loss: 4544618.0611; train_global_loss: 26185703.6489; train_optim_loss: 26185703.6489; val_kl_reg_loss: 67016.4138; val_edge_recon_loss: 653931.0417; val_gene_expr_recon_loss: 20505501.4667; val_masked_gp_l1_reg_loss: 51494.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174491.7500; val_chrom_access_recon_loss: 4553820.3333; val_global_loss: 26006255.3333; val_optim_loss: 26006255.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9213; val_auprc_score: 0.9109; val_best_acc_score: 0.8476; val_best_f1_score: 0.8566; train_kl_reg_loss: 70979.2916; train_edge_recon_loss: 626885.3912; train_gene_expr_recon_loss: 20370996.7328; train_masked_gp_l1_reg_loss: 53454.3563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154366.7952; train_chrom_access_recon_loss: 4494446.8683; train_global_loss: 25771129.3588; train_optim_loss: 25771129.3588; val_kl_reg_loss: 71667.5599; val_edge_recon_loss: 616994.7625; val_gene_expr_recon_loss: 20267446.8000; val_masked_gp_l1_reg_loss: 55323.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138763.1875; val_chrom_access_recon_loss: 4487690.9333; val_global_loss: 25637887.8667; val_optim_loss: 25637887.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9297; val_auprc_score: 0.9172; val_best_acc_score: 0.8604; val_best_f1_score: 0.8656; train_kl_reg_loss: 69004.9345; train_edge_recon_loss: 610972.0010; train_gene_expr_recon_loss: 20178165.5420; train_masked_gp_l1_reg_loss: 56641.4288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128096.3300; train_chrom_access_recon_loss: 4464782.2004; train_global_loss: 25507662.6565; train_optim_loss: 25507662.6565; val_kl_reg_loss: 67735.6633; val_edge_recon_loss: 609332.5792; val_gene_expr_recon_loss: 20032507.4667; val_masked_gp_l1_reg_loss: 57949.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119379.8438; val_chrom_access_recon_loss: 4473939.2833; val_global_loss: 25360845.3333; val_optim_loss: 25360845.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9380; val_auprc_score: 0.9233; val_best_acc_score: 0.8752; val_best_f1_score: 0.8793; train_kl_reg_loss: 66500.9787; train_edge_recon_loss: 603191.2137; train_gene_expr_recon_loss: 20002615.5115; train_masked_gp_l1_reg_loss: 58921.9725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113177.3799; train_chrom_access_recon_loss: 4424476.9237; train_global_loss: 25268884.1679; train_optim_loss: 25268884.1679; val_kl_reg_loss: 64035.4987; val_edge_recon_loss: 599910.9958; val_gene_expr_recon_loss: 19986482.8000; val_masked_gp_l1_reg_loss: 59893.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108958.2422; val_chrom_access_recon_loss: 4425394.1500; val_global_loss: 25244675.4667; val_optim_loss: 25244675.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9400; val_auprc_score: 0.9257; val_best_acc_score: 0.8758; val_best_f1_score: 0.8813; train_kl_reg_loss: 63964.3819; train_edge_recon_loss: 597558.6784; train_gene_expr_recon_loss: 19865636.7786; train_masked_gp_l1_reg_loss: 60706.1331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104124.3579; train_chrom_access_recon_loss: 4393416.5458; train_global_loss: 25085406.9924; train_optim_loss: 25085406.9924; val_kl_reg_loss: 65612.4698; val_edge_recon_loss: 596083.1417; val_gene_expr_recon_loss: 19797443.3333; val_masked_gp_l1_reg_loss: 61472.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100198.1328; val_chrom_access_recon_loss: 4380090.5167; val_global_loss: 25000899.4667; val_optim_loss: 25000899.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9489; val_auprc_score: 0.9421; val_best_acc_score: 0.8812; val_best_f1_score: 0.8872; train_kl_reg_loss: 62413.0024; train_edge_recon_loss: 592933.4509; train_gene_expr_recon_loss: 19767199.3130; train_masked_gp_l1_reg_loss: 62201.4326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97329.7982; train_chrom_access_recon_loss: 4373378.5210; train_global_loss: 24955455.4504; train_optim_loss: 24955455.4504; val_kl_reg_loss: 60653.5622; val_edge_recon_loss: 592755.7042; val_gene_expr_recon_loss: 19632200.2667; val_masked_gp_l1_reg_loss: 62828.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94477.5000; val_chrom_access_recon_loss: 4361959.6667; val_global_loss: 24804875.0667; val_optim_loss: 24804875.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9456; val_auprc_score: 0.9355; val_best_acc_score: 0.8801; val_best_f1_score: 0.8860; train_kl_reg_loss: 60179.6753; train_edge_recon_loss: 590152.1990; train_gene_expr_recon_loss: 19647817.0076; train_masked_gp_l1_reg_loss: 63395.0451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92422.4686; train_chrom_access_recon_loss: 4345608.7309; train_global_loss: 24799575.1145; train_optim_loss: 24799575.1145; val_kl_reg_loss: 60167.8852; val_edge_recon_loss: 595461.0042; val_gene_expr_recon_loss: 19613240.9333; val_masked_gp_l1_reg_loss: 64007.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91512.0000; val_chrom_access_recon_loss: 4351929.5000; val_global_loss: 24776319.6000; val_optim_loss: 24776319.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9528; val_auprc_score: 0.9407; val_best_acc_score: 0.8872; val_best_f1_score: 0.8922; train_kl_reg_loss: 59012.1372; train_edge_recon_loss: 587311.2419; train_gene_expr_recon_loss: 19522141.0992; train_masked_gp_l1_reg_loss: 64539.0437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89119.7521; train_chrom_access_recon_loss: 4315491.2748; train_global_loss: 24637614.6870; train_optim_loss: 24637614.6870; val_kl_reg_loss: 56941.1826; val_edge_recon_loss: 588552.5208; val_gene_expr_recon_loss: 19497653.2000; val_masked_gp_l1_reg_loss: 65001.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88353.9297; val_chrom_access_recon_loss: 4324633.6333; val_global_loss: 24621136.2667; val_optim_loss: 24621136.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9567; val_auprc_score: 0.9434; val_best_acc_score: 0.8937; val_best_f1_score: 0.8966; train_kl_reg_loss: 57989.9144; train_edge_recon_loss: 584233.6135; train_gene_expr_recon_loss: 19439199.0382; train_masked_gp_l1_reg_loss: 65485.5643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86716.8336; train_chrom_access_recon_loss: 4290722.6050; train_global_loss: 24524347.6336; train_optim_loss: 24524347.6336; val_kl_reg_loss: 57575.2510; val_edge_recon_loss: 583659.1958; val_gene_expr_recon_loss: 19422458.2667; val_masked_gp_l1_reg_loss: 65907.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85744.2656; val_chrom_access_recon_loss: 4302141.3833; val_global_loss: 24517486.4000; val_optim_loss: 24517486.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9578; val_auprc_score: 0.9499; val_best_acc_score: 0.8948; val_best_f1_score: 0.8993; train_kl_reg_loss: 56876.9735; train_edge_recon_loss: 581527.0868; train_gene_expr_recon_loss: 19359818.7939; train_masked_gp_l1_reg_loss: 66375.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84809.2018; train_chrom_access_recon_loss: 4274157.0573; train_global_loss: 24423564.6107; train_optim_loss: 24423564.6107; val_kl_reg_loss: 58178.2698; val_edge_recon_loss: 583282.4667; val_gene_expr_recon_loss: 19311064.2667; val_masked_gp_l1_reg_loss: 66965.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84760.7656; val_chrom_access_recon_loss: 4276676.5833; val_global_loss: 24380927.7333; val_optim_loss: 24380927.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9611; val_auprc_score: 0.9509; val_best_acc_score: 0.9016; val_best_f1_score: 0.9046; train_kl_reg_loss: 55958.5934; train_edge_recon_loss: 579671.1198; train_gene_expr_recon_loss: 19280505.4656; train_masked_gp_l1_reg_loss: 67452.9721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83769.7546; train_chrom_access_recon_loss: 4254559.8492; train_global_loss: 24321917.8779; train_optim_loss: 24321917.8779; val_kl_reg_loss: 56031.6039; val_edge_recon_loss: 578616.3333; val_gene_expr_recon_loss: 19277744.4000; val_masked_gp_l1_reg_loss: 67949.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83790.8828; val_chrom_access_recon_loss: 4281617.9500; val_global_loss: 24345750.4000; val_optim_loss: 24345750.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9639; val_auprc_score: 0.9566; val_best_acc_score: 0.9047; val_best_f1_score: 0.9089; train_kl_reg_loss: 54955.3270; train_edge_recon_loss: 578539.6250; train_gene_expr_recon_loss: 19196651.1145; train_masked_gp_l1_reg_loss: 68447.8542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83071.3993; train_chrom_access_recon_loss: 4229955.5763; train_global_loss: 24211620.8092; train_optim_loss: 24211620.8092; val_kl_reg_loss: 55338.1427; val_edge_recon_loss: 579055.4250; val_gene_expr_recon_loss: 19037333.2000; val_masked_gp_l1_reg_loss: 69016.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82663.6484; val_chrom_access_recon_loss: 4216781.8833; val_global_loss: 24040188.5333; val_optim_loss: 24040188.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9599; val_auprc_score: 0.9483; val_best_acc_score: 0.9020; val_best_f1_score: 0.9065; train_kl_reg_loss: 54237.2909; train_edge_recon_loss: 577798.9165; train_gene_expr_recon_loss: 19131606.2595; train_masked_gp_l1_reg_loss: 69491.5234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82459.7242; train_chrom_access_recon_loss: 4207951.3053; train_global_loss: 24123545.0534; train_optim_loss: 24123545.0534; val_kl_reg_loss: 53383.6042; val_edge_recon_loss: 582111.5292; val_gene_expr_recon_loss: 19135069.6000; val_masked_gp_l1_reg_loss: 70011.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82069.9062; val_chrom_access_recon_loss: 4213778.4333; val_global_loss: 24136425.2000; val_optim_loss: 24136425.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9675; val_auprc_score: 0.9582; val_best_acc_score: 0.9158; val_best_f1_score: 0.9193; train_kl_reg_loss: 53394.9752; train_edge_recon_loss: 576391.8593; train_gene_expr_recon_loss: 19079786.1069; train_masked_gp_l1_reg_loss: 70563.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81679.6087; train_chrom_access_recon_loss: 4188065.3034; train_global_loss: 24049881.5115; train_optim_loss: 24049881.5115; val_kl_reg_loss: 51892.5948; val_edge_recon_loss: 577030.3917; val_gene_expr_recon_loss: 19013452.9333; val_masked_gp_l1_reg_loss: 71209.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81499.7422; val_chrom_access_recon_loss: 4181853.7333; val_global_loss: 23976939.8667; val_optim_loss: 23976939.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9663; val_auprc_score: 0.9597; val_best_acc_score: 0.9130; val_best_f1_score: 0.9147; train_kl_reg_loss: 52692.2343; train_edge_recon_loss: 574864.7409; train_gene_expr_recon_loss: 19002878.0916; train_masked_gp_l1_reg_loss: 71740.2350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81387.8610; train_chrom_access_recon_loss: 4163832.3950; train_global_loss: 23947395.5267; train_optim_loss: 23947395.5267; val_kl_reg_loss: 51917.8076; val_edge_recon_loss: 577013.7333; val_gene_expr_recon_loss: 18989560.1333; val_masked_gp_l1_reg_loss: 72308.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81313.2578; val_chrom_access_recon_loss: 4194354.1167; val_global_loss: 23966468.0000; val_optim_loss: 23966468.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9682; val_auprc_score: 0.9605; val_best_acc_score: 0.9174; val_best_f1_score: 0.9205; train_kl_reg_loss: 52080.9101; train_edge_recon_loss: 574612.2853; train_gene_expr_recon_loss: 18963189.2366; train_masked_gp_l1_reg_loss: 73000.0882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81232.4955; train_chrom_access_recon_loss: 4146548.6088; train_global_loss: 23890663.7557; train_optim_loss: 23890663.7557; val_kl_reg_loss: 51211.6227; val_edge_recon_loss: 573733.6875; val_gene_expr_recon_loss: 18919612.5333; val_masked_gp_l1_reg_loss: 73651.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81474.6484; val_chrom_access_recon_loss: 4150561.3167; val_global_loss: 23850244.9333; val_optim_loss: 23850244.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9674; val_auprc_score: 0.9615; val_best_acc_score: 0.9101; val_best_f1_score: 0.9140; train_kl_reg_loss: 51824.6540; train_edge_recon_loss: 572263.1479; train_gene_expr_recon_loss: 18878829.6794; train_masked_gp_l1_reg_loss: 74284.4577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81124.8205; train_chrom_access_recon_loss: 4119950.9103; train_global_loss: 23778277.8931; train_optim_loss: 23778277.8931; val_kl_reg_loss: 52046.0250; val_edge_recon_loss: 577046.9583; val_gene_expr_recon_loss: 18875927.4667; val_masked_gp_l1_reg_loss: 74904.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82065.6562; val_chrom_access_recon_loss: 4131684.7667; val_global_loss: 23793675.2000; val_optim_loss: 23793675.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9675; val_auprc_score: 0.9582; val_best_acc_score: 0.9171; val_best_f1_score: 0.9201; train_kl_reg_loss: 51151.0423; train_edge_recon_loss: 573515.6856; train_gene_expr_recon_loss: 18830036.0153; train_masked_gp_l1_reg_loss: 75591.3625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81517.0818; train_chrom_access_recon_loss: 4103030.1260; train_global_loss: 23714841.2977; train_optim_loss: 23714841.2977; val_kl_reg_loss: 50273.9815; val_edge_recon_loss: 574777.7792; val_gene_expr_recon_loss: 18907627.8667; val_masked_gp_l1_reg_loss: 76165.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82816.3594; val_chrom_access_recon_loss: 4157552.3167; val_global_loss: 23849214.0000; val_optim_loss: 23849214.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9676; val_auprc_score: 0.9602; val_best_acc_score: 0.9131; val_best_f1_score: 0.9172; train_kl_reg_loss: 50867.9601; train_edge_recon_loss: 573324.9036; train_gene_expr_recon_loss: 18761830.0611; train_masked_gp_l1_reg_loss: 76828.6581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81930.7604; train_chrom_access_recon_loss: 4079194.1336; train_global_loss: 23623976.5649; train_optim_loss: 23623976.5649; val_kl_reg_loss: 51344.7109; val_edge_recon_loss: 573895.1417; val_gene_expr_recon_loss: 18835445.7333; val_masked_gp_l1_reg_loss: 77428.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82164.3281; val_chrom_access_recon_loss: 4127451.6167; val_global_loss: 23747729.4667; val_optim_loss: 23747729.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9649; val_auprc_score: 0.9532; val_best_acc_score: 0.9146; val_best_f1_score: 0.9177; train_kl_reg_loss: 50799.2039; train_edge_recon_loss: 572633.7786; train_gene_expr_recon_loss: 18719237.5115; train_masked_gp_l1_reg_loss: 78034.4126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82360.7066; train_chrom_access_recon_loss: 4061657.5821; train_global_loss: 23564723.1450; train_optim_loss: 23564723.1450; val_kl_reg_loss: 50844.0195; val_edge_recon_loss: 575895.3083; val_gene_expr_recon_loss: 18758694.2667; val_masked_gp_l1_reg_loss: 78586.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83335.6953; val_chrom_access_recon_loss: 4089869.7500; val_global_loss: 23637226.0000; val_optim_loss: 23637226.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9643; val_auprc_score: 0.9551; val_best_acc_score: 0.9119; val_best_f1_score: 0.9160; train_kl_reg_loss: 50861.4924; train_edge_recon_loss: 572164.2009; train_gene_expr_recon_loss: 18659192.8244; train_masked_gp_l1_reg_loss: 79133.7641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82932.4456; train_chrom_access_recon_loss: 4043024.6069; train_global_loss: 23487309.3435; train_optim_loss: 23487309.3435; val_kl_reg_loss: 49641.4859; val_edge_recon_loss: 577114.6917; val_gene_expr_recon_loss: 18723743.0667; val_masked_gp_l1_reg_loss: 79618.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84616.3594; val_chrom_access_recon_loss: 4100106.7333; val_global_loss: 23614839.7333; val_optim_loss: 23614839.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9641; val_auprc_score: 0.9532; val_best_acc_score: 0.9178; val_best_f1_score: 0.9211; train_kl_reg_loss: 50786.0123; train_edge_recon_loss: 573783.0248; train_gene_expr_recon_loss: 18602520.8092; train_masked_gp_l1_reg_loss: 80118.6585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83904.6985; train_chrom_access_recon_loss: 4019287.6336; train_global_loss: 23410400.9160; train_optim_loss: 23410400.9160; val_kl_reg_loss: 50562.9187; val_edge_recon_loss: 574390.6250; val_gene_expr_recon_loss: 18690680.5333; val_masked_gp_l1_reg_loss: 80550.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83841.1953; val_chrom_access_recon_loss: 4072198.8833; val_global_loss: 23552225.0667; val_optim_loss: 23552225.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9643; val_auprc_score: 0.9553; val_best_acc_score: 0.9123; val_best_f1_score: 0.9157; train_kl_reg_loss: 51155.7112; train_edge_recon_loss: 572783.0172; train_gene_expr_recon_loss: 18532387.3893; train_masked_gp_l1_reg_loss: 81015.0831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83752.1406; train_chrom_access_recon_loss: 3996107.8893; train_global_loss: 23317201.1908; train_optim_loss: 23317201.1908; val_kl_reg_loss: 51021.9555; val_edge_recon_loss: 578241.0625; val_gene_expr_recon_loss: 18623924.9333; val_masked_gp_l1_reg_loss: 81447.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84146.4141; val_chrom_access_recon_loss: 4052263.7000; val_global_loss: 23471045.3333; val_optim_loss: 23471045.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9603; val_auprc_score: 0.9476; val_best_acc_score: 0.9084; val_best_f1_score: 0.9105; train_kl_reg_loss: 51681.9748; train_edge_recon_loss: 573515.0558; train_gene_expr_recon_loss: 18497344.1221; train_masked_gp_l1_reg_loss: 81845.0790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84312.7041; train_chrom_access_recon_loss: 3982944.4351; train_global_loss: 23271643.3282; train_optim_loss: 23271643.3282; val_kl_reg_loss: 52680.3458; val_edge_recon_loss: 579185.3625; val_gene_expr_recon_loss: 18643238.5333; val_masked_gp_l1_reg_loss: 82177.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85233.1406; val_chrom_access_recon_loss: 4058724.1000; val_global_loss: 23501240.2667; val_optim_loss: 23501240.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9584; val_auprc_score: 0.9437; val_best_acc_score: 0.9034; val_best_f1_score: 0.9080; train_kl_reg_loss: 51976.6382; train_edge_recon_loss: 573894.6045; train_gene_expr_recon_loss: 18453218.6107; train_masked_gp_l1_reg_loss: 82342.6109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84754.7329; train_chrom_access_recon_loss: 3969399.2366; train_global_loss: 23215586.5954; train_optim_loss: 23215586.5954; val_kl_reg_loss: 52171.0333; val_edge_recon_loss: 580158.6125; val_gene_expr_recon_loss: 18606784.8000; val_masked_gp_l1_reg_loss: 82584.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85287.4219; val_chrom_access_recon_loss: 4024145.8833; val_global_loss: 23431132.0000; val_optim_loss: 23431132.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9626; val_auprc_score: 0.9492; val_best_acc_score: 0.9131; val_best_f1_score: 0.9167; train_kl_reg_loss: 52051.7147; train_edge_recon_loss: 574280.3941; train_gene_expr_recon_loss: 18404578.7176; train_masked_gp_l1_reg_loss: 82928.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85080.8965; train_chrom_access_recon_loss: 3952351.0401; train_global_loss: 23151271.6641; train_optim_loss: 23151271.6641; val_kl_reg_loss: 52728.5510; val_edge_recon_loss: 575424.0750; val_gene_expr_recon_loss: 18567423.6000; val_masked_gp_l1_reg_loss: 83145.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85347.2188; val_chrom_access_recon_loss: 4023073.7667; val_global_loss: 23387144.0000; val_optim_loss: 23387144.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9669; val_auprc_score: 0.9593; val_best_acc_score: 0.9140; val_best_f1_score: 0.9185; train_kl_reg_loss: 52561.2823; train_edge_recon_loss: 573360.5964; train_gene_expr_recon_loss: 18364507.9695; train_masked_gp_l1_reg_loss: 83466.6247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85433.6515; train_chrom_access_recon_loss: 3938336.5057; train_global_loss: 23097666.7023; train_optim_loss: 23097666.7023; val_kl_reg_loss: 52767.1831; val_edge_recon_loss: 576780.6292; val_gene_expr_recon_loss: 18525089.3333; val_masked_gp_l1_reg_loss: 83708.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85570.0312; val_chrom_access_recon_loss: 4018971.8000; val_global_loss: 23342887.0667; val_optim_loss: 23342887.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9611; val_auprc_score: 0.9507; val_best_acc_score: 0.9058; val_best_f1_score: 0.9098; train_kl_reg_loss: 52919.2607; train_edge_recon_loss: 573497.2844; train_gene_expr_recon_loss: 18316658.2595; train_masked_gp_l1_reg_loss: 84022.1347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85814.0462; train_chrom_access_recon_loss: 3914932.4179; train_global_loss: 23027843.4046; train_optim_loss: 23027843.4046; val_kl_reg_loss: 51482.2401; val_edge_recon_loss: 581077.8167; val_gene_expr_recon_loss: 18454166.0000; val_masked_gp_l1_reg_loss: 84336.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86871.1641; val_chrom_access_recon_loss: 3995951.6667; val_global_loss: 23253885.6000; val_optim_loss: 23253885.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9650; val_auprc_score: 0.9562; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 52602.0333; train_edge_recon_loss: 574433.7223; train_gene_expr_recon_loss: 18284738.7634; train_masked_gp_l1_reg_loss: 84619.2693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86519.6107; train_chrom_access_recon_loss: 3905691.3912; train_global_loss: 22988604.7481; train_optim_loss: 22988604.7481; val_kl_reg_loss: 53163.3589; val_edge_recon_loss: 575701.3375; val_gene_expr_recon_loss: 18448175.0667; val_masked_gp_l1_reg_loss: 84709.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86910.2578; val_chrom_access_recon_loss: 3995606.1333; val_global_loss: 23244266.0000; val_optim_loss: 23244266.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9606; val_auprc_score: 0.9499; val_best_acc_score: 0.9047; val_best_f1_score: 0.9099; train_kl_reg_loss: 53035.5268; train_edge_recon_loss: 576268.2505; train_gene_expr_recon_loss: 18284187.8779; train_masked_gp_l1_reg_loss: 84755.6187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86411.0193; train_chrom_access_recon_loss: 3902220.0057; train_global_loss: 22986878.3969; train_optim_loss: 22986878.3969; val_kl_reg_loss: 54370.2357; val_edge_recon_loss: 581163.2667; val_gene_expr_recon_loss: 18486142.1333; val_masked_gp_l1_reg_loss: 84645.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87730.4844; val_chrom_access_recon_loss: 4025555.6167; val_global_loss: 23319607.3333; val_optim_loss: 23319607.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9629; val_auprc_score: 0.9517; val_best_acc_score: 0.9124; val_best_f1_score: 0.9167; train_kl_reg_loss: 53821.8682; train_edge_recon_loss: 574785.2204; train_gene_expr_recon_loss: 18232367.4962; train_masked_gp_l1_reg_loss: 84915.1150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86892.7809; train_chrom_access_recon_loss: 3888473.0076; train_global_loss: 22921255.5267; train_optim_loss: 22921255.5267; val_kl_reg_loss: 53364.9695; val_edge_recon_loss: 578104.0625; val_gene_expr_recon_loss: 18376261.3333; val_masked_gp_l1_reg_loss: 84870.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87736.4531; val_chrom_access_recon_loss: 3986458.7667; val_global_loss: 23166795.0667; val_optim_loss: 23166795.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9655; val_auprc_score: 0.9539; val_best_acc_score: 0.9128; val_best_f1_score: 0.9157; train_kl_reg_loss: 54581.9574; train_edge_recon_loss: 574948.6980; train_gene_expr_recon_loss: 18197153.2595; train_masked_gp_l1_reg_loss: 84897.7672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87212.5544; train_chrom_access_recon_loss: 3873632.7481; train_global_loss: 22872427.0534; train_optim_loss: 22872427.0534; val_kl_reg_loss: 54182.5089; val_edge_recon_loss: 578634.6500; val_gene_expr_recon_loss: 18422727.6000; val_masked_gp_l1_reg_loss: 84891.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87699.3359; val_chrom_access_recon_loss: 3986830.2333; val_global_loss: 23214966.9333; val_optim_loss: 23214966.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9645; val_auprc_score: 0.9533; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 55143.8278; train_edge_recon_loss: 574310.0544; train_gene_expr_recon_loss: 18174812.9389; train_masked_gp_l1_reg_loss: 85178.8888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87631.0177; train_chrom_access_recon_loss: 3859561.9256; train_global_loss: 22836638.7023; train_optim_loss: 22836638.7023; val_kl_reg_loss: 55861.4357; val_edge_recon_loss: 577659.0125; val_gene_expr_recon_loss: 18301704.5333; val_masked_gp_l1_reg_loss: 85284.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88338.7969; val_chrom_access_recon_loss: 3955055.1667; val_global_loss: 23063902.1333; val_optim_loss: 23063902.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9614; val_auprc_score: 0.9479; val_best_acc_score: 0.9119; val_best_f1_score: 0.9165; train_kl_reg_loss: 55525.5791; train_edge_recon_loss: 574412.8569; train_gene_expr_recon_loss: 18137919.4351; train_masked_gp_l1_reg_loss: 85403.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88082.4494; train_chrom_access_recon_loss: 3852906.4885; train_global_loss: 22794250.4122; train_optim_loss: 22794250.4122; val_kl_reg_loss: 56156.5286; val_edge_recon_loss: 580752.9625; val_gene_expr_recon_loss: 18343603.7333; val_masked_gp_l1_reg_loss: 85490.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88620.4688; val_chrom_access_recon_loss: 3969555.1000; val_global_loss: 23124178.4000; val_optim_loss: 23124178.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9628; val_auprc_score: 0.9534; val_best_acc_score: 0.9095; val_best_f1_score: 0.9129; train_kl_reg_loss: 55845.4382; train_edge_recon_loss: 574640.0086; train_gene_expr_recon_loss: 18107901.9618; train_masked_gp_l1_reg_loss: 85701.3897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88407.5120; train_chrom_access_recon_loss: 3844468.5458; train_global_loss: 22756964.8244; train_optim_loss: 22756964.8244; val_kl_reg_loss: 56601.0516; val_edge_recon_loss: 579401.1167; val_gene_expr_recon_loss: 18368695.7333; val_masked_gp_l1_reg_loss: 85835.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89163.9375; val_chrom_access_recon_loss: 3976630.3500; val_global_loss: 23156328.4000; val_optim_loss: 23156328.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9651; val_auprc_score: 0.9571; val_best_acc_score: 0.9138; val_best_f1_score: 0.9182; train_kl_reg_loss: 56321.4328; train_edge_recon_loss: 576227.5406; train_gene_expr_recon_loss: 18081059.3893; train_masked_gp_l1_reg_loss: 85818.3124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88565.4945; train_chrom_access_recon_loss: 3832314.6508; train_global_loss: 22720306.7786; train_optim_loss: 22720306.7786; val_kl_reg_loss: 55999.5128; val_edge_recon_loss: 578372.8875; val_gene_expr_recon_loss: 18298637.3333; val_masked_gp_l1_reg_loss: 85960.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90161.1016; val_chrom_access_recon_loss: 3973039.4667; val_global_loss: 23082171.2000; val_optim_loss: 23082171.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9631; val_auprc_score: 0.9484; val_best_acc_score: 0.9119; val_best_f1_score: 0.9151; train_kl_reg_loss: 56388.9553; train_edge_recon_loss: 575529.5592; train_gene_expr_recon_loss: 18040815.8168; train_masked_gp_l1_reg_loss: 86012.0578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89425.4937; train_chrom_access_recon_loss: 3819927.6718; train_global_loss: 22668099.6336; train_optim_loss: 22668099.6336; val_kl_reg_loss: 58054.0823; val_edge_recon_loss: 579872.7458; val_gene_expr_recon_loss: 18308885.0667; val_masked_gp_l1_reg_loss: 86107.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89823.4844; val_chrom_access_recon_loss: 3975079.4500; val_global_loss: 23097823.8667; val_optim_loss: 23097823.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9608; val_auprc_score: 0.9472; val_best_acc_score: 0.9089; val_best_f1_score: 0.9135; train_kl_reg_loss: 57331.1807; train_edge_recon_loss: 574303.3049; train_gene_expr_recon_loss: 17990556.9313; train_masked_gp_l1_reg_loss: 85083.8680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64220.2286; train_chrom_access_recon_loss: 3793902.1317; train_global_loss: 22565397.6489; train_optim_loss: 22565397.6489; val_kl_reg_loss: 56953.8461; val_edge_recon_loss: 578483.3583; val_gene_expr_recon_loss: 18196177.3333; val_masked_gp_l1_reg_loss: 84680.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59364.1758; val_chrom_access_recon_loss: 3926143.4667; val_global_loss: 22901801.8667; val_optim_loss: 22901801.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9664; val_auprc_score: 0.9569; val_best_acc_score: 0.9130; val_best_f1_score: 0.9152; train_kl_reg_loss: 57044.5821; train_edge_recon_loss: 573259.6966; train_gene_expr_recon_loss: 17991262.8931; train_masked_gp_l1_reg_loss: 84621.2758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58578.7320; train_chrom_access_recon_loss: 3791837.9256; train_global_loss: 22556604.9618; train_optim_loss: 22556604.9618; val_kl_reg_loss: 57281.0911; val_edge_recon_loss: 578074.7125; val_gene_expr_recon_loss: 18286894.8000; val_masked_gp_l1_reg_loss: 84604.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58096.6250; val_chrom_access_recon_loss: 3945070.6167; val_global_loss: 23010021.4667; val_optim_loss: 23010021.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9630; val_auprc_score: 0.9529; val_best_acc_score: 0.9101; val_best_f1_score: 0.9147; train_kl_reg_loss: 57187.7022; train_edge_recon_loss: 572548.9299; train_gene_expr_recon_loss: 17978675.9771; train_masked_gp_l1_reg_loss: 84616.5238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57697.4849; train_chrom_access_recon_loss: 3788233.8931; train_global_loss: 22538960.3817; train_optim_loss: 22538960.3817; val_kl_reg_loss: 57393.8510; val_edge_recon_loss: 580164.2375; val_gene_expr_recon_loss: 18282315.2000; val_masked_gp_l1_reg_loss: 84621.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57342.9023; val_chrom_access_recon_loss: 3941034.7000; val_global_loss: 23002872.1333; val_optim_loss: 23002872.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9625; val_auprc_score: 0.9512; val_best_acc_score: 0.9085; val_best_f1_score: 0.9123; train_kl_reg_loss: 57126.4974; train_edge_recon_loss: 573157.9990; train_gene_expr_recon_loss: 17975278.4504; train_masked_gp_l1_reg_loss: 84634.1755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57035.7459; train_chrom_access_recon_loss: 3786871.8798; train_global_loss: 22534104.8397; train_optim_loss: 22534104.8397; val_kl_reg_loss: 57252.1060; val_edge_recon_loss: 579212.7083; val_gene_expr_recon_loss: 18270594.2667; val_masked_gp_l1_reg_loss: 84644.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56801.5625; val_chrom_access_recon_loss: 3935418.4333; val_global_loss: 22983923.4667; val_optim_loss: 22983923.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9651; val_auprc_score: 0.9560; val_best_acc_score: 0.9123; val_best_f1_score: 0.9155; train_kl_reg_loss: 57040.3400; train_edge_recon_loss: 573847.9819; train_gene_expr_recon_loss: 17967773.7099; train_masked_gp_l1_reg_loss: 84675.2513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56561.5178; train_chrom_access_recon_loss: 3786107.3187; train_global_loss: 22526006.3053; train_optim_loss: 22526006.3053; val_kl_reg_loss: 56918.5690; val_edge_recon_loss: 578223.0833; val_gene_expr_recon_loss: 18216591.7333; val_masked_gp_l1_reg_loss: 84698.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56366.7031; val_chrom_access_recon_loss: 3933228.0167; val_global_loss: 22926025.3333; val_optim_loss: 22926025.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9630; val_auprc_score: 0.9533; val_best_acc_score: 0.9049; val_best_f1_score: 0.9085; train_kl_reg_loss: 57032.1775; train_edge_recon_loss: 573084.7920; train_gene_expr_recon_loss: 17966810.1832; train_masked_gp_l1_reg_loss: 84591.9581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53836.4383; train_chrom_access_recon_loss: 3784461.3302; train_global_loss: 22519816.9008; train_optim_loss: 22519816.9008; val_kl_reg_loss: 57301.1969; val_edge_recon_loss: 579596.1708; val_gene_expr_recon_loss: 18228647.6000; val_masked_gp_l1_reg_loss: 84536.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53381.5391; val_chrom_access_recon_loss: 3937805.6333; val_global_loss: 22941268.5333; val_optim_loss: 22941268.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9652; val_auprc_score: 0.9555; val_best_acc_score: 0.9122; val_best_f1_score: 0.9155; train_kl_reg_loss: 57053.1753; train_edge_recon_loss: 573161.4160; train_gene_expr_recon_loss: 17970193.4198; train_masked_gp_l1_reg_loss: 84524.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53289.8379; train_chrom_access_recon_loss: 3786872.4828; train_global_loss: 22525095.1298; train_optim_loss: 22525095.1298; val_kl_reg_loss: 57055.9359; val_edge_recon_loss: 577346.5000; val_gene_expr_recon_loss: 18111201.4000; val_masked_gp_l1_reg_loss: 84514.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53220.0000; val_chrom_access_recon_loss: 3918280.6333; val_global_loss: 22801618.2667; val_optim_loss: 22801618.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9596; val_auprc_score: 0.9490; val_best_acc_score: 0.9056; val_best_f1_score: 0.9092; train_kl_reg_loss: 57096.9888; train_edge_recon_loss: 572993.6026; train_gene_expr_recon_loss: 17960390.9695; train_masked_gp_l1_reg_loss: 84513.1312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53157.2851; train_chrom_access_recon_loss: 3780037.9408; train_global_loss: 22508189.5420; train_optim_loss: 22508189.5420; val_kl_reg_loss: 57108.5370; val_edge_recon_loss: 580348.8125; val_gene_expr_recon_loss: 18249596.4000; val_masked_gp_l1_reg_loss: 84512.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53111.0586; val_chrom_access_recon_loss: 3933126.6333; val_global_loss: 22957804.5333; val_optim_loss: 22957804.5333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9612; val_auprc_score: 0.9508; val_best_acc_score: 0.9084; val_best_f1_score: 0.9120; train_kl_reg_loss: 57135.0566; train_edge_recon_loss: 574519.7405; train_gene_expr_recon_loss: 17949403.8702; train_masked_gp_l1_reg_loss: 84512.0575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53064.9945; train_chrom_access_recon_loss: 3782266.9981; train_global_loss: 22500902.5954; train_optim_loss: 22500902.5954; val_kl_reg_loss: 57491.6641; val_edge_recon_loss: 581392.7042; val_gene_expr_recon_loss: 18236275.6000; val_masked_gp_l1_reg_loss: 84510.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53021.0078; val_chrom_access_recon_loss: 3928967.8333; val_global_loss: 22941659.8667; val_optim_loss: 22941659.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9644; val_auprc_score: 0.9531; val_best_acc_score: 0.9111; val_best_f1_score: 0.9149; train_kl_reg_loss: 57024.4501; train_edge_recon_loss: 573412.3473; train_gene_expr_recon_loss: 17956992.0382; train_masked_gp_l1_reg_loss: 84511.8514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52975.2781; train_chrom_access_recon_loss: 3782821.4981; train_global_loss: 22507737.4962; train_optim_loss: 22507737.4962; val_kl_reg_loss: 57084.4844; val_edge_recon_loss: 579793.1375; val_gene_expr_recon_loss: 18231944.5333; val_masked_gp_l1_reg_loss: 84515.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52946.3281; val_chrom_access_recon_loss: 3935000.6833; val_global_loss: 22941284.9333; val_optim_loss: 22941284.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9669; val_auprc_score: 0.9570; val_best_acc_score: 0.9142; val_best_f1_score: 0.9164; train_kl_reg_loss: 57135.4973; train_edge_recon_loss: 573075.3273; train_gene_expr_recon_loss: 17940506.4885; train_masked_gp_l1_reg_loss: 84515.3924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52902.0083; train_chrom_access_recon_loss: 3777065.4256; train_global_loss: 22485200.2748; train_optim_loss: 22485200.2748; val_kl_reg_loss: 57304.2823; val_edge_recon_loss: 576786.6375; val_gene_expr_recon_loss: 18186765.8667; val_masked_gp_l1_reg_loss: 84518.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52876.6953; val_chrom_access_recon_loss: 3928757.8667; val_global_loss: 22887008.4000; val_optim_loss: 22887008.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9626; val_auprc_score: 0.9515; val_best_acc_score: 0.9096; val_best_f1_score: 0.9133; train_kl_reg_loss: 57140.0240; train_edge_recon_loss: 574043.8268; train_gene_expr_recon_loss: 17959554.0458; train_masked_gp_l1_reg_loss: 84506.6214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52625.5525; train_chrom_access_recon_loss: 3783417.0573; train_global_loss: 22511287.1756; train_optim_loss: 22511287.1756; val_kl_reg_loss: 57137.7786; val_edge_recon_loss: 580218.9542; val_gene_expr_recon_loss: 18185539.0667; val_masked_gp_l1_reg_loss: 84500.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52580.5977; val_chrom_access_recon_loss: 3929642.8500; val_global_loss: 22889618.5333; val_optim_loss: 22889618.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9638; val_auprc_score: 0.9562; val_best_acc_score: 0.9082; val_best_f1_score: 0.9116; train_kl_reg_loss: 57066.7683; train_edge_recon_loss: 572407.5081; train_gene_expr_recon_loss: 17948266.6183; train_masked_gp_l1_reg_loss: 84498.1379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52571.3022; train_chrom_access_recon_loss: 3776556.4905; train_global_loss: 22491366.9160; train_optim_loss: 22491366.9160; val_kl_reg_loss: 57187.7070; val_edge_recon_loss: 580738.5542; val_gene_expr_recon_loss: 18232335.2000; val_masked_gp_l1_reg_loss: 84496.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52563.5273; val_chrom_access_recon_loss: 3927167.2500; val_global_loss: 22934488.5333; val_optim_loss: 22934488.5333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9649; val_auprc_score: 0.9548; val_best_acc_score: 0.9105; val_best_f1_score: 0.9139; train_kl_reg_loss: 57152.3108; train_edge_recon_loss: 573601.8297; train_gene_expr_recon_loss: 17972939.5191; train_masked_gp_l1_reg_loss: 84495.9627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52556.9154; train_chrom_access_recon_loss: 3787218.7996; train_global_loss: 22527965.3435; train_optim_loss: 22527965.3435; val_kl_reg_loss: 57168.1357; val_edge_recon_loss: 578463.4167; val_gene_expr_recon_loss: 18292977.2000; val_masked_gp_l1_reg_loss: 84495.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52552.3711; val_chrom_access_recon_loss: 3961182.5667; val_global_loss: 23026839.2000; val_optim_loss: 23026839.2000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9648; val_auprc_score: 0.9551; val_best_acc_score: 0.9096; val_best_f1_score: 0.9133; train_kl_reg_loss: 57087.9057; train_edge_recon_loss: 572819.9833; train_gene_expr_recon_loss: 17952031.1679; train_masked_gp_l1_reg_loss: 84495.3566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52545.9585; train_chrom_access_recon_loss: 3781007.6622; train_global_loss: 22499988.7481; train_optim_loss: 22499988.7481; val_kl_reg_loss: 56982.1346; val_edge_recon_loss: 580027.4708; val_gene_expr_recon_loss: 18224171.8667; val_masked_gp_l1_reg_loss: 84495.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52542.0820; val_chrom_access_recon_loss: 3935154.1333; val_global_loss: 22933373.6000; val_optim_loss: 22933373.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 46 min 54 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9691
val AUPRC score: 0.9625
val best accuracy score: 0.9158
val best F1 score: 0.9199
val target rna MSE score: 1.1836
val source rna MSE score: 0.4104
val target atac MSE score: 0.7720
val source atac MSE score: 0.1255
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
