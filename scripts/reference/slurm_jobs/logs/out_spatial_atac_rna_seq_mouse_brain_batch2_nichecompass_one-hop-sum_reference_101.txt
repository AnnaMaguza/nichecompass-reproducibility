[True]
Run timestamp: 10082023_233849_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6774; val_auprc_score: 0.7261; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 168869.1809; train_edge_recon_loss: 3837234.3263; train_gene_expr_recon_loss: 44400820.2748; train_masked_gp_l1_reg_loss: 80351.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243712.0862; train_chrom_access_recon_loss: 6790432.7099; train_global_loss: 55521420.0000; train_optim_loss: 55521420.0000; val_kl_reg_loss: 124112.6818; val_edge_recon_loss: 4065961.4000; val_gene_expr_recon_loss: 39245216.5333; val_masked_gp_l1_reg_loss: 81272.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238797.0625; val_chrom_access_recon_loss: 6510396.5000; val_global_loss: 50265754.9333; val_optim_loss: 50265754.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7466; val_auprc_score: 0.7718; val_best_acc_score: 0.5299; val_best_f1_score: 0.6781; train_kl_reg_loss: 175553.1913; train_edge_recon_loss: 3700451.0420; train_gene_expr_recon_loss: 38203504.9771; train_masked_gp_l1_reg_loss: 79634.0543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233029.9060; train_chrom_access_recon_loss: 6408660.6527; train_global_loss: 48800833.8015; train_optim_loss: 48800833.8015; val_kl_reg_loss: 177489.5115; val_edge_recon_loss: 4063316.3667; val_gene_expr_recon_loss: 37617532.0000; val_masked_gp_l1_reg_loss: 78267.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226679.2656; val_chrom_access_recon_loss: 6368758.1333; val_global_loss: 48532044.5333; val_optim_loss: 48532044.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8054; val_auprc_score: 0.8218; val_best_acc_score: 0.6956; val_best_f1_score: 0.7334; train_kl_reg_loss: 190093.3073; train_edge_recon_loss: 3582690.9809; train_gene_expr_recon_loss: 37102140.2137; train_masked_gp_l1_reg_loss: 76455.3389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219947.9047; train_chrom_access_recon_loss: 6327050.3168; train_global_loss: 47498378.2290; train_optim_loss: 47498378.2290; val_kl_reg_loss: 166006.3073; val_edge_recon_loss: 4039907.3833; val_gene_expr_recon_loss: 37016937.0667; val_masked_gp_l1_reg_loss: 75741.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213175.8281; val_chrom_access_recon_loss: 6324275.9333; val_global_loss: 47836043.2000; val_optim_loss: 47836043.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8953; val_auprc_score: 0.8854; val_best_acc_score: 0.8011; val_best_f1_score: 0.8206; train_kl_reg_loss: 169765.2186; train_edge_recon_loss: 3547225.2443; train_gene_expr_recon_loss: 36679555.6031; train_masked_gp_l1_reg_loss: 76730.4898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206777.2666; train_chrom_access_recon_loss: 6292684.8664; train_global_loss: 46972738.6565; train_optim_loss: 46972738.6565; val_kl_reg_loss: 171281.0865; val_edge_recon_loss: 3885078.2333; val_gene_expr_recon_loss: 36704158.1333; val_masked_gp_l1_reg_loss: 78044.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200411.9375; val_chrom_access_recon_loss: 6279786.5333; val_global_loss: 47318760.2667; val_optim_loss: 47318760.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8893; val_auprc_score: 0.8820; val_best_acc_score: 0.8037; val_best_f1_score: 0.8130; train_kl_reg_loss: 155378.6234; train_edge_recon_loss: 3321604.8416; train_gene_expr_recon_loss: 36411062.5954; train_masked_gp_l1_reg_loss: 79562.9651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194408.1837; train_chrom_access_recon_loss: 6259179.0878; train_global_loss: 46421196.2748; train_optim_loss: 46421196.2748; val_kl_reg_loss: 189571.5448; val_edge_recon_loss: 3092815.4333; val_gene_expr_recon_loss: 36376332.2667; val_masked_gp_l1_reg_loss: 81071.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188465.3281; val_chrom_access_recon_loss: 6247970.2667; val_global_loss: 46176225.6000; val_optim_loss: 46176225.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9000; val_auprc_score: 0.8923; val_best_acc_score: 0.8147; val_best_f1_score: 0.8213; train_kl_reg_loss: 194145.9986; train_edge_recon_loss: 3026485.0954; train_gene_expr_recon_loss: 36110453.9542; train_masked_gp_l1_reg_loss: 82033.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182987.5619; train_chrom_access_recon_loss: 6225576.1183; train_global_loss: 45821682.4733; train_optim_loss: 45821682.4733; val_kl_reg_loss: 191711.0740; val_edge_recon_loss: 2981640.7833; val_gene_expr_recon_loss: 36183630.9333; val_masked_gp_l1_reg_loss: 83299.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177706.0000; val_chrom_access_recon_loss: 6227059.9000; val_global_loss: 45845049.0667; val_optim_loss: 45845049.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9073; val_auprc_score: 0.8941; val_best_acc_score: 0.8298; val_best_f1_score: 0.8397; train_kl_reg_loss: 185762.9746; train_edge_recon_loss: 2994032.3950; train_gene_expr_recon_loss: 35910850.3817; train_masked_gp_l1_reg_loss: 84458.8115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172853.0911; train_chrom_access_recon_loss: 6202718.9008; train_global_loss: 45550676.6107; train_optim_loss: 45550676.6107; val_kl_reg_loss: 183964.2198; val_edge_recon_loss: 2963822.8833; val_gene_expr_recon_loss: 36055022.6667; val_masked_gp_l1_reg_loss: 85790.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168133.7812; val_chrom_access_recon_loss: 6223314.1000; val_global_loss: 45680048.0000; val_optim_loss: 45680048.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9143; val_auprc_score: 0.9023; val_best_acc_score: 0.8395; val_best_f1_score: 0.8514; train_kl_reg_loss: 178847.4401; train_edge_recon_loss: 2945185.7519; train_gene_expr_recon_loss: 35706064.6565; train_masked_gp_l1_reg_loss: 87011.9232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163787.5897; train_chrom_access_recon_loss: 6180083.6489; train_global_loss: 45260981.0687; train_optim_loss: 45260981.0687; val_kl_reg_loss: 172982.1958; val_edge_recon_loss: 2933186.7500; val_gene_expr_recon_loss: 35843154.1333; val_masked_gp_l1_reg_loss: 88224.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159476.5000; val_chrom_access_recon_loss: 6187023.8667; val_global_loss: 45384046.9333; val_optim_loss: 45384046.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9183; val_auprc_score: 0.9068; val_best_acc_score: 0.8414; val_best_f1_score: 0.8514; train_kl_reg_loss: 173158.9888; train_edge_recon_loss: 2918702.0115; train_gene_expr_recon_loss: 35534833.4962; train_masked_gp_l1_reg_loss: 89483.4238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155469.0336; train_chrom_access_recon_loss: 6160193.7977; train_global_loss: 45031841.1603; train_optim_loss: 45031841.1603; val_kl_reg_loss: 169520.8708; val_edge_recon_loss: 2933550.2667; val_gene_expr_recon_loss: 35455144.0000; val_masked_gp_l1_reg_loss: 90589.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151503.2031; val_chrom_access_recon_loss: 6146688.8333; val_global_loss: 44946995.7333; val_optim_loss: 44946995.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9275; val_auprc_score: 0.9179; val_best_acc_score: 0.8541; val_best_f1_score: 0.8616; train_kl_reg_loss: 168734.6443; train_edge_recon_loss: 2894451.4485; train_gene_expr_recon_loss: 35367245.0076; train_masked_gp_l1_reg_loss: 91847.0806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147797.1858; train_chrom_access_recon_loss: 6132839.7176; train_global_loss: 44802914.8397; train_optim_loss: 44802914.8397; val_kl_reg_loss: 165420.4719; val_edge_recon_loss: 2906664.8833; val_gene_expr_recon_loss: 35507360.0000; val_masked_gp_l1_reg_loss: 93425.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144076.0312; val_chrom_access_recon_loss: 6153487.5667; val_global_loss: 44970433.0667; val_optim_loss: 44970433.0667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9350; val_auprc_score: 0.9242; val_best_acc_score: 0.8626; val_best_f1_score: 0.8703; train_kl_reg_loss: 166039.3470; train_edge_recon_loss: 2863415.1336; train_gene_expr_recon_loss: 35265922.6718; train_masked_gp_l1_reg_loss: 94217.2100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140552.0042; train_chrom_access_recon_loss: 6124510.4351; train_global_loss: 44654657.0382; train_optim_loss: 44654657.0382; val_kl_reg_loss: 162673.9635; val_edge_recon_loss: 2868846.5500; val_gene_expr_recon_loss: 35312620.8000; val_masked_gp_l1_reg_loss: 95073.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137060.9062; val_chrom_access_recon_loss: 6129420.2333; val_global_loss: 44705692.8000; val_optim_loss: 44705692.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9416; val_auprc_score: 0.9322; val_best_acc_score: 0.8719; val_best_f1_score: 0.8766; train_kl_reg_loss: 160619.3791; train_edge_recon_loss: 2849935.6431; train_gene_expr_recon_loss: 35149001.2214; train_masked_gp_l1_reg_loss: 96360.6353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133935.5605; train_chrom_access_recon_loss: 6110547.7710; train_global_loss: 44500400.0611; train_optim_loss: 44500400.0611; val_kl_reg_loss: 161243.1917; val_edge_recon_loss: 2852774.4167; val_gene_expr_recon_loss: 35329661.0667; val_masked_gp_l1_reg_loss: 97319.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130852.3828; val_chrom_access_recon_loss: 6129023.5333; val_global_loss: 44700874.4000; val_optim_loss: 44700874.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9403; val_auprc_score: 0.9281; val_best_acc_score: 0.8755; val_best_f1_score: 0.8826; train_kl_reg_loss: 156131.0101; train_edge_recon_loss: 2841346.3263; train_gene_expr_recon_loss: 35047183.8168; train_masked_gp_l1_reg_loss: 98564.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127913.3826; train_chrom_access_recon_loss: 6095224.2595; train_global_loss: 44366363.5115; train_optim_loss: 44366363.5115; val_kl_reg_loss: 154115.9344; val_edge_recon_loss: 2852001.7000; val_gene_expr_recon_loss: 35231525.4667; val_masked_gp_l1_reg_loss: 99963.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125055.5625; val_chrom_access_recon_loss: 6117793.0000; val_global_loss: 44580456.2667; val_optim_loss: 44580456.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9464; val_auprc_score: 0.9362; val_best_acc_score: 0.8785; val_best_f1_score: 0.8837; train_kl_reg_loss: 153678.7290; train_edge_recon_loss: 2819808.5821; train_gene_expr_recon_loss: 34942455.1450; train_masked_gp_l1_reg_loss: 100863.3751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122325.4130; train_chrom_access_recon_loss: 6086451.6565; train_global_loss: 44225582.9008; train_optim_loss: 44225582.9008; val_kl_reg_loss: 149501.6552; val_edge_recon_loss: 2848763.0667; val_gene_expr_recon_loss: 35131810.9333; val_masked_gp_l1_reg_loss: 102073.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119651.9688; val_chrom_access_recon_loss: 6107251.0000; val_global_loss: 44459050.4000; val_optim_loss: 44459050.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9512; val_auprc_score: 0.9422; val_best_acc_score: 0.8866; val_best_f1_score: 0.8925; train_kl_reg_loss: 149138.3411; train_edge_recon_loss: 2808575.0305; train_gene_expr_recon_loss: 34824858.1374; train_masked_gp_l1_reg_loss: 103009.7942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117106.5190; train_chrom_access_recon_loss: 6072994.7290; train_global_loss: 44075682.5954; train_optim_loss: 44075682.5954; val_kl_reg_loss: 146978.3646; val_edge_recon_loss: 2808198.1333; val_gene_expr_recon_loss: 34911651.4667; val_masked_gp_l1_reg_loss: 104003.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114594.4375; val_chrom_access_recon_loss: 6063231.5667; val_global_loss: 44148660.5333; val_optim_loss: 44148660.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9581; val_auprc_score: 0.9501; val_best_acc_score: 0.8945; val_best_f1_score: 0.8979; train_kl_reg_loss: 146120.6936; train_edge_recon_loss: 2815626.2023; train_gene_expr_recon_loss: 34741670.2748; train_masked_gp_l1_reg_loss: 105001.8879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112198.7170; train_chrom_access_recon_loss: 6062825.1031; train_global_loss: 43983443.0229; train_optim_loss: 43983443.0229; val_kl_reg_loss: 148990.4062; val_edge_recon_loss: 2810388.1000; val_gene_expr_recon_loss: 34908440.8000; val_masked_gp_l1_reg_loss: 106079.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109879.3906; val_chrom_access_recon_loss: 6086519.3667; val_global_loss: 44170298.9333; val_optim_loss: 44170298.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9569; val_auprc_score: 0.9469; val_best_acc_score: 0.8977; val_best_f1_score: 0.9009; train_kl_reg_loss: 143943.8548; train_edge_recon_loss: 2793767.9809; train_gene_expr_recon_loss: 34706174.6565; train_masked_gp_l1_reg_loss: 106982.9641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107670.4179; train_chrom_access_recon_loss: 6061352.5573; train_global_loss: 43919892.5191; train_optim_loss: 43919892.5191; val_kl_reg_loss: 140149.0083; val_edge_recon_loss: 2808224.6333; val_gene_expr_recon_loss: 35000808.9333; val_masked_gp_l1_reg_loss: 107973.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105495.5078; val_chrom_access_recon_loss: 6081720.7667; val_global_loss: 44244371.4667; val_optim_loss: 44244371.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9599; val_auprc_score: 0.9503; val_best_acc_score: 0.9025; val_best_f1_score: 0.9048; train_kl_reg_loss: 141932.2368; train_edge_recon_loss: 2784764.0344; train_gene_expr_recon_loss: 34644077.9542; train_masked_gp_l1_reg_loss: 109008.0403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103468.9627; train_chrom_access_recon_loss: 6055066.8206; train_global_loss: 43838318.1374; train_optim_loss: 43838318.1374; val_kl_reg_loss: 139975.4302; val_edge_recon_loss: 2792431.0167; val_gene_expr_recon_loss: 34815643.8667; val_masked_gp_l1_reg_loss: 109971.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101486.2031; val_chrom_access_recon_loss: 6064254.1000; val_global_loss: 44023765.0667; val_optim_loss: 44023765.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9615; val_auprc_score: 0.9551; val_best_acc_score: 0.9012; val_best_f1_score: 0.9050; train_kl_reg_loss: 138905.6292; train_edge_recon_loss: 2778577.3034; train_gene_expr_recon_loss: 34589739.0382; train_masked_gp_l1_reg_loss: 110946.7841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99592.6493; train_chrom_access_recon_loss: 6046216.4504; train_global_loss: 43763977.8931; train_optim_loss: 43763977.8931; val_kl_reg_loss: 141670.1854; val_edge_recon_loss: 2788761.6667; val_gene_expr_recon_loss: 34844345.6000; val_masked_gp_l1_reg_loss: 111940.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97752.4219; val_chrom_access_recon_loss: 6072126.0000; val_global_loss: 44056595.7333; val_optim_loss: 44056595.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9625; val_auprc_score: 0.9532; val_best_acc_score: 0.9049; val_best_f1_score: 0.9086; train_kl_reg_loss: 136953.0388; train_edge_recon_loss: 2775757.1565; train_gene_expr_recon_loss: 34503470.0611; train_masked_gp_l1_reg_loss: 112950.4438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95987.7064; train_chrom_access_recon_loss: 6034285.1756; train_global_loss: 43659403.5725; train_optim_loss: 43659403.5725; val_kl_reg_loss: 136107.7339; val_edge_recon_loss: 2791462.3833; val_gene_expr_recon_loss: 34760110.1333; val_masked_gp_l1_reg_loss: 113944.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94247.6016; val_chrom_access_recon_loss: 6055274.7667; val_global_loss: 43951146.9333; val_optim_loss: 43951146.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9649; val_auprc_score: 0.9581; val_best_acc_score: 0.9034; val_best_f1_score: 0.9066; train_kl_reg_loss: 135601.0636; train_edge_recon_loss: 2761899.7958; train_gene_expr_recon_loss: 34465661.4046; train_masked_gp_l1_reg_loss: 114906.4292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92599.2634; train_chrom_access_recon_loss: 6034165.0305; train_global_loss: 43604832.9771; train_optim_loss: 43604832.9771; val_kl_reg_loss: 134769.1198; val_edge_recon_loss: 2798184.8833; val_gene_expr_recon_loss: 34646208.5333; val_masked_gp_l1_reg_loss: 116121.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91032.2344; val_chrom_access_recon_loss: 6041213.1333; val_global_loss: 43827527.2000; val_optim_loss: 43827527.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9652; val_auprc_score: 0.9567; val_best_acc_score: 0.9072; val_best_f1_score: 0.9097; train_kl_reg_loss: 132843.8558; train_edge_recon_loss: 2776125.0840; train_gene_expr_recon_loss: 34400256.1679; train_masked_gp_l1_reg_loss: 116995.4371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89528.5317; train_chrom_access_recon_loss: 6024396.9046; train_global_loss: 43540145.3740; train_optim_loss: 43540145.3740; val_kl_reg_loss: 132778.5693; val_edge_recon_loss: 2791367.4500; val_gene_expr_recon_loss: 34503919.6000; val_masked_gp_l1_reg_loss: 117953.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87966.7578; val_chrom_access_recon_loss: 6002883.6000; val_global_loss: 43636869.0667; val_optim_loss: 43636869.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9678; val_auprc_score: 0.9605; val_best_acc_score: 0.9124; val_best_f1_score: 0.9154; train_kl_reg_loss: 129834.8336; train_edge_recon_loss: 2761450.5649; train_gene_expr_recon_loss: 34301688.3206; train_masked_gp_l1_reg_loss: 119000.8221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86615.3099; train_chrom_access_recon_loss: 6015409.2595; train_global_loss: 43413998.9924; train_optim_loss: 43413998.9924; val_kl_reg_loss: 131068.7281; val_edge_recon_loss: 2767892.1000; val_gene_expr_recon_loss: 34546655.7333; val_masked_gp_l1_reg_loss: 120017.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85266.7578; val_chrom_access_recon_loss: 6033472.6333; val_global_loss: 43684372.8000; val_optim_loss: 43684372.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9688; val_auprc_score: 0.9621; val_best_acc_score: 0.9130; val_best_f1_score: 0.9154; train_kl_reg_loss: 128995.3302; train_edge_recon_loss: 2759117.1317; train_gene_expr_recon_loss: 34294833.1908; train_masked_gp_l1_reg_loss: 121162.6854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83993.3625; train_chrom_access_recon_loss: 6016031.4008; train_global_loss: 43404133.2214; train_optim_loss: 43404133.2214; val_kl_reg_loss: 129641.8750; val_edge_recon_loss: 2772595.0333; val_gene_expr_recon_loss: 34555584.8000; val_masked_gp_l1_reg_loss: 122067.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82698.0391; val_chrom_access_recon_loss: 6033398.4000; val_global_loss: 43695988.0000; val_optim_loss: 43695988.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9698; val_auprc_score: 0.9643; val_best_acc_score: 0.9148; val_best_f1_score: 0.9167; train_kl_reg_loss: 128903.0470; train_edge_recon_loss: 2748551.8130; train_gene_expr_recon_loss: 34191014.4275; train_masked_gp_l1_reg_loss: 123116.0002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81567.7953; train_chrom_access_recon_loss: 6002599.5802; train_global_loss: 43275752.7634; train_optim_loss: 43275752.7634; val_kl_reg_loss: 127607.6677; val_edge_recon_loss: 2771189.8167; val_gene_expr_recon_loss: 34482308.6667; val_masked_gp_l1_reg_loss: 124172.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80412.5859; val_chrom_access_recon_loss: 6014354.6333; val_global_loss: 43600045.3333; val_optim_loss: 43600045.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9646; val_auprc_score: 0.9595; val_best_acc_score: 0.9070; val_best_f1_score: 0.9088; train_kl_reg_loss: 142259.3127; train_edge_recon_loss: 2839224.7366; train_gene_expr_recon_loss: 36281838.2290; train_masked_gp_l1_reg_loss: 124961.7720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83832.7069; train_chrom_access_recon_loss: 6233968.6069; train_global_loss: 45706085.2824; train_optim_loss: 45706085.2824; val_kl_reg_loss: 57326.0109; val_edge_recon_loss: 2838414.7167; val_gene_expr_recon_loss: 36161652.5333; val_masked_gp_l1_reg_loss: 125556.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84523.3906; val_chrom_access_recon_loss: 6173612.7000; val_global_loss: 45441085.3333; val_optim_loss: 45441085.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9695; val_auprc_score: 0.9616; val_best_acc_score: 0.9120; val_best_f1_score: 0.9146; train_kl_reg_loss: 133866.3612; train_edge_recon_loss: 2797792.9599; train_gene_expr_recon_loss: 35988895.1756; train_masked_gp_l1_reg_loss: 125583.9244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83706.8326; train_chrom_access_recon_loss: 6170745.2519; train_global_loss: 45300590.4427; train_optim_loss: 45300590.4427; val_kl_reg_loss: 62494.1096; val_edge_recon_loss: 2785589.8167; val_gene_expr_recon_loss: 36215708.0000; val_masked_gp_l1_reg_loss: 125515.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82874.5234; val_chrom_access_recon_loss: 6174035.5000; val_global_loss: 45446219.4667; val_optim_loss: 45446219.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9678; val_auprc_score: 0.9625; val_best_acc_score: 0.9134; val_best_f1_score: 0.9167; train_kl_reg_loss: 122557.7879; train_edge_recon_loss: 2773299.8931; train_gene_expr_recon_loss: 35858052.7328; train_masked_gp_l1_reg_loss: 125101.4384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81644.3307; train_chrom_access_recon_loss: 6152859.7519; train_global_loss: 45113515.7863; train_optim_loss: 45113515.7863; val_kl_reg_loss: 69168.8901; val_edge_recon_loss: 2762687.2000; val_gene_expr_recon_loss: 36101072.8000; val_masked_gp_l1_reg_loss: 124669.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80190.1250; val_chrom_access_recon_loss: 6172848.6000; val_global_loss: 45310637.6000; val_optim_loss: 45310637.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9678; val_auprc_score: 0.9601; val_best_acc_score: 0.9126; val_best_f1_score: 0.9157; train_kl_reg_loss: 114279.4952; train_edge_recon_loss: 2753653.6565; train_gene_expr_recon_loss: 35633185.2366; train_masked_gp_l1_reg_loss: 124129.8390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78510.3466; train_chrom_access_recon_loss: 6130928.7595; train_global_loss: 44834687.2672; train_optim_loss: 44834687.2672; val_kl_reg_loss: 76562.2854; val_edge_recon_loss: 2754389.1667; val_gene_expr_recon_loss: 35780001.3333; val_masked_gp_l1_reg_loss: 123570.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76644.0781; val_chrom_access_recon_loss: 6135633.8667; val_global_loss: 44946802.9333; val_optim_loss: 44946802.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9668; val_auprc_score: 0.9609; val_best_acc_score: 0.9076; val_best_f1_score: 0.9104; train_kl_reg_loss: 113324.5858; train_edge_recon_loss: 2740836.1050; train_gene_expr_recon_loss: 35579570.2595; train_masked_gp_l1_reg_loss: 123173.1307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76315.3005; train_chrom_access_recon_loss: 6131083.4885; train_global_loss: 44764303.2061; train_optim_loss: 44764303.2061; val_kl_reg_loss: 78228.9604; val_edge_recon_loss: 2767668.7333; val_gene_expr_recon_loss: 35743172.8000; val_masked_gp_l1_reg_loss: 123017.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76021.1094; val_chrom_access_recon_loss: 6144007.7333; val_global_loss: 44932113.8667; val_optim_loss: 44932113.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9667; val_auprc_score: 0.9593; val_best_acc_score: 0.9077; val_best_f1_score: 0.9115; train_kl_reg_loss: 112878.4314; train_edge_recon_loss: 2751647.2576; train_gene_expr_recon_loss: 35576767.9847; train_masked_gp_l1_reg_loss: 122910.0905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75756.4689; train_chrom_access_recon_loss: 6135132.4389; train_global_loss: 44775092.4275; train_optim_loss: 44775092.4275; val_kl_reg_loss: 76880.8974; val_edge_recon_loss: 2755897.5500; val_gene_expr_recon_loss: 35932580.8000; val_masked_gp_l1_reg_loss: 122808.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75485.7578; val_chrom_access_recon_loss: 6174058.2000; val_global_loss: 45137709.3333; val_optim_loss: 45137709.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9649; val_auprc_score: 0.9577; val_best_acc_score: 0.9092; val_best_f1_score: 0.9124; train_kl_reg_loss: 111848.0946; train_edge_recon_loss: 2748190.1584; train_gene_expr_recon_loss: 35539890.3817; train_masked_gp_l1_reg_loss: 122713.6471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75232.6221; train_chrom_access_recon_loss: 6128711.4733; train_global_loss: 44726585.7710; train_optim_loss: 44726585.7710; val_kl_reg_loss: 77843.0198; val_edge_recon_loss: 2768075.1167; val_gene_expr_recon_loss: 35937997.6000; val_masked_gp_l1_reg_loss: 122608.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74970.9844; val_chrom_access_recon_loss: 6183654.2667; val_global_loss: 45165150.6667; val_optim_loss: 45165150.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9693; val_auprc_score: 0.9649; val_best_acc_score: 0.9112; val_best_f1_score: 0.9142; train_kl_reg_loss: 111024.4108; train_edge_recon_loss: 2745771.0782; train_gene_expr_recon_loss: 35548595.6947; train_masked_gp_l1_reg_loss: 122510.7216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74709.5574; train_chrom_access_recon_loss: 6136382.8359; train_global_loss: 44738994.0763; train_optim_loss: 44738994.0763; val_kl_reg_loss: 78076.0948; val_edge_recon_loss: 2761871.0500; val_gene_expr_recon_loss: 35749233.8667; val_masked_gp_l1_reg_loss: 122417.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74445.7344; val_chrom_access_recon_loss: 6165788.2000; val_global_loss: 44951829.3333; val_optim_loss: 44951829.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 54 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9658
val AUPRC score: 0.9568
val best accuracy score: 0.9076
val best F1 score: 0.9118
val target rna MSE score: 1.4275
val source rna MSE score: 26.6056
val target atac MSE score: 0.5862
val source atac MSE score: 6.5745
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
