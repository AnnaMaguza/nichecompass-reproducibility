[True]
Run timestamp: 29072023_115012_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8743; val_auprc_score: 0.8948; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5170.5505; train_edge_recon_loss: 3473442.5278; train_gene_expr_recon_loss: 7217824.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1864842.7222; train_global_loss: 12561279.8889; train_optim_loss: 12561279.8889; val_kl_reg_loss: 10660.6133; val_edge_recon_loss: 4065500.5000; val_gene_expr_recon_loss: 6428453.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1742722.7500; val_global_loss: 12247337.0000; val_optim_loss: 12247337.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8932; val_auprc_score: 0.9092; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17162.6004; train_edge_recon_loss: 3489981.1667; train_gene_expr_recon_loss: 6261177.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1803356.5278; train_global_loss: 11571677.6667; train_optim_loss: 11571677.6667; val_kl_reg_loss: 23778.2773; val_edge_recon_loss: 4065944.0000; val_gene_expr_recon_loss: 6123972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1728505.1250; val_global_loss: 11942199.0000; val_optim_loss: 11942199.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8955; val_auprc_score: 0.9124; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 34629.2815; train_edge_recon_loss: 3498515.9722; train_gene_expr_recon_loss: 5962552.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1731792.1250; train_global_loss: 11227489.8889; train_optim_loss: 11227489.8889; val_kl_reg_loss: 38377.2500; val_edge_recon_loss: 4065933.2500; val_gene_expr_recon_loss: 5849483.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1689579.2500; val_global_loss: 11643373.0000; val_optim_loss: 11643373.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8993; val_auprc_score: 0.9135; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 53953.8893; train_edge_recon_loss: 3511471.3056; train_gene_expr_recon_loss: 5674620.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1725752.2917; train_global_loss: 10965798.1111; train_optim_loss: 10965798.1111; val_kl_reg_loss: 50817.1211; val_edge_recon_loss: 4065846.0000; val_gene_expr_recon_loss: 5508474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1692936.6250; val_global_loss: 11318074.0000; val_optim_loss: 11318074.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8956; val_auprc_score: 0.9061; val_best_acc_score: 0.5044; val_best_f1_score: 0.6686; train_kl_reg_loss: 64822.1914; train_edge_recon_loss: 3514107.6667; train_gene_expr_recon_loss: 5365271.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1717952.6111; train_global_loss: 10662153.8889; train_optim_loss: 10662153.8889; val_kl_reg_loss: 60414.1133; val_edge_recon_loss: 4065645.2500; val_gene_expr_recon_loss: 5243820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1673074.7500; val_global_loss: 11042954.0000; val_optim_loss: 11042954.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8862; val_auprc_score: 0.8977; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 71922.0916; train_edge_recon_loss: 3516050.0278; train_gene_expr_recon_loss: 5144547.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1704400.8889; train_global_loss: 10436920.2222; train_optim_loss: 10436920.2222; val_kl_reg_loss: 56752.6680; val_edge_recon_loss: 4065413.0000; val_gene_expr_recon_loss: 5012428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1654268.7500; val_global_loss: 10788863.0000; val_optim_loss: 10788863.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8782; val_auprc_score: 0.8894; val_best_acc_score: 0.5093; val_best_f1_score: 0.6708; train_kl_reg_loss: 71506.2539; train_edge_recon_loss: 3520032.3056; train_gene_expr_recon_loss: 4844040.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1677336.0694; train_global_loss: 10112915.1111; train_optim_loss: 10112915.1111; val_kl_reg_loss: 68357.3047; val_edge_recon_loss: 4065246.5000; val_gene_expr_recon_loss: 4775442.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1646838.3750; val_global_loss: 10555884.0000; val_optim_loss: 10555884.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8586; val_auprc_score: 0.8697; val_best_acc_score: 0.5177; val_best_f1_score: 0.6745; train_kl_reg_loss: 77345.9870; train_edge_recon_loss: 3514709.5278; train_gene_expr_recon_loss: 4674381.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1665622.1667; train_global_loss: 9932059.1111; train_optim_loss: 9932059.1111; val_kl_reg_loss: 55504.3477; val_edge_recon_loss: 4064728.5000; val_gene_expr_recon_loss: 4585321.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1619687.1250; val_global_loss: 10325241.0000; val_optim_loss: 10325241.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8472; val_auprc_score: 0.8576; val_best_acc_score: 0.5181; val_best_f1_score: 0.6747; train_kl_reg_loss: 72933.1211; train_edge_recon_loss: 3519564.8889; train_gene_expr_recon_loss: 4479294.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1638349.4028; train_global_loss: 9710142.3333; train_optim_loss: 9710142.3333; val_kl_reg_loss: 61990.9922; val_edge_recon_loss: 4064498.2500; val_gene_expr_recon_loss: 4397244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1601123.2500; val_global_loss: 10124856.0000; val_optim_loss: 10124856.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8259; val_auprc_score: 0.8293; val_best_acc_score: 0.5300; val_best_f1_score: 0.6798; train_kl_reg_loss: 75512.2131; train_edge_recon_loss: 3513059.3889; train_gene_expr_recon_loss: 4302765.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1616389.7917; train_global_loss: 9507726.5556; train_optim_loss: 9507726.5556; val_kl_reg_loss: 59350.1094; val_edge_recon_loss: 4063646.5000; val_gene_expr_recon_loss: 4262343.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1584246.3750; val_global_loss: 9969586.0000; val_optim_loss: 9969586.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8203; val_auprc_score: 0.8217; val_best_acc_score: 0.5575; val_best_f1_score: 0.6923; train_kl_reg_loss: 73804.2326; train_edge_recon_loss: 3514550.6111; train_gene_expr_recon_loss: 4215363.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1612118.0000; train_global_loss: 9415836.1111; train_optim_loss: 9415836.1111; val_kl_reg_loss: 52489.6055; val_edge_recon_loss: 4062146.0000; val_gene_expr_recon_loss: 4165743.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1565467.0000; val_global_loss: 9845846.0000; val_optim_loss: 9845846.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8205; val_auprc_score: 0.8189; val_best_acc_score: 0.5808; val_best_f1_score: 0.7026; train_kl_reg_loss: 72019.0386; train_edge_recon_loss: 3513187.3611; train_gene_expr_recon_loss: 4092996.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1580897.5000; train_global_loss: 9259100.2222; train_optim_loss: 9259100.2222; val_kl_reg_loss: 62197.9141; val_edge_recon_loss: 4060766.7500; val_gene_expr_recon_loss: 4073589.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1557000.0000; val_global_loss: 9753554.0000; val_optim_loss: 9753554.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8098; val_auprc_score: 0.8081; val_best_acc_score: 0.6132; val_best_f1_score: 0.7173; train_kl_reg_loss: 72378.1532; train_edge_recon_loss: 3509749.9444; train_gene_expr_recon_loss: 4022501.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1574172.7222; train_global_loss: 9178801.8889; train_optim_loss: 9178801.8889; val_kl_reg_loss: 61133.3906; val_edge_recon_loss: 4058707.0000; val_gene_expr_recon_loss: 4016596.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1547338.5000; val_global_loss: 9683776.0000; val_optim_loss: 9683776.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8127; val_auprc_score: 0.8064; val_best_acc_score: 0.6646; val_best_f1_score: 0.7415; train_kl_reg_loss: 70035.1740; train_edge_recon_loss: 3509986.0833; train_gene_expr_recon_loss: 3977804.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564802.2917; train_global_loss: 9122628.4444; train_optim_loss: 9122628.4444; val_kl_reg_loss: 59150.2930; val_edge_recon_loss: 4054407.2500; val_gene_expr_recon_loss: 3980482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539195.7500; val_global_loss: 9633235.0000; val_optim_loss: 9633235.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8122; val_auprc_score: 0.8039; val_best_acc_score: 0.7065; val_best_f1_score: 0.7599; train_kl_reg_loss: 68082.6510; train_edge_recon_loss: 3508169.9444; train_gene_expr_recon_loss: 3929172.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1560626.5139; train_global_loss: 9066051.8889; train_optim_loss: 9066051.8889; val_kl_reg_loss: 58364.4766; val_edge_recon_loss: 4047410.5000; val_gene_expr_recon_loss: 3948790.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533707.7500; val_global_loss: 9588273.0000; val_optim_loss: 9588273.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8209; val_auprc_score: 0.8112; val_best_acc_score: 0.7334; val_best_f1_score: 0.7643; train_kl_reg_loss: 65578.8637; train_edge_recon_loss: 3506896.4722; train_gene_expr_recon_loss: 3916608.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557592.1111; train_global_loss: 9046676.4444; train_optim_loss: 9046676.4444; val_kl_reg_loss: 55998.5000; val_edge_recon_loss: 4037787.2500; val_gene_expr_recon_loss: 3924034.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528573.1250; val_global_loss: 9546393.0000; val_optim_loss: 9546393.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8200; val_auprc_score: 0.8109; val_best_acc_score: 0.7326; val_best_f1_score: 0.7388; train_kl_reg_loss: 64398.8429; train_edge_recon_loss: 3502934.5556; train_gene_expr_recon_loss: 3885241.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546017.5417; train_global_loss: 8998592.7778; train_optim_loss: 8998592.7778; val_kl_reg_loss: 51027.3359; val_edge_recon_loss: 4020251.2500; val_gene_expr_recon_loss: 3916552.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528825.1250; val_global_loss: 9516656.0000; val_optim_loss: 9516656.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8299; val_auprc_score: 0.8166; val_best_acc_score: 0.7274; val_best_f1_score: 0.7658; train_kl_reg_loss: 61086.2860; train_edge_recon_loss: 3497703.6389; train_gene_expr_recon_loss: 3847786.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538839.8750; train_global_loss: 8945416.0000; train_optim_loss: 8945416.0000; val_kl_reg_loss: 51260.7188; val_edge_recon_loss: 3977912.7500; val_gene_expr_recon_loss: 3898244.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524020.5000; val_global_loss: 9451438.0000; val_optim_loss: 9451438.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8332; val_auprc_score: 0.8194; val_best_acc_score: 0.7501; val_best_f1_score: 0.7763; train_kl_reg_loss: 56908.7253; train_edge_recon_loss: 3488070.1389; train_gene_expr_recon_loss: 3878293.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546217.3194; train_global_loss: 8969490.3333; train_optim_loss: 8969490.3333; val_kl_reg_loss: 41982.0938; val_edge_recon_loss: 3897008.0000; val_gene_expr_recon_loss: 3898216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1521800.7500; val_global_loss: 9359007.0000; val_optim_loss: 9359007.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8376; val_auprc_score: 0.8239; val_best_acc_score: 0.7569; val_best_f1_score: 0.7798; train_kl_reg_loss: 50418.4184; train_edge_recon_loss: 3463045.7778; train_gene_expr_recon_loss: 3876481.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546962.4167; train_global_loss: 8936907.8889; train_optim_loss: 8936907.8889; val_kl_reg_loss: 37576.4922; val_edge_recon_loss: 3747004.7500; val_gene_expr_recon_loss: 3888186.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1520233.7500; val_global_loss: 9193002.0000; val_optim_loss: 9193002.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8393; val_auprc_score: 0.8229; val_best_acc_score: 0.7518; val_best_f1_score: 0.7762; train_kl_reg_loss: 38367.9792; train_edge_recon_loss: 3390364.3056; train_gene_expr_recon_loss: 3861353.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546206.0417; train_global_loss: 8836291.3333; train_optim_loss: 8836291.3333; val_kl_reg_loss: 30662.6172; val_edge_recon_loss: 3423713.2500; val_gene_expr_recon_loss: 3913940.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528052.7500; val_global_loss: 8896369.0000; val_optim_loss: 8896369.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8464; val_auprc_score: 0.8338; val_best_acc_score: 0.7509; val_best_f1_score: 0.7790; train_kl_reg_loss: 34295.3357; train_edge_recon_loss: 3198420.7778; train_gene_expr_recon_loss: 3904121.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551483.3611; train_global_loss: 8688320.6667; train_optim_loss: 8688320.6667; val_kl_reg_loss: 40224.6133; val_edge_recon_loss: 3092533.7500; val_gene_expr_recon_loss: 3947417.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533462.0000; val_global_loss: 8613637.0000; val_optim_loss: 8613637.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8561; val_auprc_score: 0.8420; val_best_acc_score: 0.7582; val_best_f1_score: 0.7855; train_kl_reg_loss: 54288.4301; train_edge_recon_loss: 3044355.2500; train_gene_expr_recon_loss: 3903081.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551756.9722; train_global_loss: 8553481.8889; train_optim_loss: 8553481.8889; val_kl_reg_loss: 70350.1641; val_edge_recon_loss: 2993410.0000; val_gene_expr_recon_loss: 3914749.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527173.7500; val_global_loss: 8505684.0000; val_optim_loss: 8505684.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8635; val_auprc_score: 0.8525; val_best_acc_score: 0.7654; val_best_f1_score: 0.7868; train_kl_reg_loss: 79653.6337; train_edge_recon_loss: 2964358.3333; train_gene_expr_recon_loss: 3885037.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1550540.8333; train_global_loss: 8479590.6111; train_optim_loss: 8479590.6111; val_kl_reg_loss: 83491.7656; val_edge_recon_loss: 2972986.0000; val_gene_expr_recon_loss: 3907651.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1519290.3750; val_global_loss: 8483419.0000; val_optim_loss: 8483419.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8647; val_auprc_score: 0.8444; val_best_acc_score: 0.7700; val_best_f1_score: 0.7887; train_kl_reg_loss: 87063.8290; train_edge_recon_loss: 2956527.6944; train_gene_expr_recon_loss: 3868324.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536792.6111; train_global_loss: 8448708.5556; train_optim_loss: 8448708.5556; val_kl_reg_loss: 83991.4141; val_edge_recon_loss: 2982748.7500; val_gene_expr_recon_loss: 3886058.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1517708.0000; val_global_loss: 8470507.0000; val_optim_loss: 8470507.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8805; val_auprc_score: 0.8613; val_best_acc_score: 0.7855; val_best_f1_score: 0.8021; train_kl_reg_loss: 88638.4991; train_edge_recon_loss: 2960237.1667; train_gene_expr_recon_loss: 3868256.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546981.8333; train_global_loss: 8464113.8889; train_optim_loss: 8464113.8889; val_kl_reg_loss: 57840.8047; val_edge_recon_loss: 2940940.0000; val_gene_expr_recon_loss: 3893322.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1518986.5000; val_global_loss: 8411090.0000; val_optim_loss: 8411090.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8813; val_auprc_score: 0.8624; val_best_acc_score: 0.7941; val_best_f1_score: 0.8085; train_kl_reg_loss: 92506.6823; train_edge_recon_loss: 2916832.5556; train_gene_expr_recon_loss: 3875849.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1545081.0417; train_global_loss: 8430269.1667; train_optim_loss: 8430269.1667; val_kl_reg_loss: 61799.1445; val_edge_recon_loss: 2916689.5000; val_gene_expr_recon_loss: 3884413.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1517362.7500; val_global_loss: 8380265.0000; val_optim_loss: 8380265.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8944; val_auprc_score: 0.8790; val_best_acc_score: 0.8098; val_best_f1_score: 0.8185; train_kl_reg_loss: 92974.3854; train_edge_recon_loss: 2901102.7222; train_gene_expr_recon_loss: 3856421.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535899.9028; train_global_loss: 8386399.0000; train_optim_loss: 8386399.0000; val_kl_reg_loss: 62619.9766; val_edge_recon_loss: 2895622.5000; val_gene_expr_recon_loss: 3873898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1514121.5000; val_global_loss: 8346262.0000; val_optim_loss: 8346262.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8993; val_auprc_score: 0.8799; val_best_acc_score: 0.8215; val_best_f1_score: 0.8279; train_kl_reg_loss: 87130.5356; train_edge_recon_loss: 2875972.2778; train_gene_expr_recon_loss: 3839161.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535463.3333; train_global_loss: 8337728.1667; train_optim_loss: 8337728.1667; val_kl_reg_loss: 59850.4609; val_edge_recon_loss: 2899252.5000; val_gene_expr_recon_loss: 3879272.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1514182.5000; val_global_loss: 8352558.0000; val_optim_loss: 8352558.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9108; val_auprc_score: 0.8902; val_best_acc_score: 0.8348; val_best_f1_score: 0.8415; train_kl_reg_loss: 80834.4931; train_edge_recon_loss: 2865775.1944; train_gene_expr_recon_loss: 3836689.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538956.2500; train_global_loss: 8322255.3333; train_optim_loss: 8322255.3333; val_kl_reg_loss: 60052.9375; val_edge_recon_loss: 2871548.2500; val_gene_expr_recon_loss: 3862361.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1512711.3750; val_global_loss: 8306673.5000; val_optim_loss: 8306673.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9103; val_auprc_score: 0.8816; val_best_acc_score: 0.8438; val_best_f1_score: 0.8525; train_kl_reg_loss: 78017.9696; train_edge_recon_loss: 2845672.8889; train_gene_expr_recon_loss: 3820007.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533077.2361; train_global_loss: 8276775.8889; train_optim_loss: 8276775.8889; val_kl_reg_loss: 58843.8945; val_edge_recon_loss: 2857516.0000; val_gene_expr_recon_loss: 3852085.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1509232.0000; val_global_loss: 8277677.0000; val_optim_loss: 8277677.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9217; val_auprc_score: 0.9010; val_best_acc_score: 0.8534; val_best_f1_score: 0.8623; train_kl_reg_loss: 75991.2977; train_edge_recon_loss: 2838438.6667; train_gene_expr_recon_loss: 3838410.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541726.9306; train_global_loss: 8294567.1111; train_optim_loss: 8294567.1111; val_kl_reg_loss: 57798.4648; val_edge_recon_loss: 2834272.7500; val_gene_expr_recon_loss: 3863336.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1513043.2500; val_global_loss: 8268451.0000; val_optim_loss: 8268451.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9311; val_auprc_score: 0.9075; val_best_acc_score: 0.8666; val_best_f1_score: 0.8725; train_kl_reg_loss: 74107.2422; train_edge_recon_loss: 2828930.3333; train_gene_expr_recon_loss: 3823420.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535022.5278; train_global_loss: 8261480.3333; train_optim_loss: 8261480.3333; val_kl_reg_loss: 59030.3125; val_edge_recon_loss: 2800243.2500; val_gene_expr_recon_loss: 3847919.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1511230.3750; val_global_loss: 8218423.5000; val_optim_loss: 8218423.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9351; val_auprc_score: 0.9122; val_best_acc_score: 0.8735; val_best_f1_score: 0.8793; train_kl_reg_loss: 74805.8359; train_edge_recon_loss: 2816639.5000; train_gene_expr_recon_loss: 3781254.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1530536.5972; train_global_loss: 8203236.0000; train_optim_loss: 8203236.0000; val_kl_reg_loss: 58355.0156; val_edge_recon_loss: 2792227.2500; val_gene_expr_recon_loss: 3848217.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1508092.2500; val_global_loss: 8206891.0000; val_optim_loss: 8206891.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9331; val_auprc_score: 0.9120; val_best_acc_score: 0.8733; val_best_f1_score: 0.8807; train_kl_reg_loss: 76365.4609; train_edge_recon_loss: 2795962.1944; train_gene_expr_recon_loss: 3809844.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1534193.5556; train_global_loss: 8216366.2778; train_optim_loss: 8216366.2778; val_kl_reg_loss: 60934.6328; val_edge_recon_loss: 2789757.0000; val_gene_expr_recon_loss: 3836657.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1506453.2500; val_global_loss: 8193802.0000; val_optim_loss: 8193802.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9332; val_auprc_score: 0.9112; val_best_acc_score: 0.8713; val_best_f1_score: 0.8787; train_kl_reg_loss: 77971.7439; train_edge_recon_loss: 2788108.5000; train_gene_expr_recon_loss: 3802710.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1522966.5972; train_global_loss: 8191757.7222; train_optim_loss: 8191757.7222; val_kl_reg_loss: 63752.4258; val_edge_recon_loss: 2787754.2500; val_gene_expr_recon_loss: 3837262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1505563.0000; val_global_loss: 8194332.0000; val_optim_loss: 8194332.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9367; val_auprc_score: 0.9192; val_best_acc_score: 0.8746; val_best_f1_score: 0.8817; train_kl_reg_loss: 77303.9427; train_edge_recon_loss: 2792188.6111; train_gene_expr_recon_loss: 3825096.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535524.9722; train_global_loss: 8230113.5556; train_optim_loss: 8230113.5556; val_kl_reg_loss: 62134.3359; val_edge_recon_loss: 2791236.2500; val_gene_expr_recon_loss: 3844868.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1504095.0000; val_global_loss: 8202334.0000; val_optim_loss: 8202334.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9344; val_auprc_score: 0.9133; val_best_acc_score: 0.8766; val_best_f1_score: 0.8824; train_kl_reg_loss: 76360.8932; train_edge_recon_loss: 2798911.7778; train_gene_expr_recon_loss: 3821010.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1529684.0139; train_global_loss: 8225967.0000; train_optim_loss: 8225967.0000; val_kl_reg_loss: 61962.8672; val_edge_recon_loss: 2803177.5000; val_gene_expr_recon_loss: 3826514.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1501959.0000; val_global_loss: 8193613.0000; val_optim_loss: 8193613.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9409; val_auprc_score: 0.9196; val_best_acc_score: 0.8808; val_best_f1_score: 0.8875; train_kl_reg_loss: 76089.2257; train_edge_recon_loss: 2776275.5556; train_gene_expr_recon_loss: 3773971.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1523579.0000; train_global_loss: 8149915.2778; train_optim_loss: 8149915.2778; val_kl_reg_loss: 63991.1484; val_edge_recon_loss: 2772037.5000; val_gene_expr_recon_loss: 3817764.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1500890.7500; val_global_loss: 8154684.0000; val_optim_loss: 8154684.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9386; val_auprc_score: 0.9179; val_best_acc_score: 0.8798; val_best_f1_score: 0.8859; train_kl_reg_loss: 76621.8490; train_edge_recon_loss: 2774725.2222; train_gene_expr_recon_loss: 3765706.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1516707.6944; train_global_loss: 8133761.6111; train_optim_loss: 8133761.6111; val_kl_reg_loss: 62924.1484; val_edge_recon_loss: 2772692.7500; val_gene_expr_recon_loss: 3822107.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1497225.1250; val_global_loss: 8154949.0000; val_optim_loss: 8154949.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9455; val_auprc_score: 0.9273; val_best_acc_score: 0.8888; val_best_f1_score: 0.8931; train_kl_reg_loss: 77795.0260; train_edge_recon_loss: 2762974.9167; train_gene_expr_recon_loss: 3781301.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519238.6250; train_global_loss: 8141309.6667; train_optim_loss: 8141309.6667; val_kl_reg_loss: 63210.0195; val_edge_recon_loss: 2782710.2500; val_gene_expr_recon_loss: 3819628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1500398.5000; val_global_loss: 8165946.5000; val_optim_loss: 8165946.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9474; val_auprc_score: 0.9326; val_best_acc_score: 0.8864; val_best_f1_score: 0.8922; train_kl_reg_loss: 76915.6189; train_edge_recon_loss: 2773649.5556; train_gene_expr_recon_loss: 3787521.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515226.0139; train_global_loss: 8153312.4444; train_optim_loss: 8153312.4444; val_kl_reg_loss: 62913.3828; val_edge_recon_loss: 2783571.0000; val_gene_expr_recon_loss: 3811154.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1494691.6250; val_global_loss: 8152330.0000; val_optim_loss: 8152330.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9466; val_auprc_score: 0.9277; val_best_acc_score: 0.8888; val_best_f1_score: 0.8949; train_kl_reg_loss: 76025.9714; train_edge_recon_loss: 2763537.8611; train_gene_expr_recon_loss: 3787440.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1518772.3333; train_global_loss: 8145776.8333; train_optim_loss: 8145776.8333; val_kl_reg_loss: 62981.7266; val_edge_recon_loss: 2741443.7500; val_gene_expr_recon_loss: 3806262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1494905.3750; val_global_loss: 8105593.0000; val_optim_loss: 8105593.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9465; val_auprc_score: 0.9286; val_best_acc_score: 0.8856; val_best_f1_score: 0.8923; train_kl_reg_loss: 75137.1832; train_edge_recon_loss: 2755436.6667; train_gene_expr_recon_loss: 3788286.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1523028.2639; train_global_loss: 8141889.1111; train_optim_loss: 8141889.1111; val_kl_reg_loss: 65345.9492; val_edge_recon_loss: 2768946.0000; val_gene_expr_recon_loss: 3803563.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1494242.2500; val_global_loss: 8132098.0000; val_optim_loss: 8132098.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9451; val_auprc_score: 0.9269; val_best_acc_score: 0.8870; val_best_f1_score: 0.8942; train_kl_reg_loss: 75325.8151; train_edge_recon_loss: 2763356.1389; train_gene_expr_recon_loss: 3756643.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510983.1111; train_global_loss: 8106308.2222; train_optim_loss: 8106308.2222; val_kl_reg_loss: 62380.8438; val_edge_recon_loss: 2763897.5000; val_gene_expr_recon_loss: 3796263.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1490997.2500; val_global_loss: 8113539.0000; val_optim_loss: 8113539.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9450; val_auprc_score: 0.9226; val_best_acc_score: 0.8849; val_best_f1_score: 0.8907; train_kl_reg_loss: 74069.3724; train_edge_recon_loss: 2744678.4167; train_gene_expr_recon_loss: 3762482.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1512177.7778; train_global_loss: 8093408.1111; train_optim_loss: 8093408.1111; val_kl_reg_loss: 60136.8047; val_edge_recon_loss: 2803914.0000; val_gene_expr_recon_loss: 3803568.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1492424.0000; val_global_loss: 8160043.0000; val_optim_loss: 8160043.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9488; val_auprc_score: 0.9311; val_best_acc_score: 0.8897; val_best_f1_score: 0.8946; train_kl_reg_loss: 73318.1918; train_edge_recon_loss: 2760332.9722; train_gene_expr_recon_loss: 3771383.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1520256.6389; train_global_loss: 8125291.0556; train_optim_loss: 8125291.0556; val_kl_reg_loss: 61394.2266; val_edge_recon_loss: 2802011.0000; val_gene_expr_recon_loss: 3795171.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1492292.2500; val_global_loss: 8150869.0000; val_optim_loss: 8150869.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9480; val_auprc_score: 0.9288; val_best_acc_score: 0.8909; val_best_f1_score: 0.8971; train_kl_reg_loss: 72465.2665; train_edge_recon_loss: 2738351.1389; train_gene_expr_recon_loss: 3781712.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1516362.1806; train_global_loss: 8108890.8333; train_optim_loss: 8108890.8333; val_kl_reg_loss: 62829.8438; val_edge_recon_loss: 2762373.0000; val_gene_expr_recon_loss: 3781585.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489698.1250; val_global_loss: 8096486.0000; val_optim_loss: 8096486.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9476; val_auprc_score: 0.9256; val_best_acc_score: 0.8898; val_best_f1_score: 0.8949; train_kl_reg_loss: 73533.9115; train_edge_recon_loss: 2758830.2500; train_gene_expr_recon_loss: 3754167.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515292.5556; train_global_loss: 8101824.3333; train_optim_loss: 8101824.3333; val_kl_reg_loss: 62412.6992; val_edge_recon_loss: 2765969.2500; val_gene_expr_recon_loss: 3783729.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1490371.2500; val_global_loss: 8102482.0000; val_optim_loss: 8102482.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9483; val_auprc_score: 0.9284; val_best_acc_score: 0.8915; val_best_f1_score: 0.8975; train_kl_reg_loss: 72864.2630; train_edge_recon_loss: 2757007.5556; train_gene_expr_recon_loss: 3752244.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515695.3333; train_global_loss: 8097812.0000; train_optim_loss: 8097812.0000; val_kl_reg_loss: 62497.7891; val_edge_recon_loss: 2743419.5000; val_gene_expr_recon_loss: 3780445.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488820.2500; val_global_loss: 8075183.0000; val_optim_loss: 8075183.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9473; val_auprc_score: 0.9317; val_best_acc_score: 0.8870; val_best_f1_score: 0.8929; train_kl_reg_loss: 73023.4288; train_edge_recon_loss: 2756439.7222; train_gene_expr_recon_loss: 3759494.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1516278.6389; train_global_loss: 8105236.7222; train_optim_loss: 8105236.7222; val_kl_reg_loss: 61521.8164; val_edge_recon_loss: 2793556.7500; val_gene_expr_recon_loss: 3778358.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488100.2500; val_global_loss: 8121537.0000; val_optim_loss: 8121537.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9480; val_auprc_score: 0.9311; val_best_acc_score: 0.8909; val_best_f1_score: 0.8967; train_kl_reg_loss: 71996.2535; train_edge_recon_loss: 2751520.0000; train_gene_expr_recon_loss: 3741477.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1508291.7083; train_global_loss: 8073285.0556; train_optim_loss: 8073285.0556; val_kl_reg_loss: 62045.2812; val_edge_recon_loss: 2774079.2500; val_gene_expr_recon_loss: 3781557.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1490643.3750; val_global_loss: 8108325.5000; val_optim_loss: 8108325.5000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9469; val_auprc_score: 0.9292; val_best_acc_score: 0.8915; val_best_f1_score: 0.8983; train_kl_reg_loss: 72682.5703; train_edge_recon_loss: 2756616.5833; train_gene_expr_recon_loss: 3760108.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1513150.6806; train_global_loss: 8102558.5000; train_optim_loss: 8102558.5000; val_kl_reg_loss: 61905.3750; val_edge_recon_loss: 2767451.0000; val_gene_expr_recon_loss: 3778574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488994.0000; val_global_loss: 8096924.5000; val_optim_loss: 8096924.5000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9462; val_auprc_score: 0.9272; val_best_acc_score: 0.8879; val_best_f1_score: 0.8944; train_kl_reg_loss: 72864.2639; train_edge_recon_loss: 2763113.3333; train_gene_expr_recon_loss: 3749711.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1514387.0139; train_global_loss: 8100075.6667; train_optim_loss: 8100075.6667; val_kl_reg_loss: 62521.9844; val_edge_recon_loss: 2772579.0000; val_gene_expr_recon_loss: 3780492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488325.7500; val_global_loss: 8103919.0000; val_optim_loss: 8103919.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9533; val_auprc_score: 0.9328; val_best_acc_score: 0.8914; val_best_f1_score: 0.8977; train_kl_reg_loss: 73174.9531; train_edge_recon_loss: 2762859.1111; train_gene_expr_recon_loss: 3733084.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510968.7639; train_global_loss: 8080087.4444; train_optim_loss: 8080087.4444; val_kl_reg_loss: 62673.3984; val_edge_recon_loss: 2742769.0000; val_gene_expr_recon_loss: 3780725.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488939.7500; val_global_loss: 8075107.0000; val_optim_loss: 8075107.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9522; val_auprc_score: 0.9349; val_best_acc_score: 0.8959; val_best_f1_score: 0.9016; train_kl_reg_loss: 73430.8819; train_edge_recon_loss: 2743849.7222; train_gene_expr_recon_loss: 3743358.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1509340.0417; train_global_loss: 8069979.2778; train_optim_loss: 8069979.2778; val_kl_reg_loss: 62221.3750; val_edge_recon_loss: 2753282.2500; val_gene_expr_recon_loss: 3777202.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1487180.7500; val_global_loss: 8079887.0000; val_optim_loss: 8079887.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9474; val_auprc_score: 0.9292; val_best_acc_score: 0.8887; val_best_f1_score: 0.8940; train_kl_reg_loss: 73195.4384; train_edge_recon_loss: 2751853.1944; train_gene_expr_recon_loss: 3752050.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1513170.9583; train_global_loss: 8090269.9444; train_optim_loss: 8090269.9444; val_kl_reg_loss: 62352.3984; val_edge_recon_loss: 2770385.2500; val_gene_expr_recon_loss: 3779400.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489258.0000; val_global_loss: 8101396.0000; val_optim_loss: 8101396.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9504; val_auprc_score: 0.9342; val_best_acc_score: 0.8932; val_best_f1_score: 0.8985; train_kl_reg_loss: 72585.9227; train_edge_recon_loss: 2766390.0278; train_gene_expr_recon_loss: 3729977.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1503756.1528; train_global_loss: 8072709.3889; train_optim_loss: 8072709.3889; val_kl_reg_loss: 62206.3281; val_edge_recon_loss: 2766453.2500; val_gene_expr_recon_loss: 3780886.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489617.2500; val_global_loss: 8099163.0000; val_optim_loss: 8099163.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9543; val_auprc_score: 0.9396; val_best_acc_score: 0.8998; val_best_f1_score: 0.9035; train_kl_reg_loss: 73145.9931; train_edge_recon_loss: 2759396.4167; train_gene_expr_recon_loss: 3765060.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510169.4167; train_global_loss: 8107772.7222; train_optim_loss: 8107772.7222; val_kl_reg_loss: 62011.4062; val_edge_recon_loss: 2750984.5000; val_gene_expr_recon_loss: 3778842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489080.1250; val_global_loss: 8080918.0000; val_optim_loss: 8080918.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9484; val_auprc_score: 0.9298; val_best_acc_score: 0.8933; val_best_f1_score: 0.8982; train_kl_reg_loss: 72658.1988; train_edge_recon_loss: 2753637.5278; train_gene_expr_recon_loss: 3740127.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1508102.9306; train_global_loss: 8074526.0556; train_optim_loss: 8074526.0556; val_kl_reg_loss: 62291.1562; val_edge_recon_loss: 2754282.0000; val_gene_expr_recon_loss: 3783835.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1492496.7500; val_global_loss: 8092905.0000; val_optim_loss: 8092905.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9506; val_auprc_score: 0.9370; val_best_acc_score: 0.8890; val_best_f1_score: 0.8952; train_kl_reg_loss: 72770.5043; train_edge_recon_loss: 2753451.6389; train_gene_expr_recon_loss: 3760099.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510557.2639; train_global_loss: 8096878.6111; train_optim_loss: 8096878.6111; val_kl_reg_loss: 62114.3203; val_edge_recon_loss: 2772635.0000; val_gene_expr_recon_loss: 3780670.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489478.8750; val_global_loss: 8104898.0000; val_optim_loss: 8104898.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9492; val_auprc_score: 0.9356; val_best_acc_score: 0.8906; val_best_f1_score: 0.8959; train_kl_reg_loss: 72681.7075; train_edge_recon_loss: 2757391.6944; train_gene_expr_recon_loss: 3748671.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1505854.6667; train_global_loss: 8084599.1667; train_optim_loss: 8084599.1667; val_kl_reg_loss: 61855.7500; val_edge_recon_loss: 2795349.7500; val_gene_expr_recon_loss: 3777401.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1488456.5000; val_global_loss: 8123063.0000; val_optim_loss: 8123063.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9469; val_auprc_score: 0.9258; val_best_acc_score: 0.8930; val_best_f1_score: 0.8985; train_kl_reg_loss: 72635.9818; train_edge_recon_loss: 2750656.6111; train_gene_expr_recon_loss: 3732380.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510885.4583; train_global_loss: 8066558.3889; train_optim_loss: 8066558.3889; val_kl_reg_loss: 62089.2891; val_edge_recon_loss: 2769518.5000; val_gene_expr_recon_loss: 3779915.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1489538.1250; val_global_loss: 8101061.0000; val_optim_loss: 8101061.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 43 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9508
val AUPRC score: 0.9344
val best accuracy score: 0.8909
val best F1 score: 0.8958
val target rna MSE score: 1.8472
val source rna MSE score: 0.8891
val target atac MSE score: 0.1176
val source atac MSE score: 0.0167
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
