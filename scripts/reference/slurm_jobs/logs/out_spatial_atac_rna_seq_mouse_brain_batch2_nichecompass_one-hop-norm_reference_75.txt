[True]
Run timestamp: 07082023_194305_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8827; val_auprc_score: 0.9013; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 27836.4962; train_edge_recon_loss: 353139.8299; train_gene_expr_recon_loss: 1226644.3403; train_masked_gp_l1_reg_loss: 4667.4284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167119.4149; train_chrom_access_recon_loss: 2378695.9861; train_global_loss: 4158103.4722; train_optim_loss: 4158103.4722; val_kl_reg_loss: 15810.8359; val_edge_recon_loss: 406592.2812; val_gene_expr_recon_loss: 1007988.7500; val_masked_gp_l1_reg_loss: 4268.2007; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162785.5312; val_chrom_access_recon_loss: 1795833.1250; val_global_loss: 3393278.7500; val_optim_loss: 3393278.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8914; val_auprc_score: 0.9081; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13613.1119; train_edge_recon_loss: 357064.2743; train_gene_expr_recon_loss: 913446.4236; train_masked_gp_l1_reg_loss: 4213.5590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160060.9271; train_chrom_access_recon_loss: 1555183.2639; train_global_loss: 3003581.5833; train_optim_loss: 3003581.5833; val_kl_reg_loss: 11808.3438; val_edge_recon_loss: 406585.9062; val_gene_expr_recon_loss: 845748.6250; val_masked_gp_l1_reg_loss: 4243.4282; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156724.3750; val_chrom_access_recon_loss: 1426059.8750; val_global_loss: 2851170.5000; val_optim_loss: 2851170.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8873; val_auprc_score: 0.9048; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12889.1988; train_edge_recon_loss: 356584.6632; train_gene_expr_recon_loss: 827308.2847; train_masked_gp_l1_reg_loss: 4384.3705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154001.1267; train_chrom_access_recon_loss: 1401894.6528; train_global_loss: 2757062.2778; train_optim_loss: 2757062.2778; val_kl_reg_loss: 15041.3848; val_edge_recon_loss: 406591.9375; val_gene_expr_recon_loss: 791991.1250; val_masked_gp_l1_reg_loss: 4558.6143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150460.4531; val_chrom_access_recon_loss: 1383723.0000; val_global_loss: 2752366.5000; val_optim_loss: 2752366.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8769; val_auprc_score: 0.8957; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 16553.5687; train_edge_recon_loss: 358560.3507; train_gene_expr_recon_loss: 781192.5486; train_masked_gp_l1_reg_loss: 4637.0871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147326.5191; train_chrom_access_recon_loss: 1384712.5694; train_global_loss: 2692982.6667; train_optim_loss: 2692982.6667; val_kl_reg_loss: 16721.9609; val_edge_recon_loss: 406591.5000; val_gene_expr_recon_loss: 759475.3750; val_masked_gp_l1_reg_loss: 4694.4624; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143205.2656; val_chrom_access_recon_loss: 1362416.2500; val_global_loss: 2693105.0000; val_optim_loss: 2693105.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8869; val_auprc_score: 0.9025; val_best_acc_score: 0.5020; val_best_f1_score: 0.6676; train_kl_reg_loss: 17970.5729; train_edge_recon_loss: 359131.5347; train_gene_expr_recon_loss: 754880.1944; train_masked_gp_l1_reg_loss: 4712.2268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139663.4826; train_chrom_access_recon_loss: 1357600.7917; train_global_loss: 2633958.8611; train_optim_loss: 2633958.8611; val_kl_reg_loss: 18090.3867; val_edge_recon_loss: 406573.9062; val_gene_expr_recon_loss: 737934.5625; val_masked_gp_l1_reg_loss: 4721.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135146.0625; val_chrom_access_recon_loss: 1348603.1250; val_global_loss: 2651070.0000; val_optim_loss: 2651070.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8857; val_auprc_score: 0.8918; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 19734.3322; train_edge_recon_loss: 359603.0243; train_gene_expr_recon_loss: 738760.8194; train_masked_gp_l1_reg_loss: 4715.3729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131457.6510; train_chrom_access_recon_loss: 1347686.9167; train_global_loss: 2601958.0278; train_optim_loss: 2601958.0278; val_kl_reg_loss: 18711.2480; val_edge_recon_loss: 406517.8750; val_gene_expr_recon_loss: 720591.2500; val_masked_gp_l1_reg_loss: 4694.7515; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126828.2812; val_chrom_access_recon_loss: 1338505.1250; val_global_loss: 2615848.5000; val_optim_loss: 2615848.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8722; val_auprc_score: 0.8721; val_best_acc_score: 0.5206; val_best_f1_score: 0.6755; train_kl_reg_loss: 20336.6751; train_edge_recon_loss: 359716.4340; train_gene_expr_recon_loss: 717096.2708; train_masked_gp_l1_reg_loss: 4677.2705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123144.7292; train_chrom_access_recon_loss: 1337935.1944; train_global_loss: 2562906.5556; train_optim_loss: 2562906.5556; val_kl_reg_loss: 19175.4180; val_edge_recon_loss: 406392.2188; val_gene_expr_recon_loss: 706824.6875; val_masked_gp_l1_reg_loss: 4648.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118570.8203; val_chrom_access_recon_loss: 1331312.5000; val_global_loss: 2586924.5000; val_optim_loss: 2586924.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8618; val_auprc_score: 0.8587; val_best_acc_score: 0.5534; val_best_f1_score: 0.6895; train_kl_reg_loss: 20988.6385; train_edge_recon_loss: 359582.0347; train_gene_expr_recon_loss: 704164.3681; train_masked_gp_l1_reg_loss: 4629.8364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115003.8359; train_chrom_access_recon_loss: 1330986.1944; train_global_loss: 2535354.9167; train_optim_loss: 2535354.9167; val_kl_reg_loss: 21528.8398; val_edge_recon_loss: 406168.6562; val_gene_expr_recon_loss: 693964.2500; val_masked_gp_l1_reg_loss: 4601.1831; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110617.8594; val_chrom_access_recon_loss: 1324913.5000; val_global_loss: 2561794.2500; val_optim_loss: 2561794.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8438; val_auprc_score: 0.8434; val_best_acc_score: 0.6113; val_best_f1_score: 0.7156; train_kl_reg_loss: 21973.6888; train_edge_recon_loss: 359660.6319; train_gene_expr_recon_loss: 693007.9375; train_masked_gp_l1_reg_loss: 4585.0015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107235.5972; train_chrom_access_recon_loss: 1330305.4306; train_global_loss: 2516768.2500; train_optim_loss: 2516768.2500; val_kl_reg_loss: 21395.3477; val_edge_recon_loss: 405751.4375; val_gene_expr_recon_loss: 684892.6250; val_masked_gp_l1_reg_loss: 4555.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103094.7812; val_chrom_access_recon_loss: 1319768.8750; val_global_loss: 2539459.0000; val_optim_loss: 2539459.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8418; val_auprc_score: 0.8426; val_best_acc_score: 0.6698; val_best_f1_score: 0.7433; train_kl_reg_loss: 22458.1597; train_edge_recon_loss: 359589.3958; train_gene_expr_recon_loss: 685488.3056; train_masked_gp_l1_reg_loss: 4544.5870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99949.3655; train_chrom_access_recon_loss: 1324209.4306; train_global_loss: 2496239.2222; train_optim_loss: 2496239.2222; val_kl_reg_loss: 22674.6738; val_edge_recon_loss: 405194.0938; val_gene_expr_recon_loss: 677593.4375; val_masked_gp_l1_reg_loss: 4523.9634; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96126.1719; val_chrom_access_recon_loss: 1314949.6250; val_global_loss: 2521062.0000; val_optim_loss: 2521062.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8383; val_auprc_score: 0.8320; val_best_acc_score: 0.7258; val_best_f1_score: 0.7677; train_kl_reg_loss: 23066.3611; train_edge_recon_loss: 359260.7674; train_gene_expr_recon_loss: 679548.6458; train_masked_gp_l1_reg_loss: 4512.6868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93251.6424; train_chrom_access_recon_loss: 1315826.6389; train_global_loss: 2475466.8056; train_optim_loss: 2475466.8056; val_kl_reg_loss: 21753.9297; val_edge_recon_loss: 404207.6562; val_gene_expr_recon_loss: 672586.0000; val_masked_gp_l1_reg_loss: 4494.5293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89774.2969; val_chrom_access_recon_loss: 1310876.6250; val_global_loss: 2503693.0000; val_optim_loss: 2503693.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8315; val_auprc_score: 0.8222; val_best_acc_score: 0.7447; val_best_f1_score: 0.7656; train_kl_reg_loss: 23003.5792; train_edge_recon_loss: 359102.0139; train_gene_expr_recon_loss: 677801.8264; train_masked_gp_l1_reg_loss: 4493.1491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87180.0339; train_chrom_access_recon_loss: 1317504.7778; train_global_loss: 2469085.3611; train_optim_loss: 2469085.3611; val_kl_reg_loss: 20613.7109; val_edge_recon_loss: 403062.0625; val_gene_expr_recon_loss: 669663.8750; val_masked_gp_l1_reg_loss: 4481.0879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84033.9688; val_chrom_access_recon_loss: 1307325.5000; val_global_loss: 2489180.2500; val_optim_loss: 2489180.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8369; val_auprc_score: 0.8293; val_best_acc_score: 0.7507; val_best_f1_score: 0.7499; train_kl_reg_loss: 22817.8761; train_edge_recon_loss: 358752.2361; train_gene_expr_recon_loss: 671393.4444; train_masked_gp_l1_reg_loss: 4479.9934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81689.5712; train_chrom_access_recon_loss: 1309755.3333; train_global_loss: 2448888.5000; train_optim_loss: 2448888.5000; val_kl_reg_loss: 20696.7773; val_edge_recon_loss: 401315.0000; val_gene_expr_recon_loss: 666246.6250; val_masked_gp_l1_reg_loss: 4471.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78839.4141; val_chrom_access_recon_loss: 1304209.6250; val_global_loss: 2475778.5000; val_optim_loss: 2475778.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8319; val_auprc_score: 0.8236; val_best_acc_score: 0.7416; val_best_f1_score: 0.7475; train_kl_reg_loss: 22746.2756; train_edge_recon_loss: 358053.5208; train_gene_expr_recon_loss: 667938.5833; train_masked_gp_l1_reg_loss: 4472.0782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76709.4080; train_chrom_access_recon_loss: 1304801.8889; train_global_loss: 2434721.7778; train_optim_loss: 2434721.7778; val_kl_reg_loss: 20590.4902; val_edge_recon_loss: 399196.1562; val_gene_expr_recon_loss: 663384.2500; val_masked_gp_l1_reg_loss: 4465.8599; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74120.9375; val_chrom_access_recon_loss: 1301338.6250; val_global_loss: 2463096.5000; val_optim_loss: 2463096.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8358; val_auprc_score: 0.8295; val_best_acc_score: 0.7288; val_best_f1_score: 0.7618; train_kl_reg_loss: 22298.5540; train_edge_recon_loss: 357364.2917; train_gene_expr_recon_loss: 665565.8681; train_masked_gp_l1_reg_loss: 4470.7219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72185.2214; train_chrom_access_recon_loss: 1306773.8056; train_global_loss: 2428658.5278; train_optim_loss: 2428658.5278; val_kl_reg_loss: 20718.7969; val_edge_recon_loss: 396310.4062; val_gene_expr_recon_loss: 660691.6250; val_masked_gp_l1_reg_loss: 4467.0044; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69823.1016; val_chrom_access_recon_loss: 1298857.7500; val_global_loss: 2450868.5000; val_optim_loss: 2450868.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8412; val_auprc_score: 0.8284; val_best_acc_score: 0.7485; val_best_f1_score: 0.7765; train_kl_reg_loss: 21874.7713; train_edge_recon_loss: 356128.3576; train_gene_expr_recon_loss: 663668.5278; train_masked_gp_l1_reg_loss: 4474.6002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68052.6997; train_chrom_access_recon_loss: 1300851.5556; train_global_loss: 2415050.4722; train_optim_loss: 2415050.4722; val_kl_reg_loss: 20328.5918; val_edge_recon_loss: 392593.6250; val_gene_expr_recon_loss: 658658.6250; val_masked_gp_l1_reg_loss: 4476.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65900.6406; val_chrom_access_recon_loss: 1296431.2500; val_global_loss: 2438389.0000; val_optim_loss: 2438389.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8504; val_auprc_score: 0.8444; val_best_acc_score: 0.7692; val_best_f1_score: 0.7785; train_kl_reg_loss: 21273.3995; train_edge_recon_loss: 354631.9792; train_gene_expr_recon_loss: 661518.7639; train_masked_gp_l1_reg_loss: 4487.5562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64279.2578; train_chrom_access_recon_loss: 1300930.2222; train_global_loss: 2407121.1389; train_optim_loss: 2407121.1389; val_kl_reg_loss: 19889.8086; val_edge_recon_loss: 385981.8750; val_gene_expr_recon_loss: 657290.8125; val_masked_gp_l1_reg_loss: 4490.1089; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62301.5664; val_chrom_access_recon_loss: 1294342.3750; val_global_loss: 2424296.5000; val_optim_loss: 2424296.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8559; val_auprc_score: 0.8519; val_best_acc_score: 0.7734; val_best_f1_score: 0.7807; train_kl_reg_loss: 20705.8038; train_edge_recon_loss: 352257.1389; train_gene_expr_recon_loss: 658197.3125; train_masked_gp_l1_reg_loss: 4498.9487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60805.9653; train_chrom_access_recon_loss: 1292758.5278; train_global_loss: 2389223.7222; train_optim_loss: 2389223.7222; val_kl_reg_loss: 19778.3984; val_edge_recon_loss: 376099.0625; val_gene_expr_recon_loss: 655760.1250; val_masked_gp_l1_reg_loss: 4503.9399; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58977.8047; val_chrom_access_recon_loss: 1292122.3750; val_global_loss: 2407241.7500; val_optim_loss: 2407241.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8721; val_auprc_score: 0.8632; val_best_acc_score: 0.7886; val_best_f1_score: 0.7953; train_kl_reg_loss: 20316.6215; train_edge_recon_loss: 346757.0799; train_gene_expr_recon_loss: 659989.7222; train_masked_gp_l1_reg_loss: 4518.3330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57599.3368; train_chrom_access_recon_loss: 1294531.6944; train_global_loss: 2383712.7778; train_optim_loss: 2383712.7778; val_kl_reg_loss: 19710.0137; val_edge_recon_loss: 356220.3125; val_gene_expr_recon_loss: 656065.0000; val_masked_gp_l1_reg_loss: 4528.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55916.5938; val_chrom_access_recon_loss: 1291018.7500; val_global_loss: 2383458.7500; val_optim_loss: 2383458.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8665; val_auprc_score: 0.8607; val_best_acc_score: 0.7762; val_best_f1_score: 0.7901; train_kl_reg_loss: 21641.8717; train_edge_recon_loss: 335289.4896; train_gene_expr_recon_loss: 659383.1111; train_masked_gp_l1_reg_loss: 4550.4861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54645.1623; train_chrom_access_recon_loss: 1300299.5278; train_global_loss: 2375809.6667; train_optim_loss: 2375809.6667; val_kl_reg_loss: 22932.0781; val_edge_recon_loss: 336166.4688; val_gene_expr_recon_loss: 655871.1250; val_masked_gp_l1_reg_loss: 4570.6353; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53089.4844; val_chrom_access_recon_loss: 1289592.2500; val_global_loss: 2362222.0000; val_optim_loss: 2362222.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8816; val_auprc_score: 0.8701; val_best_acc_score: 0.7947; val_best_f1_score: 0.8054; train_kl_reg_loss: 26347.3205; train_edge_recon_loss: 322356.8958; train_gene_expr_recon_loss: 661376.1806; train_masked_gp_l1_reg_loss: 4591.2829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51918.8971; train_chrom_access_recon_loss: 1295085.7083; train_global_loss: 2361676.2500; train_optim_loss: 2361676.2500; val_kl_reg_loss: 29204.7695; val_edge_recon_loss: 319694.6875; val_gene_expr_recon_loss: 653748.5625; val_masked_gp_l1_reg_loss: 4610.5713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50486.3516; val_chrom_access_recon_loss: 1287015.1250; val_global_loss: 2344760.0000; val_optim_loss: 2344760.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9016; val_auprc_score: 0.8925; val_best_acc_score: 0.8158; val_best_f1_score: 0.8256; train_kl_reg_loss: 30339.7233; train_edge_recon_loss: 314025.0972; train_gene_expr_recon_loss: 658723.9583; train_masked_gp_l1_reg_loss: 4628.1521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49404.9878; train_chrom_access_recon_loss: 1293596.6111; train_global_loss: 2350718.5833; train_optim_loss: 2350718.5833; val_kl_reg_loss: 28716.6523; val_edge_recon_loss: 311652.0000; val_gene_expr_recon_loss: 653386.6250; val_masked_gp_l1_reg_loss: 4649.9971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48075.3672; val_chrom_access_recon_loss: 1285038.0000; val_global_loss: 2331518.5000; val_optim_loss: 2331518.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9122; val_auprc_score: 0.8995; val_best_acc_score: 0.8317; val_best_f1_score: 0.8391; train_kl_reg_loss: 29351.0998; train_edge_recon_loss: 309765.9688; train_gene_expr_recon_loss: 656425.7014; train_masked_gp_l1_reg_loss: 4671.0200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47073.3967; train_chrom_access_recon_loss: 1289406.1528; train_global_loss: 2336693.3611; train_optim_loss: 2336693.3611; val_kl_reg_loss: 27724.4082; val_edge_recon_loss: 309510.3750; val_gene_expr_recon_loss: 653058.3750; val_masked_gp_l1_reg_loss: 4690.7925; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45835.7070; val_chrom_access_recon_loss: 1283281.7500; val_global_loss: 2324101.5000; val_optim_loss: 2324101.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9191; val_auprc_score: 0.9051; val_best_acc_score: 0.8437; val_best_f1_score: 0.8494; train_kl_reg_loss: 29149.7938; train_edge_recon_loss: 305838.2604; train_gene_expr_recon_loss: 656799.8681; train_masked_gp_l1_reg_loss: 4711.3534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44902.4080; train_chrom_access_recon_loss: 1285607.4167; train_global_loss: 2327009.1111; train_optim_loss: 2327009.1111; val_kl_reg_loss: 28393.2734; val_edge_recon_loss: 307266.9688; val_gene_expr_recon_loss: 651286.7500; val_masked_gp_l1_reg_loss: 4729.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43748.3906; val_chrom_access_recon_loss: 1281369.0000; val_global_loss: 2316793.7500; val_optim_loss: 2316793.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9383; val_auprc_score: 0.9267; val_best_acc_score: 0.8680; val_best_f1_score: 0.8728; train_kl_reg_loss: 29587.9184; train_edge_recon_loss: 303640.9236; train_gene_expr_recon_loss: 656388.2569; train_masked_gp_l1_reg_loss: 4749.1680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42877.2891; train_chrom_access_recon_loss: 1286369.1250; train_global_loss: 2323612.6667; train_optim_loss: 2323612.6667; val_kl_reg_loss: 28482.8906; val_edge_recon_loss: 300268.8750; val_gene_expr_recon_loss: 650195.8750; val_masked_gp_l1_reg_loss: 4766.6460; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41795.8164; val_chrom_access_recon_loss: 1279176.7500; val_global_loss: 2304686.7500; val_optim_loss: 2304686.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9357; val_auprc_score: 0.9233; val_best_acc_score: 0.8639; val_best_f1_score: 0.8659; train_kl_reg_loss: 27795.0291; train_edge_recon_loss: 321909.5035; train_gene_expr_recon_loss: 979497.1667; train_masked_gp_l1_reg_loss: 4840.6613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40800.9062; train_chrom_access_recon_loss: 1362771.9444; train_global_loss: 2737615.1389; train_optim_loss: 2737615.1389; val_kl_reg_loss: 12041.4473; val_edge_recon_loss: 313283.9062; val_gene_expr_recon_loss: 964618.8750; val_masked_gp_l1_reg_loss: 4958.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39465.7188; val_chrom_access_recon_loss: 1354206.7500; val_global_loss: 2688575.2500; val_optim_loss: 2688575.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9323; val_auprc_score: 0.9175; val_best_acc_score: 0.8618; val_best_f1_score: 0.8674; train_kl_reg_loss: 26294.1413; train_edge_recon_loss: 308265.8021; train_gene_expr_recon_loss: 971980.3958; train_masked_gp_l1_reg_loss: 5066.3322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38366.9857; train_chrom_access_recon_loss: 1355076.8194; train_global_loss: 2705050.5000; train_optim_loss: 2705050.5000; val_kl_reg_loss: 13980.2422; val_edge_recon_loss: 305396.8750; val_gene_expr_recon_loss: 959756.0000; val_masked_gp_l1_reg_loss: 5193.5767; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37015.3164; val_chrom_access_recon_loss: 1351842.6250; val_global_loss: 2673184.7500; val_optim_loss: 2673184.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9366; val_auprc_score: 0.9254; val_best_acc_score: 0.8650; val_best_f1_score: 0.8695; train_kl_reg_loss: 24428.6313; train_edge_recon_loss: 300771.8785; train_gene_expr_recon_loss: 967013.9167; train_masked_gp_l1_reg_loss: 5278.9568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35987.6914; train_chrom_access_recon_loss: 1354436.4583; train_global_loss: 2687917.5278; train_optim_loss: 2687917.5278; val_kl_reg_loss: 16495.0254; val_edge_recon_loss: 297903.3750; val_gene_expr_recon_loss: 954233.3750; val_masked_gp_l1_reg_loss: 5373.8569; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34740.5352; val_chrom_access_recon_loss: 1349488.6250; val_global_loss: 2658234.7500; val_optim_loss: 2658234.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9333; val_auprc_score: 0.9198; val_best_acc_score: 0.8593; val_best_f1_score: 0.8638; train_kl_reg_loss: 23957.2413; train_edge_recon_loss: 298997.9514; train_gene_expr_recon_loss: 957615.1181; train_masked_gp_l1_reg_loss: 5434.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33806.7964; train_chrom_access_recon_loss: 1350864.5833; train_global_loss: 2670676.6111; train_optim_loss: 2670676.6111; val_kl_reg_loss: 18334.4688; val_edge_recon_loss: 296685.2188; val_gene_expr_recon_loss: 948270.6250; val_masked_gp_l1_reg_loss: 5503.4663; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32680.5430; val_chrom_access_recon_loss: 1347283.6250; val_global_loss: 2648758.0000; val_optim_loss: 2648758.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9309; val_auprc_score: 0.9191; val_best_acc_score: 0.8553; val_best_f1_score: 0.8604; train_kl_reg_loss: 23594.5660; train_edge_recon_loss: 298096.8194; train_gene_expr_recon_loss: 957237.9931; train_masked_gp_l1_reg_loss: 5495.9444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32511.3466; train_chrom_access_recon_loss: 1354721.1528; train_global_loss: 2671657.8611; train_optim_loss: 2671657.8611; val_kl_reg_loss: 18083.3438; val_edge_recon_loss: 299427.5625; val_gene_expr_recon_loss: 947934.3750; val_masked_gp_l1_reg_loss: 5488.4795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32322.2500; val_chrom_access_recon_loss: 1346671.6250; val_global_loss: 2649927.5000; val_optim_loss: 2649927.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9278; val_auprc_score: 0.9109; val_best_acc_score: 0.8550; val_best_f1_score: 0.8600; train_kl_reg_loss: 23284.4681; train_edge_recon_loss: 297085.0243; train_gene_expr_recon_loss: 959572.1181; train_masked_gp_l1_reg_loss: 5488.2802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32206.6997; train_chrom_access_recon_loss: 1353565.1944; train_global_loss: 2671201.8056; train_optim_loss: 2671201.8056; val_kl_reg_loss: 18268.7266; val_edge_recon_loss: 299746.7812; val_gene_expr_recon_loss: 947832.3750; val_masked_gp_l1_reg_loss: 5487.5249; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32057.6641; val_chrom_access_recon_loss: 1346865.6250; val_global_loss: 2650258.5000; val_optim_loss: 2650258.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9300; val_auprc_score: 0.9134; val_best_acc_score: 0.8553; val_best_f1_score: 0.8604; train_kl_reg_loss: 23335.3346; train_edge_recon_loss: 297533.4167; train_gene_expr_recon_loss: 956612.8056; train_masked_gp_l1_reg_loss: 5488.1611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31949.2539; train_chrom_access_recon_loss: 1350111.8194; train_global_loss: 2665030.7778; train_optim_loss: 2665030.7778; val_kl_reg_loss: 18445.6602; val_edge_recon_loss: 301468.1875; val_gene_expr_recon_loss: 947193.5000; val_masked_gp_l1_reg_loss: 5489.1318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31816.6133; val_chrom_access_recon_loss: 1346735.6250; val_global_loss: 2651148.7500; val_optim_loss: 2651148.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9300; val_auprc_score: 0.9154; val_best_acc_score: 0.8554; val_best_f1_score: 0.8621; train_kl_reg_loss: 23251.5927; train_edge_recon_loss: 297876.0243; train_gene_expr_recon_loss: 950389.4375; train_masked_gp_l1_reg_loss: 5490.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31715.2875; train_chrom_access_recon_loss: 1344093.8611; train_global_loss: 2652816.7222; train_optim_loss: 2652816.7222; val_kl_reg_loss: 18475.8047; val_edge_recon_loss: 299795.8438; val_gene_expr_recon_loss: 946792.3750; val_masked_gp_l1_reg_loss: 5492.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31593.9863; val_chrom_access_recon_loss: 1346314.7500; val_global_loss: 2648465.5000; val_optim_loss: 2648465.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9360
val AUPRC score: 0.9215
val best accuracy score: 0.8643
val best F1 score: 0.8699
val target rna MSE score: 3.8067
val source rna MSE score: 3.0855
val target atac MSE score: 0.1346
val source atac MSE score: 0.0201
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
