[True]
Run timestamp: 09102023_234834_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6897; val_auprc_score: 0.6586; val_best_acc_score: 0.5177; val_best_f1_score: 0.6741; train_kl_reg_loss: 38645.8855; train_edge_recon_loss: 3505451.6402; train_gene_expr_recon_loss: 14095752.0758; train_masked_gp_l1_reg_loss: 43867.7349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5470844.0682; train_chrom_access_recon_loss: 2974444.1705; train_global_loss: 26129005.5152; train_optim_loss: 26129005.5152; val_kl_reg_loss: 56068.3350; val_edge_recon_loss: 4064075.9375; val_gene_expr_recon_loss: 13149147.7500; val_masked_gp_l1_reg_loss: 51488.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2453035.2500; val_chrom_access_recon_loss: 2832079.8438; val_global_loss: 22605896.2500; val_optim_loss: 22605896.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6717; val_auprc_score: 0.6488; val_best_acc_score: 0.6112; val_best_f1_score: 0.6971; train_kl_reg_loss: 83221.3426; train_edge_recon_loss: 3513387.1856; train_gene_expr_recon_loss: 12823885.1970; train_masked_gp_l1_reg_loss: 53717.0675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1099802.4233; train_chrom_access_recon_loss: 2837598.7955; train_global_loss: 20411612.0909; train_optim_loss: 20411612.0909; val_kl_reg_loss: 87296.4551; val_edge_recon_loss: 4057546.1562; val_gene_expr_recon_loss: 12951185.5000; val_masked_gp_l1_reg_loss: 55676.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 428685.9062; val_chrom_access_recon_loss: 2810263.9375; val_global_loss: 20390653.5000; val_optim_loss: 20390653.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7180; val_auprc_score: 0.7001; val_best_acc_score: 0.6427; val_best_f1_score: 0.7060; train_kl_reg_loss: 81611.6824; train_edge_recon_loss: 3509486.3636; train_gene_expr_recon_loss: 12666178.8333; train_masked_gp_l1_reg_loss: 57155.0775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 295535.5026; train_chrom_access_recon_loss: 2817830.9129; train_global_loss: 19427798.3939; train_optim_loss: 19427798.3939; val_kl_reg_loss: 66672.6807; val_edge_recon_loss: 4007335.7188; val_gene_expr_recon_loss: 12656971.5000; val_masked_gp_l1_reg_loss: 58690.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217822.8750; val_chrom_access_recon_loss: 2765098.2812; val_global_loss: 19772590.0000; val_optim_loss: 19772590.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7487; val_auprc_score: 0.7439; val_best_acc_score: 0.6717; val_best_f1_score: 0.7187; train_kl_reg_loss: 63543.0842; train_edge_recon_loss: 3397933.7235; train_gene_expr_recon_loss: 12592118.5152; train_masked_gp_l1_reg_loss: 60659.2527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185886.9093; train_chrom_access_recon_loss: 2803225.2386; train_global_loss: 19103366.6364; train_optim_loss: 19103366.6364; val_kl_reg_loss: 70838.8867; val_edge_recon_loss: 3332670.3125; val_gene_expr_recon_loss: 12608107.1250; val_masked_gp_l1_reg_loss: 63507.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162226.5781; val_chrom_access_recon_loss: 2767417.6562; val_global_loss: 19004768.0000; val_optim_loss: 19004768.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7739; val_auprc_score: 0.7604; val_best_acc_score: 0.6951; val_best_f1_score: 0.7398; train_kl_reg_loss: 83132.3337; train_edge_recon_loss: 3132154.6212; train_gene_expr_recon_loss: 12539831.4091; train_masked_gp_l1_reg_loss: 65847.7840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146837.2393; train_chrom_access_recon_loss: 2790338.6098; train_global_loss: 18758141.8788; train_optim_loss: 18758141.8788; val_kl_reg_loss: 90774.0107; val_edge_recon_loss: 3162319.0000; val_gene_expr_recon_loss: 12559551.1250; val_masked_gp_l1_reg_loss: 67871.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134977.3438; val_chrom_access_recon_loss: 2718309.6250; val_global_loss: 18733803.0000; val_optim_loss: 18733803.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8164; val_auprc_score: 0.7979; val_best_acc_score: 0.7359; val_best_f1_score: 0.7647; train_kl_reg_loss: 89645.3724; train_edge_recon_loss: 3057515.4242; train_gene_expr_recon_loss: 12460134.2424; train_masked_gp_l1_reg_loss: 69567.5333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127103.3378; train_chrom_access_recon_loss: 2772343.9280; train_global_loss: 18576309.9091; train_optim_loss: 18576309.9091; val_kl_reg_loss: 86620.9062; val_edge_recon_loss: 3075130.3438; val_gene_expr_recon_loss: 12448023.0000; val_masked_gp_l1_reg_loss: 71464.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120919.6953; val_chrom_access_recon_loss: 2718068.7188; val_global_loss: 18520227.0000; val_optim_loss: 18520227.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8946; val_auprc_score: 0.8679; val_best_acc_score: 0.8254; val_best_f1_score: 0.8371; train_kl_reg_loss: 91930.1645; train_edge_recon_loss: 2909122.8561; train_gene_expr_recon_loss: 12380918.9394; train_masked_gp_l1_reg_loss: 73566.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118183.5420; train_chrom_access_recon_loss: 2757394.1515; train_global_loss: 18331115.8182; train_optim_loss: 18331115.8182; val_kl_reg_loss: 98469.0889; val_edge_recon_loss: 2860098.4062; val_gene_expr_recon_loss: 12322174.5000; val_masked_gp_l1_reg_loss: 75801.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116332.7031; val_chrom_access_recon_loss: 2688289.9062; val_global_loss: 18161166.0000; val_optim_loss: 18161166.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8902; val_auprc_score: 0.8571; val_best_acc_score: 0.8297; val_best_f1_score: 0.8427; train_kl_reg_loss: 102040.2436; train_edge_recon_loss: 2833651.7614; train_gene_expr_recon_loss: 12300774.9545; train_masked_gp_l1_reg_loss: 77054.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115244.3066; train_chrom_access_recon_loss: 2742661.8106; train_global_loss: 18171427.4848; train_optim_loss: 18171427.4848; val_kl_reg_loss: 100598.1484; val_edge_recon_loss: 2833821.5625; val_gene_expr_recon_loss: 12446203.1250; val_masked_gp_l1_reg_loss: 78528.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115794.4922; val_chrom_access_recon_loss: 2731381.6875; val_global_loss: 18306327.5000; val_optim_loss: 18306327.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8957; val_auprc_score: 0.8591; val_best_acc_score: 0.8342; val_best_f1_score: 0.8458; train_kl_reg_loss: 103035.3888; train_edge_recon_loss: 2806053.1856; train_gene_expr_recon_loss: 12237651.0455; train_masked_gp_l1_reg_loss: 79271.6551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114929.6952; train_chrom_access_recon_loss: 2731438.4508; train_global_loss: 18072379.4848; train_optim_loss: 18072379.4848; val_kl_reg_loss: 99490.6768; val_edge_recon_loss: 2838363.1562; val_gene_expr_recon_loss: 12320858.5000; val_masked_gp_l1_reg_loss: 80036.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114409.3359; val_chrom_access_recon_loss: 2688230.1250; val_global_loss: 18141388.5000; val_optim_loss: 18141388.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9010; val_auprc_score: 0.8659; val_best_acc_score: 0.8369; val_best_f1_score: 0.8510; train_kl_reg_loss: 97932.9748; train_edge_recon_loss: 2813837.5720; train_gene_expr_recon_loss: 12182440.7121; train_masked_gp_l1_reg_loss: 80761.1475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113361.9893; train_chrom_access_recon_loss: 2721903.6667; train_global_loss: 18010238.2121; train_optim_loss: 18010238.2121; val_kl_reg_loss: 100660.1240; val_edge_recon_loss: 2819340.5625; val_gene_expr_recon_loss: 12221912.5000; val_masked_gp_l1_reg_loss: 81493.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112413.6953; val_chrom_access_recon_loss: 2705508.2188; val_global_loss: 18041328.2500; val_optim_loss: 18041328.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8947; val_auprc_score: 0.8607; val_best_acc_score: 0.8289; val_best_f1_score: 0.8417; train_kl_reg_loss: 97636.2888; train_edge_recon_loss: 2818258.5947; train_gene_expr_recon_loss: 12134223.1061; train_masked_gp_l1_reg_loss: 81971.1504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110539.3396; train_chrom_access_recon_loss: 2713651.5720; train_global_loss: 17956280.0606; train_optim_loss: 17956280.0606; val_kl_reg_loss: 99986.5977; val_edge_recon_loss: 2859447.6562; val_gene_expr_recon_loss: 12205797.5000; val_masked_gp_l1_reg_loss: 82685.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109411.7188; val_chrom_access_recon_loss: 2665991.4688; val_global_loss: 18023320.5000; val_optim_loss: 18023320.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9029; val_auprc_score: 0.8668; val_best_acc_score: 0.8407; val_best_f1_score: 0.8518; train_kl_reg_loss: 96305.7251; train_edge_recon_loss: 2804095.8561; train_gene_expr_recon_loss: 12078419.2424; train_masked_gp_l1_reg_loss: 82967.1306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108267.1542; train_chrom_access_recon_loss: 2701753.6288; train_global_loss: 17871808.9091; train_optim_loss: 17871808.9091; val_kl_reg_loss: 94815.7480; val_edge_recon_loss: 2845720.4375; val_gene_expr_recon_loss: 12149277.0000; val_masked_gp_l1_reg_loss: 83491.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107064.1953; val_chrom_access_recon_loss: 2683657.5625; val_global_loss: 17964026.7500; val_optim_loss: 17964026.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9120; val_auprc_score: 0.8878; val_best_acc_score: 0.8469; val_best_f1_score: 0.8592; train_kl_reg_loss: 94455.9079; train_edge_recon_loss: 2795819.7311; train_gene_expr_recon_loss: 12051404.1515; train_masked_gp_l1_reg_loss: 83912.6596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105757.6618; train_chrom_access_recon_loss: 2697189.8030; train_global_loss: 17828539.9091; train_optim_loss: 17828539.9091; val_kl_reg_loss: 95391.9053; val_edge_recon_loss: 2824384.0312; val_gene_expr_recon_loss: 12174758.8750; val_masked_gp_l1_reg_loss: 84438.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105429.8828; val_chrom_access_recon_loss: 2670502.5625; val_global_loss: 17954906.7500; val_optim_loss: 17954906.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9113; val_auprc_score: 0.8865; val_best_acc_score: 0.8493; val_best_f1_score: 0.8594; train_kl_reg_loss: 93715.1574; train_edge_recon_loss: 2788751.0455; train_gene_expr_recon_loss: 12015790.2424; train_masked_gp_l1_reg_loss: 84765.2610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103850.8221; train_chrom_access_recon_loss: 2687499.1250; train_global_loss: 17774371.6061; train_optim_loss: 17774371.6061; val_kl_reg_loss: 91680.8760; val_edge_recon_loss: 2804960.5938; val_gene_expr_recon_loss: 12095438.3750; val_masked_gp_l1_reg_loss: 85077.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103004.9844; val_chrom_access_recon_loss: 2648433.9062; val_global_loss: 17828596.7500; val_optim_loss: 17828596.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9140; val_auprc_score: 0.8837; val_best_acc_score: 0.8498; val_best_f1_score: 0.8585; train_kl_reg_loss: 91893.7915; train_edge_recon_loss: 2784324.3030; train_gene_expr_recon_loss: 11975597.1970; train_masked_gp_l1_reg_loss: 85511.7496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102323.5546; train_chrom_access_recon_loss: 2679862.7652; train_global_loss: 17719513.5455; train_optim_loss: 17719513.5455; val_kl_reg_loss: 92545.2607; val_edge_recon_loss: 2799309.5000; val_gene_expr_recon_loss: 12001235.6250; val_masked_gp_l1_reg_loss: 85795.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101240.3672; val_chrom_access_recon_loss: 2642804.6250; val_global_loss: 17722930.0000; val_optim_loss: 17722930.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9226; val_auprc_score: 0.8916; val_best_acc_score: 0.8673; val_best_f1_score: 0.8749; train_kl_reg_loss: 88702.0826; train_edge_recon_loss: 2774986.6818; train_gene_expr_recon_loss: 11947309.5000; train_masked_gp_l1_reg_loss: 86093.9934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100898.8750; train_chrom_access_recon_loss: 2673139.7879; train_global_loss: 17671130.7576; train_optim_loss: 17671130.7576; val_kl_reg_loss: 89398.2344; val_edge_recon_loss: 2781775.8750; val_gene_expr_recon_loss: 12058363.3750; val_masked_gp_l1_reg_loss: 86465.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100604.1484; val_chrom_access_recon_loss: 2631428.6562; val_global_loss: 17748036.5000; val_optim_loss: 17748036.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9181; val_auprc_score: 0.8935; val_best_acc_score: 0.8592; val_best_f1_score: 0.8660; train_kl_reg_loss: 89375.6947; train_edge_recon_loss: 2771619.7652; train_gene_expr_recon_loss: 11917172.6667; train_masked_gp_l1_reg_loss: 86835.1665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99652.7129; train_chrom_access_recon_loss: 2669178.8939; train_global_loss: 17633835.0909; train_optim_loss: 17633835.0909; val_kl_reg_loss: 90788.6387; val_edge_recon_loss: 2788928.6250; val_gene_expr_recon_loss: 12016551.2500; val_masked_gp_l1_reg_loss: 87180.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99814.7422; val_chrom_access_recon_loss: 2636383.0312; val_global_loss: 17719647.0000; val_optim_loss: 17719647.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9204; val_auprc_score: 0.8894; val_best_acc_score: 0.8657; val_best_f1_score: 0.8729; train_kl_reg_loss: 88733.2216; train_edge_recon_loss: 2765833.3447; train_gene_expr_recon_loss: 11885803.5303; train_masked_gp_l1_reg_loss: 87385.2517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98793.9943; train_chrom_access_recon_loss: 2658517.2235; train_global_loss: 17585066.6061; train_optim_loss: 17585066.6061; val_kl_reg_loss: 86110.4980; val_edge_recon_loss: 2755204.9688; val_gene_expr_recon_loss: 11955121.6250; val_masked_gp_l1_reg_loss: 87714.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98631.1719; val_chrom_access_recon_loss: 2631529.3438; val_global_loss: 17614311.5000; val_optim_loss: 17614311.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9121; val_auprc_score: 0.8825; val_best_acc_score: 0.8536; val_best_f1_score: 0.8649; train_kl_reg_loss: 88811.0195; train_edge_recon_loss: 2761941.7083; train_gene_expr_recon_loss: 11856696.3939; train_masked_gp_l1_reg_loss: 87926.1000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97989.4549; train_chrom_access_recon_loss: 2652797.0947; train_global_loss: 17546161.5455; train_optim_loss: 17546161.5455; val_kl_reg_loss: 87530.3047; val_edge_recon_loss: 2796926.4375; val_gene_expr_recon_loss: 11996226.8750; val_masked_gp_l1_reg_loss: 88046.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97269.8984; val_chrom_access_recon_loss: 2611604.0000; val_global_loss: 17677604.0000; val_optim_loss: 17677604.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8892; val_best_acc_score: 0.8576; val_best_f1_score: 0.8657; train_kl_reg_loss: 87017.5439; train_edge_recon_loss: 2764129.5492; train_gene_expr_recon_loss: 11819723.3788; train_masked_gp_l1_reg_loss: 88257.4863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97356.3060; train_chrom_access_recon_loss: 2643419.7614; train_global_loss: 17499903.8333; train_optim_loss: 17499903.8333; val_kl_reg_loss: 86876.3477; val_edge_recon_loss: 2801184.0625; val_gene_expr_recon_loss: 11855183.0000; val_masked_gp_l1_reg_loss: 88531.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97088.3047; val_chrom_access_recon_loss: 2605973.3125; val_global_loss: 17534837.0000; val_optim_loss: 17534837.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9183; val_auprc_score: 0.8875; val_best_acc_score: 0.8589; val_best_f1_score: 0.8698; train_kl_reg_loss: 86103.1639; train_edge_recon_loss: 2752579.2462; train_gene_expr_recon_loss: 11809793.6667; train_masked_gp_l1_reg_loss: 88857.7328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97142.2221; train_chrom_access_recon_loss: 2641782.1932; train_global_loss: 17476258.1818; train_optim_loss: 17476258.1818; val_kl_reg_loss: 87300.9268; val_edge_recon_loss: 2796735.8750; val_gene_expr_recon_loss: 11874499.6250; val_masked_gp_l1_reg_loss: 88976.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97659.2109; val_chrom_access_recon_loss: 2603768.9062; val_global_loss: 17548941.2500; val_optim_loss: 17548941.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9246; val_auprc_score: 0.8948; val_best_acc_score: 0.8702; val_best_f1_score: 0.8790; train_kl_reg_loss: 85702.7831; train_edge_recon_loss: 2744448.6250; train_gene_expr_recon_loss: 11789070.6818; train_masked_gp_l1_reg_loss: 89165.9316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97180.8803; train_chrom_access_recon_loss: 2636584.8258; train_global_loss: 17442153.7273; train_optim_loss: 17442153.7273; val_kl_reg_loss: 87163.5020; val_edge_recon_loss: 2760517.4375; val_gene_expr_recon_loss: 11887521.8750; val_masked_gp_l1_reg_loss: 89399.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97548.7812; val_chrom_access_recon_loss: 2623172.7188; val_global_loss: 17545324.5000; val_optim_loss: 17545324.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9262; val_auprc_score: 0.8936; val_best_acc_score: 0.8780; val_best_f1_score: 0.8851; train_kl_reg_loss: 85988.6789; train_edge_recon_loss: 2754659.3068; train_gene_expr_recon_loss: 11752768.9545; train_masked_gp_l1_reg_loss: 89419.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96957.8407; train_chrom_access_recon_loss: 2628930.3598; train_global_loss: 17408724.3788; train_optim_loss: 17408724.3788; val_kl_reg_loss: 86664.8828; val_edge_recon_loss: 2752810.2500; val_gene_expr_recon_loss: 11855207.7500; val_masked_gp_l1_reg_loss: 89477.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96762.3047; val_chrom_access_recon_loss: 2593517.6875; val_global_loss: 17474439.7500; val_optim_loss: 17474439.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9310; val_auprc_score: 0.9051; val_best_acc_score: 0.8740; val_best_f1_score: 0.8815; train_kl_reg_loss: 85138.8008; train_edge_recon_loss: 2739736.3598; train_gene_expr_recon_loss: 11733925.3182; train_masked_gp_l1_reg_loss: 89639.3783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96608.9313; train_chrom_access_recon_loss: 2624873.0720; train_global_loss: 17369921.9394; train_optim_loss: 17369921.9394; val_kl_reg_loss: 84402.0127; val_edge_recon_loss: 2745785.5312; val_gene_expr_recon_loss: 11930245.7500; val_masked_gp_l1_reg_loss: 89667.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96743.2188; val_chrom_access_recon_loss: 2630175.3750; val_global_loss: 17577019.7500; val_optim_loss: 17577019.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9268; val_auprc_score: 0.8980; val_best_acc_score: 0.8721; val_best_f1_score: 0.8803; train_kl_reg_loss: 85183.9258; train_edge_recon_loss: 2739107.6439; train_gene_expr_recon_loss: 11712377.6061; train_masked_gp_l1_reg_loss: 89771.5045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96627.0844; train_chrom_access_recon_loss: 2618131.1136; train_global_loss: 17341198.8636; train_optim_loss: 17341198.8636; val_kl_reg_loss: 86635.4688; val_edge_recon_loss: 2757760.1875; val_gene_expr_recon_loss: 11812814.3750; val_masked_gp_l1_reg_loss: 89911.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97298.9922; val_chrom_access_recon_loss: 2565788.0312; val_global_loss: 17410209.2500; val_optim_loss: 17410209.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9189; val_auprc_score: 0.8890; val_best_acc_score: 0.8616; val_best_f1_score: 0.8707; train_kl_reg_loss: 103507.0881; train_edge_recon_loss: 2830522.0189; train_gene_expr_recon_loss: 10785861.3939; train_masked_gp_l1_reg_loss: 90317.3677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95428.1758; train_chrom_access_recon_loss: 2462589.3636; train_global_loss: 16368225.2879; train_optim_loss: 16368225.2879; val_kl_reg_loss: 38110.0962; val_edge_recon_loss: 2847493.9688; val_gene_expr_recon_loss: 10795241.1250; val_masked_gp_l1_reg_loss: 90348.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96551.5312; val_chrom_access_recon_loss: 2383322.3750; val_global_loss: 16251068.6250; val_optim_loss: 16251068.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9253; val_auprc_score: 0.8994; val_best_acc_score: 0.8718; val_best_f1_score: 0.8817; train_kl_reg_loss: 88785.8406; train_edge_recon_loss: 2750634.0455; train_gene_expr_recon_loss: 10728669.0152; train_masked_gp_l1_reg_loss: 89816.2579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96429.4613; train_chrom_access_recon_loss: 2416487.0833; train_global_loss: 16170821.7576; train_optim_loss: 16170821.7576; val_kl_reg_loss: 42889.2603; val_edge_recon_loss: 2777280.8438; val_gene_expr_recon_loss: 10846030.2500; val_masked_gp_l1_reg_loss: 89272.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96503.8047; val_chrom_access_recon_loss: 2393197.3125; val_global_loss: 16245173.7500; val_optim_loss: 16245173.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9284; val_auprc_score: 0.9014; val_best_acc_score: 0.8708; val_best_f1_score: 0.8811; train_kl_reg_loss: 78870.5188; train_edge_recon_loss: 2743783.2652; train_gene_expr_recon_loss: 10708604.5758; train_masked_gp_l1_reg_loss: 88587.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95807.4206; train_chrom_access_recon_loss: 2410464.2008; train_global_loss: 16126117.3636; train_optim_loss: 16126117.3636; val_kl_reg_loss: 51130.2363; val_edge_recon_loss: 2762719.5625; val_gene_expr_recon_loss: 10782793.1250; val_masked_gp_l1_reg_loss: 87799.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95378.2266; val_chrom_access_recon_loss: 2364510.4375; val_global_loss: 16144331.6250; val_optim_loss: 16144331.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9277; val_auprc_score: 0.8978; val_best_acc_score: 0.8729; val_best_f1_score: 0.8781; train_kl_reg_loss: 72502.0256; train_edge_recon_loss: 2728296.4280; train_gene_expr_recon_loss: 10675643.0455; train_masked_gp_l1_reg_loss: 87057.7464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95253.3010; train_chrom_access_recon_loss: 2404682.6970; train_global_loss: 16063435.2727; train_optim_loss: 16063435.2727; val_kl_reg_loss: 56616.4458; val_edge_recon_loss: 2752096.5312; val_gene_expr_recon_loss: 10799606.6250; val_masked_gp_l1_reg_loss: 86139.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94998.8438; val_chrom_access_recon_loss: 2375664.3125; val_global_loss: 16165123.0000; val_optim_loss: 16165123.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9327; val_auprc_score: 0.9134; val_best_acc_score: 0.8724; val_best_f1_score: 0.8815; train_kl_reg_loss: 70672.0148; train_edge_recon_loss: 2715150.0606; train_gene_expr_recon_loss: 10650569.7424; train_masked_gp_l1_reg_loss: 85290.5754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94553.0668; train_chrom_access_recon_loss: 2398220.3447; train_global_loss: 16014455.8182; train_optim_loss: 16014455.8182; val_kl_reg_loss: 53717.3862; val_edge_recon_loss: 2772635.2812; val_gene_expr_recon_loss: 10751039.7500; val_masked_gp_l1_reg_loss: 84402.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94347.4062; val_chrom_access_recon_loss: 2359269.4062; val_global_loss: 16115411.2500; val_optim_loss: 16115411.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9266; val_auprc_score: 0.8999; val_best_acc_score: 0.8673; val_best_f1_score: 0.8768; train_kl_reg_loss: 67645.6338; train_edge_recon_loss: 2728879.4242; train_gene_expr_recon_loss: 10640679.9545; train_masked_gp_l1_reg_loss: 83758.1439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93781.4097; train_chrom_access_recon_loss: 2398558.7841; train_global_loss: 16013303.2727; train_optim_loss: 16013303.2727; val_kl_reg_loss: 56260.2568; val_edge_recon_loss: 2788669.6250; val_gene_expr_recon_loss: 10702815.7500; val_masked_gp_l1_reg_loss: 83121.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93314.3438; val_chrom_access_recon_loss: 2368555.1875; val_global_loss: 16092735.7500; val_optim_loss: 16092735.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9387; val_auprc_score: 0.9142; val_best_acc_score: 0.8837; val_best_f1_score: 0.8893; train_kl_reg_loss: 66100.4514; train_edge_recon_loss: 2721447.5568; train_gene_expr_recon_loss: 10624325.0152; train_masked_gp_l1_reg_loss: 82614.5091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93156.8845; train_chrom_access_recon_loss: 2393817.0606; train_global_loss: 15981461.4242; train_optim_loss: 15981461.4242; val_kl_reg_loss: 58622.4160; val_edge_recon_loss: 2747112.3750; val_gene_expr_recon_loss: 10676322.5000; val_masked_gp_l1_reg_loss: 82008.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92853.9844; val_chrom_access_recon_loss: 2341046.0312; val_global_loss: 15997966.1250; val_optim_loss: 15997966.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9325; val_auprc_score: 0.9050; val_best_acc_score: 0.8821; val_best_f1_score: 0.8892; train_kl_reg_loss: 66190.4880; train_edge_recon_loss: 2715410.4205; train_gene_expr_recon_loss: 10604849.0455; train_masked_gp_l1_reg_loss: 81439.8554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92349.0926; train_chrom_access_recon_loss: 2391354.9091; train_global_loss: 15951593.7727; train_optim_loss: 15951593.7727; val_kl_reg_loss: 57161.7471; val_edge_recon_loss: 2729554.4375; val_gene_expr_recon_loss: 10665591.8750; val_masked_gp_l1_reg_loss: 80887.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92136.2188; val_chrom_access_recon_loss: 2350093.7188; val_global_loss: 15975424.8750; val_optim_loss: 15975424.8750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9392; val_auprc_score: 0.9186; val_best_acc_score: 0.8821; val_best_f1_score: 0.8899; train_kl_reg_loss: 66633.3023; train_edge_recon_loss: 2704572.6553; train_gene_expr_recon_loss: 10591771.3333; train_masked_gp_l1_reg_loss: 80413.8668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91969.0772; train_chrom_access_recon_loss: 2385849.7992; train_global_loss: 15921210.0000; train_optim_loss: 15921210.0000; val_kl_reg_loss: 58833.7217; val_edge_recon_loss: 2729534.0000; val_gene_expr_recon_loss: 10639101.5000; val_masked_gp_l1_reg_loss: 80018.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91516.6797; val_chrom_access_recon_loss: 2347630.9688; val_global_loss: 15946635.1250; val_optim_loss: 15946635.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9400; val_auprc_score: 0.9131; val_best_acc_score: 0.8874; val_best_f1_score: 0.8922; train_kl_reg_loss: 67102.6649; train_edge_recon_loss: 2700887.7386; train_gene_expr_recon_loss: 10579251.2576; train_masked_gp_l1_reg_loss: 79696.8795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91517.0676; train_chrom_access_recon_loss: 2385852.4394; train_global_loss: 15904308.0303; train_optim_loss: 15904308.0303; val_kl_reg_loss: 58059.0127; val_edge_recon_loss: 2738601.5312; val_gene_expr_recon_loss: 10618488.5000; val_masked_gp_l1_reg_loss: 79358.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91384.4062; val_chrom_access_recon_loss: 2347800.0625; val_global_loss: 15933691.2500; val_optim_loss: 15933691.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9400; val_auprc_score: 0.9171; val_best_acc_score: 0.8855; val_best_f1_score: 0.8896; train_kl_reg_loss: 68797.0894; train_edge_recon_loss: 2705243.7917; train_gene_expr_recon_loss: 10546693.9091; train_masked_gp_l1_reg_loss: 78936.0129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91016.0559; train_chrom_access_recon_loss: 2373531.7803; train_global_loss: 15864218.5909; train_optim_loss: 15864218.5909; val_kl_reg_loss: 57436.5688; val_edge_recon_loss: 2734745.0000; val_gene_expr_recon_loss: 10590420.5000; val_masked_gp_l1_reg_loss: 78701.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91613.4375; val_chrom_access_recon_loss: 2327650.4688; val_global_loss: 15880566.6250; val_optim_loss: 15880566.6250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9379; val_auprc_score: 0.9113; val_best_acc_score: 0.8802; val_best_f1_score: 0.8862; train_kl_reg_loss: 66134.2843; train_edge_recon_loss: 2712158.6818; train_gene_expr_recon_loss: 10544973.3485; train_masked_gp_l1_reg_loss: 78394.2017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91106.6458; train_chrom_access_recon_loss: 2373853.3409; train_global_loss: 15866620.5303; train_optim_loss: 15866620.5303; val_kl_reg_loss: 58703.3691; val_edge_recon_loss: 2749926.5000; val_gene_expr_recon_loss: 10635538.7500; val_masked_gp_l1_reg_loss: 78158.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91076.4609; val_chrom_access_recon_loss: 2350884.6562; val_global_loss: 15964288.2500; val_optim_loss: 15964288.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9447; val_auprc_score: 0.9288; val_best_acc_score: 0.8882; val_best_f1_score: 0.8923; train_kl_reg_loss: 65946.8762; train_edge_recon_loss: 2708288.6250; train_gene_expr_recon_loss: 10540410.5000; train_masked_gp_l1_reg_loss: 77942.7188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90915.8833; train_chrom_access_recon_loss: 2374288.6098; train_global_loss: 15857793.0909; train_optim_loss: 15857793.0909; val_kl_reg_loss: 58921.2593; val_edge_recon_loss: 2737877.6250; val_gene_expr_recon_loss: 10593061.8750; val_masked_gp_l1_reg_loss: 77670.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90698.1250; val_chrom_access_recon_loss: 2340601.9062; val_global_loss: 15898830.6250; val_optim_loss: 15898830.6250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9455; val_auprc_score: 0.9257; val_best_acc_score: 0.8907; val_best_f1_score: 0.8959; train_kl_reg_loss: 65827.4250; train_edge_recon_loss: 2696165.5341; train_gene_expr_recon_loss: 10511919.2727; train_masked_gp_l1_reg_loss: 77464.7502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90478.4081; train_chrom_access_recon_loss: 2369603.8182; train_global_loss: 15811459.2121; train_optim_loss: 15811459.2121; val_kl_reg_loss: 59217.1313; val_edge_recon_loss: 2726615.7188; val_gene_expr_recon_loss: 10491751.6250; val_masked_gp_l1_reg_loss: 77149.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90642.4141; val_chrom_access_recon_loss: 2329253.3125; val_global_loss: 15774629.6250; val_optim_loss: 15774629.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9488; val_auprc_score: 0.9265; val_best_acc_score: 0.8992; val_best_f1_score: 0.9047; train_kl_reg_loss: 64276.4558; train_edge_recon_loss: 2701831.3598; train_gene_expr_recon_loss: 10494581.7727; train_masked_gp_l1_reg_loss: 76939.6491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90384.2699; train_chrom_access_recon_loss: 2361564.5379; train_global_loss: 15789577.9848; train_optim_loss: 15789577.9848; val_kl_reg_loss: 60656.1592; val_edge_recon_loss: 2692064.5000; val_gene_expr_recon_loss: 10523234.5000; val_masked_gp_l1_reg_loss: 76715.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90442.3594; val_chrom_access_recon_loss: 2348470.5000; val_global_loss: 15791583.7500; val_optim_loss: 15791583.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9431; val_auprc_score: 0.9184; val_best_acc_score: 0.8947; val_best_f1_score: 0.9005; train_kl_reg_loss: 64400.2237; train_edge_recon_loss: 2695146.9621; train_gene_expr_recon_loss: 10464557.0455; train_masked_gp_l1_reg_loss: 76517.7067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90308.6972; train_chrom_access_recon_loss: 2355727.6326; train_global_loss: 15746658.2879; train_optim_loss: 15746658.2879; val_kl_reg_loss: 59635.6274; val_edge_recon_loss: 2706553.9375; val_gene_expr_recon_loss: 10516210.0000; val_masked_gp_l1_reg_loss: 76342.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90407.9766; val_chrom_access_recon_loss: 2318613.0938; val_global_loss: 15767762.5000; val_optim_loss: 15767762.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9429; val_auprc_score: 0.9212; val_best_acc_score: 0.8904; val_best_f1_score: 0.8948; train_kl_reg_loss: 62944.1710; train_edge_recon_loss: 2693779.2803; train_gene_expr_recon_loss: 10446961.3485; train_masked_gp_l1_reg_loss: 76158.4416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90263.9933; train_chrom_access_recon_loss: 2348394.5265; train_global_loss: 15718501.7576; train_optim_loss: 15718501.7576; val_kl_reg_loss: 57428.3804; val_edge_recon_loss: 2718253.3438; val_gene_expr_recon_loss: 10523347.5000; val_masked_gp_l1_reg_loss: 75920.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90188.7188; val_chrom_access_recon_loss: 2317382.7812; val_global_loss: 15782521.8750; val_optim_loss: 15782521.8750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9542; val_auprc_score: 0.9376; val_best_acc_score: 0.8968; val_best_f1_score: 0.9006; train_kl_reg_loss: 62148.3416; train_edge_recon_loss: 2702903.5871; train_gene_expr_recon_loss: 10439702.0909; train_masked_gp_l1_reg_loss: 75701.9583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90129.4669; train_chrom_access_recon_loss: 2346449.5303; train_global_loss: 15717034.8939; train_optim_loss: 15717034.8939; val_kl_reg_loss: 61167.2764; val_edge_recon_loss: 2718439.2188; val_gene_expr_recon_loss: 10576763.2500; val_masked_gp_l1_reg_loss: 75462.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90217.9062; val_chrom_access_recon_loss: 2331966.7500; val_global_loss: 15854016.5000; val_optim_loss: 15854016.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9495; val_auprc_score: 0.9305; val_best_acc_score: 0.8952; val_best_f1_score: 0.9008; train_kl_reg_loss: 61733.0964; train_edge_recon_loss: 2693292.6061; train_gene_expr_recon_loss: 10423894.7424; train_masked_gp_l1_reg_loss: 75239.0548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90077.7467; train_chrom_access_recon_loss: 2343370.7879; train_global_loss: 15687607.9697; train_optim_loss: 15687607.9697; val_kl_reg_loss: 61493.8613; val_edge_recon_loss: 2723770.0938; val_gene_expr_recon_loss: 10510387.7500; val_masked_gp_l1_reg_loss: 74992.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89578.9609; val_chrom_access_recon_loss: 2316536.8750; val_global_loss: 15776759.6250; val_optim_loss: 15776759.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9503; val_auprc_score: 0.9312; val_best_acc_score: 0.9011; val_best_f1_score: 0.9055; train_kl_reg_loss: 63172.3427; train_edge_recon_loss: 2690904.5833; train_gene_expr_recon_loss: 10405749.2879; train_masked_gp_l1_reg_loss: 74888.6495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89671.6600; train_chrom_access_recon_loss: 2340929.2462; train_global_loss: 15665315.7273; train_optim_loss: 15665315.7273; val_kl_reg_loss: 61008.1367; val_edge_recon_loss: 2698092.8750; val_gene_expr_recon_loss: 10561693.5000; val_masked_gp_l1_reg_loss: 74705.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89471.5156; val_chrom_access_recon_loss: 2340581.5312; val_global_loss: 15825553.2500; val_optim_loss: 15825553.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9514; val_auprc_score: 0.9290; val_best_acc_score: 0.9017; val_best_f1_score: 0.9061; train_kl_reg_loss: 62518.3535; train_edge_recon_loss: 2688419.9091; train_gene_expr_recon_loss: 10390111.3939; train_masked_gp_l1_reg_loss: 74127.4600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73587.8442; train_chrom_access_recon_loss: 2337696.8182; train_global_loss: 15626461.8030; train_optim_loss: 15626461.8030; val_kl_reg_loss: 60700.4087; val_edge_recon_loss: 2704665.0000; val_gene_expr_recon_loss: 10425397.2500; val_masked_gp_l1_reg_loss: 73894.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70010.5469; val_chrom_access_recon_loss: 2295942.4062; val_global_loss: 15630610.2500; val_optim_loss: 15630610.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9486; val_auprc_score: 0.9300; val_best_acc_score: 0.8968; val_best_f1_score: 0.9008; train_kl_reg_loss: 63384.9419; train_edge_recon_loss: 2682296.3106; train_gene_expr_recon_loss: 10401550.7576; train_masked_gp_l1_reg_loss: 73829.3311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69506.6542; train_chrom_access_recon_loss: 2340258.5341; train_global_loss: 15630826.5152; train_optim_loss: 15630826.5152; val_kl_reg_loss: 61364.3623; val_edge_recon_loss: 2730788.6562; val_gene_expr_recon_loss: 10517457.8750; val_masked_gp_l1_reg_loss: 73787.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69236.5547; val_chrom_access_recon_loss: 2318160.6250; val_global_loss: 15770795.3750; val_optim_loss: 15770795.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9546; val_auprc_score: 0.9363; val_best_acc_score: 0.9006; val_best_f1_score: 0.9052; train_kl_reg_loss: 64144.7315; train_edge_recon_loss: 2684952.0227; train_gene_expr_recon_loss: 10391152.5000; train_masked_gp_l1_reg_loss: 73763.3580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69045.6055; train_chrom_access_recon_loss: 2338616.8371; train_global_loss: 15621675.0000; train_optim_loss: 15621675.0000; val_kl_reg_loss: 61577.2515; val_edge_recon_loss: 2692042.7812; val_gene_expr_recon_loss: 10432675.7500; val_masked_gp_l1_reg_loss: 73720.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68769.6406; val_chrom_access_recon_loss: 2315502.0938; val_global_loss: 15644288.0000; val_optim_loss: 15644288.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9502; val_auprc_score: 0.9339; val_best_acc_score: 0.8966; val_best_f1_score: 0.8998; train_kl_reg_loss: 64185.2162; train_edge_recon_loss: 2689546.7652; train_gene_expr_recon_loss: 10388208.8333; train_masked_gp_l1_reg_loss: 73694.4470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68674.0004; train_chrom_access_recon_loss: 2335447.9432; train_global_loss: 15619757.1667; train_optim_loss: 15619757.1667; val_kl_reg_loss: 61475.4106; val_edge_recon_loss: 2734036.7500; val_gene_expr_recon_loss: 10481332.6250; val_masked_gp_l1_reg_loss: 73667.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68566.7188; val_chrom_access_recon_loss: 2338693.9688; val_global_loss: 15757773.8750; val_optim_loss: 15757773.8750
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9495; val_auprc_score: 0.9294; val_best_acc_score: 0.8955; val_best_f1_score: 0.8999; train_kl_reg_loss: 64084.9390; train_edge_recon_loss: 2688179.8788; train_gene_expr_recon_loss: 10387216.8939; train_masked_gp_l1_reg_loss: 73645.7306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68415.8369; train_chrom_access_recon_loss: 2337788.8712; train_global_loss: 15619332.1667; train_optim_loss: 15619332.1667; val_kl_reg_loss: 62355.6440; val_edge_recon_loss: 2715422.5000; val_gene_expr_recon_loss: 10492344.1250; val_masked_gp_l1_reg_loss: 73628.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68401.0938; val_chrom_access_recon_loss: 2313335.4688; val_global_loss: 15725486.6250; val_optim_loss: 15725486.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9548; val_auprc_score: 0.9369; val_best_acc_score: 0.9062; val_best_f1_score: 0.9093; train_kl_reg_loss: 63784.4982; train_edge_recon_loss: 2687671.5379; train_gene_expr_recon_loss: 10391705.1818; train_masked_gp_l1_reg_loss: 73568.7169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66692.9287; train_chrom_access_recon_loss: 2339196.8864; train_global_loss: 15622619.6667; train_optim_loss: 15622619.6667; val_kl_reg_loss: 61414.4434; val_edge_recon_loss: 2699469.8125; val_gene_expr_recon_loss: 10410804.5000; val_masked_gp_l1_reg_loss: 73543.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66298.7500; val_chrom_access_recon_loss: 2298548.5000; val_global_loss: 15610079.2500; val_optim_loss: 15610079.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9454; val_auprc_score: 0.9278; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 63930.3893; train_edge_recon_loss: 2686905.1894; train_gene_expr_recon_loss: 10385181.8788; train_masked_gp_l1_reg_loss: 73535.0948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66226.7798; train_chrom_access_recon_loss: 2338027.7879; train_global_loss: 15613807.2121; train_optim_loss: 15613807.2121; val_kl_reg_loss: 61813.2925; val_edge_recon_loss: 2754149.6250; val_gene_expr_recon_loss: 10366781.8750; val_masked_gp_l1_reg_loss: 73528.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66169.6094; val_chrom_access_recon_loss: 2302537.9375; val_global_loss: 15624980.5000; val_optim_loss: 15624980.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9491; val_auprc_score: 0.9266; val_best_acc_score: 0.8974; val_best_f1_score: 0.9029; train_kl_reg_loss: 64007.0212; train_edge_recon_loss: 2676399.8598; train_gene_expr_recon_loss: 10387955.4697; train_masked_gp_l1_reg_loss: 73523.8925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66126.9020; train_chrom_access_recon_loss: 2337101.6970; train_global_loss: 15605114.8182; train_optim_loss: 15605114.8182; val_kl_reg_loss: 62383.3501; val_edge_recon_loss: 2731467.8125; val_gene_expr_recon_loss: 10438305.2500; val_masked_gp_l1_reg_loss: 73519.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66085.1562; val_chrom_access_recon_loss: 2310143.7188; val_global_loss: 15681904.1250; val_optim_loss: 15681904.1250
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9559; val_auprc_score: 0.9421; val_best_acc_score: 0.9033; val_best_f1_score: 0.9067; train_kl_reg_loss: 64051.2749; train_edge_recon_loss: 2688706.5985; train_gene_expr_recon_loss: 10385528.8636; train_masked_gp_l1_reg_loss: 73516.1721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66063.5290; train_chrom_access_recon_loss: 2337683.6477; train_global_loss: 15615550.0000; train_optim_loss: 15615550.0000; val_kl_reg_loss: 62300.4624; val_edge_recon_loss: 2707143.5000; val_gene_expr_recon_loss: 10457885.8750; val_masked_gp_l1_reg_loss: 73512.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66028.4141; val_chrom_access_recon_loss: 2296123.7188; val_global_loss: 15662994.6250; val_optim_loss: 15662994.6250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9475; val_auprc_score: 0.9261; val_best_acc_score: 0.8974; val_best_f1_score: 0.9021; train_kl_reg_loss: 64211.0910; train_edge_recon_loss: 2689692.2462; train_gene_expr_recon_loss: 10375215.8333; train_masked_gp_l1_reg_loss: 73510.0183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66002.1518; train_chrom_access_recon_loss: 2336286.7765; train_global_loss: 15604918.1515; train_optim_loss: 15604918.1515; val_kl_reg_loss: 62687.7075; val_edge_recon_loss: 2704032.6875; val_gene_expr_recon_loss: 10525494.5000; val_masked_gp_l1_reg_loss: 73506.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65985.2734; val_chrom_access_recon_loss: 2319425.6250; val_global_loss: 15751131.3750; val_optim_loss: 15751131.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9489; val_auprc_score: 0.9355; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 64357.6478; train_edge_recon_loss: 2683831.8712; train_gene_expr_recon_loss: 10389808.3939; train_masked_gp_l1_reg_loss: 73500.3964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65813.6283; train_chrom_access_recon_loss: 2339707.6705; train_global_loss: 15617019.6515; train_optim_loss: 15617019.6515; val_kl_reg_loss: 62378.3984; val_edge_recon_loss: 2747587.4375; val_gene_expr_recon_loss: 10467673.1250; val_masked_gp_l1_reg_loss: 73498.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65776.5547; val_chrom_access_recon_loss: 2317224.9375; val_global_loss: 15734139.1250; val_optim_loss: 15734139.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9419; val_auprc_score: 0.9163; val_best_acc_score: 0.8872; val_best_f1_score: 0.8922; train_kl_reg_loss: 64327.1380; train_edge_recon_loss: 2704855.6098; train_gene_expr_recon_loss: 10384135.8636; train_masked_gp_l1_reg_loss: 73497.4903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65769.5647; train_chrom_access_recon_loss: 2337507.0303; train_global_loss: 15630092.8030; train_optim_loss: 15630092.8030; val_kl_reg_loss: 62616.3179; val_edge_recon_loss: 2754628.2812; val_gene_expr_recon_loss: 10518222.7500; val_masked_gp_l1_reg_loss: 73496.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65764.1562; val_chrom_access_recon_loss: 2325271.8438; val_global_loss: 15800000.1250; val_optim_loss: 15800000.1250
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9505; val_auprc_score: 0.9283; val_best_acc_score: 0.9011; val_best_f1_score: 0.9048; train_kl_reg_loss: 64368.4791; train_edge_recon_loss: 2694508.3788; train_gene_expr_recon_loss: 10380265.5455; train_masked_gp_l1_reg_loss: 73496.2911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65759.6052; train_chrom_access_recon_loss: 2336799.9432; train_global_loss: 15615198.2727; train_optim_loss: 15615198.2727; val_kl_reg_loss: 63137.0117; val_edge_recon_loss: 2715308.5625; val_gene_expr_recon_loss: 10500392.3750; val_masked_gp_l1_reg_loss: 73495.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65755.2344; val_chrom_access_recon_loss: 2355390.5000; val_global_loss: 15773479.2500; val_optim_loss: 15773479.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9493; val_auprc_score: 0.9309; val_best_acc_score: 0.9001; val_best_f1_score: 0.9039; train_kl_reg_loss: 64293.3285; train_edge_recon_loss: 2687570.7727; train_gene_expr_recon_loss: 10374109.2727; train_masked_gp_l1_reg_loss: 73495.4070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65751.7461; train_chrom_access_recon_loss: 2335220.1742; train_global_loss: 15600440.7273; train_optim_loss: 15600440.7273; val_kl_reg_loss: 62900.7344; val_edge_recon_loss: 2703030.3438; val_gene_expr_recon_loss: 10527323.3750; val_masked_gp_l1_reg_loss: 73494.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65748.0000; val_chrom_access_recon_loss: 2327928.3750; val_global_loss: 15760426.0000; val_optim_loss: 15760426.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 14 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9510
val AUPRC score: 0.9362
val best accuracy score: 0.8971
val best F1 score: 0.9014
val target rna MSE score: 2.0159
val source rna MSE score: 0.7711
val target atac MSE score: 0.4684
val source atac MSE score: 0.1962
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
