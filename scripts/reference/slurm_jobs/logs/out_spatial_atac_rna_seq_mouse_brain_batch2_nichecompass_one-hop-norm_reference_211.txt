[True]
Run timestamp: 06092023_234136_211.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_211']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7803; val_auprc_score: 0.7961; val_best_acc_score: 0.5542; val_best_f1_score: 0.6886; train_kl_reg_loss: 82293.1445; train_edge_recon_loss: 3608906.3550; train_gene_expr_recon_loss: 17117754.4656; train_masked_gp_l1_reg_loss: 49832.2415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5746207.6329; train_chrom_access_recon_loss: 37076738.6565; train_global_loss: 63681732.3664; train_optim_loss: 63681732.3664; val_kl_reg_loss: 134960.1010; val_edge_recon_loss: 4061973.6833; val_gene_expr_recon_loss: 15840652.4000; val_masked_gp_l1_reg_loss: 44937.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 514324.1562; val_chrom_access_recon_loss: 35633557.6000; val_global_loss: 56230405.6000; val_optim_loss: 56230405.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8547; val_auprc_score: 0.8527; val_best_acc_score: 0.7662; val_best_f1_score: 0.7606; train_kl_reg_loss: 123013.7276; train_edge_recon_loss: 3536979.3855; train_gene_expr_recon_loss: 15569082.3511; train_masked_gp_l1_reg_loss: 42196.8955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 312556.6162; train_chrom_access_recon_loss: 35520094.7176; train_global_loss: 55103923.6031; train_optim_loss: 55103923.6031; val_kl_reg_loss: 112961.7563; val_edge_recon_loss: 4012811.6500; val_gene_expr_recon_loss: 15471246.0000; val_masked_gp_l1_reg_loss: 42166.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225264.5938; val_chrom_access_recon_loss: 35093186.0000; val_global_loss: 54957635.7333; val_optim_loss: 54957635.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8612; val_auprc_score: 0.8562; val_best_acc_score: 0.7579; val_best_f1_score: 0.7910; train_kl_reg_loss: 102689.1930; train_edge_recon_loss: 3333476.6107; train_gene_expr_recon_loss: 15332040.4122; train_masked_gp_l1_reg_loss: 43873.5543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198964.4969; train_chrom_access_recon_loss: 35084438.5954; train_global_loss: 54095483.1145; train_optim_loss: 54095483.1145; val_kl_reg_loss: 134596.2563; val_edge_recon_loss: 3012625.3000; val_gene_expr_recon_loss: 15260018.0000; val_masked_gp_l1_reg_loss: 45910.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181614.2031; val_chrom_access_recon_loss: 34785714.8000; val_global_loss: 53420478.1333; val_optim_loss: 53420478.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8780; val_auprc_score: 0.8638; val_best_acc_score: 0.7914; val_best_f1_score: 0.8071; train_kl_reg_loss: 131843.5561; train_edge_recon_loss: 2990406.6431; train_gene_expr_recon_loss: 15154511.3817; train_masked_gp_l1_reg_loss: 47336.9993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170743.1633; train_chrom_access_recon_loss: 34717695.0534; train_global_loss: 53212537.0687; train_optim_loss: 53212537.0687; val_kl_reg_loss: 125701.2161; val_edge_recon_loss: 2949259.4000; val_gene_expr_recon_loss: 15131738.0667; val_masked_gp_l1_reg_loss: 48746.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162598.9375; val_chrom_access_recon_loss: 34440649.7333; val_global_loss: 52858692.8000; val_optim_loss: 52858692.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8870; val_auprc_score: 0.8722; val_best_acc_score: 0.7961; val_best_f1_score: 0.8208; train_kl_reg_loss: 125243.6740; train_edge_recon_loss: 2932013.2061; train_gene_expr_recon_loss: 15010121.4046; train_masked_gp_l1_reg_loss: 50173.7828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156929.8040; train_chrom_access_recon_loss: 34376105.7405; train_global_loss: 52650587.6641; train_optim_loss: 52650587.6641; val_kl_reg_loss: 121875.3016; val_edge_recon_loss: 2919640.7833; val_gene_expr_recon_loss: 14907896.6000; val_masked_gp_l1_reg_loss: 51468.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150770.4219; val_chrom_access_recon_loss: 33962588.9333; val_global_loss: 52114239.4667; val_optim_loss: 52114239.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9108; val_auprc_score: 0.8960; val_best_acc_score: 0.8306; val_best_f1_score: 0.8447; train_kl_reg_loss: 121939.3077; train_edge_recon_loss: 2884799.5763; train_gene_expr_recon_loss: 14872841.6031; train_masked_gp_l1_reg_loss: 52535.6489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147272.4383; train_chrom_access_recon_loss: 34093843.3282; train_global_loss: 52173231.7863; train_optim_loss: 52173231.7863; val_kl_reg_loss: 122806.8349; val_edge_recon_loss: 2884756.1000; val_gene_expr_recon_loss: 14826273.2000; val_masked_gp_l1_reg_loss: 53550.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145154.4375; val_chrom_access_recon_loss: 33943465.8667; val_global_loss: 51976006.6667; val_optim_loss: 51976006.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9326; val_auprc_score: 0.9144; val_best_acc_score: 0.8682; val_best_f1_score: 0.8753; train_kl_reg_loss: 122576.7456; train_edge_recon_loss: 2843329.2271; train_gene_expr_recon_loss: 14760563.1756; train_masked_gp_l1_reg_loss: 54610.4034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142830.9340; train_chrom_access_recon_loss: 33820640.1527; train_global_loss: 51744550.5038; train_optim_loss: 51744550.5038; val_kl_reg_loss: 118656.7182; val_edge_recon_loss: 2823709.4000; val_gene_expr_recon_loss: 14722349.5333; val_masked_gp_l1_reg_loss: 55916.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141176.1094; val_chrom_access_recon_loss: 33676044.9333; val_global_loss: 51537852.5333; val_optim_loss: 51537852.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9389; val_auprc_score: 0.9273; val_best_acc_score: 0.8707; val_best_f1_score: 0.8785; train_kl_reg_loss: 120947.4865; train_edge_recon_loss: 2809846.7443; train_gene_expr_recon_loss: 14662205.5954; train_masked_gp_l1_reg_loss: 56736.4711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139613.0502; train_chrom_access_recon_loss: 33588329.1908; train_global_loss: 51377678.9008; train_optim_loss: 51377678.9008; val_kl_reg_loss: 116646.5771; val_edge_recon_loss: 2816872.3000; val_gene_expr_recon_loss: 14716061.5333; val_masked_gp_l1_reg_loss: 57611.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138174.3750; val_chrom_access_recon_loss: 33498920.2667; val_global_loss: 51344286.1333; val_optim_loss: 51344286.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9379; val_auprc_score: 0.9206; val_best_acc_score: 0.8732; val_best_f1_score: 0.8801; train_kl_reg_loss: 120047.0016; train_edge_recon_loss: 2782653.2920; train_gene_expr_recon_loss: 14585909.8702; train_masked_gp_l1_reg_loss: 58414.4630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137116.9536; train_chrom_access_recon_loss: 33398552.1374; train_global_loss: 51082693.4656; train_optim_loss: 51082693.4656; val_kl_reg_loss: 114806.0010; val_edge_recon_loss: 2811344.0000; val_gene_expr_recon_loss: 14562157.7333; val_masked_gp_l1_reg_loss: 59350.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136409.0625; val_chrom_access_recon_loss: 33139147.3333; val_global_loss: 50823214.4000; val_optim_loss: 50823214.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9461; val_auprc_score: 0.9320; val_best_acc_score: 0.8878; val_best_f1_score: 0.8938; train_kl_reg_loss: 117354.7581; train_edge_recon_loss: 2769378.5324; train_gene_expr_recon_loss: 14485783.8092; train_masked_gp_l1_reg_loss: 60148.6035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135339.4414; train_chrom_access_recon_loss: 33149406.7176; train_global_loss: 50717412.0916; train_optim_loss: 50717412.0916; val_kl_reg_loss: 116959.6880; val_edge_recon_loss: 2765116.4000; val_gene_expr_recon_loss: 14540820.8667; val_masked_gp_l1_reg_loss: 61021.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134071.6875; val_chrom_access_recon_loss: 33066786.9333; val_global_loss: 50684778.1333; val_optim_loss: 50684778.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9547; val_auprc_score: 0.9453; val_best_acc_score: 0.8934; val_best_f1_score: 0.8978; train_kl_reg_loss: 114524.5249; train_edge_recon_loss: 2769246.9656; train_gene_expr_recon_loss: 14419898.0992; train_masked_gp_l1_reg_loss: 61711.1887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133815.8422; train_chrom_access_recon_loss: 32956078.8244; train_global_loss: 50455275.5115; train_optim_loss: 50455275.5115; val_kl_reg_loss: 114633.5964; val_edge_recon_loss: 2755945.4167; val_gene_expr_recon_loss: 14401294.9333; val_masked_gp_l1_reg_loss: 62370.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133160.7656; val_chrom_access_recon_loss: 32831132.0000; val_global_loss: 50298536.8000; val_optim_loss: 50298536.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9564; val_auprc_score: 0.9433; val_best_acc_score: 0.8975; val_best_f1_score: 0.9020; train_kl_reg_loss: 112999.0440; train_edge_recon_loss: 2753246.0153; train_gene_expr_recon_loss: 14351678.6031; train_masked_gp_l1_reg_loss: 63074.4420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132778.1320; train_chrom_access_recon_loss: 32765428.0763; train_global_loss: 50179204.3053; train_optim_loss: 50179204.3053; val_kl_reg_loss: 112109.9219; val_edge_recon_loss: 2750343.4333; val_gene_expr_recon_loss: 14365114.8667; val_masked_gp_l1_reg_loss: 63678.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132183.8438; val_chrom_access_recon_loss: 32671479.7333; val_global_loss: 50094910.1333; val_optim_loss: 50094910.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9574; val_auprc_score: 0.9445; val_best_acc_score: 0.9054; val_best_f1_score: 0.9101; train_kl_reg_loss: 111134.4520; train_edge_recon_loss: 2753188.2328; train_gene_expr_recon_loss: 14300533.4504; train_masked_gp_l1_reg_loss: 64385.5709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131870.6576; train_chrom_access_recon_loss: 32574569.8015; train_global_loss: 49935682.0153; train_optim_loss: 49935682.0153; val_kl_reg_loss: 108048.5693; val_edge_recon_loss: 2739918.7833; val_gene_expr_recon_loss: 14332466.0000; val_masked_gp_l1_reg_loss: 65055.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131566.2812; val_chrom_access_recon_loss: 32520833.8667; val_global_loss: 49897889.3333; val_optim_loss: 49897889.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9562; val_auprc_score: 0.9430; val_best_acc_score: 0.9015; val_best_f1_score: 0.9041; train_kl_reg_loss: 109017.8495; train_edge_recon_loss: 2738090.8168; train_gene_expr_recon_loss: 14248231.7634; train_masked_gp_l1_reg_loss: 65588.5070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131344.9828; train_chrom_access_recon_loss: 32425253.5420; train_global_loss: 49717527.6947; train_optim_loss: 49717527.6947; val_kl_reg_loss: 108850.4786; val_edge_recon_loss: 2740756.9500; val_gene_expr_recon_loss: 14291209.2667; val_masked_gp_l1_reg_loss: 66030.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131081.1719; val_chrom_access_recon_loss: 32426558.2667; val_global_loss: 49764487.2000; val_optim_loss: 49764487.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9620; val_auprc_score: 0.9510; val_best_acc_score: 0.9049; val_best_f1_score: 0.9101; train_kl_reg_loss: 107823.4510; train_edge_recon_loss: 2733885.9752; train_gene_expr_recon_loss: 14207555.2214; train_masked_gp_l1_reg_loss: 66730.9516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130753.9861; train_chrom_access_recon_loss: 32270692.7939; train_global_loss: 49517442.3511; train_optim_loss: 49517442.3511; val_kl_reg_loss: 108453.3089; val_edge_recon_loss: 2742736.1000; val_gene_expr_recon_loss: 14227079.1333; val_masked_gp_l1_reg_loss: 67221.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131150.2344; val_chrom_access_recon_loss: 32158767.0667; val_global_loss: 49435407.2000; val_optim_loss: 49435407.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9591; val_auprc_score: 0.9458; val_best_acc_score: 0.9078; val_best_f1_score: 0.9119; train_kl_reg_loss: 106598.8410; train_edge_recon_loss: 2726028.9943; train_gene_expr_recon_loss: 14154297.0153; train_masked_gp_l1_reg_loss: 67784.3866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130362.7329; train_chrom_access_recon_loss: 32085007.3740; train_global_loss: 49270079.4198; train_optim_loss: 49270079.4198; val_kl_reg_loss: 105404.6302; val_edge_recon_loss: 2753698.0333; val_gene_expr_recon_loss: 14142009.7333; val_masked_gp_l1_reg_loss: 68356.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129972.5781; val_chrom_access_recon_loss: 32024950.1333; val_global_loss: 49224390.9333; val_optim_loss: 49224390.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9664; val_auprc_score: 0.9569; val_best_acc_score: 0.9105; val_best_f1_score: 0.9148; train_kl_reg_loss: 104586.0196; train_edge_recon_loss: 2729630.0821; train_gene_expr_recon_loss: 14109917.2443; train_masked_gp_l1_reg_loss: 68727.3700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129918.6189; train_chrom_access_recon_loss: 31908927.6641; train_global_loss: 49051706.8702; train_optim_loss: 49051706.8702; val_kl_reg_loss: 104947.2656; val_edge_recon_loss: 2751069.3833; val_gene_expr_recon_loss: 14200945.5333; val_masked_gp_l1_reg_loss: 69177.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130313.7188; val_chrom_access_recon_loss: 32132434.1333; val_global_loss: 49388888.2667; val_optim_loss: 49388888.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9716; val_auprc_score: 0.9627; val_best_acc_score: 0.9262; val_best_f1_score: 0.9291; train_kl_reg_loss: 103415.0588; train_edge_recon_loss: 2722570.0439; train_gene_expr_recon_loss: 14067590.5878; train_masked_gp_l1_reg_loss: 69747.8256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129878.9439; train_chrom_access_recon_loss: 31752837.8321; train_global_loss: 48846040.3053; train_optim_loss: 48846040.3053; val_kl_reg_loss: 103978.3031; val_edge_recon_loss: 2717041.9500; val_gene_expr_recon_loss: 14125475.4000; val_masked_gp_l1_reg_loss: 70010.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129917.2188; val_chrom_access_recon_loss: 31858842.8000; val_global_loss: 49005266.1333; val_optim_loss: 49005266.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9712; val_auprc_score: 0.9638; val_best_acc_score: 0.9208; val_best_f1_score: 0.9231; train_kl_reg_loss: 103417.8992; train_edge_recon_loss: 2712552.5401; train_gene_expr_recon_loss: 14038335.4656; train_masked_gp_l1_reg_loss: 70512.8924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129554.9186; train_chrom_access_recon_loss: 31605815.6183; train_global_loss: 48660189.1603; train_optim_loss: 48660189.1603; val_kl_reg_loss: 104098.3573; val_edge_recon_loss: 2755637.7500; val_gene_expr_recon_loss: 14039148.3333; val_masked_gp_l1_reg_loss: 71032.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129640.5625; val_chrom_access_recon_loss: 31651269.2000; val_global_loss: 48750825.8667; val_optim_loss: 48750825.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9734; val_auprc_score: 0.9644; val_best_acc_score: 0.9258; val_best_f1_score: 0.9276; train_kl_reg_loss: 101951.6030; train_edge_recon_loss: 2711895.9084; train_gene_expr_recon_loss: 14004093.9695; train_masked_gp_l1_reg_loss: 71340.1381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129459.7210; train_chrom_access_recon_loss: 31496824.7786; train_global_loss: 48515566.2595; train_optim_loss: 48515566.2595; val_kl_reg_loss: 99830.4344; val_edge_recon_loss: 2702647.8500; val_gene_expr_recon_loss: 14038537.6667; val_masked_gp_l1_reg_loss: 71599.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129932.4531; val_chrom_access_recon_loss: 31623201.8667; val_global_loss: 48665750.1333; val_optim_loss: 48665750.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9765; val_auprc_score: 0.9674; val_best_acc_score: 0.9325; val_best_f1_score: 0.9350; train_kl_reg_loss: 100852.3897; train_edge_recon_loss: 2718360.1221; train_gene_expr_recon_loss: 13979082.7099; train_masked_gp_l1_reg_loss: 72247.5055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129773.0468; train_chrom_access_recon_loss: 31388843.4656; train_global_loss: 48389159.0534; train_optim_loss: 48389159.0534; val_kl_reg_loss: 101344.3036; val_edge_recon_loss: 2715009.8500; val_gene_expr_recon_loss: 14009357.8000; val_masked_gp_l1_reg_loss: 72687.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129768.5859; val_chrom_access_recon_loss: 31568671.0667; val_global_loss: 48596838.9333; val_optim_loss: 48596838.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9771; val_auprc_score: 0.9710; val_best_acc_score: 0.9333; val_best_f1_score: 0.9359; train_kl_reg_loss: 100479.1607; train_edge_recon_loss: 2711949.8588; train_gene_expr_recon_loss: 13953815.4733; train_masked_gp_l1_reg_loss: 72954.4845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129480.4322; train_chrom_access_recon_loss: 31286038.5649; train_global_loss: 48254718.0153; train_optim_loss: 48254718.0153; val_kl_reg_loss: 101170.8984; val_edge_recon_loss: 2729816.7833; val_gene_expr_recon_loss: 14022191.6667; val_masked_gp_l1_reg_loss: 73264.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129462.0391; val_chrom_access_recon_loss: 31504026.1333; val_global_loss: 48559932.0000; val_optim_loss: 48559932.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9770; val_auprc_score: 0.9712; val_best_acc_score: 0.9312; val_best_f1_score: 0.9337; train_kl_reg_loss: 100493.1147; train_edge_recon_loss: 2708823.8531; train_gene_expr_recon_loss: 13924564.7786; train_masked_gp_l1_reg_loss: 73512.3036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129299.3903; train_chrom_access_recon_loss: 31153786.3511; train_global_loss: 48090479.9084; train_optim_loss: 48090479.9084; val_kl_reg_loss: 100978.4083; val_edge_recon_loss: 2719497.6333; val_gene_expr_recon_loss: 13937443.4667; val_masked_gp_l1_reg_loss: 73854.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129111.9375; val_chrom_access_recon_loss: 31274742.6667; val_global_loss: 48235628.0000; val_optim_loss: 48235628.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9801; val_auprc_score: 0.9752; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 100301.9619; train_edge_recon_loss: 2701098.0363; train_gene_expr_recon_loss: 13902956.5344; train_masked_gp_l1_reg_loss: 74141.3132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129279.5793; train_chrom_access_recon_loss: 31078122.3817; train_global_loss: 47985899.6336; train_optim_loss: 47985899.6336; val_kl_reg_loss: 100610.9573; val_edge_recon_loss: 2713105.7500; val_gene_expr_recon_loss: 13964775.4000; val_masked_gp_l1_reg_loss: 74505.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128814.8516; val_chrom_access_recon_loss: 31193410.5333; val_global_loss: 48175223.2000; val_optim_loss: 48175223.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9765; val_auprc_score: 0.9702; val_best_acc_score: 0.9349; val_best_f1_score: 0.9371; train_kl_reg_loss: 100150.7636; train_edge_recon_loss: 2707787.3874; train_gene_expr_recon_loss: 13882547.1298; train_masked_gp_l1_reg_loss: 75059.8308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129944.8887; train_chrom_access_recon_loss: 30982407.6336; train_global_loss: 47877897.5573; train_optim_loss: 47877897.5573; val_kl_reg_loss: 101119.3505; val_edge_recon_loss: 2715703.1500; val_gene_expr_recon_loss: 13926615.9333; val_masked_gp_l1_reg_loss: 74958.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129567.5938; val_chrom_access_recon_loss: 31138251.0667; val_global_loss: 48086216.0000; val_optim_loss: 48086216.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9834; val_auprc_score: 0.9794; val_best_acc_score: 0.9387; val_best_f1_score: 0.9401; train_kl_reg_loss: 110374.6222; train_edge_recon_loss: 2743002.6031; train_gene_expr_recon_loss: 13301757.4351; train_masked_gp_l1_reg_loss: 71347.2758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124566.2893; train_chrom_access_recon_loss: 30288675.5267; train_global_loss: 46639723.6336; train_optim_loss: 46639723.6336; val_kl_reg_loss: 67271.2401; val_edge_recon_loss: 2723212.1333; val_gene_expr_recon_loss: 13333055.8667; val_masked_gp_l1_reg_loss: 69711.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123842.3203; val_chrom_access_recon_loss: 30118151.0667; val_global_loss: 46435243.4667; val_optim_loss: 46435243.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9803; val_auprc_score: 0.9748; val_best_acc_score: 0.9406; val_best_f1_score: 0.9420; train_kl_reg_loss: 103937.3578; train_edge_recon_loss: 2721072.4198; train_gene_expr_recon_loss: 13262461.9160; train_masked_gp_l1_reg_loss: 69028.2956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122866.9509; train_chrom_access_recon_loss: 30150307.1756; train_global_loss: 46429674.0763; train_optim_loss: 46429674.0763; val_kl_reg_loss: 71561.2005; val_edge_recon_loss: 2711130.3500; val_gene_expr_recon_loss: 13289615.2000; val_masked_gp_l1_reg_loss: 68467.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122350.3516; val_chrom_access_recon_loss: 30058873.2000; val_global_loss: 46321998.1333; val_optim_loss: 46321998.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9827; val_auprc_score: 0.9770; val_best_acc_score: 0.9410; val_best_f1_score: 0.9427; train_kl_reg_loss: 97913.8294; train_edge_recon_loss: 2701518.0725; train_gene_expr_recon_loss: 13244041.3664; train_masked_gp_l1_reg_loss: 68027.0224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121853.4678; train_chrom_access_recon_loss: 30110120.1679; train_global_loss: 46343474.0153; train_optim_loss: 46343474.0153; val_kl_reg_loss: 73846.5641; val_edge_recon_loss: 2715639.4333; val_gene_expr_recon_loss: 13213022.6000; val_masked_gp_l1_reg_loss: 67679.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121688.7812; val_chrom_access_recon_loss: 29863455.8667; val_global_loss: 46055332.2667; val_optim_loss: 46055332.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9799; val_auprc_score: 0.9701; val_best_acc_score: 0.9410; val_best_f1_score: 0.9430; train_kl_reg_loss: 93855.5605; train_edge_recon_loss: 2696773.9485; train_gene_expr_recon_loss: 13219063.8855; train_masked_gp_l1_reg_loss: 67437.2783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121110.4008; train_chrom_access_recon_loss: 30003088.0763; train_global_loss: 46201329.1298; train_optim_loss: 46201329.1298; val_kl_reg_loss: 76513.9719; val_edge_recon_loss: 2709846.6500; val_gene_expr_recon_loss: 13254423.0667; val_masked_gp_l1_reg_loss: 67131.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121052.4609; val_chrom_access_recon_loss: 29910908.4000; val_global_loss: 46139875.4667; val_optim_loss: 46139875.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9832; val_auprc_score: 0.9785; val_best_acc_score: 0.9421; val_best_f1_score: 0.9433; train_kl_reg_loss: 91066.2968; train_edge_recon_loss: 2694729.6088; train_gene_expr_recon_loss: 13196964.2672; train_masked_gp_l1_reg_loss: 66957.1084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120399.8073; train_chrom_access_recon_loss: 29961409.1450; train_global_loss: 46131526.1679; train_optim_loss: 46131526.1679; val_kl_reg_loss: 76054.6667; val_edge_recon_loss: 2709043.3333; val_gene_expr_recon_loss: 13229804.0667; val_masked_gp_l1_reg_loss: 66746.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119977.3984; val_chrom_access_recon_loss: 29807103.8667; val_global_loss: 46008730.1333; val_optim_loss: 46008730.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9825; val_auprc_score: 0.9790; val_best_acc_score: 0.9398; val_best_f1_score: 0.9418; train_kl_reg_loss: 89035.2099; train_edge_recon_loss: 2692305.3111; train_gene_expr_recon_loss: 13160699.7023; train_masked_gp_l1_reg_loss: 66594.8451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119834.0503; train_chrom_access_recon_loss: 29839217.5878; train_global_loss: 45967686.5649; train_optim_loss: 45967686.5649; val_kl_reg_loss: 76098.4464; val_edge_recon_loss: 2704937.7167; val_gene_expr_recon_loss: 13238216.5333; val_masked_gp_l1_reg_loss: 66454.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119197.5234; val_chrom_access_recon_loss: 29774103.2000; val_global_loss: 45979006.9333; val_optim_loss: 45979006.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9842; val_auprc_score: 0.9796; val_best_acc_score: 0.9448; val_best_f1_score: 0.9465; train_kl_reg_loss: 88624.4714; train_edge_recon_loss: 2684451.2634; train_gene_expr_recon_loss: 13131979.3282; train_masked_gp_l1_reg_loss: 66360.2112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119558.7042; train_chrom_access_recon_loss: 29699922.3359; train_global_loss: 45790896.3664; train_optim_loss: 45790896.3664; val_kl_reg_loss: 76674.9000; val_edge_recon_loss: 2688375.6500; val_gene_expr_recon_loss: 13197568.6000; val_masked_gp_l1_reg_loss: 66164.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119214.6641; val_chrom_access_recon_loss: 29608378.6667; val_global_loss: 45756376.8000; val_optim_loss: 45756376.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9830; val_auprc_score: 0.9786; val_best_acc_score: 0.9427; val_best_f1_score: 0.9439; train_kl_reg_loss: 88204.6616; train_edge_recon_loss: 2688330.8378; train_gene_expr_recon_loss: 13118581.9618; train_masked_gp_l1_reg_loss: 66120.0187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119464.9980; train_chrom_access_recon_loss: 29655802.4427; train_global_loss: 45736504.8855; train_optim_loss: 45736504.8855; val_kl_reg_loss: 78217.7615; val_edge_recon_loss: 2698701.8167; val_gene_expr_recon_loss: 13210143.8667; val_masked_gp_l1_reg_loss: 65991.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119257.5156; val_chrom_access_recon_loss: 29553772.2667; val_global_loss: 45726085.6000; val_optim_loss: 45726085.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9834; val_auprc_score: 0.9778; val_best_acc_score: 0.9429; val_best_f1_score: 0.9446; train_kl_reg_loss: 87077.3888; train_edge_recon_loss: 2686907.2863; train_gene_expr_recon_loss: 13097239.7863; train_masked_gp_l1_reg_loss: 65992.9544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119385.1412; train_chrom_access_recon_loss: 29522030.4427; train_global_loss: 45578632.9771; train_optim_loss: 45578632.9771; val_kl_reg_loss: 78193.6031; val_edge_recon_loss: 2690998.6833; val_gene_expr_recon_loss: 13169993.6667; val_masked_gp_l1_reg_loss: 65958.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119521.6797; val_chrom_access_recon_loss: 29465855.0667; val_global_loss: 45590521.3333; val_optim_loss: 45590521.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9828; val_auprc_score: 0.9770; val_best_acc_score: 0.9453; val_best_f1_score: 0.9468; train_kl_reg_loss: 86305.4750; train_edge_recon_loss: 2673907.2634; train_gene_expr_recon_loss: 13076524.5725; train_masked_gp_l1_reg_loss: 65878.8875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119386.4455; train_chrom_access_recon_loss: 29450834.3969; train_global_loss: 45472837.0076; train_optim_loss: 45472837.0076; val_kl_reg_loss: 78477.1870; val_edge_recon_loss: 2686401.2333; val_gene_expr_recon_loss: 13129327.6000; val_masked_gp_l1_reg_loss: 65868.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118595.5469; val_chrom_access_recon_loss: 29259666.2667; val_global_loss: 45338337.3333; val_optim_loss: 45338337.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9833; val_auprc_score: 0.9785; val_best_acc_score: 0.9456; val_best_f1_score: 0.9475; train_kl_reg_loss: 85519.2492; train_edge_recon_loss: 2678817.9599; train_gene_expr_recon_loss: 13054577.4885; train_masked_gp_l1_reg_loss: 65769.9235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119154.5101; train_chrom_access_recon_loss: 29360010.8244; train_global_loss: 45363849.9542; train_optim_loss: 45363849.9542; val_kl_reg_loss: 77456.5792; val_edge_recon_loss: 2694361.5500; val_gene_expr_recon_loss: 13047639.4000; val_masked_gp_l1_reg_loss: 65717.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119805.3047; val_chrom_access_recon_loss: 29242122.0000; val_global_loss: 45247101.8667; val_optim_loss: 45247101.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9843; val_auprc_score: 0.9797; val_best_acc_score: 0.9508; val_best_f1_score: 0.9524; train_kl_reg_loss: 84686.4765; train_edge_recon_loss: 2680753.9198; train_gene_expr_recon_loss: 13036199.1221; train_masked_gp_l1_reg_loss: 65679.3414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119186.3554; train_chrom_access_recon_loss: 29318342.5038; train_global_loss: 45304847.5725; train_optim_loss: 45304847.5725; val_kl_reg_loss: 78809.6521; val_edge_recon_loss: 2681711.0167; val_gene_expr_recon_loss: 13130483.6000; val_masked_gp_l1_reg_loss: 65636.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119364.0000; val_chrom_access_recon_loss: 29312263.7333; val_global_loss: 45388268.2667; val_optim_loss: 45388268.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9832; val_auprc_score: 0.9771; val_best_acc_score: 0.9464; val_best_f1_score: 0.9476; train_kl_reg_loss: 84221.0057; train_edge_recon_loss: 2679593.1145; train_gene_expr_recon_loss: 13023043.7710; train_masked_gp_l1_reg_loss: 65602.8052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119113.2757; train_chrom_access_recon_loss: 29295699.8015; train_global_loss: 45267273.6489; train_optim_loss: 45267273.6489; val_kl_reg_loss: 78349.3953; val_edge_recon_loss: 2699738.1833; val_gene_expr_recon_loss: 13085220.4667; val_masked_gp_l1_reg_loss: 65594.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118738.2812; val_chrom_access_recon_loss: 29302197.7333; val_global_loss: 45349838.6667; val_optim_loss: 45349838.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9874; val_auprc_score: 0.9836; val_best_acc_score: 0.9535; val_best_f1_score: 0.9545; train_kl_reg_loss: 83337.2726; train_edge_recon_loss: 2677375.2691; train_gene_expr_recon_loss: 13004918.0458; train_masked_gp_l1_reg_loss: 65579.5654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119136.2799; train_chrom_access_recon_loss: 29274832.7786; train_global_loss: 45225179.0840; train_optim_loss: 45225179.0840; val_kl_reg_loss: 78232.7094; val_edge_recon_loss: 2673401.7500; val_gene_expr_recon_loss: 13090103.5333; val_masked_gp_l1_reg_loss: 65623.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119429.4688; val_chrom_access_recon_loss: 29195855.8667; val_global_loss: 45222646.9333; val_optim_loss: 45222646.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9873; val_auprc_score: 0.9824; val_best_acc_score: 0.9543; val_best_f1_score: 0.9558; train_kl_reg_loss: 82910.7975; train_edge_recon_loss: 2672987.4141; train_gene_expr_recon_loss: 12994107.2443; train_masked_gp_l1_reg_loss: 65644.5317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119126.1326; train_chrom_access_recon_loss: 29249716.9771; train_global_loss: 45184492.8244; train_optim_loss: 45184492.8244; val_kl_reg_loss: 77258.3708; val_edge_recon_loss: 2663685.3167; val_gene_expr_recon_loss: 13073761.0667; val_masked_gp_l1_reg_loss: 65618.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119146.4609; val_chrom_access_recon_loss: 29144641.7333; val_global_loss: 45144110.6667; val_optim_loss: 45144110.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9874; val_auprc_score: 0.9839; val_best_acc_score: 0.9573; val_best_f1_score: 0.9581; train_kl_reg_loss: 83221.4133; train_edge_recon_loss: 2673203.6202; train_gene_expr_recon_loss: 12975745.8244; train_masked_gp_l1_reg_loss: 65628.3446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119087.1664; train_chrom_access_recon_loss: 29175146.7176; train_global_loss: 45092032.9160; train_optim_loss: 45092032.9160; val_kl_reg_loss: 77904.2312; val_edge_recon_loss: 2685894.7500; val_gene_expr_recon_loss: 13082639.6000; val_masked_gp_l1_reg_loss: 65754.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118827.5312; val_chrom_access_recon_loss: 29250296.0000; val_global_loss: 45281317.0667; val_optim_loss: 45281317.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9871; val_auprc_score: 0.9834; val_best_acc_score: 0.9561; val_best_f1_score: 0.9573; train_kl_reg_loss: 82234.7588; train_edge_recon_loss: 2672026.7195; train_gene_expr_recon_loss: 12945671.9924; train_masked_gp_l1_reg_loss: 65718.2270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119127.3853; train_chrom_access_recon_loss: 29123207.7099; train_global_loss: 45007986.8397; train_optim_loss: 45007986.8397; val_kl_reg_loss: 79075.9510; val_edge_recon_loss: 2674418.6500; val_gene_expr_recon_loss: 12935197.8000; val_masked_gp_l1_reg_loss: 65674.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119560.3516; val_chrom_access_recon_loss: 28949566.6667; val_global_loss: 44823492.5333; val_optim_loss: 44823492.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9865; val_auprc_score: 0.9805; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 81703.2856; train_edge_recon_loss: 2667169.3168; train_gene_expr_recon_loss: 12943359.2519; train_masked_gp_l1_reg_loss: 65684.1895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119025.5154; train_chrom_access_recon_loss: 29124565.1603; train_global_loss: 45001506.7786; train_optim_loss: 45001506.7786; val_kl_reg_loss: 80310.6703; val_edge_recon_loss: 2672438.6667; val_gene_expr_recon_loss: 12977744.5333; val_masked_gp_l1_reg_loss: 65709.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119331.0234; val_chrom_access_recon_loss: 28905370.6667; val_global_loss: 44820905.8667; val_optim_loss: 44820905.8667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9869; val_auprc_score: 0.9817; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 80570.7889; train_edge_recon_loss: 2672492.3931; train_gene_expr_recon_loss: 12940498.1298; train_masked_gp_l1_reg_loss: 65667.3276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119016.5761; train_chrom_access_recon_loss: 29108668.3359; train_global_loss: 44986913.8626; train_optim_loss: 44986913.8626; val_kl_reg_loss: 77716.3849; val_edge_recon_loss: 2674198.0667; val_gene_expr_recon_loss: 13051704.8667; val_masked_gp_l1_reg_loss: 65645.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118688.5234; val_chrom_access_recon_loss: 29111200.6667; val_global_loss: 45099155.2000; val_optim_loss: 45099155.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9854; val_auprc_score: 0.9797; val_best_acc_score: 0.9508; val_best_f1_score: 0.9523; train_kl_reg_loss: 81297.4784; train_edge_recon_loss: 2663766.6565; train_gene_expr_recon_loss: 12925581.0534; train_masked_gp_l1_reg_loss: 65676.0214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118875.8154; train_chrom_access_recon_loss: 29059779.5267; train_global_loss: 44914976.5191; train_optim_loss: 44914976.5191; val_kl_reg_loss: 76664.6625; val_edge_recon_loss: 2682693.4167; val_gene_expr_recon_loss: 12992112.9333; val_masked_gp_l1_reg_loss: 65590.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119397.0312; val_chrom_access_recon_loss: 29019180.5333; val_global_loss: 44955640.0000; val_optim_loss: 44955640.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9874; val_auprc_score: 0.9834; val_best_acc_score: 0.9568; val_best_f1_score: 0.9578; train_kl_reg_loss: 80859.1465; train_edge_recon_loss: 2661823.5725; train_gene_expr_recon_loss: 12929412.8321; train_masked_gp_l1_reg_loss: 65658.8822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119013.8027; train_chrom_access_recon_loss: 29061139.1908; train_global_loss: 44917907.3282; train_optim_loss: 44917907.3282; val_kl_reg_loss: 78639.9073; val_edge_recon_loss: 2681941.7333; val_gene_expr_recon_loss: 12973550.6667; val_masked_gp_l1_reg_loss: 65645.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118050.7344; val_chrom_access_recon_loss: 28985052.0000; val_global_loss: 44902881.3333; val_optim_loss: 44902881.3333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9869; val_auprc_score: 0.9803; val_best_acc_score: 0.9559; val_best_f1_score: 0.9569; train_kl_reg_loss: 80835.3344; train_edge_recon_loss: 2665442.1107; train_gene_expr_recon_loss: 12925698.6031; train_masked_gp_l1_reg_loss: 65647.5049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118919.7405; train_chrom_access_recon_loss: 29058476.4427; train_global_loss: 44915019.8473; train_optim_loss: 44915019.8473; val_kl_reg_loss: 80158.2568; val_edge_recon_loss: 2685963.7333; val_gene_expr_recon_loss: 13014156.7333; val_masked_gp_l1_reg_loss: 65702.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118425.6797; val_chrom_access_recon_loss: 29107703.0667; val_global_loss: 45072110.6667; val_optim_loss: 45072110.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9890; val_auprc_score: 0.9852; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 81063.3879; train_edge_recon_loss: 2664168.2958; train_gene_expr_recon_loss: 12910575.1985; train_masked_gp_l1_reg_loss: 65238.2178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86360.3305; train_chrom_access_recon_loss: 29042295.7252; train_global_loss: 44849701.1603; train_optim_loss: 44849701.1603; val_kl_reg_loss: 79450.3052; val_edge_recon_loss: 2662331.0500; val_gene_expr_recon_loss: 12959389.3333; val_masked_gp_l1_reg_loss: 65078.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83550.8438; val_chrom_access_recon_loss: 28944122.1333; val_global_loss: 44793922.9333; val_optim_loss: 44793922.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9900; val_auprc_score: 0.9877; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 81302.5647; train_edge_recon_loss: 2658507.3111; train_gene_expr_recon_loss: 12911389.3435; train_masked_gp_l1_reg_loss: 65031.7948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83236.5988; train_chrom_access_recon_loss: 29032929.3588; train_global_loss: 44832396.8855; train_optim_loss: 44832396.8855; val_kl_reg_loss: 79998.4880; val_edge_recon_loss: 2675700.8667; val_gene_expr_recon_loss: 12970705.1333; val_masked_gp_l1_reg_loss: 64996.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83020.2969; val_chrom_access_recon_loss: 29036312.2667; val_global_loss: 44910732.5333; val_optim_loss: 44910732.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9901; val_auprc_score: 0.9871; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 81288.3084; train_edge_recon_loss: 2665589.0515; train_gene_expr_recon_loss: 12897770.6183; train_masked_gp_l1_reg_loss: 64979.3008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82770.3272; train_chrom_access_recon_loss: 29032607.5115; train_global_loss: 44825005.1298; train_optim_loss: 44825005.1298; val_kl_reg_loss: 80397.7031; val_edge_recon_loss: 2666185.4667; val_gene_expr_recon_loss: 12953789.5333; val_masked_gp_l1_reg_loss: 64963.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82540.7266; val_chrom_access_recon_loss: 28922024.4000; val_global_loss: 44769900.5333; val_optim_loss: 44769900.5333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9889; val_auprc_score: 0.9855; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 81371.2161; train_edge_recon_loss: 2661585.8912; train_gene_expr_recon_loss: 12888340.6183; train_masked_gp_l1_reg_loss: 64952.6467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82250.2658; train_chrom_access_recon_loss: 29003539.6031; train_global_loss: 44782040.5191; train_optim_loss: 44782040.5191; val_kl_reg_loss: 79473.9198; val_edge_recon_loss: 2675824.9000; val_gene_expr_recon_loss: 13005018.8667; val_masked_gp_l1_reg_loss: 64957.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82123.1016; val_chrom_access_recon_loss: 29087105.8667; val_global_loss: 44994502.9333; val_optim_loss: 44994502.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9851; val_best_acc_score: 0.9612; val_best_f1_score: 0.9622; train_kl_reg_loss: 81612.6120; train_edge_recon_loss: 2663912.6660; train_gene_expr_recon_loss: 12895570.6794; train_masked_gp_l1_reg_loss: 64941.5432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81844.8624; train_chrom_access_recon_loss: 29011279.5267; train_global_loss: 44799162.0153; train_optim_loss: 44799162.0153; val_kl_reg_loss: 80400.8568; val_edge_recon_loss: 2670831.5833; val_gene_expr_recon_loss: 12936425.6000; val_masked_gp_l1_reg_loss: 64930.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81669.5625; val_chrom_access_recon_loss: 28939621.4667; val_global_loss: 44773879.7333; val_optim_loss: 44773879.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9886; val_auprc_score: 0.9813; val_best_acc_score: 0.9590; val_best_f1_score: 0.9601; train_kl_reg_loss: 81795.0200; train_edge_recon_loss: 2662392.2195; train_gene_expr_recon_loss: 12898212.2519; train_masked_gp_l1_reg_loss: 64917.6701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81442.6179; train_chrom_access_recon_loss: 28998905.0382; train_global_loss: 44787664.9160; train_optim_loss: 44787664.9160; val_kl_reg_loss: 80996.8818; val_edge_recon_loss: 2690587.6833; val_gene_expr_recon_loss: 13002079.8667; val_masked_gp_l1_reg_loss: 64901.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81291.9531; val_chrom_access_recon_loss: 29092212.1333; val_global_loss: 45012069.0667; val_optim_loss: 45012069.0667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9905; val_auprc_score: 0.9875; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 81705.1536; train_edge_recon_loss: 2664792.4008; train_gene_expr_recon_loss: 12894865.0840; train_masked_gp_l1_reg_loss: 64893.4198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81068.4317; train_chrom_access_recon_loss: 28998996.7176; train_global_loss: 44786321.0992; train_optim_loss: 44786321.0992; val_kl_reg_loss: 81099.8344; val_edge_recon_loss: 2664608.1333; val_gene_expr_recon_loss: 12941408.1333; val_masked_gp_l1_reg_loss: 64874.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80798.4922; val_chrom_access_recon_loss: 28817362.2667; val_global_loss: 44650150.1333; val_optim_loss: 44650150.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9889; val_auprc_score: 0.9821; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 82076.7372; train_edge_recon_loss: 2664188.0305; train_gene_expr_recon_loss: 12893307.2443; train_masked_gp_l1_reg_loss: 64863.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80698.4211; train_chrom_access_recon_loss: 28997243.7252; train_global_loss: 44782378.1374; train_optim_loss: 44782378.1374; val_kl_reg_loss: 81370.4990; val_edge_recon_loss: 2664965.8167; val_gene_expr_recon_loss: 12966166.6667; val_masked_gp_l1_reg_loss: 64853.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80391.9219; val_chrom_access_recon_loss: 28927817.7333; val_global_loss: 44785566.4000; val_optim_loss: 44785566.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9864; val_best_acc_score: 0.9603; val_best_f1_score: 0.9607; train_kl_reg_loss: 82169.3729; train_edge_recon_loss: 2663412.2939; train_gene_expr_recon_loss: 12886588.1374; train_masked_gp_l1_reg_loss: 64843.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80361.9469; train_chrom_access_recon_loss: 28967571.0076; train_global_loss: 44744946.2290; train_optim_loss: 44744946.2290; val_kl_reg_loss: 81159.9490; val_edge_recon_loss: 2695405.0333; val_gene_expr_recon_loss: 13005078.4667; val_masked_gp_l1_reg_loss: 64833.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80127.0391; val_chrom_access_recon_loss: 29034801.4667; val_global_loss: 44961405.6000; val_optim_loss: 44961405.6000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9903; val_auprc_score: 0.9865; val_best_acc_score: 0.9613; val_best_f1_score: 0.9624; train_kl_reg_loss: 81980.3980; train_edge_recon_loss: 2664889.6450; train_gene_expr_recon_loss: 12892579.8931; train_masked_gp_l1_reg_loss: 64826.1175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80000.5005; train_chrom_access_recon_loss: 29029436.2595; train_global_loss: 44813712.9771; train_optim_loss: 44813712.9771; val_kl_reg_loss: 81144.3875; val_edge_recon_loss: 2672172.0167; val_gene_expr_recon_loss: 12941931.0000; val_masked_gp_l1_reg_loss: 64815.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79951.3438; val_chrom_access_recon_loss: 28977111.0667; val_global_loss: 44817124.2667; val_optim_loss: 44817124.2667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9893; val_auprc_score: 0.9844; val_best_acc_score: 0.9594; val_best_f1_score: 0.9606; train_kl_reg_loss: 82258.1280; train_edge_recon_loss: 2661590.3740; train_gene_expr_recon_loss: 12891595.4962; train_masked_gp_l1_reg_loss: 64808.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79707.7857; train_chrom_access_recon_loss: 29009336.0458; train_global_loss: 44789296.0000; train_optim_loss: 44789296.0000; val_kl_reg_loss: 81002.3797; val_edge_recon_loss: 2677280.8000; val_gene_expr_recon_loss: 12981011.0000; val_masked_gp_l1_reg_loss: 64796.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79661.0391; val_chrom_access_recon_loss: 28887441.7333; val_global_loss: 44771192.8000; val_optim_loss: 44771192.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9879; val_auprc_score: 0.9833; val_best_acc_score: 0.9588; val_best_f1_score: 0.9597; train_kl_reg_loss: 81957.7133; train_edge_recon_loss: 2660032.1565; train_gene_expr_recon_loss: 12886791.3282; train_masked_gp_l1_reg_loss: 64744.5987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75994.9435; train_chrom_access_recon_loss: 29017594.1221; train_global_loss: 44787114.8397; train_optim_loss: 44787114.8397; val_kl_reg_loss: 81217.1698; val_edge_recon_loss: 2672579.8333; val_gene_expr_recon_loss: 12919337.6667; val_masked_gp_l1_reg_loss: 64724.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75675.3359; val_chrom_access_recon_loss: 28851040.1333; val_global_loss: 44664574.9333; val_optim_loss: 44664574.9333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9891; val_auprc_score: 0.9843; val_best_acc_score: 0.9619; val_best_f1_score: 0.9627; train_kl_reg_loss: 81858.4088; train_edge_recon_loss: 2656237.1775; train_gene_expr_recon_loss: 12885416.9771; train_masked_gp_l1_reg_loss: 64715.5430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75647.6183; train_chrom_access_recon_loss: 28976280.9008; train_global_loss: 44740156.6718; train_optim_loss: 44740156.6718; val_kl_reg_loss: 80989.4667; val_edge_recon_loss: 2669188.0500; val_gene_expr_recon_loss: 12959428.4667; val_masked_gp_l1_reg_loss: 64706.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75630.1016; val_chrom_access_recon_loss: 28858810.2667; val_global_loss: 44708751.4667; val_optim_loss: 44708751.4667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9901; val_auprc_score: 0.9861; val_best_acc_score: 0.9615; val_best_f1_score: 0.9623; train_kl_reg_loss: 81995.5240; train_edge_recon_loss: 2663031.3492; train_gene_expr_recon_loss: 12878320.3053; train_masked_gp_l1_reg_loss: 64700.8870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75604.9358; train_chrom_access_recon_loss: 28984450.1985; train_global_loss: 44748103.0840; train_optim_loss: 44748103.0840; val_kl_reg_loss: 81470.8260; val_edge_recon_loss: 2677030.8667; val_gene_expr_recon_loss: 12996534.8000; val_masked_gp_l1_reg_loss: 64695.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75589.2656; val_chrom_access_recon_loss: 29093197.3333; val_global_loss: 44988518.9333; val_optim_loss: 44988518.9333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9906; val_auprc_score: 0.9879; val_best_acc_score: 0.9629; val_best_f1_score: 0.9637; train_kl_reg_loss: 81879.1706; train_edge_recon_loss: 2667023.3015; train_gene_expr_recon_loss: 12877813.9389; train_masked_gp_l1_reg_loss: 64692.2971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75563.4887; train_chrom_access_recon_loss: 28968332.9313; train_global_loss: 44735305.3130; train_optim_loss: 44735305.3130; val_kl_reg_loss: 81307.2510; val_edge_recon_loss: 2658832.3500; val_gene_expr_recon_loss: 13011770.4000; val_masked_gp_l1_reg_loss: 64688.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75548.0938; val_chrom_access_recon_loss: 29170000.8000; val_global_loss: 45062146.9333; val_optim_loss: 45062146.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 190 min 36 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9890
val AUPRC score: 0.9838
val best accuracy score: 0.9594
val best F1 score: 0.9603
val target rna MSE score: 1.0654
val source rna MSE score: 0.3606
val target atac MSE score: 0.1221
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
