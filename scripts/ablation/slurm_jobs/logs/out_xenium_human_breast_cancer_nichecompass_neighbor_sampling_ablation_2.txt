None
Run timestamp: 19072023_130106_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9442; val_auprc_score: 0.9304; val_best_acc_score: 0.8814; val_best_f1_score: 0.8880; train_kl_reg_loss: 49898.6038; train_edge_recon_loss: 26961041.9633; train_gene_expr_recon_loss: 7492151.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34503092.4190; train_optim_loss: 34503092.4190; val_kl_reg_loss: 48110.8154; val_edge_recon_loss: 26817205.2466; val_gene_expr_recon_loss: 6864045.8253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33729361.9452; val_optim_loss: 33729361.9452
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9574; val_auprc_score: 0.9498; val_best_acc_score: 0.8949; val_best_f1_score: 0.8994; train_kl_reg_loss: 44423.5781; train_edge_recon_loss: 26300968.1177; train_gene_expr_recon_loss: 6669579.0959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33014970.8119; train_optim_loss: 33014970.8119; val_kl_reg_loss: 40120.1438; val_edge_recon_loss: 26752180.8082; val_gene_expr_recon_loss: 6465699.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33258000.7397; val_optim_loss: 33258000.7397
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9657; val_auprc_score: 0.9593; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 38716.8322; train_edge_recon_loss: 26183798.7722; train_gene_expr_recon_loss: 6398841.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32621357.3180; train_optim_loss: 32621357.3180; val_kl_reg_loss: 37073.5715; val_edge_recon_loss: 26648279.6438; val_gene_expr_recon_loss: 6285574.3390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32970927.5890; val_optim_loss: 32970927.5890
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9686; val_auprc_score: 0.9628; val_best_acc_score: 0.9125; val_best_f1_score: 0.9155; train_kl_reg_loss: 37118.7201; train_edge_recon_loss: 26113888.6284; train_gene_expr_recon_loss: 6243478.6644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32394486.0138; train_optim_loss: 32394486.0138; val_kl_reg_loss: 36307.1743; val_edge_recon_loss: 26574712.1507; val_gene_expr_recon_loss: 6179147.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32790166.6027; val_optim_loss: 32790166.6027
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9709; val_auprc_score: 0.9657; val_best_acc_score: 0.9159; val_best_f1_score: 0.9188; train_kl_reg_loss: 35880.0527; train_edge_recon_loss: 26083154.2141; train_gene_expr_recon_loss: 6157389.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276423.8624; train_optim_loss: 32276423.8624; val_kl_reg_loss: 35079.7275; val_edge_recon_loss: 26561736.1233; val_gene_expr_recon_loss: 6102786.5788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32699602.4247; val_optim_loss: 32699602.4247
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9725; val_auprc_score: 0.9678; val_best_acc_score: 0.9187; val_best_f1_score: 0.9211; train_kl_reg_loss: 35560.2262; train_edge_recon_loss: 26042725.5688; train_gene_expr_recon_loss: 6101841.5524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32180127.3563; train_optim_loss: 32180127.3563; val_kl_reg_loss: 34498.3590; val_edge_recon_loss: 26551224.7945; val_gene_expr_recon_loss: 6062814.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32648538.0137; val_optim_loss: 32648538.0137
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9741; val_auprc_score: 0.9694; val_best_acc_score: 0.9220; val_best_f1_score: 0.9241; train_kl_reg_loss: 35399.2518; train_edge_recon_loss: 26025915.3853; train_gene_expr_recon_loss: 6068661.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32129976.4786; train_optim_loss: 32129976.4786; val_kl_reg_loss: 34667.5807; val_edge_recon_loss: 26510796.1644; val_gene_expr_recon_loss: 6023339.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32568803.6438; val_optim_loss: 32568803.6438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9767; val_auprc_score: 0.9731; val_best_acc_score: 0.9256; val_best_f1_score: 0.9277; train_kl_reg_loss: 34821.6216; train_edge_recon_loss: 26018665.3792; train_gene_expr_recon_loss: 6045408.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32098895.1116; train_optim_loss: 32098895.1116; val_kl_reg_loss: 33235.2037; val_edge_recon_loss: 26502066.9452; val_gene_expr_recon_loss: 6032533.9795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32567836.1096; val_optim_loss: 32567836.1096
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9713; val_best_acc_score: 0.9243; val_best_f1_score: 0.9265; train_kl_reg_loss: 34912.8442; train_edge_recon_loss: 25996468.8272; train_gene_expr_recon_loss: 6019144.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32050525.9908; train_optim_loss: 32050525.9908; val_kl_reg_loss: 34153.2188; val_edge_recon_loss: 26530685.5342; val_gene_expr_recon_loss: 5997033.7877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32561872.4247; val_optim_loss: 32561872.4247
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9772; val_auprc_score: 0.9733; val_best_acc_score: 0.9279; val_best_f1_score: 0.9297; train_kl_reg_loss: 34469.0800; train_edge_recon_loss: 25975027.3165; train_gene_expr_recon_loss: 6008674.0019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32018170.4480; train_optim_loss: 32018170.4480; val_kl_reg_loss: 32936.6994; val_edge_recon_loss: 26477916.0274; val_gene_expr_recon_loss: 5992848.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32503701.6027; val_optim_loss: 32503701.6027
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9780; val_auprc_score: 0.9745; val_best_acc_score: 0.9280; val_best_f1_score: 0.9301; train_kl_reg_loss: 34262.7005; train_edge_recon_loss: 25983148.8150; train_gene_expr_recon_loss: 5999419.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32016830.9495; train_optim_loss: 32016830.9495; val_kl_reg_loss: 33041.2171; val_edge_recon_loss: 26528511.7260; val_gene_expr_recon_loss: 5982270.6096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32543823.4932; val_optim_loss: 32543823.4932
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9735; val_best_acc_score: 0.9269; val_best_f1_score: 0.9288; train_kl_reg_loss: 34191.1466; train_edge_recon_loss: 25962168.4235; train_gene_expr_recon_loss: 5987173.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31983533.1988; train_optim_loss: 31983533.1988; val_kl_reg_loss: 33956.6726; val_edge_recon_loss: 26480262.9315; val_gene_expr_recon_loss: 5967657.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32481876.6438; val_optim_loss: 32481876.6438
