None
Run timestamp: 24072023_222104_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9357; val_auprc_score: 0.9146; val_best_acc_score: 0.8753; val_best_f1_score: 0.8834; train_kl_reg_loss: 20083.4949; train_edge_recon_loss: 2727386.4250; train_gene_expr_recon_loss: 797972.0666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3545441.9864; train_optim_loss: 3545441.9864; val_kl_reg_loss: 17949.7572; val_edge_recon_loss: 2699395.7895; val_gene_expr_recon_loss: 723802.8832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3441148.4375; val_optim_loss: 3441148.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9492; val_auprc_score: 0.9354; val_best_acc_score: 0.8886; val_best_f1_score: 0.8952; train_kl_reg_loss: 17151.0576; train_edge_recon_loss: 2639902.7768; train_gene_expr_recon_loss: 708476.2575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3365530.0912; train_optim_loss: 3365530.0912; val_kl_reg_loss: 15195.9831; val_edge_recon_loss: 2684546.0428; val_gene_expr_recon_loss: 687778.1702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3387520.2007; val_optim_loss: 3387520.2007
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9589; val_auprc_score: 0.9489; val_best_acc_score: 0.9000; val_best_f1_score: 0.9046; train_kl_reg_loss: 15409.3933; train_edge_recon_loss: 2632294.5496; train_gene_expr_recon_loss: 679014.3233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3326718.2680; train_optim_loss: 3326718.2680; val_kl_reg_loss: 14442.1416; val_edge_recon_loss: 2680999.9638; val_gene_expr_recon_loss: 666199.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3361641.7533; val_optim_loss: 3361641.7533
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9646; val_auprc_score: 0.9550; val_best_acc_score: 0.9110; val_best_f1_score: 0.9147; train_kl_reg_loss: 14804.9830; train_edge_recon_loss: 2623250.8632; train_gene_expr_recon_loss: 659912.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3297967.9985; train_optim_loss: 3297967.9985; val_kl_reg_loss: 14392.6405; val_edge_recon_loss: 2672053.8322; val_gene_expr_recon_loss: 649357.5518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3335804.0066; val_optim_loss: 3335804.0066
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9670; val_auprc_score: 0.9581; val_best_acc_score: 0.9151; val_best_f1_score: 0.9183; train_kl_reg_loss: 14400.2515; train_edge_recon_loss: 2621322.6500; train_gene_expr_recon_loss: 647387.6302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3283110.5324; train_optim_loss: 3283110.5324; val_kl_reg_loss: 13702.6651; val_edge_recon_loss: 2668559.5197; val_gene_expr_recon_loss: 641165.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3323428.0493; val_optim_loss: 3323428.0493
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9698; val_auprc_score: 0.9631; val_best_acc_score: 0.9166; val_best_f1_score: 0.9193; train_kl_reg_loss: 14206.9560; train_edge_recon_loss: 2615397.0761; train_gene_expr_recon_loss: 638677.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3268281.4412; train_optim_loss: 3268281.4412; val_kl_reg_loss: 13721.2976; val_edge_recon_loss: 2667294.3355; val_gene_expr_recon_loss: 632009.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3313025.3684; val_optim_loss: 3313025.3684
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9684; val_auprc_score: 0.9593; val_best_acc_score: 0.9171; val_best_f1_score: 0.9201; train_kl_reg_loss: 13938.9241; train_edge_recon_loss: 2615031.1647; train_gene_expr_recon_loss: 632414.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261384.7103; train_optim_loss: 3261384.7103; val_kl_reg_loss: 13745.4758; val_edge_recon_loss: 2671544.6283; val_gene_expr_recon_loss: 628071.5905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3313361.6941; val_optim_loss: 3313361.6941
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9709; val_auprc_score: 0.9635; val_best_acc_score: 0.9203; val_best_f1_score: 0.9234; train_kl_reg_loss: 13853.8644; train_edge_recon_loss: 2612362.1853; train_gene_expr_recon_loss: 627845.5273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254061.5798; train_optim_loss: 3254061.5798; val_kl_reg_loss: 13220.9597; val_edge_recon_loss: 2662694.1776; val_gene_expr_recon_loss: 626509.1291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3302424.2697; val_optim_loss: 3302424.2697
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9705; val_auprc_score: 0.9621; val_best_acc_score: 0.9221; val_best_f1_score: 0.9247; train_kl_reg_loss: 13746.6555; train_edge_recon_loss: 2610023.2805; train_gene_expr_recon_loss: 623970.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3247740.6121; train_optim_loss: 3247740.6121; val_kl_reg_loss: 13165.9400; val_edge_recon_loss: 2663852.2039; val_gene_expr_recon_loss: 620420.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3297439.0592; val_optim_loss: 3297439.0592
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9724; val_auprc_score: 0.9651; val_best_acc_score: 0.9243; val_best_f1_score: 0.9266; train_kl_reg_loss: 13513.7868; train_edge_recon_loss: 2609492.9136; train_gene_expr_recon_loss: 621167.6925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244174.3930; train_optim_loss: 3244174.3930; val_kl_reg_loss: 13113.9301; val_edge_recon_loss: 2661729.0526; val_gene_expr_recon_loss: 619358.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3294201.8322; val_optim_loss: 3294201.8322
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9740; val_auprc_score: 0.9673; val_best_acc_score: 0.9261; val_best_f1_score: 0.9284; train_kl_reg_loss: 13432.1456; train_edge_recon_loss: 2607234.9890; train_gene_expr_recon_loss: 619004.9127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239672.0467; train_optim_loss: 3239672.0467; val_kl_reg_loss: 12992.1692; val_edge_recon_loss: 2662230.7368; val_gene_expr_recon_loss: 617185.1908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3292408.1086; val_optim_loss: 3292408.1086
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9737; val_auprc_score: 0.9676; val_best_acc_score: 0.9242; val_best_f1_score: 0.9265; train_kl_reg_loss: 13342.4501; train_edge_recon_loss: 2607810.7022; train_gene_expr_recon_loss: 617262.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238415.2518; train_optim_loss: 3238415.2518; val_kl_reg_loss: 13266.2583; val_edge_recon_loss: 2661852.7138; val_gene_expr_recon_loss: 615678.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3290797.0526; val_optim_loss: 3290797.0526
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9739; val_auprc_score: 0.9665; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 13297.7620; train_edge_recon_loss: 2606658.6743; train_gene_expr_recon_loss: 615756.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235712.9062; train_optim_loss: 3235712.9062; val_kl_reg_loss: 12801.7954; val_edge_recon_loss: 2656922.9276; val_gene_expr_recon_loss: 615240.3840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284965.1053; val_optim_loss: 3284965.1053
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9737; val_auprc_score: 0.9667; val_best_acc_score: 0.9265; val_best_f1_score: 0.9284; train_kl_reg_loss: 13192.9921; train_edge_recon_loss: 2606350.7801; train_gene_expr_recon_loss: 614307.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233851.7640; train_optim_loss: 3233851.7640; val_kl_reg_loss: 12769.2311; val_edge_recon_loss: 2659318.7007; val_gene_expr_recon_loss: 613785.9720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285873.9046; val_optim_loss: 3285873.9046
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9727; val_auprc_score: 0.9643; val_best_acc_score: 0.9266; val_best_f1_score: 0.9285; train_kl_reg_loss: 13090.7016; train_edge_recon_loss: 2604825.1154; train_gene_expr_recon_loss: 613478.4499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231394.2721; train_optim_loss: 3231394.2721; val_kl_reg_loss: 12985.0016; val_edge_recon_loss: 2661477.1316; val_gene_expr_recon_loss: 613941.7706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3288403.9013; val_optim_loss: 3288403.9013
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9724; val_auprc_score: 0.9645; val_best_acc_score: 0.9259; val_best_f1_score: 0.9281; train_kl_reg_loss: 13104.7915; train_edge_recon_loss: 2602707.0463; train_gene_expr_recon_loss: 612097.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227909.6301; train_optim_loss: 3227909.6301; val_kl_reg_loss: 12734.5336; val_edge_recon_loss: 2659004.8191; val_gene_expr_recon_loss: 611611.3635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3283350.6974; val_optim_loss: 3283350.6974
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9738; val_auprc_score: 0.9660; val_best_acc_score: 0.9276; val_best_f1_score: 0.9302; train_kl_reg_loss: 13029.0875; train_edge_recon_loss: 2603090.5798; train_gene_expr_recon_loss: 611648.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227768.0452; train_optim_loss: 3227768.0452; val_kl_reg_loss: 12914.7986; val_edge_recon_loss: 2654565.0099; val_gene_expr_recon_loss: 612342.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279822.1579; val_optim_loss: 3279822.1579
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9749; val_auprc_score: 0.9684; val_best_acc_score: 0.9289; val_best_f1_score: 0.9311; train_kl_reg_loss: 13018.8207; train_edge_recon_loss: 2603148.2044; train_gene_expr_recon_loss: 610777.1854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226944.2140; train_optim_loss: 3226944.2140; val_kl_reg_loss: 12658.0316; val_edge_recon_loss: 2654925.9441; val_gene_expr_recon_loss: 613067.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3280651.5461; val_optim_loss: 3280651.5461
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9757; val_auprc_score: 0.9693; val_best_acc_score: 0.9292; val_best_f1_score: 0.9312; train_kl_reg_loss: 12953.0875; train_edge_recon_loss: 2600897.9544; train_gene_expr_recon_loss: 610090.3895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223941.4298; train_optim_loss: 3223941.4298; val_kl_reg_loss: 12766.8748; val_edge_recon_loss: 2655936.1743; val_gene_expr_recon_loss: 609844.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3278547.5033; val_optim_loss: 3278547.5033
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9752; val_auprc_score: 0.9682; val_best_acc_score: 0.9296; val_best_f1_score: 0.9315; train_kl_reg_loss: 12957.8848; train_edge_recon_loss: 2601007.1923; train_gene_expr_recon_loss: 609391.3108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223356.3882; train_optim_loss: 3223356.3882; val_kl_reg_loss: 12643.4138; val_edge_recon_loss: 2653883.7664; val_gene_expr_recon_loss: 609465.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275992.4013; val_optim_loss: 3275992.4013
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9745; val_auprc_score: 0.9671; val_best_acc_score: 0.9291; val_best_f1_score: 0.9314; train_kl_reg_loss: 12892.6365; train_edge_recon_loss: 2600492.5463; train_gene_expr_recon_loss: 608763.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222148.4949; train_optim_loss: 3222148.4949; val_kl_reg_loss: 12457.7138; val_edge_recon_loss: 2657859.6053; val_gene_expr_recon_loss: 609667.0049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279984.3289; val_optim_loss: 3279984.3289
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9753; val_auprc_score: 0.9682; val_best_acc_score: 0.9310; val_best_f1_score: 0.9328; train_kl_reg_loss: 12824.2286; train_edge_recon_loss: 2601323.8460; train_gene_expr_recon_loss: 608496.1321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222644.2173; train_optim_loss: 3222644.2173; val_kl_reg_loss: 12534.8224; val_edge_recon_loss: 2655546.9934; val_gene_expr_recon_loss: 609170.9030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277252.6974; val_optim_loss: 3277252.6974
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9747; val_auprc_score: 0.9677; val_best_acc_score: 0.9285; val_best_f1_score: 0.9307; train_kl_reg_loss: 12819.7845; train_edge_recon_loss: 2599592.0147; train_gene_expr_recon_loss: 608174.6128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220586.4107; train_optim_loss: 3220586.4107; val_kl_reg_loss: 12747.9546; val_edge_recon_loss: 2651891.8947; val_gene_expr_recon_loss: 608409.8100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273049.6678; val_optim_loss: 3273049.6678
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9703; val_best_acc_score: 0.9312; val_best_f1_score: 0.9332; train_kl_reg_loss: 12821.9224; train_edge_recon_loss: 2599647.8496; train_gene_expr_recon_loss: 607627.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220097.7051; train_optim_loss: 3220097.7051; val_kl_reg_loss: 12373.0147; val_edge_recon_loss: 2653635.2730; val_gene_expr_recon_loss: 607263.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273272.2007; val_optim_loss: 3273272.2007
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9745; val_auprc_score: 0.9664; val_best_acc_score: 0.9309; val_best_f1_score: 0.9327; train_kl_reg_loss: 12712.8386; train_edge_recon_loss: 2599444.8415; train_gene_expr_recon_loss: 607049.0560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219206.7368; train_optim_loss: 3219206.7368; val_kl_reg_loss: 12348.2228; val_edge_recon_loss: 2654543.6480; val_gene_expr_recon_loss: 607995.7122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274887.5954; val_optim_loss: 3274887.5954
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9760; val_auprc_score: 0.9695; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 12788.9048; train_edge_recon_loss: 2599364.4169; train_gene_expr_recon_loss: 606912.6997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219066.0165; train_optim_loss: 3219066.0165; val_kl_reg_loss: 12325.1261; val_edge_recon_loss: 2654325.4309; val_gene_expr_recon_loss: 608290.5929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274941.1546; val_optim_loss: 3274941.1546
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9764; val_auprc_score: 0.9699; val_best_acc_score: 0.9317; val_best_f1_score: 0.9336; train_kl_reg_loss: 12702.8306; train_edge_recon_loss: 2599369.0592; train_gene_expr_recon_loss: 606876.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218948.3687; train_optim_loss: 3218948.3687; val_kl_reg_loss: 12157.6264; val_edge_recon_loss: 2656081.3191; val_gene_expr_recon_loss: 606311.2492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274550.1875; val_optim_loss: 3274550.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9774; val_auprc_score: 0.9714; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 12661.7737; train_edge_recon_loss: 2597245.0838; train_gene_expr_recon_loss: 601520.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211427.5610; train_optim_loss: 3211427.5610; val_kl_reg_loss: 12413.0938; val_edge_recon_loss: 2650128.3783; val_gene_expr_recon_loss: 601857.7804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264399.2599; val_optim_loss: 3264399.2599
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9771; val_auprc_score: 0.9707; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 12772.7358; train_edge_recon_loss: 2595622.1437; train_gene_expr_recon_loss: 600991.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209386.4393; train_optim_loss: 3209386.4393; val_kl_reg_loss: 12532.9024; val_edge_recon_loss: 2650066.6941; val_gene_expr_recon_loss: 602450.6554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265050.2566; val_optim_loss: 3265050.2566
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9770; val_auprc_score: 0.9705; val_best_acc_score: 0.9326; val_best_f1_score: 0.9343; train_kl_reg_loss: 12801.1920; train_edge_recon_loss: 2596307.4096; train_gene_expr_recon_loss: 601092.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210201.5732; train_optim_loss: 3210201.5732; val_kl_reg_loss: 12490.5988; val_edge_recon_loss: 2650292.7763; val_gene_expr_recon_loss: 601392.6423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264176.0066; val_optim_loss: 3264176.0066
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9778; val_auprc_score: 0.9719; val_best_acc_score: 0.9341; val_best_f1_score: 0.9360; train_kl_reg_loss: 12773.1040; train_edge_recon_loss: 2597355.7489; train_gene_expr_recon_loss: 600640.1801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210769.0324; train_optim_loss: 3210769.0324; val_kl_reg_loss: 12480.0880; val_edge_recon_loss: 2646755.0197; val_gene_expr_recon_loss: 600199.1258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259434.2434; val_optim_loss: 3259434.2434
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9774; val_auprc_score: 0.9708; val_best_acc_score: 0.9345; val_best_f1_score: 0.9364; train_kl_reg_loss: 12759.4544; train_edge_recon_loss: 2596920.1801; train_gene_expr_recon_loss: 600874.2615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210553.8886; train_optim_loss: 3210553.8886; val_kl_reg_loss: 12429.8583; val_edge_recon_loss: 2647916.7928; val_gene_expr_recon_loss: 601130.0115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261476.6645; val_optim_loss: 3261476.6645
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9781; val_auprc_score: 0.9722; val_best_acc_score: 0.9345; val_best_f1_score: 0.9360; train_kl_reg_loss: 12763.0010; train_edge_recon_loss: 2596348.6018; train_gene_expr_recon_loss: 600266.9304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209378.5360; train_optim_loss: 3209378.5360; val_kl_reg_loss: 12457.7037; val_edge_recon_loss: 2648568.8783; val_gene_expr_recon_loss: 600842.6258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261869.1875; val_optim_loss: 3261869.1875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9779; val_auprc_score: 0.9717; val_best_acc_score: 0.9349; val_best_f1_score: 0.9363; train_kl_reg_loss: 12721.2956; train_edge_recon_loss: 2597097.6857; train_gene_expr_recon_loss: 600273.7355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210092.7169; train_optim_loss: 3210092.7169; val_kl_reg_loss: 12511.5100; val_edge_recon_loss: 2649257.8289; val_gene_expr_recon_loss: 602701.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264471.0230; val_optim_loss: 3264471.0230
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9769; val_auprc_score: 0.9700; val_best_acc_score: 0.9334; val_best_f1_score: 0.9350; train_kl_reg_loss: 12779.4879; train_edge_recon_loss: 2595669.6879; train_gene_expr_recon_loss: 600470.1138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208919.2893; train_optim_loss: 3208919.2893; val_kl_reg_loss: 12449.3238; val_edge_recon_loss: 2650158.0132; val_gene_expr_recon_loss: 600036.1382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262643.4836; val_optim_loss: 3262643.4836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9342; val_best_f1_score: 0.9359; train_kl_reg_loss: 12762.3258; train_edge_recon_loss: 2593918.2287; train_gene_expr_recon_loss: 599424.9633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206105.5129; train_optim_loss: 3206105.5129; val_kl_reg_loss: 12466.1244; val_edge_recon_loss: 2650828.6151; val_gene_expr_recon_loss: 600596.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263890.7829; val_optim_loss: 3263890.7829
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9779; val_auprc_score: 0.9719; val_best_acc_score: 0.9335; val_best_f1_score: 0.9354; train_kl_reg_loss: 12768.5897; train_edge_recon_loss: 2595816.6415; train_gene_expr_recon_loss: 599791.2756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208376.5070; train_optim_loss: 3208376.5070; val_kl_reg_loss: 12472.3057; val_edge_recon_loss: 2649161.5493; val_gene_expr_recon_loss: 599555.2928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261189.1151; val_optim_loss: 3261189.1151
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9773; val_auprc_score: 0.9706; val_best_acc_score: 0.9337; val_best_f1_score: 0.9357; train_kl_reg_loss: 12763.0424; train_edge_recon_loss: 2594779.0846; train_gene_expr_recon_loss: 599363.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206905.8320; train_optim_loss: 3206905.8320; val_kl_reg_loss: 12472.6893; val_edge_recon_loss: 2645644.8487; val_gene_expr_recon_loss: 601138.7303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259256.2566; val_optim_loss: 3259256.2566
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9770; val_auprc_score: 0.9701; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 12753.9435; train_edge_recon_loss: 2596007.5493; train_gene_expr_recon_loss: 599770.0175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208531.5048; train_optim_loss: 3208531.5048; val_kl_reg_loss: 12440.8433; val_edge_recon_loss: 2651012.8651; val_gene_expr_recon_loss: 601187.9252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264641.6414; val_optim_loss: 3264641.6414
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9773; val_auprc_score: 0.9711; val_best_acc_score: 0.9330; val_best_f1_score: 0.9349; train_kl_reg_loss: 12747.6745; train_edge_recon_loss: 2595777.7246; train_gene_expr_recon_loss: 599506.7626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208032.1636; train_optim_loss: 3208032.1636; val_kl_reg_loss: 12457.7880; val_edge_recon_loss: 2652719.4408; val_gene_expr_recon_loss: 601565.5378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266742.7533; val_optim_loss: 3266742.7533
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9780; val_auprc_score: 0.9719; val_best_acc_score: 0.9344; val_best_f1_score: 0.9363; train_kl_reg_loss: 12748.9816; train_edge_recon_loss: 2595151.4585; train_gene_expr_recon_loss: 599452.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207352.7651; train_optim_loss: 3207352.7651; val_kl_reg_loss: 12432.6043; val_edge_recon_loss: 2647926.9243; val_gene_expr_recon_loss: 600918.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261277.7697; val_optim_loss: 3261277.7697
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9778; val_auprc_score: 0.9718; val_best_acc_score: 0.9344; val_best_f1_score: 0.9361; train_kl_reg_loss: 12744.0368; train_edge_recon_loss: 2594991.0577; train_gene_expr_recon_loss: 599554.4114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207289.5055; train_optim_loss: 3207289.5055; val_kl_reg_loss: 12432.0605; val_edge_recon_loss: 2646968.1118; val_gene_expr_recon_loss: 600618.2730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260018.4441; val_optim_loss: 3260018.4441

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9777; val_auprc_score: 0.9718; val_best_acc_score: 0.9334; val_best_f1_score: 0.9354; train_kl_reg_loss: 12738.9405; train_edge_recon_loss: 2595087.4493; train_gene_expr_recon_loss: 599526.4472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207352.8349; train_optim_loss: 3207352.8349; val_kl_reg_loss: 12429.3669; val_edge_recon_loss: 2650871.0066; val_gene_expr_recon_loss: 599326.6283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262626.9967; val_optim_loss: 3262626.9967
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9779; val_auprc_score: 0.9718; val_best_acc_score: 0.9351; val_best_f1_score: 0.9368; train_kl_reg_loss: 12742.4793; train_edge_recon_loss: 2597052.9221; train_gene_expr_recon_loss: 599322.7901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209118.1930; train_optim_loss: 3209118.1930; val_kl_reg_loss: 12431.0140; val_edge_recon_loss: 2646834.4671; val_gene_expr_recon_loss: 600813.6702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260079.1513; val_optim_loss: 3260079.1513
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9780; val_auprc_score: 0.9715; val_best_acc_score: 0.9347; val_best_f1_score: 0.9364; train_kl_reg_loss: 12733.5099; train_edge_recon_loss: 2596685.7007; train_gene_expr_recon_loss: 599367.9134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208787.1232; train_optim_loss: 3208787.1232; val_kl_reg_loss: 12441.8186; val_edge_recon_loss: 2649342.5724; val_gene_expr_recon_loss: 599625.8602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261410.2599; val_optim_loss: 3261410.2599
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9777; val_auprc_score: 0.9712; val_best_acc_score: 0.9347; val_best_f1_score: 0.9362; train_kl_reg_loss: 12741.7725; train_edge_recon_loss: 2596477.4011; train_gene_expr_recon_loss: 599606.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208825.8750; train_optim_loss: 3208825.8750; val_kl_reg_loss: 12447.0998; val_edge_recon_loss: 2646903.7336; val_gene_expr_recon_loss: 600462.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259813.6118; val_optim_loss: 3259813.6118

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 64 min 41 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9777
Val AUPRC score: 0.9716
Val best accuracy score: 0.9341
Val best F1 score: 0.9359
Val gene expr MSE score: 1.4443

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
