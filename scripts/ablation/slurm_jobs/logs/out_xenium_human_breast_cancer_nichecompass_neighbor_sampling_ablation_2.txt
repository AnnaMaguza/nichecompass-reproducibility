None
Run timestamp: 19072023_130106_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9442; val_auprc_score: 0.9304; val_best_acc_score: 0.8814; val_best_f1_score: 0.8880; train_kl_reg_loss: 49898.6038; train_edge_recon_loss: 26961041.9633; train_gene_expr_recon_loss: 7492151.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34503092.4190; train_optim_loss: 34503092.4190; val_kl_reg_loss: 48110.8154; val_edge_recon_loss: 26817205.2466; val_gene_expr_recon_loss: 6864045.8253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33729361.9452; val_optim_loss: 33729361.9452
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9574; val_auprc_score: 0.9498; val_best_acc_score: 0.8949; val_best_f1_score: 0.8994; train_kl_reg_loss: 44423.5781; train_edge_recon_loss: 26300968.1177; train_gene_expr_recon_loss: 6669579.0959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33014970.8119; train_optim_loss: 33014970.8119; val_kl_reg_loss: 40120.1438; val_edge_recon_loss: 26752180.8082; val_gene_expr_recon_loss: 6465699.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33258000.7397; val_optim_loss: 33258000.7397
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9657; val_auprc_score: 0.9593; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 38716.8322; train_edge_recon_loss: 26183798.7722; train_gene_expr_recon_loss: 6398841.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32621357.3180; train_optim_loss: 32621357.3180; val_kl_reg_loss: 37073.5715; val_edge_recon_loss: 26648279.6438; val_gene_expr_recon_loss: 6285574.3390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32970927.5890; val_optim_loss: 32970927.5890
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9686; val_auprc_score: 0.9628; val_best_acc_score: 0.9125; val_best_f1_score: 0.9155; train_kl_reg_loss: 37118.7201; train_edge_recon_loss: 26113888.6284; train_gene_expr_recon_loss: 6243478.6644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32394486.0138; train_optim_loss: 32394486.0138; val_kl_reg_loss: 36307.1743; val_edge_recon_loss: 26574712.1507; val_gene_expr_recon_loss: 6179147.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32790166.6027; val_optim_loss: 32790166.6027
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9709; val_auprc_score: 0.9657; val_best_acc_score: 0.9159; val_best_f1_score: 0.9188; train_kl_reg_loss: 35880.0527; train_edge_recon_loss: 26083154.2141; train_gene_expr_recon_loss: 6157389.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276423.8624; train_optim_loss: 32276423.8624; val_kl_reg_loss: 35079.7275; val_edge_recon_loss: 26561736.1233; val_gene_expr_recon_loss: 6102786.5788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32699602.4247; val_optim_loss: 32699602.4247
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9725; val_auprc_score: 0.9678; val_best_acc_score: 0.9187; val_best_f1_score: 0.9211; train_kl_reg_loss: 35560.2262; train_edge_recon_loss: 26042725.5688; train_gene_expr_recon_loss: 6101841.5524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32180127.3563; train_optim_loss: 32180127.3563; val_kl_reg_loss: 34498.3590; val_edge_recon_loss: 26551224.7945; val_gene_expr_recon_loss: 6062814.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32648538.0137; val_optim_loss: 32648538.0137
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9741; val_auprc_score: 0.9694; val_best_acc_score: 0.9220; val_best_f1_score: 0.9241; train_kl_reg_loss: 35399.2518; train_edge_recon_loss: 26025915.3853; train_gene_expr_recon_loss: 6068661.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32129976.4786; train_optim_loss: 32129976.4786; val_kl_reg_loss: 34667.5807; val_edge_recon_loss: 26510796.1644; val_gene_expr_recon_loss: 6023339.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32568803.6438; val_optim_loss: 32568803.6438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9767; val_auprc_score: 0.9731; val_best_acc_score: 0.9256; val_best_f1_score: 0.9277; train_kl_reg_loss: 34821.6216; train_edge_recon_loss: 26018665.3792; train_gene_expr_recon_loss: 6045408.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32098895.1116; train_optim_loss: 32098895.1116; val_kl_reg_loss: 33235.2037; val_edge_recon_loss: 26502066.9452; val_gene_expr_recon_loss: 6032533.9795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32567836.1096; val_optim_loss: 32567836.1096
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9713; val_best_acc_score: 0.9243; val_best_f1_score: 0.9265; train_kl_reg_loss: 34912.8442; train_edge_recon_loss: 25996468.8272; train_gene_expr_recon_loss: 6019144.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32050525.9908; train_optim_loss: 32050525.9908; val_kl_reg_loss: 34153.2188; val_edge_recon_loss: 26530685.5342; val_gene_expr_recon_loss: 5997033.7877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32561872.4247; val_optim_loss: 32561872.4247
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9772; val_auprc_score: 0.9733; val_best_acc_score: 0.9279; val_best_f1_score: 0.9297; train_kl_reg_loss: 34469.0800; train_edge_recon_loss: 25975027.3165; train_gene_expr_recon_loss: 6008674.0019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32018170.4480; train_optim_loss: 32018170.4480; val_kl_reg_loss: 32936.6994; val_edge_recon_loss: 26477916.0274; val_gene_expr_recon_loss: 5992848.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32503701.6027; val_optim_loss: 32503701.6027
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9780; val_auprc_score: 0.9745; val_best_acc_score: 0.9280; val_best_f1_score: 0.9301; train_kl_reg_loss: 34262.7005; train_edge_recon_loss: 25983148.8150; train_gene_expr_recon_loss: 5999419.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32016830.9495; train_optim_loss: 32016830.9495; val_kl_reg_loss: 33041.2171; val_edge_recon_loss: 26528511.7260; val_gene_expr_recon_loss: 5982270.6096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32543823.4932; val_optim_loss: 32543823.4932
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9735; val_best_acc_score: 0.9269; val_best_f1_score: 0.9288; train_kl_reg_loss: 34191.1466; train_edge_recon_loss: 25962168.4235; train_gene_expr_recon_loss: 5987173.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31983533.1988; train_optim_loss: 31983533.1988; val_kl_reg_loss: 33956.6726; val_edge_recon_loss: 26480262.9315; val_gene_expr_recon_loss: 5967657.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32481876.6438; val_optim_loss: 32481876.6438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9791; val_auprc_score: 0.9759; val_best_acc_score: 0.9302; val_best_f1_score: 0.9318; train_kl_reg_loss: 34246.0786; train_edge_recon_loss: 25949914.8670; train_gene_expr_recon_loss: 5977117.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31961278.7263; train_optim_loss: 31961278.7263; val_kl_reg_loss: 33131.6963; val_edge_recon_loss: 26476587.8904; val_gene_expr_recon_loss: 5955169.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32464889.0000; val_optim_loss: 32464889.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9793; val_auprc_score: 0.9757; val_best_acc_score: 0.9319; val_best_f1_score: 0.9336; train_kl_reg_loss: 34061.5964; train_edge_recon_loss: 25948686.4709; train_gene_expr_recon_loss: 5973591.9599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31956340.0229; train_optim_loss: 31956340.0229; val_kl_reg_loss: 33978.0449; val_edge_recon_loss: 26403599.7671; val_gene_expr_recon_loss: 5965089.1473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32402667.0959; val_optim_loss: 32402667.0959
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9789; val_auprc_score: 0.9756; val_best_acc_score: 0.9307; val_best_f1_score: 0.9322; train_kl_reg_loss: 34290.1618; train_edge_recon_loss: 25939540.2462; train_gene_expr_recon_loss: 5963658.0447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31937488.4740; train_optim_loss: 31937488.4740; val_kl_reg_loss: 33393.5457; val_edge_recon_loss: 26449043.8356; val_gene_expr_recon_loss: 5957545.2534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32439982.6301; val_optim_loss: 32439982.6301
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9798; val_auprc_score: 0.9765; val_best_acc_score: 0.9318; val_best_f1_score: 0.9335; train_kl_reg_loss: 34107.3517; train_edge_recon_loss: 25926862.6697; train_gene_expr_recon_loss: 5958836.2362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31919806.2569; train_optim_loss: 31919806.2569; val_kl_reg_loss: 33839.1379; val_edge_recon_loss: 26447820.0000; val_gene_expr_recon_loss: 5936619.0479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32418278.3014; val_optim_loss: 32418278.3014
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9800; val_auprc_score: 0.9765; val_best_acc_score: 0.9328; val_best_f1_score: 0.9341; train_kl_reg_loss: 34060.8701; train_edge_recon_loss: 25920227.8333; train_gene_expr_recon_loss: 5950924.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31905212.8654; train_optim_loss: 31905212.8654; val_kl_reg_loss: 32459.4523; val_edge_recon_loss: 26423263.5068; val_gene_expr_recon_loss: 5930141.1062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32385864.0822; val_optim_loss: 32385864.0822
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9795; val_auprc_score: 0.9757; val_best_acc_score: 0.9331; val_best_f1_score: 0.9344; train_kl_reg_loss: 34364.0435; train_edge_recon_loss: 25918731.1606; train_gene_expr_recon_loss: 5945825.2110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31898920.3792; train_optim_loss: 31898920.3792; val_kl_reg_loss: 33841.9951; val_edge_recon_loss: 26457045.8630; val_gene_expr_recon_loss: 5949073.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32439961.1507; val_optim_loss: 32439961.1507
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9803; val_auprc_score: 0.9771; val_best_acc_score: 0.9335; val_best_f1_score: 0.9350; train_kl_reg_loss: 34236.3837; train_edge_recon_loss: 25903618.1162; train_gene_expr_recon_loss: 5942613.9859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31880468.4954; train_optim_loss: 31880468.4954; val_kl_reg_loss: 33973.2772; val_edge_recon_loss: 26421348.6712; val_gene_expr_recon_loss: 5928657.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32383979.0000; val_optim_loss: 32383979.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9801; val_auprc_score: 0.9767; val_best_acc_score: 0.9337; val_best_f1_score: 0.9351; train_kl_reg_loss: 34028.6415; train_edge_recon_loss: 25912201.2125; train_gene_expr_recon_loss: 5942249.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31888479.5535; train_optim_loss: 31888479.5535; val_kl_reg_loss: 33873.3089; val_edge_recon_loss: 26434422.5479; val_gene_expr_recon_loss: 5952632.1336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32420927.9041; val_optim_loss: 32420927.9041
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9798; val_auprc_score: 0.9760; val_best_acc_score: 0.9335; val_best_f1_score: 0.9350; train_kl_reg_loss: 34364.6475; train_edge_recon_loss: 25905795.4893; train_gene_expr_recon_loss: 5937014.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31877174.2798; train_optim_loss: 31877174.2798; val_kl_reg_loss: 33285.4462; val_edge_recon_loss: 26482975.4110; val_gene_expr_recon_loss: 5925320.7774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32441581.6849; val_optim_loss: 32441581.6849
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9814; val_auprc_score: 0.9782; val_best_acc_score: 0.9365; val_best_f1_score: 0.9380; train_kl_reg_loss: 34194.1398; train_edge_recon_loss: 25894995.5015; train_gene_expr_recon_loss: 5932802.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31861991.8991; train_optim_loss: 31861991.8991; val_kl_reg_loss: 33556.9608; val_edge_recon_loss: 26404526.2055; val_gene_expr_recon_loss: 5934174.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32372257.6164; val_optim_loss: 32372257.6164
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9815; val_auprc_score: 0.9785; val_best_acc_score: 0.9360; val_best_f1_score: 0.9374; train_kl_reg_loss: 34377.2035; train_edge_recon_loss: 25898478.3012; train_gene_expr_recon_loss: 5929641.5199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31862497.0031; train_optim_loss: 31862497.0031; val_kl_reg_loss: 32907.3461; val_edge_recon_loss: 26408512.0959; val_gene_expr_recon_loss: 5921219.3390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32362638.7534; val_optim_loss: 32362638.7534
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9801; val_auprc_score: 0.9763; val_best_acc_score: 0.9337; val_best_f1_score: 0.9353; train_kl_reg_loss: 34154.8688; train_edge_recon_loss: 25895596.0229; train_gene_expr_recon_loss: 5926967.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31856718.4572; train_optim_loss: 31856718.4572; val_kl_reg_loss: 34215.1479; val_edge_recon_loss: 26443027.1644; val_gene_expr_recon_loss: 5928056.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32405298.3699; val_optim_loss: 32405298.3699
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9817; val_auprc_score: 0.9784; val_best_acc_score: 0.9371; val_best_f1_score: 0.9384; train_kl_reg_loss: 34385.5499; train_edge_recon_loss: 25883214.1193; train_gene_expr_recon_loss: 5923434.6120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31841034.3043; train_optim_loss: 31841034.3043; val_kl_reg_loss: 33390.0958; val_edge_recon_loss: 26425516.4384; val_gene_expr_recon_loss: 5911125.5034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32370032.0548; val_optim_loss: 32370032.0548
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9814; val_auprc_score: 0.9778; val_best_acc_score: 0.9367; val_best_f1_score: 0.9383; train_kl_reg_loss: 34161.8605; train_edge_recon_loss: 25879563.6835; train_gene_expr_recon_loss: 5921394.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31835120.3104; train_optim_loss: 31835120.3104; val_kl_reg_loss: 33039.5255; val_edge_recon_loss: 26434832.5342; val_gene_expr_recon_loss: 5908571.3425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32376443.3836; val_optim_loss: 32376443.3836
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9822; val_auprc_score: 0.9791; val_best_acc_score: 0.9380; val_best_f1_score: 0.9394; train_kl_reg_loss: 34421.2310; train_edge_recon_loss: 25886012.4128; train_gene_expr_recon_loss: 5921906.7890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31842340.4144; train_optim_loss: 31842340.4144; val_kl_reg_loss: 33661.7870; val_edge_recon_loss: 26388306.9315; val_gene_expr_recon_loss: 5914515.2260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32336483.8767; val_optim_loss: 32336483.8767
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9818; val_auprc_score: 0.9785; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 34226.4553; train_edge_recon_loss: 25875078.3639; train_gene_expr_recon_loss: 5920234.8624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31829539.6835; train_optim_loss: 31829539.6835; val_kl_reg_loss: 33092.6757; val_edge_recon_loss: 26402415.4932; val_gene_expr_recon_loss: 5898956.5479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32334464.7260; val_optim_loss: 32334464.7260
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9824; val_auprc_score: 0.9791; val_best_acc_score: 0.9388; val_best_f1_score: 0.9399; train_kl_reg_loss: 34045.4207; train_edge_recon_loss: 25860518.0550; train_gene_expr_recon_loss: 5916258.1204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31810821.6116; train_optim_loss: 31810821.6116; val_kl_reg_loss: 33433.9431; val_edge_recon_loss: 26388334.8493; val_gene_expr_recon_loss: 5909265.1473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32331033.9041; val_optim_loss: 32331033.9041
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9825; val_auprc_score: 0.9788; val_best_acc_score: 0.9388; val_best_f1_score: 0.9397; train_kl_reg_loss: 34109.5292; train_edge_recon_loss: 25868168.3609; train_gene_expr_recon_loss: 5916267.0329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31818544.8976; train_optim_loss: 31818544.8976; val_kl_reg_loss: 32766.4056; val_edge_recon_loss: 26402442.0137; val_gene_expr_recon_loss: 5903338.2808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32338546.7260; val_optim_loss: 32338546.7260
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9819; val_auprc_score: 0.9782; val_best_acc_score: 0.9376; val_best_f1_score: 0.9390; train_kl_reg_loss: 34269.9528; train_edge_recon_loss: 25853975.1239; train_gene_expr_recon_loss: 5914258.5604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31802503.6544; train_optim_loss: 31802503.6544; val_kl_reg_loss: 33960.0008; val_edge_recon_loss: 26397511.0000; val_gene_expr_recon_loss: 5919272.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32350743.4247; val_optim_loss: 32350743.4247
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9822; val_auprc_score: 0.9782; val_best_acc_score: 0.9386; val_best_f1_score: 0.9398; train_kl_reg_loss: 34432.4739; train_edge_recon_loss: 25863069.1483; train_gene_expr_recon_loss: 5910315.1365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31807816.7294; train_optim_loss: 31807816.7294; val_kl_reg_loss: 33133.1273; val_edge_recon_loss: 26405984.1233; val_gene_expr_recon_loss: 5890029.9555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32329147.2329; val_optim_loss: 32329147.2329
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9818; val_auprc_score: 0.9780; val_best_acc_score: 0.9387; val_best_f1_score: 0.9399; train_kl_reg_loss: 34371.8032; train_edge_recon_loss: 25860856.2523; train_gene_expr_recon_loss: 5910556.9018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31805784.9908; train_optim_loss: 31805784.9908; val_kl_reg_loss: 34716.2284; val_edge_recon_loss: 26345841.6575; val_gene_expr_recon_loss: 5897046.7329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32277604.5479; val_optim_loss: 32277604.5479
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9824; val_auprc_score: 0.9792; val_best_acc_score: 0.9393; val_best_f1_score: 0.9407; train_kl_reg_loss: 34238.8087; train_edge_recon_loss: 25867700.5489; train_gene_expr_recon_loss: 5910916.4423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31812855.7982; train_optim_loss: 31812855.7982; val_kl_reg_loss: 34032.3753; val_edge_recon_loss: 26385380.1233; val_gene_expr_recon_loss: 5905784.9315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32325197.2740; val_optim_loss: 32325197.2740
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9827; val_auprc_score: 0.9799; val_best_acc_score: 0.9392; val_best_f1_score: 0.9404; train_kl_reg_loss: 34551.4221; train_edge_recon_loss: 25862781.3517; train_gene_expr_recon_loss: 5905893.2813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31803226.0443; train_optim_loss: 31803226.0443; val_kl_reg_loss: 33464.9967; val_edge_recon_loss: 26421287.4110; val_gene_expr_recon_loss: 5894293.0240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32349045.4932; val_optim_loss: 32349045.4932
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9828; val_auprc_score: 0.9796; val_best_acc_score: 0.9402; val_best_f1_score: 0.9415; train_kl_reg_loss: 34481.3202; train_edge_recon_loss: 25861252.0076; train_gene_expr_recon_loss: 5908933.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31804666.7080; train_optim_loss: 31804666.7080; val_kl_reg_loss: 33855.0712; val_edge_recon_loss: 26318873.1370; val_gene_expr_recon_loss: 5889261.5103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32241989.7808; val_optim_loss: 32241989.7808
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9828; val_auprc_score: 0.9796; val_best_acc_score: 0.9396; val_best_f1_score: 0.9406; train_kl_reg_loss: 34238.7120; train_edge_recon_loss: 25849225.6407; train_gene_expr_recon_loss: 5906684.6166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31790148.9679; train_optim_loss: 31790148.9679; val_kl_reg_loss: 33357.2463; val_edge_recon_loss: 26373866.8219; val_gene_expr_recon_loss: 5905050.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32312274.7945; val_optim_loss: 32312274.7945
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9829; val_auprc_score: 0.9798; val_best_acc_score: 0.9399; val_best_f1_score: 0.9411; train_kl_reg_loss: 34342.1549; train_edge_recon_loss: 25845728.1223; train_gene_expr_recon_loss: 5907231.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31787301.7737; train_optim_loss: 31787301.7737; val_kl_reg_loss: 33644.9791; val_edge_recon_loss: 26371633.9863; val_gene_expr_recon_loss: 5885320.9966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32290600.0411; val_optim_loss: 32290600.0411
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9826; val_auprc_score: 0.9794; val_best_acc_score: 0.9392; val_best_f1_score: 0.9406; train_kl_reg_loss: 34136.7500; train_edge_recon_loss: 25855748.5306; train_gene_expr_recon_loss: 5904203.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31794089.1621; train_optim_loss: 31794089.1621; val_kl_reg_loss: 33730.5317; val_edge_recon_loss: 26375038.3288; val_gene_expr_recon_loss: 5913778.5685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32322547.3425; val_optim_loss: 32322547.3425
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9822; val_auprc_score: 0.9786; val_best_acc_score: 0.9402; val_best_f1_score: 0.9414; train_kl_reg_loss: 34391.4926; train_edge_recon_loss: 25859809.3165; train_gene_expr_recon_loss: 5900861.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31795062.4220; train_optim_loss: 31795062.4220; val_kl_reg_loss: 33774.7642; val_edge_recon_loss: 26351970.4247; val_gene_expr_recon_loss: 5896793.6370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32282538.9315; val_optim_loss: 32282538.9315

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9827; val_auprc_score: 0.9794; val_best_acc_score: 0.9399; val_best_f1_score: 0.9412; train_kl_reg_loss: 35287.6807; train_edge_recon_loss: 25825203.7890; train_gene_expr_recon_loss: 5841168.0761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31701659.5260; train_optim_loss: 31701659.5260; val_kl_reg_loss: 34877.6913; val_edge_recon_loss: 26354029.7808; val_gene_expr_recon_loss: 5835992.9212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32224900.3288; val_optim_loss: 32224900.3288
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9836; val_auprc_score: 0.9805; val_best_acc_score: 0.9411; val_best_f1_score: 0.9424; train_kl_reg_loss: 35886.5031; train_edge_recon_loss: 25833896.8135; train_gene_expr_recon_loss: 5830605.9495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31700389.2584; train_optim_loss: 31700389.2584; val_kl_reg_loss: 35246.5458; val_edge_recon_loss: 26330501.9726; val_gene_expr_recon_loss: 5815044.2260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32180792.6986; val_optim_loss: 32180792.6986
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9836; val_auprc_score: 0.9806; val_best_acc_score: 0.9411; val_best_f1_score: 0.9424; train_kl_reg_loss: 36293.7657; train_edge_recon_loss: 25832633.2416; train_gene_expr_recon_loss: 5826896.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31695823.3547; train_optim_loss: 31695823.3547; val_kl_reg_loss: 35499.3802; val_edge_recon_loss: 26332846.7945; val_gene_expr_recon_loss: 5820922.6712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32189268.8630; val_optim_loss: 32189268.8630
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9834; val_auprc_score: 0.9804; val_best_acc_score: 0.9410; val_best_f1_score: 0.9422; train_kl_reg_loss: 36435.7646; train_edge_recon_loss: 25830231.2538; train_gene_expr_recon_loss: 5824465.3234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31691132.3425; train_optim_loss: 31691132.3425; val_kl_reg_loss: 35502.0199; val_edge_recon_loss: 26357685.0137; val_gene_expr_recon_loss: 5826602.0308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32219789.1370; val_optim_loss: 32219789.1370
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9836; val_auprc_score: 0.9806; val_best_acc_score: 0.9414; val_best_f1_score: 0.9425; train_kl_reg_loss: 36362.6460; train_edge_recon_loss: 25833873.5489; train_gene_expr_recon_loss: 5825692.2458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31695928.4480; train_optim_loss: 31695928.4480; val_kl_reg_loss: 35414.0957; val_edge_recon_loss: 26333124.7123; val_gene_expr_recon_loss: 5831446.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32199985.6164; val_optim_loss: 32199985.6164
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9835; val_auprc_score: 0.9808; val_best_acc_score: 0.9406; val_best_f1_score: 0.9417; train_kl_reg_loss: 36581.3453; train_edge_recon_loss: 25829030.7508; train_gene_expr_recon_loss: 5823975.9075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31689587.9862; train_optim_loss: 31689587.9862; val_kl_reg_loss: 35643.6241; val_edge_recon_loss: 26370467.7945; val_gene_expr_recon_loss: 5824332.7603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32230444.0959; val_optim_loss: 32230444.0959

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9836; val_auprc_score: 0.9806; val_best_acc_score: 0.9413; val_best_f1_score: 0.9421; train_kl_reg_loss: 36541.9684; train_edge_recon_loss: 25826293.1346; train_gene_expr_recon_loss: 5812564.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31675399.9725; train_optim_loss: 31675399.9725; val_kl_reg_loss: 35696.6657; val_edge_recon_loss: 26353225.2055; val_gene_expr_recon_loss: 5800923.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32189845.3014; val_optim_loss: 32189845.3014
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9832; val_auprc_score: 0.9801; val_best_acc_score: 0.9404; val_best_f1_score: 0.9415; train_kl_reg_loss: 36553.6017; train_edge_recon_loss: 25820562.9297; train_gene_expr_recon_loss: 5813480.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31670596.6560; train_optim_loss: 31670596.6560; val_kl_reg_loss: 35684.2969; val_edge_recon_loss: 26349749.7123; val_gene_expr_recon_loss: 5811155.0548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32196589.2192; val_optim_loss: 32196589.2192
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9834; val_auprc_score: 0.9804; val_best_acc_score: 0.9403; val_best_f1_score: 0.9416; train_kl_reg_loss: 36560.9074; train_edge_recon_loss: 25819878.6621; train_gene_expr_recon_loss: 5815215.0287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31671654.5994; train_optim_loss: 31671654.5994; val_kl_reg_loss: 35676.9474; val_edge_recon_loss: 26366423.6849; val_gene_expr_recon_loss: 5807707.1541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32209807.8630; val_optim_loss: 32209807.8630
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9834; val_auprc_score: 0.9804; val_best_acc_score: 0.9404; val_best_f1_score: 0.9415; train_kl_reg_loss: 36581.5536; train_edge_recon_loss: 25826840.2141; train_gene_expr_recon_loss: 5811227.9908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31674649.7431; train_optim_loss: 31674649.7431; val_kl_reg_loss: 35814.8622; val_edge_recon_loss: 26369706.0685; val_gene_expr_recon_loss: 5813718.4075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32219239.2740; val_optim_loss: 32219239.2740

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 116 min 19 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9836
Val AUPRC score: 0.9807
Val best accuracy score: 0.9410
Val best F1 score: 0.9420
Val gene expr MSE score: 1.4843

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
