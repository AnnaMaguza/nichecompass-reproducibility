None
Run timestamp: 30062023_121610_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9821; val_auprc_score: 0.9751; val_best_acc_score: 0.9483; val_best_f1_score: 0.9495; train_kl_reg_loss: 7640.1576; train_edge_recon_loss: 270384.5445; train_gene_expr_recon_loss: 128894.9256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406919.6287; train_optim_loss: 406919.6287; val_kl_reg_loss: 7572.5311; val_edge_recon_loss: 261852.6258; val_gene_expr_recon_loss: 115799.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385224.3056; val_optim_loss: 385224.3056
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9864; val_auprc_score: 0.9812; val_best_acc_score: 0.9580; val_best_f1_score: 0.9590; train_kl_reg_loss: 7510.4855; train_edge_recon_loss: 261552.5480; train_gene_expr_recon_loss: 112554.1521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381617.1855; train_optim_loss: 381617.1855; val_kl_reg_loss: 7155.0117; val_edge_recon_loss: 260845.9783; val_gene_expr_recon_loss: 109869.6035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377870.5922; val_optim_loss: 377870.5922
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9878; val_auprc_score: 0.9834; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 7217.3747; train_edge_recon_loss: 260518.6482; train_gene_expr_recon_loss: 108245.7226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375981.7452; train_optim_loss: 375981.7452; val_kl_reg_loss: 7045.0269; val_edge_recon_loss: 260231.5709; val_gene_expr_recon_loss: 106654.1115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373930.7066; val_optim_loss: 373930.7066
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9896; val_auprc_score: 0.9861; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 7082.8831; train_edge_recon_loss: 260012.9602; train_gene_expr_recon_loss: 105525.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372621.3802; train_optim_loss: 372621.3802; val_kl_reg_loss: 6943.4566; val_edge_recon_loss: 260023.3457; val_gene_expr_recon_loss: 104647.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371614.1532; val_optim_loss: 371614.1532
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9904; val_auprc_score: 0.9871; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 6970.6804; train_edge_recon_loss: 259852.8235; train_gene_expr_recon_loss: 103418.0397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370241.5430; train_optim_loss: 370241.5430; val_kl_reg_loss: 6861.1613; val_edge_recon_loss: 259511.4505; val_gene_expr_recon_loss: 102910.0010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369282.6120; val_optim_loss: 369282.6120
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9912; val_auprc_score: 0.9884; val_best_acc_score: 0.9673; val_best_f1_score: 0.9679; train_kl_reg_loss: 6899.8164; train_edge_recon_loss: 259620.2919; train_gene_expr_recon_loss: 101941.5377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368461.6464; train_optim_loss: 368461.6464; val_kl_reg_loss: 6689.2216; val_edge_recon_loss: 259231.7748; val_gene_expr_recon_loss: 101713.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367634.7035; val_optim_loss: 367634.7035
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9684; val_best_f1_score: 0.9690; train_kl_reg_loss: 6836.7891; train_edge_recon_loss: 259337.0397; train_gene_expr_recon_loss: 100748.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366922.0255; train_optim_loss: 366922.0255; val_kl_reg_loss: 6811.2978; val_edge_recon_loss: 259229.2752; val_gene_expr_recon_loss: 100438.2313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366478.8064; val_optim_loss: 366478.8064
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 6796.5396; train_edge_recon_loss: 259037.4633; train_gene_expr_recon_loss: 99743.5177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365577.5215; train_optim_loss: 365577.5215; val_kl_reg_loss: 6653.2911; val_edge_recon_loss: 259032.9402; val_gene_expr_recon_loss: 99703.4491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365389.6814; val_optim_loss: 365389.6814
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9921; val_auprc_score: 0.9895; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 6757.6400; train_edge_recon_loss: 258859.4864; train_gene_expr_recon_loss: 98862.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364479.7548; train_optim_loss: 364479.7548; val_kl_reg_loss: 6642.5669; val_edge_recon_loss: 258750.8121; val_gene_expr_recon_loss: 99247.6993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364641.0785; val_optim_loss: 364641.0785
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9904; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 6728.4775; train_edge_recon_loss: 258744.6663; train_gene_expr_recon_loss: 98223.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363696.7767; train_optim_loss: 363696.7767; val_kl_reg_loss: 6599.0462; val_edge_recon_loss: 258416.0766; val_gene_expr_recon_loss: 98851.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363866.2950; val_optim_loss: 363866.2950
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9928; val_auprc_score: 0.9904; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 6697.3501; train_edge_recon_loss: 258571.1794; train_gene_expr_recon_loss: 97620.9850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362889.5124; train_optim_loss: 362889.5124; val_kl_reg_loss: 6626.7570; val_edge_recon_loss: 258541.7713; val_gene_expr_recon_loss: 98541.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363709.6380; val_optim_loss: 363709.6380
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9930; val_auprc_score: 0.9909; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 6672.3472; train_edge_recon_loss: 258403.2728; train_gene_expr_recon_loss: 97116.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362192.1883; train_optim_loss: 362192.1883; val_kl_reg_loss: 6596.9322; val_edge_recon_loss: 258381.6886; val_gene_expr_recon_loss: 98058.6359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363037.2591; val_optim_loss: 363037.2591
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9936; val_auprc_score: 0.9918; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 6652.7769; train_edge_recon_loss: 258332.7421; train_gene_expr_recon_loss: 96670.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361655.6996; train_optim_loss: 361655.6996; val_kl_reg_loss: 6576.5833; val_edge_recon_loss: 258210.3377; val_gene_expr_recon_loss: 97706.5444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362493.4672; val_optim_loss: 362493.4672
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 6641.1889; train_edge_recon_loss: 258018.5604; train_gene_expr_recon_loss: 96415.2525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361075.0019; train_optim_loss: 361075.0019; val_kl_reg_loss: 6509.9397; val_edge_recon_loss: 258264.1101; val_gene_expr_recon_loss: 97413.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362187.0610; val_optim_loss: 362187.0610
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 6633.8159; train_edge_recon_loss: 257939.7909; train_gene_expr_recon_loss: 95974.5459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360548.1524; train_optim_loss: 360548.1524; val_kl_reg_loss: 6538.0467; val_edge_recon_loss: 258317.1147; val_gene_expr_recon_loss: 97212.4261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362067.5838; val_optim_loss: 362067.5838
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 6623.2390; train_edge_recon_loss: 257884.1238; train_gene_expr_recon_loss: 95763.3452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360270.7067; train_optim_loss: 360270.7067; val_kl_reg_loss: 6570.1493; val_edge_recon_loss: 257476.5713; val_gene_expr_recon_loss: 97359.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361406.5572; val_optim_loss: 361406.5572
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 6611.2637; train_edge_recon_loss: 257870.2705; train_gene_expr_recon_loss: 95535.3271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360016.8618; train_optim_loss: 360016.8618; val_kl_reg_loss: 6508.7443; val_edge_recon_loss: 257763.9108; val_gene_expr_recon_loss: 96886.4274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361159.0831; val_optim_loss: 361159.0831
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 6612.4478; train_edge_recon_loss: 257743.2353; train_gene_expr_recon_loss: 95135.2267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359490.9093; train_optim_loss: 359490.9093; val_kl_reg_loss: 6544.5349; val_edge_recon_loss: 257876.7931; val_gene_expr_recon_loss: 97041.6881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361463.0168; val_optim_loss: 361463.0168
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 6611.8475; train_edge_recon_loss: 257596.6874; train_gene_expr_recon_loss: 94954.3155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359162.8499; train_optim_loss: 359162.8499; val_kl_reg_loss: 6550.0634; val_edge_recon_loss: 257348.5846; val_gene_expr_recon_loss: 97071.8114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360970.4527; val_optim_loss: 360970.4527
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 6614.7648; train_edge_recon_loss: 257510.0416; train_gene_expr_recon_loss: 94822.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358947.1914; train_optim_loss: 358947.1914; val_kl_reg_loss: 6558.3846; val_edge_recon_loss: 257705.3639; val_gene_expr_recon_loss: 96928.2651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361192.0137; val_optim_loss: 361192.0137
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 6613.7298; train_edge_recon_loss: 257393.6768; train_gene_expr_recon_loss: 94576.9589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358584.3652; train_optim_loss: 358584.3652; val_kl_reg_loss: 6550.4927; val_edge_recon_loss: 257472.4661; val_gene_expr_recon_loss: 97051.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361074.4345; val_optim_loss: 361074.4345
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 6616.2337; train_edge_recon_loss: 257421.9313; train_gene_expr_recon_loss: 94360.7196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358398.8849; train_optim_loss: 358398.8849; val_kl_reg_loss: 6582.5541; val_edge_recon_loss: 257357.6574; val_gene_expr_recon_loss: 96809.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360749.2660; val_optim_loss: 360749.2660
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6616.9181; train_edge_recon_loss: 257311.8969; train_gene_expr_recon_loss: 94224.0870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358152.9017; train_optim_loss: 358152.9017; val_kl_reg_loss: 6552.5855; val_edge_recon_loss: 257315.8895; val_gene_expr_recon_loss: 96731.7828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360600.2561; val_optim_loss: 360600.2561
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6620.3928; train_edge_recon_loss: 257329.5331; train_gene_expr_recon_loss: 94028.8377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357978.7648; train_optim_loss: 357978.7648; val_kl_reg_loss: 6559.4837; val_edge_recon_loss: 257168.6280; val_gene_expr_recon_loss: 96632.4653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360360.5755; val_optim_loss: 360360.5755
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 6624.9013; train_edge_recon_loss: 257358.1056; train_gene_expr_recon_loss: 93913.4679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357896.4767; train_optim_loss: 357896.4767; val_kl_reg_loss: 6573.5770; val_edge_recon_loss: 257535.8068; val_gene_expr_recon_loss: 96680.9708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360790.3575; val_optim_loss: 360790.3575
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9937; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6632.5793; train_edge_recon_loss: 257106.2640; train_gene_expr_recon_loss: 93679.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357418.2206; train_optim_loss: 357418.2206; val_kl_reg_loss: 6590.0295; val_edge_recon_loss: 257154.9017; val_gene_expr_recon_loss: 96748.9059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360493.8384; val_optim_loss: 360493.8384
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6642.4029; train_edge_recon_loss: 257162.7880; train_gene_expr_recon_loss: 93515.0481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357320.2380; train_optim_loss: 357320.2380; val_kl_reg_loss: 6600.2681; val_edge_recon_loss: 257186.1845; val_gene_expr_recon_loss: 96806.0659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360592.5183; val_optim_loss: 360592.5183
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 6646.0654; train_edge_recon_loss: 257189.0302; train_gene_expr_recon_loss: 93391.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357226.2785; train_optim_loss: 357226.2785; val_kl_reg_loss: 6534.9513; val_edge_recon_loss: 257373.5053; val_gene_expr_recon_loss: 96688.8512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360597.3079; val_optim_loss: 360597.3079

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6656.1375; train_edge_recon_loss: 257017.7115; train_gene_expr_recon_loss: 92652.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356326.7691; train_optim_loss: 356326.7691; val_kl_reg_loss: 6594.1746; val_edge_recon_loss: 257277.6155; val_gene_expr_recon_loss: 96317.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360189.1502; val_optim_loss: 360189.1502
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 6649.5034; train_edge_recon_loss: 256999.1536; train_gene_expr_recon_loss: 92618.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356266.7139; train_optim_loss: 356266.7139; val_kl_reg_loss: 6579.2404; val_edge_recon_loss: 256991.7530; val_gene_expr_recon_loss: 96458.6315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360029.6235; val_optim_loss: 360029.6235
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6645.4456; train_edge_recon_loss: 256990.0450; train_gene_expr_recon_loss: 92513.2205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356148.7104; train_optim_loss: 356148.7104; val_kl_reg_loss: 6572.6820; val_edge_recon_loss: 257221.6303; val_gene_expr_recon_loss: 96384.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360178.5739; val_optim_loss: 360178.5739
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6642.8624; train_edge_recon_loss: 257030.4091; train_gene_expr_recon_loss: 92493.8941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356167.1653; train_optim_loss: 356167.1653; val_kl_reg_loss: 6566.2514; val_edge_recon_loss: 257033.5808; val_gene_expr_recon_loss: 96550.2889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360150.1197; val_optim_loss: 360150.1197
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6649.4323; train_edge_recon_loss: 256925.9604; train_gene_expr_recon_loss: 92437.5397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356012.9333; train_optim_loss: 356012.9333; val_kl_reg_loss: 6595.4344; val_edge_recon_loss: 256965.0015; val_gene_expr_recon_loss: 96515.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360076.1959; val_optim_loss: 360076.1959
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6651.1317; train_edge_recon_loss: 256850.5144; train_gene_expr_recon_loss: 92382.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355883.6948; train_optim_loss: 355883.6948; val_kl_reg_loss: 6579.4278; val_edge_recon_loss: 256910.0335; val_gene_expr_recon_loss: 96782.8329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360272.2950; val_optim_loss: 360272.2950

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6650.3081; train_edge_recon_loss: 256915.1865; train_gene_expr_recon_loss: 92279.8834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355845.3789; train_optim_loss: 355845.3789; val_kl_reg_loss: 6578.2583; val_edge_recon_loss: 257261.8133; val_gene_expr_recon_loss: 96498.8298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360338.9017; val_optim_loss: 360338.9017
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 6647.2659; train_edge_recon_loss: 256964.4037; train_gene_expr_recon_loss: 92354.6716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355966.3421; train_optim_loss: 355966.3421; val_kl_reg_loss: 6570.0584; val_edge_recon_loss: 256865.9646; val_gene_expr_recon_loss: 96494.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359930.5808; val_optim_loss: 359930.5808
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6647.4725; train_edge_recon_loss: 256985.6886; train_gene_expr_recon_loss: 92245.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355878.7189; train_optim_loss: 355878.7189; val_kl_reg_loss: 6572.3621; val_edge_recon_loss: 257334.6620; val_gene_expr_recon_loss: 96513.5669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360420.5892; val_optim_loss: 360420.5892
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 6644.8726; train_edge_recon_loss: 256973.8870; train_gene_expr_recon_loss: 92242.2215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355860.9823; train_optim_loss: 355860.9823; val_kl_reg_loss: 6575.7246; val_edge_recon_loss: 256762.8422; val_gene_expr_recon_loss: 96503.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359842.0252; val_optim_loss: 359842.0252
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6650.3208; train_edge_recon_loss: 256856.6173; train_gene_expr_recon_loss: 92274.3207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355781.2587; train_optim_loss: 355781.2587; val_kl_reg_loss: 6578.0370; val_edge_recon_loss: 256857.7538; val_gene_expr_recon_loss: 96680.4594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360116.2523; val_optim_loss: 360116.2523
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6649.8330; train_edge_recon_loss: 256896.5987; train_gene_expr_recon_loss: 92335.2640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355881.6944; train_optim_loss: 355881.6944; val_kl_reg_loss: 6576.3721; val_edge_recon_loss: 257040.6772; val_gene_expr_recon_loss: 96542.8965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360159.9444; val_optim_loss: 360159.9444
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6646.7047; train_edge_recon_loss: 256937.0773; train_gene_expr_recon_loss: 92269.9503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355853.7324; train_optim_loss: 355853.7324; val_kl_reg_loss: 6571.3347; val_edge_recon_loss: 257240.8780; val_gene_expr_recon_loss: 96530.2668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360342.4794; val_optim_loss: 360342.4794
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6647.2834; train_edge_recon_loss: 256826.5107; train_gene_expr_recon_loss: 92235.2815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355709.0763; train_optim_loss: 355709.0763; val_kl_reg_loss: 6578.6239; val_edge_recon_loss: 256810.4848; val_gene_expr_recon_loss: 96582.9840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359972.0938; val_optim_loss: 359972.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6649.8994; train_edge_recon_loss: 256854.0106; train_gene_expr_recon_loss: 92227.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355731.2721; train_optim_loss: 355731.2721; val_kl_reg_loss: 6577.8457; val_edge_recon_loss: 257037.4775; val_gene_expr_recon_loss: 96660.1099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360275.4329; val_optim_loss: 360275.4329
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6649.0485; train_edge_recon_loss: 256934.4812; train_gene_expr_recon_loss: 92245.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355829.2659; train_optim_loss: 355829.2659; val_kl_reg_loss: 6576.8658; val_edge_recon_loss: 257129.8175; val_gene_expr_recon_loss: 96623.2041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360329.8887; val_optim_loss: 360329.8887
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6648.5363; train_edge_recon_loss: 256942.9458; train_gene_expr_recon_loss: 92244.8913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355836.3721; train_optim_loss: 355836.3721; val_kl_reg_loss: 6575.5282; val_edge_recon_loss: 256833.6547; val_gene_expr_recon_loss: 96268.4907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359677.6723; val_optim_loss: 359677.6723
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 6649.5469; train_edge_recon_loss: 256851.4671; train_gene_expr_recon_loss: 92260.9564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355761.9700; train_optim_loss: 355761.9700; val_kl_reg_loss: 6573.5503; val_edge_recon_loss: 256857.0396; val_gene_expr_recon_loss: 96455.3144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359885.9017; val_optim_loss: 359885.9017
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6648.2052; train_edge_recon_loss: 256920.5329; train_gene_expr_recon_loss: 92266.7836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355835.5224; train_optim_loss: 355835.5224; val_kl_reg_loss: 6572.1582; val_edge_recon_loss: 256640.0149; val_gene_expr_recon_loss: 96394.3632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359606.5366; val_optim_loss: 359606.5366
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6647.1774; train_edge_recon_loss: 256963.1520; train_gene_expr_recon_loss: 92234.8437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355845.1726; train_optim_loss: 355845.1726; val_kl_reg_loss: 6574.5099; val_edge_recon_loss: 256954.6147; val_gene_expr_recon_loss: 96426.5295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359955.6524; val_optim_loss: 359955.6524
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6648.0646; train_edge_recon_loss: 256893.5389; train_gene_expr_recon_loss: 92270.6086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355812.2112; train_optim_loss: 355812.2112; val_kl_reg_loss: 6572.5358; val_edge_recon_loss: 257040.0617; val_gene_expr_recon_loss: 96668.7494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360281.3460; val_optim_loss: 360281.3460
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6646.6259; train_edge_recon_loss: 256824.7708; train_gene_expr_recon_loss: 92212.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355683.8815; train_optim_loss: 355683.8815; val_kl_reg_loss: 6574.6910; val_edge_recon_loss: 256913.2999; val_gene_expr_recon_loss: 96576.0873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360064.0777; val_optim_loss: 360064.0777
heaps
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6649.2569; train_edge_recon_loss: 256908.0955; train_gene_expr_recon_loss: 92284.7874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355842.1388; train_optim_loss: 355842.1388; val_kl_reg_loss: 6574.2405; val_edge_recon_loss: 257060.4002; val_gene_expr_recon_loss: 96430.5109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360065.1502; val_optim_loss: 360065.1502

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

heaps
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6648.8273; train_edge_recon_loss: 256926.0691; train_gene_expr_recon_loss: 92230.3111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355805.2073; train_optim_loss: 355805.2073; val_kl_reg_loss: 6574.7285; val_edge_recon_loss: 256818.9950; val_gene_expr_recon_loss: 96302.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359696.1319; val_optim_loss: 359696.1319
heaps
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6648.6221; train_edge_recon_loss: 256821.9477; train_gene_expr_recon_loss: 92298.1219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355768.6923; train_optim_loss: 355768.6923; val_kl_reg_loss: 6573.4944; val_edge_recon_loss: 256980.9524; val_gene_expr_recon_loss: 96440.0111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359994.4604; val_optim_loss: 359994.4604
heaps
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 6648.3832; train_edge_recon_loss: 256844.5371; train_gene_expr_recon_loss: 92209.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355702.4666; train_optim_loss: 355702.4666; val_kl_reg_loss: 6575.3811; val_edge_recon_loss: 256883.0777; val_gene_expr_recon_loss: 96526.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359984.5587; val_optim_loss: 359984.5587
heaps
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 6648.8923; train_edge_recon_loss: 256905.3435; train_gene_expr_recon_loss: 92262.3330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355816.5681; train_optim_loss: 355816.5681; val_kl_reg_loss: 6572.5089; val_edge_recon_loss: 257009.0393; val_gene_expr_recon_loss: 96648.4947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360230.0404; val_optim_loss: 360230.0404

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 163 min 57 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9949
Val best accuracy score: 0.9802
Val best F1 score: 0.9804
Val gene expr MSE score: 0.6188

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
