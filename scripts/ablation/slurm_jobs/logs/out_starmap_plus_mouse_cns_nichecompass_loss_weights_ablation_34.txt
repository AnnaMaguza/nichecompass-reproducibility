None
Run timestamp: 02072023_141733_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9820; val_auprc_score: 0.9748; val_best_acc_score: 0.9489; val_best_f1_score: 0.9503; train_kl_reg_loss: 7758.9009; train_edge_recon_loss: 270399.5284; train_gene_expr_recon_loss: 127655.5259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405813.9554; train_optim_loss: 405813.9554; val_kl_reg_loss: 7712.0648; val_edge_recon_loss: 261879.6704; val_gene_expr_recon_loss: 114731.0364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384322.7736; val_optim_loss: 384322.7736
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9864; val_auprc_score: 0.9813; val_best_acc_score: 0.9570; val_best_f1_score: 0.9579; train_kl_reg_loss: 7580.8046; train_edge_recon_loss: 261300.1695; train_gene_expr_recon_loss: 111110.2340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379991.2085; train_optim_loss: 379991.2085; val_kl_reg_loss: 7121.5163; val_edge_recon_loss: 260497.8415; val_gene_expr_recon_loss: 108523.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376143.2302; val_optim_loss: 376143.2302
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9842; val_best_acc_score: 0.9601; val_best_f1_score: 0.9609; train_kl_reg_loss: 7178.4129; train_edge_recon_loss: 260662.9665; train_gene_expr_recon_loss: 106793.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374634.7202; train_optim_loss: 374634.7202; val_kl_reg_loss: 6996.3018; val_edge_recon_loss: 260432.1200; val_gene_expr_recon_loss: 105066.1517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372494.5709; val_optim_loss: 372494.5709
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9894; val_auprc_score: 0.9858; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 6989.5699; train_edge_recon_loss: 260303.7985; train_gene_expr_recon_loss: 104049.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371342.9361; train_optim_loss: 371342.9361; val_kl_reg_loss: 6770.4737; val_edge_recon_loss: 259709.2035; val_gene_expr_recon_loss: 102636.3569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369116.0389; val_optim_loss: 369116.0389
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9898; val_auprc_score: 0.9863; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 6882.6031; train_edge_recon_loss: 259854.8716; train_gene_expr_recon_loss: 101988.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368726.0229; train_optim_loss: 368726.0229; val_kl_reg_loss: 6640.4368; val_edge_recon_loss: 259890.7180; val_gene_expr_recon_loss: 101156.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367687.5495; val_optim_loss: 367687.5495
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9904; val_auprc_score: 0.9870; val_best_acc_score: 0.9673; val_best_f1_score: 0.9679; train_kl_reg_loss: 6797.6857; train_edge_recon_loss: 259573.6483; train_gene_expr_recon_loss: 100452.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366824.0684; train_optim_loss: 366824.0684; val_kl_reg_loss: 6619.7568; val_edge_recon_loss: 259397.9150; val_gene_expr_recon_loss: 99794.5534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365812.2233; val_optim_loss: 365812.2233
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9906; val_auprc_score: 0.9870; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 6726.1767; train_edge_recon_loss: 259209.2388; train_gene_expr_recon_loss: 99256.5701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365191.9857; train_optim_loss: 365191.9857; val_kl_reg_loss: 6668.6408; val_edge_recon_loss: 258692.5896; val_gene_expr_recon_loss: 99118.5112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364479.7409; val_optim_loss: 364479.7409
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 6665.6533; train_edge_recon_loss: 258970.2703; train_gene_expr_recon_loss: 98305.8835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363941.8069; train_optim_loss: 363941.8069; val_kl_reg_loss: 6493.6230; val_edge_recon_loss: 258478.0953; val_gene_expr_recon_loss: 98219.3826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363191.0991; val_optim_loss: 363191.0991
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9918; val_auprc_score: 0.9890; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 6616.1815; train_edge_recon_loss: 258867.4973; train_gene_expr_recon_loss: 97379.5353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362863.2148; train_optim_loss: 362863.2148; val_kl_reg_loss: 6410.5067; val_edge_recon_loss: 258528.7969; val_gene_expr_recon_loss: 97552.9886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362492.2934; val_optim_loss: 362492.2934
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 6577.4760; train_edge_recon_loss: 258623.7433; train_gene_expr_recon_loss: 96857.7689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362058.9883; train_optim_loss: 362058.9883; val_kl_reg_loss: 6448.9623; val_edge_recon_loss: 258291.6974; val_gene_expr_recon_loss: 96835.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361575.7889; val_optim_loss: 361575.7889
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 6541.4144; train_edge_recon_loss: 258475.8451; train_gene_expr_recon_loss: 96285.4255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361302.6854; train_optim_loss: 361302.6854; val_kl_reg_loss: 6472.8022; val_edge_recon_loss: 258237.2393; val_gene_expr_recon_loss: 96456.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361166.5838; val_optim_loss: 361166.5838
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 6503.7793; train_edge_recon_loss: 258316.1804; train_gene_expr_recon_loss: 95861.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360681.5892; train_optim_loss: 360681.5892; val_kl_reg_loss: 6469.4651; val_edge_recon_loss: 258600.0896; val_gene_expr_recon_loss: 96443.5776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361513.1349; val_optim_loss: 361513.1349
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 6474.6037; train_edge_recon_loss: 258271.6349; train_gene_expr_recon_loss: 95485.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360232.0976; train_optim_loss: 360232.0976; val_kl_reg_loss: 6420.8018; val_edge_recon_loss: 258112.2656; val_gene_expr_recon_loss: 96198.0760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360731.1463; val_optim_loss: 360731.1463
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 6459.6846; train_edge_recon_loss: 258106.9740; train_gene_expr_recon_loss: 95094.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359660.7947; train_optim_loss: 359660.7947; val_kl_reg_loss: 6352.5340; val_edge_recon_loss: 257629.9939; val_gene_expr_recon_loss: 96003.6412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359986.1715; val_optim_loss: 359986.1715
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 6439.0359; train_edge_recon_loss: 258002.1340; train_gene_expr_recon_loss: 94705.0542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359146.2237; train_optim_loss: 359146.2237; val_kl_reg_loss: 6326.2559; val_edge_recon_loss: 258222.7923; val_gene_expr_recon_loss: 95858.2948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360407.3422; val_optim_loss: 360407.3422
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 6429.6548; train_edge_recon_loss: 257903.8685; train_gene_expr_recon_loss: 94503.4147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358836.9380; train_optim_loss: 358836.9380; val_kl_reg_loss: 6378.3643; val_edge_recon_loss: 257572.5137; val_gene_expr_recon_loss: 95778.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359728.9771; val_optim_loss: 359728.9771
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 6416.3210; train_edge_recon_loss: 257837.3569; train_gene_expr_recon_loss: 94298.3416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358552.0193; train_optim_loss: 358552.0193; val_kl_reg_loss: 6405.5673; val_edge_recon_loss: 257719.9577; val_gene_expr_recon_loss: 95715.1704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359840.6944; val_optim_loss: 359840.6944
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 6406.5990; train_edge_recon_loss: 257748.8037; train_gene_expr_recon_loss: 94056.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358211.4862; train_optim_loss: 358211.4862; val_kl_reg_loss: 6233.9182; val_edge_recon_loss: 257602.2698; val_gene_expr_recon_loss: 95599.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359435.2896; val_optim_loss: 359435.2896
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 6405.3399; train_edge_recon_loss: 257542.8715; train_gene_expr_recon_loss: 93711.0817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357659.2935; train_optim_loss: 357659.2935; val_kl_reg_loss: 6252.1390; val_edge_recon_loss: 257370.4002; val_gene_expr_recon_loss: 95481.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359104.1799; val_optim_loss: 359104.1799
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 6399.3506; train_edge_recon_loss: 257553.4278; train_gene_expr_recon_loss: 93480.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357433.6024; train_optim_loss: 357433.6024; val_kl_reg_loss: 6351.9600; val_edge_recon_loss: 257759.4745; val_gene_expr_recon_loss: 95472.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359583.4466; val_optim_loss: 359583.4466
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 6392.3043; train_edge_recon_loss: 257481.7092; train_gene_expr_recon_loss: 93378.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357252.7793; train_optim_loss: 357252.7793; val_kl_reg_loss: 6334.2795; val_edge_recon_loss: 257247.6364; val_gene_expr_recon_loss: 95356.6766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358938.5907; val_optim_loss: 358938.5907
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 6397.4860; train_edge_recon_loss: 257348.3902; train_gene_expr_recon_loss: 93158.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356904.4373; train_optim_loss: 356904.4373; val_kl_reg_loss: 6363.6273; val_edge_recon_loss: 257621.6643; val_gene_expr_recon_loss: 95219.7595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359205.0526; val_optim_loss: 359205.0526
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 6400.9415; train_edge_recon_loss: 257269.9418; train_gene_expr_recon_loss: 92991.8201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356662.7030; train_optim_loss: 356662.7030; val_kl_reg_loss: 6242.8886; val_edge_recon_loss: 257118.7580; val_gene_expr_recon_loss: 95108.6073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358470.2523; val_optim_loss: 358470.2523
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 6396.4941; train_edge_recon_loss: 257270.5479; train_gene_expr_recon_loss: 92905.0269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356572.0686; train_optim_loss: 356572.0686; val_kl_reg_loss: 6265.1111; val_edge_recon_loss: 257179.2393; val_gene_expr_recon_loss: 95089.5038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358533.8544; val_optim_loss: 358533.8544
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6397.4574; train_edge_recon_loss: 257212.3208; train_gene_expr_recon_loss: 92726.0915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356335.8692; train_optim_loss: 356335.8692; val_kl_reg_loss: 6323.1326; val_edge_recon_loss: 257009.9668; val_gene_expr_recon_loss: 95133.2662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358466.3666; val_optim_loss: 358466.3666
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 6398.8222; train_edge_recon_loss: 257144.7284; train_gene_expr_recon_loss: 92471.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356015.4293; train_optim_loss: 356015.4293; val_kl_reg_loss: 6329.9003; val_edge_recon_loss: 257264.3171; val_gene_expr_recon_loss: 94933.9392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358528.1540; val_optim_loss: 358528.1540
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6396.9398; train_edge_recon_loss: 257245.4411; train_gene_expr_recon_loss: 92332.3205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355974.7005; train_optim_loss: 355974.7005; val_kl_reg_loss: 6296.3899; val_edge_recon_loss: 256787.2565; val_gene_expr_recon_loss: 95028.4224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358112.0686; val_optim_loss: 358112.0686
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6406.3399; train_edge_recon_loss: 257047.0658; train_gene_expr_recon_loss: 92234.3070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355687.7128; train_optim_loss: 355687.7128; val_kl_reg_loss: 6333.8703; val_edge_recon_loss: 256834.3533; val_gene_expr_recon_loss: 95120.8388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358289.0625; val_optim_loss: 358289.0625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6413.7886; train_edge_recon_loss: 256987.9012; train_gene_expr_recon_loss: 92102.3850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355504.0754; train_optim_loss: 355504.0754; val_kl_reg_loss: 6337.4320; val_edge_recon_loss: 256902.0156; val_gene_expr_recon_loss: 95050.8531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358290.2980; val_optim_loss: 358290.2980
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6414.6590; train_edge_recon_loss: 256986.6912; train_gene_expr_recon_loss: 92053.7853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355455.1364; train_optim_loss: 355455.1364; val_kl_reg_loss: 6343.4300; val_edge_recon_loss: 256802.8068; val_gene_expr_recon_loss: 95189.3676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358335.6014; val_optim_loss: 358335.6014
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6415.6120; train_edge_recon_loss: 256976.0310; train_gene_expr_recon_loss: 91932.5272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355324.1703; train_optim_loss: 355324.1703; val_kl_reg_loss: 6356.0076; val_edge_recon_loss: 257006.3228; val_gene_expr_recon_loss: 95051.8615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358414.1928; val_optim_loss: 358414.1928

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 6424.7331; train_edge_recon_loss: 256745.6339; train_gene_expr_recon_loss: 91340.5389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354510.9051; train_optim_loss: 354510.9051; val_kl_reg_loss: 6343.9816; val_edge_recon_loss: 256712.7961; val_gene_expr_recon_loss: 94636.4777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357693.2569; val_optim_loss: 357693.2569
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6421.5482; train_edge_recon_loss: 256772.3773; train_gene_expr_recon_loss: 91136.0077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354329.9329; train_optim_loss: 354329.9329; val_kl_reg_loss: 6337.1107; val_edge_recon_loss: 256774.9707; val_gene_expr_recon_loss: 94879.5817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357991.6646; val_optim_loss: 357991.6646
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6411.8252; train_edge_recon_loss: 256796.8342; train_gene_expr_recon_loss: 91015.5984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354224.2579; train_optim_loss: 354224.2579; val_kl_reg_loss: 6329.5958; val_edge_recon_loss: 256776.7008; val_gene_expr_recon_loss: 94919.8921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358026.1890; val_optim_loss: 358026.1890
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 6410.1848; train_edge_recon_loss: 256764.2289; train_gene_expr_recon_loss: 90927.4543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354101.8674; train_optim_loss: 354101.8674; val_kl_reg_loss: 6350.2910; val_edge_recon_loss: 256621.0827; val_gene_expr_recon_loss: 95134.1138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358105.4886; val_optim_loss: 358105.4886
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 6414.3721; train_edge_recon_loss: 256669.9949; train_gene_expr_recon_loss: 91016.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354100.4749; train_optim_loss: 354100.4749; val_kl_reg_loss: 6334.3878; val_edge_recon_loss: 257176.8098; val_gene_expr_recon_loss: 95053.2199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358564.4154; val_optim_loss: 358564.4154

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 6409.8486; train_edge_recon_loss: 256670.3007; train_gene_expr_recon_loss: 90933.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354013.7320; train_optim_loss: 354013.7320; val_kl_reg_loss: 6337.3698; val_edge_recon_loss: 256577.5408; val_gene_expr_recon_loss: 94797.2146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357712.1265; val_optim_loss: 357712.1265
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6408.6163; train_edge_recon_loss: 256880.9191; train_gene_expr_recon_loss: 90977.9774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354267.5133; train_optim_loss: 354267.5133; val_kl_reg_loss: 6336.3594; val_edge_recon_loss: 256743.2294; val_gene_expr_recon_loss: 94881.4476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357961.0335; val_optim_loss: 357961.0335
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6411.2729; train_edge_recon_loss: 256582.2166; train_gene_expr_recon_loss: 90886.6534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353880.1440; train_optim_loss: 353880.1440; val_kl_reg_loss: 6336.4918; val_edge_recon_loss: 256653.6753; val_gene_expr_recon_loss: 94877.5979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357867.7637; val_optim_loss: 357867.7637
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 6408.4194; train_edge_recon_loss: 256768.2899; train_gene_expr_recon_loss: 90957.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354134.0615; train_optim_loss: 354134.0615; val_kl_reg_loss: 6331.2986; val_edge_recon_loss: 256787.6052; val_gene_expr_recon_loss: 94690.5838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357809.4886; val_optim_loss: 357809.4886

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 107 min 9 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9953
Val best accuracy score: 0.9808
Val best F1 score: 0.9809
Val gene expr MSE score: 0.6492

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
