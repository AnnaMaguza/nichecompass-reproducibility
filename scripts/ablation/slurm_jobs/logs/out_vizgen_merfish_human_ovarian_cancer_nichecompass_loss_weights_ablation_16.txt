Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 2303.7897; train_edge_recon_loss: 26853.4945; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29157.2842; train_optim_loss: 29157.2842; val_kl_reg_loss: 2310.9295; val_edge_recon_loss: 25596.5604; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27907.4900; val_optim_loss: 27907.4900
None
Run timestamp: 06072023_004642_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9669; val_best_f1_score: 0.9671; train_kl_reg_loss: 2183.2159; train_edge_recon_loss: 27536.9755; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29720.1915; train_optim_loss: 29720.1915; val_kl_reg_loss: 2101.2556; val_edge_recon_loss: 26010.3756; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28111.6312; val_optim_loss: 28111.6312
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 2303.7093; train_edge_recon_loss: 26854.8581; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29158.5675; train_optim_loss: 29158.5675; val_kl_reg_loss: 2310.4127; val_edge_recon_loss: 25603.7382; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27914.1510; val_optim_loss: 27914.1510
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 2261.5239; train_edge_recon_loss: 27171.9855; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29433.5093; train_optim_loss: 29433.5093; val_kl_reg_loss: 2294.1336; val_edge_recon_loss: 25916.4055; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28210.5391; val_optim_loss: 28210.5391

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 2303.3982; train_edge_recon_loss: 26850.5613; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29153.9595; train_optim_loss: 29153.9595; val_kl_reg_loss: 2310.4484; val_edge_recon_loss: 25615.7936; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27926.2420; val_optim_loss: 27926.2420
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 2273.3250; train_edge_recon_loss: 27108.6999; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29382.0249; train_optim_loss: 29382.0249; val_kl_reg_loss: 2214.4967; val_edge_recon_loss: 25889.2993; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28103.7960; val_optim_loss: 28103.7960
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 2303.3512; train_edge_recon_loss: 26854.3432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29157.6944; train_optim_loss: 29157.6944; val_kl_reg_loss: 2310.4129; val_edge_recon_loss: 25612.0816; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27922.4946; val_optim_loss: 27922.4946
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9792; val_best_f1_score: 0.9792; train_kl_reg_loss: 2279.8039; train_edge_recon_loss: 27065.4542; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29345.2581; train_optim_loss: 29345.2581; val_kl_reg_loss: 2256.2399; val_edge_recon_loss: 25837.9505; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28094.1903; val_optim_loss: 28094.1903
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2282.7515; train_edge_recon_loss: 27036.9096; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29319.6611; train_optim_loss: 29319.6611; val_kl_reg_loss: 2268.8923; val_edge_recon_loss: 25812.9406; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28081.8329; val_optim_loss: 28081.8329
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2303.3832; train_edge_recon_loss: 26854.4312; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29157.8144; train_optim_loss: 29157.8144; val_kl_reg_loss: 2310.2589; val_edge_recon_loss: 25608.7566; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27919.0155; val_optim_loss: 27919.0155
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 2283.4342; train_edge_recon_loss: 27017.6319; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29301.0661; train_optim_loss: 29301.0661; val_kl_reg_loss: 2295.1813; val_edge_recon_loss: 25777.8505; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28073.0318; val_optim_loss: 28073.0318
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 2303.3668; train_edge_recon_loss: 26857.4903; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.8571; train_optim_loss: 29160.8571; val_kl_reg_loss: 2310.3328; val_edge_recon_loss: 25610.3806; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27920.7134; val_optim_loss: 27920.7134
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 2286.4455; train_edge_recon_loss: 26997.3575; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29283.8030; train_optim_loss: 29283.8030; val_kl_reg_loss: 2271.6255; val_edge_recon_loss: 25787.1360; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28058.7614; val_optim_loss: 28058.7614

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1626 min 1 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9990
Val AUPRC score: 0.9987
Val best accuracy score: 0.9889
Val best F1 score: 0.9890
Val gene expr MSE score: 13.7832

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 2288.1608; train_edge_recon_loss: 26981.4823; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29269.6431; train_optim_loss: 29269.6431; val_kl_reg_loss: 2266.1847; val_edge_recon_loss: 25771.8405; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28038.0252; val_optim_loss: 28038.0252
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9848; val_best_f1_score: 0.9848; train_kl_reg_loss: 2289.0741; train_edge_recon_loss: 26973.9665; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29263.0406; train_optim_loss: 29263.0406; val_kl_reg_loss: 2285.5354; val_edge_recon_loss: 25750.4876; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28036.0230; val_optim_loss: 28036.0230
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2290.2946; train_edge_recon_loss: 26964.4417; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29254.7363; train_optim_loss: 29254.7363; val_kl_reg_loss: 2282.3829; val_edge_recon_loss: 25747.3919; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28029.7749; val_optim_loss: 28029.7749
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2291.8682; train_edge_recon_loss: 26950.1419; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29242.0100; train_optim_loss: 29242.0100; val_kl_reg_loss: 2277.6605; val_edge_recon_loss: 25726.0814; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28003.7419; val_optim_loss: 28003.7419
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2292.5208; train_edge_recon_loss: 26944.5707; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29237.0915; train_optim_loss: 29237.0915; val_kl_reg_loss: 2311.6032; val_edge_recon_loss: 25733.0630; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28044.6662; val_optim_loss: 28044.6662
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9858; val_best_f1_score: 0.9858; train_kl_reg_loss: 2293.1593; train_edge_recon_loss: 26937.9982; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29231.1575; train_optim_loss: 29231.1575; val_kl_reg_loss: 2290.6728; val_edge_recon_loss: 25720.5615; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28011.2343; val_optim_loss: 28011.2343
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9857; val_best_f1_score: 0.9857; train_kl_reg_loss: 2294.2924; train_edge_recon_loss: 26930.7245; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29225.0169; train_optim_loss: 29225.0169; val_kl_reg_loss: 2312.9685; val_edge_recon_loss: 25705.1568; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28018.1252; val_optim_loss: 28018.1252
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 2296.0761; train_edge_recon_loss: 26919.6033; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29215.6793; train_optim_loss: 29215.6793; val_kl_reg_loss: 2315.6166; val_edge_recon_loss: 25689.2562; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28004.8728; val_optim_loss: 28004.8728

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 2291.3263; train_edge_recon_loss: 26882.5469; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29173.8733; train_optim_loss: 29173.8733; val_kl_reg_loss: 2296.3323; val_edge_recon_loss: 25660.9378; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27957.2701; val_optim_loss: 27957.2701
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 2290.3237; train_edge_recon_loss: 26876.4442; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29166.7679; train_optim_loss: 29166.7679; val_kl_reg_loss: 2289.5451; val_edge_recon_loss: 25651.4021; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27940.9472; val_optim_loss: 27940.9472
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 2289.7457; train_edge_recon_loss: 26875.2904; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29165.0361; train_optim_loss: 29165.0361; val_kl_reg_loss: 2295.5047; val_edge_recon_loss: 25650.2330; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27945.7376; val_optim_loss: 27945.7376
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 2289.5089; train_edge_recon_loss: 26872.4773; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29161.9862; train_optim_loss: 29161.9862; val_kl_reg_loss: 2288.4478; val_edge_recon_loss: 25658.0342; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27946.4820; val_optim_loss: 27946.4820
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 2288.9134; train_edge_recon_loss: 26871.2229; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.1364; train_optim_loss: 29160.1364; val_kl_reg_loss: 2289.1037; val_edge_recon_loss: 25650.7706; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27939.8743; val_optim_loss: 27939.8743
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 2289.0196; train_edge_recon_loss: 26870.7973; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29159.8170; train_optim_loss: 29159.8170; val_kl_reg_loss: 2284.7773; val_edge_recon_loss: 25639.9439; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27924.7213; val_optim_loss: 27924.7213
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 2288.1536; train_edge_recon_loss: 26872.3160; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29160.4696; train_optim_loss: 29160.4696; val_kl_reg_loss: 2302.9339; val_edge_recon_loss: 25645.7235; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27948.6574; val_optim_loss: 27948.6574
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9988; val_auprc_score: 0.9984; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 2288.6811; train_edge_recon_loss: 26867.3331; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29156.0143; train_optim_loss: 29156.0143; val_kl_reg_loss: 2293.1125; val_edge_recon_loss: 25647.0590; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27940.1714; val_optim_loss: 27940.1714
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2287.6502; train_edge_recon_loss: 26872.1348; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29159.7850; train_optim_loss: 29159.7850; val_kl_reg_loss: 2290.1888; val_edge_recon_loss: 25636.9168; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27927.1056; val_optim_loss: 27927.1056
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2287.8624; train_edge_recon_loss: 26868.5112; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29156.3736; train_optim_loss: 29156.3736; val_kl_reg_loss: 2284.0961; val_edge_recon_loss: 25645.6351; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27929.7312; val_optim_loss: 27929.7312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2287.7079; train_edge_recon_loss: 26863.2361; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29150.9440; train_optim_loss: 29150.9440; val_kl_reg_loss: 2291.6654; val_edge_recon_loss: 25634.3232; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27925.9887; val_optim_loss: 27925.9887
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2288.5764; train_edge_recon_loss: 26856.3206; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29144.8971; train_optim_loss: 29144.8971; val_kl_reg_loss: 2291.5388; val_edge_recon_loss: 25656.1709; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27947.7096; val_optim_loss: 27947.7096
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2288.1633; train_edge_recon_loss: 26858.6015; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29146.7648; train_optim_loss: 29146.7648; val_kl_reg_loss: 2287.6836; val_edge_recon_loss: 25641.5681; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27929.2517; val_optim_loss: 27929.2517
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 2287.6383; train_edge_recon_loss: 26858.2120; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29145.8503; train_optim_loss: 29145.8503; val_kl_reg_loss: 2292.7602; val_edge_recon_loss: 25622.6472; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27915.4074; val_optim_loss: 27915.4074
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2288.0432; train_edge_recon_loss: 26857.9811; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29146.0242; train_optim_loss: 29146.0242; val_kl_reg_loss: 2293.0204; val_edge_recon_loss: 25630.5178; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27923.5382; val_optim_loss: 27923.5382
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 2287.2568; train_edge_recon_loss: 26858.1226; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29145.3794; train_optim_loss: 29145.3794; val_kl_reg_loss: 2291.7140; val_edge_recon_loss: 25642.7675; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27934.4816; val_optim_loss: 27934.4816
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2288.1590; train_edge_recon_loss: 26856.7576; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29144.9166; train_optim_loss: 29144.9166; val_kl_reg_loss: 2293.6208; val_edge_recon_loss: 25647.6794; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27941.3002; val_optim_loss: 27941.3002
