None
Run timestamp: 16072023_153642_1003.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1003']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9895; val_auprc_score: 0.9858; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 12152.3657; train_edge_recon_loss: 2645027.2924; train_gene_expr_recon_loss: 2070459.6196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4727639.2809; train_optim_loss: 4727639.2809; val_kl_reg_loss: 12820.9474; val_edge_recon_loss: 2582203.6313; val_gene_expr_recon_loss: 1977207.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4572232.5375; val_optim_loss: 4572232.5375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 12702.9936; train_edge_recon_loss: 2574040.6815; train_gene_expr_recon_loss: 1950446.5263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4537190.2010; train_optim_loss: 4537190.2010; val_kl_reg_loss: 13015.6604; val_edge_recon_loss: 2573035.3656; val_gene_expr_recon_loss: 1912664.4578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4498715.4938; val_optim_loss: 4498715.4938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9908; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 12996.9161; train_edge_recon_loss: 2566419.1812; train_gene_expr_recon_loss: 1899187.9951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4478604.0932; train_optim_loss: 4478604.0932; val_kl_reg_loss: 13128.2075; val_edge_recon_loss: 2568881.1656; val_gene_expr_recon_loss: 1874181.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4456190.6750; val_optim_loss: 4456190.6750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 13237.7785; train_edge_recon_loss: 2563062.7097; train_gene_expr_recon_loss: 1867875.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4444176.4499; train_optim_loss: 4444176.4499; val_kl_reg_loss: 13341.6577; val_edge_recon_loss: 2562737.1469; val_gene_expr_recon_loss: 1854404.3078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4430483.0812; val_optim_loss: 4430483.0812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 13440.8002; train_edge_recon_loss: 2560134.8168; train_gene_expr_recon_loss: 1845349.6177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4418925.2330; train_optim_loss: 4418925.2330; val_kl_reg_loss: 13446.6867; val_edge_recon_loss: 2563566.3188; val_gene_expr_recon_loss: 1834997.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4412010.5375; val_optim_loss: 4412010.5375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13575.8436; train_edge_recon_loss: 2559310.7072; train_gene_expr_recon_loss: 1827998.6168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4400885.1683; train_optim_loss: 4400885.1683; val_kl_reg_loss: 13606.9244; val_edge_recon_loss: 2561446.7281; val_gene_expr_recon_loss: 1824101.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4399154.8563; val_optim_loss: 4399154.8563
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 13697.5752; train_edge_recon_loss: 2557224.3860; train_gene_expr_recon_loss: 1815162.7364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4386084.7038; train_optim_loss: 4386084.7038; val_kl_reg_loss: 13810.5548; val_edge_recon_loss: 2560948.7437; val_gene_expr_recon_loss: 1812837.6828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4387596.9813; val_optim_loss: 4387596.9813
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 13773.1661; train_edge_recon_loss: 2555720.6944; train_gene_expr_recon_loss: 1805185.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4374679.4200; train_optim_loss: 4374679.4200; val_kl_reg_loss: 13900.1431; val_edge_recon_loss: 2561136.0219; val_gene_expr_recon_loss: 1804032.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4379069.1562; val_optim_loss: 4379069.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 13824.4457; train_edge_recon_loss: 2555356.4402; train_gene_expr_recon_loss: 1794162.3157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4363343.1951; train_optim_loss: 4363343.1951; val_kl_reg_loss: 13902.8116; val_edge_recon_loss: 2557641.3281; val_gene_expr_recon_loss: 1801213.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4372757.7938; val_optim_loss: 4372757.7938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 13906.8751; train_edge_recon_loss: 2554587.6280; train_gene_expr_recon_loss: 1786566.8538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4355061.3588; train_optim_loss: 4355061.3588; val_kl_reg_loss: 13996.2504; val_edge_recon_loss: 2556670.6094; val_gene_expr_recon_loss: 1796998.1891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4367665.0750; val_optim_loss: 4367665.0750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 13952.0294; train_edge_recon_loss: 2553711.4030; train_gene_expr_recon_loss: 1781833.1459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4349496.5821; train_optim_loss: 4349496.5821; val_kl_reg_loss: 13811.0842; val_edge_recon_loss: 2558894.9531; val_gene_expr_recon_loss: 1793971.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4366677.3688; val_optim_loss: 4366677.3688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 14010.2857; train_edge_recon_loss: 2553331.4075; train_gene_expr_recon_loss: 1774732.1579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4342073.8456; train_optim_loss: 4342073.8456; val_kl_reg_loss: 13973.7260; val_edge_recon_loss: 2558812.5562; val_gene_expr_recon_loss: 1791198.8313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4363985.1000; val_optim_loss: 4363985.1000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 14042.2081; train_edge_recon_loss: 2553276.2684; train_gene_expr_recon_loss: 1771657.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4338975.8421; train_optim_loss: 4338975.8421; val_kl_reg_loss: 13730.2148; val_edge_recon_loss: 2554634.2062; val_gene_expr_recon_loss: 1790745.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4359109.7062; val_optim_loss: 4359109.7062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 14090.6515; train_edge_recon_loss: 2552708.5671; train_gene_expr_recon_loss: 1768750.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4335549.5529; train_optim_loss: 4335549.5529; val_kl_reg_loss: 14053.9854; val_edge_recon_loss: 2554585.1531; val_gene_expr_recon_loss: 1791884.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4360524.1063; val_optim_loss: 4360524.1063
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 14137.4254; train_edge_recon_loss: 2552180.2197; train_gene_expr_recon_loss: 1764750.6433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4331068.2903; train_optim_loss: 4331068.2903; val_kl_reg_loss: 14048.4211; val_edge_recon_loss: 2556275.6437; val_gene_expr_recon_loss: 1793455.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4363779.9500; val_optim_loss: 4363779.9500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 14159.3080; train_edge_recon_loss: 2550843.0010; train_gene_expr_recon_loss: 1762941.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4327943.8675; train_optim_loss: 4327943.8675; val_kl_reg_loss: 14153.9787; val_edge_recon_loss: 2554086.9094; val_gene_expr_recon_loss: 1792029.7437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4360270.6375; val_optim_loss: 4360270.6375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 14190.2203; train_edge_recon_loss: 2550938.7740; train_gene_expr_recon_loss: 1759663.5518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4324792.5445; train_optim_loss: 4324792.5445; val_kl_reg_loss: 14226.4732; val_edge_recon_loss: 2557011.8344; val_gene_expr_recon_loss: 1792539.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4363778.1625; val_optim_loss: 4363778.1625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 14650.2399; train_edge_recon_loss: 2548999.2253; train_gene_expr_recon_loss: 1739204.7571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4302854.2253; train_optim_loss: 4302854.2253; val_kl_reg_loss: 14459.8954; val_edge_recon_loss: 2553299.3219; val_gene_expr_recon_loss: 1777914.6141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4345673.8125; val_optim_loss: 4345673.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 14391.9311; train_edge_recon_loss: 2547260.9419; train_gene_expr_recon_loss: 1733811.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4295464.7458; train_optim_loss: 4295464.7458; val_kl_reg_loss: 14240.1447; val_edge_recon_loss: 2550497.9344; val_gene_expr_recon_loss: 1782613.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4347351.5250; val_optim_loss: 4347351.5250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 14254.3114; train_edge_recon_loss: 2547055.6739; train_gene_expr_recon_loss: 1734325.2747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4295635.2650; train_optim_loss: 4295635.2650; val_kl_reg_loss: 14114.9662; val_edge_recon_loss: 2550637.3781; val_gene_expr_recon_loss: 1781338.7078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4346091.0750; val_optim_loss: 4346091.0750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 14196.8920; train_edge_recon_loss: 2547403.2483; train_gene_expr_recon_loss: 1733480.8604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4295081.0136; train_optim_loss: 4295081.0136; val_kl_reg_loss: 14115.3202; val_edge_recon_loss: 2551112.6125; val_gene_expr_recon_loss: 1781834.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4347062.7875; val_optim_loss: 4347062.7875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 14172.6580; train_edge_recon_loss: 2547358.2921; train_gene_expr_recon_loss: 1732227.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4293758.2882; train_optim_loss: 4293758.2882; val_kl_reg_loss: 14080.0896; val_edge_recon_loss: 2548391.3375; val_gene_expr_recon_loss: 1779888.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4342359.7250; val_optim_loss: 4342359.7250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 14164.1652; train_edge_recon_loss: 2547273.5313; train_gene_expr_recon_loss: 1731962.1798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4293399.8741; train_optim_loss: 4293399.8741; val_kl_reg_loss: 14070.1747; val_edge_recon_loss: 2548276.7500; val_gene_expr_recon_loss: 1779316.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4341663.6000; val_optim_loss: 4341663.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 14158.6746; train_edge_recon_loss: 2546515.3425; train_gene_expr_recon_loss: 1730591.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4291265.8140; train_optim_loss: 4291265.8140; val_kl_reg_loss: 14106.3478; val_edge_recon_loss: 2551178.2437; val_gene_expr_recon_loss: 1779644.2766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4344928.8563; val_optim_loss: 4344928.8563
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 14157.7469; train_edge_recon_loss: 2545920.0150; train_gene_expr_recon_loss: 1729922.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4290000.0939; train_optim_loss: 4290000.0939; val_kl_reg_loss: 14049.7240; val_edge_recon_loss: 2546744.7594; val_gene_expr_recon_loss: 1786012.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4346807.0000; val_optim_loss: 4346807.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 14155.8270; train_edge_recon_loss: 2546184.6853; train_gene_expr_recon_loss: 1729892.6326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4290233.1582; train_optim_loss: 4290233.1582; val_kl_reg_loss: 14077.4368; val_edge_recon_loss: 2550341.9469; val_gene_expr_recon_loss: 1779218.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4343637.5594; val_optim_loss: 4343637.5594
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 14158.1207; train_edge_recon_loss: 2546063.7656; train_gene_expr_recon_loss: 1728122.1937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4288344.0692; train_optim_loss: 4288344.0692; val_kl_reg_loss: 14075.5986; val_edge_recon_loss: 2550059.0812; val_gene_expr_recon_loss: 1781723.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4345857.8750; val_optim_loss: 4345857.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 14227.0869; train_edge_recon_loss: 2545559.7973; train_gene_expr_recon_loss: 1723849.5240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4283636.4086; train_optim_loss: 4283636.4086; val_kl_reg_loss: 14145.2240; val_edge_recon_loss: 2547512.2281; val_gene_expr_recon_loss: 1782868.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4344526.0938; val_optim_loss: 4344526.0938
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 14256.6847; train_edge_recon_loss: 2545966.4110; train_gene_expr_recon_loss: 1724583.5042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4284806.5970; train_optim_loss: 4284806.5970; val_kl_reg_loss: 14149.5831; val_edge_recon_loss: 2548707.7687; val_gene_expr_recon_loss: 1783455.5031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4346312.8625; val_optim_loss: 4346312.8625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 14257.2725; train_edge_recon_loss: 2545492.2834; train_gene_expr_recon_loss: 1722696.4150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4282445.9562; train_optim_loss: 4282445.9562; val_kl_reg_loss: 14155.0962; val_edge_recon_loss: 2548384.2469; val_gene_expr_recon_loss: 1781136.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4343676.3000; val_optim_loss: 4343676.3000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 14249.8792; train_edge_recon_loss: 2545703.7305; train_gene_expr_recon_loss: 1722614.1403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4282567.7604; train_optim_loss: 4282567.7604; val_kl_reg_loss: 14135.9847; val_edge_recon_loss: 2548763.9625; val_gene_expr_recon_loss: 1782481.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4345381.6000; val_optim_loss: 4345381.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 334 min 51 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9963
Val best accuracy score: 0.9846
Val best F1 score: 0.9847
Val gene expr MSE score: 0.4648

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
