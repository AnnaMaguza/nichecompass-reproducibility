None
Run timestamp: 03072023_071446_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9032; val_auprc_score: 0.9153; val_best_acc_score: 0.8144; val_best_f1_score: 0.8075; train_kl_reg_loss: 6689.8255; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 148163.9352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154853.7603; train_optim_loss: 154853.7603; val_kl_reg_loss: 4712.2795; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 132885.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137597.3034; val_optim_loss: 137597.3034
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9139; val_auprc_score: 0.9255; val_best_acc_score: 0.8289; val_best_f1_score: 0.8204; train_kl_reg_loss: 4191.0957; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 131046.1017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135237.1974; train_optim_loss: 135237.1974; val_kl_reg_loss: 3634.7373; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127655.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131290.1902; val_optim_loss: 131290.1902
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9180; val_auprc_score: 0.9290; val_best_acc_score: 0.8337; val_best_f1_score: 0.8282; train_kl_reg_loss: 3448.7585; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127028.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130477.3656; train_optim_loss: 130477.3656; val_kl_reg_loss: 3191.0624; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124682.6939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127873.7561; val_optim_loss: 127873.7561
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9214; val_auprc_score: 0.9320; val_best_acc_score: 0.8370; val_best_f1_score: 0.8339; train_kl_reg_loss: 3124.4895; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124429.4849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127553.9745; train_optim_loss: 127553.9745; val_kl_reg_loss: 2916.2801; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122382.0381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125298.3180; val_optim_loss: 125298.3180
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9196; val_auprc_score: 0.9302; val_best_acc_score: 0.8339; val_best_f1_score: 0.8312; train_kl_reg_loss: 2950.2883; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122616.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125566.4754; train_optim_loss: 125566.4754; val_kl_reg_loss: 2815.0366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121192.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124007.7749; val_optim_loss: 124007.7749
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9197; val_auprc_score: 0.9299; val_best_acc_score: 0.8367; val_best_f1_score: 0.8313; train_kl_reg_loss: 2848.9583; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121342.4855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124191.4437; train_optim_loss: 124191.4437; val_kl_reg_loss: 2726.5740; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 120092.7712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122819.3447; val_optim_loss: 122819.3447
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9207; val_auprc_score: 0.9307; val_best_acc_score: 0.8368; val_best_f1_score: 0.8313; train_kl_reg_loss: 2783.3316; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120329.6702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123113.0019; train_optim_loss: 123113.0019; val_kl_reg_loss: 2646.5648; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119100.7832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121747.3483; val_optim_loss: 121747.3483
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9201; val_auprc_score: 0.9301; val_best_acc_score: 0.8350; val_best_f1_score: 0.8331; train_kl_reg_loss: 2736.1122; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119473.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122210.0978; train_optim_loss: 122210.0978; val_kl_reg_loss: 2652.3463; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118582.0256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121234.3719; val_optim_loss: 121234.3719
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9201; val_auprc_score: 0.9301; val_best_acc_score: 0.8355; val_best_f1_score: 0.8309; train_kl_reg_loss: 2700.6418; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118944.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121645.4724; train_optim_loss: 121645.4724; val_kl_reg_loss: 2621.1271; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118071.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120692.7392; val_optim_loss: 120692.7392
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9198; val_auprc_score: 0.9301; val_best_acc_score: 0.8350; val_best_f1_score: 0.8319; train_kl_reg_loss: 2672.7043; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118489.1793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121161.8835; train_optim_loss: 121161.8835; val_kl_reg_loss: 2557.4763; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117498.9358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120056.4124; val_optim_loss: 120056.4124
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9206; val_auprc_score: 0.9305; val_best_acc_score: 0.8372; val_best_f1_score: 0.8321; train_kl_reg_loss: 2648.3447; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118075.8796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120724.2245; train_optim_loss: 120724.2245; val_kl_reg_loss: 2560.8523; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117479.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120039.9016; val_optim_loss: 120039.9016
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9189; val_auprc_score: 0.9292; val_best_acc_score: 0.8350; val_best_f1_score: 0.8303; train_kl_reg_loss: 2628.6890; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117793.2531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120421.9420; train_optim_loss: 120421.9420; val_kl_reg_loss: 2559.9580; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117136.4956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119696.4540; val_optim_loss: 119696.4540
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9195; val_auprc_score: 0.9298; val_best_acc_score: 0.8349; val_best_f1_score: 0.8320; train_kl_reg_loss: 2614.7530; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117544.0237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120158.7768; train_optim_loss: 120158.7768; val_kl_reg_loss: 2556.3122; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116968.8449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119525.1571; val_optim_loss: 119525.1571
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9204; val_auprc_score: 0.9307; val_best_acc_score: 0.8367; val_best_f1_score: 0.8324; train_kl_reg_loss: 2602.2074; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117324.5656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119926.7730; train_optim_loss: 119926.7730; val_kl_reg_loss: 2527.2923; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116603.9067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119131.1994; val_optim_loss: 119131.1994
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9197; val_auprc_score: 0.9302; val_best_acc_score: 0.8364; val_best_f1_score: 0.8319; train_kl_reg_loss: 2590.8263; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117122.8146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119713.6409; train_optim_loss: 119713.6409; val_kl_reg_loss: 2544.5135; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116462.0800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119006.5940; val_optim_loss: 119006.5940
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9203; val_auprc_score: 0.9307; val_best_acc_score: 0.8365; val_best_f1_score: 0.8336; train_kl_reg_loss: 2578.9175; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116952.3420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119531.2598; train_optim_loss: 119531.2598; val_kl_reg_loss: 2503.4645; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116453.8733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118957.3378; val_optim_loss: 118957.3378
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9195; val_auprc_score: 0.9304; val_best_acc_score: 0.8347; val_best_f1_score: 0.8316; train_kl_reg_loss: 2572.5011; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116770.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119343.2878; train_optim_loss: 119343.2878; val_kl_reg_loss: 2540.1761; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116207.2148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118747.3911; val_optim_loss: 118747.3911
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9191; val_auprc_score: 0.9301; val_best_acc_score: 0.8360; val_best_f1_score: 0.8304; train_kl_reg_loss: 2564.7893; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116681.4376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119246.2268; train_optim_loss: 119246.2268; val_kl_reg_loss: 2520.8746; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116116.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118637.3062; val_optim_loss: 118637.3062
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9202; val_auprc_score: 0.9313; val_best_acc_score: 0.8385; val_best_f1_score: 0.8333; train_kl_reg_loss: 2557.1980; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116613.6009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119170.7990; train_optim_loss: 119170.7990; val_kl_reg_loss: 2502.7794; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116186.9854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118689.7646; val_optim_loss: 118689.7646
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9190; val_auprc_score: 0.9299; val_best_acc_score: 0.8362; val_best_f1_score: 0.8318; train_kl_reg_loss: 2551.6210; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116435.7975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118987.4184; train_optim_loss: 118987.4184; val_kl_reg_loss: 2512.9999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115976.6724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118489.6726; val_optim_loss: 118489.6726
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9177; val_auprc_score: 0.9288; val_best_acc_score: 0.8334; val_best_f1_score: 0.8308; train_kl_reg_loss: 2546.4204; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116370.5343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118916.9547; train_optim_loss: 118916.9547; val_kl_reg_loss: 2520.0314; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115931.1374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118451.1690; val_optim_loss: 118451.1690
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9214; val_auprc_score: 0.9323; val_best_acc_score: 0.8395; val_best_f1_score: 0.8347; train_kl_reg_loss: 2539.8505; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116309.7161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118849.5667; train_optim_loss: 118849.5667; val_kl_reg_loss: 2486.4326; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115882.5683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118369.0009; val_optim_loss: 118369.0009
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9204; val_auprc_score: 0.9312; val_best_acc_score: 0.8385; val_best_f1_score: 0.8331; train_kl_reg_loss: 2534.7628; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116212.7906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118747.5534; train_optim_loss: 118747.5534; val_kl_reg_loss: 2487.4374; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115987.6494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118475.0868; val_optim_loss: 118475.0868
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9203; val_auprc_score: 0.9319; val_best_acc_score: 0.8394; val_best_f1_score: 0.8349; train_kl_reg_loss: 2527.8546; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116125.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118653.1957; train_optim_loss: 118653.1957; val_kl_reg_loss: 2466.1729; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115642.6997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118108.8726; val_optim_loss: 118108.8726
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9199; val_auprc_score: 0.9315; val_best_acc_score: 0.8389; val_best_f1_score: 0.8339; train_kl_reg_loss: 2521.6623; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116057.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118579.2397; train_optim_loss: 118579.2397; val_kl_reg_loss: 2496.3693; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115740.7648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118237.1341; val_optim_loss: 118237.1341
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9225; val_auprc_score: 0.9335; val_best_acc_score: 0.8399; val_best_f1_score: 0.8367; train_kl_reg_loss: 2516.4412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115996.6025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118513.0438; train_optim_loss: 118513.0438; val_kl_reg_loss: 2490.8980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115757.1084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118248.0064; val_optim_loss: 118248.0064
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9220; val_auprc_score: 0.9332; val_best_acc_score: 0.8410; val_best_f1_score: 0.8374; train_kl_reg_loss: 2511.3665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115986.1235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118497.4901; train_optim_loss: 118497.4901; val_kl_reg_loss: 2446.5068; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115561.1734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118007.6803; val_optim_loss: 118007.6803
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9212; val_auprc_score: 0.9328; val_best_acc_score: 0.8400; val_best_f1_score: 0.8349; train_kl_reg_loss: 2504.1061; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115893.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118397.6759; train_optim_loss: 118397.6759; val_kl_reg_loss: 2446.9489; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115484.7591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117931.7078; val_optim_loss: 117931.7078
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9224; val_auprc_score: 0.9337; val_best_acc_score: 0.8428; val_best_f1_score: 0.8373; train_kl_reg_loss: 2500.6413; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115849.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118350.1779; train_optim_loss: 118350.1779; val_kl_reg_loss: 2417.4628; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115627.2155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118044.6784; val_optim_loss: 118044.6784
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9218; val_auprc_score: 0.9334; val_best_acc_score: 0.8411; val_best_f1_score: 0.8358; train_kl_reg_loss: 2493.5345; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115795.0164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118288.5509; train_optim_loss: 118288.5509; val_kl_reg_loss: 2443.7983; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115542.5237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117986.3227; val_optim_loss: 117986.3227
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9235; val_auprc_score: 0.9346; val_best_acc_score: 0.8435; val_best_f1_score: 0.8397; train_kl_reg_loss: 2489.2878; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115764.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118253.7554; train_optim_loss: 118253.7554; val_kl_reg_loss: 2431.8325; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115492.8524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117924.6851; val_optim_loss: 117924.6851
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9231; val_auprc_score: 0.9345; val_best_acc_score: 0.8429; val_best_f1_score: 0.8388; train_kl_reg_loss: 2486.3747; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115727.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118213.8673; train_optim_loss: 118213.8673; val_kl_reg_loss: 2440.0525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115305.4467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117745.4994; val_optim_loss: 117745.4994
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9240; val_auprc_score: 0.9353; val_best_acc_score: 0.8428; val_best_f1_score: 0.8398; train_kl_reg_loss: 2483.7226; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115739.6720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118223.3946; train_optim_loss: 118223.3946; val_kl_reg_loss: 2420.5541; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115454.9878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117875.5425; val_optim_loss: 117875.5425
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9236; val_auprc_score: 0.9352; val_best_acc_score: 0.8441; val_best_f1_score: 0.8398; train_kl_reg_loss: 2477.1976; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115664.3962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118141.5937; train_optim_loss: 118141.5937; val_kl_reg_loss: 2426.3977; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115369.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117795.6348; val_optim_loss: 117795.6348
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9233; val_auprc_score: 0.9347; val_best_acc_score: 0.8429; val_best_f1_score: 0.8389; train_kl_reg_loss: 2474.4034; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115653.4463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118127.8497; train_optim_loss: 118127.8497; val_kl_reg_loss: 2417.8700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115479.5536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117897.4236; val_optim_loss: 117897.4236
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9239; val_auprc_score: 0.9350; val_best_acc_score: 0.8446; val_best_f1_score: 0.8396; train_kl_reg_loss: 2470.4475; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115585.4241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118055.8716; train_optim_loss: 118055.8716; val_kl_reg_loss: 2430.1570; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115489.3584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117919.5156; val_optim_loss: 117919.5156

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9238; val_auprc_score: 0.9351; val_best_acc_score: 0.8449; val_best_f1_score: 0.8404; train_kl_reg_loss: 2430.3077; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115040.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117471.1688; train_optim_loss: 117471.1688; val_kl_reg_loss: 2389.4100; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114898.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117287.8068; val_optim_loss: 117287.8068
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9235; val_auprc_score: 0.9352; val_best_acc_score: 0.8450; val_best_f1_score: 0.8401; train_kl_reg_loss: 2428.2036; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115042.5987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117470.8023; train_optim_loss: 117470.8023; val_kl_reg_loss: 2391.8181; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114992.8338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117384.6516; val_optim_loss: 117384.6516
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9243; val_auprc_score: 0.9359; val_best_acc_score: 0.8449; val_best_f1_score: 0.8412; train_kl_reg_loss: 2427.2641; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115015.0594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117442.3236; train_optim_loss: 117442.3236; val_kl_reg_loss: 2384.0686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115016.2901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117400.3591; val_optim_loss: 117400.3591
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9250; val_auprc_score: 0.9368; val_best_acc_score: 0.8456; val_best_f1_score: 0.8426; train_kl_reg_loss: 2426.5735; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115017.0151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117443.5886; train_optim_loss: 117443.5886; val_kl_reg_loss: 2373.0539; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114931.3909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117304.4447; val_optim_loss: 117304.4447
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9240; val_auprc_score: 0.9354; val_best_acc_score: 0.8452; val_best_f1_score: 0.8417; train_kl_reg_loss: 2424.6076; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115016.6114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117441.2192; train_optim_loss: 117441.2192; val_kl_reg_loss: 2373.8022; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114905.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117279.6949; val_optim_loss: 117279.6949
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9238; val_auprc_score: 0.9352; val_best_acc_score: 0.8443; val_best_f1_score: 0.8402; train_kl_reg_loss: 2423.7141; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114980.2065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117403.9207; train_optim_loss: 117403.9207; val_kl_reg_loss: 2388.2544; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114808.2357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117196.4901; val_optim_loss: 117196.4901
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9243; val_auprc_score: 0.9357; val_best_acc_score: 0.8444; val_best_f1_score: 0.8417; train_kl_reg_loss: 2423.0921; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114952.5777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117375.6698; train_optim_loss: 117375.6698; val_kl_reg_loss: 2380.8929; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114898.0283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117278.9210; val_optim_loss: 117278.9210
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9236; val_auprc_score: 0.9351; val_best_acc_score: 0.8435; val_best_f1_score: 0.8410; train_kl_reg_loss: 2421.1372; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114981.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117402.6771; train_optim_loss: 117402.6771; val_kl_reg_loss: 2378.1811; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114932.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117310.4648; val_optim_loss: 117310.4648
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9244; val_auprc_score: 0.9362; val_best_acc_score: 0.8449; val_best_f1_score: 0.8414; train_kl_reg_loss: 2420.4234; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115002.4621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117422.8853; train_optim_loss: 117422.8853; val_kl_reg_loss: 2390.1420; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114979.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117369.4945; val_optim_loss: 117369.4945
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9243; val_auprc_score: 0.9356; val_best_acc_score: 0.8456; val_best_f1_score: 0.8420; train_kl_reg_loss: 2420.2265; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114924.9290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117345.1556; train_optim_loss: 117345.1556; val_kl_reg_loss: 2384.8127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114966.8581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117351.6702; val_optim_loss: 117351.6702

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9243; val_auprc_score: 0.9358; val_best_acc_score: 0.8443; val_best_f1_score: 0.8412; train_kl_reg_loss: 2414.0478; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114874.1296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117288.1774; train_optim_loss: 117288.1774; val_kl_reg_loss: 2373.6986; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114909.5629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117283.2616; val_optim_loss: 117283.2616
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9248; val_auprc_score: 0.9361; val_best_acc_score: 0.8450; val_best_f1_score: 0.8417; train_kl_reg_loss: 2413.8665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114884.7696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117298.6360; train_optim_loss: 117298.6360; val_kl_reg_loss: 2373.5895; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114851.8714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117225.4609; val_optim_loss: 117225.4609
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9237; val_auprc_score: 0.9356; val_best_acc_score: 0.8441; val_best_f1_score: 0.8401; train_kl_reg_loss: 2413.0911; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114913.1937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117326.2847; train_optim_loss: 117326.2847; val_kl_reg_loss: 2373.0315; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115030.8923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117403.9241; val_optim_loss: 117403.9241
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9250; val_auprc_score: 0.9363; val_best_acc_score: 0.8458; val_best_f1_score: 0.8422; train_kl_reg_loss: 2413.3201; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114855.4519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117268.7722; train_optim_loss: 117268.7722; val_kl_reg_loss: 2370.5754; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114844.3986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117214.9734; val_optim_loss: 117214.9734

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 102 min 52 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9241
Val AUPRC score: 0.9359
Val best accuracy score: 0.8448
Val best F1 score: 0.8413
Val gene expr MSE score: 8.4357

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
