None
Run timestamp: 04072023_221935_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9174; val_auprc_score: 0.9285; val_best_acc_score: 0.8344; val_best_f1_score: 0.8272; train_kl_reg_loss: 4974.8846; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 142296.7081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147271.5926; train_optim_loss: 147271.5926; val_kl_reg_loss: 3359.4966; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130406.9490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133766.4455; val_optim_loss: 133766.4455
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9257; val_auprc_score: 0.9363; val_best_acc_score: 0.8438; val_best_f1_score: 0.8414; train_kl_reg_loss: 3129.9085; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128510.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131640.7201; train_optim_loss: 131640.7201; val_kl_reg_loss: 2811.2541; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125050.8907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127862.1452; val_optim_loss: 127862.1452
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9275; val_auprc_score: 0.9375; val_best_acc_score: 0.8476; val_best_f1_score: 0.8412; train_kl_reg_loss: 2792.7793; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124476.2725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127269.0518; train_optim_loss: 127269.0518; val_kl_reg_loss: 2642.8961; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122272.3202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124915.2166; val_optim_loss: 124915.2166
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9255; val_auprc_score: 0.9358; val_best_acc_score: 0.8448; val_best_f1_score: 0.8385; train_kl_reg_loss: 2673.8469; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122352.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125025.9358; train_optim_loss: 125025.9358; val_kl_reg_loss: 2585.2220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 120820.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123405.7586; val_optim_loss: 123405.7586
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9229; val_auprc_score: 0.9333; val_best_acc_score: 0.8410; val_best_f1_score: 0.8353; train_kl_reg_loss: 2622.8071; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121075.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123698.0447; train_optim_loss: 123698.0447; val_kl_reg_loss: 2571.7240; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119946.0009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122517.7251; val_optim_loss: 122517.7251
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9248; val_auprc_score: 0.9350; val_best_acc_score: 0.8433; val_best_f1_score: 0.8387; train_kl_reg_loss: 2596.5960; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120213.6082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122810.2042; train_optim_loss: 122810.2042; val_kl_reg_loss: 2540.0364; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118955.9634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121495.9997; val_optim_loss: 121495.9997
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9241; val_auprc_score: 0.9345; val_best_acc_score: 0.8404; val_best_f1_score: 0.8375; train_kl_reg_loss: 2582.8564; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119648.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122231.7466; train_optim_loss: 122231.7466; val_kl_reg_loss: 2488.6543; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118689.9994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121178.6538; val_optim_loss: 121178.6538
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9233; val_auprc_score: 0.9337; val_best_acc_score: 0.8406; val_best_f1_score: 0.8372; train_kl_reg_loss: 2573.5712; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119186.8817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121760.4530; train_optim_loss: 121760.4530; val_kl_reg_loss: 2518.0431; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118466.4065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120984.4501; val_optim_loss: 120984.4501
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9208; val_auprc_score: 0.9317; val_best_acc_score: 0.8367; val_best_f1_score: 0.8338; train_kl_reg_loss: 2562.9508; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118888.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121451.5172; train_optim_loss: 121451.5172; val_kl_reg_loss: 2517.9038; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118070.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120588.3656; val_optim_loss: 120588.3656
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9215; val_auprc_score: 0.9326; val_best_acc_score: 0.8380; val_best_f1_score: 0.8337; train_kl_reg_loss: 2556.8244; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118603.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121159.9426; train_optim_loss: 121159.9426; val_kl_reg_loss: 2529.8039; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117999.3131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120529.1173; val_optim_loss: 120529.1173
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9209; val_auprc_score: 0.9324; val_best_acc_score: 0.8384; val_best_f1_score: 0.8353; train_kl_reg_loss: 2549.6937; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118456.9161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121006.6099; train_optim_loss: 121006.6099; val_kl_reg_loss: 2499.2294; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117784.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120284.1505; val_optim_loss: 120284.1505
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9239; val_auprc_score: 0.9352; val_best_acc_score: 0.8431; val_best_f1_score: 0.8386; train_kl_reg_loss: 2541.6440; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118266.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120808.6330; train_optim_loss: 120808.6330; val_kl_reg_loss: 2466.1107; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117551.9567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120018.0676; val_optim_loss: 120018.0676
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9236; val_auprc_score: 0.9351; val_best_acc_score: 0.8434; val_best_f1_score: 0.8384; train_kl_reg_loss: 2535.5670; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118095.5235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120631.0905; train_optim_loss: 120631.0905; val_kl_reg_loss: 2479.7136; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117633.2130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120112.9268; val_optim_loss: 120112.9268
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9228; val_auprc_score: 0.9339; val_best_acc_score: 0.8418; val_best_f1_score: 0.8387; train_kl_reg_loss: 2525.4630; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117944.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120470.3017; train_optim_loss: 120470.3017; val_kl_reg_loss: 2473.9259; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117451.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119925.0986; val_optim_loss: 119925.0986
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9228; val_auprc_score: 0.9346; val_best_acc_score: 0.8423; val_best_f1_score: 0.8372; train_kl_reg_loss: 2520.6763; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117868.6750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120389.3511; train_optim_loss: 120389.3511; val_kl_reg_loss: 2456.1629; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117506.7156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119962.8782; val_optim_loss: 119962.8782
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9222; val_auprc_score: 0.9342; val_best_acc_score: 0.8420; val_best_f1_score: 0.8364; train_kl_reg_loss: 2516.8977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117749.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120266.7609; train_optim_loss: 120266.7609; val_kl_reg_loss: 2453.2985; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117433.9881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119887.2862; val_optim_loss: 119887.2862
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9217; val_auprc_score: 0.9335; val_best_acc_score: 0.8413; val_best_f1_score: 0.8366; train_kl_reg_loss: 2509.9507; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117691.0256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120200.9763; train_optim_loss: 120200.9763; val_kl_reg_loss: 2480.0981; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117432.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119912.6179; val_optim_loss: 119912.6179
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9225; val_auprc_score: 0.9344; val_best_acc_score: 0.8425; val_best_f1_score: 0.8379; train_kl_reg_loss: 2505.2669; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117619.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120124.4456; train_optim_loss: 120124.4456; val_kl_reg_loss: 2429.9590; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117180.1007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119610.0598; val_optim_loss: 119610.0598
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9246; val_auprc_score: 0.9365; val_best_acc_score: 0.8450; val_best_f1_score: 0.8408; train_kl_reg_loss: 2497.6339; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117584.0902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120081.7241; train_optim_loss: 120081.7241; val_kl_reg_loss: 2429.6543; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117181.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119610.6652; val_optim_loss: 119610.6652
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9227; val_auprc_score: 0.9346; val_best_acc_score: 0.8436; val_best_f1_score: 0.8396; train_kl_reg_loss: 2492.8479; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117565.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120058.2601; train_optim_loss: 120058.2601; val_kl_reg_loss: 2446.6207; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117075.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119522.3845; val_optim_loss: 119522.3845
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9240; val_auprc_score: 0.9360; val_best_acc_score: 0.8464; val_best_f1_score: 0.8403; train_kl_reg_loss: 2487.5103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117428.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119915.5221; train_optim_loss: 119915.5221; val_kl_reg_loss: 2424.6250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117219.4229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119644.0484; val_optim_loss: 119644.0484
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9230; val_auprc_score: 0.9354; val_best_acc_score: 0.8444; val_best_f1_score: 0.8396; train_kl_reg_loss: 2483.4470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117421.2289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119904.6758; train_optim_loss: 119904.6758; val_kl_reg_loss: 2422.7508; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116929.0307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119351.7819; val_optim_loss: 119351.7819
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9245; val_auprc_score: 0.9366; val_best_acc_score: 0.8466; val_best_f1_score: 0.8411; train_kl_reg_loss: 2477.7086; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117350.9095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119828.6179; train_optim_loss: 119828.6179; val_kl_reg_loss: 2450.5271; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116944.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119395.1383; val_optim_loss: 119395.1383
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9263; val_auprc_score: 0.9383; val_best_acc_score: 0.8476; val_best_f1_score: 0.8447; train_kl_reg_loss: 2474.3354; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117311.3384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119785.6738; train_optim_loss: 119785.6738; val_kl_reg_loss: 2441.9486; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117016.9712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119458.9193; val_optim_loss: 119458.9193
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9243; val_auprc_score: 0.9366; val_best_acc_score: 0.8457; val_best_f1_score: 0.8423; train_kl_reg_loss: 2470.8754; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117308.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119778.9390; train_optim_loss: 119778.9390; val_kl_reg_loss: 2464.2363; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117075.3660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119539.6023; val_optim_loss: 119539.6023
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9266; val_auprc_score: 0.9384; val_best_acc_score: 0.8495; val_best_f1_score: 0.8450; train_kl_reg_loss: 2480.2567; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117279.3963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119759.6529; train_optim_loss: 119759.6529; val_kl_reg_loss: 2418.1429; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116974.0382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119392.1811; val_optim_loss: 119392.1811

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9260; val_auprc_score: 0.9382; val_best_acc_score: 0.8490; val_best_f1_score: 0.8450; train_kl_reg_loss: 2398.8971; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116317.8729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118716.7699; train_optim_loss: 118716.7699; val_kl_reg_loss: 2357.4318; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116270.1889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118627.6209; val_optim_loss: 118627.6209
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9251; val_auprc_score: 0.9377; val_best_acc_score: 0.8474; val_best_f1_score: 0.8434; train_kl_reg_loss: 2388.1412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116300.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118688.8331; train_optim_loss: 118688.8331; val_kl_reg_loss: 2369.0557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116192.7910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118561.8462; val_optim_loss: 118561.8462
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9254; val_auprc_score: 0.9378; val_best_acc_score: 0.8482; val_best_f1_score: 0.8442; train_kl_reg_loss: 2385.2360; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116218.6949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118603.9310; train_optim_loss: 118603.9310; val_kl_reg_loss: 2350.8063; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116256.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118606.9151; val_optim_loss: 118606.9151
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9266; val_auprc_score: 0.9385; val_best_acc_score: 0.8502; val_best_f1_score: 0.8453; train_kl_reg_loss: 2383.1916; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116220.8639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118604.0555; train_optim_loss: 118604.0555; val_kl_reg_loss: 2335.9644; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116148.2972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118484.2613; val_optim_loss: 118484.2613
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9261; val_auprc_score: 0.9383; val_best_acc_score: 0.8493; val_best_f1_score: 0.8447; train_kl_reg_loss: 2381.2422; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116167.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118548.5924; train_optim_loss: 118548.5924; val_kl_reg_loss: 2342.6240; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116198.7379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118541.3617; val_optim_loss: 118541.3617
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9259; val_auprc_score: 0.9382; val_best_acc_score: 0.8489; val_best_f1_score: 0.8436; train_kl_reg_loss: 2379.3068; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116183.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118562.7194; train_optim_loss: 118562.7194; val_kl_reg_loss: 2337.0682; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116199.5901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118536.6584; val_optim_loss: 118536.6584
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9265; val_auprc_score: 0.9384; val_best_acc_score: 0.8497; val_best_f1_score: 0.8447; train_kl_reg_loss: 2376.5773; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116166.3779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118542.9552; train_optim_loss: 118542.9552; val_kl_reg_loss: 2347.0974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116141.4467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118488.5439; val_optim_loss: 118488.5439
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9254; val_auprc_score: 0.9375; val_best_acc_score: 0.8483; val_best_f1_score: 0.8432; train_kl_reg_loss: 2375.6818; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116105.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118481.3737; train_optim_loss: 118481.3737; val_kl_reg_loss: 2340.1730; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116056.5025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118396.6755; val_optim_loss: 118396.6755
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9257; val_auprc_score: 0.9381; val_best_acc_score: 0.8498; val_best_f1_score: 0.8442; train_kl_reg_loss: 2374.9545; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116144.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118519.3379; train_optim_loss: 118519.3379; val_kl_reg_loss: 2331.7768; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115967.9585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118299.7355; val_optim_loss: 118299.7355
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9263; val_auprc_score: 0.9383; val_best_acc_score: 0.8499; val_best_f1_score: 0.8443; train_kl_reg_loss: 2372.3110; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116152.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118524.4332; train_optim_loss: 118524.4332; val_kl_reg_loss: 2327.8711; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116165.5883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118493.4595; val_optim_loss: 118493.4595
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9268; val_auprc_score: 0.9390; val_best_acc_score: 0.8510; val_best_f1_score: 0.8457; train_kl_reg_loss: 2372.0504; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116151.5516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118523.6022; train_optim_loss: 118523.6022; val_kl_reg_loss: 2323.9749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116052.0887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118376.0636; val_optim_loss: 118376.0636
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9247; val_auprc_score: 0.9369; val_best_acc_score: 0.8485; val_best_f1_score: 0.8426; train_kl_reg_loss: 2370.9138; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116095.3132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118466.2271; train_optim_loss: 118466.2271; val_kl_reg_loss: 2326.9558; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116007.3899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118334.3458; val_optim_loss: 118334.3458
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9262; val_auprc_score: 0.9384; val_best_acc_score: 0.8500; val_best_f1_score: 0.8445; train_kl_reg_loss: 2368.5965; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116115.6814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118484.2779; train_optim_loss: 118484.2779; val_kl_reg_loss: 2336.5202; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116095.5752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118432.0954; val_optim_loss: 118432.0954

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9257; val_auprc_score: 0.9375; val_best_acc_score: 0.8495; val_best_f1_score: 0.8448; train_kl_reg_loss: 2361.9937; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115998.0711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118360.0647; train_optim_loss: 118360.0647; val_kl_reg_loss: 2320.5493; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116014.9013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118335.4508; val_optim_loss: 118335.4508
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9254; val_auprc_score: 0.9377; val_best_acc_score: 0.8489; val_best_f1_score: 0.8443; train_kl_reg_loss: 2362.1225; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116016.7516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118378.8741; train_optim_loss: 118378.8741; val_kl_reg_loss: 2326.5627; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116078.4376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118405.0005; val_optim_loss: 118405.0005
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9256; val_auprc_score: 0.9379; val_best_acc_score: 0.8494; val_best_f1_score: 0.8450; train_kl_reg_loss: 2361.0967; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115944.0848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118305.1815; train_optim_loss: 118305.1815; val_kl_reg_loss: 2325.7888; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116008.0739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118333.8627; val_optim_loss: 118333.8627
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9259; val_auprc_score: 0.9382; val_best_acc_score: 0.8499; val_best_f1_score: 0.8456; train_kl_reg_loss: 2361.6242; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115946.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118308.4598; train_optim_loss: 118308.4598; val_kl_reg_loss: 2325.7423; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116028.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118354.1129; val_optim_loss: 118354.1129

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 118 min 29 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9260
Val AUPRC score: 0.9383
Val best accuracy score: 0.8498
Val best F1 score: 0.8442
Val gene expr MSE score: 8.4785

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
