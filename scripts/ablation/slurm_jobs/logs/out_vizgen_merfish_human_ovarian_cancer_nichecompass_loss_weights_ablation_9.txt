None
Run timestamp: 30062023_204803_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9136; val_auprc_score: 0.9235; val_best_acc_score: 0.8242; val_best_f1_score: 0.8236; train_kl_reg_loss: 5693.8913; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 147677.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153370.9664; train_optim_loss: 153370.9664; val_kl_reg_loss: 4040.4019; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 134595.3506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138635.7526; val_optim_loss: 138635.7526
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9225; val_auprc_score: 0.9326; val_best_acc_score: 0.8376; val_best_f1_score: 0.8360; train_kl_reg_loss: 3714.3832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 132547.6014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136261.9847; train_optim_loss: 136261.9847; val_kl_reg_loss: 3302.4298; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 129259.0896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132561.5197; val_optim_loss: 132561.5197
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9299; val_auprc_score: 0.9392; val_best_acc_score: 0.8503; val_best_f1_score: 0.8468; train_kl_reg_loss: 3135.0447; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128413.3063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131548.3510; train_optim_loss: 131548.3510; val_kl_reg_loss: 2856.8611; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126082.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128939.0851; val_optim_loss: 128939.0851
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9306; val_auprc_score: 0.9397; val_best_acc_score: 0.8498; val_best_f1_score: 0.8486; train_kl_reg_loss: 2900.0444; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125695.8377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128595.8821; train_optim_loss: 128595.8821; val_kl_reg_loss: 2738.3018; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123939.6893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126677.9911; val_optim_loss: 126677.9911
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9283; val_auprc_score: 0.9376; val_best_acc_score: 0.8485; val_best_f1_score: 0.8435; train_kl_reg_loss: 2781.5456; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123843.3902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126624.9358; train_optim_loss: 126624.9358; val_kl_reg_loss: 2728.5202; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122371.1770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125099.6973; val_optim_loss: 125099.6973
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9298; val_auprc_score: 0.9386; val_best_acc_score: 0.8486; val_best_f1_score: 0.8451; train_kl_reg_loss: 2714.0989; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122504.8566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125218.9555; train_optim_loss: 125218.9555; val_kl_reg_loss: 2604.9231; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121232.1655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123837.0885; val_optim_loss: 123837.0885
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9280; val_auprc_score: 0.9373; val_best_acc_score: 0.8446; val_best_f1_score: 0.8436; train_kl_reg_loss: 2675.2601; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121536.0823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124211.3423; train_optim_loss: 124211.3423; val_kl_reg_loss: 2564.4457; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 120502.5247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123066.9703; val_optim_loss: 123066.9703
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9267; val_auprc_score: 0.9362; val_best_acc_score: 0.8453; val_best_f1_score: 0.8414; train_kl_reg_loss: 2650.2859; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120799.0136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123449.2995; train_optim_loss: 123449.2995; val_kl_reg_loss: 2567.4885; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119700.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122267.7669; val_optim_loss: 122267.7669
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9255; val_auprc_score: 0.9345; val_best_acc_score: 0.8407; val_best_f1_score: 0.8397; train_kl_reg_loss: 2635.9364; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120207.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122843.1826; train_optim_loss: 122843.1826; val_kl_reg_loss: 2581.5675; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119303.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121884.8364; val_optim_loss: 121884.8364
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9238; val_auprc_score: 0.9339; val_best_acc_score: 0.8412; val_best_f1_score: 0.8364; train_kl_reg_loss: 2624.5852; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119725.5199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122350.1051; train_optim_loss: 122350.1051; val_kl_reg_loss: 2540.3217; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119008.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121548.5067; val_optim_loss: 121548.5067
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9238; val_auprc_score: 0.9336; val_best_acc_score: 0.8402; val_best_f1_score: 0.8378; train_kl_reg_loss: 2614.8853; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119315.9558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121930.8412; train_optim_loss: 121930.8412; val_kl_reg_loss: 2549.9803; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118530.4632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121080.4433; val_optim_loss: 121080.4433
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9237; val_auprc_score: 0.9334; val_best_acc_score: 0.8398; val_best_f1_score: 0.8361; train_kl_reg_loss: 2606.3391; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119052.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121659.0589; train_optim_loss: 121659.0589; val_kl_reg_loss: 2552.2587; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118445.6072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120997.8659; val_optim_loss: 120997.8659
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9221; val_auprc_score: 0.9323; val_best_acc_score: 0.8394; val_best_f1_score: 0.8365; train_kl_reg_loss: 2598.1404; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118770.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121368.8592; train_optim_loss: 121368.8592; val_kl_reg_loss: 2499.0375; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118174.8381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120673.8754; val_optim_loss: 120673.8754
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9217; val_auprc_score: 0.9322; val_best_acc_score: 0.8385; val_best_f1_score: 0.8357; train_kl_reg_loss: 2591.6383; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118631.9701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121223.6085; train_optim_loss: 121223.6085; val_kl_reg_loss: 2520.6278; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118089.2803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120609.9080; val_optim_loss: 120609.9080
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9214; val_auprc_score: 0.9318; val_best_acc_score: 0.8371; val_best_f1_score: 0.8349; train_kl_reg_loss: 2586.0484; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118373.6350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120959.6834; train_optim_loss: 120959.6834; val_kl_reg_loss: 2521.5274; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117767.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120289.3854; val_optim_loss: 120289.3854
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9206; val_auprc_score: 0.9313; val_best_acc_score: 0.8385; val_best_f1_score: 0.8344; train_kl_reg_loss: 2581.7448; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118281.1976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120862.9423; train_optim_loss: 120862.9423; val_kl_reg_loss: 2517.7047; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117845.2832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120362.9878; val_optim_loss: 120362.9878
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9214; val_auprc_score: 0.9326; val_best_acc_score: 0.8391; val_best_f1_score: 0.8359; train_kl_reg_loss: 2576.2517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118106.5894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120682.8412; train_optim_loss: 120682.8412; val_kl_reg_loss: 2496.3999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117807.4061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120303.8055; val_optim_loss: 120303.8055
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9184; val_auprc_score: 0.9296; val_best_acc_score: 0.8346; val_best_f1_score: 0.8313; train_kl_reg_loss: 2570.1659; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117976.7182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120546.8840; train_optim_loss: 120546.8840; val_kl_reg_loss: 2518.5934; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117559.3226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120077.9156; val_optim_loss: 120077.9156
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9197; val_auprc_score: 0.9311; val_best_acc_score: 0.8369; val_best_f1_score: 0.8343; train_kl_reg_loss: 2565.2120; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117874.6503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120439.8623; train_optim_loss: 120439.8623; val_kl_reg_loss: 2513.7183; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117464.2055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119977.9236; val_optim_loss: 119977.9236
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9194; val_auprc_score: 0.9307; val_best_acc_score: 0.8366; val_best_f1_score: 0.8328; train_kl_reg_loss: 2559.4944; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117782.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120342.3146; train_optim_loss: 120342.3146; val_kl_reg_loss: 2499.1855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117581.5928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120080.7784; val_optim_loss: 120080.7784
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9190; val_auprc_score: 0.9305; val_best_acc_score: 0.8367; val_best_f1_score: 0.8324; train_kl_reg_loss: 2553.8871; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117677.2243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120231.1115; train_optim_loss: 120231.1115; val_kl_reg_loss: 2535.4296; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117199.2977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119734.7276; val_optim_loss: 119734.7276
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9204; val_auprc_score: 0.9320; val_best_acc_score: 0.8388; val_best_f1_score: 0.8349; train_kl_reg_loss: 2549.4475; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117599.1812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120148.6286; train_optim_loss: 120148.6286; val_kl_reg_loss: 2489.6934; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117262.9214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119752.6149; val_optim_loss: 119752.6149
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9187; val_auprc_score: 0.9304; val_best_acc_score: 0.8367; val_best_f1_score: 0.8331; train_kl_reg_loss: 2544.3246; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117527.5080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120071.8325; train_optim_loss: 120071.8325; val_kl_reg_loss: 2515.4284; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117104.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119619.7656; val_optim_loss: 119619.7656
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9210; val_auprc_score: 0.9325; val_best_acc_score: 0.8390; val_best_f1_score: 0.8364; train_kl_reg_loss: 2539.2462; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117463.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120002.5661; train_optim_loss: 120002.5661; val_kl_reg_loss: 2461.1964; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117205.3058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119666.5021; val_optim_loss: 119666.5021
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9183; val_auprc_score: 0.9303; val_best_acc_score: 0.8367; val_best_f1_score: 0.8329; train_kl_reg_loss: 2534.4732; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117411.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119945.6823; train_optim_loss: 119945.6823; val_kl_reg_loss: 2510.8734; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117110.8639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119621.7371; val_optim_loss: 119621.7371
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9198; val_auprc_score: 0.9315; val_best_acc_score: 0.8373; val_best_f1_score: 0.8340; train_kl_reg_loss: 2529.2164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117362.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119891.5000; train_optim_loss: 119891.5000; val_kl_reg_loss: 2500.3387; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117073.1820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119573.5216; val_optim_loss: 119573.5216
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9204; val_auprc_score: 0.9322; val_best_acc_score: 0.8392; val_best_f1_score: 0.8348; train_kl_reg_loss: 2524.8346; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117269.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119794.1134; train_optim_loss: 119794.1134; val_kl_reg_loss: 2460.3702; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116995.4239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119455.7943; val_optim_loss: 119455.7943
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9223; val_auprc_score: 0.9339; val_best_acc_score: 0.8418; val_best_f1_score: 0.8385; train_kl_reg_loss: 2518.9270; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117225.5002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119744.4273; train_optim_loss: 119744.4273; val_kl_reg_loss: 2462.4801; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116869.4940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119331.9743; val_optim_loss: 119331.9743
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9216; val_auprc_score: 0.9336; val_best_acc_score: 0.8421; val_best_f1_score: 0.8378; train_kl_reg_loss: 2515.5608; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117223.2269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119738.7876; train_optim_loss: 119738.7876; val_kl_reg_loss: 2453.3378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116927.6679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119381.0057; val_optim_loss: 119381.0057
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9211; val_auprc_score: 0.9330; val_best_acc_score: 0.8412; val_best_f1_score: 0.8382; train_kl_reg_loss: 2511.9403; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117148.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119660.7646; train_optim_loss: 119660.7646; val_kl_reg_loss: 2482.2170; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116941.9798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119424.1970; val_optim_loss: 119424.1970
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9208; val_auprc_score: 0.9329; val_best_acc_score: 0.8395; val_best_f1_score: 0.8363; train_kl_reg_loss: 2507.5899; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117100.8196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119608.4097; train_optim_loss: 119608.4097; val_kl_reg_loss: 2450.9474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116931.9128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119382.8605; val_optim_loss: 119382.8605
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9210; val_auprc_score: 0.9331; val_best_acc_score: 0.8393; val_best_f1_score: 0.8367; train_kl_reg_loss: 2503.0077; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117080.1704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119583.1781; train_optim_loss: 119583.1781; val_kl_reg_loss: 2452.8864; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116786.2359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119239.1227; val_optim_loss: 119239.1227
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9203; val_auprc_score: 0.9321; val_best_acc_score: 0.8381; val_best_f1_score: 0.8351; train_kl_reg_loss: 2499.8437; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117045.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119545.3395; train_optim_loss: 119545.3395; val_kl_reg_loss: 2466.2820; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116799.6521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119265.9342; val_optim_loss: 119265.9342
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9205; val_auprc_score: 0.9324; val_best_acc_score: 0.8400; val_best_f1_score: 0.8362; train_kl_reg_loss: 2494.0873; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117020.8769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119514.9642; train_optim_loss: 119514.9642; val_kl_reg_loss: 2466.6428; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116762.6793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119229.3217; val_optim_loss: 119229.3217
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9233; val_auprc_score: 0.9353; val_best_acc_score: 0.8444; val_best_f1_score: 0.8408; train_kl_reg_loss: 2493.4634; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116963.0231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119456.4866; train_optim_loss: 119456.4866; val_kl_reg_loss: 2448.6877; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116805.9281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119254.6161; val_optim_loss: 119254.6161
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9212; val_auprc_score: 0.9332; val_best_acc_score: 0.8407; val_best_f1_score: 0.8370; train_kl_reg_loss: 2486.8544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116935.1310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119421.9853; train_optim_loss: 119421.9853; val_kl_reg_loss: 2438.1996; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116837.7821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119275.9815; val_optim_loss: 119275.9815
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9211; val_auprc_score: 0.9334; val_best_acc_score: 0.8407; val_best_f1_score: 0.8370; train_kl_reg_loss: 2484.9302; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116863.1753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119348.1056; train_optim_loss: 119348.1056; val_kl_reg_loss: 2435.7070; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116594.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119029.7506; val_optim_loss: 119029.7506
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9220; val_auprc_score: 0.9342; val_best_acc_score: 0.8420; val_best_f1_score: 0.8385; train_kl_reg_loss: 2480.0798; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116899.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119379.6605; train_optim_loss: 119379.6605; val_kl_reg_loss: 2417.4271; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116591.8152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119009.2428; val_optim_loss: 119009.2428
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9230; val_auprc_score: 0.9352; val_best_acc_score: 0.8431; val_best_f1_score: 0.8397; train_kl_reg_loss: 2476.0370; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116795.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119271.2955; train_optim_loss: 119271.2955; val_kl_reg_loss: 2442.8980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116638.1234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119081.0212; val_optim_loss: 119081.0212
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9207; val_auprc_score: 0.9334; val_best_acc_score: 0.8415; val_best_f1_score: 0.8377; train_kl_reg_loss: 2473.8737; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116862.8315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119336.7052; train_optim_loss: 119336.7052; val_kl_reg_loss: 2450.9616; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116601.7261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119052.6875; val_optim_loss: 119052.6875
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9233; val_auprc_score: 0.9358; val_best_acc_score: 0.8451; val_best_f1_score: 0.8419; train_kl_reg_loss: 2469.9386; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116804.6457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119274.5843; train_optim_loss: 119274.5843; val_kl_reg_loss: 2431.1963; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116626.1804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119057.3763; val_optim_loss: 119057.3763
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9212; val_auprc_score: 0.9334; val_best_acc_score: 0.8404; val_best_f1_score: 0.8371; train_kl_reg_loss: 2466.9277; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116776.8046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119243.7321; train_optim_loss: 119243.7321; val_kl_reg_loss: 2411.1830; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116641.5679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119052.7507; val_optim_loss: 119052.7507

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9222; val_auprc_score: 0.9347; val_best_acc_score: 0.8443; val_best_f1_score: 0.8390; train_kl_reg_loss: 2411.1067; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116183.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118594.9699; train_optim_loss: 118594.9699; val_kl_reg_loss: 2371.9899; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116146.4121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118518.4021; val_optim_loss: 118518.4021
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9230; val_auprc_score: 0.9353; val_best_acc_score: 0.8447; val_best_f1_score: 0.8408; train_kl_reg_loss: 2404.3595; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116068.6857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118473.0452; train_optim_loss: 118473.0452; val_kl_reg_loss: 2366.8731; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116229.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118596.0989; val_optim_loss: 118596.0989
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9222; val_auprc_score: 0.9346; val_best_acc_score: 0.8436; val_best_f1_score: 0.8391; train_kl_reg_loss: 2403.0046; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116061.8127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118464.8171; train_optim_loss: 118464.8171; val_kl_reg_loss: 2368.5509; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116150.6845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118519.2352; val_optim_loss: 118519.2352
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9231; val_auprc_score: 0.9352; val_best_acc_score: 0.8444; val_best_f1_score: 0.8405; train_kl_reg_loss: 2403.4125; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116028.7027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118432.1151; train_optim_loss: 118432.1151; val_kl_reg_loss: 2368.7754; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116140.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118509.0375; val_optim_loss: 118509.0375
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9231; val_auprc_score: 0.9353; val_best_acc_score: 0.8445; val_best_f1_score: 0.8412; train_kl_reg_loss: 2401.8906; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116094.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118496.7456; train_optim_loss: 118496.7456; val_kl_reg_loss: 2368.5633; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115925.5939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118294.1575; val_optim_loss: 118294.1575
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9233; val_auprc_score: 0.9355; val_best_acc_score: 0.8451; val_best_f1_score: 0.8415; train_kl_reg_loss: 2401.1046; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116032.5389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118433.6435; train_optim_loss: 118433.6435; val_kl_reg_loss: 2354.6462; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116050.6212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118405.2675; val_optim_loss: 118405.2675
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9231; val_auprc_score: 0.9350; val_best_acc_score: 0.8440; val_best_f1_score: 0.8409; train_kl_reg_loss: 2400.0116; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116035.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118435.1388; train_optim_loss: 118435.1388; val_kl_reg_loss: 2365.7610; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116125.0969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118490.8577; val_optim_loss: 118490.8577
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9239; val_auprc_score: 0.9363; val_best_acc_score: 0.8458; val_best_f1_score: 0.8409; train_kl_reg_loss: 2399.8804; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116075.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118475.6223; train_optim_loss: 118475.6223; val_kl_reg_loss: 2358.8255; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116035.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118393.9615; val_optim_loss: 118393.9615
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9232; val_auprc_score: 0.9355; val_best_acc_score: 0.8442; val_best_f1_score: 0.8411; train_kl_reg_loss: 2398.1978; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116005.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118403.2441; train_optim_loss: 118403.2441; val_kl_reg_loss: 2369.0957; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116168.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118538.0224; val_optim_loss: 118538.0224

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9223; val_auprc_score: 0.9346; val_best_acc_score: 0.8436; val_best_f1_score: 0.8400; train_kl_reg_loss: 2392.8571; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115960.0866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118352.9437; train_optim_loss: 118352.9437; val_kl_reg_loss: 2356.4850; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116101.7276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118458.2126; val_optim_loss: 118458.2126
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9226; val_auprc_score: 0.9347; val_best_acc_score: 0.8439; val_best_f1_score: 0.8398; train_kl_reg_loss: 2392.5048; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115938.0030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118330.5078; train_optim_loss: 118330.5078; val_kl_reg_loss: 2358.9725; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115969.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118328.4226; val_optim_loss: 118328.4226
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9232; val_auprc_score: 0.9355; val_best_acc_score: 0.8450; val_best_f1_score: 0.8414; train_kl_reg_loss: 2392.1905; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115961.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118353.2739; train_optim_loss: 118353.2739; val_kl_reg_loss: 2359.5165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116060.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118420.4899; val_optim_loss: 118420.4899
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9233; val_auprc_score: 0.9355; val_best_acc_score: 0.8446; val_best_f1_score: 0.8414; train_kl_reg_loss: 2392.4339; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115905.1102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118297.5439; train_optim_loss: 118297.5439; val_kl_reg_loss: 2356.9650; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116070.9949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118427.9594; val_optim_loss: 118427.9594

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 117 min 52 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9231
Val AUPRC score: 0.9351
Val best accuracy score: 0.8447
Val best F1 score: 0.8410
Val gene expr MSE score: 8.3208

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
