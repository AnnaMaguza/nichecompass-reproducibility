None
Run timestamp: 04072023_092738_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9648; val_auprc_score: 0.9690; val_best_acc_score: 0.9037; val_best_f1_score: 0.9025; train_kl_reg_loss: 2615.5790; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 213991.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216607.2231; train_optim_loss: 216607.2231; val_kl_reg_loss: 2813.7999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 203335.1166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206148.9165; val_optim_loss: 206148.9165
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9716; val_auprc_score: 0.9756; val_best_acc_score: 0.9159; val_best_f1_score: 0.9145; train_kl_reg_loss: 3282.9236; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 199926.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203209.0114; train_optim_loss: 203209.0114; val_kl_reg_loss: 3404.6507; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 194847.8153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198252.4655; val_optim_loss: 198252.4655
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9716; val_auprc_score: 0.9766; val_best_acc_score: 0.9184; val_best_f1_score: 0.9161; train_kl_reg_loss: 3498.4060; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 193758.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197257.3693; train_optim_loss: 197257.3693; val_kl_reg_loss: 3424.8781; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 190738.5594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194163.4369; val_optim_loss: 194163.4369
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9760; val_best_acc_score: 0.9172; val_best_f1_score: 0.9156; train_kl_reg_loss: 3503.9706; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 190820.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194324.6895; train_optim_loss: 194324.6895; val_kl_reg_loss: 3368.6423; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 188514.7366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191883.3793; val_optim_loss: 191883.3793
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9685; val_auprc_score: 0.9742; val_best_acc_score: 0.9146; val_best_f1_score: 0.9123; train_kl_reg_loss: 3474.6412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 189406.5640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192881.2050; train_optim_loss: 192881.2050; val_kl_reg_loss: 3427.7860; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 187875.5636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191303.3500; val_optim_loss: 191303.3500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9700; val_auprc_score: 0.9756; val_best_acc_score: 0.9165; val_best_f1_score: 0.9148; train_kl_reg_loss: 3411.8262; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 188342.0959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191753.9221; train_optim_loss: 191753.9221; val_kl_reg_loss: 3316.2205; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 186983.9845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190300.2047; val_optim_loss: 190300.2047
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9692; val_auprc_score: 0.9750; val_best_acc_score: 0.9156; val_best_f1_score: 0.9133; train_kl_reg_loss: 3361.4050; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 187767.4413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191128.8463; train_optim_loss: 191128.8463; val_kl_reg_loss: 3336.7946; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 186907.5589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190244.3537; val_optim_loss: 190244.3537
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9697; val_auprc_score: 0.9757; val_best_acc_score: 0.9184; val_best_f1_score: 0.9157; train_kl_reg_loss: 3322.1021; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 187336.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190658.9734; train_optim_loss: 190658.9734; val_kl_reg_loss: 3249.6880; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 186269.4599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189519.1483; val_optim_loss: 189519.1483
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9703; val_auprc_score: 0.9762; val_best_acc_score: 0.9189; val_best_f1_score: 0.9159; train_kl_reg_loss: 3288.2227; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 187143.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190431.9624; train_optim_loss: 190431.9624; val_kl_reg_loss: 3220.0697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 186253.5087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189473.5786; val_optim_loss: 189473.5786
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9690; val_auprc_score: 0.9752; val_best_acc_score: 0.9161; val_best_f1_score: 0.9139; train_kl_reg_loss: 3264.0712; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186818.9526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190083.0237; train_optim_loss: 190083.0237; val_kl_reg_loss: 3150.5459; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 186081.1668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189231.7129; val_optim_loss: 189231.7129
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9696; val_auprc_score: 0.9757; val_best_acc_score: 0.9182; val_best_f1_score: 0.9162; train_kl_reg_loss: 3237.4068; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186685.3743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189922.7812; train_optim_loss: 189922.7812; val_kl_reg_loss: 3191.0689; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185722.8918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188913.9609; val_optim_loss: 188913.9609
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9699; val_auprc_score: 0.9761; val_best_acc_score: 0.9186; val_best_f1_score: 0.9161; train_kl_reg_loss: 3211.0863; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186518.7082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189729.7944; train_optim_loss: 189729.7944; val_kl_reg_loss: 3172.0644; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185774.0838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188946.1480; val_optim_loss: 188946.1480
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9698; val_auprc_score: 0.9757; val_best_acc_score: 0.9180; val_best_f1_score: 0.9162; train_kl_reg_loss: 3195.1354; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186400.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189595.9587; train_optim_loss: 189595.9587; val_kl_reg_loss: 3131.8951; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185643.1972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188775.0922; val_optim_loss: 188775.0922
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9698; val_auprc_score: 0.9758; val_best_acc_score: 0.9186; val_best_f1_score: 0.9161; train_kl_reg_loss: 3170.7987; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186348.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189518.8735; train_optim_loss: 189518.8735; val_kl_reg_loss: 3111.9177; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185730.3585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188842.2763; val_optim_loss: 188842.2763
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9698; val_auprc_score: 0.9760; val_best_acc_score: 0.9186; val_best_f1_score: 0.9159; train_kl_reg_loss: 3153.7983; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186204.7175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189358.5156; train_optim_loss: 189358.5156; val_kl_reg_loss: 3074.5418; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185492.5530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188567.0947; val_optim_loss: 188567.0947
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9680; val_auprc_score: 0.9745; val_best_acc_score: 0.9151; val_best_f1_score: 0.9130; train_kl_reg_loss: 3135.4658; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186145.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189281.1601; train_optim_loss: 189281.1601; val_kl_reg_loss: 3035.8855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185648.0851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188683.9707; val_optim_loss: 188683.9707
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9697; val_auprc_score: 0.9759; val_best_acc_score: 0.9192; val_best_f1_score: 0.9166; train_kl_reg_loss: 3123.9736; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186067.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189191.2309; train_optim_loss: 189191.2309; val_kl_reg_loss: 3055.1452; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185601.3170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188656.4626; val_optim_loss: 188656.4626
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9699; val_auprc_score: 0.9762; val_best_acc_score: 0.9190; val_best_f1_score: 0.9166; train_kl_reg_loss: 3111.8296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186072.2491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189184.0787; train_optim_loss: 189184.0787; val_kl_reg_loss: 2989.8787; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185665.9053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188655.7841; val_optim_loss: 188655.7841
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9700; val_auprc_score: 0.9759; val_best_acc_score: 0.9193; val_best_f1_score: 0.9166; train_kl_reg_loss: 3096.1979; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 186045.8933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189142.0912; train_optim_loss: 189142.0912; val_kl_reg_loss: 2968.8702; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 185690.9717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188659.8415; val_optim_loss: 188659.8415

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9734; val_auprc_score: 0.9788; val_best_acc_score: 0.9252; val_best_f1_score: 0.9225; train_kl_reg_loss: 2657.5192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 184529.8564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187187.3759; train_optim_loss: 187187.3759; val_kl_reg_loss: 2383.9671; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184241.4811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186625.4487; val_optim_loss: 186625.4487
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9737; val_auprc_score: 0.9789; val_best_acc_score: 0.9249; val_best_f1_score: 0.9234; train_kl_reg_loss: 2317.9747; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 184102.9440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186420.9184; train_optim_loss: 186420.9184; val_kl_reg_loss: 2208.0981; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184327.5108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186535.6084; val_optim_loss: 186535.6084
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9741; val_auprc_score: 0.9792; val_best_acc_score: 0.9252; val_best_f1_score: 0.9235; train_kl_reg_loss: 2209.2689; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183926.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186136.0981; train_optim_loss: 186136.0981; val_kl_reg_loss: 2134.9501; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183832.9680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185967.9180; val_optim_loss: 185967.9180
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9741; val_auprc_score: 0.9793; val_best_acc_score: 0.9253; val_best_f1_score: 0.9236; train_kl_reg_loss: 2161.4047; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183837.5041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185998.9088; train_optim_loss: 185998.9088; val_kl_reg_loss: 2116.3185; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184064.4848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186180.8036; val_optim_loss: 186180.8036
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9747; val_auprc_score: 0.9795; val_best_acc_score: 0.9266; val_best_f1_score: 0.9244; train_kl_reg_loss: 2138.5174; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183742.6940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185881.2114; train_optim_loss: 185881.2114; val_kl_reg_loss: 2076.6218; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184001.0213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186077.6437; val_optim_loss: 186077.6437
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9752; val_auprc_score: 0.9801; val_best_acc_score: 0.9277; val_best_f1_score: 0.9254; train_kl_reg_loss: 2121.0819; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183665.6456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185786.7272; train_optim_loss: 185786.7272; val_kl_reg_loss: 2078.5522; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184045.8452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186124.3967; val_optim_loss: 186124.3967
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9754; val_auprc_score: 0.9801; val_best_acc_score: 0.9281; val_best_f1_score: 0.9256; train_kl_reg_loss: 2110.7314; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183654.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185765.5267; train_optim_loss: 185765.5267; val_kl_reg_loss: 2075.7230; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184016.3536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186092.0771; val_optim_loss: 186092.0771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9752; val_auprc_score: 0.9801; val_best_acc_score: 0.9273; val_best_f1_score: 0.9257; train_kl_reg_loss: 2091.6907; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183473.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185564.8766; train_optim_loss: 185564.8766; val_kl_reg_loss: 2048.6948; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183934.9790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185983.6740; val_optim_loss: 185983.6740
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9755; val_auprc_score: 0.9801; val_best_acc_score: 0.9280; val_best_f1_score: 0.9266; train_kl_reg_loss: 2082.1199; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183432.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185515.1069; train_optim_loss: 185515.1069; val_kl_reg_loss: 2047.2248; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183962.8969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186010.1213; val_optim_loss: 186010.1213
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9755; val_auprc_score: 0.9803; val_best_acc_score: 0.9278; val_best_f1_score: 0.9260; train_kl_reg_loss: 2077.9850; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183376.6132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185454.5982; train_optim_loss: 185454.5982; val_kl_reg_loss: 2045.3620; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184084.5656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186129.9274; val_optim_loss: 186129.9274
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9752; val_auprc_score: 0.9798; val_best_acc_score: 0.9279; val_best_f1_score: 0.9256; train_kl_reg_loss: 2075.5711; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183314.4195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185389.9909; train_optim_loss: 185389.9909; val_kl_reg_loss: 2037.9272; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183763.9033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185801.8305; val_optim_loss: 185801.8305
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9758; val_auprc_score: 0.9806; val_best_acc_score: 0.9278; val_best_f1_score: 0.9264; train_kl_reg_loss: 2071.8405; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183368.0577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185439.8982; train_optim_loss: 185439.8982; val_kl_reg_loss: 2035.8556; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183856.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185891.8668; val_optim_loss: 185891.8668
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9757; val_auprc_score: 0.9804; val_best_acc_score: 0.9282; val_best_f1_score: 0.9265; train_kl_reg_loss: 2069.7953; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183311.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185381.6733; train_optim_loss: 185381.6733; val_kl_reg_loss: 2035.2796; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183774.2741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185809.5538; val_optim_loss: 185809.5538
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9755; val_auprc_score: 0.9803; val_best_acc_score: 0.9278; val_best_f1_score: 0.9261; train_kl_reg_loss: 2068.4250; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183328.8474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185397.2723; train_optim_loss: 185397.2723; val_kl_reg_loss: 2032.5014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183951.1232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185983.6249; val_optim_loss: 185983.6249
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9755; val_auprc_score: 0.9804; val_best_acc_score: 0.9278; val_best_f1_score: 0.9255; train_kl_reg_loss: 2066.7578; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183333.9367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185400.6943; train_optim_loss: 185400.6943; val_kl_reg_loss: 2030.6799; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183865.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185896.2663; val_optim_loss: 185896.2663

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9757; val_auprc_score: 0.9805; val_best_acc_score: 0.9281; val_best_f1_score: 0.9266; train_kl_reg_loss: 2064.6314; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183256.2203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185320.8516; train_optim_loss: 185320.8516; val_kl_reg_loss: 2031.6428; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183955.6646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185987.3078; val_optim_loss: 185987.3078
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9756; val_auprc_score: 0.9805; val_best_acc_score: 0.9274; val_best_f1_score: 0.9256; train_kl_reg_loss: 2064.3367; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183240.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185304.7725; train_optim_loss: 185304.7725; val_kl_reg_loss: 2031.2426; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183611.5947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185642.8371; val_optim_loss: 185642.8371
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9757; val_auprc_score: 0.9803; val_best_acc_score: 0.9284; val_best_f1_score: 0.9269; train_kl_reg_loss: 2064.9218; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183262.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185327.3924; train_optim_loss: 185327.3924; val_kl_reg_loss: 2032.2678; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183746.8119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185779.0797; val_optim_loss: 185779.0797
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9759; val_auprc_score: 0.9806; val_best_acc_score: 0.9279; val_best_f1_score: 0.9263; train_kl_reg_loss: 2064.2844; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183280.8951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185345.1794; train_optim_loss: 185345.1794; val_kl_reg_loss: 2031.1212; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183784.2908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185815.4122; val_optim_loss: 185815.4122
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9758; val_auprc_score: 0.9807; val_best_acc_score: 0.9285; val_best_f1_score: 0.9271; train_kl_reg_loss: 2064.4859; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183219.3508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185283.8365; train_optim_loss: 185283.8365; val_kl_reg_loss: 2030.2502; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183761.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185791.9202; val_optim_loss: 185791.9202
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9756; val_auprc_score: 0.9803; val_best_acc_score: 0.9276; val_best_f1_score: 0.9261; train_kl_reg_loss: 2064.2395; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183261.9865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185326.2261; train_optim_loss: 185326.2261; val_kl_reg_loss: 2032.1260; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183684.0520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185716.1783; val_optim_loss: 185716.1783

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9757; val_auprc_score: 0.9802; val_best_acc_score: 0.9282; val_best_f1_score: 0.9267; train_kl_reg_loss: 2064.9145; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183240.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185305.0684; train_optim_loss: 185305.0684; val_kl_reg_loss: 2031.7845; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 184031.6278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186063.4119; val_optim_loss: 186063.4119
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9757; val_auprc_score: 0.9805; val_best_acc_score: 0.9276; val_best_f1_score: 0.9260; train_kl_reg_loss: 2064.1849; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183263.6317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185327.8164; train_optim_loss: 185327.8164; val_kl_reg_loss: 2031.5339; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183808.8419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185840.3754; val_optim_loss: 185840.3754
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9757; val_auprc_score: 0.9805; val_best_acc_score: 0.9272; val_best_f1_score: 0.9258; train_kl_reg_loss: 2064.0705; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183273.6482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185337.7187; train_optim_loss: 185337.7187; val_kl_reg_loss: 2031.4224; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183839.7932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185871.2159; val_optim_loss: 185871.2159
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9756; val_auprc_score: 0.9804; val_best_acc_score: 0.9273; val_best_f1_score: 0.9258; train_kl_reg_loss: 2064.1110; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 183314.8246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185378.9356; train_optim_loss: 185378.9356; val_kl_reg_loss: 2030.5197; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 183625.9909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185656.5111; val_optim_loss: 185656.5111

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 129 min 56 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9757
Val AUPRC score: 0.9803
Val best accuracy score: 0.9280
Val best F1 score: 0.9266
Val gene expr MSE score: 8.6108

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
