None
Run timestamp: 05072023_211305_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9140; val_auprc_score: 0.9254; val_best_acc_score: 0.8298; val_best_f1_score: 0.8219; train_kl_reg_loss: 5072.8024; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 140126.6527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145199.4550; train_optim_loss: 145199.4550; val_kl_reg_loss: 3539.1859; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 129453.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132992.8988; val_optim_loss: 132992.8988
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9212; val_auprc_score: 0.9322; val_best_acc_score: 0.8366; val_best_f1_score: 0.8346; train_kl_reg_loss: 3163.0175; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126757.8838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129920.9015; train_optim_loss: 129920.9015; val_kl_reg_loss: 2805.4108; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124205.3927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127010.8030; val_optim_loss: 127010.8030
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9252; val_auprc_score: 0.9353; val_best_acc_score: 0.8446; val_best_f1_score: 0.8390; train_kl_reg_loss: 2807.3413; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122918.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125726.2280; train_optim_loss: 125726.2280; val_kl_reg_loss: 2633.0355; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121523.6200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124156.6554; val_optim_loss: 124156.6554
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9251; val_auprc_score: 0.9349; val_best_acc_score: 0.8435; val_best_f1_score: 0.8384; train_kl_reg_loss: 2683.4713; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120821.6198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123505.0911; train_optim_loss: 123505.0911; val_kl_reg_loss: 2615.8019; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 120051.0920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122666.8938; val_optim_loss: 122666.8938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9233; val_auprc_score: 0.9335; val_best_acc_score: 0.8414; val_best_f1_score: 0.8362; train_kl_reg_loss: 2631.1989; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119609.5894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122240.7883; train_optim_loss: 122240.7883; val_kl_reg_loss: 2563.2344; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118908.8348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121472.0693; val_optim_loss: 121472.0693
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9222; val_auprc_score: 0.9325; val_best_acc_score: 0.8401; val_best_f1_score: 0.8357; train_kl_reg_loss: 2601.1361; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118757.3610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121358.4972; train_optim_loss: 121358.4972; val_kl_reg_loss: 2509.7021; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118303.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120813.2761; val_optim_loss: 120813.2761
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9218; val_auprc_score: 0.9318; val_best_acc_score: 0.8384; val_best_f1_score: 0.8354; train_kl_reg_loss: 2580.9905; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118226.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120807.7233; train_optim_loss: 120807.7233; val_kl_reg_loss: 2528.9036; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117764.9201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120293.8237; val_optim_loss: 120293.8237
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9220; val_auprc_score: 0.9323; val_best_acc_score: 0.8404; val_best_f1_score: 0.8350; train_kl_reg_loss: 2565.8261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117777.5837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120343.4100; train_optim_loss: 120343.4100; val_kl_reg_loss: 2469.1504; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117605.0808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120074.2308; val_optim_loss: 120074.2308
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9195; val_auprc_score: 0.9305; val_best_acc_score: 0.8369; val_best_f1_score: 0.8335; train_kl_reg_loss: 2552.5619; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117511.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120063.7954; train_optim_loss: 120063.7954; val_kl_reg_loss: 2475.6084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117337.1110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119812.7193; val_optim_loss: 119812.7193
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9201; val_auprc_score: 0.9310; val_best_acc_score: 0.8365; val_best_f1_score: 0.8321; train_kl_reg_loss: 2544.9559; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117240.1420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119785.0979; train_optim_loss: 119785.0979; val_kl_reg_loss: 2486.1532; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117292.4439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119778.5971; val_optim_loss: 119778.5971
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9225; val_auprc_score: 0.9331; val_best_acc_score: 0.8399; val_best_f1_score: 0.8369; train_kl_reg_loss: 2535.2953; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117027.2120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119562.5073; train_optim_loss: 119562.5073; val_kl_reg_loss: 2457.8497; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117039.8974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119497.7474; val_optim_loss: 119497.7474
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9223; val_auprc_score: 0.9333; val_best_acc_score: 0.8408; val_best_f1_score: 0.8364; train_kl_reg_loss: 2527.7465; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116872.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119400.6895; train_optim_loss: 119400.6895; val_kl_reg_loss: 2477.6258; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117002.3165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119479.9424; val_optim_loss: 119479.9424
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9218; val_auprc_score: 0.9330; val_best_acc_score: 0.8411; val_best_f1_score: 0.8363; train_kl_reg_loss: 2522.4599; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116728.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119251.3267; train_optim_loss: 119251.3267; val_kl_reg_loss: 2479.3948; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116889.4256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119368.8203; val_optim_loss: 119368.8203
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9219; val_auprc_score: 0.9331; val_best_acc_score: 0.8416; val_best_f1_score: 0.8378; train_kl_reg_loss: 2517.5439; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116538.5707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119056.1146; train_optim_loss: 119056.1146; val_kl_reg_loss: 2504.3538; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116690.2837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119194.6374; val_optim_loss: 119194.6374
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9220; val_auprc_score: 0.9335; val_best_acc_score: 0.8405; val_best_f1_score: 0.8369; train_kl_reg_loss: 2509.7400; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116488.5803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118998.3202; train_optim_loss: 118998.3202; val_kl_reg_loss: 2448.9621; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116542.9416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118991.9038; val_optim_loss: 118991.9038
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9233; val_auprc_score: 0.9349; val_best_acc_score: 0.8439; val_best_f1_score: 0.8391; train_kl_reg_loss: 2502.4493; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116407.7582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118910.2075; train_optim_loss: 118910.2075; val_kl_reg_loss: 2437.6279; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116583.7418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119021.3698; val_optim_loss: 119021.3698
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9223; val_auprc_score: 0.9336; val_best_acc_score: 0.8419; val_best_f1_score: 0.8368; train_kl_reg_loss: 2498.6397; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116266.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118765.4082; train_optim_loss: 118765.4082; val_kl_reg_loss: 2465.0694; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116629.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119095.0425; val_optim_loss: 119095.0425
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9248; val_auprc_score: 0.9363; val_best_acc_score: 0.8439; val_best_f1_score: 0.8417; train_kl_reg_loss: 2492.4173; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116224.2736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118716.6908; train_optim_loss: 118716.6908; val_kl_reg_loss: 2447.7518; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116419.5294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118867.2813; val_optim_loss: 118867.2813
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9240; val_auprc_score: 0.9354; val_best_acc_score: 0.8435; val_best_f1_score: 0.8395; train_kl_reg_loss: 2486.0615; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116186.3541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118672.4155; train_optim_loss: 118672.4155; val_kl_reg_loss: 2417.5517; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116258.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118676.1741; val_optim_loss: 118676.1741
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9240; val_auprc_score: 0.9361; val_best_acc_score: 0.8438; val_best_f1_score: 0.8392; train_kl_reg_loss: 2482.4350; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116076.7195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118559.1544; train_optim_loss: 118559.1544; val_kl_reg_loss: 2432.6262; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116429.4244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118862.0503; val_optim_loss: 118862.0503
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9240; val_auprc_score: 0.9357; val_best_acc_score: 0.8451; val_best_f1_score: 0.8397; train_kl_reg_loss: 2476.0977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116058.2611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118534.3588; train_optim_loss: 118534.3588; val_kl_reg_loss: 2441.3829; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116203.7014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118645.0842; val_optim_loss: 118645.0842
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9272; val_auprc_score: 0.9384; val_best_acc_score: 0.8486; val_best_f1_score: 0.8447; train_kl_reg_loss: 2472.8961; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115978.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118451.2369; train_optim_loss: 118451.2369; val_kl_reg_loss: 2420.4755; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116123.8379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118544.3133; val_optim_loss: 118544.3133
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9254; val_auprc_score: 0.9370; val_best_acc_score: 0.8469; val_best_f1_score: 0.8425; train_kl_reg_loss: 2467.6459; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115957.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118425.3988; train_optim_loss: 118425.3988; val_kl_reg_loss: 2444.9878; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116185.8651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118630.8530; val_optim_loss: 118630.8530
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9266; val_auprc_score: 0.9381; val_best_acc_score: 0.8473; val_best_f1_score: 0.8443; train_kl_reg_loss: 2464.3370; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115923.7896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118388.1264; train_optim_loss: 118388.1264; val_kl_reg_loss: 2451.9477; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116155.8425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118607.7903; val_optim_loss: 118607.7903
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9253; val_auprc_score: 0.9368; val_best_acc_score: 0.8464; val_best_f1_score: 0.8434; train_kl_reg_loss: 2460.3588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115878.0405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118338.3993; train_optim_loss: 118338.3993; val_kl_reg_loss: 2441.7611; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116240.8178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118682.5790; val_optim_loss: 118682.5790
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9254; val_auprc_score: 0.9373; val_best_acc_score: 0.8474; val_best_f1_score: 0.8429; train_kl_reg_loss: 2455.4770; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115871.5143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118326.9913; train_optim_loss: 118326.9913; val_kl_reg_loss: 2428.5942; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116143.5697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118572.1638; val_optim_loss: 118572.1638

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9276; val_auprc_score: 0.9392; val_best_acc_score: 0.8495; val_best_f1_score: 0.8462; train_kl_reg_loss: 2406.1760; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115061.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117467.9795; train_optim_loss: 117467.9795; val_kl_reg_loss: 2363.3283; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115573.3878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117936.7159; val_optim_loss: 117936.7159
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9270; val_auprc_score: 0.9386; val_best_acc_score: 0.8490; val_best_f1_score: 0.8455; train_kl_reg_loss: 2402.4278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115035.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117438.2567; train_optim_loss: 117438.2567; val_kl_reg_loss: 2379.1199; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115649.1820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118028.3021; val_optim_loss: 118028.3021
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9278; val_auprc_score: 0.9392; val_best_acc_score: 0.8502; val_best_f1_score: 0.8460; train_kl_reg_loss: 2401.2276; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114989.3609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117390.5885; train_optim_loss: 117390.5885; val_kl_reg_loss: 2358.3086; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115615.7316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117974.0401; val_optim_loss: 117974.0401
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9277; val_auprc_score: 0.9394; val_best_acc_score: 0.8506; val_best_f1_score: 0.8457; train_kl_reg_loss: 2399.4686; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114946.7736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117346.2421; train_optim_loss: 117346.2421; val_kl_reg_loss: 2359.1511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115397.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117756.3104; val_optim_loss: 117756.3104
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9276; val_auprc_score: 0.9392; val_best_acc_score: 0.8496; val_best_f1_score: 0.8456; train_kl_reg_loss: 2398.4923; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114976.2510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117374.7433; train_optim_loss: 117374.7433; val_kl_reg_loss: 2362.4895; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115472.9206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117835.4099; val_optim_loss: 117835.4099
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9274; val_auprc_score: 0.9393; val_best_acc_score: 0.8510; val_best_f1_score: 0.8466; train_kl_reg_loss: 2396.2721; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114927.8122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117324.0842; train_optim_loss: 117324.0842; val_kl_reg_loss: 2352.9496; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115368.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117721.0645; val_optim_loss: 117721.0645
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9272; val_auprc_score: 0.9388; val_best_acc_score: 0.8500; val_best_f1_score: 0.8455; train_kl_reg_loss: 2395.7983; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114925.4635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117321.2618; train_optim_loss: 117321.2618; val_kl_reg_loss: 2372.2152; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115471.2600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117843.4749; val_optim_loss: 117843.4749
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9274; val_auprc_score: 0.9390; val_best_acc_score: 0.8498; val_best_f1_score: 0.8462; train_kl_reg_loss: 2393.5917; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114867.7055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117261.2971; train_optim_loss: 117261.2971; val_kl_reg_loss: 2351.1758; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115473.5081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117824.6842; val_optim_loss: 117824.6842
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9273; val_auprc_score: 0.9389; val_best_acc_score: 0.8500; val_best_f1_score: 0.8460; train_kl_reg_loss: 2392.7702; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114901.2706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117294.0408; train_optim_loss: 117294.0408; val_kl_reg_loss: 2351.3407; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115435.8723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117787.2128; val_optim_loss: 117787.2128
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9272; val_auprc_score: 0.9389; val_best_acc_score: 0.8502; val_best_f1_score: 0.8459; train_kl_reg_loss: 2390.6710; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114902.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117292.8355; train_optim_loss: 117292.8355; val_kl_reg_loss: 2358.1356; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115481.5813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117839.7169; val_optim_loss: 117839.7169

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9271; val_auprc_score: 0.9389; val_best_acc_score: 0.8492; val_best_f1_score: 0.8452; train_kl_reg_loss: 2385.2938; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114797.3129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117182.6066; train_optim_loss: 117182.6066; val_kl_reg_loss: 2348.8675; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115407.4663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117756.3336; val_optim_loss: 117756.3336
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9276; val_auprc_score: 0.9390; val_best_acc_score: 0.8509; val_best_f1_score: 0.8468; train_kl_reg_loss: 2384.1215; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114747.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117131.1360; train_optim_loss: 117131.1360; val_kl_reg_loss: 2348.5881; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115353.4815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117702.0695; val_optim_loss: 117702.0695
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9285; val_auprc_score: 0.9400; val_best_acc_score: 0.8519; val_best_f1_score: 0.8473; train_kl_reg_loss: 2384.0672; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114726.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117110.6037; train_optim_loss: 117110.6037; val_kl_reg_loss: 2348.7604; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115233.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117581.9197; val_optim_loss: 117581.9197
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9271; val_auprc_score: 0.9390; val_best_acc_score: 0.8496; val_best_f1_score: 0.8454; train_kl_reg_loss: 2385.0601; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114772.2479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117157.3081; train_optim_loss: 117157.3081; val_kl_reg_loss: 2350.8930; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115230.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117581.4886; val_optim_loss: 117581.4886
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9270; val_auprc_score: 0.9383; val_best_acc_score: 0.8500; val_best_f1_score: 0.8460; train_kl_reg_loss: 2384.7123; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114778.6057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117163.3180; train_optim_loss: 117163.3180; val_kl_reg_loss: 2346.6640; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115457.3989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117804.0631; val_optim_loss: 117804.0631
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9282; val_auprc_score: 0.9394; val_best_acc_score: 0.8519; val_best_f1_score: 0.8482; train_kl_reg_loss: 2384.1147; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114741.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117125.9704; train_optim_loss: 117125.9704; val_kl_reg_loss: 2348.6465; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115350.1531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117698.7999; val_optim_loss: 117698.7999
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9284; val_auprc_score: 0.9401; val_best_acc_score: 0.8524; val_best_f1_score: 0.8479; train_kl_reg_loss: 2384.0622; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114731.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117115.4832; train_optim_loss: 117115.4832; val_kl_reg_loss: 2344.2253; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115310.7009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117654.9262; val_optim_loss: 117654.9262
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9278; val_auprc_score: 0.9393; val_best_acc_score: 0.8512; val_best_f1_score: 0.8473; train_kl_reg_loss: 2383.1413; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114739.3055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117122.4468; train_optim_loss: 117122.4468; val_kl_reg_loss: 2347.6351; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115278.8678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117626.5028; val_optim_loss: 117626.5028

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9275; val_auprc_score: 0.9392; val_best_acc_score: 0.8507; val_best_f1_score: 0.8467; train_kl_reg_loss: 2383.5233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114742.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117126.2409; train_optim_loss: 117126.2409; val_kl_reg_loss: 2346.5493; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115203.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117549.9858; val_optim_loss: 117549.9858
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9268; val_auprc_score: 0.9386; val_best_acc_score: 0.8495; val_best_f1_score: 0.8457; train_kl_reg_loss: 2383.3374; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114771.7152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117155.0526; train_optim_loss: 117155.0526; val_kl_reg_loss: 2348.6868; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115347.6257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117696.3125; val_optim_loss: 117696.3125
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9273; val_auprc_score: 0.9390; val_best_acc_score: 0.8497; val_best_f1_score: 0.8460; train_kl_reg_loss: 2383.9338; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114801.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117185.0104; train_optim_loss: 117185.0104; val_kl_reg_loss: 2348.8316; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115320.5967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117669.4281; val_optim_loss: 117669.4281
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9282; val_auprc_score: 0.9397; val_best_acc_score: 0.8507; val_best_f1_score: 0.8478; train_kl_reg_loss: 2383.4799; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114721.5830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117105.0630; train_optim_loss: 117105.0630; val_kl_reg_loss: 2347.6437; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115349.4005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117697.0445; val_optim_loss: 117697.0445
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9271; val_auprc_score: 0.9386; val_best_acc_score: 0.8501; val_best_f1_score: 0.8466; train_kl_reg_loss: 2383.6779; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114751.6337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117135.3117; train_optim_loss: 117135.3117; val_kl_reg_loss: 2348.4705; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115378.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117727.2229; val_optim_loss: 117727.2229

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9271; val_auprc_score: 0.9389; val_best_acc_score: 0.8503; val_best_f1_score: 0.8459; train_kl_reg_loss: 2383.8264; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114707.6481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117091.4744; train_optim_loss: 117091.4744; val_kl_reg_loss: 2348.9700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115317.6891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117666.6593; val_optim_loss: 117666.6593
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9276; val_auprc_score: 0.9393; val_best_acc_score: 0.8506; val_best_f1_score: 0.8473; train_kl_reg_loss: 2383.7020; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114700.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117083.9865; train_optim_loss: 117083.9865; val_kl_reg_loss: 2348.1898; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115303.4656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117651.6553; val_optim_loss: 117651.6553
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9273; val_auprc_score: 0.9390; val_best_acc_score: 0.8508; val_best_f1_score: 0.8466; train_kl_reg_loss: 2383.7184; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114748.3695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117132.0878; train_optim_loss: 117132.0878; val_kl_reg_loss: 2347.6753; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115314.9499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117662.6252; val_optim_loss: 117662.6252
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9276; val_auprc_score: 0.9392; val_best_acc_score: 0.8513; val_best_f1_score: 0.8466; train_kl_reg_loss: 2383.4876; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 114750.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117134.1016; train_optim_loss: 117134.1016; val_kl_reg_loss: 2348.2060; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 115444.6437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117792.8499; val_optim_loss: 117792.8499

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 45 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9278
Val AUPRC score: 0.9396
Val best accuracy score: 0.8508
Val best F1 score: 0.8461
Val gene expr MSE score: 8.7729

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
