None
Run timestamp: 28062023_181624_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9734; val_auprc_score: 0.9678; val_best_acc_score: 0.9223; val_best_f1_score: 0.9247; train_kl_reg_loss: 2394.4139; train_edge_recon_loss: 28194.5892; train_gene_expr_recon_loss: 13463.2617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44052.2648; train_optim_loss: 44052.2648; val_kl_reg_loss: 2447.4231; val_edge_recon_loss: 26502.6285; val_gene_expr_recon_loss: 12759.8009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41709.8525; val_optim_loss: 41709.8525
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9824; val_auprc_score: 0.9793; val_best_acc_score: 0.9384; val_best_f1_score: 0.9401; train_kl_reg_loss: 2545.0756; train_edge_recon_loss: 27635.6215; train_gene_expr_recon_loss: 12669.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42849.7527; train_optim_loss: 42849.7527; val_kl_reg_loss: 2554.4172; val_edge_recon_loss: 26354.5327; val_gene_expr_recon_loss: 12389.0670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41298.0172; val_optim_loss: 41298.0172
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9844; val_auprc_score: 0.9819; val_best_acc_score: 0.9410; val_best_f1_score: 0.9421; train_kl_reg_loss: 2557.7299; train_edge_recon_loss: 27558.5199; train_gene_expr_recon_loss: 12387.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42504.2434; train_optim_loss: 42504.2434; val_kl_reg_loss: 2543.3831; val_edge_recon_loss: 26330.7753; val_gene_expr_recon_loss: 12201.8501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41076.0084; val_optim_loss: 41076.0084
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9848; val_auprc_score: 0.9824; val_best_acc_score: 0.9427; val_best_f1_score: 0.9440; train_kl_reg_loss: 2571.0838; train_edge_recon_loss: 27519.3446; train_gene_expr_recon_loss: 12266.5447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42356.9731; train_optim_loss: 42356.9731; val_kl_reg_loss: 2472.4077; val_edge_recon_loss: 26339.3711; val_gene_expr_recon_loss: 12124.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40936.5242; val_optim_loss: 40936.5242
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9853; val_auprc_score: 0.9826; val_best_acc_score: 0.9452; val_best_f1_score: 0.9465; train_kl_reg_loss: 2587.0726; train_edge_recon_loss: 27484.1683; train_gene_expr_recon_loss: 12204.5981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42275.8389; train_optim_loss: 42275.8389; val_kl_reg_loss: 2594.4586; val_edge_recon_loss: 26311.5883; val_gene_expr_recon_loss: 12068.1363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40974.1831; val_optim_loss: 40974.1831
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9869; val_auprc_score: 0.9844; val_best_acc_score: 0.9469; val_best_f1_score: 0.9480; train_kl_reg_loss: 2599.5872; train_edge_recon_loss: 27468.3362; train_gene_expr_recon_loss: 12169.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42237.6172; train_optim_loss: 42237.6172; val_kl_reg_loss: 2554.5839; val_edge_recon_loss: 26302.5693; val_gene_expr_recon_loss: 12034.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40891.9645; val_optim_loss: 40891.9645
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9883; val_auprc_score: 0.9865; val_best_acc_score: 0.9503; val_best_f1_score: 0.9513; train_kl_reg_loss: 2610.3421; train_edge_recon_loss: 27443.6052; train_gene_expr_recon_loss: 12137.9940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42191.9413; train_optim_loss: 42191.9413; val_kl_reg_loss: 2591.6693; val_edge_recon_loss: 26231.7625; val_gene_expr_recon_loss: 12002.5942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40826.0259; val_optim_loss: 40826.0259
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9889; val_auprc_score: 0.9871; val_best_acc_score: 0.9517; val_best_f1_score: 0.9526; train_kl_reg_loss: 2616.1598; train_edge_recon_loss: 27442.0637; train_gene_expr_recon_loss: 12119.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42178.0528; train_optim_loss: 42178.0528; val_kl_reg_loss: 2673.0896; val_edge_recon_loss: 26257.0906; val_gene_expr_recon_loss: 11988.7010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40918.8813; val_optim_loss: 40918.8813
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9886; val_auprc_score: 0.9865; val_best_acc_score: 0.9523; val_best_f1_score: 0.9531; train_kl_reg_loss: 2622.3405; train_edge_recon_loss: 27430.0487; train_gene_expr_recon_loss: 12103.4386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42155.8277; train_optim_loss: 42155.8277; val_kl_reg_loss: 2582.5311; val_edge_recon_loss: 26240.1709; val_gene_expr_recon_loss: 11967.3364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40790.0383; val_optim_loss: 40790.0383
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9537; val_best_f1_score: 0.9546; train_kl_reg_loss: 2626.6855; train_edge_recon_loss: 27424.4159; train_gene_expr_recon_loss: 12093.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42144.2727; train_optim_loss: 42144.2727; val_kl_reg_loss: 2647.1402; val_edge_recon_loss: 26242.5115; val_gene_expr_recon_loss: 11949.6264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40839.2780; val_optim_loss: 40839.2780
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9896; val_auprc_score: 0.9880; val_best_acc_score: 0.9540; val_best_f1_score: 0.9548; train_kl_reg_loss: 2630.3361; train_edge_recon_loss: 27417.1200; train_gene_expr_recon_loss: 12082.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42130.1452; train_optim_loss: 42130.1452; val_kl_reg_loss: 2635.7498; val_edge_recon_loss: 26234.5722; val_gene_expr_recon_loss: 11944.5468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40814.8687; val_optim_loss: 40814.8687
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9904; val_auprc_score: 0.9888; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 2635.7610; train_edge_recon_loss: 27407.0068; train_gene_expr_recon_loss: 12072.5409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42115.3088; train_optim_loss: 42115.3088; val_kl_reg_loss: 2596.6943; val_edge_recon_loss: 26246.2917; val_gene_expr_recon_loss: 11953.9932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40796.9792; val_optim_loss: 40796.9792
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9891; val_auprc_score: 0.9875; val_best_acc_score: 0.9532; val_best_f1_score: 0.9541; train_kl_reg_loss: 2639.0572; train_edge_recon_loss: 27402.0433; train_gene_expr_recon_loss: 12064.1539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42105.2545; train_optim_loss: 42105.2545; val_kl_reg_loss: 2583.1584; val_edge_recon_loss: 26225.4342; val_gene_expr_recon_loss: 11936.4551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40745.0476; val_optim_loss: 40745.0476
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9906; val_auprc_score: 0.9891; val_best_acc_score: 0.9566; val_best_f1_score: 0.9573; train_kl_reg_loss: 2644.3564; train_edge_recon_loss: 27384.1463; train_gene_expr_recon_loss: 12058.9762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42087.4788; train_optim_loss: 42087.4788; val_kl_reg_loss: 2549.9567; val_edge_recon_loss: 26249.3543; val_gene_expr_recon_loss: 11913.9732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40713.2842; val_optim_loss: 40713.2842
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9557; val_best_f1_score: 0.9564; train_kl_reg_loss: 2646.6856; train_edge_recon_loss: 27380.9349; train_gene_expr_recon_loss: 12053.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42081.4252; train_optim_loss: 42081.4252; val_kl_reg_loss: 2597.8748; val_edge_recon_loss: 26249.0438; val_gene_expr_recon_loss: 11933.8534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40780.7720; val_optim_loss: 40780.7720
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9909; val_auprc_score: 0.9896; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 2648.1185; train_edge_recon_loss: 27382.7829; train_gene_expr_recon_loss: 12048.5421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42079.4435; train_optim_loss: 42079.4435; val_kl_reg_loss: 2643.3688; val_edge_recon_loss: 26222.3503; val_gene_expr_recon_loss: 11914.9511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40780.6702; val_optim_loss: 40780.6702
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9564; val_best_f1_score: 0.9571; train_kl_reg_loss: 2651.9925; train_edge_recon_loss: 27371.0840; train_gene_expr_recon_loss: 12045.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42068.1267; train_optim_loss: 42068.1267; val_kl_reg_loss: 2632.6671; val_edge_recon_loss: 26213.6085; val_gene_expr_recon_loss: 11913.8753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40760.1510; val_optim_loss: 40760.1510
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9570; val_best_f1_score: 0.9575; train_kl_reg_loss: 2653.0703; train_edge_recon_loss: 27373.5768; train_gene_expr_recon_loss: 12041.1137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42067.7609; train_optim_loss: 42067.7609; val_kl_reg_loss: 2588.1584; val_edge_recon_loss: 26228.9985; val_gene_expr_recon_loss: 11918.3458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40735.5027; val_optim_loss: 40735.5027

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9917; val_auprc_score: 0.9902; val_best_acc_score: 0.9601; val_best_f1_score: 0.9607; train_kl_reg_loss: 2635.1173; train_edge_recon_loss: 27343.3831; train_gene_expr_recon_loss: 11933.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41912.4838; train_optim_loss: 41912.4838; val_kl_reg_loss: 2579.5475; val_edge_recon_loss: 26152.7446; val_gene_expr_recon_loss: 11814.9069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40547.1989; val_optim_loss: 40547.1989
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9916; val_auprc_score: 0.9901; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 2607.1017; train_edge_recon_loss: 27363.4764; train_gene_expr_recon_loss: 11885.3226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41855.9008; train_optim_loss: 41855.9008; val_kl_reg_loss: 2587.9922; val_edge_recon_loss: 26168.0286; val_gene_expr_recon_loss: 11803.5185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40559.5394; val_optim_loss: 40559.5394
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9907; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 2594.3545; train_edge_recon_loss: 27385.0460; train_gene_expr_recon_loss: 11873.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41852.7182; train_optim_loss: 41852.7182; val_kl_reg_loss: 2571.6795; val_edge_recon_loss: 26198.7398; val_gene_expr_recon_loss: 11809.5471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40579.9662; val_optim_loss: 40579.9662
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9919; val_auprc_score: 0.9905; val_best_acc_score: 0.9607; val_best_f1_score: 0.9612; train_kl_reg_loss: 2587.3875; train_edge_recon_loss: 27395.3109; train_gene_expr_recon_loss: 11863.1922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41845.8906; train_optim_loss: 41845.8906; val_kl_reg_loss: 2541.5352; val_edge_recon_loss: 26209.3359; val_gene_expr_recon_loss: 11801.2052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40552.0762; val_optim_loss: 40552.0762
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9923; val_auprc_score: 0.9912; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 2589.5627; train_edge_recon_loss: 27377.3614; train_gene_expr_recon_loss: 11857.5864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41824.5105; train_optim_loss: 41824.5105; val_kl_reg_loss: 2537.3282; val_edge_recon_loss: 26204.6702; val_gene_expr_recon_loss: 11805.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40547.4728; val_optim_loss: 40547.4728

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9924; val_auprc_score: 0.9914; val_best_acc_score: 0.9612; val_best_f1_score: 0.9617; train_kl_reg_loss: 2583.8423; train_edge_recon_loss: 27385.0841; train_gene_expr_recon_loss: 11846.2605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41815.1868; train_optim_loss: 41815.1868; val_kl_reg_loss: 2559.6417; val_edge_recon_loss: 26180.5965; val_gene_expr_recon_loss: 11805.1339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40545.3719; val_optim_loss: 40545.3719
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9921; val_auprc_score: 0.9910; val_best_acc_score: 0.9610; val_best_f1_score: 0.9616; train_kl_reg_loss: 2584.0908; train_edge_recon_loss: 27385.7143; train_gene_expr_recon_loss: 11845.6703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41815.4754; train_optim_loss: 41815.4754; val_kl_reg_loss: 2547.6409; val_edge_recon_loss: 26201.9819; val_gene_expr_recon_loss: 11799.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40549.4359; val_optim_loss: 40549.4359
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9919; val_auprc_score: 0.9906; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 2584.1275; train_edge_recon_loss: 27391.6601; train_gene_expr_recon_loss: 11841.6363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41817.4238; train_optim_loss: 41817.4238; val_kl_reg_loss: 2550.3895; val_edge_recon_loss: 26213.4365; val_gene_expr_recon_loss: 11806.8097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40570.6358; val_optim_loss: 40570.6358
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9922; val_auprc_score: 0.9908; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 2583.0361; train_edge_recon_loss: 27391.2038; train_gene_expr_recon_loss: 11840.8903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41815.1302; train_optim_loss: 41815.1302; val_kl_reg_loss: 2556.9135; val_edge_recon_loss: 26206.5582; val_gene_expr_recon_loss: 11796.1508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40559.6227; val_optim_loss: 40559.6227
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9910; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 2583.5847; train_edge_recon_loss: 27386.6239; train_gene_expr_recon_loss: 11843.0873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41813.2960; train_optim_loss: 41813.2960; val_kl_reg_loss: 2560.5761; val_edge_recon_loss: 26214.4854; val_gene_expr_recon_loss: 11809.9919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40585.0536; val_optim_loss: 40585.0536

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9922; val_auprc_score: 0.9911; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 2584.3633; train_edge_recon_loss: 27389.1679; train_gene_expr_recon_loss: 11840.0100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41813.5412; train_optim_loss: 41813.5412; val_kl_reg_loss: 2554.3454; val_edge_recon_loss: 26191.0580; val_gene_expr_recon_loss: 11808.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40553.7821; val_optim_loss: 40553.7821
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9914; val_best_acc_score: 0.9620; val_best_f1_score: 0.9625; train_kl_reg_loss: 2582.0257; train_edge_recon_loss: 27393.9263; train_gene_expr_recon_loss: 11836.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41812.4421; train_optim_loss: 41812.4421; val_kl_reg_loss: 2551.0091; val_edge_recon_loss: 26162.7371; val_gene_expr_recon_loss: 11792.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40506.1750; val_optim_loss: 40506.1750
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9911; val_best_acc_score: 0.9613; val_best_f1_score: 0.9618; train_kl_reg_loss: 2583.7699; train_edge_recon_loss: 27377.6629; train_gene_expr_recon_loss: 11840.1116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41801.5444; train_optim_loss: 41801.5444; val_kl_reg_loss: 2557.7261; val_edge_recon_loss: 26205.6070; val_gene_expr_recon_loss: 11795.8599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40559.1929; val_optim_loss: 40559.1929
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9922; val_auprc_score: 0.9910; val_best_acc_score: 0.9617; val_best_f1_score: 0.9622; train_kl_reg_loss: 2582.8123; train_edge_recon_loss: 27391.8514; train_gene_expr_recon_loss: 11843.6476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41818.3113; train_optim_loss: 41818.3113; val_kl_reg_loss: 2553.4784; val_edge_recon_loss: 26193.4310; val_gene_expr_recon_loss: 11809.3334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40556.2430; val_optim_loss: 40556.2430
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9925; val_auprc_score: 0.9914; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 2581.9311; train_edge_recon_loss: 27395.1895; train_gene_expr_recon_loss: 11836.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41813.2266; train_optim_loss: 41813.2266; val_kl_reg_loss: 2549.3514; val_edge_recon_loss: 26172.9557; val_gene_expr_recon_loss: 11790.9566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40513.2639; val_optim_loss: 40513.2639
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9923; val_auprc_score: 0.9910; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 2582.9204; train_edge_recon_loss: 27381.8584; train_gene_expr_recon_loss: 11839.8459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41804.6247; train_optim_loss: 41804.6247; val_kl_reg_loss: 2555.3933; val_edge_recon_loss: 26187.2924; val_gene_expr_recon_loss: 11808.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40550.9797; val_optim_loss: 40550.9797

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9921; val_auprc_score: 0.9909; val_best_acc_score: 0.9611; val_best_f1_score: 0.9616; train_kl_reg_loss: 2584.1570; train_edge_recon_loss: 27386.7179; train_gene_expr_recon_loss: 11838.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41809.4757; train_optim_loss: 41809.4757; val_kl_reg_loss: 2553.6908; val_edge_recon_loss: 26226.6825; val_gene_expr_recon_loss: 11796.3661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40576.7394; val_optim_loss: 40576.7394
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9914; val_best_acc_score: 0.9610; val_best_f1_score: 0.9615; train_kl_reg_loss: 2583.9375; train_edge_recon_loss: 27380.3537; train_gene_expr_recon_loss: 11840.1407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41804.4318; train_optim_loss: 41804.4318; val_kl_reg_loss: 2553.8795; val_edge_recon_loss: 26187.3731; val_gene_expr_recon_loss: 11789.4862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40530.7389; val_optim_loss: 40530.7389
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9925; val_auprc_score: 0.9914; val_best_acc_score: 0.9616; val_best_f1_score: 0.9622; train_kl_reg_loss: 2583.7464; train_edge_recon_loss: 27384.1110; train_gene_expr_recon_loss: 11837.7813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41805.6388; train_optim_loss: 41805.6388; val_kl_reg_loss: 2552.9973; val_edge_recon_loss: 26167.7219; val_gene_expr_recon_loss: 11803.7710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40524.4903; val_optim_loss: 40524.4903
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9922; val_auprc_score: 0.9911; val_best_acc_score: 0.9605; val_best_f1_score: 0.9610; train_kl_reg_loss: 2583.3502; train_edge_recon_loss: 27387.1893; train_gene_expr_recon_loss: 11839.6299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41810.1695; train_optim_loss: 41810.1695; val_kl_reg_loss: 2552.9398; val_edge_recon_loss: 26225.1310; val_gene_expr_recon_loss: 11788.7090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40566.7799; val_optim_loss: 40566.7799

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 156 min 19 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9922
Val AUPRC score: 0.9911
Val best accuracy score: 0.9609
Val best F1 score: 0.9614
Val gene expr MSE score: 2.6562

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
