None
Run timestamp: 30062023_110813_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9675; val_auprc_score: 0.9482; val_best_acc_score: 0.9278; val_best_f1_score: 0.9300; train_kl_reg_loss: 6045.1792; train_edge_recon_loss: 274064.8695; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280110.0495; train_optim_loss: 280110.0495; val_kl_reg_loss: 5891.2564; val_edge_recon_loss: 262438.2166; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268329.4730; val_optim_loss: 268329.4730
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9699; val_auprc_score: 0.9524; val_best_acc_score: 0.9351; val_best_f1_score: 0.9374; train_kl_reg_loss: 5906.1894; train_edge_recon_loss: 260810.9532; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266717.1429; train_optim_loss: 266717.1429; val_kl_reg_loss: 5778.0246; val_edge_recon_loss: 261665.6023; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267443.6264; val_optim_loss: 267443.6264
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9751; val_auprc_score: 0.9612; val_best_acc_score: 0.9442; val_best_f1_score: 0.9460; train_kl_reg_loss: 5838.4518; train_edge_recon_loss: 259357.4361; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265195.8889; train_optim_loss: 265195.8889; val_kl_reg_loss: 5658.4013; val_edge_recon_loss: 260155.2464; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265813.6463; val_optim_loss: 265813.6463
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9750; val_auprc_score: 0.9585; val_best_acc_score: 0.9486; val_best_f1_score: 0.9502; train_kl_reg_loss: 5783.3933; train_edge_recon_loss: 258737.6575; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264521.0498; train_optim_loss: 264521.0498; val_kl_reg_loss: 5588.2251; val_edge_recon_loss: 259590.8793; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265179.1065; val_optim_loss: 265179.1065
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9777; val_auprc_score: 0.9633; val_best_acc_score: 0.9516; val_best_f1_score: 0.9530; train_kl_reg_loss: 5767.6209; train_edge_recon_loss: 258284.5661; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264052.1870; train_optim_loss: 264052.1870; val_kl_reg_loss: 5676.9510; val_edge_recon_loss: 258304.1626; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263981.1122; val_optim_loss: 263981.1122
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9778; val_auprc_score: 0.9640; val_best_acc_score: 0.9517; val_best_f1_score: 0.9531; train_kl_reg_loss: 5756.2085; train_edge_recon_loss: 257893.4963; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263649.7050; train_optim_loss: 263649.7050; val_kl_reg_loss: 5626.2490; val_edge_recon_loss: 258694.8011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264321.0504; val_optim_loss: 264321.0504
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9781; val_auprc_score: 0.9640; val_best_acc_score: 0.9532; val_best_f1_score: 0.9547; train_kl_reg_loss: 5740.4264; train_edge_recon_loss: 257823.5598; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263563.9859; train_optim_loss: 263563.9859; val_kl_reg_loss: 5574.9755; val_edge_recon_loss: 258462.1662; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264037.1399; val_optim_loss: 264037.1399
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9784; val_auprc_score: 0.9644; val_best_acc_score: 0.9556; val_best_f1_score: 0.9569; train_kl_reg_loss: 5732.1298; train_edge_recon_loss: 257552.7346; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263284.8647; train_optim_loss: 263284.8647; val_kl_reg_loss: 5500.0138; val_edge_recon_loss: 258016.9325; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263516.9460; val_optim_loss: 263516.9460
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9814; val_auprc_score: 0.9685; val_best_acc_score: 0.9584; val_best_f1_score: 0.9597; train_kl_reg_loss: 5731.0943; train_edge_recon_loss: 257500.0822; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263231.1768; train_optim_loss: 263231.1768; val_kl_reg_loss: 5618.1493; val_edge_recon_loss: 257609.5433; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263227.6932; val_optim_loss: 263227.6932
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9822; val_auprc_score: 0.9718; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 5730.2234; train_edge_recon_loss: 257205.9217; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262936.1447; train_optim_loss: 262936.1447; val_kl_reg_loss: 5703.7733; val_edge_recon_loss: 257964.3366; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263668.1101; val_optim_loss: 263668.1101
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9814; val_auprc_score: 0.9690; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 5731.5879; train_edge_recon_loss: 257326.7739; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263058.3617; train_optim_loss: 263058.3617; val_kl_reg_loss: 5576.5747; val_edge_recon_loss: 258060.0604; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263636.6357; val_optim_loss: 263636.6357
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9829; val_auprc_score: 0.9715; val_best_acc_score: 0.9610; val_best_f1_score: 0.9620; train_kl_reg_loss: 5727.6507; train_edge_recon_loss: 257018.6495; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262746.3000; train_optim_loss: 262746.3000; val_kl_reg_loss: 5779.5911; val_edge_recon_loss: 257083.0462; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262862.6364; val_optim_loss: 262862.6364
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9828; val_auprc_score: 0.9729; val_best_acc_score: 0.9593; val_best_f1_score: 0.9604; train_kl_reg_loss: 5720.6611; train_edge_recon_loss: 257207.9977; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262928.6587; train_optim_loss: 262928.6587; val_kl_reg_loss: 5541.0176; val_edge_recon_loss: 257755.3423; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263296.3615; val_optim_loss: 263296.3615
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9716; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 5719.1596; train_edge_recon_loss: 256895.6861; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262614.8451; train_optim_loss: 262614.8451; val_kl_reg_loss: 5577.4444; val_edge_recon_loss: 257340.3878; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262917.8317; val_optim_loss: 262917.8317
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9834; val_auprc_score: 0.9737; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 5722.0059; train_edge_recon_loss: 256957.4434; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262679.4493; train_optim_loss: 262679.4493; val_kl_reg_loss: 5588.2850; val_edge_recon_loss: 256966.8913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262555.1768; val_optim_loss: 262555.1768
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9840; val_auprc_score: 0.9740; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 5717.8599; train_edge_recon_loss: 256901.8114; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262619.6711; train_optim_loss: 262619.6711; val_kl_reg_loss: 5674.4240; val_edge_recon_loss: 256712.6385; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262387.0618; val_optim_loss: 262387.0618
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9835; val_auprc_score: 0.9728; val_best_acc_score: 0.9637; val_best_f1_score: 0.9646; train_kl_reg_loss: 5718.8500; train_edge_recon_loss: 256693.4596; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262412.3089; train_optim_loss: 262412.3089; val_kl_reg_loss: 5696.8917; val_edge_recon_loss: 257219.3722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262916.2628; val_optim_loss: 262916.2628
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9850; val_auprc_score: 0.9754; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 5710.8938; train_edge_recon_loss: 256808.7161; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262519.6095; train_optim_loss: 262519.6095; val_kl_reg_loss: 5618.9169; val_edge_recon_loss: 256739.8239; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262358.7386; val_optim_loss: 262358.7386
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9864; val_auprc_score: 0.9789; val_best_acc_score: 0.9662; val_best_f1_score: 0.9670; train_kl_reg_loss: 5712.4979; train_edge_recon_loss: 256564.9480; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262277.4460; train_optim_loss: 262277.4460; val_kl_reg_loss: 5642.2419; val_edge_recon_loss: 256496.6243; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262138.8665; val_optim_loss: 262138.8665
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9850; val_auprc_score: 0.9750; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 5709.7908; train_edge_recon_loss: 256484.1787; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262193.9696; train_optim_loss: 262193.9696; val_kl_reg_loss: 5638.5807; val_edge_recon_loss: 256534.7457; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262173.3253; val_optim_loss: 262173.3253
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9861; val_auprc_score: 0.9775; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 5706.1116; train_edge_recon_loss: 256580.4256; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262286.5380; train_optim_loss: 262286.5380; val_kl_reg_loss: 5680.4391; val_edge_recon_loss: 256468.6214; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262149.0604; val_optim_loss: 262149.0604
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9864; val_auprc_score: 0.9779; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 5706.1104; train_edge_recon_loss: 256489.1538; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262195.2646; train_optim_loss: 262195.2646; val_kl_reg_loss: 5695.6954; val_edge_recon_loss: 256396.0185; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262091.7159; val_optim_loss: 262091.7159
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9872; val_auprc_score: 0.9794; val_best_acc_score: 0.9677; val_best_f1_score: 0.9684; train_kl_reg_loss: 5699.6418; train_edge_recon_loss: 256528.0031; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262227.6451; train_optim_loss: 262227.6451; val_kl_reg_loss: 5550.7525; val_edge_recon_loss: 256315.3977; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261866.1499; val_optim_loss: 261866.1499
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9867; val_auprc_score: 0.9790; val_best_acc_score: 0.9670; val_best_f1_score: 0.9678; train_kl_reg_loss: 5691.7289; train_edge_recon_loss: 256398.7097; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262090.4387; train_optim_loss: 262090.4387; val_kl_reg_loss: 5655.3268; val_edge_recon_loss: 256562.7763; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262218.1044; val_optim_loss: 262218.1044
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9875; val_auprc_score: 0.9806; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 5698.2898; train_edge_recon_loss: 256369.7284; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262068.0187; train_optim_loss: 262068.0187; val_kl_reg_loss: 5728.3714; val_edge_recon_loss: 256177.5575; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261905.9283; val_optim_loss: 261905.9283
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9870; val_auprc_score: 0.9791; val_best_acc_score: 0.9679; val_best_f1_score: 0.9685; train_kl_reg_loss: 5693.4371; train_edge_recon_loss: 256537.3609; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262230.7980; train_optim_loss: 262230.7980; val_kl_reg_loss: 5597.9514; val_edge_recon_loss: 256770.6861; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262368.6392; val_optim_loss: 262368.6392
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9884; val_auprc_score: 0.9827; val_best_acc_score: 0.9679; val_best_f1_score: 0.9685; train_kl_reg_loss: 5697.1870; train_edge_recon_loss: 256296.8534; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261994.0407; train_optim_loss: 261994.0407; val_kl_reg_loss: 5581.6902; val_edge_recon_loss: 256129.5533; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261711.2436; val_optim_loss: 261711.2436
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9870; val_auprc_score: 0.9794; val_best_acc_score: 0.9675; val_best_f1_score: 0.9682; train_kl_reg_loss: 5693.4636; train_edge_recon_loss: 256158.3489; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261851.8118; train_optim_loss: 261851.8118; val_kl_reg_loss: 5606.0977; val_edge_recon_loss: 256726.3594; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262332.4567; val_optim_loss: 262332.4567
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9869; val_auprc_score: 0.9786; val_best_acc_score: 0.9673; val_best_f1_score: 0.9680; train_kl_reg_loss: 5693.0942; train_edge_recon_loss: 256052.6256; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261745.7194; train_optim_loss: 261745.7194; val_kl_reg_loss: 5591.1984; val_edge_recon_loss: 256481.8778; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262073.0739; val_optim_loss: 262073.0739
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9875; val_auprc_score: 0.9796; val_best_acc_score: 0.9683; val_best_f1_score: 0.9690; train_kl_reg_loss: 5686.2462; train_edge_recon_loss: 256246.6173; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261932.8630; train_optim_loss: 261932.8630; val_kl_reg_loss: 5638.1137; val_edge_recon_loss: 256289.7997; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261927.9126; val_optim_loss: 261927.9126
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9871; val_auprc_score: 0.9791; val_best_acc_score: 0.9674; val_best_f1_score: 0.9680; train_kl_reg_loss: 5692.1965; train_edge_recon_loss: 256243.3802; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261935.5774; train_optim_loss: 261935.5774; val_kl_reg_loss: 5686.4736; val_edge_recon_loss: 256803.7223; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262490.1960; val_optim_loss: 262490.1960

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9880; val_auprc_score: 0.9814; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 5677.2903; train_edge_recon_loss: 256064.0287; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261741.3187; train_optim_loss: 261741.3187; val_kl_reg_loss: 5623.6318; val_edge_recon_loss: 256112.3636; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261735.9964; val_optim_loss: 261735.9964
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9888; val_auprc_score: 0.9821; val_best_acc_score: 0.9698; val_best_f1_score: 0.9704; train_kl_reg_loss: 5664.9863; train_edge_recon_loss: 256092.4709; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261757.4569; train_optim_loss: 261757.4569; val_kl_reg_loss: 5583.9502; val_edge_recon_loss: 256253.3146; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261837.2642; val_optim_loss: 261837.2642
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9895; val_auprc_score: 0.9832; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 5666.8681; train_edge_recon_loss: 255941.4760; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261608.3445; train_optim_loss: 261608.3445; val_kl_reg_loss: 5566.5656; val_edge_recon_loss: 255358.3771; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260924.9439; val_optim_loss: 260924.9439
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9874; val_auprc_score: 0.9796; val_best_acc_score: 0.9687; val_best_f1_score: 0.9694; train_kl_reg_loss: 5660.6697; train_edge_recon_loss: 256042.2747; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261702.9446; train_optim_loss: 261702.9446; val_kl_reg_loss: 5607.2070; val_edge_recon_loss: 256355.6499; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261962.8558; val_optim_loss: 261962.8558
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9883; val_auprc_score: 0.9808; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 5664.4651; train_edge_recon_loss: 255901.4810; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261565.9462; train_optim_loss: 261565.9462; val_kl_reg_loss: 5591.0560; val_edge_recon_loss: 255999.0064; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261590.0632; val_optim_loss: 261590.0632
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9888; val_auprc_score: 0.9821; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 5664.9669; train_edge_recon_loss: 255924.1129; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261589.0794; train_optim_loss: 261589.0794; val_kl_reg_loss: 5580.1392; val_edge_recon_loss: 255698.2422; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261278.3849; val_optim_loss: 261278.3849
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9878; val_auprc_score: 0.9802; val_best_acc_score: 0.9686; val_best_f1_score: 0.9693; train_kl_reg_loss: 5655.5320; train_edge_recon_loss: 255921.6795; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261577.2121; train_optim_loss: 261577.2121; val_kl_reg_loss: 5581.9412; val_edge_recon_loss: 255963.7741; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261545.7180; val_optim_loss: 261545.7180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9881; val_auprc_score: 0.9813; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 5655.2758; train_edge_recon_loss: 256018.6869; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261673.9630; train_optim_loss: 261673.9630; val_kl_reg_loss: 5572.8480; val_edge_recon_loss: 255763.0142; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261335.8629; val_optim_loss: 261335.8629
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9885; val_auprc_score: 0.9816; val_best_acc_score: 0.9686; val_best_f1_score: 0.9693; train_kl_reg_loss: 5657.2711; train_edge_recon_loss: 256071.4156; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261728.6873; train_optim_loss: 261728.6873; val_kl_reg_loss: 5568.7949; val_edge_recon_loss: 256563.1165; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262131.9098; val_optim_loss: 262131.9098
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9879; val_auprc_score: 0.9793; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 5654.5987; train_edge_recon_loss: 255978.8914; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261633.4899; train_optim_loss: 261633.4899; val_kl_reg_loss: 5576.3936; val_edge_recon_loss: 256317.2741; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261893.6690; val_optim_loss: 261893.6690
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9887; val_auprc_score: 0.9821; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 5660.1377; train_edge_recon_loss: 255900.7058; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261560.8434; train_optim_loss: 261560.8434; val_kl_reg_loss: 5569.2268; val_edge_recon_loss: 255974.5689; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261543.7933; val_optim_loss: 261543.7933

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 55 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9887
Val AUPRC score: 0.9816
Val best accuracy score: 0.9700
Val best F1 score: 0.9706
Val gene expr MSE score: 1.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
