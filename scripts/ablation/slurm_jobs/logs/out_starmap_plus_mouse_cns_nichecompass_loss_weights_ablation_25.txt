None
Run timestamp: 02072023_124742_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9661; val_auprc_score: 0.9453; val_best_acc_score: 0.9259; val_best_f1_score: 0.9283; train_kl_reg_loss: 5916.2131; train_edge_recon_loss: 273509.1967; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279425.4103; train_optim_loss: 279425.4103; val_kl_reg_loss: 5816.1209; val_edge_recon_loss: 263177.7230; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268993.8480; val_optim_loss: 268993.8480
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9713; val_auprc_score: 0.9571; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 5727.2866; train_edge_recon_loss: 260495.4910; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266222.7764; train_optim_loss: 266222.7764; val_kl_reg_loss: 5512.0015; val_edge_recon_loss: 260872.5142; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266384.5128; val_optim_loss: 266384.5128
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9735; val_auprc_score: 0.9574; val_best_acc_score: 0.9418; val_best_f1_score: 0.9439; train_kl_reg_loss: 5645.2238; train_edge_recon_loss: 259199.9425; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264845.1664; train_optim_loss: 264845.1664; val_kl_reg_loss: 5416.0238; val_edge_recon_loss: 260092.5490; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265508.5739; val_optim_loss: 265508.5739
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9750; val_auprc_score: 0.9607; val_best_acc_score: 0.9459; val_best_f1_score: 0.9477; train_kl_reg_loss: 5600.6042; train_edge_recon_loss: 258805.1692; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264405.7725; train_optim_loss: 264405.7725; val_kl_reg_loss: 5383.4425; val_edge_recon_loss: 259394.1818; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264777.6243; val_optim_loss: 264777.6243
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9800; val_auprc_score: 0.9690; val_best_acc_score: 0.9536; val_best_f1_score: 0.9546; train_kl_reg_loss: 5588.0679; train_edge_recon_loss: 258258.6048; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263846.6724; train_optim_loss: 263846.6724; val_kl_reg_loss: 5333.5326; val_edge_recon_loss: 257976.2607; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263309.7940; val_optim_loss: 263309.7940
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9789; val_auprc_score: 0.9662; val_best_acc_score: 0.9533; val_best_f1_score: 0.9547; train_kl_reg_loss: 5575.6053; train_edge_recon_loss: 257797.4729; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263373.0780; train_optim_loss: 263373.0780; val_kl_reg_loss: 5409.9046; val_edge_recon_loss: 258078.2024; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263488.1065; val_optim_loss: 263488.1065
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9801; val_auprc_score: 0.9684; val_best_acc_score: 0.9540; val_best_f1_score: 0.9552; train_kl_reg_loss: 5572.0188; train_edge_recon_loss: 257627.3495; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263199.3687; train_optim_loss: 263199.3687; val_kl_reg_loss: 5393.8858; val_edge_recon_loss: 257698.6790; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263092.5632; val_optim_loss: 263092.5632
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9793; val_auprc_score: 0.9666; val_best_acc_score: 0.9540; val_best_f1_score: 0.9554; train_kl_reg_loss: 5557.4993; train_edge_recon_loss: 257533.7758; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263091.2765; train_optim_loss: 263091.2765; val_kl_reg_loss: 5432.1118; val_edge_recon_loss: 258252.6179; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263684.7330; val_optim_loss: 263684.7330
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9791; val_auprc_score: 0.9646; val_best_acc_score: 0.9547; val_best_f1_score: 0.9560; train_kl_reg_loss: 5554.7917; train_edge_recon_loss: 257352.1342; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262906.9269; train_optim_loss: 262906.9269; val_kl_reg_loss: 5463.7971; val_edge_recon_loss: 258218.2685; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263682.0639; val_optim_loss: 263682.0639
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9794; val_auprc_score: 0.9652; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 5543.9074; train_edge_recon_loss: 257386.1586; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262930.0667; train_optim_loss: 262930.0667; val_kl_reg_loss: 5402.7659; val_edge_recon_loss: 257561.2315; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262963.9972; val_optim_loss: 262963.9972
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9804; val_auprc_score: 0.9677; val_best_acc_score: 0.9571; val_best_f1_score: 0.9584; train_kl_reg_loss: 5553.1622; train_edge_recon_loss: 257024.8776; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262578.0400; train_optim_loss: 262578.0400; val_kl_reg_loss: 5513.3207; val_edge_recon_loss: 258012.6378; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263525.9574; val_optim_loss: 263525.9574
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9818; val_auprc_score: 0.9694; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 5553.0173; train_edge_recon_loss: 257017.2379; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262570.2549; train_optim_loss: 262570.2549; val_kl_reg_loss: 5546.9304; val_edge_recon_loss: 257322.4126; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262869.3445; val_optim_loss: 262869.3445
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9806; val_auprc_score: 0.9668; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 5561.2257; train_edge_recon_loss: 256951.1284; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262512.3543; train_optim_loss: 262512.3543; val_kl_reg_loss: 5414.2745; val_edge_recon_loss: 257081.1300; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262495.4048; val_optim_loss: 262495.4048
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9821; val_auprc_score: 0.9701; val_best_acc_score: 0.9619; val_best_f1_score: 0.9629; train_kl_reg_loss: 5544.3662; train_edge_recon_loss: 256878.3808; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262422.7472; train_optim_loss: 262422.7472; val_kl_reg_loss: 5395.4849; val_edge_recon_loss: 257286.0462; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262681.5298; val_optim_loss: 262681.5298
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9826; val_auprc_score: 0.9705; val_best_acc_score: 0.9617; val_best_f1_score: 0.9627; train_kl_reg_loss: 5543.2481; train_edge_recon_loss: 256782.0365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262325.2851; train_optim_loss: 262325.2851; val_kl_reg_loss: 5486.8959; val_edge_recon_loss: 256829.9815; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262316.8778; val_optim_loss: 262316.8778
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9838; val_auprc_score: 0.9732; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 5533.6421; train_edge_recon_loss: 256776.6515; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262310.2945; train_optim_loss: 262310.2945; val_kl_reg_loss: 5520.5988; val_edge_recon_loss: 257181.9205; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262702.5185; val_optim_loss: 262702.5185
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9837; val_auprc_score: 0.9741; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 5541.6468; train_edge_recon_loss: 256606.5329; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262148.1794; train_optim_loss: 262148.1794; val_kl_reg_loss: 5253.4590; val_edge_recon_loss: 256832.6570; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262086.1172; val_optim_loss: 262086.1172
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9841; val_auprc_score: 0.9737; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 5537.4404; train_edge_recon_loss: 256592.7603; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262130.2015; train_optim_loss: 262130.2015; val_kl_reg_loss: 5322.2162; val_edge_recon_loss: 256522.0689; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261844.2862; val_optim_loss: 261844.2862
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9826; val_auprc_score: 0.9712; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 5533.2926; train_edge_recon_loss: 256503.9955; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262037.2875; train_optim_loss: 262037.2875; val_kl_reg_loss: 5387.1281; val_edge_recon_loss: 257191.8828; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262579.0085; val_optim_loss: 262579.0085
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9844; val_auprc_score: 0.9742; val_best_acc_score: 0.9649; val_best_f1_score: 0.9658; train_kl_reg_loss: 5530.6243; train_edge_recon_loss: 256352.4208; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261883.0459; train_optim_loss: 261883.0459; val_kl_reg_loss: 5431.0589; val_edge_recon_loss: 256272.3828; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261703.4403; val_optim_loss: 261703.4403
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9840; val_auprc_score: 0.9730; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 5534.3232; train_edge_recon_loss: 256419.8687; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261954.1913; train_optim_loss: 261954.1913; val_kl_reg_loss: 5335.6626; val_edge_recon_loss: 256764.6996; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262100.3594; val_optim_loss: 262100.3594
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9842; val_auprc_score: 0.9745; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 5520.4024; train_edge_recon_loss: 256490.3482; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262010.7511; train_optim_loss: 262010.7511; val_kl_reg_loss: 5505.7097; val_edge_recon_loss: 256865.2827; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262370.9922; val_optim_loss: 262370.9922
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9848; val_auprc_score: 0.9751; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 5526.3556; train_edge_recon_loss: 256316.7228; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261843.0785; train_optim_loss: 261843.0785; val_kl_reg_loss: 5358.7929; val_edge_recon_loss: 256601.2720; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261960.0639; val_optim_loss: 261960.0639
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9855; val_auprc_score: 0.9764; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 5516.6823; train_edge_recon_loss: 256380.7237; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261897.4058; train_optim_loss: 261897.4058; val_kl_reg_loss: 5501.9612; val_edge_recon_loss: 256491.5412; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261993.5028; val_optim_loss: 261993.5028

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9858; val_auprc_score: 0.9774; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 5510.0882; train_edge_recon_loss: 256210.0312; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261720.1195; train_optim_loss: 261720.1195; val_kl_reg_loss: 5444.7345; val_edge_recon_loss: 256758.9851; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262203.7209; val_optim_loss: 262203.7209
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9855; val_auprc_score: 0.9754; val_best_acc_score: 0.9674; val_best_f1_score: 0.9682; train_kl_reg_loss: 5502.3896; train_edge_recon_loss: 256217.2464; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261719.6362; train_optim_loss: 261719.6362; val_kl_reg_loss: 5379.2224; val_edge_recon_loss: 255707.2855; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261086.5043; val_optim_loss: 261086.5043
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9858; val_auprc_score: 0.9764; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 5495.7890; train_edge_recon_loss: 256282.2534; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261778.0427; train_optim_loss: 261778.0427; val_kl_reg_loss: 5412.7863; val_edge_recon_loss: 256186.4190; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261599.2053; val_optim_loss: 261599.2053
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9857; val_auprc_score: 0.9761; val_best_acc_score: 0.9653; val_best_f1_score: 0.9661; train_kl_reg_loss: 5497.4114; train_edge_recon_loss: 256188.6222; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261686.0342; train_optim_loss: 261686.0342; val_kl_reg_loss: 5421.5489; val_edge_recon_loss: 256522.6257; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261944.1733; val_optim_loss: 261944.1733
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9859; val_auprc_score: 0.9767; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 5491.7690; train_edge_recon_loss: 256324.0270; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261815.7964; train_optim_loss: 261815.7964; val_kl_reg_loss: 5399.8650; val_edge_recon_loss: 256335.3466; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261735.2124; val_optim_loss: 261735.2124
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9871; val_auprc_score: 0.9790; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 5496.8929; train_edge_recon_loss: 256015.9648; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261512.8575; train_optim_loss: 261512.8575; val_kl_reg_loss: 5422.3954; val_edge_recon_loss: 256188.6712; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261611.0653; val_optim_loss: 261611.0653

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9863; val_auprc_score: 0.9780; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 5488.4414; train_edge_recon_loss: 256235.7509; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261724.1921; train_optim_loss: 261724.1921; val_kl_reg_loss: 5410.7072; val_edge_recon_loss: 256403.2777; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261813.9851; val_optim_loss: 261813.9851
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9871; val_auprc_score: 0.9786; val_best_acc_score: 0.9674; val_best_f1_score: 0.9680; train_kl_reg_loss: 5491.1325; train_edge_recon_loss: 256131.6611; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261622.7939; train_optim_loss: 261622.7939; val_kl_reg_loss: 5399.4669; val_edge_recon_loss: 256187.8359; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261587.3026; val_optim_loss: 261587.3026
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9859; val_auprc_score: 0.9775; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 5492.0737; train_edge_recon_loss: 256110.1646; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261602.2383; train_optim_loss: 261602.2383; val_kl_reg_loss: 5399.7629; val_edge_recon_loss: 256496.9268; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261896.6918; val_optim_loss: 261896.6918
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9853; val_auprc_score: 0.9763; val_best_acc_score: 0.9647; val_best_f1_score: 0.9656; train_kl_reg_loss: 5485.7608; train_edge_recon_loss: 256202.9018; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261688.6625; train_optim_loss: 261688.6625; val_kl_reg_loss: 5410.4915; val_edge_recon_loss: 256718.8402; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262129.3303; val_optim_loss: 262129.3303

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 28 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9857
Val AUPRC score: 0.9758
Val best accuracy score: 0.9664
Val best F1 score: 0.9672
Val gene expr MSE score: 1.0064

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
