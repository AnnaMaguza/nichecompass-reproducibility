None
Run timestamp: 05082023_041715_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 2, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 7481.0404; train_edge_recon_loss: 265226.5995; train_gene_expr_recon_loss: 203617.7341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 476325.3739; train_optim_loss: 476325.3739; val_kl_reg_loss: 6759.8909; val_edge_recon_loss: 259625.6544; val_gene_expr_recon_loss: 188957.7916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455343.3377; val_optim_loss: 455343.3377
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 6951.9010; train_edge_recon_loss: 259121.8532; train_gene_expr_recon_loss: 182691.7788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448765.5335; train_optim_loss: 448765.5335; val_kl_reg_loss: 6642.6300; val_edge_recon_loss: 257977.4904; val_gene_expr_recon_loss: 179701.9825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444322.1042; val_optim_loss: 444322.1042
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9949; val_auprc_score: 0.9939; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 6701.0831; train_edge_recon_loss: 258378.5583; train_gene_expr_recon_loss: 177152.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442232.5924; train_optim_loss: 442232.5924; val_kl_reg_loss: 6560.9896; val_edge_recon_loss: 257652.3050; val_gene_expr_recon_loss: 176598.6469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440811.9409; val_optim_loss: 440811.9409
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 6582.9966; train_edge_recon_loss: 257669.9114; train_gene_expr_recon_loss: 174815.3264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439068.2344; train_optim_loss: 439068.2344; val_kl_reg_loss: 6547.9199; val_edge_recon_loss: 256894.2167; val_gene_expr_recon_loss: 174218.9190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437661.0549; val_optim_loss: 437661.0549
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 6515.1389; train_edge_recon_loss: 257269.0009; train_gene_expr_recon_loss: 173615.9623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437400.1026; train_optim_loss: 437400.1026; val_kl_reg_loss: 6388.6744; val_edge_recon_loss: 257041.5882; val_gene_expr_recon_loss: 173520.6100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436950.8735; val_optim_loss: 436950.8735
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6475.5011; train_edge_recon_loss: 257121.2537; train_gene_expr_recon_loss: 172981.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436577.8774; train_optim_loss: 436577.8774; val_kl_reg_loss: 6345.9527; val_edge_recon_loss: 256581.6212; val_gene_expr_recon_loss: 173612.6798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436540.2534; val_optim_loss: 436540.2534
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6447.1473; train_edge_recon_loss: 256777.6672; train_gene_expr_recon_loss: 172304.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435529.6881; train_optim_loss: 435529.6881; val_kl_reg_loss: 6442.4956; val_edge_recon_loss: 256299.0947; val_gene_expr_recon_loss: 172730.0715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435471.6623; val_optim_loss: 435471.6623
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6437.6876; train_edge_recon_loss: 256594.3154; train_gene_expr_recon_loss: 171902.0639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434934.0671; train_optim_loss: 434934.0671; val_kl_reg_loss: 6330.2062; val_edge_recon_loss: 255878.9912; val_gene_expr_recon_loss: 172689.6679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434898.8645; val_optim_loss: 434898.8645
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6426.6756; train_edge_recon_loss: 256349.7498; train_gene_expr_recon_loss: 171704.1873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434480.6123; train_optim_loss: 434480.6123; val_kl_reg_loss: 6477.3051; val_edge_recon_loss: 256201.6923; val_gene_expr_recon_loss: 172482.0402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435161.0366; val_optim_loss: 435161.0366
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 6423.8220; train_edge_recon_loss: 256259.5020; train_gene_expr_recon_loss: 171549.3286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434232.6526; train_optim_loss: 434232.6526; val_kl_reg_loss: 6358.0713; val_edge_recon_loss: 255764.5724; val_gene_expr_recon_loss: 172500.3332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434622.9756; val_optim_loss: 434622.9756
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 6418.2655; train_edge_recon_loss: 256153.4103; train_gene_expr_recon_loss: 171325.3970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433897.0728; train_optim_loss: 433897.0728; val_kl_reg_loss: 6451.5069; val_edge_recon_loss: 255592.2707; val_gene_expr_recon_loss: 172234.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434278.0589; val_optim_loss: 434278.0589
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 6415.1102; train_edge_recon_loss: 256098.5483; train_gene_expr_recon_loss: 171139.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433653.5594; train_optim_loss: 433653.5594; val_kl_reg_loss: 6471.4908; val_edge_recon_loss: 255701.3846; val_gene_expr_recon_loss: 172584.7428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434757.6193; val_optim_loss: 434757.6193
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6413.7790; train_edge_recon_loss: 255986.6101; train_gene_expr_recon_loss: 170989.0959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433389.4847; train_optim_loss: 433389.4847; val_kl_reg_loss: 6329.7507; val_edge_recon_loss: 255608.4975; val_gene_expr_recon_loss: 171989.5392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433927.7872; val_optim_loss: 433927.7872
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6413.8647; train_edge_recon_loss: 255846.4448; train_gene_expr_recon_loss: 170938.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433198.3735; train_optim_loss: 433198.3735; val_kl_reg_loss: 6296.4953; val_edge_recon_loss: 255451.4942; val_gene_expr_recon_loss: 172129.2637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433877.2532; val_optim_loss: 433877.2532
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6408.2132; train_edge_recon_loss: 255959.0004; train_gene_expr_recon_loss: 170720.6072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433087.8211; train_optim_loss: 433087.8211; val_kl_reg_loss: 6407.6869; val_edge_recon_loss: 255655.1804; val_gene_expr_recon_loss: 172001.2515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434064.1178; val_optim_loss: 434064.1178
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6412.3943; train_edge_recon_loss: 255767.4460; train_gene_expr_recon_loss: 170671.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432851.6044; train_optim_loss: 432851.6044; val_kl_reg_loss: 6409.7900; val_edge_recon_loss: 255448.4293; val_gene_expr_recon_loss: 171700.5238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433558.7407; val_optim_loss: 433558.7407
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6408.0159; train_edge_recon_loss: 255808.0194; train_gene_expr_recon_loss: 170573.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432789.8598; train_optim_loss: 432789.8598; val_kl_reg_loss: 6495.1737; val_edge_recon_loss: 255468.0378; val_gene_expr_recon_loss: 171527.4551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433490.6665; val_optim_loss: 433490.6665
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6408.5112; train_edge_recon_loss: 255727.8809; train_gene_expr_recon_loss: 170387.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432523.7904; train_optim_loss: 432523.7904; val_kl_reg_loss: 6438.7977; val_edge_recon_loss: 255328.0885; val_gene_expr_recon_loss: 171828.5843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433595.4710; val_optim_loss: 433595.4710
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6410.6009; train_edge_recon_loss: 255665.7451; train_gene_expr_recon_loss: 170340.1203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432416.4659; train_optim_loss: 432416.4659; val_kl_reg_loss: 6390.6798; val_edge_recon_loss: 255145.5261; val_gene_expr_recon_loss: 171139.2631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432675.4707; val_optim_loss: 432675.4707
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6411.0278; train_edge_recon_loss: 255622.1857; train_gene_expr_recon_loss: 170176.7906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432210.0046; train_optim_loss: 432210.0046; val_kl_reg_loss: 6400.4855; val_edge_recon_loss: 255478.4994; val_gene_expr_recon_loss: 171722.0254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433601.0103; val_optim_loss: 433601.0103
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6412.6598; train_edge_recon_loss: 255625.8858; train_gene_expr_recon_loss: 170248.8309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432287.3768; train_optim_loss: 432287.3768; val_kl_reg_loss: 6414.0314; val_edge_recon_loss: 255161.9859; val_gene_expr_recon_loss: 171558.4742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433134.4905; val_optim_loss: 433134.4905
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6408.8888; train_edge_recon_loss: 255588.9462; train_gene_expr_recon_loss: 170047.8447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432045.6798; train_optim_loss: 432045.6798; val_kl_reg_loss: 6310.5529; val_edge_recon_loss: 255451.6572; val_gene_expr_recon_loss: 171847.2414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433609.4512; val_optim_loss: 433609.4512
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6409.6727; train_edge_recon_loss: 255577.6786; train_gene_expr_recon_loss: 169949.6929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431937.0442; train_optim_loss: 431937.0442; val_kl_reg_loss: 6458.9789; val_edge_recon_loss: 255042.0103; val_gene_expr_recon_loss: 171233.7450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432734.7332; val_optim_loss: 432734.7332

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6417.9688; train_edge_recon_loss: 255297.7200; train_gene_expr_recon_loss: 169278.5890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430994.2780; train_optim_loss: 430994.2780; val_kl_reg_loss: 6402.7062; val_edge_recon_loss: 255050.4174; val_gene_expr_recon_loss: 171333.8243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432786.9480; val_optim_loss: 432786.9480
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 6413.5972; train_edge_recon_loss: 255383.2089; train_gene_expr_recon_loss: 169100.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430897.5300; train_optim_loss: 430897.5300; val_kl_reg_loss: 6362.4527; val_edge_recon_loss: 255101.1186; val_gene_expr_recon_loss: 170781.1710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432244.7431; val_optim_loss: 432244.7431
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6410.3585; train_edge_recon_loss: 255270.7343; train_gene_expr_recon_loss: 168891.3088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430572.4016; train_optim_loss: 430572.4016; val_kl_reg_loss: 6368.9358; val_edge_recon_loss: 254971.5574; val_gene_expr_recon_loss: 170700.7023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432041.1968; val_optim_loss: 432041.1968
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6408.5965; train_edge_recon_loss: 255183.9009; train_gene_expr_recon_loss: 168796.7929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430389.2906; train_optim_loss: 430389.2906; val_kl_reg_loss: 6361.7307; val_edge_recon_loss: 254900.7077; val_gene_expr_recon_loss: 170630.2783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431892.7161; val_optim_loss: 431892.7161
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6410.2977; train_edge_recon_loss: 255189.2862; train_gene_expr_recon_loss: 168935.6560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430535.2396; train_optim_loss: 430535.2396; val_kl_reg_loss: 6378.3644; val_edge_recon_loss: 254800.1561; val_gene_expr_recon_loss: 170676.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431855.0819; val_optim_loss: 431855.0819
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9984; val_auprc_score: 0.9983; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6402.9779; train_edge_recon_loss: 255243.6358; train_gene_expr_recon_loss: 168746.5810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430393.1945; train_optim_loss: 430393.1945; val_kl_reg_loss: 6363.7924; val_edge_recon_loss: 255143.1913; val_gene_expr_recon_loss: 170883.1502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432390.1359; val_optim_loss: 432390.1359
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9868; val_best_f1_score: 0.9870; train_kl_reg_loss: 6400.7506; train_edge_recon_loss: 255258.0154; train_gene_expr_recon_loss: 168810.5689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430469.3348; train_optim_loss: 430469.3348; val_kl_reg_loss: 6358.7924; val_edge_recon_loss: 254929.7821; val_gene_expr_recon_loss: 170714.0183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432002.5917; val_optim_loss: 432002.5917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6402.5602; train_edge_recon_loss: 255230.6291; train_gene_expr_recon_loss: 168717.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430350.8279; train_optim_loss: 430350.8279; val_kl_reg_loss: 6368.8263; val_edge_recon_loss: 254891.5000; val_gene_expr_recon_loss: 170522.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431782.5467; val_optim_loss: 431782.5467
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6398.5708; train_edge_recon_loss: 255168.6398; train_gene_expr_recon_loss: 168665.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430232.6153; train_optim_loss: 430232.6153; val_kl_reg_loss: 6360.9008; val_edge_recon_loss: 254875.4869; val_gene_expr_recon_loss: 170823.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432059.4562; val_optim_loss: 432059.4562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 6399.4001; train_edge_recon_loss: 255144.8820; train_gene_expr_recon_loss: 168660.4276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430204.7098; train_optim_loss: 430204.7098; val_kl_reg_loss: 6366.5621; val_edge_recon_loss: 254756.7658; val_gene_expr_recon_loss: 170736.6770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431860.0061; val_optim_loss: 431860.0061
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6397.3047; train_edge_recon_loss: 255196.4248; train_gene_expr_recon_loss: 168563.9078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430157.6373; train_optim_loss: 430157.6373; val_kl_reg_loss: 6336.4333; val_edge_recon_loss: 254950.0215; val_gene_expr_recon_loss: 170297.0797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431583.5339; val_optim_loss: 431583.5339
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6395.3085; train_edge_recon_loss: 255127.0207; train_gene_expr_recon_loss: 168704.4248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430226.7544; train_optim_loss: 430226.7544; val_kl_reg_loss: 6362.3282; val_edge_recon_loss: 254831.6731; val_gene_expr_recon_loss: 170965.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432159.4771; val_optim_loss: 432159.4771
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6397.9575; train_edge_recon_loss: 255133.2915; train_gene_expr_recon_loss: 168702.0237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430233.2724; train_optim_loss: 430233.2724; val_kl_reg_loss: 6354.8747; val_edge_recon_loss: 254985.4648; val_gene_expr_recon_loss: 170646.1885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431986.5274; val_optim_loss: 431986.5274
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6397.3778; train_edge_recon_loss: 255091.2007; train_gene_expr_recon_loss: 168597.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430086.0048; train_optim_loss: 430086.0048; val_kl_reg_loss: 6424.4258; val_edge_recon_loss: 254771.4602; val_gene_expr_recon_loss: 170833.3632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432029.2494; val_optim_loss: 432029.2494
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6394.5647; train_edge_recon_loss: 255148.8748; train_gene_expr_recon_loss: 168576.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430120.3952; train_optim_loss: 430120.3952; val_kl_reg_loss: 6362.9445; val_edge_recon_loss: 254890.6978; val_gene_expr_recon_loss: 170651.4284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431905.0705; val_optim_loss: 431905.0705

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6394.7411; train_edge_recon_loss: 255114.8244; train_gene_expr_recon_loss: 168426.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429936.1717; train_optim_loss: 429936.1717; val_kl_reg_loss: 6366.4624; val_edge_recon_loss: 254894.2460; val_gene_expr_recon_loss: 170674.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431935.6576; val_optim_loss: 431935.6576
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 6396.9049; train_edge_recon_loss: 255083.1049; train_gene_expr_recon_loss: 168406.8612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429886.8710; train_optim_loss: 429886.8710; val_kl_reg_loss: 6369.7127; val_edge_recon_loss: 254813.5640; val_gene_expr_recon_loss: 170435.0546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431618.3325; val_optim_loss: 431618.3325
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 6391.6222; train_edge_recon_loss: 255141.3238; train_gene_expr_recon_loss: 168368.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429901.4389; train_optim_loss: 429901.4389; val_kl_reg_loss: 6368.9694; val_edge_recon_loss: 254935.4061; val_gene_expr_recon_loss: 170845.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432150.3580; val_optim_loss: 432150.3580
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6393.6638; train_edge_recon_loss: 255084.3299; train_gene_expr_recon_loss: 168405.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429883.0779; train_optim_loss: 429883.0779; val_kl_reg_loss: 6355.5196; val_edge_recon_loss: 254546.9976; val_gene_expr_recon_loss: 170729.6544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431632.1721; val_optim_loss: 431632.1721

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 167 min 6 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9984
val AUPRC score: 0.9979
val best accuracy score: 0.9871
val best F1 score: 0.9872
val target rna MSE score: 0.4764
val source rna MSE score: 0.0728

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
