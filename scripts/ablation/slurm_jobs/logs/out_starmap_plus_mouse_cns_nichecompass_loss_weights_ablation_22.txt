None
Run timestamp: 02072023_121645_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9836; val_auprc_score: 0.9794; val_best_acc_score: 0.9455; val_best_f1_score: 0.9464; train_kl_reg_loss: 5614.4449; train_edge_recon_loss: 31506.4278; train_gene_expr_recon_loss: 116084.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 153205.3764; train_optim_loss: 153205.3764; val_kl_reg_loss: 4787.5413; val_edge_recon_loss: 30263.5064; val_gene_expr_recon_loss: 105397.1862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140448.2340; val_optim_loss: 140448.2340
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9872; val_auprc_score: 0.9836; val_best_acc_score: 0.9548; val_best_f1_score: 0.9558; train_kl_reg_loss: 4532.2442; train_edge_recon_loss: 29994.8174; train_gene_expr_recon_loss: 103446.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137974.0113; train_optim_loss: 137974.0113; val_kl_reg_loss: 4200.5468; val_edge_recon_loss: 29470.0901; val_gene_expr_recon_loss: 101125.6986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134796.3352; val_optim_loss: 134796.3352
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9881; val_best_acc_score: 0.9599; val_best_f1_score: 0.9607; train_kl_reg_loss: 4113.2833; train_edge_recon_loss: 29389.4676; train_gene_expr_recon_loss: 100396.9780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133899.7283; train_optim_loss: 133899.7283; val_kl_reg_loss: 3900.9565; val_edge_recon_loss: 28958.3131; val_gene_expr_recon_loss: 98855.4596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131714.7288; val_optim_loss: 131714.7288
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 3903.4680; train_edge_recon_loss: 29040.1307; train_gene_expr_recon_loss: 98272.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131216.1074; train_optim_loss: 131216.1074; val_kl_reg_loss: 3752.2662; val_edge_recon_loss: 28557.6328; val_gene_expr_recon_loss: 97672.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129982.4228; val_optim_loss: 129982.4228
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9916; val_auprc_score: 0.9899; val_best_acc_score: 0.9637; val_best_f1_score: 0.9642; train_kl_reg_loss: 3791.7936; train_edge_recon_loss: 28789.9763; train_gene_expr_recon_loss: 96785.7504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129367.5201; train_optim_loss: 129367.5201; val_kl_reg_loss: 3644.9400; val_edge_recon_loss: 28310.5660; val_gene_expr_recon_loss: 96407.0017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128362.5080; val_optim_loss: 128362.5080
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 3721.6986; train_edge_recon_loss: 28600.6627; train_gene_expr_recon_loss: 95570.0433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127892.4044; train_optim_loss: 127892.4044; val_kl_reg_loss: 3614.9983; val_edge_recon_loss: 28180.5613; val_gene_expr_recon_loss: 95428.6856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127224.2447; val_optim_loss: 127224.2447
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 3682.5691; train_edge_recon_loss: 28444.9805; train_gene_expr_recon_loss: 94616.9780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126744.5277; train_optim_loss: 126744.5277; val_kl_reg_loss: 3535.6102; val_edge_recon_loss: 28020.3742; val_gene_expr_recon_loss: 94867.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126423.3906; val_optim_loss: 126423.3906
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9931; val_auprc_score: 0.9918; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 3658.6827; train_edge_recon_loss: 28322.6250; train_gene_expr_recon_loss: 93816.4851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125797.7927; train_optim_loss: 125797.7927; val_kl_reg_loss: 3589.6240; val_edge_recon_loss: 27900.8787; val_gene_expr_recon_loss: 94350.5223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125841.0244; val_optim_loss: 125841.0244
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9930; val_auprc_score: 0.9915; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 3647.9802; train_edge_recon_loss: 28225.9223; train_gene_expr_recon_loss: 93119.8417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124993.7442; train_optim_loss: 124993.7442; val_kl_reg_loss: 3549.5628; val_edge_recon_loss: 27842.0520; val_gene_expr_recon_loss: 93688.6961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125080.3108; val_optim_loss: 125080.3108
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 3645.5289; train_edge_recon_loss: 28135.1416; train_gene_expr_recon_loss: 92641.8253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124422.4959; train_optim_loss: 124422.4959; val_kl_reg_loss: 3597.8076; val_edge_recon_loss: 27786.0372; val_gene_expr_recon_loss: 93444.0562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124827.9021; val_optim_loss: 124827.9021
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9939; val_auprc_score: 0.9929; val_best_acc_score: 0.9677; val_best_f1_score: 0.9680; train_kl_reg_loss: 3644.0600; train_edge_recon_loss: 28060.1174; train_gene_expr_recon_loss: 92092.3720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123796.5495; train_optim_loss: 123796.5495; val_kl_reg_loss: 3617.1315; val_edge_recon_loss: 27718.2617; val_gene_expr_recon_loss: 93332.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124667.8384; val_optim_loss: 124667.8384
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9931; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 3643.9873; train_edge_recon_loss: 28002.2281; train_gene_expr_recon_loss: 91651.9966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123298.2120; train_optim_loss: 123298.2120; val_kl_reg_loss: 3613.0755; val_edge_recon_loss: 27640.4530; val_gene_expr_recon_loss: 93151.9350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124405.4642; val_optim_loss: 124405.4642
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 3648.9166; train_edge_recon_loss: 27950.1512; train_gene_expr_recon_loss: 91266.8716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122865.9392; train_optim_loss: 122865.9392; val_kl_reg_loss: 3571.4743; val_edge_recon_loss: 27684.5483; val_gene_expr_recon_loss: 92986.8723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124242.8946; val_optim_loss: 124242.8946
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9941; val_auprc_score: 0.9929; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 3655.1652; train_edge_recon_loss: 27898.4526; train_gene_expr_recon_loss: 91051.2043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122604.8222; train_optim_loss: 122604.8222; val_kl_reg_loss: 3617.2679; val_edge_recon_loss: 27614.5850; val_gene_expr_recon_loss: 92704.9579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123936.8108; val_optim_loss: 123936.8108
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 3659.6205; train_edge_recon_loss: 27849.9990; train_gene_expr_recon_loss: 90694.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122203.7172; train_optim_loss: 122203.7172; val_kl_reg_loss: 3606.8003; val_edge_recon_loss: 27527.4645; val_gene_expr_recon_loss: 92954.2342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124088.4990; val_optim_loss: 124088.4990
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9946; val_auprc_score: 0.9937; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 3668.9486; train_edge_recon_loss: 27804.1343; train_gene_expr_recon_loss: 90362.4851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121835.5679; train_optim_loss: 121835.5679; val_kl_reg_loss: 3614.7489; val_edge_recon_loss: 27499.0292; val_gene_expr_recon_loss: 92975.1820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124088.9594; val_optim_loss: 124088.9594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9934; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 3677.2251; train_edge_recon_loss: 27775.9437; train_gene_expr_recon_loss: 90211.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121664.4236; train_optim_loss: 121664.4236; val_kl_reg_loss: 3619.9656; val_edge_recon_loss: 27503.8802; val_gene_expr_recon_loss: 92940.5842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124064.4306; val_optim_loss: 124064.4306
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 3682.5093; train_edge_recon_loss: 27749.2591; train_gene_expr_recon_loss: 89954.7014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121386.4699; train_optim_loss: 121386.4699; val_kl_reg_loss: 3667.3849; val_edge_recon_loss: 27446.2262; val_gene_expr_recon_loss: 92514.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123627.6261; val_optim_loss: 123627.6261
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 3691.1048; train_edge_recon_loss: 27720.6818; train_gene_expr_recon_loss: 89833.0172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121244.8038; train_optim_loss: 121244.8038; val_kl_reg_loss: 3623.7421; val_edge_recon_loss: 27409.1434; val_gene_expr_recon_loss: 92640.6740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123673.5587; val_optim_loss: 123673.5587
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9951; val_auprc_score: 0.9942; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 3699.4933; train_edge_recon_loss: 27699.3232; train_gene_expr_recon_loss: 89577.1083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120975.9248; train_optim_loss: 120975.9248; val_kl_reg_loss: 3674.3705; val_edge_recon_loss: 27395.0850; val_gene_expr_recon_loss: 92709.5452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123779.0004; val_optim_loss: 123779.0004
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9938; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 3704.2634; train_edge_recon_loss: 27676.9484; train_gene_expr_recon_loss: 89496.4255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120877.6374; train_optim_loss: 120877.6374; val_kl_reg_loss: 3653.6329; val_edge_recon_loss: 27381.3289; val_gene_expr_recon_loss: 92970.2140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124005.1757; val_optim_loss: 124005.1757
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9712; val_best_f1_score: 0.9715; train_kl_reg_loss: 3712.6284; train_edge_recon_loss: 27654.5858; train_gene_expr_recon_loss: 89254.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120621.8652; train_optim_loss: 120621.8652; val_kl_reg_loss: 3663.3854; val_edge_recon_loss: 27381.6255; val_gene_expr_recon_loss: 92987.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124032.3070; val_optim_loss: 124032.3070

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 3695.6467; train_edge_recon_loss: 27583.9821; train_gene_expr_recon_loss: 88568.3499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119847.9788; train_optim_loss: 119847.9788; val_kl_reg_loss: 3647.5142; val_edge_recon_loss: 27353.4153; val_gene_expr_recon_loss: 92899.0522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123899.9825; val_optim_loss: 123899.9825
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 3690.9356; train_edge_recon_loss: 27586.1119; train_gene_expr_recon_loss: 88552.6436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119829.6911; train_optim_loss: 119829.6911; val_kl_reg_loss: 3646.3689; val_edge_recon_loss: 27344.3799; val_gene_expr_recon_loss: 92750.5478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123741.2963; val_optim_loss: 123741.2963
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9947; val_best_acc_score: 0.9710; val_best_f1_score: 0.9713; train_kl_reg_loss: 3691.6927; train_edge_recon_loss: 27574.3086; train_gene_expr_recon_loss: 88482.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119748.5533; train_optim_loss: 119748.5533; val_kl_reg_loss: 3637.3895; val_edge_recon_loss: 27342.4159; val_gene_expr_recon_loss: 92591.6084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123571.4144; val_optim_loss: 123571.4144
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9941; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 3687.1356; train_edge_recon_loss: 27582.2397; train_gene_expr_recon_loss: 88416.2925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119685.6677; train_optim_loss: 119685.6677; val_kl_reg_loss: 3644.0640; val_edge_recon_loss: 27366.4406; val_gene_expr_recon_loss: 92651.3323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123661.8367; val_optim_loss: 123661.8367
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 3685.5250; train_edge_recon_loss: 27588.0077; train_gene_expr_recon_loss: 88410.7156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119684.2482; train_optim_loss: 119684.2482; val_kl_reg_loss: 3634.9393; val_edge_recon_loss: 27355.7837; val_gene_expr_recon_loss: 92626.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123617.0848; val_optim_loss: 123617.0848
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 3683.6404; train_edge_recon_loss: 27582.2910; train_gene_expr_recon_loss: 88387.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119653.4438; train_optim_loss: 119653.4438; val_kl_reg_loss: 3637.8355; val_edge_recon_loss: 27359.2743; val_gene_expr_recon_loss: 92431.5179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123428.6269; val_optim_loss: 123428.6269
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 3682.9063; train_edge_recon_loss: 27581.0748; train_gene_expr_recon_loss: 88347.4103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119611.3912; train_optim_loss: 119611.3912; val_kl_reg_loss: 3636.0845; val_edge_recon_loss: 27363.4181; val_gene_expr_recon_loss: 92529.5537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123529.0566; val_optim_loss: 123529.0566
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 3683.2551; train_edge_recon_loss: 27575.0465; train_gene_expr_recon_loss: 88340.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119598.5039; train_optim_loss: 119598.5039; val_kl_reg_loss: 3637.2478; val_edge_recon_loss: 27374.2967; val_gene_expr_recon_loss: 92680.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123691.8388; val_optim_loss: 123691.8388
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 3685.1509; train_edge_recon_loss: 27567.7054; train_gene_expr_recon_loss: 88286.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119539.5806; train_optim_loss: 119539.5806; val_kl_reg_loss: 3645.4579; val_edge_recon_loss: 27361.2088; val_gene_expr_recon_loss: 92608.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123614.6947; val_optim_loss: 123614.6947
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9944; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 3682.0014; train_edge_recon_loss: 27576.5772; train_gene_expr_recon_loss: 88302.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119561.2361; train_optim_loss: 119561.2361; val_kl_reg_loss: 3632.0253; val_edge_recon_loss: 27356.8636; val_gene_expr_recon_loss: 92783.3817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123772.2702; val_optim_loss: 123772.2702

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 3678.5707; train_edge_recon_loss: 27566.6185; train_gene_expr_recon_loss: 88134.1966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119379.3858; train_optim_loss: 119379.3858; val_kl_reg_loss: 3628.5660; val_edge_recon_loss: 27324.5675; val_gene_expr_recon_loss: 92576.0349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123529.1677; val_optim_loss: 123529.1677
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 3680.3294; train_edge_recon_loss: 27560.9199; train_gene_expr_recon_loss: 88188.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119429.6890; train_optim_loss: 119429.6890; val_kl_reg_loss: 3632.0244; val_edge_recon_loss: 27365.5332; val_gene_expr_recon_loss: 92700.4708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123698.0284; val_optim_loss: 123698.0284
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9955; val_auprc_score: 0.9947; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 3680.7264; train_edge_recon_loss: 27567.3577; train_gene_expr_recon_loss: 88246.2524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119494.3363; train_optim_loss: 119494.3363; val_kl_reg_loss: 3634.6903; val_edge_recon_loss: 27348.6780; val_gene_expr_recon_loss: 92618.2100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123601.5787; val_optim_loss: 123601.5787
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9953; val_auprc_score: 0.9945; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 3678.2583; train_edge_recon_loss: 27575.6916; train_gene_expr_recon_loss: 88180.7341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119434.6838; train_optim_loss: 119434.6838; val_kl_reg_loss: 3631.0161; val_edge_recon_loss: 27320.3096; val_gene_expr_recon_loss: 92673.3224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123624.6481; val_optim_loss: 123624.6481

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 94 min 38 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9951
Val AUPRC score: 0.9942
Val best accuracy score: 0.9705
Val best F1 score: 0.9710
Val gene expr MSE score: 0.6183

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
