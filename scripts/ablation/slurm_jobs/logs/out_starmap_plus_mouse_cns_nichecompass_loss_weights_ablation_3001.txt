None
Run timestamp: 03072023_122014_3001.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_3001']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9829; val_auprc_score: 0.9755; val_best_acc_score: 0.9508; val_best_f1_score: 0.9520; train_kl_reg_loss: 7572.5508; train_edge_recon_loss: 270435.2898; train_gene_expr_recon_loss: 128648.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406655.8567; train_optim_loss: 406655.8567; val_kl_reg_loss: 7650.4246; val_edge_recon_loss: 261536.0255; val_gene_expr_recon_loss: 115749.9385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384936.3895; val_optim_loss: 384936.3895
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9862; val_auprc_score: 0.9803; val_best_acc_score: 0.9589; val_best_f1_score: 0.9597; train_kl_reg_loss: 7505.3471; train_edge_recon_loss: 261281.9634; train_gene_expr_recon_loss: 112766.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381553.4273; train_optim_loss: 381553.4273; val_kl_reg_loss: 7151.3463; val_edge_recon_loss: 260692.6921; val_gene_expr_recon_loss: 110012.0217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377856.0625; val_optim_loss: 377856.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9886; val_auprc_score: 0.9850; val_best_acc_score: 0.9612; val_best_f1_score: 0.9621; train_kl_reg_loss: 7184.8503; train_edge_recon_loss: 260479.6081; train_gene_expr_recon_loss: 108499.5396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376163.9980; train_optim_loss: 376163.9980; val_kl_reg_loss: 6936.7652; val_edge_recon_loss: 260266.9809; val_gene_expr_recon_loss: 106621.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373825.7073; val_optim_loss: 373825.7073
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9899; val_auprc_score: 0.9864; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 7040.5112; train_edge_recon_loss: 260137.5503; train_gene_expr_recon_loss: 105607.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372785.4081; train_optim_loss: 372785.4081; val_kl_reg_loss: 6724.2191; val_edge_recon_loss: 259767.3201; val_gene_expr_recon_loss: 104505.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370996.8300; val_optim_loss: 370996.8300
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9899; val_auprc_score: 0.9864; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 6956.5828; train_edge_recon_loss: 259676.5197; train_gene_expr_recon_loss: 103506.7509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370139.8535; train_optim_loss: 370139.8535; val_kl_reg_loss: 6734.3674; val_edge_recon_loss: 259530.7611; val_gene_expr_recon_loss: 102837.0856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369102.2119; val_optim_loss: 369102.2119
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9907; val_auprc_score: 0.9876; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 6885.6303; train_edge_recon_loss: 259457.9872; train_gene_expr_recon_loss: 102050.1131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368393.7292; train_optim_loss: 368393.7292; val_kl_reg_loss: 6787.3541; val_edge_recon_loss: 259104.1726; val_gene_expr_recon_loss: 101663.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367555.3849; val_optim_loss: 367555.3849
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9884; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 6826.3072; train_edge_recon_loss: 259296.5982; train_gene_expr_recon_loss: 100815.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366938.6359; train_optim_loss: 366938.6359; val_kl_reg_loss: 6705.5060; val_edge_recon_loss: 259258.0636; val_gene_expr_recon_loss: 100144.8256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366108.3941; val_optim_loss: 366108.3941
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9921; val_auprc_score: 0.9895; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 6779.5363; train_edge_recon_loss: 259154.2129; train_gene_expr_recon_loss: 99858.2048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365791.9538; train_optim_loss: 365791.9538; val_kl_reg_loss: 6587.5742; val_edge_recon_loss: 258653.7763; val_gene_expr_recon_loss: 100013.5856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365254.9345; val_optim_loss: 365254.9345
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 6743.3883; train_edge_recon_loss: 258719.0827; train_gene_expr_recon_loss: 98929.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364392.4655; train_optim_loss: 364392.4655; val_kl_reg_loss: 6550.0595; val_edge_recon_loss: 258905.4844; val_gene_expr_recon_loss: 98889.0082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364344.5572; val_optim_loss: 364344.5572
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9924; val_auprc_score: 0.9898; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 6708.3224; train_edge_recon_loss: 258696.1820; train_gene_expr_recon_loss: 98291.1678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363695.6714; train_optim_loss: 363695.6714; val_kl_reg_loss: 6674.8371; val_edge_recon_loss: 258258.1155; val_gene_expr_recon_loss: 98342.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363275.3582; val_optim_loss: 363275.3582
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9926; val_auprc_score: 0.9900; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 6673.9851; train_edge_recon_loss: 258568.6412; train_gene_expr_recon_loss: 97703.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362945.8228; train_optim_loss: 362945.8228; val_kl_reg_loss: 6574.9054; val_edge_recon_loss: 258480.2622; val_gene_expr_recon_loss: 98102.4089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363157.5755; val_optim_loss: 363157.5755
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 6655.6411; train_edge_recon_loss: 258413.0474; train_gene_expr_recon_loss: 97274.7622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362343.4492; train_optim_loss: 362343.4492; val_kl_reg_loss: 6568.8437; val_edge_recon_loss: 258065.3506; val_gene_expr_recon_loss: 97901.2027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362535.3986; val_optim_loss: 362535.3986
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 6637.1750; train_edge_recon_loss: 258194.1267; train_gene_expr_recon_loss: 96836.5488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361667.8511; train_optim_loss: 361667.8511; val_kl_reg_loss: 6607.2068; val_edge_recon_loss: 257726.4413; val_gene_expr_recon_loss: 97366.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361700.6296; val_optim_loss: 361700.6296
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9916; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 6626.9769; train_edge_recon_loss: 258017.4288; train_gene_expr_recon_loss: 96459.8904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361104.2974; train_optim_loss: 361104.2974; val_kl_reg_loss: 6590.7613; val_edge_recon_loss: 257989.2767; val_gene_expr_recon_loss: 97192.4251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361772.4619; val_optim_loss: 361772.4619
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 6616.1823; train_edge_recon_loss: 258081.1687; train_gene_expr_recon_loss: 96134.6388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360831.9907; train_optim_loss: 360831.9907; val_kl_reg_loss: 6550.3833; val_edge_recon_loss: 258108.6311; val_gene_expr_recon_loss: 97330.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361989.5412; val_optim_loss: 361989.5412
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 6600.3632; train_edge_recon_loss: 257989.5747; train_gene_expr_recon_loss: 95836.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360426.3193; train_optim_loss: 360426.3193; val_kl_reg_loss: 6559.4169; val_edge_recon_loss: 258204.8121; val_gene_expr_recon_loss: 97234.1286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361998.3567; val_optim_loss: 361998.3567
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 6601.4631; train_edge_recon_loss: 257770.3332; train_gene_expr_recon_loss: 95554.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359925.9201; train_optim_loss: 359925.9201; val_kl_reg_loss: 6562.6994; val_edge_recon_loss: 257834.0575; val_gene_expr_recon_loss: 97179.3504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361576.1059; val_optim_loss: 361576.1059
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 6596.7886; train_edge_recon_loss: 257755.4805; train_gene_expr_recon_loss: 95245.5393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359597.8083; train_optim_loss: 359597.8083; val_kl_reg_loss: 6471.6603; val_edge_recon_loss: 257727.3121; val_gene_expr_recon_loss: 96801.7797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361000.7538; val_optim_loss: 361000.7538
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 6598.3214; train_edge_recon_loss: 257567.3295; train_gene_expr_recon_loss: 94944.5973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359110.2470; train_optim_loss: 359110.2470; val_kl_reg_loss: 6520.3691; val_edge_recon_loss: 257697.7885; val_gene_expr_recon_loss: 96803.4082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361021.5640; val_optim_loss: 361021.5640
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 6598.5024; train_edge_recon_loss: 257547.7285; train_gene_expr_recon_loss: 94771.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358917.4654; train_optim_loss: 358917.4654; val_kl_reg_loss: 6497.6563; val_edge_recon_loss: 257555.5358; val_gene_expr_recon_loss: 96765.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360818.5457; val_optim_loss: 360818.5457
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 6602.5370; train_edge_recon_loss: 257501.9153; train_gene_expr_recon_loss: 94618.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358722.7520; train_optim_loss: 358722.7520; val_kl_reg_loss: 6550.8164; val_edge_recon_loss: 257475.5194; val_gene_expr_recon_loss: 96680.0126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360706.3498; val_optim_loss: 360706.3498
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 6609.0267; train_edge_recon_loss: 257377.1097; train_gene_expr_recon_loss: 94495.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358481.8602; train_optim_loss: 358481.8602; val_kl_reg_loss: 6469.4502; val_edge_recon_loss: 257420.6837; val_gene_expr_recon_loss: 96755.3624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360645.5000; val_optim_loss: 360645.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 6607.1726; train_edge_recon_loss: 257443.7404; train_gene_expr_recon_loss: 94222.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358273.6253; train_optim_loss: 358273.6253; val_kl_reg_loss: 6492.5366; val_edge_recon_loss: 257118.6322; val_gene_expr_recon_loss: 96625.0372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360236.2043; val_optim_loss: 360236.2043
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 6616.7836; train_edge_recon_loss: 257288.5492; train_gene_expr_recon_loss: 94104.1134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358009.4464; train_optim_loss: 358009.4464; val_kl_reg_loss: 6563.4791; val_edge_recon_loss: 257221.0198; val_gene_expr_recon_loss: 96690.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360475.1860; val_optim_loss: 360475.1860
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 6624.0943; train_edge_recon_loss: 257223.9286; train_gene_expr_recon_loss: 93919.5439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357767.5663; train_optim_loss: 357767.5663; val_kl_reg_loss: 6511.1130; val_edge_recon_loss: 257409.3769; val_gene_expr_recon_loss: 96574.1574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360494.6479; val_optim_loss: 360494.6479
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 6621.4660; train_edge_recon_loss: 257244.0082; train_gene_expr_recon_loss: 93729.2744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357594.7471; train_optim_loss: 357594.7471; val_kl_reg_loss: 6600.1321; val_edge_recon_loss: 257263.1021; val_gene_expr_recon_loss: 96478.1551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360341.3872; val_optim_loss: 360341.3872
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6631.6705; train_edge_recon_loss: 257126.9287; train_gene_expr_recon_loss: 93603.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357362.5915; train_optim_loss: 357362.5915; val_kl_reg_loss: 6572.1411; val_edge_recon_loss: 256864.8925; val_gene_expr_recon_loss: 96419.3228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359856.3582; val_optim_loss: 359856.3582
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6642.0515; train_edge_recon_loss: 257086.6066; train_gene_expr_recon_loss: 93436.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357165.6185; train_optim_loss: 357165.6185; val_kl_reg_loss: 6520.4274; val_edge_recon_loss: 257415.6833; val_gene_expr_recon_loss: 96372.3769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360308.4870; val_optim_loss: 360308.4870
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 6637.3920; train_edge_recon_loss: 257223.8866; train_gene_expr_recon_loss: 93223.2171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357084.4955; train_optim_loss: 357084.4955; val_kl_reg_loss: 6549.0260; val_edge_recon_loss: 257105.9002; val_gene_expr_recon_loss: 96579.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360234.4573; val_optim_loss: 360234.4573
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6652.8937; train_edge_recon_loss: 257058.6144; train_gene_expr_recon_loss: 93159.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356871.3320; train_optim_loss: 356871.3320; val_kl_reg_loss: 6588.0305; val_edge_recon_loss: 257098.5412; val_gene_expr_recon_loss: 96715.9066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360402.4794; val_optim_loss: 360402.4794
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6656.1984; train_edge_recon_loss: 257004.3668; train_gene_expr_recon_loss: 93056.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356716.9851; train_optim_loss: 356716.9851; val_kl_reg_loss: 6635.6126; val_edge_recon_loss: 257113.5568; val_gene_expr_recon_loss: 96683.7833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360432.9543; val_optim_loss: 360432.9543

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 6667.2636; train_edge_recon_loss: 256951.2372; train_gene_expr_recon_loss: 92301.4256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355919.9268; train_optim_loss: 355919.9268; val_kl_reg_loss: 6589.6986; val_edge_recon_loss: 257103.5232; val_gene_expr_recon_loss: 96489.3483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360182.5701; val_optim_loss: 360182.5701
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6663.2004; train_edge_recon_loss: 256845.1101; train_gene_expr_recon_loss: 92100.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355608.8747; train_optim_loss: 355608.8747; val_kl_reg_loss: 6586.1088; val_edge_recon_loss: 257128.5111; val_gene_expr_recon_loss: 96279.1044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359993.7203; val_optim_loss: 359993.7203
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6661.6755; train_edge_recon_loss: 256877.1390; train_gene_expr_recon_loss: 92111.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355650.4103; train_optim_loss: 355650.4103; val_kl_reg_loss: 6582.3636; val_edge_recon_loss: 256980.9642; val_gene_expr_recon_loss: 96189.7226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359753.0480; val_optim_loss: 359753.0480
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6660.6167; train_edge_recon_loss: 256827.0713; train_gene_expr_recon_loss: 92180.6345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355668.3228; train_optim_loss: 355668.3228; val_kl_reg_loss: 6597.1914; val_edge_recon_loss: 257018.4268; val_gene_expr_recon_loss: 96266.6787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359882.2950; val_optim_loss: 359882.2950
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6659.6489; train_edge_recon_loss: 256838.6645; train_gene_expr_recon_loss: 92011.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355509.4446; train_optim_loss: 355509.4446; val_kl_reg_loss: 6590.1058; val_edge_recon_loss: 256922.8754; val_gene_expr_recon_loss: 96330.1572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359843.1387; val_optim_loss: 359843.1387
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9813; val_best_f1_score: 0.9816; train_kl_reg_loss: 6663.7525; train_edge_recon_loss: 256806.9363; train_gene_expr_recon_loss: 92039.6019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355510.2909; train_optim_loss: 355510.2909; val_kl_reg_loss: 6607.6366; val_edge_recon_loss: 257023.0934; val_gene_expr_recon_loss: 96318.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359949.1479; val_optim_loss: 359949.1479
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6656.2013; train_edge_recon_loss: 256894.2503; train_gene_expr_recon_loss: 91994.7661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355545.2179; train_optim_loss: 355545.2179; val_kl_reg_loss: 6584.1869; val_edge_recon_loss: 257298.8773; val_gene_expr_recon_loss: 96568.3064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360451.3735; val_optim_loss: 360451.3735

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 6664.8187; train_edge_recon_loss: 256780.8975; train_gene_expr_recon_loss: 91927.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355373.4235; train_optim_loss: 355373.4235; val_kl_reg_loss: 6585.2227; val_edge_recon_loss: 257075.0728; val_gene_expr_recon_loss: 96200.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359861.1029; val_optim_loss: 359861.1029
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6662.6949; train_edge_recon_loss: 256799.2940; train_gene_expr_recon_loss: 91950.4501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355412.4399; train_optim_loss: 355412.4399; val_kl_reg_loss: 6589.9555; val_edge_recon_loss: 256851.9726; val_gene_expr_recon_loss: 96391.4931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359833.4215; val_optim_loss: 359833.4215
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6660.4002; train_edge_recon_loss: 256838.7446; train_gene_expr_recon_loss: 91922.4911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355421.6349; train_optim_loss: 355421.6349; val_kl_reg_loss: 6587.2813; val_edge_recon_loss: 256637.7241; val_gene_expr_recon_loss: 96398.9695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359623.9726; val_optim_loss: 359623.9726
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9816; train_kl_reg_loss: 6662.7065; train_edge_recon_loss: 256766.5760; train_gene_expr_recon_loss: 91910.8685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355340.1501; train_optim_loss: 355340.1501; val_kl_reg_loss: 6584.2926; val_edge_recon_loss: 256716.3998; val_gene_expr_recon_loss: 96455.8550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359756.5488; val_optim_loss: 359756.5488
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6659.7727; train_edge_recon_loss: 256799.0259; train_gene_expr_recon_loss: 91902.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355361.5847; train_optim_loss: 355361.5847; val_kl_reg_loss: 6585.5499; val_edge_recon_loss: 256924.9002; val_gene_expr_recon_loss: 96165.7153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359676.1631; val_optim_loss: 359676.1631
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9803; val_best_f1_score: 0.9806; train_kl_reg_loss: 6661.5037; train_edge_recon_loss: 256782.7640; train_gene_expr_recon_loss: 91891.1355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355335.4026; train_optim_loss: 355335.4026; val_kl_reg_loss: 6593.6990; val_edge_recon_loss: 256998.2096; val_gene_expr_recon_loss: 96363.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359955.3956; val_optim_loss: 359955.3956
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6662.0091; train_edge_recon_loss: 256791.6860; train_gene_expr_recon_loss: 91907.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355361.2415; train_optim_loss: 355361.2415; val_kl_reg_loss: 6585.7157; val_edge_recon_loss: 256916.8921; val_gene_expr_recon_loss: 96417.2504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359919.8590; val_optim_loss: 359919.8590

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 6661.0378; train_edge_recon_loss: 256857.9503; train_gene_expr_recon_loss: 91880.9968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355399.9853; train_optim_loss: 355399.9853; val_kl_reg_loss: 6589.8439; val_edge_recon_loss: 256910.6528; val_gene_expr_recon_loss: 96430.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359931.2508; val_optim_loss: 359931.2508
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 6661.6554; train_edge_recon_loss: 256784.0293; train_gene_expr_recon_loss: 91811.0149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355256.6995; train_optim_loss: 355256.6995; val_kl_reg_loss: 6586.3752; val_edge_recon_loss: 257008.8243; val_gene_expr_recon_loss: 96183.9718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359779.1723; val_optim_loss: 359779.1723
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 6661.2830; train_edge_recon_loss: 256861.6524; train_gene_expr_recon_loss: 91846.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355369.7003; train_optim_loss: 355369.7003; val_kl_reg_loss: 6585.9238; val_edge_recon_loss: 257192.5587; val_gene_expr_recon_loss: 96183.9947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359962.4779; val_optim_loss: 359962.4779
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6660.8024; train_edge_recon_loss: 256836.1892; train_gene_expr_recon_loss: 91880.7788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355377.7698; train_optim_loss: 355377.7698; val_kl_reg_loss: 6586.5198; val_edge_recon_loss: 256669.4966; val_gene_expr_recon_loss: 96482.5669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359738.5846; val_optim_loss: 359738.5846

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 145 min 14 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9951
Val best accuracy score: 0.9812
Val best F1 score: 0.9814
Val gene expr MSE score: 0.6385

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
