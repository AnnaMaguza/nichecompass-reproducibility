None
Run timestamp: 02072023_012108_1000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_1000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9439; val_auprc_score: 0.9319; val_best_acc_score: 0.8772; val_best_f1_score: 0.8828; train_kl_reg_loss: 3435.5633; train_edge_recon_loss: 29841.7563; train_gene_expr_recon_loss: 76050.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109327.4166; train_optim_loss: 109327.4166; val_kl_reg_loss: 3151.8014; val_edge_recon_loss: 28869.9894; val_gene_expr_recon_loss: 69225.2442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101247.0350; val_optim_loss: 101247.0350
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9568; val_auprc_score: 0.9477; val_best_acc_score: 0.8942; val_best_f1_score: 0.8992; train_kl_reg_loss: 3106.2356; train_edge_recon_loss: 28638.8951; train_gene_expr_recon_loss: 67904.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99649.7782; train_optim_loss: 99649.7782; val_kl_reg_loss: 2946.0058; val_edge_recon_loss: 28431.8395; val_gene_expr_recon_loss: 65827.9710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97205.8165; val_optim_loss: 97205.8165
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9593; val_auprc_score: 0.9512; val_best_acc_score: 0.8975; val_best_f1_score: 0.9020; train_kl_reg_loss: 3052.6365; train_edge_recon_loss: 28338.3790; train_gene_expr_recon_loss: 65246.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96637.0284; train_optim_loss: 96637.0284; val_kl_reg_loss: 2991.9183; val_edge_recon_loss: 28262.5132; val_gene_expr_recon_loss: 63957.2214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95211.6528; val_optim_loss: 95211.6528
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9640; val_auprc_score: 0.9570; val_best_acc_score: 0.9060; val_best_f1_score: 0.9096; train_kl_reg_loss: 3053.1569; train_edge_recon_loss: 28172.4380; train_gene_expr_recon_loss: 63629.9803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94855.5751; train_optim_loss: 94855.5751; val_kl_reg_loss: 2998.6857; val_edge_recon_loss: 28095.7288; val_gene_expr_recon_loss: 62745.4901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93839.9048; val_optim_loss: 93839.9048
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9650; val_auprc_score: 0.9578; val_best_acc_score: 0.9075; val_best_f1_score: 0.9116; train_kl_reg_loss: 3061.0070; train_edge_recon_loss: 28074.7107; train_gene_expr_recon_loss: 62623.3902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93759.1078; train_optim_loss: 93759.1078; val_kl_reg_loss: 3010.4670; val_edge_recon_loss: 28013.5145; val_gene_expr_recon_loss: 61846.3872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92870.3686; val_optim_loss: 92870.3686
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9669; val_auprc_score: 0.9601; val_best_acc_score: 0.9111; val_best_f1_score: 0.9144; train_kl_reg_loss: 3071.0407; train_edge_recon_loss: 28015.3031; train_gene_expr_recon_loss: 61919.2101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93005.5541; train_optim_loss: 93005.5541; val_kl_reg_loss: 2969.1862; val_edge_recon_loss: 27964.0322; val_gene_expr_recon_loss: 61337.5504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92270.7684; val_optim_loss: 92270.7684
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9662; val_auprc_score: 0.9580; val_best_acc_score: 0.9115; val_best_f1_score: 0.9149; train_kl_reg_loss: 3078.2656; train_edge_recon_loss: 27949.0547; train_gene_expr_recon_loss: 61435.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92462.6202; train_optim_loss: 92462.6202; val_kl_reg_loss: 2972.8297; val_edge_recon_loss: 27912.6872; val_gene_expr_recon_loss: 60938.1531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91823.6700; val_optim_loss: 91823.6700
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9677; val_auprc_score: 0.9612; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 3084.4638; train_edge_recon_loss: 27900.4101; train_gene_expr_recon_loss: 61089.1279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92074.0018; train_optim_loss: 92074.0018; val_kl_reg_loss: 3003.1964; val_edge_recon_loss: 27896.9890; val_gene_expr_recon_loss: 60630.3632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91530.5485; val_optim_loss: 91530.5485
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9684; val_auprc_score: 0.9621; val_best_acc_score: 0.9138; val_best_f1_score: 0.9170; train_kl_reg_loss: 3092.8133; train_edge_recon_loss: 27855.5495; train_gene_expr_recon_loss: 60877.7580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91826.1209; train_optim_loss: 91826.1209; val_kl_reg_loss: 3030.4808; val_edge_recon_loss: 27847.1915; val_gene_expr_recon_loss: 60602.9783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91480.6508; val_optim_loss: 91480.6508
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9701; val_auprc_score: 0.9643; val_best_acc_score: 0.9160; val_best_f1_score: 0.9187; train_kl_reg_loss: 3091.4489; train_edge_recon_loss: 27830.4626; train_gene_expr_recon_loss: 60682.8239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91604.7354; train_optim_loss: 91604.7354; val_kl_reg_loss: 3016.4567; val_edge_recon_loss: 27800.5600; val_gene_expr_recon_loss: 60334.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91151.2146; val_optim_loss: 91151.2146
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9704; val_auprc_score: 0.9646; val_best_acc_score: 0.9157; val_best_f1_score: 0.9184; train_kl_reg_loss: 3095.9643; train_edge_recon_loss: 27796.6321; train_gene_expr_recon_loss: 60523.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91415.9855; train_optim_loss: 91415.9855; val_kl_reg_loss: 3002.3872; val_edge_recon_loss: 27854.3215; val_gene_expr_recon_loss: 60220.9801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91077.6889; val_optim_loss: 91077.6889
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9718; val_auprc_score: 0.9672; val_best_acc_score: 0.9170; val_best_f1_score: 0.9196; train_kl_reg_loss: 3095.3440; train_edge_recon_loss: 27788.5631; train_gene_expr_recon_loss: 60404.3443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91288.2514; train_optim_loss: 91288.2514; val_kl_reg_loss: 2987.6732; val_edge_recon_loss: 27788.0880; val_gene_expr_recon_loss: 60068.0311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90843.7922; val_optim_loss: 90843.7922
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9715; val_auprc_score: 0.9661; val_best_acc_score: 0.9181; val_best_f1_score: 0.9205; train_kl_reg_loss: 3099.7323; train_edge_recon_loss: 27752.7201; train_gene_expr_recon_loss: 60308.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91161.0513; train_optim_loss: 91161.0513; val_kl_reg_loss: 3028.4095; val_edge_recon_loss: 27791.6016; val_gene_expr_recon_loss: 60144.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90964.7748; val_optim_loss: 90964.7748
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9714; val_auprc_score: 0.9657; val_best_acc_score: 0.9173; val_best_f1_score: 0.9198; train_kl_reg_loss: 3104.9430; train_edge_recon_loss: 27732.9978; train_gene_expr_recon_loss: 60214.1720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91052.1128; train_optim_loss: 91052.1128; val_kl_reg_loss: 3007.3497; val_edge_recon_loss: 27777.8312; val_gene_expr_recon_loss: 60004.2884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90789.4692; val_optim_loss: 90789.4692
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9703; val_auprc_score: 0.9643; val_best_acc_score: 0.9161; val_best_f1_score: 0.9189; train_kl_reg_loss: 3105.3166; train_edge_recon_loss: 27712.3656; train_gene_expr_recon_loss: 60157.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90974.9680; train_optim_loss: 90974.9680; val_kl_reg_loss: 3066.4809; val_edge_recon_loss: 27799.2677; val_gene_expr_recon_loss: 59901.8751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90767.6237; val_optim_loss: 90767.6237
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9718; val_auprc_score: 0.9661; val_best_acc_score: 0.9185; val_best_f1_score: 0.9213; train_kl_reg_loss: 3108.0769; train_edge_recon_loss: 27688.0619; train_gene_expr_recon_loss: 60072.8421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90868.9810; train_optim_loss: 90868.9810; val_kl_reg_loss: 3030.7017; val_edge_recon_loss: 27723.8844; val_gene_expr_recon_loss: 59935.8156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90690.4018; val_optim_loss: 90690.4018
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9710; val_auprc_score: 0.9642; val_best_acc_score: 0.9189; val_best_f1_score: 0.9219; train_kl_reg_loss: 3104.2718; train_edge_recon_loss: 27687.4802; train_gene_expr_recon_loss: 60063.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90855.4394; train_optim_loss: 90855.4394; val_kl_reg_loss: 3072.7184; val_edge_recon_loss: 27653.1475; val_gene_expr_recon_loss: 59901.2958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90627.1617; val_optim_loss: 90627.1617
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9721; val_auprc_score: 0.9666; val_best_acc_score: 0.9175; val_best_f1_score: 0.9204; train_kl_reg_loss: 3108.2365; train_edge_recon_loss: 27672.0474; train_gene_expr_recon_loss: 59973.0637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90753.3477; train_optim_loss: 90753.3477; val_kl_reg_loss: 3054.9119; val_edge_recon_loss: 27659.8727; val_gene_expr_recon_loss: 60047.1937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90761.9786; val_optim_loss: 90761.9786
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9730; val_auprc_score: 0.9686; val_best_acc_score: 0.9185; val_best_f1_score: 0.9208; train_kl_reg_loss: 3109.4252; train_edge_recon_loss: 27645.7927; train_gene_expr_recon_loss: 59966.8061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90722.0242; train_optim_loss: 90722.0242; val_kl_reg_loss: 3071.9839; val_edge_recon_loss: 27693.2926; val_gene_expr_recon_loss: 59914.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90679.8577; val_optim_loss: 90679.8577
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9724; val_auprc_score: 0.9669; val_best_acc_score: 0.9190; val_best_f1_score: 0.9218; train_kl_reg_loss: 3107.0642; train_edge_recon_loss: 27660.4448; train_gene_expr_recon_loss: 59915.3703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90682.8794; train_optim_loss: 90682.8794; val_kl_reg_loss: 2982.3078; val_edge_recon_loss: 27727.1624; val_gene_expr_recon_loss: 59884.6632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90594.1335; val_optim_loss: 90594.1335
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9733; val_auprc_score: 0.9686; val_best_acc_score: 0.9204; val_best_f1_score: 0.9222; train_kl_reg_loss: 3106.7457; train_edge_recon_loss: 27653.3969; train_gene_expr_recon_loss: 59892.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90652.7077; train_optim_loss: 90652.7077; val_kl_reg_loss: 3024.2272; val_edge_recon_loss: 27703.8647; val_gene_expr_recon_loss: 59786.2874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90514.3787; val_optim_loss: 90514.3787
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9740; val_auprc_score: 0.9697; val_best_acc_score: 0.9211; val_best_f1_score: 0.9234; train_kl_reg_loss: 3112.3622; train_edge_recon_loss: 27615.6099; train_gene_expr_recon_loss: 59802.8063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90530.7785; train_optim_loss: 90530.7785; val_kl_reg_loss: 3074.0087; val_edge_recon_loss: 27589.0023; val_gene_expr_recon_loss: 59648.7707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90311.7822; val_optim_loss: 90311.7822
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9719; val_auprc_score: 0.9665; val_best_acc_score: 0.9194; val_best_f1_score: 0.9218; train_kl_reg_loss: 3110.1396; train_edge_recon_loss: 27627.7883; train_gene_expr_recon_loss: 59838.7998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90576.7277; train_optim_loss: 90576.7277; val_kl_reg_loss: 2998.2075; val_edge_recon_loss: 27663.9051; val_gene_expr_recon_loss: 59713.1674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90375.2800; val_optim_loss: 90375.2800
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9718; val_auprc_score: 0.9661; val_best_acc_score: 0.9197; val_best_f1_score: 0.9225; train_kl_reg_loss: 3109.0603; train_edge_recon_loss: 27619.6909; train_gene_expr_recon_loss: 59786.5544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90515.3056; train_optim_loss: 90515.3056; val_kl_reg_loss: 3050.4259; val_edge_recon_loss: 27666.4497; val_gene_expr_recon_loss: 59550.1516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90267.0275; val_optim_loss: 90267.0275
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9738; val_auprc_score: 0.9691; val_best_acc_score: 0.9204; val_best_f1_score: 0.9228; train_kl_reg_loss: 3110.7492; train_edge_recon_loss: 27617.7813; train_gene_expr_recon_loss: 59757.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90486.2005; train_optim_loss: 90486.2005; val_kl_reg_loss: 3039.4722; val_edge_recon_loss: 27641.5939; val_gene_expr_recon_loss: 59873.5986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90554.6647; val_optim_loss: 90554.6647
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9714; val_auprc_score: 0.9659; val_best_acc_score: 0.9171; val_best_f1_score: 0.9196; train_kl_reg_loss: 3113.2661; train_edge_recon_loss: 27597.1865; train_gene_expr_recon_loss: 59731.2226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90441.6751; train_optim_loss: 90441.6751; val_kl_reg_loss: 3038.0140; val_edge_recon_loss: 27699.5401; val_gene_expr_recon_loss: 59714.5191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90452.0736; val_optim_loss: 90452.0736
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9739; val_auprc_score: 0.9690; val_best_acc_score: 0.9212; val_best_f1_score: 0.9235; train_kl_reg_loss: 3111.8890; train_edge_recon_loss: 27596.1447; train_gene_expr_recon_loss: 59742.9907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90451.0244; train_optim_loss: 90451.0244; val_kl_reg_loss: 3095.0182; val_edge_recon_loss: 27619.7528; val_gene_expr_recon_loss: 59826.6353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90541.4062; val_optim_loss: 90541.4062
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9728; val_auprc_score: 0.9675; val_best_acc_score: 0.9210; val_best_f1_score: 0.9234; train_kl_reg_loss: 3110.3934; train_edge_recon_loss: 27595.5796; train_gene_expr_recon_loss: 59685.0270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90391.0000; train_optim_loss: 90391.0000; val_kl_reg_loss: 3033.2858; val_edge_recon_loss: 27586.6010; val_gene_expr_recon_loss: 59577.9791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90197.8661; val_optim_loss: 90197.8661
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9726; val_auprc_score: 0.9668; val_best_acc_score: 0.9217; val_best_f1_score: 0.9243; train_kl_reg_loss: 3112.6898; train_edge_recon_loss: 27587.2754; train_gene_expr_recon_loss: 59697.0537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90397.0189; train_optim_loss: 90397.0189; val_kl_reg_loss: 3093.0165; val_edge_recon_loss: 27606.2526; val_gene_expr_recon_loss: 59580.4234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90279.6923; val_optim_loss: 90279.6923
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9738; val_auprc_score: 0.9689; val_best_acc_score: 0.9219; val_best_f1_score: 0.9240; train_kl_reg_loss: 3111.3018; train_edge_recon_loss: 27587.6940; train_gene_expr_recon_loss: 59701.8404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90400.8360; train_optim_loss: 90400.8360; val_kl_reg_loss: 3051.0094; val_edge_recon_loss: 27598.6820; val_gene_expr_recon_loss: 59648.8491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90298.5405; val_optim_loss: 90298.5405
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9733; val_auprc_score: 0.9682; val_best_acc_score: 0.9209; val_best_f1_score: 0.9230; train_kl_reg_loss: 3112.2201; train_edge_recon_loss: 27578.1722; train_gene_expr_recon_loss: 59627.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90317.7699; train_optim_loss: 90317.7699; val_kl_reg_loss: 3079.7751; val_edge_recon_loss: 27570.5112; val_gene_expr_recon_loss: 59617.0190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90267.3053; val_optim_loss: 90267.3053
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9744; val_auprc_score: 0.9697; val_best_acc_score: 0.9217; val_best_f1_score: 0.9238; train_kl_reg_loss: 3112.6018; train_edge_recon_loss: 27576.0156; train_gene_expr_recon_loss: 59613.4817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90302.0992; train_optim_loss: 90302.0992; val_kl_reg_loss: 3063.4260; val_edge_recon_loss: 27589.2337; val_gene_expr_recon_loss: 59687.5604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90340.2200; val_optim_loss: 90340.2200

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9727; val_auprc_score: 0.9675; val_best_acc_score: 0.9201; val_best_f1_score: 0.9230; train_kl_reg_loss: 3096.4360; train_edge_recon_loss: 27528.6193; train_gene_expr_recon_loss: 59304.1303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89929.1855; train_optim_loss: 89929.1855; val_kl_reg_loss: 3030.8071; val_edge_recon_loss: 27591.9120; val_gene_expr_recon_loss: 59357.0609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89979.7800; val_optim_loss: 89979.7800
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9739; val_auprc_score: 0.9691; val_best_acc_score: 0.9212; val_best_f1_score: 0.9236; train_kl_reg_loss: 3091.4422; train_edge_recon_loss: 27529.6917; train_gene_expr_recon_loss: 59239.4617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89860.5955; train_optim_loss: 89860.5955; val_kl_reg_loss: 3031.6786; val_edge_recon_loss: 27583.4146; val_gene_expr_recon_loss: 59333.6941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89948.7874; val_optim_loss: 89948.7874
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9746; val_auprc_score: 0.9703; val_best_acc_score: 0.9227; val_best_f1_score: 0.9246; train_kl_reg_loss: 3086.6439; train_edge_recon_loss: 27536.0560; train_gene_expr_recon_loss: 59225.8404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89848.5404; train_optim_loss: 89848.5404; val_kl_reg_loss: 3020.1312; val_edge_recon_loss: 27568.7432; val_gene_expr_recon_loss: 59226.2160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89815.0902; val_optim_loss: 89815.0902
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9744; val_auprc_score: 0.9696; val_best_acc_score: 0.9230; val_best_f1_score: 0.9251; train_kl_reg_loss: 3086.2935; train_edge_recon_loss: 27534.3211; train_gene_expr_recon_loss: 59231.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89852.0193; train_optim_loss: 89852.0193; val_kl_reg_loss: 3011.4976; val_edge_recon_loss: 27540.3313; val_gene_expr_recon_loss: 59254.2720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89806.1009; val_optim_loss: 89806.1009
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9755; val_auprc_score: 0.9713; val_best_acc_score: 0.9234; val_best_f1_score: 0.9259; train_kl_reg_loss: 3087.7859; train_edge_recon_loss: 27530.0919; train_gene_expr_recon_loss: 59241.4116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89859.2895; train_optim_loss: 89859.2895; val_kl_reg_loss: 3025.7313; val_edge_recon_loss: 27539.1771; val_gene_expr_recon_loss: 59273.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89838.6943; val_optim_loss: 89838.6943
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9750; val_auprc_score: 0.9706; val_best_acc_score: 0.9239; val_best_f1_score: 0.9260; train_kl_reg_loss: 3084.7947; train_edge_recon_loss: 27535.1528; train_gene_expr_recon_loss: 59240.3996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89860.3470; train_optim_loss: 89860.3470; val_kl_reg_loss: 3018.1557; val_edge_recon_loss: 27514.6638; val_gene_expr_recon_loss: 59183.1671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89715.9864; val_optim_loss: 89715.9864
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9738; val_auprc_score: 0.9689; val_best_acc_score: 0.9215; val_best_f1_score: 0.9235; train_kl_reg_loss: 3085.2953; train_edge_recon_loss: 27517.9787; train_gene_expr_recon_loss: 59178.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89782.0693; train_optim_loss: 89782.0693; val_kl_reg_loss: 3027.8417; val_edge_recon_loss: 27589.4475; val_gene_expr_recon_loss: 59212.1145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89829.4034; val_optim_loss: 89829.4034
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9747; val_auprc_score: 0.9701; val_best_acc_score: 0.9240; val_best_f1_score: 0.9261; train_kl_reg_loss: 3084.7644; train_edge_recon_loss: 27527.6564; train_gene_expr_recon_loss: 59188.8517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89801.2725; train_optim_loss: 89801.2725; val_kl_reg_loss: 3019.6260; val_edge_recon_loss: 27547.4626; val_gene_expr_recon_loss: 59340.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89907.8489; val_optim_loss: 89907.8489
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9753; val_auprc_score: 0.9706; val_best_acc_score: 0.9240; val_best_f1_score: 0.9261; train_kl_reg_loss: 3081.9663; train_edge_recon_loss: 27534.3922; train_gene_expr_recon_loss: 59189.1872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89805.5457; train_optim_loss: 89805.5457; val_kl_reg_loss: 3016.1445; val_edge_recon_loss: 27524.5367; val_gene_expr_recon_loss: 59399.8376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89940.5189; val_optim_loss: 89940.5189
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9741; val_auprc_score: 0.9691; val_best_acc_score: 0.9234; val_best_f1_score: 0.9256; train_kl_reg_loss: 3083.2749; train_edge_recon_loss: 27529.9967; train_gene_expr_recon_loss: 59223.5638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89836.8354; train_optim_loss: 89836.8354; val_kl_reg_loss: 3026.9079; val_edge_recon_loss: 27522.0231; val_gene_expr_recon_loss: 59270.9770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89819.9080; val_optim_loss: 89819.9080

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9745; val_auprc_score: 0.9697; val_best_acc_score: 0.9236; val_best_f1_score: 0.9254; train_kl_reg_loss: 3081.2194; train_edge_recon_loss: 27530.8419; train_gene_expr_recon_loss: 59148.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89760.9078; train_optim_loss: 89760.9078; val_kl_reg_loss: 3018.2034; val_edge_recon_loss: 27561.9340; val_gene_expr_recon_loss: 59292.2307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89872.3682; val_optim_loss: 89872.3682
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9744; val_auprc_score: 0.9701; val_best_acc_score: 0.9226; val_best_f1_score: 0.9245; train_kl_reg_loss: 3079.1238; train_edge_recon_loss: 27524.6180; train_gene_expr_recon_loss: 59170.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89774.0573; train_optim_loss: 89774.0573; val_kl_reg_loss: 3019.4869; val_edge_recon_loss: 27558.4780; val_gene_expr_recon_loss: 59320.3754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89898.3400; val_optim_loss: 89898.3400
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9747; val_auprc_score: 0.9700; val_best_acc_score: 0.9242; val_best_f1_score: 0.9262; train_kl_reg_loss: 3081.0157; train_edge_recon_loss: 27518.6844; train_gene_expr_recon_loss: 59165.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89765.0645; train_optim_loss: 89765.0645; val_kl_reg_loss: 3018.9923; val_edge_recon_loss: 27572.6464; val_gene_expr_recon_loss: 59201.3393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89792.9783; val_optim_loss: 89792.9783
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9743; val_auprc_score: 0.9695; val_best_acc_score: 0.9228; val_best_f1_score: 0.9250; train_kl_reg_loss: 3079.2824; train_edge_recon_loss: 27525.3663; train_gene_expr_recon_loss: 59172.6284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89777.2768; train_optim_loss: 89777.2768; val_kl_reg_loss: 3012.4767; val_edge_recon_loss: 27560.0467; val_gene_expr_recon_loss: 59293.3671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89865.8910; val_optim_loss: 89865.8910

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 77 min 4 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9751
Val AUPRC score: 0.9704
Val best accuracy score: 0.9240
Val best F1 score: 0.9257
Val gene expr MSE score: 1.3774

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
