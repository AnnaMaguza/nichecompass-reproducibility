None
Run timestamp: 15072023_171617_1000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9464; val_auprc_score: 0.9306; val_best_acc_score: 0.8873; val_best_f1_score: 0.8938; train_kl_reg_loss: 12244.0440; train_edge_recon_loss: 2693441.2919; train_gene_expr_recon_loss: 1324440.0437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4030125.3824; train_optim_loss: 4030125.3824; val_kl_reg_loss: 11448.1895; val_edge_recon_loss: 2692286.9901; val_gene_expr_recon_loss: 1273014.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3976750.1480; val_optim_loss: 3976750.1480
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9640; val_auprc_score: 0.9555; val_best_acc_score: 0.9079; val_best_f1_score: 0.9112; train_kl_reg_loss: 11827.1470; train_edge_recon_loss: 2623825.9537; train_gene_expr_recon_loss: 1238894.3458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3874547.4460; train_optim_loss: 3874547.4460; val_kl_reg_loss: 11703.7934; val_edge_recon_loss: 2678114.4013; val_gene_expr_recon_loss: 1217259.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3907077.3026; val_optim_loss: 3907077.3026
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9679; val_auprc_score: 0.9602; val_best_acc_score: 0.9157; val_best_f1_score: 0.9187; train_kl_reg_loss: 11853.1203; train_edge_recon_loss: 2615768.5452; train_gene_expr_recon_loss: 1200150.3048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3827771.9728; train_optim_loss: 3827771.9728; val_kl_reg_loss: 11496.2179; val_edge_recon_loss: 2670718.4178; val_gene_expr_recon_loss: 1189362.9622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3871577.5855; val_optim_loss: 3871577.5855
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9677; val_auprc_score: 0.9590; val_best_acc_score: 0.9171; val_best_f1_score: 0.9202; train_kl_reg_loss: 11933.8898; train_edge_recon_loss: 2612836.2165; train_gene_expr_recon_loss: 1177403.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3802173.1610; train_optim_loss: 3802173.1610; val_kl_reg_loss: 11929.1440; val_edge_recon_loss: 2663965.8947; val_gene_expr_recon_loss: 1171453.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847348.6546; val_optim_loss: 3847348.6546
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9689; val_auprc_score: 0.9608; val_best_acc_score: 0.9178; val_best_f1_score: 0.9211; train_kl_reg_loss: 11970.2677; train_edge_recon_loss: 2610221.6879; train_gene_expr_recon_loss: 1163433.3153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3785625.2735; train_optim_loss: 3785625.2735; val_kl_reg_loss: 11625.5387; val_edge_recon_loss: 2668483.6283; val_gene_expr_recon_loss: 1159040.7648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3839149.9375; val_optim_loss: 3839149.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9679; val_auprc_score: 0.9585; val_best_acc_score: 0.9181; val_best_f1_score: 0.9212; train_kl_reg_loss: 12034.0295; train_edge_recon_loss: 2607482.8813; train_gene_expr_recon_loss: 1152796.5107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3772313.4151; train_optim_loss: 3772313.4151; val_kl_reg_loss: 11822.9183; val_edge_recon_loss: 2663837.1447; val_gene_expr_recon_loss: 1153766.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3829426.6546; val_optim_loss: 3829426.6546
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9700; val_auprc_score: 0.9614; val_best_acc_score: 0.9204; val_best_f1_score: 0.9235; train_kl_reg_loss: 12084.5431; train_edge_recon_loss: 2606237.6309; train_gene_expr_recon_loss: 1147200.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3765522.3206; train_optim_loss: 3765522.3206; val_kl_reg_loss: 11889.9441; val_edge_recon_loss: 2663784.9836; val_gene_expr_recon_loss: 1149055.0888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3824730.0099; val_optim_loss: 3824730.0099
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9726; val_auprc_score: 0.9652; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 12089.4670; train_edge_recon_loss: 2602750.7544; train_gene_expr_recon_loss: 1143263.7289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3758103.9504; train_optim_loss: 3758103.9504; val_kl_reg_loss: 12072.3874; val_edge_recon_loss: 2659205.3816; val_gene_expr_recon_loss: 1143828.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3815106.4474; val_optim_loss: 3815106.4474
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9733; val_auprc_score: 0.9661; val_best_acc_score: 0.9250; val_best_f1_score: 0.9279; train_kl_reg_loss: 12107.5133; train_edge_recon_loss: 2603990.4871; train_gene_expr_recon_loss: 1139849.0077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3755947.0081; train_optim_loss: 3755947.0081; val_kl_reg_loss: 12699.3773; val_edge_recon_loss: 2654329.9507; val_gene_expr_recon_loss: 1144941.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3811971.1941; val_optim_loss: 3811971.1941
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9721; val_auprc_score: 0.9644; val_best_acc_score: 0.9249; val_best_f1_score: 0.9272; train_kl_reg_loss: 12179.0865; train_edge_recon_loss: 2602962.7864; train_gene_expr_recon_loss: 1137358.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3752500.0206; train_optim_loss: 3752500.0206; val_kl_reg_loss: 12019.4805; val_edge_recon_loss: 2658727.6612; val_gene_expr_recon_loss: 1137824.9334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3808572.0789; val_optim_loss: 3808572.0789
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9720; val_auprc_score: 0.9636; val_best_acc_score: 0.9255; val_best_f1_score: 0.9277; train_kl_reg_loss: 12146.0864; train_edge_recon_loss: 2600968.2687; train_gene_expr_recon_loss: 1135857.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3748971.9441; train_optim_loss: 3748971.9441; val_kl_reg_loss: 11657.3787; val_edge_recon_loss: 2657968.0296; val_gene_expr_recon_loss: 1149828.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3819454.3125; val_optim_loss: 3819454.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9751; val_auprc_score: 0.9684; val_best_acc_score: 0.9273; val_best_f1_score: 0.9294; train_kl_reg_loss: 12170.9734; train_edge_recon_loss: 2601858.8798; train_gene_expr_recon_loss: 1134067.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3748097.6434; train_optim_loss: 3748097.6434; val_kl_reg_loss: 12127.7407; val_edge_recon_loss: 2657802.3224; val_gene_expr_recon_loss: 1137307.2730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3807237.3651; val_optim_loss: 3807237.3651
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9738; val_auprc_score: 0.9671; val_best_acc_score: 0.9262; val_best_f1_score: 0.9287; train_kl_reg_loss: 12179.5530; train_edge_recon_loss: 2599772.5588; train_gene_expr_recon_loss: 1133279.5941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3745231.7055; train_optim_loss: 3745231.7055; val_kl_reg_loss: 11861.7861; val_edge_recon_loss: 2651231.0625; val_gene_expr_recon_loss: 1136691.2961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3799784.1414; val_optim_loss: 3799784.1414
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9734; val_auprc_score: 0.9655; val_best_acc_score: 0.9270; val_best_f1_score: 0.9295; train_kl_reg_loss: 12191.4227; train_edge_recon_loss: 2598648.5673; train_gene_expr_recon_loss: 1132578.2272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3743418.2173; train_optim_loss: 3743418.2173; val_kl_reg_loss: 11914.5652; val_edge_recon_loss: 2652567.3553; val_gene_expr_recon_loss: 1138489.1694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3802971.0954; val_optim_loss: 3802971.0954
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9737; val_auprc_score: 0.9662; val_best_acc_score: 0.9278; val_best_f1_score: 0.9297; train_kl_reg_loss: 12180.9885; train_edge_recon_loss: 2599794.2324; train_gene_expr_recon_loss: 1131495.8651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3743471.0901; train_optim_loss: 3743471.0901; val_kl_reg_loss: 11901.8905; val_edge_recon_loss: 2651663.6678; val_gene_expr_recon_loss: 1136368.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3799934.0329; val_optim_loss: 3799934.0329
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9734; val_auprc_score: 0.9658; val_best_acc_score: 0.9276; val_best_f1_score: 0.9299; train_kl_reg_loss: 12198.7218; train_edge_recon_loss: 2599058.5482; train_gene_expr_recon_loss: 1130851.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3742108.8522; train_optim_loss: 3742108.8522; val_kl_reg_loss: 12033.9061; val_edge_recon_loss: 2655396.4770; val_gene_expr_recon_loss: 1135109.3076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3802539.7039; val_optim_loss: 3802539.7039
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9736; val_auprc_score: 0.9660; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 12202.0634; train_edge_recon_loss: 2597108.7853; train_gene_expr_recon_loss: 1131206.8050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3740517.6585; train_optim_loss: 3740517.6585; val_kl_reg_loss: 11980.5085; val_edge_recon_loss: 2654626.0691; val_gene_expr_recon_loss: 1135136.2319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3801742.8059; val_optim_loss: 3801742.8059

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9751; val_auprc_score: 0.9674; val_best_acc_score: 0.9300; val_best_f1_score: 0.9321; train_kl_reg_loss: 12309.9785; train_edge_recon_loss: 2596666.8794; train_gene_expr_recon_loss: 1120113.1866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3729090.0430; train_optim_loss: 3729090.0430; val_kl_reg_loss: 11937.9575; val_edge_recon_loss: 2643011.3026; val_gene_expr_recon_loss: 1125504.6711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3780453.9013; val_optim_loss: 3780453.9013
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9747; val_auprc_score: 0.9674; val_best_acc_score: 0.9290; val_best_f1_score: 0.9310; train_kl_reg_loss: 12163.9823; train_edge_recon_loss: 2594568.1239; train_gene_expr_recon_loss: 1119032.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3725765.0151; train_optim_loss: 3725765.0151; val_kl_reg_loss: 11924.9091; val_edge_recon_loss: 2651388.2599; val_gene_expr_recon_loss: 1122853.9803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3786167.1447; val_optim_loss: 3786167.1447
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9750; val_auprc_score: 0.9672; val_best_acc_score: 0.9290; val_best_f1_score: 0.9312; train_kl_reg_loss: 12114.8932; train_edge_recon_loss: 2593814.4426; train_gene_expr_recon_loss: 1118576.1239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3724505.4544; train_optim_loss: 3724505.4544; val_kl_reg_loss: 11833.5483; val_edge_recon_loss: 2649349.0428; val_gene_expr_recon_loss: 1127016.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3788198.6118; val_optim_loss: 3788198.6118
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9752; val_auprc_score: 0.9685; val_best_acc_score: 0.9294; val_best_f1_score: 0.9316; train_kl_reg_loss: 12093.6709; train_edge_recon_loss: 2594773.6838; train_gene_expr_recon_loss: 1118386.0188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3725253.3746; train_optim_loss: 3725253.3746; val_kl_reg_loss: 11819.8199; val_edge_recon_loss: 2652008.6283; val_gene_expr_recon_loss: 1123513.3997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3787341.8355; val_optim_loss: 3787341.8355
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9758; val_auprc_score: 0.9692; val_best_acc_score: 0.9302; val_best_f1_score: 0.9324; train_kl_reg_loss: 12088.7437; train_edge_recon_loss: 2594758.1960; train_gene_expr_recon_loss: 1118495.8820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3725342.8243; train_optim_loss: 3725342.8243; val_kl_reg_loss: 11779.5536; val_edge_recon_loss: 2645603.9901; val_gene_expr_recon_loss: 1125253.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3782636.6447; val_optim_loss: 3782636.6447

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9762; val_auprc_score: 0.9694; val_best_acc_score: 0.9314; val_best_f1_score: 0.9332; train_kl_reg_loss: 12089.5584; train_edge_recon_loss: 2594784.3831; train_gene_expr_recon_loss: 1117061.4276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3723935.3739; train_optim_loss: 3723935.3739; val_kl_reg_loss: 11880.6847; val_edge_recon_loss: 2643540.7961; val_gene_expr_recon_loss: 1123012.4984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3778433.9901; val_optim_loss: 3778433.9901
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9752; val_auprc_score: 0.9680; val_best_acc_score: 0.9296; val_best_f1_score: 0.9315; train_kl_reg_loss: 12115.9734; train_edge_recon_loss: 2596024.0673; train_gene_expr_recon_loss: 1117061.7072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3725201.7489; train_optim_loss: 3725201.7489; val_kl_reg_loss: 11877.5881; val_edge_recon_loss: 2646860.6711; val_gene_expr_recon_loss: 1122607.0033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781345.2829; val_optim_loss: 3781345.2829
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9751; val_auprc_score: 0.9683; val_best_acc_score: 0.9287; val_best_f1_score: 0.9308; train_kl_reg_loss: 12115.7665; train_edge_recon_loss: 2593282.2257; train_gene_expr_recon_loss: 1116622.3570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722020.3485; train_optim_loss: 3722020.3485; val_kl_reg_loss: 11859.0057; val_edge_recon_loss: 2651566.4079; val_gene_expr_recon_loss: 1120889.0107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3784314.4079; val_optim_loss: 3784314.4079
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9761; val_auprc_score: 0.9694; val_best_acc_score: 0.9307; val_best_f1_score: 0.9327; train_kl_reg_loss: 12108.8059; train_edge_recon_loss: 2592922.2393; train_gene_expr_recon_loss: 1116640.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3721671.9346; train_optim_loss: 3721671.9346; val_kl_reg_loss: 11845.1183; val_edge_recon_loss: 2643163.3026; val_gene_expr_recon_loss: 1121857.5896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3776866.0033; val_optim_loss: 3776866.0033
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9752; val_auprc_score: 0.9680; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 12097.4297; train_edge_recon_loss: 2593497.5180; train_gene_expr_recon_loss: 1116839.0640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722434.0099; train_optim_loss: 3722434.0099; val_kl_reg_loss: 11853.8892; val_edge_recon_loss: 2647844.6184; val_gene_expr_recon_loss: 1122094.4046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781792.9408; val_optim_loss: 3781792.9408
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9758; val_auprc_score: 0.9692; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 12102.8481; train_edge_recon_loss: 2593849.3430; train_gene_expr_recon_loss: 1116414.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722366.3103; train_optim_loss: 3722366.3103; val_kl_reg_loss: 11869.3965; val_edge_recon_loss: 2648481.7007; val_gene_expr_recon_loss: 1122896.0905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783247.1974; val_optim_loss: 3783247.1974
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9757; val_auprc_score: 0.9685; val_best_acc_score: 0.9305; val_best_f1_score: 0.9321; train_kl_reg_loss: 12104.8125; train_edge_recon_loss: 2593874.2327; train_gene_expr_recon_loss: 1115973.3548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3721952.4033; train_optim_loss: 3721952.4033; val_kl_reg_loss: 11853.3700; val_edge_recon_loss: 2647773.7401; val_gene_expr_recon_loss: 1123865.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783492.1678; val_optim_loss: 3783492.1678
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9751; val_auprc_score: 0.9683; val_best_acc_score: 0.9286; val_best_f1_score: 0.9307; train_kl_reg_loss: 12100.9474; train_edge_recon_loss: 2596158.5893; train_gene_expr_recon_loss: 1116083.4197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3724342.9496; train_optim_loss: 3724342.9496; val_kl_reg_loss: 11861.2038; val_edge_recon_loss: 2651022.4671; val_gene_expr_recon_loss: 1125724.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3788608.0757; val_optim_loss: 3788608.0757

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9756; val_auprc_score: 0.9686; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 12105.0673; train_edge_recon_loss: 2592514.3132; train_gene_expr_recon_loss: 1116143.2866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3720762.6676; train_optim_loss: 3720762.6676; val_kl_reg_loss: 11856.8610; val_edge_recon_loss: 2644860.8026; val_gene_expr_recon_loss: 1121022.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3777740.0822; val_optim_loss: 3777740.0822
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9756; val_auprc_score: 0.9686; val_best_acc_score: 0.9294; val_best_f1_score: 0.9314; train_kl_reg_loss: 12105.4681; train_edge_recon_loss: 2593459.0467; train_gene_expr_recon_loss: 1116877.8509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722442.3603; train_optim_loss: 3722442.3603; val_kl_reg_loss: 11867.2786; val_edge_recon_loss: 2646990.8684; val_gene_expr_recon_loss: 1122333.5740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781191.7368; val_optim_loss: 3781191.7368
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9748; val_auprc_score: 0.9672; val_best_acc_score: 0.9296; val_best_f1_score: 0.9314; train_kl_reg_loss: 12107.0254; train_edge_recon_loss: 2593567.6121; train_gene_expr_recon_loss: 1116679.1048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722353.7382; train_optim_loss: 3722353.7382; val_kl_reg_loss: 11858.6001; val_edge_recon_loss: 2650027.7632; val_gene_expr_recon_loss: 1121227.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3783113.3882; val_optim_loss: 3783113.3882
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9752; val_auprc_score: 0.9681; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 12108.8283; train_edge_recon_loss: 2594040.0191; train_gene_expr_recon_loss: 1116566.2404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3722715.0934; train_optim_loss: 3722715.0934; val_kl_reg_loss: 11864.4729; val_edge_recon_loss: 2647440.5132; val_gene_expr_recon_loss: 1122581.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3781885.9967; val_optim_loss: 3781885.9967

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 58 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9763
Val AUPRC score: 0.9698
Val best accuracy score: 0.9303
Val best F1 score: 0.9323
Val gene expr MSE score: 2.6654

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
