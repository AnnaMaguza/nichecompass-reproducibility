None
Run timestamp: 24072023_201318_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9829; val_auprc_score: 0.9777; val_best_acc_score: 0.9455; val_best_f1_score: 0.9469; train_kl_reg_loss: 97358.0327; train_edge_recon_loss: 26823409.0376; train_gene_expr_recon_loss: 11706766.4423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38627533.5132; train_optim_loss: 38627533.5132; val_kl_reg_loss: 114841.7318; val_edge_recon_loss: 26120262.2750; val_gene_expr_recon_loss: 10857015.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37092120.0500; val_optim_loss: 37092120.0500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9856; val_auprc_score: 0.9810; val_best_acc_score: 0.9509; val_best_f1_score: 0.9520; train_kl_reg_loss: 106826.0700; train_edge_recon_loss: 25990262.4451; train_gene_expr_recon_loss: 10530295.7163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36627384.1558; train_optim_loss: 36627384.1558; val_kl_reg_loss: 100268.4706; val_edge_recon_loss: 25996461.7750; val_gene_expr_recon_loss: 10462026.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36558756.7500; val_optim_loss: 36558756.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9848; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 91819.9176; train_edge_recon_loss: 25893582.3115; train_gene_expr_recon_loss: 10243740.4117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36229142.6759; train_optim_loss: 36229142.6759; val_kl_reg_loss: 88829.7139; val_edge_recon_loss: 25849695.5000; val_gene_expr_recon_loss: 10242142.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36180668.1000; val_optim_loss: 36180668.1000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9890; val_auprc_score: 0.9857; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 85899.2425; train_edge_recon_loss: 25797115.3630; train_gene_expr_recon_loss: 10079234.5744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35962249.2573; train_optim_loss: 35962249.2573; val_kl_reg_loss: 81843.3036; val_edge_recon_loss: 25830371.1500; val_gene_expr_recon_loss: 10118524.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36030738.9500; val_optim_loss: 36030738.9500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9906; val_auprc_score: 0.9878; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 79456.3807; train_edge_recon_loss: 25752744.9235; train_gene_expr_recon_loss: 9965152.4771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35797353.6912; train_optim_loss: 35797353.6912; val_kl_reg_loss: 76561.2953; val_edge_recon_loss: 25772010.3000; val_gene_expr_recon_loss: 10008555.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35857127.1500; val_optim_loss: 35857127.1500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9883; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 74373.1283; train_edge_recon_loss: 25721302.5563; train_gene_expr_recon_loss: 9877548.2601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35673223.9277; train_optim_loss: 35673223.9277; val_kl_reg_loss: 72431.4128; val_edge_recon_loss: 25738623.2000; val_gene_expr_recon_loss: 9947312.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35758367.0500; val_optim_loss: 35758367.0500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9905; val_auprc_score: 0.9875; val_best_acc_score: 0.9651; val_best_f1_score: 0.9657; train_kl_reg_loss: 66189.6789; train_edge_recon_loss: 25706340.3004; train_gene_expr_recon_loss: 9858084.6231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35630614.6370; train_optim_loss: 35630614.6370; val_kl_reg_loss: 67981.7083; val_edge_recon_loss: 25750463.7250; val_gene_expr_recon_loss: 9933508.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35751953.9000; val_optim_loss: 35751953.9000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9682; val_best_f1_score: 0.9689; train_kl_reg_loss: 66667.4533; train_edge_recon_loss: 25676208.3727; train_gene_expr_recon_loss: 9773791.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35516666.8373; train_optim_loss: 35516666.8373; val_kl_reg_loss: 64915.1645; val_edge_recon_loss: 25708349.6750; val_gene_expr_recon_loss: 9888528.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35661793.2000; val_optim_loss: 35661793.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 64701.5393; train_edge_recon_loss: 25651233.0431; train_gene_expr_recon_loss: 9722268.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35438203.1266; train_optim_loss: 35438203.1266; val_kl_reg_loss: 63140.6782; val_edge_recon_loss: 25687423.3250; val_gene_expr_recon_loss: 9827962.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35578526.5500; val_optim_loss: 35578526.5500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9925; val_auprc_score: 0.9904; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 62335.7219; train_edge_recon_loss: 25644122.6648; train_gene_expr_recon_loss: 9690842.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35397301.0515; train_optim_loss: 35397301.0515; val_kl_reg_loss: 60186.7285; val_edge_recon_loss: 25687741.5500; val_gene_expr_recon_loss: 9811498.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35559426.6500; val_optim_loss: 35559426.6500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9928; val_auprc_score: 0.9906; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 61029.5129; train_edge_recon_loss: 25622047.6384; train_gene_expr_recon_loss: 9653330.1001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35336407.3102; train_optim_loss: 35336407.3102; val_kl_reg_loss: 60067.5963; val_edge_recon_loss: 25685172.5000; val_gene_expr_recon_loss: 9801281.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35546521.9000; val_optim_loss: 35546521.9000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9910; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 59724.7098; train_edge_recon_loss: 25621670.8484; train_gene_expr_recon_loss: 9637911.6905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35319307.1822; train_optim_loss: 35319307.1822; val_kl_reg_loss: 58631.2378; val_edge_recon_loss: 25641265.7250; val_gene_expr_recon_loss: 9789302.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35489199.0000; val_optim_loss: 35489199.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 58869.3969; train_edge_recon_loss: 25606118.5786; train_gene_expr_recon_loss: 9600379.9166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35265367.7942; train_optim_loss: 35265367.7942; val_kl_reg_loss: 56962.7532; val_edge_recon_loss: 25631560.5750; val_gene_expr_recon_loss: 9760092.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35448615.5000; val_optim_loss: 35448615.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 57536.9231; train_edge_recon_loss: 25597058.6314; train_gene_expr_recon_loss: 9580292.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35234888.4729; train_optim_loss: 35234888.4729; val_kl_reg_loss: 57394.0600; val_edge_recon_loss: 25618534.8250; val_gene_expr_recon_loss: 9731370.0125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35407299.0500; val_optim_loss: 35407299.0500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 57215.9822; train_edge_recon_loss: 25590216.3143; train_gene_expr_recon_loss: 9555317.6732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35202749.9249; train_optim_loss: 35202749.9249; val_kl_reg_loss: 56242.7282; val_edge_recon_loss: 25612850.9000; val_gene_expr_recon_loss: 9716188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385281.4500; val_optim_loss: 35385281.4500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 56475.0683; train_edge_recon_loss: 25585417.9221; train_gene_expr_recon_loss: 9543573.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35185466.5591; train_optim_loss: 35185466.5591; val_kl_reg_loss: 56011.3060; val_edge_recon_loss: 25598168.3000; val_gene_expr_recon_loss: 9739249.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35393428.7000; val_optim_loss: 35393428.7000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 55930.6398; train_edge_recon_loss: 25579661.5327; train_gene_expr_recon_loss: 9519734.9263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35155327.1099; train_optim_loss: 35155327.1099; val_kl_reg_loss: 55310.0318; val_edge_recon_loss: 25612531.5750; val_gene_expr_recon_loss: 9717316.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385157.6500; val_optim_loss: 35385157.6500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 55069.3937; train_edge_recon_loss: 25573779.1071; train_gene_expr_recon_loss: 9502494.4520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35131342.9708; train_optim_loss: 35131342.9708; val_kl_reg_loss: 54023.0799; val_edge_recon_loss: 25613553.0000; val_gene_expr_recon_loss: 9707355.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35374931.9500; val_optim_loss: 35374931.9500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 54711.2715; train_edge_recon_loss: 25564181.5828; train_gene_expr_recon_loss: 9488376.9416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35107269.7524; train_optim_loss: 35107269.7524; val_kl_reg_loss: 53613.9851; val_edge_recon_loss: 25619073.8250; val_gene_expr_recon_loss: 9730033.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35402721.7000; val_optim_loss: 35402721.7000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9770; val_best_f1_score: 0.9774; train_kl_reg_loss: 54466.5423; train_edge_recon_loss: 25552558.6203; train_gene_expr_recon_loss: 9479672.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35086697.3741; train_optim_loss: 35086697.3741; val_kl_reg_loss: 53027.1751; val_edge_recon_loss: 25586283.9250; val_gene_expr_recon_loss: 9723508.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35362819.9500; val_optim_loss: 35362819.9500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 54120.0288; train_edge_recon_loss: 25555677.2406; train_gene_expr_recon_loss: 9458224.4478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35068021.7135; train_optim_loss: 35068021.7135; val_kl_reg_loss: 54144.3396; val_edge_recon_loss: 25588905.8750; val_gene_expr_recon_loss: 9668689.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35311739.2000; val_optim_loss: 35311739.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 54025.8020; train_edge_recon_loss: 25547797.5382; train_gene_expr_recon_loss: 9438469.2218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35040292.5814; train_optim_loss: 35040292.5814; val_kl_reg_loss: 52748.7511; val_edge_recon_loss: 25571003.0500; val_gene_expr_recon_loss: 9656968.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280720.7000; val_optim_loss: 35280720.7000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 53235.3272; train_edge_recon_loss: 25547772.8540; train_gene_expr_recon_loss: 9434466.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35035474.4590; train_optim_loss: 35035474.4590; val_kl_reg_loss: 52888.4444; val_edge_recon_loss: 25589465.9250; val_gene_expr_recon_loss: 9675522.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35317877.5000; val_optim_loss: 35317877.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 53294.0519; train_edge_recon_loss: 25539649.3352; train_gene_expr_recon_loss: 9429773.3957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35022716.7121; train_optim_loss: 35022716.7121; val_kl_reg_loss: 53709.8973; val_edge_recon_loss: 25578444.2000; val_gene_expr_recon_loss: 9682081.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35314235.6500; val_optim_loss: 35314235.6500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 52803.5227; train_edge_recon_loss: 25546520.5257; train_gene_expr_recon_loss: 9417668.8039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35016992.8567; train_optim_loss: 35016992.8567; val_kl_reg_loss: 52261.9414; val_edge_recon_loss: 25564737.3250; val_gene_expr_recon_loss: 9683363.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35300363.2000; val_optim_loss: 35300363.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 52757.6740; train_edge_recon_loss: 25536658.0167; train_gene_expr_recon_loss: 9407481.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34996896.9068; train_optim_loss: 34996896.9068; val_kl_reg_loss: 52348.6856; val_edge_recon_loss: 25577384.0750; val_gene_expr_recon_loss: 9691572.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35321305.3000; val_optim_loss: 35321305.3000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 55103.3925; train_edge_recon_loss: 25526942.8512; train_gene_expr_recon_loss: 9328159.1008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34910205.2907; train_optim_loss: 34910205.2907; val_kl_reg_loss: 55604.6773; val_edge_recon_loss: 25561919.2000; val_gene_expr_recon_loss: 9643613.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35261137.0500; val_optim_loss: 35261137.0500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 56759.3994; train_edge_recon_loss: 25520215.5299; train_gene_expr_recon_loss: 9307998.2782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34884973.2072; train_optim_loss: 34884973.2072; val_kl_reg_loss: 56614.9656; val_edge_recon_loss: 25561831.0000; val_gene_expr_recon_loss: 9626296.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35244742.1500; val_optim_loss: 35244742.1500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 57386.4385; train_edge_recon_loss: 25522216.3700; train_gene_expr_recon_loss: 9308297.5056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34887900.3449; train_optim_loss: 34887900.3449; val_kl_reg_loss: 56892.1729; val_edge_recon_loss: 25539859.3500; val_gene_expr_recon_loss: 9615257.4125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35212008.9000; val_optim_loss: 35212008.9000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 57558.6958; train_edge_recon_loss: 25522454.5508; train_gene_expr_recon_loss: 9309029.5362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34889042.7705; train_optim_loss: 34889042.7705; val_kl_reg_loss: 57164.8519; val_edge_recon_loss: 25534656.5500; val_gene_expr_recon_loss: 9644930.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35236751.6500; val_optim_loss: 35236751.6500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 57721.9446; train_edge_recon_loss: 25516946.6314; train_gene_expr_recon_loss: 9299226.3060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34873894.8261; train_optim_loss: 34873894.8261; val_kl_reg_loss: 57343.0162; val_edge_recon_loss: 25573090.5500; val_gene_expr_recon_loss: 9609850.1375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240283.7000; val_optim_loss: 35240283.7000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 57917.2790; train_edge_recon_loss: 25515501.6189; train_gene_expr_recon_loss: 9294776.1391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34868194.9764; train_optim_loss: 34868194.9764; val_kl_reg_loss: 57321.0185; val_edge_recon_loss: 25543664.7000; val_gene_expr_recon_loss: 9618911.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35219897.0500; val_optim_loss: 35219897.0500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 58104.9495; train_edge_recon_loss: 25520055.8248; train_gene_expr_recon_loss: 9291360.5542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34869521.3519; train_optim_loss: 34869521.3519; val_kl_reg_loss: 57592.1010; val_edge_recon_loss: 25554891.7250; val_gene_expr_recon_loss: 9579876.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35192360.2500; val_optim_loss: 35192360.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 58085.8713; train_edge_recon_loss: 25519240.9903; train_gene_expr_recon_loss: 9286646.4179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34863973.3074; train_optim_loss: 34863973.3074; val_kl_reg_loss: 57222.5525; val_edge_recon_loss: 25560936.7000; val_gene_expr_recon_loss: 9627675.4125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35245834.6500; val_optim_loss: 35245834.6500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 57910.8210; train_edge_recon_loss: 25520717.3324; train_gene_expr_recon_loss: 9291134.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34869762.5146; train_optim_loss: 34869762.5146; val_kl_reg_loss: 57092.2753; val_edge_recon_loss: 25547031.7750; val_gene_expr_recon_loss: 9572107.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35176231.3000; val_optim_loss: 35176231.3000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 58035.3523; train_edge_recon_loss: 25512959.5271; train_gene_expr_recon_loss: 9281840.0459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34852834.8929; train_optim_loss: 34852834.8929; val_kl_reg_loss: 57690.8927; val_edge_recon_loss: 25562588.7500; val_gene_expr_recon_loss: 9615457.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35235737.4500; val_optim_loss: 35235737.4500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 58407.8751; train_edge_recon_loss: 25508122.3505; train_gene_expr_recon_loss: 9279472.8401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34846003.0209; train_optim_loss: 34846003.0209; val_kl_reg_loss: 57772.6705; val_edge_recon_loss: 25554782.7750; val_gene_expr_recon_loss: 9586099.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35198655.4500; val_optim_loss: 35198655.4500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 58151.9999; train_edge_recon_loss: 25521947.5605; train_gene_expr_recon_loss: 9284936.3665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34865035.9110; train_optim_loss: 34865035.9110; val_kl_reg_loss: 57744.9449; val_edge_recon_loss: 25542968.5750; val_gene_expr_recon_loss: 9583916.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35184629.6000; val_optim_loss: 35184629.6000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 58347.4168; train_edge_recon_loss: 25512690.9513; train_gene_expr_recon_loss: 9286258.8484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34857297.1516; train_optim_loss: 34857297.1516; val_kl_reg_loss: 57424.3127; val_edge_recon_loss: 25543733.0250; val_gene_expr_recon_loss: 9598670.4125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35199827.5500; val_optim_loss: 35199827.5500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 58174.9950; train_edge_recon_loss: 25517898.8261; train_gene_expr_recon_loss: 9271263.8811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34847337.6801; train_optim_loss: 34847337.6801; val_kl_reg_loss: 57636.1440; val_edge_recon_loss: 25543692.3000; val_gene_expr_recon_loss: 9595905.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35197234.0000; val_optim_loss: 35197234.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 58348.8388; train_edge_recon_loss: 25506416.7844; train_gene_expr_recon_loss: 9274164.2524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34838929.9193; train_optim_loss: 34838929.9193; val_kl_reg_loss: 57650.5788; val_edge_recon_loss: 25532827.3750; val_gene_expr_recon_loss: 9605542.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35196020.6500; val_optim_loss: 35196020.6500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 58358.9664; train_edge_recon_loss: 25517368.1530; train_gene_expr_recon_loss: 9268433.4033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844160.5063; train_optim_loss: 34844160.5063; val_kl_reg_loss: 57735.1260; val_edge_recon_loss: 25539308.2000; val_gene_expr_recon_loss: 9598702.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35195745.2000; val_optim_loss: 35195745.2000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 58401.1795; train_edge_recon_loss: 25514559.5160; train_gene_expr_recon_loss: 9271117.5487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34844078.2476; train_optim_loss: 34844078.2476; val_kl_reg_loss: 57616.9465; val_edge_recon_loss: 25572767.9500; val_gene_expr_recon_loss: 9623156.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35253541.3500; val_optim_loss: 35253541.3500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 207 min 0 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9943
Val best accuracy score: 0.9793
Val best F1 score: 0.9795
Val gene expr MSE score: 0.6578

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
