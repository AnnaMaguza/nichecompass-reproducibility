None
Run timestamp: 07072023_000112_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9937; val_auprc_score: 0.9936; val_best_acc_score: 0.9608; val_best_f1_score: 0.9609; train_kl_reg_loss: 2472.3477; train_edge_recon_loss: 28050.8491; train_gene_expr_recon_loss: 14857.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45381.1675; train_optim_loss: 45381.1675; val_kl_reg_loss: 2455.5952; val_edge_recon_loss: 26644.9632; val_gene_expr_recon_loss: 13653.7268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42754.2851; val_optim_loss: 42754.2851
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9959; val_auprc_score: 0.9956; val_best_acc_score: 0.9699; val_best_f1_score: 0.9699; train_kl_reg_loss: 2627.4262; train_edge_recon_loss: 27464.1120; train_gene_expr_recon_loss: 13533.3752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43624.9135; train_optim_loss: 43624.9135; val_kl_reg_loss: 2680.8801; val_edge_recon_loss: 26466.9464; val_gene_expr_recon_loss: 13225.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42373.7944; val_optim_loss: 42373.7944
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9713; val_best_f1_score: 0.9713; train_kl_reg_loss: 2665.3536; train_edge_recon_loss: 27333.5816; train_gene_expr_recon_loss: 13297.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43296.4131; train_optim_loss: 43296.4131; val_kl_reg_loss: 2672.2687; val_edge_recon_loss: 26337.1539; val_gene_expr_recon_loss: 13085.0450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42094.4676; val_optim_loss: 42094.4676
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 2683.4826; train_edge_recon_loss: 27254.7667; train_gene_expr_recon_loss: 13201.0135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43139.2628; train_optim_loss: 43139.2628; val_kl_reg_loss: 2652.1836; val_edge_recon_loss: 26268.8340; val_gene_expr_recon_loss: 13032.3574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41953.3750; val_optim_loss: 41953.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2694.1614; train_edge_recon_loss: 27216.6701; train_gene_expr_recon_loss: 13143.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43054.2409; train_optim_loss: 43054.2409; val_kl_reg_loss: 2653.4613; val_edge_recon_loss: 26240.0133; val_gene_expr_recon_loss: 13059.9388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41953.4135; val_optim_loss: 41953.4135
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9768; val_best_f1_score: 0.9768; train_kl_reg_loss: 2702.5851; train_edge_recon_loss: 27182.1512; train_gene_expr_recon_loss: 13094.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42979.2375; train_optim_loss: 42979.2375; val_kl_reg_loss: 2636.5354; val_edge_recon_loss: 26211.7238; val_gene_expr_recon_loss: 12895.7370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41743.9961; val_optim_loss: 41743.9961
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 2707.1221; train_edge_recon_loss: 27161.3656; train_gene_expr_recon_loss: 13057.9592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42926.4469; train_optim_loss: 42926.4469; val_kl_reg_loss: 2743.3505; val_edge_recon_loss: 26191.6217; val_gene_expr_recon_loss: 15098.0520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44033.0242; val_optim_loss: 44033.0242
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9777; val_best_f1_score: 0.9777; train_kl_reg_loss: 2712.8243; train_edge_recon_loss: 27133.9633; train_gene_expr_recon_loss: 12595.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42442.7524; train_optim_loss: 42442.7524; val_kl_reg_loss: 2649.9898; val_edge_recon_loss: 26149.8845; val_gene_expr_recon_loss: 12223.4541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41023.3285; val_optim_loss: 41023.3285
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 2718.2517; train_edge_recon_loss: 27117.7217; train_gene_expr_recon_loss: 11501.7050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41337.6784; train_optim_loss: 41337.6784; val_kl_reg_loss: 2773.4625; val_edge_recon_loss: 26127.5136; val_gene_expr_recon_loss: 10941.6800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39842.6560; val_optim_loss: 39842.6560
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 2721.1788; train_edge_recon_loss: 27110.4891; train_gene_expr_recon_loss: 11137.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40969.3154; train_optim_loss: 40969.3154; val_kl_reg_loss: 2688.6091; val_edge_recon_loss: 26112.1895; val_gene_expr_recon_loss: 11053.9445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39854.7429; val_optim_loss: 39854.7429
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9978; val_auprc_score: 0.9977; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 2725.3544; train_edge_recon_loss: 27091.9169; train_gene_expr_recon_loss: 11043.7534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40861.0248; train_optim_loss: 40861.0248; val_kl_reg_loss: 2768.3804; val_edge_recon_loss: 26122.7555; val_gene_expr_recon_loss: 11112.1126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40003.2486; val_optim_loss: 40003.2486
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2727.4208; train_edge_recon_loss: 27087.8837; train_gene_expr_recon_loss: 11017.5105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40832.8149; train_optim_loss: 40832.8149; val_kl_reg_loss: 2719.7220; val_edge_recon_loss: 26106.7500; val_gene_expr_recon_loss: 10919.0487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39745.5207; val_optim_loss: 39745.5207
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2731.4825; train_edge_recon_loss: 27079.1097; train_gene_expr_recon_loss: 10989.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40799.8722; train_optim_loss: 40799.8722; val_kl_reg_loss: 2743.3634; val_edge_recon_loss: 26085.6825; val_gene_expr_recon_loss: 10898.6889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39727.7348; val_optim_loss: 39727.7348
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 2735.3114; train_edge_recon_loss: 27068.3126; train_gene_expr_recon_loss: 10983.9503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40787.5743; train_optim_loss: 40787.5743; val_kl_reg_loss: 2691.2098; val_edge_recon_loss: 26060.5935; val_gene_expr_recon_loss: 10908.0548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39659.8582; val_optim_loss: 39659.8582
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 2738.7214; train_edge_recon_loss: 27061.3050; train_gene_expr_recon_loss: 10977.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40777.8928; train_optim_loss: 40777.8928; val_kl_reg_loss: 2696.4758; val_edge_recon_loss: 26099.7097; val_gene_expr_recon_loss: 10906.1537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39702.3393; val_optim_loss: 39702.3393
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 2741.4408; train_edge_recon_loss: 27053.3301; train_gene_expr_recon_loss: 10981.6717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40776.4427; train_optim_loss: 40776.4427; val_kl_reg_loss: 2703.8485; val_edge_recon_loss: 26064.7150; val_gene_expr_recon_loss: 10912.2114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39680.7750; val_optim_loss: 39680.7750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 2744.5195; train_edge_recon_loss: 27044.7858; train_gene_expr_recon_loss: 10977.5153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40766.8207; train_optim_loss: 40766.8207; val_kl_reg_loss: 2733.1390; val_edge_recon_loss: 26033.7042; val_gene_expr_recon_loss: 10904.0869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39670.9299; val_optim_loss: 39670.9299
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9819; val_best_f1_score: 0.9819; train_kl_reg_loss: 2747.0668; train_edge_recon_loss: 27036.1288; train_gene_expr_recon_loss: 10954.2353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40737.4310; train_optim_loss: 40737.4310; val_kl_reg_loss: 2758.4585; val_edge_recon_loss: 26047.7483; val_gene_expr_recon_loss: 10897.3811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39703.5880; val_optim_loss: 39703.5880

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 2747.0991; train_edge_recon_loss: 27006.6527; train_gene_expr_recon_loss: 10891.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40645.2968; train_optim_loss: 40645.2968; val_kl_reg_loss: 2733.2368; val_edge_recon_loss: 26009.5952; val_gene_expr_recon_loss: 10848.4603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39591.2922; val_optim_loss: 39591.2922
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9839; val_best_f1_score: 0.9839; train_kl_reg_loss: 2742.6568; train_edge_recon_loss: 27002.9916; train_gene_expr_recon_loss: 10881.6235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40627.2719; train_optim_loss: 40627.2719; val_kl_reg_loss: 2729.6264; val_edge_recon_loss: 26024.1142; val_gene_expr_recon_loss: 10830.8277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39584.5682; val_optim_loss: 39584.5682
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9839; val_best_f1_score: 0.9839; train_kl_reg_loss: 2741.5778; train_edge_recon_loss: 27005.0646; train_gene_expr_recon_loss: 10874.4770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40621.1194; train_optim_loss: 40621.1194; val_kl_reg_loss: 2736.4796; val_edge_recon_loss: 26007.9536; val_gene_expr_recon_loss: 10822.6530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39567.0861; val_optim_loss: 39567.0861
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 2740.7708; train_edge_recon_loss: 27004.3129; train_gene_expr_recon_loss: 10869.5587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40614.6424; train_optim_loss: 40614.6424; val_kl_reg_loss: 2719.4527; val_edge_recon_loss: 26010.4126; val_gene_expr_recon_loss: 10822.5382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39552.4035; val_optim_loss: 39552.4035
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9846; val_best_f1_score: 0.9846; train_kl_reg_loss: 2741.2845; train_edge_recon_loss: 27000.1736; train_gene_expr_recon_loss: 10870.6648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40612.1229; train_optim_loss: 40612.1229; val_kl_reg_loss: 2742.7175; val_edge_recon_loss: 25993.7800; val_gene_expr_recon_loss: 10815.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39551.5846; val_optim_loss: 39551.5846
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 2740.7874; train_edge_recon_loss: 27004.1706; train_gene_expr_recon_loss: 10868.6957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40613.6537; train_optim_loss: 40613.6537; val_kl_reg_loss: 2718.6518; val_edge_recon_loss: 26007.8554; val_gene_expr_recon_loss: 10823.4292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39549.9364; val_optim_loss: 39549.9364
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9844; val_best_f1_score: 0.9844; train_kl_reg_loss: 2741.3713; train_edge_recon_loss: 27000.2940; train_gene_expr_recon_loss: 10861.9889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40603.6541; train_optim_loss: 40603.6541; val_kl_reg_loss: 2735.4234; val_edge_recon_loss: 26003.9000; val_gene_expr_recon_loss: 10833.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39572.6006; val_optim_loss: 39572.6006
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 2742.5156; train_edge_recon_loss: 26992.9561; train_gene_expr_recon_loss: 10862.3943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40597.8660; train_optim_loss: 40597.8660; val_kl_reg_loss: 2724.8639; val_edge_recon_loss: 25996.3375; val_gene_expr_recon_loss: 10819.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39541.0025; val_optim_loss: 39541.0025
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9843; val_best_f1_score: 0.9843; train_kl_reg_loss: 2742.2068; train_edge_recon_loss: 26995.9764; train_gene_expr_recon_loss: 10863.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40602.1383; train_optim_loss: 40602.1383; val_kl_reg_loss: 2723.9185; val_edge_recon_loss: 26013.3710; val_gene_expr_recon_loss: 10817.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39555.1814; val_optim_loss: 39555.1814
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9845; val_best_f1_score: 0.9845; train_kl_reg_loss: 2742.7016; train_edge_recon_loss: 26993.1453; train_gene_expr_recon_loss: 10863.0767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40598.9235; train_optim_loss: 40598.9235; val_kl_reg_loss: 2739.6537; val_edge_recon_loss: 26002.0626; val_gene_expr_recon_loss: 10834.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39576.6439; val_optim_loss: 39576.6439
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9852; val_best_f1_score: 0.9852; train_kl_reg_loss: 2742.7829; train_edge_recon_loss: 26993.9562; train_gene_expr_recon_loss: 10861.2381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40597.9771; train_optim_loss: 40597.9771; val_kl_reg_loss: 2731.6225; val_edge_recon_loss: 25996.1920; val_gene_expr_recon_loss: 10818.9815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39546.7960; val_optim_loss: 39546.7960
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9848; val_best_f1_score: 0.9848; train_kl_reg_loss: 2742.1106; train_edge_recon_loss: 26998.7503; train_gene_expr_recon_loss: 10858.0329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40598.8938; train_optim_loss: 40598.8938; val_kl_reg_loss: 2730.5739; val_edge_recon_loss: 26009.2556; val_gene_expr_recon_loss: 10822.7936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39562.6231; val_optim_loss: 39562.6231

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 2743.7741; train_edge_recon_loss: 26986.0200; train_gene_expr_recon_loss: 10856.2976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40586.0916; train_optim_loss: 40586.0916; val_kl_reg_loss: 2738.3139; val_edge_recon_loss: 25993.6225; val_gene_expr_recon_loss: 10803.9857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39535.9221; val_optim_loss: 39535.9221
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 2744.1182; train_edge_recon_loss: 26985.4899; train_gene_expr_recon_loss: 10849.7887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.3968; train_optim_loss: 40579.3968; val_kl_reg_loss: 2734.2174; val_edge_recon_loss: 26023.2457; val_gene_expr_recon_loss: 10820.5624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39578.0256; val_optim_loss: 39578.0256
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9851; val_best_f1_score: 0.9851; train_kl_reg_loss: 2743.8915; train_edge_recon_loss: 26985.5571; train_gene_expr_recon_loss: 10851.8298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40581.2783; train_optim_loss: 40581.2783; val_kl_reg_loss: 2737.8623; val_edge_recon_loss: 25997.2130; val_gene_expr_recon_loss: 10802.4571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39537.5324; val_optim_loss: 39537.5324
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2742.9708; train_edge_recon_loss: 26990.7912; train_gene_expr_recon_loss: 10854.9781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40588.7401; train_optim_loss: 40588.7401; val_kl_reg_loss: 2732.8184; val_edge_recon_loss: 26010.0169; val_gene_expr_recon_loss: 10825.4387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39568.2740; val_optim_loss: 39568.2740
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2743.6848; train_edge_recon_loss: 26986.4069; train_gene_expr_recon_loss: 10850.8683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40580.9600; train_optim_loss: 40580.9600; val_kl_reg_loss: 2735.3072; val_edge_recon_loss: 25981.5943; val_gene_expr_recon_loss: 10815.6971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39532.5986; val_optim_loss: 39532.5986
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9852; val_best_f1_score: 0.9852; train_kl_reg_loss: 2743.1528; train_edge_recon_loss: 26986.1360; train_gene_expr_recon_loss: 10850.3882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.6770; train_optim_loss: 40579.6770; val_kl_reg_loss: 2731.2359; val_edge_recon_loss: 25989.1540; val_gene_expr_recon_loss: 10801.3042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39521.6941; val_optim_loss: 39521.6941
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 2742.4161; train_edge_recon_loss: 26990.4445; train_gene_expr_recon_loss: 10854.6860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40587.5467; train_optim_loss: 40587.5467; val_kl_reg_loss: 2733.9173; val_edge_recon_loss: 26011.0201; val_gene_expr_recon_loss: 10805.8363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39550.7736; val_optim_loss: 39550.7736
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9853; val_best_f1_score: 0.9853; train_kl_reg_loss: 2742.7247; train_edge_recon_loss: 26988.2858; train_gene_expr_recon_loss: 10845.8491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40576.8595; train_optim_loss: 40576.8595; val_kl_reg_loss: 2736.4456; val_edge_recon_loss: 25981.0850; val_gene_expr_recon_loss: 10810.3543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39527.8850; val_optim_loss: 39527.8850
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2743.0817; train_edge_recon_loss: 26986.2927; train_gene_expr_recon_loss: 10849.7331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.1075; train_optim_loss: 40579.1075; val_kl_reg_loss: 2738.4142; val_edge_recon_loss: 25986.8865; val_gene_expr_recon_loss: 10806.1687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39531.4693; val_optim_loss: 39531.4693
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 2742.7549; train_edge_recon_loss: 26985.8122; train_gene_expr_recon_loss: 10849.8824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40578.4495; train_optim_loss: 40578.4495; val_kl_reg_loss: 2740.0247; val_edge_recon_loss: 25995.1574; val_gene_expr_recon_loss: 10809.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39545.0364; val_optim_loss: 39545.0364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 2743.8025; train_edge_recon_loss: 26986.2063; train_gene_expr_recon_loss: 10849.1783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.1871; train_optim_loss: 40579.1871; val_kl_reg_loss: 2735.8382; val_edge_recon_loss: 25989.5498; val_gene_expr_recon_loss: 10819.7883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39545.1764; val_optim_loss: 39545.1764
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9848; val_best_f1_score: 0.9848; train_kl_reg_loss: 2742.6510; train_edge_recon_loss: 26989.7955; train_gene_expr_recon_loss: 10847.4528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.8992; train_optim_loss: 40579.8992; val_kl_reg_loss: 2736.4604; val_edge_recon_loss: 26006.1468; val_gene_expr_recon_loss: 10810.7108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39553.3181; val_optim_loss: 39553.3181
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 2743.7573; train_edge_recon_loss: 26981.2586; train_gene_expr_recon_loss: 10845.9300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40570.9459; train_optim_loss: 40570.9459; val_kl_reg_loss: 2736.1098; val_edge_recon_loss: 25989.8157; val_gene_expr_recon_loss: 10820.3744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39546.3000; val_optim_loss: 39546.3000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2743.2637; train_edge_recon_loss: 26986.0496; train_gene_expr_recon_loss: 10847.1716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40576.4849; train_optim_loss: 40576.4849; val_kl_reg_loss: 2735.7381; val_edge_recon_loss: 25986.2803; val_gene_expr_recon_loss: 10800.9852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39523.0036; val_optim_loss: 39523.0036

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 781 min 16 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9987
Val AUPRC score: 0.9985
Val best accuracy score: 0.9847
Val best F1 score: 0.9848
Val gene expr MSE score: 8.7491

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
