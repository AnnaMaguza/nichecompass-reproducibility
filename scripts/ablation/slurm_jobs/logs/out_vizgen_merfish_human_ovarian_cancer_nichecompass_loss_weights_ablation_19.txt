None
Run timestamp: 30062023_220551_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9921; val_auprc_score: 0.9920; val_best_acc_score: 0.9551; val_best_f1_score: 0.9552; train_kl_reg_loss: 2426.6671; train_edge_recon_loss: 28351.5764; train_gene_expr_recon_loss: 15811.0866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46589.3301; train_optim_loss: 46589.3301; val_kl_reg_loss: 2501.8504; val_edge_recon_loss: 26871.1344; val_gene_expr_recon_loss: 14250.2170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43623.2018; val_optim_loss: 43623.2018
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9952; val_auprc_score: 0.9950; val_best_acc_score: 0.9660; val_best_f1_score: 0.9660; train_kl_reg_loss: 2587.0624; train_edge_recon_loss: 27635.9002; train_gene_expr_recon_loss: 14023.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44246.3928; train_optim_loss: 44246.3928; val_kl_reg_loss: 2586.3350; val_edge_recon_loss: 26619.5157; val_gene_expr_recon_loss: 13570.4709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42776.3216; val_optim_loss: 42776.3216
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 2629.8143; train_edge_recon_loss: 27469.7539; train_gene_expr_recon_loss: 13584.2799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43683.8481; train_optim_loss: 43683.8481; val_kl_reg_loss: 2638.1183; val_edge_recon_loss: 26514.1543; val_gene_expr_recon_loss: 13274.3082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42426.5809; val_optim_loss: 42426.5809
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 2657.7482; train_edge_recon_loss: 27374.9420; train_gene_expr_recon_loss: 13372.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43405.0127; train_optim_loss: 43405.0127; val_kl_reg_loss: 2557.0021; val_edge_recon_loss: 26394.9150; val_gene_expr_recon_loss: 13144.9832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42096.9001; val_optim_loss: 42096.9001
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9750; val_best_f1_score: 0.9750; train_kl_reg_loss: 2678.1745; train_edge_recon_loss: 27307.9955; train_gene_expr_recon_loss: 13265.4960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43251.6660; train_optim_loss: 43251.6660; val_kl_reg_loss: 2665.0330; val_edge_recon_loss: 26367.8261; val_gene_expr_recon_loss: 13051.3417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42084.2006; val_optim_loss: 42084.2006
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 2689.9573; train_edge_recon_loss: 27260.3051; train_gene_expr_recon_loss: 13187.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43137.5768; train_optim_loss: 43137.5768; val_kl_reg_loss: 2647.7669; val_edge_recon_loss: 26280.4474; val_gene_expr_recon_loss: 13015.4153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41943.6296; val_optim_loss: 41943.6296
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 2697.4311; train_edge_recon_loss: 27229.5138; train_gene_expr_recon_loss: 13140.3302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43067.2751; train_optim_loss: 43067.2751; val_kl_reg_loss: 2663.0296; val_edge_recon_loss: 26257.8149; val_gene_expr_recon_loss: 12973.5578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41894.4023; val_optim_loss: 41894.4023
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9771; val_best_f1_score: 0.9771; train_kl_reg_loss: 2702.1792; train_edge_recon_loss: 27201.2113; train_gene_expr_recon_loss: 13108.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43011.6178; train_optim_loss: 43011.6178; val_kl_reg_loss: 2639.2445; val_edge_recon_loss: 26254.9765; val_gene_expr_recon_loss: 12960.3079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41854.5287; val_optim_loss: 41854.5287
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9777; val_best_f1_score: 0.9777; train_kl_reg_loss: 2705.8752; train_edge_recon_loss: 27181.4856; train_gene_expr_recon_loss: 13081.7388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42969.0996; train_optim_loss: 42969.0996; val_kl_reg_loss: 2692.7607; val_edge_recon_loss: 26209.3257; val_gene_expr_recon_loss: 12931.4789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41833.5653; val_optim_loss: 41833.5653
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9794; val_best_f1_score: 0.9794; train_kl_reg_loss: 2708.9736; train_edge_recon_loss: 27169.9113; train_gene_expr_recon_loss: 13063.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42942.3710; train_optim_loss: 42942.3710; val_kl_reg_loss: 2657.1299; val_edge_recon_loss: 26172.6403; val_gene_expr_recon_loss: 12933.9673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41763.7377; val_optim_loss: 41763.7377
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9792; val_best_f1_score: 0.9792; train_kl_reg_loss: 2715.5412; train_edge_recon_loss: 27146.6391; train_gene_expr_recon_loss: 13051.9218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42914.1021; train_optim_loss: 42914.1021; val_kl_reg_loss: 2656.5604; val_edge_recon_loss: 26153.5681; val_gene_expr_recon_loss: 12928.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41738.8479; val_optim_loss: 41738.8479
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9795; val_best_f1_score: 0.9795; train_kl_reg_loss: 2718.0131; train_edge_recon_loss: 27141.1545; train_gene_expr_recon_loss: 13031.2492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42890.4168; train_optim_loss: 42890.4168; val_kl_reg_loss: 2686.5665; val_edge_recon_loss: 26149.7596; val_gene_expr_recon_loss: 12906.7265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41743.0527; val_optim_loss: 41743.0527
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2722.3957; train_edge_recon_loss: 27124.6379; train_gene_expr_recon_loss: 13024.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42871.6121; train_optim_loss: 42871.6121; val_kl_reg_loss: 2680.5897; val_edge_recon_loss: 26138.9479; val_gene_expr_recon_loss: 12883.8294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41703.3671; val_optim_loss: 41703.3671
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9981; val_auprc_score: 0.9980; val_best_acc_score: 0.9806; val_best_f1_score: 0.9806; train_kl_reg_loss: 2726.4414; train_edge_recon_loss: 27117.1607; train_gene_expr_recon_loss: 13015.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42859.4301; train_optim_loss: 42859.4301; val_kl_reg_loss: 2732.1991; val_edge_recon_loss: 26132.9878; val_gene_expr_recon_loss: 12879.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41744.2448; val_optim_loss: 41744.2448
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2729.6286; train_edge_recon_loss: 27109.1660; train_gene_expr_recon_loss: 13009.7702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42848.5648; train_optim_loss: 42848.5648; val_kl_reg_loss: 2730.5246; val_edge_recon_loss: 26127.5537; val_gene_expr_recon_loss: 12876.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41734.5431; val_optim_loss: 41734.5431
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9981; val_auprc_score: 0.9980; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 2733.1968; train_edge_recon_loss: 27100.0754; train_gene_expr_recon_loss: 13001.3807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42834.6529; train_optim_loss: 42834.6529; val_kl_reg_loss: 2674.7298; val_edge_recon_loss: 26089.3617; val_gene_expr_recon_loss: 12863.9723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41628.0638; val_optim_loss: 41628.0638
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 2735.3064; train_edge_recon_loss: 27093.9271; train_gene_expr_recon_loss: 12994.8038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42824.0372; train_optim_loss: 42824.0372; val_kl_reg_loss: 2702.5290; val_edge_recon_loss: 26092.5043; val_gene_expr_recon_loss: 12881.6124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41676.6457; val_optim_loss: 41676.6457
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 2736.7591; train_edge_recon_loss: 27093.7360; train_gene_expr_recon_loss: 12985.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42816.1077; train_optim_loss: 42816.1077; val_kl_reg_loss: 2752.9343; val_edge_recon_loss: 26134.6905; val_gene_expr_recon_loss: 12856.5174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41744.1424; val_optim_loss: 41744.1424
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 2739.7624; train_edge_recon_loss: 27080.4678; train_gene_expr_recon_loss: 12985.8337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42806.0639; train_optim_loss: 42806.0639; val_kl_reg_loss: 2699.1862; val_edge_recon_loss: 26117.0404; val_gene_expr_recon_loss: 12835.7185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41651.9453; val_optim_loss: 41651.9453
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9819; val_best_f1_score: 0.9819; train_kl_reg_loss: 2742.4478; train_edge_recon_loss: 27068.2429; train_gene_expr_recon_loss: 12981.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42792.5355; train_optim_loss: 42792.5355; val_kl_reg_loss: 2755.9457; val_edge_recon_loss: 26085.0471; val_gene_expr_recon_loss: 12858.5931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41699.5860; val_optim_loss: 41699.5860

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9833; val_best_f1_score: 0.9833; train_kl_reg_loss: 2746.1208; train_edge_recon_loss: 27036.8372; train_gene_expr_recon_loss: 12927.0452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42710.0032; train_optim_loss: 42710.0032; val_kl_reg_loss: 2733.2586; val_edge_recon_loss: 26035.5898; val_gene_expr_recon_loss: 12825.1059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41593.9543; val_optim_loss: 41593.9543
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9833; val_best_f1_score: 0.9833; train_kl_reg_loss: 2742.0328; train_edge_recon_loss: 27040.4221; train_gene_expr_recon_loss: 12915.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42698.1717; train_optim_loss: 42698.1717; val_kl_reg_loss: 2731.2187; val_edge_recon_loss: 26049.2632; val_gene_expr_recon_loss: 12818.4226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41598.9045; val_optim_loss: 41598.9045
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9829; val_best_f1_score: 0.9829; train_kl_reg_loss: 2741.9259; train_edge_recon_loss: 27035.8755; train_gene_expr_recon_loss: 12914.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42692.6213; train_optim_loss: 42692.6213; val_kl_reg_loss: 2711.4715; val_edge_recon_loss: 26047.6089; val_gene_expr_recon_loss: 12800.2929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41559.3734; val_optim_loss: 41559.3734
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 2741.9905; train_edge_recon_loss: 27034.3938; train_gene_expr_recon_loss: 12906.5220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42682.9062; train_optim_loss: 42682.9062; val_kl_reg_loss: 2734.8207; val_edge_recon_loss: 26047.3640; val_gene_expr_recon_loss: 12797.3583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41579.5431; val_optim_loss: 41579.5431
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 2740.8705; train_edge_recon_loss: 27040.5975; train_gene_expr_recon_loss: 12904.3682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42685.8362; train_optim_loss: 42685.8362; val_kl_reg_loss: 2708.8554; val_edge_recon_loss: 26067.7881; val_gene_expr_recon_loss: 12810.0528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41586.6963; val_optim_loss: 41586.6963
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 2740.7516; train_edge_recon_loss: 27042.2140; train_gene_expr_recon_loss: 12901.9742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42684.9398; train_optim_loss: 42684.9398; val_kl_reg_loss: 2701.8334; val_edge_recon_loss: 26047.2873; val_gene_expr_recon_loss: 12807.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41556.7821; val_optim_loss: 41556.7821
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9835; val_best_f1_score: 0.9835; train_kl_reg_loss: 2741.5207; train_edge_recon_loss: 27038.6216; train_gene_expr_recon_loss: 12904.9690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42685.1114; train_optim_loss: 42685.1114; val_kl_reg_loss: 2719.3116; val_edge_recon_loss: 26062.7693; val_gene_expr_recon_loss: 12808.0426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41590.1236; val_optim_loss: 41590.1236
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 2742.1671; train_edge_recon_loss: 27035.2042; train_gene_expr_recon_loss: 12899.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42677.2652; train_optim_loss: 42677.2652; val_kl_reg_loss: 2718.6144; val_edge_recon_loss: 26033.5612; val_gene_expr_recon_loss: 12797.6046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41549.7803; val_optim_loss: 41549.7803
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9838; val_best_f1_score: 0.9838; train_kl_reg_loss: 2743.3264; train_edge_recon_loss: 27029.2911; train_gene_expr_recon_loss: 12902.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42675.0115; train_optim_loss: 42675.0115; val_kl_reg_loss: 2725.5932; val_edge_recon_loss: 26056.6939; val_gene_expr_recon_loss: 12803.0582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41585.3454; val_optim_loss: 41585.3454
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 2743.2860; train_edge_recon_loss: 27030.2692; train_gene_expr_recon_loss: 12894.2011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42667.7563; train_optim_loss: 42667.7563; val_kl_reg_loss: 2703.9651; val_edge_recon_loss: 26061.9725; val_gene_expr_recon_loss: 12797.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41563.9365; val_optim_loss: 41563.9365
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 2743.8182; train_edge_recon_loss: 27027.5761; train_gene_expr_recon_loss: 12898.0560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42669.4504; train_optim_loss: 42669.4504; val_kl_reg_loss: 2711.4007; val_edge_recon_loss: 26073.0034; val_gene_expr_recon_loss: 12808.7196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41593.1237; val_optim_loss: 41593.1237
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 2743.4775; train_edge_recon_loss: 27032.2433; train_gene_expr_recon_loss: 12896.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42672.1903; train_optim_loss: 42672.1903; val_kl_reg_loss: 2745.3453; val_edge_recon_loss: 26052.6148; val_gene_expr_recon_loss: 12794.4830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41592.4431; val_optim_loss: 41592.4431

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 2744.4062; train_edge_recon_loss: 27026.0213; train_gene_expr_recon_loss: 12888.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42658.9542; train_optim_loss: 42658.9542; val_kl_reg_loss: 2737.2331; val_edge_recon_loss: 26031.0097; val_gene_expr_recon_loss: 12784.8541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41553.0969; val_optim_loss: 41553.0969
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9841; val_best_f1_score: 0.9841; train_kl_reg_loss: 2744.1004; train_edge_recon_loss: 27027.3277; train_gene_expr_recon_loss: 12891.5839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42663.0119; train_optim_loss: 42663.0119; val_kl_reg_loss: 2734.1239; val_edge_recon_loss: 26055.7209; val_gene_expr_recon_loss: 12803.2294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41593.0741; val_optim_loss: 41593.0741
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 2744.8182; train_edge_recon_loss: 27021.5639; train_gene_expr_recon_loss: 12885.4594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42651.8414; train_optim_loss: 42651.8414; val_kl_reg_loss: 2730.5745; val_edge_recon_loss: 26050.3979; val_gene_expr_recon_loss: 12784.3147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41565.2871; val_optim_loss: 41565.2871
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 2744.3742; train_edge_recon_loss: 27023.4769; train_gene_expr_recon_loss: 12888.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42656.1542; train_optim_loss: 42656.1542; val_kl_reg_loss: 2732.6361; val_edge_recon_loss: 26048.3357; val_gene_expr_recon_loss: 12799.6269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41580.5987; val_optim_loss: 41580.5987

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 557 min 29 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9984
Val best accuracy score: 0.9834
Val best F1 score: 0.9834
Val gene expr MSE score: 8.6655

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
