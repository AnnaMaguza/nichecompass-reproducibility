None
Run timestamp: 06072023_012419_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9938; val_auprc_score: 0.9937; val_best_acc_score: 0.9611; val_best_f1_score: 0.9613; train_kl_reg_loss: 2488.6888; train_edge_recon_loss: 28065.4551; train_gene_expr_recon_loss: 14920.5782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45474.7221; train_optim_loss: 45474.7221; val_kl_reg_loss: 2578.2620; val_edge_recon_loss: 26693.5275; val_gene_expr_recon_loss: 13498.4793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42770.2685; val_optim_loss: 42770.2685
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9697; val_best_f1_score: 0.9698; train_kl_reg_loss: 2624.6803; train_edge_recon_loss: 27462.8577; train_gene_expr_recon_loss: 13444.0754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43531.6135; train_optim_loss: 43531.6135; val_kl_reg_loss: 2573.6390; val_edge_recon_loss: 26467.5291; val_gene_expr_recon_loss: 13089.5792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42130.7474; val_optim_loss: 42130.7474
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9967; val_auprc_score: 0.9963; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 2662.1452; train_edge_recon_loss: 27317.8360; train_gene_expr_recon_loss: 13187.6237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43167.6050; train_optim_loss: 43167.6050; val_kl_reg_loss: 2647.5195; val_edge_recon_loss: 26363.3054; val_gene_expr_recon_loss: 12962.9397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41973.7647; val_optim_loss: 41973.7647
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 2680.2306; train_edge_recon_loss: 27250.8952; train_gene_expr_recon_loss: 13079.9958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43011.1216; train_optim_loss: 43011.1216; val_kl_reg_loss: 2659.7724; val_edge_recon_loss: 26258.5680; val_gene_expr_recon_loss: 12894.8569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41813.1972; val_optim_loss: 41813.1972
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 2695.8127; train_edge_recon_loss: 27199.7569; train_gene_expr_recon_loss: 13027.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42923.3463; train_optim_loss: 42923.3463; val_kl_reg_loss: 2678.9642; val_edge_recon_loss: 26216.6374; val_gene_expr_recon_loss: 12941.6787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41837.2803; val_optim_loss: 41837.2803
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9772; val_best_f1_score: 0.9772; train_kl_reg_loss: 2706.8279; train_edge_recon_loss: 27166.3113; train_gene_expr_recon_loss: 12970.1906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42843.3299; train_optim_loss: 42843.3299; val_kl_reg_loss: 2586.8591; val_edge_recon_loss: 26189.4037; val_gene_expr_recon_loss: 12964.0514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41740.3141; val_optim_loss: 41740.3141
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 2711.7812; train_edge_recon_loss: 27146.6727; train_gene_expr_recon_loss: 12848.6501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42707.1039; train_optim_loss: 42707.1039; val_kl_reg_loss: 2664.4290; val_edge_recon_loss: 26139.3985; val_gene_expr_recon_loss: 11758.6436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40562.4709; val_optim_loss: 40562.4709
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 2714.9097; train_edge_recon_loss: 27128.4967; train_gene_expr_recon_loss: 12447.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42290.8342; train_optim_loss: 42290.8342; val_kl_reg_loss: 2662.8944; val_edge_recon_loss: 26144.0304; val_gene_expr_recon_loss: 11980.9484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40787.8732; val_optim_loss: 40787.8732
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2721.6623; train_edge_recon_loss: 27109.1684; train_gene_expr_recon_loss: 11783.8497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41614.6803; train_optim_loss: 41614.6803; val_kl_reg_loss: 2708.2965; val_edge_recon_loss: 26144.0918; val_gene_expr_recon_loss: 11360.0825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40212.4708; val_optim_loss: 40212.4708
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9799; val_best_f1_score: 0.9799; train_kl_reg_loss: 2726.0274; train_edge_recon_loss: 27091.2762; train_gene_expr_recon_loss: 11121.8230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40939.1266; train_optim_loss: 40939.1266; val_kl_reg_loss: 2745.6307; val_edge_recon_loss: 26109.1927; val_gene_expr_recon_loss: 10869.6782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39724.5015; val_optim_loss: 39724.5015
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9801; val_best_f1_score: 0.9801; train_kl_reg_loss: 2728.1769; train_edge_recon_loss: 27086.9058; train_gene_expr_recon_loss: 10926.9339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40742.0167; train_optim_loss: 40742.0167; val_kl_reg_loss: 2744.7073; val_edge_recon_loss: 26128.4293; val_gene_expr_recon_loss: 10883.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39756.9087; val_optim_loss: 39756.9087
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9981; val_auprc_score: 0.9980; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 2729.7958; train_edge_recon_loss: 27072.9975; train_gene_expr_recon_loss: 10902.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40705.0736; train_optim_loss: 40705.0736; val_kl_reg_loss: 2731.4192; val_edge_recon_loss: 26108.3962; val_gene_expr_recon_loss: 10810.2086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39650.0241; val_optim_loss: 39650.0241
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 2729.1453; train_edge_recon_loss: 27065.4436; train_gene_expr_recon_loss: 10882.3210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40676.9098; train_optim_loss: 40676.9098; val_kl_reg_loss: 2683.1140; val_edge_recon_loss: 26076.8812; val_gene_expr_recon_loss: 10805.9064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39565.9016; val_optim_loss: 39565.9016
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 2727.4219; train_edge_recon_loss: 27058.9368; train_gene_expr_recon_loss: 10879.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40666.1557; train_optim_loss: 40666.1557; val_kl_reg_loss: 2696.4465; val_edge_recon_loss: 26042.5916; val_gene_expr_recon_loss: 10922.2479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39661.2860; val_optim_loss: 39661.2860
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9812; val_best_f1_score: 0.9812; train_kl_reg_loss: 2730.2946; train_edge_recon_loss: 27049.6560; train_gene_expr_recon_loss: 10854.9893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40634.9399; train_optim_loss: 40634.9399; val_kl_reg_loss: 2710.3351; val_edge_recon_loss: 26073.5283; val_gene_expr_recon_loss: 10733.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39517.2748; val_optim_loss: 39517.2748
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9982; val_auprc_score: 0.9981; val_best_acc_score: 0.9816; val_best_f1_score: 0.9816; train_kl_reg_loss: 2732.8562; train_edge_recon_loss: 27041.9315; train_gene_expr_recon_loss: 10843.9033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40618.6909; train_optim_loss: 40618.6909; val_kl_reg_loss: 2681.1735; val_edge_recon_loss: 26060.3976; val_gene_expr_recon_loss: 10702.9824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39444.5536; val_optim_loss: 39444.5536
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9810; val_best_f1_score: 0.9810; train_kl_reg_loss: 2735.9987; train_edge_recon_loss: 27036.3944; train_gene_expr_recon_loss: 10846.7093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40619.1024; train_optim_loss: 40619.1024; val_kl_reg_loss: 2716.7731; val_edge_recon_loss: 26095.8503; val_gene_expr_recon_loss: 10734.7717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39547.3952; val_optim_loss: 39547.3952
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 2738.0072; train_edge_recon_loss: 27033.4210; train_gene_expr_recon_loss: 10819.8137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40591.2419; train_optim_loss: 40591.2419; val_kl_reg_loss: 2743.3202; val_edge_recon_loss: 26051.2865; val_gene_expr_recon_loss: 10721.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39516.3196; val_optim_loss: 39516.3196
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 2741.0956; train_edge_recon_loss: 27027.8127; train_gene_expr_recon_loss: 10815.4879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40584.3962; train_optim_loss: 40584.3962; val_kl_reg_loss: 2716.1862; val_edge_recon_loss: 26037.7487; val_gene_expr_recon_loss: 10706.3919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39460.3267; val_optim_loss: 39460.3267
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9826; val_best_f1_score: 0.9826; train_kl_reg_loss: 2743.6383; train_edge_recon_loss: 27022.9826; train_gene_expr_recon_loss: 10813.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.8273; train_optim_loss: 40579.8273; val_kl_reg_loss: 2728.3968; val_edge_recon_loss: 26042.9496; val_gene_expr_recon_loss: 10705.7685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39477.1150; val_optim_loss: 39477.1150

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 2745.5709; train_edge_recon_loss: 26985.9730; train_gene_expr_recon_loss: 10758.2925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40489.8365; train_optim_loss: 40489.8365; val_kl_reg_loss: 2736.2819; val_edge_recon_loss: 26009.3504; val_gene_expr_recon_loss: 10672.0057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39417.6380; val_optim_loss: 39417.6380
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 2743.9307; train_edge_recon_loss: 26982.7143; train_gene_expr_recon_loss: 10751.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40477.7521; train_optim_loss: 40477.7521; val_kl_reg_loss: 2726.3715; val_edge_recon_loss: 26003.9306; val_gene_expr_recon_loss: 10649.0819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39379.3839; val_optim_loss: 39379.3839
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9842; val_best_f1_score: 0.9842; train_kl_reg_loss: 2743.0659; train_edge_recon_loss: 26982.9376; train_gene_expr_recon_loss: 10747.6657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40473.6692; train_optim_loss: 40473.6692; val_kl_reg_loss: 2741.2712; val_edge_recon_loss: 26013.5061; val_gene_expr_recon_loss: 10691.9256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39446.7029; val_optim_loss: 39446.7029
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2743.9932; train_edge_recon_loss: 26974.6838; train_gene_expr_recon_loss: 10745.5609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40464.2378; train_optim_loss: 40464.2378; val_kl_reg_loss: 2764.9231; val_edge_recon_loss: 26003.3920; val_gene_expr_recon_loss: 10640.4832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39408.7984; val_optim_loss: 39408.7984
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2743.8438; train_edge_recon_loss: 26974.1224; train_gene_expr_recon_loss: 10746.6070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40464.5731; train_optim_loss: 40464.5731; val_kl_reg_loss: 2733.3459; val_edge_recon_loss: 26011.2574; val_gene_expr_recon_loss: 10660.9952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39405.5984; val_optim_loss: 39405.5984
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9845; val_best_f1_score: 0.9845; train_kl_reg_loss: 2741.9050; train_edge_recon_loss: 26984.5752; train_gene_expr_recon_loss: 10737.2671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40463.7473; train_optim_loss: 40463.7473; val_kl_reg_loss: 2719.4255; val_edge_recon_loss: 26016.2280; val_gene_expr_recon_loss: 10664.3230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39399.9766; val_optim_loss: 39399.9766

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2742.4575; train_edge_recon_loss: 26976.8078; train_gene_expr_recon_loss: 10733.9836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40453.2489; train_optim_loss: 40453.2489; val_kl_reg_loss: 2737.3192; val_edge_recon_loss: 25990.8830; val_gene_expr_recon_loss: 10662.9487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39391.1510; val_optim_loss: 39391.1510
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 2743.7776; train_edge_recon_loss: 26970.4526; train_gene_expr_recon_loss: 10734.9588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40449.1889; train_optim_loss: 40449.1889; val_kl_reg_loss: 2733.8653; val_edge_recon_loss: 26010.0202; val_gene_expr_recon_loss: 10675.6379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39419.5234; val_optim_loss: 39419.5234
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9846; val_best_f1_score: 0.9846; train_kl_reg_loss: 2743.7535; train_edge_recon_loss: 26969.9594; train_gene_expr_recon_loss: 10735.5746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40449.2874; train_optim_loss: 40449.2874; val_kl_reg_loss: 2742.5955; val_edge_recon_loss: 25994.6302; val_gene_expr_recon_loss: 10656.7151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39393.9407; val_optim_loss: 39393.9407
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 2742.8646; train_edge_recon_loss: 26975.3433; train_gene_expr_recon_loss: 10731.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40450.1413; train_optim_loss: 40450.1413; val_kl_reg_loss: 2743.0157; val_edge_recon_loss: 26004.6585; val_gene_expr_recon_loss: 10661.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39409.2395; val_optim_loss: 39409.2395

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 469 min 9 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9987
Val AUPRC score: 0.9986
Val best accuracy score: 0.9845
Val best F1 score: 0.9845
Val gene expr MSE score: 8.6095

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
