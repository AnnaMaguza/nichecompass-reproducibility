None
Run timestamp: 13072023_075023_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9691; val_auprc_score: 0.9561; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 7395.7743; train_edge_recon_loss: 277349.7021; train_gene_expr_recon_loss: 134631.0896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419376.5669; train_optim_loss: 419376.5669; val_kl_reg_loss: 7862.9923; val_edge_recon_loss: 265535.0923; val_gene_expr_recon_loss: 120743.3842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394141.4673; val_optim_loss: 394141.4673
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9731; val_auprc_score: 0.9604; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 7844.1141; train_edge_recon_loss: 262978.1787; train_gene_expr_recon_loss: 115492.0628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386314.3545; train_optim_loss: 386314.3545; val_kl_reg_loss: 7438.5578; val_edge_recon_loss: 265363.0760; val_gene_expr_recon_loss: 111758.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384560.1960; val_optim_loss: 384560.1960
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9772; val_auprc_score: 0.9669; val_best_acc_score: 0.9425; val_best_f1_score: 0.9441; train_kl_reg_loss: 7424.6368; train_edge_recon_loss: 262061.5340; train_gene_expr_recon_loss: 110329.9341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379816.1047; train_optim_loss: 379816.1047; val_kl_reg_loss: 7066.7349; val_edge_recon_loss: 263238.7472; val_gene_expr_recon_loss: 108430.0753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378735.5526; val_optim_loss: 378735.5526
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9805; val_auprc_score: 0.9727; val_best_acc_score: 0.9493; val_best_f1_score: 0.9507; train_kl_reg_loss: 7219.7951; train_edge_recon_loss: 261321.9125; train_gene_expr_recon_loss: 107354.1550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375895.8621; train_optim_loss: 375895.8621; val_kl_reg_loss: 7044.5902; val_edge_recon_loss: 262891.3949; val_gene_expr_recon_loss: 105854.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375790.6364; val_optim_loss: 375790.6364
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9813; val_auprc_score: 0.9735; val_best_acc_score: 0.9514; val_best_f1_score: 0.9525; train_kl_reg_loss: 7084.6759; train_edge_recon_loss: 260921.1667; train_gene_expr_recon_loss: 105079.6196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373085.4600; train_optim_loss: 373085.4600; val_kl_reg_loss: 6976.1013; val_edge_recon_loss: 262711.3331; val_gene_expr_recon_loss: 104071.8505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373759.2812; val_optim_loss: 373759.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9812; val_auprc_score: 0.9731; val_best_acc_score: 0.9530; val_best_f1_score: 0.9541; train_kl_reg_loss: 6998.5569; train_edge_recon_loss: 260664.4773; train_gene_expr_recon_loss: 103273.2497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370936.2834; train_optim_loss: 370936.2834; val_kl_reg_loss: 6756.5315; val_edge_recon_loss: 262665.5043; val_gene_expr_recon_loss: 102397.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371819.5142; val_optim_loss: 371819.5142
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9832; val_auprc_score: 0.9763; val_best_acc_score: 0.9545; val_best_f1_score: 0.9556; train_kl_reg_loss: 6929.3749; train_edge_recon_loss: 260386.9047; train_gene_expr_recon_loss: 101609.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368926.2599; train_optim_loss: 368926.2599; val_kl_reg_loss: 6711.2216; val_edge_recon_loss: 262291.8651; val_gene_expr_recon_loss: 101194.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370197.5625; val_optim_loss: 370197.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9822; val_auprc_score: 0.9739; val_best_acc_score: 0.9549; val_best_f1_score: 0.9560; train_kl_reg_loss: 6880.3272; train_edge_recon_loss: 260300.5846; train_gene_expr_recon_loss: 100412.2915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367593.2043; train_optim_loss: 367593.2043; val_kl_reg_loss: 6664.2280; val_edge_recon_loss: 262177.2045; val_gene_expr_recon_loss: 99989.6360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368831.0653; val_optim_loss: 368831.0653
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9836; val_auprc_score: 0.9769; val_best_acc_score: 0.9557; val_best_f1_score: 0.9567; train_kl_reg_loss: 6825.7214; train_edge_recon_loss: 260239.6252; train_gene_expr_recon_loss: 99273.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366338.9100; train_optim_loss: 366338.9100; val_kl_reg_loss: 6724.9921; val_edge_recon_loss: 262249.7138; val_gene_expr_recon_loss: 98869.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367844.4574; val_optim_loss: 367844.4574
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9846; val_auprc_score: 0.9783; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 6816.8229; train_edge_recon_loss: 259864.8761; train_gene_expr_recon_loss: 98209.1254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364890.8250; train_optim_loss: 364890.8250; val_kl_reg_loss: 6562.8879; val_edge_recon_loss: 262067.1207; val_gene_expr_recon_loss: 98270.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366900.6136; val_optim_loss: 366900.6136
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9845; val_auprc_score: 0.9779; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 6792.8227; train_edge_recon_loss: 259746.0149; train_gene_expr_recon_loss: 97307.9806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363846.8179; train_optim_loss: 363846.8179; val_kl_reg_loss: 6645.0818; val_edge_recon_loss: 261392.5589; val_gene_expr_recon_loss: 97706.4144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365744.0540; val_optim_loss: 365744.0540
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9844; val_auprc_score: 0.9778; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 6772.0757; train_edge_recon_loss: 259683.9312; train_gene_expr_recon_loss: 96466.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362922.7507; train_optim_loss: 362922.7507; val_kl_reg_loss: 6659.1970; val_edge_recon_loss: 261352.0156; val_gene_expr_recon_loss: 96728.9936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364740.2088; val_optim_loss: 364740.2088
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9854; val_auprc_score: 0.9793; val_best_acc_score: 0.9595; val_best_f1_score: 0.9606; train_kl_reg_loss: 6755.5235; train_edge_recon_loss: 259586.3205; train_gene_expr_recon_loss: 95754.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362096.1136; train_optim_loss: 362096.1136; val_kl_reg_loss: 6418.8347; val_edge_recon_loss: 261118.6207; val_gene_expr_recon_loss: 96310.3658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363847.8182; val_optim_loss: 363847.8182
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9844; val_auprc_score: 0.9771; val_best_acc_score: 0.9579; val_best_f1_score: 0.9590; train_kl_reg_loss: 6736.4263; train_edge_recon_loss: 259548.3021; train_gene_expr_recon_loss: 95138.7111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361423.4396; train_optim_loss: 361423.4396; val_kl_reg_loss: 6555.8075; val_edge_recon_loss: 261959.2088; val_gene_expr_recon_loss: 95702.1175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364217.1307; val_optim_loss: 364217.1307
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9847; val_auprc_score: 0.9784; val_best_acc_score: 0.9593; val_best_f1_score: 0.9601; train_kl_reg_loss: 6721.7213; train_edge_recon_loss: 259272.5873; train_gene_expr_recon_loss: 94570.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360565.0620; train_optim_loss: 360565.0620; val_kl_reg_loss: 6603.0423; val_edge_recon_loss: 261551.7216; val_gene_expr_recon_loss: 95404.8505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363559.6165; val_optim_loss: 363559.6165
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9854; val_auprc_score: 0.9790; val_best_acc_score: 0.9601; val_best_f1_score: 0.9610; train_kl_reg_loss: 6703.6779; train_edge_recon_loss: 259388.4457; train_gene_expr_recon_loss: 94041.5133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360133.6375; train_optim_loss: 360133.6375; val_kl_reg_loss: 6587.0902; val_edge_recon_loss: 261320.2564; val_gene_expr_recon_loss: 94640.2351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362547.5810; val_optim_loss: 362547.5810
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9860; val_auprc_score: 0.9806; val_best_acc_score: 0.9601; val_best_f1_score: 0.9611; train_kl_reg_loss: 6711.1714; train_edge_recon_loss: 259036.8262; train_gene_expr_recon_loss: 93558.7579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359306.7546; train_optim_loss: 359306.7546; val_kl_reg_loss: 6509.7558; val_edge_recon_loss: 261269.8842; val_gene_expr_recon_loss: 94426.6978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362206.3395; val_optim_loss: 362206.3395
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9865; val_auprc_score: 0.9810; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 6701.8972; train_edge_recon_loss: 259149.0710; train_gene_expr_recon_loss: 93001.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358852.2967; train_optim_loss: 358852.2967; val_kl_reg_loss: 6544.3011; val_edge_recon_loss: 261128.5923; val_gene_expr_recon_loss: 94292.4084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361965.3026; val_optim_loss: 361965.3026
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9857; val_auprc_score: 0.9801; val_best_acc_score: 0.9610; val_best_f1_score: 0.9617; train_kl_reg_loss: 6699.6379; train_edge_recon_loss: 259028.7444; train_gene_expr_recon_loss: 92699.2264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358427.6087; train_optim_loss: 358427.6087; val_kl_reg_loss: 6566.3812; val_edge_recon_loss: 261198.6839; val_gene_expr_recon_loss: 94295.1800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362060.2415; val_optim_loss: 362060.2415
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9854; val_auprc_score: 0.9790; val_best_acc_score: 0.9609; val_best_f1_score: 0.9619; train_kl_reg_loss: 6675.0455; train_edge_recon_loss: 258979.4893; train_gene_expr_recon_loss: 92230.5177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357885.0540; train_optim_loss: 357885.0540; val_kl_reg_loss: 6501.8424; val_edge_recon_loss: 260899.6989; val_gene_expr_recon_loss: 93545.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360947.1307; val_optim_loss: 360947.1307
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9854; val_auprc_score: 0.9799; val_best_acc_score: 0.9610; val_best_f1_score: 0.9619; train_kl_reg_loss: 6673.4577; train_edge_recon_loss: 258920.3529; train_gene_expr_recon_loss: 91912.7290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357506.5391; train_optim_loss: 357506.5391; val_kl_reg_loss: 6499.7935; val_edge_recon_loss: 261144.8771; val_gene_expr_recon_loss: 93346.1197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360990.7912; val_optim_loss: 360990.7912
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9872; val_auprc_score: 0.9821; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 6678.9393; train_edge_recon_loss: 258772.5145; train_gene_expr_recon_loss: 91539.7976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356991.2521; train_optim_loss: 356991.2521; val_kl_reg_loss: 6485.6386; val_edge_recon_loss: 261096.4922; val_gene_expr_recon_loss: 93407.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360990.0170; val_optim_loss: 360990.0170
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9853; val_auprc_score: 0.9796; val_best_acc_score: 0.9607; val_best_f1_score: 0.9619; train_kl_reg_loss: 6669.3304; train_edge_recon_loss: 258750.5583; train_gene_expr_recon_loss: 91356.2881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356776.1766; train_optim_loss: 356776.1766; val_kl_reg_loss: 6483.4071; val_edge_recon_loss: 261359.4517; val_gene_expr_recon_loss: 93209.7450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361052.6051; val_optim_loss: 361052.6051
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9868; val_auprc_score: 0.9815; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 6666.6903; train_edge_recon_loss: 258560.2881; train_gene_expr_recon_loss: 91130.6635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356357.6401; train_optim_loss: 356357.6401; val_kl_reg_loss: 6511.7236; val_edge_recon_loss: 261005.0625; val_gene_expr_recon_loss: 92952.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360469.6548; val_optim_loss: 360469.6548
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9877; val_auprc_score: 0.9827; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 6663.8561; train_edge_recon_loss: 258703.9118; train_gene_expr_recon_loss: 90795.4169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356163.1836; train_optim_loss: 356163.1836; val_kl_reg_loss: 6434.1822; val_edge_recon_loss: 261276.2614; val_gene_expr_recon_loss: 92856.9162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360567.3580; val_optim_loss: 360567.3580
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9864; val_auprc_score: 0.9808; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 6662.4847; train_edge_recon_loss: 258578.1919; train_gene_expr_recon_loss: 90567.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355807.9186; train_optim_loss: 355807.9186; val_kl_reg_loss: 6527.3938; val_edge_recon_loss: 260754.9744; val_gene_expr_recon_loss: 92570.6903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359853.0625; val_optim_loss: 359853.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9878; val_auprc_score: 0.9828; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 6664.7439; train_edge_recon_loss: 258396.8241; train_gene_expr_recon_loss: 90276.9125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355338.4811; train_optim_loss: 355338.4811; val_kl_reg_loss: 6532.1895; val_edge_recon_loss: 260385.9631; val_gene_expr_recon_loss: 92727.9915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359646.1491; val_optim_loss: 359646.1491
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9874; val_auprc_score: 0.9827; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 6646.8841; train_edge_recon_loss: 258542.4588; train_gene_expr_recon_loss: 90049.5192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355238.8633; train_optim_loss: 355238.8633; val_kl_reg_loss: 6504.6343; val_edge_recon_loss: 260968.1868; val_gene_expr_recon_loss: 92221.0792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359693.8963; val_optim_loss: 359693.8963
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9878; val_auprc_score: 0.9832; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 6665.8729; train_edge_recon_loss: 258317.1469; train_gene_expr_recon_loss: 89831.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354814.4803; train_optim_loss: 354814.4803; val_kl_reg_loss: 6588.5044; val_edge_recon_loss: 260489.8011; val_gene_expr_recon_loss: 92271.7383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359350.0469; val_optim_loss: 359350.0469
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9872; val_auprc_score: 0.9818; val_best_acc_score: 0.9632; val_best_f1_score: 0.9641; train_kl_reg_loss: 6653.1299; train_edge_recon_loss: 258372.2061; train_gene_expr_recon_loss: 89609.6645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354635.0000; train_optim_loss: 354635.0000; val_kl_reg_loss: 6508.9735; val_edge_recon_loss: 260635.4332; val_gene_expr_recon_loss: 92201.2290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359345.6321; val_optim_loss: 359345.6321
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9884; val_auprc_score: 0.9843; val_best_acc_score: 0.9651; val_best_f1_score: 0.9657; train_kl_reg_loss: 6654.0817; train_edge_recon_loss: 258369.7260; train_gene_expr_recon_loss: 89412.0155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354435.8234; train_optim_loss: 354435.8234; val_kl_reg_loss: 6502.8258; val_edge_recon_loss: 260425.1832; val_gene_expr_recon_loss: 92104.4616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359032.4688; val_optim_loss: 359032.4688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9876; val_auprc_score: 0.9830; val_best_acc_score: 0.9640; val_best_f1_score: 0.9648; train_kl_reg_loss: 6661.0191; train_edge_recon_loss: 258309.8706; train_gene_expr_recon_loss: 89180.5180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354151.4069; train_optim_loss: 354151.4069; val_kl_reg_loss: 6527.6338; val_edge_recon_loss: 260758.4766; val_gene_expr_recon_loss: 92197.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359484.0000; val_optim_loss: 359484.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9882; val_auprc_score: 0.9835; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 6664.6804; train_edge_recon_loss: 258217.0645; train_gene_expr_recon_loss: 89040.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353922.3428; train_optim_loss: 353922.3428; val_kl_reg_loss: 6479.3021; val_edge_recon_loss: 260674.4070; val_gene_expr_recon_loss: 91960.0550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359113.7599; val_optim_loss: 359113.7599
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9880; val_auprc_score: 0.9832; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 6663.3651; train_edge_recon_loss: 258120.5626; train_gene_expr_recon_loss: 88895.8378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353679.7638; train_optim_loss: 353679.7638; val_kl_reg_loss: 6558.8584; val_edge_recon_loss: 260838.6705; val_gene_expr_recon_loss: 92099.4759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359497.0071; val_optim_loss: 359497.0071
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9883; val_auprc_score: 0.9842; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 6665.0537; train_edge_recon_loss: 258045.0785; train_gene_expr_recon_loss: 88746.5424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353456.6735; train_optim_loss: 353456.6735; val_kl_reg_loss: 6489.6722; val_edge_recon_loss: 260289.2514; val_gene_expr_recon_loss: 91767.9205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358546.8423; val_optim_loss: 358546.8423
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9887; val_auprc_score: 0.9842; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 6659.8206; train_edge_recon_loss: 258021.3671; train_gene_expr_recon_loss: 88563.8769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353245.0627; train_optim_loss: 353245.0627; val_kl_reg_loss: 6546.4373; val_edge_recon_loss: 260331.2876; val_gene_expr_recon_loss: 91938.7358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358816.4616; val_optim_loss: 358816.4616
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9892; val_auprc_score: 0.9852; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 6660.2214; train_edge_recon_loss: 258024.6348; train_gene_expr_recon_loss: 88422.4405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353107.2972; train_optim_loss: 353107.2972; val_kl_reg_loss: 6499.0024; val_edge_recon_loss: 259821.1854; val_gene_expr_recon_loss: 92167.4780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358487.6648; val_optim_loss: 358487.6648
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9888; val_auprc_score: 0.9848; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 6674.6799; train_edge_recon_loss: 257914.0775; train_gene_expr_recon_loss: 88297.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352886.2340; train_optim_loss: 352886.2340; val_kl_reg_loss: 6549.7907; val_edge_recon_loss: 260167.9702; val_gene_expr_recon_loss: 91631.2770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358349.0341; val_optim_loss: 358349.0341
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9888; val_auprc_score: 0.9847; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 6665.3596; train_edge_recon_loss: 257892.7235; train_gene_expr_recon_loss: 88165.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352723.1478; train_optim_loss: 352723.1478; val_kl_reg_loss: 6514.8802; val_edge_recon_loss: 260265.8040; val_gene_expr_recon_loss: 91877.6083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358658.2940; val_optim_loss: 358658.2940
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9883; val_auprc_score: 0.9841; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 6661.8309; train_edge_recon_loss: 258089.7781; train_gene_expr_recon_loss: 88038.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352789.8857; train_optim_loss: 352789.8857; val_kl_reg_loss: 6527.5931; val_edge_recon_loss: 260483.8651; val_gene_expr_recon_loss: 92086.6534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359098.1080; val_optim_loss: 359098.1080
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9888; val_auprc_score: 0.9845; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 6674.0328; train_edge_recon_loss: 257922.0304; train_gene_expr_recon_loss: 87949.5188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352545.5809; train_optim_loss: 352545.5809; val_kl_reg_loss: 6551.0391; val_edge_recon_loss: 260185.3516; val_gene_expr_recon_loss: 91823.9354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358560.3239; val_optim_loss: 358560.3239
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9904; val_auprc_score: 0.9873; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 6676.0574; train_edge_recon_loss: 257890.8680; train_gene_expr_recon_loss: 87747.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352314.8758; train_optim_loss: 352314.8758; val_kl_reg_loss: 6505.1497; val_edge_recon_loss: 259808.4339; val_gene_expr_recon_loss: 91711.9957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358025.5824; val_optim_loss: 358025.5824
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9893; val_auprc_score: 0.9853; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 6692.2077; train_edge_recon_loss: 257808.3064; train_gene_expr_recon_loss: 87633.7113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352134.2243; train_optim_loss: 352134.2243; val_kl_reg_loss: 6516.5131; val_edge_recon_loss: 260060.7834; val_gene_expr_recon_loss: 91794.0337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358371.3281; val_optim_loss: 358371.3281
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9898; val_auprc_score: 0.9858; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 6678.9591; train_edge_recon_loss: 257809.4661; train_gene_expr_recon_loss: 87526.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352015.3055; train_optim_loss: 352015.3055; val_kl_reg_loss: 6559.2349; val_edge_recon_loss: 259680.8601; val_gene_expr_recon_loss: 91378.7177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357618.8111; val_optim_loss: 357618.8111
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9894; val_auprc_score: 0.9854; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 6688.6070; train_edge_recon_loss: 257738.7991; train_gene_expr_recon_loss: 87411.8191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351839.2257; train_optim_loss: 351839.2257; val_kl_reg_loss: 6546.6113; val_edge_recon_loss: 259807.0085; val_gene_expr_recon_loss: 92089.6090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358443.2273; val_optim_loss: 358443.2273
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9899; val_auprc_score: 0.9864; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 6689.6076; train_edge_recon_loss: 257798.1933; train_gene_expr_recon_loss: 87312.1513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351799.9538; train_optim_loss: 351799.9538; val_kl_reg_loss: 6519.3327; val_edge_recon_loss: 259988.3089; val_gene_expr_recon_loss: 91885.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358393.0398; val_optim_loss: 358393.0398
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9902; val_auprc_score: 0.9869; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 6687.9890; train_edge_recon_loss: 257717.7374; train_gene_expr_recon_loss: 87218.2894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351624.0155; train_optim_loss: 351624.0155; val_kl_reg_loss: 6579.9578; val_edge_recon_loss: 259912.9155; val_gene_expr_recon_loss: 91797.4116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358290.2855; val_optim_loss: 358290.2855
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9897; val_auprc_score: 0.9856; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 6697.6914; train_edge_recon_loss: 257847.0201; train_gene_expr_recon_loss: 87075.2179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351619.9310; train_optim_loss: 351619.9310; val_kl_reg_loss: 6558.8399; val_edge_recon_loss: 260054.8082; val_gene_expr_recon_loss: 91550.0089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358163.6562; val_optim_loss: 358163.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9906; val_auprc_score: 0.9877; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 6673.9345; train_edge_recon_loss: 257480.8515; train_gene_expr_recon_loss: 86415.2249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350570.0117; train_optim_loss: 350570.0117; val_kl_reg_loss: 6544.5053; val_edge_recon_loss: 259679.5561; val_gene_expr_recon_loss: 91564.2379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357788.2983; val_optim_loss: 357788.2983
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9902; val_auprc_score: 0.9868; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 6669.6942; train_edge_recon_loss: 257525.6529; train_gene_expr_recon_loss: 86385.1855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350580.5332; train_optim_loss: 350580.5332; val_kl_reg_loss: 6515.1750; val_edge_recon_loss: 259737.2237; val_gene_expr_recon_loss: 91433.4165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357685.8196; val_optim_loss: 357685.8196
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9901; val_auprc_score: 0.9863; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 6670.0991; train_edge_recon_loss: 257584.0820; train_gene_expr_recon_loss: 86271.9510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350526.1333; train_optim_loss: 350526.1333; val_kl_reg_loss: 6536.4387; val_edge_recon_loss: 260161.9901; val_gene_expr_recon_loss: 91120.8675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357819.2969; val_optim_loss: 357819.2969
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9898; val_auprc_score: 0.9861; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 6658.6482; train_edge_recon_loss: 257517.8818; train_gene_expr_recon_loss: 86292.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350468.5711; train_optim_loss: 350468.5711; val_kl_reg_loss: 6539.1082; val_edge_recon_loss: 259949.0568; val_gene_expr_recon_loss: 91426.8015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357914.9659; val_optim_loss: 357914.9659

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 9 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9849
Val best accuracy score: 0.9688
Val best F1 score: 0.9692
Val gene expr MSE score: 0.6549

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
