None
Run timestamp: 14082023_201834_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.0', '--lambda_l1_masked', '10.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9912; val_auprc_score: 0.9886; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 7409.0434; train_edge_recon_loss: 263058.5092; train_gene_expr_recon_loss: 197588.9916; train_masked_gp_l1_reg_loss: 2613.8533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470670.3974; train_optim_loss: 470670.3974; val_kl_reg_loss: 6891.2075; val_edge_recon_loss: 258786.1428; val_gene_expr_recon_loss: 184418.5597; val_masked_gp_l1_reg_loss: 3003.7417; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 453099.6598; val_optim_loss: 453099.6598
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 6910.3930; train_edge_recon_loss: 259159.7481; train_gene_expr_recon_loss: 180303.5897; train_masked_gp_l1_reg_loss: 3118.0267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449491.7575; train_optim_loss: 449491.7575; val_kl_reg_loss: 6677.5780; val_edge_recon_loss: 257687.5122; val_gene_expr_recon_loss: 179204.3848; val_masked_gp_l1_reg_loss: 3160.0845; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446729.5678; val_optim_loss: 446729.5678
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 6696.9801; train_edge_recon_loss: 258358.6132; train_gene_expr_recon_loss: 177586.2232; train_masked_gp_l1_reg_loss: 3193.0436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445834.8602; train_optim_loss: 445834.8602; val_kl_reg_loss: 6719.3160; val_edge_recon_loss: 257702.0473; val_gene_expr_recon_loss: 177823.2681; val_masked_gp_l1_reg_loss: 3204.7190; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445449.3506; val_optim_loss: 445449.3506
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 6605.9450; train_edge_recon_loss: 258048.6050; train_gene_expr_recon_loss: 176767.1235; train_masked_gp_l1_reg_loss: 3204.8129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444626.4863; train_optim_loss: 444626.4863; val_kl_reg_loss: 6463.8110; val_edge_recon_loss: 257110.1234; val_gene_expr_recon_loss: 177186.3160; val_masked_gp_l1_reg_loss: 3216.5771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443976.8129; val_optim_loss: 443976.8129
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 6563.8154; train_edge_recon_loss: 257731.0279; train_gene_expr_recon_loss: 176367.5110; train_masked_gp_l1_reg_loss: 3209.2859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443871.6400; train_optim_loss: 443871.6400; val_kl_reg_loss: 6481.9759; val_edge_recon_loss: 257004.8305; val_gene_expr_recon_loss: 176929.5627; val_masked_gp_l1_reg_loss: 3220.7239; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443637.0872; val_optim_loss: 443637.0872
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 6538.1426; train_edge_recon_loss: 257561.8188; train_gene_expr_recon_loss: 176129.7121; train_masked_gp_l1_reg_loss: 3210.1523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443439.8256; train_optim_loss: 443439.8256; val_kl_reg_loss: 6516.1598; val_edge_recon_loss: 256691.1370; val_gene_expr_recon_loss: 177387.2955; val_masked_gp_l1_reg_loss: 3221.1570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443815.7494; val_optim_loss: 443815.7494
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 6520.7685; train_edge_recon_loss: 257479.1741; train_gene_expr_recon_loss: 175981.1372; train_masked_gp_l1_reg_loss: 3222.2501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443203.3297; train_optim_loss: 443203.3297; val_kl_reg_loss: 6442.1148; val_edge_recon_loss: 256638.5166; val_gene_expr_recon_loss: 176855.2780; val_masked_gp_l1_reg_loss: 3216.5762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443152.4720; val_optim_loss: 443152.4720
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 6518.1593; train_edge_recon_loss: 257273.3587; train_gene_expr_recon_loss: 175919.0629; train_masked_gp_l1_reg_loss: 3239.2879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442949.8689; train_optim_loss: 442949.8689; val_kl_reg_loss: 6507.3659; val_edge_recon_loss: 256518.0154; val_gene_expr_recon_loss: 177062.0097; val_masked_gp_l1_reg_loss: 3257.7952; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443345.1717; val_optim_loss: 443345.1717
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 6511.8727; train_edge_recon_loss: 257199.0894; train_gene_expr_recon_loss: 175737.0699; train_masked_gp_l1_reg_loss: 3256.6875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442704.7197; train_optim_loss: 442704.7197; val_kl_reg_loss: 6441.2981; val_edge_recon_loss: 256338.3044; val_gene_expr_recon_loss: 177001.0486; val_masked_gp_l1_reg_loss: 3262.6194; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443043.2750; val_optim_loss: 443043.2750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6511.0035; train_edge_recon_loss: 257097.4137; train_gene_expr_recon_loss: 175622.8168; train_masked_gp_l1_reg_loss: 3273.7864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442505.0205; train_optim_loss: 442505.0205; val_kl_reg_loss: 6450.6495; val_edge_recon_loss: 256200.3444; val_gene_expr_recon_loss: 176698.0553; val_masked_gp_l1_reg_loss: 3302.3840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442651.4239; val_optim_loss: 442651.4239
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 6506.6011; train_edge_recon_loss: 257100.6436; train_gene_expr_recon_loss: 175553.2029; train_masked_gp_l1_reg_loss: 3287.5126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442447.9607; train_optim_loss: 442447.9607; val_kl_reg_loss: 6492.3127; val_edge_recon_loss: 256338.3653; val_gene_expr_recon_loss: 176702.2091; val_masked_gp_l1_reg_loss: 3303.6545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442836.5445; val_optim_loss: 442836.5445
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6506.1245; train_edge_recon_loss: 257040.3323; train_gene_expr_recon_loss: 175428.1125; train_masked_gp_l1_reg_loss: 3298.7218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442273.2914; train_optim_loss: 442273.2914; val_kl_reg_loss: 6493.1906; val_edge_recon_loss: 256319.1162; val_gene_expr_recon_loss: 176575.0200; val_masked_gp_l1_reg_loss: 3291.9194; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442679.2332; val_optim_loss: 442679.2332
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6509.2667; train_edge_recon_loss: 256986.9529; train_gene_expr_recon_loss: 175553.4395; train_masked_gp_l1_reg_loss: 3306.1179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442355.7768; train_optim_loss: 442355.7768; val_kl_reg_loss: 6487.0134; val_edge_recon_loss: 256060.4520; val_gene_expr_recon_loss: 176739.0458; val_masked_gp_l1_reg_loss: 3308.2314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442594.7301; val_optim_loss: 442594.7301
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6506.7409; train_edge_recon_loss: 256833.1841; train_gene_expr_recon_loss: 175342.4886; train_masked_gp_l1_reg_loss: 3313.3696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441995.7834; train_optim_loss: 441995.7834; val_kl_reg_loss: 6449.0829; val_edge_recon_loss: 256111.6406; val_gene_expr_recon_loss: 176173.6741; val_masked_gp_l1_reg_loss: 3310.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442045.1462; val_optim_loss: 442045.1462
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6508.3149; train_edge_recon_loss: 256821.1679; train_gene_expr_recon_loss: 175344.3179; train_masked_gp_l1_reg_loss: 3321.1520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441994.9529; train_optim_loss: 441994.9529; val_kl_reg_loss: 6437.0405; val_edge_recon_loss: 256022.6434; val_gene_expr_recon_loss: 176563.1500; val_masked_gp_l1_reg_loss: 3334.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442357.7392; val_optim_loss: 442357.7392
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6512.9446; train_edge_recon_loss: 256752.4311; train_gene_expr_recon_loss: 175148.9534; train_masked_gp_l1_reg_loss: 3326.7729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441741.1016; train_optim_loss: 441741.1016; val_kl_reg_loss: 6488.4614; val_edge_recon_loss: 255774.1124; val_gene_expr_recon_loss: 176226.5913; val_masked_gp_l1_reg_loss: 3320.0186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441809.1973; val_optim_loss: 441809.1973
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6514.3215; train_edge_recon_loss: 256739.3416; train_gene_expr_recon_loss: 175207.8342; train_masked_gp_l1_reg_loss: 3334.0610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441795.5585; train_optim_loss: 441795.5585; val_kl_reg_loss: 6462.5435; val_edge_recon_loss: 255960.3438; val_gene_expr_recon_loss: 176129.4137; val_masked_gp_l1_reg_loss: 3340.5359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441892.8315; val_optim_loss: 441892.8315
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6509.7578; train_edge_recon_loss: 256716.8252; train_gene_expr_recon_loss: 175274.5698; train_masked_gp_l1_reg_loss: 3345.5506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441846.7032; train_optim_loss: 441846.7032; val_kl_reg_loss: 6461.6719; val_edge_recon_loss: 255894.4917; val_gene_expr_recon_loss: 176559.3838; val_masked_gp_l1_reg_loss: 3346.7549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442262.2971; val_optim_loss: 442262.2971
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6513.4213; train_edge_recon_loss: 256729.7617; train_gene_expr_recon_loss: 175100.2071; train_masked_gp_l1_reg_loss: 3352.3658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441695.7558; train_optim_loss: 441695.7558; val_kl_reg_loss: 6487.3672; val_edge_recon_loss: 255828.9066; val_gene_expr_recon_loss: 176650.3674; val_masked_gp_l1_reg_loss: 3346.4343; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442313.0799; val_optim_loss: 442313.0799
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6518.3446; train_edge_recon_loss: 256662.8670; train_gene_expr_recon_loss: 175051.7572; train_masked_gp_l1_reg_loss: 3362.3960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441595.3650; train_optim_loss: 441595.3650; val_kl_reg_loss: 6514.0557; val_edge_recon_loss: 255919.0164; val_gene_expr_recon_loss: 176179.0937; val_masked_gp_l1_reg_loss: 3362.0098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441974.1653; val_optim_loss: 441974.1653

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6503.2388; train_edge_recon_loss: 256575.2185; train_gene_expr_recon_loss: 174782.7528; train_masked_gp_l1_reg_loss: 3160.0220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441021.2315; train_optim_loss: 441021.2315; val_kl_reg_loss: 6490.9760; val_edge_recon_loss: 255672.9030; val_gene_expr_recon_loss: 176047.6831; val_masked_gp_l1_reg_loss: 3156.0144; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441367.5622; val_optim_loss: 441367.5622
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6490.2330; train_edge_recon_loss: 256507.6280; train_gene_expr_recon_loss: 174608.8269; train_masked_gp_l1_reg_loss: 3158.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440764.9288; train_optim_loss: 440764.9288; val_kl_reg_loss: 6467.3041; val_edge_recon_loss: 255694.0585; val_gene_expr_recon_loss: 175393.8642; val_masked_gp_l1_reg_loss: 3158.7993; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440714.0398; val_optim_loss: 440714.0398
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6483.5677; train_edge_recon_loss: 256498.6743; train_gene_expr_recon_loss: 174549.8988; train_masked_gp_l1_reg_loss: 3161.2293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440693.3702; train_optim_loss: 440693.3702; val_kl_reg_loss: 6464.5889; val_edge_recon_loss: 255653.3146; val_gene_expr_recon_loss: 175824.8765; val_masked_gp_l1_reg_loss: 3165.0405; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441107.8103; val_optim_loss: 441107.8103
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 6479.8966; train_edge_recon_loss: 256531.1900; train_gene_expr_recon_loss: 174414.3564; train_masked_gp_l1_reg_loss: 3166.2076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440591.6507; train_optim_loss: 440591.6507; val_kl_reg_loss: 6460.6406; val_edge_recon_loss: 255583.0324; val_gene_expr_recon_loss: 175797.3427; val_masked_gp_l1_reg_loss: 3166.8486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441007.8596; val_optim_loss: 441007.8596
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6472.8486; train_edge_recon_loss: 256488.6371; train_gene_expr_recon_loss: 174406.4278; train_masked_gp_l1_reg_loss: 3170.1538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440538.0672; train_optim_loss: 440538.0672; val_kl_reg_loss: 6462.9227; val_edge_recon_loss: 255651.1521; val_gene_expr_recon_loss: 175722.8458; val_masked_gp_l1_reg_loss: 3174.0884; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441011.0146; val_optim_loss: 441011.0146
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6472.7532; train_edge_recon_loss: 256489.6834; train_gene_expr_recon_loss: 174449.0804; train_masked_gp_l1_reg_loss: 3175.5302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440587.0477; train_optim_loss: 440587.0477; val_kl_reg_loss: 6462.0881; val_edge_recon_loss: 255729.0523; val_gene_expr_recon_loss: 175842.2906; val_masked_gp_l1_reg_loss: 3177.1838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441210.6193; val_optim_loss: 441210.6193

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6470.2164; train_edge_recon_loss: 256400.0520; train_gene_expr_recon_loss: 174314.2842; train_masked_gp_l1_reg_loss: 3153.9105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440338.4629; train_optim_loss: 440338.4629; val_kl_reg_loss: 6465.9686; val_edge_recon_loss: 255726.0613; val_gene_expr_recon_loss: 175863.9462; val_masked_gp_l1_reg_loss: 3153.2676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441209.2566; val_optim_loss: 441209.2566
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6469.3550; train_edge_recon_loss: 256427.5099; train_gene_expr_recon_loss: 174346.0586; train_masked_gp_l1_reg_loss: 3153.2237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440396.1476; train_optim_loss: 440396.1476; val_kl_reg_loss: 6461.5614; val_edge_recon_loss: 255741.5109; val_gene_expr_recon_loss: 175950.2718; val_masked_gp_l1_reg_loss: 3153.4595; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441306.8128; val_optim_loss: 441306.8128
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 6468.0769; train_edge_recon_loss: 256408.9286; train_gene_expr_recon_loss: 174287.0566; train_masked_gp_l1_reg_loss: 3153.6682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440317.7300; train_optim_loss: 440317.7300; val_kl_reg_loss: 6454.5422; val_edge_recon_loss: 255686.2319; val_gene_expr_recon_loss: 175388.0742; val_masked_gp_l1_reg_loss: 3153.8669; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440682.7241; val_optim_loss: 440682.7241
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6468.0417; train_edge_recon_loss: 256392.0638; train_gene_expr_recon_loss: 174385.0489; train_masked_gp_l1_reg_loss: 3154.1654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440399.3199; train_optim_loss: 440399.3199; val_kl_reg_loss: 6454.1842; val_edge_recon_loss: 255428.5345; val_gene_expr_recon_loss: 175863.2256; val_masked_gp_l1_reg_loss: 3154.6123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440900.5691; val_optim_loss: 440900.5691
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6464.3479; train_edge_recon_loss: 256462.9738; train_gene_expr_recon_loss: 174307.6680; train_masked_gp_l1_reg_loss: 3154.7785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440389.7682; train_optim_loss: 440389.7682; val_kl_reg_loss: 6454.1136; val_edge_recon_loss: 255569.9405; val_gene_expr_recon_loss: 176076.6015; val_masked_gp_l1_reg_loss: 3155.1003; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441255.7500; val_optim_loss: 441255.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6466.5608; train_edge_recon_loss: 256459.5076; train_gene_expr_recon_loss: 174376.6247; train_masked_gp_l1_reg_loss: 3155.4429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440458.1359; train_optim_loss: 440458.1359; val_kl_reg_loss: 6458.2383; val_edge_recon_loss: 255796.3371; val_gene_expr_recon_loss: 175938.4208; val_masked_gp_l1_reg_loss: 3155.7690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441348.7775; val_optim_loss: 441348.7775
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6467.0327; train_edge_recon_loss: 256435.8619; train_gene_expr_recon_loss: 174308.8991; train_masked_gp_l1_reg_loss: 3156.0720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440367.8659; train_optim_loss: 440367.8659; val_kl_reg_loss: 6453.6799; val_edge_recon_loss: 255494.5644; val_gene_expr_recon_loss: 175506.1830; val_masked_gp_l1_reg_loss: 3156.5845; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440611.0206; val_optim_loss: 440611.0206
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 6464.0927; train_edge_recon_loss: 256448.2977; train_gene_expr_recon_loss: 174249.6875; train_masked_gp_l1_reg_loss: 3156.7080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440318.7858; train_optim_loss: 440318.7858; val_kl_reg_loss: 6448.0449; val_edge_recon_loss: 255464.1440; val_gene_expr_recon_loss: 175638.7454; val_masked_gp_l1_reg_loss: 3156.7515; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440707.6843; val_optim_loss: 440707.6843
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6463.9164; train_edge_recon_loss: 256403.3934; train_gene_expr_recon_loss: 174255.7447; train_masked_gp_l1_reg_loss: 3157.2271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440280.2815; train_optim_loss: 440280.2815; val_kl_reg_loss: 6460.4651; val_edge_recon_loss: 255829.7047; val_gene_expr_recon_loss: 175782.1722; val_masked_gp_l1_reg_loss: 3157.5085; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441229.8410; val_optim_loss: 441229.8410
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6462.8263; train_edge_recon_loss: 256454.0081; train_gene_expr_recon_loss: 174346.3183; train_masked_gp_l1_reg_loss: 3157.8092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440420.9620; train_optim_loss: 440420.9620; val_kl_reg_loss: 6455.9356; val_edge_recon_loss: 255622.8591; val_gene_expr_recon_loss: 175880.4169; val_masked_gp_l1_reg_loss: 3158.2788; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441117.4930; val_optim_loss: 441117.4930
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9873; val_best_f1_score: 0.9875; train_kl_reg_loss: 6465.3884; train_edge_recon_loss: 256417.3305; train_gene_expr_recon_loss: 174313.9950; train_masked_gp_l1_reg_loss: 3158.4047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440355.1189; train_optim_loss: 440355.1189; val_kl_reg_loss: 6450.1697; val_edge_recon_loss: 255782.1411; val_gene_expr_recon_loss: 176015.6918; val_masked_gp_l1_reg_loss: 3158.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441406.7839; val_optim_loss: 441406.7839

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6465.0271; train_edge_recon_loss: 256481.4763; train_gene_expr_recon_loss: 174323.1705; train_masked_gp_l1_reg_loss: 3156.2618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440425.9357; train_optim_loss: 440425.9357; val_kl_reg_loss: 6449.8252; val_edge_recon_loss: 255717.3139; val_gene_expr_recon_loss: 176037.5514; val_masked_gp_l1_reg_loss: 3156.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441360.7849; val_optim_loss: 441360.7849
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6464.4651; train_edge_recon_loss: 256404.1565; train_gene_expr_recon_loss: 174360.8962; train_masked_gp_l1_reg_loss: 3156.1270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440385.6434; train_optim_loss: 440385.6434; val_kl_reg_loss: 6453.9676; val_edge_recon_loss: 255573.7592; val_gene_expr_recon_loss: 175959.8859; val_masked_gp_l1_reg_loss: 3156.1313; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441143.7377; val_optim_loss: 441143.7377
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6463.4136; train_edge_recon_loss: 256353.8339; train_gene_expr_recon_loss: 174229.5170; train_masked_gp_l1_reg_loss: 3156.1629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440202.9265; train_optim_loss: 440202.9265; val_kl_reg_loss: 6455.0662; val_edge_recon_loss: 255619.9530; val_gene_expr_recon_loss: 175658.4618; val_masked_gp_l1_reg_loss: 3156.1926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440889.6704; val_optim_loss: 440889.6704
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 6466.7961; train_edge_recon_loss: 256407.2698; train_gene_expr_recon_loss: 174304.9446; train_masked_gp_l1_reg_loss: 3156.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440335.2194; train_optim_loss: 440335.2194; val_kl_reg_loss: 6455.0421; val_edge_recon_loss: 255588.8131; val_gene_expr_recon_loss: 176017.7580; val_masked_gp_l1_reg_loss: 3156.2795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441217.8941; val_optim_loss: 441217.8941

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 270 min 46 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9982
val AUPRC score: 0.9977
val best accuracy score: 0.9877
val best F1 score: 0.9878
val target rna MSE score: 0.5642
val source rna MSE score: 0.0675

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
