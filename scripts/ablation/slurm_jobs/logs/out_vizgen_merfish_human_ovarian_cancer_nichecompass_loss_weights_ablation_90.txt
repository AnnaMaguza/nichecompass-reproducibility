None
Run timestamp: 17072023_230953_90.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_90']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9784; val_auprc_score: 0.9776; val_best_acc_score: 0.9237; val_best_f1_score: 0.9247; train_kl_reg_loss: 32590.3924; train_edge_recon_loss: 2750437.7488; train_gene_expr_recon_loss: 1439095.1153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4222123.2595; train_optim_loss: 4222123.2595; val_kl_reg_loss: 26737.2552; val_edge_recon_loss: 2668177.2336; val_gene_expr_recon_loss: 1339591.8533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4034506.3439; val_optim_loss: 4034506.3439
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9867; val_auprc_score: 0.9861; val_best_acc_score: 0.9426; val_best_f1_score: 0.9429; train_kl_reg_loss: 24497.1237; train_edge_recon_loss: 2631710.0538; train_gene_expr_recon_loss: 1312835.2851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3969042.4614; train_optim_loss: 3969042.4614; val_kl_reg_loss: 22085.4669; val_edge_recon_loss: 2641814.3427; val_gene_expr_recon_loss: 1297348.2653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3961248.0775; val_optim_loss: 3961248.0775
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9897; val_auprc_score: 0.9892; val_best_acc_score: 0.9498; val_best_f1_score: 0.9501; train_kl_reg_loss: 21122.5230; train_edge_recon_loss: 2616170.3167; train_gene_expr_recon_loss: 1285295.8825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3922588.7220; train_optim_loss: 3922588.7220; val_kl_reg_loss: 19807.1145; val_edge_recon_loss: 2633566.6467; val_gene_expr_recon_loss: 1277617.8351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3930991.6021; val_optim_loss: 3930991.6021
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9912; val_auprc_score: 0.9907; val_best_acc_score: 0.9542; val_best_f1_score: 0.9544; train_kl_reg_loss: 19144.7228; train_edge_recon_loss: 2609862.6680; train_gene_expr_recon_loss: 1272810.5495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3901817.9418; train_optim_loss: 3901817.9418; val_kl_reg_loss: 18087.1952; val_edge_recon_loss: 2625651.0822; val_gene_expr_recon_loss: 1271667.2248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3915405.5106; val_optim_loss: 3915405.5106
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9918; val_auprc_score: 0.9911; val_best_acc_score: 0.9566; val_best_f1_score: 0.9567; train_kl_reg_loss: 18019.5445; train_edge_recon_loss: 2605304.5799; train_gene_expr_recon_loss: 1265385.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3888709.3857; train_optim_loss: 3888709.3857; val_kl_reg_loss: 17359.5381; val_edge_recon_loss: 2624212.5164; val_gene_expr_recon_loss: 1265730.7758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3907302.8275; val_optim_loss: 3907302.8275
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9925; val_auprc_score: 0.9919; val_best_acc_score: 0.9590; val_best_f1_score: 0.9593; train_kl_reg_loss: 17390.0246; train_edge_recon_loss: 2601533.1978; train_gene_expr_recon_loss: 1260123.4134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3879046.6337; train_optim_loss: 3879046.6337; val_kl_reg_loss: 17014.5040; val_edge_recon_loss: 2617714.7101; val_gene_expr_recon_loss: 1262104.2477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3896833.4671; val_optim_loss: 3896833.4671
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9927; val_auprc_score: 0.9921; val_best_acc_score: 0.9591; val_best_f1_score: 0.9592; train_kl_reg_loss: 16929.6296; train_edge_recon_loss: 2599676.6005; train_gene_expr_recon_loss: 1257076.7239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3873682.9533; train_optim_loss: 3873682.9533; val_kl_reg_loss: 16911.2450; val_edge_recon_loss: 2614920.2113; val_gene_expr_recon_loss: 1259587.2776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3891418.7277; val_optim_loss: 3891418.7277
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9927; val_auprc_score: 0.9920; val_best_acc_score: 0.9599; val_best_f1_score: 0.9601; train_kl_reg_loss: 16600.0345; train_edge_recon_loss: 2597647.6188; train_gene_expr_recon_loss: 1254111.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3868359.4958; train_optim_loss: 3868359.4958; val_kl_reg_loss: 16342.1181; val_edge_recon_loss: 2616452.0399; val_gene_expr_recon_loss: 1257165.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3889960.1045; val_optim_loss: 3889960.1045
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9928; val_auprc_score: 0.9922; val_best_acc_score: 0.9599; val_best_f1_score: 0.9601; train_kl_reg_loss: 16395.9758; train_edge_recon_loss: 2596228.8288; train_gene_expr_recon_loss: 1251130.1251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3863754.9286; train_optim_loss: 3863754.9286; val_kl_reg_loss: 15890.7109; val_edge_recon_loss: 2616242.9401; val_gene_expr_recon_loss: 1258010.4378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3890144.1092; val_optim_loss: 3890144.1092
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9932; val_best_acc_score: 0.9633; val_best_f1_score: 0.9635; train_kl_reg_loss: 16139.0586; train_edge_recon_loss: 2595073.2649; train_gene_expr_recon_loss: 1249285.0271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3860497.3533; train_optim_loss: 3860497.3533; val_kl_reg_loss: 15986.5517; val_edge_recon_loss: 2612635.7582; val_gene_expr_recon_loss: 1255075.7981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3883698.1080; val_optim_loss: 3883698.1080
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9933; val_best_acc_score: 0.9633; val_best_f1_score: 0.9635; train_kl_reg_loss: 15984.1196; train_edge_recon_loss: 2594048.9024; train_gene_expr_recon_loss: 1248119.1427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3858152.1596; train_optim_loss: 3858152.1596; val_kl_reg_loss: 15775.0571; val_edge_recon_loss: 2611230.6174; val_gene_expr_recon_loss: 1253756.1772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3880761.8451; val_optim_loss: 3880761.8451
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9935; val_best_acc_score: 0.9635; val_best_f1_score: 0.9637; train_kl_reg_loss: 15838.7242; train_edge_recon_loss: 2592501.1156; train_gene_expr_recon_loss: 1246683.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3855023.7270; train_optim_loss: 3855023.7270; val_kl_reg_loss: 15690.7960; val_edge_recon_loss: 2609484.6092; val_gene_expr_recon_loss: 1252553.1725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3877728.5822; val_optim_loss: 3877728.5822
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9942; val_auprc_score: 0.9938; val_best_acc_score: 0.9644; val_best_f1_score: 0.9646; train_kl_reg_loss: 15739.6195; train_edge_recon_loss: 2591874.0610; train_gene_expr_recon_loss: 1245525.0141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3853138.6939; train_optim_loss: 3853138.6939; val_kl_reg_loss: 15456.0262; val_edge_recon_loss: 2607433.6467; val_gene_expr_recon_loss: 1252675.1156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3875564.7852; val_optim_loss: 3875564.7852
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9938; val_auprc_score: 0.9933; val_best_acc_score: 0.9629; val_best_f1_score: 0.9632; train_kl_reg_loss: 15657.3259; train_edge_recon_loss: 2590551.0508; train_gene_expr_recon_loss: 1244315.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3850523.3872; train_optim_loss: 3850523.3872; val_kl_reg_loss: 15240.2328; val_edge_recon_loss: 2610492.6901; val_gene_expr_recon_loss: 1250151.3938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3875884.3157; val_optim_loss: 3875884.3157
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9942; val_auprc_score: 0.9937; val_best_acc_score: 0.9643; val_best_f1_score: 0.9645; train_kl_reg_loss: 15593.1522; train_edge_recon_loss: 2589805.1463; train_gene_expr_recon_loss: 1243190.8541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3848589.1565; train_optim_loss: 3848589.1565; val_kl_reg_loss: 15367.3073; val_edge_recon_loss: 2609126.2629; val_gene_expr_recon_loss: 1251031.6479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3875525.2242; val_optim_loss: 3875525.2242
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9942; val_auprc_score: 0.9937; val_best_acc_score: 0.9644; val_best_f1_score: 0.9645; train_kl_reg_loss: 15496.1162; train_edge_recon_loss: 2590145.4097; train_gene_expr_recon_loss: 1242511.8513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3848153.3794; train_optim_loss: 3848153.3794; val_kl_reg_loss: 15232.9014; val_edge_recon_loss: 2608915.5974; val_gene_expr_recon_loss: 1251667.9396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3875816.4378; val_optim_loss: 3875816.4378
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9943; val_auprc_score: 0.9938; val_best_acc_score: 0.9650; val_best_f1_score: 0.9650; train_kl_reg_loss: 15430.8483; train_edge_recon_loss: 2589390.3378; train_gene_expr_recon_loss: 1242026.7058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3846847.8893; train_optim_loss: 3846847.8893; val_kl_reg_loss: 14813.8902; val_edge_recon_loss: 2609832.0904; val_gene_expr_recon_loss: 1249023.7283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3873669.7230; val_optim_loss: 3873669.7230
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9944; val_best_acc_score: 0.9670; val_best_f1_score: 0.9672; train_kl_reg_loss: 15304.9367; train_edge_recon_loss: 2588780.3501; train_gene_expr_recon_loss: 1240976.7026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3845061.9907; train_optim_loss: 3845061.9907; val_kl_reg_loss: 15147.5267; val_edge_recon_loss: 2610078.6514; val_gene_expr_recon_loss: 1249236.4384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3874462.6115; val_optim_loss: 3874462.6115
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9942; val_best_acc_score: 0.9675; val_best_f1_score: 0.9677; train_kl_reg_loss: 15276.5622; train_edge_recon_loss: 2588806.4804; train_gene_expr_recon_loss: 1240682.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3844765.9517; train_optim_loss: 3844765.9517; val_kl_reg_loss: 14631.8045; val_edge_recon_loss: 2608617.9531; val_gene_expr_recon_loss: 1250212.7846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3873462.5505; val_optim_loss: 3873462.5505
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9945; val_auprc_score: 0.9939; val_best_acc_score: 0.9659; val_best_f1_score: 0.9661; train_kl_reg_loss: 15245.1029; train_edge_recon_loss: 2587469.5453; train_gene_expr_recon_loss: 1240597.7130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3843312.3630; train_optim_loss: 3843312.3630; val_kl_reg_loss: 14915.9816; val_edge_recon_loss: 2607105.3310; val_gene_expr_recon_loss: 1250484.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3872506.0951; val_optim_loss: 3872506.0951
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9678; val_best_f1_score: 0.9680; train_kl_reg_loss: 15180.2925; train_edge_recon_loss: 2587163.8940; train_gene_expr_recon_loss: 1239737.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3842082.1482; train_optim_loss: 3842082.1482; val_kl_reg_loss: 15017.5690; val_edge_recon_loss: 2604682.9531; val_gene_expr_recon_loss: 1250832.1227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3870532.6491; val_optim_loss: 3870532.6491
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9945; val_best_acc_score: 0.9684; val_best_f1_score: 0.9686; train_kl_reg_loss: 15140.7267; train_edge_recon_loss: 2586897.5627; train_gene_expr_recon_loss: 1239052.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3841090.7589; train_optim_loss: 3841090.7589; val_kl_reg_loss: 15041.2793; val_edge_recon_loss: 2604058.2054; val_gene_expr_recon_loss: 1249751.8715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3868851.3592; val_optim_loss: 3868851.3592
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9945; val_best_acc_score: 0.9682; val_best_f1_score: 0.9684; train_kl_reg_loss: 15133.1927; train_edge_recon_loss: 2586499.2199; train_gene_expr_recon_loss: 1238929.3100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3840561.7241; train_optim_loss: 3840561.7241; val_kl_reg_loss: 14959.1980; val_edge_recon_loss: 2605354.1761; val_gene_expr_recon_loss: 1248084.1391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3868397.5117; val_optim_loss: 3868397.5117
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9944; val_best_acc_score: 0.9682; val_best_f1_score: 0.9683; train_kl_reg_loss: 15089.2023; train_edge_recon_loss: 2585319.1703; train_gene_expr_recon_loss: 1238646.6672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3839055.0411; train_optim_loss: 3839055.0411; val_kl_reg_loss: 15039.1922; val_edge_recon_loss: 2606031.5962; val_gene_expr_recon_loss: 1248370.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3869441.4507; val_optim_loss: 3869441.4507
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9950; val_auprc_score: 0.9944; val_best_acc_score: 0.9680; val_best_f1_score: 0.9682; train_kl_reg_loss: 15060.5076; train_edge_recon_loss: 2584414.9988; train_gene_expr_recon_loss: 1238641.1869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3838116.6917; train_optim_loss: 3838116.6917; val_kl_reg_loss: 14881.5086; val_edge_recon_loss: 2603806.2124; val_gene_expr_recon_loss: 1247020.2518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3865707.9754; val_optim_loss: 3865707.9754
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9953; val_auprc_score: 0.9947; val_best_acc_score: 0.9690; val_best_f1_score: 0.9692; train_kl_reg_loss: 14995.5917; train_edge_recon_loss: 2584831.2408; train_gene_expr_recon_loss: 1238183.6707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3838010.5072; train_optim_loss: 3838010.5072; val_kl_reg_loss: 14553.6039; val_edge_recon_loss: 2604010.6350; val_gene_expr_recon_loss: 1247537.8351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3866102.0681; val_optim_loss: 3866102.0681
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9692; val_best_f1_score: 0.9693; train_kl_reg_loss: 14922.3240; train_edge_recon_loss: 2584697.2457; train_gene_expr_recon_loss: 1237645.4029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3837264.9689; train_optim_loss: 3837264.9689; val_kl_reg_loss: 14817.5060; val_edge_recon_loss: 2602389.1631; val_gene_expr_recon_loss: 1248117.1802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3865323.8521; val_optim_loss: 3865323.8521
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9955; val_auprc_score: 0.9950; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 14952.4308; train_edge_recon_loss: 2583519.3895; train_gene_expr_recon_loss: 1238064.8567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3836536.6760; train_optim_loss: 3836536.6760; val_kl_reg_loss: 14768.8950; val_edge_recon_loss: 2600086.1761; val_gene_expr_recon_loss: 1247515.0035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3862370.0822; val_optim_loss: 3862370.0822
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9698; val_best_f1_score: 0.9700; train_kl_reg_loss: 14922.2449; train_edge_recon_loss: 2583122.1484; train_gene_expr_recon_loss: 1237302.7056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3835347.0968; train_optim_loss: 3835347.0968; val_kl_reg_loss: 14989.1363; val_edge_recon_loss: 2601749.5446; val_gene_expr_recon_loss: 1245779.8228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3862518.4953; val_optim_loss: 3862518.4953
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 14865.9363; train_edge_recon_loss: 2583448.2495; train_gene_expr_recon_loss: 1237099.1228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3835413.3104; train_optim_loss: 3835413.3104; val_kl_reg_loss: 14702.5349; val_edge_recon_loss: 2603237.0258; val_gene_expr_recon_loss: 1247692.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3865631.5704; val_optim_loss: 3865631.5704
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9709; val_best_f1_score: 0.9710; train_kl_reg_loss: 14851.8135; train_edge_recon_loss: 2583364.0105; train_gene_expr_recon_loss: 1237099.3806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3835315.2067; train_optim_loss: 3835315.2067; val_kl_reg_loss: 14378.9151; val_edge_recon_loss: 2602280.0035; val_gene_expr_recon_loss: 1246908.6907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3863567.6115; val_optim_loss: 3863567.6115
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9698; val_best_f1_score: 0.9700; train_kl_reg_loss: 14840.8811; train_edge_recon_loss: 2583131.1646; train_gene_expr_recon_loss: 1236623.3923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3834595.4413; train_optim_loss: 3834595.4413; val_kl_reg_loss: 14498.8983; val_edge_recon_loss: 2602645.8768; val_gene_expr_recon_loss: 1247050.0317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3864194.8169; val_optim_loss: 3864194.8169

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9958; val_auprc_score: 0.9954; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 15259.9474; train_edge_recon_loss: 2580195.5301; train_gene_expr_recon_loss: 1226507.1102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3821962.5845; train_optim_loss: 3821962.5845; val_kl_reg_loss: 15096.3441; val_edge_recon_loss: 2598260.9824; val_gene_expr_recon_loss: 1238556.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3851913.8908; val_optim_loss: 3851913.8908
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 15354.7275; train_edge_recon_loss: 2580061.7626; train_gene_expr_recon_loss: 1225159.1578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3820575.6507; train_optim_loss: 3820575.6507; val_kl_reg_loss: 15140.5984; val_edge_recon_loss: 2597266.7207; val_gene_expr_recon_loss: 1237162.3674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849569.6843; val_optim_loss: 3849569.6843
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 15364.2627; train_edge_recon_loss: 2579701.1036; train_gene_expr_recon_loss: 1223504.0421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3818569.4091; train_optim_loss: 3818569.4091; val_kl_reg_loss: 15119.8207; val_edge_recon_loss: 2597125.5000; val_gene_expr_recon_loss: 1236977.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849222.3310; val_optim_loss: 3849222.3310
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 15326.8336; train_edge_recon_loss: 2579586.6418; train_gene_expr_recon_loss: 1223218.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3818131.9470; train_optim_loss: 3818131.9470; val_kl_reg_loss: 15120.5332; val_edge_recon_loss: 2596530.9800; val_gene_expr_recon_loss: 1236418.4853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3848069.9977; val_optim_loss: 3848069.9977
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 15324.5500; train_edge_recon_loss: 2579259.1559; train_gene_expr_recon_loss: 1222641.9006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3817225.6082; train_optim_loss: 3817225.6082; val_kl_reg_loss: 15085.2398; val_edge_recon_loss: 2597530.6232; val_gene_expr_recon_loss: 1236542.9472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849158.8169; val_optim_loss: 3849158.8169
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 15307.5664; train_edge_recon_loss: 2579112.3666; train_gene_expr_recon_loss: 1222637.4736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3817057.4072; train_optim_loss: 3817057.4072; val_kl_reg_loss: 15042.7302; val_edge_recon_loss: 2598169.6655; val_gene_expr_recon_loss: 1236096.7482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849309.1315; val_optim_loss: 3849309.1315
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 15290.3992; train_edge_recon_loss: 2579369.6546; train_gene_expr_recon_loss: 1222607.2856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3817267.3428; train_optim_loss: 3817267.3428; val_kl_reg_loss: 14994.2438; val_edge_recon_loss: 2600000.0657; val_gene_expr_recon_loss: 1235502.8662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3850497.1808; val_optim_loss: 3850497.1808
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 15267.4340; train_edge_recon_loss: 2578861.8905; train_gene_expr_recon_loss: 1222683.6117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3816812.9379; train_optim_loss: 3816812.9379; val_kl_reg_loss: 14848.8302; val_edge_recon_loss: 2599750.0282; val_gene_expr_recon_loss: 1234644.3762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849243.2394; val_optim_loss: 3849243.2394

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9730; val_best_f1_score: 0.9731; train_kl_reg_loss: 15229.8395; train_edge_recon_loss: 2578498.4202; train_gene_expr_recon_loss: 1220774.0001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814502.2605; train_optim_loss: 3814502.2605; val_kl_reg_loss: 15028.1747; val_edge_recon_loss: 2596919.0176; val_gene_expr_recon_loss: 1235282.6749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847229.8545; val_optim_loss: 3847229.8545
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 15256.3952; train_edge_recon_loss: 2579031.5839; train_gene_expr_recon_loss: 1220422.3908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814710.3718; train_optim_loss: 3814710.3718; val_kl_reg_loss: 15020.5482; val_edge_recon_loss: 2597303.2101; val_gene_expr_recon_loss: 1233984.7506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846308.4988; val_optim_loss: 3846308.4988
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 15254.3177; train_edge_recon_loss: 2578984.3074; train_gene_expr_recon_loss: 1220907.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3815146.4188; train_optim_loss: 3815146.4188; val_kl_reg_loss: 15009.0311; val_edge_recon_loss: 2596846.9589; val_gene_expr_recon_loss: 1234131.5927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3845987.5833; val_optim_loss: 3845987.5833
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 15273.8035; train_edge_recon_loss: 2578464.3932; train_gene_expr_recon_loss: 1220768.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814506.7278; train_optim_loss: 3814506.7278; val_kl_reg_loss: 15028.1891; val_edge_recon_loss: 2596680.1162; val_gene_expr_recon_loss: 1233091.9049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3844800.2160; val_optim_loss: 3844800.2160
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 15259.9458; train_edge_recon_loss: 2578660.7716; train_gene_expr_recon_loss: 1220753.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814673.7616; train_optim_loss: 3814673.7616; val_kl_reg_loss: 15011.6448; val_edge_recon_loss: 2597749.4988; val_gene_expr_recon_loss: 1234089.7940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846850.9413; val_optim_loss: 3846850.9413
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9724; val_best_f1_score: 0.9725; train_kl_reg_loss: 15253.9159; train_edge_recon_loss: 2578657.6068; train_gene_expr_recon_loss: 1220780.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814691.8310; train_optim_loss: 3814691.8310; val_kl_reg_loss: 15015.7435; val_edge_recon_loss: 2598847.4847; val_gene_expr_recon_loss: 1233314.3597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847177.5786; val_optim_loss: 3847177.5786
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 15257.7947; train_edge_recon_loss: 2578720.4203; train_gene_expr_recon_loss: 1220591.8257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814570.0399; train_optim_loss: 3814570.0399; val_kl_reg_loss: 15017.6325; val_edge_recon_loss: 2597217.2946; val_gene_expr_recon_loss: 1233979.4308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846214.3615; val_optim_loss: 3846214.3615
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 15254.0595; train_edge_recon_loss: 2578946.5102; train_gene_expr_recon_loss: 1220374.6356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814575.2049; train_optim_loss: 3814575.2049; val_kl_reg_loss: 15020.5409; val_edge_recon_loss: 2598515.9718; val_gene_expr_recon_loss: 1234104.6197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847641.1256; val_optim_loss: 3847641.1256

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 15249.0099; train_edge_recon_loss: 2578708.7560; train_gene_expr_recon_loss: 1220218.8049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814176.5722; train_optim_loss: 3814176.5722; val_kl_reg_loss: 15016.0713; val_edge_recon_loss: 2597422.5822; val_gene_expr_recon_loss: 1233630.0364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846068.7031; val_optim_loss: 3846068.7031
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9725; val_best_f1_score: 0.9727; train_kl_reg_loss: 15253.3259; train_edge_recon_loss: 2578925.9996; train_gene_expr_recon_loss: 1220568.0411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814747.3655; train_optim_loss: 3814747.3655; val_kl_reg_loss: 15017.8987; val_edge_recon_loss: 2597326.3885; val_gene_expr_recon_loss: 1234073.8521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846418.1362; val_optim_loss: 3846418.1362
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9728; val_best_f1_score: 0.9730; train_kl_reg_loss: 15257.2674; train_edge_recon_loss: 2578903.1688; train_gene_expr_recon_loss: 1220084.4572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814244.8923; train_optim_loss: 3814244.8923; val_kl_reg_loss: 15018.8420; val_edge_recon_loss: 2598069.9296; val_gene_expr_recon_loss: 1231848.8920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3844937.6502; val_optim_loss: 3844937.6502
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9960; val_auprc_score: 0.9954; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 15260.6456; train_edge_recon_loss: 2578884.6642; train_gene_expr_recon_loss: 1220586.4027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3814731.7128; train_optim_loss: 3814731.7128; val_kl_reg_loss: 15010.8233; val_edge_recon_loss: 2598913.6620; val_gene_expr_recon_loss: 1233575.8286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847500.3040; val_optim_loss: 3847500.3040

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 442 min 59 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9956
Val best accuracy score: 0.9734
Val best F1 score: 0.9735
Val gene expr MSE score: 8.4750

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
