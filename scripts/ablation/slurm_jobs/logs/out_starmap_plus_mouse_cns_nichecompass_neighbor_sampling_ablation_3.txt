None
Run timestamp: 13072023_091014_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9858; val_auprc_score: 0.9809; val_best_acc_score: 0.9531; val_best_f1_score: 0.9543; train_kl_reg_loss: 7647.8232; train_edge_recon_loss: 267506.9893; train_gene_expr_recon_loss: 124163.3428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399318.1548; train_optim_loss: 399318.1548; val_kl_reg_loss: 7396.1323; val_edge_recon_loss: 260308.5817; val_gene_expr_recon_loss: 113353.8025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381058.5184; val_optim_loss: 381058.5184
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9861; val_best_acc_score: 0.9624; val_best_f1_score: 0.9633; train_kl_reg_loss: 7305.0626; train_edge_recon_loss: 260740.1922; train_gene_expr_recon_loss: 109701.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377746.4971; train_optim_loss: 377746.4971; val_kl_reg_loss: 6889.5735; val_edge_recon_loss: 259623.6470; val_gene_expr_recon_loss: 107702.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374215.4764; val_optim_loss: 374215.4764
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9910; val_auprc_score: 0.9882; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 7036.1977; train_edge_recon_loss: 260029.6812; train_gene_expr_recon_loss: 105468.5354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372534.4133; train_optim_loss: 372534.4133; val_kl_reg_loss: 6810.7749; val_edge_recon_loss: 259085.3476; val_gene_expr_recon_loss: 104425.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370321.7577; val_optim_loss: 370321.7577
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 6875.2161; train_edge_recon_loss: 259513.0561; train_gene_expr_recon_loss: 102836.3253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369224.5975; train_optim_loss: 369224.5975; val_kl_reg_loss: 6777.5374; val_edge_recon_loss: 258634.1002; val_gene_expr_recon_loss: 102571.4867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367983.1219; val_optim_loss: 367983.1219
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9929; val_auprc_score: 0.9904; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 6753.7837; train_edge_recon_loss: 259197.0994; train_gene_expr_recon_loss: 101049.1642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367000.0471; train_optim_loss: 367000.0471; val_kl_reg_loss: 6758.5759; val_edge_recon_loss: 258399.9062; val_gene_expr_recon_loss: 100979.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366137.6296; val_optim_loss: 366137.6296
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9940; val_auprc_score: 0.9921; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 6664.7000; train_edge_recon_loss: 258841.8498; train_gene_expr_recon_loss: 99801.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365307.6544; train_optim_loss: 365307.6544; val_kl_reg_loss: 6504.2234; val_edge_recon_loss: 258023.0579; val_gene_expr_recon_loss: 100121.7371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364649.0190; val_optim_loss: 364649.0190
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 6596.2242; train_edge_recon_loss: 258528.8821; train_gene_expr_recon_loss: 98991.8525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364116.9589; train_optim_loss: 364116.9589; val_kl_reg_loss: 6479.3609; val_edge_recon_loss: 257650.1155; val_gene_expr_recon_loss: 99334.0771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363463.5528; val_optim_loss: 363463.5528
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9928; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 6535.6570; train_edge_recon_loss: 258316.2602; train_gene_expr_recon_loss: 98265.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363117.0877; train_optim_loss: 363117.0877; val_kl_reg_loss: 6379.4454; val_edge_recon_loss: 257946.3066; val_gene_expr_recon_loss: 98820.7870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363146.5369; val_optim_loss: 363146.5369
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 6482.2885; train_edge_recon_loss: 258116.4331; train_gene_expr_recon_loss: 97703.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362302.0387; train_optim_loss: 362302.0387; val_kl_reg_loss: 6375.6905; val_edge_recon_loss: 257388.0515; val_gene_expr_recon_loss: 98578.3604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362342.1014; val_optim_loss: 362342.1014
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 6443.9785; train_edge_recon_loss: 257982.8927; train_gene_expr_recon_loss: 97209.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361636.2652; train_optim_loss: 361636.2652; val_kl_reg_loss: 6402.6506; val_edge_recon_loss: 257539.1463; val_gene_expr_recon_loss: 98197.9590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362139.7577; val_optim_loss: 362139.7577
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 6421.1479; train_edge_recon_loss: 257689.5906; train_gene_expr_recon_loss: 96935.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361045.8829; train_optim_loss: 361045.8829; val_kl_reg_loss: 6343.4335; val_edge_recon_loss: 256901.7490; val_gene_expr_recon_loss: 98000.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361246.1634; val_optim_loss: 361246.1634
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 6398.3617; train_edge_recon_loss: 257535.2805; train_gene_expr_recon_loss: 96530.1835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360463.8264; train_optim_loss: 360463.8264; val_kl_reg_loss: 6346.7125; val_edge_recon_loss: 256908.4939; val_gene_expr_recon_loss: 98212.0818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361467.2889; val_optim_loss: 361467.2889
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 6373.1948; train_edge_recon_loss: 257446.8091; train_gene_expr_recon_loss: 96355.2157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360175.2201; train_optim_loss: 360175.2201; val_kl_reg_loss: 6368.6743; val_edge_recon_loss: 256662.9226; val_gene_expr_recon_loss: 98066.1698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361097.7654; val_optim_loss: 361097.7654
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6360.1023; train_edge_recon_loss: 257279.9515; train_gene_expr_recon_loss: 96098.5501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359738.6041; train_optim_loss: 359738.6041; val_kl_reg_loss: 6231.7588; val_edge_recon_loss: 256633.2126; val_gene_expr_recon_loss: 98011.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360876.6373; val_optim_loss: 360876.6373
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9822; val_best_f1_score: 0.9825; train_kl_reg_loss: 6351.1125; train_edge_recon_loss: 257180.7423; train_gene_expr_recon_loss: 95915.1266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359446.9815; train_optim_loss: 359446.9815; val_kl_reg_loss: 6364.1491; val_edge_recon_loss: 256375.0272; val_gene_expr_recon_loss: 97507.6400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360246.8151; val_optim_loss: 360246.8151
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 6340.1429; train_edge_recon_loss: 257138.6385; train_gene_expr_recon_loss: 95644.1582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359122.9392; train_optim_loss: 359122.9392; val_kl_reg_loss: 6292.5783; val_edge_recon_loss: 256647.5884; val_gene_expr_recon_loss: 97461.2426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360401.4088; val_optim_loss: 360401.4088
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6337.6653; train_edge_recon_loss: 256960.7620; train_gene_expr_recon_loss: 95516.2859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358814.7120; train_optim_loss: 358814.7120; val_kl_reg_loss: 6269.3400; val_edge_recon_loss: 256394.6332; val_gene_expr_recon_loss: 97634.1310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360298.1050; val_optim_loss: 360298.1050
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9959; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6338.9779; train_edge_recon_loss: 256847.7087; train_gene_expr_recon_loss: 95324.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358510.7009; train_optim_loss: 358510.7009; val_kl_reg_loss: 6265.8131; val_edge_recon_loss: 256218.8243; val_gene_expr_recon_loss: 97650.4203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360135.0558; val_optim_loss: 360135.0558
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9968; val_auprc_score: 0.9957; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 6333.1262; train_edge_recon_loss: 256814.4007; train_gene_expr_recon_loss: 95113.5401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358261.0670; train_optim_loss: 358261.0670; val_kl_reg_loss: 6304.8267; val_edge_recon_loss: 256227.1990; val_gene_expr_recon_loss: 97461.8368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359993.8689; val_optim_loss: 359993.8689
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 6334.5509; train_edge_recon_loss: 256777.5364; train_gene_expr_recon_loss: 94949.9986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358062.0867; train_optim_loss: 358062.0867; val_kl_reg_loss: 6221.1194; val_edge_recon_loss: 256232.5146; val_gene_expr_recon_loss: 97646.9834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360100.6153; val_optim_loss: 360100.6153
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6333.2489; train_edge_recon_loss: 256650.1740; train_gene_expr_recon_loss: 94831.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357814.7667; train_optim_loss: 357814.7667; val_kl_reg_loss: 6335.0319; val_edge_recon_loss: 256303.0914; val_gene_expr_recon_loss: 97420.4351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360058.5610; val_optim_loss: 360058.5610
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6331.3322; train_edge_recon_loss: 256636.8572; train_gene_expr_recon_loss: 94699.8445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357668.0345; train_optim_loss: 357668.0345; val_kl_reg_loss: 6345.4671; val_edge_recon_loss: 256119.1153; val_gene_expr_recon_loss: 97584.8170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360049.3965; val_optim_loss: 360049.3965
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6336.3011; train_edge_recon_loss: 256635.9055; train_gene_expr_recon_loss: 94647.9070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357620.1131; train_optim_loss: 357620.1131; val_kl_reg_loss: 6318.5865; val_edge_recon_loss: 256145.6527; val_gene_expr_recon_loss: 97199.8230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359664.0620; val_optim_loss: 359664.0620
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6336.0573; train_edge_recon_loss: 256567.0990; train_gene_expr_recon_loss: 94386.7233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357289.8783; train_optim_loss: 357289.8783; val_kl_reg_loss: 6306.8175; val_edge_recon_loss: 255836.2797; val_gene_expr_recon_loss: 97623.8124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359766.9088; val_optim_loss: 359766.9088
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9863; val_best_f1_score: 0.9865; train_kl_reg_loss: 6338.1367; train_edge_recon_loss: 256505.4523; train_gene_expr_recon_loss: 94324.2123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357167.8007; train_optim_loss: 357167.8007; val_kl_reg_loss: 6351.5878; val_edge_recon_loss: 255811.2864; val_gene_expr_recon_loss: 97355.2290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359518.1040; val_optim_loss: 359518.1040
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 6348.9158; train_edge_recon_loss: 256468.9948; train_gene_expr_recon_loss: 94247.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357065.6038; train_optim_loss: 357065.6038; val_kl_reg_loss: 6310.6452; val_edge_recon_loss: 256010.9506; val_gene_expr_recon_loss: 97739.1965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360060.7900; val_optim_loss: 360060.7900
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 6346.1760; train_edge_recon_loss: 256445.4825; train_gene_expr_recon_loss: 94064.9480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356856.6066; train_optim_loss: 356856.6066; val_kl_reg_loss: 6266.9587; val_edge_recon_loss: 255872.3589; val_gene_expr_recon_loss: 97489.4832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359628.7987; val_optim_loss: 359628.7987
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6350.7552; train_edge_recon_loss: 256412.3670; train_gene_expr_recon_loss: 94034.5994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356797.7225; train_optim_loss: 356797.7225; val_kl_reg_loss: 6373.4478; val_edge_recon_loss: 255878.2951; val_gene_expr_recon_loss: 97502.8521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359754.5932; val_optim_loss: 359754.5932
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6358.2486; train_edge_recon_loss: 256354.9549; train_gene_expr_recon_loss: 93899.0645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356612.2681; train_optim_loss: 356612.2681; val_kl_reg_loss: 6282.8070; val_edge_recon_loss: 255776.8609; val_gene_expr_recon_loss: 97527.5730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359587.2398; val_optim_loss: 359587.2398

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6368.8548; train_edge_recon_loss: 256219.5140; train_gene_expr_recon_loss: 93162.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355751.0296; train_optim_loss: 355751.0296; val_kl_reg_loss: 6335.9880; val_edge_recon_loss: 255742.3379; val_gene_expr_recon_loss: 97144.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359222.7065; val_optim_loss: 359222.7065
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6363.6002; train_edge_recon_loss: 256227.0503; train_gene_expr_recon_loss: 93114.1767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355704.8284; train_optim_loss: 355704.8284; val_kl_reg_loss: 6339.4089; val_edge_recon_loss: 255507.9027; val_gene_expr_recon_loss: 97144.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358992.1875; val_optim_loss: 358992.1875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6359.5292; train_edge_recon_loss: 256217.7635; train_gene_expr_recon_loss: 93094.5049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355671.7974; train_optim_loss: 355671.7974; val_kl_reg_loss: 6338.0280; val_edge_recon_loss: 255836.9657; val_gene_expr_recon_loss: 97387.1853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359562.1798; val_optim_loss: 359562.1798
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6359.8825; train_edge_recon_loss: 256245.4327; train_gene_expr_recon_loss: 93054.3596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355659.6747; train_optim_loss: 355659.6747; val_kl_reg_loss: 6313.4837; val_edge_recon_loss: 255558.5087; val_gene_expr_recon_loss: 97199.3198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359071.3110; val_optim_loss: 359071.3110
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6362.0827; train_edge_recon_loss: 256142.4479; train_gene_expr_recon_loss: 93000.1262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355504.6563; train_optim_loss: 355504.6563; val_kl_reg_loss: 6328.7048; val_edge_recon_loss: 255819.5269; val_gene_expr_recon_loss: 97416.1063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359564.3391; val_optim_loss: 359564.3391
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6361.2588; train_edge_recon_loss: 256203.9997; train_gene_expr_recon_loss: 92984.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355549.3321; train_optim_loss: 355549.3321; val_kl_reg_loss: 6317.8769; val_edge_recon_loss: 255377.3251; val_gene_expr_recon_loss: 97210.3687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358905.5717; val_optim_loss: 358905.5717
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6358.2761; train_edge_recon_loss: 256245.3133; train_gene_expr_recon_loss: 92947.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355551.2514; train_optim_loss: 355551.2514; val_kl_reg_loss: 6339.3814; val_edge_recon_loss: 255918.1186; val_gene_expr_recon_loss: 97327.2907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359584.7889; val_optim_loss: 359584.7889
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6356.8119; train_edge_recon_loss: 256210.5430; train_gene_expr_recon_loss: 92981.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355548.8883; train_optim_loss: 355548.8883; val_kl_reg_loss: 6330.8755; val_edge_recon_loss: 255602.3317; val_gene_expr_recon_loss: 97647.4465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359580.6532; val_optim_loss: 359580.6532
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6358.0664; train_edge_recon_loss: 256189.8223; train_gene_expr_recon_loss: 92849.9150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355397.8042; train_optim_loss: 355397.8042; val_kl_reg_loss: 6347.6644; val_edge_recon_loss: 255802.8663; val_gene_expr_recon_loss: 97374.1401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359524.6767; val_optim_loss: 359524.6767
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6358.0246; train_edge_recon_loss: 256177.0994; train_gene_expr_recon_loss: 92795.3408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355330.4647; train_optim_loss: 355330.4647; val_kl_reg_loss: 6315.1871; val_edge_recon_loss: 255586.5254; val_gene_expr_recon_loss: 97554.3627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359456.0784; val_optim_loss: 359456.0784

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6360.8729; train_edge_recon_loss: 256050.8471; train_gene_expr_recon_loss: 92813.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355224.7457; train_optim_loss: 355224.7457; val_kl_reg_loss: 6334.6711; val_edge_recon_loss: 255565.7951; val_gene_expr_recon_loss: 97358.1889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359258.6552; val_optim_loss: 359258.6552
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6359.5514; train_edge_recon_loss: 256170.0290; train_gene_expr_recon_loss: 92787.3856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355316.9656; train_optim_loss: 355316.9656; val_kl_reg_loss: 6337.5636; val_edge_recon_loss: 255723.2034; val_gene_expr_recon_loss: 97493.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359554.3914; val_optim_loss: 359554.3914
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6361.6013; train_edge_recon_loss: 256096.1279; train_gene_expr_recon_loss: 92765.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355223.4275; train_optim_loss: 355223.4275; val_kl_reg_loss: 6338.4560; val_edge_recon_loss: 255400.0584; val_gene_expr_recon_loss: 97598.0643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359336.5774; val_optim_loss: 359336.5774
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6361.0850; train_edge_recon_loss: 256072.1647; train_gene_expr_recon_loss: 92755.2451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355188.4939; train_optim_loss: 355188.4939; val_kl_reg_loss: 6332.6571; val_edge_recon_loss: 255628.9111; val_gene_expr_recon_loss: 97345.0456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359306.6142; val_optim_loss: 359306.6142

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 334 min 15 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9968
Val best accuracy score: 0.9860
Val best F1 score: 0.9861
Val gene expr MSE score: 0.6793

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
