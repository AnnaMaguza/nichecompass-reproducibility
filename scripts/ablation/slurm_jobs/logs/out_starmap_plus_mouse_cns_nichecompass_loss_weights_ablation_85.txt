None
Run timestamp: 31072023_101529_85.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_85']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9694; val_auprc_score: 0.9561; val_best_acc_score: 0.9260; val_best_f1_score: 0.9283; train_kl_reg_loss: 7053.8963; train_edge_recon_loss: 280649.2047; train_gene_expr_recon_loss: 228999.1578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 516702.2611; train_optim_loss: 516702.2611; val_kl_reg_loss: 8116.3093; val_edge_recon_loss: 267061.1250; val_gene_expr_recon_loss: 206441.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 481619.0341; val_optim_loss: 481619.0341
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9735; val_auprc_score: 0.9621; val_best_acc_score: 0.9353; val_best_f1_score: 0.9372; train_kl_reg_loss: 7923.9706; train_edge_recon_loss: 263764.7551; train_gene_expr_recon_loss: 200496.1035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 472184.8285; train_optim_loss: 472184.8285; val_kl_reg_loss: 7518.0341; val_edge_recon_loss: 265232.4354; val_gene_expr_recon_loss: 195587.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 468338.0824; val_optim_loss: 468338.0824
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9776; val_auprc_score: 0.9683; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 7508.7323; train_edge_recon_loss: 262686.2241; train_gene_expr_recon_loss: 192741.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 462936.2083; train_optim_loss: 462936.2083; val_kl_reg_loss: 7223.3771; val_edge_recon_loss: 264275.6321; val_gene_expr_recon_loss: 189582.9567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 461081.9673; val_optim_loss: 461081.9673
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9808; val_auprc_score: 0.9727; val_best_acc_score: 0.9478; val_best_f1_score: 0.9491; train_kl_reg_loss: 7312.5909; train_edge_recon_loss: 261838.9787; train_gene_expr_recon_loss: 187699.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 456851.3818; train_optim_loss: 456851.3818; val_kl_reg_loss: 6902.2475; val_edge_recon_loss: 263606.4432; val_gene_expr_recon_loss: 185723.3849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 456232.0781; val_optim_loss: 456232.0781
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9815; val_auprc_score: 0.9740; val_best_acc_score: 0.9499; val_best_f1_score: 0.9514; train_kl_reg_loss: 7194.3490; train_edge_recon_loss: 261405.6928; train_gene_expr_recon_loss: 184133.5986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 452733.6408; train_optim_loss: 452733.6408; val_kl_reg_loss: 6908.8609; val_edge_recon_loss: 263438.8033; val_gene_expr_recon_loss: 182715.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 453063.1662; val_optim_loss: 453063.1662
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9824; val_auprc_score: 0.9745; val_best_acc_score: 0.9526; val_best_f1_score: 0.9538; train_kl_reg_loss: 7101.6690; train_edge_recon_loss: 260959.7785; train_gene_expr_recon_loss: 181308.1311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449369.5762; train_optim_loss: 449369.5762; val_kl_reg_loss: 6902.9486; val_edge_recon_loss: 263270.1207; val_gene_expr_recon_loss: 180336.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450509.2869; val_optim_loss: 450509.2869
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9833; val_auprc_score: 0.9768; val_best_acc_score: 0.9548; val_best_f1_score: 0.9558; train_kl_reg_loss: 7035.2437; train_edge_recon_loss: 260815.2632; train_gene_expr_recon_loss: 178979.7002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446830.2065; train_optim_loss: 446830.2065; val_kl_reg_loss: 6734.0901; val_edge_recon_loss: 262766.9283; val_gene_expr_recon_loss: 178297.8963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447798.9148; val_optim_loss: 447798.9148
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9830; val_auprc_score: 0.9762; val_best_acc_score: 0.9556; val_best_f1_score: 0.9567; train_kl_reg_loss: 7000.1138; train_edge_recon_loss: 260500.0984; train_gene_expr_recon_loss: 177009.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444510.0685; train_optim_loss: 444510.0685; val_kl_reg_loss: 6797.8904; val_edge_recon_loss: 263090.2436; val_gene_expr_recon_loss: 176533.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446422.0469; val_optim_loss: 446422.0469
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9837; val_auprc_score: 0.9777; val_best_acc_score: 0.9549; val_best_f1_score: 0.9561; train_kl_reg_loss: 6974.9326; train_edge_recon_loss: 260254.7429; train_gene_expr_recon_loss: 175281.7856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442511.4618; train_optim_loss: 442511.4618; val_kl_reg_loss: 6785.0384; val_edge_recon_loss: 262491.3693; val_gene_expr_recon_loss: 174911.2472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444187.6534; val_optim_loss: 444187.6534
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9846; val_auprc_score: 0.9785; val_best_acc_score: 0.9573; val_best_f1_score: 0.9582; train_kl_reg_loss: 6938.6174; train_edge_recon_loss: 260118.7465; train_gene_expr_recon_loss: 173772.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440830.2078; train_optim_loss: 440830.2078; val_kl_reg_loss: 6718.5255; val_edge_recon_loss: 262373.6875; val_gene_expr_recon_loss: 173524.4879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442616.7045; val_optim_loss: 442616.7045
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9844; val_auprc_score: 0.9786; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 6910.1153; train_edge_recon_loss: 260038.8572; train_gene_expr_recon_loss: 172406.9993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439355.9697; train_optim_loss: 439355.9697; val_kl_reg_loss: 6598.8953; val_edge_recon_loss: 262200.4325; val_gene_expr_recon_loss: 172319.9879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441119.3168; val_optim_loss: 441119.3168
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9858; val_auprc_score: 0.9807; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 6916.9824; train_edge_recon_loss: 259878.2453; train_gene_expr_recon_loss: 171281.5828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438076.8109; train_optim_loss: 438076.8109; val_kl_reg_loss: 6704.0803; val_edge_recon_loss: 261606.1257; val_gene_expr_recon_loss: 171793.2159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440103.4219; val_optim_loss: 440103.4219
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9846; val_auprc_score: 0.9777; val_best_acc_score: 0.9595; val_best_f1_score: 0.9604; train_kl_reg_loss: 6901.0177; train_edge_recon_loss: 259780.1586; train_gene_expr_recon_loss: 170215.6978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436896.8734; train_optim_loss: 436896.8734; val_kl_reg_loss: 6717.0686; val_edge_recon_loss: 262179.2436; val_gene_expr_recon_loss: 170673.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439569.7869; val_optim_loss: 439569.7869
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9860; val_auprc_score: 0.9811; val_best_acc_score: 0.9599; val_best_f1_score: 0.9608; train_kl_reg_loss: 6899.6348; train_edge_recon_loss: 259584.8688; train_gene_expr_recon_loss: 169193.2730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435677.7773; train_optim_loss: 435677.7773; val_kl_reg_loss: 6697.6248; val_edge_recon_loss: 261557.4538; val_gene_expr_recon_loss: 170068.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438323.9034; val_optim_loss: 438323.9034
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9797; val_best_acc_score: 0.9604; val_best_f1_score: 0.9613; train_kl_reg_loss: 6900.0649; train_edge_recon_loss: 259526.6174; train_gene_expr_recon_loss: 168630.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435056.7471; train_optim_loss: 435056.7471; val_kl_reg_loss: 6788.0413; val_edge_recon_loss: 261624.7550; val_gene_expr_recon_loss: 169021.4134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437434.2031; val_optim_loss: 437434.2031
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9855; val_auprc_score: 0.9793; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 6908.9068; train_edge_recon_loss: 259277.9192; train_gene_expr_recon_loss: 167643.4268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433830.2518; train_optim_loss: 433830.2518; val_kl_reg_loss: 6791.4830; val_edge_recon_loss: 261568.7223; val_gene_expr_recon_loss: 168236.5689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436596.7727; val_optim_loss: 436596.7727
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9851; val_auprc_score: 0.9789; val_best_acc_score: 0.9597; val_best_f1_score: 0.9607; train_kl_reg_loss: 6913.0830; train_edge_recon_loss: 259381.7439; train_gene_expr_recon_loss: 167093.4250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433388.2490; train_optim_loss: 433388.2490; val_kl_reg_loss: 6794.9521; val_edge_recon_loss: 261898.9943; val_gene_expr_recon_loss: 167876.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436570.1690; val_optim_loss: 436570.1690
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9864; val_auprc_score: 0.9810; val_best_acc_score: 0.9607; val_best_f1_score: 0.9615; train_kl_reg_loss: 6903.7167; train_edge_recon_loss: 259308.9837; train_gene_expr_recon_loss: 166311.0696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432523.7712; train_optim_loss: 432523.7712; val_kl_reg_loss: 6731.6701; val_edge_recon_loss: 261876.8161; val_gene_expr_recon_loss: 167015.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435623.9957; val_optim_loss: 435623.9957
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9863; val_auprc_score: 0.9807; val_best_acc_score: 0.9609; val_best_f1_score: 0.9619; train_kl_reg_loss: 6902.2007; train_edge_recon_loss: 259182.0715; train_gene_expr_recon_loss: 165791.8103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431876.0833; train_optim_loss: 431876.0833; val_kl_reg_loss: 6669.0574; val_edge_recon_loss: 261534.8714; val_gene_expr_recon_loss: 166711.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434915.6605; val_optim_loss: 434915.6605
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9860; val_auprc_score: 0.9800; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 6910.4998; train_edge_recon_loss: 258920.6018; train_gene_expr_recon_loss: 165279.6825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431110.7835; train_optim_loss: 431110.7835; val_kl_reg_loss: 6894.3499; val_edge_recon_loss: 261435.8857; val_gene_expr_recon_loss: 166704.8601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435035.0923; val_optim_loss: 435035.0923
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9867; val_auprc_score: 0.9816; val_best_acc_score: 0.9613; val_best_f1_score: 0.9622; train_kl_reg_loss: 6922.8419; train_edge_recon_loss: 258962.8281; train_gene_expr_recon_loss: 164747.1905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430632.8608; train_optim_loss: 430632.8608; val_kl_reg_loss: 6781.9864; val_edge_recon_loss: 261677.4822; val_gene_expr_recon_loss: 165864.1271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434323.5966; val_optim_loss: 434323.5966
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9868; val_auprc_score: 0.9818; val_best_acc_score: 0.9618; val_best_f1_score: 0.9625; train_kl_reg_loss: 6909.7423; train_edge_recon_loss: 259044.5588; train_gene_expr_recon_loss: 164362.9439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430317.2446; train_optim_loss: 430317.2446; val_kl_reg_loss: 6807.3444; val_edge_recon_loss: 261591.3146; val_gene_expr_recon_loss: 165895.3530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434294.0128; val_optim_loss: 434294.0128
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9867; val_auprc_score: 0.9818; val_best_acc_score: 0.9617; val_best_f1_score: 0.9625; train_kl_reg_loss: 6924.0522; train_edge_recon_loss: 258813.4778; train_gene_expr_recon_loss: 163937.8049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429675.3351; train_optim_loss: 429675.3351; val_kl_reg_loss: 6813.0011; val_edge_recon_loss: 261484.9929; val_gene_expr_recon_loss: 165494.4112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433792.4048; val_optim_loss: 433792.4048
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9861; val_auprc_score: 0.9801; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 6928.5730; train_edge_recon_loss: 258783.7734; train_gene_expr_recon_loss: 163557.7725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429270.1177; train_optim_loss: 429270.1177; val_kl_reg_loss: 6766.1702; val_edge_recon_loss: 261062.1094; val_gene_expr_recon_loss: 165252.7678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433081.0440; val_optim_loss: 433081.0440
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9863; val_auprc_score: 0.9810; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 6933.8916; train_edge_recon_loss: 258908.1159; train_gene_expr_recon_loss: 163321.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429163.7497; train_optim_loss: 429163.7497; val_kl_reg_loss: 6743.3074; val_edge_recon_loss: 261217.2514; val_gene_expr_recon_loss: 165447.6101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433408.1690; val_optim_loss: 433408.1690
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9872; val_auprc_score: 0.9817; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 6926.5425; train_edge_recon_loss: 258831.7859; train_gene_expr_recon_loss: 162991.8083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428750.1359; train_optim_loss: 428750.1359; val_kl_reg_loss: 6737.4745; val_edge_recon_loss: 260994.3509; val_gene_expr_recon_loss: 165218.1662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432949.9901; val_optim_loss: 432949.9901
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9876; val_auprc_score: 0.9825; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 6935.8152; train_edge_recon_loss: 258682.4556; train_gene_expr_recon_loss: 162656.4749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428274.7454; train_optim_loss: 428274.7454; val_kl_reg_loss: 6731.8878; val_edge_recon_loss: 260805.1974; val_gene_expr_recon_loss: 164639.9595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432177.0426; val_optim_loss: 432177.0426
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9868; val_auprc_score: 0.9814; val_best_acc_score: 0.9629; val_best_f1_score: 0.9638; train_kl_reg_loss: 6955.1156; train_edge_recon_loss: 258580.7126; train_gene_expr_recon_loss: 162405.2792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427941.1081; train_optim_loss: 427941.1081; val_kl_reg_loss: 6856.6327; val_edge_recon_loss: 260944.3871; val_gene_expr_recon_loss: 164291.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432092.6875; val_optim_loss: 432092.6875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9869; val_auprc_score: 0.9814; val_best_acc_score: 0.9629; val_best_f1_score: 0.9637; train_kl_reg_loss: 6955.8984; train_edge_recon_loss: 258675.3897; train_gene_expr_recon_loss: 161971.2106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427602.4987; train_optim_loss: 427602.4987; val_kl_reg_loss: 6746.3727; val_edge_recon_loss: 261370.5135; val_gene_expr_recon_loss: 164255.8416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432372.7287; val_optim_loss: 432372.7287
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9866; val_auprc_score: 0.9803; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 6958.1139; train_edge_recon_loss: 258505.3609; train_gene_expr_recon_loss: 161790.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427253.9325; train_optim_loss: 427253.9325; val_kl_reg_loss: 6696.4082; val_edge_recon_loss: 261367.9077; val_gene_expr_recon_loss: 164236.3061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432300.6236; val_optim_loss: 432300.6236
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9869; val_auprc_score: 0.9815; val_best_acc_score: 0.9636; val_best_f1_score: 0.9644; train_kl_reg_loss: 6960.6798; train_edge_recon_loss: 258417.7137; train_gene_expr_recon_loss: 161722.1689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427100.5649; train_optim_loss: 427100.5649; val_kl_reg_loss: 6834.4028; val_edge_recon_loss: 261264.3793; val_gene_expr_recon_loss: 164141.4240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432240.2045; val_optim_loss: 432240.2045
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9867; val_auprc_score: 0.9810; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 6969.2176; train_edge_recon_loss: 258320.9291; train_gene_expr_recon_loss: 161189.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426479.9368; train_optim_loss: 426479.9368; val_kl_reg_loss: 6830.2858; val_edge_recon_loss: 261755.3693; val_gene_expr_recon_loss: 164132.4290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432718.0795; val_optim_loss: 432718.0795

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9876; val_auprc_score: 0.9820; val_best_acc_score: 0.9635; val_best_f1_score: 0.9644; train_kl_reg_loss: 6957.9083; train_edge_recon_loss: 258012.8264; train_gene_expr_recon_loss: 160727.7325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425698.4665; train_optim_loss: 425698.4665; val_kl_reg_loss: 6782.4138; val_edge_recon_loss: 260946.0604; val_gene_expr_recon_loss: 164230.7038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431959.1761; val_optim_loss: 431959.1761
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9883; val_auprc_score: 0.9839; val_best_acc_score: 0.9657; val_best_f1_score: 0.9664; train_kl_reg_loss: 6944.8089; train_edge_recon_loss: 258164.0382; train_gene_expr_recon_loss: 160621.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425730.2272; train_optim_loss: 425730.2272; val_kl_reg_loss: 6774.9861; val_edge_recon_loss: 260705.9155; val_gene_expr_recon_loss: 163471.9098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430952.8082; val_optim_loss: 430952.8082
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9876; val_auprc_score: 0.9827; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 6934.5143; train_edge_recon_loss: 258227.0364; train_gene_expr_recon_loss: 160428.4675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425590.0192; train_optim_loss: 425590.0192; val_kl_reg_loss: 6786.2710; val_edge_recon_loss: 260472.7116; val_gene_expr_recon_loss: 163114.8345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430373.8153; val_optim_loss: 430373.8153
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9881; val_auprc_score: 0.9837; val_best_acc_score: 0.9648; val_best_f1_score: 0.9656; train_kl_reg_loss: 6926.6574; train_edge_recon_loss: 258347.7435; train_gene_expr_recon_loss: 160460.3784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425734.7801; train_optim_loss: 425734.7801; val_kl_reg_loss: 6759.7101; val_edge_recon_loss: 260738.5653; val_gene_expr_recon_loss: 163227.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430725.4048; val_optim_loss: 430725.4048
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9877; val_auprc_score: 0.9828; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 6937.1548; train_edge_recon_loss: 258181.0302; train_gene_expr_recon_loss: 160611.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425729.2928; train_optim_loss: 425729.2928; val_kl_reg_loss: 6770.0065; val_edge_recon_loss: 260873.3778; val_gene_expr_recon_loss: 163442.1996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431085.5866; val_optim_loss: 431085.5866
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9878; val_auprc_score: 0.9827; val_best_acc_score: 0.9646; val_best_f1_score: 0.9654; train_kl_reg_loss: 6930.8859; train_edge_recon_loss: 258175.2022; train_gene_expr_recon_loss: 160449.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425555.5376; train_optim_loss: 425555.5376; val_kl_reg_loss: 6778.3271; val_edge_recon_loss: 261008.8580; val_gene_expr_recon_loss: 163217.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431004.5014; val_optim_loss: 431004.5014
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9877; val_auprc_score: 0.9827; val_best_acc_score: 0.9646; val_best_f1_score: 0.9654; train_kl_reg_loss: 6929.5455; train_edge_recon_loss: 258216.5270; train_gene_expr_recon_loss: 160413.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425559.5977; train_optim_loss: 425559.5977; val_kl_reg_loss: 6784.3171; val_edge_recon_loss: 261020.9709; val_gene_expr_recon_loss: 163616.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431421.5014; val_optim_loss: 431421.5014

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9883; val_auprc_score: 0.9829; val_best_acc_score: 0.9649; val_best_f1_score: 0.9658; train_kl_reg_loss: 6935.1643; train_edge_recon_loss: 258240.7987; train_gene_expr_recon_loss: 160254.9634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425430.9272; train_optim_loss: 425430.9272; val_kl_reg_loss: 6774.2649; val_edge_recon_loss: 260475.5824; val_gene_expr_recon_loss: 163924.1264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431173.9801; val_optim_loss: 431173.9801
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9889; val_auprc_score: 0.9845; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 6931.7571; train_edge_recon_loss: 258062.9572; train_gene_expr_recon_loss: 160346.0746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425340.7884; train_optim_loss: 425340.7884; val_kl_reg_loss: 6774.7082; val_edge_recon_loss: 260313.6946; val_gene_expr_recon_loss: 163553.2855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430641.6832; val_optim_loss: 430641.6832
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9881; val_auprc_score: 0.9837; val_best_acc_score: 0.9649; val_best_f1_score: 0.9657; train_kl_reg_loss: 6930.3684; train_edge_recon_loss: 258219.1116; train_gene_expr_recon_loss: 160204.4342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425353.9147; train_optim_loss: 425353.9147; val_kl_reg_loss: 6768.1585; val_edge_recon_loss: 261244.2195; val_gene_expr_recon_loss: 163491.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431504.2756; val_optim_loss: 431504.2756
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9879; val_auprc_score: 0.9828; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 6932.2793; train_edge_recon_loss: 258214.6394; train_gene_expr_recon_loss: 160281.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425428.2964; train_optim_loss: 425428.2964; val_kl_reg_loss: 6774.1973; val_edge_recon_loss: 260679.3757; val_gene_expr_recon_loss: 163652.3679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431105.9389; val_optim_loss: 431105.9389

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 19 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9880
val AUPRC score: 0.9832
val best accuracy score: 0.9644
val best F1 score: 0.9652
val target rna MSE score: 0.6354
val source rna MSE score: 0.1083

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
