None
Run timestamp: 04082023_203640_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '2', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 2, n_layers: 2, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9719; val_auprc_score: 0.9659; val_best_acc_score: 0.9211; val_best_f1_score: 0.9235; train_kl_reg_loss: 6098.9685; train_edge_recon_loss: 265881.9252; train_gene_expr_recon_loss: 123128.9854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 395109.8792; train_optim_loss: 395109.8792; val_kl_reg_loss: 6141.0453; val_edge_recon_loss: 265824.6258; val_gene_expr_recon_loss: 111884.4050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 383850.0764; val_optim_loss: 383850.0764
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9837; val_auprc_score: 0.9807; val_best_acc_score: 0.9423; val_best_f1_score: 0.9433; train_kl_reg_loss: 5874.6237; train_edge_recon_loss: 260344.4167; train_gene_expr_recon_loss: 109500.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375719.8302; train_optim_loss: 375719.8302; val_kl_reg_loss: 5905.6751; val_edge_recon_loss: 264087.1770; val_gene_expr_recon_loss: 107090.0653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377082.9162; val_optim_loss: 377082.9162
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9876; val_auprc_score: 0.9852; val_best_acc_score: 0.9508; val_best_f1_score: 0.9515; train_kl_reg_loss: 5824.3279; train_edge_recon_loss: 259272.7107; train_gene_expr_recon_loss: 106550.1350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371647.1740; train_optim_loss: 371647.1740; val_kl_reg_loss: 5863.1718; val_edge_recon_loss: 263095.2886; val_gene_expr_recon_loss: 105401.0808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374359.5407; val_optim_loss: 374359.5407
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9870; val_auprc_score: 0.9846; val_best_acc_score: 0.9495; val_best_f1_score: 0.9506; train_kl_reg_loss: 5804.5335; train_edge_recon_loss: 258748.8152; train_gene_expr_recon_loss: 105421.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369974.4827; train_optim_loss: 369974.4827; val_kl_reg_loss: 5890.6864; val_edge_recon_loss: 262980.9769; val_gene_expr_recon_loss: 104749.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373621.5401; val_optim_loss: 373621.5401
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9884; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 5798.3618; train_edge_recon_loss: 258501.5784; train_gene_expr_recon_loss: 104755.8413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369055.7818; train_optim_loss: 369055.7818; val_kl_reg_loss: 5890.5794; val_edge_recon_loss: 261778.3983; val_gene_expr_recon_loss: 104176.6159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371845.5922; val_optim_loss: 371845.5922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9893; val_auprc_score: 0.9873; val_best_acc_score: 0.9557; val_best_f1_score: 0.9563; train_kl_reg_loss: 5804.6088; train_edge_recon_loss: 258158.5345; train_gene_expr_recon_loss: 104362.9080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368326.0514; train_optim_loss: 368326.0514; val_kl_reg_loss: 5978.9064; val_edge_recon_loss: 261671.8222; val_gene_expr_recon_loss: 103937.0958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371587.8246; val_optim_loss: 371587.8246
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9605; val_best_f1_score: 0.9611; train_kl_reg_loss: 5808.7238; train_edge_recon_loss: 257976.6027; train_gene_expr_recon_loss: 104039.6761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367825.0024; train_optim_loss: 367825.0024; val_kl_reg_loss: 5885.9544; val_edge_recon_loss: 261227.3922; val_gene_expr_recon_loss: 103736.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370849.5833; val_optim_loss: 370849.5833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9905; val_auprc_score: 0.9885; val_best_acc_score: 0.9593; val_best_f1_score: 0.9599; train_kl_reg_loss: 5811.3091; train_edge_recon_loss: 257824.7489; train_gene_expr_recon_loss: 103781.6686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367417.7267; train_optim_loss: 367417.7267; val_kl_reg_loss: 5925.0939; val_edge_recon_loss: 261574.4548; val_gene_expr_recon_loss: 103460.9593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370960.5078; val_optim_loss: 370960.5078
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9594; val_best_f1_score: 0.9600; train_kl_reg_loss: 5813.0203; train_edge_recon_loss: 257685.5482; train_gene_expr_recon_loss: 103553.0730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367051.6415; train_optim_loss: 367051.6415; val_kl_reg_loss: 5845.6067; val_edge_recon_loss: 261583.7963; val_gene_expr_recon_loss: 103313.7438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370743.1466; val_optim_loss: 370743.1466
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9884; val_best_acc_score: 0.9598; val_best_f1_score: 0.9605; train_kl_reg_loss: 5811.9915; train_edge_recon_loss: 257572.0832; train_gene_expr_recon_loss: 103332.6232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366716.6974; train_optim_loss: 366716.6974; val_kl_reg_loss: 5872.3737; val_edge_recon_loss: 261254.6476; val_gene_expr_recon_loss: 103046.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370173.3046; val_optim_loss: 370173.3046
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9912; val_auprc_score: 0.9893; val_best_acc_score: 0.9610; val_best_f1_score: 0.9614; train_kl_reg_loss: 5800.4577; train_edge_recon_loss: 257370.2819; train_gene_expr_recon_loss: 103141.6539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366312.3932; train_optim_loss: 366312.3932; val_kl_reg_loss: 5901.5270; val_edge_recon_loss: 260810.6170; val_gene_expr_recon_loss: 102749.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369461.2003; val_optim_loss: 369461.2003
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9616; val_best_f1_score: 0.9621; train_kl_reg_loss: 5638.6363; train_edge_recon_loss: 257321.4079; train_gene_expr_recon_loss: 102867.7857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365827.8299; train_optim_loss: 365827.8299; val_kl_reg_loss: 6113.2318; val_edge_recon_loss: 261023.9750; val_gene_expr_recon_loss: 102669.2376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369806.4451; val_optim_loss: 369806.4451
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9918; val_auprc_score: 0.9898; val_best_acc_score: 0.9631; val_best_f1_score: 0.9636; train_kl_reg_loss: 3540073114115101184.0000; train_edge_recon_loss: 257228.7261; train_gene_expr_recon_loss: 102453.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3540073114115460608.0000; train_optim_loss: 3540073114115460608.0000; val_kl_reg_loss: 6265.7381; val_edge_recon_loss: 261243.6964; val_gene_expr_recon_loss: 102472.8584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369982.2934; val_optim_loss: 369982.2934
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9915; val_auprc_score: 0.9895; val_best_acc_score: 0.9621; val_best_f1_score: 0.9626; train_kl_reg_loss: 120422153.1441; train_edge_recon_loss: 257033.0775; train_gene_expr_recon_loss: 102074.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 120781259.0538; train_optim_loss: 120781259.0538; val_kl_reg_loss: 6295.8540; val_edge_recon_loss: 261054.3182; val_gene_expr_recon_loss: 102422.0401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369772.2114; val_optim_loss: 369772.2114
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9638; val_best_f1_score: 0.9642; train_kl_reg_loss: 5251.8662; train_edge_recon_loss: 256924.0998; train_gene_expr_recon_loss: 101839.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364015.4972; train_optim_loss: 364015.4972; val_kl_reg_loss: 6693.5945; val_edge_recon_loss: 260476.1807; val_gene_expr_recon_loss: 102399.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369569.6543; val_optim_loss: 369569.6543

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 5259.3954; train_edge_recon_loss: 256751.2537; train_gene_expr_recon_loss: 101381.0715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363391.7207; train_optim_loss: 363391.7207; val_kl_reg_loss: 6463.7107; val_edge_recon_loss: 260529.3823; val_gene_expr_recon_loss: 102074.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369068.0535; val_optim_loss: 369068.0535
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 5223.8602; train_edge_recon_loss: 256753.6066; train_gene_expr_recon_loss: 101346.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363323.7973; train_optim_loss: 363323.7973; val_kl_reg_loss: 6247.1397; val_edge_recon_loss: 260321.5071; val_gene_expr_recon_loss: 101866.8870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368435.5329; val_optim_loss: 368435.5329
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9918; val_auprc_score: 0.9896; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 5246.2923; train_edge_recon_loss: 256804.5640; train_gene_expr_recon_loss: 101303.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363354.2354; train_optim_loss: 363354.2354; val_kl_reg_loss: 6161.6047; val_edge_recon_loss: 260872.5259; val_gene_expr_recon_loss: 101589.3863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368623.5171; val_optim_loss: 368623.5171
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5214.6880; train_edge_recon_loss: 256708.4716; train_gene_expr_recon_loss: 101252.8928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363176.0521; train_optim_loss: 363176.0521; val_kl_reg_loss: 6288.9560; val_edge_recon_loss: 260401.3192; val_gene_expr_recon_loss: 101870.5816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368560.8566; val_optim_loss: 368560.8566
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9654; val_best_f1_score: 0.9657; train_kl_reg_loss: 5236.7421; train_edge_recon_loss: 256693.6975; train_gene_expr_recon_loss: 101266.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363197.4349; train_optim_loss: 363197.4349; val_kl_reg_loss: 6544.1809; val_edge_recon_loss: 260393.6520; val_gene_expr_recon_loss: 101867.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368805.6986; val_optim_loss: 368805.6986
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 5226.1920; train_edge_recon_loss: 256752.4200; train_gene_expr_recon_loss: 101239.9130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363218.5248; train_optim_loss: 363218.5248; val_kl_reg_loss: 6407.5866; val_edge_recon_loss: 260306.9662; val_gene_expr_recon_loss: 101799.1201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368513.6730; val_optim_loss: 368513.6730

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 5226.3580; train_edge_recon_loss: 256809.7869; train_gene_expr_recon_loss: 101241.4672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363277.6125; train_optim_loss: 363277.6125; val_kl_reg_loss: 6496.3700; val_edge_recon_loss: 260381.0211; val_gene_expr_recon_loss: 101682.0257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368559.4174; val_optim_loss: 368559.4174
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 5212.6941; train_edge_recon_loss: 256754.7185; train_gene_expr_recon_loss: 101186.0548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363153.4678; train_optim_loss: 363153.4678; val_kl_reg_loss: 6540.3657; val_edge_recon_loss: 260401.1862; val_gene_expr_recon_loss: 101928.4269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368869.9793; val_optim_loss: 368869.9793
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9928; val_auprc_score: 0.9912; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 5216.6673; train_edge_recon_loss: 256683.2345; train_gene_expr_recon_loss: 101143.3831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363043.2846; train_optim_loss: 363043.2846; val_kl_reg_loss: 6256.9916; val_edge_recon_loss: 260375.3814; val_gene_expr_recon_loss: 101547.3179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368179.6914; val_optim_loss: 368179.6914
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 5251.3763; train_edge_recon_loss: 256634.0003; train_gene_expr_recon_loss: 101160.6020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363045.9783; train_optim_loss: 363045.9783; val_kl_reg_loss: 6325.6213; val_edge_recon_loss: 260601.7374; val_gene_expr_recon_loss: 101510.4128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368437.7703; val_optim_loss: 368437.7703
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9923; val_auprc_score: 0.9907; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 5221.1648; train_edge_recon_loss: 256660.1894; train_gene_expr_recon_loss: 101109.0412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362990.3951; train_optim_loss: 362990.3951; val_kl_reg_loss: 6444.8975; val_edge_recon_loss: 260404.3233; val_gene_expr_recon_loss: 101702.4502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368551.6716; val_optim_loss: 368551.6716
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 5209.5538; train_edge_recon_loss: 256788.3474; train_gene_expr_recon_loss: 101172.3417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363170.2429; train_optim_loss: 363170.2429; val_kl_reg_loss: 6261.6888; val_edge_recon_loss: 260920.6052; val_gene_expr_recon_loss: 101588.3807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368770.6742; val_optim_loss: 368770.6742
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9929; val_auprc_score: 0.9914; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 5225.9931; train_edge_recon_loss: 256780.6766; train_gene_expr_recon_loss: 101128.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363134.8075; train_optim_loss: 363134.8075; val_kl_reg_loss: 6764.6075; val_edge_recon_loss: 259900.4655; val_gene_expr_recon_loss: 101910.0053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368575.0785; val_optim_loss: 368575.0785

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9657; val_best_f1_score: 0.9661; train_kl_reg_loss: 5232.8339; train_edge_recon_loss: 256656.7743; train_gene_expr_recon_loss: 101118.2141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363007.8225; train_optim_loss: 363007.8225; val_kl_reg_loss: 6516.4318; val_edge_recon_loss: 260291.0130; val_gene_expr_recon_loss: 101845.0831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368652.5274; val_optim_loss: 368652.5274
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9652; val_best_f1_score: 0.9655; train_kl_reg_loss: 5226.1721; train_edge_recon_loss: 256688.7708; train_gene_expr_recon_loss: 101102.4189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363017.3618; train_optim_loss: 363017.3618; val_kl_reg_loss: 6399.2657; val_edge_recon_loss: 260249.4669; val_gene_expr_recon_loss: 101732.1595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368380.8926; val_optim_loss: 368380.8926
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 5242.0200; train_edge_recon_loss: 256636.4277; train_gene_expr_recon_loss: 101123.5716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363002.0195; train_optim_loss: 363002.0195; val_kl_reg_loss: 6542.4438; val_edge_recon_loss: 260646.9248; val_gene_expr_recon_loss: 101698.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368887.6719; val_optim_loss: 368887.6719
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9922; val_auprc_score: 0.9903; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5222.0916; train_edge_recon_loss: 256822.2713; train_gene_expr_recon_loss: 101103.2022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363147.5649; train_optim_loss: 363147.5649; val_kl_reg_loss: 6428.3571; val_edge_recon_loss: 260488.1371; val_gene_expr_recon_loss: 101791.7004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368708.1949; val_optim_loss: 368708.1949

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 187 min 43 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9923
val AUPRC score: 0.9906
val best accuracy score: 0.9655
val best F1 score: 0.9659
val target rna MSE score: 0.9658
val source rna MSE score: 0.2806

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
