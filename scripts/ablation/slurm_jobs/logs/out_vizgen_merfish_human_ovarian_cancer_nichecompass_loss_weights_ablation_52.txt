None
Run timestamp: 17072023_222805_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9690; val_best_f1_score: 0.9691; train_kl_reg_loss: 15038.6517; train_edge_recon_loss: 26292568.4691; train_gene_expr_recon_loss: 21484494.0811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47792101.2065; train_optim_loss: 47792101.2065; val_kl_reg_loss: 16455.3167; val_edge_recon_loss: 26064008.9143; val_gene_expr_recon_loss: 20553180.3238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46633644.5143; val_optim_loss: 46633644.5143
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 17287.1586; train_edge_recon_loss: 25910985.0612; train_gene_expr_recon_loss: 20399404.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46327676.8015; train_optim_loss: 46327676.8015; val_kl_reg_loss: 17583.3378; val_edge_recon_loss: 25956327.9571; val_gene_expr_recon_loss: 20339834.4762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46313745.8857; val_optim_loss: 46313745.8857
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 18223.7654; train_edge_recon_loss: 25836301.9226; train_gene_expr_recon_loss: 20269957.2563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46124482.9261; train_optim_loss: 46124482.9261; val_kl_reg_loss: 19160.4577; val_edge_recon_loss: 25889452.7143; val_gene_expr_recon_loss: 20286758.6048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46195371.8000; val_optim_loss: 46195371.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 18588.7103; train_edge_recon_loss: 25802044.8778; train_gene_expr_recon_loss: 20233430.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46054064.4792; train_optim_loss: 46054064.4792; val_kl_reg_loss: 18634.9337; val_edge_recon_loss: 25889662.1762; val_gene_expr_recon_loss: 20227686.9952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46135984.2381; val_optim_loss: 46135984.2381
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 18739.0229; train_edge_recon_loss: 25769459.3289; train_gene_expr_recon_loss: 20215332.9139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46003531.2992; train_optim_loss: 46003531.2992; val_kl_reg_loss: 18443.0832; val_edge_recon_loss: 25835423.1095; val_gene_expr_recon_loss: 20233403.6286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46087269.6476; val_optim_loss: 46087269.6476
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 18769.9436; train_edge_recon_loss: 25747080.8656; train_gene_expr_recon_loss: 20203589.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45969440.2216; train_optim_loss: 45969440.2216; val_kl_reg_loss: 18914.6505; val_edge_recon_loss: 25830284.8190; val_gene_expr_recon_loss: 20227485.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46076684.7333; val_optim_loss: 46076684.7333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 18776.0695; train_edge_recon_loss: 25727834.4723; train_gene_expr_recon_loss: 20196516.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45943127.0384; train_optim_loss: 45943127.0384; val_kl_reg_loss: 18631.7580; val_edge_recon_loss: 25801982.4619; val_gene_expr_recon_loss: 20237732.2095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46058346.4762; val_optim_loss: 46058346.4762
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 18723.9503; train_edge_recon_loss: 25719503.6263; train_gene_expr_recon_loss: 20192535.0702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45930762.6250; train_optim_loss: 45930762.6250; val_kl_reg_loss: 19049.5009; val_edge_recon_loss: 25793476.7095; val_gene_expr_recon_loss: 20210100.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46022626.7810; val_optim_loss: 46022626.7810
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 18724.2796; train_edge_recon_loss: 25704804.1654; train_gene_expr_recon_loss: 20186783.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45910311.7328; train_optim_loss: 45910311.7328; val_kl_reg_loss: 18343.0227; val_edge_recon_loss: 25798722.9952; val_gene_expr_recon_loss: 20206776.6905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46023842.7238; val_optim_loss: 46023842.7238
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 18666.3849; train_edge_recon_loss: 25695848.8222; train_gene_expr_recon_loss: 20180891.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45895406.5497; train_optim_loss: 45895406.5497; val_kl_reg_loss: 19135.2379; val_edge_recon_loss: 25781493.2810; val_gene_expr_recon_loss: 20210909.7619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46011538.3333; val_optim_loss: 46011538.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 18600.8247; train_edge_recon_loss: 25683846.4506; train_gene_expr_recon_loss: 20177077.5584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45879524.7771; train_optim_loss: 45879524.7771; val_kl_reg_loss: 17950.9206; val_edge_recon_loss: 25752965.4143; val_gene_expr_recon_loss: 20209138.4476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45980054.7238; val_optim_loss: 45980054.7238
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 18544.8516; train_edge_recon_loss: 25680533.0639; train_gene_expr_recon_loss: 20174435.0421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45873512.9637; train_optim_loss: 45873512.9637; val_kl_reg_loss: 17872.8851; val_edge_recon_loss: 25727041.8905; val_gene_expr_recon_loss: 20203629.7429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45948544.4762; val_optim_loss: 45948544.4762
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 18506.2676; train_edge_recon_loss: 25672074.1405; train_gene_expr_recon_loss: 20170115.1153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45860695.5240; train_optim_loss: 45860695.5240; val_kl_reg_loss: 19049.1457; val_edge_recon_loss: 25736331.1714; val_gene_expr_recon_loss: 20206752.6714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45962132.9238; val_optim_loss: 45962132.9238
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 18466.3242; train_edge_recon_loss: 25668030.8778; train_gene_expr_recon_loss: 20167704.0456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45854201.2563; train_optim_loss: 45854201.2563; val_kl_reg_loss: 17918.0200; val_edge_recon_loss: 25734244.5286; val_gene_expr_recon_loss: 20205620.6143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45957783.1714; val_optim_loss: 45957783.1714
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9838; val_best_f1_score: 0.9838; train_kl_reg_loss: 18417.0011; train_edge_recon_loss: 25657247.8622; train_gene_expr_recon_loss: 20163897.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45839562.1574; train_optim_loss: 45839562.1574; val_kl_reg_loss: 18845.8481; val_edge_recon_loss: 25733083.1381; val_gene_expr_recon_loss: 20196956.1286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45948885.1333; val_optim_loss: 45948885.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 18352.3113; train_edge_recon_loss: 25656653.4031; train_gene_expr_recon_loss: 20162489.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45837495.6671; train_optim_loss: 45837495.6671; val_kl_reg_loss: 17969.3099; val_edge_recon_loss: 25705378.4048; val_gene_expr_recon_loss: 20211781.8286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45935129.5238; val_optim_loss: 45935129.5238
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 18318.4236; train_edge_recon_loss: 25649223.6242; train_gene_expr_recon_loss: 20160626.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45828168.4421; train_optim_loss: 45828168.4421; val_kl_reg_loss: 18679.2534; val_edge_recon_loss: 25709217.0524; val_gene_expr_recon_loss: 20195973.4762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45923869.6667; val_optim_loss: 45923869.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 18275.6674; train_edge_recon_loss: 25640708.2385; train_gene_expr_recon_loss: 20158790.6849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45817774.5868; train_optim_loss: 45817774.5868; val_kl_reg_loss: 18612.6303; val_edge_recon_loss: 25720631.1810; val_gene_expr_recon_loss: 20196711.7762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45935955.6286; val_optim_loss: 45935955.6286
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 18234.9582; train_edge_recon_loss: 25636994.2131; train_gene_expr_recon_loss: 20155112.1018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45810341.3125; train_optim_loss: 45810341.3125; val_kl_reg_loss: 18188.1393; val_edge_recon_loss: 25698092.3762; val_gene_expr_recon_loss: 20194902.7048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45911183.1714; val_optim_loss: 45911183.1714
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 18188.4176; train_edge_recon_loss: 25630704.2285; train_gene_expr_recon_loss: 20152537.3332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45801429.9581; train_optim_loss: 45801429.9581; val_kl_reg_loss: 18025.6336; val_edge_recon_loss: 25694779.2238; val_gene_expr_recon_loss: 20209474.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45922279.7429; val_optim_loss: 45922279.7429
