None
Run timestamp: 07082023_121353_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '28', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1274644
Number of validation edges: 141627
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 7340.1746; train_edge_recon_loss: 263532.3176; train_gene_expr_recon_loss: 197495.6908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 468368.1829; train_optim_loss: 468368.1829; val_kl_reg_loss: 6833.3643; val_edge_recon_loss: 258770.3302; val_gene_expr_recon_loss: 182206.8057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447810.5015; val_optim_loss: 447810.5015
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 6764.0765; train_edge_recon_loss: 259106.3277; train_gene_expr_recon_loss: 178243.1451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444113.5494; train_optim_loss: 444113.5494; val_kl_reg_loss: 6666.7437; val_edge_recon_loss: 257329.6050; val_gene_expr_recon_loss: 176179.1642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440175.5131; val_optim_loss: 440175.5131
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6549.4265; train_edge_recon_loss: 257944.5611; train_gene_expr_recon_loss: 174765.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439259.1938; train_optim_loss: 439259.1938; val_kl_reg_loss: 6389.2026; val_edge_recon_loss: 256681.0415; val_gene_expr_recon_loss: 174367.5386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437437.7826; val_optim_loss: 437437.7826
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6466.7300; train_edge_recon_loss: 257274.2672; train_gene_expr_recon_loss: 173447.9252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437188.9227; train_optim_loss: 437188.9227; val_kl_reg_loss: 6411.0874; val_edge_recon_loss: 255822.5178; val_gene_expr_recon_loss: 173505.2972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435738.9017; val_optim_loss: 435738.9017
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9974; val_auprc_score: 0.9963; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6426.8523; train_edge_recon_loss: 256876.5981; train_gene_expr_recon_loss: 172883.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436186.6974; train_optim_loss: 436186.6974; val_kl_reg_loss: 6395.2115; val_edge_recon_loss: 255635.1047; val_gene_expr_recon_loss: 172943.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434973.8711; val_optim_loss: 434973.8711
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6407.9106; train_edge_recon_loss: 256606.8347; train_gene_expr_recon_loss: 172511.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435526.2470; train_optim_loss: 435526.2470; val_kl_reg_loss: 6370.6737; val_edge_recon_loss: 255388.7114; val_gene_expr_recon_loss: 172865.7230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434625.1086; val_optim_loss: 434625.1086
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6397.0612; train_edge_recon_loss: 256389.7899; train_gene_expr_recon_loss: 172300.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435087.0697; train_optim_loss: 435087.0697; val_kl_reg_loss: 6364.7702; val_edge_recon_loss: 255325.0189; val_gene_expr_recon_loss: 172720.0629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434409.8515; val_optim_loss: 434409.8515
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 6389.1610; train_edge_recon_loss: 256276.0298; train_gene_expr_recon_loss: 172121.3169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434786.5078; train_optim_loss: 434786.5078; val_kl_reg_loss: 6314.0854; val_edge_recon_loss: 255058.8681; val_gene_expr_recon_loss: 172729.8093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434102.7630; val_optim_loss: 434102.7630
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 6388.1423; train_edge_recon_loss: 256103.3393; train_gene_expr_recon_loss: 171932.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434423.9174; train_optim_loss: 434423.9174; val_kl_reg_loss: 6437.1428; val_edge_recon_loss: 255006.9759; val_gene_expr_recon_loss: 172621.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434065.4852; val_optim_loss: 434065.4852
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9903; val_best_f1_score: 0.9904; train_kl_reg_loss: 6389.8275; train_edge_recon_loss: 255996.0656; train_gene_expr_recon_loss: 171816.6089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434202.5020; train_optim_loss: 434202.5020; val_kl_reg_loss: 6375.6457; val_edge_recon_loss: 254811.8376; val_gene_expr_recon_loss: 172608.5120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433795.9956; val_optim_loss: 433795.9956
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9908; val_best_f1_score: 0.9908; train_kl_reg_loss: 6389.4400; train_edge_recon_loss: 255925.5354; train_gene_expr_recon_loss: 171737.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434052.0183; train_optim_loss: 434052.0183; val_kl_reg_loss: 6414.0523; val_edge_recon_loss: 254822.7651; val_gene_expr_recon_loss: 172466.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433703.8061; val_optim_loss: 433703.8061
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9908; val_best_f1_score: 0.9909; train_kl_reg_loss: 6395.1999; train_edge_recon_loss: 255774.0370; train_gene_expr_recon_loss: 171680.2194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433849.4564; train_optim_loss: 433849.4564; val_kl_reg_loss: 6483.5340; val_edge_recon_loss: 254872.7662; val_gene_expr_recon_loss: 172533.5724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433889.8709; val_optim_loss: 433889.8709
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9912; val_best_f1_score: 0.9913; train_kl_reg_loss: 6396.2784; train_edge_recon_loss: 255733.8630; train_gene_expr_recon_loss: 171536.5912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433666.7325; train_optim_loss: 433666.7325; val_kl_reg_loss: 6399.0698; val_edge_recon_loss: 254674.2240; val_gene_expr_recon_loss: 172485.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433558.9985; val_optim_loss: 433558.9985
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9914; val_best_f1_score: 0.9914; train_kl_reg_loss: 6396.8721; train_edge_recon_loss: 255671.1574; train_gene_expr_recon_loss: 171447.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433515.0628; train_optim_loss: 433515.0628; val_kl_reg_loss: 6379.1204; val_edge_recon_loss: 254580.7906; val_gene_expr_recon_loss: 172474.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433434.1224; val_optim_loss: 433434.1224
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9987; val_auprc_score: 0.9981; val_best_acc_score: 0.9917; val_best_f1_score: 0.9918; train_kl_reg_loss: 6401.5509; train_edge_recon_loss: 255604.9063; train_gene_expr_recon_loss: 171394.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433400.6630; train_optim_loss: 433400.6630; val_kl_reg_loss: 6410.6911; val_edge_recon_loss: 254508.3140; val_gene_expr_recon_loss: 172507.3983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433426.4022; val_optim_loss: 433426.4022
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9916; val_best_f1_score: 0.9916; train_kl_reg_loss: 6404.0912; train_edge_recon_loss: 255576.4958; train_gene_expr_recon_loss: 171346.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433326.9981; train_optim_loss: 433326.9981; val_kl_reg_loss: 6400.2178; val_edge_recon_loss: 254530.2753; val_gene_expr_recon_loss: 172456.8660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433387.3598; val_optim_loss: 433387.3598
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9987; val_auprc_score: 0.9982; val_best_acc_score: 0.9921; val_best_f1_score: 0.9921; train_kl_reg_loss: 6409.8598; train_edge_recon_loss: 255493.0937; train_gene_expr_recon_loss: 171256.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433159.0215; train_optim_loss: 433159.0215; val_kl_reg_loss: 6417.6675; val_edge_recon_loss: 254421.9385; val_gene_expr_recon_loss: 172303.5908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433143.1979; val_optim_loss: 433143.1979
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9920; val_best_f1_score: 0.9920; train_kl_reg_loss: 6410.9320; train_edge_recon_loss: 255516.9807; train_gene_expr_recon_loss: 171132.8189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433060.7312; train_optim_loss: 433060.7312; val_kl_reg_loss: 6416.0234; val_edge_recon_loss: 254622.1108; val_gene_expr_recon_loss: 172455.3304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433493.4641; val_optim_loss: 433493.4641
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9987; val_auprc_score: 0.9982; val_best_acc_score: 0.9921; val_best_f1_score: 0.9921; train_kl_reg_loss: 6416.4803; train_edge_recon_loss: 255435.4679; train_gene_expr_recon_loss: 171085.7429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432937.6912; train_optim_loss: 432937.6912; val_kl_reg_loss: 6428.6153; val_edge_recon_loss: 254577.4906; val_gene_expr_recon_loss: 172444.5472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433450.6538; val_optim_loss: 433450.6538
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9988; val_auprc_score: 0.9983; val_best_acc_score: 0.9923; val_best_f1_score: 0.9923; train_kl_reg_loss: 6419.6589; train_edge_recon_loss: 255433.9741; train_gene_expr_recon_loss: 171032.2944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432885.9279; train_optim_loss: 432885.9279; val_kl_reg_loss: 6435.8255; val_edge_recon_loss: 254400.1489; val_gene_expr_recon_loss: 172406.2129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433242.1864; val_optim_loss: 433242.1864
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9988; val_auprc_score: 0.9982; val_best_acc_score: 0.9924; val_best_f1_score: 0.9924; train_kl_reg_loss: 6425.0678; train_edge_recon_loss: 255342.3215; train_gene_expr_recon_loss: 171078.9634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432846.3528; train_optim_loss: 432846.3528; val_kl_reg_loss: 6423.1241; val_edge_recon_loss: 254390.2944; val_gene_expr_recon_loss: 172474.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433287.9512; val_optim_loss: 433287.9512

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9989; val_auprc_score: 0.9983; val_best_acc_score: 0.9928; val_best_f1_score: 0.9929; train_kl_reg_loss: 6448.5767; train_edge_recon_loss: 255245.9505; train_gene_expr_recon_loss: 170286.9114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431981.4385; train_optim_loss: 431981.4385; val_kl_reg_loss: 6453.9740; val_edge_recon_loss: 254326.7881; val_gene_expr_recon_loss: 172144.2797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432925.0423; val_optim_loss: 432925.0423
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9989; val_auprc_score: 0.9982; val_best_acc_score: 0.9929; val_best_f1_score: 0.9929; train_kl_reg_loss: 6454.6860; train_edge_recon_loss: 255262.2404; train_gene_expr_recon_loss: 170212.1557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431929.0821; train_optim_loss: 431929.0821; val_kl_reg_loss: 6446.3353; val_edge_recon_loss: 254220.8295; val_gene_expr_recon_loss: 171964.5907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432631.7562; val_optim_loss: 432631.7562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9988; val_auprc_score: 0.9984; val_best_acc_score: 0.9927; val_best_f1_score: 0.9927; train_kl_reg_loss: 6451.5433; train_edge_recon_loss: 255230.7434; train_gene_expr_recon_loss: 170144.2066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431826.4936; train_optim_loss: 431826.4936; val_kl_reg_loss: 6467.5876; val_edge_recon_loss: 254333.4500; val_gene_expr_recon_loss: 171839.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432640.9755; val_optim_loss: 432640.9755
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9990; val_auprc_score: 0.9985; val_best_acc_score: 0.9929; val_best_f1_score: 0.9930; train_kl_reg_loss: 6453.6869; train_edge_recon_loss: 255220.1275; train_gene_expr_recon_loss: 170159.0749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431832.8890; train_optim_loss: 431832.8890; val_kl_reg_loss: 6458.2944; val_edge_recon_loss: 254316.4579; val_gene_expr_recon_loss: 172055.6388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432830.3923; val_optim_loss: 432830.3923
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9989; val_auprc_score: 0.9982; val_best_acc_score: 0.9930; val_best_f1_score: 0.9930; train_kl_reg_loss: 6454.5889; train_edge_recon_loss: 255182.9460; train_gene_expr_recon_loss: 170091.1290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431728.6640; train_optim_loss: 431728.6640; val_kl_reg_loss: 6462.1550; val_edge_recon_loss: 254378.9786; val_gene_expr_recon_loss: 172083.9537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432925.0866; val_optim_loss: 432925.0866
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9989; val_auprc_score: 0.9983; val_best_acc_score: 0.9927; val_best_f1_score: 0.9928; train_kl_reg_loss: 6456.5277; train_edge_recon_loss: 255164.6938; train_gene_expr_recon_loss: 170061.8459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431683.0676; train_optim_loss: 431683.0676; val_kl_reg_loss: 6468.9656; val_edge_recon_loss: 254354.5904; val_gene_expr_recon_loss: 171972.7937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432796.3503; val_optim_loss: 432796.3503

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9990; val_auprc_score: 0.9985; val_best_acc_score: 0.9932; val_best_f1_score: 0.9932; train_kl_reg_loss: 6459.2817; train_edge_recon_loss: 255174.8312; train_gene_expr_recon_loss: 169949.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431583.5920; train_optim_loss: 431583.5920; val_kl_reg_loss: 6464.6713; val_edge_recon_loss: 254230.7985; val_gene_expr_recon_loss: 172022.7332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432718.2014; val_optim_loss: 432718.2014
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9990; val_auprc_score: 0.9983; val_best_acc_score: 0.9932; val_best_f1_score: 0.9932; train_kl_reg_loss: 6460.5153; train_edge_recon_loss: 255178.1951; train_gene_expr_recon_loss: 169970.8588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431609.5690; train_optim_loss: 431609.5690; val_kl_reg_loss: 6466.9886; val_edge_recon_loss: 254210.3852; val_gene_expr_recon_loss: 171979.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432656.9804; val_optim_loss: 432656.9804
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9989; val_auprc_score: 0.9984; val_best_acc_score: 0.9932; val_best_f1_score: 0.9932; train_kl_reg_loss: 6459.7175; train_edge_recon_loss: 255156.1991; train_gene_expr_recon_loss: 169961.7309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431577.6475; train_optim_loss: 431577.6475; val_kl_reg_loss: 6469.7237; val_edge_recon_loss: 254225.4561; val_gene_expr_recon_loss: 172214.9417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432910.1214; val_optim_loss: 432910.1214
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9929; val_best_f1_score: 0.9930; train_kl_reg_loss: 6459.9820; train_edge_recon_loss: 255155.4091; train_gene_expr_recon_loss: 169890.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431505.6119; train_optim_loss: 431505.6119; val_kl_reg_loss: 6465.6666; val_edge_recon_loss: 254267.3901; val_gene_expr_recon_loss: 172188.8827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432921.9391; val_optim_loss: 432921.9391

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 628 min 40 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9989
val AUPRC score: 0.9984
val best accuracy score: 0.9927
val best F1 score: 0.9928
val target rna MSE score: 0.5933
val source rna MSE score: 0.0273

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
