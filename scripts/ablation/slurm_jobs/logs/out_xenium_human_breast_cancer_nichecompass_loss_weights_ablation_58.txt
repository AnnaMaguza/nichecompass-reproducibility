None
Run timestamp: 28072023_135902_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9506; val_auprc_score: 0.9444; val_best_acc_score: 0.8826; val_best_f1_score: 0.8843; train_kl_reg_loss: 577.2153; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12731.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13309.1320; train_optim_loss: 13309.1320; val_kl_reg_loss: 524.1881; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11423.8985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11948.0866; val_optim_loss: 11948.0866
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9594; val_auprc_score: 0.9553; val_best_acc_score: 0.8946; val_best_f1_score: 0.8958; train_kl_reg_loss: 514.6789; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11289.6040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11804.2829; train_optim_loss: 11804.2829; val_kl_reg_loss: 490.1458; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10846.5674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11336.7132; val_optim_loss: 11336.7132
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9613; val_auprc_score: 0.9575; val_best_acc_score: 0.8970; val_best_f1_score: 0.8983; train_kl_reg_loss: 492.6909; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10896.2411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11388.9320; train_optim_loss: 11388.9320; val_kl_reg_loss: 463.2219; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10615.1537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11078.3756; val_optim_loss: 11078.3756
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9635; val_auprc_score: 0.9599; val_best_acc_score: 0.9006; val_best_f1_score: 0.9020; train_kl_reg_loss: 482.7486; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10724.4037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11207.1523; train_optim_loss: 11207.1523; val_kl_reg_loss: 470.1657; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10493.5923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10963.7580; val_optim_loss: 10963.7580
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9643; val_auprc_score: 0.9610; val_best_acc_score: 0.9016; val_best_f1_score: 0.9027; train_kl_reg_loss: 477.0177; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10635.8918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11112.9094; train_optim_loss: 11112.9094; val_kl_reg_loss: 466.0343; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10429.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10895.4787; val_optim_loss: 10895.4787
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9650; val_auprc_score: 0.9616; val_best_acc_score: 0.9025; val_best_f1_score: 0.9045; train_kl_reg_loss: 474.2452; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10586.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11060.3626; train_optim_loss: 11060.3626; val_kl_reg_loss: 469.2012; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10396.1038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10865.3050; val_optim_loss: 10865.3050
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9645; val_auprc_score: 0.9607; val_best_acc_score: 0.9021; val_best_f1_score: 0.9040; train_kl_reg_loss: 472.8963; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10553.8388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11026.7351; train_optim_loss: 11026.7351; val_kl_reg_loss: 460.5642; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10380.1188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10840.6830; val_optim_loss: 10840.6830
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9621; val_auprc_score: 0.9586; val_best_acc_score: 0.8978; val_best_f1_score: 0.8995; train_kl_reg_loss: 472.4597; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10542.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11015.0384; train_optim_loss: 11015.0384; val_kl_reg_loss: 464.5858; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10374.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10839.5602; val_optim_loss: 10839.5602
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9634; val_auprc_score: 0.9595; val_best_acc_score: 0.9013; val_best_f1_score: 0.9029; train_kl_reg_loss: 471.2644; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10523.5608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10994.8252; train_optim_loss: 10994.8252; val_kl_reg_loss: 479.0015; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10358.3058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10837.3073; val_optim_loss: 10837.3073
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9652; val_auprc_score: 0.9625; val_best_acc_score: 0.9022; val_best_f1_score: 0.9033; train_kl_reg_loss: 470.5123; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10514.5686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10985.0809; train_optim_loss: 10985.0809; val_kl_reg_loss: 468.7029; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10353.7933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10822.4962; val_optim_loss: 10822.4962
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9657; val_auprc_score: 0.9628; val_best_acc_score: 0.9036; val_best_f1_score: 0.9042; train_kl_reg_loss: 469.7036; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10509.3060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10979.0096; train_optim_loss: 10979.0096; val_kl_reg_loss: 469.2859; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10344.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10813.8402; val_optim_loss: 10813.8402
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9651; val_auprc_score: 0.9622; val_best_acc_score: 0.9026; val_best_f1_score: 0.9036; train_kl_reg_loss: 469.4803; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10506.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10975.9825; train_optim_loss: 10975.9825; val_kl_reg_loss: 467.6926; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10321.3640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10789.0566; val_optim_loss: 10789.0566
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9660; val_auprc_score: 0.9628; val_best_acc_score: 0.9034; val_best_f1_score: 0.9053; train_kl_reg_loss: 468.6637; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10501.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10970.4397; train_optim_loss: 10970.4397; val_kl_reg_loss: 457.6578; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10341.0472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10798.7049; val_optim_loss: 10798.7049
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9666; val_auprc_score: 0.9637; val_best_acc_score: 0.9051; val_best_f1_score: 0.9064; train_kl_reg_loss: 467.5956; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10498.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10965.8197; train_optim_loss: 10965.8197; val_kl_reg_loss: 450.4847; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10346.3440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10796.8286; val_optim_loss: 10796.8286
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9682; val_auprc_score: 0.9654; val_best_acc_score: 0.9080; val_best_f1_score: 0.9094; train_kl_reg_loss: 466.8500; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10494.3453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10961.1953; train_optim_loss: 10961.1953; val_kl_reg_loss: 452.6898; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10349.1260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10801.8158; val_optim_loss: 10801.8158
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9648; val_auprc_score: 0.9614; val_best_acc_score: 0.9019; val_best_f1_score: 0.9037; train_kl_reg_loss: 466.8451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10493.4963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10960.3415; train_optim_loss: 10960.3415; val_kl_reg_loss: 460.0220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10332.2544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10792.2764; val_optim_loss: 10792.2764

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9672; val_auprc_score: 0.9647; val_best_acc_score: 0.9049; val_best_f1_score: 0.9068; train_kl_reg_loss: 464.0353; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10455.3405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10919.3759; train_optim_loss: 10919.3759; val_kl_reg_loss: 457.7220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10324.7847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10782.5067; val_optim_loss: 10782.5067
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9680; val_auprc_score: 0.9655; val_best_acc_score: 0.9061; val_best_f1_score: 0.9083; train_kl_reg_loss: 464.1229; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10450.3792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10914.5020; train_optim_loss: 10914.5020; val_kl_reg_loss: 457.7281; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10300.1861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10757.9142; val_optim_loss: 10757.9142
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9679; val_auprc_score: 0.9655; val_best_acc_score: 0.9060; val_best_f1_score: 0.9079; train_kl_reg_loss: 464.0183; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10447.2815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10911.2998; train_optim_loss: 10911.2998; val_kl_reg_loss: 460.4246; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10318.9109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10779.3356; val_optim_loss: 10779.3356
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9675; val_auprc_score: 0.9649; val_best_acc_score: 0.9057; val_best_f1_score: 0.9075; train_kl_reg_loss: 464.0822; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10445.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10909.6780; train_optim_loss: 10909.6780; val_kl_reg_loss: 458.2304; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10313.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10771.8202; val_optim_loss: 10771.8202
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9677; val_auprc_score: 0.9648; val_best_acc_score: 0.9056; val_best_f1_score: 0.9076; train_kl_reg_loss: 464.2222; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10446.7672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10910.9894; train_optim_loss: 10910.9894; val_kl_reg_loss: 460.2884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10314.8183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10775.1067; val_optim_loss: 10775.1067
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9673; val_auprc_score: 0.9646; val_best_acc_score: 0.9051; val_best_f1_score: 0.9068; train_kl_reg_loss: 464.4770; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10446.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10910.5413; train_optim_loss: 10910.5413; val_kl_reg_loss: 458.0492; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10304.2772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10762.3264; val_optim_loss: 10762.3264

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9682; val_auprc_score: 0.9657; val_best_acc_score: 0.9067; val_best_f1_score: 0.9086; train_kl_reg_loss: 464.3238; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10441.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10905.8681; train_optim_loss: 10905.8681; val_kl_reg_loss: 457.3593; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10280.7840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10738.1433; val_optim_loss: 10738.1433
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9680; val_auprc_score: 0.9653; val_best_acc_score: 0.9066; val_best_f1_score: 0.9083; train_kl_reg_loss: 464.2539; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10439.9579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10904.2118; train_optim_loss: 10904.2118; val_kl_reg_loss: 458.2478; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10304.1550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10762.4028; val_optim_loss: 10762.4028
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9679; val_auprc_score: 0.9653; val_best_acc_score: 0.9066; val_best_f1_score: 0.9086; train_kl_reg_loss: 464.4542; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10444.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10908.5033; train_optim_loss: 10908.5033; val_kl_reg_loss: 458.6258; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10306.9888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10765.6146; val_optim_loss: 10765.6146
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9682; val_auprc_score: 0.9656; val_best_acc_score: 0.9067; val_best_f1_score: 0.9087; train_kl_reg_loss: 464.4546; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10438.0683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10902.5229; train_optim_loss: 10902.5229; val_kl_reg_loss: 458.4739; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10302.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10760.8110; val_optim_loss: 10760.8110
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9689; val_auprc_score: 0.9665; val_best_acc_score: 0.9078; val_best_f1_score: 0.9096; train_kl_reg_loss: 464.2418; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10442.2372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10906.4790; train_optim_loss: 10906.4790; val_kl_reg_loss: 458.5214; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10327.8647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10786.3861; val_optim_loss: 10786.3861

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9681; val_auprc_score: 0.9655; val_best_acc_score: 0.9066; val_best_f1_score: 0.9086; train_kl_reg_loss: 464.1082; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10437.7549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10901.8631; train_optim_loss: 10901.8631; val_kl_reg_loss: 458.1836; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10298.1732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10756.3568; val_optim_loss: 10756.3568
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9677; val_auprc_score: 0.9651; val_best_acc_score: 0.9055; val_best_f1_score: 0.9076; train_kl_reg_loss: 464.0408; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10432.6171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10896.6580; train_optim_loss: 10896.6580; val_kl_reg_loss: 458.3947; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10299.9420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10758.3366; val_optim_loss: 10758.3366
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9680; val_auprc_score: 0.9654; val_best_acc_score: 0.9071; val_best_f1_score: 0.9090; train_kl_reg_loss: 464.2856; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10440.0038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10904.2894; train_optim_loss: 10904.2894; val_kl_reg_loss: 458.4522; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10309.5456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10767.9978; val_optim_loss: 10767.9978
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9681; val_auprc_score: 0.9655; val_best_acc_score: 0.9064; val_best_f1_score: 0.9084; train_kl_reg_loss: 464.3675; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10443.5245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10907.8921; train_optim_loss: 10907.8921; val_kl_reg_loss: 458.5858; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10306.0304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10764.6162; val_optim_loss: 10764.6162

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 112 min 53 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9681
val AUPRC score: 0.9657
val best accuracy score: 0.9063
val best F1 score: 0.9083
val target rna MSE score: 1.3584
val source rna MSE score: 0.1635

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
