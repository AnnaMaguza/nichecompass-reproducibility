None
Run timestamp: 28072023_113856_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9883; val_auprc_score: 0.9852; val_best_acc_score: 0.9556; val_best_f1_score: 0.9565; train_kl_reg_loss: 4286.7345; train_edge_recon_loss: 30759.7549; train_gene_expr_recon_loss: 201349.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 236396.3174; train_optim_loss: 236396.3174; val_kl_reg_loss: 3993.7398; val_edge_recon_loss: 28889.5712; val_gene_expr_recon_loss: 187952.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 220835.5186; val_optim_loss: 220835.5186
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9897; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 3781.9825; train_edge_recon_loss: 28926.6420; train_gene_expr_recon_loss: 181644.4942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 214353.1184; train_optim_loss: 214353.1184; val_kl_reg_loss: 3617.2914; val_edge_recon_loss: 28094.9149; val_gene_expr_recon_loss: 179087.3518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 210799.5580; val_optim_loss: 210799.5580
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 3587.4055; train_edge_recon_loss: 28423.2843; train_gene_expr_recon_loss: 175398.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 207409.0781; train_optim_loss: 207409.0781; val_kl_reg_loss: 3495.5842; val_edge_recon_loss: 27659.9938; val_gene_expr_recon_loss: 174644.5627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 205800.1412; val_optim_loss: 205800.1412
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9936; val_auprc_score: 0.9924; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 3506.6560; train_edge_recon_loss: 28123.2952; train_gene_expr_recon_loss: 171881.8002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 203511.7516; train_optim_loss: 203511.7516; val_kl_reg_loss: 3541.8304; val_edge_recon_loss: 27448.3201; val_gene_expr_recon_loss: 172115.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203105.4150; val_optim_loss: 203105.4150
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9949; val_auprc_score: 0.9940; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 3478.1422; train_edge_recon_loss: 27915.3407; train_gene_expr_recon_loss: 169697.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201091.0252; train_optim_loss: 201091.0252; val_kl_reg_loss: 3492.1029; val_edge_recon_loss: 27233.9994; val_gene_expr_recon_loss: 171062.7301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201788.8322; val_optim_loss: 201788.8322
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 3473.2126; train_edge_recon_loss: 27774.7183; train_gene_expr_recon_loss: 168182.0470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 199429.9782; train_optim_loss: 199429.9782; val_kl_reg_loss: 3470.4918; val_edge_recon_loss: 27108.1398; val_gene_expr_recon_loss: 169192.8129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 199771.4447; val_optim_loss: 199771.4447
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9955; val_auprc_score: 0.9948; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 3485.0217; train_edge_recon_loss: 27661.0144; train_gene_expr_recon_loss: 167103.1965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 198249.2325; train_optim_loss: 198249.2325; val_kl_reg_loss: 3526.4648; val_edge_recon_loss: 27002.0532; val_gene_expr_recon_loss: 168942.3998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 199470.9176; val_optim_loss: 199470.9176
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 3502.5670; train_edge_recon_loss: 27568.6211; train_gene_expr_recon_loss: 166336.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 197408.1373; train_optim_loss: 197408.1373; val_kl_reg_loss: 3523.9530; val_edge_recon_loss: 26901.6990; val_gene_expr_recon_loss: 168369.7096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198795.3615; val_optim_loss: 198795.3615
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 3521.7253; train_edge_recon_loss: 27511.9209; train_gene_expr_recon_loss: 165637.0886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 196670.7350; train_optim_loss: 196670.7350; val_kl_reg_loss: 3503.8470; val_edge_recon_loss: 26858.8795; val_gene_expr_recon_loss: 168181.8137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198544.5400; val_optim_loss: 198544.5400
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9747; val_best_f1_score: 0.9749; train_kl_reg_loss: 3543.8894; train_edge_recon_loss: 27457.0584; train_gene_expr_recon_loss: 165105.5258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 196106.4735; train_optim_loss: 196106.4735; val_kl_reg_loss: 3535.8247; val_edge_recon_loss: 26787.5866; val_gene_expr_recon_loss: 167652.5447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197975.9557; val_optim_loss: 197975.9557
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 3566.4558; train_edge_recon_loss: 27418.6452; train_gene_expr_recon_loss: 164791.1008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 195776.2021; train_optim_loss: 195776.2021; val_kl_reg_loss: 3582.5883; val_edge_recon_loss: 26756.4493; val_gene_expr_recon_loss: 167538.2518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197877.2896; val_optim_loss: 197877.2896
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 3590.8596; train_edge_recon_loss: 27380.4350; train_gene_expr_recon_loss: 164426.5893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 195397.8838; train_optim_loss: 195397.8838; val_kl_reg_loss: 3565.3204; val_edge_recon_loss: 26772.1377; val_gene_expr_recon_loss: 167680.4080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198017.8666; val_optim_loss: 198017.8666
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9764; val_best_f1_score: 0.9765; train_kl_reg_loss: 3615.2549; train_edge_recon_loss: 27344.1053; train_gene_expr_recon_loss: 164216.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 195175.5093; train_optim_loss: 195175.5093; val_kl_reg_loss: 3583.9947; val_edge_recon_loss: 26749.9132; val_gene_expr_recon_loss: 167236.8568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197570.7645; val_optim_loss: 197570.7645
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 3635.5287; train_edge_recon_loss: 27327.6146; train_gene_expr_recon_loss: 163936.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194899.8822; train_optim_loss: 194899.8822; val_kl_reg_loss: 3560.6949; val_edge_recon_loss: 26736.0283; val_gene_expr_recon_loss: 167373.1883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197669.9117; val_optim_loss: 197669.9117
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 3657.1184; train_edge_recon_loss: 27300.8836; train_gene_expr_recon_loss: 163683.7870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194641.7887; train_optim_loss: 194641.7887; val_kl_reg_loss: 3637.7209; val_edge_recon_loss: 26751.7349; val_gene_expr_recon_loss: 167706.1893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198095.6457; val_optim_loss: 198095.6457
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 3680.1900; train_edge_recon_loss: 27285.0555; train_gene_expr_recon_loss: 163639.2603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194604.5058; train_optim_loss: 194604.5058; val_kl_reg_loss: 3665.7214; val_edge_recon_loss: 26734.5844; val_gene_expr_recon_loss: 167201.7582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197602.0639; val_optim_loss: 197602.0639
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 3700.9126; train_edge_recon_loss: 27262.8397; train_gene_expr_recon_loss: 163321.1545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194284.9067; train_optim_loss: 194284.9067; val_kl_reg_loss: 3689.5049; val_edge_recon_loss: 26696.1819; val_gene_expr_recon_loss: 167173.4592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197559.1459; val_optim_loss: 197559.1459
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 3719.0837; train_edge_recon_loss: 27252.3604; train_gene_expr_recon_loss: 163286.3450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194257.7889; train_optim_loss: 194257.7889; val_kl_reg_loss: 3685.0925; val_edge_recon_loss: 26710.8124; val_gene_expr_recon_loss: 167740.9918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198136.8961; val_optim_loss: 198136.8961
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 3737.9863; train_edge_recon_loss: 27242.4830; train_gene_expr_recon_loss: 163128.3957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194108.8650; train_optim_loss: 194108.8650; val_kl_reg_loss: 3701.1568; val_edge_recon_loss: 26677.6922; val_gene_expr_recon_loss: 167202.2650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197581.1133; val_optim_loss: 197581.1133
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 3754.8072; train_edge_recon_loss: 27233.1022; train_gene_expr_recon_loss: 162969.7974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193957.7069; train_optim_loss: 193957.7069; val_kl_reg_loss: 3741.4014; val_edge_recon_loss: 26700.0113; val_gene_expr_recon_loss: 167316.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197757.8230; val_optim_loss: 197757.8230
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 3771.5332; train_edge_recon_loss: 27217.0885; train_gene_expr_recon_loss: 162824.2060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193812.8277; train_optim_loss: 193812.8277; val_kl_reg_loss: 3786.2702; val_edge_recon_loss: 26713.8962; val_gene_expr_recon_loss: 167802.4816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198302.6480; val_optim_loss: 198302.6480

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 3781.4107; train_edge_recon_loss: 27152.4597; train_gene_expr_recon_loss: 162202.2099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193136.0802; train_optim_loss: 193136.0802; val_kl_reg_loss: 3754.3959; val_edge_recon_loss: 26656.0198; val_gene_expr_recon_loss: 167066.3311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197476.7467; val_optim_loss: 197476.7467
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 3773.5861; train_edge_recon_loss: 27162.4426; train_gene_expr_recon_loss: 161954.4894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192890.5181; train_optim_loss: 192890.5181; val_kl_reg_loss: 3746.4672; val_edge_recon_loss: 26662.0051; val_gene_expr_recon_loss: 167389.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197798.0775; val_optim_loss: 197798.0775
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 3774.1564; train_edge_recon_loss: 27157.1591; train_gene_expr_recon_loss: 162024.2343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192955.5498; train_optim_loss: 192955.5498; val_kl_reg_loss: 3739.1170; val_edge_recon_loss: 26668.0417; val_gene_expr_recon_loss: 167252.9285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197660.0873; val_optim_loss: 197660.0873
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 3774.0361; train_edge_recon_loss: 27161.9945; train_gene_expr_recon_loss: 161956.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192892.9720; train_optim_loss: 192892.9720; val_kl_reg_loss: 3754.0163; val_edge_recon_loss: 26658.8876; val_gene_expr_recon_loss: 167633.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198046.4295; val_optim_loss: 198046.4295
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 3776.4832; train_edge_recon_loss: 27164.9014; train_gene_expr_recon_loss: 161906.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192848.1162; train_optim_loss: 192848.1162; val_kl_reg_loss: 3751.8195; val_edge_recon_loss: 26658.2724; val_gene_expr_recon_loss: 167488.1744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197898.2668; val_optim_loss: 197898.2668

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 3779.6320; train_edge_recon_loss: 27158.6158; train_gene_expr_recon_loss: 161812.2217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192750.4694; train_optim_loss: 192750.4694; val_kl_reg_loss: 3749.5005; val_edge_recon_loss: 26670.9062; val_gene_expr_recon_loss: 167503.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197923.5217; val_optim_loss: 197923.5217
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 3777.7871; train_edge_recon_loss: 27150.7819; train_gene_expr_recon_loss: 161812.7155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192741.2848; train_optim_loss: 192741.2848; val_kl_reg_loss: 3746.2473; val_edge_recon_loss: 26670.4782; val_gene_expr_recon_loss: 167036.9820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197453.7082; val_optim_loss: 197453.7082
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 3778.2326; train_edge_recon_loss: 27153.6043; train_gene_expr_recon_loss: 161727.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192658.9836; train_optim_loss: 192658.9836; val_kl_reg_loss: 3748.7255; val_edge_recon_loss: 26667.7125; val_gene_expr_recon_loss: 167462.8535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197879.2918; val_optim_loss: 197879.2918
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 3778.1360; train_edge_recon_loss: 27147.4588; train_gene_expr_recon_loss: 161871.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192796.8973; train_optim_loss: 192796.8973; val_kl_reg_loss: 3751.6562; val_edge_recon_loss: 26637.8624; val_gene_expr_recon_loss: 167663.1959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198052.7150; val_optim_loss: 198052.7150
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 3779.5201; train_edge_recon_loss: 27158.4113; train_gene_expr_recon_loss: 161833.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192771.2819; train_optim_loss: 192771.2819; val_kl_reg_loss: 3756.2080; val_edge_recon_loss: 26666.5053; val_gene_expr_recon_loss: 167442.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197864.8414; val_optim_loss: 197864.8414
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 3778.1203; train_edge_recon_loss: 27152.2526; train_gene_expr_recon_loss: 161869.5433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192799.9162; train_optim_loss: 192799.9162; val_kl_reg_loss: 3749.0203; val_edge_recon_loss: 26664.7191; val_gene_expr_recon_loss: 167495.7674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197909.5072; val_optim_loss: 197909.5072

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9796; val_best_f1_score: 0.9796; train_kl_reg_loss: 3777.4202; train_edge_recon_loss: 27152.3656; train_gene_expr_recon_loss: 161765.3942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192695.1800; train_optim_loss: 192695.1800; val_kl_reg_loss: 3748.1958; val_edge_recon_loss: 26656.4251; val_gene_expr_recon_loss: 167202.9760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197607.5971; val_optim_loss: 197607.5971
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 3777.5004; train_edge_recon_loss: 27163.9106; train_gene_expr_recon_loss: 161868.7736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192810.1846; train_optim_loss: 192810.1846; val_kl_reg_loss: 3751.0933; val_edge_recon_loss: 26665.8207; val_gene_expr_recon_loss: 167723.6877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198140.6016; val_optim_loss: 198140.6016
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 3777.5623; train_edge_recon_loss: 27151.0366; train_gene_expr_recon_loss: 161739.3002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192667.8989; train_optim_loss: 192667.8989; val_kl_reg_loss: 3748.8506; val_edge_recon_loss: 26686.4715; val_gene_expr_recon_loss: 167378.7854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197814.1078; val_optim_loss: 197814.1078
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 3777.7229; train_edge_recon_loss: 27146.9510; train_gene_expr_recon_loss: 161837.8981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192762.5723; train_optim_loss: 192762.5723; val_kl_reg_loss: 3749.3334; val_edge_recon_loss: 26657.5547; val_gene_expr_recon_loss: 167599.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198006.8844; val_optim_loss: 198006.8844

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 254 min 10 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9966
Val best accuracy score: 0.9791
Val best F1 score: 0.9793
Val target rna MSE score: 0.6296
Val source rna MSE score: 0.0272

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
