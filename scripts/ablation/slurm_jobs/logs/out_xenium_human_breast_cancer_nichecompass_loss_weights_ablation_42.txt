None
Run timestamp: 29062023_010724_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9778; val_auprc_score: 0.9732; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 6734.3441; train_edge_recon_loss: 267722.6978; train_gene_expr_recon_loss: 132007.0357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406464.0785; train_optim_loss: 406464.0785; val_kl_reg_loss: 6983.7542; val_edge_recon_loss: 263832.0144; val_gene_expr_recon_loss: 126366.7385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397182.5075; val_optim_loss: 397182.5075
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9821; val_auprc_score: 0.9785; val_best_acc_score: 0.9380; val_best_f1_score: 0.9395; train_kl_reg_loss: 7072.5031; train_edge_recon_loss: 262296.5974; train_gene_expr_recon_loss: 124251.3669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393620.4676; train_optim_loss: 393620.4676; val_kl_reg_loss: 6981.9750; val_edge_recon_loss: 263139.3612; val_gene_expr_recon_loss: 122444.9339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392566.2701; val_optim_loss: 392566.2701
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9847; val_auprc_score: 0.9818; val_best_acc_score: 0.9443; val_best_f1_score: 0.9456; train_kl_reg_loss: 7163.6833; train_edge_recon_loss: 261643.9419; train_gene_expr_recon_loss: 121557.5534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390365.1788; train_optim_loss: 390365.1788; val_kl_reg_loss: 7092.4600; val_edge_recon_loss: 262674.2149; val_gene_expr_recon_loss: 120458.6374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390225.3129; val_optim_loss: 390225.3129
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9855; val_auprc_score: 0.9826; val_best_acc_score: 0.9469; val_best_f1_score: 0.9481; train_kl_reg_loss: 7196.0265; train_edge_recon_loss: 261308.3394; train_gene_expr_recon_loss: 120273.1153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388777.4806; train_optim_loss: 388777.4806; val_kl_reg_loss: 7056.0965; val_edge_recon_loss: 262203.9158; val_gene_expr_recon_loss: 119677.5629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388937.5760; val_optim_loss: 388937.5760
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9861; val_auprc_score: 0.9833; val_best_acc_score: 0.9483; val_best_f1_score: 0.9497; train_kl_reg_loss: 7204.5327; train_edge_recon_loss: 260944.3145; train_gene_expr_recon_loss: 119502.0620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387650.9086; train_optim_loss: 387650.9086; val_kl_reg_loss: 7154.3458; val_edge_recon_loss: 261978.2460; val_gene_expr_recon_loss: 119225.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388357.8012; val_optim_loss: 388357.8012
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9843; val_best_acc_score: 0.9513; val_best_f1_score: 0.9523; train_kl_reg_loss: 7198.6095; train_edge_recon_loss: 260748.8475; train_gene_expr_recon_loss: 119103.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387050.9605; train_optim_loss: 387050.9605; val_kl_reg_loss: 7116.1024; val_edge_recon_loss: 261693.8160; val_gene_expr_recon_loss: 118707.5089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387517.4270; val_optim_loss: 387517.4270
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9883; val_auprc_score: 0.9859; val_best_acc_score: 0.9527; val_best_f1_score: 0.9535; train_kl_reg_loss: 7190.3649; train_edge_recon_loss: 260623.5375; train_gene_expr_recon_loss: 118765.4284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386579.3306; train_optim_loss: 386579.3306; val_kl_reg_loss: 7139.1511; val_edge_recon_loss: 261431.2051; val_gene_expr_recon_loss: 118480.8350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387051.1916; val_optim_loss: 387051.1916
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9874; val_auprc_score: 0.9845; val_best_acc_score: 0.9520; val_best_f1_score: 0.9531; train_kl_reg_loss: 7188.7194; train_edge_recon_loss: 260479.6546; train_gene_expr_recon_loss: 118545.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386213.4494; train_optim_loss: 386213.4494; val_kl_reg_loss: 7102.1060; val_edge_recon_loss: 261834.1204; val_gene_expr_recon_loss: 118458.1664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387394.3921; val_optim_loss: 387394.3921
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9883; val_auprc_score: 0.9857; val_best_acc_score: 0.9541; val_best_f1_score: 0.9551; train_kl_reg_loss: 7178.6486; train_edge_recon_loss: 260401.0566; train_gene_expr_recon_loss: 118412.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385991.8227; train_optim_loss: 385991.8227; val_kl_reg_loss: 7054.4534; val_edge_recon_loss: 261369.9572; val_gene_expr_recon_loss: 118186.1361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386610.5464; val_optim_loss: 386610.5464
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9851; val_best_acc_score: 0.9529; val_best_f1_score: 0.9539; train_kl_reg_loss: 7164.9863; train_edge_recon_loss: 260323.5644; train_gene_expr_recon_loss: 118318.1002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385806.6513; train_optim_loss: 385806.6513; val_kl_reg_loss: 7072.4886; val_edge_recon_loss: 261673.4273; val_gene_expr_recon_loss: 118131.9683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386877.8842; val_optim_loss: 386877.8842
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9884; val_auprc_score: 0.9857; val_best_acc_score: 0.9547; val_best_f1_score: 0.9556; train_kl_reg_loss: 7163.4097; train_edge_recon_loss: 260188.5766; train_gene_expr_recon_loss: 118200.2494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385552.2356; train_optim_loss: 385552.2356; val_kl_reg_loss: 7121.8845; val_edge_recon_loss: 261410.1904; val_gene_expr_recon_loss: 118019.1899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386551.2650; val_optim_loss: 386551.2650
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9861; val_best_acc_score: 0.9539; val_best_f1_score: 0.9547; train_kl_reg_loss: 7159.0770; train_edge_recon_loss: 260207.0784; train_gene_expr_recon_loss: 118184.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385550.7852; train_optim_loss: 385550.7852; val_kl_reg_loss: 7006.1640; val_edge_recon_loss: 261490.1467; val_gene_expr_recon_loss: 118025.7010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386522.0107; val_optim_loss: 386522.0107
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9886; val_auprc_score: 0.9862; val_best_acc_score: 0.9546; val_best_f1_score: 0.9554; train_kl_reg_loss: 7154.3198; train_edge_recon_loss: 260099.0915; train_gene_expr_recon_loss: 118061.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385314.4958; train_optim_loss: 385314.4958; val_kl_reg_loss: 7077.6457; val_edge_recon_loss: 261416.9928; val_gene_expr_recon_loss: 118192.8734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386687.5098; val_optim_loss: 386687.5098
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9870; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 7147.9775; train_edge_recon_loss: 260053.9525; train_gene_expr_recon_loss: 118068.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385270.0032; train_optim_loss: 385270.0032; val_kl_reg_loss: 7224.0756; val_edge_recon_loss: 261182.8801; val_gene_expr_recon_loss: 118035.4471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386442.4026; val_optim_loss: 386442.4026
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9884; val_auprc_score: 0.9857; val_best_acc_score: 0.9562; val_best_f1_score: 0.9570; train_kl_reg_loss: 7144.3382; train_edge_recon_loss: 260087.4866; train_gene_expr_recon_loss: 118052.7809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385284.6052; train_optim_loss: 385284.6052; val_kl_reg_loss: 7003.2213; val_edge_recon_loss: 261152.8043; val_gene_expr_recon_loss: 118174.0597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386330.0854; val_optim_loss: 386330.0854
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9888; val_auprc_score: 0.9863; val_best_acc_score: 0.9564; val_best_f1_score: 0.9574; train_kl_reg_loss: 7142.9691; train_edge_recon_loss: 259897.5040; train_gene_expr_recon_loss: 117966.6323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385007.1047; train_optim_loss: 385007.1047; val_kl_reg_loss: 7090.7271; val_edge_recon_loss: 260801.6286; val_gene_expr_recon_loss: 118090.3606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385982.7160; val_optim_loss: 385982.7160
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9885; val_auprc_score: 0.9857; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 7140.4576; train_edge_recon_loss: 259833.8835; train_gene_expr_recon_loss: 117962.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384937.0645; train_optim_loss: 384937.0645; val_kl_reg_loss: 7015.9486; val_edge_recon_loss: 260888.3561; val_gene_expr_recon_loss: 117908.6528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385812.9555; val_optim_loss: 385812.9555
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9862; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 7135.6587; train_edge_recon_loss: 259846.7055; train_gene_expr_recon_loss: 117869.3263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384851.6907; train_optim_loss: 384851.6907; val_kl_reg_loss: 6965.7084; val_edge_recon_loss: 260838.9222; val_gene_expr_recon_loss: 117713.4456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385518.0773; val_optim_loss: 385518.0773
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9898; val_auprc_score: 0.9873; val_best_acc_score: 0.9591; val_best_f1_score: 0.9597; train_kl_reg_loss: 7130.5071; train_edge_recon_loss: 259884.5309; train_gene_expr_recon_loss: 117895.4668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384910.5042; train_optim_loss: 384910.5042; val_kl_reg_loss: 7076.1889; val_edge_recon_loss: 260555.1574; val_gene_expr_recon_loss: 117710.3259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385341.6685; val_optim_loss: 385341.6685
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9862; val_best_acc_score: 0.9575; val_best_f1_score: 0.9583; train_kl_reg_loss: 7127.7263; train_edge_recon_loss: 259805.9429; train_gene_expr_recon_loss: 117852.0985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384785.7673; train_optim_loss: 384785.7673; val_kl_reg_loss: 6984.6876; val_edge_recon_loss: 260868.7786; val_gene_expr_recon_loss: 117712.7847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385566.2513; val_optim_loss: 385566.2513
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9886; val_auprc_score: 0.9859; val_best_acc_score: 0.9569; val_best_f1_score: 0.9578; train_kl_reg_loss: 7122.5420; train_edge_recon_loss: 259858.6013; train_gene_expr_recon_loss: 117798.3378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384779.4808; train_optim_loss: 384779.4808; val_kl_reg_loss: 7037.2165; val_edge_recon_loss: 261110.3781; val_gene_expr_recon_loss: 117944.5385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386092.1333; val_optim_loss: 386092.1333
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9894; val_auprc_score: 0.9870; val_best_acc_score: 0.9575; val_best_f1_score: 0.9583; train_kl_reg_loss: 7122.7664; train_edge_recon_loss: 259669.7370; train_gene_expr_recon_loss: 117780.0604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384572.5640; train_optim_loss: 384572.5640; val_kl_reg_loss: 7114.8271; val_edge_recon_loss: 260517.1685; val_gene_expr_recon_loss: 117761.6723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385393.6682; val_optim_loss: 385393.6682
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9893; val_auprc_score: 0.9869; val_best_acc_score: 0.9574; val_best_f1_score: 0.9582; train_kl_reg_loss: 7117.6235; train_edge_recon_loss: 259677.1842; train_gene_expr_recon_loss: 117772.7901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384567.5981; train_optim_loss: 384567.5981; val_kl_reg_loss: 6947.7937; val_edge_recon_loss: 260756.9492; val_gene_expr_recon_loss: 117782.1871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385486.9300; val_optim_loss: 385486.9300

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9903; val_auprc_score: 0.9880; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 7092.9390; train_edge_recon_loss: 259424.9247; train_gene_expr_recon_loss: 116748.7375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383266.6015; train_optim_loss: 383266.6015; val_kl_reg_loss: 6960.6951; val_edge_recon_loss: 260067.0742; val_gene_expr_recon_loss: 116710.3013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383738.0702; val_optim_loss: 383738.0702
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9591; val_best_f1_score: 0.9599; train_kl_reg_loss: 7034.4442; train_edge_recon_loss: 259475.3381; train_gene_expr_recon_loss: 116642.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383152.4644; train_optim_loss: 383152.4644; val_kl_reg_loss: 6966.9452; val_edge_recon_loss: 260432.0497; val_gene_expr_recon_loss: 116703.3282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384102.3234; val_optim_loss: 384102.3234
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9898; val_auprc_score: 0.9871; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 7005.9404; train_edge_recon_loss: 259455.9731; train_gene_expr_recon_loss: 116583.8936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383045.8074; train_optim_loss: 383045.8074; val_kl_reg_loss: 6923.4841; val_edge_recon_loss: 260455.3934; val_gene_expr_recon_loss: 116591.7746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383970.6539; val_optim_loss: 383970.6539
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9877; val_best_acc_score: 0.9600; val_best_f1_score: 0.9608; train_kl_reg_loss: 6985.2656; train_edge_recon_loss: 259397.4607; train_gene_expr_recon_loss: 116485.5321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382868.2584; train_optim_loss: 382868.2584; val_kl_reg_loss: 6907.8085; val_edge_recon_loss: 260233.1142; val_gene_expr_recon_loss: 116673.3453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383814.2673; val_optim_loss: 383814.2673
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9905; val_auprc_score: 0.9883; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 6970.9447; train_edge_recon_loss: 259335.8344; train_gene_expr_recon_loss: 116487.2316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382794.0108; train_optim_loss: 382794.0108; val_kl_reg_loss: 6889.0146; val_edge_recon_loss: 260367.0657; val_gene_expr_recon_loss: 116682.3713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383938.4521; val_optim_loss: 383938.4521

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 6965.0281; train_edge_recon_loss: 259402.6771; train_gene_expr_recon_loss: 116372.7010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382740.4057; train_optim_loss: 382740.4057; val_kl_reg_loss: 6879.8135; val_edge_recon_loss: 260231.7693; val_gene_expr_recon_loss: 116491.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383602.8050; val_optim_loss: 383602.8050
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9877; val_best_acc_score: 0.9605; val_best_f1_score: 0.9611; train_kl_reg_loss: 6963.2354; train_edge_recon_loss: 259444.4208; train_gene_expr_recon_loss: 116381.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382789.3756; train_optim_loss: 382789.3756; val_kl_reg_loss: 6867.3779; val_edge_recon_loss: 260251.8125; val_gene_expr_recon_loss: 116558.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383677.7442; val_optim_loss: 383677.7442
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9899; val_auprc_score: 0.9876; val_best_acc_score: 0.9600; val_best_f1_score: 0.9605; train_kl_reg_loss: 6959.2878; train_edge_recon_loss: 259451.2695; train_gene_expr_recon_loss: 116332.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382743.4901; train_optim_loss: 382743.4901; val_kl_reg_loss: 6876.8261; val_edge_recon_loss: 260434.3890; val_gene_expr_recon_loss: 116512.7171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383823.9341; val_optim_loss: 383823.9341
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9904; val_auprc_score: 0.9882; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 6958.2394; train_edge_recon_loss: 259465.4779; train_gene_expr_recon_loss: 116340.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382764.0191; train_optim_loss: 382764.0191; val_kl_reg_loss: 6872.2041; val_edge_recon_loss: 260076.2051; val_gene_expr_recon_loss: 116486.9183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383435.3305; val_optim_loss: 383435.3305
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 6955.9725; train_edge_recon_loss: 259464.7856; train_gene_expr_recon_loss: 116328.9150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382749.6726; train_optim_loss: 382749.6726; val_kl_reg_loss: 6875.7449; val_edge_recon_loss: 260548.4740; val_gene_expr_recon_loss: 116451.9965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383876.2166; val_optim_loss: 383876.2166
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9905; val_auprc_score: 0.9881; val_best_acc_score: 0.9604; val_best_f1_score: 0.9611; train_kl_reg_loss: 6957.4341; train_edge_recon_loss: 259271.6347; train_gene_expr_recon_loss: 116316.1912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382545.2597; train_optim_loss: 382545.2597; val_kl_reg_loss: 6856.2130; val_edge_recon_loss: 260141.8519; val_gene_expr_recon_loss: 116631.3202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383629.3855; val_optim_loss: 383629.3855
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9902; val_auprc_score: 0.9878; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 6955.6775; train_edge_recon_loss: 259389.9138; train_gene_expr_recon_loss: 116309.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382655.0538; train_optim_loss: 382655.0538; val_kl_reg_loss: 6858.6551; val_edge_recon_loss: 260514.7867; val_gene_expr_recon_loss: 116478.2897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383851.7329; val_optim_loss: 383851.7329
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9897; val_auprc_score: 0.9871; val_best_acc_score: 0.9592; val_best_f1_score: 0.9600; train_kl_reg_loss: 6952.9214; train_edge_recon_loss: 259300.8664; train_gene_expr_recon_loss: 116324.0940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382577.8811; train_optim_loss: 382577.8811; val_kl_reg_loss: 6877.5884; val_edge_recon_loss: 260618.4094; val_gene_expr_recon_loss: 116420.6038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383916.6030; val_optim_loss: 383916.6030

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9898; val_auprc_score: 0.9874; val_best_acc_score: 0.9596; val_best_f1_score: 0.9603; train_kl_reg_loss: 6955.5267; train_edge_recon_loss: 259394.3186; train_gene_expr_recon_loss: 116331.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382681.2363; train_optim_loss: 382681.2363; val_kl_reg_loss: 6864.8271; val_edge_recon_loss: 260559.4277; val_gene_expr_recon_loss: 116490.5148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383914.7697; val_optim_loss: 383914.7697
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9900; val_auprc_score: 0.9876; val_best_acc_score: 0.9592; val_best_f1_score: 0.9600; train_kl_reg_loss: 6950.4519; train_edge_recon_loss: 259366.9663; train_gene_expr_recon_loss: 116283.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382601.0097; train_optim_loss: 382601.0097; val_kl_reg_loss: 6869.6018; val_edge_recon_loss: 260510.4075; val_gene_expr_recon_loss: 116479.7638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383859.7759; val_optim_loss: 383859.7759
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9901; val_auprc_score: 0.9878; val_best_acc_score: 0.9599; val_best_f1_score: 0.9605; train_kl_reg_loss: 6950.5835; train_edge_recon_loss: 259458.1251; train_gene_expr_recon_loss: 116318.9897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382727.6978; train_optim_loss: 382727.6978; val_kl_reg_loss: 6867.0425; val_edge_recon_loss: 260452.9991; val_gene_expr_recon_loss: 116442.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383762.6866; val_optim_loss: 383762.6866
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9904; val_auprc_score: 0.9882; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 6948.4691; train_edge_recon_loss: 259401.6824; train_gene_expr_recon_loss: 116280.2374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382630.3891; train_optim_loss: 382630.3891; val_kl_reg_loss: 6864.8934; val_edge_recon_loss: 260108.1725; val_gene_expr_recon_loss: 116448.7177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383421.7851; val_optim_loss: 383421.7851
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9901; val_auprc_score: 0.9877; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 6947.9095; train_edge_recon_loss: 259529.2058; train_gene_expr_recon_loss: 116307.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382784.5884; train_optim_loss: 382784.5884; val_kl_reg_loss: 6862.7295; val_edge_recon_loss: 260474.3515; val_gene_expr_recon_loss: 116581.2633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383918.3455; val_optim_loss: 383918.3455
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9903; val_auprc_score: 0.9882; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 6948.6678; train_edge_recon_loss: 259397.3240; train_gene_expr_recon_loss: 116235.8728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382581.8648; train_optim_loss: 382581.8648; val_kl_reg_loss: 6863.2787; val_edge_recon_loss: 260144.6685; val_gene_expr_recon_loss: 116574.6533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383582.6008; val_optim_loss: 383582.6008
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9902; val_auprc_score: 0.9879; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 6949.8734; train_edge_recon_loss: 259441.8901; train_gene_expr_recon_loss: 116293.2033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382684.9666; train_optim_loss: 382684.9666; val_kl_reg_loss: 6866.4393; val_edge_recon_loss: 260323.1826; val_gene_expr_recon_loss: 116551.5378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383741.1597; val_optim_loss: 383741.1597
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9902; val_auprc_score: 0.9880; val_best_acc_score: 0.9606; val_best_f1_score: 0.9612; train_kl_reg_loss: 6950.8956; train_edge_recon_loss: 259337.7244; train_gene_expr_recon_loss: 116283.5231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382572.1432; train_optim_loss: 382572.1432; val_kl_reg_loss: 6865.3411; val_edge_recon_loss: 260366.0880; val_gene_expr_recon_loss: 116420.3054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383651.7333; val_optim_loss: 383651.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9900; val_auprc_score: 0.9877; val_best_acc_score: 0.9600; val_best_f1_score: 0.9607; train_kl_reg_loss: 6950.9479; train_edge_recon_loss: 259304.0080; train_gene_expr_recon_loss: 116366.8863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382621.8422; train_optim_loss: 382621.8422; val_kl_reg_loss: 6868.0172; val_edge_recon_loss: 260377.2480; val_gene_expr_recon_loss: 116522.6475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383767.9125; val_optim_loss: 383767.9125
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9882; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 6951.1108; train_edge_recon_loss: 259461.3420; train_gene_expr_recon_loss: 116285.7458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382698.1983; train_optim_loss: 382698.1983; val_kl_reg_loss: 6866.7468; val_edge_recon_loss: 260331.3776; val_gene_expr_recon_loss: 116409.3967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383607.5225; val_optim_loss: 383607.5225
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9899; val_auprc_score: 0.9874; val_best_acc_score: 0.9594; val_best_f1_score: 0.9602; train_kl_reg_loss: 6950.7147; train_edge_recon_loss: 259456.3254; train_gene_expr_recon_loss: 116304.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382711.6792; train_optim_loss: 382711.6792; val_kl_reg_loss: 6866.1888; val_edge_recon_loss: 260504.0427; val_gene_expr_recon_loss: 116454.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383824.2913; val_optim_loss: 383824.2913
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9901; val_auprc_score: 0.9878; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 6950.3556; train_edge_recon_loss: 259363.0458; train_gene_expr_recon_loss: 116297.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382610.4402; train_optim_loss: 382610.4402; val_kl_reg_loss: 6865.4679; val_edge_recon_loss: 260419.6756; val_gene_expr_recon_loss: 116355.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383640.4983; val_optim_loss: 383640.4983

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 229 min 18 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9903
Val AUPRC score: 0.9881
Val best accuracy score: 0.9604
Val best F1 score: 0.9611
Val gene expr MSE score: 2.6094

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
