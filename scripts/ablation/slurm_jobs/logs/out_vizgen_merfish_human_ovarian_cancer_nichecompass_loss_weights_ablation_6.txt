None
Run timestamp: 03072023_071446_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9482; val_auprc_score: 0.9558; val_best_acc_score: 0.8734; val_best_f1_score: 0.8718; train_kl_reg_loss: 1125.9817; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 15237.8983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16363.8800; train_optim_loss: 16363.8800; val_kl_reg_loss: 884.6976; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13643.9755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14528.6730; val_optim_loss: 14528.6730
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9547; val_auprc_score: 0.9616; val_best_acc_score: 0.8855; val_best_f1_score: 0.8805; train_kl_reg_loss: 855.9413; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13538.7793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14394.7206; train_optim_loss: 14394.7206; val_kl_reg_loss: 796.6494; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13082.7657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13879.4151; val_optim_loss: 13879.4151
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9584; val_auprc_score: 0.9648; val_best_acc_score: 0.8911; val_best_f1_score: 0.8885; train_kl_reg_loss: 760.6723; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13167.0960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13927.7683; train_optim_loss: 13927.7683; val_kl_reg_loss: 697.0090; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12862.4416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13559.4506; val_optim_loss: 13559.4506
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9599; val_auprc_score: 0.9661; val_best_acc_score: 0.8937; val_best_f1_score: 0.8888; train_kl_reg_loss: 710.5606; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12982.9105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13693.4711; train_optim_loss: 13693.4711; val_kl_reg_loss: 696.0392; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12722.9428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13418.9820; val_optim_loss: 13418.9820
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9614; val_auprc_score: 0.9673; val_best_acc_score: 0.8962; val_best_f1_score: 0.8932; train_kl_reg_loss: 681.4491; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12877.6985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13559.1475; train_optim_loss: 13559.1475; val_kl_reg_loss: 645.9753; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12653.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13299.6707; val_optim_loss: 13299.6707
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9629; val_auprc_score: 0.9687; val_best_acc_score: 0.8969; val_best_f1_score: 0.8953; train_kl_reg_loss: 664.3551; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12826.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13491.1652; train_optim_loss: 13491.1652; val_kl_reg_loss: 649.7719; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12629.4733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13279.2452; val_optim_loss: 13279.2452
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9627; val_auprc_score: 0.9684; val_best_acc_score: 0.8987; val_best_f1_score: 0.8959; train_kl_reg_loss: 654.2629; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12782.9476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13437.2105; train_optim_loss: 13437.2105; val_kl_reg_loss: 640.1479; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12584.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13224.2672; val_optim_loss: 13224.2672
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9644; val_auprc_score: 0.9701; val_best_acc_score: 0.9013; val_best_f1_score: 0.8970; train_kl_reg_loss: 649.1735; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12758.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13407.7508; train_optim_loss: 13407.7508; val_kl_reg_loss: 641.9904; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12581.2139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13223.2043; val_optim_loss: 13223.2043
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9650; val_auprc_score: 0.9703; val_best_acc_score: 0.9014; val_best_f1_score: 0.8992; train_kl_reg_loss: 645.7174; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12736.0696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13381.7870; train_optim_loss: 13381.7870; val_kl_reg_loss: 631.0874; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12554.9937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13186.0810; val_optim_loss: 13186.0810
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9670; val_auprc_score: 0.9723; val_best_acc_score: 0.9058; val_best_f1_score: 0.9022; train_kl_reg_loss: 644.2870; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12714.9639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13359.2510; train_optim_loss: 13359.2510; val_kl_reg_loss: 645.5582; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12542.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13187.7597; val_optim_loss: 13187.7597
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9670; val_auprc_score: 0.9723; val_best_acc_score: 0.9054; val_best_f1_score: 0.9041; train_kl_reg_loss: 643.5531; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12708.8761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13352.4292; train_optim_loss: 13352.4292; val_kl_reg_loss: 631.4780; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12530.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13162.2912; val_optim_loss: 13162.2912
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9689; val_auprc_score: 0.9736; val_best_acc_score: 0.9087; val_best_f1_score: 0.9056; train_kl_reg_loss: 643.2285; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12690.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13333.2624; train_optim_loss: 13333.2624; val_kl_reg_loss: 620.6984; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12533.8874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13154.5858; val_optim_loss: 13154.5858
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9669; val_auprc_score: 0.9722; val_best_acc_score: 0.9056; val_best_f1_score: 0.9020; train_kl_reg_loss: 643.4206; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12684.5875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13328.0081; train_optim_loss: 13328.0081; val_kl_reg_loss: 627.3944; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12538.6843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13166.0786; val_optim_loss: 13166.0786
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9686; val_auprc_score: 0.9735; val_best_acc_score: 0.9072; val_best_f1_score: 0.9060; train_kl_reg_loss: 643.4256; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.0228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13320.4484; train_optim_loss: 13320.4484; val_kl_reg_loss: 635.5593; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12504.8896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13140.4490; val_optim_loss: 13140.4490
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9693; val_auprc_score: 0.9741; val_best_acc_score: 0.9104; val_best_f1_score: 0.9084; train_kl_reg_loss: 643.2854; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12663.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13307.0092; train_optim_loss: 13307.0092; val_kl_reg_loss: 629.4009; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12501.3410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13130.7418; val_optim_loss: 13130.7418
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9694; val_auprc_score: 0.9741; val_best_acc_score: 0.9100; val_best_f1_score: 0.9080; train_kl_reg_loss: 643.6607; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12659.3352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13302.9960; train_optim_loss: 13302.9960; val_kl_reg_loss: 644.1341; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12506.3608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13150.4950; val_optim_loss: 13150.4950
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9701; val_auprc_score: 0.9749; val_best_acc_score: 0.9112; val_best_f1_score: 0.9082; train_kl_reg_loss: 644.1740; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12654.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13298.9574; train_optim_loss: 13298.9574; val_kl_reg_loss: 640.3035; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12498.0659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13138.3694; val_optim_loss: 13138.3694
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9714; val_auprc_score: 0.9759; val_best_acc_score: 0.9144; val_best_f1_score: 0.9120; train_kl_reg_loss: 644.7506; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12650.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13294.9591; train_optim_loss: 13294.9591; val_kl_reg_loss: 642.4541; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12507.8610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13150.3152; val_optim_loss: 13150.3152
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9718; val_auprc_score: 0.9763; val_best_acc_score: 0.9139; val_best_f1_score: 0.9127; train_kl_reg_loss: 645.2202; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12646.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13292.0467; train_optim_loss: 13292.0467; val_kl_reg_loss: 636.2621; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12490.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13126.3011; val_optim_loss: 13126.3011
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9710; val_auprc_score: 0.9754; val_best_acc_score: 0.9125; val_best_f1_score: 0.9109; train_kl_reg_loss: 644.8025; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12640.5474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13285.3499; train_optim_loss: 13285.3499; val_kl_reg_loss: 626.7208; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12495.1259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13121.8468; val_optim_loss: 13121.8468
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9733; val_auprc_score: 0.9776; val_best_acc_score: 0.9173; val_best_f1_score: 0.9156; train_kl_reg_loss: 644.3480; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12636.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13280.9274; train_optim_loss: 13280.9274; val_kl_reg_loss: 639.7500; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12490.2269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13129.9769; val_optim_loss: 13129.9769
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9727; val_auprc_score: 0.9770; val_best_acc_score: 0.9162; val_best_f1_score: 0.9140; train_kl_reg_loss: 643.9840; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12636.6774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13280.6614; train_optim_loss: 13280.6614; val_kl_reg_loss: 646.0747; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12496.9835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13143.0582; val_optim_loss: 13143.0582
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9725; val_auprc_score: 0.9767; val_best_acc_score: 0.9163; val_best_f1_score: 0.9141; train_kl_reg_loss: 644.4767; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12632.8374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13277.3141; train_optim_loss: 13277.3141; val_kl_reg_loss: 635.2427; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12488.4600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13123.7026; val_optim_loss: 13123.7026
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9720; val_auprc_score: 0.9764; val_best_acc_score: 0.9151; val_best_f1_score: 0.9123; train_kl_reg_loss: 645.0133; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12633.0902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13278.1034; train_optim_loss: 13278.1034; val_kl_reg_loss: 636.2051; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12475.0296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13111.2347; val_optim_loss: 13111.2347
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9732; val_auprc_score: 0.9773; val_best_acc_score: 0.9177; val_best_f1_score: 0.9151; train_kl_reg_loss: 645.2619; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12622.3732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13267.6351; train_optim_loss: 13267.6351; val_kl_reg_loss: 640.8104; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12486.2741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13127.0846; val_optim_loss: 13127.0846
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9723; val_auprc_score: 0.9766; val_best_acc_score: 0.9151; val_best_f1_score: 0.9132; train_kl_reg_loss: 645.6780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12623.2598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13268.9378; train_optim_loss: 13268.9378; val_kl_reg_loss: 636.3870; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12489.8944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13126.2813; val_optim_loss: 13126.2813
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9731; val_auprc_score: 0.9773; val_best_acc_score: 0.9166; val_best_f1_score: 0.9156; train_kl_reg_loss: 646.3541; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12619.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13265.8909; train_optim_loss: 13265.8909; val_kl_reg_loss: 637.3171; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12488.7717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13126.0889; val_optim_loss: 13126.0889
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9732; val_auprc_score: 0.9774; val_best_acc_score: 0.9169; val_best_f1_score: 0.9154; train_kl_reg_loss: 646.7848; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12617.3245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13264.1093; train_optim_loss: 13264.1093; val_kl_reg_loss: 634.1565; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12495.6132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13129.7697; val_optim_loss: 13129.7697

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9749; val_auprc_score: 0.9790; val_best_acc_score: 0.9208; val_best_f1_score: 0.9191; train_kl_reg_loss: 645.6012; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12570.6282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13216.2294; train_optim_loss: 13216.2294; val_kl_reg_loss: 640.0508; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12448.7739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13088.8247; val_optim_loss: 13088.8247
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9749; val_auprc_score: 0.9787; val_best_acc_score: 0.9211; val_best_f1_score: 0.9194; train_kl_reg_loss: 646.2564; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12565.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13212.1414; train_optim_loss: 13212.1414; val_kl_reg_loss: 638.8776; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12451.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13090.2612; val_optim_loss: 13090.2612
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9754; val_auprc_score: 0.9793; val_best_acc_score: 0.9217; val_best_f1_score: 0.9203; train_kl_reg_loss: 646.7144; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12563.0444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13209.7587; train_optim_loss: 13209.7587; val_kl_reg_loss: 639.1076; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12432.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13071.8119; val_optim_loss: 13071.8119
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9752; val_auprc_score: 0.9790; val_best_acc_score: 0.9214; val_best_f1_score: 0.9197; train_kl_reg_loss: 647.0933; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12564.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13211.7461; train_optim_loss: 13211.7461; val_kl_reg_loss: 640.3806; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12439.2140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13079.5946; val_optim_loss: 13079.5946
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9749; val_auprc_score: 0.9789; val_best_acc_score: 0.9205; val_best_f1_score: 0.9192; train_kl_reg_loss: 647.6088; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12561.1682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13208.7769; train_optim_loss: 13208.7769; val_kl_reg_loss: 642.7055; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12456.1145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13098.8199; val_optim_loss: 13098.8199
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9750; val_auprc_score: 0.9789; val_best_acc_score: 0.9208; val_best_f1_score: 0.9194; train_kl_reg_loss: 647.9819; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12561.6539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13209.6358; train_optim_loss: 13209.6358; val_kl_reg_loss: 641.7083; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12442.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13084.3528; val_optim_loss: 13084.3528
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9746; val_auprc_score: 0.9786; val_best_acc_score: 0.9196; val_best_f1_score: 0.9186; train_kl_reg_loss: 648.1954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12564.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13212.2248; train_optim_loss: 13212.2248; val_kl_reg_loss: 641.3018; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12430.8386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13072.1404; val_optim_loss: 13072.1404

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9753; val_auprc_score: 0.9791; val_best_acc_score: 0.9211; val_best_f1_score: 0.9203; train_kl_reg_loss: 647.8318; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12556.5220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13204.3539; train_optim_loss: 13204.3539; val_kl_reg_loss: 641.2378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12440.1230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13081.3608; val_optim_loss: 13081.3608
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9752; val_auprc_score: 0.9791; val_best_acc_score: 0.9210; val_best_f1_score: 0.9203; train_kl_reg_loss: 648.0955; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12551.5373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13199.6329; train_optim_loss: 13199.6329; val_kl_reg_loss: 642.3202; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12445.2744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13087.5945; val_optim_loss: 13087.5945
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9752; val_auprc_score: 0.9790; val_best_acc_score: 0.9211; val_best_f1_score: 0.9204; train_kl_reg_loss: 648.2825; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12551.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13199.4849; train_optim_loss: 13199.4849; val_kl_reg_loss: 641.8846; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12437.0016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13078.8862; val_optim_loss: 13078.8862
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9753; val_auprc_score: 0.9792; val_best_acc_score: 0.9210; val_best_f1_score: 0.9203; train_kl_reg_loss: 648.1003; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12554.2286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13202.3288; train_optim_loss: 13202.3288; val_kl_reg_loss: 642.4360; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12438.0733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13080.5093; val_optim_loss: 13080.5093

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 252 min 22 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9753
Val AUPRC score: 0.9791
Val best accuracy score: 0.9216
Val best F1 score: 0.9201
Val gene expr MSE score: 8.5371

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
