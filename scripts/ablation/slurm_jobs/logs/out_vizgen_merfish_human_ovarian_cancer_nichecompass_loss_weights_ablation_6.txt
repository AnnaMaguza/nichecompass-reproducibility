None
Run timestamp: 04072023_204832_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9534; val_auprc_score: 0.9605; val_best_acc_score: 0.8844; val_best_f1_score: 0.8799; train_kl_reg_loss: 925.3534; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14503.6058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15428.9592; train_optim_loss: 15428.9592; val_kl_reg_loss: 730.7241; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13253.8096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13984.5337; val_optim_loss: 13984.5337
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9561; val_auprc_score: 0.9627; val_best_acc_score: 0.8880; val_best_f1_score: 0.8842; train_kl_reg_loss: 711.8680; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13258.6934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13970.5614; train_optim_loss: 13970.5614; val_kl_reg_loss: 659.2198; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12926.1195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13585.3393; val_optim_loss: 13585.3393
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9587; val_auprc_score: 0.9655; val_best_acc_score: 0.8923; val_best_f1_score: 0.8892; train_kl_reg_loss: 657.6702; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13051.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13709.2251; train_optim_loss: 13709.2251; val_kl_reg_loss: 630.5728; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12808.3574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13438.9301; val_optim_loss: 13438.9301
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9578; val_auprc_score: 0.9644; val_best_acc_score: 0.8900; val_best_f1_score: 0.8866; train_kl_reg_loss: 636.7887; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12964.5335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13601.3222; train_optim_loss: 13601.3222; val_kl_reg_loss: 636.7565; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12757.7445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13394.5010; val_optim_loss: 13394.5010
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9617; val_auprc_score: 0.9678; val_best_acc_score: 0.8976; val_best_f1_score: 0.8928; train_kl_reg_loss: 627.6970; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12917.5501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13545.2471; train_optim_loss: 13545.2471; val_kl_reg_loss: 627.0216; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12728.0877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13355.1094; val_optim_loss: 13355.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9610; val_auprc_score: 0.9674; val_best_acc_score: 0.8950; val_best_f1_score: 0.8931; train_kl_reg_loss: 622.7940; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12887.1780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13509.9720; train_optim_loss: 13509.9720; val_kl_reg_loss: 595.8849; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12715.6082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13311.4930; val_optim_loss: 13311.4930
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9644; val_auprc_score: 0.9702; val_best_acc_score: 0.9013; val_best_f1_score: 0.8983; train_kl_reg_loss: 619.6725; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12866.9851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13486.6575; train_optim_loss: 13486.6575; val_kl_reg_loss: 611.6150; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12708.0895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13319.7045; val_optim_loss: 13319.7045
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9663; val_auprc_score: 0.9717; val_best_acc_score: 0.9046; val_best_f1_score: 0.9015; train_kl_reg_loss: 617.8590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12855.3348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13473.1938; train_optim_loss: 13473.1938; val_kl_reg_loss: 589.1654; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12721.1819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13310.3473; val_optim_loss: 13310.3473
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9642; val_auprc_score: 0.9700; val_best_acc_score: 0.9014; val_best_f1_score: 0.8985; train_kl_reg_loss: 616.9062; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12849.3267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13466.2328; train_optim_loss: 13466.2328; val_kl_reg_loss: 610.0368; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12690.9350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13300.9718; val_optim_loss: 13300.9718
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9671; val_auprc_score: 0.9724; val_best_acc_score: 0.9068; val_best_f1_score: 0.9032; train_kl_reg_loss: 616.7933; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12833.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13449.8709; train_optim_loss: 13449.8709; val_kl_reg_loss: 619.4966; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12679.7143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13299.2109; val_optim_loss: 13299.2109
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9658; val_auprc_score: 0.9713; val_best_acc_score: 0.9038; val_best_f1_score: 0.9017; train_kl_reg_loss: 617.1693; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12825.1971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13442.3663; train_optim_loss: 13442.3663; val_kl_reg_loss: 607.9281; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12679.1668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13287.0949; val_optim_loss: 13287.0949
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9680; val_auprc_score: 0.9732; val_best_acc_score: 0.9085; val_best_f1_score: 0.9055; train_kl_reg_loss: 617.1473; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12824.0649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13441.2122; train_optim_loss: 13441.2122; val_kl_reg_loss: 609.9556; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12664.6069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13274.5625; val_optim_loss: 13274.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9689; val_auprc_score: 0.9738; val_best_acc_score: 0.9098; val_best_f1_score: 0.9071; train_kl_reg_loss: 617.5156; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12809.8655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13427.3811; train_optim_loss: 13427.3811; val_kl_reg_loss: 612.5453; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12670.1850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13282.7303; val_optim_loss: 13282.7303
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9686; val_auprc_score: 0.9736; val_best_acc_score: 0.9096; val_best_f1_score: 0.9063; train_kl_reg_loss: 618.4257; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12808.2376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13426.6633; train_optim_loss: 13426.6633; val_kl_reg_loss: 626.9934; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12659.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13286.0824; val_optim_loss: 13286.0824
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9684; val_auprc_score: 0.9735; val_best_acc_score: 0.9086; val_best_f1_score: 0.9061; train_kl_reg_loss: 619.0759; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12806.4611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13425.5370; train_optim_loss: 13425.5370; val_kl_reg_loss: 604.7165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12671.6617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13276.3782; val_optim_loss: 13276.3782
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9690; val_auprc_score: 0.9739; val_best_acc_score: 0.9091; val_best_f1_score: 0.9074; train_kl_reg_loss: 620.0923; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12801.2063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13421.2986; train_optim_loss: 13421.2986; val_kl_reg_loss: 614.9246; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12665.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13280.9121; val_optim_loss: 13280.9121

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9720; val_auprc_score: 0.9765; val_best_acc_score: 0.9147; val_best_f1_score: 0.9135; train_kl_reg_loss: 617.9229; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12722.5790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13340.5019; train_optim_loss: 13340.5019; val_kl_reg_loss: 611.7120; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12624.4109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13236.1229; val_optim_loss: 13236.1229
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9724; val_auprc_score: 0.9768; val_best_acc_score: 0.9156; val_best_f1_score: 0.9145; train_kl_reg_loss: 618.4367; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12711.2090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13329.6456; train_optim_loss: 13329.6456; val_kl_reg_loss: 615.1606; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12609.0842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13224.2449; val_optim_loss: 13224.2449
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9723; val_auprc_score: 0.9767; val_best_acc_score: 0.9158; val_best_f1_score: 0.9141; train_kl_reg_loss: 618.9826; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12706.1689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13325.1515; train_optim_loss: 13325.1515; val_kl_reg_loss: 614.0789; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12615.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13229.7920; val_optim_loss: 13229.7920
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9722; val_auprc_score: 0.9767; val_best_acc_score: 0.9154; val_best_f1_score: 0.9139; train_kl_reg_loss: 619.4452; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12698.7546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13318.1998; train_optim_loss: 13318.1998; val_kl_reg_loss: 614.8177; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12602.2207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13217.0384; val_optim_loss: 13217.0384
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9719; val_auprc_score: 0.9762; val_best_acc_score: 0.9143; val_best_f1_score: 0.9130; train_kl_reg_loss: 620.0101; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12696.8754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13316.8855; train_optim_loss: 13316.8855; val_kl_reg_loss: 614.9107; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12609.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13224.0834; val_optim_loss: 13224.0834
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9719; val_auprc_score: 0.9764; val_best_acc_score: 0.9151; val_best_f1_score: 0.9136; train_kl_reg_loss: 620.4843; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12702.2164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13322.7007; train_optim_loss: 13322.7007; val_kl_reg_loss: 616.4757; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12605.3033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13221.7790; val_optim_loss: 13221.7790
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9727; val_auprc_score: 0.9770; val_best_acc_score: 0.9168; val_best_f1_score: 0.9151; train_kl_reg_loss: 620.8447; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12693.3094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13314.1541; train_optim_loss: 13314.1541; val_kl_reg_loss: 612.6449; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12592.0904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13204.7352; val_optim_loss: 13204.7352
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9723; val_auprc_score: 0.9766; val_best_acc_score: 0.9161; val_best_f1_score: 0.9144; train_kl_reg_loss: 621.2000; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12692.3629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13313.5629; train_optim_loss: 13313.5629; val_kl_reg_loss: 617.4658; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12603.5971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13221.0629; val_optim_loss: 13221.0629
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9719; val_auprc_score: 0.9762; val_best_acc_score: 0.9151; val_best_f1_score: 0.9137; train_kl_reg_loss: 621.5732; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12694.2382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13315.8114; train_optim_loss: 13315.8114; val_kl_reg_loss: 618.8288; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12595.3873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13214.2160; val_optim_loss: 13214.2160
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9723; val_auprc_score: 0.9765; val_best_acc_score: 0.9159; val_best_f1_score: 0.9143; train_kl_reg_loss: 621.5908; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12690.1281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13311.7188; train_optim_loss: 13311.7188; val_kl_reg_loss: 614.3921; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12614.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.6921; val_optim_loss: 13228.6921
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9725; val_auprc_score: 0.9767; val_best_acc_score: 0.9167; val_best_f1_score: 0.9148; train_kl_reg_loss: 622.1362; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12687.6648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13309.8011; train_optim_loss: 13309.8011; val_kl_reg_loss: 613.0601; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12614.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13227.6676; val_optim_loss: 13227.6676

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9726; val_auprc_score: 0.9767; val_best_acc_score: 0.9163; val_best_f1_score: 0.9146; train_kl_reg_loss: 622.0533; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12679.7797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13301.8331; train_optim_loss: 13301.8331; val_kl_reg_loss: 616.8902; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12598.3410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13215.2312; val_optim_loss: 13215.2312
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9726; val_auprc_score: 0.9770; val_best_acc_score: 0.9166; val_best_f1_score: 0.9147; train_kl_reg_loss: 622.1448; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12681.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13303.4456; train_optim_loss: 13303.4456; val_kl_reg_loss: 616.7536; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12589.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13206.4665; val_optim_loss: 13206.4665
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9771; val_best_acc_score: 0.9176; val_best_f1_score: 0.9156; train_kl_reg_loss: 622.0094; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.2507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13299.2602; train_optim_loss: 13299.2602; val_kl_reg_loss: 615.4278; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12592.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13207.7981; val_optim_loss: 13207.7981
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9725; val_auprc_score: 0.9769; val_best_acc_score: 0.9166; val_best_f1_score: 0.9147; train_kl_reg_loss: 622.0803; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12675.0375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13297.1177; train_optim_loss: 13297.1177; val_kl_reg_loss: 616.7699; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12594.2329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13211.0028; val_optim_loss: 13211.0028

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 223 min 18 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9728
Val AUPRC score: 0.9769
Val best accuracy score: 0.9174
Val best F1 score: 0.9156
Val gene expr MSE score: 8.5563

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
