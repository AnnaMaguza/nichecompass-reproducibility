None
Run timestamp: 03072023_191830_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9498; val_auprc_score: 0.9574; val_best_acc_score: 0.8771; val_best_f1_score: 0.8758; train_kl_reg_loss: 1039.6996; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 15294.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16333.8701; train_optim_loss: 16333.8701; val_kl_reg_loss: 833.5125; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13729.4237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14562.9362; val_optim_loss: 14562.9362
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9576; val_auprc_score: 0.9641; val_best_acc_score: 0.8903; val_best_f1_score: 0.8842; train_kl_reg_loss: 815.8029; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13668.3964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14484.1993; train_optim_loss: 14484.1993; val_kl_reg_loss: 763.5658; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13171.8112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13935.3769; val_optim_loss: 13935.3769
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9581; val_auprc_score: 0.9646; val_best_acc_score: 0.8918; val_best_f1_score: 0.8876; train_kl_reg_loss: 734.9659; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13301.6155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14036.5814; train_optim_loss: 14036.5814; val_kl_reg_loss: 680.0128; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12954.7078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13634.7206; val_optim_loss: 13634.7206
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9607; val_auprc_score: 0.9669; val_best_acc_score: 0.8936; val_best_f1_score: 0.8923; train_kl_reg_loss: 693.0659; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13119.5711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13812.6371; train_optim_loss: 13812.6371; val_kl_reg_loss: 662.9324; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12830.3468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13493.2792; val_optim_loss: 13493.2792
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9616; val_auprc_score: 0.9676; val_best_acc_score: 0.8970; val_best_f1_score: 0.8929; train_kl_reg_loss: 667.6766; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13017.5107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13685.1873; train_optim_loss: 13685.1873; val_kl_reg_loss: 659.0375; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12745.4916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13404.5291; val_optim_loss: 13404.5291
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9629; val_auprc_score: 0.9688; val_best_acc_score: 0.8967; val_best_f1_score: 0.8959; train_kl_reg_loss: 652.2481; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12951.2897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13603.5378; train_optim_loss: 13603.5378; val_kl_reg_loss: 646.0890; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12728.6967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13374.7858; val_optim_loss: 13374.7858
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9627; val_auprc_score: 0.9685; val_best_acc_score: 0.8986; val_best_f1_score: 0.8952; train_kl_reg_loss: 642.9478; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12913.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13555.9725; train_optim_loss: 13555.9725; val_kl_reg_loss: 635.6380; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12675.2220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13310.8600; val_optim_loss: 13310.8600
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9652; val_auprc_score: 0.9707; val_best_acc_score: 0.9019; val_best_f1_score: 0.9004; train_kl_reg_loss: 636.4836; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12881.5623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13518.0458; train_optim_loss: 13518.0458; val_kl_reg_loss: 612.0884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12674.2904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13286.3789; val_optim_loss: 13286.3789
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9647; val_auprc_score: 0.9703; val_best_acc_score: 0.9023; val_best_f1_score: 0.8999; train_kl_reg_loss: 632.0933; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12859.9265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13492.0198; train_optim_loss: 13492.0198; val_kl_reg_loss: 632.5614; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12642.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13275.4211; val_optim_loss: 13275.4211
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9658; val_auprc_score: 0.9711; val_best_acc_score: 0.9035; val_best_f1_score: 0.8999; train_kl_reg_loss: 629.6515; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12847.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13477.5411; train_optim_loss: 13477.5411; val_kl_reg_loss: 627.1993; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12634.7601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13261.9593; val_optim_loss: 13261.9593
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9662; val_auprc_score: 0.9715; val_best_acc_score: 0.9038; val_best_f1_score: 0.9024; train_kl_reg_loss: 627.8196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12835.8923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13463.7119; train_optim_loss: 13463.7119; val_kl_reg_loss: 617.0147; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12633.7714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13250.7861; val_optim_loss: 13250.7861
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9664; val_auprc_score: 0.9717; val_best_acc_score: 0.9047; val_best_f1_score: 0.9022; train_kl_reg_loss: 626.7871; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12825.1304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13451.9176; train_optim_loss: 13451.9176; val_kl_reg_loss: 617.8982; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12630.4698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13248.3680; val_optim_loss: 13248.3680
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9691; val_auprc_score: 0.9740; val_best_acc_score: 0.9098; val_best_f1_score: 0.9063; train_kl_reg_loss: 626.6008; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12808.7726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13435.3734; train_optim_loss: 13435.3734; val_kl_reg_loss: 622.5928; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12605.7215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.3143; val_optim_loss: 13228.3143
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9689; val_auprc_score: 0.9738; val_best_acc_score: 0.9085; val_best_f1_score: 0.9069; train_kl_reg_loss: 627.0698; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12802.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13429.9281; train_optim_loss: 13429.9281; val_kl_reg_loss: 612.6493; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12615.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.1572; val_optim_loss: 13228.1572
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9688; val_auprc_score: 0.9737; val_best_acc_score: 0.9089; val_best_f1_score: 0.9069; train_kl_reg_loss: 627.5072; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12789.8817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13417.3889; train_optim_loss: 13417.3889; val_kl_reg_loss: 623.0221; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12606.7022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13229.7243; val_optim_loss: 13229.7243
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9705; val_auprc_score: 0.9752; val_best_acc_score: 0.9130; val_best_f1_score: 0.9102; train_kl_reg_loss: 627.1793; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12788.3476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13415.5269; train_optim_loss: 13415.5269; val_kl_reg_loss: 627.6232; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12592.4586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13220.0818; val_optim_loss: 13220.0818
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9698; val_auprc_score: 0.9744; val_best_acc_score: 0.9118; val_best_f1_score: 0.9091; train_kl_reg_loss: 627.3509; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12785.2138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13412.5647; train_optim_loss: 13412.5647; val_kl_reg_loss: 634.0359; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12594.1503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.1862; val_optim_loss: 13228.1862
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9708; val_auprc_score: 0.9755; val_best_acc_score: 0.9129; val_best_f1_score: 0.9096; train_kl_reg_loss: 627.5303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12781.0862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13408.6165; train_optim_loss: 13408.6165; val_kl_reg_loss: 616.9937; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12599.8497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13216.8434; val_optim_loss: 13216.8434
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9710; val_auprc_score: 0.9756; val_best_acc_score: 0.9133; val_best_f1_score: 0.9107; train_kl_reg_loss: 627.5453; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12772.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13399.7894; train_optim_loss: 13399.7894; val_kl_reg_loss: 623.9715; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12582.1304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13206.1019; val_optim_loss: 13206.1019
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9703; val_auprc_score: 0.9749; val_best_acc_score: 0.9116; val_best_f1_score: 0.9098; train_kl_reg_loss: 627.3007; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12768.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13395.3575; train_optim_loss: 13395.3575; val_kl_reg_loss: 621.9629; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12598.5279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13220.4908; val_optim_loss: 13220.4908
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9706; val_auprc_score: 0.9752; val_best_acc_score: 0.9125; val_best_f1_score: 0.9102; train_kl_reg_loss: 627.2706; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12766.5902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13393.8608; train_optim_loss: 13393.8608; val_kl_reg_loss: 614.5032; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12595.3403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13209.8436; val_optim_loss: 13209.8436
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9720; val_auprc_score: 0.9764; val_best_acc_score: 0.9155; val_best_f1_score: 0.9130; train_kl_reg_loss: 626.9625; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12760.6603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13387.6228; train_optim_loss: 13387.6228; val_kl_reg_loss: 610.4119; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12594.7655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13205.1775; val_optim_loss: 13205.1775
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9724; val_auprc_score: 0.9767; val_best_acc_score: 0.9165; val_best_f1_score: 0.9140; train_kl_reg_loss: 626.4703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12755.8137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13382.2841; train_optim_loss: 13382.2841; val_kl_reg_loss: 619.4293; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12600.7610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13220.1903; val_optim_loss: 13220.1903
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9728; val_auprc_score: 0.9771; val_best_acc_score: 0.9168; val_best_f1_score: 0.9144; train_kl_reg_loss: 626.7940; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12759.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13386.0385; train_optim_loss: 13386.0385; val_kl_reg_loss: 624.7203; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12602.2993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13227.0195; val_optim_loss: 13227.0195
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9724; val_auprc_score: 0.9767; val_best_acc_score: 0.9152; val_best_f1_score: 0.9133; train_kl_reg_loss: 626.4382; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12754.9777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13381.4159; train_optim_loss: 13381.4159; val_kl_reg_loss: 620.6469; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12583.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13203.7525; val_optim_loss: 13203.7525
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9732; val_auprc_score: 0.9774; val_best_acc_score: 0.9163; val_best_f1_score: 0.9154; train_kl_reg_loss: 626.1107; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12748.3607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13374.4715; train_optim_loss: 13374.4715; val_kl_reg_loss: 613.2067; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12580.2565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13193.4631; val_optim_loss: 13193.4631
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9724; val_auprc_score: 0.9768; val_best_acc_score: 0.9158; val_best_f1_score: 0.9128; train_kl_reg_loss: 625.7375; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12749.2739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13375.0114; train_optim_loss: 13375.0114; val_kl_reg_loss: 627.6749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12582.4845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13210.1594; val_optim_loss: 13210.1594
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9731; val_auprc_score: 0.9772; val_best_acc_score: 0.9170; val_best_f1_score: 0.9157; train_kl_reg_loss: 625.5746; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12746.3126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13371.8872; train_optim_loss: 13371.8872; val_kl_reg_loss: 618.4691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12602.3757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13220.8448; val_optim_loss: 13220.8448
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9718; val_auprc_score: 0.9762; val_best_acc_score: 0.9137; val_best_f1_score: 0.9125; train_kl_reg_loss: 625.4143; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12743.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13368.5899; train_optim_loss: 13368.5899; val_kl_reg_loss: 622.1194; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12587.6165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13209.7359; val_optim_loss: 13209.7359
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9742; val_auprc_score: 0.9783; val_best_acc_score: 0.9196; val_best_f1_score: 0.9177; train_kl_reg_loss: 625.5272; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12744.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13370.0198; train_optim_loss: 13370.0198; val_kl_reg_loss: 612.4418; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12583.1683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13195.6100; val_optim_loss: 13195.6100

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9753; val_auprc_score: 0.9792; val_best_acc_score: 0.9210; val_best_f1_score: 0.9199; train_kl_reg_loss: 624.0278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12694.4516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13318.4794; train_optim_loss: 13318.4794; val_kl_reg_loss: 615.2323; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12548.8493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13164.0816; val_optim_loss: 13164.0816
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9756; val_auprc_score: 0.9794; val_best_acc_score: 0.9213; val_best_f1_score: 0.9202; train_kl_reg_loss: 624.1957; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12681.6229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13305.8186; train_optim_loss: 13305.8186; val_kl_reg_loss: 617.1177; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12555.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13173.1147; val_optim_loss: 13173.1147
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9752; val_auprc_score: 0.9790; val_best_acc_score: 0.9204; val_best_f1_score: 0.9195; train_kl_reg_loss: 624.6415; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.7019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13302.3434; train_optim_loss: 13302.3434; val_kl_reg_loss: 618.5733; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12547.5373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13166.1106; val_optim_loss: 13166.1106
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9751; val_auprc_score: 0.9788; val_best_acc_score: 0.9203; val_best_f1_score: 0.9192; train_kl_reg_loss: 625.0388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12672.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13297.5966; train_optim_loss: 13297.5966; val_kl_reg_loss: 621.8116; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12544.4513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13166.2629; val_optim_loss: 13166.2629
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9755; val_auprc_score: 0.9793; val_best_acc_score: 0.9216; val_best_f1_score: 0.9204; train_kl_reg_loss: 625.2389; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12673.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13298.7713; train_optim_loss: 13298.7713; val_kl_reg_loss: 616.3943; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12552.9409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13169.3352; val_optim_loss: 13169.3352

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9755; val_auprc_score: 0.9793; val_best_acc_score: 0.9218; val_best_f1_score: 0.9205; train_kl_reg_loss: 625.2990; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12666.6038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13291.9028; train_optim_loss: 13291.9028; val_kl_reg_loss: 619.1253; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12540.4660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13159.5912; val_optim_loss: 13159.5912
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9758; val_auprc_score: 0.9795; val_best_acc_score: 0.9223; val_best_f1_score: 0.9209; train_kl_reg_loss: 625.5612; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12666.3911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13291.9523; train_optim_loss: 13291.9523; val_kl_reg_loss: 619.3665; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12538.4409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13157.8074; val_optim_loss: 13157.8074
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9754; val_auprc_score: 0.9792; val_best_acc_score: 0.9214; val_best_f1_score: 0.9200; train_kl_reg_loss: 625.5373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12663.5027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13289.0400; train_optim_loss: 13289.0400; val_kl_reg_loss: 618.9123; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12535.0345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13153.9468; val_optim_loss: 13153.9468
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9755; val_auprc_score: 0.9793; val_best_acc_score: 0.9221; val_best_f1_score: 0.9207; train_kl_reg_loss: 625.6174; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12664.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13290.2855; train_optim_loss: 13290.2855; val_kl_reg_loss: 619.9543; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12549.1629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13169.1173; val_optim_loss: 13169.1173
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9752; val_auprc_score: 0.9790; val_best_acc_score: 0.9211; val_best_f1_score: 0.9197; train_kl_reg_loss: 625.5609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12664.4326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13289.9935; train_optim_loss: 13289.9935; val_kl_reg_loss: 619.4911; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12535.5945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13155.0856; val_optim_loss: 13155.0856
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9756; val_auprc_score: 0.9794; val_best_acc_score: 0.9222; val_best_f1_score: 0.9207; train_kl_reg_loss: 625.5227; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12659.7505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13285.2732; train_optim_loss: 13285.2732; val_kl_reg_loss: 619.2161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12531.3543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13150.5704; val_optim_loss: 13150.5704
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9756; val_auprc_score: 0.9792; val_best_acc_score: 0.9223; val_best_f1_score: 0.9209; train_kl_reg_loss: 625.6679; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12662.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13288.5453; train_optim_loss: 13288.5453; val_kl_reg_loss: 621.2487; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12536.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13158.0436; val_optim_loss: 13158.0436
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9753; val_auprc_score: 0.9791; val_best_acc_score: 0.9215; val_best_f1_score: 0.9201; train_kl_reg_loss: 625.4191; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12663.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13288.7330; train_optim_loss: 13288.7330; val_kl_reg_loss: 619.9859; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12526.5473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13146.5331; val_optim_loss: 13146.5331
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9760; val_auprc_score: 0.9798; val_best_acc_score: 0.9224; val_best_f1_score: 0.9209; train_kl_reg_loss: 625.7124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12658.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13284.5756; train_optim_loss: 13284.5756; val_kl_reg_loss: 618.8557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12547.3119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13166.1676; val_optim_loss: 13166.1676
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9757; val_auprc_score: 0.9793; val_best_acc_score: 0.9221; val_best_f1_score: 0.9206; train_kl_reg_loss: 625.6982; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12664.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13290.3271; train_optim_loss: 13290.3271; val_kl_reg_loss: 618.8472; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12536.6662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13155.5134; val_optim_loss: 13155.5134
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9753; val_auprc_score: 0.9791; val_best_acc_score: 0.9212; val_best_f1_score: 0.9199; train_kl_reg_loss: 625.7371; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12661.9347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13287.6718; train_optim_loss: 13287.6718; val_kl_reg_loss: 620.2852; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12528.5207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13148.8060; val_optim_loss: 13148.8060
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9756; val_auprc_score: 0.9794; val_best_acc_score: 0.9221; val_best_f1_score: 0.9207; train_kl_reg_loss: 625.6388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12660.4101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13286.0489; train_optim_loss: 13286.0489; val_kl_reg_loss: 620.3108; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12531.5178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13151.8286; val_optim_loss: 13151.8286

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9756; val_auprc_score: 0.9794; val_best_acc_score: 0.9218; val_best_f1_score: 0.9204; train_kl_reg_loss: 625.8101; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12659.8470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13285.6571; train_optim_loss: 13285.6571; val_kl_reg_loss: 619.3413; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12536.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13155.9362; val_optim_loss: 13155.9362
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9755; val_auprc_score: 0.9793; val_best_acc_score: 0.9219; val_best_f1_score: 0.9205; train_kl_reg_loss: 625.6715; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12662.7809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13288.4525; train_optim_loss: 13288.4525; val_kl_reg_loss: 619.5738; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12537.1290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13156.7028; val_optim_loss: 13156.7028
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9759; val_auprc_score: 0.9796; val_best_acc_score: 0.9230; val_best_f1_score: 0.9215; train_kl_reg_loss: 625.8026; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12658.3755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13284.1781; train_optim_loss: 13284.1781; val_kl_reg_loss: 619.8274; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12534.0919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13153.9193; val_optim_loss: 13153.9193
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9756; val_auprc_score: 0.9795; val_best_acc_score: 0.9222; val_best_f1_score: 0.9207; train_kl_reg_loss: 625.9306; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12659.8112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13285.7419; train_optim_loss: 13285.7419; val_kl_reg_loss: 619.7891; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12532.8565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13152.6456; val_optim_loss: 13152.6456

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 264 min 18 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9755
Val AUPRC score: 0.9793
Val best accuracy score: 0.9220
Val best F1 score: 0.9205
Val gene expr MSE score: 8.4155

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
