None
Run timestamp: 30062023_200509_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9506; val_auprc_score: 0.9577; val_best_acc_score: 0.8759; val_best_f1_score: 0.8757; train_kl_reg_loss: 1005.0473; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 15267.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16272.9768; train_optim_loss: 16272.9768; val_kl_reg_loss: 874.9020; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13718.0884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14592.9904; val_optim_loss: 14592.9904
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9533; val_auprc_score: 0.9603; val_best_acc_score: 0.8816; val_best_f1_score: 0.8779; train_kl_reg_loss: 804.6471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13638.3762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14443.0232; train_optim_loss: 14443.0232; val_kl_reg_loss: 725.0496; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13236.6161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13961.6657; val_optim_loss: 13961.6657
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9575; val_auprc_score: 0.9640; val_best_acc_score: 0.8893; val_best_f1_score: 0.8858; train_kl_reg_loss: 727.5813; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13278.9505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14006.5317; train_optim_loss: 14006.5317; val_kl_reg_loss: 687.7855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12988.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13675.9842; val_optim_loss: 13675.9842
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9577; val_auprc_score: 0.9643; val_best_acc_score: 0.8880; val_best_f1_score: 0.8863; train_kl_reg_loss: 687.9708; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13106.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13794.6525; train_optim_loss: 13794.6525; val_kl_reg_loss: 674.2176; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12871.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13546.0843; val_optim_loss: 13546.0843
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9592; val_auprc_score: 0.9656; val_best_acc_score: 0.8931; val_best_f1_score: 0.8891; train_kl_reg_loss: 664.3579; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13003.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13668.0434; train_optim_loss: 13668.0434; val_kl_reg_loss: 655.4383; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12810.1681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13465.6064; val_optim_loss: 13465.6064
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9597; val_auprc_score: 0.9662; val_best_acc_score: 0.8921; val_best_f1_score: 0.8903; train_kl_reg_loss: 649.5095; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12947.9878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13597.4974; train_optim_loss: 13597.4974; val_kl_reg_loss: 631.2329; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12769.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13401.2191; val_optim_loss: 13401.2191
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9624; val_auprc_score: 0.9683; val_best_acc_score: 0.8975; val_best_f1_score: 0.8933; train_kl_reg_loss: 640.5588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12903.7568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13544.3156; train_optim_loss: 13544.3156; val_kl_reg_loss: 615.7857; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12759.9837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13375.7694; val_optim_loss: 13375.7694
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9624; val_auprc_score: 0.9683; val_best_acc_score: 0.8961; val_best_f1_score: 0.8941; train_kl_reg_loss: 634.9196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12875.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13510.5580; train_optim_loss: 13510.5580; val_kl_reg_loss: 610.4501; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12735.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13345.9123; val_optim_loss: 13345.9123
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9635; val_auprc_score: 0.9693; val_best_acc_score: 0.8991; val_best_f1_score: 0.8964; train_kl_reg_loss: 631.4685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12854.0170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13485.4855; train_optim_loss: 13485.4855; val_kl_reg_loss: 611.3557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12726.4736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13337.8294; val_optim_loss: 13337.8294
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9642; val_auprc_score: 0.9698; val_best_acc_score: 0.9010; val_best_f1_score: 0.8970; train_kl_reg_loss: 629.4097; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12837.6482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13467.0579; train_optim_loss: 13467.0579; val_kl_reg_loss: 620.0600; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12698.9503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13319.0103; val_optim_loss: 13319.0103
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9642; val_auprc_score: 0.9700; val_best_acc_score: 0.9007; val_best_f1_score: 0.8974; train_kl_reg_loss: 628.7799; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12829.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13458.2123; train_optim_loss: 13458.2123; val_kl_reg_loss: 631.6668; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12685.4165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13317.0833; val_optim_loss: 13317.0833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9649; val_auprc_score: 0.9701; val_best_acc_score: 0.9016; val_best_f1_score: 0.8993; train_kl_reg_loss: 628.4039; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12815.2265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13443.6304; train_optim_loss: 13443.6304; val_kl_reg_loss: 623.8310; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12682.1106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13305.9416; val_optim_loss: 13305.9416
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9652; val_auprc_score: 0.9707; val_best_acc_score: 0.9029; val_best_f1_score: 0.8992; train_kl_reg_loss: 628.8140; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12807.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13436.4961; train_optim_loss: 13436.4961; val_kl_reg_loss: 609.2267; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12686.4932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13295.7199; val_optim_loss: 13295.7199
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9663; val_auprc_score: 0.9716; val_best_acc_score: 0.9048; val_best_f1_score: 0.9018; train_kl_reg_loss: 628.5952; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12793.1549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13421.7501; train_optim_loss: 13421.7501; val_kl_reg_loss: 626.7443; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12677.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13304.1153; val_optim_loss: 13304.1153
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9650; val_auprc_score: 0.9705; val_best_acc_score: 0.9003; val_best_f1_score: 0.8989; train_kl_reg_loss: 628.8606; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12793.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13422.2483; train_optim_loss: 13422.2483; val_kl_reg_loss: 631.1530; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12673.6366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13304.7896; val_optim_loss: 13304.7896
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9674; val_auprc_score: 0.9723; val_best_acc_score: 0.9062; val_best_f1_score: 0.9039; train_kl_reg_loss: 629.3646; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12784.8200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13414.1846; train_optim_loss: 13414.1846; val_kl_reg_loss: 617.7657; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12652.6765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13270.4422; val_optim_loss: 13270.4422
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9682; val_auprc_score: 0.9733; val_best_acc_score: 0.9080; val_best_f1_score: 0.9046; train_kl_reg_loss: 629.8567; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12776.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13406.3172; train_optim_loss: 13406.3172; val_kl_reg_loss: 617.8203; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12639.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13256.8273; val_optim_loss: 13256.8273
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9675; val_auprc_score: 0.9726; val_best_acc_score: 0.9070; val_best_f1_score: 0.9044; train_kl_reg_loss: 630.5036; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12774.4334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13404.9370; train_optim_loss: 13404.9370; val_kl_reg_loss: 630.2769; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12637.8735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13268.1504; val_optim_loss: 13268.1504
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9682; val_auprc_score: 0.9731; val_best_acc_score: 0.9084; val_best_f1_score: 0.9054; train_kl_reg_loss: 630.8453; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12767.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13398.3542; train_optim_loss: 13398.3542; val_kl_reg_loss: 628.6573; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12654.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13282.8370; val_optim_loss: 13282.8370
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9699; val_auprc_score: 0.9747; val_best_acc_score: 0.9106; val_best_f1_score: 0.9086; train_kl_reg_loss: 631.1088; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12766.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13397.9233; train_optim_loss: 13397.9233; val_kl_reg_loss: 631.2364; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12637.1004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13268.3369; val_optim_loss: 13268.3369
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9700; val_auprc_score: 0.9748; val_best_acc_score: 0.9115; val_best_f1_score: 0.9096; train_kl_reg_loss: 630.8375; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12758.5881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13389.4255; train_optim_loss: 13389.4255; val_kl_reg_loss: 623.3127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12651.5850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13274.8977; val_optim_loss: 13274.8977

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9711; val_auprc_score: 0.9756; val_best_acc_score: 0.9129; val_best_f1_score: 0.9112; train_kl_reg_loss: 628.7849; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12705.8400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13334.6250; train_optim_loss: 13334.6250; val_kl_reg_loss: 621.1011; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12625.5755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13246.6765; val_optim_loss: 13246.6765
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9707; val_auprc_score: 0.9753; val_best_acc_score: 0.9130; val_best_f1_score: 0.9104; train_kl_reg_loss: 629.0336; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12692.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13321.7540; train_optim_loss: 13321.7540; val_kl_reg_loss: 624.2593; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12625.7602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13250.0195; val_optim_loss: 13250.0195
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9712; val_auprc_score: 0.9758; val_best_acc_score: 0.9135; val_best_f1_score: 0.9118; train_kl_reg_loss: 629.1554; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12695.7437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13324.8991; train_optim_loss: 13324.8991; val_kl_reg_loss: 621.6212; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12606.0723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13227.6935; val_optim_loss: 13227.6935
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9715; val_auprc_score: 0.9759; val_best_acc_score: 0.9134; val_best_f1_score: 0.9123; train_kl_reg_loss: 629.6438; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12690.7271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13320.3709; train_optim_loss: 13320.3709; val_kl_reg_loss: 620.4565; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12609.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13230.0677; val_optim_loss: 13230.0677
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9710; val_auprc_score: 0.9756; val_best_acc_score: 0.9126; val_best_f1_score: 0.9115; train_kl_reg_loss: 630.0457; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12691.2380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13321.2837; train_optim_loss: 13321.2837; val_kl_reg_loss: 623.3049; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12605.2781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.5831; val_optim_loss: 13228.5831
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9715; val_auprc_score: 0.9760; val_best_acc_score: 0.9138; val_best_f1_score: 0.9126; train_kl_reg_loss: 630.2758; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12689.8050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13320.0808; train_optim_loss: 13320.0808; val_kl_reg_loss: 619.9308; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12612.5022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13232.4329; val_optim_loss: 13232.4329
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9717; val_auprc_score: 0.9760; val_best_acc_score: 0.9143; val_best_f1_score: 0.9131; train_kl_reg_loss: 630.2414; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12687.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13317.9297; train_optim_loss: 13317.9297; val_kl_reg_loss: 620.1503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12619.0542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13239.2045; val_optim_loss: 13239.2045

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9712; val_auprc_score: 0.9757; val_best_acc_score: 0.9129; val_best_f1_score: 0.9117; train_kl_reg_loss: 630.0636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12680.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13310.9995; train_optim_loss: 13310.9995; val_kl_reg_loss: 623.6682; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12617.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13241.2250; val_optim_loss: 13241.2250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9714; val_auprc_score: 0.9758; val_best_acc_score: 0.9137; val_best_f1_score: 0.9124; train_kl_reg_loss: 630.3592; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12679.6492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13310.0084; train_optim_loss: 13310.0084; val_kl_reg_loss: 624.2959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12607.9962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13232.2921; val_optim_loss: 13232.2921
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9713; val_auprc_score: 0.9755; val_best_acc_score: 0.9130; val_best_f1_score: 0.9118; train_kl_reg_loss: 630.3396; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12676.0285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13306.3682; train_optim_loss: 13306.3682; val_kl_reg_loss: 624.3328; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12590.2933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13214.6262; val_optim_loss: 13214.6262
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9716; val_auprc_score: 0.9760; val_best_acc_score: 0.9144; val_best_f1_score: 0.9129; train_kl_reg_loss: 630.0903; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.5242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13307.6145; train_optim_loss: 13307.6145; val_kl_reg_loss: 623.0603; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12601.7198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13224.7800; val_optim_loss: 13224.7800
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9715; val_auprc_score: 0.9760; val_best_acc_score: 0.9144; val_best_f1_score: 0.9129; train_kl_reg_loss: 630.2332; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12675.9367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13306.1699; train_optim_loss: 13306.1699; val_kl_reg_loss: 623.0793; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12596.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13219.1162; val_optim_loss: 13219.1162
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9716; val_auprc_score: 0.9761; val_best_acc_score: 0.9140; val_best_f1_score: 0.9126; train_kl_reg_loss: 630.3851; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12675.5823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13305.9674; train_optim_loss: 13305.9674; val_kl_reg_loss: 623.3448; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12616.6071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13239.9519; val_optim_loss: 13239.9519
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9716; val_auprc_score: 0.9759; val_best_acc_score: 0.9142; val_best_f1_score: 0.9128; train_kl_reg_loss: 630.1950; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12675.6240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13305.8190; train_optim_loss: 13305.8190; val_kl_reg_loss: 623.6360; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12608.7808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13232.4169; val_optim_loss: 13232.4169

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9714; val_auprc_score: 0.9758; val_best_acc_score: 0.9139; val_best_f1_score: 0.9124; train_kl_reg_loss: 630.1806; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12680.5479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13310.7285; train_optim_loss: 13310.7285; val_kl_reg_loss: 623.4302; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12605.3997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13228.8299; val_optim_loss: 13228.8299
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9713; val_auprc_score: 0.9757; val_best_acc_score: 0.9138; val_best_f1_score: 0.9124; train_kl_reg_loss: 630.4972; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12678.6189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13309.1161; train_optim_loss: 13309.1161; val_kl_reg_loss: 623.4807; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12614.6784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13238.1591; val_optim_loss: 13238.1591
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9713; val_auprc_score: 0.9759; val_best_acc_score: 0.9137; val_best_f1_score: 0.9123; train_kl_reg_loss: 630.5146; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.2694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13307.7840; train_optim_loss: 13307.7840; val_kl_reg_loss: 623.4728; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12613.6984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13237.1713; val_optim_loss: 13237.1713
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9715; val_auprc_score: 0.9760; val_best_acc_score: 0.9142; val_best_f1_score: 0.9128; train_kl_reg_loss: 630.4345; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.2254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13307.6599; train_optim_loss: 13307.6599; val_kl_reg_loss: 623.0963; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12594.2088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13217.3051; val_optim_loss: 13217.3051

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 250 min 44 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9715
Val AUPRC score: 0.9759
Val best accuracy score: 0.9140
Val best F1 score: 0.9127
Val gene expr MSE score: 8.7753

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
