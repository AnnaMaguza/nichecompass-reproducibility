None
Run timestamp: 04072023_092738_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9796; val_auprc_score: 0.9811; val_best_acc_score: 0.9250; val_best_f1_score: 0.9243; train_kl_reg_loss: 294.7751; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 22147.4469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22442.2221; train_optim_loss: 22442.2221; val_kl_reg_loss: 271.8800; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 20765.8110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21037.6910; val_optim_loss: 21037.6910
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9867; val_auprc_score: 0.9880; val_best_acc_score: 0.9428; val_best_f1_score: 0.9426; train_kl_reg_loss: 252.1404; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20882.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21134.9967; train_optim_loss: 21134.9967; val_kl_reg_loss: 229.5428; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 20249.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20479.4318; val_optim_loss: 20479.4318
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9892; val_auprc_score: 0.9905; val_best_acc_score: 0.9513; val_best_f1_score: 0.9508; train_kl_reg_loss: 232.5053; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20551.7946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20784.3000; train_optim_loss: 20784.3000; val_kl_reg_loss: 237.5133; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 20080.9101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20318.4233; val_optim_loss: 20318.4233
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9905; val_best_acc_score: 0.9519; val_best_f1_score: 0.9513; train_kl_reg_loss: 230.0070; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20436.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20666.4194; train_optim_loss: 20666.4194; val_kl_reg_loss: 230.2665; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 20008.6919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20238.9584; val_optim_loss: 20238.9584
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9902; val_auprc_score: 0.9912; val_best_acc_score: 0.9541; val_best_f1_score: 0.9536; train_kl_reg_loss: 229.8886; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20380.1546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20610.0433; train_optim_loss: 20610.0433; val_kl_reg_loss: 238.0141; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19962.9017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20200.9158; val_optim_loss: 20200.9158
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9913; val_auprc_score: 0.9923; val_best_acc_score: 0.9573; val_best_f1_score: 0.9571; train_kl_reg_loss: 231.0960; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20350.7605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20581.8565; train_optim_loss: 20581.8565; val_kl_reg_loss: 232.3481; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19947.5709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20179.9190; val_optim_loss: 20179.9190
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9923; val_best_acc_score: 0.9576; val_best_f1_score: 0.9572; train_kl_reg_loss: 232.5537; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20332.1008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20564.6546; train_optim_loss: 20564.6546; val_kl_reg_loss: 230.1215; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19964.0336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20194.1551; val_optim_loss: 20194.1551
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9917; val_auprc_score: 0.9926; val_best_acc_score: 0.9587; val_best_f1_score: 0.9585; train_kl_reg_loss: 233.5933; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20312.5356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20546.1289; train_optim_loss: 20546.1289; val_kl_reg_loss: 229.1385; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19943.0509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20172.1894; val_optim_loss: 20172.1894
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9920; val_auprc_score: 0.9931; val_best_acc_score: 0.9606; val_best_f1_score: 0.9602; train_kl_reg_loss: 235.4582; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20301.3393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20536.7975; train_optim_loss: 20536.7975; val_kl_reg_loss: 229.2015; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19947.5219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20176.7234; val_optim_loss: 20176.7234
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9918; val_auprc_score: 0.9930; val_best_acc_score: 0.9602; val_best_f1_score: 0.9598; train_kl_reg_loss: 236.1812; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20297.3414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20533.5225; train_optim_loss: 20533.5225; val_kl_reg_loss: 234.4385; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19916.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20151.2740; val_optim_loss: 20151.2740
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9922; val_auprc_score: 0.9932; val_best_acc_score: 0.9609; val_best_f1_score: 0.9607; train_kl_reg_loss: 237.4273; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20281.8487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20519.2760; train_optim_loss: 20519.2760; val_kl_reg_loss: 234.2971; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19930.7831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20165.0802; val_optim_loss: 20165.0802
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9937; val_best_acc_score: 0.9621; val_best_f1_score: 0.9618; train_kl_reg_loss: 238.7925; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20280.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20519.0503; train_optim_loss: 20519.0503; val_kl_reg_loss: 234.8666; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19954.0754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20188.9420; val_optim_loss: 20188.9420
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9928; val_auprc_score: 0.9938; val_best_acc_score: 0.9633; val_best_f1_score: 0.9629; train_kl_reg_loss: 239.5061; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20274.4319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20513.9379; train_optim_loss: 20513.9379; val_kl_reg_loss: 238.0149; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19918.2340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20156.2489; val_optim_loss: 20156.2489
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9930; val_auprc_score: 0.9940; val_best_acc_score: 0.9638; val_best_f1_score: 0.9636; train_kl_reg_loss: 239.9461; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20267.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20507.4137; train_optim_loss: 20507.4137; val_kl_reg_loss: 229.8564; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19930.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20160.3356; val_optim_loss: 20160.3356

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9942; val_auprc_score: 0.9950; val_best_acc_score: 0.9683; val_best_f1_score: 0.9681; train_kl_reg_loss: 197.9783; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20003.8735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20201.8518; train_optim_loss: 20201.8518; val_kl_reg_loss: 183.6474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19873.3901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20057.0375; val_optim_loss: 20057.0375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9943; val_auprc_score: 0.9951; val_best_acc_score: 0.9685; val_best_f1_score: 0.9682; train_kl_reg_loss: 185.2821; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19886.1070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20071.3891; train_optim_loss: 20071.3891; val_kl_reg_loss: 183.1188; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19840.1548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20023.2736; val_optim_loss: 20023.2736
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9952; val_best_acc_score: 0.9696; val_best_f1_score: 0.9695; train_kl_reg_loss: 185.3796; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19874.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20059.5241; train_optim_loss: 20059.5241; val_kl_reg_loss: 184.8248; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19839.0033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20023.8281; val_optim_loss: 20023.8281
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9952; val_best_acc_score: 0.9691; val_best_f1_score: 0.9688; train_kl_reg_loss: 186.2106; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19863.4782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20049.6888; train_optim_loss: 20049.6888; val_kl_reg_loss: 186.0670; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19842.9086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20028.9756; val_optim_loss: 20028.9756
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9950; val_best_acc_score: 0.9695; val_best_f1_score: 0.9694; train_kl_reg_loss: 186.9159; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19855.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20042.4393; train_optim_loss: 20042.4393; val_kl_reg_loss: 186.0052; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19825.2003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20011.2055; val_optim_loss: 20011.2055
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9954; val_best_acc_score: 0.9702; val_best_f1_score: 0.9701; train_kl_reg_loss: 187.5185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19848.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20035.7223; train_optim_loss: 20035.7223; val_kl_reg_loss: 186.8962; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19829.1649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20016.0611; val_optim_loss: 20016.0611
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9946; val_auprc_score: 0.9953; val_best_acc_score: 0.9703; val_best_f1_score: 0.9702; train_kl_reg_loss: 188.1437; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19848.2477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20036.3914; train_optim_loss: 20036.3914; val_kl_reg_loss: 187.6471; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19850.3795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20038.0268; val_optim_loss: 20038.0268
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9947; val_auprc_score: 0.9954; val_best_acc_score: 0.9705; val_best_f1_score: 0.9704; train_kl_reg_loss: 188.8301; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19844.7283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20033.5584; train_optim_loss: 20033.5584; val_kl_reg_loss: 188.3436; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19837.3315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20025.6751; val_optim_loss: 20025.6751
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9956; val_best_acc_score: 0.9712; val_best_f1_score: 0.9710; train_kl_reg_loss: 189.2641; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19842.5955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20031.8596; train_optim_loss: 20031.8596; val_kl_reg_loss: 188.3182; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19834.1526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20022.4708; val_optim_loss: 20022.4708

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9956; val_best_acc_score: 0.9708; val_best_f1_score: 0.9706; train_kl_reg_loss: 189.1679; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19823.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20012.7328; train_optim_loss: 20012.7328; val_kl_reg_loss: 187.7504; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19829.0740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20016.8244; val_optim_loss: 20016.8244
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9948; val_auprc_score: 0.9956; val_best_acc_score: 0.9714; val_best_f1_score: 0.9712; train_kl_reg_loss: 189.0609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19816.3354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20005.3963; train_optim_loss: 20005.3963; val_kl_reg_loss: 187.2397; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19825.7120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20012.9517; val_optim_loss: 20012.9517
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9948; val_auprc_score: 0.9955; val_best_acc_score: 0.9712; val_best_f1_score: 0.9710; train_kl_reg_loss: 189.1392; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19817.8209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20006.9600; train_optim_loss: 20006.9600; val_kl_reg_loss: 187.3976; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19815.0116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20002.4092; val_optim_loss: 20002.4092
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9956; val_best_acc_score: 0.9716; val_best_f1_score: 0.9714; train_kl_reg_loss: 189.0388; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19800.4490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19989.4878; train_optim_loss: 19989.4878; val_kl_reg_loss: 187.8372; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19817.4400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20005.2772; val_optim_loss: 20005.2772
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9949; val_auprc_score: 0.9954; val_best_acc_score: 0.9715; val_best_f1_score: 0.9713; train_kl_reg_loss: 189.2069; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19803.8350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19993.0419; train_optim_loss: 19993.0419; val_kl_reg_loss: 187.7938; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19813.5068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20001.3005; val_optim_loss: 20001.3005
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9956; val_best_acc_score: 0.9713; val_best_f1_score: 0.9711; train_kl_reg_loss: 189.2517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19799.0199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19988.2715; train_optim_loss: 19988.2715; val_kl_reg_loss: 187.7720; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19810.7503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19998.5223; val_optim_loss: 19998.5223
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9950; val_auprc_score: 0.9957; val_best_acc_score: 0.9716; val_best_f1_score: 0.9714; train_kl_reg_loss: 189.2835; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19792.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19982.2497; train_optim_loss: 19982.2497; val_kl_reg_loss: 187.8182; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19822.4372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20010.2553; val_optim_loss: 20010.2553
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9949; val_auprc_score: 0.9956; val_best_acc_score: 0.9713; val_best_f1_score: 0.9710; train_kl_reg_loss: 189.2698; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19799.8768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19989.1466; train_optim_loss: 19989.1466; val_kl_reg_loss: 187.8010; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19803.9562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19991.7573; val_optim_loss: 19991.7573
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9948; val_auprc_score: 0.9956; val_best_acc_score: 0.9711; val_best_f1_score: 0.9708; train_kl_reg_loss: 189.3344; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19799.7909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19989.1253; train_optim_loss: 19989.1253; val_kl_reg_loss: 187.7334; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19821.8248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20009.5583; val_optim_loss: 20009.5583
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9715; val_best_f1_score: 0.9712; train_kl_reg_loss: 189.3025; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19791.8709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19981.1734; train_optim_loss: 19981.1734; val_kl_reg_loss: 187.8049; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19812.5326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20000.3374; val_optim_loss: 20000.3374
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9948; val_auprc_score: 0.9956; val_best_acc_score: 0.9715; val_best_f1_score: 0.9712; train_kl_reg_loss: 189.4504; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19789.3894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19978.8398; train_optim_loss: 19978.8398; val_kl_reg_loss: 187.8719; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19824.8302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20012.7022; val_optim_loss: 20012.7022
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9715; val_best_f1_score: 0.9712; train_kl_reg_loss: 189.5083; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19795.9275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19985.4358; train_optim_loss: 19985.4358; val_kl_reg_loss: 187.8219; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19831.2241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20019.0460; val_optim_loss: 20019.0460

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9949; val_auprc_score: 0.9955; val_best_acc_score: 0.9713; val_best_f1_score: 0.9711; train_kl_reg_loss: 189.5517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19797.7280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19987.2797; train_optim_loss: 19987.2797; val_kl_reg_loss: 187.9393; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19803.0194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19990.9587; val_optim_loss: 19990.9587
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9949; val_auprc_score: 0.9955; val_best_acc_score: 0.9716; val_best_f1_score: 0.9714; train_kl_reg_loss: 189.6329; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19792.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19982.6284; train_optim_loss: 19982.6284; val_kl_reg_loss: 187.9539; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19807.8562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19995.8102; val_optim_loss: 19995.8102
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9950; val_auprc_score: 0.9958; val_best_acc_score: 0.9718; val_best_f1_score: 0.9716; train_kl_reg_loss: 189.6298; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19786.9348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19976.5646; train_optim_loss: 19976.5646; val_kl_reg_loss: 188.0263; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19816.0845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20004.1108; val_optim_loss: 20004.1108
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9949; val_auprc_score: 0.9955; val_best_acc_score: 0.9714; val_best_f1_score: 0.9711; train_kl_reg_loss: 189.6447; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19791.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19980.9472; train_optim_loss: 19980.9472; val_kl_reg_loss: 188.0503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19818.1930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20006.2433; val_optim_loss: 20006.2433
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9950; val_auprc_score: 0.9956; val_best_acc_score: 0.9714; val_best_f1_score: 0.9712; train_kl_reg_loss: 189.6790; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19790.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19979.7025; train_optim_loss: 19979.7025; val_kl_reg_loss: 188.0751; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19814.4745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20002.5497; val_optim_loss: 20002.5497

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9950; val_auprc_score: 0.9957; val_best_acc_score: 0.9715; val_best_f1_score: 0.9713; train_kl_reg_loss: 189.7364; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19789.9586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19979.6950; train_optim_loss: 19979.6950; val_kl_reg_loss: 188.0433; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19825.6380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20013.6813; val_optim_loss: 20013.6813
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9949; val_auprc_score: 0.9957; val_best_acc_score: 0.9717; val_best_f1_score: 0.9714; train_kl_reg_loss: 189.6825; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19792.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19982.1422; train_optim_loss: 19982.1422; val_kl_reg_loss: 187.9957; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19810.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19998.7228; val_optim_loss: 19998.7228
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9950; val_auprc_score: 0.9955; val_best_acc_score: 0.9720; val_best_f1_score: 0.9718; train_kl_reg_loss: 189.7100; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19792.2076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19981.9176; train_optim_loss: 19981.9176; val_kl_reg_loss: 188.1057; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19828.5971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20016.7028; val_optim_loss: 20016.7028
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9950; val_auprc_score: 0.9957; val_best_acc_score: 0.9717; val_best_f1_score: 0.9715; train_kl_reg_loss: 189.6905; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19793.9248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19983.6154; train_optim_loss: 19983.6154; val_kl_reg_loss: 188.0989; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19824.4559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20012.5548; val_optim_loss: 20012.5548

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 397 min 33 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9949
Val AUPRC score: 0.9957
Val best accuracy score: 0.9717
Val best F1 score: 0.9714
Val gene expr MSE score: 8.2799

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
