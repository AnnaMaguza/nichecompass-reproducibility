None
Run timestamp: 05072023_210741_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9491; val_auprc_score: 0.9566; val_best_acc_score: 0.8753; val_best_f1_score: 0.8719; train_kl_reg_loss: 1016.9923; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14477.6851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15494.6774; train_optim_loss: 15494.6774; val_kl_reg_loss: 798.8127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13089.5570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13888.3697; val_optim_loss: 13888.3697
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9526; val_auprc_score: 0.9597; val_best_acc_score: 0.8799; val_best_f1_score: 0.8769; train_kl_reg_loss: 747.5352; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13145.9665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13893.5017; train_optim_loss: 13893.5017; val_kl_reg_loss: 707.4682; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12735.1887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13442.6568; val_optim_loss: 13442.6568
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9575; val_auprc_score: 0.9639; val_best_acc_score: 0.8892; val_best_f1_score: 0.8857; train_kl_reg_loss: 681.2940; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12925.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13606.7836; train_optim_loss: 13606.7836; val_kl_reg_loss: 654.5420; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12627.7063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13282.2483; val_optim_loss: 13282.2483
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9587; val_auprc_score: 0.9649; val_best_acc_score: 0.8891; val_best_f1_score: 0.8868; train_kl_reg_loss: 654.0542; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12840.0780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13494.1321; train_optim_loss: 13494.1321; val_kl_reg_loss: 636.1061; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12574.5337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13210.6398; val_optim_loss: 13210.6398
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9625; val_auprc_score: 0.9682; val_best_acc_score: 0.8968; val_best_f1_score: 0.8933; train_kl_reg_loss: 642.1977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12788.3530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13430.5506; train_optim_loss: 13430.5506; val_kl_reg_loss: 621.9036; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12571.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13192.9174; val_optim_loss: 13192.9174
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9613; val_auprc_score: 0.9675; val_best_acc_score: 0.8944; val_best_f1_score: 0.8924; train_kl_reg_loss: 639.2196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12760.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13399.3797; train_optim_loss: 13399.3797; val_kl_reg_loss: 629.8321; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12535.9127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13165.7447; val_optim_loss: 13165.7447
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9646; val_auprc_score: 0.9702; val_best_acc_score: 0.9014; val_best_f1_score: 0.8973; train_kl_reg_loss: 638.5049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12739.8315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13378.3364; train_optim_loss: 13378.3364; val_kl_reg_loss: 620.6752; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12521.8969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13142.5721; val_optim_loss: 13142.5721
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9649; val_auprc_score: 0.9703; val_best_acc_score: 0.8998; val_best_f1_score: 0.8982; train_kl_reg_loss: 637.9063; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12726.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13363.9811; train_optim_loss: 13363.9811; val_kl_reg_loss: 629.0683; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12513.0989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13142.1672; val_optim_loss: 13142.1672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9653; val_auprc_score: 0.9707; val_best_acc_score: 0.9023; val_best_f1_score: 0.8983; train_kl_reg_loss: 636.8906; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12714.4194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13351.3099; train_optim_loss: 13351.3099; val_kl_reg_loss: 614.6750; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12522.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13137.4696; val_optim_loss: 13137.4696
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9679; val_auprc_score: 0.9729; val_best_acc_score: 0.9069; val_best_f1_score: 0.9033; train_kl_reg_loss: 636.3626; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12704.0054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13340.3680; train_optim_loss: 13340.3680; val_kl_reg_loss: 638.6188; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12477.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13116.4242; val_optim_loss: 13116.4242
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9679; val_auprc_score: 0.9727; val_best_acc_score: 0.9060; val_best_f1_score: 0.9045; train_kl_reg_loss: 636.2466; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12692.6994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13328.9460; train_optim_loss: 13328.9460; val_kl_reg_loss: 633.0660; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12486.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13120.0627; val_optim_loss: 13120.0627
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9691; val_auprc_score: 0.9737; val_best_acc_score: 0.9086; val_best_f1_score: 0.9062; train_kl_reg_loss: 636.8519; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12688.4331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13325.2850; train_optim_loss: 13325.2850; val_kl_reg_loss: 636.0436; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12496.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13132.8422; val_optim_loss: 13132.8422
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9694; val_auprc_score: 0.9741; val_best_acc_score: 0.9092; val_best_f1_score: 0.9062; train_kl_reg_loss: 637.1436; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12683.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13320.5350; train_optim_loss: 13320.5350; val_kl_reg_loss: 622.5161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12497.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13120.1642; val_optim_loss: 13120.1642
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9706; val_auprc_score: 0.9751; val_best_acc_score: 0.9111; val_best_f1_score: 0.9096; train_kl_reg_loss: 637.1440; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12683.1336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13320.2776; train_optim_loss: 13320.2776; val_kl_reg_loss: 613.6633; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12510.7472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13124.4105; val_optim_loss: 13124.4105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9716; val_auprc_score: 0.9758; val_best_acc_score: 0.9141; val_best_f1_score: 0.9115; train_kl_reg_loss: 636.0066; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12615.1748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13251.1813; train_optim_loss: 13251.1813; val_kl_reg_loss: 634.1622; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12448.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13082.7234; val_optim_loss: 13082.7234
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9720; val_auprc_score: 0.9763; val_best_acc_score: 0.9144; val_best_f1_score: 0.9120; train_kl_reg_loss: 636.9556; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12606.5778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13243.5334; train_optim_loss: 13243.5334; val_kl_reg_loss: 630.0217; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12453.6900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13083.7117; val_optim_loss: 13083.7117
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9732; val_auprc_score: 0.9773; val_best_acc_score: 0.9159; val_best_f1_score: 0.9146; train_kl_reg_loss: 637.6100; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12603.1422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13240.7522; train_optim_loss: 13240.7522; val_kl_reg_loss: 627.0841; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12452.7424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13079.8265; val_optim_loss: 13079.8265
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9719; val_auprc_score: 0.9761; val_best_acc_score: 0.9141; val_best_f1_score: 0.9116; train_kl_reg_loss: 638.0514; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12596.2393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13234.2907; train_optim_loss: 13234.2907; val_kl_reg_loss: 632.1208; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12439.4466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13071.5675; val_optim_loss: 13071.5675
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9721; val_auprc_score: 0.9764; val_best_acc_score: 0.9143; val_best_f1_score: 0.9122; train_kl_reg_loss: 638.6631; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12596.6647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13235.3279; train_optim_loss: 13235.3279; val_kl_reg_loss: 632.8000; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12440.3019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13073.1018; val_optim_loss: 13073.1018
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9725; val_auprc_score: 0.9766; val_best_acc_score: 0.9151; val_best_f1_score: 0.9132; train_kl_reg_loss: 638.9338; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12591.3117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13230.2455; train_optim_loss: 13230.2455; val_kl_reg_loss: 634.4003; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12425.8760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13060.2763; val_optim_loss: 13060.2763
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9721; val_auprc_score: 0.9762; val_best_acc_score: 0.9144; val_best_f1_score: 0.9127; train_kl_reg_loss: 639.3833; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12592.7831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13232.1664; train_optim_loss: 13232.1664; val_kl_reg_loss: 628.4276; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12440.2354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13068.6630; val_optim_loss: 13068.6630
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9726; val_auprc_score: 0.9767; val_best_acc_score: 0.9152; val_best_f1_score: 0.9130; train_kl_reg_loss: 639.7561; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12585.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13225.5646; train_optim_loss: 13225.5646; val_kl_reg_loss: 635.9166; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12440.9494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13076.8660; val_optim_loss: 13076.8660
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9722; val_auprc_score: 0.9764; val_best_acc_score: 0.9148; val_best_f1_score: 0.9126; train_kl_reg_loss: 639.9419; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12590.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13230.8178; train_optim_loss: 13230.8178; val_kl_reg_loss: 637.3366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12429.3946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13066.7311; val_optim_loss: 13066.7311
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9719; val_auprc_score: 0.9761; val_best_acc_score: 0.9140; val_best_f1_score: 0.9126; train_kl_reg_loss: 640.3305; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12589.1881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13229.5186; train_optim_loss: 13229.5186; val_kl_reg_loss: 633.9583; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12423.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13057.8018; val_optim_loss: 13057.8018
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9722; val_auprc_score: 0.9764; val_best_acc_score: 0.9142; val_best_f1_score: 0.9128; train_kl_reg_loss: 640.5168; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12585.6830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13226.1998; train_optim_loss: 13226.1998; val_kl_reg_loss: 633.9511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12432.1240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13066.0751; val_optim_loss: 13066.0751
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9722; val_auprc_score: 0.9764; val_best_acc_score: 0.9147; val_best_f1_score: 0.9129; train_kl_reg_loss: 640.7973; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12585.4187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13226.2159; train_optim_loss: 13226.2159; val_kl_reg_loss: 635.7335; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12428.9523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13064.6857; val_optim_loss: 13064.6857
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9731; val_auprc_score: 0.9772; val_best_acc_score: 0.9169; val_best_f1_score: 0.9155; train_kl_reg_loss: 640.8814; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12581.5752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13222.4566; train_optim_loss: 13222.4566; val_kl_reg_loss: 630.7371; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12431.1648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13061.9020; val_optim_loss: 13061.9020
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9733; val_auprc_score: 0.9773; val_best_acc_score: 0.9166; val_best_f1_score: 0.9153; train_kl_reg_loss: 641.1647; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12578.3344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13219.4992; train_optim_loss: 13219.4992; val_kl_reg_loss: 632.5739; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12438.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13071.2960; val_optim_loss: 13071.2960

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9727; val_auprc_score: 0.9768; val_best_acc_score: 0.9148; val_best_f1_score: 0.9136; train_kl_reg_loss: 641.3221; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12571.2525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13212.5747; train_optim_loss: 13212.5747; val_kl_reg_loss: 635.9861; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12416.5796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13052.5657; val_optim_loss: 13052.5657
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9730; val_auprc_score: 0.9769; val_best_acc_score: 0.9160; val_best_f1_score: 0.9145; train_kl_reg_loss: 641.0896; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12571.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13212.6506; train_optim_loss: 13212.6506; val_kl_reg_loss: 633.2811; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12428.0360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13061.3172; val_optim_loss: 13061.3172
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9732; val_auprc_score: 0.9773; val_best_acc_score: 0.9167; val_best_f1_score: 0.9151; train_kl_reg_loss: 641.2196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12570.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13211.5555; train_optim_loss: 13211.5555; val_kl_reg_loss: 633.0027; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12434.1145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13067.1173; val_optim_loss: 13067.1173
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9729; val_auprc_score: 0.9769; val_best_acc_score: 0.9164; val_best_f1_score: 0.9148; train_kl_reg_loss: 641.2809; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12574.3434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13215.6243; train_optim_loss: 13215.6243; val_kl_reg_loss: 634.2906; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12420.0309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13054.3214; val_optim_loss: 13054.3214
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9731; val_auprc_score: 0.9772; val_best_acc_score: 0.9166; val_best_f1_score: 0.9151; train_kl_reg_loss: 641.5449; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12572.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13213.8887; train_optim_loss: 13213.8887; val_kl_reg_loss: 636.4505; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12418.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13054.9265; val_optim_loss: 13054.9265

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9733; val_auprc_score: 0.9774; val_best_acc_score: 0.9168; val_best_f1_score: 0.9152; train_kl_reg_loss: 641.6538; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12568.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13210.3790; train_optim_loss: 13210.3790; val_kl_reg_loss: 634.3950; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12422.2675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13056.6626; val_optim_loss: 13056.6626
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9731; val_auprc_score: 0.9772; val_best_acc_score: 0.9162; val_best_f1_score: 0.9147; train_kl_reg_loss: 641.2911; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12571.0223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13212.3134; train_optim_loss: 13212.3134; val_kl_reg_loss: 634.3176; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12421.8813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13056.1989; val_optim_loss: 13056.1989
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9732; val_auprc_score: 0.9774; val_best_acc_score: 0.9171; val_best_f1_score: 0.9155; train_kl_reg_loss: 641.3828; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12568.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13210.1696; train_optim_loss: 13210.1696; val_kl_reg_loss: 634.9352; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12424.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13059.8428; val_optim_loss: 13059.8428
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9731; val_auprc_score: 0.9771; val_best_acc_score: 0.9167; val_best_f1_score: 0.9151; train_kl_reg_loss: 641.4705; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12568.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13209.8117; train_optim_loss: 13209.8117; val_kl_reg_loss: 634.6749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12428.3608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13063.0357; val_optim_loss: 13063.0357

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 214 min 29 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9727
Val AUPRC score: 0.9768
Val best accuracy score: 0.9154
Val best F1 score: 0.9141
Val gene expr MSE score: 8.5658

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
