None
Run timestamp: 14072023_155355_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9710; val_auprc_score: 0.9705; val_best_acc_score: 0.9113; val_best_f1_score: 0.9121; train_kl_reg_loss: 86977.7539; train_edge_recon_loss: 2888606.3875; train_gene_expr_recon_loss: 13637743.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16613327.8634; train_optim_loss: 16613327.8634; val_kl_reg_loss: 66125.5119; val_edge_recon_loss: 2747554.8697; val_gene_expr_recon_loss: 12917276.7136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15730957.0845; val_optim_loss: 15730957.0845
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9835; val_auprc_score: 0.9830; val_best_acc_score: 0.9348; val_best_f1_score: 0.9351; train_kl_reg_loss: 61881.2847; train_edge_recon_loss: 2694674.0564; train_gene_expr_recon_loss: 12685749.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15442304.9419; train_optim_loss: 15442304.9419; val_kl_reg_loss: 54560.7179; val_edge_recon_loss: 2700573.8322; val_gene_expr_recon_loss: 12562696.4038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15317830.9531; val_optim_loss: 15317830.9531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9868; val_auprc_score: 0.9864; val_best_acc_score: 0.9423; val_best_f1_score: 0.9424; train_kl_reg_loss: 52658.8510; train_edge_recon_loss: 2670040.3810; train_gene_expr_recon_loss: 12458779.0565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15181478.3030; train_optim_loss: 15181478.3030; val_kl_reg_loss: 49257.4333; val_edge_recon_loss: 2682259.0575; val_gene_expr_recon_loss: 12439769.1268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15171285.6338; val_optim_loss: 15171285.6338
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9876; val_auprc_score: 0.9873; val_best_acc_score: 0.9442; val_best_f1_score: 0.9445; train_kl_reg_loss: 48504.9558; train_edge_recon_loss: 2657943.4963; train_gene_expr_recon_loss: 12356976.7164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15063425.1732; train_optim_loss: 15063425.1732; val_kl_reg_loss: 46429.0213; val_edge_recon_loss: 2673556.8157; val_gene_expr_recon_loss: 12369272.7746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15089258.6291; val_optim_loss: 15089258.6291
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9886; val_auprc_score: 0.9883; val_best_acc_score: 0.9470; val_best_f1_score: 0.9472; train_kl_reg_loss: 46334.2760; train_edge_recon_loss: 2652168.3192; train_gene_expr_recon_loss: 12286284.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14984786.6740; train_optim_loss: 14984786.6740; val_kl_reg_loss: 43996.6496; val_edge_recon_loss: 2670892.6455; val_gene_expr_recon_loss: 12335355.7089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15050245.0235; val_optim_loss: 15050245.0235
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9894; val_auprc_score: 0.9891; val_best_acc_score: 0.9491; val_best_f1_score: 0.9492; train_kl_reg_loss: 44608.5405; train_edge_recon_loss: 2648107.6351; train_gene_expr_recon_loss: 12236639.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14929355.3736; train_optim_loss: 14929355.3736; val_kl_reg_loss: 43244.1605; val_edge_recon_loss: 2665266.4859; val_gene_expr_recon_loss: 12293091.6009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15001602.2535; val_optim_loss: 15001602.2535
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9900; val_auprc_score: 0.9895; val_best_acc_score: 0.9501; val_best_f1_score: 0.9503; train_kl_reg_loss: 43343.3461; train_edge_recon_loss: 2643432.8022; train_gene_expr_recon_loss: 12201488.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14888264.9492; train_optim_loss: 14888264.9492; val_kl_reg_loss: 42910.5142; val_edge_recon_loss: 2662485.6538; val_gene_expr_recon_loss: 12272126.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14977523.1268; val_optim_loss: 14977523.1268
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9903; val_auprc_score: 0.9900; val_best_acc_score: 0.9505; val_best_f1_score: 0.9509; train_kl_reg_loss: 42517.3609; train_edge_recon_loss: 2641985.2495; train_gene_expr_recon_loss: 12177876.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14862379.5552; train_optim_loss: 14862379.5552; val_kl_reg_loss: 41731.3551; val_edge_recon_loss: 2658022.5986; val_gene_expr_recon_loss: 12247614.1925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14947368.1784; val_optim_loss: 14947368.1784
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9906; val_auprc_score: 0.9903; val_best_acc_score: 0.9518; val_best_f1_score: 0.9519; train_kl_reg_loss: 41761.7118; train_edge_recon_loss: 2639079.8931; train_gene_expr_recon_loss: 12159338.8127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14840180.4207; train_optim_loss: 14840180.4207; val_kl_reg_loss: 40523.8190; val_edge_recon_loss: 2660698.4167; val_gene_expr_recon_loss: 12235562.8826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14936785.1455; val_optim_loss: 14936785.1455
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9912; val_auprc_score: 0.9908; val_best_acc_score: 0.9534; val_best_f1_score: 0.9537; train_kl_reg_loss: 41065.8958; train_edge_recon_loss: 2638500.7988; train_gene_expr_recon_loss: 12145803.7127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14825370.4103; train_optim_loss: 14825370.4103; val_kl_reg_loss: 40347.4771; val_edge_recon_loss: 2656622.7817; val_gene_expr_recon_loss: 12214789.8169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14911760.0469; val_optim_loss: 14911760.0469
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9910; val_auprc_score: 0.9906; val_best_acc_score: 0.9528; val_best_f1_score: 0.9530; train_kl_reg_loss: 40665.0371; train_edge_recon_loss: 2636910.7004; train_gene_expr_recon_loss: 12128636.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14806212.2350; train_optim_loss: 14806212.2350; val_kl_reg_loss: 39555.1810; val_edge_recon_loss: 2656030.2723; val_gene_expr_recon_loss: 12224627.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14920212.9484; val_optim_loss: 14920212.9484
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9913; val_auprc_score: 0.9910; val_best_acc_score: 0.9543; val_best_f1_score: 0.9544; train_kl_reg_loss: 40254.6472; train_edge_recon_loss: 2634437.3936; train_gene_expr_recon_loss: 12113154.7933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14787846.8273; train_optim_loss: 14787846.8273; val_kl_reg_loss: 39681.4269; val_edge_recon_loss: 2655567.8263; val_gene_expr_recon_loss: 12215206.1127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14910455.3803; val_optim_loss: 14910455.3803
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9916; val_auprc_score: 0.9913; val_best_acc_score: 0.9550; val_best_f1_score: 0.9552; train_kl_reg_loss: 39912.5214; train_edge_recon_loss: 2633830.9214; train_gene_expr_recon_loss: 12107441.3433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14781184.7875; train_optim_loss: 14781184.7875; val_kl_reg_loss: 39013.5148; val_edge_recon_loss: 2657921.9026; val_gene_expr_recon_loss: 12211540.3662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14908475.7277; val_optim_loss: 14908475.7277
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9917; val_best_acc_score: 0.9562; val_best_f1_score: 0.9563; train_kl_reg_loss: 39588.5907; train_edge_recon_loss: 2632576.3819; train_gene_expr_recon_loss: 12100741.3176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14772906.2794; train_optim_loss: 14772906.2794; val_kl_reg_loss: 38835.2890; val_edge_recon_loss: 2654408.1549; val_gene_expr_recon_loss: 12201272.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14894515.7042; val_optim_loss: 14894515.7042
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9921; val_auprc_score: 0.9917; val_best_acc_score: 0.9560; val_best_f1_score: 0.9562; train_kl_reg_loss: 39288.4005; train_edge_recon_loss: 2632118.6115; train_gene_expr_recon_loss: 12090611.2439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14762018.2533; train_optim_loss: 14762018.2533; val_kl_reg_loss: 38170.1249; val_edge_recon_loss: 2654493.8897; val_gene_expr_recon_loss: 12205636.9296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14898300.9343; val_optim_loss: 14898300.9343
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9922; val_auprc_score: 0.9919; val_best_acc_score: 0.9569; val_best_f1_score: 0.9570; train_kl_reg_loss: 38973.3853; train_edge_recon_loss: 2631068.1795; train_gene_expr_recon_loss: 12089124.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14759166.1695; train_optim_loss: 14759166.1695; val_kl_reg_loss: 37671.1033; val_edge_recon_loss: 2650677.9965; val_gene_expr_recon_loss: 12192912.8685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14881261.9671; val_optim_loss: 14881261.9671
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9923; val_auprc_score: 0.9920; val_best_acc_score: 0.9574; val_best_f1_score: 0.9575; train_kl_reg_loss: 38849.7759; train_edge_recon_loss: 2629511.3968; train_gene_expr_recon_loss: 12077959.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14746321.0173; train_optim_loss: 14746321.0173; val_kl_reg_loss: 37973.4498; val_edge_recon_loss: 2653045.9800; val_gene_expr_recon_loss: 12197368.1690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14888387.6150; val_optim_loss: 14888387.6150
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9925; val_auprc_score: 0.9921; val_best_acc_score: 0.9575; val_best_f1_score: 0.9577; train_kl_reg_loss: 38575.7938; train_edge_recon_loss: 2629576.8592; train_gene_expr_recon_loss: 12077912.0513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14746064.7049; train_optim_loss: 14746064.7049; val_kl_reg_loss: 37920.3890; val_edge_recon_loss: 2652301.3991; val_gene_expr_recon_loss: 12208594.7371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14898816.5352; val_optim_loss: 14898816.5352
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9923; val_auprc_score: 0.9919; val_best_acc_score: 0.9575; val_best_f1_score: 0.9575; train_kl_reg_loss: 38308.7603; train_edge_recon_loss: 2628523.4283; train_gene_expr_recon_loss: 12079144.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14745976.3459; train_optim_loss: 14745976.3459; val_kl_reg_loss: 36966.6991; val_edge_recon_loss: 2651765.7876; val_gene_expr_recon_loss: 12198617.0892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14887349.5540; val_optim_loss: 14887349.5540
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9924; val_auprc_score: 0.9921; val_best_acc_score: 0.9573; val_best_f1_score: 0.9574; train_kl_reg_loss: 38237.6316; train_edge_recon_loss: 2627937.4048; train_gene_expr_recon_loss: 12074054.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14740229.5495; train_optim_loss: 14740229.5495; val_kl_reg_loss: 37382.5873; val_edge_recon_loss: 2653381.8920; val_gene_expr_recon_loss: 12169408.8779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14860173.3380; val_optim_loss: 14860173.3380
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9924; val_auprc_score: 0.9919; val_best_acc_score: 0.9578; val_best_f1_score: 0.9579; train_kl_reg_loss: 38002.2900; train_edge_recon_loss: 2627483.4430; train_gene_expr_recon_loss: 12064297.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14729783.5819; train_optim_loss: 14729783.5819; val_kl_reg_loss: 36890.4981; val_edge_recon_loss: 2649534.8897; val_gene_expr_recon_loss: 12190670.1596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14877095.5305; val_optim_loss: 14877095.5305
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9925; val_auprc_score: 0.9919; val_best_acc_score: 0.9583; val_best_f1_score: 0.9586; train_kl_reg_loss: 37741.4124; train_edge_recon_loss: 2626988.7547; train_gene_expr_recon_loss: 12066413.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14731143.3066; train_optim_loss: 14731143.3066; val_kl_reg_loss: 37135.3631; val_edge_recon_loss: 2647412.9824; val_gene_expr_recon_loss: 12175273.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14859822.2817; val_optim_loss: 14859822.2817
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9925; val_auprc_score: 0.9919; val_best_acc_score: 0.9582; val_best_f1_score: 0.9582; train_kl_reg_loss: 37641.3495; train_edge_recon_loss: 2626608.9536; train_gene_expr_recon_loss: 12056321.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14720572.2261; train_optim_loss: 14720572.2261; val_kl_reg_loss: 37236.3301; val_edge_recon_loss: 2648259.6972; val_gene_expr_recon_loss: 12173799.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14859295.7277; val_optim_loss: 14859295.7277
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9597; val_best_f1_score: 0.9597; train_kl_reg_loss: 37524.8289; train_edge_recon_loss: 2625840.4783; train_gene_expr_recon_loss: 12053538.9262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14716904.2203; train_optim_loss: 14716904.2203; val_kl_reg_loss: 36683.2050; val_edge_recon_loss: 2647841.2183; val_gene_expr_recon_loss: 12215178.2113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14899702.6385; val_optim_loss: 14899702.6385
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9931; val_auprc_score: 0.9928; val_best_acc_score: 0.9598; val_best_f1_score: 0.9599; train_kl_reg_loss: 37227.3758; train_edge_recon_loss: 2625743.1877; train_gene_expr_recon_loss: 12051539.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14714509.8655; train_optim_loss: 14714509.8655; val_kl_reg_loss: 36278.7322; val_edge_recon_loss: 2646960.4284; val_gene_expr_recon_loss: 12182427.0141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14865666.1643; val_optim_loss: 14865666.1643
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9930; val_auprc_score: 0.9925; val_best_acc_score: 0.9602; val_best_f1_score: 0.9604; train_kl_reg_loss: 37129.2510; train_edge_recon_loss: 2624660.3524; train_gene_expr_recon_loss: 12049216.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14711005.9696; train_optim_loss: 14711005.9696; val_kl_reg_loss: 36670.5115; val_edge_recon_loss: 2646776.7887; val_gene_expr_recon_loss: 12180429.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14863876.7277; val_optim_loss: 14863876.7277
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9933; val_auprc_score: 0.9930; val_best_acc_score: 0.9601; val_best_f1_score: 0.9602; train_kl_reg_loss: 36924.4669; train_edge_recon_loss: 2625227.9151; train_gene_expr_recon_loss: 12051311.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14713463.9958; train_optim_loss: 14713463.9958; val_kl_reg_loss: 36373.7727; val_edge_recon_loss: 2647003.4707; val_gene_expr_recon_loss: 12192981.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14876358.4366; val_optim_loss: 14876358.4366

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9935; val_auprc_score: 0.9930; val_best_acc_score: 0.9614; val_best_f1_score: 0.9614; train_kl_reg_loss: 38341.3875; train_edge_recon_loss: 2621938.6913; train_gene_expr_recon_loss: 11962277.7127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14622557.7896; train_optim_loss: 14622557.7896; val_kl_reg_loss: 37722.1271; val_edge_recon_loss: 2643734.5317; val_gene_expr_recon_loss: 12098542.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14779999.1784; val_optim_loss: 14779999.1784
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9935; val_auprc_score: 0.9931; val_best_acc_score: 0.9611; val_best_f1_score: 0.9613; train_kl_reg_loss: 38705.7206; train_edge_recon_loss: 2621012.5412; train_gene_expr_recon_loss: 11953772.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14613490.4103; train_optim_loss: 14613490.4103; val_kl_reg_loss: 38102.3574; val_edge_recon_loss: 2645122.1197; val_gene_expr_recon_loss: 12077631.9061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14760856.3803; val_optim_loss: 14760856.3803
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9937; val_auprc_score: 0.9934; val_best_acc_score: 0.9614; val_best_f1_score: 0.9615; train_kl_reg_loss: 38784.8766; train_edge_recon_loss: 2620107.2576; train_gene_expr_recon_loss: 11948908.1005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14607800.2402; train_optim_loss: 14607800.2402; val_kl_reg_loss: 37931.6962; val_edge_recon_loss: 2643956.2852; val_gene_expr_recon_loss: 12098824.8967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14780712.8732; val_optim_loss: 14780712.8732
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9936; val_auprc_score: 0.9933; val_best_acc_score: 0.9615; val_best_f1_score: 0.9617; train_kl_reg_loss: 38688.8405; train_edge_recon_loss: 2620555.7473; train_gene_expr_recon_loss: 11947963.5228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14607208.1141; train_optim_loss: 14607208.1141; val_kl_reg_loss: 37850.4295; val_edge_recon_loss: 2642153.7512; val_gene_expr_recon_loss: 12076457.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14756461.7700; val_optim_loss: 14756461.7700
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9935; val_auprc_score: 0.9932; val_best_acc_score: 0.9616; val_best_f1_score: 0.9618; train_kl_reg_loss: 38624.9298; train_edge_recon_loss: 2620542.5298; train_gene_expr_recon_loss: 11944967.7750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14604135.2449; train_optim_loss: 14604135.2449; val_kl_reg_loss: 37816.7060; val_edge_recon_loss: 2643638.9730; val_gene_expr_recon_loss: 12085963.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14767419.1784; val_optim_loss: 14767419.1784
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9936; val_auprc_score: 0.9932; val_best_acc_score: 0.9615; val_best_f1_score: 0.9617; train_kl_reg_loss: 38520.4865; train_edge_recon_loss: 2619784.8493; train_gene_expr_recon_loss: 11942842.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14601148.2020; train_optim_loss: 14601148.2020; val_kl_reg_loss: 37732.1958; val_edge_recon_loss: 2644052.6432; val_gene_expr_recon_loss: 12097548.8685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14779333.7230; val_optim_loss: 14779333.7230
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9937; val_auprc_score: 0.9934; val_best_acc_score: 0.9619; val_best_f1_score: 0.9621; train_kl_reg_loss: 38421.6088; train_edge_recon_loss: 2620326.6189; train_gene_expr_recon_loss: 11945792.0194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14604540.2339; train_optim_loss: 14604540.2339; val_kl_reg_loss: 37626.8319; val_edge_recon_loss: 2643805.1185; val_gene_expr_recon_loss: 12066090.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14747522.1972; val_optim_loss: 14747522.1972
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9938; val_auprc_score: 0.9936; val_best_acc_score: 0.9621; val_best_f1_score: 0.9623; train_kl_reg_loss: 38248.9833; train_edge_recon_loss: 2619561.9322; train_gene_expr_recon_loss: 11941195.7441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14599006.6541; train_optim_loss: 14599006.6541; val_kl_reg_loss: 37277.1393; val_edge_recon_loss: 2643014.4777; val_gene_expr_recon_loss: 12077259.7465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14757551.3568; val_optim_loss: 14757551.3568
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9938; val_auprc_score: 0.9935; val_best_acc_score: 0.9625; val_best_f1_score: 0.9627; train_kl_reg_loss: 38129.7531; train_edge_recon_loss: 2620108.3965; train_gene_expr_recon_loss: 11941223.8791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14599462.0256; train_optim_loss: 14599462.0256; val_kl_reg_loss: 37298.4787; val_edge_recon_loss: 2641201.2688; val_gene_expr_recon_loss: 12081776.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14760276.1831; val_optim_loss: 14760276.1831
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9936; val_auprc_score: 0.9933; val_best_acc_score: 0.9622; val_best_f1_score: 0.9624; train_kl_reg_loss: 38094.7693; train_edge_recon_loss: 2619645.7669; train_gene_expr_recon_loss: 11939762.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14597502.6243; train_optim_loss: 14597502.6243; val_kl_reg_loss: 37248.3846; val_edge_recon_loss: 2641914.3110; val_gene_expr_recon_loss: 12077305.1690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14756467.8498; val_optim_loss: 14756467.8498
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9939; val_auprc_score: 0.9936; val_best_acc_score: 0.9620; val_best_f1_score: 0.9622; train_kl_reg_loss: 37969.5692; train_edge_recon_loss: 2620212.1456; train_gene_expr_recon_loss: 11938424.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14596606.6384; train_optim_loss: 14596606.6384; val_kl_reg_loss: 37170.0079; val_edge_recon_loss: 2642759.5962; val_gene_expr_recon_loss: 12084899.9061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14764829.5399; val_optim_loss: 14764829.5399

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9937; val_auprc_score: 0.9933; val_best_acc_score: 0.9621; val_best_f1_score: 0.9622; train_kl_reg_loss: 37989.9433; train_edge_recon_loss: 2620335.9250; train_gene_expr_recon_loss: 11927851.0115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14586176.8802; train_optim_loss: 14586176.8802; val_kl_reg_loss: 37276.9391; val_edge_recon_loss: 2642876.4519; val_gene_expr_recon_loss: 12058885.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14739039.0563; val_optim_loss: 14739039.0563
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9938; val_auprc_score: 0.9933; val_best_acc_score: 0.9619; val_best_f1_score: 0.9621; train_kl_reg_loss: 38042.7947; train_edge_recon_loss: 2619308.6724; train_gene_expr_recon_loss: 11928563.5186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14585914.9864; train_optim_loss: 14585914.9864; val_kl_reg_loss: 37272.4652; val_edge_recon_loss: 2642798.3451; val_gene_expr_recon_loss: 12075716.2160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14755786.9953; val_optim_loss: 14755786.9953
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9938; val_auprc_score: 0.9934; val_best_acc_score: 0.9621; val_best_f1_score: 0.9621; train_kl_reg_loss: 38056.3935; train_edge_recon_loss: 2619747.5383; train_gene_expr_recon_loss: 11926057.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14583861.7420; train_optim_loss: 14583861.7420; val_kl_reg_loss: 37275.4438; val_edge_recon_loss: 2643066.4002; val_gene_expr_recon_loss: 12067401.5915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14747743.4178; val_optim_loss: 14747743.4178
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9936; val_auprc_score: 0.9932; val_best_acc_score: 0.9618; val_best_f1_score: 0.9619; train_kl_reg_loss: 38053.1695; train_edge_recon_loss: 2619586.7992; train_gene_expr_recon_loss: 11924245.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14581885.8142; train_optim_loss: 14581885.8142; val_kl_reg_loss: 37261.7966; val_edge_recon_loss: 2641310.2254; val_gene_expr_recon_loss: 12073091.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14751663.6103; val_optim_loss: 14751663.6103
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9937; val_auprc_score: 0.9934; val_best_acc_score: 0.9614; val_best_f1_score: 0.9616; train_kl_reg_loss: 38069.0302; train_edge_recon_loss: 2618901.9436; train_gene_expr_recon_loss: 11925633.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14582604.7572; train_optim_loss: 14582604.7572; val_kl_reg_loss: 37302.4831; val_edge_recon_loss: 2644086.6103; val_gene_expr_recon_loss: 12071670.7793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14753059.9014; val_optim_loss: 14753059.9014

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9938; val_auprc_score: 0.9935; val_best_acc_score: 0.9625; val_best_f1_score: 0.9626; train_kl_reg_loss: 38093.1314; train_edge_recon_loss: 2619412.0701; train_gene_expr_recon_loss: 11922650.8158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14580156.0120; train_optim_loss: 14580156.0120; val_kl_reg_loss: 37315.4950; val_edge_recon_loss: 2641988.5352; val_gene_expr_recon_loss: 12070425.8685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14749729.8826; val_optim_loss: 14749729.8826
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9936; val_auprc_score: 0.9931; val_best_acc_score: 0.9620; val_best_f1_score: 0.9622; train_kl_reg_loss: 38100.5952; train_edge_recon_loss: 2619988.0597; train_gene_expr_recon_loss: 11925778.0706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14583866.7258; train_optim_loss: 14583866.7258; val_kl_reg_loss: 37300.8048; val_edge_recon_loss: 2644049.2148; val_gene_expr_recon_loss: 12063814.0798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14745164.1127; val_optim_loss: 14745164.1127
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9939; val_auprc_score: 0.9935; val_best_acc_score: 0.9625; val_best_f1_score: 0.9626; train_kl_reg_loss: 38099.7558; train_edge_recon_loss: 2618812.0417; train_gene_expr_recon_loss: 11920721.8749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14577633.6729; train_optim_loss: 14577633.6729; val_kl_reg_loss: 37317.2235; val_edge_recon_loss: 2637845.3052; val_gene_expr_recon_loss: 12069013.0141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14744175.5352; val_optim_loss: 14744175.5352
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9936; val_auprc_score: 0.9933; val_best_acc_score: 0.9615; val_best_f1_score: 0.9617; train_kl_reg_loss: 38100.2266; train_edge_recon_loss: 2619229.0700; train_gene_expr_recon_loss: 11920683.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14578013.1099; train_optim_loss: 14578013.1099; val_kl_reg_loss: 37288.1627; val_edge_recon_loss: 2643224.3744; val_gene_expr_recon_loss: 12080828.8545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14761341.3803; val_optim_loss: 14761341.3803

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 393 min 59 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9937
Val AUPRC score: 0.9935
Val best accuracy score: 0.9616
Val best F1 score: 0.9618
Val gene expr MSE score: 8.3765

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
