None
Run timestamp: 03072023_122014_2005.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2005']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9802; val_auprc_score: 0.9698; val_best_acc_score: 0.9503; val_best_f1_score: 0.9517; train_kl_reg_loss: 5889.7431; train_edge_recon_loss: 267031.3658; train_gene_expr_recon_loss: 14443.1087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 287364.2176; train_optim_loss: 287364.2176; val_kl_reg_loss: 5796.7160; val_edge_recon_loss: 258777.6204; val_gene_expr_recon_loss: 13287.1649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277861.5030; val_optim_loss: 277861.5030
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9833; val_auprc_score: 0.9748; val_best_acc_score: 0.9577; val_best_f1_score: 0.9588; train_kl_reg_loss: 5760.9767; train_edge_recon_loss: 258889.1145; train_gene_expr_recon_loss: 12765.4856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277415.5772; train_optim_loss: 277415.5772; val_kl_reg_loss: 5729.1432; val_edge_recon_loss: 257742.5080; val_gene_expr_recon_loss: 12435.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275906.9436; val_optim_loss: 275906.9436
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9849; val_auprc_score: 0.9774; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 5738.3099; train_edge_recon_loss: 258097.9007; train_gene_expr_recon_loss: 12171.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276007.4429; train_optim_loss: 276007.4429; val_kl_reg_loss: 5628.4233; val_edge_recon_loss: 257335.5678; val_gene_expr_recon_loss: 12051.8527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275015.8438; val_optim_loss: 275015.8438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9872; val_auprc_score: 0.9810; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 5732.3965; train_edge_recon_loss: 257485.3885; train_gene_expr_recon_loss: 11824.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275042.5530; train_optim_loss: 275042.5530; val_kl_reg_loss: 5693.3659; val_edge_recon_loss: 256859.4322; val_gene_expr_recon_loss: 11763.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274316.6242; val_optim_loss: 274316.6242
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9880; val_auprc_score: 0.9825; val_best_acc_score: 0.9665; val_best_f1_score: 0.9672; train_kl_reg_loss: 5731.6730; train_edge_recon_loss: 257185.3074; train_gene_expr_recon_loss: 11592.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274509.7486; train_optim_loss: 274509.7486; val_kl_reg_loss: 5704.5067; val_edge_recon_loss: 256737.9821; val_gene_expr_recon_loss: 11555.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273997.7744; val_optim_loss: 273997.7744
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9894; val_auprc_score: 0.9842; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 5728.3577; train_edge_recon_loss: 257123.1575; train_gene_expr_recon_loss: 11416.6908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274268.2066; train_optim_loss: 274268.2066; val_kl_reg_loss: 5612.6062; val_edge_recon_loss: 256198.1105; val_gene_expr_recon_loss: 11476.5040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273287.2195; val_optim_loss: 273287.2195
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9894; val_auprc_score: 0.9840; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 5729.1855; train_edge_recon_loss: 256997.4706; train_gene_expr_recon_loss: 11301.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274028.1456; train_optim_loss: 274028.1456; val_kl_reg_loss: 5597.7893; val_edge_recon_loss: 255824.0530; val_gene_expr_recon_loss: 11296.7256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272718.5671; val_optim_loss: 272718.5671
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9902; val_auprc_score: 0.9858; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 5726.9283; train_edge_recon_loss: 256778.8006; train_gene_expr_recon_loss: 11178.1690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273683.8981; train_optim_loss: 273683.8981; val_kl_reg_loss: 5635.8459; val_edge_recon_loss: 256109.5111; val_gene_expr_recon_loss: 11178.9269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272924.2858; val_optim_loss: 272924.2858
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9917; val_auprc_score: 0.9880; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 5722.4992; train_edge_recon_loss: 256788.7827; train_gene_expr_recon_loss: 11083.6802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273594.9617; train_optim_loss: 273594.9617; val_kl_reg_loss: 5688.5005; val_edge_recon_loss: 255721.8281; val_gene_expr_recon_loss: 11103.5686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272513.9002; val_optim_loss: 272513.9002
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9909; val_auprc_score: 0.9863; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 5722.2865; train_edge_recon_loss: 256513.6760; train_gene_expr_recon_loss: 11012.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273248.1427; train_optim_loss: 273248.1427; val_kl_reg_loss: 5589.5537; val_edge_recon_loss: 256070.8152; val_gene_expr_recon_loss: 11055.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272715.9985; val_optim_loss: 272715.9985
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9920; val_auprc_score: 0.9881; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 5722.8874; train_edge_recon_loss: 256453.2918; train_gene_expr_recon_loss: 10932.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273108.7233; train_optim_loss: 273108.7233; val_kl_reg_loss: 5652.0731; val_edge_recon_loss: 255971.9196; val_gene_expr_recon_loss: 10995.0493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272619.0442; val_optim_loss: 272619.0442
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9892; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 5726.1925; train_edge_recon_loss: 256306.8924; train_gene_expr_recon_loss: 10867.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272900.1393; train_optim_loss: 272900.1393; val_kl_reg_loss: 5680.9781; val_edge_recon_loss: 255442.8910; val_gene_expr_recon_loss: 10886.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272009.9284; val_optim_loss: 272009.9284
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9928; val_auprc_score: 0.9892; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 5728.1276; train_edge_recon_loss: 256224.8477; train_gene_expr_recon_loss: 10806.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272759.0673; train_optim_loss: 272759.0673; val_kl_reg_loss: 5638.4597; val_edge_recon_loss: 255773.5987; val_gene_expr_recon_loss: 10837.9525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272250.0145; val_optim_loss: 272250.0145
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9933; val_auprc_score: 0.9900; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5726.4470; train_edge_recon_loss: 256195.1202; train_gene_expr_recon_loss: 10769.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272691.3465; train_optim_loss: 272691.3465; val_kl_reg_loss: 5659.6319; val_edge_recon_loss: 255563.9497; val_gene_expr_recon_loss: 10811.0772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272034.6616; val_optim_loss: 272034.6616
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9935; val_auprc_score: 0.9909; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 5725.3255; train_edge_recon_loss: 256120.7557; train_gene_expr_recon_loss: 10712.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272558.7604; train_optim_loss: 272558.7604; val_kl_reg_loss: 5716.0665; val_edge_recon_loss: 255343.0701; val_gene_expr_recon_loss: 10755.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271814.7645; val_optim_loss: 271814.7645
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9938; val_auprc_score: 0.9909; val_best_acc_score: 0.9769; val_best_f1_score: 0.9773; train_kl_reg_loss: 5730.0235; train_edge_recon_loss: 256041.2296; train_gene_expr_recon_loss: 10674.0561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272445.3096; train_optim_loss: 272445.3096; val_kl_reg_loss: 5716.3377; val_edge_recon_loss: 255434.2389; val_gene_expr_recon_loss: 10729.9971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271880.5709; val_optim_loss: 271880.5709
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9939; val_auprc_score: 0.9904; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 5728.0992; train_edge_recon_loss: 255980.2185; train_gene_expr_recon_loss: 10644.2795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272352.5971; train_optim_loss: 272352.5971; val_kl_reg_loss: 5761.3029; val_edge_recon_loss: 255245.6959; val_gene_expr_recon_loss: 10666.0010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271673.0023; val_optim_loss: 271673.0023
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9916; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 5730.8603; train_edge_recon_loss: 255973.5581; train_gene_expr_recon_loss: 10604.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272308.8021; train_optim_loss: 272308.8021; val_kl_reg_loss: 5655.6285; val_edge_recon_loss: 254941.4691; val_gene_expr_recon_loss: 10672.0177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271269.1159; val_optim_loss: 271269.1159
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9943; val_auprc_score: 0.9918; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 5725.7173; train_edge_recon_loss: 255934.6430; train_gene_expr_recon_loss: 10572.8093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272233.1696; train_optim_loss: 272233.1696; val_kl_reg_loss: 5612.1356; val_edge_recon_loss: 255257.6418; val_gene_expr_recon_loss: 10651.0872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271520.8643; val_optim_loss: 271520.8643
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9944; val_auprc_score: 0.9917; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 5729.0981; train_edge_recon_loss: 255878.9969; train_gene_expr_recon_loss: 10542.3874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272150.4823; train_optim_loss: 272150.4823; val_kl_reg_loss: 5589.5970; val_edge_recon_loss: 255208.2485; val_gene_expr_recon_loss: 10621.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271419.3163; val_optim_loss: 271419.3163
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9923; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 5726.2929; train_edge_recon_loss: 255815.6312; train_gene_expr_recon_loss: 10517.0206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272058.9443; train_optim_loss: 272058.9443; val_kl_reg_loss: 5683.4025; val_edge_recon_loss: 255301.7580; val_gene_expr_recon_loss: 10575.1041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271560.2652; val_optim_loss: 271560.2652
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9923; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5724.9539; train_edge_recon_loss: 255865.1381; train_gene_expr_recon_loss: 10482.8232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272072.9151; train_optim_loss: 272072.9151; val_kl_reg_loss: 5708.2227; val_edge_recon_loss: 254810.1593; val_gene_expr_recon_loss: 10534.1552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271052.5366; val_optim_loss: 271052.5366
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9949; val_auprc_score: 0.9924; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 5723.9790; train_edge_recon_loss: 255789.4436; train_gene_expr_recon_loss: 10465.1993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271978.6220; train_optim_loss: 271978.6220; val_kl_reg_loss: 5735.1524; val_edge_recon_loss: 255101.9836; val_gene_expr_recon_loss: 10522.1918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271359.3285; val_optim_loss: 271359.3285
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9920; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5726.8038; train_edge_recon_loss: 255600.2135; train_gene_expr_recon_loss: 10450.3028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271777.3197; train_optim_loss: 271777.3197; val_kl_reg_loss: 5710.3023; val_edge_recon_loss: 254841.0297; val_gene_expr_recon_loss: 10508.6951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271060.0297; val_optim_loss: 271060.0297
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9950; val_auprc_score: 0.9926; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 5726.5032; train_edge_recon_loss: 255596.3863; train_gene_expr_recon_loss: 10428.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271751.6175; train_optim_loss: 271751.6175; val_kl_reg_loss: 5768.3931; val_edge_recon_loss: 254801.6860; val_gene_expr_recon_loss: 10482.3429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271052.4215; val_optim_loss: 271052.4215
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9951; val_auprc_score: 0.9925; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5726.1227; train_edge_recon_loss: 255608.3441; train_gene_expr_recon_loss: 10418.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271753.3110; train_optim_loss: 271753.3110; val_kl_reg_loss: 5766.9271; val_edge_recon_loss: 255063.4848; val_gene_expr_recon_loss: 10462.4434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271292.8559; val_optim_loss: 271292.8559
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9957; val_auprc_score: 0.9933; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 5725.9266; train_edge_recon_loss: 255545.4223; train_gene_expr_recon_loss: 10400.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271672.2391; train_optim_loss: 271672.2391; val_kl_reg_loss: 5660.0184; val_edge_recon_loss: 254531.2630; val_gene_expr_recon_loss: 10483.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270674.9329; val_optim_loss: 270674.9329
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9958; val_auprc_score: 0.9937; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5725.8275; train_edge_recon_loss: 255513.1989; train_gene_expr_recon_loss: 10393.9171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271632.9438; train_optim_loss: 271632.9438; val_kl_reg_loss: 5704.0576; val_edge_recon_loss: 254844.0678; val_gene_expr_recon_loss: 10458.9191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271007.0434; val_optim_loss: 271007.0434
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9931; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 5724.9684; train_edge_recon_loss: 255460.3031; train_gene_expr_recon_loss: 10380.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271565.6772; train_optim_loss: 271565.6772; val_kl_reg_loss: 5725.7034; val_edge_recon_loss: 254492.6220; val_gene_expr_recon_loss: 10457.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270675.3994; val_optim_loss: 270675.3994
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9956; val_auprc_score: 0.9935; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 5724.8210; train_edge_recon_loss: 255492.1754; train_gene_expr_recon_loss: 10367.5870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271584.5833; train_optim_loss: 271584.5833; val_kl_reg_loss: 5597.4144; val_edge_recon_loss: 254526.9097; val_gene_expr_recon_loss: 10417.6545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270541.9787; val_optim_loss: 270541.9787
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9933; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 5727.1030; train_edge_recon_loss: 255294.4765; train_gene_expr_recon_loss: 10352.9436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271374.5234; train_optim_loss: 271374.5234; val_kl_reg_loss: 5705.3068; val_edge_recon_loss: 254506.0248; val_gene_expr_recon_loss: 10415.7418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270627.0724; val_optim_loss: 270627.0724
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9960; val_auprc_score: 0.9938; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 5722.7873; train_edge_recon_loss: 255419.2782; train_gene_expr_recon_loss: 10335.7613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271477.8270; train_optim_loss: 271477.8270; val_kl_reg_loss: 5732.8702; val_edge_recon_loss: 254556.2679; val_gene_expr_recon_loss: 10421.6269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270710.7637; val_optim_loss: 270710.7637
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9961; val_auprc_score: 0.9941; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 5726.9887; train_edge_recon_loss: 255372.7298; train_gene_expr_recon_loss: 10327.2301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271426.9489; train_optim_loss: 271426.9489; val_kl_reg_loss: 5713.1764; val_edge_recon_loss: 254108.5454; val_gene_expr_recon_loss: 10381.6580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270203.3826; val_optim_loss: 270203.3826
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9962; val_auprc_score: 0.9941; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 5725.4069; train_edge_recon_loss: 255383.5914; train_gene_expr_recon_loss: 10321.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271430.5684; train_optim_loss: 271430.5684; val_kl_reg_loss: 5633.8753; val_edge_recon_loss: 254533.3399; val_gene_expr_recon_loss: 10399.1293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270566.3438; val_optim_loss: 270566.3438
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9940; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 5725.4504; train_edge_recon_loss: 255352.1320; train_gene_expr_recon_loss: 10297.6446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271375.2270; train_optim_loss: 271375.2270; val_kl_reg_loss: 5685.8923; val_edge_recon_loss: 254457.7146; val_gene_expr_recon_loss: 10396.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270540.0389; val_optim_loss: 270540.0389
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9962; val_auprc_score: 0.9945; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 5726.9268; train_edge_recon_loss: 255320.0684; train_gene_expr_recon_loss: 10289.9845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271336.9805; train_optim_loss: 271336.9805; val_kl_reg_loss: 5695.3860; val_edge_recon_loss: 254557.1357; val_gene_expr_recon_loss: 10383.6995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270636.2218; val_optim_loss: 270636.2218
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9947; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 5729.5152; train_edge_recon_loss: 255179.9282; train_gene_expr_recon_loss: 10299.2009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271208.6444; train_optim_loss: 271208.6444; val_kl_reg_loss: 5736.9166; val_edge_recon_loss: 254460.6414; val_gene_expr_recon_loss: 10367.2979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270564.8559; val_optim_loss: 270564.8559

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9945; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 5715.7332; train_edge_recon_loss: 255151.8416; train_gene_expr_recon_loss: 10261.2606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271128.8353; train_optim_loss: 271128.8353; val_kl_reg_loss: 5671.4216; val_edge_recon_loss: 254235.0659; val_gene_expr_recon_loss: 10350.0284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270256.5145; val_optim_loss: 270256.5145
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9963; val_auprc_score: 0.9946; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 5710.2124; train_edge_recon_loss: 255139.8654; train_gene_expr_recon_loss: 10250.4873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271100.5646; train_optim_loss: 271100.5646; val_kl_reg_loss: 5673.5328; val_edge_recon_loss: 254526.1239; val_gene_expr_recon_loss: 10333.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270532.8567; val_optim_loss: 270532.8567
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 5709.6997; train_edge_recon_loss: 255053.1220; train_gene_expr_recon_loss: 10250.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271013.0848; train_optim_loss: 271013.0848; val_kl_reg_loss: 5676.6654; val_edge_recon_loss: 254378.8563; val_gene_expr_recon_loss: 10307.8244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270363.3445; val_optim_loss: 270363.3445
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9963; val_auprc_score: 0.9948; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 5706.2632; train_edge_recon_loss: 255206.6436; train_gene_expr_recon_loss: 10249.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271162.6805; train_optim_loss: 271162.6805; val_kl_reg_loss: 5671.6994; val_edge_recon_loss: 254471.2157; val_gene_expr_recon_loss: 10344.0166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270486.9329; val_optim_loss: 270486.9329

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 113 min 54 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9957
Val AUPRC score: 0.9933
Val best accuracy score: 0.9840
Val best F1 score: 0.9842
Val gene expr MSE score: 0.6940

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
