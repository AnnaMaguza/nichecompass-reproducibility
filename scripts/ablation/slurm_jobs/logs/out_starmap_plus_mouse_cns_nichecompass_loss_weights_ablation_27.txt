None
Run timestamp: 02072023_131520_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9846; val_auprc_score: 0.9772; val_best_acc_score: 0.9564; val_best_f1_score: 0.9572; train_kl_reg_loss: 5566.1134; train_edge_recon_loss: 264515.3728; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270081.4857; train_optim_loss: 270081.4857; val_kl_reg_loss: 5424.1794; val_edge_recon_loss: 258222.2828; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263646.4623; val_optim_loss: 263646.4623
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9872; val_auprc_score: 0.9812; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 5477.9872; train_edge_recon_loss: 257984.5729; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263462.5593; train_optim_loss: 263462.5593; val_kl_reg_loss: 5357.8360; val_edge_recon_loss: 256618.4403; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261976.2782; val_optim_loss: 261976.2782
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9897; val_auprc_score: 0.9848; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 5473.8426; train_edge_recon_loss: 257184.1114; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262657.9542; train_optim_loss: 262657.9542; val_kl_reg_loss: 5315.3065; val_edge_recon_loss: 256100.0840; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261415.3909; val_optim_loss: 261415.3909
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9913; val_auprc_score: 0.9872; val_best_acc_score: 0.9725; val_best_f1_score: 0.9730; train_kl_reg_loss: 5462.4996; train_edge_recon_loss: 256826.7124; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262289.2119; train_optim_loss: 262289.2119; val_kl_reg_loss: 5315.3930; val_edge_recon_loss: 255812.3975; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261127.7900; val_optim_loss: 261127.7900
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9920; val_auprc_score: 0.9886; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 5453.6197; train_edge_recon_loss: 256624.6494; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262078.2690; train_optim_loss: 262078.2690; val_kl_reg_loss: 5406.6248; val_edge_recon_loss: 255702.5348; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261109.1591; val_optim_loss: 261109.1591
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9921; val_auprc_score: 0.9885; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 5448.3342; train_edge_recon_loss: 256428.7080; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261877.0427; train_optim_loss: 261877.0427; val_kl_reg_loss: 5284.3914; val_edge_recon_loss: 255311.4675; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260595.8596; val_optim_loss: 260595.8596
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9930; val_auprc_score: 0.9900; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5442.3476; train_edge_recon_loss: 256331.3823; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261773.7300; train_optim_loss: 261773.7300; val_kl_reg_loss: 5356.4501; val_edge_recon_loss: 254917.7833; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260274.2339; val_optim_loss: 260274.2339
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9937; val_auprc_score: 0.9908; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5439.2521; train_edge_recon_loss: 256128.3299; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261567.5817; train_optim_loss: 261567.5817; val_kl_reg_loss: 5356.2995; val_edge_recon_loss: 254987.3878; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260343.6867; val_optim_loss: 260343.6867
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9938; val_auprc_score: 0.9907; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 5433.2707; train_edge_recon_loss: 256100.9920; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261534.2629; train_optim_loss: 261534.2629; val_kl_reg_loss: 5275.4416; val_edge_recon_loss: 254916.6814; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260192.1227; val_optim_loss: 260192.1227
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9905; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 5431.7760; train_edge_recon_loss: 255971.2173; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261402.9935; train_optim_loss: 261402.9935; val_kl_reg_loss: 5386.9545; val_edge_recon_loss: 255251.5446; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260638.4995; val_optim_loss: 260638.4995
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9941; val_auprc_score: 0.9911; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 5425.5357; train_edge_recon_loss: 255902.6767; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261328.2126; train_optim_loss: 261328.2126; val_kl_reg_loss: 5394.6052; val_edge_recon_loss: 254627.1565; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260021.7613; val_optim_loss: 260021.7613
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9948; val_auprc_score: 0.9920; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 5423.4319; train_edge_recon_loss: 255817.9077; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261241.3393; train_optim_loss: 261241.3393; val_kl_reg_loss: 5303.2817; val_edge_recon_loss: 254767.1898; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260070.4711; val_optim_loss: 260070.4711
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9922; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 5421.7585; train_edge_recon_loss: 255751.3488; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261173.1072; train_optim_loss: 261173.1072; val_kl_reg_loss: 5355.8199; val_edge_recon_loss: 254521.6632; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259877.4826; val_optim_loss: 259877.4826
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9924; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 5416.2079; train_edge_recon_loss: 255665.4267; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261081.6344; train_optim_loss: 261081.6344; val_kl_reg_loss: 5338.5714; val_edge_recon_loss: 254468.4933; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259807.0645; val_optim_loss: 259807.0645
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9953; val_auprc_score: 0.9927; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 5410.2347; train_edge_recon_loss: 255598.0348; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261008.2692; train_optim_loss: 261008.2692; val_kl_reg_loss: 5377.2505; val_edge_recon_loss: 254593.1709; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259970.4209; val_optim_loss: 259970.4209
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9954; val_auprc_score: 0.9927; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 5410.8241; train_edge_recon_loss: 255422.7209; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260833.5447; train_optim_loss: 260833.5447; val_kl_reg_loss: 5482.1029; val_edge_recon_loss: 254495.9434; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259978.0469; val_optim_loss: 259978.0469
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9935; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 5408.1285; train_edge_recon_loss: 255419.0344; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260827.1630; train_optim_loss: 260827.1630; val_kl_reg_loss: 5237.1139; val_edge_recon_loss: 254390.9060; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259628.0200; val_optim_loss: 259628.0200
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9933; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 5401.0635; train_edge_recon_loss: 255451.8251; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260852.8886; train_optim_loss: 260852.8886; val_kl_reg_loss: 5334.4899; val_edge_recon_loss: 254078.6337; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259413.1237; val_optim_loss: 259413.1237
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9935; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 5402.4657; train_edge_recon_loss: 255340.1856; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260742.6512; train_optim_loss: 260742.6512; val_kl_reg_loss: 5402.6919; val_edge_recon_loss: 254179.6893; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259582.3811; val_optim_loss: 259582.3811
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9943; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 5394.6239; train_edge_recon_loss: 255389.1001; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260783.7240; train_optim_loss: 260783.7240; val_kl_reg_loss: 5350.3859; val_edge_recon_loss: 254091.3386; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259441.7244; val_optim_loss: 259441.7244
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9939; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 5394.5480; train_edge_recon_loss: 255296.2816; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260690.8297; train_optim_loss: 260690.8297; val_kl_reg_loss: 5295.7396; val_edge_recon_loss: 254100.4493; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259396.1878; val_optim_loss: 259396.1878
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9939; val_best_acc_score: 0.9858; val_best_f1_score: 0.9860; train_kl_reg_loss: 5392.2126; train_edge_recon_loss: 255217.3929; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260609.6054; train_optim_loss: 260609.6054; val_kl_reg_loss: 5370.7469; val_edge_recon_loss: 254206.4080; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259577.1552; val_optim_loss: 259577.1552
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9964; val_auprc_score: 0.9942; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 5386.3890; train_edge_recon_loss: 255286.1177; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260672.5063; train_optim_loss: 260672.5063; val_kl_reg_loss: 5371.0027; val_edge_recon_loss: 253988.9134; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259359.9155; val_optim_loss: 259359.9155
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9960; val_auprc_score: 0.9934; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 5387.7627; train_edge_recon_loss: 255173.1890; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260560.9521; train_optim_loss: 260560.9521; val_kl_reg_loss: 5317.6565; val_edge_recon_loss: 254093.3317; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259410.9885; val_optim_loss: 259410.9885
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9964; val_auprc_score: 0.9942; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 5382.9816; train_edge_recon_loss: 255136.6115; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260519.5930; train_optim_loss: 260519.5930; val_kl_reg_loss: 5358.6275; val_edge_recon_loss: 253930.6055; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259289.2323; val_optim_loss: 259289.2323
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9942; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5381.0724; train_edge_recon_loss: 255052.2536; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260433.3262; train_optim_loss: 260433.3262; val_kl_reg_loss: 5330.2285; val_edge_recon_loss: 253859.8811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259190.1101; val_optim_loss: 259190.1101
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9967; val_auprc_score: 0.9948; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5379.8751; train_edge_recon_loss: 255045.2614; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260425.1367; train_optim_loss: 260425.1367; val_kl_reg_loss: 5366.9734; val_edge_recon_loss: 253985.7185; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259352.6924; val_optim_loss: 259352.6924
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9938; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5377.4009; train_edge_recon_loss: 255057.8260; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260435.2271; train_optim_loss: 260435.2271; val_kl_reg_loss: 5300.2697; val_edge_recon_loss: 253868.2579; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259168.5289; val_optim_loss: 259168.5289
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9966; val_auprc_score: 0.9946; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 5376.9250; train_edge_recon_loss: 255000.7970; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260377.7222; train_optim_loss: 260377.7222; val_kl_reg_loss: 5349.7797; val_edge_recon_loss: 253663.8443; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259013.6237; val_optim_loss: 259013.6237
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9953; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 5371.9458; train_edge_recon_loss: 255056.8611; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260428.8071; train_optim_loss: 260428.8071; val_kl_reg_loss: 5367.1461; val_edge_recon_loss: 253824.7520; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259191.8986; val_optim_loss: 259191.8986
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9970; val_auprc_score: 0.9953; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 5373.3148; train_edge_recon_loss: 255008.2420; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260381.5566; train_optim_loss: 260381.5566; val_kl_reg_loss: 5353.8068; val_edge_recon_loss: 253687.5154; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259041.3215; val_optim_loss: 259041.3215
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9966; val_auprc_score: 0.9947; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 5370.2188; train_edge_recon_loss: 254976.4542; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260346.6730; train_optim_loss: 260346.6730; val_kl_reg_loss: 5372.0957; val_edge_recon_loss: 254134.8950; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259506.9905; val_optim_loss: 259506.9905
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9969; val_auprc_score: 0.9951; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 5369.0277; train_edge_recon_loss: 254852.4157; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260221.4435; train_optim_loss: 260221.4435; val_kl_reg_loss: 5442.1994; val_edge_recon_loss: 253741.8840; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259184.0830; val_optim_loss: 259184.0830

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9972; val_auprc_score: 0.9956; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 5357.5686; train_edge_recon_loss: 254814.0653; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260171.6340; train_optim_loss: 260171.6340; val_kl_reg_loss: 5332.9585; val_edge_recon_loss: 253702.8140; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259035.7731; val_optim_loss: 259035.7731
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9972; val_auprc_score: 0.9954; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 5348.8096; train_edge_recon_loss: 254842.1281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260190.9374; train_optim_loss: 260190.9374; val_kl_reg_loss: 5346.2081; val_edge_recon_loss: 253567.4913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258913.6990; val_optim_loss: 258913.6990
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9971; val_auprc_score: 0.9952; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 5347.5264; train_edge_recon_loss: 254798.5261; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260146.0526; train_optim_loss: 260146.0526; val_kl_reg_loss: 5330.8211; val_edge_recon_loss: 253602.3171; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258933.1373; val_optim_loss: 258933.1373
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9969; val_auprc_score: 0.9951; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 5346.5015; train_edge_recon_loss: 254805.6247; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260152.1258; train_optim_loss: 260152.1258; val_kl_reg_loss: 5323.7114; val_edge_recon_loss: 253658.0003; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258981.7123; val_optim_loss: 258981.7123
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9972; val_auprc_score: 0.9954; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5344.7464; train_edge_recon_loss: 254752.7561; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260097.5024; train_optim_loss: 260097.5024; val_kl_reg_loss: 5333.2530; val_edge_recon_loss: 253695.6614; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259028.9139; val_optim_loss: 259028.9139
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5342.6144; train_edge_recon_loss: 254761.2240; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260103.8384; train_optim_loss: 260103.8384; val_kl_reg_loss: 5345.3522; val_edge_recon_loss: 253683.2026; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259028.5546; val_optim_loss: 259028.5546

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9971; val_auprc_score: 0.9955; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 5344.8886; train_edge_recon_loss: 254672.4369; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260017.3253; train_optim_loss: 260017.3253; val_kl_reg_loss: 5339.4981; val_edge_recon_loss: 253788.8227; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259128.3210; val_optim_loss: 259128.3210
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9973; val_auprc_score: 0.9956; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 5341.1541; train_edge_recon_loss: 254821.8135; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260162.9675; train_optim_loss: 260162.9675; val_kl_reg_loss: 5331.2115; val_edge_recon_loss: 253486.5044; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258817.7159; val_optim_loss: 258817.7159
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9973; val_auprc_score: 0.9958; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 5342.4154; train_edge_recon_loss: 254689.7555; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260032.1708; train_optim_loss: 260032.1708; val_kl_reg_loss: 5336.1803; val_edge_recon_loss: 253442.2623; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258778.4426; val_optim_loss: 258778.4426
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9970; val_auprc_score: 0.9948; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 5340.5791; train_edge_recon_loss: 254792.3246; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260132.9036; train_optim_loss: 260132.9036; val_kl_reg_loss: 5326.9860; val_edge_recon_loss: 253618.0774; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258945.0633; val_optim_loss: 258945.0633
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9969; val_auprc_score: 0.9950; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 5340.9910; train_edge_recon_loss: 254709.0394; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260050.0305; train_optim_loss: 260050.0305; val_kl_reg_loss: 5335.3569; val_edge_recon_loss: 253740.1475; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259075.5031; val_optim_loss: 259075.5031
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9970; val_auprc_score: 0.9951; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5339.8669; train_edge_recon_loss: 254775.1805; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260115.0475; train_optim_loss: 260115.0475; val_kl_reg_loss: 5333.2532; val_edge_recon_loss: 253639.6819; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258972.9347; val_optim_loss: 258972.9347
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9969; val_auprc_score: 0.9945; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 5338.5797; train_edge_recon_loss: 254829.8019; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260168.3815; train_optim_loss: 260168.3815; val_kl_reg_loss: 5331.7211; val_edge_recon_loss: 253585.7310; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258917.4524; val_optim_loss: 258917.4524

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9972; val_auprc_score: 0.9954; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5341.6514; train_edge_recon_loss: 254803.4232; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260145.0746; train_optim_loss: 260145.0746; val_kl_reg_loss: 5330.0121; val_edge_recon_loss: 253504.2572; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258834.2687; val_optim_loss: 258834.2687
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9971; val_auprc_score: 0.9953; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 5340.7943; train_edge_recon_loss: 254716.0625; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260056.8570; train_optim_loss: 260056.8570; val_kl_reg_loss: 5330.2421; val_edge_recon_loss: 253489.9874; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258820.2290; val_optim_loss: 258820.2290
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9972; val_auprc_score: 0.9955; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5341.1968; train_edge_recon_loss: 254686.9899; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260028.1863; train_optim_loss: 260028.1863; val_kl_reg_loss: 5330.9609; val_edge_recon_loss: 253537.9805; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258868.9421; val_optim_loss: 258868.9421
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9969; val_auprc_score: 0.9950; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 5338.4997; train_edge_recon_loss: 254795.9329; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260134.4326; train_optim_loss: 260134.4326; val_kl_reg_loss: 5332.1207; val_edge_recon_loss: 253787.6365; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259119.7567; val_optim_loss: 259119.7567

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 271 min 35 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9973
Val AUPRC score: 0.9957
Val best accuracy score: 0.9890
Val best F1 score: 0.9891
Val gene expr MSE score: 0.9513

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
