None
Run timestamp: 08082023_193806_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9585; val_auprc_score: 0.9513; val_best_acc_score: 0.8927; val_best_f1_score: 0.8981; train_kl_reg_loss: 37766.3160; train_edge_recon_loss: 2774272.1839; train_gene_expr_recon_loss: 11986239.4527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 14798277.9542; train_optim_loss: 14798277.9542; val_kl_reg_loss: 30466.8122; val_edge_recon_loss: 2687444.3031; val_gene_expr_recon_loss: 11087393.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13805305.1045; val_optim_loss: 13805305.1045
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9709; val_auprc_score: 0.9661; val_best_acc_score: 0.9139; val_best_f1_score: 0.9173; train_kl_reg_loss: 26912.8593; train_edge_recon_loss: 2665279.5089; train_gene_expr_recon_loss: 10807061.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13499254.1040; train_optim_loss: 13499254.1040; val_kl_reg_loss: 23806.9528; val_edge_recon_loss: 2662696.1028; val_gene_expr_recon_loss: 10664347.7735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13350850.8328; val_optim_loss: 13350850.8328
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9785; val_auprc_score: 0.9753; val_best_acc_score: 0.9274; val_best_f1_score: 0.9294; train_kl_reg_loss: 22768.7853; train_edge_recon_loss: 2648336.6984; train_gene_expr_recon_loss: 10574108.3821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13245213.8642; train_optim_loss: 13245213.8642; val_kl_reg_loss: 21355.6219; val_edge_recon_loss: 2651616.2953; val_gene_expr_recon_loss: 10557577.6690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13230549.5645; val_optim_loss: 13230549.5645
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9840; val_auprc_score: 0.9817; val_best_acc_score: 0.9384; val_best_f1_score: 0.9397; train_kl_reg_loss: 20407.5804; train_edge_recon_loss: 2638109.3093; train_gene_expr_recon_loss: 10493891.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13152408.4414; train_optim_loss: 13152408.4414; val_kl_reg_loss: 19183.9007; val_edge_recon_loss: 2642602.0244; val_gene_expr_recon_loss: 10501044.9547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13162830.8780; val_optim_loss: 13162830.8780
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9865; val_auprc_score: 0.9846; val_best_acc_score: 0.9434; val_best_f1_score: 0.9446; train_kl_reg_loss: 19340.7252; train_edge_recon_loss: 2629393.8488; train_gene_expr_recon_loss: 10459300.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13108035.1722; train_optim_loss: 13108035.1722; val_kl_reg_loss: 19094.9621; val_edge_recon_loss: 2633907.5418; val_gene_expr_recon_loss: 10489695.8467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13142698.3345; val_optim_loss: 13142698.3345
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9875; val_auprc_score: 0.9856; val_best_acc_score: 0.9463; val_best_f1_score: 0.9472; train_kl_reg_loss: 18776.2406; train_edge_recon_loss: 2622744.9670; train_gene_expr_recon_loss: 10437716.9802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13079238.1901; train_optim_loss: 13079238.1901; val_kl_reg_loss: 18419.4596; val_edge_recon_loss: 2631924.2674; val_gene_expr_recon_loss: 10475666.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13126010.6864; val_optim_loss: 13126010.6864
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9886; val_auprc_score: 0.9869; val_best_acc_score: 0.9493; val_best_f1_score: 0.9503; train_kl_reg_loss: 18365.4986; train_edge_recon_loss: 2618114.2855; train_gene_expr_recon_loss: 10424887.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13061366.9116; train_optim_loss: 13061366.9116; val_kl_reg_loss: 18395.5454; val_edge_recon_loss: 2628044.5618; val_gene_expr_recon_loss: 10461817.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13108257.9652; val_optim_loss: 13108257.9652
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9893; val_auprc_score: 0.9877; val_best_acc_score: 0.9522; val_best_f1_score: 0.9531; train_kl_reg_loss: 18092.2751; train_edge_recon_loss: 2615641.7274; train_gene_expr_recon_loss: 10417159.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13050893.2847; train_optim_loss: 13050893.2847; val_kl_reg_loss: 17607.2810; val_edge_recon_loss: 2626009.6159; val_gene_expr_recon_loss: 10463672.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13107289.2857; val_optim_loss: 13107289.2857
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9896; val_auprc_score: 0.9878; val_best_acc_score: 0.9536; val_best_f1_score: 0.9544; train_kl_reg_loss: 17820.8580; train_edge_recon_loss: 2612762.1147; train_gene_expr_recon_loss: 10413331.8507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13043914.8313; train_optim_loss: 13043914.8313; val_kl_reg_loss: 17905.0739; val_edge_recon_loss: 2622659.7291; val_gene_expr_recon_loss: 10453557.6202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13094122.4321; val_optim_loss: 13094122.4321
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9552; val_best_f1_score: 0.9560; train_kl_reg_loss: 17653.4478; train_edge_recon_loss: 2611414.6811; train_gene_expr_recon_loss: 10404953.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13034021.9763; train_optim_loss: 13034021.9763; val_kl_reg_loss: 17316.8531; val_edge_recon_loss: 2621721.1498; val_gene_expr_recon_loss: 10443750.8676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13082788.8955; val_optim_loss: 13082788.8955
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9910; val_auprc_score: 0.9897; val_best_acc_score: 0.9574; val_best_f1_score: 0.9581; train_kl_reg_loss: 17471.7752; train_edge_recon_loss: 2610084.4002; train_gene_expr_recon_loss: 10400435.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13027991.3635; train_optim_loss: 13027991.3635; val_kl_reg_loss: 17494.4303; val_edge_recon_loss: 2618377.9129; val_gene_expr_recon_loss: 10450478.6132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13086350.9686; val_optim_loss: 13086350.9686
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9577; val_best_f1_score: 0.9584; train_kl_reg_loss: 17344.9266; train_edge_recon_loss: 2608306.2601; train_gene_expr_recon_loss: 10393043.3666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13018694.5535; train_optim_loss: 13018694.5535; val_kl_reg_loss: 17235.6065; val_edge_recon_loss: 2619305.5078; val_gene_expr_recon_loss: 10447402.0279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13083943.1254; val_optim_loss: 13083943.1254
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9918; val_auprc_score: 0.9906; val_best_acc_score: 0.9597; val_best_f1_score: 0.9603; train_kl_reg_loss: 17227.6770; train_edge_recon_loss: 2607743.6462; train_gene_expr_recon_loss: 10394259.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13019230.6528; train_optim_loss: 13019230.6528; val_kl_reg_loss: 16910.5028; val_edge_recon_loss: 2616263.8789; val_gene_expr_recon_loss: 10442856.9686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13076031.3624; val_optim_loss: 13076031.3624
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9916; val_auprc_score: 0.9902; val_best_acc_score: 0.9598; val_best_f1_score: 0.9604; train_kl_reg_loss: 17130.4927; train_edge_recon_loss: 2606828.4221; train_gene_expr_recon_loss: 10388653.3712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13012612.2824; train_optim_loss: 13012612.2824; val_kl_reg_loss: 17102.5247; val_edge_recon_loss: 2616413.5749; val_gene_expr_recon_loss: 10448836.3206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13082352.3798; val_optim_loss: 13082352.3798
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9920; val_auprc_score: 0.9907; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 17049.8916; train_edge_recon_loss: 2606404.5151; train_gene_expr_recon_loss: 10384423.3088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13007877.7176; train_optim_loss: 13007877.7176; val_kl_reg_loss: 17077.7206; val_edge_recon_loss: 2611980.6568; val_gene_expr_recon_loss: 10439918.5645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13068976.9338; val_optim_loss: 13068976.9338
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9925; val_auprc_score: 0.9913; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 17067.3677; train_edge_recon_loss: 2604270.7506; train_gene_expr_recon_loss: 10380966.5985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13002304.7211; train_optim_loss: 13002304.7211; val_kl_reg_loss: 16971.2145; val_edge_recon_loss: 2616916.0044; val_gene_expr_recon_loss: 10460950.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13094837.7108; val_optim_loss: 13094837.7108
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9923; val_auprc_score: 0.9911; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 17081.4583; train_edge_recon_loss: 2602805.6424; train_gene_expr_recon_loss: 10388896.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13008784.0353; train_optim_loss: 13008784.0353; val_kl_reg_loss: 16866.5156; val_edge_recon_loss: 2614636.6908; val_gene_expr_recon_loss: 10444053.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13075556.4530; val_optim_loss: 13075556.4530
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9920; val_auprc_score: 0.9907; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 17023.0167; train_edge_recon_loss: 2602999.5049; train_gene_expr_recon_loss: 10385452.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13005474.9123; train_optim_loss: 13005474.9123; val_kl_reg_loss: 16906.0244; val_edge_recon_loss: 2617069.6603; val_gene_expr_recon_loss: 10456664.5923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13090640.2265; val_optim_loss: 13090640.2265
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9925; val_auprc_score: 0.9912; val_best_acc_score: 0.9628; val_best_f1_score: 0.9633; train_kl_reg_loss: 17004.9313; train_edge_recon_loss: 2602299.4366; train_gene_expr_recon_loss: 10381972.7661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13001277.1241; train_optim_loss: 13001277.1241; val_kl_reg_loss: 16642.5764; val_edge_recon_loss: 2611844.6507; val_gene_expr_recon_loss: 10439464.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13067951.4599; val_optim_loss: 13067951.4599
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9927; val_auprc_score: 0.9914; val_best_acc_score: 0.9632; val_best_f1_score: 0.9637; train_kl_reg_loss: 16933.7899; train_edge_recon_loss: 2602037.7461; train_gene_expr_recon_loss: 10380560.9480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12999532.4864; train_optim_loss: 12999532.4864; val_kl_reg_loss: 16861.9462; val_edge_recon_loss: 2610818.0244; val_gene_expr_recon_loss: 10454674.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13082354.3484; val_optim_loss: 13082354.3484
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9929; val_auprc_score: 0.9916; val_best_acc_score: 0.9640; val_best_f1_score: 0.9644; train_kl_reg_loss: 16988.6960; train_edge_recon_loss: 2601220.8148; train_gene_expr_recon_loss: 10377278.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12995487.8580; train_optim_loss: 12995487.8580; val_kl_reg_loss: 16630.6291; val_edge_recon_loss: 2608991.4774; val_gene_expr_recon_loss: 10446119.4739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13071741.5923; val_optim_loss: 13071741.5923
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9927; val_auprc_score: 0.9914; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 16930.4423; train_edge_recon_loss: 2600726.8564; train_gene_expr_recon_loss: 10374319.8208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12991977.1245; train_optim_loss: 12991977.1245; val_kl_reg_loss: 16742.7563; val_edge_recon_loss: 2609371.7021; val_gene_expr_recon_loss: 10437091.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13063206.4181; val_optim_loss: 13063206.4181
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9928; val_auprc_score: 0.9914; val_best_acc_score: 0.9645; val_best_f1_score: 0.9649; train_kl_reg_loss: 16926.6532; train_edge_recon_loss: 2600363.1380; train_gene_expr_recon_loss: 10375656.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12992946.3918; train_optim_loss: 12992946.3918; val_kl_reg_loss: 16686.7574; val_edge_recon_loss: 2612254.5253; val_gene_expr_recon_loss: 10443807.5296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13072748.8118; val_optim_loss: 13072748.8118
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 16898.3813; train_edge_recon_loss: 2600842.1673; train_gene_expr_recon_loss: 10376244.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12993984.7502; train_optim_loss: 12993984.7502; val_kl_reg_loss: 17049.2787; val_edge_recon_loss: 2610396.3580; val_gene_expr_recon_loss: 10440540.4669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13067986.1324; val_optim_loss: 13067986.1324
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9928; val_auprc_score: 0.9916; val_best_acc_score: 0.9638; val_best_f1_score: 0.9643; train_kl_reg_loss: 16908.5420; train_edge_recon_loss: 2599461.6340; train_gene_expr_recon_loss: 10373801.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12990171.7758; train_optim_loss: 12990171.7758; val_kl_reg_loss: 16815.7218; val_edge_recon_loss: 2610611.6768; val_gene_expr_recon_loss: 10450914.6272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13078342.0139; val_optim_loss: 13078342.0139
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9921; val_auprc_score: 0.9905; val_best_acc_score: 0.9629; val_best_f1_score: 0.9634; train_kl_reg_loss: 16920.9026; train_edge_recon_loss: 2598981.8546; train_gene_expr_recon_loss: 10369234.5477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12985137.3072; train_optim_loss: 12985137.3072; val_kl_reg_loss: 16934.7090; val_edge_recon_loss: 2616447.4233; val_gene_expr_recon_loss: 10453557.0314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13086939.1568; val_optim_loss: 13086939.1568

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9931; val_auprc_score: 0.9919; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 17575.1588; train_edge_recon_loss: 2597008.2456; train_gene_expr_recon_loss: 10329093.4267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12943676.8278; train_optim_loss: 12943676.8278; val_kl_reg_loss: 17335.8271; val_edge_recon_loss: 2607284.1289; val_gene_expr_recon_loss: 10404069.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13028689.1638; val_optim_loss: 13028689.1638
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 17638.1949; train_edge_recon_loss: 2595663.5559; train_gene_expr_recon_loss: 10327257.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12940559.1567; train_optim_loss: 12940559.1567; val_kl_reg_loss: 17399.6742; val_edge_recon_loss: 2606888.3075; val_gene_expr_recon_loss: 10418519.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13042807.7805; val_optim_loss: 13042807.7805
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9931; val_auprc_score: 0.9919; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 17660.8797; train_edge_recon_loss: 2596629.2972; train_gene_expr_recon_loss: 10321435.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12935725.7374; train_optim_loss: 12935725.7374; val_kl_reg_loss: 17534.3410; val_edge_recon_loss: 2605492.7509; val_gene_expr_recon_loss: 10419713.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13042740.4007; val_optim_loss: 13042740.4007
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9652; val_best_f1_score: 0.9656; train_kl_reg_loss: 17702.6375; train_edge_recon_loss: 2596216.2100; train_gene_expr_recon_loss: 10322093.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12936012.2137; train_optim_loss: 12936012.2137; val_kl_reg_loss: 17521.5910; val_edge_recon_loss: 2607254.9521; val_gene_expr_recon_loss: 10415747.3345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13040523.8711; val_optim_loss: 13040523.8711
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 17633.0115; train_edge_recon_loss: 2596496.4378; train_gene_expr_recon_loss: 10318932.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12933061.7669; train_optim_loss: 12933061.7669; val_kl_reg_loss: 17420.8677; val_edge_recon_loss: 2604638.2456; val_gene_expr_recon_loss: 10404358.9338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13026418.0592; val_optim_loss: 13026418.0592
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9931; val_auprc_score: 0.9918; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 17646.0477; train_edge_recon_loss: 2596322.7193; train_gene_expr_recon_loss: 10322794.1920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12936762.9690; train_optim_loss: 12936762.9690; val_kl_reg_loss: 17424.2103; val_edge_recon_loss: 2606263.8580; val_gene_expr_recon_loss: 10403931.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13027620.0000; val_optim_loss: 13027620.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9933; val_auprc_score: 0.9920; val_best_acc_score: 0.9657; val_best_f1_score: 0.9661; train_kl_reg_loss: 17647.7065; train_edge_recon_loss: 2595015.7900; train_gene_expr_recon_loss: 10321831.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12934494.7944; train_optim_loss: 12934494.7944; val_kl_reg_loss: 17440.9695; val_edge_recon_loss: 2605354.3406; val_gene_expr_recon_loss: 10393625.9059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13016421.2265; val_optim_loss: 13016421.2265
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9655; val_best_f1_score: 0.9659; train_kl_reg_loss: 17623.9930; train_edge_recon_loss: 2595420.5306; train_gene_expr_recon_loss: 10318178.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12931222.7789; train_optim_loss: 12931222.7789; val_kl_reg_loss: 17473.9612; val_edge_recon_loss: 2603305.7796; val_gene_expr_recon_loss: 10395295.6725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13016075.4216; val_optim_loss: 13016075.4216
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9932; val_auprc_score: 0.9918; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 17605.6685; train_edge_recon_loss: 2595736.6207; train_gene_expr_recon_loss: 10321440.7510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12934783.0434; train_optim_loss: 12934783.0434; val_kl_reg_loss: 17447.1401; val_edge_recon_loss: 2605076.0305; val_gene_expr_recon_loss: 10399313.7666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13021836.9303; val_optim_loss: 13021836.9303
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9934; val_auprc_score: 0.9921; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 17567.2720; train_edge_recon_loss: 2595639.5899; train_gene_expr_recon_loss: 10315406.4519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12928613.3057; train_optim_loss: 12928613.3057; val_kl_reg_loss: 17275.4151; val_edge_recon_loss: 2606138.4451; val_gene_expr_recon_loss: 10416369.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13039783.5436; val_optim_loss: 13039783.5436
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9933; val_auprc_score: 0.9921; val_best_acc_score: 0.9657; val_best_f1_score: 0.9661; train_kl_reg_loss: 17557.7598; train_edge_recon_loss: 2595190.8602; train_gene_expr_recon_loss: 10321308.3716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12934056.9853; train_optim_loss: 12934056.9853; val_kl_reg_loss: 17424.7772; val_edge_recon_loss: 2604316.8110; val_gene_expr_recon_loss: 10412986.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13034727.9199; val_optim_loss: 13034727.9199
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9933; val_auprc_score: 0.9920; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 17540.1078; train_edge_recon_loss: 2595439.7137; train_gene_expr_recon_loss: 10318904.6234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12931884.4418; train_optim_loss: 12931884.4418; val_kl_reg_loss: 17343.7269; val_edge_recon_loss: 2605471.7378; val_gene_expr_recon_loss: 10427653.8502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13050469.3171; val_optim_loss: 13050469.3171

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9932; val_auprc_score: 0.9919; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 17565.1282; train_edge_recon_loss: 2595101.2905; train_gene_expr_recon_loss: 10314843.2219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12927509.6396; train_optim_loss: 12927509.6396; val_kl_reg_loss: 17409.3869; val_edge_recon_loss: 2606937.3885; val_gene_expr_recon_loss: 10398212.3833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13022559.1638; val_optim_loss: 13022559.1638
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9934; val_auprc_score: 0.9921; val_best_acc_score: 0.9657; val_best_f1_score: 0.9661; train_kl_reg_loss: 17604.0867; train_edge_recon_loss: 2594823.5851; train_gene_expr_recon_loss: 10313235.8204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12925663.4942; train_optim_loss: 12925663.4942; val_kl_reg_loss: 17432.3373; val_edge_recon_loss: 2606468.0775; val_gene_expr_recon_loss: 10406806.3728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13030706.8293; val_optim_loss: 13030706.8293
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9934; val_auprc_score: 0.9923; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 17622.2609; train_edge_recon_loss: 2595929.1403; train_gene_expr_recon_loss: 10311609.7742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12925161.1800; train_optim_loss: 12925161.1800; val_kl_reg_loss: 17419.9990; val_edge_recon_loss: 2604434.3693; val_gene_expr_recon_loss: 10408810.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13030664.8606; val_optim_loss: 13030664.8606
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9934; val_auprc_score: 0.9923; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 17622.2324; train_edge_recon_loss: 2595759.0932; train_gene_expr_recon_loss: 10311025.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12924406.7413; train_optim_loss: 12924406.7413; val_kl_reg_loss: 17408.2141; val_edge_recon_loss: 2605369.6925; val_gene_expr_recon_loss: 10398406.3206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13021184.2404; val_optim_loss: 13021184.2404

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 687 min 55 sec.
Using best model state, which was in epoch 34.
