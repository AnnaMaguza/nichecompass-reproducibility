None
Run timestamp: 14072023_121117_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9755; val_auprc_score: 0.9671; val_best_acc_score: 0.9330; val_best_f1_score: 0.9350; train_kl_reg_loss: 107263.5127; train_edge_recon_loss: 27337005.1087; train_gene_expr_recon_loss: 11941135.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39385404.5435; train_optim_loss: 39385404.5435; val_kl_reg_loss: 125385.7700; val_edge_recon_loss: 26420218.6341; val_gene_expr_recon_loss: 10816635.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37362239.7073; val_optim_loss: 37362239.7073
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9802; val_auprc_score: 0.9717; val_best_acc_score: 0.9449; val_best_f1_score: 0.9466; train_kl_reg_loss: 136155.6558; train_edge_recon_loss: 26144144.4130; train_gene_expr_recon_loss: 10536518.6630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36816818.7500; train_optim_loss: 36816818.7500; val_kl_reg_loss: 127816.3051; val_edge_recon_loss: 26152945.0732; val_gene_expr_recon_loss: 10381579.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36662341.3659; val_optim_loss: 36662341.3659
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9818; val_auprc_score: 0.9752; val_best_acc_score: 0.9472; val_best_f1_score: 0.9486; train_kl_reg_loss: 124986.7842; train_edge_recon_loss: 26018975.1304; train_gene_expr_recon_loss: 10209449.5082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36353411.4565; train_optim_loss: 36353411.4565; val_kl_reg_loss: 116087.1879; val_edge_recon_loss: 26130548.5366; val_gene_expr_recon_loss: 10136830.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36383466.0488; val_optim_loss: 36383466.0488
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9844; val_auprc_score: 0.9788; val_best_acc_score: 0.9528; val_best_f1_score: 0.9538; train_kl_reg_loss: 112066.4656; train_edge_recon_loss: 25952060.3478; train_gene_expr_recon_loss: 10010968.3370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36075095.1739; train_optim_loss: 36075095.1739; val_kl_reg_loss: 102999.7229; val_edge_recon_loss: 25983854.8780; val_gene_expr_recon_loss: 9969799.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36056653.8537; val_optim_loss: 36056653.8537
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9849; val_auprc_score: 0.9795; val_best_acc_score: 0.9553; val_best_f1_score: 0.9564; train_kl_reg_loss: 102261.2658; train_edge_recon_loss: 25876895.9293; train_gene_expr_recon_loss: 9872340.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35851497.4783; train_optim_loss: 35851497.4783; val_kl_reg_loss: 98382.3937; val_edge_recon_loss: 25926169.6098; val_gene_expr_recon_loss: 9825346.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35849898.4390; val_optim_loss: 35849898.4390
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9567; val_best_f1_score: 0.9577; train_kl_reg_loss: 98438.9870; train_edge_recon_loss: 25815843.1739; train_gene_expr_recon_loss: 9752821.8696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35667104.0435; train_optim_loss: 35667104.0435; val_kl_reg_loss: 93223.2363; val_edge_recon_loss: 25873348.3902; val_gene_expr_recon_loss: 9727505.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35694077.2683; val_optim_loss: 35694077.2683
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9866; val_auprc_score: 0.9817; val_best_acc_score: 0.9594; val_best_f1_score: 0.9603; train_kl_reg_loss: 93859.7097; train_edge_recon_loss: 25790472.0761; train_gene_expr_recon_loss: 9668680.9103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35553012.6087; train_optim_loss: 35553012.6087; val_kl_reg_loss: 88219.0964; val_edge_recon_loss: 25830967.2683; val_gene_expr_recon_loss: 9692232.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35611418.4390; val_optim_loss: 35611418.4390
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9882; val_auprc_score: 0.9843; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 89505.1332; train_edge_recon_loss: 25758830.8859; train_gene_expr_recon_loss: 9596106.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35444442.2283; train_optim_loss: 35444442.2283; val_kl_reg_loss: 87025.2041; val_edge_recon_loss: 25819741.2195; val_gene_expr_recon_loss: 9620340.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35527106.8293; val_optim_loss: 35527106.8293
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9877; val_auprc_score: 0.9833; val_best_acc_score: 0.9615; val_best_f1_score: 0.9623; train_kl_reg_loss: 85678.3501; train_edge_recon_loss: 25732530.6848; train_gene_expr_recon_loss: 9542080.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35360289.3478; train_optim_loss: 35360289.3478; val_kl_reg_loss: 82836.7731; val_edge_recon_loss: 25784306.2927; val_gene_expr_recon_loss: 9578956.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35446099.9024; val_optim_loss: 35446099.9024
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9838; val_best_acc_score: 0.9618; val_best_f1_score: 0.9626; train_kl_reg_loss: 82417.1426; train_edge_recon_loss: 25721308.8750; train_gene_expr_recon_loss: 9490568.3370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35294294.3152; train_optim_loss: 35294294.3152; val_kl_reg_loss: 79187.9348; val_edge_recon_loss: 25781740.8293; val_gene_expr_recon_loss: 9548026.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35408954.8293; val_optim_loss: 35408954.8293
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9889; val_auprc_score: 0.9851; val_best_acc_score: 0.9636; val_best_f1_score: 0.9643; train_kl_reg_loss: 78989.5153; train_edge_recon_loss: 25693571.2989; train_gene_expr_recon_loss: 9459867.6060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35232428.3696; train_optim_loss: 35232428.3696; val_kl_reg_loss: 76379.5080; val_edge_recon_loss: 25761679.7561; val_gene_expr_recon_loss: 9535796.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35373856.0000; val_optim_loss: 35373856.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9889; val_auprc_score: 0.9846; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 76754.8671; train_edge_recon_loss: 25676488.2609; train_gene_expr_recon_loss: 9411119.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35164362.5109; train_optim_loss: 35164362.5109; val_kl_reg_loss: 74456.4510; val_edge_recon_loss: 25745185.2195; val_gene_expr_recon_loss: 9506725.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35326367.3171; val_optim_loss: 35326367.3171
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9896; val_auprc_score: 0.9857; val_best_acc_score: 0.9643; val_best_f1_score: 0.9651; train_kl_reg_loss: 74416.6806; train_edge_recon_loss: 25684683.3913; train_gene_expr_recon_loss: 9383856.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35142956.5978; train_optim_loss: 35142956.5978; val_kl_reg_loss: 73077.7534; val_edge_recon_loss: 25730089.5122; val_gene_expr_recon_loss: 9487680.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35290847.4146; val_optim_loss: 35290847.4146
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9899; val_auprc_score: 0.9862; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 72333.4724; train_edge_recon_loss: 25654574.0326; train_gene_expr_recon_loss: 9358458.6495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35085366.0217; train_optim_loss: 35085366.0217; val_kl_reg_loss: 69392.6071; val_edge_recon_loss: 25734415.0732; val_gene_expr_recon_loss: 9454880.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35258687.5122; val_optim_loss: 35258687.5122
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9895; val_auprc_score: 0.9859; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 70968.9656; train_edge_recon_loss: 25650905.9022; train_gene_expr_recon_loss: 9327138.4592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35049013.5217; train_optim_loss: 35049013.5217; val_kl_reg_loss: 68350.8403; val_edge_recon_loss: 25743259.6098; val_gene_expr_recon_loss: 9441691.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35253302.4390; val_optim_loss: 35253302.4390
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9905; val_auprc_score: 0.9871; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 69583.4577; train_edge_recon_loss: 25638578.2065; train_gene_expr_recon_loss: 9296690.0571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35004851.7500; train_optim_loss: 35004851.7500; val_kl_reg_loss: 69103.6926; val_edge_recon_loss: 25719018.1951; val_gene_expr_recon_loss: 9459017.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35247138.9268; val_optim_loss: 35247138.9268
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9900; val_auprc_score: 0.9867; val_best_acc_score: 0.9662; val_best_f1_score: 0.9670; train_kl_reg_loss: 68365.5027; train_edge_recon_loss: 25626151.5109; train_gene_expr_recon_loss: 9282227.4103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34976744.4130; train_optim_loss: 34976744.4130; val_kl_reg_loss: 67419.2078; val_edge_recon_loss: 25684108.0488; val_gene_expr_recon_loss: 9427065.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35178592.9756; val_optim_loss: 35178592.9756
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9909; val_auprc_score: 0.9878; val_best_acc_score: 0.9679; val_best_f1_score: 0.9686; train_kl_reg_loss: 67000.1447; train_edge_recon_loss: 25629946.5000; train_gene_expr_recon_loss: 9260611.6984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34957558.4457; train_optim_loss: 34957558.4457; val_kl_reg_loss: 65389.2429; val_edge_recon_loss: 25703828.4390; val_gene_expr_recon_loss: 9451193.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35220411.1220; val_optim_loss: 35220411.1220
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 66052.5410; train_edge_recon_loss: 25614228.3043; train_gene_expr_recon_loss: 9227771.8940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34908052.7065; train_optim_loss: 34908052.7065; val_kl_reg_loss: 63777.6525; val_edge_recon_loss: 25700077.9512; val_gene_expr_recon_loss: 9428717.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35192573.6585; val_optim_loss: 35192573.6585
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9910; val_auprc_score: 0.9877; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 64894.6493; train_edge_recon_loss: 25615887.9130; train_gene_expr_recon_loss: 9216963.3234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34897745.7391; train_optim_loss: 34897745.7391; val_kl_reg_loss: 62965.9443; val_edge_recon_loss: 25682114.4390; val_gene_expr_recon_loss: 9399145.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35144226.2439; val_optim_loss: 35144226.2439
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9704; val_best_f1_score: 0.9710; train_kl_reg_loss: 64206.1285; train_edge_recon_loss: 25602035.0815; train_gene_expr_recon_loss: 9192745.3696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34858986.6413; train_optim_loss: 34858986.6413; val_kl_reg_loss: 62024.4215; val_edge_recon_loss: 25680766.5854; val_gene_expr_recon_loss: 9404151.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35146942.8293; val_optim_loss: 35146942.8293
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9912; val_auprc_score: 0.9880; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 63707.9439; train_edge_recon_loss: 25611378.8315; train_gene_expr_recon_loss: 9176568.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34851655.6739; train_optim_loss: 34851655.6739; val_kl_reg_loss: 62602.9210; val_edge_recon_loss: 25673135.4634; val_gene_expr_recon_loss: 9411389.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35147127.9024; val_optim_loss: 35147127.9024
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9914; val_auprc_score: 0.9887; val_best_acc_score: 0.9696; val_best_f1_score: 0.9702; train_kl_reg_loss: 63205.0567; train_edge_recon_loss: 25591168.6359; train_gene_expr_recon_loss: 9159875.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34814249.2391; train_optim_loss: 34814249.2391; val_kl_reg_loss: 62161.9330; val_edge_recon_loss: 25704457.2195; val_gene_expr_recon_loss: 9407684.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35174303.8049; val_optim_loss: 35174303.8049
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 61936.7541; train_edge_recon_loss: 25597784.2283; train_gene_expr_recon_loss: 9142981.9484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34802702.9674; train_optim_loss: 34802702.9674; val_kl_reg_loss: 60754.7087; val_edge_recon_loss: 25709901.7561; val_gene_expr_recon_loss: 9386170.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35156827.0244; val_optim_loss: 35156827.0244

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9708; val_best_f1_score: 0.9714; train_kl_reg_loss: 63052.7622; train_edge_recon_loss: 25587108.5326; train_gene_expr_recon_loss: 9084398.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34734559.8804; train_optim_loss: 34734559.8804; val_kl_reg_loss: 62511.9838; val_edge_recon_loss: 25654167.5122; val_gene_expr_recon_loss: 9359012.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35075692.2927; val_optim_loss: 35075692.2927
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9913; val_auprc_score: 0.9882; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 64319.1701; train_edge_recon_loss: 25570600.4239; train_gene_expr_recon_loss: 9075331.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34710251.3370; train_optim_loss: 34710251.3370; val_kl_reg_loss: 63164.7797; val_edge_recon_loss: 25698416.7317; val_gene_expr_recon_loss: 9355216.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35116798.0488; val_optim_loss: 35116798.0488
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 64465.9911; train_edge_recon_loss: 25581385.9239; train_gene_expr_recon_loss: 9076291.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34722143.2609; train_optim_loss: 34722143.2609; val_kl_reg_loss: 62939.2424; val_edge_recon_loss: 25660011.4634; val_gene_expr_recon_loss: 9327389.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35050339.6098; val_optim_loss: 35050339.6098
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9892; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 64562.6340; train_edge_recon_loss: 25581781.9402; train_gene_expr_recon_loss: 9066194.8899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34712539.6087; train_optim_loss: 34712539.6087; val_kl_reg_loss: 62986.5267; val_edge_recon_loss: 25661989.5122; val_gene_expr_recon_loss: 9364355.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35089331.0244; val_optim_loss: 35089331.0244
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 64147.3906; train_edge_recon_loss: 25572537.8913; train_gene_expr_recon_loss: 9071677.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34708362.6739; train_optim_loss: 34708362.6739; val_kl_reg_loss: 63009.5840; val_edge_recon_loss: 25676374.0000; val_gene_expr_recon_loss: 9340209.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35079593.2683; val_optim_loss: 35079593.2683
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9921; val_auprc_score: 0.9896; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 64142.3403; train_edge_recon_loss: 25578925.1413; train_gene_expr_recon_loss: 9057695.3329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34700762.7717; train_optim_loss: 34700762.7717; val_kl_reg_loss: 62694.0037; val_edge_recon_loss: 25625124.9268; val_gene_expr_recon_loss: 9350931.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35038750.3415; val_optim_loss: 35038750.3415
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9921; val_auprc_score: 0.9896; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 63911.9977; train_edge_recon_loss: 25578772.1250; train_gene_expr_recon_loss: 9059103.8261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34701787.9022; train_optim_loss: 34701787.9022; val_kl_reg_loss: 62806.7127; val_edge_recon_loss: 25643992.0976; val_gene_expr_recon_loss: 9373902.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35080700.9756; val_optim_loss: 35080700.9756
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9708; val_best_f1_score: 0.9714; train_kl_reg_loss: 63746.2855; train_edge_recon_loss: 25586854.4511; train_gene_expr_recon_loss: 9052923.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703523.8913; train_optim_loss: 34703523.8913; val_kl_reg_loss: 62345.9691; val_edge_recon_loss: 25658467.1220; val_gene_expr_recon_loss: 9364153.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35084966.6341; val_optim_loss: 35084966.6341
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9917; val_auprc_score: 0.9886; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 63606.5687; train_edge_recon_loss: 25587097.7772; train_gene_expr_recon_loss: 9048999.8533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34699704.2717; train_optim_loss: 34699704.2717; val_kl_reg_loss: 62437.3973; val_edge_recon_loss: 25671361.0244; val_gene_expr_recon_loss: 9346235.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35080034.2439; val_optim_loss: 35080034.2439
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9921; val_auprc_score: 0.9894; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 63670.1706; train_edge_recon_loss: 25568718.1087; train_gene_expr_recon_loss: 9051519.4049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34683907.6087; train_optim_loss: 34683907.6087; val_kl_reg_loss: 62233.0898; val_edge_recon_loss: 25627802.8293; val_gene_expr_recon_loss: 9371633.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35061670.3415; val_optim_loss: 35061670.3415

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 63479.7767; train_edge_recon_loss: 25581437.4891; train_gene_expr_recon_loss: 9040806.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34685723.5543; train_optim_loss: 34685723.5543; val_kl_reg_loss: 62119.0618; val_edge_recon_loss: 25680742.3415; val_gene_expr_recon_loss: 9359588.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35102449.8537; val_optim_loss: 35102449.8537
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 63551.0236; train_edge_recon_loss: 25571850.4511; train_gene_expr_recon_loss: 9044992.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34680394.0761; train_optim_loss: 34680394.0761; val_kl_reg_loss: 62449.5069; val_edge_recon_loss: 25653726.3902; val_gene_expr_recon_loss: 9368526.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35084703.0244; val_optim_loss: 35084703.0244
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 63662.0838; train_edge_recon_loss: 25583009.9837; train_gene_expr_recon_loss: 9039978.5639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34686650.5326; train_optim_loss: 34686650.5326; val_kl_reg_loss: 62444.9506; val_edge_recon_loss: 25631115.9512; val_gene_expr_recon_loss: 9347984.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35041545.3659; val_optim_loss: 35041545.3659
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9919; val_auprc_score: 0.9890; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 63742.5513; train_edge_recon_loss: 25568004.9674; train_gene_expr_recon_loss: 9037491.2921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34669238.8043; train_optim_loss: 34669238.8043; val_kl_reg_loss: 62536.7000; val_edge_recon_loss: 25676902.0976; val_gene_expr_recon_loss: 9369457.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35108895.6098; val_optim_loss: 35108895.6098

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 101 min 52 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9921
Val AUPRC score: 0.9892
Val best accuracy score: 0.9711
Val best F1 score: 0.9716
Val gene expr MSE score: 0.6161

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
