None
Run timestamp: 08082023_224016_98.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_98']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9765; val_auprc_score: 0.9649; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 26329.5479; train_edge_recon_loss: 26783012.6630; train_gene_expr_recon_loss: 2319059.0887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29128401.2500; train_optim_loss: 29128401.2500; val_kl_reg_loss: 25967.4861; val_edge_recon_loss: 26013281.7561; val_gene_expr_recon_loss: 2121288.4787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28160537.8049; val_optim_loss: 28160537.8049
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9797; val_auprc_score: 0.9710; val_best_acc_score: 0.9455; val_best_f1_score: 0.9469; train_kl_reg_loss: 25218.8333; train_edge_recon_loss: 25889751.4728; train_gene_expr_recon_loss: 2049382.0717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27964352.4076; train_optim_loss: 27964352.4076; val_kl_reg_loss: 23507.7147; val_edge_recon_loss: 25948101.2683; val_gene_expr_recon_loss: 1991421.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27963030.6829; val_optim_loss: 27963030.6829
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9819; val_auprc_score: 0.9731; val_best_acc_score: 0.9541; val_best_f1_score: 0.9554; train_kl_reg_loss: 22858.0080; train_edge_recon_loss: 25759339.5054; train_gene_expr_recon_loss: 1960385.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27742583.4511; train_optim_loss: 27742583.4511; val_kl_reg_loss: 22422.0619; val_edge_recon_loss: 25791531.7073; val_gene_expr_recon_loss: 1923603.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27737556.8780; val_optim_loss: 27737556.8780
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9838; val_auprc_score: 0.9762; val_best_acc_score: 0.9570; val_best_f1_score: 0.9582; train_kl_reg_loss: 22518.1989; train_edge_recon_loss: 25709825.2935; train_gene_expr_recon_loss: 1901163.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27633506.9076; train_optim_loss: 27633506.9076; val_kl_reg_loss: 22436.0613; val_edge_recon_loss: 25736921.1220; val_gene_expr_recon_loss: 1877125.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27636482.4390; val_optim_loss: 27636482.4390
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9851; val_auprc_score: 0.9776; val_best_acc_score: 0.9596; val_best_f1_score: 0.9607; train_kl_reg_loss: 22281.6492; train_edge_recon_loss: 25653009.9946; train_gene_expr_recon_loss: 1865395.8312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27540687.4783; train_optim_loss: 27540687.4783; val_kl_reg_loss: 21813.1321; val_edge_recon_loss: 25735569.0732; val_gene_expr_recon_loss: 1842678.4268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27600060.7317; val_optim_loss: 27600060.7317
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9795; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 21460.8099; train_edge_recon_loss: 25647181.7554; train_gene_expr_recon_loss: 1836924.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27505567.3315; train_optim_loss: 27505567.3315; val_kl_reg_loss: 20942.2913; val_edge_recon_loss: 25675451.0244; val_gene_expr_recon_loss: 1821935.0701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27518328.1951; val_optim_loss: 27518328.1951
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9870; val_auprc_score: 0.9806; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 20974.5476; train_edge_recon_loss: 25599771.6739; train_gene_expr_recon_loss: 1816319.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27437065.7011; train_optim_loss: 27437065.7011; val_kl_reg_loss: 20899.7742; val_edge_recon_loss: 25660642.4390; val_gene_expr_recon_loss: 1803853.6006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27485395.8537; val_optim_loss: 27485395.8537
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9879; val_auprc_score: 0.9824; val_best_acc_score: 0.9646; val_best_f1_score: 0.9654; train_kl_reg_loss: 20851.5276; train_edge_recon_loss: 25582638.8913; train_gene_expr_recon_loss: 1799895.3849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27403385.8587; train_optim_loss: 27403385.8587; val_kl_reg_loss: 19846.1963; val_edge_recon_loss: 25615944.5854; val_gene_expr_recon_loss: 1791578.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27427369.2195; val_optim_loss: 27427369.2195
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9883; val_auprc_score: 0.9827; val_best_acc_score: 0.9639; val_best_f1_score: 0.9646; train_kl_reg_loss: 20782.3759; train_edge_recon_loss: 25574975.7337; train_gene_expr_recon_loss: 1785068.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27380826.2880; train_optim_loss: 27380826.2880; val_kl_reg_loss: 20854.4510; val_edge_recon_loss: 25669162.0488; val_gene_expr_recon_loss: 1777708.6037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27467725.1707; val_optim_loss: 27467725.1707
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9895; val_auprc_score: 0.9842; val_best_acc_score: 0.9679; val_best_f1_score: 0.9686; train_kl_reg_loss: 20823.5418; train_edge_recon_loss: 25542103.3261; train_gene_expr_recon_loss: 1773828.0445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27336754.9565; train_optim_loss: 27336754.9565; val_kl_reg_loss: 20104.6645; val_edge_recon_loss: 25581230.4390; val_gene_expr_recon_loss: 1768638.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27369973.6098; val_optim_loss: 27369973.6098
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9892; val_auprc_score: 0.9837; val_best_acc_score: 0.9681; val_best_f1_score: 0.9688; train_kl_reg_loss: 20693.3108; train_edge_recon_loss: 25546710.9076; train_gene_expr_recon_loss: 1766817.8567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27334222.1359; train_optim_loss: 27334222.1359; val_kl_reg_loss: 19996.6599; val_edge_recon_loss: 25608947.9512; val_gene_expr_recon_loss: 1760116.0610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27389060.6829; val_optim_loss: 27389060.6829
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9908; val_auprc_score: 0.9867; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 20594.9470; train_edge_recon_loss: 25525198.1141; train_gene_expr_recon_loss: 1758164.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27303957.5870; train_optim_loss: 27303957.5870; val_kl_reg_loss: 20135.8364; val_edge_recon_loss: 25581553.7561; val_gene_expr_recon_loss: 1753108.9116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27354798.5366; val_optim_loss: 27354798.5366
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9900; val_auprc_score: 0.9840; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 20375.1193; train_edge_recon_loss: 25521319.6957; train_gene_expr_recon_loss: 1750847.4029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27292542.2174; train_optim_loss: 27292542.2174; val_kl_reg_loss: 19848.4279; val_edge_recon_loss: 25569055.5610; val_gene_expr_recon_loss: 1746751.7896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27335655.8537; val_optim_loss: 27335655.8537
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9913; val_auprc_score: 0.9877; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 20157.1200; train_edge_recon_loss: 25511490.5163; train_gene_expr_recon_loss: 1744810.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27276458.6141; train_optim_loss: 27276458.6141; val_kl_reg_loss: 19757.8243; val_edge_recon_loss: 25567568.2439; val_gene_expr_recon_loss: 1741072.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27328399.0244; val_optim_loss: 27328399.0244
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9913; val_auprc_score: 0.9870; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 20126.6485; train_edge_recon_loss: 25501630.0924; train_gene_expr_recon_loss: 1739671.7802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27261428.5000; train_optim_loss: 27261428.5000; val_kl_reg_loss: 19359.1610; val_edge_recon_loss: 25560995.4634; val_gene_expr_recon_loss: 1738940.1402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27319294.9756; val_optim_loss: 27319294.9756
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9924; val_auprc_score: 0.9893; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 19855.0804; train_edge_recon_loss: 25497101.3207; train_gene_expr_recon_loss: 1737170.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27254126.5054; train_optim_loss: 27254126.5054; val_kl_reg_loss: 19924.4293; val_edge_recon_loss: 25551452.0488; val_gene_expr_recon_loss: 1732671.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27304048.2927; val_optim_loss: 27304048.2927
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9929; val_auprc_score: 0.9898; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 19561.0470; train_edge_recon_loss: 25489931.5217; train_gene_expr_recon_loss: 1733367.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27242859.5598; train_optim_loss: 27242859.5598; val_kl_reg_loss: 19138.4218; val_edge_recon_loss: 25498097.8049; val_gene_expr_recon_loss: 1732544.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27249780.6341; val_optim_loss: 27249780.6341
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9921; val_auprc_score: 0.9884; val_best_acc_score: 0.9749; val_best_f1_score: 0.9753; train_kl_reg_loss: 19728.7154; train_edge_recon_loss: 25482391.3261; train_gene_expr_recon_loss: 1730032.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27232152.8098; train_optim_loss: 27232152.8098; val_kl_reg_loss: 19528.7044; val_edge_recon_loss: 25559870.7805; val_gene_expr_recon_loss: 1726505.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27305905.3171; val_optim_loss: 27305905.3171
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9930; val_auprc_score: 0.9898; val_best_acc_score: 0.9769; val_best_f1_score: 0.9773; train_kl_reg_loss: 19499.5015; train_edge_recon_loss: 25472105.4674; train_gene_expr_recon_loss: 1726607.5608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27218212.6033; train_optim_loss: 27218212.6033; val_kl_reg_loss: 19015.1757; val_edge_recon_loss: 25529831.4146; val_gene_expr_recon_loss: 1722384.8445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27271231.6585; val_optim_loss: 27271231.6585
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9932; val_auprc_score: 0.9902; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 19451.2556; train_edge_recon_loss: 25464272.8315; train_gene_expr_recon_loss: 1724648.8893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27208373.0380; train_optim_loss: 27208373.0380; val_kl_reg_loss: 19077.0145; val_edge_recon_loss: 25521749.6585; val_gene_expr_recon_loss: 1724292.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27265119.3659; val_optim_loss: 27265119.3659
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9933; val_auprc_score: 0.9902; val_best_acc_score: 0.9769; val_best_f1_score: 0.9773; train_kl_reg_loss: 19417.4806; train_edge_recon_loss: 25456239.0652; train_gene_expr_recon_loss: 1720972.2762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27196628.8804; train_optim_loss: 27196628.8804; val_kl_reg_loss: 18903.8886; val_edge_recon_loss: 25520996.2439; val_gene_expr_recon_loss: 1724113.7957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27264013.9024; val_optim_loss: 27264013.9024

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9940; val_auprc_score: 0.9912; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 19246.3913; train_edge_recon_loss: 25463966.8043; train_gene_expr_recon_loss: 1716687.8573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27199901.0598; train_optim_loss: 27199901.0598; val_kl_reg_loss: 19098.7096; val_edge_recon_loss: 25499035.8537; val_gene_expr_recon_loss: 1718888.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27237022.7805; val_optim_loss: 27237022.7805
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9895; val_best_acc_score: 0.9767; val_best_f1_score: 0.9771; train_kl_reg_loss: 19402.3023; train_edge_recon_loss: 25440489.6359; train_gene_expr_recon_loss: 1714657.2385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27174549.2391; train_optim_loss: 27174549.2391; val_kl_reg_loss: 19114.9414; val_edge_recon_loss: 25539752.5854; val_gene_expr_recon_loss: 1719466.6128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27278334.3415; val_optim_loss: 27278334.3415
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9940; val_auprc_score: 0.9913; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 19415.8830; train_edge_recon_loss: 25461656.2500; train_gene_expr_recon_loss: 1713962.3706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27195034.5543; train_optim_loss: 27195034.5543; val_kl_reg_loss: 19186.8626; val_edge_recon_loss: 25494184.7805; val_gene_expr_recon_loss: 1714997.7195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27228369.4634; val_optim_loss: 27228369.4634
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9904; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 19439.0142; train_edge_recon_loss: 25441776.7935; train_gene_expr_recon_loss: 1713604.5727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27174820.3424; train_optim_loss: 27174820.3424; val_kl_reg_loss: 19186.8901; val_edge_recon_loss: 25512089.7561; val_gene_expr_recon_loss: 1715457.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27246734.7317; val_optim_loss: 27246734.7317
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9939; val_auprc_score: 0.9908; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 19495.3425; train_edge_recon_loss: 25443705.1250; train_gene_expr_recon_loss: 1711879.5401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27175079.9891; train_optim_loss: 27175079.9891; val_kl_reg_loss: 19141.5044; val_edge_recon_loss: 25505703.4146; val_gene_expr_recon_loss: 1715151.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27239996.5366; val_optim_loss: 27239996.5366
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9939; val_auprc_score: 0.9910; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 19448.6879; train_edge_recon_loss: 25438532.7120; train_gene_expr_recon_loss: 1711493.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27169474.9674; train_optim_loss: 27169474.9674; val_kl_reg_loss: 19078.4029; val_edge_recon_loss: 25485507.9024; val_gene_expr_recon_loss: 1715591.0366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27220177.2195; val_optim_loss: 27220177.2195
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9935; val_auprc_score: 0.9904; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 19412.0983; train_edge_recon_loss: 25440167.0380; train_gene_expr_recon_loss: 1712513.7711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27172092.8750; train_optim_loss: 27172092.8750; val_kl_reg_loss: 19023.2307; val_edge_recon_loss: 25506161.7073; val_gene_expr_recon_loss: 1715879.2287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27241064.1951; val_optim_loss: 27241064.1951
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9942; val_auprc_score: 0.9913; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 19301.2349; train_edge_recon_loss: 25436426.5978; train_gene_expr_recon_loss: 1711031.5724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27166759.4620; train_optim_loss: 27166759.4620; val_kl_reg_loss: 19030.0425; val_edge_recon_loss: 25510125.7073; val_gene_expr_recon_loss: 1714359.5579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27243515.3659; val_optim_loss: 27243515.3659
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9941; val_auprc_score: 0.9913; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 19300.5886; train_edge_recon_loss: 25436692.7935; train_gene_expr_recon_loss: 1710732.4528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27166725.7446; train_optim_loss: 27166725.7446; val_kl_reg_loss: 18975.6931; val_edge_recon_loss: 25503569.9024; val_gene_expr_recon_loss: 1711656.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27234201.8049; val_optim_loss: 27234201.8049
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9936; val_auprc_score: 0.9906; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 19207.6767; train_edge_recon_loss: 25431012.2554; train_gene_expr_recon_loss: 1711986.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27162206.9674; train_optim_loss: 27162206.9674; val_kl_reg_loss: 18863.9021; val_edge_recon_loss: 25531201.7561; val_gene_expr_recon_loss: 1713399.5061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27263465.0732; val_optim_loss: 27263465.0732

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9937; val_auprc_score: 0.9905; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 19196.1779; train_edge_recon_loss: 25442994.2826; train_gene_expr_recon_loss: 1709447.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27171637.6413; train_optim_loss: 27171637.6413; val_kl_reg_loss: 18887.2888; val_edge_recon_loss: 25495630.4390; val_gene_expr_recon_loss: 1713833.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27228351.0732; val_optim_loss: 27228351.0732
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9940; val_auprc_score: 0.9910; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 19191.2626; train_edge_recon_loss: 25435329.6413; train_gene_expr_recon_loss: 1710535.0628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27165055.9457; train_optim_loss: 27165055.9457; val_kl_reg_loss: 18911.5170; val_edge_recon_loss: 25467677.8049; val_gene_expr_recon_loss: 1713221.3354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27199810.6341; val_optim_loss: 27199810.6341
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9941; val_auprc_score: 0.9914; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 19188.1227; train_edge_recon_loss: 25435911.8859; train_gene_expr_recon_loss: 1710153.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27165253.4783; train_optim_loss: 27165253.4783; val_kl_reg_loss: 18877.2278; val_edge_recon_loss: 25495803.0732; val_gene_expr_recon_loss: 1715674.2317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27230354.4878; val_optim_loss: 27230354.4878
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9941; val_auprc_score: 0.9913; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 19188.2259; train_edge_recon_loss: 25432610.5435; train_gene_expr_recon_loss: 1710920.4711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27162719.2011; train_optim_loss: 27162719.2011; val_kl_reg_loss: 18873.7831; val_edge_recon_loss: 25486576.5854; val_gene_expr_recon_loss: 1713043.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27218493.7073; val_optim_loss: 27218493.7073
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 19191.6527; train_edge_recon_loss: 25433676.8859; train_gene_expr_recon_loss: 1709534.6206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27162403.2228; train_optim_loss: 27162403.2228; val_kl_reg_loss: 18866.1600; val_edge_recon_loss: 25514684.3415; val_gene_expr_recon_loss: 1711979.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27245530.5366; val_optim_loss: 27245530.5366
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9940; val_auprc_score: 0.9912; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 19188.6133; train_edge_recon_loss: 25442843.8261; train_gene_expr_recon_loss: 1709595.5985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27171627.9946; train_optim_loss: 27171627.9946; val_kl_reg_loss: 18900.5302; val_edge_recon_loss: 25486234.9756; val_gene_expr_recon_loss: 1711804.3720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27216939.7561; val_optim_loss: 27216939.7561

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9938; val_auprc_score: 0.9907; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 19182.8949; train_edge_recon_loss: 25439346.6630; train_gene_expr_recon_loss: 1708520.2395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27167049.7663; train_optim_loss: 27167049.7663; val_kl_reg_loss: 18867.5895; val_edge_recon_loss: 25489001.0244; val_gene_expr_recon_loss: 1712109.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27219977.8049; val_optim_loss: 27219977.8049
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9942; val_auprc_score: 0.9917; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 19182.8324; train_edge_recon_loss: 25438329.4457; train_gene_expr_recon_loss: 1709234.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27166746.7989; train_optim_loss: 27166746.7989; val_kl_reg_loss: 18885.9535; val_edge_recon_loss: 25485543.9024; val_gene_expr_recon_loss: 1712104.8262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27216534.5366; val_optim_loss: 27216534.5366
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9937; val_auprc_score: 0.9905; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 19178.7971; train_edge_recon_loss: 25446547.2989; train_gene_expr_recon_loss: 1709811.0819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27175537.1250; train_optim_loss: 27175537.1250; val_kl_reg_loss: 18887.9367; val_edge_recon_loss: 25490263.9024; val_gene_expr_recon_loss: 1712576.7774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27221728.5366; val_optim_loss: 27221728.5366
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9939; val_auprc_score: 0.9908; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 19182.5823; train_edge_recon_loss: 25441443.7011; train_gene_expr_recon_loss: 1708601.5275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27169227.8261; train_optim_loss: 27169227.8261; val_kl_reg_loss: 18886.1096; val_edge_recon_loss: 25514374.0000; val_gene_expr_recon_loss: 1712953.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27246214.1463; val_optim_loss: 27246214.1463

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 65 min 12 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9936
val AUPRC score: 0.9901
val best accuracy score: 0.9787
val best F1 score: 0.9790
val target rna MSE score: 0.5754
val source rna MSE score: 0.0662

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
