None
Run timestamp: 02072023_111255_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9859; val_auprc_score: 0.9791; val_best_acc_score: 0.9595; val_best_f1_score: 0.9606; train_kl_reg_loss: 2132.6072; train_edge_recon_loss: 27558.0261; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29690.6333; train_optim_loss: 29690.6333; val_kl_reg_loss: 2260.9697; val_edge_recon_loss: 25775.4349; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28036.4045; val_optim_loss: 28036.4045
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9836; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 2262.6451; train_edge_recon_loss: 26973.6056; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29236.2507; train_optim_loss: 29236.2507; val_kl_reg_loss: 2273.2062; val_edge_recon_loss: 25682.0951; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27955.3013; val_optim_loss: 27955.3013
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9914; val_auprc_score: 0.9869; val_best_acc_score: 0.9728; val_best_f1_score: 0.9733; train_kl_reg_loss: 2274.8668; train_edge_recon_loss: 26902.6727; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29177.5395; train_optim_loss: 29177.5395; val_kl_reg_loss: 2261.2038; val_edge_recon_loss: 25630.3430; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27891.5467; val_optim_loss: 27891.5467
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9916; val_auprc_score: 0.9871; val_best_acc_score: 0.9742; val_best_f1_score: 0.9747; train_kl_reg_loss: 2280.9109; train_edge_recon_loss: 26857.4468; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29138.3577; train_optim_loss: 29138.3577; val_kl_reg_loss: 2271.8699; val_edge_recon_loss: 25617.6395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27889.5094; val_optim_loss: 27889.5094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9899; val_best_acc_score: 0.9769; val_best_f1_score: 0.9773; train_kl_reg_loss: 2286.0289; train_edge_recon_loss: 26825.2584; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29111.2873; train_optim_loss: 29111.2873; val_kl_reg_loss: 2228.6312; val_edge_recon_loss: 25562.5987; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27791.2300; val_optim_loss: 27791.2300
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9933; val_auprc_score: 0.9900; val_best_acc_score: 0.9768; val_best_f1_score: 0.9772; train_kl_reg_loss: 2291.2882; train_edge_recon_loss: 26797.2701; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29088.5583; train_optim_loss: 29088.5583; val_kl_reg_loss: 2297.8437; val_edge_recon_loss: 25570.1167; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27867.9604; val_optim_loss: 27867.9604
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9918; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 2290.0917; train_edge_recon_loss: 26798.5674; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29088.6591; train_optim_loss: 29088.6591; val_kl_reg_loss: 2325.2804; val_edge_recon_loss: 25538.2288; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27863.5093; val_optim_loss: 27863.5093
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9917; val_best_acc_score: 0.9810; val_best_f1_score: 0.9813; train_kl_reg_loss: 2294.1221; train_edge_recon_loss: 26772.5859; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29066.7080; train_optim_loss: 29066.7080; val_kl_reg_loss: 2224.8097; val_edge_recon_loss: 25522.6335; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27747.4432; val_optim_loss: 27747.4432
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9951; val_auprc_score: 0.9927; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 2295.6470; train_edge_recon_loss: 26764.0161; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29059.6631; train_optim_loss: 29059.6631; val_kl_reg_loss: 2330.8837; val_edge_recon_loss: 25495.8315; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27826.7152; val_optim_loss: 27826.7152
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9936; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 2295.6783; train_edge_recon_loss: 26763.4379; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29059.1162; train_optim_loss: 29059.1162; val_kl_reg_loss: 2284.6075; val_edge_recon_loss: 25485.9606; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27770.5681; val_optim_loss: 27770.5681
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9939; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 2298.7395; train_edge_recon_loss: 26743.2380; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29041.9774; train_optim_loss: 29041.9774; val_kl_reg_loss: 2302.3233; val_edge_recon_loss: 25467.4274; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27769.7508; val_optim_loss: 27769.7508
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9944; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 2299.7138; train_edge_recon_loss: 26734.9948; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29034.7087; train_optim_loss: 29034.7087; val_kl_reg_loss: 2286.1778; val_edge_recon_loss: 25482.9337; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27769.1116; val_optim_loss: 27769.1116

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9939; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 2293.6164; train_edge_recon_loss: 26712.0069; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29005.6233; train_optim_loss: 29005.6233; val_kl_reg_loss: 2304.9903; val_edge_recon_loss: 25454.6690; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27759.6593; val_optim_loss: 27759.6593
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9944; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 2293.8530; train_edge_recon_loss: 26709.8157; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29003.6686; train_optim_loss: 29003.6686; val_kl_reg_loss: 2300.0945; val_edge_recon_loss: 25446.0896; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27746.1841; val_optim_loss: 27746.1841
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2293.9108; train_edge_recon_loss: 26702.8221; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28996.7329; train_optim_loss: 28996.7329; val_kl_reg_loss: 2308.8120; val_edge_recon_loss: 25466.0276; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27774.8397; val_optim_loss: 27774.8397
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9962; val_auprc_score: 0.9940; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 2293.1265; train_edge_recon_loss: 26709.3162; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29002.4428; train_optim_loss: 29002.4428; val_kl_reg_loss: 2315.2088; val_edge_recon_loss: 25452.2028; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27767.4115; val_optim_loss: 27767.4115
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9963; val_auprc_score: 0.9942; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 2294.2669; train_edge_recon_loss: 26700.8543; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28995.1212; train_optim_loss: 28995.1212; val_kl_reg_loss: 2323.7579; val_edge_recon_loss: 25456.4859; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27780.2439; val_optim_loss: 27780.2439
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9964; val_auprc_score: 0.9948; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 2295.1341; train_edge_recon_loss: 26696.0589; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28991.1931; train_optim_loss: 28991.1931; val_kl_reg_loss: 2317.2539; val_edge_recon_loss: 25469.0770; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27786.3308; val_optim_loss: 27786.3308

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2293.5940; train_edge_recon_loss: 26697.1027; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28990.6967; train_optim_loss: 28990.6967; val_kl_reg_loss: 2305.1209; val_edge_recon_loss: 25432.5338; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27737.6546; val_optim_loss: 27737.6546
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9951; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2294.4883; train_edge_recon_loss: 26688.6133; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.1016; train_optim_loss: 28983.1016; val_kl_reg_loss: 2305.3471; val_edge_recon_loss: 25428.7415; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27734.0887; val_optim_loss: 27734.0887
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9964; val_auprc_score: 0.9946; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2294.1894; train_edge_recon_loss: 26690.1045; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28984.2939; train_optim_loss: 28984.2939; val_kl_reg_loss: 2305.6851; val_edge_recon_loss: 25439.7177; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27745.4028; val_optim_loss: 27745.4028
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9965; val_auprc_score: 0.9947; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2293.6209; train_edge_recon_loss: 26695.6389; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28989.2598; train_optim_loss: 28989.2598; val_kl_reg_loss: 2304.8406; val_edge_recon_loss: 25446.4577; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27751.2984; val_optim_loss: 27751.2984
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9952; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2293.6770; train_edge_recon_loss: 26689.6697; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.3467; train_optim_loss: 28983.3467; val_kl_reg_loss: 2308.7196; val_edge_recon_loss: 25421.9295; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27730.6491; val_optim_loss: 27730.6491
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9963; val_auprc_score: 0.9941; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2294.2671; train_edge_recon_loss: 26689.0630; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.3301; train_optim_loss: 28983.3301; val_kl_reg_loss: 2306.9196; val_edge_recon_loss: 25431.7565; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27738.6761; val_optim_loss: 27738.6761
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9952; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2293.2766; train_edge_recon_loss: 26693.2960; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28986.5726; train_optim_loss: 28986.5726; val_kl_reg_loss: 2304.2350; val_edge_recon_loss: 25439.9535; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27744.1885; val_optim_loss: 27744.1885
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9944; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 2293.1106; train_edge_recon_loss: 26694.8435; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28987.9540; train_optim_loss: 28987.9540; val_kl_reg_loss: 2306.2318; val_edge_recon_loss: 25460.9477; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27767.1795; val_optim_loss: 27767.1795
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9946; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2293.5165; train_edge_recon_loss: 26693.4678; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28986.9843; train_optim_loss: 28986.9843; val_kl_reg_loss: 2303.9643; val_edge_recon_loss: 25448.8139; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27752.7782; val_optim_loss: 27752.7782

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9947; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2292.2810; train_edge_recon_loss: 26694.1678; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28986.4489; train_optim_loss: 28986.4489; val_kl_reg_loss: 2305.6937; val_edge_recon_loss: 25428.0067; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27733.7004; val_optim_loss: 27733.7004
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2293.0663; train_edge_recon_loss: 26689.9744; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.0407; train_optim_loss: 28983.0407; val_kl_reg_loss: 2306.5955; val_edge_recon_loss: 25427.4379; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27734.0333; val_optim_loss: 27734.0333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2292.9466; train_edge_recon_loss: 26691.5412; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28984.4878; train_optim_loss: 28984.4878; val_kl_reg_loss: 2306.5273; val_edge_recon_loss: 25462.0092; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27768.5365; val_optim_loss: 27768.5365
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9965; val_auprc_score: 0.9945; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2293.4411; train_edge_recon_loss: 26689.6519; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.0929; train_optim_loss: 28983.0929; val_kl_reg_loss: 2306.8700; val_edge_recon_loss: 25416.4910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27723.3609; val_optim_loss: 27723.3609
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2293.2625; train_edge_recon_loss: 26689.1502; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28982.4127; train_optim_loss: 28982.4127; val_kl_reg_loss: 2306.7030; val_edge_recon_loss: 25446.9455; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27753.6484; val_optim_loss: 27753.6484
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9966; val_auprc_score: 0.9948; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2293.3510; train_edge_recon_loss: 26696.0214; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28989.3724; train_optim_loss: 28989.3724; val_kl_reg_loss: 2305.5667; val_edge_recon_loss: 25417.7101; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27723.2766; val_optim_loss: 27723.2766
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9944; val_best_acc_score: 0.9862; val_best_f1_score: 0.9864; train_kl_reg_loss: 2293.6216; train_edge_recon_loss: 26686.0665; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28979.6880; train_optim_loss: 28979.6880; val_kl_reg_loss: 2307.7050; val_edge_recon_loss: 25419.5830; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27727.2880; val_optim_loss: 27727.2880
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9948; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2294.5782; train_edge_recon_loss: 26682.6190; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28977.1972; train_optim_loss: 28977.1972; val_kl_reg_loss: 2307.6570; val_edge_recon_loss: 25431.8104; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27739.4674; val_optim_loss: 27739.4674
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 2293.6989; train_edge_recon_loss: 26689.6459; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28983.3448; train_optim_loss: 28983.3448; val_kl_reg_loss: 2307.5531; val_edge_recon_loss: 25443.7802; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27751.3332; val_optim_loss: 27751.3332
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9966; val_auprc_score: 0.9950; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 2292.7067; train_edge_recon_loss: 26696.5948; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28989.3016; train_optim_loss: 28989.3016; val_kl_reg_loss: 2306.1324; val_edge_recon_loss: 25422.1804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27728.3130; val_optim_loss: 27728.3130

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 2292.9147; train_edge_recon_loss: 26689.3661; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28982.2808; train_optim_loss: 28982.2808; val_kl_reg_loss: 2306.0391; val_edge_recon_loss: 25448.4438; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27754.4828; val_optim_loss: 27754.4828
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9965; val_auprc_score: 0.9946; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2292.9407; train_edge_recon_loss: 26686.5333; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28979.4740; train_optim_loss: 28979.4740; val_kl_reg_loss: 2306.5752; val_edge_recon_loss: 25439.8834; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27746.4587; val_optim_loss: 27746.4587
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9948; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 2293.1214; train_edge_recon_loss: 26694.9338; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28988.0552; train_optim_loss: 28988.0552; val_kl_reg_loss: 2306.6559; val_edge_recon_loss: 25442.4382; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27749.0941; val_optim_loss: 27749.0941
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9967; val_auprc_score: 0.9950; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2293.2755; train_edge_recon_loss: 26683.1236; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28976.3991; train_optim_loss: 28976.3991; val_kl_reg_loss: 2306.6207; val_edge_recon_loss: 25442.0014; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27748.6222; val_optim_loss: 27748.6222

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 376 min 20 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9945
Val best accuracy score: 0.9857
Val best F1 score: 0.9859
Val gene expr MSE score: 0.9053

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
