None
Run timestamp: 13072023_131455_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9729; val_auprc_score: 0.9714; val_best_acc_score: 0.9173; val_best_f1_score: 0.9180; train_kl_reg_loss: 9020.5340; train_edge_recon_loss: 274865.8812; train_gene_expr_recon_loss: 151224.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435110.4542; train_optim_loss: 435110.4542; val_kl_reg_loss: 8121.6370; val_edge_recon_loss: 270859.4807; val_gene_expr_recon_loss: 137654.3913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416635.5119; val_optim_loss: 416635.5119
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9795; val_auprc_score: 0.9782; val_best_acc_score: 0.9293; val_best_f1_score: 0.9300; train_kl_reg_loss: 8204.3029; train_edge_recon_loss: 265762.8587; train_gene_expr_recon_loss: 133651.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407618.5948; train_optim_loss: 407618.5948; val_kl_reg_loss: 7802.6682; val_edge_recon_loss: 268945.8818; val_gene_expr_recon_loss: 130329.2629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407077.8131; val_optim_loss: 407077.8131
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9820; val_auprc_score: 0.9807; val_best_acc_score: 0.9350; val_best_f1_score: 0.9356; train_kl_reg_loss: 7711.9871; train_edge_recon_loss: 264435.0089; train_gene_expr_recon_loss: 128604.4194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400751.4149; train_optim_loss: 400751.4149; val_kl_reg_loss: 7252.4252; val_edge_recon_loss: 267887.2580; val_gene_expr_recon_loss: 126893.0906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402032.7724; val_optim_loss: 402032.7724
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9838; val_auprc_score: 0.9826; val_best_acc_score: 0.9378; val_best_f1_score: 0.9386; train_kl_reg_loss: 7456.2434; train_edge_recon_loss: 263654.5638; train_gene_expr_recon_loss: 125919.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397030.5792; train_optim_loss: 397030.5792; val_kl_reg_loss: 7217.3891; val_edge_recon_loss: 268432.7366; val_gene_expr_recon_loss: 124502.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400152.9548; val_optim_loss: 400152.9548
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9850; val_auprc_score: 0.9839; val_best_acc_score: 0.9422; val_best_f1_score: 0.9426; train_kl_reg_loss: 7302.2768; train_edge_recon_loss: 263144.8835; train_gene_expr_recon_loss: 124214.3540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394661.5139; train_optim_loss: 394661.5139; val_kl_reg_loss: 6960.1735; val_edge_recon_loss: 267232.9244; val_gene_expr_recon_loss: 123332.7270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397525.8253; val_optim_loss: 397525.8253
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9856; val_auprc_score: 0.9845; val_best_acc_score: 0.9429; val_best_f1_score: 0.9434; train_kl_reg_loss: 7215.5288; train_edge_recon_loss: 262613.2974; train_gene_expr_recon_loss: 123075.0845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392903.9104; train_optim_loss: 392903.9104; val_kl_reg_loss: 7038.8977; val_edge_recon_loss: 267336.5205; val_gene_expr_recon_loss: 122454.0140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396829.4310; val_optim_loss: 396829.4310
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9858; val_auprc_score: 0.9849; val_best_acc_score: 0.9432; val_best_f1_score: 0.9437; train_kl_reg_loss: 7156.4348; train_edge_recon_loss: 262202.3876; train_gene_expr_recon_loss: 122241.3522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391600.1747; train_optim_loss: 391600.1747; val_kl_reg_loss: 6994.1278; val_edge_recon_loss: 266585.0401; val_gene_expr_recon_loss: 121670.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395249.7062; val_optim_loss: 395249.7062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9862; val_auprc_score: 0.9852; val_best_acc_score: 0.9444; val_best_f1_score: 0.9449; train_kl_reg_loss: 7111.3894; train_edge_recon_loss: 262035.6169; train_gene_expr_recon_loss: 121591.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390738.6199; train_optim_loss: 390738.6199; val_kl_reg_loss: 6917.3597; val_edge_recon_loss: 266395.7949; val_gene_expr_recon_loss: 121112.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394425.2480; val_optim_loss: 394425.2480
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9857; val_best_acc_score: 0.9444; val_best_f1_score: 0.9448; train_kl_reg_loss: 7083.4662; train_edge_recon_loss: 261970.9529; train_gene_expr_recon_loss: 121096.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390151.1921; train_optim_loss: 390151.1921; val_kl_reg_loss: 6885.3048; val_edge_recon_loss: 266569.1773; val_gene_expr_recon_loss: 120947.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394402.4483; val_optim_loss: 394402.4483
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9868; val_best_acc_score: 0.9471; val_best_f1_score: 0.9476; train_kl_reg_loss: 7048.1706; train_edge_recon_loss: 261835.4944; train_gene_expr_recon_loss: 120649.8019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389533.4676; train_optim_loss: 389533.4676; val_kl_reg_loss: 6886.1991; val_edge_recon_loss: 265898.3635; val_gene_expr_recon_loss: 120559.8153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393344.3770; val_optim_loss: 393344.3770
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9875; val_auprc_score: 0.9864; val_best_acc_score: 0.9474; val_best_f1_score: 0.9478; train_kl_reg_loss: 7059.9680; train_edge_recon_loss: 261528.7000; train_gene_expr_recon_loss: 120242.2356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388830.9030; train_optim_loss: 388830.9030; val_kl_reg_loss: 6880.2946; val_edge_recon_loss: 265846.1901; val_gene_expr_recon_loss: 120089.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392815.5153; val_optim_loss: 392815.5153
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9875; val_auprc_score: 0.9864; val_best_acc_score: 0.9474; val_best_f1_score: 0.9478; train_kl_reg_loss: 7043.7587; train_edge_recon_loss: 261394.2851; train_gene_expr_recon_loss: 120008.7751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388446.8192; train_optim_loss: 388446.8192; val_kl_reg_loss: 6915.6365; val_edge_recon_loss: 266425.4325; val_gene_expr_recon_loss: 119734.6671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393075.7375; val_optim_loss: 393075.7375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9880; val_auprc_score: 0.9867; val_best_acc_score: 0.9484; val_best_f1_score: 0.9487; train_kl_reg_loss: 7032.1507; train_edge_recon_loss: 261350.8967; train_gene_expr_recon_loss: 119727.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388110.5364; train_optim_loss: 388110.5364; val_kl_reg_loss: 6897.7018; val_edge_recon_loss: 266202.2112; val_gene_expr_recon_loss: 119502.6717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392602.5855; val_optim_loss: 392602.5855
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9879; val_auprc_score: 0.9871; val_best_acc_score: 0.9480; val_best_f1_score: 0.9484; train_kl_reg_loss: 7027.1860; train_edge_recon_loss: 261197.4767; train_gene_expr_recon_loss: 119554.3239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387778.9867; train_optim_loss: 387778.9867; val_kl_reg_loss: 6790.5390; val_edge_recon_loss: 265783.8842; val_gene_expr_recon_loss: 119467.4999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392041.9233; val_optim_loss: 392041.9233
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9885; val_auprc_score: 0.9871; val_best_acc_score: 0.9496; val_best_f1_score: 0.9499; train_kl_reg_loss: 7019.6189; train_edge_recon_loss: 261207.2341; train_gene_expr_recon_loss: 119332.2382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387559.0914; train_optim_loss: 387559.0914; val_kl_reg_loss: 6885.8130; val_edge_recon_loss: 265739.6652; val_gene_expr_recon_loss: 119306.9370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391932.4173; val_optim_loss: 391932.4173
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9879; val_auprc_score: 0.9871; val_best_acc_score: 0.9483; val_best_f1_score: 0.9487; train_kl_reg_loss: 7018.5750; train_edge_recon_loss: 261073.2899; train_gene_expr_recon_loss: 119183.8857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387275.7508; train_optim_loss: 387275.7508; val_kl_reg_loss: 6798.7957; val_edge_recon_loss: 266333.7770; val_gene_expr_recon_loss: 119122.0778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392254.6491; val_optim_loss: 392254.6491
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9881; val_auprc_score: 0.9872; val_best_acc_score: 0.9490; val_best_f1_score: 0.9494; train_kl_reg_loss: 7018.6937; train_edge_recon_loss: 261086.5556; train_gene_expr_recon_loss: 119053.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387158.4445; train_optim_loss: 387158.4445; val_kl_reg_loss: 6896.5437; val_edge_recon_loss: 265966.9134; val_gene_expr_recon_loss: 119145.8756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392009.3341; val_optim_loss: 392009.3341
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9883; val_auprc_score: 0.9870; val_best_acc_score: 0.9497; val_best_f1_score: 0.9500; train_kl_reg_loss: 7013.2242; train_edge_recon_loss: 260933.7507; train_gene_expr_recon_loss: 118869.0973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386816.0725; train_optim_loss: 386816.0725; val_kl_reg_loss: 6872.0680; val_edge_recon_loss: 265731.1634; val_gene_expr_recon_loss: 118817.1032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391420.3349; val_optim_loss: 391420.3349
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9884; val_auprc_score: 0.9873; val_best_acc_score: 0.9497; val_best_f1_score: 0.9502; train_kl_reg_loss: 7007.0960; train_edge_recon_loss: 260885.6497; train_gene_expr_recon_loss: 118837.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386730.0788; train_optim_loss: 386730.0788; val_kl_reg_loss: 6955.6010; val_edge_recon_loss: 265786.5297; val_gene_expr_recon_loss: 118880.5508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391622.6821; val_optim_loss: 391622.6821
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9879; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 7014.5478; train_edge_recon_loss: 260713.4855; train_gene_expr_recon_loss: 118780.1585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386508.1916; train_optim_loss: 386508.1916; val_kl_reg_loss: 6846.8037; val_edge_recon_loss: 265590.0763; val_gene_expr_recon_loss: 118885.3988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391322.2795; val_optim_loss: 391322.2795
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9882; val_best_acc_score: 0.9525; val_best_f1_score: 0.9528; train_kl_reg_loss: 7006.5418; train_edge_recon_loss: 260816.7500; train_gene_expr_recon_loss: 118644.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386468.0547; train_optim_loss: 386468.0547; val_kl_reg_loss: 6856.7805; val_edge_recon_loss: 265447.8798; val_gene_expr_recon_loss: 118805.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391110.0895; val_optim_loss: 391110.0895
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9880; val_best_acc_score: 0.9511; val_best_f1_score: 0.9513; train_kl_reg_loss: 7008.4829; train_edge_recon_loss: 260674.1901; train_gene_expr_recon_loss: 118555.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386238.2019; train_optim_loss: 386238.2019; val_kl_reg_loss: 6884.2034; val_edge_recon_loss: 265262.7997; val_gene_expr_recon_loss: 118494.0468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390641.0514; val_optim_loss: 390641.0514
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9882; val_auprc_score: 0.9871; val_best_acc_score: 0.9492; val_best_f1_score: 0.9494; train_kl_reg_loss: 7006.4047; train_edge_recon_loss: 260748.3352; train_gene_expr_recon_loss: 118468.3988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386223.1389; train_optim_loss: 386223.1389; val_kl_reg_loss: 6817.9185; val_edge_recon_loss: 265945.2327; val_gene_expr_recon_loss: 118618.9019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391382.0514; val_optim_loss: 391382.0514
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9885; val_auprc_score: 0.9875; val_best_acc_score: 0.9500; val_best_f1_score: 0.9505; train_kl_reg_loss: 7003.1404; train_edge_recon_loss: 260648.0871; train_gene_expr_recon_loss: 118444.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386095.4905; train_optim_loss: 386095.4905; val_kl_reg_loss: 6900.3622; val_edge_recon_loss: 265473.6521; val_gene_expr_recon_loss: 118529.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390903.2406; val_optim_loss: 390903.2406
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9889; val_auprc_score: 0.9878; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 7001.9122; train_edge_recon_loss: 260676.2361; train_gene_expr_recon_loss: 118358.2212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386036.3700; train_optim_loss: 386036.3700; val_kl_reg_loss: 6850.0310; val_edge_recon_loss: 265389.3994; val_gene_expr_recon_loss: 118464.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390703.9162; val_optim_loss: 390703.9162
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9895; val_auprc_score: 0.9881; val_best_acc_score: 0.9526; val_best_f1_score: 0.9531; train_kl_reg_loss: 7004.4984; train_edge_recon_loss: 260517.2589; train_gene_expr_recon_loss: 118261.7111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385783.4687; train_optim_loss: 385783.4687; val_kl_reg_loss: 6849.8895; val_edge_recon_loss: 264955.0200; val_gene_expr_recon_loss: 118429.1701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390234.0810; val_optim_loss: 390234.0810
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9892; val_auprc_score: 0.9882; val_best_acc_score: 0.9524; val_best_f1_score: 0.9526; train_kl_reg_loss: 7001.7477; train_edge_recon_loss: 260588.6908; train_gene_expr_recon_loss: 118220.9692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385811.4073; train_optim_loss: 385811.4073; val_kl_reg_loss: 6797.2033; val_edge_recon_loss: 265255.5716; val_gene_expr_recon_loss: 118447.9619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390500.7364; val_optim_loss: 390500.7364
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9892; val_auprc_score: 0.9880; val_best_acc_score: 0.9516; val_best_f1_score: 0.9521; train_kl_reg_loss: 7001.0553; train_edge_recon_loss: 260513.6510; train_gene_expr_recon_loss: 118208.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385723.6748; train_optim_loss: 385723.6748; val_kl_reg_loss: 6890.7005; val_edge_recon_loss: 265565.0457; val_gene_expr_recon_loss: 118353.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390809.6125; val_optim_loss: 390809.6125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9897; val_auprc_score: 0.9884; val_best_acc_score: 0.9537; val_best_f1_score: 0.9542; train_kl_reg_loss: 7012.1651; train_edge_recon_loss: 260430.9870; train_gene_expr_recon_loss: 118126.7709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385569.9228; train_optim_loss: 385569.9228; val_kl_reg_loss: 6833.9649; val_edge_recon_loss: 265202.4415; val_gene_expr_recon_loss: 118174.9181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390211.3247; val_optim_loss: 390211.3247
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9897; val_auprc_score: 0.9884; val_best_acc_score: 0.9536; val_best_f1_score: 0.9541; train_kl_reg_loss: 7010.6392; train_edge_recon_loss: 260412.9025; train_gene_expr_recon_loss: 118105.7899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385529.3316; train_optim_loss: 385529.3316; val_kl_reg_loss: 6832.3351; val_edge_recon_loss: 265123.4696; val_gene_expr_recon_loss: 118376.2941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390332.0989; val_optim_loss: 390332.0989
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9897; val_auprc_score: 0.9886; val_best_acc_score: 0.9533; val_best_f1_score: 0.9537; train_kl_reg_loss: 6994.0018; train_edge_recon_loss: 260506.5100; train_gene_expr_recon_loss: 118044.9436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385545.4550; train_optim_loss: 385545.4550; val_kl_reg_loss: 6837.6031; val_edge_recon_loss: 265393.7384; val_gene_expr_recon_loss: 118157.7452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390389.0875; val_optim_loss: 390389.0875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9892; val_auprc_score: 0.9879; val_best_acc_score: 0.9529; val_best_f1_score: 0.9534; train_kl_reg_loss: 7006.7837; train_edge_recon_loss: 260426.0052; train_gene_expr_recon_loss: 117987.3306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385420.1192; train_optim_loss: 385420.1192; val_kl_reg_loss: 6916.7346; val_edge_recon_loss: 265022.6223; val_gene_expr_recon_loss: 118285.7686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390225.1259; val_optim_loss: 390225.1259
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9887; val_auprc_score: 0.9876; val_best_acc_score: 0.9511; val_best_f1_score: 0.9514; train_kl_reg_loss: 7000.9869; train_edge_recon_loss: 260370.3126; train_gene_expr_recon_loss: 117983.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385354.3753; train_optim_loss: 385354.3753; val_kl_reg_loss: 7006.0268; val_edge_recon_loss: 265363.3389; val_gene_expr_recon_loss: 118226.1908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390595.5551; val_optim_loss: 390595.5551

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9901; val_auprc_score: 0.9888; val_best_acc_score: 0.9554; val_best_f1_score: 0.9558; train_kl_reg_loss: 6997.9969; train_edge_recon_loss: 260110.9657; train_gene_expr_recon_loss: 116968.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384077.4812; train_optim_loss: 384077.4812; val_kl_reg_loss: 6831.4744; val_edge_recon_loss: 264716.8939; val_gene_expr_recon_loss: 117237.3589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388785.7284; val_optim_loss: 388785.7284
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9901; val_auprc_score: 0.9890; val_best_acc_score: 0.9551; val_best_f1_score: 0.9555; train_kl_reg_loss: 6986.5270; train_edge_recon_loss: 260071.9960; train_gene_expr_recon_loss: 116920.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383978.9902; train_optim_loss: 383978.9902; val_kl_reg_loss: 6874.7597; val_edge_recon_loss: 264917.2118; val_gene_expr_recon_loss: 117095.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388887.7361; val_optim_loss: 388887.7361
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9898; val_auprc_score: 0.9887; val_best_acc_score: 0.9545; val_best_f1_score: 0.9548; train_kl_reg_loss: 6985.3851; train_edge_recon_loss: 259999.5151; train_gene_expr_recon_loss: 116771.5699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383756.4699; train_optim_loss: 383756.4699; val_kl_reg_loss: 6879.7107; val_edge_recon_loss: 265124.9609; val_gene_expr_recon_loss: 117146.5487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389151.2213; val_optim_loss: 389151.2213
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9906; val_auprc_score: 0.9896; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 6979.0427; train_edge_recon_loss: 259972.7248; train_gene_expr_recon_loss: 116762.5835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383714.3510; train_optim_loss: 383714.3510; val_kl_reg_loss: 6848.4398; val_edge_recon_loss: 264654.2263; val_gene_expr_recon_loss: 117220.6884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388723.3523; val_optim_loss: 388723.3523
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9905; val_auprc_score: 0.9894; val_best_acc_score: 0.9558; val_best_f1_score: 0.9562; train_kl_reg_loss: 6970.5395; train_edge_recon_loss: 259923.1470; train_gene_expr_recon_loss: 116759.0478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383652.7338; train_optim_loss: 383652.7338; val_kl_reg_loss: 6839.0772; val_edge_recon_loss: 264885.8589; val_gene_expr_recon_loss: 117220.2010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388945.1378; val_optim_loss: 388945.1378
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9892; val_best_acc_score: 0.9552; val_best_f1_score: 0.9556; train_kl_reg_loss: 6975.5019; train_edge_recon_loss: 259942.9089; train_gene_expr_recon_loss: 116723.2536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383641.6646; train_optim_loss: 383641.6646; val_kl_reg_loss: 6844.3489; val_edge_recon_loss: 264848.5489; val_gene_expr_recon_loss: 117045.8364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388738.7332; val_optim_loss: 388738.7332
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9906; val_auprc_score: 0.9893; val_best_acc_score: 0.9559; val_best_f1_score: 0.9561; train_kl_reg_loss: 6958.1825; train_edge_recon_loss: 260014.6499; train_gene_expr_recon_loss: 116713.8709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383686.7035; train_optim_loss: 383686.7035; val_kl_reg_loss: 6818.1137; val_edge_recon_loss: 264796.5303; val_gene_expr_recon_loss: 116974.2766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388588.9196; val_optim_loss: 388588.9196
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9908; val_auprc_score: 0.9897; val_best_acc_score: 0.9570; val_best_f1_score: 0.9573; train_kl_reg_loss: 6957.0255; train_edge_recon_loss: 259981.4368; train_gene_expr_recon_loss: 116675.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383613.8353; train_optim_loss: 383613.8353; val_kl_reg_loss: 6829.2759; val_edge_recon_loss: 264492.6898; val_gene_expr_recon_loss: 116980.2558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388302.2210; val_optim_loss: 388302.2210
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9907; val_auprc_score: 0.9895; val_best_acc_score: 0.9559; val_best_f1_score: 0.9563; train_kl_reg_loss: 6954.2901; train_edge_recon_loss: 259995.9251; train_gene_expr_recon_loss: 116660.3935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383610.6102; train_optim_loss: 383610.6102; val_kl_reg_loss: 6839.1584; val_edge_recon_loss: 264683.7247; val_gene_expr_recon_loss: 117114.2455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388637.1293; val_optim_loss: 388637.1293
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9905; val_auprc_score: 0.9895; val_best_acc_score: 0.9559; val_best_f1_score: 0.9562; train_kl_reg_loss: 6950.8863; train_edge_recon_loss: 259969.9343; train_gene_expr_recon_loss: 116640.4936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383561.3151; train_optim_loss: 383561.3151; val_kl_reg_loss: 6819.1790; val_edge_recon_loss: 264786.5483; val_gene_expr_recon_loss: 117054.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388659.7489; val_optim_loss: 388659.7489
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9909; val_auprc_score: 0.9901; val_best_acc_score: 0.9561; val_best_f1_score: 0.9565; train_kl_reg_loss: 6946.0677; train_edge_recon_loss: 259957.6200; train_gene_expr_recon_loss: 116661.9745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383565.6615; train_optim_loss: 383565.6615; val_kl_reg_loss: 6861.8654; val_edge_recon_loss: 264774.4825; val_gene_expr_recon_loss: 116929.6868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388566.0341; val_optim_loss: 388566.0341
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9904; val_auprc_score: 0.9894; val_best_acc_score: 0.9558; val_best_f1_score: 0.9561; train_kl_reg_loss: 6950.0071; train_edge_recon_loss: 259882.4601; train_gene_expr_recon_loss: 116628.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383460.9852; train_optim_loss: 383460.9852; val_kl_reg_loss: 6832.0029; val_edge_recon_loss: 264795.1152; val_gene_expr_recon_loss: 116961.1582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388588.2756; val_optim_loss: 388588.2756

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9895; val_best_acc_score: 0.9557; val_best_f1_score: 0.9561; train_kl_reg_loss: 6943.2134; train_edge_recon_loss: 259903.9136; train_gene_expr_recon_loss: 116507.4226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383354.5499; train_optim_loss: 383354.5499; val_kl_reg_loss: 6823.3750; val_edge_recon_loss: 264593.5396; val_gene_expr_recon_loss: 116991.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388408.0102; val_optim_loss: 388408.0102
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9906; val_auprc_score: 0.9897; val_best_acc_score: 0.9559; val_best_f1_score: 0.9563; train_kl_reg_loss: 6936.0756; train_edge_recon_loss: 259860.6751; train_gene_expr_recon_loss: 116500.4716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383297.2222; train_optim_loss: 383297.2222; val_kl_reg_loss: 6810.7997; val_edge_recon_loss: 264890.2916; val_gene_expr_recon_loss: 116837.1907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388538.2815; val_optim_loss: 388538.2815
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9902; val_auprc_score: 0.9891; val_best_acc_score: 0.9555; val_best_f1_score: 0.9559; train_kl_reg_loss: 6938.6251; train_edge_recon_loss: 259893.8600; train_gene_expr_recon_loss: 116448.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383280.6762; train_optim_loss: 383280.6762; val_kl_reg_loss: 6807.9207; val_edge_recon_loss: 265113.5513; val_gene_expr_recon_loss: 116870.6229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388792.0972; val_optim_loss: 388792.0972
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9905; val_auprc_score: 0.9893; val_best_acc_score: 0.9565; val_best_f1_score: 0.9568; train_kl_reg_loss: 6936.6458; train_edge_recon_loss: 259853.0419; train_gene_expr_recon_loss: 116498.6555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383288.3427; train_optim_loss: 383288.3427; val_kl_reg_loss: 6823.9388; val_edge_recon_loss: 264754.2432; val_gene_expr_recon_loss: 116807.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388385.4568; val_optim_loss: 388385.4568

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 130 min 48 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9897
Val best accuracy score: 0.9567
Val best F1 score: 0.9570
Val gene expr MSE score: 8.7955

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
