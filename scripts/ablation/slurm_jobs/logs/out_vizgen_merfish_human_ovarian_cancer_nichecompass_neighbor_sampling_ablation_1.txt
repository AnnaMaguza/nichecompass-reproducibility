None
Run timestamp: 12072023_182548_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9730; val_auprc_score: 0.9717; val_best_acc_score: 0.9155; val_best_f1_score: 0.9168; train_kl_reg_loss: 9188.2515; train_edge_recon_loss: 275265.9852; train_gene_expr_recon_loss: 150811.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435266.0942; train_optim_loss: 435266.0942; val_kl_reg_loss: 8628.7171; val_edge_recon_loss: 271385.9034; val_gene_expr_recon_loss: 137877.3616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417891.9832; val_optim_loss: 417891.9832
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9789; val_auprc_score: 0.9770; val_best_acc_score: 0.9284; val_best_f1_score: 0.9293; train_kl_reg_loss: 8291.1863; train_edge_recon_loss: 265806.0633; train_gene_expr_recon_loss: 133643.4717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407740.7212; train_optim_loss: 407740.7212; val_kl_reg_loss: 7825.6720; val_edge_recon_loss: 269005.7455; val_gene_expr_recon_loss: 130686.8979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407518.3153; val_optim_loss: 407518.3153
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9813; val_auprc_score: 0.9803; val_best_acc_score: 0.9329; val_best_f1_score: 0.9333; train_kl_reg_loss: 7803.2678; train_edge_recon_loss: 264505.5201; train_gene_expr_recon_loss: 128829.7933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401138.5816; train_optim_loss: 401138.5816; val_kl_reg_loss: 7417.3196; val_edge_recon_loss: 268563.5028; val_gene_expr_recon_loss: 127334.8735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403315.6986; val_optim_loss: 403315.6986
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9826; val_auprc_score: 0.9815; val_best_acc_score: 0.9360; val_best_f1_score: 0.9364; train_kl_reg_loss: 7533.9070; train_edge_recon_loss: 263607.9947; train_gene_expr_recon_loss: 126152.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397294.8304; train_optim_loss: 397294.8304; val_kl_reg_loss: 7329.5646; val_edge_recon_loss: 268074.0028; val_gene_expr_recon_loss: 125344.9346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400748.5020; val_optim_loss: 400748.5020
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9848; val_auprc_score: 0.9836; val_best_acc_score: 0.9400; val_best_f1_score: 0.9406; train_kl_reg_loss: 7382.6499; train_edge_recon_loss: 263024.6657; train_gene_expr_recon_loss: 124535.7730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394943.0895; train_optim_loss: 394943.0895; val_kl_reg_loss: 7228.1664; val_edge_recon_loss: 267473.5503; val_gene_expr_recon_loss: 123846.7006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398548.4151; val_optim_loss: 398548.4151
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9849; val_best_acc_score: 0.9433; val_best_f1_score: 0.9439; train_kl_reg_loss: 7269.6500; train_edge_recon_loss: 262700.7457; train_gene_expr_recon_loss: 123439.1422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393409.5375; train_optim_loss: 393409.5375; val_kl_reg_loss: 7043.6677; val_edge_recon_loss: 266685.9922; val_gene_expr_recon_loss: 123002.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396732.3688; val_optim_loss: 396732.3688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9861; val_auprc_score: 0.9855; val_best_acc_score: 0.9430; val_best_f1_score: 0.9432; train_kl_reg_loss: 7225.3352; train_edge_recon_loss: 262397.7359; train_gene_expr_recon_loss: 122587.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392210.6385; train_optim_loss: 392210.6385; val_kl_reg_loss: 7063.3196; val_edge_recon_loss: 266758.4094; val_gene_expr_recon_loss: 122297.7520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396119.4801; val_optim_loss: 396119.4801
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9857; val_auprc_score: 0.9848; val_best_acc_score: 0.9424; val_best_f1_score: 0.9426; train_kl_reg_loss: 7178.0576; train_edge_recon_loss: 262165.7244; train_gene_expr_recon_loss: 121959.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391303.0058; train_optim_loss: 391303.0058; val_kl_reg_loss: 6958.6174; val_edge_recon_loss: 266586.8021; val_gene_expr_recon_loss: 121663.6180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395209.0381; val_optim_loss: 395209.0381
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9872; val_auprc_score: 0.9860; val_best_acc_score: 0.9459; val_best_f1_score: 0.9466; train_kl_reg_loss: 7141.6172; train_edge_recon_loss: 261929.8115; train_gene_expr_recon_loss: 121404.6985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390476.1273; train_optim_loss: 390476.1273; val_kl_reg_loss: 6894.2891; val_edge_recon_loss: 266558.6320; val_gene_expr_recon_loss: 121456.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394909.5412; val_optim_loss: 394909.5412
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9877; val_auprc_score: 0.9867; val_best_acc_score: 0.9464; val_best_f1_score: 0.9468; train_kl_reg_loss: 7117.3653; train_edge_recon_loss: 261829.0856; train_gene_expr_recon_loss: 120983.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389930.2118; train_optim_loss: 389930.2118; val_kl_reg_loss: 6880.3029; val_edge_recon_loss: 266490.9462; val_gene_expr_recon_loss: 120885.8504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394257.1000; val_optim_loss: 394257.1000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9870; val_auprc_score: 0.9861; val_best_acc_score: 0.9452; val_best_f1_score: 0.9459; train_kl_reg_loss: 7097.2608; train_edge_recon_loss: 261599.4336; train_gene_expr_recon_loss: 120701.2818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389397.9770; train_optim_loss: 389397.9770; val_kl_reg_loss: 6930.3653; val_edge_recon_loss: 266269.2778; val_gene_expr_recon_loss: 120765.2849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393964.9261; val_optim_loss: 393964.9261
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9872; val_auprc_score: 0.9862; val_best_acc_score: 0.9467; val_best_f1_score: 0.9468; train_kl_reg_loss: 7093.4336; train_edge_recon_loss: 261366.7616; train_gene_expr_recon_loss: 120314.6943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388774.8892; train_optim_loss: 388774.8892; val_kl_reg_loss: 6979.9569; val_edge_recon_loss: 266055.6750; val_gene_expr_recon_loss: 120563.9369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393599.5682; val_optim_loss: 393599.5682
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9881; val_auprc_score: 0.9868; val_best_acc_score: 0.9485; val_best_f1_score: 0.9487; train_kl_reg_loss: 7066.8954; train_edge_recon_loss: 261493.0529; train_gene_expr_recon_loss: 120117.8327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388677.7808; train_optim_loss: 388677.7808; val_kl_reg_loss: 6885.7712; val_edge_recon_loss: 265891.7338; val_gene_expr_recon_loss: 120456.2245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393233.7284; val_optim_loss: 393233.7284
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9878; val_auprc_score: 0.9870; val_best_acc_score: 0.9477; val_best_f1_score: 0.9480; train_kl_reg_loss: 7066.1012; train_edge_recon_loss: 261206.0804; train_gene_expr_recon_loss: 119949.5149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388221.6964; train_optim_loss: 388221.6964; val_kl_reg_loss: 6937.1270; val_edge_recon_loss: 265830.2490; val_gene_expr_recon_loss: 120317.5289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393084.9060; val_optim_loss: 393084.9060
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9873; val_auprc_score: 0.9863; val_best_acc_score: 0.9474; val_best_f1_score: 0.9476; train_kl_reg_loss: 7060.2233; train_edge_recon_loss: 261157.9745; train_gene_expr_recon_loss: 119762.9387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387981.1372; train_optim_loss: 387981.1372; val_kl_reg_loss: 6926.8648; val_edge_recon_loss: 265944.8396; val_gene_expr_recon_loss: 119945.1293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392816.8341; val_optim_loss: 392816.8341
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9875; val_auprc_score: 0.9867; val_best_acc_score: 0.9466; val_best_f1_score: 0.9469; train_kl_reg_loss: 7045.4497; train_edge_recon_loss: 261194.0578; train_gene_expr_recon_loss: 119625.1518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387864.6596; train_optim_loss: 387864.6596; val_kl_reg_loss: 7021.2419; val_edge_recon_loss: 265883.6327; val_gene_expr_recon_loss: 119996.3186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392901.1926; val_optim_loss: 392901.1926
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9880; val_auprc_score: 0.9870; val_best_acc_score: 0.9485; val_best_f1_score: 0.9488; train_kl_reg_loss: 7053.2405; train_edge_recon_loss: 261047.5681; train_gene_expr_recon_loss: 119495.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387596.7249; train_optim_loss: 387596.7249; val_kl_reg_loss: 7001.7556; val_edge_recon_loss: 265835.1774; val_gene_expr_recon_loss: 119659.1826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392496.1176; val_optim_loss: 392496.1176
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9877; val_best_acc_score: 0.9507; val_best_f1_score: 0.9511; train_kl_reg_loss: 7037.0653; train_edge_recon_loss: 261074.2309; train_gene_expr_recon_loss: 119308.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387419.6751; train_optim_loss: 387419.6751; val_kl_reg_loss: 6833.5352; val_edge_recon_loss: 266105.2683; val_gene_expr_recon_loss: 119780.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392719.0631; val_optim_loss: 392719.0631
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9882; val_best_acc_score: 0.9512; val_best_f1_score: 0.9514; train_kl_reg_loss: 7047.1358; train_edge_recon_loss: 260985.7841; train_gene_expr_recon_loss: 119250.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387283.3687; train_optim_loss: 387283.3687; val_kl_reg_loss: 6986.8913; val_edge_recon_loss: 265656.7347; val_gene_expr_recon_loss: 119631.7232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392275.3500; val_optim_loss: 392275.3500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9884; val_auprc_score: 0.9873; val_best_acc_score: 0.9500; val_best_f1_score: 0.9504; train_kl_reg_loss: 7044.4446; train_edge_recon_loss: 260842.6468; train_gene_expr_recon_loss: 119141.2655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387028.3573; train_optim_loss: 387028.3573; val_kl_reg_loss: 6980.4106; val_edge_recon_loss: 265953.9283; val_gene_expr_recon_loss: 119425.7652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392360.1045; val_optim_loss: 392360.1045
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9875; val_best_acc_score: 0.9502; val_best_f1_score: 0.9507; train_kl_reg_loss: 7039.4810; train_edge_recon_loss: 260853.8324; train_gene_expr_recon_loss: 119062.4482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386955.7616; train_optim_loss: 386955.7616; val_kl_reg_loss: 6880.3547; val_edge_recon_loss: 265580.8906; val_gene_expr_recon_loss: 119111.8339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391573.0790; val_optim_loss: 391573.0790
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9888; val_auprc_score: 0.9878; val_best_acc_score: 0.9505; val_best_f1_score: 0.9510; train_kl_reg_loss: 7039.3488; train_edge_recon_loss: 260797.4941; train_gene_expr_recon_loss: 119006.6727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386843.5156; train_optim_loss: 386843.5156; val_kl_reg_loss: 6994.2380; val_edge_recon_loss: 265433.5038; val_gene_expr_recon_loss: 119374.0606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391801.8014; val_optim_loss: 391801.8014
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9891; val_auprc_score: 0.9881; val_best_acc_score: 0.9512; val_best_f1_score: 0.9515; train_kl_reg_loss: 7037.5460; train_edge_recon_loss: 260719.4213; train_gene_expr_recon_loss: 118890.9439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386647.9121; train_optim_loss: 386647.9121; val_kl_reg_loss: 6893.4339; val_edge_recon_loss: 265420.6675; val_gene_expr_recon_loss: 119302.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391616.7060; val_optim_loss: 391616.7060
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9890; val_auprc_score: 0.9877; val_best_acc_score: 0.9512; val_best_f1_score: 0.9515; train_kl_reg_loss: 7032.8089; train_edge_recon_loss: 260666.8676; train_gene_expr_recon_loss: 118847.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386546.7675; train_optim_loss: 386546.7675; val_kl_reg_loss: 6910.7968; val_edge_recon_loss: 265498.9283; val_gene_expr_recon_loss: 119079.8998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391489.6253; val_optim_loss: 391489.6253
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9892; val_auprc_score: 0.9885; val_best_acc_score: 0.9507; val_best_f1_score: 0.9510; train_kl_reg_loss: 7035.7617; train_edge_recon_loss: 260599.0041; train_gene_expr_recon_loss: 118780.3499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386415.1159; train_optim_loss: 386415.1159; val_kl_reg_loss: 6952.2674; val_edge_recon_loss: 265438.2682; val_gene_expr_recon_loss: 119115.8167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391506.3511; val_optim_loss: 391506.3511
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9895; val_auprc_score: 0.9887; val_best_acc_score: 0.9515; val_best_f1_score: 0.9517; train_kl_reg_loss: 7032.6270; train_edge_recon_loss: 260685.7583; train_gene_expr_recon_loss: 118689.0901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386407.4751; train_optim_loss: 386407.4751; val_kl_reg_loss: 6815.2279; val_edge_recon_loss: 265179.2605; val_gene_expr_recon_loss: 118993.2476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390987.7341; val_optim_loss: 390987.7341
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9890; val_auprc_score: 0.9880; val_best_acc_score: 0.9514; val_best_f1_score: 0.9516; train_kl_reg_loss: 7027.5135; train_edge_recon_loss: 260628.0063; train_gene_expr_recon_loss: 118632.2013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386287.7217; train_optim_loss: 386287.7217; val_kl_reg_loss: 6982.5337; val_edge_recon_loss: 265351.2036; val_gene_expr_recon_loss: 118903.8993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391237.6330; val_optim_loss: 391237.6330
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9526; val_best_f1_score: 0.9530; train_kl_reg_loss: 7022.7677; train_edge_recon_loss: 260630.3495; train_gene_expr_recon_loss: 118588.2297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386241.3472; train_optim_loss: 386241.3472; val_kl_reg_loss: 6905.6254; val_edge_recon_loss: 265326.2456; val_gene_expr_recon_loss: 118831.7103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391063.5804; val_optim_loss: 391063.5804
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9890; val_auprc_score: 0.9880; val_best_acc_score: 0.9515; val_best_f1_score: 0.9518; train_kl_reg_loss: 7028.9710; train_edge_recon_loss: 260560.3826; train_gene_expr_recon_loss: 118526.9604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386116.3137; train_optim_loss: 386116.3137; val_kl_reg_loss: 6954.7660; val_edge_recon_loss: 265398.4416; val_gene_expr_recon_loss: 118970.8076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391324.0148; val_optim_loss: 391324.0148
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9893; val_auprc_score: 0.9883; val_best_acc_score: 0.9518; val_best_f1_score: 0.9523; train_kl_reg_loss: 7028.9713; train_edge_recon_loss: 260469.4775; train_gene_expr_recon_loss: 118484.8617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385983.3108; train_optim_loss: 385983.3108; val_kl_reg_loss: 6821.1097; val_edge_recon_loss: 265307.4162; val_gene_expr_recon_loss: 118991.8578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391120.3824; val_optim_loss: 391120.3824

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9899; val_auprc_score: 0.9890; val_best_acc_score: 0.9536; val_best_f1_score: 0.9537; train_kl_reg_loss: 7012.1097; train_edge_recon_loss: 260165.5530; train_gene_expr_recon_loss: 117478.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384655.8788; train_optim_loss: 384655.8788; val_kl_reg_loss: 6878.3918; val_edge_recon_loss: 265008.8374; val_gene_expr_recon_loss: 117894.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389782.0923; val_optim_loss: 389782.0923
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9896; val_auprc_score: 0.9884; val_best_acc_score: 0.9534; val_best_f1_score: 0.9535; train_kl_reg_loss: 7009.7414; train_edge_recon_loss: 260163.0910; train_gene_expr_recon_loss: 117349.9628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384522.7957; train_optim_loss: 384522.7957; val_kl_reg_loss: 6879.8868; val_edge_recon_loss: 265239.8604; val_gene_expr_recon_loss: 117876.7079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389996.4545; val_optim_loss: 389996.4545
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9899; val_auprc_score: 0.9888; val_best_acc_score: 0.9537; val_best_f1_score: 0.9538; train_kl_reg_loss: 7010.4154; train_edge_recon_loss: 260080.5235; train_gene_expr_recon_loss: 117273.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384364.0207; train_optim_loss: 384364.0207; val_kl_reg_loss: 6858.4791; val_edge_recon_loss: 265083.5173; val_gene_expr_recon_loss: 117717.4410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389659.4361; val_optim_loss: 389659.4361
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9899; val_auprc_score: 0.9890; val_best_acc_score: 0.9537; val_best_f1_score: 0.9540; train_kl_reg_loss: 6996.7181; train_edge_recon_loss: 260095.8796; train_gene_expr_recon_loss: 117248.0584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384340.6563; train_optim_loss: 384340.6563; val_kl_reg_loss: 6892.7663; val_edge_recon_loss: 265039.3166; val_gene_expr_recon_loss: 117855.6712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389787.7557; val_optim_loss: 389787.7557
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9904; val_auprc_score: 0.9894; val_best_acc_score: 0.9548; val_best_f1_score: 0.9549; train_kl_reg_loss: 6995.3869; train_edge_recon_loss: 260096.0903; train_gene_expr_recon_loss: 117255.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384346.7288; train_optim_loss: 384346.7288; val_kl_reg_loss: 6876.9005; val_edge_recon_loss: 264715.5324; val_gene_expr_recon_loss: 117863.6704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389456.1023; val_optim_loss: 389456.1023
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9904; val_auprc_score: 0.9896; val_best_acc_score: 0.9553; val_best_f1_score: 0.9554; train_kl_reg_loss: 6986.7013; train_edge_recon_loss: 260048.8076; train_gene_expr_recon_loss: 117217.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384252.8561; train_optim_loss: 384252.8561; val_kl_reg_loss: 6860.3302; val_edge_recon_loss: 264510.1385; val_gene_expr_recon_loss: 117788.6513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389159.1190; val_optim_loss: 389159.1190
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9903; val_auprc_score: 0.9896; val_best_acc_score: 0.9537; val_best_f1_score: 0.9541; train_kl_reg_loss: 6975.0322; train_edge_recon_loss: 260157.2996; train_gene_expr_recon_loss: 117174.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384306.9787; train_optim_loss: 384306.9787; val_kl_reg_loss: 6870.5695; val_edge_recon_loss: 265032.3024; val_gene_expr_recon_loss: 117865.2747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389768.1466; val_optim_loss: 389768.1466
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9904; val_auprc_score: 0.9896; val_best_acc_score: 0.9545; val_best_f1_score: 0.9546; train_kl_reg_loss: 6972.6536; train_edge_recon_loss: 260142.0320; train_gene_expr_recon_loss: 117176.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384291.1891; train_optim_loss: 384291.1891; val_kl_reg_loss: 6840.6733; val_edge_recon_loss: 264847.9452; val_gene_expr_recon_loss: 117708.0927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389396.7119; val_optim_loss: 389396.7119
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9904; val_auprc_score: 0.9896; val_best_acc_score: 0.9543; val_best_f1_score: 0.9545; train_kl_reg_loss: 6964.7000; train_edge_recon_loss: 260063.7586; train_gene_expr_recon_loss: 117178.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384206.5222; train_optim_loss: 384206.5222; val_kl_reg_loss: 6869.4054; val_edge_recon_loss: 264906.7153; val_gene_expr_recon_loss: 117692.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389469.0861; val_optim_loss: 389469.0861
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9904; val_auprc_score: 0.9893; val_best_acc_score: 0.9545; val_best_f1_score: 0.9548; train_kl_reg_loss: 6969.5133; train_edge_recon_loss: 260113.2780; train_gene_expr_recon_loss: 117135.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384218.5510; train_optim_loss: 384218.5510; val_kl_reg_loss: 6844.3905; val_edge_recon_loss: 264554.7872; val_gene_expr_recon_loss: 117641.4925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389040.6699; val_optim_loss: 389040.6699
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9903; val_auprc_score: 0.9892; val_best_acc_score: 0.9549; val_best_f1_score: 0.9551; train_kl_reg_loss: 6965.1244; train_edge_recon_loss: 260057.5815; train_gene_expr_recon_loss: 117117.4082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384140.1145; train_optim_loss: 384140.1145; val_kl_reg_loss: 6856.1603; val_edge_recon_loss: 264853.8709; val_gene_expr_recon_loss: 117793.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389503.3753; val_optim_loss: 389503.3753
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9906; val_auprc_score: 0.9893; val_best_acc_score: 0.9554; val_best_f1_score: 0.9555; train_kl_reg_loss: 6967.2875; train_edge_recon_loss: 260067.0136; train_gene_expr_recon_loss: 117092.0041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384126.3045; train_optim_loss: 384126.3045; val_kl_reg_loss: 6851.0929; val_edge_recon_loss: 264711.9801; val_gene_expr_recon_loss: 117684.5775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389247.6491; val_optim_loss: 389247.6491
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9906; val_auprc_score: 0.9894; val_best_acc_score: 0.9555; val_best_f1_score: 0.9556; train_kl_reg_loss: 6959.9044; train_edge_recon_loss: 260050.9158; train_gene_expr_recon_loss: 117108.5080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384119.3287; train_optim_loss: 384119.3287; val_kl_reg_loss: 6830.5706; val_edge_recon_loss: 264766.8310; val_gene_expr_recon_loss: 117597.3224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389194.7253; val_optim_loss: 389194.7253
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9906; val_auprc_score: 0.9897; val_best_acc_score: 0.9553; val_best_f1_score: 0.9554; train_kl_reg_loss: 6961.0106; train_edge_recon_loss: 260000.4585; train_gene_expr_recon_loss: 117072.4335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384033.9022; train_optim_loss: 384033.9022; val_kl_reg_loss: 6875.4690; val_edge_recon_loss: 264668.7572; val_gene_expr_recon_loss: 117715.0684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389259.2940; val_optim_loss: 389259.2940

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9905; val_auprc_score: 0.9895; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 6959.2628; train_edge_recon_loss: 259960.9756; train_gene_expr_recon_loss: 116953.6278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383873.8663; train_optim_loss: 383873.8663; val_kl_reg_loss: 6842.2898; val_edge_recon_loss: 264490.8707; val_gene_expr_recon_loss: 117586.6630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388919.8227; val_optim_loss: 388919.8227
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9895; val_best_acc_score: 0.9556; val_best_f1_score: 0.9558; train_kl_reg_loss: 6950.4174; train_edge_recon_loss: 260032.6868; train_gene_expr_recon_loss: 116959.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383942.4779; train_optim_loss: 383942.4779; val_kl_reg_loss: 6850.0022; val_edge_recon_loss: 265043.7786; val_gene_expr_recon_loss: 117518.9411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389412.7219; val_optim_loss: 389412.7219
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9907; val_auprc_score: 0.9898; val_best_acc_score: 0.9553; val_best_f1_score: 0.9556; train_kl_reg_loss: 6953.8833; train_edge_recon_loss: 259949.4133; train_gene_expr_recon_loss: 116922.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383825.6781; train_optim_loss: 383825.6781; val_kl_reg_loss: 6846.4722; val_edge_recon_loss: 264950.5506; val_gene_expr_recon_loss: 117593.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389390.2332; val_optim_loss: 389390.2332
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9903; val_auprc_score: 0.9893; val_best_acc_score: 0.9553; val_best_f1_score: 0.9554; train_kl_reg_loss: 6950.5700; train_edge_recon_loss: 259948.9053; train_gene_expr_recon_loss: 116944.1148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383843.5897; train_optim_loss: 383843.5897; val_kl_reg_loss: 6843.9871; val_edge_recon_loss: 264933.6983; val_gene_expr_recon_loss: 117475.1653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389252.8520; val_optim_loss: 389252.8520
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9904; val_auprc_score: 0.9894; val_best_acc_score: 0.9549; val_best_f1_score: 0.9551; train_kl_reg_loss: 6951.4422; train_edge_recon_loss: 259985.9230; train_gene_expr_recon_loss: 116951.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383889.3130; train_optim_loss: 383889.3130; val_kl_reg_loss: 6846.3054; val_edge_recon_loss: 265017.6068; val_gene_expr_recon_loss: 117478.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389342.5176; val_optim_loss: 389342.5176

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9908; val_auprc_score: 0.9901; val_best_acc_score: 0.9555; val_best_f1_score: 0.9556; train_kl_reg_loss: 6951.8578; train_edge_recon_loss: 260004.9277; train_gene_expr_recon_loss: 116889.7104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383846.4961; train_optim_loss: 383846.4961; val_kl_reg_loss: 6839.1885; val_edge_recon_loss: 265048.7276; val_gene_expr_recon_loss: 117457.6561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389345.5716; val_optim_loss: 389345.5716
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9545; val_best_f1_score: 0.9548; train_kl_reg_loss: 6949.8413; train_edge_recon_loss: 260049.7383; train_gene_expr_recon_loss: 116890.3256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383889.9053; train_optim_loss: 383889.9053; val_kl_reg_loss: 6835.1351; val_edge_recon_loss: 264825.7714; val_gene_expr_recon_loss: 117509.5161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389170.4250; val_optim_loss: 389170.4250
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9905; val_auprc_score: 0.9896; val_best_acc_score: 0.9554; val_best_f1_score: 0.9556; train_kl_reg_loss: 6948.5390; train_edge_recon_loss: 259991.5954; train_gene_expr_recon_loss: 116915.4371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383855.5718; train_optim_loss: 383855.5718; val_kl_reg_loss: 6841.9369; val_edge_recon_loss: 264744.4182; val_gene_expr_recon_loss: 117515.5018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389101.8543; val_optim_loss: 389101.8543
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9905; val_auprc_score: 0.9895; val_best_acc_score: 0.9548; val_best_f1_score: 0.9550; train_kl_reg_loss: 6949.6765; train_edge_recon_loss: 260103.0925; train_gene_expr_recon_loss: 116902.5161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383955.2852; train_optim_loss: 383955.2852; val_kl_reg_loss: 6832.8017; val_edge_recon_loss: 265015.6281; val_gene_expr_recon_loss: 117444.7440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389293.1744; val_optim_loss: 389293.1744

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 167 min 6 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9903
Val AUPRC score: 0.9892
Val best accuracy score: 0.9553
Val best F1 score: 0.9555
Val gene expr MSE score: 9.0752

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
