None
Run timestamp: 28062023_235123_37.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_37']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9748; val_auprc_score: 0.9683; val_best_acc_score: 0.9271; val_best_f1_score: 0.9298; train_kl_reg_loss: 6299.5259; train_edge_recon_loss: 266848.3258; train_gene_expr_recon_loss: 13370.8525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286518.7048; train_optim_loss: 286518.7048; val_kl_reg_loss: 6327.8152; val_edge_recon_loss: 263113.0074; val_gene_expr_recon_loss: 12784.6329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282225.4561; val_optim_loss: 282225.4561
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9797; val_auprc_score: 0.9747; val_best_acc_score: 0.9362; val_best_f1_score: 0.9378; train_kl_reg_loss: 6395.9863; train_edge_recon_loss: 262009.4263; train_gene_expr_recon_loss: 12675.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281080.4875; train_optim_loss: 281080.4875; val_kl_reg_loss: 6319.9972; val_edge_recon_loss: 262264.2088; val_gene_expr_recon_loss: 12479.5480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281063.7532; val_optim_loss: 281063.7532
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9848; val_auprc_score: 0.9812; val_best_acc_score: 0.9460; val_best_f1_score: 0.9471; train_kl_reg_loss: 6410.5949; train_edge_recon_loss: 261409.1682; train_gene_expr_recon_loss: 12482.2420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280302.0052; train_optim_loss: 280302.0052; val_kl_reg_loss: 6430.7544; val_edge_recon_loss: 261599.1119; val_gene_expr_recon_loss: 12317.5207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280347.3876; val_optim_loss: 280347.3876
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9821; val_best_acc_score: 0.9488; val_best_f1_score: 0.9498; train_kl_reg_loss: 6412.3488; train_edge_recon_loss: 260959.9416; train_gene_expr_recon_loss: 12398.7904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279771.0806; train_optim_loss: 279771.0806; val_kl_reg_loss: 6210.8984; val_edge_recon_loss: 261325.1140; val_gene_expr_recon_loss: 12283.3188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279819.3311; val_optim_loss: 279819.3311
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9858; val_auprc_score: 0.9820; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 6411.4163; train_edge_recon_loss: 260651.5951; train_gene_expr_recon_loss: 12348.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279411.5916; train_optim_loss: 279411.5916; val_kl_reg_loss: 6315.7005; val_edge_recon_loss: 260821.1263; val_gene_expr_recon_loss: 12262.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279399.1107; val_optim_loss: 279399.1107
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9860; val_auprc_score: 0.9823; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 6414.1728; train_edge_recon_loss: 260340.4606; train_gene_expr_recon_loss: 12325.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279080.2472; train_optim_loss: 279080.2472; val_kl_reg_loss: 6233.7455; val_edge_recon_loss: 261243.2564; val_gene_expr_recon_loss: 12216.8034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279693.8052; val_optim_loss: 279693.8052
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9883; val_auprc_score: 0.9851; val_best_acc_score: 0.9556; val_best_f1_score: 0.9562; train_kl_reg_loss: 6417.5430; train_edge_recon_loss: 260174.2093; train_gene_expr_recon_loss: 12301.2394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278892.9923; train_optim_loss: 278892.9923; val_kl_reg_loss: 6273.2463; val_edge_recon_loss: 260823.5274; val_gene_expr_recon_loss: 12174.9220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279271.6969; val_optim_loss: 279271.6969
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9886; val_auprc_score: 0.9857; val_best_acc_score: 0.9566; val_best_f1_score: 0.9573; train_kl_reg_loss: 6418.7225; train_edge_recon_loss: 259968.5129; train_gene_expr_recon_loss: 12282.3318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278669.5673; train_optim_loss: 278669.5673; val_kl_reg_loss: 6276.2769; val_edge_recon_loss: 260498.1888; val_gene_expr_recon_loss: 12218.2711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278992.7352; val_optim_loss: 278992.7352
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9570; val_best_f1_score: 0.9578; train_kl_reg_loss: 6415.6882; train_edge_recon_loss: 259956.0626; train_gene_expr_recon_loss: 12274.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278646.6211; train_optim_loss: 278646.6211; val_kl_reg_loss: 6417.2507; val_edge_recon_loss: 260170.0240; val_gene_expr_recon_loss: 12205.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278792.7755; val_optim_loss: 278792.7755
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9900; val_auprc_score: 0.9873; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 6419.1220; train_edge_recon_loss: 259776.7235; train_gene_expr_recon_loss: 12267.2979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278463.1433; train_optim_loss: 278463.1433; val_kl_reg_loss: 6507.9386; val_edge_recon_loss: 260303.4466; val_gene_expr_recon_loss: 12215.8733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279027.2588; val_optim_loss: 279027.2588
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9896; val_auprc_score: 0.9866; val_best_acc_score: 0.9599; val_best_f1_score: 0.9606; train_kl_reg_loss: 6419.7198; train_edge_recon_loss: 259705.0316; train_gene_expr_recon_loss: 12269.7120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278394.4632; train_optim_loss: 278394.4632; val_kl_reg_loss: 6406.7005; val_edge_recon_loss: 260080.2914; val_gene_expr_recon_loss: 12184.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278671.7857; val_optim_loss: 278671.7857
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9899; val_auprc_score: 0.9870; val_best_acc_score: 0.9601; val_best_f1_score: 0.9607; train_kl_reg_loss: 6424.3009; train_edge_recon_loss: 259465.0578; train_gene_expr_recon_loss: 12261.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278150.4183; train_optim_loss: 278150.4183; val_kl_reg_loss: 6312.5437; val_edge_recon_loss: 259986.0277; val_gene_expr_recon_loss: 12188.8383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278487.4086; val_optim_loss: 278487.4086
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9607; val_best_f1_score: 0.9615; train_kl_reg_loss: 6418.3589; train_edge_recon_loss: 259581.9282; train_gene_expr_recon_loss: 12260.1569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278260.4440; train_optim_loss: 278260.4440; val_kl_reg_loss: 6239.2080; val_edge_recon_loss: 259664.8077; val_gene_expr_recon_loss: 12210.2015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278114.2181; val_optim_loss: 278114.2181
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9907; val_auprc_score: 0.9881; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 6420.4575; train_edge_recon_loss: 259350.2802; train_gene_expr_recon_loss: 12254.7447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278025.4827; train_optim_loss: 278025.4827; val_kl_reg_loss: 6371.6446; val_edge_recon_loss: 259827.1304; val_gene_expr_recon_loss: 12175.4211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278374.1950; val_optim_loss: 278374.1950
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9887; val_best_acc_score: 0.9632; val_best_f1_score: 0.9637; train_kl_reg_loss: 6425.8942; train_edge_recon_loss: 259282.0861; train_gene_expr_recon_loss: 12246.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277954.9511; train_optim_loss: 277954.9511; val_kl_reg_loss: 6443.9801; val_edge_recon_loss: 259649.0997; val_gene_expr_recon_loss: 12186.9733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278280.0531; val_optim_loss: 278280.0531
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9913; val_auprc_score: 0.9890; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 6426.5189; train_edge_recon_loss: 259318.1749; train_gene_expr_recon_loss: 12245.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277989.7618; train_optim_loss: 277989.7618; val_kl_reg_loss: 6516.1623; val_edge_recon_loss: 259662.0764; val_gene_expr_recon_loss: 12188.3781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278366.6167; val_optim_loss: 278366.6167
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 6426.6590; train_edge_recon_loss: 259264.4380; train_gene_expr_recon_loss: 12245.7233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277936.8203; train_optim_loss: 277936.8203; val_kl_reg_loss: 6331.5052; val_edge_recon_loss: 259320.1693; val_gene_expr_recon_loss: 12176.1494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277827.8238; val_optim_loss: 277827.8238
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9649; val_best_f1_score: 0.9652; train_kl_reg_loss: 6428.0623; train_edge_recon_loss: 259219.1161; train_gene_expr_recon_loss: 12246.5584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277893.7365; train_optim_loss: 277893.7365; val_kl_reg_loss: 6404.9830; val_edge_recon_loss: 259460.1114; val_gene_expr_recon_loss: 12172.1764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278037.2708; val_optim_loss: 278037.2708
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 6426.4394; train_edge_recon_loss: 259163.7334; train_gene_expr_recon_loss: 12245.9575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277836.1316; train_optim_loss: 277836.1316; val_kl_reg_loss: 6391.0714; val_edge_recon_loss: 259387.1484; val_gene_expr_recon_loss: 12183.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277961.7440; val_optim_loss: 277961.7440
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9914; val_auprc_score: 0.9886; val_best_acc_score: 0.9653; val_best_f1_score: 0.9657; train_kl_reg_loss: 6425.1094; train_edge_recon_loss: 259070.6101; train_gene_expr_recon_loss: 12241.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277737.2390; train_optim_loss: 277737.2390; val_kl_reg_loss: 6392.3170; val_edge_recon_loss: 259212.5340; val_gene_expr_recon_loss: 12167.4678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277772.3183; val_optim_loss: 277772.3183
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9650; val_best_f1_score: 0.9655; train_kl_reg_loss: 6436.4383; train_edge_recon_loss: 259010.0345; train_gene_expr_recon_loss: 12241.9529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277688.4257; train_optim_loss: 277688.4257; val_kl_reg_loss: 6355.6799; val_edge_recon_loss: 259141.4594; val_gene_expr_recon_loss: 12192.0330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277689.1723; val_optim_loss: 277689.1723
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9921; val_auprc_score: 0.9896; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 6427.8354; train_edge_recon_loss: 258986.5944; train_gene_expr_recon_loss: 12237.6774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277652.1074; train_optim_loss: 277652.1074; val_kl_reg_loss: 6308.8655; val_edge_recon_loss: 259078.3322; val_gene_expr_recon_loss: 12166.6006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277553.7975; val_optim_loss: 277553.7975
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9890; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 6430.4095; train_edge_recon_loss: 258973.4369; train_gene_expr_recon_loss: 12232.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277636.8084; train_optim_loss: 277636.8084; val_kl_reg_loss: 6495.6420; val_edge_recon_loss: 259238.2156; val_gene_expr_recon_loss: 12179.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277913.0809; val_optim_loss: 277913.0809
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 6434.8543; train_edge_recon_loss: 258867.3955; train_gene_expr_recon_loss: 12237.4278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277539.6768; train_optim_loss: 277539.6768; val_kl_reg_loss: 6407.3421; val_edge_recon_loss: 259364.0538; val_gene_expr_recon_loss: 12181.0178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277952.4129; val_optim_loss: 277952.4129
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9897; val_best_acc_score: 0.9676; val_best_f1_score: 0.9682; train_kl_reg_loss: 6431.6336; train_edge_recon_loss: 258796.5206; train_gene_expr_recon_loss: 12234.4877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277462.6419; train_optim_loss: 277462.6419; val_kl_reg_loss: 6419.8318; val_edge_recon_loss: 259125.0157; val_gene_expr_recon_loss: 12169.1670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277714.0146; val_optim_loss: 277714.0146
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 6430.9507; train_edge_recon_loss: 258866.1462; train_gene_expr_recon_loss: 12235.1671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277532.2640; train_optim_loss: 277532.2640; val_kl_reg_loss: 6452.1982; val_edge_recon_loss: 258899.0308; val_gene_expr_recon_loss: 12154.6082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277505.8380; val_optim_loss: 277505.8380
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9921; val_auprc_score: 0.9897; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 6437.1359; train_edge_recon_loss: 258809.6284; train_gene_expr_recon_loss: 12233.9220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277480.6860; train_optim_loss: 277480.6860; val_kl_reg_loss: 6421.1272; val_edge_recon_loss: 259058.4205; val_gene_expr_recon_loss: 12153.7667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277633.3151; val_optim_loss: 277633.3151
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9927; val_auprc_score: 0.9902; val_best_acc_score: 0.9687; val_best_f1_score: 0.9690; train_kl_reg_loss: 6434.0413; train_edge_recon_loss: 258870.3191; train_gene_expr_recon_loss: 12231.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277535.7916; train_optim_loss: 277535.7916; val_kl_reg_loss: 6387.5134; val_edge_recon_loss: 259198.1092; val_gene_expr_recon_loss: 12150.1769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277735.8020; val_optim_loss: 277735.8020
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9926; val_auprc_score: 0.9901; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 6433.3751; train_edge_recon_loss: 258766.7618; train_gene_expr_recon_loss: 12224.9808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277425.1174; train_optim_loss: 277425.1174; val_kl_reg_loss: 6524.0597; val_edge_recon_loss: 258966.8016; val_gene_expr_recon_loss: 12177.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277668.6139; val_optim_loss: 277668.6139
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9921; val_auprc_score: 0.9897; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 6438.3879; train_edge_recon_loss: 258711.0475; train_gene_expr_recon_loss: 12225.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277375.3382; train_optim_loss: 277375.3382; val_kl_reg_loss: 6354.8252; val_edge_recon_loss: 258896.1527; val_gene_expr_recon_loss: 12156.4380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277407.4159; val_optim_loss: 277407.4159
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9928; val_auprc_score: 0.9907; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 6439.6081; train_edge_recon_loss: 258701.5275; train_gene_expr_recon_loss: 12231.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277372.8329; train_optim_loss: 277372.8329; val_kl_reg_loss: 6451.8146; val_edge_recon_loss: 258737.0204; val_gene_expr_recon_loss: 12163.6399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277352.4756; val_optim_loss: 277352.4756
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9926; val_auprc_score: 0.9904; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 6435.8428; train_edge_recon_loss: 258641.3062; train_gene_expr_recon_loss: 12226.9343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277304.0830; train_optim_loss: 277304.0830; val_kl_reg_loss: 6503.7189; val_edge_recon_loss: 258457.6656; val_gene_expr_recon_loss: 12155.6943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277117.0777; val_optim_loss: 277117.0777
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 6438.7822; train_edge_recon_loss: 258770.7508; train_gene_expr_recon_loss: 12231.4924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277441.0259; train_optim_loss: 277441.0259; val_kl_reg_loss: 6488.5975; val_edge_recon_loss: 258497.6267; val_gene_expr_recon_loss: 12168.3284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277154.5531; val_optim_loss: 277154.5531
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 6436.6670; train_edge_recon_loss: 258592.7288; train_gene_expr_recon_loss: 12229.0958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277258.4919; train_optim_loss: 277258.4919; val_kl_reg_loss: 6395.6794; val_edge_recon_loss: 258699.9092; val_gene_expr_recon_loss: 12184.0952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277279.6824; val_optim_loss: 277279.6824
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9930; val_auprc_score: 0.9908; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 6438.5031; train_edge_recon_loss: 258550.8884; train_gene_expr_recon_loss: 12229.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277218.6156; train_optim_loss: 277218.6156; val_kl_reg_loss: 6475.4668; val_edge_recon_loss: 258820.9848; val_gene_expr_recon_loss: 12147.4847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277443.9358; val_optim_loss: 277443.9358
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9928; val_auprc_score: 0.9904; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 6440.9675; train_edge_recon_loss: 258584.7838; train_gene_expr_recon_loss: 12225.6720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277251.4230; train_optim_loss: 277251.4230; val_kl_reg_loss: 6554.6703; val_edge_recon_loss: 258696.5961; val_gene_expr_recon_loss: 12182.5472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277433.8123; val_optim_loss: 277433.8123

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 6438.5718; train_edge_recon_loss: 258297.1152; train_gene_expr_recon_loss: 12058.2647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276793.9522; train_optim_loss: 276793.9522; val_kl_reg_loss: 6433.8410; val_edge_recon_loss: 258217.3991; val_gene_expr_recon_loss: 12016.2685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276667.5047; val_optim_loss: 276667.5047
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 6424.9102; train_edge_recon_loss: 258293.6669; train_gene_expr_recon_loss: 12054.7210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276773.2981; train_optim_loss: 276773.2981; val_kl_reg_loss: 6346.5732; val_edge_recon_loss: 258257.3431; val_gene_expr_recon_loss: 12006.1655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276610.0813; val_optim_loss: 276610.0813
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 6419.6400; train_edge_recon_loss: 258347.8755; train_gene_expr_recon_loss: 12049.0276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276816.5440; train_optim_loss: 276816.5440; val_kl_reg_loss: 6408.5765; val_edge_recon_loss: 258528.1624; val_gene_expr_recon_loss: 12000.7547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276937.4936; val_optim_loss: 276937.4936
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 6416.2677; train_edge_recon_loss: 258300.3293; train_gene_expr_recon_loss: 12047.8753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276764.4723; train_optim_loss: 276764.4723; val_kl_reg_loss: 6362.3811; val_edge_recon_loss: 258248.2807; val_gene_expr_recon_loss: 11995.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276605.9985; val_optim_loss: 276605.9985
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9934; val_auprc_score: 0.9912; val_best_acc_score: 0.9719; val_best_f1_score: 0.9723; train_kl_reg_loss: 6418.9482; train_edge_recon_loss: 258204.6232; train_gene_expr_recon_loss: 12047.4937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276671.0649; train_optim_loss: 276671.0649; val_kl_reg_loss: 6386.8508; val_edge_recon_loss: 258106.7547; val_gene_expr_recon_loss: 11980.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276473.6896; val_optim_loss: 276473.6896
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9934; val_auprc_score: 0.9912; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 6411.5415; train_edge_recon_loss: 258257.4564; train_gene_expr_recon_loss: 12046.9098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276715.9075; train_optim_loss: 276715.9075; val_kl_reg_loss: 6359.1208; val_edge_recon_loss: 258409.9850; val_gene_expr_recon_loss: 11984.9579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276754.0646; val_optim_loss: 276754.0646
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9932; val_auprc_score: 0.9908; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 6415.5921; train_edge_recon_loss: 258178.8973; train_gene_expr_recon_loss: 12044.2894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276638.7786; train_optim_loss: 276638.7786; val_kl_reg_loss: 6423.9303; val_edge_recon_loss: 258134.4244; val_gene_expr_recon_loss: 11997.8209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276556.1753; val_optim_loss: 276556.1753
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9935; val_auprc_score: 0.9913; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 6410.9845; train_edge_recon_loss: 258238.8155; train_gene_expr_recon_loss: 12041.6978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276691.4978; train_optim_loss: 276691.4978; val_kl_reg_loss: 6377.3049; val_edge_recon_loss: 258270.1226; val_gene_expr_recon_loss: 11993.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276640.7232; val_optim_loss: 276640.7232
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 6413.9168; train_edge_recon_loss: 258235.3832; train_gene_expr_recon_loss: 12038.9637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276688.2640; train_optim_loss: 276688.2640; val_kl_reg_loss: 6377.4059; val_edge_recon_loss: 258268.7851; val_gene_expr_recon_loss: 11986.5575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276632.7502; val_optim_loss: 276632.7502

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9936; val_auprc_score: 0.9913; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 6415.5112; train_edge_recon_loss: 258195.8599; train_gene_expr_recon_loss: 12024.9510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276636.3215; train_optim_loss: 276636.3215; val_kl_reg_loss: 6381.2709; val_edge_recon_loss: 258275.0131; val_gene_expr_recon_loss: 11972.1525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276628.4351; val_optim_loss: 276628.4351
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9938; val_auprc_score: 0.9917; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 6415.5941; train_edge_recon_loss: 258161.5007; train_gene_expr_recon_loss: 12021.0454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276598.1394; train_optim_loss: 276598.1394; val_kl_reg_loss: 6394.0011; val_edge_recon_loss: 258114.5287; val_gene_expr_recon_loss: 11989.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276498.2924; val_optim_loss: 276498.2924
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9933; val_auprc_score: 0.9910; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 6414.0497; train_edge_recon_loss: 258169.2136; train_gene_expr_recon_loss: 12022.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276605.6499; train_optim_loss: 276605.6499; val_kl_reg_loss: 6380.0697; val_edge_recon_loss: 258534.2777; val_gene_expr_recon_loss: 11960.7126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276875.0608; val_optim_loss: 276875.0608
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 6410.0312; train_edge_recon_loss: 258222.6698; train_gene_expr_recon_loss: 12025.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276657.7067; train_optim_loss: 276657.7067; val_kl_reg_loss: 6381.5793; val_edge_recon_loss: 258199.6113; val_gene_expr_recon_loss: 11969.1572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276550.3474; val_optim_loss: 276550.3474

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 297 min 56 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9933
Val AUPRC score: 0.9912
Val best accuracy score: 0.9712
Val best F1 score: 0.9716
Val gene expr MSE score: 2.6657

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
