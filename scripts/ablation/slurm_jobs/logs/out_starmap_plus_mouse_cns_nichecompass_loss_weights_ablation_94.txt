None
Run timestamp: 08082023_212112_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9543; val_auprc_score: 0.9487; val_best_acc_score: 0.8856; val_best_f1_score: 0.8868; train_kl_reg_loss: 72150.6921; train_edge_recon_loss: 3145444.1535; train_gene_expr_recon_loss: 20835658.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 24053253.8370; train_optim_loss: 24053253.8370; val_kl_reg_loss: 75957.6825; val_edge_recon_loss: 2821937.8049; val_gene_expr_recon_loss: 19268418.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 22166314.1951; val_optim_loss: 22166314.1951
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9798; val_auprc_score: 0.9739; val_best_acc_score: 0.9388; val_best_f1_score: 0.9402; train_kl_reg_loss: 70751.2974; train_edge_recon_loss: 2737672.1216; train_gene_expr_recon_loss: 18847150.4348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 21655573.8859; train_optim_loss: 21655573.8859; val_kl_reg_loss: 65647.3668; val_edge_recon_loss: 2700912.2134; val_gene_expr_recon_loss: 18463195.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 21229755.1707; val_optim_loss: 21229755.1707
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9833; val_auprc_score: 0.9776; val_best_acc_score: 0.9486; val_best_f1_score: 0.9499; train_kl_reg_loss: 63449.3508; train_edge_recon_loss: 2675100.3730; train_gene_expr_recon_loss: 18189768.6630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20928318.3587; train_optim_loss: 20928318.3587; val_kl_reg_loss: 58357.7927; val_edge_recon_loss: 2667235.2134; val_gene_expr_recon_loss: 17979901.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20705494.7317; val_optim_loss: 20705494.7317
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9849; val_auprc_score: 0.9798; val_best_acc_score: 0.9521; val_best_f1_score: 0.9533; train_kl_reg_loss: 56769.8499; train_edge_recon_loss: 2655521.2289; train_gene_expr_recon_loss: 17779149.9592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20491441.0489; train_optim_loss: 20491441.0489; val_kl_reg_loss: 52920.6069; val_edge_recon_loss: 2661388.5427; val_gene_expr_recon_loss: 17629957.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20344266.1463; val_optim_loss: 20344266.1463
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9855; val_auprc_score: 0.9805; val_best_acc_score: 0.9536; val_best_f1_score: 0.9547; train_kl_reg_loss: 51732.6876; train_edge_recon_loss: 2645782.1365; train_gene_expr_recon_loss: 17449845.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20147360.2391; train_optim_loss: 20147360.2391; val_kl_reg_loss: 48841.7844; val_edge_recon_loss: 2650999.8902; val_gene_expr_recon_loss: 17346212.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20046054.6341; val_optim_loss: 20046054.6341
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9867; val_auprc_score: 0.9826; val_best_acc_score: 0.9552; val_best_f1_score: 0.9562; train_kl_reg_loss: 48074.5172; train_edge_recon_loss: 2637054.3770; train_gene_expr_recon_loss: 17207898.1630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19893027.0598; train_optim_loss: 19893027.0598; val_kl_reg_loss: 46095.2473; val_edge_recon_loss: 2642485.2744; val_gene_expr_recon_loss: 17160646.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19849226.7317; val_optim_loss: 19849226.7317
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9868; val_auprc_score: 0.9827; val_best_acc_score: 0.9557; val_best_f1_score: 0.9568; train_kl_reg_loss: 45165.5135; train_edge_recon_loss: 2631136.2602; train_gene_expr_recon_loss: 17015883.0353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19692184.7989; train_optim_loss: 19692184.7989; val_kl_reg_loss: 43282.5221; val_edge_recon_loss: 2639083.7317; val_gene_expr_recon_loss: 17007165.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19689531.3659; val_optim_loss: 19689531.3659
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9879; val_auprc_score: 0.9845; val_best_acc_score: 0.9577; val_best_f1_score: 0.9586; train_kl_reg_loss: 42947.8778; train_edge_recon_loss: 2627267.9219; train_gene_expr_recon_loss: 16860772.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19530988.5870; train_optim_loss: 19530988.5870; val_kl_reg_loss: 41032.5498; val_edge_recon_loss: 2635220.6890; val_gene_expr_recon_loss: 16901357.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19577610.6341; val_optim_loss: 19577610.6341
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9882; val_auprc_score: 0.9844; val_best_acc_score: 0.9586; val_best_f1_score: 0.9595; train_kl_reg_loss: 41182.4540; train_edge_recon_loss: 2625129.3967; train_gene_expr_recon_loss: 16720544.1549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19386856.0598; train_optim_loss: 19386856.0598; val_kl_reg_loss: 39947.8106; val_edge_recon_loss: 2632611.1098; val_gene_expr_recon_loss: 16754589.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19427148.8293; val_optim_loss: 19427148.8293
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9885; val_auprc_score: 0.9855; val_best_acc_score: 0.9587; val_best_f1_score: 0.9596; train_kl_reg_loss: 39927.3918; train_edge_recon_loss: 2620267.8091; train_gene_expr_recon_loss: 16616087.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19276283.1304; train_optim_loss: 19276283.1304; val_kl_reg_loss: 38999.9340; val_edge_recon_loss: 2632000.7927; val_gene_expr_recon_loss: 16715908.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19386909.2683; val_optim_loss: 19386909.2683
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9886; val_auprc_score: 0.9851; val_best_acc_score: 0.9596; val_best_f1_score: 0.9604; train_kl_reg_loss: 38911.8565; train_edge_recon_loss: 2616301.4001; train_gene_expr_recon_loss: 16528420.4511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19183633.6793; train_optim_loss: 19183633.6793; val_kl_reg_loss: 38211.7069; val_edge_recon_loss: 2630284.8049; val_gene_expr_recon_loss: 16622124.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19290621.0244; val_optim_loss: 19290621.0244
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9890; val_auprc_score: 0.9859; val_best_acc_score: 0.9602; val_best_f1_score: 0.9610; train_kl_reg_loss: 38102.0496; train_edge_recon_loss: 2615110.5795; train_gene_expr_recon_loss: 16439617.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19092830.5978; train_optim_loss: 19092830.5978; val_kl_reg_loss: 37116.8853; val_edge_recon_loss: 2625140.2866; val_gene_expr_recon_loss: 16597335.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19259592.1951; val_optim_loss: 19259592.1951
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9889; val_auprc_score: 0.9859; val_best_acc_score: 0.9604; val_best_f1_score: 0.9611; train_kl_reg_loss: 37321.1712; train_edge_recon_loss: 2613678.0836; train_gene_expr_recon_loss: 16377040.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19028039.4620; train_optim_loss: 19028039.4620; val_kl_reg_loss: 36580.2660; val_edge_recon_loss: 2624061.5915; val_gene_expr_recon_loss: 16554315.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19214957.3171; val_optim_loss: 19214957.3171
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9887; val_auprc_score: 0.9854; val_best_acc_score: 0.9600; val_best_f1_score: 0.9609; train_kl_reg_loss: 36760.1613; train_edge_recon_loss: 2612218.4287; train_gene_expr_recon_loss: 16315636.0489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18964614.6467; train_optim_loss: 18964614.6467; val_kl_reg_loss: 35934.3561; val_edge_recon_loss: 2620621.6280; val_gene_expr_recon_loss: 16512578.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19169134.9756; val_optim_loss: 19169134.9756
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9889; val_auprc_score: 0.9855; val_best_acc_score: 0.9602; val_best_f1_score: 0.9612; train_kl_reg_loss: 36218.9941; train_edge_recon_loss: 2609272.8254; train_gene_expr_recon_loss: 16261224.4457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18906716.2989; train_optim_loss: 18906716.2989; val_kl_reg_loss: 35623.3216; val_edge_recon_loss: 2627727.7622; val_gene_expr_recon_loss: 16486217.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19149569.2195; val_optim_loss: 19149569.2195
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9896; val_auprc_score: 0.9868; val_best_acc_score: 0.9616; val_best_f1_score: 0.9623; train_kl_reg_loss: 35914.6964; train_edge_recon_loss: 2607474.9789; train_gene_expr_recon_loss: 16221120.2527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18864509.9457; train_optim_loss: 18864509.9457; val_kl_reg_loss: 35140.7389; val_edge_recon_loss: 2619514.4512; val_gene_expr_recon_loss: 16460844.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19115499.9512; val_optim_loss: 19115499.9512
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 35484.8807; train_edge_recon_loss: 2607039.9334; train_gene_expr_recon_loss: 16176854.0027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18819378.8315; train_optim_loss: 18819378.8315; val_kl_reg_loss: 34564.0652; val_edge_recon_loss: 2617905.9146; val_gene_expr_recon_loss: 16424410.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19076880.2439; val_optim_loss: 19076880.2439
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9609; val_best_f1_score: 0.9619; train_kl_reg_loss: 35202.2673; train_edge_recon_loss: 2606235.9783; train_gene_expr_recon_loss: 16154584.8098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18796023.0761; train_optim_loss: 18796023.0761; val_kl_reg_loss: 34647.3533; val_edge_recon_loss: 2622210.8415; val_gene_expr_recon_loss: 16466859.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19123717.4634; val_optim_loss: 19123717.4634
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9891; val_auprc_score: 0.9860; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 34802.4823; train_edge_recon_loss: 2605764.5408; train_gene_expr_recon_loss: 16134954.3397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18775521.3207; train_optim_loss: 18775521.3207; val_kl_reg_loss: 34366.2755; val_edge_recon_loss: 2614547.6220; val_gene_expr_recon_loss: 16454309.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19103223.3171; val_optim_loss: 19103223.3171
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9858; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 34596.0390; train_edge_recon_loss: 2605440.2092; train_gene_expr_recon_loss: 16099912.5679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18739948.8587; train_optim_loss: 18739948.8587; val_kl_reg_loss: 33823.9065; val_edge_recon_loss: 2619195.2439; val_gene_expr_recon_loss: 16436504.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19089523.1707; val_optim_loss: 19089523.1707
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 34297.2027; train_edge_recon_loss: 2603868.0088; train_gene_expr_recon_loss: 16071927.4402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18710092.6413; train_optim_loss: 18710092.6413; val_kl_reg_loss: 33671.8805; val_edge_recon_loss: 2620881.8415; val_gene_expr_recon_loss: 16449641.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19104195.2683; val_optim_loss: 19104195.2683

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9870; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 34675.6162; train_edge_recon_loss: 2601158.4925; train_gene_expr_recon_loss: 15986276.2908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18622110.4348; train_optim_loss: 18622110.4348; val_kl_reg_loss: 33800.1747; val_edge_recon_loss: 2615300.1768; val_gene_expr_recon_loss: 16399280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19048380.2927; val_optim_loss: 19048380.2927
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9895; val_auprc_score: 0.9867; val_best_acc_score: 0.9618; val_best_f1_score: 0.9627; train_kl_reg_loss: 34462.5124; train_edge_recon_loss: 2599460.8492; train_gene_expr_recon_loss: 15973787.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18607711.2446; train_optim_loss: 18607711.2446; val_kl_reg_loss: 33785.4038; val_edge_recon_loss: 2614222.8476; val_gene_expr_recon_loss: 16394211.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19042220.0488; val_optim_loss: 19042220.0488
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9904; val_auprc_score: 0.9881; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 34441.0817; train_edge_recon_loss: 2600231.1671; train_gene_expr_recon_loss: 15978978.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18613650.5272; train_optim_loss: 18613650.5272; val_kl_reg_loss: 33679.2229; val_edge_recon_loss: 2611708.3171; val_gene_expr_recon_loss: 16334644.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18980032.0976; val_optim_loss: 18980032.0976
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9896; val_auprc_score: 0.9868; val_best_acc_score: 0.9622; val_best_f1_score: 0.9630; train_kl_reg_loss: 34409.7513; train_edge_recon_loss: 2599298.0781; train_gene_expr_recon_loss: 15971928.3967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18605636.2174; train_optim_loss: 18605636.2174; val_kl_reg_loss: 33691.1662; val_edge_recon_loss: 2614082.4085; val_gene_expr_recon_loss: 16401295.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19049069.1707; val_optim_loss: 19049069.1707
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9623; val_best_f1_score: 0.9631; train_kl_reg_loss: 34384.1133; train_edge_recon_loss: 2601484.6420; train_gene_expr_recon_loss: 15984749.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18620618.4511; train_optim_loss: 18620618.4511; val_kl_reg_loss: 33735.0921; val_edge_recon_loss: 2613442.2683; val_gene_expr_recon_loss: 16406499.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19053676.9268; val_optim_loss: 19053676.9268
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9870; val_best_acc_score: 0.9620; val_best_f1_score: 0.9628; train_kl_reg_loss: 34349.6443; train_edge_recon_loss: 2600672.6990; train_gene_expr_recon_loss: 15963296.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18598319.0707; train_optim_loss: 18598319.0707; val_kl_reg_loss: 33652.6307; val_edge_recon_loss: 2612347.2012; val_gene_expr_recon_loss: 16410372.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19056372.2927; val_optim_loss: 19056372.2927
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9871; val_best_acc_score: 0.9629; val_best_f1_score: 0.9636; train_kl_reg_loss: 34314.5792; train_edge_recon_loss: 2599423.1583; train_gene_expr_recon_loss: 15967363.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18601101.6196; train_optim_loss: 18601101.6196; val_kl_reg_loss: 33674.0401; val_edge_recon_loss: 2613263.7927; val_gene_expr_recon_loss: 16397771.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19044708.7805; val_optim_loss: 19044708.7805

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9900; val_auprc_score: 0.9873; val_best_acc_score: 0.9631; val_best_f1_score: 0.9638; train_kl_reg_loss: 34328.6316; train_edge_recon_loss: 2599595.9694; train_gene_expr_recon_loss: 15965492.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18599416.9457; train_optim_loss: 18599416.9457; val_kl_reg_loss: 33649.4511; val_edge_recon_loss: 2611758.9573; val_gene_expr_recon_loss: 16369588.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19014996.9268; val_optim_loss: 19014996.9268
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9900; val_auprc_score: 0.9872; val_best_acc_score: 0.9639; val_best_f1_score: 0.9645; train_kl_reg_loss: 34341.3207; train_edge_recon_loss: 2598392.8315; train_gene_expr_recon_loss: 15958720.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18591455.0217; train_optim_loss: 18591455.0217; val_kl_reg_loss: 33708.2558; val_edge_recon_loss: 2608822.8415; val_gene_expr_recon_loss: 16393187.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19035718.2439; val_optim_loss: 19035718.2439
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9896; val_auprc_score: 0.9868; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 34322.6172; train_edge_recon_loss: 2599220.3974; train_gene_expr_recon_loss: 15964684.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18598227.0543; train_optim_loss: 18598227.0543; val_kl_reg_loss: 33605.1157; val_edge_recon_loss: 2613893.2317; val_gene_expr_recon_loss: 16380029.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19027528.0488; val_optim_loss: 19027528.0488
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9896; val_auprc_score: 0.9870; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 34301.1938; train_edge_recon_loss: 2599350.8628; train_gene_expr_recon_loss: 15939703.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18573355.8424; train_optim_loss: 18573355.8424; val_kl_reg_loss: 33601.7509; val_edge_recon_loss: 2612386.0976; val_gene_expr_recon_loss: 16369945.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19015933.8049; val_optim_loss: 19015933.8049

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 41 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9892
val AUPRC score: 0.9863
val best accuracy score: 0.9619
val best F1 score: 0.9627
val target rna MSE score: 0.6515
val source rna MSE score: 0.0553

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
