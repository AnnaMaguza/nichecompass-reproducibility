None
Run timestamp: 01072023_083104_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9860; val_auprc_score: 0.9836; val_best_acc_score: 0.9455; val_best_f1_score: 0.9467; train_kl_reg_loss: 2238.3853; train_edge_recon_loss: 27677.2782; train_gene_expr_recon_loss: 7859.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37775.5131; train_optim_loss: 37775.5131; val_kl_reg_loss: 2352.8828; val_edge_recon_loss: 26434.7965; val_gene_expr_recon_loss: 7215.0088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36002.6882; val_optim_loss: 36002.6882
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9907; val_auprc_score: 0.9891; val_best_acc_score: 0.9572; val_best_f1_score: 0.9577; train_kl_reg_loss: 2366.3351; train_edge_recon_loss: 27272.8715; train_gene_expr_recon_loss: 7115.5531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36754.7597; train_optim_loss: 36754.7597; val_kl_reg_loss: 2425.2859; val_edge_recon_loss: 26296.1144; val_gene_expr_recon_loss: 6935.4589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35656.8592; val_optim_loss: 35656.8592
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9927; val_auprc_score: 0.9914; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 2405.8366; train_edge_recon_loss: 27180.1941; train_gene_expr_recon_loss: 6956.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36542.5899; train_optim_loss: 36542.5899; val_kl_reg_loss: 2514.6970; val_edge_recon_loss: 26201.7390; val_gene_expr_recon_loss: 6849.7748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35566.2108; val_optim_loss: 35566.2108
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 2426.2847; train_edge_recon_loss: 27130.8436; train_gene_expr_recon_loss: 6892.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36449.4120; train_optim_loss: 36449.4120; val_kl_reg_loss: 2402.0604; val_edge_recon_loss: 26135.5575; val_gene_expr_recon_loss: 6808.6677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35346.2856; val_optim_loss: 35346.2856
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9938; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 2441.2942; train_edge_recon_loss: 27089.7091; train_gene_expr_recon_loss: 6855.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36386.1818; train_optim_loss: 36386.1818; val_kl_reg_loss: 2483.2085; val_edge_recon_loss: 26086.8908; val_gene_expr_recon_loss: 6783.1968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35353.2961; val_optim_loss: 35353.2961
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 2452.2636; train_edge_recon_loss: 27059.8590; train_gene_expr_recon_loss: 6838.5641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36350.6867; train_optim_loss: 36350.6867; val_kl_reg_loss: 2532.9746; val_edge_recon_loss: 26112.6757; val_gene_expr_recon_loss: 6756.9320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35402.5821; val_optim_loss: 35402.5821
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9950; val_auprc_score: 0.9940; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 2458.5462; train_edge_recon_loss: 27045.5741; train_gene_expr_recon_loss: 6820.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36324.8373; train_optim_loss: 36324.8373; val_kl_reg_loss: 2550.0552; val_edge_recon_loss: 26047.6902; val_gene_expr_recon_loss: 6745.5406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35343.2859; val_optim_loss: 35343.2859
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9944; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 2463.6932; train_edge_recon_loss: 27028.8693; train_gene_expr_recon_loss: 6807.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36299.9630; train_optim_loss: 36299.9630; val_kl_reg_loss: 2403.7960; val_edge_recon_loss: 26036.5398; val_gene_expr_recon_loss: 6756.6539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35196.9896; val_optim_loss: 35196.9896
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 2468.7620; train_edge_recon_loss: 27017.3581; train_gene_expr_recon_loss: 6800.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36286.4862; train_optim_loss: 36286.4862; val_kl_reg_loss: 2441.3734; val_edge_recon_loss: 26016.4807; val_gene_expr_recon_loss: 6751.3623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35209.2164; val_optim_loss: 35209.2164
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 2474.2315; train_edge_recon_loss: 26997.4366; train_gene_expr_recon_loss: 6797.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36269.0040; train_optim_loss: 36269.0040; val_kl_reg_loss: 2341.7937; val_edge_recon_loss: 26026.3398; val_gene_expr_recon_loss: 6752.6737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35120.8073; val_optim_loss: 35120.8073
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 2476.9269; train_edge_recon_loss: 26988.9452; train_gene_expr_recon_loss: 6786.4197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36252.2918; train_optim_loss: 36252.2918; val_kl_reg_loss: 2438.9750; val_edge_recon_loss: 25989.5411; val_gene_expr_recon_loss: 6728.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35157.3053; val_optim_loss: 35157.3053
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 2479.8517; train_edge_recon_loss: 26980.2257; train_gene_expr_recon_loss: 6782.0759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36242.1532; train_optim_loss: 36242.1532; val_kl_reg_loss: 2478.4856; val_edge_recon_loss: 26009.1940; val_gene_expr_recon_loss: 6735.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35223.3555; val_optim_loss: 35223.3555
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 2482.2067; train_edge_recon_loss: 26977.8951; train_gene_expr_recon_loss: 6778.5079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36238.6097; train_optim_loss: 36238.6097; val_kl_reg_loss: 2453.1049; val_edge_recon_loss: 26012.9349; val_gene_expr_recon_loss: 6729.8588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35195.8986; val_optim_loss: 35195.8986
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 2485.5346; train_edge_recon_loss: 26962.9939; train_gene_expr_recon_loss: 6776.9719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36225.5004; train_optim_loss: 36225.5004; val_kl_reg_loss: 2528.7436; val_edge_recon_loss: 26011.1716; val_gene_expr_recon_loss: 6724.9548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35264.8700; val_optim_loss: 35264.8700

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 2486.8477; train_edge_recon_loss: 26930.8164; train_gene_expr_recon_loss: 6742.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36159.9685; train_optim_loss: 36159.9685; val_kl_reg_loss: 2486.9472; val_edge_recon_loss: 25895.0994; val_gene_expr_recon_loss: 6690.8520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35072.8986; val_optim_loss: 35072.8986
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 2485.0519; train_edge_recon_loss: 26927.2333; train_gene_expr_recon_loss: 6733.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36145.5351; train_optim_loss: 36145.5351; val_kl_reg_loss: 2470.1336; val_edge_recon_loss: 25916.6030; val_gene_expr_recon_loss: 6683.7114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35070.4479; val_optim_loss: 35070.4479
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 2484.2160; train_edge_recon_loss: 26929.9202; train_gene_expr_recon_loss: 6734.2603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36148.3965; train_optim_loss: 36148.3965; val_kl_reg_loss: 2470.9490; val_edge_recon_loss: 25902.9342; val_gene_expr_recon_loss: 6693.2616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35067.1448; val_optim_loss: 35067.1448
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 2484.8243; train_edge_recon_loss: 26922.7998; train_gene_expr_recon_loss: 6736.4184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36144.0424; train_optim_loss: 36144.0424; val_kl_reg_loss: 2469.2494; val_edge_recon_loss: 25898.1987; val_gene_expr_recon_loss: 6687.4027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35054.8509; val_optim_loss: 35054.8509
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2484.8033; train_edge_recon_loss: 26923.3203; train_gene_expr_recon_loss: 6729.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36137.7780; train_optim_loss: 36137.7780; val_kl_reg_loss: 2465.1063; val_edge_recon_loss: 25913.2359; val_gene_expr_recon_loss: 6690.3974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35068.7396; val_optim_loss: 35068.7396
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2484.4476; train_edge_recon_loss: 26923.0622; train_gene_expr_recon_loss: 6729.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36136.5853; train_optim_loss: 36136.5853; val_kl_reg_loss: 2485.7968; val_edge_recon_loss: 25903.9717; val_gene_expr_recon_loss: 6677.1606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35066.9290; val_optim_loss: 35066.9290
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 2485.1145; train_edge_recon_loss: 26920.9857; train_gene_expr_recon_loss: 6727.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36133.2111; train_optim_loss: 36133.2111; val_kl_reg_loss: 2476.5318; val_edge_recon_loss: 25894.7920; val_gene_expr_recon_loss: 6691.1199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35062.4436; val_optim_loss: 35062.4436
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2486.0388; train_edge_recon_loss: 26918.3652; train_gene_expr_recon_loss: 6726.5849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36130.9889; train_optim_loss: 36130.9889; val_kl_reg_loss: 2477.3135; val_edge_recon_loss: 25898.5268; val_gene_expr_recon_loss: 6691.4082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35067.2484; val_optim_loss: 35067.2484

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 2484.0287; train_edge_recon_loss: 26921.2332; train_gene_expr_recon_loss: 6723.1147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36128.3766; train_optim_loss: 36128.3766; val_kl_reg_loss: 2471.4035; val_edge_recon_loss: 25868.3174; val_gene_expr_recon_loss: 6675.8477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35015.5687; val_optim_loss: 35015.5687
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 2484.8711; train_edge_recon_loss: 26916.3269; train_gene_expr_recon_loss: 6720.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36121.9129; train_optim_loss: 36121.9129; val_kl_reg_loss: 2476.1044; val_edge_recon_loss: 25892.9543; val_gene_expr_recon_loss: 6680.1571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35049.2160; val_optim_loss: 35049.2160
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 2485.6889; train_edge_recon_loss: 26914.9497; train_gene_expr_recon_loss: 6723.5266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36124.1652; train_optim_loss: 36124.1652; val_kl_reg_loss: 2481.5809; val_edge_recon_loss: 25887.7203; val_gene_expr_recon_loss: 6672.5152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35041.8164; val_optim_loss: 35041.8164
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2485.8464; train_edge_recon_loss: 26912.7556; train_gene_expr_recon_loss: 6722.3586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36120.9605; train_optim_loss: 36120.9605; val_kl_reg_loss: 2480.3707; val_edge_recon_loss: 25895.5957; val_gene_expr_recon_loss: 6690.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35066.7287; val_optim_loss: 35066.7287
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 2485.6050; train_edge_recon_loss: 26910.6545; train_gene_expr_recon_loss: 6722.1130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36118.3725; train_optim_loss: 36118.3725; val_kl_reg_loss: 2484.2609; val_edge_recon_loss: 25887.8486; val_gene_expr_recon_loss: 6683.1072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35055.2166; val_optim_loss: 35055.2166

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 2487.0246; train_edge_recon_loss: 26911.7757; train_gene_expr_recon_loss: 6721.5968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36120.3971; train_optim_loss: 36120.3971; val_kl_reg_loss: 2476.4041; val_edge_recon_loss: 25882.5503; val_gene_expr_recon_loss: 6671.6097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35030.5642; val_optim_loss: 35030.5642
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 2485.6512; train_edge_recon_loss: 26913.9128; train_gene_expr_recon_loss: 6720.2436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36119.8076; train_optim_loss: 36119.8076; val_kl_reg_loss: 2475.2509; val_edge_recon_loss: 25907.9263; val_gene_expr_recon_loss: 6680.2326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35063.4097; val_optim_loss: 35063.4097
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 2485.7811; train_edge_recon_loss: 26911.0374; train_gene_expr_recon_loss: 6722.4249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36119.2433; train_optim_loss: 36119.2433; val_kl_reg_loss: 2477.5653; val_edge_recon_loss: 25900.0158; val_gene_expr_recon_loss: 6685.7231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35063.3041; val_optim_loss: 35063.3041
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2486.3776; train_edge_recon_loss: 26910.1526; train_gene_expr_recon_loss: 6721.0062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36117.5365; train_optim_loss: 36117.5365; val_kl_reg_loss: 2476.0532; val_edge_recon_loss: 25889.4477; val_gene_expr_recon_loss: 6687.8663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35053.3670; val_optim_loss: 35053.3670

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 583 min 9 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9963
Val best accuracy score: 0.9801
Val best F1 score: 0.9803
Val gene expr MSE score: 1.7536

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
