None
Run timestamp: 01072023_211321_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9868; val_auprc_score: 0.9847; val_best_acc_score: 0.9466; val_best_f1_score: 0.9477; train_kl_reg_loss: 2212.0004; train_edge_recon_loss: 27637.4423; train_gene_expr_recon_loss: 7838.2792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37687.7219; train_optim_loss: 37687.7219; val_kl_reg_loss: 2216.5884; val_edge_recon_loss: 26398.9073; val_gene_expr_recon_loss: 7148.6389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35764.1346; val_optim_loss: 35764.1346
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 2331.8858; train_edge_recon_loss: 27235.6250; train_gene_expr_recon_loss: 7072.8278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36640.3387; train_optim_loss: 36640.3387; val_kl_reg_loss: 2371.7171; val_edge_recon_loss: 26244.1962; val_gene_expr_recon_loss: 6888.1819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35504.0952; val_optim_loss: 35504.0952
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9645; val_best_f1_score: 0.9650; train_kl_reg_loss: 2372.2384; train_edge_recon_loss: 27139.7190; train_gene_expr_recon_loss: 6918.6770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36430.6345; train_optim_loss: 36430.6345; val_kl_reg_loss: 2313.4321; val_edge_recon_loss: 26126.6177; val_gene_expr_recon_loss: 6796.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35236.6722; val_optim_loss: 35236.6722
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 2393.3296; train_edge_recon_loss: 27084.2021; train_gene_expr_recon_loss: 6842.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36319.7599; train_optim_loss: 36319.7599; val_kl_reg_loss: 2475.8860; val_edge_recon_loss: 26127.1608; val_gene_expr_recon_loss: 6743.2058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35346.2526; val_optim_loss: 35346.2526
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 2405.6423; train_edge_recon_loss: 27055.4636; train_gene_expr_recon_loss: 6802.1978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36263.3037; train_optim_loss: 36263.3037; val_kl_reg_loss: 2434.1537; val_edge_recon_loss: 26128.5782; val_gene_expr_recon_loss: 6723.1666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285.8984; val_optim_loss: 35285.8984
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9947; val_auprc_score: 0.9936; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 2416.4898; train_edge_recon_loss: 27021.5536; train_gene_expr_recon_loss: 6781.3566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36219.4001; train_optim_loss: 36219.4001; val_kl_reg_loss: 2377.9715; val_edge_recon_loss: 26099.0658; val_gene_expr_recon_loss: 6697.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35174.9485; val_optim_loss: 35174.9485
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9951; val_auprc_score: 0.9941; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 2424.9447; train_edge_recon_loss: 27002.6160; train_gene_expr_recon_loss: 6763.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36191.4158; train_optim_loss: 36191.4158; val_kl_reg_loss: 2355.6242; val_edge_recon_loss: 26090.8401; val_gene_expr_recon_loss: 6685.8869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35132.3512; val_optim_loss: 35132.3512
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 2430.9046; train_edge_recon_loss: 26981.6784; train_gene_expr_recon_loss: 6755.2958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36167.8788; train_optim_loss: 36167.8788; val_kl_reg_loss: 2390.9854; val_edge_recon_loss: 26061.3661; val_gene_expr_recon_loss: 6671.9566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35124.3080; val_optim_loss: 35124.3080
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 2436.0818; train_edge_recon_loss: 26968.0960; train_gene_expr_recon_loss: 6741.9078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36146.0856; train_optim_loss: 36146.0856; val_kl_reg_loss: 2471.6404; val_edge_recon_loss: 26059.8782; val_gene_expr_recon_loss: 6671.1944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35202.7130; val_optim_loss: 35202.7130
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 2441.1243; train_edge_recon_loss: 26956.7261; train_gene_expr_recon_loss: 6737.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36134.9770; train_optim_loss: 36134.9770; val_kl_reg_loss: 2424.3356; val_edge_recon_loss: 25965.2559; val_gene_expr_recon_loss: 6661.2836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35050.8750; val_optim_loss: 35050.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 2443.0346; train_edge_recon_loss: 26952.0254; train_gene_expr_recon_loss: 6731.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36126.1963; train_optim_loss: 36126.1963; val_kl_reg_loss: 2504.6726; val_edge_recon_loss: 26027.3751; val_gene_expr_recon_loss: 6657.8623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35189.9099; val_optim_loss: 35189.9099
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9951; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 2447.6851; train_edge_recon_loss: 26936.9033; train_gene_expr_recon_loss: 6728.3118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36112.9002; train_optim_loss: 36112.9002; val_kl_reg_loss: 2491.7684; val_edge_recon_loss: 26005.7361; val_gene_expr_recon_loss: 6651.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35148.9696; val_optim_loss: 35148.9696
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 2450.8826; train_edge_recon_loss: 26929.6026; train_gene_expr_recon_loss: 6722.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36103.2643; train_optim_loss: 36103.2643; val_kl_reg_loss: 2439.0698; val_edge_recon_loss: 25954.0022; val_gene_expr_recon_loss: 6647.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35040.1837; val_optim_loss: 35040.1837
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 2453.9194; train_edge_recon_loss: 26922.0898; train_gene_expr_recon_loss: 6716.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36092.5678; train_optim_loss: 36092.5678; val_kl_reg_loss: 2421.9939; val_edge_recon_loss: 25957.7923; val_gene_expr_recon_loss: 6638.5346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35018.3208; val_optim_loss: 35018.3208
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 2456.9044; train_edge_recon_loss: 26913.2611; train_gene_expr_recon_loss: 6717.5102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36087.6757; train_optim_loss: 36087.6757; val_kl_reg_loss: 2458.4450; val_edge_recon_loss: 25976.0651; val_gene_expr_recon_loss: 6645.4198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35079.9300; val_optim_loss: 35079.9300
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 2458.1888; train_edge_recon_loss: 26913.1185; train_gene_expr_recon_loss: 6714.6899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36085.9972; train_optim_loss: 36085.9972; val_kl_reg_loss: 2436.0393; val_edge_recon_loss: 25968.6975; val_gene_expr_recon_loss: 6648.0046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35052.7414; val_optim_loss: 35052.7414
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 2461.2182; train_edge_recon_loss: 26904.7337; train_gene_expr_recon_loss: 6710.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36076.2670; train_optim_loss: 36076.2670; val_kl_reg_loss: 2448.8432; val_edge_recon_loss: 25966.1447; val_gene_expr_recon_loss: 6632.8853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35047.8731; val_optim_loss: 35047.8731
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 2463.5519; train_edge_recon_loss: 26894.7989; train_gene_expr_recon_loss: 6710.5215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36068.8723; train_optim_loss: 36068.8723; val_kl_reg_loss: 2479.1103; val_edge_recon_loss: 25989.6517; val_gene_expr_recon_loss: 6651.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35120.1323; val_optim_loss: 35120.1323

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2464.9651; train_edge_recon_loss: 26862.5089; train_gene_expr_recon_loss: 6680.4687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36007.9427; train_optim_loss: 36007.9427; val_kl_reg_loss: 2460.5614; val_edge_recon_loss: 25881.4168; val_gene_expr_recon_loss: 6615.3315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34957.3097; val_optim_loss: 34957.3097
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2463.6590; train_edge_recon_loss: 26860.8512; train_gene_expr_recon_loss: 6675.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35999.6565; train_optim_loss: 35999.6565; val_kl_reg_loss: 2443.4499; val_edge_recon_loss: 25890.0626; val_gene_expr_recon_loss: 6612.0574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34945.5700; val_optim_loss: 34945.5700
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2463.6131; train_edge_recon_loss: 26857.8389; train_gene_expr_recon_loss: 6674.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35996.3380; train_optim_loss: 35996.3380; val_kl_reg_loss: 2464.3483; val_edge_recon_loss: 25888.5360; val_gene_expr_recon_loss: 6601.9628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34954.8471; val_optim_loss: 34954.8471
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2462.6980; train_edge_recon_loss: 26862.4799; train_gene_expr_recon_loss: 6673.4473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35998.6253; train_optim_loss: 35998.6253; val_kl_reg_loss: 2466.6177; val_edge_recon_loss: 25892.4204; val_gene_expr_recon_loss: 6611.4367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34970.4749; val_optim_loss: 34970.4749
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 2463.3870; train_edge_recon_loss: 26857.3666; train_gene_expr_recon_loss: 6673.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35994.1026; train_optim_loss: 35994.1026; val_kl_reg_loss: 2451.6810; val_edge_recon_loss: 25890.0333; val_gene_expr_recon_loss: 6609.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34950.9531; val_optim_loss: 34950.9531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2462.7361; train_edge_recon_loss: 26861.6788; train_gene_expr_recon_loss: 6669.7462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35994.1611; train_optim_loss: 35994.1611; val_kl_reg_loss: 2459.9190; val_edge_recon_loss: 25864.3579; val_gene_expr_recon_loss: 6607.9801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34932.2571; val_optim_loss: 34932.2571
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2463.7944; train_edge_recon_loss: 26852.9686; train_gene_expr_recon_loss: 6673.4334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35990.1964; train_optim_loss: 35990.1964; val_kl_reg_loss: 2475.6231; val_edge_recon_loss: 25888.8559; val_gene_expr_recon_loss: 6599.5283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34964.0073; val_optim_loss: 34964.0073
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 2463.2543; train_edge_recon_loss: 26857.2999; train_gene_expr_recon_loss: 6670.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35990.8544; train_optim_loss: 35990.8544; val_kl_reg_loss: 2456.8080; val_edge_recon_loss: 25899.2818; val_gene_expr_recon_loss: 6603.4639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34959.5538; val_optim_loss: 34959.5538
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 2463.8237; train_edge_recon_loss: 26855.0875; train_gene_expr_recon_loss: 6668.8475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35987.7588; train_optim_loss: 35987.7588; val_kl_reg_loss: 2442.8497; val_edge_recon_loss: 25891.8563; val_gene_expr_recon_loss: 6605.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34940.2905; val_optim_loss: 34940.2905
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 2463.8709; train_edge_recon_loss: 26856.8460; train_gene_expr_recon_loss: 6668.6939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35989.4108; train_optim_loss: 35989.4108; val_kl_reg_loss: 2450.9963; val_edge_recon_loss: 25908.4266; val_gene_expr_recon_loss: 6602.5415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34961.9644; val_optim_loss: 34961.9644

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 2464.2405; train_edge_recon_loss: 26851.2650; train_gene_expr_recon_loss: 6662.9590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35978.4645; train_optim_loss: 35978.4645; val_kl_reg_loss: 2456.6727; val_edge_recon_loss: 25845.4937; val_gene_expr_recon_loss: 6604.0645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34906.2310; val_optim_loss: 34906.2310
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2465.1141; train_edge_recon_loss: 26845.0692; train_gene_expr_recon_loss: 6665.6822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35975.8655; train_optim_loss: 35975.8655; val_kl_reg_loss: 2461.9224; val_edge_recon_loss: 25876.0273; val_gene_expr_recon_loss: 6605.2720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34943.2218; val_optim_loss: 34943.2218
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2464.1937; train_edge_recon_loss: 26848.9455; train_gene_expr_recon_loss: 6664.2087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35977.3478; train_optim_loss: 35977.3478; val_kl_reg_loss: 2457.7186; val_edge_recon_loss: 25879.3522; val_gene_expr_recon_loss: 6600.7509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34937.8216; val_optim_loss: 34937.8216
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 2463.5863; train_edge_recon_loss: 26851.5396; train_gene_expr_recon_loss: 6663.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35978.6693; train_optim_loss: 35978.6693; val_kl_reg_loss: 2455.0446; val_edge_recon_loss: 25860.2320; val_gene_expr_recon_loss: 6607.3598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34922.6366; val_optim_loss: 34922.6366
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2463.2102; train_edge_recon_loss: 26853.7696; train_gene_expr_recon_loss: 6664.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35981.9186; train_optim_loss: 35981.9186; val_kl_reg_loss: 2453.1998; val_edge_recon_loss: 25872.4818; val_gene_expr_recon_loss: 6597.9150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34923.5965; val_optim_loss: 34923.5965

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 2462.9536; train_edge_recon_loss: 26852.8560; train_gene_expr_recon_loss: 6664.0934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35979.9030; train_optim_loss: 35979.9030; val_kl_reg_loss: 2456.7909; val_edge_recon_loss: 25887.4537; val_gene_expr_recon_loss: 6606.5634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34950.8081; val_optim_loss: 34950.8081
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 2463.5855; train_edge_recon_loss: 26854.3191; train_gene_expr_recon_loss: 6661.7291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35979.6336; train_optim_loss: 35979.6336; val_kl_reg_loss: 2456.6664; val_edge_recon_loss: 25880.0955; val_gene_expr_recon_loss: 6604.1935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34940.9555; val_optim_loss: 34940.9555
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 2463.3998; train_edge_recon_loss: 26854.7944; train_gene_expr_recon_loss: 6665.1947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35983.3889; train_optim_loss: 35983.3889; val_kl_reg_loss: 2456.9000; val_edge_recon_loss: 25865.9260; val_gene_expr_recon_loss: 6595.6304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34918.4565; val_optim_loss: 34918.4565
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2464.1076; train_edge_recon_loss: 26851.6216; train_gene_expr_recon_loss: 6662.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35977.7380; train_optim_loss: 35977.7380; val_kl_reg_loss: 2457.5922; val_edge_recon_loss: 25862.5223; val_gene_expr_recon_loss: 6596.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34916.3725; val_optim_loss: 34916.3725

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 694 min 57 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9964
Val best accuracy score: 0.9811
Val best F1 score: 0.9813
Val gene expr MSE score: 1.7235

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
