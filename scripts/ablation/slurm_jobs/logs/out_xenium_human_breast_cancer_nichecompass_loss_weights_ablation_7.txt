None
Run timestamp: 13072023_230704_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9594; val_auprc_score: 0.9508; val_best_acc_score: 0.8974; val_best_f1_score: 0.9027; train_kl_reg_loss: 56024.5533; train_edge_recon_loss: 2786069.2238; train_gene_expr_recon_loss: 7141081.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9983174.8807; train_optim_loss: 9983174.8807; val_kl_reg_loss: 45011.9045; val_edge_recon_loss: 2706871.6273; val_gene_expr_recon_loss: 6709447.3287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9461330.8426; val_optim_loss: 9461330.8426
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9740; val_auprc_score: 0.9698; val_best_acc_score: 0.9196; val_best_f1_score: 0.9229; train_kl_reg_loss: 40941.9281; train_edge_recon_loss: 2677212.7459; train_gene_expr_recon_loss: 6599215.5602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9317370.2392; train_optim_loss: 9317370.2392; val_kl_reg_loss: 36761.9176; val_edge_recon_loss: 2678077.8403; val_gene_expr_recon_loss: 6512574.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9227413.9537; val_optim_loss: 9227413.9537
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9782; val_best_acc_score: 0.9329; val_best_f1_score: 0.9347; train_kl_reg_loss: 35139.2944; train_edge_recon_loss: 2657192.9303; train_gene_expr_recon_loss: 6475522.1896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9167854.4095; train_optim_loss: 9167854.4095; val_kl_reg_loss: 32968.1301; val_edge_recon_loss: 2661752.9896; val_gene_expr_recon_loss: 6431788.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9126509.8472; val_optim_loss: 9126509.8472
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9849; val_auprc_score: 0.9826; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 32496.2481; train_edge_recon_loss: 2643156.6119; train_gene_expr_recon_loss: 6420129.6649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9095782.5298; train_optim_loss: 9095782.5298; val_kl_reg_loss: 31099.8793; val_edge_recon_loss: 2654461.3206; val_gene_expr_recon_loss: 6406654.6204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092215.8843; val_optim_loss: 9092215.8843
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9860; val_auprc_score: 0.9838; val_best_acc_score: 0.9445; val_best_f1_score: 0.9455; train_kl_reg_loss: 31115.6135; train_edge_recon_loss: 2635973.2172; train_gene_expr_recon_loss: 6389810.7307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9056899.5715; train_optim_loss: 9056899.5715; val_kl_reg_loss: 30257.0687; val_edge_recon_loss: 2648780.4387; val_gene_expr_recon_loss: 6378659.3287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9057696.7870; val_optim_loss: 9057696.7870
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9852; val_best_acc_score: 0.9473; val_best_f1_score: 0.9485; train_kl_reg_loss: 30107.6378; train_edge_recon_loss: 2632343.2389; train_gene_expr_recon_loss: 6366693.2978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9029144.1829; train_optim_loss: 9029144.1829; val_kl_reg_loss: 28445.9732; val_edge_recon_loss: 2643049.5104; val_gene_expr_recon_loss: 6356044.6968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9027540.1759; val_optim_loss: 9027540.1759
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9879; val_auprc_score: 0.9859; val_best_acc_score: 0.9493; val_best_f1_score: 0.9501; train_kl_reg_loss: 29300.9323; train_edge_recon_loss: 2628807.4879; train_gene_expr_recon_loss: 6353240.1556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9011348.5720; train_optim_loss: 9011348.5720; val_kl_reg_loss: 28994.2288; val_edge_recon_loss: 2640067.5127; val_gene_expr_recon_loss: 6361574.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9030635.7917; val_optim_loss: 9030635.7917
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9884; val_auprc_score: 0.9864; val_best_acc_score: 0.9508; val_best_f1_score: 0.9516; train_kl_reg_loss: 28564.3430; train_edge_recon_loss: 2626225.6957; train_gene_expr_recon_loss: 6343458.1037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8998248.1366; train_optim_loss: 8998248.1366; val_kl_reg_loss: 27351.7794; val_edge_recon_loss: 2639655.3391; val_gene_expr_recon_loss: 6355605.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022612.2269; val_optim_loss: 9022612.2269
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9873; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 28012.7036; train_edge_recon_loss: 2624774.0396; train_gene_expr_recon_loss: 6332439.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8985226.4342; train_optim_loss: 8985226.4342; val_kl_reg_loss: 27359.3183; val_edge_recon_loss: 2636270.2604; val_gene_expr_recon_loss: 6344950.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9008579.6065; val_optim_loss: 9008579.6065
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9546; val_best_f1_score: 0.9554; train_kl_reg_loss: 27543.7902; train_edge_recon_loss: 2623431.4933; train_gene_expr_recon_loss: 6326196.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8977172.0638; train_optim_loss: 8977172.0638; val_kl_reg_loss: 26984.2242; val_edge_recon_loss: 2633427.0243; val_gene_expr_recon_loss: 6340540.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9000951.3519; val_optim_loss: 9000951.3519
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9902; val_auprc_score: 0.9885; val_best_acc_score: 0.9551; val_best_f1_score: 0.9560; train_kl_reg_loss: 27090.4356; train_edge_recon_loss: 2621130.3075; train_gene_expr_recon_loss: 6324149.4020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8972370.1373; train_optim_loss: 8972370.1373; val_kl_reg_loss: 26647.2256; val_edge_recon_loss: 2634372.3634; val_gene_expr_recon_loss: 6335037.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8996056.6065; val_optim_loss: 8996056.6065
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9564; val_best_f1_score: 0.9573; train_kl_reg_loss: 26682.3502; train_edge_recon_loss: 2621221.1093; train_gene_expr_recon_loss: 6315720.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8963624.3549; train_optim_loss: 8963624.3549; val_kl_reg_loss: 26366.7067; val_edge_recon_loss: 2632444.1759; val_gene_expr_recon_loss: 6351227.5972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9010038.4861; val_optim_loss: 9010038.4861
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9910; val_auprc_score: 0.9895; val_best_acc_score: 0.9580; val_best_f1_score: 0.9585; train_kl_reg_loss: 26314.1877; train_edge_recon_loss: 2618252.5270; train_gene_expr_recon_loss: 6312244.4776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8956811.2016; train_optim_loss: 8956811.2016; val_kl_reg_loss: 25593.7251; val_edge_recon_loss: 2632304.2118; val_gene_expr_recon_loss: 6338644.3449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8996542.2292; val_optim_loss: 8996542.2292
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9909; val_auprc_score: 0.9892; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 26066.9773; train_edge_recon_loss: 2618181.5543; train_gene_expr_recon_loss: 6309997.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8954245.7099; train_optim_loss: 8954245.7099; val_kl_reg_loss: 25846.3534; val_edge_recon_loss: 2634049.2812; val_gene_expr_recon_loss: 6332449.7801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8992345.4352; val_optim_loss: 8992345.4352
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9910; val_auprc_score: 0.9895; val_best_acc_score: 0.9581; val_best_f1_score: 0.9589; train_kl_reg_loss: 25910.3782; train_edge_recon_loss: 2616087.2683; train_gene_expr_recon_loss: 6304064.9002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8946062.5494; train_optim_loss: 8946062.5494; val_kl_reg_loss: 25608.7649; val_edge_recon_loss: 2628399.8773; val_gene_expr_recon_loss: 6328624.4699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8982633.1481; val_optim_loss: 8982633.1481
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9914; val_auprc_score: 0.9900; val_best_acc_score: 0.9588; val_best_f1_score: 0.9595; train_kl_reg_loss: 25551.4336; train_edge_recon_loss: 2615399.8164; train_gene_expr_recon_loss: 6303519.1417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8944470.3876; train_optim_loss: 8944470.3876; val_kl_reg_loss: 25039.2484; val_edge_recon_loss: 2627930.9178; val_gene_expr_recon_loss: 6325569.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8978540.0000; val_optim_loss: 8978540.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9897; val_best_acc_score: 0.9587; val_best_f1_score: 0.9594; train_kl_reg_loss: 25377.2919; train_edge_recon_loss: 2615212.4999; train_gene_expr_recon_loss: 6302467.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8943057.6885; train_optim_loss: 8943057.6885; val_kl_reg_loss: 24777.3112; val_edge_recon_loss: 2629526.6620; val_gene_expr_recon_loss: 6333711.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8988015.3588; val_optim_loss: 8988015.3588
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9916; val_auprc_score: 0.9902; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 25180.7572; train_edge_recon_loss: 2614198.3585; train_gene_expr_recon_loss: 6300432.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8939811.4933; train_optim_loss: 8939811.4933; val_kl_reg_loss: 24335.2662; val_edge_recon_loss: 2627168.8993; val_gene_expr_recon_loss: 6337419.4977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8988923.7130; val_optim_loss: 8988923.7130
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9914; val_auprc_score: 0.9899; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 24959.3328; train_edge_recon_loss: 2612823.8792; train_gene_expr_recon_loss: 6297857.2050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8935640.4259; train_optim_loss: 8935640.4259; val_kl_reg_loss: 25038.1589; val_edge_recon_loss: 2624810.6065; val_gene_expr_recon_loss: 6328223.5069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8978072.3009; val_optim_loss: 8978072.3009
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9914; val_auprc_score: 0.9897; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 24801.7927; train_edge_recon_loss: 2612677.9156; train_gene_expr_recon_loss: 6296312.8642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8933792.5846; train_optim_loss: 8933792.5846; val_kl_reg_loss: 24651.4914; val_edge_recon_loss: 2628874.1030; val_gene_expr_recon_loss: 6330709.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8984234.7431; val_optim_loss: 8984234.7431
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9904; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 24741.1800; train_edge_recon_loss: 2611487.8632; train_gene_expr_recon_loss: 6295403.2078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931632.2487; train_optim_loss: 8931632.2487; val_kl_reg_loss: 24598.1838; val_edge_recon_loss: 2625230.1157; val_gene_expr_recon_loss: 6325846.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8975674.6759; val_optim_loss: 8975674.6759
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9921; val_auprc_score: 0.9906; val_best_acc_score: 0.9623; val_best_f1_score: 0.9628; train_kl_reg_loss: 24654.3516; train_edge_recon_loss: 2609992.5385; train_gene_expr_recon_loss: 6291111.1672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8925758.0592; train_optim_loss: 8925758.0592; val_kl_reg_loss: 23899.0866; val_edge_recon_loss: 2625262.5301; val_gene_expr_recon_loss: 6328447.5787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8977609.1620; val_optim_loss: 8977609.1620
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9920; val_auprc_score: 0.9906; val_best_acc_score: 0.9626; val_best_f1_score: 0.9631; train_kl_reg_loss: 24466.3709; train_edge_recon_loss: 2612142.8585; train_gene_expr_recon_loss: 6290986.4398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927595.6752; train_optim_loss: 8927595.6752; val_kl_reg_loss: 23891.0994; val_edge_recon_loss: 2621371.4421; val_gene_expr_recon_loss: 6325007.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8970269.6343; val_optim_loss: 8970269.6343
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9626; val_best_f1_score: 0.9632; train_kl_reg_loss: 24407.2930; train_edge_recon_loss: 2610174.0539; train_gene_expr_recon_loss: 6288018.7942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8922600.1409; train_optim_loss: 8922600.1409; val_kl_reg_loss: 24295.9216; val_edge_recon_loss: 2624080.7431; val_gene_expr_recon_loss: 6329461.7269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8977838.4074; val_optim_loss: 8977838.4074
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9918; val_auprc_score: 0.9901; val_best_acc_score: 0.9620; val_best_f1_score: 0.9627; train_kl_reg_loss: 24356.7643; train_edge_recon_loss: 2609502.4118; train_gene_expr_recon_loss: 6286430.1106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8920289.2932; train_optim_loss: 8920289.2932; val_kl_reg_loss: 24003.0281; val_edge_recon_loss: 2621395.8021; val_gene_expr_recon_loss: 6335203.7940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8980602.6528; val_optim_loss: 8980602.6528
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9920; val_auprc_score: 0.9906; val_best_acc_score: 0.9623; val_best_f1_score: 0.9629; train_kl_reg_loss: 24204.3017; train_edge_recon_loss: 2608735.9807; train_gene_expr_recon_loss: 6288251.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8921191.4982; train_optim_loss: 8921191.4982; val_kl_reg_loss: 24152.1046; val_edge_recon_loss: 2621046.3461; val_gene_expr_recon_loss: 6330977.9815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8976176.4190; val_optim_loss: 8976176.4190
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 24101.2504; train_edge_recon_loss: 2609228.7333; train_gene_expr_recon_loss: 6283469.7137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8916799.6924; train_optim_loss: 8916799.6924; val_kl_reg_loss: 23994.7077; val_edge_recon_loss: 2622353.4294; val_gene_expr_recon_loss: 6326213.0856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8972561.2407; val_optim_loss: 8972561.2407

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9632; val_best_f1_score: 0.9637; train_kl_reg_loss: 25237.7077; train_edge_recon_loss: 2607386.2513; train_gene_expr_recon_loss: 6245917.6520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8878541.6121; train_optim_loss: 8878541.6121; val_kl_reg_loss: 25067.1914; val_edge_recon_loss: 2620071.1921; val_gene_expr_recon_loss: 6298025.4884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8943163.8681; val_optim_loss: 8943163.8681
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9633; val_best_f1_score: 0.9640; train_kl_reg_loss: 25568.6144; train_edge_recon_loss: 2606672.9677; train_gene_expr_recon_loss: 6240190.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8872432.3117; train_optim_loss: 8872432.3117; val_kl_reg_loss: 25266.4167; val_edge_recon_loss: 2620308.9803; val_gene_expr_recon_loss: 6296554.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8942130.1296; val_optim_loss: 8942130.1296
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9922; val_auprc_score: 0.9908; val_best_acc_score: 0.9628; val_best_f1_score: 0.9633; train_kl_reg_loss: 25705.5597; train_edge_recon_loss: 2605482.5231; train_gene_expr_recon_loss: 6242585.1690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8873773.2603; train_optim_loss: 8873773.2603; val_kl_reg_loss: 25411.3100; val_edge_recon_loss: 2620127.3056; val_gene_expr_recon_loss: 6293339.4560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8938878.1065; val_optim_loss: 8938878.1065
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9910; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 25774.8507; train_edge_recon_loss: 2605298.6178; train_gene_expr_recon_loss: 6239682.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8870756.2392; train_optim_loss: 8870756.2392; val_kl_reg_loss: 25304.3998; val_edge_recon_loss: 2622338.4271; val_gene_expr_recon_loss: 6299836.7037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8947479.5324; val_optim_loss: 8947479.5324
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9923; val_auprc_score: 0.9910; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 25805.4619; train_edge_recon_loss: 2605304.1803; train_gene_expr_recon_loss: 6238800.2341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8869909.8771; train_optim_loss: 8869909.8771; val_kl_reg_loss: 25387.2932; val_edge_recon_loss: 2621701.3449; val_gene_expr_recon_loss: 6290571.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8937659.8819; val_optim_loss: 8937659.8819
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9922; val_auprc_score: 0.9908; val_best_acc_score: 0.9627; val_best_f1_score: 0.9634; train_kl_reg_loss: 25827.9645; train_edge_recon_loss: 2604891.8639; train_gene_expr_recon_loss: 6239006.6955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8869726.5231; train_optim_loss: 8869726.5231; val_kl_reg_loss: 25532.2203; val_edge_recon_loss: 2619690.2847; val_gene_expr_recon_loss: 6295091.4329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8940313.9491; val_optim_loss: 8940313.9491
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 25750.7137; train_edge_recon_loss: 2605235.3089; train_gene_expr_recon_loss: 6236655.3061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8867641.3274; train_optim_loss: 8867641.3274; val_kl_reg_loss: 25267.0561; val_edge_recon_loss: 2619396.3657; val_gene_expr_recon_loss: 6291813.7060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8936477.1157; val_optim_loss: 8936477.1157
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9925; val_auprc_score: 0.9913; val_best_acc_score: 0.9636; val_best_f1_score: 0.9640; train_kl_reg_loss: 25731.4860; train_edge_recon_loss: 2604927.7029; train_gene_expr_recon_loss: 6236317.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8866976.7958; train_optim_loss: 8866976.7958; val_kl_reg_loss: 25371.9644; val_edge_recon_loss: 2619195.5081; val_gene_expr_recon_loss: 6304439.0394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8949006.5602; val_optim_loss: 8949006.5602
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9631; val_best_f1_score: 0.9638; train_kl_reg_loss: 25712.4409; train_edge_recon_loss: 2604533.1910; train_gene_expr_recon_loss: 6234058.6147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8864304.2616; train_optim_loss: 8864304.2616; val_kl_reg_loss: 25283.5452; val_edge_recon_loss: 2618410.1910; val_gene_expr_recon_loss: 6294513.7616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8938207.4676; val_optim_loss: 8938207.4676
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 25696.6520; train_edge_recon_loss: 2605142.7095; train_gene_expr_recon_loss: 6235783.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8866622.4007; train_optim_loss: 8866622.4007; val_kl_reg_loss: 25375.8337; val_edge_recon_loss: 2616956.9016; val_gene_expr_recon_loss: 6284264.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8926597.3657; val_optim_loss: 8926597.3657
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 25643.1787; train_edge_recon_loss: 2605040.4159; train_gene_expr_recon_loss: 6235584.0612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8866267.6633; train_optim_loss: 8866267.6633; val_kl_reg_loss: 25167.2352; val_edge_recon_loss: 2616771.2859; val_gene_expr_recon_loss: 6293463.2801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8935401.8380; val_optim_loss: 8935401.8380
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9634; val_best_f1_score: 0.9639; train_kl_reg_loss: 25596.1230; train_edge_recon_loss: 2604565.8417; train_gene_expr_recon_loss: 6233469.2212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8863631.1741; train_optim_loss: 8863631.1741; val_kl_reg_loss: 25244.9697; val_edge_recon_loss: 2617883.6910; val_gene_expr_recon_loss: 6293367.9931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8936496.6574; val_optim_loss: 8936496.6574
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9924; val_auprc_score: 0.9911; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 25521.3579; train_edge_recon_loss: 2605256.4592; train_gene_expr_recon_loss: 6233639.2984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8864417.1242; train_optim_loss: 8864417.1242; val_kl_reg_loss: 25092.0561; val_edge_recon_loss: 2618774.1794; val_gene_expr_recon_loss: 6294075.6921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8937941.8958; val_optim_loss: 8937941.8958
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9924; val_auprc_score: 0.9908; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 25467.9631; train_edge_recon_loss: 2605665.4874; train_gene_expr_recon_loss: 6231742.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8862875.6435; train_optim_loss: 8862875.6435; val_kl_reg_loss: 24988.2374; val_edge_recon_loss: 2617079.9525; val_gene_expr_recon_loss: 6299874.6296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8941942.8056; val_optim_loss: 8941942.8056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9636; val_best_f1_score: 0.9643; train_kl_reg_loss: 25475.2949; train_edge_recon_loss: 2604600.4374; train_gene_expr_recon_loss: 6228713.0072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8858788.7351; train_optim_loss: 8858788.7351; val_kl_reg_loss: 25189.7423; val_edge_recon_loss: 2617844.8993; val_gene_expr_recon_loss: 6300038.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8943072.8194; val_optim_loss: 8943072.8194
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 25575.4128; train_edge_recon_loss: 2604010.4316; train_gene_expr_recon_loss: 6227770.3423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8857356.1865; train_optim_loss: 8857356.1865; val_kl_reg_loss: 25170.3337; val_edge_recon_loss: 2617850.7431; val_gene_expr_recon_loss: 6294909.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8937930.9306; val_optim_loss: 8937930.9306
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9639; val_best_f1_score: 0.9644; train_kl_reg_loss: 25604.2948; train_edge_recon_loss: 2604092.8711; train_gene_expr_recon_loss: 6227511.4367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8857208.6114; train_optim_loss: 8857208.6114; val_kl_reg_loss: 25242.9176; val_edge_recon_loss: 2617272.5475; val_gene_expr_recon_loss: 6289202.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8931718.3565; val_optim_loss: 8931718.3565
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9928; val_auprc_score: 0.9915; val_best_acc_score: 0.9642; val_best_f1_score: 0.9647; train_kl_reg_loss: 25636.7808; train_edge_recon_loss: 2603959.3660; train_gene_expr_recon_loss: 6226622.7662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8856218.9151; train_optim_loss: 8856218.9151; val_kl_reg_loss: 25245.2484; val_edge_recon_loss: 2618295.0289; val_gene_expr_recon_loss: 6293054.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8936594.4861; val_optim_loss: 8936594.4861

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 444 min 5 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9912
Val best accuracy score: 0.9637
Val best F1 score: 0.9643
Val gene expr MSE score: 1.5172

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
