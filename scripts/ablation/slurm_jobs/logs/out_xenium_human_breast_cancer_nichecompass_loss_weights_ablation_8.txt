None
Run timestamp: 01072023_174924_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9654; val_auprc_score: 0.9635; val_best_acc_score: 0.9023; val_best_f1_score: 0.9039; train_kl_reg_loss: 513.3755; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 7527.0441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8040.4196; train_optim_loss: 8040.4196; val_kl_reg_loss: 455.1269; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6800.3323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7255.4592; val_optim_loss: 7255.4592
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9706; val_auprc_score: 0.9693; val_best_acc_score: 0.9112; val_best_f1_score: 0.9115; train_kl_reg_loss: 446.1540; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6889.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7335.8783; train_optim_loss: 7335.8783; val_kl_reg_loss: 424.5376; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6647.9772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7072.5148; val_optim_loss: 7072.5148
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9729; val_auprc_score: 0.9718; val_best_acc_score: 0.9140; val_best_f1_score: 0.9151; train_kl_reg_loss: 432.9465; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6792.2271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7225.1736; train_optim_loss: 7225.1736; val_kl_reg_loss: 420.4962; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6608.8630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7029.3592; val_optim_loss: 7029.3592
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9725; val_auprc_score: 0.9712; val_best_acc_score: 0.9142; val_best_f1_score: 0.9148; train_kl_reg_loss: 429.0796; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6756.7780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7185.8576; train_optim_loss: 7185.8576; val_kl_reg_loss: 416.5327; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6601.3160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7017.8486; val_optim_loss: 7017.8486
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9744; val_auprc_score: 0.9733; val_best_acc_score: 0.9177; val_best_f1_score: 0.9180; train_kl_reg_loss: 426.3662; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6739.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7165.9120; train_optim_loss: 7165.9120; val_kl_reg_loss: 421.1229; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6584.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7006.0959; val_optim_loss: 7006.0959
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9747; val_auprc_score: 0.9739; val_best_acc_score: 0.9175; val_best_f1_score: 0.9172; train_kl_reg_loss: 422.6516; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6725.9147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7148.5663; train_optim_loss: 7148.5663; val_kl_reg_loss: 417.9626; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6581.2855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6999.2481; val_optim_loss: 6999.2481
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9748; val_auprc_score: 0.9737; val_best_acc_score: 0.9177; val_best_f1_score: 0.9187; train_kl_reg_loss: 420.3085; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6718.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7138.7700; train_optim_loss: 7138.7700; val_kl_reg_loss: 404.7947; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6579.1574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6983.9521; val_optim_loss: 6983.9521
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9751; val_auprc_score: 0.9746; val_best_acc_score: 0.9175; val_best_f1_score: 0.9185; train_kl_reg_loss: 418.7150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6710.5913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7129.3063; train_optim_loss: 7129.3063; val_kl_reg_loss: 423.3162; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6566.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6989.8896; val_optim_loss: 6989.8896
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9752; val_auprc_score: 0.9749; val_best_acc_score: 0.9175; val_best_f1_score: 0.9181; train_kl_reg_loss: 417.2047; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6708.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7125.3878; train_optim_loss: 7125.3878; val_kl_reg_loss: 407.9620; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6565.7635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6973.7255; val_optim_loss: 6973.7255
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9747; val_auprc_score: 0.9738; val_best_acc_score: 0.9176; val_best_f1_score: 0.9180; train_kl_reg_loss: 416.4702; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6704.0011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7120.4713; train_optim_loss: 7120.4713; val_kl_reg_loss: 411.1040; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6582.8339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6993.9378; val_optim_loss: 6993.9378
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9746; val_auprc_score: 0.9742; val_best_acc_score: 0.9165; val_best_f1_score: 0.9162; train_kl_reg_loss: 417.1545; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6700.4267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7117.5813; train_optim_loss: 7117.5813; val_kl_reg_loss: 404.4527; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6568.3873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6972.8400; val_optim_loss: 6972.8400
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9741; val_auprc_score: 0.9740; val_best_acc_score: 0.9149; val_best_f1_score: 0.9149; train_kl_reg_loss: 417.5407; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6698.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7115.8780; train_optim_loss: 7115.8780; val_kl_reg_loss: 407.5774; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6573.0397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6980.6171; val_optim_loss: 6980.6171
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9746; val_auprc_score: 0.9745; val_best_acc_score: 0.9161; val_best_f1_score: 0.9159; train_kl_reg_loss: 417.7431; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6693.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7110.8441; train_optim_loss: 7110.8441; val_kl_reg_loss: 415.8153; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6561.1940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6977.0093; val_optim_loss: 6977.0093
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9752; val_auprc_score: 0.9751; val_best_acc_score: 0.9170; val_best_f1_score: 0.9170; train_kl_reg_loss: 418.2901; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6691.1891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7109.4792; train_optim_loss: 7109.4792; val_kl_reg_loss: 405.7374; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6570.0483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6975.7856; val_optim_loss: 6975.7856
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9740; val_auprc_score: 0.9742; val_best_acc_score: 0.9146; val_best_f1_score: 0.9141; train_kl_reg_loss: 418.7235; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6689.1161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7107.8396; train_optim_loss: 7107.8396; val_kl_reg_loss: 414.8470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6562.7709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6977.6179; val_optim_loss: 6977.6179

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9765; val_auprc_score: 0.9765; val_best_acc_score: 0.9191; val_best_f1_score: 0.9199; train_kl_reg_loss: 418.2837; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6657.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7075.6847; train_optim_loss: 7075.6847; val_kl_reg_loss: 413.6641; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6541.2029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6954.8669; val_optim_loss: 6954.8669
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9769; val_auprc_score: 0.9770; val_best_acc_score: 0.9195; val_best_f1_score: 0.9203; train_kl_reg_loss: 418.2540; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6655.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7073.6425; train_optim_loss: 7073.6425; val_kl_reg_loss: 412.7972; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6547.2770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6960.0743; val_optim_loss: 6960.0743
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9765; val_auprc_score: 0.9765; val_best_acc_score: 0.9188; val_best_f1_score: 0.9194; train_kl_reg_loss: 418.3615; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6651.8273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7070.1887; train_optim_loss: 7070.1887; val_kl_reg_loss: 414.9050; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6546.6716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6961.5766; val_optim_loss: 6961.5766
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9769; val_auprc_score: 0.9773; val_best_acc_score: 0.9188; val_best_f1_score: 0.9195; train_kl_reg_loss: 418.6159; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6649.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7068.4891; train_optim_loss: 7068.4891; val_kl_reg_loss: 415.6210; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6549.1964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6964.8174; val_optim_loss: 6964.8174
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9774; val_auprc_score: 0.9777; val_best_acc_score: 0.9209; val_best_f1_score: 0.9214; train_kl_reg_loss: 418.7919; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6648.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7067.4600; train_optim_loss: 7067.4600; val_kl_reg_loss: 411.6110; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6542.0617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6953.6727; val_optim_loss: 6953.6727
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9767; val_auprc_score: 0.9771; val_best_acc_score: 0.9193; val_best_f1_score: 0.9198; train_kl_reg_loss: 419.0588; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6647.3257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7066.3845; train_optim_loss: 7066.3845; val_kl_reg_loss: 413.7554; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6537.3070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6951.0623; val_optim_loss: 6951.0623
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9770; val_auprc_score: 0.9772; val_best_acc_score: 0.9201; val_best_f1_score: 0.9207; train_kl_reg_loss: 419.4225; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6648.4592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7067.8817; train_optim_loss: 7067.8817; val_kl_reg_loss: 417.9162; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6545.9205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6963.8367; val_optim_loss: 6963.8367
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9768; val_auprc_score: 0.9772; val_best_acc_score: 0.9191; val_best_f1_score: 0.9197; train_kl_reg_loss: 419.5943; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6646.1779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7065.7722; train_optim_loss: 7065.7722; val_kl_reg_loss: 416.5643; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6542.8237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6959.3880; val_optim_loss: 6959.3880
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9760; val_auprc_score: 0.9762; val_best_acc_score: 0.9183; val_best_f1_score: 0.9187; train_kl_reg_loss: 419.6722; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6646.1090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7065.7812; train_optim_loss: 7065.7812; val_kl_reg_loss: 411.3437; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6542.9598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6954.3035; val_optim_loss: 6954.3035
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9767; val_auprc_score: 0.9770; val_best_acc_score: 0.9192; val_best_f1_score: 0.9198; train_kl_reg_loss: 419.8937; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6644.1580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7064.0516; train_optim_loss: 7064.0516; val_kl_reg_loss: 418.7263; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6544.3793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6963.1056; val_optim_loss: 6963.1056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9768; val_auprc_score: 0.9770; val_best_acc_score: 0.9196; val_best_f1_score: 0.9200; train_kl_reg_loss: 420.1573; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6639.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7059.9221; train_optim_loss: 7059.9221; val_kl_reg_loss: 415.6328; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6544.1225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6959.7553; val_optim_loss: 6959.7553
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9769; val_auprc_score: 0.9772; val_best_acc_score: 0.9199; val_best_f1_score: 0.9203; train_kl_reg_loss: 419.8307; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6638.9145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7058.7452; train_optim_loss: 7058.7452; val_kl_reg_loss: 416.1466; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6549.4904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6965.6370; val_optim_loss: 6965.6370
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9767; val_auprc_score: 0.9770; val_best_acc_score: 0.9195; val_best_f1_score: 0.9199; train_kl_reg_loss: 420.0507; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6640.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7060.8028; train_optim_loss: 7060.8028; val_kl_reg_loss: 415.5050; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6551.0641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6966.5691; val_optim_loss: 6966.5691
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9766; val_auprc_score: 0.9768; val_best_acc_score: 0.9190; val_best_f1_score: 0.9194; train_kl_reg_loss: 420.0140; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6640.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7060.9346; train_optim_loss: 7060.9346; val_kl_reg_loss: 415.4370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6547.3200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6962.7569; val_optim_loss: 6962.7569

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 517 min 19 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9765
Val AUPRC score: 0.9768
Val best accuracy score: 0.9184
Val best F1 score: 0.9190
Val gene expr MSE score: 1.6862

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
