None
Run timestamp: 14072023_002005_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9638; val_auprc_score: 0.9574; val_best_acc_score: 0.9026; val_best_f1_score: 0.9072; train_kl_reg_loss: 52819.6248; train_edge_recon_loss: 2774502.8481; train_gene_expr_recon_loss: 7076026.5997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9903349.0675; train_optim_loss: 9903349.0675; val_kl_reg_loss: 43467.9510; val_edge_recon_loss: 2693365.5305; val_gene_expr_recon_loss: 6687530.6742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9424364.1777; val_optim_loss: 9424364.1777
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9782; val_auprc_score: 0.9747; val_best_acc_score: 0.9277; val_best_f1_score: 0.9298; train_kl_reg_loss: 38208.1629; train_edge_recon_loss: 2673726.2285; train_gene_expr_recon_loss: 6602100.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9314034.7149; train_optim_loss: 9314034.7149; val_kl_reg_loss: 33942.8137; val_edge_recon_loss: 2665173.4199; val_gene_expr_recon_loss: 6536009.3118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9235125.5366; val_optim_loss: 9235125.5366
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9842; val_auprc_score: 0.9820; val_best_acc_score: 0.9389; val_best_f1_score: 0.9404; train_kl_reg_loss: 32682.8198; train_edge_recon_loss: 2651639.8975; train_gene_expr_recon_loss: 6515822.3602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9200145.0857; train_optim_loss: 9200145.0857; val_kl_reg_loss: 31415.0915; val_edge_recon_loss: 2655927.2491; val_gene_expr_recon_loss: 6497051.0226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9184393.3693; val_optim_loss: 9184393.3693
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9856; val_best_acc_score: 0.9473; val_best_f1_score: 0.9485; train_kl_reg_loss: 30524.7862; train_edge_recon_loss: 2637688.0572; train_gene_expr_recon_loss: 6478692.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9146905.3144; train_optim_loss: 9146905.3144; val_kl_reg_loss: 29703.1899; val_edge_recon_loss: 2641905.8197; val_gene_expr_recon_loss: 6475133.8449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9146742.8676; val_optim_loss: 9146742.8676
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9891; val_auprc_score: 0.9876; val_best_acc_score: 0.9506; val_best_f1_score: 0.9515; train_kl_reg_loss: 29136.2857; train_edge_recon_loss: 2631540.5712; train_gene_expr_recon_loss: 6457348.6028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9118025.4585; train_optim_loss: 9118025.4585; val_kl_reg_loss: 28344.8584; val_edge_recon_loss: 2640330.9364; val_gene_expr_recon_loss: 6459112.8380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9127788.5923; val_optim_loss: 9127788.5923
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9901; val_auprc_score: 0.9887; val_best_acc_score: 0.9539; val_best_f1_score: 0.9547; train_kl_reg_loss: 28022.8263; train_edge_recon_loss: 2626798.5144; train_gene_expr_recon_loss: 6444258.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9099079.6579; train_optim_loss: 9099079.6579; val_kl_reg_loss: 27090.1657; val_edge_recon_loss: 2636001.1150; val_gene_expr_recon_loss: 6470556.3136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9133647.6063; val_optim_loss: 9133647.6063
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9910; val_auprc_score: 0.9896; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 27159.5548; train_edge_recon_loss: 2623647.0209; train_gene_expr_recon_loss: 6436161.6408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9086968.2228; train_optim_loss: 9086968.2228; val_kl_reg_loss: 26424.4861; val_edge_recon_loss: 2630747.6185; val_gene_expr_recon_loss: 6444375.8693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9101547.9617; val_optim_loss: 9101547.9617
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9915; val_auprc_score: 0.9903; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 26490.0271; train_edge_recon_loss: 2621608.5911; train_gene_expr_recon_loss: 6426847.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9074946.0349; train_optim_loss: 9074946.0349; val_kl_reg_loss: 26135.4713; val_edge_recon_loss: 2629843.9721; val_gene_expr_recon_loss: 6435296.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9091275.7979; val_optim_loss: 9091275.7979
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9917; val_auprc_score: 0.9904; val_best_acc_score: 0.9596; val_best_f1_score: 0.9603; train_kl_reg_loss: 25875.9800; train_edge_recon_loss: 2619301.7076; train_gene_expr_recon_loss: 6417574.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9062751.7265; train_optim_loss: 9062751.7265; val_kl_reg_loss: 25603.9675; val_edge_recon_loss: 2627698.6882; val_gene_expr_recon_loss: 6444090.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9097392.8589; val_optim_loss: 9097392.8589
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 25419.6253; train_edge_recon_loss: 2617061.7602; train_gene_expr_recon_loss: 6410798.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9053280.3301; train_optim_loss: 9053280.3301; val_kl_reg_loss: 25281.7395; val_edge_recon_loss: 2626745.5514; val_gene_expr_recon_loss: 6435053.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9087080.9373; val_optim_loss: 9087080.9373
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9924; val_auprc_score: 0.9912; val_best_acc_score: 0.9619; val_best_f1_score: 0.9625; train_kl_reg_loss: 24997.8898; train_edge_recon_loss: 2615126.6713; train_gene_expr_recon_loss: 6406242.0933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9046366.6592; train_optim_loss: 9046366.6592; val_kl_reg_loss: 24965.4869; val_edge_recon_loss: 2625293.6742; val_gene_expr_recon_loss: 6445476.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9095735.5575; val_optim_loss: 9095735.5575
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9919; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 24682.5422; train_edge_recon_loss: 2612691.0370; train_gene_expr_recon_loss: 6403815.4888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9041189.0741; train_optim_loss: 9041189.0741; val_kl_reg_loss: 25160.8972; val_edge_recon_loss: 2623792.3606; val_gene_expr_recon_loss: 6441042.5070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9089995.7596; val_optim_loss: 9089995.7596
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9921; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 24415.3149; train_edge_recon_loss: 2611992.3125; train_gene_expr_recon_loss: 6398649.8156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9035057.4438; train_optim_loss: 9035057.4438; val_kl_reg_loss: 24065.6747; val_edge_recon_loss: 2622168.5645; val_gene_expr_recon_loss: 6424067.6934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9070301.9303; val_optim_loss: 9070301.9303
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9655; val_best_f1_score: 0.9659; train_kl_reg_loss: 24169.4449; train_edge_recon_loss: 2610166.6042; train_gene_expr_recon_loss: 6394679.8309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9029015.8829; train_optim_loss: 9029015.8829; val_kl_reg_loss: 23158.4522; val_edge_recon_loss: 2620705.4321; val_gene_expr_recon_loss: 6437798.5557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9081662.4739; val_optim_loss: 9081662.4739
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 23980.4714; train_edge_recon_loss: 2608977.2929; train_gene_expr_recon_loss: 6391945.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9024903.0112; train_optim_loss: 9024903.0112; val_kl_reg_loss: 23540.6217; val_edge_recon_loss: 2620593.4826; val_gene_expr_recon_loss: 6447208.1969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9091342.2979; val_optim_loss: 9091342.2979
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 23824.9072; train_edge_recon_loss: 2607815.8612; train_gene_expr_recon_loss: 6390945.4005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9022586.1691; train_optim_loss: 9022586.1691; val_kl_reg_loss: 23607.0730; val_edge_recon_loss: 2615426.9408; val_gene_expr_recon_loss: 6442134.7909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9081168.8362; val_optim_loss: 9081168.8362
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9647; val_best_f1_score: 0.9651; train_kl_reg_loss: 23613.8547; train_edge_recon_loss: 2606227.5211; train_gene_expr_recon_loss: 6387186.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017028.1674; train_optim_loss: 9017028.1674; val_kl_reg_loss: 24287.3576; val_edge_recon_loss: 2619185.3789; val_gene_expr_recon_loss: 6426686.2631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9070159.0105; val_optim_loss: 9070159.0105
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9924; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 23499.4236; train_edge_recon_loss: 2606269.9174; train_gene_expr_recon_loss: 6387496.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017265.6705; train_optim_loss: 9017265.6705; val_kl_reg_loss: 23373.1213; val_edge_recon_loss: 2615896.4443; val_gene_expr_recon_loss: 6431319.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9070588.7143; val_optim_loss: 9070588.7143
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9937; val_auprc_score: 0.9926; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 23363.9115; train_edge_recon_loss: 2605585.8610; train_gene_expr_recon_loss: 6383831.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9012781.3757; train_optim_loss: 9012781.3757; val_kl_reg_loss: 23186.1983; val_edge_recon_loss: 2616050.2814; val_gene_expr_recon_loss: 6453700.8031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092937.2892; val_optim_loss: 9092937.2892
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9937; val_auprc_score: 0.9927; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 23231.8470; train_edge_recon_loss: 2604531.5004; train_gene_expr_recon_loss: 6385001.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9012764.5089; train_optim_loss: 9012764.5089; val_kl_reg_loss: 22965.7248; val_edge_recon_loss: 2617311.2535; val_gene_expr_recon_loss: 6436740.6132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9077017.5732; val_optim_loss: 9077017.5732
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9933; val_auprc_score: 0.9920; val_best_acc_score: 0.9666; val_best_f1_score: 0.9670; train_kl_reg_loss: 23138.5249; train_edge_recon_loss: 2604558.1584; train_gene_expr_recon_loss: 6382339.3284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9010036.0050; train_optim_loss: 9010036.0050; val_kl_reg_loss: 22539.2846; val_edge_recon_loss: 2613933.4503; val_gene_expr_recon_loss: 6434363.8432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9070836.6028; val_optim_loss: 9070836.6028

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9938; val_auprc_score: 0.9927; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 24432.3155; train_edge_recon_loss: 2602509.4162; train_gene_expr_recon_loss: 6338381.4585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8965323.1965; train_optim_loss: 8965323.1965; val_kl_reg_loss: 24544.1554; val_edge_recon_loss: 2610948.7125; val_gene_expr_recon_loss: 6395927.4948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9031420.3484; val_optim_loss: 9031420.3484
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9937; val_auprc_score: 0.9925; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 24908.8911; train_edge_recon_loss: 2601530.4975; train_gene_expr_recon_loss: 6335259.3635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8961698.7519; train_optim_loss: 8961698.7519; val_kl_reg_loss: 24796.8039; val_edge_recon_loss: 2610576.8389; val_gene_expr_recon_loss: 6390188.0279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9025561.6690; val_optim_loss: 9025561.6690
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9939; val_auprc_score: 0.9929; val_best_acc_score: 0.9677; val_best_f1_score: 0.9681; train_kl_reg_loss: 25013.6410; train_edge_recon_loss: 2601170.0862; train_gene_expr_recon_loss: 6336007.2025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8962190.9302; train_optim_loss: 8962190.9302; val_kl_reg_loss: 24815.0373; val_edge_recon_loss: 2609827.2474; val_gene_expr_recon_loss: 6388836.4617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9023478.7700; val_optim_loss: 9023478.7700
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9680; val_best_f1_score: 0.9683; train_kl_reg_loss: 25123.9816; train_edge_recon_loss: 2601666.8611; train_gene_expr_recon_loss: 6336830.5180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8963621.3567; train_optim_loss: 8963621.3567; val_kl_reg_loss: 24849.9778; val_edge_recon_loss: 2610396.5993; val_gene_expr_recon_loss: 6399064.4895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9034311.0401; val_optim_loss: 9034311.0401
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9937; val_auprc_score: 0.9925; val_best_acc_score: 0.9677; val_best_f1_score: 0.9680; train_kl_reg_loss: 25152.5528; train_edge_recon_loss: 2600864.1216; train_gene_expr_recon_loss: 6334021.7779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8960038.4486; train_optim_loss: 8960038.4486; val_kl_reg_loss: 24728.9449; val_edge_recon_loss: 2610015.4338; val_gene_expr_recon_loss: 6392476.4948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9027220.9059; val_optim_loss: 9027220.9059
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9939; val_auprc_score: 0.9929; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 25121.1915; train_edge_recon_loss: 2601205.7519; train_gene_expr_recon_loss: 6331851.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8958178.2194; train_optim_loss: 8958178.2194; val_kl_reg_loss: 24813.6818; val_edge_recon_loss: 2610150.1899; val_gene_expr_recon_loss: 6398039.5958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9033003.4495; val_optim_loss: 9033003.4495
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9938; val_auprc_score: 0.9926; val_best_acc_score: 0.9678; val_best_f1_score: 0.9682; train_kl_reg_loss: 25062.6676; train_edge_recon_loss: 2600162.0512; train_gene_expr_recon_loss: 6330225.1073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8955449.8282; train_optim_loss: 8955449.8282; val_kl_reg_loss: 24786.9181; val_edge_recon_loss: 2608628.4503; val_gene_expr_recon_loss: 6389277.3084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022692.6847; val_optim_loss: 9022692.6847
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9940; val_auprc_score: 0.9930; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 25024.0436; train_edge_recon_loss: 2601041.4495; train_gene_expr_recon_loss: 6329356.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8955421.7318; train_optim_loss: 8955421.7318; val_kl_reg_loss: 24836.4840; val_edge_recon_loss: 2611041.6995; val_gene_expr_recon_loss: 6393283.0174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9029161.1951; val_optim_loss: 9029161.1951
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9938; val_auprc_score: 0.9927; val_best_acc_score: 0.9680; val_best_f1_score: 0.9683; train_kl_reg_loss: 25037.5962; train_edge_recon_loss: 2599460.3012; train_gene_expr_recon_loss: 6327849.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8952347.3902; train_optim_loss: 8952347.3902; val_kl_reg_loss: 24855.1422; val_edge_recon_loss: 2609522.1786; val_gene_expr_recon_loss: 6400109.9129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9034487.2439; val_optim_loss: 9034487.2439
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9940; val_auprc_score: 0.9929; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 24974.3149; train_edge_recon_loss: 2600379.0328; train_gene_expr_recon_loss: 6327829.7230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8953183.0718; train_optim_loss: 8953183.0718; val_kl_reg_loss: 24829.0374; val_edge_recon_loss: 2609029.6882; val_gene_expr_recon_loss: 6392333.5209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9026192.2352; val_optim_loss: 9026192.2352
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9675; val_best_f1_score: 0.9678; train_kl_reg_loss: 24996.0299; train_edge_recon_loss: 2599537.7923; train_gene_expr_recon_loss: 6329386.6488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8953920.4686; train_optim_loss: 8953920.4686; val_kl_reg_loss: 24725.5528; val_edge_recon_loss: 2612321.1280; val_gene_expr_recon_loss: 6398101.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9035148.0209; val_optim_loss: 9035148.0209

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9941; val_auprc_score: 0.9930; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 25072.5517; train_edge_recon_loss: 2600238.5954; train_gene_expr_recon_loss: 6323071.4496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8948382.6051; train_optim_loss: 8948382.6051; val_kl_reg_loss: 24831.4282; val_edge_recon_loss: 2608295.4408; val_gene_expr_recon_loss: 6381687.4111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9014814.2805; val_optim_loss: 9014814.2805
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9939; val_auprc_score: 0.9928; val_best_acc_score: 0.9678; val_best_f1_score: 0.9682; train_kl_reg_loss: 25098.6081; train_edge_recon_loss: 2599811.9753; train_gene_expr_recon_loss: 6323903.9682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8948814.5564; train_optim_loss: 8948814.5564; val_kl_reg_loss: 24801.4198; val_edge_recon_loss: 2609682.0854; val_gene_expr_recon_loss: 6388233.6707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022717.1742; val_optim_loss: 9022717.1742
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 25121.1736; train_edge_recon_loss: 2600178.9916; train_gene_expr_recon_loss: 6323635.3737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8948935.5376; train_optim_loss: 8948935.5376; val_kl_reg_loss: 24928.1820; val_edge_recon_loss: 2608735.2517; val_gene_expr_recon_loss: 6392587.6115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9026251.0453; val_optim_loss: 9026251.0453
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9940; val_auprc_score: 0.9927; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 25160.5698; train_edge_recon_loss: 2599469.1980; train_gene_expr_recon_loss: 6323753.2409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8948383.0128; train_optim_loss: 8948383.0128; val_kl_reg_loss: 24905.4161; val_edge_recon_loss: 2611661.8632; val_gene_expr_recon_loss: 6386507.1760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9023074.4355; val_optim_loss: 9023074.4355
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9940; val_auprc_score: 0.9929; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 25164.0389; train_edge_recon_loss: 2599833.5134; train_gene_expr_recon_loss: 6321135.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8946132.8200; train_optim_loss: 8946132.8200; val_kl_reg_loss: 24935.7764; val_edge_recon_loss: 2608861.3014; val_gene_expr_recon_loss: 6388561.4425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022358.4965; val_optim_loss: 9022358.4965

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 25169.2750; train_edge_recon_loss: 2600510.7040; train_gene_expr_recon_loss: 6320587.7898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8946267.7797; train_optim_loss: 8946267.7797; val_kl_reg_loss: 24913.1564; val_edge_recon_loss: 2610176.7491; val_gene_expr_recon_loss: 6395365.1690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9030455.0366; val_optim_loss: 9030455.0366
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9941; val_auprc_score: 0.9930; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 25170.3659; train_edge_recon_loss: 2600733.9019; train_gene_expr_recon_loss: 6320678.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8946582.5376; train_optim_loss: 8946582.5376; val_kl_reg_loss: 24905.7837; val_edge_recon_loss: 2609169.8415; val_gene_expr_recon_loss: 6390756.6359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9024832.2422; val_optim_loss: 9024832.2422
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 25168.6107; train_edge_recon_loss: 2599520.9419; train_gene_expr_recon_loss: 6320049.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8944738.6491; train_optim_loss: 8944738.6491; val_kl_reg_loss: 24917.1506; val_edge_recon_loss: 2607859.2326; val_gene_expr_recon_loss: 6390782.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9023558.8397; val_optim_loss: 9023558.8397
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9939; val_auprc_score: 0.9927; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 25172.0507; train_edge_recon_loss: 2600667.7259; train_gene_expr_recon_loss: 6322455.1127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8948294.8920; train_optim_loss: 8948294.8920; val_kl_reg_loss: 24898.5953; val_edge_recon_loss: 2609877.2117; val_gene_expr_recon_loss: 6391776.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9026552.6202; val_optim_loss: 9026552.6202

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 812 min 2 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9940
Val AUPRC score: 0.9929
Val best accuracy score: 0.9682
Val best F1 score: 0.9685
Val gene expr MSE score: 1.5923

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
