Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 7212.0854; train_edge_recon_loss: 258595.8745; train_gene_expr_recon_loss: 195633.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461441.8027; train_optim_loss: 461441.8027; val_kl_reg_loss: 7157.0654; val_edge_recon_loss: 258662.6547; val_gene_expr_recon_loss: 195863.4241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461683.1452; val_optim_loss: 461683.1452
None
Run timestamp: 01072023_024809_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9898; val_auprc_score: 0.9895; val_best_acc_score: 0.9483; val_best_f1_score: 0.9486; train_kl_reg_loss: 8410.7281; train_edge_recon_loss: 272970.8078; train_gene_expr_recon_loss: 150114.0863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431495.6225; train_optim_loss: 431495.6225; val_kl_reg_loss: 7932.4081; val_edge_recon_loss: 266664.7615; val_gene_expr_recon_loss: 137722.4597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412319.6307; val_optim_loss: 412319.6307
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9935; val_auprc_score: 0.9931; val_best_acc_score: 0.9604; val_best_f1_score: 0.9606; train_kl_reg_loss: 7663.1869; train_edge_recon_loss: 264924.2984; train_gene_expr_recon_loss: 135359.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407947.3121; train_optim_loss: 407947.3121; val_kl_reg_loss: 7362.0840; val_edge_recon_loss: 264297.2592; val_gene_expr_recon_loss: 132690.7458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404350.0872; val_optim_loss: 404350.0872
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9785; val_best_f1_score: 0.9785; train_kl_reg_loss: 7208.5872; train_edge_recon_loss: 258647.8396; train_gene_expr_recon_loss: 195612.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461468.8850; train_optim_loss: 461468.8850; val_kl_reg_loss: 7155.2232; val_edge_recon_loss: 258854.8901; val_gene_expr_recon_loss: 195975.0238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461985.1371; val_optim_loss: 461985.1371
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9951; val_auprc_score: 0.9948; val_best_acc_score: 0.9667; val_best_f1_score: 0.9667; train_kl_reg_loss: 7249.1833; train_edge_recon_loss: 263265.0574; train_gene_expr_recon_loss: 132090.0610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402604.3016; train_optim_loss: 402604.3016; val_kl_reg_loss: 7106.4923; val_edge_recon_loss: 263129.5397; val_gene_expr_recon_loss: 130660.2881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400896.3198; val_optim_loss: 400896.3198
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 7207.5089; train_edge_recon_loss: 258606.4968; train_gene_expr_recon_loss: 195637.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461451.5712; train_optim_loss: 461451.5712; val_kl_reg_loss: 7153.6384; val_edge_recon_loss: 258960.6384; val_gene_expr_recon_loss: 195907.5762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462021.8525; val_optim_loss: 462021.8525
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9708; val_best_f1_score: 0.9709; train_kl_reg_loss: 7035.5764; train_edge_recon_loss: 262269.2061; train_gene_expr_recon_loss: 130590.6899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399895.4726; train_optim_loss: 399895.4726; val_kl_reg_loss: 6912.7747; val_edge_recon_loss: 262580.3950; val_gene_expr_recon_loss: 129780.3697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399273.5402; val_optim_loss: 399273.5402
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 7205.3655; train_edge_recon_loss: 258619.1399; train_gene_expr_recon_loss: 195610.8812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461435.3858; train_optim_loss: 461435.3858; val_kl_reg_loss: 7144.5422; val_edge_recon_loss: 258587.8001; val_gene_expr_recon_loss: 195881.3434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461613.6893; val_optim_loss: 461613.6893
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9961; val_auprc_score: 0.9959; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 6890.8657; train_edge_recon_loss: 261670.7709; train_gene_expr_recon_loss: 129681.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398242.6516; train_optim_loss: 398242.6516; val_kl_reg_loss: 6647.0389; val_edge_recon_loss: 261836.1796; val_gene_expr_recon_loss: 129083.5242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397566.7431; val_optim_loss: 397566.7431
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 6785.9572; train_edge_recon_loss: 261208.4738; train_gene_expr_recon_loss: 129152.2541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397146.6853; train_optim_loss: 397146.6853; val_kl_reg_loss: 6660.9291; val_edge_recon_loss: 261487.8935; val_gene_expr_recon_loss: 128823.1890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396972.0105; val_optim_loss: 396972.0105
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 7204.6505; train_edge_recon_loss: 258607.3230; train_gene_expr_recon_loss: 195607.5096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461419.4833; train_optim_loss: 461419.4833; val_kl_reg_loss: 7141.7023; val_edge_recon_loss: 258751.8360; val_gene_expr_recon_loss: 195984.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461878.2411; val_optim_loss: 461878.2411
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9739; val_best_f1_score: 0.9739; train_kl_reg_loss: 6732.1696; train_edge_recon_loss: 260817.2581; train_gene_expr_recon_loss: 128755.5652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396304.9926; train_optim_loss: 396304.9926; val_kl_reg_loss: 6627.5868; val_edge_recon_loss: 260995.6506; val_gene_expr_recon_loss: 128509.7467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396132.9836; val_optim_loss: 396132.9836
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 7204.2536; train_edge_recon_loss: 258570.8175; train_gene_expr_recon_loss: 195644.7984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461419.8695; train_optim_loss: 461419.8695; val_kl_reg_loss: 7131.7457; val_edge_recon_loss: 258784.5231; val_gene_expr_recon_loss: 196074.0226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461990.2907; val_optim_loss: 461990.2907
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9747; val_best_f1_score: 0.9749; train_kl_reg_loss: 6696.7963; train_edge_recon_loss: 260515.7155; train_gene_expr_recon_loss: 128475.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395688.3545; train_optim_loss: 395688.3545; val_kl_reg_loss: 6598.1345; val_edge_recon_loss: 260507.8099; val_gene_expr_recon_loss: 128225.4751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395331.4193; val_optim_loss: 395331.4193
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 7201.6835; train_edge_recon_loss: 258635.6660; train_gene_expr_recon_loss: 195631.4925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461468.8420; train_optim_loss: 461468.8420; val_kl_reg_loss: 7144.2733; val_edge_recon_loss: 258895.9597; val_gene_expr_recon_loss: 195946.4025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461986.6337; val_optim_loss: 461986.6337
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 6674.5351; train_edge_recon_loss: 260322.2220; train_gene_expr_recon_loss: 128281.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395278.2901; train_optim_loss: 395278.2901; val_kl_reg_loss: 6570.6130; val_edge_recon_loss: 260492.4216; val_gene_expr_recon_loss: 128071.7733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395134.8083; val_optim_loss: 395134.8083
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9764; val_best_f1_score: 0.9764; train_kl_reg_loss: 6659.3645; train_edge_recon_loss: 260201.9745; train_gene_expr_recon_loss: 128071.1122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394932.4516; train_optim_loss: 394932.4516; val_kl_reg_loss: 6561.0908; val_edge_recon_loss: 260541.1429; val_gene_expr_recon_loss: 127722.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394824.4697; val_optim_loss: 394824.4697
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 7197.8623; train_edge_recon_loss: 258651.1623; train_gene_expr_recon_loss: 195637.0134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461486.0376; train_optim_loss: 461486.0376; val_kl_reg_loss: 7126.6581; val_edge_recon_loss: 258834.4662; val_gene_expr_recon_loss: 196067.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462028.4856; val_optim_loss: 462028.4856
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 6656.0268; train_edge_recon_loss: 259949.9613; train_gene_expr_recon_loss: 127913.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394519.2676; train_optim_loss: 394519.2676; val_kl_reg_loss: 6553.4728; val_edge_recon_loss: 260241.1310; val_gene_expr_recon_loss: 127720.3567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394514.9612; val_optim_loss: 394514.9612

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 7195.7141; train_edge_recon_loss: 258611.6625; train_gene_expr_recon_loss: 195563.6916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461371.0680; train_optim_loss: 461371.0680; val_kl_reg_loss: 7131.8304; val_edge_recon_loss: 258874.5194; val_gene_expr_recon_loss: 195683.5011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461689.8532; val_optim_loss: 461689.8532
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 6642.0492; train_edge_recon_loss: 259983.9361; train_gene_expr_recon_loss: 127772.6508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394398.6363; train_optim_loss: 394398.6363; val_kl_reg_loss: 6635.2138; val_edge_recon_loss: 260285.1860; val_gene_expr_recon_loss: 127496.5790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394416.9775; val_optim_loss: 394416.9775
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 7197.6062; train_edge_recon_loss: 258618.2164; train_gene_expr_recon_loss: 195581.3037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461397.1254; train_optim_loss: 461397.1254; val_kl_reg_loss: 7138.3541; val_edge_recon_loss: 258703.0900; val_gene_expr_recon_loss: 196007.9185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461849.3629; val_optim_loss: 461849.3629
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 6641.4639; train_edge_recon_loss: 259781.8072; train_gene_expr_recon_loss: 127655.5302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394078.8017; train_optim_loss: 394078.8017; val_kl_reg_loss: 6604.5741; val_edge_recon_loss: 260145.1373; val_gene_expr_recon_loss: 127530.8253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394280.5352; val_optim_loss: 394280.5352
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 6642.3304; train_edge_recon_loss: 259714.4825; train_gene_expr_recon_loss: 127547.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393904.2165; train_optim_loss: 393904.2165; val_kl_reg_loss: 6590.2603; val_edge_recon_loss: 259881.1552; val_gene_expr_recon_loss: 127466.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393937.9792; val_optim_loss: 393937.9792
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 7197.9205; train_edge_recon_loss: 258582.5511; train_gene_expr_recon_loss: 195570.5514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461351.0227; train_optim_loss: 461351.0227; val_kl_reg_loss: 7132.4293; val_edge_recon_loss: 258847.3142; val_gene_expr_recon_loss: 195639.2110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461618.9561; val_optim_loss: 461618.9561
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 6641.5727; train_edge_recon_loss: 259665.7435; train_gene_expr_recon_loss: 127434.3630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393741.6794; train_optim_loss: 393741.6794; val_kl_reg_loss: 6650.4482; val_edge_recon_loss: 259770.7641; val_gene_expr_recon_loss: 127296.3035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393717.5176; val_optim_loss: 393717.5176
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 7197.3256; train_edge_recon_loss: 258638.9111; train_gene_expr_recon_loss: 195591.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461428.2183; train_optim_loss: 461428.2183; val_kl_reg_loss: 7136.7876; val_edge_recon_loss: 258825.2893; val_gene_expr_recon_loss: 195798.9341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461761.0109; val_optim_loss: 461761.0109
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 6643.6581; train_edge_recon_loss: 259515.4985; train_gene_expr_recon_loss: 127338.3339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393497.4908; train_optim_loss: 393497.4908; val_kl_reg_loss: 6695.1145; val_edge_recon_loss: 259791.3712; val_gene_expr_recon_loss: 127274.6370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393761.1226; val_optim_loss: 393761.1226

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 725 min 15 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9972
Val best accuracy score: 0.9782
Val best F1 score: 0.9784
Val gene expr MSE score: 7.8885

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 6645.8948; train_edge_recon_loss: 259420.0681; train_gene_expr_recon_loss: 127290.7063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393356.6694; train_optim_loss: 393356.6694; val_kl_reg_loss: 6451.4134; val_edge_recon_loss: 259623.3232; val_gene_expr_recon_loss: 127306.6105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393381.3461; val_optim_loss: 393381.3461
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 6645.5551; train_edge_recon_loss: 259413.0432; train_gene_expr_recon_loss: 127160.1451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393218.7435; train_optim_loss: 393218.7435; val_kl_reg_loss: 6682.8693; val_edge_recon_loss: 259682.3644; val_gene_expr_recon_loss: 127112.2676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393477.5032; val_optim_loss: 393477.5032
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9789; val_best_f1_score: 0.9789; train_kl_reg_loss: 6646.4936; train_edge_recon_loss: 259389.6874; train_gene_expr_recon_loss: 127103.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393139.4178; train_optim_loss: 393139.4178; val_kl_reg_loss: 6581.1415; val_edge_recon_loss: 259589.7508; val_gene_expr_recon_loss: 127192.1426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393363.0344; val_optim_loss: 393363.0344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 6643.9758; train_edge_recon_loss: 259360.7380; train_gene_expr_recon_loss: 127042.7491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393047.4633; train_optim_loss: 393047.4633; val_kl_reg_loss: 6651.7423; val_edge_recon_loss: 259438.3097; val_gene_expr_recon_loss: 127113.4240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393203.4771; val_optim_loss: 393203.4771
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9810; val_best_f1_score: 0.9810; train_kl_reg_loss: 6653.4580; train_edge_recon_loss: 259185.0174; train_gene_expr_recon_loss: 127051.4050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392889.8798; train_optim_loss: 392889.8798; val_kl_reg_loss: 6426.7870; val_edge_recon_loss: 259257.7329; val_gene_expr_recon_loss: 127122.6089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392807.1303; val_optim_loss: 392807.1303
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 6649.0656; train_edge_recon_loss: 259195.1725; train_gene_expr_recon_loss: 127006.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392850.3918; train_optim_loss: 392850.3918; val_kl_reg_loss: 6662.0085; val_edge_recon_loss: 259412.9254; val_gene_expr_recon_loss: 127108.6095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393183.5441; val_optim_loss: 393183.5441
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 6651.5076; train_edge_recon_loss: 259139.3623; train_gene_expr_recon_loss: 126930.1470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392721.0171; train_optim_loss: 392721.0171; val_kl_reg_loss: 6654.3727; val_edge_recon_loss: 259526.4735; val_gene_expr_recon_loss: 127004.2309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393185.0761; val_optim_loss: 393185.0761
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 6653.0460; train_edge_recon_loss: 259123.9388; train_gene_expr_recon_loss: 126891.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392668.3347; train_optim_loss: 392668.3347; val_kl_reg_loss: 6552.9647; val_edge_recon_loss: 259432.4908; val_gene_expr_recon_loss: 126987.8891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392973.3447; val_optim_loss: 392973.3447
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 6654.3513; train_edge_recon_loss: 259095.1720; train_gene_expr_recon_loss: 126878.2351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392627.7591; train_optim_loss: 392627.7591; val_kl_reg_loss: 6628.0478; val_edge_recon_loss: 259217.9364; val_gene_expr_recon_loss: 126872.6848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392718.6693; val_optim_loss: 392718.6693
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 6656.3295; train_edge_recon_loss: 259017.4741; train_gene_expr_recon_loss: 126842.7990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392516.6027; train_optim_loss: 392516.6027; val_kl_reg_loss: 6682.4906; val_edge_recon_loss: 259154.6653; val_gene_expr_recon_loss: 127007.8575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392845.0146; val_optim_loss: 392845.0146
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 6652.9503; train_edge_recon_loss: 259008.9418; train_gene_expr_recon_loss: 126788.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392450.3049; train_optim_loss: 392450.3049; val_kl_reg_loss: 6524.7550; val_edge_recon_loss: 259254.4462; val_gene_expr_recon_loss: 126939.8586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392719.0587; val_optim_loss: 392719.0587
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 6657.7330; train_edge_recon_loss: 258969.9516; train_gene_expr_recon_loss: 126783.9730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392411.6581; train_optim_loss: 392411.6581; val_kl_reg_loss: 6622.9622; val_edge_recon_loss: 259264.8729; val_gene_expr_recon_loss: 126864.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392752.3226; val_optim_loss: 392752.3226
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 6656.8284; train_edge_recon_loss: 258941.1982; train_gene_expr_recon_loss: 126751.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392349.2698; train_optim_loss: 392349.2698; val_kl_reg_loss: 6537.6725; val_edge_recon_loss: 259195.2523; val_gene_expr_recon_loss: 127070.4236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392803.3489; val_optim_loss: 392803.3489

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9818; val_best_f1_score: 0.9818; train_kl_reg_loss: 6710.1985; train_edge_recon_loss: 258628.6853; train_gene_expr_recon_loss: 125980.0519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391318.9355; train_optim_loss: 391318.9355; val_kl_reg_loss: 6713.9672; val_edge_recon_loss: 258895.5906; val_gene_expr_recon_loss: 126398.7829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392008.3420; val_optim_loss: 392008.3420
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 6704.3004; train_edge_recon_loss: 258592.2767; train_gene_expr_recon_loss: 125879.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391176.2568; train_optim_loss: 391176.2568; val_kl_reg_loss: 6612.4686; val_edge_recon_loss: 258742.5812; val_gene_expr_recon_loss: 126100.6537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391455.7031; val_optim_loss: 391455.7031
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 6695.1964; train_edge_recon_loss: 258648.0147; train_gene_expr_recon_loss: 125870.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391213.8671; train_optim_loss: 391213.8671; val_kl_reg_loss: 6656.5051; val_edge_recon_loss: 258932.5929; val_gene_expr_recon_loss: 126226.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391816.0376; val_optim_loss: 391816.0376
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 6693.3482; train_edge_recon_loss: 258599.4178; train_gene_expr_recon_loss: 125770.4346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391063.2008; train_optim_loss: 391063.2008; val_kl_reg_loss: 6621.0621; val_edge_recon_loss: 259025.3501; val_gene_expr_recon_loss: 126160.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391806.4381; val_optim_loss: 391806.4381
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9828; val_best_f1_score: 0.9828; train_kl_reg_loss: 6689.6914; train_edge_recon_loss: 258628.4682; train_gene_expr_recon_loss: 125777.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391095.5068; train_optim_loss: 391095.5068; val_kl_reg_loss: 6640.6082; val_edge_recon_loss: 258805.0614; val_gene_expr_recon_loss: 126226.5639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391672.2326; val_optim_loss: 391672.2326
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9822; val_best_f1_score: 0.9822; train_kl_reg_loss: 6688.5701; train_edge_recon_loss: 258562.0809; train_gene_expr_recon_loss: 125726.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390977.3914; train_optim_loss: 390977.3914; val_kl_reg_loss: 6671.4982; val_edge_recon_loss: 259028.5570; val_gene_expr_recon_loss: 126050.7592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391750.8143; val_optim_loss: 391750.8143

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9826; val_best_f1_score: 0.9826; train_kl_reg_loss: 6694.3535; train_edge_recon_loss: 258542.2407; train_gene_expr_recon_loss: 125656.8547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390893.4491; train_optim_loss: 390893.4491; val_kl_reg_loss: 6636.6231; val_edge_recon_loss: 258829.6813; val_gene_expr_recon_loss: 126091.2857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391557.5884; val_optim_loss: 391557.5884
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9824; val_best_f1_score: 0.9824; train_kl_reg_loss: 6695.7667; train_edge_recon_loss: 258578.0561; train_gene_expr_recon_loss: 125621.3734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390895.1957; train_optim_loss: 390895.1957; val_kl_reg_loss: 6643.9731; val_edge_recon_loss: 258850.4682; val_gene_expr_recon_loss: 126090.0910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391584.5305; val_optim_loss: 391584.5305
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9825; val_best_f1_score: 0.9825; train_kl_reg_loss: 6695.6587; train_edge_recon_loss: 258506.6207; train_gene_expr_recon_loss: 125642.7584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390845.0379; train_optim_loss: 390845.0379; val_kl_reg_loss: 6635.2360; val_edge_recon_loss: 258892.5602; val_gene_expr_recon_loss: 126112.9429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391640.7391; val_optim_loss: 391640.7391
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 6693.7958; train_edge_recon_loss: 258602.3133; train_gene_expr_recon_loss: 125603.8075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390899.9166; train_optim_loss: 390899.9166; val_kl_reg_loss: 6640.5733; val_edge_recon_loss: 258899.0347; val_gene_expr_recon_loss: 126152.7009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391692.3085; val_optim_loss: 391692.3085

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 577 min 54 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9979
Val best accuracy score: 0.9818
Val best F1 score: 0.9819
Val gene expr MSE score: 8.3751

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
