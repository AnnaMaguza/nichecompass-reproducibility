None
Run timestamp: 19072023_230359_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9858; val_auprc_score: 0.9821; val_best_acc_score: 0.9503; val_best_f1_score: 0.9514; train_kl_reg_loss: 154379.0100; train_edge_recon_loss: 26893722.3640; train_gene_expr_recon_loss: 11875564.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38923665.9338; train_optim_loss: 38923665.9338; val_kl_reg_loss: 144237.6050; val_edge_recon_loss: 26160074.7869; val_gene_expr_recon_loss: 10980242.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37284554.8852; val_optim_loss: 37284554.8852
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9891; val_auprc_score: 0.9870; val_best_acc_score: 0.9541; val_best_f1_score: 0.9552; train_kl_reg_loss: 130975.1668; train_edge_recon_loss: 25975688.4118; train_gene_expr_recon_loss: 10666600.2243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36773263.7721; train_optim_loss: 36773263.7721; val_kl_reg_loss: 117269.0958; val_edge_recon_loss: 25904664.1639; val_gene_expr_recon_loss: 10612930.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36634864.2623; val_optim_loss: 36634864.2623
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9629; val_best_f1_score: 0.9636; train_kl_reg_loss: 109166.0382; train_edge_recon_loss: 25783572.5257; train_gene_expr_recon_loss: 10389635.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36282373.5956; train_optim_loss: 36282373.5956; val_kl_reg_loss: 101974.6488; val_edge_recon_loss: 25759380.9508; val_gene_expr_recon_loss: 10362636.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36223991.8033; val_optim_loss: 36223991.8033
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 98647.6885; train_edge_recon_loss: 25717936.6765; train_gene_expr_recon_loss: 10203050.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36019634.4118; train_optim_loss: 36019634.4118; val_kl_reg_loss: 89789.8888; val_edge_recon_loss: 25733686.5574; val_gene_expr_recon_loss: 10231218.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36054695.0820; val_optim_loss: 36054695.0820
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 89135.0769; train_edge_recon_loss: 25676737.0956; train_gene_expr_recon_loss: 10080073.9706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35845946.1397; train_optim_loss: 35845946.1397; val_kl_reg_loss: 84390.4836; val_edge_recon_loss: 25724146.2623; val_gene_expr_recon_loss: 10137664.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35946201.7049; val_optim_loss: 35946201.7049
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 82393.7300; train_edge_recon_loss: 25641505.4559; train_gene_expr_recon_loss: 9994494.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35718393.3603; train_optim_loss: 35718393.3603; val_kl_reg_loss: 78435.7916; val_edge_recon_loss: 25664767.7377; val_gene_expr_recon_loss: 10060757.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35803961.1803; val_optim_loss: 35803961.1803
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9936; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 76693.9047; train_edge_recon_loss: 25618760.4228; train_gene_expr_recon_loss: 9928086.1471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35623540.5515; train_optim_loss: 35623540.5515; val_kl_reg_loss: 71980.7240; val_edge_recon_loss: 25615910.4262; val_gene_expr_recon_loss: 9994752.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35682643.8033; val_optim_loss: 35682643.8033
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 71954.7443; train_edge_recon_loss: 25586867.7059; train_gene_expr_recon_loss: 9874082.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35532904.6029; train_optim_loss: 35532904.6029; val_kl_reg_loss: 68116.6221; val_edge_recon_loss: 25619235.3770; val_gene_expr_recon_loss: 9964483.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35651835.4098; val_optim_loss: 35651835.4098
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9945; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 67924.3005; train_edge_recon_loss: 25566172.9596; train_gene_expr_recon_loss: 9839609.6213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35473706.8750; train_optim_loss: 35473706.8750; val_kl_reg_loss: 66697.6664; val_edge_recon_loss: 25634107.4426; val_gene_expr_recon_loss: 9939447.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35640252.5902; val_optim_loss: 35640252.5902
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 65401.4729; train_edge_recon_loss: 25536256.2684; train_gene_expr_recon_loss: 9799096.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35400754.1176; train_optim_loss: 35400754.1176; val_kl_reg_loss: 62062.8218; val_edge_recon_loss: 25581084.6230; val_gene_expr_recon_loss: 9914237.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35557384.9836; val_optim_loss: 35557384.9836
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 62900.9725; train_edge_recon_loss: 25527784.8824; train_gene_expr_recon_loss: 9772254.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35362939.8750; train_optim_loss: 35362939.8750; val_kl_reg_loss: 62134.3570; val_edge_recon_loss: 25615515.3115; val_gene_expr_recon_loss: 9884998.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35562648.2623; val_optim_loss: 35562648.2623
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 60715.8605; train_edge_recon_loss: 25520686.3419; train_gene_expr_recon_loss: 9731196.9246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35312599.1838; train_optim_loss: 35312599.1838; val_kl_reg_loss: 61320.7333; val_edge_recon_loss: 25510900.8197; val_gene_expr_recon_loss: 9857008.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35429230.5574; val_optim_loss: 35429230.5574
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 58821.2762; train_edge_recon_loss: 25511219.4853; train_gene_expr_recon_loss: 9691854.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35261895.4265; train_optim_loss: 35261895.4265; val_kl_reg_loss: 57342.1890; val_edge_recon_loss: 25547668.3279; val_gene_expr_recon_loss: 9856983.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35461994.0328; val_optim_loss: 35461994.0328
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 57152.2979; train_edge_recon_loss: 25500960.6801; train_gene_expr_recon_loss: 9675824.1526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35233937.1691; train_optim_loss: 35233937.1691; val_kl_reg_loss: 54278.9744; val_edge_recon_loss: 25544904.2295; val_gene_expr_recon_loss: 9815671.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35414854.5574; val_optim_loss: 35414854.5574
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 55182.1770; train_edge_recon_loss: 25504688.1471; train_gene_expr_recon_loss: 9656458.8199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35216329.1397; train_optim_loss: 35216329.1397; val_kl_reg_loss: 54390.9476; val_edge_recon_loss: 25547779.7705; val_gene_expr_recon_loss: 9786525.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35388696.0656; val_optim_loss: 35388696.0656
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 54172.6676; train_edge_recon_loss: 25491353.6471; train_gene_expr_recon_loss: 9631158.2004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35176684.4338; train_optim_loss: 35176684.4338; val_kl_reg_loss: 52521.6176; val_edge_recon_loss: 25525115.1148; val_gene_expr_recon_loss: 9790448.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35368085.7049; val_optim_loss: 35368085.7049
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 52701.1782; train_edge_recon_loss: 25485384.5993; train_gene_expr_recon_loss: 9613280.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35151366.1544; train_optim_loss: 35151366.1544; val_kl_reg_loss: 53749.3022; val_edge_recon_loss: 25493387.5082; val_gene_expr_recon_loss: 9756119.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35303256.3934; val_optim_loss: 35303256.3934
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 51978.1938; train_edge_recon_loss: 25479670.3493; train_gene_expr_recon_loss: 9592339.4412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35123988.0147; train_optim_loss: 35123988.0147; val_kl_reg_loss: 48529.2893; val_edge_recon_loss: 25521214.2623; val_gene_expr_recon_loss: 9767509.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35337252.8525; val_optim_loss: 35337252.8525
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 51380.4776; train_edge_recon_loss: 25465814.8162; train_gene_expr_recon_loss: 9563130.6691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35080325.9191; train_optim_loss: 35080325.9191; val_kl_reg_loss: 50921.3617; val_edge_recon_loss: 25513475.7377; val_gene_expr_recon_loss: 9750076.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35314472.9180; val_optim_loss: 35314472.9180
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 50909.1846; train_edge_recon_loss: 25468411.3824; train_gene_expr_recon_loss: 9555974.7702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35075295.2941; train_optim_loss: 35075295.2941; val_kl_reg_loss: 48647.3592; val_edge_recon_loss: 25533592.1639; val_gene_expr_recon_loss: 9736508.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35318747.7377; val_optim_loss: 35318747.7377
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 50119.8923; train_edge_recon_loss: 25465552.1912; train_gene_expr_recon_loss: 9532806.3952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35048478.5441; train_optim_loss: 35048478.5441; val_kl_reg_loss: 51634.3746; val_edge_recon_loss: 25497292.2295; val_gene_expr_recon_loss: 9725954.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274880.5902; val_optim_loss: 35274880.5902
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 49880.0768; train_edge_recon_loss: 25454087.7353; train_gene_expr_recon_loss: 9517529.0974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35021496.8456; train_optim_loss: 35021496.8456; val_kl_reg_loss: 50653.5194; val_edge_recon_loss: 25493090.5574; val_gene_expr_recon_loss: 9700681.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35244425.1148; val_optim_loss: 35244425.1148
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 49284.0728; train_edge_recon_loss: 25447645.0257; train_gene_expr_recon_loss: 9500626.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34997555.9632; train_optim_loss: 34997555.9632; val_kl_reg_loss: 48348.8807; val_edge_recon_loss: 25472607.1148; val_gene_expr_recon_loss: 9729972.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35250928.2623; val_optim_loss: 35250928.2623
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 48850.6409; train_edge_recon_loss: 25445404.5515; train_gene_expr_recon_loss: 9490394.3934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34984649.5809; train_optim_loss: 34984649.5809; val_kl_reg_loss: 50168.6629; val_edge_recon_loss: 25479121.8361; val_gene_expr_recon_loss: 9702229.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231519.8689; val_optim_loss: 35231519.8689
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 48452.9332; train_edge_recon_loss: 25447428.4044; train_gene_expr_recon_loss: 9471816.0478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34967697.3309; train_optim_loss: 34967697.3309; val_kl_reg_loss: 47996.6761; val_edge_recon_loss: 25428746.4262; val_gene_expr_recon_loss: 9683394.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35160138.3607; val_optim_loss: 35160138.3607
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 48247.6720; train_edge_recon_loss: 25441508.1287; train_gene_expr_recon_loss: 9455653.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34945409.6213; train_optim_loss: 34945409.6213; val_kl_reg_loss: 47852.4383; val_edge_recon_loss: 25483923.4098; val_gene_expr_recon_loss: 9708907.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35240682.9508; val_optim_loss: 35240682.9508
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 47716.0812; train_edge_recon_loss: 25439359.3787; train_gene_expr_recon_loss: 9452528.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34939603.9191; train_optim_loss: 34939603.9191; val_kl_reg_loss: 45819.3699; val_edge_recon_loss: 25468345.5410; val_gene_expr_recon_loss: 9660834.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35174999.2787; val_optim_loss: 35174999.2787
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 47843.7127; train_edge_recon_loss: 25428276.5662; train_gene_expr_recon_loss: 9437219.3051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34913339.6103; train_optim_loss: 34913339.6103; val_kl_reg_loss: 45521.0277; val_edge_recon_loss: 25456889.1803; val_gene_expr_recon_loss: 9657302.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35159712.3934; val_optim_loss: 35159712.3934
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 47235.0593; train_edge_recon_loss: 25432593.5257; train_gene_expr_recon_loss: 9418013.6222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34897842.2169; train_optim_loss: 34897842.2169; val_kl_reg_loss: 45954.1162; val_edge_recon_loss: 25458030.4918; val_gene_expr_recon_loss: 9672267.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35176252.1311; val_optim_loss: 35176252.1311
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 47161.1667; train_edge_recon_loss: 25431152.7574; train_gene_expr_recon_loss: 9428475.9577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34906789.7721; train_optim_loss: 34906789.7721; val_kl_reg_loss: 46858.5117; val_edge_recon_loss: 25442370.9180; val_gene_expr_recon_loss: 9675577.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35164807.0164; val_optim_loss: 35164807.0164
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 47149.6429; train_edge_recon_loss: 25428280.2096; train_gene_expr_recon_loss: 9398707.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34874137.1618; train_optim_loss: 34874137.1618; val_kl_reg_loss: 47568.3949; val_edge_recon_loss: 25471270.6230; val_gene_expr_recon_loss: 9643814.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35162653.9016; val_optim_loss: 35162653.9016
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 47192.0735; train_edge_recon_loss: 25427533.8493; train_gene_expr_recon_loss: 9382246.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34856972.0735; train_optim_loss: 34856972.0735; val_kl_reg_loss: 47352.1850; val_edge_recon_loss: 25474043.3770; val_gene_expr_recon_loss: 9650872.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172268.0000; val_optim_loss: 35172268.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 50637.3228; train_edge_recon_loss: 25407292.4816; train_gene_expr_recon_loss: 9309851.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34767780.8309; train_optim_loss: 34767780.8309; val_kl_reg_loss: 52002.9682; val_edge_recon_loss: 25423272.1639; val_gene_expr_recon_loss: 9569244.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35044519.7377; val_optim_loss: 35044519.7377
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 52857.1591; train_edge_recon_loss: 25403429.5294; train_gene_expr_recon_loss: 9283374.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34739661.5956; train_optim_loss: 34739661.5956; val_kl_reg_loss: 52853.5232; val_edge_recon_loss: 25447009.2131; val_gene_expr_recon_loss: 9570642.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35070505.5082; val_optim_loss: 35070505.5082
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 53355.3334; train_edge_recon_loss: 25405830.9265; train_gene_expr_recon_loss: 9284283.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34743469.2941; train_optim_loss: 34743469.2941; val_kl_reg_loss: 52685.5820; val_edge_recon_loss: 25431038.2623; val_gene_expr_recon_loss: 9586075.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35069799.4754; val_optim_loss: 35069799.4754
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 53394.9057; train_edge_recon_loss: 25399442.0735; train_gene_expr_recon_loss: 9264176.6351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34717013.5221; train_optim_loss: 34717013.5221; val_kl_reg_loss: 53022.4759; val_edge_recon_loss: 25406002.1639; val_gene_expr_recon_loss: 9581274.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35040299.6066; val_optim_loss: 35040299.6066
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 53652.2780; train_edge_recon_loss: 25412958.8015; train_gene_expr_recon_loss: 9272387.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34738998.8088; train_optim_loss: 34738998.8088; val_kl_reg_loss: 53734.4150; val_edge_recon_loss: 25419563.1803; val_gene_expr_recon_loss: 9577439.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35050736.3279; val_optim_loss: 35050736.3279
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 54014.4670; train_edge_recon_loss: 25396836.1581; train_gene_expr_recon_loss: 9275136.5184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34725987.2500; train_optim_loss: 34725987.2500; val_kl_reg_loss: 53690.3840; val_edge_recon_loss: 25426867.8689; val_gene_expr_recon_loss: 9583411.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35063969.7705; val_optim_loss: 35063969.7705
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 53972.3724; train_edge_recon_loss: 25403143.0735; train_gene_expr_recon_loss: 9265289.8888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34722405.3824; train_optim_loss: 34722405.3824; val_kl_reg_loss: 53381.6357; val_edge_recon_loss: 25442483.8361; val_gene_expr_recon_loss: 9576374.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35072239.6066; val_optim_loss: 35072239.6066
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 54200.8830; train_edge_recon_loss: 25397760.8382; train_gene_expr_recon_loss: 9268289.7105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34720251.3824; train_optim_loss: 34720251.3824; val_kl_reg_loss: 53492.8145; val_edge_recon_loss: 25439376.4918; val_gene_expr_recon_loss: 9562148.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35055017.5738; val_optim_loss: 35055017.5738

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 54273.2435; train_edge_recon_loss: 25397748.6066; train_gene_expr_recon_loss: 9251931.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703953.4191; train_optim_loss: 34703953.4191; val_kl_reg_loss: 54139.2348; val_edge_recon_loss: 25435122.2951; val_gene_expr_recon_loss: 9551677.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35040938.9508; val_optim_loss: 35040938.9508
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 54645.0085; train_edge_recon_loss: 25395221.8897; train_gene_expr_recon_loss: 9253920.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703786.9559; train_optim_loss: 34703786.9559; val_kl_reg_loss: 53865.6817; val_edge_recon_loss: 25429236.0328; val_gene_expr_recon_loss: 9548108.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35031210.5574; val_optim_loss: 35031210.5574
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 54769.0037; train_edge_recon_loss: 25402292.1581; train_gene_expr_recon_loss: 9250007.9559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34707069.1103; train_optim_loss: 34707069.1103; val_kl_reg_loss: 54439.3188; val_edge_recon_loss: 25437148.1967; val_gene_expr_recon_loss: 9539472.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35031059.3443; val_optim_loss: 35031059.3443
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 54764.9193; train_edge_recon_loss: 25402637.0257; train_gene_expr_recon_loss: 9245608.0919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703010.0735; train_optim_loss: 34703010.0735; val_kl_reg_loss: 54214.2942; val_edge_recon_loss: 25414398.5574; val_gene_expr_recon_loss: 9583572.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35052185.1148; val_optim_loss: 35052185.1148
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 54642.5559; train_edge_recon_loss: 25399523.7169; train_gene_expr_recon_loss: 9243285.8575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697452.2132; train_optim_loss: 34697452.2132; val_kl_reg_loss: 54278.9385; val_edge_recon_loss: 25424769.2131; val_gene_expr_recon_loss: 9596571.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35075620.0656; val_optim_loss: 35075620.0656
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 54865.4328; train_edge_recon_loss: 25392902.1434; train_gene_expr_recon_loss: 9250954.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34698721.6765; train_optim_loss: 34698721.6765; val_kl_reg_loss: 54213.7742; val_edge_recon_loss: 25464854.4590; val_gene_expr_recon_loss: 9553836.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35072904.9180; val_optim_loss: 35072904.9180
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 55031.0334; train_edge_recon_loss: 25394514.4632; train_gene_expr_recon_loss: 9244444.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34693989.7059; train_optim_loss: 34693989.7059; val_kl_reg_loss: 54631.2731; val_edge_recon_loss: 25419924.1967; val_gene_expr_recon_loss: 9576889.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35051444.9180; val_optim_loss: 35051444.9180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 54997.2901; train_edge_recon_loss: 25390426.8750; train_gene_expr_recon_loss: 9243040.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34688464.8529; train_optim_loss: 34688464.8529; val_kl_reg_loss: 54603.9149; val_edge_recon_loss: 25451563.7377; val_gene_expr_recon_loss: 9570968.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35077135.7377; val_optim_loss: 35077135.7377
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 55043.6966; train_edge_recon_loss: 25395915.8603; train_gene_expr_recon_loss: 9241444.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34692404.0221; train_optim_loss: 34692404.0221; val_kl_reg_loss: 54449.3884; val_edge_recon_loss: 25419733.8361; val_gene_expr_recon_loss: 9548453.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35022636.8525; val_optim_loss: 35022636.8525
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 55032.8783; train_edge_recon_loss: 25407727.2316; train_gene_expr_recon_loss: 9234889.1765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697649.2574; train_optim_loss: 34697649.2574; val_kl_reg_loss: 54572.6991; val_edge_recon_loss: 25426033.9344; val_gene_expr_recon_loss: 9564791.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35045398.4262; val_optim_loss: 35045398.4262
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 55007.6612; train_edge_recon_loss: 25396628.7353; train_gene_expr_recon_loss: 9239229.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34690865.8971; train_optim_loss: 34690865.8971; val_kl_reg_loss: 54546.0702; val_edge_recon_loss: 25435453.1475; val_gene_expr_recon_loss: 9551591.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35041590.4918; val_optim_loss: 35041590.4918
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 55063.1560; train_edge_recon_loss: 25401935.1103; train_gene_expr_recon_loss: 9245889.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34702887.5147; train_optim_loss: 34702887.5147; val_kl_reg_loss: 54475.2302; val_edge_recon_loss: 25438582.5574; val_gene_expr_recon_loss: 9540354.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35033412.1967; val_optim_loss: 35033412.1967
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 55018.9838; train_edge_recon_loss: 25397147.2941; train_gene_expr_recon_loss: 9248375.6103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34700541.8824; train_optim_loss: 34700541.8824; val_kl_reg_loss: 54405.2971; val_edge_recon_loss: 25424291.0492; val_gene_expr_recon_loss: 9550899.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35029595.5410; val_optim_loss: 35029595.5410

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 55014.8173; train_edge_recon_loss: 25389523.3566; train_gene_expr_recon_loss: 9249097.0919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34693635.1471; train_optim_loss: 34693635.1471; val_kl_reg_loss: 54470.3380; val_edge_recon_loss: 25435521.6066; val_gene_expr_recon_loss: 9545236.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35035227.8033; val_optim_loss: 35035227.8033
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 55031.8281; train_edge_recon_loss: 25396649.9007; train_gene_expr_recon_loss: 9245555.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697237.3750; train_optim_loss: 34697237.3750; val_kl_reg_loss: 54491.7007; val_edge_recon_loss: 25423164.9836; val_gene_expr_recon_loss: 9557294.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35034951.2131; val_optim_loss: 35034951.2131
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 55037.0531; train_edge_recon_loss: 25394364.1728; train_gene_expr_recon_loss: 9252235.0055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34701636.1176; train_optim_loss: 34701636.1176; val_kl_reg_loss: 54522.5943; val_edge_recon_loss: 25411223.1148; val_gene_expr_recon_loss: 9554072.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35019818.7541; val_optim_loss: 35019818.7541
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 55000.2032; train_edge_recon_loss: 25395608.6912; train_gene_expr_recon_loss: 9246986.9853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697595.8529; train_optim_loss: 34697595.8529; val_kl_reg_loss: 54470.9885; val_edge_recon_loss: 25446966.6230; val_gene_expr_recon_loss: 9546303.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35047741.0492; val_optim_loss: 35047741.0492
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 55044.3373; train_edge_recon_loss: 25397728.1360; train_gene_expr_recon_loss: 9248372.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34701145.1471; train_optim_loss: 34701145.1471; val_kl_reg_loss: 54531.0614; val_edge_recon_loss: 25426577.3115; val_gene_expr_recon_loss: 9550947.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35032055.1475; val_optim_loss: 35032055.1475
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 55056.7491; train_edge_recon_loss: 25395963.5882; train_gene_expr_recon_loss: 9244808.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34695829.0294; train_optim_loss: 34695829.0294; val_kl_reg_loss: 54433.3325; val_edge_recon_loss: 25394098.1311; val_gene_expr_recon_loss: 9545024.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34993555.8033; val_optim_loss: 34993555.8033
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 55027.3189; train_edge_recon_loss: 25390390.2904; train_gene_expr_recon_loss: 9243358.4559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34688776.0809; train_optim_loss: 34688776.0809; val_kl_reg_loss: 54507.7143; val_edge_recon_loss: 25441691.8033; val_gene_expr_recon_loss: 9532490.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35028689.3770; val_optim_loss: 35028689.3770
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9861; val_best_f1_score: 0.9863; train_kl_reg_loss: 55059.6792; train_edge_recon_loss: 25385924.3051; train_gene_expr_recon_loss: 9248069.3566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34689053.2206; train_optim_loss: 34689053.2206; val_kl_reg_loss: 54589.8939; val_edge_recon_loss: 25444953.4754; val_gene_expr_recon_loss: 9568608.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35068151.7377; val_optim_loss: 35068151.7377
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 55066.2294; train_edge_recon_loss: 25393151.1728; train_gene_expr_recon_loss: 9246954.5836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34695172.0735; train_optim_loss: 34695172.0735; val_kl_reg_loss: 54432.5864; val_edge_recon_loss: 25424704.3279; val_gene_expr_recon_loss: 9564231.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35043368.0000; val_optim_loss: 35043368.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 55032.5402; train_edge_recon_loss: 25400786.3713; train_gene_expr_recon_loss: 9238532.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34694351.6618; train_optim_loss: 34694351.6618; val_kl_reg_loss: 54506.8409; val_edge_recon_loss: 25422862.2951; val_gene_expr_recon_loss: 9526881.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35004250.6885; val_optim_loss: 35004250.6885

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 55041.7547; train_edge_recon_loss: 25398225.2316; train_gene_expr_recon_loss: 9242536.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34695803.4559; train_optim_loss: 34695803.4559; val_kl_reg_loss: 54589.8651; val_edge_recon_loss: 25433070.9180; val_gene_expr_recon_loss: 9570279.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35057940.0000; val_optim_loss: 35057940.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9867; val_best_f1_score: 0.9867; train_kl_reg_loss: 55049.9483; train_edge_recon_loss: 25391907.5000; train_gene_expr_recon_loss: 9237062.2261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34684019.7353; train_optim_loss: 34684019.7353; val_kl_reg_loss: 54527.6967; val_edge_recon_loss: 25417933.6721; val_gene_expr_recon_loss: 9558642.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35031103.8033; val_optim_loss: 35031103.8033
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 55053.9640; train_edge_recon_loss: 25393366.6875; train_gene_expr_recon_loss: 9248674.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697095.4559; train_optim_loss: 34697095.4559; val_kl_reg_loss: 54581.5389; val_edge_recon_loss: 25425661.3443; val_gene_expr_recon_loss: 9564832.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35045075.4098; val_optim_loss: 35045075.4098
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 55057.0679; train_edge_recon_loss: 25401222.0221; train_gene_expr_recon_loss: 9243067.5717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34699346.5882; train_optim_loss: 34699346.5882; val_kl_reg_loss: 54466.2740; val_edge_recon_loss: 25415213.2787; val_gene_expr_recon_loss: 9559427.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35029107.0820; val_optim_loss: 35029107.0820

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 316 min 9 sec.
Using best model state, which was in epoch 59.

--- MODEL EVALUATION ---
Val AUROC score: 0.9983
Val AUPRC score: 0.9977
Val best accuracy score: 0.9867
Val best F1 score: 0.9868
Val gene expr MSE score: 0.5927

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
