None
Run timestamp: 14082023_212129_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9888; val_auprc_score: 0.9850; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 7517.4190; train_edge_recon_loss: 264039.8265; train_gene_expr_recon_loss: 201907.0125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3534.0490; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 476998.3070; train_optim_loss: 476998.3070; val_kl_reg_loss: 7190.1165; val_edge_recon_loss: 259632.8738; val_gene_expr_recon_loss: 188071.1273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4129.7749; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 459023.8985; val_optim_loss: 459023.8985
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9910; val_auprc_score: 0.9881; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 7164.5745; train_edge_recon_loss: 259701.7031; train_gene_expr_recon_loss: 183370.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4237.3836; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 454473.7493; train_optim_loss: 454473.7493; val_kl_reg_loss: 7120.3708; val_edge_recon_loss: 258505.9006; val_gene_expr_recon_loss: 181831.5126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4285.7734; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451743.5657; val_optim_loss: 451743.5657
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9929; val_auprc_score: 0.9908; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 6939.2534; train_edge_recon_loss: 259054.3286; train_gene_expr_recon_loss: 179633.4952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4227.8016; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449854.8786; train_optim_loss: 449854.8786; val_kl_reg_loss: 6759.2185; val_edge_recon_loss: 258030.5413; val_gene_expr_recon_loss: 179567.8781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4157.2925; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448514.9196; val_optim_loss: 448514.9196
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 6822.8150; train_edge_recon_loss: 258495.9239; train_gene_expr_recon_loss: 178250.3617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4089.7740; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447658.8745; train_optim_loss: 447658.8745; val_kl_reg_loss: 6677.9728; val_edge_recon_loss: 257993.9380; val_gene_expr_recon_loss: 179336.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4050.4395; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448058.7616; val_optim_loss: 448058.7616
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 6758.5448; train_edge_recon_loss: 258118.5202; train_gene_expr_recon_loss: 177855.2138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4003.1384; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446735.4166; train_optim_loss: 446735.4166; val_kl_reg_loss: 6662.6636; val_edge_recon_loss: 257371.5448; val_gene_expr_recon_loss: 178584.5563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3962.8569; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446581.6089; val_optim_loss: 446581.6089
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 6722.6778; train_edge_recon_loss: 257971.4103; train_gene_expr_recon_loss: 177647.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3975.7029; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446316.8397; train_optim_loss: 446316.8397; val_kl_reg_loss: 6723.3921; val_edge_recon_loss: 257418.5537; val_gene_expr_recon_loss: 178328.9680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3957.9788; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446428.8820; val_optim_loss: 446428.8820
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 6688.2881; train_edge_recon_loss: 257888.2297; train_gene_expr_recon_loss: 177527.1419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3962.8106; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446066.4701; train_optim_loss: 446066.4701; val_kl_reg_loss: 6687.3497; val_edge_recon_loss: 257288.4883; val_gene_expr_recon_loss: 178619.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3964.5806; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446559.7415; val_optim_loss: 446559.7415
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9958; val_auprc_score: 0.9940; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6670.6100; train_edge_recon_loss: 257706.6040; train_gene_expr_recon_loss: 177391.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3961.7335; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445730.3837; train_optim_loss: 445730.3837; val_kl_reg_loss: 6659.2754; val_edge_recon_loss: 256991.8813; val_gene_expr_recon_loss: 178509.0065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3970.6646; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446130.8193; val_optim_loss: 446130.8193
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 6663.3801; train_edge_recon_loss: 257518.1888; train_gene_expr_recon_loss: 177344.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3969.7937; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445495.7651; train_optim_loss: 445495.7651; val_kl_reg_loss: 6591.4760; val_edge_recon_loss: 257134.9902; val_gene_expr_recon_loss: 178484.5584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3963.9009; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446174.9305; val_optim_loss: 446174.9305
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9815; val_best_f1_score: 0.9818; train_kl_reg_loss: 6652.7954; train_edge_recon_loss: 257420.4758; train_gene_expr_recon_loss: 177325.2957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3977.6235; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445376.1910; train_optim_loss: 445376.1910; val_kl_reg_loss: 6527.8834; val_edge_recon_loss: 256837.7731; val_gene_expr_recon_loss: 178092.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3980.5115; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445438.9295; val_optim_loss: 445438.9295
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6647.7045; train_edge_recon_loss: 257356.1562; train_gene_expr_recon_loss: 177243.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3987.3873; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445234.8713; train_optim_loss: 445234.8713; val_kl_reg_loss: 6679.3976; val_edge_recon_loss: 256920.7700; val_gene_expr_recon_loss: 178304.2685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3998.9023; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445903.3414; val_optim_loss: 445903.3414
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6647.3756; train_edge_recon_loss: 257351.5697; train_gene_expr_recon_loss: 177162.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4000.7899; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445162.3625; train_optim_loss: 445162.3625; val_kl_reg_loss: 6587.1840; val_edge_recon_loss: 256887.7268; val_gene_expr_recon_loss: 178264.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3981.9243; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445721.4588; val_optim_loss: 445721.4588
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9965; val_auprc_score: 0.9951; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6641.7477; train_edge_recon_loss: 257342.1293; train_gene_expr_recon_loss: 177175.4183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4004.0792; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445163.3740; train_optim_loss: 445163.3740; val_kl_reg_loss: 6687.0509; val_edge_recon_loss: 256796.0874; val_gene_expr_recon_loss: 178087.9628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4011.5640; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445582.6644; val_optim_loss: 445582.6644
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 6638.1058; train_edge_recon_loss: 257227.7620; train_gene_expr_recon_loss: 177181.8075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4013.9949; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445061.6703; train_optim_loss: 445061.6703; val_kl_reg_loss: 6603.8194; val_edge_recon_loss: 256576.7497; val_gene_expr_recon_loss: 177840.8857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4004.0542; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445025.5172; val_optim_loss: 445025.5172
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 6637.3198; train_edge_recon_loss: 257137.4980; train_gene_expr_recon_loss: 177182.6749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4016.8521; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444974.3449; train_optim_loss: 444974.3449; val_kl_reg_loss: 6607.8525; val_edge_recon_loss: 256690.2282; val_gene_expr_recon_loss: 178527.3674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4017.8220; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445843.2603; val_optim_loss: 445843.2603
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 6641.8311; train_edge_recon_loss: 257135.2218; train_gene_expr_recon_loss: 176972.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4022.4461; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444772.0726; train_optim_loss: 444772.0726; val_kl_reg_loss: 6612.6922; val_edge_recon_loss: 256562.7468; val_gene_expr_recon_loss: 177847.3484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4026.2595; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445049.0368; val_optim_loss: 445049.0368
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 6635.4416; train_edge_recon_loss: 257109.3728; train_gene_expr_recon_loss: 177084.3966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4027.2034; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444856.4143; train_optim_loss: 444856.4143; val_kl_reg_loss: 6634.5308; val_edge_recon_loss: 256429.4444; val_gene_expr_recon_loss: 178215.1654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4029.1760; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445308.3258; val_optim_loss: 445308.3258
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 6641.0164; train_edge_recon_loss: 256998.6626; train_gene_expr_recon_loss: 177006.4660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4024.7939; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444670.9390; train_optim_loss: 444670.9390; val_kl_reg_loss: 6618.6776; val_edge_recon_loss: 256196.1058; val_gene_expr_recon_loss: 178194.1103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4021.7788; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445030.6748; val_optim_loss: 445030.6748

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6614.3501; train_edge_recon_loss: 256841.4693; train_gene_expr_recon_loss: 176758.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3879.9323; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444094.2629; train_optim_loss: 444094.2629; val_kl_reg_loss: 6609.9389; val_edge_recon_loss: 256219.3867; val_gene_expr_recon_loss: 177683.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3878.8599; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444391.7828; val_optim_loss: 444391.7828
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6603.1409; train_edge_recon_loss: 256814.4879; train_gene_expr_recon_loss: 176511.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3878.2145; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443807.0103; train_optim_loss: 443807.0103; val_kl_reg_loss: 6590.1762; val_edge_recon_loss: 256082.7323; val_gene_expr_recon_loss: 177777.6673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3879.6472; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444330.2319; val_optim_loss: 444330.2319
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6600.2958; train_edge_recon_loss: 256869.6890; train_gene_expr_recon_loss: 176542.4662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3878.8590; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443891.3095; train_optim_loss: 443891.3095; val_kl_reg_loss: 6565.7280; val_edge_recon_loss: 256254.1834; val_gene_expr_recon_loss: 178254.4341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3877.9136; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444952.2518; val_optim_loss: 444952.2518
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 6599.3169; train_edge_recon_loss: 256761.6273; train_gene_expr_recon_loss: 176490.6273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3880.1420; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443731.7135; train_optim_loss: 443731.7135; val_kl_reg_loss: 6605.1645; val_edge_recon_loss: 256230.2216; val_gene_expr_recon_loss: 177968.1697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3880.9290; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444684.4929; val_optim_loss: 444684.4929
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 6597.4422; train_edge_recon_loss: 256814.0735; train_gene_expr_recon_loss: 176485.7298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3883.6417; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443780.8876; train_optim_loss: 443780.8876; val_kl_reg_loss: 6579.4497; val_edge_recon_loss: 256047.7100; val_gene_expr_recon_loss: 177693.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3885.4282; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444205.6420; val_optim_loss: 444205.6420
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6593.6826; train_edge_recon_loss: 256761.5306; train_gene_expr_recon_loss: 176370.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3888.8751; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443614.2247; train_optim_loss: 443614.2247; val_kl_reg_loss: 6589.9938; val_edge_recon_loss: 255904.6356; val_gene_expr_recon_loss: 177786.4748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3889.8608; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444170.9791; val_optim_loss: 444170.9791
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6590.5924; train_edge_recon_loss: 256756.9187; train_gene_expr_recon_loss: 176489.7957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3892.0479; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443729.3551; train_optim_loss: 443729.3551; val_kl_reg_loss: 6571.7795; val_edge_recon_loss: 256204.7013; val_gene_expr_recon_loss: 177819.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.1328; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444492.3476; val_optim_loss: 444492.3476
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 6593.0453; train_edge_recon_loss: 256703.5099; train_gene_expr_recon_loss: 176525.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3897.5830; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443719.9059; train_optim_loss: 443719.9059; val_kl_reg_loss: 6576.4799; val_edge_recon_loss: 256389.6377; val_gene_expr_recon_loss: 177764.9132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3903.3623; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444634.4052; val_optim_loss: 444634.4052
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6583.2371; train_edge_recon_loss: 256750.6252; train_gene_expr_recon_loss: 176409.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3903.5044; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443646.8573; train_optim_loss: 443646.8573; val_kl_reg_loss: 6551.8895; val_edge_recon_loss: 255959.4308; val_gene_expr_recon_loss: 178023.7492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3903.2288; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444438.2885; val_optim_loss: 444438.2885
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6583.2999; train_edge_recon_loss: 256773.7677; train_gene_expr_recon_loss: 176434.5844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3908.1122; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443699.7639; train_optim_loss: 443699.7639; val_kl_reg_loss: 6568.6933; val_edge_recon_loss: 255897.2115; val_gene_expr_recon_loss: 177919.8637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3911.5312; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444297.2992; val_optim_loss: 444297.2992

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6578.5314; train_edge_recon_loss: 256755.2433; train_gene_expr_recon_loss: 176379.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.4860; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443609.7539; train_optim_loss: 443609.7539; val_kl_reg_loss: 6550.5845; val_edge_recon_loss: 255936.8771; val_gene_expr_recon_loss: 177589.2324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.6963; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443973.3829; val_optim_loss: 443973.3829
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6574.8248; train_edge_recon_loss: 256700.9992; train_gene_expr_recon_loss: 176388.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3897.1940; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443561.5495; train_optim_loss: 443561.5495; val_kl_reg_loss: 6563.8118; val_edge_recon_loss: 256007.8263; val_gene_expr_recon_loss: 177899.5302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.9668; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444368.1361; val_optim_loss: 444368.1361
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6575.5145; train_edge_recon_loss: 256695.1154; train_gene_expr_recon_loss: 176236.7144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3897.0035; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443404.3482; train_optim_loss: 443404.3482; val_kl_reg_loss: 6551.9658; val_edge_recon_loss: 256325.6604; val_gene_expr_recon_loss: 177723.4303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.9348; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444497.9941; val_optim_loss: 444497.9941
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 6571.9999; train_edge_recon_loss: 256686.1012; train_gene_expr_recon_loss: 176326.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3897.1752; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443481.6103; train_optim_loss: 443481.6103; val_kl_reg_loss: 6555.8488; val_edge_recon_loss: 256237.8370; val_gene_expr_recon_loss: 177652.5138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3897.2930; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444343.4817; val_optim_loss: 444343.4817
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6574.7303; train_edge_recon_loss: 256722.6051; train_gene_expr_recon_loss: 176433.7825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3897.5899; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443628.7076; train_optim_loss: 443628.7076; val_kl_reg_loss: 6553.2605; val_edge_recon_loss: 255927.0991; val_gene_expr_recon_loss: 177723.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3897.5366; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444100.9567; val_optim_loss: 444100.9567

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6570.1731; train_edge_recon_loss: 256679.7815; train_gene_expr_recon_loss: 176189.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.2769; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443335.8760; train_optim_loss: 443335.8760; val_kl_reg_loss: 6552.5389; val_edge_recon_loss: 256025.9394; val_gene_expr_recon_loss: 177864.2776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.2939; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444339.0374; val_optim_loss: 444339.0374
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6574.3969; train_edge_recon_loss: 256717.9305; train_gene_expr_recon_loss: 176450.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3204; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443639.4409; train_optim_loss: 443639.4409; val_kl_reg_loss: 6554.5045; val_edge_recon_loss: 256096.3396; val_gene_expr_recon_loss: 177514.7932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3269; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444061.9500; val_optim_loss: 444061.9500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9975; val_auprc_score: 0.9964; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6574.2965; train_edge_recon_loss: 256668.3680; train_gene_expr_recon_loss: 176279.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3203; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443418.6163; train_optim_loss: 443418.6163; val_kl_reg_loss: 6554.6033; val_edge_recon_loss: 255900.1297; val_gene_expr_recon_loss: 177288.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3286; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443639.8035; val_optim_loss: 443639.8035
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6572.0615; train_edge_recon_loss: 256735.7831; train_gene_expr_recon_loss: 176382.4546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3687; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443586.6688; train_optim_loss: 443586.6688; val_kl_reg_loss: 6549.1813; val_edge_recon_loss: 255955.7828; val_gene_expr_recon_loss: 177859.7779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.4106; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444261.1476; val_optim_loss: 444261.1476
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 6574.4386; train_edge_recon_loss: 256654.6281; train_gene_expr_recon_loss: 176425.7714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3905; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443551.2281; train_optim_loss: 443551.2281; val_kl_reg_loss: 6552.5322; val_edge_recon_loss: 256103.6637; val_gene_expr_recon_loss: 177749.4130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.4321; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444302.0476; val_optim_loss: 444302.0476
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6572.6707; train_edge_recon_loss: 256768.0770; train_gene_expr_recon_loss: 176281.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.4510; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443518.7892; train_optim_loss: 443518.7892; val_kl_reg_loss: 6554.9170; val_edge_recon_loss: 256032.5650; val_gene_expr_recon_loss: 178044.1350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.4834; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444528.0859; val_optim_loss: 444528.0859
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 6574.7911; train_edge_recon_loss: 256704.1929; train_gene_expr_recon_loss: 176326.6768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.4960; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443502.1562; train_optim_loss: 443502.1562; val_kl_reg_loss: 6552.6909; val_edge_recon_loss: 256099.5854; val_gene_expr_recon_loss: 177709.2997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.5383; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444258.1073; val_optim_loss: 444258.1073

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6572.9094; train_edge_recon_loss: 256669.8909; train_gene_expr_recon_loss: 176351.5037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3651; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443490.6803; train_optim_loss: 443490.6803; val_kl_reg_loss: 6555.4385; val_edge_recon_loss: 255965.7506; val_gene_expr_recon_loss: 177889.0552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3623; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444306.6187; val_optim_loss: 444306.6187
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6574.6592; train_edge_recon_loss: 256774.4649; train_gene_expr_recon_loss: 176276.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3619; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443522.0664; train_optim_loss: 443522.0664; val_kl_reg_loss: 6553.6267; val_edge_recon_loss: 255957.4962; val_gene_expr_recon_loss: 177671.0048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3618; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444078.5028; val_optim_loss: 444078.5028
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6574.7333; train_edge_recon_loss: 256701.6585; train_gene_expr_recon_loss: 176371.8730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3630; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443544.6398; train_optim_loss: 443544.6398; val_kl_reg_loss: 6554.1961; val_edge_recon_loss: 255938.6269; val_gene_expr_recon_loss: 177667.5407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3621; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444056.7394; val_optim_loss: 444056.7394
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 6571.3970; train_edge_recon_loss: 256814.3462; train_gene_expr_recon_loss: 176329.2264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3896.3642; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443611.3444; train_optim_loss: 443611.3444; val_kl_reg_loss: 6553.8912; val_edge_recon_loss: 256337.2601; val_gene_expr_recon_loss: 177785.3833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3896.3643; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444572.9108; val_optim_loss: 444572.9108

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 280 min 12 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9974
val AUPRC score: 0.9965
val best accuracy score: 0.9851
val best F1 score: 0.9852
val target rna MSE score: 0.6118
val source rna MSE score: 0.0666

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
