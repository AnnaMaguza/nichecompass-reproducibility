None
Run timestamp: 20072023_111643_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9883; val_auprc_score: 0.9859; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 110704.7085; train_edge_recon_loss: 26373102.9848; train_gene_expr_recon_loss: 11105170.1141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37588977.8168; train_optim_loss: 37588977.8168; val_kl_reg_loss: 88414.3970; val_edge_recon_loss: 25953261.7190; val_gene_expr_recon_loss: 10425481.6198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36467157.7521; val_optim_loss: 36467157.7521
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9921; val_auprc_score: 0.9906; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 78387.5398; train_edge_recon_loss: 25770670.8679; train_gene_expr_recon_loss: 10248649.9439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36097708.3718; train_optim_loss: 36097708.3718; val_kl_reg_loss: 71832.9987; val_edge_recon_loss: 25719307.0826; val_gene_expr_recon_loss: 10109712.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35900852.0661; val_optim_loss: 35900852.0661
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 64254.4884; train_edge_recon_loss: 25652489.7883; train_gene_expr_recon_loss: 10047371.4485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35764115.7478; train_optim_loss: 35764115.7478; val_kl_reg_loss: 60123.2691; val_edge_recon_loss: 25648471.9917; val_gene_expr_recon_loss: 10023722.8368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35732317.9339; val_optim_loss: 35732317.9339
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 56087.1918; train_edge_recon_loss: 25596023.1192; train_gene_expr_recon_loss: 9955312.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35607422.8440; train_optim_loss: 35607422.8440; val_kl_reg_loss: 48471.2353; val_edge_recon_loss: 25625997.6529; val_gene_expr_recon_loss: 9972158.0351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35646627.1405; val_optim_loss: 35646627.1405
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 50542.6687; train_edge_recon_loss: 25553006.4630; train_gene_expr_recon_loss: 9899865.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35503414.6249; train_optim_loss: 35503414.6249; val_kl_reg_loss: 47813.5165; val_edge_recon_loss: 25591531.2479; val_gene_expr_recon_loss: 9891120.8223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35530465.5702; val_optim_loss: 35530465.5702
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9942; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 47493.6334; train_edge_recon_loss: 25533364.9489; train_gene_expr_recon_loss: 9868589.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35449448.1813; train_optim_loss: 35449448.1813; val_kl_reg_loss: 48215.0948; val_edge_recon_loss: 25586486.9504; val_gene_expr_recon_loss: 9882895.8037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35517597.9504; val_optim_loss: 35517597.9504
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9956; val_auprc_score: 0.9948; val_best_acc_score: 0.9761; val_best_f1_score: 0.9765; train_kl_reg_loss: 45097.7594; train_edge_recon_loss: 25515720.3893; train_gene_expr_recon_loss: 9822081.7561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35382899.9181; train_optim_loss: 35382899.9181; val_kl_reg_loss: 43751.4469; val_edge_recon_loss: 25540289.3802; val_gene_expr_recon_loss: 9837623.8285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35421664.6529; val_optim_loss: 35421664.6529
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 43745.7019; train_edge_recon_loss: 25505986.6231; train_gene_expr_recon_loss: 9807133.4202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35356865.7285; train_optim_loss: 35356865.7285; val_kl_reg_loss: 42737.4025; val_edge_recon_loss: 25554471.8843; val_gene_expr_recon_loss: 9824586.1054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35421795.3223; val_optim_loss: 35421795.3223
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 42316.8852; train_edge_recon_loss: 25494462.7133; train_gene_expr_recon_loss: 9769077.2747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35305856.9011; train_optim_loss: 35305856.9011; val_kl_reg_loss: 40952.5558; val_edge_recon_loss: 25540484.5124; val_gene_expr_recon_loss: 9789406.3781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35370843.5702; val_optim_loss: 35370843.5702
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 41401.7982; train_edge_recon_loss: 25494382.8550; train_gene_expr_recon_loss: 9763622.2437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35299406.9296; train_optim_loss: 35299406.9296; val_kl_reg_loss: 40779.6167; val_edge_recon_loss: 25525534.7273; val_gene_expr_recon_loss: 9806023.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35372338.0413; val_optim_loss: 35372338.0413
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 39917.2156; train_edge_recon_loss: 25481158.2688; train_gene_expr_recon_loss: 9751806.6072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35272882.1335; train_optim_loss: 35272882.1335; val_kl_reg_loss: 38099.2061; val_edge_recon_loss: 25519772.2727; val_gene_expr_recon_loss: 9781744.0331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35339615.4711; val_optim_loss: 35339615.4711
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 39351.8166; train_edge_recon_loss: 25466531.1201; train_gene_expr_recon_loss: 9719858.0656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35225740.9940; train_optim_loss: 35225740.9940; val_kl_reg_loss: 38466.8416; val_edge_recon_loss: 25511558.6777; val_gene_expr_recon_loss: 9782612.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35332638.5620; val_optim_loss: 35332638.5620
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 38744.1068; train_edge_recon_loss: 25461179.1643; train_gene_expr_recon_loss: 9710705.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35210628.8256; train_optim_loss: 35210628.8256; val_kl_reg_loss: 37443.9759; val_edge_recon_loss: 25499104.4545; val_gene_expr_recon_loss: 9770409.3471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35306957.6033; val_optim_loss: 35306957.6033
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 38458.5423; train_edge_recon_loss: 25458766.5697; train_gene_expr_recon_loss: 9688863.2087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35186088.3010; train_optim_loss: 35186088.3010; val_kl_reg_loss: 37635.0149; val_edge_recon_loss: 25453059.2479; val_gene_expr_recon_loss: 9767204.3967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35257898.8099; val_optim_loss: 35257898.8099
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 37890.7736; train_edge_recon_loss: 25454563.9420; train_gene_expr_recon_loss: 9684660.9319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35177115.6742; train_optim_loss: 35177115.6742; val_kl_reg_loss: 37207.5084; val_edge_recon_loss: 25479321.3884; val_gene_expr_recon_loss: 9761134.1570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35277662.9835; val_optim_loss: 35277662.9835
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 37930.0688; train_edge_recon_loss: 25450668.0331; train_gene_expr_recon_loss: 9672291.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35160889.9291; train_optim_loss: 35160889.9291; val_kl_reg_loss: 37405.1656; val_edge_recon_loss: 25489744.6694; val_gene_expr_recon_loss: 9774477.9649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301627.7521; val_optim_loss: 35301627.7521
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 37681.2228; train_edge_recon_loss: 25450337.7101; train_gene_expr_recon_loss: 9657320.3111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35145339.2618; train_optim_loss: 35145339.2618; val_kl_reg_loss: 37804.8165; val_edge_recon_loss: 25473707.3554; val_gene_expr_recon_loss: 9748718.9277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35260230.8595; val_optim_loss: 35260230.8595
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 37212.4962; train_edge_recon_loss: 25439725.3162; train_gene_expr_recon_loss: 9648607.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35125545.3935; train_optim_loss: 35125545.3935; val_kl_reg_loss: 36683.8593; val_edge_recon_loss: 25470887.0413; val_gene_expr_recon_loss: 9755756.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35263327.6364; val_optim_loss: 35263327.6364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 42018.4245; train_edge_recon_loss: 25423387.7202; train_gene_expr_recon_loss: 9551027.8955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35016434.0064; train_optim_loss: 35016434.0064; val_kl_reg_loss: 44024.8630; val_edge_recon_loss: 25437732.4628; val_gene_expr_recon_loss: 9670060.2748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35151817.5868; val_optim_loss: 35151817.5868
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 45097.7204; train_edge_recon_loss: 25412352.7197; train_gene_expr_recon_loss: 9528617.0023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34986067.4947; train_optim_loss: 34986067.4947; val_kl_reg_loss: 45348.0780; val_edge_recon_loss: 25466537.7190; val_gene_expr_recon_loss: 9662402.2376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35174288.1488; val_optim_loss: 35174288.1488
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 46194.7985; train_edge_recon_loss: 25406436.9333; train_gene_expr_recon_loss: 9526234.3810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34978866.1445; train_optim_loss: 34978866.1445; val_kl_reg_loss: 46551.2208; val_edge_recon_loss: 25456610.5950; val_gene_expr_recon_loss: 9637117.1777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35140278.9752; val_optim_loss: 35140278.9752
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 47147.4948; train_edge_recon_loss: 25406254.9379; train_gene_expr_recon_loss: 9521998.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34975401.1569; train_optim_loss: 34975401.1569; val_kl_reg_loss: 46999.9758; val_edge_recon_loss: 25456963.5372; val_gene_expr_recon_loss: 9648796.0888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35152759.5950; val_optim_loss: 35152759.5950
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 47215.9782; train_edge_recon_loss: 25417121.5573; train_gene_expr_recon_loss: 9517268.9142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34981606.4151; train_optim_loss: 34981606.4151; val_kl_reg_loss: 46686.3868; val_edge_recon_loss: 25445034.2975; val_gene_expr_recon_loss: 9639158.1322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130878.8926; val_optim_loss: 35130878.8926
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 47512.5667; train_edge_recon_loss: 25404783.2637; train_gene_expr_recon_loss: 9510923.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34963219.0041; train_optim_loss: 34963219.0041; val_kl_reg_loss: 47362.7546; val_edge_recon_loss: 25461866.0331; val_gene_expr_recon_loss: 9665735.9587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35174964.8182; val_optim_loss: 35174964.8182
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 47668.3209; train_edge_recon_loss: 25412229.7478; train_gene_expr_recon_loss: 9499354.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34959252.8808; train_optim_loss: 34959252.8808; val_kl_reg_loss: 46892.5698; val_edge_recon_loss: 25440694.3636; val_gene_expr_recon_loss: 9623752.0331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35111338.8347; val_optim_loss: 35111338.8347
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 47817.9640; train_edge_recon_loss: 25407386.9370; train_gene_expr_recon_loss: 9498701.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34953906.7234; train_optim_loss: 34953906.7234; val_kl_reg_loss: 47563.6957; val_edge_recon_loss: 25435468.0331; val_gene_expr_recon_loss: 9633441.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35116473.5702; val_optim_loss: 35116473.5702
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 48127.1767; train_edge_recon_loss: 25408094.5154; train_gene_expr_recon_loss: 9496135.6341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34952357.2867; train_optim_loss: 34952357.2867; val_kl_reg_loss: 47332.7771; val_edge_recon_loss: 25431314.5537; val_gene_expr_recon_loss: 9640958.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35119605.9669; val_optim_loss: 35119605.9669
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 47921.2699; train_edge_recon_loss: 25414592.5053; train_gene_expr_recon_loss: 9497445.8139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34959959.5849; train_optim_loss: 34959959.5849; val_kl_reg_loss: 47309.7581; val_edge_recon_loss: 25426512.2479; val_gene_expr_recon_loss: 9612776.9132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35086598.9421; val_optim_loss: 35086598.9421
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 48304.1047; train_edge_recon_loss: 25400044.8145; train_gene_expr_recon_loss: 9487616.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34935965.0152; train_optim_loss: 34935965.0152; val_kl_reg_loss: 47582.4373; val_edge_recon_loss: 25402942.9752; val_gene_expr_recon_loss: 9631596.3347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35082121.7190; val_optim_loss: 35082121.7190
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 48316.9345; train_edge_recon_loss: 25399559.8187; train_gene_expr_recon_loss: 9488783.6012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34936660.3543; train_optim_loss: 34936660.3543; val_kl_reg_loss: 47453.4485; val_edge_recon_loss: 25441983.9669; val_gene_expr_recon_loss: 9640820.0764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130257.4793; val_optim_loss: 35130257.4793
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 48357.8582; train_edge_recon_loss: 25400714.0626; train_gene_expr_recon_loss: 9482162.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34931234.2052; train_optim_loss: 34931234.2052; val_kl_reg_loss: 48029.7480; val_edge_recon_loss: 25433131.1405; val_gene_expr_recon_loss: 9632404.4132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35113565.3388; val_optim_loss: 35113565.3388
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 48289.0982; train_edge_recon_loss: 25402016.9305; train_gene_expr_recon_loss: 9476630.0366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34926936.0709; train_optim_loss: 34926936.0709; val_kl_reg_loss: 47991.5939; val_edge_recon_loss: 25454956.3306; val_gene_expr_recon_loss: 9640116.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35143064.1240; val_optim_loss: 35143064.1240
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 48379.4250; train_edge_recon_loss: 25406109.0492; train_gene_expr_recon_loss: 9476126.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34930614.7934; train_optim_loss: 34930614.7934; val_kl_reg_loss: 48203.6169; val_edge_recon_loss: 25425262.7603; val_gene_expr_recon_loss: 9601510.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35074976.8182; val_optim_loss: 35074976.8182
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 48071.9788; train_edge_recon_loss: 25416379.0345; train_gene_expr_recon_loss: 9481340.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34945791.4947; train_optim_loss: 34945791.4947; val_kl_reg_loss: 47545.3244; val_edge_recon_loss: 25445105.4545; val_gene_expr_recon_loss: 9611469.7231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35104120.4628; val_optim_loss: 35104120.4628
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 48514.2812; train_edge_recon_loss: 25397646.0405; train_gene_expr_recon_loss: 9471565.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34917725.5545; train_optim_loss: 34917725.5545; val_kl_reg_loss: 48684.4583; val_edge_recon_loss: 25439000.2893; val_gene_expr_recon_loss: 9608171.8264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35095856.6033; val_optim_loss: 35095856.6033
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 48422.8240; train_edge_recon_loss: 25397922.0423; train_gene_expr_recon_loss: 9466816.1673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34913161.0014; train_optim_loss: 34913161.0014; val_kl_reg_loss: 47738.3771; val_edge_recon_loss: 25421670.6860; val_gene_expr_recon_loss: 9631581.0331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35100990.1074; val_optim_loss: 35100990.1074
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 48305.0727; train_edge_recon_loss: 25400583.2177; train_gene_expr_recon_loss: 9468267.2342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34917155.4929; train_optim_loss: 34917155.4929; val_kl_reg_loss: 47938.3925; val_edge_recon_loss: 25439284.5207; val_gene_expr_recon_loss: 9614759.3058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35101982.1983; val_optim_loss: 35101982.1983

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 48609.0617; train_edge_recon_loss: 25400173.1081; train_gene_expr_recon_loss: 9455597.3654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34904379.4956; train_optim_loss: 34904379.4956; val_kl_reg_loss: 48357.1270; val_edge_recon_loss: 25412502.0331; val_gene_expr_recon_loss: 9592845.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35053704.4132; val_optim_loss: 35053704.4132
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 48629.5893; train_edge_recon_loss: 25398383.3953; train_gene_expr_recon_loss: 9449686.2234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34896699.2223; train_optim_loss: 34896699.2223; val_kl_reg_loss: 48222.6584; val_edge_recon_loss: 25429169.4793; val_gene_expr_recon_loss: 9612098.4752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35089490.6777; val_optim_loss: 35089490.6777
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 48734.5329; train_edge_recon_loss: 25400349.0667; train_gene_expr_recon_loss: 9443260.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34892344.3286; train_optim_loss: 34892344.3286; val_kl_reg_loss: 48555.8613; val_edge_recon_loss: 25436053.1322; val_gene_expr_recon_loss: 9607641.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35092250.3306; val_optim_loss: 35092250.3306
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 48893.1440; train_edge_recon_loss: 25400700.0451; train_gene_expr_recon_loss: 9451550.7098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34901143.8960; train_optim_loss: 34901143.8960; val_kl_reg_loss: 48663.6679; val_edge_recon_loss: 25408333.4628; val_gene_expr_recon_loss: 9624120.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35081117.5537; val_optim_loss: 35081117.5537
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 49193.1565; train_edge_recon_loss: 25396927.5343; train_gene_expr_recon_loss: 9442668.5778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34888789.2637; train_optim_loss: 34888789.2637; val_kl_reg_loss: 48821.5071; val_edge_recon_loss: 25424205.4132; val_gene_expr_recon_loss: 9627860.5124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35100887.5868; val_optim_loss: 35100887.5868

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 49210.6407; train_edge_recon_loss: 25393426.1620; train_gene_expr_recon_loss: 9452659.0884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34895295.8702; train_optim_loss: 34895295.8702; val_kl_reg_loss: 48704.1034; val_edge_recon_loss: 25408328.8099; val_gene_expr_recon_loss: 9602369.2707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35059402.1983; val_optim_loss: 35059402.1983
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 49172.0215; train_edge_recon_loss: 25389455.1229; train_gene_expr_recon_loss: 9453632.2766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34892259.3557; train_optim_loss: 34892259.3557; val_kl_reg_loss: 48806.8172; val_edge_recon_loss: 25435079.7273; val_gene_expr_recon_loss: 9622591.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35106478.1322; val_optim_loss: 35106478.1322
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 49222.9462; train_edge_recon_loss: 25400791.2996; train_gene_expr_recon_loss: 9454192.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34904207.1919; train_optim_loss: 34904207.1919; val_kl_reg_loss: 48758.5567; val_edge_recon_loss: 25412120.0165; val_gene_expr_recon_loss: 9608800.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35069678.6116; val_optim_loss: 35069678.6116
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 49221.6690; train_edge_recon_loss: 25392626.3277; train_gene_expr_recon_loss: 9444289.0854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34886137.0824; train_optim_loss: 34886137.0824; val_kl_reg_loss: 48693.6075; val_edge_recon_loss: 25436961.7769; val_gene_expr_recon_loss: 9608686.8533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35094342.1983; val_optim_loss: 35094342.1983

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 326 min 38 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9982
Val AUPRC score: 0.9978
Val best accuracy score: 0.9857
Val best F1 score: 0.9858
Val gene expr MSE score: 0.5844

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
