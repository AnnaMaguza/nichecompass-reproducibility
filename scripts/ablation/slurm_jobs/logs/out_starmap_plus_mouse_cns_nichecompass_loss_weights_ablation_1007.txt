None
Run timestamp: 02072023_164304_1007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9894; val_auprc_score: 0.9854; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 2348.2442; train_edge_recon_loss: 27776.5479; train_gene_expr_recon_loss: 12680.0920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42804.8841; train_optim_loss: 42804.8841; val_kl_reg_loss: 2510.1847; val_edge_recon_loss: 26169.0708; val_gene_expr_recon_loss: 11482.4254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40161.6810; val_optim_loss: 40161.6810
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 2495.0634; train_edge_recon_loss: 27214.4170; train_gene_expr_recon_loss: 11189.1698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40898.6501; train_optim_loss: 40898.6501; val_kl_reg_loss: 2452.4095; val_edge_recon_loss: 26051.5983; val_gene_expr_recon_loss: 10862.4854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39366.4931; val_optim_loss: 39366.4931
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9894; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 2517.0822; train_edge_recon_loss: 27138.5634; train_gene_expr_recon_loss: 10755.0969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40410.7425; train_optim_loss: 40410.7425; val_kl_reg_loss: 2553.3677; val_edge_recon_loss: 26003.2165; val_gene_expr_recon_loss: 10560.6554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39117.2396; val_optim_loss: 39117.2396
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9914; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 2535.0104; train_edge_recon_loss: 27073.6421; train_gene_expr_recon_loss: 10508.8754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40117.5281; train_optim_loss: 40117.5281; val_kl_reg_loss: 2545.4326; val_edge_recon_loss: 25937.5908; val_gene_expr_recon_loss: 10352.2041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38835.2274; val_optim_loss: 38835.2274
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9942; val_auprc_score: 0.9922; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 2550.7775; train_edge_recon_loss: 27025.9587; train_gene_expr_recon_loss: 10348.2193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39924.9555; train_optim_loss: 39924.9555; val_kl_reg_loss: 2565.1562; val_edge_recon_loss: 25884.7999; val_gene_expr_recon_loss: 10224.8313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38674.7874; val_optim_loss: 38674.7874
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 2562.2605; train_edge_recon_loss: 26996.1959; train_gene_expr_recon_loss: 10241.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39799.9159; train_optim_loss: 39799.9159; val_kl_reg_loss: 2566.7422; val_edge_recon_loss: 25897.5881; val_gene_expr_recon_loss: 10137.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38601.7944; val_optim_loss: 38601.7944
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 2573.9938; train_edge_recon_loss: 26967.7346; train_gene_expr_recon_loss: 10171.5481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39713.2765; train_optim_loss: 39713.2765; val_kl_reg_loss: 2589.4155; val_edge_recon_loss: 25831.4052; val_gene_expr_recon_loss: 10089.0701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38509.8909; val_optim_loss: 38509.8909
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2583.5481; train_edge_recon_loss: 26940.0236; train_gene_expr_recon_loss: 10112.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39635.8091; train_optim_loss: 39635.8091; val_kl_reg_loss: 2575.9240; val_edge_recon_loss: 25772.0290; val_gene_expr_recon_loss: 10067.4982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38415.4512; val_optim_loss: 38415.4512
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 2594.5693; train_edge_recon_loss: 26909.3737; train_gene_expr_recon_loss: 10073.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39577.8430; train_optim_loss: 39577.8430; val_kl_reg_loss: 2527.4318; val_edge_recon_loss: 25760.7925; val_gene_expr_recon_loss: 10069.5940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38357.8185; val_optim_loss: 38357.8185
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 2603.5371; train_edge_recon_loss: 26880.8194; train_gene_expr_recon_loss: 10035.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39519.4216; train_optim_loss: 39519.4216; val_kl_reg_loss: 2562.3296; val_edge_recon_loss: 25721.4829; val_gene_expr_recon_loss: 10036.7999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38320.6124; val_optim_loss: 38320.6124
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 2610.5764; train_edge_recon_loss: 26869.8218; train_gene_expr_recon_loss: 10013.9218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39494.3201; train_optim_loss: 39494.3201; val_kl_reg_loss: 2596.5935; val_edge_recon_loss: 25727.6206; val_gene_expr_recon_loss: 10015.8096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38340.0239; val_optim_loss: 38340.0239
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 2617.7490; train_edge_recon_loss: 26857.9749; train_gene_expr_recon_loss: 9990.6447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39466.3686; train_optim_loss: 39466.3686; val_kl_reg_loss: 2629.1631; val_edge_recon_loss: 25718.4089; val_gene_expr_recon_loss: 9953.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38301.2219; val_optim_loss: 38301.2219
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 2622.5380; train_edge_recon_loss: 26853.5680; train_gene_expr_recon_loss: 9970.2897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39446.3957; train_optim_loss: 39446.3957; val_kl_reg_loss: 2587.3933; val_edge_recon_loss: 25692.1651; val_gene_expr_recon_loss: 9982.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38261.6576; val_optim_loss: 38261.6576
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 2631.6280; train_edge_recon_loss: 26824.8071; train_gene_expr_recon_loss: 9947.0275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39403.4627; train_optim_loss: 39403.4627; val_kl_reg_loss: 2633.6300; val_edge_recon_loss: 25687.6403; val_gene_expr_recon_loss: 9981.8157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38303.0859; val_optim_loss: 38303.0859
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2635.8329; train_edge_recon_loss: 26820.5848; train_gene_expr_recon_loss: 9941.6903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39398.1079; train_optim_loss: 39398.1079; val_kl_reg_loss: 2618.9557; val_edge_recon_loss: 25668.2542; val_gene_expr_recon_loss: 9963.2690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38250.4787; val_optim_loss: 38250.4787
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 2641.2390; train_edge_recon_loss: 26809.4339; train_gene_expr_recon_loss: 9925.3010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39375.9739; train_optim_loss: 39375.9739; val_kl_reg_loss: 2655.8226; val_edge_recon_loss: 25649.7741; val_gene_expr_recon_loss: 9972.7664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38278.3631; val_optim_loss: 38278.3631
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 2644.7979; train_edge_recon_loss: 26806.2192; train_gene_expr_recon_loss: 9911.1948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39362.2119; train_optim_loss: 39362.2119; val_kl_reg_loss: 2648.3244; val_edge_recon_loss: 25655.3447; val_gene_expr_recon_loss: 9974.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38278.0830; val_optim_loss: 38278.0830
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 2650.0115; train_edge_recon_loss: 26795.7305; train_gene_expr_recon_loss: 9903.0257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39348.7677; train_optim_loss: 39348.7677; val_kl_reg_loss: 2638.8512; val_edge_recon_loss: 25662.4677; val_gene_expr_recon_loss: 9964.4958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38265.8148; val_optim_loss: 38265.8148
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2654.0139; train_edge_recon_loss: 26786.6148; train_gene_expr_recon_loss: 9891.5863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39332.2150; train_optim_loss: 39332.2150; val_kl_reg_loss: 2669.4407; val_edge_recon_loss: 25650.2238; val_gene_expr_recon_loss: 9973.2404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38292.9048; val_optim_loss: 38292.9048

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 2651.6908; train_edge_recon_loss: 26778.5720; train_gene_expr_recon_loss: 9847.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39278.2042; train_optim_loss: 39278.2042; val_kl_reg_loss: 2669.9157; val_edge_recon_loss: 25644.7374; val_gene_expr_recon_loss: 9939.0482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38253.7013; val_optim_loss: 38253.7013
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 2652.4928; train_edge_recon_loss: 26765.2938; train_gene_expr_recon_loss: 9843.9291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39261.7157; train_optim_loss: 39261.7157; val_kl_reg_loss: 2658.5632; val_edge_recon_loss: 25625.0213; val_gene_expr_recon_loss: 9932.2350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38215.8195; val_optim_loss: 38215.8195
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2652.0234; train_edge_recon_loss: 26762.4611; train_gene_expr_recon_loss: 9834.7479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39249.2324; train_optim_loss: 39249.2324; val_kl_reg_loss: 2667.6266; val_edge_recon_loss: 25643.5479; val_gene_expr_recon_loss: 9941.0933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38252.2677; val_optim_loss: 38252.2677
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 2652.0615; train_edge_recon_loss: 26765.4227; train_gene_expr_recon_loss: 9830.3880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39247.8721; train_optim_loss: 39247.8721; val_kl_reg_loss: 2661.7969; val_edge_recon_loss: 25631.2904; val_gene_expr_recon_loss: 9957.5380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38250.6250; val_optim_loss: 38250.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 2652.6104; train_edge_recon_loss: 26761.0113; train_gene_expr_recon_loss: 9821.7410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39235.3627; train_optim_loss: 39235.3627; val_kl_reg_loss: 2660.5427; val_edge_recon_loss: 25635.7229; val_gene_expr_recon_loss: 9942.6321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38238.8979; val_optim_loss: 38238.8979
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9877; train_kl_reg_loss: 2652.9386; train_edge_recon_loss: 26761.7642; train_gene_expr_recon_loss: 9818.7877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39233.4906; train_optim_loss: 39233.4906; val_kl_reg_loss: 2670.1528; val_edge_recon_loss: 25641.9169; val_gene_expr_recon_loss: 9952.5415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38264.6113; val_optim_loss: 38264.6113

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9877; val_best_f1_score: 0.9877; train_kl_reg_loss: 2653.4909; train_edge_recon_loss: 26758.0681; train_gene_expr_recon_loss: 9824.8470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39236.4061; train_optim_loss: 39236.4061; val_kl_reg_loss: 2663.8848; val_edge_recon_loss: 25631.7158; val_gene_expr_recon_loss: 9950.9295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38246.5301; val_optim_loss: 38246.5301
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 2651.7973; train_edge_recon_loss: 26765.8164; train_gene_expr_recon_loss: 9824.8932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39242.5070; train_optim_loss: 39242.5070; val_kl_reg_loss: 2660.3026; val_edge_recon_loss: 25645.9795; val_gene_expr_recon_loss: 9957.9747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38264.2570; val_optim_loss: 38264.2570
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2652.4641; train_edge_recon_loss: 26759.6710; train_gene_expr_recon_loss: 9816.1655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39228.3006; train_optim_loss: 39228.3006; val_kl_reg_loss: 2663.5820; val_edge_recon_loss: 25613.2858; val_gene_expr_recon_loss: 9932.4212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38209.2889; val_optim_loss: 38209.2889
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2652.1468; train_edge_recon_loss: 26762.2127; train_gene_expr_recon_loss: 9815.1990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39229.5585; train_optim_loss: 39229.5585; val_kl_reg_loss: 2661.5684; val_edge_recon_loss: 25633.4534; val_gene_expr_recon_loss: 9932.8163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38227.8380; val_optim_loss: 38227.8380
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 2652.9315; train_edge_recon_loss: 26758.8750; train_gene_expr_recon_loss: 9819.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39231.6323; train_optim_loss: 39231.6323; val_kl_reg_loss: 2660.3331; val_edge_recon_loss: 25637.2656; val_gene_expr_recon_loss: 9938.3725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38235.9712; val_optim_loss: 38235.9712
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2653.8846; train_edge_recon_loss: 26752.5929; train_gene_expr_recon_loss: 9814.7516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39221.2291; train_optim_loss: 39221.2291; val_kl_reg_loss: 2662.7415; val_edge_recon_loss: 25633.2001; val_gene_expr_recon_loss: 9921.0083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38216.9501; val_optim_loss: 38216.9501
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 2653.6528; train_edge_recon_loss: 26752.0226; train_gene_expr_recon_loss: 9805.7497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39211.4251; train_optim_loss: 39211.4251; val_kl_reg_loss: 2665.3100; val_edge_recon_loss: 25623.2659; val_gene_expr_recon_loss: 9929.6185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38218.1941; val_optim_loss: 38218.1941

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 2654.0130; train_edge_recon_loss: 26756.3301; train_gene_expr_recon_loss: 9815.0705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39225.4135; train_optim_loss: 39225.4135; val_kl_reg_loss: 2663.9092; val_edge_recon_loss: 25626.9618; val_gene_expr_recon_loss: 9944.1685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38235.0397; val_optim_loss: 38235.0397
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2653.6522; train_edge_recon_loss: 26754.5035; train_gene_expr_recon_loss: 9807.9343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39216.0900; train_optim_loss: 39216.0900; val_kl_reg_loss: 2663.9259; val_edge_recon_loss: 25612.5578; val_gene_expr_recon_loss: 9943.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38220.1468; val_optim_loss: 38220.1468
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 2653.4646; train_edge_recon_loss: 26759.3728; train_gene_expr_recon_loss: 9808.5232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39221.3606; train_optim_loss: 39221.3606; val_kl_reg_loss: 2663.2434; val_edge_recon_loss: 25630.5785; val_gene_expr_recon_loss: 9938.6268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38232.4486; val_optim_loss: 38232.4486
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2652.4557; train_edge_recon_loss: 26763.6798; train_gene_expr_recon_loss: 9814.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39231.0330; train_optim_loss: 39231.0330; val_kl_reg_loss: 2662.0242; val_edge_recon_loss: 25646.3411; val_gene_expr_recon_loss: 9917.4819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38225.8477; val_optim_loss: 38225.8477

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 327 min 13 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9980
Val AUPRC score: 0.9976
Val best accuracy score: 0.9873
Val best F1 score: 0.9874
Val gene expr MSE score: 0.6566

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
