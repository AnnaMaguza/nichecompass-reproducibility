None
Run timestamp: 30062023_100002_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9618; val_auprc_score: 0.9553; val_best_acc_score: 0.9021; val_best_f1_score: 0.9028; train_kl_reg_loss: 5795.7139; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121341.1703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127136.8840; train_optim_loss: 127136.8840; val_kl_reg_loss: 5418.8596; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107889.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113308.6023; val_optim_loss: 113308.6023
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9659; val_auprc_score: 0.9597; val_best_acc_score: 0.9096; val_best_f1_score: 0.9097; train_kl_reg_loss: 4872.2643; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105082.5695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109954.8341; train_optim_loss: 109954.8341; val_kl_reg_loss: 4322.7775; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102905.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107228.0625; val_optim_loss: 107228.0625
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9682; val_auprc_score: 0.9642; val_best_acc_score: 0.9118; val_best_f1_score: 0.9134; train_kl_reg_loss: 4036.1611; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 101274.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 105311.0473; train_optim_loss: 105311.0473; val_kl_reg_loss: 3576.3425; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 100409.1776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103985.5199; val_optim_loss: 103985.5199
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9689; val_auprc_score: 0.9654; val_best_acc_score: 0.9117; val_best_f1_score: 0.9134; train_kl_reg_loss: 3612.2519; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 98753.4459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 102365.6978; train_optim_loss: 102365.6978; val_kl_reg_loss: 3308.0238; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 98077.7095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101385.7330; val_optim_loss: 101385.7330
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9680; val_auprc_score: 0.9653; val_best_acc_score: 0.9095; val_best_f1_score: 0.9095; train_kl_reg_loss: 3374.6507; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 96875.7697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100250.4205; train_optim_loss: 100250.4205; val_kl_reg_loss: 3232.2430; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96731.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99964.0884; val_optim_loss: 99964.0884
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9669; val_auprc_score: 0.9651; val_best_acc_score: 0.9076; val_best_f1_score: 0.9070; train_kl_reg_loss: 3231.2103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 95304.4614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98535.6715; train_optim_loss: 98535.6715; val_kl_reg_loss: 3080.4529; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 95554.9499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98635.4034; val_optim_loss: 98635.4034
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9664; val_auprc_score: 0.9652; val_best_acc_score: 0.9058; val_best_f1_score: 0.9052; train_kl_reg_loss: 3137.0723; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93922.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97059.6386; train_optim_loss: 97059.6386; val_kl_reg_loss: 2988.3256; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 94372.8722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97361.1978; val_optim_loss: 97361.1978
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9645; val_auprc_score: 0.9635; val_best_acc_score: 0.9017; val_best_f1_score: 0.9026; train_kl_reg_loss: 3073.5084; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 92894.9158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95968.4242; train_optim_loss: 95968.4242; val_kl_reg_loss: 2982.5774; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 93285.9048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96268.4822; val_optim_loss: 96268.4822
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9633; val_auprc_score: 0.9629; val_best_acc_score: 0.9010; val_best_f1_score: 0.8997; train_kl_reg_loss: 3023.4622; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91991.1618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95014.6239; train_optim_loss: 95014.6239; val_kl_reg_loss: 2952.9320; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 92937.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95890.7884; val_optim_loss: 95890.7884
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9621; val_auprc_score: 0.9623; val_best_acc_score: 0.8987; val_best_f1_score: 0.8988; train_kl_reg_loss: 2989.0242; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91099.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94088.1260; train_optim_loss: 94088.1260; val_kl_reg_loss: 2916.8804; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 92427.4893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95344.3700; val_optim_loss: 95344.3700
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9616; val_auprc_score: 0.9628; val_best_acc_score: 0.8965; val_best_f1_score: 0.8975; train_kl_reg_loss: 2955.7727; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 90439.5565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93395.3291; train_optim_loss: 93395.3291; val_kl_reg_loss: 2876.5444; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 91860.9162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94737.4609; val_optim_loss: 94737.4609
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9597; val_auprc_score: 0.9612; val_best_acc_score: 0.8953; val_best_f1_score: 0.8950; train_kl_reg_loss: 2934.5278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 89876.5767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92811.1043; train_optim_loss: 92811.1043; val_kl_reg_loss: 2876.1993; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 91205.8395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94082.0384; val_optim_loss: 94082.0384
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9579; val_auprc_score: 0.9594; val_best_acc_score: 0.8929; val_best_f1_score: 0.8907; train_kl_reg_loss: 2916.1745; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 89318.9606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92235.1352; train_optim_loss: 92235.1352; val_kl_reg_loss: 2832.9879; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90720.8388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93553.8271; val_optim_loss: 93553.8271
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9576; val_auprc_score: 0.9589; val_best_acc_score: 0.8916; val_best_f1_score: 0.8915; train_kl_reg_loss: 2898.4756; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 88727.9269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91626.4020; train_optim_loss: 91626.4020; val_kl_reg_loss: 2791.5025; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90865.4698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93656.9727; val_optim_loss: 93656.9727
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9578; val_auprc_score: 0.9597; val_best_acc_score: 0.8929; val_best_f1_score: 0.8917; train_kl_reg_loss: 2884.8901; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 88443.8619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91328.7520; train_optim_loss: 91328.7520; val_kl_reg_loss: 2808.9639; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90724.5245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93533.4886; val_optim_loss: 93533.4886
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9560; val_auprc_score: 0.9581; val_best_acc_score: 0.8901; val_best_f1_score: 0.8900; train_kl_reg_loss: 2872.3090; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87966.1723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90838.4812; train_optim_loss: 90838.4812; val_kl_reg_loss: 2827.4224; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90591.1651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93418.5884; val_optim_loss: 93418.5884
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9560; val_auprc_score: 0.9589; val_best_acc_score: 0.8917; val_best_f1_score: 0.8901; train_kl_reg_loss: 2862.5192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87689.7911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90552.3103; train_optim_loss: 90552.3103; val_kl_reg_loss: 2793.5329; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90536.8658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93330.3988; val_optim_loss: 93330.3988
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9538; val_auprc_score: 0.9577; val_best_acc_score: 0.8877; val_best_f1_score: 0.8867; train_kl_reg_loss: 2852.4312; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87359.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90212.3238; train_optim_loss: 90212.3238; val_kl_reg_loss: 2750.9337; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89985.9247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92736.8594; val_optim_loss: 92736.8594
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9529; val_auprc_score: 0.9564; val_best_acc_score: 0.8867; val_best_f1_score: 0.8866; train_kl_reg_loss: 2845.8786; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87120.3692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89966.2475; train_optim_loss: 89966.2475; val_kl_reg_loss: 2755.3128; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90023.9279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92779.2404; val_optim_loss: 92779.2404
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9544; val_auprc_score: 0.9583; val_best_acc_score: 0.8901; val_best_f1_score: 0.8887; train_kl_reg_loss: 2837.5551; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86781.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89619.0627; train_optim_loss: 89619.0627; val_kl_reg_loss: 2768.0397; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90148.7255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92916.7656; val_optim_loss: 92916.7656
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9541; val_auprc_score: 0.9581; val_best_acc_score: 0.8908; val_best_f1_score: 0.8883; train_kl_reg_loss: 2830.2512; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86560.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89390.3702; train_optim_loss: 89390.3702; val_kl_reg_loss: 2759.9656; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90058.5891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92818.5554; val_optim_loss: 92818.5554
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9521; val_auprc_score: 0.9571; val_best_acc_score: 0.8867; val_best_f1_score: 0.8843; train_kl_reg_loss: 2824.8461; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86374.6678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89199.5140; train_optim_loss: 89199.5140; val_kl_reg_loss: 2761.0797; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89958.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92720.0543; val_optim_loss: 92720.0543
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9521; val_auprc_score: 0.9567; val_best_acc_score: 0.8872; val_best_f1_score: 0.8861; train_kl_reg_loss: 2820.2611; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86196.6918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89016.9530; train_optim_loss: 89016.9530; val_kl_reg_loss: 2766.1544; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89882.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92648.5124; val_optim_loss: 92648.5124
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9502; val_auprc_score: 0.9552; val_best_acc_score: 0.8857; val_best_f1_score: 0.8839; train_kl_reg_loss: 2813.1943; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85981.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88794.3270; train_optim_loss: 88794.3270; val_kl_reg_loss: 2753.1638; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89957.6864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92710.8498; val_optim_loss: 92710.8498
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9518; val_auprc_score: 0.9572; val_best_acc_score: 0.8878; val_best_f1_score: 0.8865; train_kl_reg_loss: 2810.2746; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85769.4195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88579.6939; train_optim_loss: 88579.6939; val_kl_reg_loss: 2718.8115; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90055.8448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92774.6559; val_optim_loss: 92774.6559
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9498; val_auprc_score: 0.9555; val_best_acc_score: 0.8855; val_best_f1_score: 0.8818; train_kl_reg_loss: 2807.9882; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85590.9917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88398.9799; train_optim_loss: 88398.9799; val_kl_reg_loss: 2761.9669; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89586.3196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92348.2869; val_optim_loss: 92348.2869
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9495; val_auprc_score: 0.9548; val_best_acc_score: 0.8844; val_best_f1_score: 0.8833; train_kl_reg_loss: 2803.3038; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85459.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88263.1221; train_optim_loss: 88263.1221; val_kl_reg_loss: 2751.8686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89619.5778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92371.4471; val_optim_loss: 92371.4471
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9496; val_auprc_score: 0.9554; val_best_acc_score: 0.8841; val_best_f1_score: 0.8829; train_kl_reg_loss: 2798.1636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85314.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88112.8527; train_optim_loss: 88112.8527; val_kl_reg_loss: 2768.1434; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89938.2003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92706.3434; val_optim_loss: 92706.3434
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9478; val_auprc_score: 0.9542; val_best_acc_score: 0.8830; val_best_f1_score: 0.8811; train_kl_reg_loss: 2794.8912; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85193.9101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87988.8013; train_optim_loss: 87988.8013; val_kl_reg_loss: 2778.0317; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89849.8597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92627.8906; val_optim_loss: 92627.8906
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9488; val_auprc_score: 0.9550; val_best_acc_score: 0.8857; val_best_f1_score: 0.8823; train_kl_reg_loss: 2794.6296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84998.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87793.5644; train_optim_loss: 87793.5644; val_kl_reg_loss: 2745.9721; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89713.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92459.8253; val_optim_loss: 92459.8253

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9489; val_auprc_score: 0.9558; val_best_acc_score: 0.8847; val_best_f1_score: 0.8835; train_kl_reg_loss: 2730.5510; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84310.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87041.2594; train_optim_loss: 87041.2594; val_kl_reg_loss: 2667.3313; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89557.9542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92225.2859; val_optim_loss: 92225.2859
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9476; val_auprc_score: 0.9537; val_best_acc_score: 0.8829; val_best_f1_score: 0.8817; train_kl_reg_loss: 2723.4164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84267.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86990.8898; train_optim_loss: 86990.8898; val_kl_reg_loss: 2671.6250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89411.4421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92083.0668; val_optim_loss: 92083.0668
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9478; val_auprc_score: 0.9540; val_best_acc_score: 0.8836; val_best_f1_score: 0.8820; train_kl_reg_loss: 2723.1726; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84303.6735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87026.8459; train_optim_loss: 87026.8459; val_kl_reg_loss: 2665.5683; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89191.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91857.3182; val_optim_loss: 91857.3182
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9481; val_auprc_score: 0.9546; val_best_acc_score: 0.8866; val_best_f1_score: 0.8846; train_kl_reg_loss: 2723.0608; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84231.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86954.7367; train_optim_loss: 86954.7367; val_kl_reg_loss: 2664.8015; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89651.7212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92316.5231; val_optim_loss: 92316.5231
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9474; val_auprc_score: 0.9542; val_best_acc_score: 0.8838; val_best_f1_score: 0.8823; train_kl_reg_loss: 2722.4120; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84224.1881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86946.6001; train_optim_loss: 86946.6001; val_kl_reg_loss: 2679.0793; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89587.8690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92266.9485; val_optim_loss: 92266.9485
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9488; val_auprc_score: 0.9557; val_best_acc_score: 0.8860; val_best_f1_score: 0.8835; train_kl_reg_loss: 2722.3701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84239.8446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86962.2149; train_optim_loss: 86962.2149; val_kl_reg_loss: 2657.8013; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89472.6605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92130.4613; val_optim_loss: 92130.4613
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9475; val_auprc_score: 0.9545; val_best_acc_score: 0.8838; val_best_f1_score: 0.8815; train_kl_reg_loss: 2720.2350; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84147.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86867.6295; train_optim_loss: 86867.6295; val_kl_reg_loss: 2666.3441; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89292.6836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91959.0277; val_optim_loss: 91959.0277

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9478; val_auprc_score: 0.9546; val_best_acc_score: 0.8845; val_best_f1_score: 0.8820; train_kl_reg_loss: 2715.9508; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84123.7510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86839.7015; train_optim_loss: 86839.7015; val_kl_reg_loss: 2659.4558; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89684.6996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92344.1555; val_optim_loss: 92344.1555
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9478; val_auprc_score: 0.9546; val_best_acc_score: 0.8842; val_best_f1_score: 0.8819; train_kl_reg_loss: 2712.2256; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84151.7976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86864.0234; train_optim_loss: 86864.0234; val_kl_reg_loss: 2662.8001; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89787.5476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92450.3480; val_optim_loss: 92450.3480
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9468; val_auprc_score: 0.9531; val_best_acc_score: 0.8832; val_best_f1_score: 0.8807; train_kl_reg_loss: 2713.5877; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84066.1393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86779.7269; train_optim_loss: 86779.7269; val_kl_reg_loss: 2661.3091; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89380.1499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92041.4588; val_optim_loss: 92041.4588
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9469; val_auprc_score: 0.9536; val_best_acc_score: 0.8833; val_best_f1_score: 0.8808; train_kl_reg_loss: 2712.4053; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84086.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86798.7511; train_optim_loss: 86798.7511; val_kl_reg_loss: 2657.0736; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89628.8683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92285.9425; val_optim_loss: 92285.9425

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 52 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9486
Val AUPRC score: 0.9551
Val best accuracy score: 0.8850
Val best F1 score: 0.8832
Val gene expr MSE score: 0.6833

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
