None
Run timestamp: 14072023_095738_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9565; val_auprc_score: 0.9348; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 24734.3392; train_edge_recon_loss: 27386030.2708; train_gene_expr_recon_loss: 1465835.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28876599.5729; train_optim_loss: 28876599.5729; val_kl_reg_loss: 25193.7731; val_edge_recon_loss: 26490845.8182; val_gene_expr_recon_loss: 1345789.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27861828.7273; val_optim_loss: 27861828.7273
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9697; val_auprc_score: 0.9538; val_best_acc_score: 0.9287; val_best_f1_score: 0.9313; train_kl_reg_loss: 24383.3563; train_edge_recon_loss: 26057403.2917; train_gene_expr_recon_loss: 1298665.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27380452.4792; train_optim_loss: 27380452.4792; val_kl_reg_loss: 22008.0285; val_edge_recon_loss: 26255630.7273; val_gene_expr_recon_loss: 1247314.8239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27524953.5455; val_optim_loss: 27524953.5455
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9708; val_auprc_score: 0.9563; val_best_acc_score: 0.9330; val_best_f1_score: 0.9352; train_kl_reg_loss: 22680.3315; train_edge_recon_loss: 25931791.6458; train_gene_expr_recon_loss: 1221752.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176224.7500; train_optim_loss: 27176224.7500; val_kl_reg_loss: 21730.8141; val_edge_recon_loss: 26142979.9091; val_gene_expr_recon_loss: 1176923.5966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27341634.3636; val_optim_loss: 27341634.3636
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9717; val_auprc_score: 0.9580; val_best_acc_score: 0.9344; val_best_f1_score: 0.9366; train_kl_reg_loss: 22098.3925; train_edge_recon_loss: 25851185.9271; train_gene_expr_recon_loss: 1178618.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27051902.3438; train_optim_loss: 27051902.3438; val_kl_reg_loss: 20777.0342; val_edge_recon_loss: 26096384.3636; val_gene_expr_recon_loss: 1157850.2159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27275011.8182; val_optim_loss: 27275011.8182
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9739; val_auprc_score: 0.9623; val_best_acc_score: 0.9385; val_best_f1_score: 0.9406; train_kl_reg_loss: 20886.5020; train_edge_recon_loss: 25808857.3229; train_gene_expr_recon_loss: 1152064.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26981808.2812; train_optim_loss: 26981808.2812; val_kl_reg_loss: 19828.5287; val_edge_recon_loss: 26042054.3636; val_gene_expr_recon_loss: 1132521.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27194404.7273; val_optim_loss: 27194404.7273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9747; val_auprc_score: 0.9620; val_best_acc_score: 0.9417; val_best_f1_score: 0.9435; train_kl_reg_loss: 20423.3800; train_edge_recon_loss: 25753498.4167; train_gene_expr_recon_loss: 1131523.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26905445.3750; train_optim_loss: 26905445.3750; val_kl_reg_loss: 19632.8572; val_edge_recon_loss: 25979218.4545; val_gene_expr_recon_loss: 1116724.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27115576.0000; val_optim_loss: 27115576.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9774; val_auprc_score: 0.9649; val_best_acc_score: 0.9470; val_best_f1_score: 0.9486; train_kl_reg_loss: 20541.8347; train_edge_recon_loss: 25725539.2708; train_gene_expr_recon_loss: 1114900.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26860982.1042; train_optim_loss: 26860982.1042; val_kl_reg_loss: 19871.0415; val_edge_recon_loss: 25850203.8182; val_gene_expr_recon_loss: 1101706.9943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26971782.0000; val_optim_loss: 26971782.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9765; val_auprc_score: 0.9638; val_best_acc_score: 0.9464; val_best_f1_score: 0.9479; train_kl_reg_loss: 20665.7584; train_edge_recon_loss: 25699863.7812; train_gene_expr_recon_loss: 1100823.6751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26821353.1458; train_optim_loss: 26821353.1458; val_kl_reg_loss: 20159.8660; val_edge_recon_loss: 25931154.2727; val_gene_expr_recon_loss: 1085196.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27036510.1818; val_optim_loss: 27036510.1818
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9780; val_auprc_score: 0.9666; val_best_acc_score: 0.9486; val_best_f1_score: 0.9500; train_kl_reg_loss: 20678.5554; train_edge_recon_loss: 25706797.5625; train_gene_expr_recon_loss: 1090468.6803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26817944.7500; train_optim_loss: 26817944.7500; val_kl_reg_loss: 19958.6101; val_edge_recon_loss: 25946302.8182; val_gene_expr_recon_loss: 1075239.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27041500.6364; val_optim_loss: 27041500.6364
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9777; val_auprc_score: 0.9646; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 20493.8247; train_edge_recon_loss: 25656681.6250; train_gene_expr_recon_loss: 1080910.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26758086.2917; train_optim_loss: 26758086.2917; val_kl_reg_loss: 20354.2014; val_edge_recon_loss: 25896068.2727; val_gene_expr_recon_loss: 1069105.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26985528.5455; val_optim_loss: 26985528.5455
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9797; val_auprc_score: 0.9688; val_best_acc_score: 0.9505; val_best_f1_score: 0.9517; train_kl_reg_loss: 20579.8891; train_edge_recon_loss: 25652031.3854; train_gene_expr_recon_loss: 1072488.2533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26745099.5417; train_optim_loss: 26745099.5417; val_kl_reg_loss: 19794.6134; val_edge_recon_loss: 25878742.6364; val_gene_expr_recon_loss: 1060887.9205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26959425.1818; val_optim_loss: 26959425.1818
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9795; val_auprc_score: 0.9688; val_best_acc_score: 0.9519; val_best_f1_score: 0.9532; train_kl_reg_loss: 20239.3866; train_edge_recon_loss: 25632267.8229; train_gene_expr_recon_loss: 1065434.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26717941.6146; train_optim_loss: 26717941.6146; val_kl_reg_loss: 18492.0420; val_edge_recon_loss: 25862920.5455; val_gene_expr_recon_loss: 1057407.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26938820.2727; val_optim_loss: 26938820.2727
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9799; val_auprc_score: 0.9676; val_best_acc_score: 0.9540; val_best_f1_score: 0.9553; train_kl_reg_loss: 20126.4091; train_edge_recon_loss: 25621599.1354; train_gene_expr_recon_loss: 1059593.6904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26701319.3229; train_optim_loss: 26701319.3229; val_kl_reg_loss: 19025.6625; val_edge_recon_loss: 25843217.1818; val_gene_expr_recon_loss: 1049081.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26911324.6364; val_optim_loss: 26911324.6364
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9804; val_auprc_score: 0.9699; val_best_acc_score: 0.9534; val_best_f1_score: 0.9547; train_kl_reg_loss: 19770.8362; train_edge_recon_loss: 25613753.9375; train_gene_expr_recon_loss: 1054833.4443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26688358.2708; train_optim_loss: 26688358.2708; val_kl_reg_loss: 19067.6563; val_edge_recon_loss: 25835070.9091; val_gene_expr_recon_loss: 1046372.9517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26900511.6364; val_optim_loss: 26900511.6364
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9822; val_auprc_score: 0.9720; val_best_acc_score: 0.9557; val_best_f1_score: 0.9569; train_kl_reg_loss: 20277.4442; train_edge_recon_loss: 25573520.8854; train_gene_expr_recon_loss: 1048029.3245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26641827.6667; train_optim_loss: 26641827.6667; val_kl_reg_loss: 19538.0700; val_edge_recon_loss: 25772203.2727; val_gene_expr_recon_loss: 1040021.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26831763.1818; val_optim_loss: 26831763.1818
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9822; val_auprc_score: 0.9722; val_best_acc_score: 0.9562; val_best_f1_score: 0.9573; train_kl_reg_loss: 19992.3362; train_edge_recon_loss: 25572023.7396; train_gene_expr_recon_loss: 1043872.0107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26635888.0729; train_optim_loss: 26635888.0729; val_kl_reg_loss: 19115.9211; val_edge_recon_loss: 25795611.4545; val_gene_expr_recon_loss: 1036288.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26851015.8182; val_optim_loss: 26851015.8182
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9825; val_auprc_score: 0.9737; val_best_acc_score: 0.9573; val_best_f1_score: 0.9584; train_kl_reg_loss: 20137.6527; train_edge_recon_loss: 25557542.9896; train_gene_expr_recon_loss: 1039086.1387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26616766.8021; train_optim_loss: 26616766.8021; val_kl_reg_loss: 19252.1887; val_edge_recon_loss: 25769074.6364; val_gene_expr_recon_loss: 1034314.1847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26822640.8182; val_optim_loss: 26822640.8182
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9829; val_auprc_score: 0.9733; val_best_acc_score: 0.9573; val_best_f1_score: 0.9584; train_kl_reg_loss: 19801.6666; train_edge_recon_loss: 25566778.1458; train_gene_expr_recon_loss: 1035844.8096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26622424.5104; train_optim_loss: 26622424.5104; val_kl_reg_loss: 19818.9865; val_edge_recon_loss: 25762903.0909; val_gene_expr_recon_loss: 1025323.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26808045.2727; val_optim_loss: 26808045.2727
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9820; val_auprc_score: 0.9712; val_best_acc_score: 0.9578; val_best_f1_score: 0.9590; train_kl_reg_loss: 19956.6457; train_edge_recon_loss: 25561080.8125; train_gene_expr_recon_loss: 1031490.2438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26612527.7292; train_optim_loss: 26612527.7292; val_kl_reg_loss: 19781.8599; val_edge_recon_loss: 25783330.7273; val_gene_expr_recon_loss: 1025575.4176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26828688.0000; val_optim_loss: 26828688.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9852; val_auprc_score: 0.9785; val_best_acc_score: 0.9590; val_best_f1_score: 0.9602; train_kl_reg_loss: 19964.7988; train_edge_recon_loss: 25551508.8333; train_gene_expr_recon_loss: 1027108.1022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26598581.8021; train_optim_loss: 26598581.8021; val_kl_reg_loss: 19075.5371; val_edge_recon_loss: 25731330.4545; val_gene_expr_recon_loss: 1020368.9574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26770775.0909; val_optim_loss: 26770775.0909
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9847; val_auprc_score: 0.9765; val_best_acc_score: 0.9609; val_best_f1_score: 0.9619; train_kl_reg_loss: 20144.4246; train_edge_recon_loss: 25549437.1354; train_gene_expr_recon_loss: 1024135.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26593716.8021; train_optim_loss: 26593716.8021; val_kl_reg_loss: 19564.0888; val_edge_recon_loss: 25724341.1818; val_gene_expr_recon_loss: 1016827.0114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26760732.3636; val_optim_loss: 26760732.3636
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9847; val_auprc_score: 0.9769; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 19995.2062; train_edge_recon_loss: 25543135.1354; train_gene_expr_recon_loss: 1022811.8958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26585942.2500; train_optim_loss: 26585942.2500; val_kl_reg_loss: 19001.9403; val_edge_recon_loss: 25723504.0909; val_gene_expr_recon_loss: 1015799.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26758305.4545; val_optim_loss: 26758305.4545
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9852; val_auprc_score: 0.9776; val_best_acc_score: 0.9596; val_best_f1_score: 0.9605; train_kl_reg_loss: 19710.4572; train_edge_recon_loss: 25542335.6979; train_gene_expr_recon_loss: 1019860.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26581906.3854; train_optim_loss: 26581906.3854; val_kl_reg_loss: 19506.9499; val_edge_recon_loss: 25742177.0909; val_gene_expr_recon_loss: 1013269.8494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26774953.7273; val_optim_loss: 26774953.7273
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9853; val_auprc_score: 0.9785; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 19810.5974; train_edge_recon_loss: 25527175.8750; train_gene_expr_recon_loss: 1016602.1790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26563588.7083; train_optim_loss: 26563588.7083; val_kl_reg_loss: 19005.6523; val_edge_recon_loss: 25744511.0000; val_gene_expr_recon_loss: 1014442.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26777959.3636; val_optim_loss: 26777959.3636
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9863; val_auprc_score: 0.9789; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 19896.2756; train_edge_recon_loss: 25545389.7083; train_gene_expr_recon_loss: 1013545.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26578831.8646; train_optim_loss: 26578831.8646; val_kl_reg_loss: 19423.4762; val_edge_recon_loss: 25669676.0000; val_gene_expr_recon_loss: 1007390.3892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26696489.6364; val_optim_loss: 26696489.6364
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9852; val_auprc_score: 0.9773; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 19865.6391; train_edge_recon_loss: 25525758.1042; train_gene_expr_recon_loss: 1011525.3232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26557149.1042; train_optim_loss: 26557149.1042; val_kl_reg_loss: 19294.3164; val_edge_recon_loss: 25776565.1818; val_gene_expr_recon_loss: 1005643.5085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26801502.9091; val_optim_loss: 26801502.9091
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9864; val_auprc_score: 0.9785; val_best_acc_score: 0.9633; val_best_f1_score: 0.9641; train_kl_reg_loss: 19918.9996; train_edge_recon_loss: 25516588.4792; train_gene_expr_recon_loss: 1008829.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26545336.5521; train_optim_loss: 26545336.5521; val_kl_reg_loss: 19195.4851; val_edge_recon_loss: 25660153.1818; val_gene_expr_recon_loss: 1005192.9830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26684541.8182; val_optim_loss: 26684541.8182
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9856; val_auprc_score: 0.9785; val_best_acc_score: 0.9614; val_best_f1_score: 0.9624; train_kl_reg_loss: 20026.0548; train_edge_recon_loss: 25500051.4167; train_gene_expr_recon_loss: 1006152.7230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26526230.1042; train_optim_loss: 26526230.1042; val_kl_reg_loss: 19675.6555; val_edge_recon_loss: 25756797.9091; val_gene_expr_recon_loss: 1001498.6648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26777972.2727; val_optim_loss: 26777972.2727
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9866; val_auprc_score: 0.9800; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 20093.7007; train_edge_recon_loss: 25508716.5312; train_gene_expr_recon_loss: 1004288.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26533098.9896; train_optim_loss: 26533098.9896; val_kl_reg_loss: 19489.0103; val_edge_recon_loss: 25739591.2727; val_gene_expr_recon_loss: 1002302.6477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26761383.2727; val_optim_loss: 26761383.2727
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9870; val_auprc_score: 0.9803; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 20070.0862; train_edge_recon_loss: 25504763.5833; train_gene_expr_recon_loss: 1003059.6357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26527893.2708; train_optim_loss: 26527893.2708; val_kl_reg_loss: 19402.5963; val_edge_recon_loss: 25716442.5455; val_gene_expr_recon_loss: 998837.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26734682.2727; val_optim_loss: 26734682.2727
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9872; val_auprc_score: 0.9802; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 20184.7993; train_edge_recon_loss: 25508096.0208; train_gene_expr_recon_loss: 1000862.4378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26529143.2292; train_optim_loss: 26529143.2292; val_kl_reg_loss: 20046.9173; val_edge_recon_loss: 25712542.0000; val_gene_expr_recon_loss: 998285.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26730875.0909; val_optim_loss: 26730875.0909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9869; val_auprc_score: 0.9793; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 20318.0394; train_edge_recon_loss: 25495502.2812; train_gene_expr_recon_loss: 997121.9421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26512942.2396; train_optim_loss: 26512942.2396; val_kl_reg_loss: 19701.1069; val_edge_recon_loss: 25664739.0909; val_gene_expr_recon_loss: 992676.6051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26677116.8182; val_optim_loss: 26677116.8182
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9877; val_auprc_score: 0.9806; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 20244.5394; train_edge_recon_loss: 25483840.3021; train_gene_expr_recon_loss: 996124.4460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26500209.2917; train_optim_loss: 26500209.2917; val_kl_reg_loss: 19659.2755; val_edge_recon_loss: 25630557.0909; val_gene_expr_recon_loss: 994421.0398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26644637.3636; val_optim_loss: 26644637.3636
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9869; val_auprc_score: 0.9795; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 20172.7963; train_edge_recon_loss: 25486694.3958; train_gene_expr_recon_loss: 994793.0732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26501660.2917; train_optim_loss: 26501660.2917; val_kl_reg_loss: 19567.5082; val_edge_recon_loss: 25663609.4545; val_gene_expr_recon_loss: 991456.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26674633.1818; val_optim_loss: 26674633.1818
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9878; val_auprc_score: 0.9816; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 20047.1613; train_edge_recon_loss: 25499007.8750; train_gene_expr_recon_loss: 994946.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26514001.3854; train_optim_loss: 26514001.3854; val_kl_reg_loss: 19385.0518; val_edge_recon_loss: 25679466.9091; val_gene_expr_recon_loss: 990973.7926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26689825.7273; val_optim_loss: 26689825.7273
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9874; val_auprc_score: 0.9812; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 19961.9803; train_edge_recon_loss: 25491840.9167; train_gene_expr_recon_loss: 994998.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26506800.9062; train_optim_loss: 26506800.9062; val_kl_reg_loss: 19386.5264; val_edge_recon_loss: 25693009.4545; val_gene_expr_recon_loss: 991464.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26703859.9091; val_optim_loss: 26703859.9091
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9877; val_auprc_score: 0.9816; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 19929.8069; train_edge_recon_loss: 25478095.1146; train_gene_expr_recon_loss: 994992.0397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26493016.9479; train_optim_loss: 26493016.9479; val_kl_reg_loss: 19345.2117; val_edge_recon_loss: 25662897.0000; val_gene_expr_recon_loss: 995497.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26677739.0000; val_optim_loss: 26677739.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9876; val_auprc_score: 0.9808; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 19896.0804; train_edge_recon_loss: 25495403.8958; train_gene_expr_recon_loss: 994499.5853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26509799.5729; train_optim_loss: 26509799.5729; val_kl_reg_loss: 19374.8620; val_edge_recon_loss: 25688753.8182; val_gene_expr_recon_loss: 994236.2614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26702364.8182; val_optim_loss: 26702364.8182
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9885; val_auprc_score: 0.9825; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 19895.5433; train_edge_recon_loss: 25481299.7812; train_gene_expr_recon_loss: 994622.1670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26495817.5729; train_optim_loss: 26495817.5729; val_kl_reg_loss: 19403.8108; val_edge_recon_loss: 25624209.0909; val_gene_expr_recon_loss: 993623.7301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26637236.6364; val_optim_loss: 26637236.6364
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9876; val_auprc_score: 0.9813; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 19892.7803; train_edge_recon_loss: 25486399.6458; train_gene_expr_recon_loss: 993944.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26500237.2812; train_optim_loss: 26500237.2812; val_kl_reg_loss: 19372.3061; val_edge_recon_loss: 25692452.8182; val_gene_expr_recon_loss: 991172.1903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26702997.9091; val_optim_loss: 26702997.9091
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9870; val_auprc_score: 0.9794; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 19887.3202; train_edge_recon_loss: 25493976.4583; train_gene_expr_recon_loss: 993189.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26507053.6562; train_optim_loss: 26507053.6562; val_kl_reg_loss: 19389.1744; val_edge_recon_loss: 25653674.7273; val_gene_expr_recon_loss: 992738.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26665802.9091; val_optim_loss: 26665802.9091
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9886; val_auprc_score: 0.9829; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 19914.1876; train_edge_recon_loss: 25492968.5104; train_gene_expr_recon_loss: 994539.3757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26507422.0625; train_optim_loss: 26507422.0625; val_kl_reg_loss: 19374.2540; val_edge_recon_loss: 25643109.6364; val_gene_expr_recon_loss: 991248.8920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26653732.4545; val_optim_loss: 26653732.4545
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9882; val_auprc_score: 0.9823; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 19906.6861; train_edge_recon_loss: 25489538.6458; train_gene_expr_recon_loss: 993551.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26502996.4271; train_optim_loss: 26502996.4271; val_kl_reg_loss: 19372.7583; val_edge_recon_loss: 25654551.1818; val_gene_expr_recon_loss: 990035.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26663959.0000; val_optim_loss: 26663959.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9872; val_auprc_score: 0.9803; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 19924.5691; train_edge_recon_loss: 25481104.0312; train_gene_expr_recon_loss: 994219.2816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26495247.9375; train_optim_loss: 26495247.9375; val_kl_reg_loss: 19395.1329; val_edge_recon_loss: 25692389.6364; val_gene_expr_recon_loss: 994929.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26706714.3636; val_optim_loss: 26706714.3636
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9874; val_auprc_score: 0.9802; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 19926.8050; train_edge_recon_loss: 25474236.4375; train_gene_expr_recon_loss: 994132.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26488296.2083; train_optim_loss: 26488296.2083; val_kl_reg_loss: 19386.2815; val_edge_recon_loss: 25641334.5455; val_gene_expr_recon_loss: 994177.3551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26654898.0000; val_optim_loss: 26654898.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9883; val_auprc_score: 0.9825; val_best_acc_score: 0.9652; val_best_f1_score: 0.9660; train_kl_reg_loss: 19915.5333; train_edge_recon_loss: 25482587.4583; train_gene_expr_recon_loss: 994420.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26496923.8438; train_optim_loss: 26496923.8438; val_kl_reg_loss: 19396.7027; val_edge_recon_loss: 25684543.8182; val_gene_expr_recon_loss: 991257.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26695197.7273; val_optim_loss: 26695197.7273
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9878; val_auprc_score: 0.9820; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 19920.7326; train_edge_recon_loss: 25476526.1667; train_gene_expr_recon_loss: 994122.2581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26490569.1458; train_optim_loss: 26490569.1458; val_kl_reg_loss: 19381.4721; val_edge_recon_loss: 25676269.2727; val_gene_expr_recon_loss: 990989.9148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26686640.5455; val_optim_loss: 26686640.5455

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 18 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9879
Val AUPRC score: 0.9812
Val best accuracy score: 0.9661
Val best F1 score: 0.9666
Val gene expr MSE score: 0.6821

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
