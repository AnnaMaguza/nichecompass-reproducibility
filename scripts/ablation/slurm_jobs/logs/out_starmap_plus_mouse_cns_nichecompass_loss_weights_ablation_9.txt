None
Run timestamp: 02072023_092745_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9601; val_auprc_score: 0.9531; val_best_acc_score: 0.8986; val_best_f1_score: 0.8992; train_kl_reg_loss: 5926.0897; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119683.6916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125609.7808; train_optim_loss: 125609.7808; val_kl_reg_loss: 5455.6577; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 105953.1420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 111408.7997; val_optim_loss: 111408.7997
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9666; val_auprc_score: 0.9614; val_best_acc_score: 0.9094; val_best_f1_score: 0.9113; train_kl_reg_loss: 4939.2330; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103638.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108577.4649; train_optim_loss: 108577.4649; val_kl_reg_loss: 4222.5323; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 101237.7876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105460.3200; val_optim_loss: 105460.3200
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9674; val_auprc_score: 0.9635; val_best_acc_score: 0.9106; val_best_f1_score: 0.9119; train_kl_reg_loss: 4061.5354; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 99860.9730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103922.5085; train_optim_loss: 103922.5085; val_kl_reg_loss: 3671.6269; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 98477.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 102149.1481; val_optim_loss: 102149.1481
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9680; val_auprc_score: 0.9651; val_best_acc_score: 0.9107; val_best_f1_score: 0.9114; train_kl_reg_loss: 3615.2780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 97417.2923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101032.5703; train_optim_loss: 101032.5703; val_kl_reg_loss: 3407.4401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 96018.7074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99426.1481; val_optim_loss: 99426.1481
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9672; val_auprc_score: 0.9635; val_best_acc_score: 0.9117; val_best_f1_score: 0.9112; train_kl_reg_loss: 3364.3322; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 95504.5891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98868.9211; train_optim_loss: 98868.9211; val_kl_reg_loss: 3212.7387; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 94305.6087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97518.3480; val_optim_loss: 97518.3480
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9663; val_auprc_score: 0.9637; val_best_acc_score: 0.9076; val_best_f1_score: 0.9072; train_kl_reg_loss: 3209.7600; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 93904.2795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97114.0392; train_optim_loss: 97114.0392; val_kl_reg_loss: 3048.4374; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 93330.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96378.6293; val_optim_loss: 96378.6293
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9652; val_auprc_score: 0.9636; val_best_acc_score: 0.9048; val_best_f1_score: 0.9050; train_kl_reg_loss: 3106.6311; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 92543.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95650.1418; train_optim_loss: 95650.1418; val_kl_reg_loss: 2957.2392; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 92139.3097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95096.5483; val_optim_loss: 95096.5483
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9640; val_auprc_score: 0.9629; val_best_acc_score: 0.9025; val_best_f1_score: 0.9016; train_kl_reg_loss: 3027.1288; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 91501.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94528.7057; train_optim_loss: 94528.7057; val_kl_reg_loss: 2979.0876; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 91624.5923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94603.6800; val_optim_loss: 94603.6800
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9631; val_auprc_score: 0.9626; val_best_acc_score: 0.9009; val_best_f1_score: 0.9002; train_kl_reg_loss: 2969.2678; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 90550.1917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93519.4595; train_optim_loss: 93519.4595; val_kl_reg_loss: 2891.6926; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90800.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93692.1822; val_optim_loss: 93692.1822
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9617; val_auprc_score: 0.9614; val_best_acc_score: 0.8968; val_best_f1_score: 0.8981; train_kl_reg_loss: 2923.5495; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 89692.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92615.9370; train_optim_loss: 92615.9370; val_kl_reg_loss: 2868.5289; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 90204.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93073.1719; val_optim_loss: 93073.1719
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9612; val_auprc_score: 0.9607; val_best_acc_score: 0.8966; val_best_f1_score: 0.8969; train_kl_reg_loss: 2885.8114; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 89089.3234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91975.1346; train_optim_loss: 91975.1346; val_kl_reg_loss: 2793.2590; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89900.2138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92693.4719; val_optim_loss: 92693.4719
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9595; val_auprc_score: 0.9601; val_best_acc_score: 0.8938; val_best_f1_score: 0.8944; train_kl_reg_loss: 2852.0103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 88482.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91334.2638; train_optim_loss: 91334.2638; val_kl_reg_loss: 2761.4436; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89563.9879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92325.4318; val_optim_loss: 92325.4318
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9594; val_auprc_score: 0.9608; val_best_acc_score: 0.8939; val_best_f1_score: 0.8926; train_kl_reg_loss: 2824.0691; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 88035.2503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90859.3197; train_optim_loss: 90859.3197; val_kl_reg_loss: 2719.8771; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89492.1928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92212.0700; val_optim_loss: 92212.0700
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9568; val_auprc_score: 0.9577; val_best_acc_score: 0.8894; val_best_f1_score: 0.8903; train_kl_reg_loss: 2796.6492; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87510.7766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90307.4257; train_optim_loss: 90307.4257; val_kl_reg_loss: 2708.6500; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 89097.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91805.8267; val_optim_loss: 91805.8267
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9567; val_auprc_score: 0.9588; val_best_acc_score: 0.8888; val_best_f1_score: 0.8884; train_kl_reg_loss: 2774.1943; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 87145.2019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89919.3962; train_optim_loss: 89919.3962; val_kl_reg_loss: 2736.8911; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88702.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91439.2198; val_optim_loss: 91439.2198
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9562; val_auprc_score: 0.9581; val_best_acc_score: 0.8913; val_best_f1_score: 0.8893; train_kl_reg_loss: 2757.3214; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86786.5168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89543.8383; train_optim_loss: 89543.8383; val_kl_reg_loss: 2685.2692; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88496.3846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91181.6538; val_optim_loss: 91181.6538
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9558; val_auprc_score: 0.9576; val_best_acc_score: 0.8897; val_best_f1_score: 0.8881; train_kl_reg_loss: 2738.3172; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86561.8189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89300.1363; train_optim_loss: 89300.1363; val_kl_reg_loss: 2692.4309; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88655.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91347.4585; val_optim_loss: 91347.4585
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9550; val_auprc_score: 0.9575; val_best_acc_score: 0.8887; val_best_f1_score: 0.8883; train_kl_reg_loss: 2720.1508; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 86203.8337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88923.9845; train_optim_loss: 88923.9845; val_kl_reg_loss: 2637.2101; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88293.4471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90930.6573; val_optim_loss: 90930.6573
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9534; val_auprc_score: 0.9563; val_best_acc_score: 0.8866; val_best_f1_score: 0.8855; train_kl_reg_loss: 2705.3052; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85963.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88668.3842; train_optim_loss: 88668.3842; val_kl_reg_loss: 2661.3893; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88161.8874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90823.2773; val_optim_loss: 90823.2773
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9535; val_auprc_score: 0.9562; val_best_acc_score: 0.8879; val_best_f1_score: 0.8860; train_kl_reg_loss: 2692.2476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85731.9255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88424.1734; train_optim_loss: 88424.1734; val_kl_reg_loss: 2618.5092; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88172.3349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90790.8452; val_optim_loss: 90790.8452
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9530; val_auprc_score: 0.9564; val_best_acc_score: 0.8863; val_best_f1_score: 0.8857; train_kl_reg_loss: 2679.5831; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85484.1343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88163.7175; train_optim_loss: 88163.7175; val_kl_reg_loss: 2614.4033; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88073.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90687.5795; val_optim_loss: 90687.5795
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9537; val_auprc_score: 0.9576; val_best_acc_score: 0.8863; val_best_f1_score: 0.8858; train_kl_reg_loss: 2665.0312; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85292.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87957.8644; train_optim_loss: 87957.8644; val_kl_reg_loss: 2594.6275; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88147.7464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90742.3736; val_optim_loss: 90742.3736
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9540; val_auprc_score: 0.9573; val_best_acc_score: 0.8892; val_best_f1_score: 0.8874; train_kl_reg_loss: 2654.6860; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 85170.9568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87825.6427; train_optim_loss: 87825.6427; val_kl_reg_loss: 2597.4639; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88083.8548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90681.3178; val_optim_loss: 90681.3178
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9511; val_auprc_score: 0.9544; val_best_acc_score: 0.8862; val_best_f1_score: 0.8833; train_kl_reg_loss: 2648.8324; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84983.2172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87632.0493; train_optim_loss: 87632.0493; val_kl_reg_loss: 2588.0002; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87971.9119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90559.9119; val_optim_loss: 90559.9119
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9505; val_auprc_score: 0.9544; val_best_acc_score: 0.8831; val_best_f1_score: 0.8825; train_kl_reg_loss: 2638.9130; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84886.0633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87524.9761; train_optim_loss: 87524.9761; val_kl_reg_loss: 2565.8688; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88125.2994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90691.1680; val_optim_loss: 90691.1680
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9497; val_auprc_score: 0.9547; val_best_acc_score: 0.8829; val_best_f1_score: 0.8812; train_kl_reg_loss: 2630.0930; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84738.0249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87368.1176; train_optim_loss: 87368.1176; val_kl_reg_loss: 2598.1949; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88011.9986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90610.1932; val_optim_loss: 90610.1932
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9510; val_auprc_score: 0.9553; val_best_acc_score: 0.8858; val_best_f1_score: 0.8841; train_kl_reg_loss: 2622.8586; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84558.2177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87181.0763; train_optim_loss: 87181.0763; val_kl_reg_loss: 2542.0848; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88171.5707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90713.6559; val_optim_loss: 90713.6559
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9504; val_auprc_score: 0.9554; val_best_acc_score: 0.8827; val_best_f1_score: 0.8809; train_kl_reg_loss: 2615.2705; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 84448.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87063.4344; train_optim_loss: 87063.4344; val_kl_reg_loss: 2582.0630; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87993.9819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90576.0447; val_optim_loss: 90576.0447

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9489; val_auprc_score: 0.9535; val_best_acc_score: 0.8824; val_best_f1_score: 0.8803; train_kl_reg_loss: 2562.6439; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83727.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86290.6309; train_optim_loss: 86290.6309; val_kl_reg_loss: 2502.3639; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87908.8015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90411.1655; val_optim_loss: 90411.1655
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9488; val_auprc_score: 0.9543; val_best_acc_score: 0.8826; val_best_f1_score: 0.8796; train_kl_reg_loss: 2557.9171; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83743.3273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86301.2446; train_optim_loss: 86301.2446; val_kl_reg_loss: 2501.6278; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87710.0636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90211.6903; val_optim_loss: 90211.6903
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9489; val_auprc_score: 0.9533; val_best_acc_score: 0.8832; val_best_f1_score: 0.8805; train_kl_reg_loss: 2556.3518; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83692.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86248.7917; train_optim_loss: 86248.7917; val_kl_reg_loss: 2494.9279; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87673.8285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90168.7564; val_optim_loss: 90168.7564
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9499; val_auprc_score: 0.9546; val_best_acc_score: 0.8830; val_best_f1_score: 0.8817; train_kl_reg_loss: 2554.9937; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83643.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86198.9004; train_optim_loss: 86198.9004; val_kl_reg_loss: 2505.1504; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 88050.8501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90556.0004; val_optim_loss: 90556.0004
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9484; val_auprc_score: 0.9529; val_best_acc_score: 0.8826; val_best_f1_score: 0.8799; train_kl_reg_loss: 2553.8734; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83663.7039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86217.5772; train_optim_loss: 86217.5772; val_kl_reg_loss: 2506.8503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87795.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90302.7798; val_optim_loss: 90302.7798
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9486; val_auprc_score: 0.9537; val_best_acc_score: 0.8835; val_best_f1_score: 0.8804; train_kl_reg_loss: 2554.7078; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83584.0479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86138.7560; train_optim_loss: 86138.7560; val_kl_reg_loss: 2504.1956; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87642.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90146.7301; val_optim_loss: 90146.7301
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9478; val_auprc_score: 0.9528; val_best_acc_score: 0.8804; val_best_f1_score: 0.8797; train_kl_reg_loss: 2550.1809; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83594.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86144.9014; train_optim_loss: 86144.9014; val_kl_reg_loss: 2501.6620; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87980.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90482.6360; val_optim_loss: 90482.6360
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9483; val_auprc_score: 0.9536; val_best_acc_score: 0.8804; val_best_f1_score: 0.8797; train_kl_reg_loss: 2549.3781; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83566.5160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86115.8941; train_optim_loss: 86115.8941; val_kl_reg_loss: 2491.5220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87811.0398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90302.5611; val_optim_loss: 90302.5611
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9487; val_auprc_score: 0.9537; val_best_acc_score: 0.8820; val_best_f1_score: 0.8808; train_kl_reg_loss: 2548.9293; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83643.9373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86192.8664; train_optim_loss: 86192.8664; val_kl_reg_loss: 2506.6769; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87717.8913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90224.5682; val_optim_loss: 90224.5682
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9477; val_auprc_score: 0.9529; val_best_acc_score: 0.8797; val_best_f1_score: 0.8774; train_kl_reg_loss: 2547.3605; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83599.4024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86146.7630; train_optim_loss: 86146.7630; val_kl_reg_loss: 2484.4990; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87813.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90298.2660; val_optim_loss: 90298.2660

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9488; val_auprc_score: 0.9545; val_best_acc_score: 0.8812; val_best_f1_score: 0.8799; train_kl_reg_loss: 2539.7081; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83445.2150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85984.9230; train_optim_loss: 85984.9230; val_kl_reg_loss: 2486.3084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87732.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90219.0103; val_optim_loss: 90219.0103
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9483; val_auprc_score: 0.9535; val_best_acc_score: 0.8821; val_best_f1_score: 0.8806; train_kl_reg_loss: 2538.8760; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83422.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85961.7792; train_optim_loss: 85961.7792; val_kl_reg_loss: 2482.9357; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87887.2791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90370.2145; val_optim_loss: 90370.2145
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9480; val_auprc_score: 0.9526; val_best_acc_score: 0.8813; val_best_f1_score: 0.8800; train_kl_reg_loss: 2538.0701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83396.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85934.6729; train_optim_loss: 85934.6729; val_kl_reg_loss: 2486.2455; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87937.4851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90423.7308; val_optim_loss: 90423.7308
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9491; val_auprc_score: 0.9541; val_best_acc_score: 0.8828; val_best_f1_score: 0.8812; train_kl_reg_loss: 2538.6800; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 83576.0782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86114.7585; train_optim_loss: 86114.7585; val_kl_reg_loss: 2486.7260; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 87673.8235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90160.5497; val_optim_loss: 90160.5497

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 58 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9481
Val AUPRC score: 0.9531
Val best accuracy score: 0.8812
Val best F1 score: 0.8797
Val gene expr MSE score: 0.6928

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
