None
Run timestamp: 29072023_013341_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9949; val_auprc_score: 0.9946; val_best_acc_score: 0.9673; val_best_f1_score: 0.9675; train_kl_reg_loss: 2199.1461; train_edge_recon_loss: 27559.5033; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29758.6494; train_optim_loss: 29758.6494; val_kl_reg_loss: 2148.2635; val_edge_recon_loss: 26035.7444; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28184.0078; val_optim_loss: 28184.0078
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 2278.3033; train_edge_recon_loss: 27197.3992; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29475.7025; train_optim_loss: 29475.7025; val_kl_reg_loss: 2237.2065; val_edge_recon_loss: 25917.9616; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28155.1681; val_optim_loss: 28155.1681
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 2289.8211; train_edge_recon_loss: 27137.3491; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29427.1702; train_optim_loss: 29427.1702; val_kl_reg_loss: 2233.6135; val_edge_recon_loss: 25876.1837; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28109.7973; val_optim_loss: 28109.7973
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 2295.5242; train_edge_recon_loss: 27101.3733; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29396.8975; train_optim_loss: 29396.8975; val_kl_reg_loss: 2278.2309; val_edge_recon_loss: 25854.7826; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28133.0134; val_optim_loss: 28133.0134
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9797; val_best_f1_score: 0.9797; train_kl_reg_loss: 2299.5947; train_edge_recon_loss: 27066.1380; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29365.7327; train_optim_loss: 29365.7327; val_kl_reg_loss: 2338.9497; val_edge_recon_loss: 25818.1222; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28157.0720; val_optim_loss: 28157.0720
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 2301.3213; train_edge_recon_loss: 27045.3032; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29346.6245; train_optim_loss: 29346.6245; val_kl_reg_loss: 2290.8878; val_edge_recon_loss: 25779.8306; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28070.7184; val_optim_loss: 28070.7184
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 2303.2073; train_edge_recon_loss: 27029.4662; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29332.6735; train_optim_loss: 29332.6735; val_kl_reg_loss: 2292.9630; val_edge_recon_loss: 25787.6463; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28080.6093; val_optim_loss: 28080.6093
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9830; val_best_f1_score: 0.9830; train_kl_reg_loss: 2304.4274; train_edge_recon_loss: 27015.3862; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29319.8136; train_optim_loss: 29319.8136; val_kl_reg_loss: 2293.6051; val_edge_recon_loss: 25781.7128; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28075.3179; val_optim_loss: 28075.3179
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 2306.7730; train_edge_recon_loss: 27000.3740; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29307.1470; train_optim_loss: 29307.1470; val_kl_reg_loss: 2368.9432; val_edge_recon_loss: 25755.5056; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28124.4488; val_optim_loss: 28124.4488
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 2307.8892; train_edge_recon_loss: 26990.9796; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29298.8688; train_optim_loss: 29298.8688; val_kl_reg_loss: 2307.1087; val_edge_recon_loss: 25750.3323; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28057.4411; val_optim_loss: 28057.4411
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 2309.7374; train_edge_recon_loss: 26977.2391; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29286.9765; train_optim_loss: 29286.9765; val_kl_reg_loss: 2324.7755; val_edge_recon_loss: 25741.0335; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28065.8090; val_optim_loss: 28065.8090
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 2311.3695; train_edge_recon_loss: 26966.1104; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29277.4799; train_optim_loss: 29277.4799; val_kl_reg_loss: 2299.8933; val_edge_recon_loss: 25714.9617; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28014.8550; val_optim_loss: 28014.8550
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2312.2003; train_edge_recon_loss: 26958.8119; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29271.0122; train_optim_loss: 29271.0122; val_kl_reg_loss: 2301.6946; val_edge_recon_loss: 25713.3417; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28015.0363; val_optim_loss: 28015.0363
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2313.4648; train_edge_recon_loss: 26951.6020; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29265.0669; train_optim_loss: 29265.0669; val_kl_reg_loss: 2324.4905; val_edge_recon_loss: 25709.1373; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28033.6278; val_optim_loss: 28033.6278
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9865; val_best_f1_score: 0.9865; train_kl_reg_loss: 2313.6564; train_edge_recon_loss: 26950.0226; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29263.6789; train_optim_loss: 29263.6789; val_kl_reg_loss: 2312.7903; val_edge_recon_loss: 25703.5487; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28016.3389; val_optim_loss: 28016.3389
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9864; val_best_f1_score: 0.9864; train_kl_reg_loss: 2314.6593; train_edge_recon_loss: 26942.6477; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29257.3070; train_optim_loss: 29257.3070; val_kl_reg_loss: 2319.0115; val_edge_recon_loss: 25698.6276; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28017.6391; val_optim_loss: 28017.6391

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 2310.1800; train_edge_recon_loss: 26906.1401; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29216.3202; train_optim_loss: 29216.3202; val_kl_reg_loss: 2320.1560; val_edge_recon_loss: 25664.3817; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27984.5377; val_optim_loss: 27984.5377
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9988; val_auprc_score: 0.9984; val_best_acc_score: 0.9879; val_best_f1_score: 0.9879; train_kl_reg_loss: 2309.2308; train_edge_recon_loss: 26898.0998; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29207.3306; train_optim_loss: 29207.3306; val_kl_reg_loss: 2310.4723; val_edge_recon_loss: 25652.0073; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27962.4797; val_optim_loss: 27962.4797
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 2307.7115; train_edge_recon_loss: 26900.7258; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29208.4373; train_optim_loss: 29208.4373; val_kl_reg_loss: 2314.6356; val_edge_recon_loss: 25655.1833; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27969.8189; val_optim_loss: 27969.8189
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 2309.5817; train_edge_recon_loss: 26889.9741; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29199.5558; train_optim_loss: 29199.5558; val_kl_reg_loss: 2303.8087; val_edge_recon_loss: 25643.1939; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27947.0026; val_optim_loss: 27947.0026
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 2307.3939; train_edge_recon_loss: 26896.1733; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29203.5673; train_optim_loss: 29203.5673; val_kl_reg_loss: 2299.4598; val_edge_recon_loss: 25641.8063; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27941.2662; val_optim_loss: 27941.2662
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9988; val_auprc_score: 0.9984; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 2308.0370; train_edge_recon_loss: 26892.3225; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29200.3595; train_optim_loss: 29200.3595; val_kl_reg_loss: 2304.8596; val_edge_recon_loss: 25658.6428; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27963.5024; val_optim_loss: 27963.5024
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 2307.4856; train_edge_recon_loss: 26893.1498; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29200.6354; train_optim_loss: 29200.6354; val_kl_reg_loss: 2308.2819; val_edge_recon_loss: 25659.6666; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27967.9485; val_optim_loss: 27967.9485
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2307.4257; train_edge_recon_loss: 26891.9908; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29199.4164; train_optim_loss: 29199.4164; val_kl_reg_loss: 2308.6938; val_edge_recon_loss: 25631.7392; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27940.4330; val_optim_loss: 27940.4330
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2308.0468; train_edge_recon_loss: 26887.5433; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29195.5901; train_optim_loss: 29195.5901; val_kl_reg_loss: 2308.3638; val_edge_recon_loss: 25660.9350; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27969.2988; val_optim_loss: 27969.2988
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 2306.6783; train_edge_recon_loss: 26892.3328; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29199.0111; train_optim_loss: 29199.0111; val_kl_reg_loss: 2307.8371; val_edge_recon_loss: 25644.7341; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27952.5712; val_optim_loss: 27952.5712
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 2306.6949; train_edge_recon_loss: 26890.8492; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29197.5441; train_optim_loss: 29197.5441; val_kl_reg_loss: 2302.0346; val_edge_recon_loss: 25650.5111; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27952.5457; val_optim_loss: 27952.5457
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2307.2096; train_edge_recon_loss: 26887.0937; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29194.3033; train_optim_loss: 29194.3033; val_kl_reg_loss: 2322.0289; val_edge_recon_loss: 25639.9247; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27961.9536; val_optim_loss: 27961.9536

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 2307.8316; train_edge_recon_loss: 26877.9660; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29185.7976; train_optim_loss: 29185.7976; val_kl_reg_loss: 2309.3535; val_edge_recon_loss: 25641.4202; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27950.7737; val_optim_loss: 27950.7737
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2306.4747; train_edge_recon_loss: 26881.4092; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29187.8839; train_optim_loss: 29187.8839; val_kl_reg_loss: 2309.7180; val_edge_recon_loss: 25631.2312; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27940.9491; val_optim_loss: 27940.9491
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 2306.9982; train_edge_recon_loss: 26880.5187; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29187.5169; train_optim_loss: 29187.5169; val_kl_reg_loss: 2312.7229; val_edge_recon_loss: 25650.0249; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27962.7478; val_optim_loss: 27962.7478
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 2307.7159; train_edge_recon_loss: 26876.3589; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29184.0748; train_optim_loss: 29184.0748; val_kl_reg_loss: 2309.0318; val_edge_recon_loss: 25626.4658; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27935.4976; val_optim_loss: 27935.4976
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 2307.2657; train_edge_recon_loss: 26879.6028; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29186.8685; train_optim_loss: 29186.8685; val_kl_reg_loss: 2307.7930; val_edge_recon_loss: 25636.1538; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27943.9469; val_optim_loss: 27943.9469
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 2306.1391; train_edge_recon_loss: 26882.7383; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29188.8774; train_optim_loss: 29188.8774; val_kl_reg_loss: 2306.2773; val_edge_recon_loss: 25621.2698; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27927.5470; val_optim_loss: 27927.5470
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2306.9981; train_edge_recon_loss: 26878.1430; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29185.1411; train_optim_loss: 29185.1411; val_kl_reg_loss: 2305.4582; val_edge_recon_loss: 25632.9828; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27938.4410; val_optim_loss: 27938.4410
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2305.1844; train_edge_recon_loss: 26885.6292; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29190.8137; train_optim_loss: 29190.8137; val_kl_reg_loss: 2310.5804; val_edge_recon_loss: 25639.2965; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27949.8769; val_optim_loss: 27949.8769
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 2307.1487; train_edge_recon_loss: 26877.6914; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29184.8401; train_optim_loss: 29184.8401; val_kl_reg_loss: 2309.1439; val_edge_recon_loss: 25639.2913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27948.4353; val_optim_loss: 27948.4353
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2306.4212; train_edge_recon_loss: 26879.7498; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29186.1710; train_optim_loss: 29186.1710; val_kl_reg_loss: 2308.9947; val_edge_recon_loss: 25659.5518; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27968.5465; val_optim_loss: 27968.5465

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2305.9470; train_edge_recon_loss: 26881.5917; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29187.5387; train_optim_loss: 29187.5387; val_kl_reg_loss: 2308.6738; val_edge_recon_loss: 25647.8317; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27956.5055; val_optim_loss: 27956.5055
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 2307.1869; train_edge_recon_loss: 26876.7239; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29183.9108; train_optim_loss: 29183.9108; val_kl_reg_loss: 2308.6669; val_edge_recon_loss: 25643.5909; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27952.2578; val_optim_loss: 27952.2578
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 2306.3979; train_edge_recon_loss: 26885.3264; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29191.7243; train_optim_loss: 29191.7243; val_kl_reg_loss: 2307.8252; val_edge_recon_loss: 25641.3296; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27949.1548; val_optim_loss: 27949.1548
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9988; val_auprc_score: 0.9985; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2306.0739; train_edge_recon_loss: 26881.2784; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29187.3523; train_optim_loss: 29187.3523; val_kl_reg_loss: 2308.4224; val_edge_recon_loss: 25636.3030; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27944.7254; val_optim_loss: 27944.7254

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1171 min 54 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9989
val AUPRC score: 0.9986
val best accuracy score: 0.9886
val best F1 score: 0.9886
val target rna MSE score: 13.3579
val source rna MSE score: 6.5778

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
