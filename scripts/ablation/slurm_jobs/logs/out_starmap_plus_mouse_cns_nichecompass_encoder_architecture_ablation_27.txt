None
Run timestamp: 15082023_010615_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9886; val_auprc_score: 0.9846; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 7627.2922; train_edge_recon_loss: 264108.0175; train_gene_expr_recon_loss: 201786.1472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3554.3971; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 477075.8540; train_optim_loss: 477075.8540; val_kl_reg_loss: 7383.9243; val_edge_recon_loss: 259827.9380; val_gene_expr_recon_loss: 186451.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4126.3809; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 457789.8822; val_optim_loss: 457789.8822
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9908; val_auprc_score: 0.9878; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 7202.1807; train_edge_recon_loss: 259756.1015; train_gene_expr_recon_loss: 183222.2530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4261.8565; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 454442.3915; train_optim_loss: 454442.3915; val_kl_reg_loss: 7156.7143; val_edge_recon_loss: 258999.4365; val_gene_expr_recon_loss: 180091.6780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4314.2012; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450562.0165; val_optim_loss: 450562.0165
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 6973.0929; train_edge_recon_loss: 259016.9487; train_gene_expr_recon_loss: 179582.9270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4283.4651; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449856.4337; train_optim_loss: 449856.4337; val_kl_reg_loss: 6751.8194; val_edge_recon_loss: 258284.0282; val_gene_expr_recon_loss: 178489.3873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4206.8926; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447732.1413; val_optim_loss: 447732.1413
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 6855.7878; train_edge_recon_loss: 258469.9058; train_gene_expr_recon_loss: 178406.9763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4148.9838; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447881.6540; train_optim_loss: 447881.6540; val_kl_reg_loss: 6694.3829; val_edge_recon_loss: 257847.7900; val_gene_expr_recon_loss: 178027.7497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4105.8574; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446675.7672; val_optim_loss: 446675.7672
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9758; val_best_f1_score: 0.9762; train_kl_reg_loss: 6782.1808; train_edge_recon_loss: 258245.1743; train_gene_expr_recon_loss: 177940.4819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4073.1564; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447040.9935; train_optim_loss: 447040.9935; val_kl_reg_loss: 6704.4770; val_edge_recon_loss: 257543.8148; val_gene_expr_recon_loss: 177504.5096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4038.0884; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445790.8940; val_optim_loss: 445790.8940
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 6738.6792; train_edge_recon_loss: 257986.3943; train_gene_expr_recon_loss: 177737.9518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4012.1121; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446475.1375; train_optim_loss: 446475.1375; val_kl_reg_loss: 6626.9322; val_edge_recon_loss: 257358.1681; val_gene_expr_recon_loss: 176882.9751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3990.6348; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444858.6998; val_optim_loss: 444858.6998
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 6711.4614; train_edge_recon_loss: 257818.3976; train_gene_expr_recon_loss: 177645.5388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3993.5034; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446168.9012; train_optim_loss: 446168.9012; val_kl_reg_loss: 6623.2546; val_edge_recon_loss: 257132.8501; val_gene_expr_recon_loss: 177195.1785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3986.8447; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444938.1269; val_optim_loss: 444938.1269
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6690.6723; train_edge_recon_loss: 257721.2379; train_gene_expr_recon_loss: 177346.8600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4006.3104; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445765.0808; train_optim_loss: 445765.0808; val_kl_reg_loss: 6649.3335; val_edge_recon_loss: 256803.2738; val_gene_expr_recon_loss: 177010.2651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4005.4612; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444468.3409; val_optim_loss: 444468.3409
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6680.0462; train_edge_recon_loss: 257577.1778; train_gene_expr_recon_loss: 177416.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4015.3840; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445689.3956; train_optim_loss: 445689.3956; val_kl_reg_loss: 6568.2689; val_edge_recon_loss: 256751.5091; val_gene_expr_recon_loss: 177147.9387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4022.0488; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444489.7801; val_optim_loss: 444489.7801
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6678.0673; train_edge_recon_loss: 257435.9737; train_gene_expr_recon_loss: 177234.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4030.7711; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445379.6771; train_optim_loss: 445379.6771; val_kl_reg_loss: 6633.1555; val_edge_recon_loss: 257156.1703; val_gene_expr_recon_loss: 176849.1565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4021.2812; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444659.7630; val_optim_loss: 444659.7630
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 6662.3436; train_edge_recon_loss: 257382.5947; train_gene_expr_recon_loss: 177237.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4043.9673; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445326.2148; train_optim_loss: 445326.2148; val_kl_reg_loss: 6581.3659; val_edge_recon_loss: 256724.5889; val_gene_expr_recon_loss: 176818.4933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4058.3582; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444182.7917; val_optim_loss: 444182.7917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 6662.5922; train_edge_recon_loss: 257386.4726; train_gene_expr_recon_loss: 177186.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4056.2142; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445291.7791; train_optim_loss: 445291.7791; val_kl_reg_loss: 6647.6667; val_edge_recon_loss: 256828.0048; val_gene_expr_recon_loss: 176770.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4065.9917; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444312.3932; val_optim_loss: 444312.3932
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 6659.3266; train_edge_recon_loss: 257286.3310; train_gene_expr_recon_loss: 177068.5907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4064.2117; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445078.4595; train_optim_loss: 445078.4595; val_kl_reg_loss: 6641.8636; val_edge_recon_loss: 256780.0078; val_gene_expr_recon_loss: 177155.2914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4057.2351; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444634.4128; val_optim_loss: 444634.4128
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 6657.1923; train_edge_recon_loss: 257242.9933; train_gene_expr_recon_loss: 177043.6735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4068.7160; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445012.5749; train_optim_loss: 445012.5749; val_kl_reg_loss: 6660.2641; val_edge_recon_loss: 256667.8786; val_gene_expr_recon_loss: 176723.0801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4053.0610; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444104.2843; val_optim_loss: 444104.2843
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 6656.2118; train_edge_recon_loss: 257159.4005; train_gene_expr_recon_loss: 177003.0858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4077.6549; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444896.3526; train_optim_loss: 444896.3526; val_kl_reg_loss: 6628.6032; val_edge_recon_loss: 256530.0139; val_gene_expr_recon_loss: 176984.2446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4074.6968; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444217.5496; val_optim_loss: 444217.5496
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 6654.9633; train_edge_recon_loss: 257148.2468; train_gene_expr_recon_loss: 176923.9892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4080.6746; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444807.8741; train_optim_loss: 444807.8741; val_kl_reg_loss: 6609.9128; val_edge_recon_loss: 256413.7360; val_gene_expr_recon_loss: 177046.7508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4071.8853; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444142.2753; val_optim_loss: 444142.2753
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 6658.3169; train_edge_recon_loss: 257099.1903; train_gene_expr_recon_loss: 176884.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4083.2809; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444724.8792; train_optim_loss: 444724.8792; val_kl_reg_loss: 6594.4279; val_edge_recon_loss: 256519.1178; val_gene_expr_recon_loss: 176707.2304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4063.6699; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443884.4303; val_optim_loss: 443884.4303
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 6657.2098; train_edge_recon_loss: 257009.3869; train_gene_expr_recon_loss: 177087.8117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4083.7249; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444838.1335; train_optim_loss: 444838.1335; val_kl_reg_loss: 6559.0015; val_edge_recon_loss: 256449.0044; val_gene_expr_recon_loss: 176848.1554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4095.4829; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443951.6300; val_optim_loss: 443951.6300
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6656.0431; train_edge_recon_loss: 257026.2298; train_gene_expr_recon_loss: 177026.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4089.9922; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444799.2544; train_optim_loss: 444799.2544; val_kl_reg_loss: 6558.6293; val_edge_recon_loss: 256547.1549; val_gene_expr_recon_loss: 177073.1693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4090.4202; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444269.3603; val_optim_loss: 444269.3603
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6654.4231; train_edge_recon_loss: 256984.9979; train_gene_expr_recon_loss: 176980.1924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4091.8374; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444711.4506; train_optim_loss: 444711.4506; val_kl_reg_loss: 6578.0863; val_edge_recon_loss: 256233.6353; val_gene_expr_recon_loss: 177084.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4103.3179; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443999.7561; val_optim_loss: 443999.7561
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 6651.3389; train_edge_recon_loss: 256904.7951; train_gene_expr_recon_loss: 176869.4708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4092.4563; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444518.0611; train_optim_loss: 444518.0611; val_kl_reg_loss: 6646.0893; val_edge_recon_loss: 256114.3863; val_gene_expr_recon_loss: 177278.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4085.0933; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444124.2710; val_optim_loss: 444124.2710

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6626.4567; train_edge_recon_loss: 256876.5736; train_gene_expr_recon_loss: 176429.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3945.1332; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443877.6029; train_optim_loss: 443877.6029; val_kl_reg_loss: 6620.9342; val_edge_recon_loss: 256115.5088; val_gene_expr_recon_loss: 176332.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3940.8013; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443010.0360; val_optim_loss: 443010.0360
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6623.9718; train_edge_recon_loss: 256721.4968; train_gene_expr_recon_loss: 176484.2017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3941.9888; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443771.6586; train_optim_loss: 443771.6586; val_kl_reg_loss: 6595.3218; val_edge_recon_loss: 255823.0878; val_gene_expr_recon_loss: 176478.8399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3942.3948; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442839.6555; val_optim_loss: 442839.6555
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6620.9621; train_edge_recon_loss: 256741.8568; train_gene_expr_recon_loss: 176408.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3943.6109; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443715.1344; train_optim_loss: 443715.1344; val_kl_reg_loss: 6597.0316; val_edge_recon_loss: 256169.1214; val_gene_expr_recon_loss: 176276.1663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3944.4421; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442986.7568; val_optim_loss: 442986.7568
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6616.2634; train_edge_recon_loss: 256747.9805; train_gene_expr_recon_loss: 176389.8165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3947.7418; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443701.8026; train_optim_loss: 443701.8026; val_kl_reg_loss: 6594.5087; val_edge_recon_loss: 255982.0156; val_gene_expr_recon_loss: 176627.0824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3950.5750; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443154.1676; val_optim_loss: 443154.1676
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 3743.2257; train_edge_recon_loss: 259707.1382; train_gene_expr_recon_loss: 135814.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3578.9266; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 402843.7183; train_optim_loss: 402843.7183; val_kl_reg_loss: 1054.6041; val_edge_recon_loss: 259962.2303; val_gene_expr_recon_loss: 133725.6647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3172.5776; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 397915.0595; val_optim_loss: 397915.0595
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 2338.1069; train_edge_recon_loss: 258534.1334; train_gene_expr_recon_loss: 133015.4711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2887.3713; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 396775.0824; train_optim_loss: 396775.0824; val_kl_reg_loss: 1219.2726; val_edge_recon_loss: 259008.4858; val_gene_expr_recon_loss: 132490.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2674.8501; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 395393.3728; val_optim_loss: 395393.3728
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9934; val_auprc_score: 0.9921; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 1882.1372; train_edge_recon_loss: 257676.6657; train_gene_expr_recon_loss: 132491.9519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2556.8908; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 394607.6449; train_optim_loss: 394607.6449; val_kl_reg_loss: 1384.2628; val_edge_recon_loss: 258049.4078; val_gene_expr_recon_loss: 132211.7976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2469.2664; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 394114.7504; val_optim_loss: 394114.7504
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9940; val_auprc_score: 0.9927; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 1743.3822; train_edge_recon_loss: 257300.1276; train_gene_expr_recon_loss: 132156.8852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2417.1297; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 393617.5252; train_optim_loss: 393617.5252; val_kl_reg_loss: 1493.4836; val_edge_recon_loss: 257729.1079; val_gene_expr_recon_loss: 131906.9283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2371.7383; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393501.2698; val_optim_loss: 393501.2698
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 1683.1611; train_edge_recon_loss: 256959.0081; train_gene_expr_recon_loss: 131954.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2340.2250; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392936.9057; train_optim_loss: 392936.9057; val_kl_reg_loss: 1548.8801; val_edge_recon_loss: 257734.8804; val_gene_expr_recon_loss: 132078.0558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2316.6704; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393678.4708; val_optim_loss: 393678.4708
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9746; val_best_f1_score: 0.9748; train_kl_reg_loss: 1653.6168; train_edge_recon_loss: 256819.0072; train_gene_expr_recon_loss: 131771.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2298.0479; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392542.6019; train_optim_loss: 392542.6019; val_kl_reg_loss: 1567.7002; val_edge_recon_loss: 257404.4622; val_gene_expr_recon_loss: 131681.7985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2283.4197; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392937.3666; val_optim_loss: 392937.3666
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 1637.0564; train_edge_recon_loss: 256585.6634; train_gene_expr_recon_loss: 131670.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2276.3490; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392169.3801; train_optim_loss: 392169.3801; val_kl_reg_loss: 1525.1861; val_edge_recon_loss: 257499.9711; val_gene_expr_recon_loss: 131005.8239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2271.6296; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392302.6064; val_optim_loss: 392302.6064
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 1639.4418; train_edge_recon_loss: 256709.1728; train_gene_expr_recon_loss: 131012.1114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2268.8118; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391629.5377; train_optim_loss: 391629.5377; val_kl_reg_loss: 1539.0488; val_edge_recon_loss: 256882.7729; val_gene_expr_recon_loss: 131168.8053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2267.1958; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 391857.8150; val_optim_loss: 391857.8150
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 1617.0320; train_edge_recon_loss: 256461.1164; train_gene_expr_recon_loss: 130961.9438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2267.2569; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391307.3490; train_optim_loss: 391307.3490; val_kl_reg_loss: 1540.5765; val_edge_recon_loss: 257107.8347; val_gene_expr_recon_loss: 130990.8450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2267.5903; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 391906.8499; val_optim_loss: 391906.8499
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 1599.7074; train_edge_recon_loss: 256320.4687; train_gene_expr_recon_loss: 130918.3246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2269.1064; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391107.6072; train_optim_loss: 391107.6072; val_kl_reg_loss: 1546.8514; val_edge_recon_loss: 256868.3164; val_gene_expr_recon_loss: 130938.8446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2271.9541; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 391625.9801; val_optim_loss: 391625.9801
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 1585.3058; train_edge_recon_loss: 256270.7990; train_gene_expr_recon_loss: 130779.0454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2274.3613; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390909.5118; train_optim_loss: 390909.5118; val_kl_reg_loss: 1513.2042; val_edge_recon_loss: 256751.2501; val_gene_expr_recon_loss: 129426.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2276.6580; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389967.9720; val_optim_loss: 389967.9720
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 1588.1252; train_edge_recon_loss: 256242.2188; train_gene_expr_recon_loss: 129548.6857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2277.7867; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389656.8161; train_optim_loss: 389656.8161; val_kl_reg_loss: 1529.0525; val_edge_recon_loss: 256719.1852; val_gene_expr_recon_loss: 129382.5474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2277.1560; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389907.9416; val_optim_loss: 389907.9416
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 1578.6921; train_edge_recon_loss: 256223.8942; train_gene_expr_recon_loss: 129425.4448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2276.6914; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389504.7223; train_optim_loss: 389504.7223; val_kl_reg_loss: 1529.6754; val_edge_recon_loss: 256568.2388; val_gene_expr_recon_loss: 129044.5170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2278.2695; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389420.7127; val_optim_loss: 389420.7127
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 1566.4823; train_edge_recon_loss: 256218.6236; train_gene_expr_recon_loss: 129396.2225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2280.9745; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389462.3031; train_optim_loss: 389462.3031; val_kl_reg_loss: 1537.8680; val_edge_recon_loss: 256583.9306; val_gene_expr_recon_loss: 129304.3534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2284.6438; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389710.8076; val_optim_loss: 389710.8076
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 1569.3745; train_edge_recon_loss: 256107.8258; train_gene_expr_recon_loss: 129382.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2287.6147; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389347.6903; train_optim_loss: 389347.6903; val_kl_reg_loss: 1552.9028; val_edge_recon_loss: 256608.2289; val_gene_expr_recon_loss: 129364.9787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2290.8306; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389816.9542; val_optim_loss: 389816.9542
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 1563.8986; train_edge_recon_loss: 256075.6343; train_gene_expr_recon_loss: 129344.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2295.0976; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389279.4938; train_optim_loss: 389279.4938; val_kl_reg_loss: 1545.0967; val_edge_recon_loss: 256598.1816; val_gene_expr_recon_loss: 129393.0598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2299.5601; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389835.9001; val_optim_loss: 389835.9001
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 1559.1569; train_edge_recon_loss: 256037.9222; train_gene_expr_recon_loss: 129355.2068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2303.7172; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389256.0033; train_optim_loss: 389256.0033; val_kl_reg_loss: 1540.5342; val_edge_recon_loss: 256473.7052; val_gene_expr_recon_loss: 129294.2700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2307.7124; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389616.2284; val_optim_loss: 389616.2284

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 1556.8962; train_edge_recon_loss: 255989.8679; train_gene_expr_recon_loss: 129232.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2306.4167; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389085.6695; train_optim_loss: 389085.6695; val_kl_reg_loss: 1541.2977; val_edge_recon_loss: 256377.4935; val_gene_expr_recon_loss: 129271.1398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2306.9587; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389496.8989; val_optim_loss: 389496.8989
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 1559.8811; train_edge_recon_loss: 256014.8729; train_gene_expr_recon_loss: 129232.4460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2307.4524; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389114.6519; train_optim_loss: 389114.6519; val_kl_reg_loss: 1541.0415; val_edge_recon_loss: 256581.4877; val_gene_expr_recon_loss: 129277.8654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2307.8611; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389708.2701; val_optim_loss: 389708.2701
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 1559.6187; train_edge_recon_loss: 255991.8187; train_gene_expr_recon_loss: 129259.6831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2308.2936; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 389119.4140; train_optim_loss: 389119.4140; val_kl_reg_loss: 1536.9952; val_edge_recon_loss: 256370.3890; val_gene_expr_recon_loss: 129247.6698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2308.7439; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389463.8033; val_optim_loss: 389463.8033
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 1560.2875; train_edge_recon_loss: 255909.5405; train_gene_expr_recon_loss: 129219.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2309.2195; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 388998.4878; train_optim_loss: 388998.4878; val_kl_reg_loss: 1542.1122; val_edge_recon_loss: 256624.3943; val_gene_expr_recon_loss: 129041.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2309.5745; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389517.7384; val_optim_loss: 389517.7384

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 295 min 49 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9959
val AUPRC score: 0.9949
val best accuracy score: 0.9786
val best F1 score: 0.9788
val target rna MSE score: 1.0875
val source rna MSE score: 0.0611

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
