None
Run timestamp: 29062023_213538_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9706; val_auprc_score: 0.9560; val_best_acc_score: 0.9282; val_best_f1_score: 0.9304; train_kl_reg_loss: 6990.3554; train_edge_recon_loss: 278072.0744; train_gene_expr_recon_loss: 211285.7684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496348.1981; train_optim_loss: 496348.1981; val_kl_reg_loss: 7273.5853; val_edge_recon_loss: 263986.1293; val_gene_expr_recon_loss: 201038.5170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472298.2301; val_optim_loss: 472298.2301
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9758; val_auprc_score: 0.9642; val_best_acc_score: 0.9393; val_best_f1_score: 0.9410; train_kl_reg_loss: 7484.9631; train_edge_recon_loss: 262058.3972; train_gene_expr_recon_loss: 199082.8237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468626.1854; train_optim_loss: 468626.1854; val_kl_reg_loss: 7046.1444; val_edge_recon_loss: 262743.6143; val_gene_expr_recon_loss: 196582.8146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466372.5767; val_optim_loss: 466372.5767
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9788; val_auprc_score: 0.9678; val_best_acc_score: 0.9471; val_best_f1_score: 0.9485; train_kl_reg_loss: 7515.2351; train_edge_recon_loss: 260767.2121; train_gene_expr_recon_loss: 194969.1248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463251.5728; train_optim_loss: 463251.5728; val_kl_reg_loss: 7278.8828; val_edge_recon_loss: 261811.4723; val_gene_expr_recon_loss: 193230.0973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462320.4531; val_optim_loss: 462320.4531
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9799; val_auprc_score: 0.9700; val_best_acc_score: 0.9497; val_best_f1_score: 0.9510; train_kl_reg_loss: 7571.7415; train_edge_recon_loss: 260059.3105; train_gene_expr_recon_loss: 191403.8311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459034.8830; train_optim_loss: 459034.8830; val_kl_reg_loss: 7289.2834; val_edge_recon_loss: 261657.4964; val_gene_expr_recon_loss: 190017.5170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458964.3026; val_optim_loss: 458964.3026
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9812; val_auprc_score: 0.9726; val_best_acc_score: 0.9526; val_best_f1_score: 0.9537; train_kl_reg_loss: 7641.9125; train_edge_recon_loss: 259839.4095; train_gene_expr_recon_loss: 188311.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455792.3527; train_optim_loss: 455792.3527; val_kl_reg_loss: 7451.8334; val_edge_recon_loss: 261359.0724; val_gene_expr_recon_loss: 185509.9311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454320.8324; val_optim_loss: 454320.8324
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9820; val_auprc_score: 0.9728; val_best_acc_score: 0.9539; val_best_f1_score: 0.9550; train_kl_reg_loss: 7715.6768; train_edge_recon_loss: 259665.8848; train_gene_expr_recon_loss: 185611.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452992.8268; train_optim_loss: 452992.8268; val_kl_reg_loss: 7610.5093; val_edge_recon_loss: 261449.1399; val_gene_expr_recon_loss: 183106.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452165.7969; val_optim_loss: 452165.7969
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9830; val_auprc_score: 0.9755; val_best_acc_score: 0.9546; val_best_f1_score: 0.9558; train_kl_reg_loss: 7827.3040; train_edge_recon_loss: 259413.0811; train_gene_expr_recon_loss: 183080.4894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450320.8770; train_optim_loss: 450320.8770; val_kl_reg_loss: 7619.9843; val_edge_recon_loss: 261417.1484; val_gene_expr_recon_loss: 181550.9595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450588.0923; val_optim_loss: 450588.0923
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9812; val_auprc_score: 0.9712; val_best_acc_score: 0.9555; val_best_f1_score: 0.9565; train_kl_reg_loss: 7876.5946; train_edge_recon_loss: 259154.7719; train_gene_expr_recon_loss: 179966.8498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446998.2161; train_optim_loss: 446998.2161; val_kl_reg_loss: 7723.0094; val_edge_recon_loss: 261840.1626; val_gene_expr_recon_loss: 178536.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448099.5014; val_optim_loss: 448099.5014
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9829; val_auprc_score: 0.9753; val_best_acc_score: 0.9550; val_best_f1_score: 0.9562; train_kl_reg_loss: 7956.2625; train_edge_recon_loss: 259134.6063; train_gene_expr_recon_loss: 177534.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444625.4705; train_optim_loss: 444625.4705; val_kl_reg_loss: 7708.5471; val_edge_recon_loss: 261255.5952; val_gene_expr_recon_loss: 178123.4972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447087.6378; val_optim_loss: 447087.6378
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9823; val_auprc_score: 0.9737; val_best_acc_score: 0.9560; val_best_f1_score: 0.9569; train_kl_reg_loss: 8043.5917; train_edge_recon_loss: 259101.2700; train_gene_expr_recon_loss: 175391.2507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442536.1131; train_optim_loss: 442536.1131; val_kl_reg_loss: 7908.1239; val_edge_recon_loss: 261663.3182; val_gene_expr_recon_loss: 174849.7713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444421.2145; val_optim_loss: 444421.2145
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9815; val_auprc_score: 0.9731; val_best_acc_score: 0.9545; val_best_f1_score: 0.9557; train_kl_reg_loss: 8105.5194; train_edge_recon_loss: 258875.3290; train_gene_expr_recon_loss: 173368.1770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440349.0259; train_optim_loss: 440349.0259; val_kl_reg_loss: 8200.2135; val_edge_recon_loss: 262466.3203; val_gene_expr_recon_loss: 174510.0803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445176.6136; val_optim_loss: 445176.6136
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9825; val_auprc_score: 0.9735; val_best_acc_score: 0.9555; val_best_f1_score: 0.9566; train_kl_reg_loss: 8188.0307; train_edge_recon_loss: 258942.5831; train_gene_expr_recon_loss: 171664.3175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438794.9321; train_optim_loss: 438794.9321; val_kl_reg_loss: 8055.9260; val_edge_recon_loss: 262035.1328; val_gene_expr_recon_loss: 171483.4986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441574.5511; val_optim_loss: 441574.5511
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9822; val_auprc_score: 0.9741; val_best_acc_score: 0.9548; val_best_f1_score: 0.9559; train_kl_reg_loss: 8246.6300; train_edge_recon_loss: 258779.0151; train_gene_expr_recon_loss: 170178.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437203.7611; train_optim_loss: 437203.7611; val_kl_reg_loss: 8082.1762; val_edge_recon_loss: 261974.2521; val_gene_expr_recon_loss: 170711.8494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440768.2784; val_optim_loss: 440768.2784
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9824; val_auprc_score: 0.9738; val_best_acc_score: 0.9548; val_best_f1_score: 0.9560; train_kl_reg_loss: 8304.4857; train_edge_recon_loss: 258814.3978; train_gene_expr_recon_loss: 168838.6246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435957.5080; train_optim_loss: 435957.5080; val_kl_reg_loss: 8179.4503; val_edge_recon_loss: 262298.4134; val_gene_expr_recon_loss: 169664.2294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440142.0909; val_optim_loss: 440142.0909
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9833; val_auprc_score: 0.9757; val_best_acc_score: 0.9564; val_best_f1_score: 0.9576; train_kl_reg_loss: 8363.5444; train_edge_recon_loss: 258609.6029; train_gene_expr_recon_loss: 167966.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434939.8195; train_optim_loss: 434939.8195; val_kl_reg_loss: 8271.9252; val_edge_recon_loss: 261915.1129; val_gene_expr_recon_loss: 169116.1236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439303.1619; val_optim_loss: 439303.1619
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9826; val_auprc_score: 0.9752; val_best_acc_score: 0.9572; val_best_f1_score: 0.9583; train_kl_reg_loss: 8405.0409; train_edge_recon_loss: 258620.3056; train_gene_expr_recon_loss: 166818.6315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433843.9771; train_optim_loss: 433843.9771; val_kl_reg_loss: 8196.3232; val_edge_recon_loss: 261243.2741; val_gene_expr_recon_loss: 169059.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438499.5554; val_optim_loss: 438499.5554
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9815; val_auprc_score: 0.9726; val_best_acc_score: 0.9558; val_best_f1_score: 0.9569; train_kl_reg_loss: 8452.8026; train_edge_recon_loss: 258539.2467; train_gene_expr_recon_loss: 165762.8946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432754.9416; train_optim_loss: 432754.9416; val_kl_reg_loss: 8390.5841; val_edge_recon_loss: 262058.8899; val_gene_expr_recon_loss: 167955.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438404.5440; val_optim_loss: 438404.5440
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9830; val_auprc_score: 0.9755; val_best_acc_score: 0.9568; val_best_f1_score: 0.9580; train_kl_reg_loss: 8487.1359; train_edge_recon_loss: 258646.3783; train_gene_expr_recon_loss: 165208.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432342.2186; train_optim_loss: 432342.2186; val_kl_reg_loss: 8321.3284; val_edge_recon_loss: 261893.0064; val_gene_expr_recon_loss: 167145.6811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437360.0241; val_optim_loss: 437360.0241
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9821; val_auprc_score: 0.9742; val_best_acc_score: 0.9557; val_best_f1_score: 0.9568; train_kl_reg_loss: 8525.9742; train_edge_recon_loss: 258447.9361; train_gene_expr_recon_loss: 164456.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431430.8823; train_optim_loss: 431430.8823; val_kl_reg_loss: 8499.7390; val_edge_recon_loss: 262056.4474; val_gene_expr_recon_loss: 166854.2365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437410.4219; val_optim_loss: 437410.4219
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9827; val_auprc_score: 0.9745; val_best_acc_score: 0.9560; val_best_f1_score: 0.9573; train_kl_reg_loss: 8560.9276; train_edge_recon_loss: 258379.3976; train_gene_expr_recon_loss: 163891.7412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430832.0672; train_optim_loss: 430832.0672; val_kl_reg_loss: 8473.3057; val_edge_recon_loss: 261848.7912; val_gene_expr_recon_loss: 166706.4929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437028.5824; val_optim_loss: 437028.5824
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9829; val_auprc_score: 0.9762; val_best_acc_score: 0.9563; val_best_f1_score: 0.9574; train_kl_reg_loss: 8590.5881; train_edge_recon_loss: 258338.9073; train_gene_expr_recon_loss: 163417.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430346.5711; train_optim_loss: 430346.5711; val_kl_reg_loss: 8432.5382; val_edge_recon_loss: 261809.2131; val_gene_expr_recon_loss: 165615.0760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435856.8239; val_optim_loss: 435856.8239
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9835; val_auprc_score: 0.9764; val_best_acc_score: 0.9583; val_best_f1_score: 0.9595; train_kl_reg_loss: 8617.4473; train_edge_recon_loss: 258329.6120; train_gene_expr_recon_loss: 162950.0166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429897.0754; train_optim_loss: 429897.0754; val_kl_reg_loss: 8477.4433; val_edge_recon_loss: 261461.3516; val_gene_expr_recon_loss: 165503.0142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435441.8082; val_optim_loss: 435441.8082
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9844; val_auprc_score: 0.9780; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 8648.3056; train_edge_recon_loss: 258185.5336; train_gene_expr_recon_loss: 162627.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429461.4642; train_optim_loss: 429461.4642; val_kl_reg_loss: 8436.7411; val_edge_recon_loss: 261305.3295; val_gene_expr_recon_loss: 166400.9517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436143.0256; val_optim_loss: 436143.0256
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9832; val_auprc_score: 0.9750; val_best_acc_score: 0.9584; val_best_f1_score: 0.9593; train_kl_reg_loss: 8669.1308; train_edge_recon_loss: 258213.8848; train_gene_expr_recon_loss: 162203.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429086.9730; train_optim_loss: 429086.9730; val_kl_reg_loss: 8504.1985; val_edge_recon_loss: 261574.3984; val_gene_expr_recon_loss: 165594.9503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435673.5455; val_optim_loss: 435673.5455
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9835; val_auprc_score: 0.9760; val_best_acc_score: 0.9579; val_best_f1_score: 0.9588; train_kl_reg_loss: 8689.4959; train_edge_recon_loss: 258301.9313; train_gene_expr_recon_loss: 161696.9928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428688.4219; train_optim_loss: 428688.4219; val_kl_reg_loss: 8425.8438; val_edge_recon_loss: 261802.9680; val_gene_expr_recon_loss: 164949.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435178.6932; val_optim_loss: 435178.6932
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9837; val_auprc_score: 0.9765; val_best_acc_score: 0.9576; val_best_f1_score: 0.9587; train_kl_reg_loss: 8707.3693; train_edge_recon_loss: 258263.1257; train_gene_expr_recon_loss: 161464.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428435.0811; train_optim_loss: 428435.0811; val_kl_reg_loss: 8628.6792; val_edge_recon_loss: 261727.5575; val_gene_expr_recon_loss: 164562.5199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434918.7557; val_optim_loss: 434918.7557
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9839; val_auprc_score: 0.9766; val_best_acc_score: 0.9594; val_best_f1_score: 0.9606; train_kl_reg_loss: 8725.9901; train_edge_recon_loss: 258304.5334; train_gene_expr_recon_loss: 161204.5640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428235.0879; train_optim_loss: 428235.0879; val_kl_reg_loss: 8558.9724; val_edge_recon_loss: 261050.0447; val_gene_expr_recon_loss: 164734.8089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434343.8281; val_optim_loss: 434343.8281
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9832; val_auprc_score: 0.9752; val_best_acc_score: 0.9580; val_best_f1_score: 0.9592; train_kl_reg_loss: 8751.5666; train_edge_recon_loss: 258071.2759; train_gene_expr_recon_loss: 160876.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427699.6847; train_optim_loss: 427699.6847; val_kl_reg_loss: 8577.5869; val_edge_recon_loss: 261267.6697; val_gene_expr_recon_loss: 165119.5732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434964.8295; val_optim_loss: 434964.8295
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9843; val_auprc_score: 0.9780; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 8761.3678; train_edge_recon_loss: 258192.2847; train_gene_expr_recon_loss: 160589.7280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427543.3791; train_optim_loss: 427543.3791; val_kl_reg_loss: 8486.2208; val_edge_recon_loss: 261290.8629; val_gene_expr_recon_loss: 165620.4837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435397.5625; val_optim_loss: 435397.5625
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9842; val_auprc_score: 0.9772; val_best_acc_score: 0.9582; val_best_f1_score: 0.9592; train_kl_reg_loss: 8782.8506; train_edge_recon_loss: 258022.6295; train_gene_expr_recon_loss: 160302.3446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427107.8252; train_optim_loss: 427107.8252; val_kl_reg_loss: 8683.2535; val_edge_recon_loss: 261548.8210; val_gene_expr_recon_loss: 164465.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434697.9588; val_optim_loss: 434697.9588
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9844; val_auprc_score: 0.9776; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 8793.1178; train_edge_recon_loss: 257953.1088; train_gene_expr_recon_loss: 160236.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426982.3304; train_optim_loss: 426982.3304; val_kl_reg_loss: 8617.3699; val_edge_recon_loss: 261502.4830; val_gene_expr_recon_loss: 164508.5582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434628.4119; val_optim_loss: 434628.4119

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9843; val_auprc_score: 0.9769; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 8799.5751; train_edge_recon_loss: 257673.0802; train_gene_expr_recon_loss: 157982.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424455.1610; train_optim_loss: 424455.1610; val_kl_reg_loss: 8635.8105; val_edge_recon_loss: 260905.3736; val_gene_expr_recon_loss: 163163.4382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432704.6193; val_optim_loss: 432704.6193
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9846; val_auprc_score: 0.9783; val_best_acc_score: 0.9602; val_best_f1_score: 0.9612; train_kl_reg_loss: 8825.0577; train_edge_recon_loss: 257651.3430; train_gene_expr_recon_loss: 157815.0193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424291.4217; train_optim_loss: 424291.4217; val_kl_reg_loss: 8645.5674; val_edge_recon_loss: 260614.3984; val_gene_expr_recon_loss: 163141.4801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432401.4432; val_optim_loss: 432401.4432
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9843; val_auprc_score: 0.9778; val_best_acc_score: 0.9595; val_best_f1_score: 0.9604; train_kl_reg_loss: 8838.2754; train_edge_recon_loss: 257512.8852; train_gene_expr_recon_loss: 157748.6229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424099.7819; train_optim_loss: 424099.7819; val_kl_reg_loss: 8653.0808; val_edge_recon_loss: 260658.2045; val_gene_expr_recon_loss: 163380.2088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432691.4943; val_optim_loss: 432691.4943
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9850; val_auprc_score: 0.9789; val_best_acc_score: 0.9597; val_best_f1_score: 0.9606; train_kl_reg_loss: 8842.7963; train_edge_recon_loss: 257594.8382; train_gene_expr_recon_loss: 157706.5812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424144.2152; train_optim_loss: 424144.2152; val_kl_reg_loss: 8635.5528; val_edge_recon_loss: 260402.7479; val_gene_expr_recon_loss: 162898.1420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431936.4418; val_optim_loss: 431936.4418
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9838; val_auprc_score: 0.9763; val_best_acc_score: 0.9594; val_best_f1_score: 0.9604; train_kl_reg_loss: 8849.4797; train_edge_recon_loss: 257397.6720; train_gene_expr_recon_loss: 157651.5650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423898.7158; train_optim_loss: 423898.7158; val_kl_reg_loss: 8665.1078; val_edge_recon_loss: 260630.3480; val_gene_expr_recon_loss: 163041.7287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432337.1832; val_optim_loss: 432337.1832
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9840; val_auprc_score: 0.9775; val_best_acc_score: 0.9591; val_best_f1_score: 0.9602; train_kl_reg_loss: 8853.6535; train_edge_recon_loss: 257693.0601; train_gene_expr_recon_loss: 157610.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424157.1509; train_optim_loss: 424157.1509; val_kl_reg_loss: 8675.9863; val_edge_recon_loss: 260759.1321; val_gene_expr_recon_loss: 163181.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432616.7770; val_optim_loss: 432616.7770
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9842; val_auprc_score: 0.9771; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 8853.9630; train_edge_recon_loss: 257516.4957; train_gene_expr_recon_loss: 157574.9092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423945.3678; train_optim_loss: 423945.3678; val_kl_reg_loss: 8662.3831; val_edge_recon_loss: 260701.2741; val_gene_expr_recon_loss: 162904.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432268.0511; val_optim_loss: 432268.0511
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9852; val_auprc_score: 0.9797; val_best_acc_score: 0.9596; val_best_f1_score: 0.9605; train_kl_reg_loss: 8853.2744; train_edge_recon_loss: 257583.9186; train_gene_expr_recon_loss: 157235.2254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423672.4209; train_optim_loss: 423672.4209; val_kl_reg_loss: 8626.6844; val_edge_recon_loss: 261052.3679; val_gene_expr_recon_loss: 162581.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432260.4901; val_optim_loss: 432260.4901

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9840; val_auprc_score: 0.9774; val_best_acc_score: 0.9595; val_best_f1_score: 0.9604; train_kl_reg_loss: 8852.2305; train_edge_recon_loss: 257442.1801; train_gene_expr_recon_loss: 157245.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423539.8835; train_optim_loss: 423539.8835; val_kl_reg_loss: 8665.5301; val_edge_recon_loss: 260606.8075; val_gene_expr_recon_loss: 162649.1903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431921.5284; val_optim_loss: 431921.5284
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9852; val_auprc_score: 0.9784; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 8854.4606; train_edge_recon_loss: 257379.5312; train_gene_expr_recon_loss: 157147.2437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423381.2350; train_optim_loss: 423381.2350; val_kl_reg_loss: 8670.3573; val_edge_recon_loss: 260277.7926; val_gene_expr_recon_loss: 162994.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431942.8324; val_optim_loss: 431942.8324
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9843; val_auprc_score: 0.9779; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 8857.3589; train_edge_recon_loss: 257287.5083; train_gene_expr_recon_loss: 157065.6071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423210.4751; train_optim_loss: 423210.4751; val_kl_reg_loss: 8662.2849; val_edge_recon_loss: 260700.3963; val_gene_expr_recon_loss: 163109.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432471.8878; val_optim_loss: 432471.8878
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9836; val_auprc_score: 0.9763; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 8856.9485; train_edge_recon_loss: 257398.3556; train_gene_expr_recon_loss: 157313.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423568.9347; train_optim_loss: 423568.9347; val_kl_reg_loss: 8672.6246; val_edge_recon_loss: 261018.7401; val_gene_expr_recon_loss: 162999.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432690.4929; val_optim_loss: 432690.4929
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9843; val_auprc_score: 0.9769; val_best_acc_score: 0.9595; val_best_f1_score: 0.9604; train_kl_reg_loss: 8860.2376; train_edge_recon_loss: 257443.9211; train_gene_expr_recon_loss: 157062.6470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423366.8065; train_optim_loss: 423366.8065; val_kl_reg_loss: 8668.7623; val_edge_recon_loss: 260776.1300; val_gene_expr_recon_loss: 163284.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432729.8622; val_optim_loss: 432729.8622

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9844; val_auprc_score: 0.9775; val_best_acc_score: 0.9596; val_best_f1_score: 0.9607; train_kl_reg_loss: 8856.0401; train_edge_recon_loss: 257576.6956; train_gene_expr_recon_loss: 156961.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423393.7425; train_optim_loss: 423393.7425; val_kl_reg_loss: 8669.2598; val_edge_recon_loss: 260655.2692; val_gene_expr_recon_loss: 162746.1357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432070.6648; val_optim_loss: 432070.6648
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9844; val_auprc_score: 0.9778; val_best_acc_score: 0.9599; val_best_f1_score: 0.9608; train_kl_reg_loss: 8857.1551; train_edge_recon_loss: 257448.1688; train_gene_expr_recon_loss: 157085.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423390.4297; train_optim_loss: 423390.4297; val_kl_reg_loss: 8666.1993; val_edge_recon_loss: 260809.7827; val_gene_expr_recon_loss: 162754.1740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432230.1562; val_optim_loss: 432230.1562
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9841; val_auprc_score: 0.9768; val_best_acc_score: 0.9599; val_best_f1_score: 0.9609; train_kl_reg_loss: 8858.4456; train_edge_recon_loss: 257516.9514; train_gene_expr_recon_loss: 157128.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423503.4425; train_optim_loss: 423503.4425; val_kl_reg_loss: 8670.6458; val_edge_recon_loss: 260780.6300; val_gene_expr_recon_loss: 162699.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432150.6222; val_optim_loss: 432150.6222
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9848; val_auprc_score: 0.9780; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 8858.5259; train_edge_recon_loss: 257439.2668; train_gene_expr_recon_loss: 157162.2406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423460.0342; train_optim_loss: 423460.0342; val_kl_reg_loss: 8668.8335; val_edge_recon_loss: 260749.7962; val_gene_expr_recon_loss: 162917.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432336.1051; val_optim_loss: 432336.1051

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 1 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9843
Val AUPRC score: 0.9774
Val best accuracy score: 0.9598
Val best F1 score: 0.9606
Val gene expr MSE score: 0.5207

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
