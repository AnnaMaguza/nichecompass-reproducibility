None
Run timestamp: 30062023_103326_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9636; val_auprc_score: 0.9522; val_best_acc_score: 0.9078; val_best_f1_score: 0.9101; train_kl_reg_loss: 5329.9781; train_edge_recon_loss: 31971.4891; train_gene_expr_recon_loss: 123943.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161245.3957; train_optim_loss: 161245.3957; val_kl_reg_loss: 5315.3448; val_edge_recon_loss: 30516.3553; val_gene_expr_recon_loss: 110510.3303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146342.0305; val_optim_loss: 146342.0305
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9736; val_auprc_score: 0.9661; val_best_acc_score: 0.9261; val_best_f1_score: 0.9274; train_kl_reg_loss: 5011.6779; train_edge_recon_loss: 30206.2982; train_gene_expr_recon_loss: 107138.8252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142356.8020; train_optim_loss: 142356.8020; val_kl_reg_loss: 4505.4609; val_edge_recon_loss: 30077.7940; val_gene_expr_recon_loss: 105042.2376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139625.4929; val_optim_loss: 139625.4929
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9774; val_auprc_score: 0.9718; val_best_acc_score: 0.9335; val_best_f1_score: 0.9343; train_kl_reg_loss: 4425.8478; train_edge_recon_loss: 29828.2130; train_gene_expr_recon_loss: 103219.6217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137473.6829; train_optim_loss: 137473.6829; val_kl_reg_loss: 4134.8062; val_edge_recon_loss: 29775.9523; val_gene_expr_recon_loss: 102153.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136064.5455; val_optim_loss: 136064.5455
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9797; val_auprc_score: 0.9740; val_best_acc_score: 0.9395; val_best_f1_score: 0.9407; train_kl_reg_loss: 4154.2639; train_edge_recon_loss: 29561.4252; train_gene_expr_recon_loss: 100695.4709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134411.1596; train_optim_loss: 134411.1596; val_kl_reg_loss: 3900.8095; val_edge_recon_loss: 29556.4684; val_gene_expr_recon_loss: 99956.4162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133413.6942; val_optim_loss: 133413.6942
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9795; val_auprc_score: 0.9734; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 4032.6248; train_edge_recon_loss: 29310.0445; train_gene_expr_recon_loss: 98757.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132100.0366; train_optim_loss: 132100.0366; val_kl_reg_loss: 3885.6116; val_edge_recon_loss: 29410.5812; val_gene_expr_recon_loss: 98380.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131676.8949; val_optim_loss: 131676.8949
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9816; val_auprc_score: 0.9762; val_best_acc_score: 0.9432; val_best_f1_score: 0.9441; train_kl_reg_loss: 3970.4434; train_edge_recon_loss: 29134.4923; train_gene_expr_recon_loss: 97154.3578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130259.2937; train_optim_loss: 130259.2937; val_kl_reg_loss: 3873.7839; val_edge_recon_loss: 29137.0031; val_gene_expr_recon_loss: 97047.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130058.4219; val_optim_loss: 130058.4219
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9816; val_auprc_score: 0.9767; val_best_acc_score: 0.9420; val_best_f1_score: 0.9433; train_kl_reg_loss: 3929.3605; train_edge_recon_loss: 29005.6458; train_gene_expr_recon_loss: 95721.3072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128656.3138; train_optim_loss: 128656.3138; val_kl_reg_loss: 3846.8410; val_edge_recon_loss: 29183.5638; val_gene_expr_recon_loss: 95896.2425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128926.6477; val_optim_loss: 128926.6477
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9820; val_auprc_score: 0.9766; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 3909.3299; train_edge_recon_loss: 28885.7255; train_gene_expr_recon_loss: 94400.3291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127195.3847; train_optim_loss: 127195.3847; val_kl_reg_loss: 3831.4909; val_edge_recon_loss: 29099.8876; val_gene_expr_recon_loss: 95023.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127954.6804; val_optim_loss: 127954.6804
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9819; val_auprc_score: 0.9770; val_best_acc_score: 0.9417; val_best_f1_score: 0.9430; train_kl_reg_loss: 3911.2446; train_edge_recon_loss: 28772.3395; train_gene_expr_recon_loss: 93362.4568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126046.0409; train_optim_loss: 126046.0409; val_kl_reg_loss: 3844.9520; val_edge_recon_loss: 28949.8249; val_gene_expr_recon_loss: 94274.1886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127068.9663; val_optim_loss: 127068.9663
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9818; val_auprc_score: 0.9765; val_best_acc_score: 0.9412; val_best_f1_score: 0.9428; train_kl_reg_loss: 3914.9281; train_edge_recon_loss: 28671.6037; train_gene_expr_recon_loss: 92417.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125004.0969; train_optim_loss: 125004.0969; val_kl_reg_loss: 3860.8179; val_edge_recon_loss: 28910.7164; val_gene_expr_recon_loss: 93490.5870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126262.1211; val_optim_loss: 126262.1211
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9800; val_auprc_score: 0.9737; val_best_acc_score: 0.9392; val_best_f1_score: 0.9406; train_kl_reg_loss: 3917.7572; train_edge_recon_loss: 28600.7178; train_gene_expr_recon_loss: 91570.1451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124088.6199; train_optim_loss: 124088.6199; val_kl_reg_loss: 3839.6803; val_edge_recon_loss: 28923.3913; val_gene_expr_recon_loss: 93104.9272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125867.9982; val_optim_loss: 125867.9982
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9823; val_auprc_score: 0.9776; val_best_acc_score: 0.9417; val_best_f1_score: 0.9429; train_kl_reg_loss: 3926.1600; train_edge_recon_loss: 28532.2841; train_gene_expr_recon_loss: 91034.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123493.4085; train_optim_loss: 123493.4085; val_kl_reg_loss: 3836.5390; val_edge_recon_loss: 28846.2105; val_gene_expr_recon_loss: 92439.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125122.4194; val_optim_loss: 125122.4194
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9828; val_auprc_score: 0.9781; val_best_acc_score: 0.9415; val_best_f1_score: 0.9427; train_kl_reg_loss: 3923.7876; train_edge_recon_loss: 28477.8382; train_gene_expr_recon_loss: 90321.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122722.7006; train_optim_loss: 122722.7006; val_kl_reg_loss: 3837.0479; val_edge_recon_loss: 28821.6690; val_gene_expr_recon_loss: 92057.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124716.6044; val_optim_loss: 124716.6044
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9822; val_auprc_score: 0.9773; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 3929.5714; train_edge_recon_loss: 28418.1866; train_gene_expr_recon_loss: 89711.7380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122059.4959; train_optim_loss: 122059.4959; val_kl_reg_loss: 3857.0167; val_edge_recon_loss: 28757.0116; val_gene_expr_recon_loss: 92012.4556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124626.4844; val_optim_loss: 124626.4844
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9821; val_auprc_score: 0.9769; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 3931.4225; train_edge_recon_loss: 28380.8538; train_gene_expr_recon_loss: 89237.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121549.5631; train_optim_loss: 121549.5631; val_kl_reg_loss: 3843.7509; val_edge_recon_loss: 28767.0872; val_gene_expr_recon_loss: 91293.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123904.5994; val_optim_loss: 123904.5994
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9823; val_auprc_score: 0.9780; val_best_acc_score: 0.9425; val_best_f1_score: 0.9437; train_kl_reg_loss: 3935.4163; train_edge_recon_loss: 28325.7800; train_gene_expr_recon_loss: 88694.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120956.0941; train_optim_loss: 120956.0941; val_kl_reg_loss: 3844.9048; val_edge_recon_loss: 28758.3650; val_gene_expr_recon_loss: 91291.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123895.0629; val_optim_loss: 123895.0629
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9829; val_auprc_score: 0.9790; val_best_acc_score: 0.9417; val_best_f1_score: 0.9430; train_kl_reg_loss: 3943.1150; train_edge_recon_loss: 28280.4710; train_gene_expr_recon_loss: 88486.3045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120709.8905; train_optim_loss: 120709.8905; val_kl_reg_loss: 3836.5830; val_edge_recon_loss: 28718.4291; val_gene_expr_recon_loss: 90895.9652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123450.9780; val_optim_loss: 123450.9780
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9833; val_auprc_score: 0.9794; val_best_acc_score: 0.9428; val_best_f1_score: 0.9442; train_kl_reg_loss: 3940.2390; train_edge_recon_loss: 28265.7320; train_gene_expr_recon_loss: 88050.4109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120256.3818; train_optim_loss: 120256.3818; val_kl_reg_loss: 3869.8869; val_edge_recon_loss: 28709.9752; val_gene_expr_recon_loss: 90713.0071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123292.8704; val_optim_loss: 123292.8704
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9819; val_auprc_score: 0.9767; val_best_acc_score: 0.9416; val_best_f1_score: 0.9431; train_kl_reg_loss: 3942.9676; train_edge_recon_loss: 28228.0852; train_gene_expr_recon_loss: 87746.5427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119917.5957; train_optim_loss: 119917.5957; val_kl_reg_loss: 3861.7074; val_edge_recon_loss: 28671.8326; val_gene_expr_recon_loss: 90793.7660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123327.3061; val_optim_loss: 123327.3061
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9822; val_auprc_score: 0.9777; val_best_acc_score: 0.9407; val_best_f1_score: 0.9421; train_kl_reg_loss: 3941.2819; train_edge_recon_loss: 28204.8296; train_gene_expr_recon_loss: 87494.9065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119641.0179; train_optim_loss: 119641.0179; val_kl_reg_loss: 3870.3149; val_edge_recon_loss: 28708.7175; val_gene_expr_recon_loss: 90835.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123414.6229; val_optim_loss: 123414.6229
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9828; val_auprc_score: 0.9787; val_best_acc_score: 0.9411; val_best_f1_score: 0.9427; train_kl_reg_loss: 3946.9115; train_edge_recon_loss: 28171.8617; train_gene_expr_recon_loss: 87151.6161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119270.3893; train_optim_loss: 119270.3893; val_kl_reg_loss: 3867.6500; val_edge_recon_loss: 28644.4049; val_gene_expr_recon_loss: 90726.5884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123238.6438; val_optim_loss: 123238.6438
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9828; val_auprc_score: 0.9789; val_best_acc_score: 0.9411; val_best_f1_score: 0.9425; train_kl_reg_loss: 3950.4715; train_edge_recon_loss: 28134.1670; train_gene_expr_recon_loss: 86955.6263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119040.2648; train_optim_loss: 119040.2648; val_kl_reg_loss: 3895.4449; val_edge_recon_loss: 28661.0553; val_gene_expr_recon_loss: 90686.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123242.7386; val_optim_loss: 123242.7386
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9824; val_auprc_score: 0.9775; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 3952.0360; train_edge_recon_loss: 28105.8626; train_gene_expr_recon_loss: 86770.9572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118828.8556; train_optim_loss: 118828.8556; val_kl_reg_loss: 3925.0095; val_edge_recon_loss: 28569.5400; val_gene_expr_recon_loss: 90347.8168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122842.3672; val_optim_loss: 122842.3672
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9820; val_auprc_score: 0.9768; val_best_acc_score: 0.9416; val_best_f1_score: 0.9432; train_kl_reg_loss: 3947.4166; train_edge_recon_loss: 28096.1019; train_gene_expr_recon_loss: 86550.8414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118594.3601; train_optim_loss: 118594.3601; val_kl_reg_loss: 3857.4332; val_edge_recon_loss: 28569.4929; val_gene_expr_recon_loss: 90372.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122799.2188; val_optim_loss: 122799.2188
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9834; val_auprc_score: 0.9799; val_best_acc_score: 0.9411; val_best_f1_score: 0.9426; train_kl_reg_loss: 3951.5442; train_edge_recon_loss: 28069.5183; train_gene_expr_recon_loss: 86305.1840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118326.2464; train_optim_loss: 118326.2464; val_kl_reg_loss: 3877.9605; val_edge_recon_loss: 28629.5910; val_gene_expr_recon_loss: 90343.4371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122850.9886; val_optim_loss: 122850.9886
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9833; val_auprc_score: 0.9793; val_best_acc_score: 0.9432; val_best_f1_score: 0.9446; train_kl_reg_loss: 3952.0741; train_edge_recon_loss: 28046.6081; train_gene_expr_recon_loss: 86145.6284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118144.3107; train_optim_loss: 118144.3107; val_kl_reg_loss: 3870.7590; val_edge_recon_loss: 28556.7966; val_gene_expr_recon_loss: 90309.2788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122736.8342; val_optim_loss: 122736.8342
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9830; val_auprc_score: 0.9793; val_best_acc_score: 0.9413; val_best_f1_score: 0.9431; train_kl_reg_loss: 3957.5168; train_edge_recon_loss: 28026.4703; train_gene_expr_recon_loss: 85986.5419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117970.5291; train_optim_loss: 117970.5291; val_kl_reg_loss: 3865.0909; val_edge_recon_loss: 28558.5564; val_gene_expr_recon_loss: 90765.8058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123189.4535; val_optim_loss: 123189.4535
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9826; val_auprc_score: 0.9783; val_best_acc_score: 0.9412; val_best_f1_score: 0.9426; train_kl_reg_loss: 3959.0504; train_edge_recon_loss: 28011.6420; train_gene_expr_recon_loss: 85899.3309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117870.0232; train_optim_loss: 117870.0232; val_kl_reg_loss: 3888.9106; val_edge_recon_loss: 28583.7828; val_gene_expr_recon_loss: 90303.3430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122776.0362; val_optim_loss: 122776.0362
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9826; val_auprc_score: 0.9780; val_best_acc_score: 0.9427; val_best_f1_score: 0.9439; train_kl_reg_loss: 3957.9822; train_edge_recon_loss: 27999.7603; train_gene_expr_recon_loss: 85680.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117638.4598; train_optim_loss: 117638.4598; val_kl_reg_loss: 3871.1786; val_edge_recon_loss: 28537.1614; val_gene_expr_recon_loss: 90439.8384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122848.1783; val_optim_loss: 122848.1783
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9837; val_auprc_score: 0.9799; val_best_acc_score: 0.9425; val_best_f1_score: 0.9438; train_kl_reg_loss: 3955.1944; train_edge_recon_loss: 28005.8211; train_gene_expr_recon_loss: 85547.6890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117508.7047; train_optim_loss: 117508.7047; val_kl_reg_loss: 3889.3080; val_edge_recon_loss: 28532.3320; val_gene_expr_recon_loss: 90288.5210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122710.1616; val_optim_loss: 122710.1616
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9820; val_auprc_score: 0.9775; val_best_acc_score: 0.9410; val_best_f1_score: 0.9428; train_kl_reg_loss: 3965.7039; train_edge_recon_loss: 27962.2082; train_gene_expr_recon_loss: 85431.3291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117359.2413; train_optim_loss: 117359.2413; val_kl_reg_loss: 3909.8772; val_edge_recon_loss: 28534.5271; val_gene_expr_recon_loss: 90355.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122800.3185; val_optim_loss: 122800.3185
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9827; val_auprc_score: 0.9785; val_best_acc_score: 0.9419; val_best_f1_score: 0.9431; train_kl_reg_loss: 3968.1811; train_edge_recon_loss: 27946.7980; train_gene_expr_recon_loss: 85235.5254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117150.5046; train_optim_loss: 117150.5046; val_kl_reg_loss: 3885.4879; val_edge_recon_loss: 28527.8956; val_gene_expr_recon_loss: 90482.1491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122895.5323; val_optim_loss: 122895.5323
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9836; val_auprc_score: 0.9800; val_best_acc_score: 0.9440; val_best_f1_score: 0.9455; train_kl_reg_loss: 3974.1952; train_edge_recon_loss: 27921.3059; train_gene_expr_recon_loss: 85226.9499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117122.4510; train_optim_loss: 117122.4510; val_kl_reg_loss: 3881.7086; val_edge_recon_loss: 28501.4360; val_gene_expr_recon_loss: 90505.4208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122888.5646; val_optim_loss: 122888.5646
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9832; val_auprc_score: 0.9789; val_best_acc_score: 0.9426; val_best_f1_score: 0.9437; train_kl_reg_loss: 3973.9630; train_edge_recon_loss: 27915.7269; train_gene_expr_recon_loss: 85161.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117050.6958; train_optim_loss: 117050.6958; val_kl_reg_loss: 3873.6316; val_edge_recon_loss: 28528.7208; val_gene_expr_recon_loss: 90344.3239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122746.6765; val_optim_loss: 122746.6765

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9825; val_auprc_score: 0.9784; val_best_acc_score: 0.9423; val_best_f1_score: 0.9438; train_kl_reg_loss: 3930.2435; train_edge_recon_loss: 27864.6241; train_gene_expr_recon_loss: 84341.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116136.0404; train_optim_loss: 116136.0404; val_kl_reg_loss: 3863.6141; val_edge_recon_loss: 28465.6023; val_gene_expr_recon_loss: 90213.4201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122542.6364; val_optim_loss: 122542.6364
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9826; val_auprc_score: 0.9789; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 3933.7592; train_edge_recon_loss: 27844.2170; train_gene_expr_recon_loss: 84317.4075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116095.3839; train_optim_loss: 116095.3839; val_kl_reg_loss: 3859.4799; val_edge_recon_loss: 28515.3415; val_gene_expr_recon_loss: 90328.6939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122703.5156; val_optim_loss: 122703.5156
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9829; val_auprc_score: 0.9794; val_best_acc_score: 0.9420; val_best_f1_score: 0.9434; train_kl_reg_loss: 3929.7516; train_edge_recon_loss: 27855.5408; train_gene_expr_recon_loss: 84288.7940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116074.0865; train_optim_loss: 116074.0865; val_kl_reg_loss: 3854.2976; val_edge_recon_loss: 28467.7683; val_gene_expr_recon_loss: 90009.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122331.4258; val_optim_loss: 122331.4258
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9829; val_auprc_score: 0.9791; val_best_acc_score: 0.9416; val_best_f1_score: 0.9431; train_kl_reg_loss: 3927.0010; train_edge_recon_loss: 27856.1406; train_gene_expr_recon_loss: 84216.6560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115999.7978; train_optim_loss: 115999.7978; val_kl_reg_loss: 3861.9704; val_edge_recon_loss: 28489.5248; val_gene_expr_recon_loss: 89922.7124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122274.2070; val_optim_loss: 122274.2070
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9837; val_auprc_score: 0.9801; val_best_acc_score: 0.9433; val_best_f1_score: 0.9446; train_kl_reg_loss: 3932.6224; train_edge_recon_loss: 27843.8570; train_gene_expr_recon_loss: 84331.9421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116108.4213; train_optim_loss: 116108.4213; val_kl_reg_loss: 3858.0550; val_edge_recon_loss: 28468.9846; val_gene_expr_recon_loss: 90287.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122614.1058; val_optim_loss: 122614.1058
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9835; val_auprc_score: 0.9799; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 3927.7697; train_edge_recon_loss: 27852.5652; train_gene_expr_recon_loss: 84225.8986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116006.2333; train_optim_loss: 116006.2333; val_kl_reg_loss: 3862.2040; val_edge_recon_loss: 28436.0099; val_gene_expr_recon_loss: 90386.3466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122684.5597; val_optim_loss: 122684.5597
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9824; val_auprc_score: 0.9785; val_best_acc_score: 0.9420; val_best_f1_score: 0.9435; train_kl_reg_loss: 3924.5815; train_edge_recon_loss: 27850.5266; train_gene_expr_recon_loss: 84139.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115914.8219; train_optim_loss: 115914.8219; val_kl_reg_loss: 3841.9539; val_edge_recon_loss: 28483.1346; val_gene_expr_recon_loss: 90174.0739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122499.1619; val_optim_loss: 122499.1619
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9833; val_auprc_score: 0.9794; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 3922.9090; train_edge_recon_loss: 27857.3352; train_gene_expr_recon_loss: 84183.3575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115963.6016; train_optim_loss: 115963.6016; val_kl_reg_loss: 3850.8494; val_edge_recon_loss: 28456.9600; val_gene_expr_recon_loss: 90248.5447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122556.3544; val_optim_loss: 122556.3544

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9838; val_auprc_score: 0.9801; val_best_acc_score: 0.9438; val_best_f1_score: 0.9450; train_kl_reg_loss: 3921.2670; train_edge_recon_loss: 27838.2476; train_gene_expr_recon_loss: 84106.5516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115866.0661; train_optim_loss: 115866.0661; val_kl_reg_loss: 3853.4591; val_edge_recon_loss: 28434.3424; val_gene_expr_recon_loss: 90474.9719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122762.7738; val_optim_loss: 122762.7738
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9821; val_auprc_score: 0.9771; val_best_acc_score: 0.9420; val_best_f1_score: 0.9434; train_kl_reg_loss: 3920.5175; train_edge_recon_loss: 27840.7083; train_gene_expr_recon_loss: 84103.6432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115864.8691; train_optim_loss: 115864.8691; val_kl_reg_loss: 3851.2105; val_edge_recon_loss: 28516.8896; val_gene_expr_recon_loss: 90345.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122713.2152; val_optim_loss: 122713.2152
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9828; val_auprc_score: 0.9787; val_best_acc_score: 0.9414; val_best_f1_score: 0.9429; train_kl_reg_loss: 3921.1612; train_edge_recon_loss: 27839.3139; train_gene_expr_recon_loss: 84174.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115934.7875; train_optim_loss: 115934.7875; val_kl_reg_loss: 3845.7072; val_edge_recon_loss: 28487.9681; val_gene_expr_recon_loss: 90300.3143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122633.9908; val_optim_loss: 122633.9908
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9840; val_auprc_score: 0.9803; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 3918.4684; train_edge_recon_loss: 27839.6068; train_gene_expr_recon_loss: 84128.7920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115886.8671; train_optim_loss: 115886.8671; val_kl_reg_loss: 3845.7377; val_edge_recon_loss: 28436.9101; val_gene_expr_recon_loss: 90215.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122498.3118; val_optim_loss: 122498.3118

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 9 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9823
Val AUPRC score: 0.9777
Val best accuracy score: 0.9420
Val best F1 score: 0.9434
Val gene expr MSE score: 0.7018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
