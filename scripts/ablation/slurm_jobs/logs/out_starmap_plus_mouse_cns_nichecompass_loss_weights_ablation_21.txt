None
Run timestamp: 02072023_115436_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9645; val_auprc_score: 0.9562; val_best_acc_score: 0.9056; val_best_f1_score: 0.9082; train_kl_reg_loss: 5580.6637; train_edge_recon_loss: 31853.7672; train_gene_expr_recon_loss: 122651.8277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160086.2585; train_optim_loss: 160086.2585; val_kl_reg_loss: 5505.6830; val_edge_recon_loss: 30651.2453; val_gene_expr_recon_loss: 109194.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145351.4531; val_optim_loss: 145351.4531
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9742; val_auprc_score: 0.9679; val_best_acc_score: 0.9257; val_best_f1_score: 0.9270; train_kl_reg_loss: 5151.3683; train_edge_recon_loss: 30319.1423; train_gene_expr_recon_loss: 105841.2785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141311.7898; train_optim_loss: 141311.7898; val_kl_reg_loss: 4606.1607; val_edge_recon_loss: 30151.9316; val_gene_expr_recon_loss: 103955.0149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138713.1051; val_optim_loss: 138713.1051
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9763; val_auprc_score: 0.9692; val_best_acc_score: 0.9333; val_best_f1_score: 0.9347; train_kl_reg_loss: 4494.5568; train_edge_recon_loss: 29932.8427; train_gene_expr_recon_loss: 101897.7585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136325.1582; train_optim_loss: 136325.1582; val_kl_reg_loss: 4152.8152; val_edge_recon_loss: 29932.5521; val_gene_expr_recon_loss: 101145.1616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135230.5284; val_optim_loss: 135230.5284
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9789; val_auprc_score: 0.9731; val_best_acc_score: 0.9364; val_best_f1_score: 0.9378; train_kl_reg_loss: 4204.5763; train_edge_recon_loss: 29616.1931; train_gene_expr_recon_loss: 99272.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133093.6383; train_optim_loss: 133093.6383; val_kl_reg_loss: 3959.5168; val_edge_recon_loss: 29596.1685; val_gene_expr_recon_loss: 99125.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132680.7440; val_optim_loss: 132680.7440
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9807; val_auprc_score: 0.9752; val_best_acc_score: 0.9402; val_best_f1_score: 0.9418; train_kl_reg_loss: 4063.7023; train_edge_recon_loss: 29354.7638; train_gene_expr_recon_loss: 97261.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130680.0950; train_optim_loss: 130680.0950; val_kl_reg_loss: 3942.3034; val_edge_recon_loss: 29337.3792; val_gene_expr_recon_loss: 97330.2294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130609.9130; val_optim_loss: 130609.9130
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9808; val_auprc_score: 0.9748; val_best_acc_score: 0.9407; val_best_f1_score: 0.9425; train_kl_reg_loss: 3978.9509; train_edge_recon_loss: 29162.7614; train_gene_expr_recon_loss: 95600.9584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128742.6707; train_optim_loss: 128742.6707; val_kl_reg_loss: 3880.1766; val_edge_recon_loss: 29316.1827; val_gene_expr_recon_loss: 95922.0305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129118.3903; val_optim_loss: 129118.3903
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9820; val_auprc_score: 0.9770; val_best_acc_score: 0.9432; val_best_f1_score: 0.9445; train_kl_reg_loss: 3929.7547; train_edge_recon_loss: 29020.3391; train_gene_expr_recon_loss: 94182.7132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127132.8070; train_optim_loss: 127132.8070; val_kl_reg_loss: 3804.7407; val_edge_recon_loss: 29197.5617; val_gene_expr_recon_loss: 94967.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127969.3374; val_optim_loss: 127969.3374
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9803; val_auprc_score: 0.9744; val_best_acc_score: 0.9413; val_best_f1_score: 0.9428; train_kl_reg_loss: 3908.5522; train_edge_recon_loss: 28900.2953; train_gene_expr_recon_loss: 92963.9786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125772.8262; train_optim_loss: 125772.8262; val_kl_reg_loss: 3796.1616; val_edge_recon_loss: 29078.7022; val_gene_expr_recon_loss: 93699.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126574.4350; val_optim_loss: 126574.4350
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9825; val_auprc_score: 0.9776; val_best_acc_score: 0.9442; val_best_f1_score: 0.9455; train_kl_reg_loss: 3895.5867; train_edge_recon_loss: 28785.3438; train_gene_expr_recon_loss: 91990.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124671.1501; train_optim_loss: 124671.1501; val_kl_reg_loss: 3764.5484; val_edge_recon_loss: 28902.8280; val_gene_expr_recon_loss: 93350.0490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126017.4254; val_optim_loss: 126017.4254
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9811; val_auprc_score: 0.9756; val_best_acc_score: 0.9419; val_best_f1_score: 0.9436; train_kl_reg_loss: 3889.1060; train_edge_recon_loss: 28703.4871; train_gene_expr_recon_loss: 91027.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123619.6221; train_optim_loss: 123619.6221; val_kl_reg_loss: 3791.0511; val_edge_recon_loss: 28963.6154; val_gene_expr_recon_loss: 92296.5707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125051.2369; val_optim_loss: 125051.2369
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9816; val_auprc_score: 0.9767; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 3876.4632; train_edge_recon_loss: 28632.5603; train_gene_expr_recon_loss: 90229.4478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122738.4715; train_optim_loss: 122738.4715; val_kl_reg_loss: 3781.1900; val_edge_recon_loss: 28916.2567; val_gene_expr_recon_loss: 92009.7429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124707.1907; val_optim_loss: 124707.1907
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9827; val_auprc_score: 0.9787; val_best_acc_score: 0.9430; val_best_f1_score: 0.9444; train_kl_reg_loss: 3869.3025; train_edge_recon_loss: 28565.6851; train_gene_expr_recon_loss: 89542.9843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121977.9722; train_optim_loss: 121977.9722; val_kl_reg_loss: 3749.0132; val_edge_recon_loss: 28871.8088; val_gene_expr_recon_loss: 91670.8093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124291.6314; val_optim_loss: 124291.6314
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9812; val_auprc_score: 0.9760; val_best_acc_score: 0.9425; val_best_f1_score: 0.9441; train_kl_reg_loss: 3863.5630; train_edge_recon_loss: 28494.9079; train_gene_expr_recon_loss: 89081.9202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121440.3912; train_optim_loss: 121440.3912; val_kl_reg_loss: 3815.3068; val_edge_recon_loss: 28887.8134; val_gene_expr_recon_loss: 91106.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123809.8079; val_optim_loss: 123809.8079
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9817; val_auprc_score: 0.9763; val_best_acc_score: 0.9419; val_best_f1_score: 0.9434; train_kl_reg_loss: 3858.7710; train_edge_recon_loss: 28432.0219; train_gene_expr_recon_loss: 88566.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120857.1844; train_optim_loss: 120857.1844; val_kl_reg_loss: 3788.8515; val_edge_recon_loss: 28774.9173; val_gene_expr_recon_loss: 90828.7837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123392.5533; val_optim_loss: 123392.5533
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9824; val_auprc_score: 0.9776; val_best_acc_score: 0.9441; val_best_f1_score: 0.9458; train_kl_reg_loss: 3850.9958; train_edge_recon_loss: 28396.4346; train_gene_expr_recon_loss: 88087.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120335.0533; train_optim_loss: 120335.0533; val_kl_reg_loss: 3783.6460; val_edge_recon_loss: 28726.8985; val_gene_expr_recon_loss: 90281.0408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122791.5852; val_optim_loss: 122791.5852
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9825; val_auprc_score: 0.9782; val_best_acc_score: 0.9437; val_best_f1_score: 0.9452; train_kl_reg_loss: 3848.3389; train_edge_recon_loss: 28337.1447; train_gene_expr_recon_loss: 87631.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119817.3615; train_optim_loss: 119817.3615; val_kl_reg_loss: 3761.6409; val_edge_recon_loss: 28687.6240; val_gene_expr_recon_loss: 90767.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123216.7486; val_optim_loss: 123216.7486
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9829; val_auprc_score: 0.9787; val_best_acc_score: 0.9441; val_best_f1_score: 0.9454; train_kl_reg_loss: 3843.1372; train_edge_recon_loss: 28294.3561; train_gene_expr_recon_loss: 87388.4586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119525.9519; train_optim_loss: 119525.9519; val_kl_reg_loss: 3710.8628; val_edge_recon_loss: 28705.5689; val_gene_expr_recon_loss: 90314.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122730.7571; val_optim_loss: 122730.7571
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9816; val_auprc_score: 0.9762; val_best_acc_score: 0.9431; val_best_f1_score: 0.9446; train_kl_reg_loss: 3833.8348; train_edge_recon_loss: 28269.0213; train_gene_expr_recon_loss: 86978.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119081.5146; train_optim_loss: 119081.5146; val_kl_reg_loss: 3763.3470; val_edge_recon_loss: 28617.8089; val_gene_expr_recon_loss: 90157.8398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122538.9950; val_optim_loss: 122538.9950
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9831; val_auprc_score: 0.9789; val_best_acc_score: 0.9442; val_best_f1_score: 0.9456; train_kl_reg_loss: 3835.3053; train_edge_recon_loss: 28218.8123; train_gene_expr_recon_loss: 86651.0562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118705.1737; train_optim_loss: 118705.1737; val_kl_reg_loss: 3772.5403; val_edge_recon_loss: 28641.2623; val_gene_expr_recon_loss: 89724.2340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122138.0366; val_optim_loss: 122138.0366
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9836; val_auprc_score: 0.9795; val_best_acc_score: 0.9449; val_best_f1_score: 0.9460; train_kl_reg_loss: 3830.0067; train_edge_recon_loss: 28188.0174; train_gene_expr_recon_loss: 86401.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118420.0154; train_optim_loss: 118420.0154; val_kl_reg_loss: 3756.4954; val_edge_recon_loss: 28580.7549; val_gene_expr_recon_loss: 90262.8132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122600.0629; val_optim_loss: 122600.0629
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9827; val_auprc_score: 0.9782; val_best_acc_score: 0.9431; val_best_f1_score: 0.9446; train_kl_reg_loss: 3830.0113; train_edge_recon_loss: 28155.9156; train_gene_expr_recon_loss: 86133.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118119.2408; train_optim_loss: 118119.2408; val_kl_reg_loss: 3739.2109; val_edge_recon_loss: 28582.0664; val_gene_expr_recon_loss: 90014.3970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122335.6744; val_optim_loss: 122335.6744
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9824; val_auprc_score: 0.9778; val_best_acc_score: 0.9426; val_best_f1_score: 0.9440; train_kl_reg_loss: 3822.3139; train_edge_recon_loss: 28130.5404; train_gene_expr_recon_loss: 85859.8961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117812.7506; train_optim_loss: 117812.7506; val_kl_reg_loss: 3740.2014; val_edge_recon_loss: 28563.8259; val_gene_expr_recon_loss: 90006.4407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122310.4688; val_optim_loss: 122310.4688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9835; val_auprc_score: 0.9795; val_best_acc_score: 0.9440; val_best_f1_score: 0.9456; train_kl_reg_loss: 3825.8117; train_edge_recon_loss: 28106.6057; train_gene_expr_recon_loss: 85781.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117714.1942; train_optim_loss: 117714.1942; val_kl_reg_loss: 3703.9604; val_edge_recon_loss: 28474.3515; val_gene_expr_recon_loss: 89769.7994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121948.1112; val_optim_loss: 121948.1112
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9824; val_auprc_score: 0.9782; val_best_acc_score: 0.9436; val_best_f1_score: 0.9451; train_kl_reg_loss: 3820.0369; train_edge_recon_loss: 28093.7433; train_gene_expr_recon_loss: 85600.5086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117514.2888; train_optim_loss: 117514.2888; val_kl_reg_loss: 3738.7793; val_edge_recon_loss: 28531.4198; val_gene_expr_recon_loss: 89468.2908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121738.4897; val_optim_loss: 121738.4897
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9836; val_auprc_score: 0.9799; val_best_acc_score: 0.9443; val_best_f1_score: 0.9457; train_kl_reg_loss: 3821.9876; train_edge_recon_loss: 28054.2761; train_gene_expr_recon_loss: 85340.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117216.6336; train_optim_loss: 117216.6336; val_kl_reg_loss: 3759.5918; val_edge_recon_loss: 28478.1852; val_gene_expr_recon_loss: 89763.1278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122000.9055; val_optim_loss: 122000.9055
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9833; val_auprc_score: 0.9791; val_best_acc_score: 0.9451; val_best_f1_score: 0.9465; train_kl_reg_loss: 3823.5250; train_edge_recon_loss: 28028.0647; train_gene_expr_recon_loss: 85193.6365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117045.2260; train_optim_loss: 117045.2260; val_kl_reg_loss: 3748.4498; val_edge_recon_loss: 28467.4352; val_gene_expr_recon_loss: 89700.3317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121916.2159; val_optim_loss: 121916.2159
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9832; val_auprc_score: 0.9789; val_best_acc_score: 0.9449; val_best_f1_score: 0.9465; train_kl_reg_loss: 3827.0371; train_edge_recon_loss: 28000.9703; train_gene_expr_recon_loss: 85010.2832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116838.2908; train_optim_loss: 116838.2908; val_kl_reg_loss: 3758.9362; val_edge_recon_loss: 28450.3517; val_gene_expr_recon_loss: 89344.8271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121554.1151; val_optim_loss: 121554.1151
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9834; val_auprc_score: 0.9791; val_best_acc_score: 0.9450; val_best_f1_score: 0.9465; train_kl_reg_loss: 3823.1690; train_edge_recon_loss: 28001.1762; train_gene_expr_recon_loss: 84910.4195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116734.7643; train_optim_loss: 116734.7643; val_kl_reg_loss: 3737.1698; val_edge_recon_loss: 28445.2026; val_gene_expr_recon_loss: 89598.5089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121780.8821; val_optim_loss: 121780.8821
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9828; val_auprc_score: 0.9788; val_best_acc_score: 0.9436; val_best_f1_score: 0.9453; train_kl_reg_loss: 3824.6807; train_edge_recon_loss: 27965.9432; train_gene_expr_recon_loss: 84799.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116589.8889; train_optim_loss: 116589.8889; val_kl_reg_loss: 3738.3044; val_edge_recon_loss: 28424.5527; val_gene_expr_recon_loss: 89803.4215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121966.2784; val_optim_loss: 121966.2784
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9833; val_auprc_score: 0.9796; val_best_acc_score: 0.9456; val_best_f1_score: 0.9472; train_kl_reg_loss: 3828.4033; train_edge_recon_loss: 27948.0562; train_gene_expr_recon_loss: 84546.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116322.9526; train_optim_loss: 116322.9526; val_kl_reg_loss: 3720.2662; val_edge_recon_loss: 28413.6602; val_gene_expr_recon_loss: 89656.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121790.5270; val_optim_loss: 121790.5270
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9834; val_auprc_score: 0.9798; val_best_acc_score: 0.9444; val_best_f1_score: 0.9461; train_kl_reg_loss: 3828.0636; train_edge_recon_loss: 27921.9498; train_gene_expr_recon_loss: 84479.7748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116229.7881; train_optim_loss: 116229.7881; val_kl_reg_loss: 3761.1656; val_edge_recon_loss: 28407.2469; val_gene_expr_recon_loss: 89646.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121814.5884; val_optim_loss: 121814.5884

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9833; val_auprc_score: 0.9795; val_best_acc_score: 0.9450; val_best_f1_score: 0.9465; train_kl_reg_loss: 3793.9497; train_edge_recon_loss: 27879.0226; train_gene_expr_recon_loss: 83905.8174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115578.7896; train_optim_loss: 115578.7896; val_kl_reg_loss: 3719.4042; val_edge_recon_loss: 28358.7963; val_gene_expr_recon_loss: 89294.2351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121372.4350; val_optim_loss: 121372.4350
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9833; val_auprc_score: 0.9795; val_best_acc_score: 0.9455; val_best_f1_score: 0.9470; train_kl_reg_loss: 3790.6253; train_edge_recon_loss: 27869.2692; train_gene_expr_recon_loss: 83853.5636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115513.4578; train_optim_loss: 115513.4578; val_kl_reg_loss: 3712.8110; val_edge_recon_loss: 28362.2773; val_gene_expr_recon_loss: 89752.6783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121827.7667; val_optim_loss: 121827.7667
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9843; val_auprc_score: 0.9807; val_best_acc_score: 0.9469; val_best_f1_score: 0.9484; train_kl_reg_loss: 3787.9389; train_edge_recon_loss: 27861.4627; train_gene_expr_recon_loss: 83742.0079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115391.4096; train_optim_loss: 115391.4096; val_kl_reg_loss: 3715.8079; val_edge_recon_loss: 28300.6850; val_gene_expr_recon_loss: 89338.8171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121355.3093; val_optim_loss: 121355.3093
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9843; val_auprc_score: 0.9814; val_best_acc_score: 0.9461; val_best_f1_score: 0.9474; train_kl_reg_loss: 3785.0535; train_edge_recon_loss: 27868.2018; train_gene_expr_recon_loss: 83799.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115452.8091; train_optim_loss: 115452.8091; val_kl_reg_loss: 3718.5530; val_edge_recon_loss: 28318.6907; val_gene_expr_recon_loss: 89218.0259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121255.2699; val_optim_loss: 121255.2699
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9833; val_auprc_score: 0.9789; val_best_acc_score: 0.9441; val_best_f1_score: 0.9457; train_kl_reg_loss: 3782.0980; train_edge_recon_loss: 27866.2083; train_gene_expr_recon_loss: 83671.0411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115319.3479; train_optim_loss: 115319.3479; val_kl_reg_loss: 3706.5575; val_edge_recon_loss: 28379.8625; val_gene_expr_recon_loss: 89305.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121391.5252; val_optim_loss: 121391.5252
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9832; val_auprc_score: 0.9795; val_best_acc_score: 0.9438; val_best_f1_score: 0.9453; train_kl_reg_loss: 3781.1774; train_edge_recon_loss: 27866.0886; train_gene_expr_recon_loss: 83782.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115429.9231; train_optim_loss: 115429.9231; val_kl_reg_loss: 3713.8071; val_edge_recon_loss: 28390.3331; val_gene_expr_recon_loss: 89283.8214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121387.9627; val_optim_loss: 121387.9627
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9836; val_auprc_score: 0.9796; val_best_acc_score: 0.9450; val_best_f1_score: 0.9468; train_kl_reg_loss: 3781.4292; train_edge_recon_loss: 27870.8085; train_gene_expr_recon_loss: 83710.0112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115362.2487; train_optim_loss: 115362.2487; val_kl_reg_loss: 3710.2891; val_edge_recon_loss: 28334.1678; val_gene_expr_recon_loss: 89370.2635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121414.7202; val_optim_loss: 121414.7202
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9836; val_auprc_score: 0.9797; val_best_acc_score: 0.9451; val_best_f1_score: 0.9464; train_kl_reg_loss: 3779.7942; train_edge_recon_loss: 27858.6387; train_gene_expr_recon_loss: 83641.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115279.5682; train_optim_loss: 115279.5682; val_kl_reg_loss: 3696.9201; val_edge_recon_loss: 28364.9300; val_gene_expr_recon_loss: 89464.9851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121526.8349; val_optim_loss: 121526.8349

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9835; val_auprc_score: 0.9796; val_best_acc_score: 0.9459; val_best_f1_score: 0.9473; train_kl_reg_loss: 3770.8211; train_edge_recon_loss: 27854.9026; train_gene_expr_recon_loss: 83630.7824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115256.5059; train_optim_loss: 115256.5059; val_kl_reg_loss: 3701.9490; val_edge_recon_loss: 28366.2761; val_gene_expr_recon_loss: 89373.4400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121441.6648; val_optim_loss: 121441.6648
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9826; val_auprc_score: 0.9779; val_best_acc_score: 0.9436; val_best_f1_score: 0.9453; train_kl_reg_loss: 3772.5893; train_edge_recon_loss: 27855.4052; train_gene_expr_recon_loss: 83615.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115243.8610; train_optim_loss: 115243.8610; val_kl_reg_loss: 3701.8057; val_edge_recon_loss: 28405.2338; val_gene_expr_recon_loss: 89531.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121638.8754; val_optim_loss: 121638.8754
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9831; val_auprc_score: 0.9790; val_best_acc_score: 0.9438; val_best_f1_score: 0.9453; train_kl_reg_loss: 3768.4309; train_edge_recon_loss: 27876.6566; train_gene_expr_recon_loss: 83599.3872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115244.4751; train_optim_loss: 115244.4751; val_kl_reg_loss: 3702.9883; val_edge_recon_loss: 28373.2437; val_gene_expr_recon_loss: 89442.1449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121518.3771; val_optim_loss: 121518.3771
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9830; val_auprc_score: 0.9786; val_best_acc_score: 0.9449; val_best_f1_score: 0.9464; train_kl_reg_loss: 3772.6203; train_edge_recon_loss: 27853.2658; train_gene_expr_recon_loss: 83568.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 115194.0897; train_optim_loss: 115194.0897; val_kl_reg_loss: 3701.4747; val_edge_recon_loss: 28363.2236; val_gene_expr_recon_loss: 89439.8395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121504.5380; val_optim_loss: 121504.5380

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 15 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9840
Val AUPRC score: 0.9802
Val best accuracy score: 0.9467
Val best F1 score: 0.9481
Val gene expr MSE score: 0.6847

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
