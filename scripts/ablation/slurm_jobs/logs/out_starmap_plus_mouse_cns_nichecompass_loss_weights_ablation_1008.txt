None
Run timestamp: 03072023_171838_1008.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1008']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9640; val_auprc_score: 0.9563; val_best_acc_score: 0.9048; val_best_f1_score: 0.9067; train_kl_reg_loss: 5473.1059; train_edge_recon_loss: 32033.2883; train_gene_expr_recon_loss: 123578.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161084.8639; train_optim_loss: 161084.8639; val_kl_reg_loss: 5359.3050; val_edge_recon_loss: 30707.0281; val_gene_expr_recon_loss: 109171.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145237.6648; val_optim_loss: 145237.6648
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9739; val_auprc_score: 0.9672; val_best_acc_score: 0.9261; val_best_f1_score: 0.9275; train_kl_reg_loss: 5065.4479; train_edge_recon_loss: 30285.0563; train_gene_expr_recon_loss: 107025.4536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142375.9573; train_optim_loss: 142375.9573; val_kl_reg_loss: 4533.0262; val_edge_recon_loss: 30183.0795; val_gene_expr_recon_loss: 104333.0181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139049.1229; val_optim_loss: 139049.1229
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9771; val_auprc_score: 0.9706; val_best_acc_score: 0.9333; val_best_f1_score: 0.9343; train_kl_reg_loss: 4452.8607; train_edge_recon_loss: 29902.0392; train_gene_expr_recon_loss: 103373.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137728.6724; train_optim_loss: 137728.6724; val_kl_reg_loss: 4197.8373; val_edge_recon_loss: 29821.4008; val_gene_expr_recon_loss: 101473.4748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135492.7131; val_optim_loss: 135492.7131
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9790; val_auprc_score: 0.9738; val_best_acc_score: 0.9365; val_best_f1_score: 0.9376; train_kl_reg_loss: 4174.0615; train_edge_recon_loss: 29625.1761; train_gene_expr_recon_loss: 100663.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134462.5296; train_optim_loss: 134462.5296; val_kl_reg_loss: 3951.1801; val_edge_recon_loss: 29690.8240; val_gene_expr_recon_loss: 99494.4190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133136.4219; val_optim_loss: 133136.4219
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9809; val_auprc_score: 0.9758; val_best_acc_score: 0.9394; val_best_f1_score: 0.9406; train_kl_reg_loss: 4054.9900; train_edge_recon_loss: 29353.2000; train_gene_expr_recon_loss: 98681.4345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132089.6246; train_optim_loss: 132089.6246; val_kl_reg_loss: 3889.4821; val_edge_recon_loss: 29341.6450; val_gene_expr_recon_loss: 98038.4915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131269.6183; val_optim_loss: 131269.6183
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9804; val_auprc_score: 0.9744; val_best_acc_score: 0.9404; val_best_f1_score: 0.9415; train_kl_reg_loss: 3986.3241; train_edge_recon_loss: 29176.6985; train_gene_expr_recon_loss: 97082.3767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130245.3997; train_optim_loss: 130245.3997; val_kl_reg_loss: 3884.4626; val_edge_recon_loss: 29266.5922; val_gene_expr_recon_loss: 96351.6903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129502.7450; val_optim_loss: 129502.7450
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9819; val_auprc_score: 0.9767; val_best_acc_score: 0.9433; val_best_f1_score: 0.9444; train_kl_reg_loss: 3944.6707; train_edge_recon_loss: 29055.1807; train_gene_expr_recon_loss: 95586.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128586.6208; train_optim_loss: 128586.6208; val_kl_reg_loss: 3794.8888; val_edge_recon_loss: 29165.6008; val_gene_expr_recon_loss: 95519.4780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128479.9677; val_optim_loss: 128479.9677
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9828; val_auprc_score: 0.9779; val_best_acc_score: 0.9444; val_best_f1_score: 0.9457; train_kl_reg_loss: 3934.9374; train_edge_recon_loss: 28918.6636; train_gene_expr_recon_loss: 94488.4278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127342.0292; train_optim_loss: 127342.0292; val_kl_reg_loss: 3803.7587; val_edge_recon_loss: 29012.3612; val_gene_expr_recon_loss: 94350.3487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127166.4702; val_optim_loss: 127166.4702
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9822; val_auprc_score: 0.9775; val_best_acc_score: 0.9431; val_best_f1_score: 0.9443; train_kl_reg_loss: 3933.2243; train_edge_recon_loss: 28806.1801; train_gene_expr_recon_loss: 93386.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126125.7817; train_optim_loss: 126125.7817; val_kl_reg_loss: 3820.4583; val_edge_recon_loss: 29034.5175; val_gene_expr_recon_loss: 93461.3597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126316.3363; val_optim_loss: 126316.3363
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9821; val_auprc_score: 0.9764; val_best_acc_score: 0.9443; val_best_f1_score: 0.9456; train_kl_reg_loss: 3934.4609; train_edge_recon_loss: 28712.2647; train_gene_expr_recon_loss: 92455.1750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125101.9008; train_optim_loss: 125101.9008; val_kl_reg_loss: 3836.2854; val_edge_recon_loss: 28905.0610; val_gene_expr_recon_loss: 93103.7876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125845.1339; val_optim_loss: 125845.1339
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9823; val_auprc_score: 0.9774; val_best_acc_score: 0.9423; val_best_f1_score: 0.9437; train_kl_reg_loss: 3942.6333; train_edge_recon_loss: 28638.3979; train_gene_expr_recon_loss: 91575.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124156.2387; train_optim_loss: 124156.2387; val_kl_reg_loss: 3826.9080; val_edge_recon_loss: 28977.9626; val_gene_expr_recon_loss: 92200.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125005.7599; val_optim_loss: 125005.7599
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9824; val_auprc_score: 0.9769; val_best_acc_score: 0.9430; val_best_f1_score: 0.9443; train_kl_reg_loss: 3947.8255; train_edge_recon_loss: 28559.2067; train_gene_expr_recon_loss: 90959.5049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123466.5371; train_optim_loss: 123466.5371; val_kl_reg_loss: 3853.9865; val_edge_recon_loss: 28887.8416; val_gene_expr_recon_loss: 91981.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124723.6243; val_optim_loss: 124723.6243
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9826; val_auprc_score: 0.9779; val_best_acc_score: 0.9441; val_best_f1_score: 0.9451; train_kl_reg_loss: 3945.6128; train_edge_recon_loss: 28507.6790; train_gene_expr_recon_loss: 90298.3231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122751.6150; train_optim_loss: 122751.6150; val_kl_reg_loss: 3856.2589; val_edge_recon_loss: 28837.4367; val_gene_expr_recon_loss: 91475.7113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124169.4073; val_optim_loss: 124169.4073
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9839; val_auprc_score: 0.9802; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 3946.3278; train_edge_recon_loss: 28448.7313; train_gene_expr_recon_loss: 89774.6568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122169.7157; train_optim_loss: 122169.7157; val_kl_reg_loss: 3884.9657; val_edge_recon_loss: 28837.1574; val_gene_expr_recon_loss: 91305.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124027.7976; val_optim_loss: 124027.7976
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9837; val_auprc_score: 0.9801; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 3948.3239; train_edge_recon_loss: 28408.7916; train_gene_expr_recon_loss: 89319.6469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121676.7625; train_optim_loss: 121676.7625; val_kl_reg_loss: 3838.0579; val_edge_recon_loss: 28785.9805; val_gene_expr_recon_loss: 90895.1378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123519.1758; val_optim_loss: 123519.1758
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9817; val_auprc_score: 0.9764; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 3952.7307; train_edge_recon_loss: 28354.0886; train_gene_expr_recon_loss: 88907.1421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121213.9617; train_optim_loss: 121213.9617; val_kl_reg_loss: 3814.5916; val_edge_recon_loss: 28768.5978; val_gene_expr_recon_loss: 90722.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123305.7624; val_optim_loss: 123305.7624
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9833; val_auprc_score: 0.9795; val_best_acc_score: 0.9426; val_best_f1_score: 0.9441; train_kl_reg_loss: 3951.6002; train_edge_recon_loss: 28313.9387; train_gene_expr_recon_loss: 88453.3682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120718.9071; train_optim_loss: 120718.9071; val_kl_reg_loss: 3862.9739; val_edge_recon_loss: 28698.5308; val_gene_expr_recon_loss: 90611.3033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123172.8086; val_optim_loss: 123172.8086
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9830; val_auprc_score: 0.9787; val_best_acc_score: 0.9433; val_best_f1_score: 0.9447; train_kl_reg_loss: 3950.4203; train_edge_recon_loss: 28296.6589; train_gene_expr_recon_loss: 88203.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120450.7720; train_optim_loss: 120450.7720; val_kl_reg_loss: 3858.0557; val_edge_recon_loss: 28724.6031; val_gene_expr_recon_loss: 90028.4268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122611.0856; val_optim_loss: 122611.0856
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9824; val_auprc_score: 0.9774; val_best_acc_score: 0.9424; val_best_f1_score: 0.9443; train_kl_reg_loss: 3952.8924; train_edge_recon_loss: 28253.9900; train_gene_expr_recon_loss: 87840.1213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120047.0034; train_optim_loss: 120047.0034; val_kl_reg_loss: 3853.5888; val_edge_recon_loss: 28688.2340; val_gene_expr_recon_loss: 90134.2081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122676.0305; val_optim_loss: 122676.0305
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9840; val_auprc_score: 0.9804; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 3951.2353; train_edge_recon_loss: 28225.3684; train_gene_expr_recon_loss: 87550.6173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119727.2208; train_optim_loss: 119727.2208; val_kl_reg_loss: 3916.2612; val_edge_recon_loss: 28699.5074; val_gene_expr_recon_loss: 89714.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122330.2234; val_optim_loss: 122330.2234
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9833; val_auprc_score: 0.9791; val_best_acc_score: 0.9431; val_best_f1_score: 0.9442; train_kl_reg_loss: 3951.6434; train_edge_recon_loss: 28211.1607; train_gene_expr_recon_loss: 87212.6077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119375.4117; train_optim_loss: 119375.4117; val_kl_reg_loss: 3836.1439; val_edge_recon_loss: 28679.7859; val_gene_expr_recon_loss: 89877.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122393.0511; val_optim_loss: 122393.0511
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9828; val_auprc_score: 0.9785; val_best_acc_score: 0.9422; val_best_f1_score: 0.9437; train_kl_reg_loss: 3960.1343; train_edge_recon_loss: 28151.5302; train_gene_expr_recon_loss: 87089.7541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119201.4185; train_optim_loss: 119201.4185; val_kl_reg_loss: 3826.7304; val_edge_recon_loss: 28676.4703; val_gene_expr_recon_loss: 89934.4382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122437.6392; val_optim_loss: 122437.6392
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9824; val_auprc_score: 0.9787; val_best_acc_score: 0.9412; val_best_f1_score: 0.9429; train_kl_reg_loss: 3956.9219; train_edge_recon_loss: 28147.4110; train_gene_expr_recon_loss: 86791.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118895.8157; train_optim_loss: 118895.8157; val_kl_reg_loss: 3849.7865; val_edge_recon_loss: 28658.6794; val_gene_expr_recon_loss: 89818.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122327.1143; val_optim_loss: 122327.1143
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9836; val_auprc_score: 0.9802; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 3962.5351; train_edge_recon_loss: 28111.2844; train_gene_expr_recon_loss: 86640.2603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118714.0800; train_optim_loss: 118714.0800; val_kl_reg_loss: 3886.8632; val_edge_recon_loss: 28609.3489; val_gene_expr_recon_loss: 89518.7837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122014.9954; val_optim_loss: 122014.9954
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9827; val_auprc_score: 0.9786; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 3965.7126; train_edge_recon_loss: 28078.2469; train_gene_expr_recon_loss: 86401.7522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118445.7118; train_optim_loss: 118445.7118; val_kl_reg_loss: 3896.5857; val_edge_recon_loss: 28601.0074; val_gene_expr_recon_loss: 89756.7550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122254.3484; val_optim_loss: 122254.3484
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9831; val_auprc_score: 0.9789; val_best_acc_score: 0.9435; val_best_f1_score: 0.9449; train_kl_reg_loss: 3961.6795; train_edge_recon_loss: 28080.2674; train_gene_expr_recon_loss: 86213.4119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118255.3587; train_optim_loss: 118255.3587; val_kl_reg_loss: 3906.7517; val_edge_recon_loss: 28580.5866; val_gene_expr_recon_loss: 89606.0593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122093.3974; val_optim_loss: 122093.3974
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9837; val_auprc_score: 0.9798; val_best_acc_score: 0.9442; val_best_f1_score: 0.9456; train_kl_reg_loss: 3971.1486; train_edge_recon_loss: 28035.9135; train_gene_expr_recon_loss: 86023.3308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118030.3931; train_optim_loss: 118030.3931; val_kl_reg_loss: 3882.9797; val_edge_recon_loss: 28511.8477; val_gene_expr_recon_loss: 89638.5813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122033.4077; val_optim_loss: 122033.4077
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9834; val_auprc_score: 0.9800; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 3970.7514; train_edge_recon_loss: 28019.8745; train_gene_expr_recon_loss: 85948.7839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117939.4098; train_optim_loss: 117939.4098; val_kl_reg_loss: 3891.0031; val_edge_recon_loss: 28558.5288; val_gene_expr_recon_loss: 89855.2006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122304.7326; val_optim_loss: 122304.7326

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9838; val_auprc_score: 0.9804; val_best_acc_score: 0.9439; val_best_f1_score: 0.9451; train_kl_reg_loss: 3935.6565; train_edge_recon_loss: 27955.9572; train_gene_expr_recon_loss: 85270.3076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117161.9213; train_optim_loss: 117161.9213; val_kl_reg_loss: 3845.8947; val_edge_recon_loss: 28507.4222; val_gene_expr_recon_loss: 89165.3452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121518.6623; val_optim_loss: 121518.6623
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9841; val_auprc_score: 0.9807; val_best_acc_score: 0.9442; val_best_f1_score: 0.9460; train_kl_reg_loss: 3926.4955; train_edge_recon_loss: 27964.6435; train_gene_expr_recon_loss: 85202.4893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117093.6282; train_optim_loss: 117093.6282; val_kl_reg_loss: 3841.6672; val_edge_recon_loss: 28468.7285; val_gene_expr_recon_loss: 89188.5504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121498.9464; val_optim_loss: 121498.9464
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9833; val_auprc_score: 0.9795; val_best_acc_score: 0.9435; val_best_f1_score: 0.9445; train_kl_reg_loss: 3921.7380; train_edge_recon_loss: 27956.6866; train_gene_expr_recon_loss: 85120.4822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116998.9067; train_optim_loss: 116998.9067; val_kl_reg_loss: 3837.7942; val_edge_recon_loss: 28481.7205; val_gene_expr_recon_loss: 89375.6257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121695.1410; val_optim_loss: 121695.1410
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9841; val_auprc_score: 0.9806; val_best_acc_score: 0.9443; val_best_f1_score: 0.9457; train_kl_reg_loss: 3921.6762; train_edge_recon_loss: 27962.4552; train_gene_expr_recon_loss: 85037.0915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116921.2230; train_optim_loss: 116921.2230; val_kl_reg_loss: 3835.1846; val_edge_recon_loss: 28505.4274; val_gene_expr_recon_loss: 89259.2653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121599.8764; val_optim_loss: 121599.8764
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9835; val_auprc_score: 0.9797; val_best_acc_score: 0.9424; val_best_f1_score: 0.9440; train_kl_reg_loss: 3922.5663; train_edge_recon_loss: 27935.7258; train_gene_expr_recon_loss: 85116.6436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116974.9356; train_optim_loss: 116974.9356; val_kl_reg_loss: 3845.8807; val_edge_recon_loss: 28543.3332; val_gene_expr_recon_loss: 89191.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121580.9158; val_optim_loss: 121580.9158
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9837; val_auprc_score: 0.9803; val_best_acc_score: 0.9432; val_best_f1_score: 0.9447; train_kl_reg_loss: 3923.4461; train_edge_recon_loss: 27935.1737; train_gene_expr_recon_loss: 85037.1634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116895.7836; train_optim_loss: 116895.7836; val_kl_reg_loss: 3828.3744; val_edge_recon_loss: 28519.5398; val_gene_expr_recon_loss: 89394.5497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121742.4638; val_optim_loss: 121742.4638

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9832; val_auprc_score: 0.9797; val_best_acc_score: 0.9419; val_best_f1_score: 0.9435; train_kl_reg_loss: 3917.5686; train_edge_recon_loss: 27941.2125; train_gene_expr_recon_loss: 84957.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116816.2427; train_optim_loss: 116816.2427; val_kl_reg_loss: 3831.6777; val_edge_recon_loss: 28561.0106; val_gene_expr_recon_loss: 89135.1342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121527.8228; val_optim_loss: 121527.8228
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9837; val_auprc_score: 0.9801; val_best_acc_score: 0.9435; val_best_f1_score: 0.9445; train_kl_reg_loss: 3916.8562; train_edge_recon_loss: 27939.4041; train_gene_expr_recon_loss: 84942.1444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116798.4049; train_optim_loss: 116798.4049; val_kl_reg_loss: 3828.6939; val_edge_recon_loss: 28496.4184; val_gene_expr_recon_loss: 89262.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121587.6928; val_optim_loss: 121587.6928
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9829; val_auprc_score: 0.9788; val_best_acc_score: 0.9425; val_best_f1_score: 0.9440; train_kl_reg_loss: 3916.8916; train_edge_recon_loss: 27927.2592; train_gene_expr_recon_loss: 84970.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116815.1058; train_optim_loss: 116815.1058; val_kl_reg_loss: 3831.0637; val_edge_recon_loss: 28501.2563; val_gene_expr_recon_loss: 89343.9084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121676.2290; val_optim_loss: 121676.2290
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9822; val_auprc_score: 0.9775; val_best_acc_score: 0.9412; val_best_f1_score: 0.9428; train_kl_reg_loss: 3914.1258; train_edge_recon_loss: 27941.3291; train_gene_expr_recon_loss: 84964.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116820.2538; train_optim_loss: 116820.2538; val_kl_reg_loss: 3829.8687; val_edge_recon_loss: 28531.4567; val_gene_expr_recon_loss: 89585.8402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121947.1655; val_optim_loss: 121947.1655

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 4 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9828
Val AUPRC score: 0.9793
Val best accuracy score: 0.9409
Val best F1 score: 0.9426
Val gene expr MSE score: 0.6715

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
