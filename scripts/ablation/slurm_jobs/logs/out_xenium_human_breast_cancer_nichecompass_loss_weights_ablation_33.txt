None
Run timestamp: 02072023_000537_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9461; val_auprc_score: 0.9297; val_best_acc_score: 0.8861; val_best_f1_score: 0.8924; train_kl_reg_loss: 6345.0858; train_edge_recon_loss: 271856.5440; train_gene_expr_recon_loss: 81907.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360109.2080; train_optim_loss: 360109.2080; val_kl_reg_loss: 5941.2240; val_edge_recon_loss: 269431.1883; val_gene_expr_recon_loss: 74883.0733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350255.4873; val_optim_loss: 350255.4873
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9597; val_auprc_score: 0.9476; val_best_acc_score: 0.9034; val_best_f1_score: 0.9077; train_kl_reg_loss: 5944.8165; train_edge_recon_loss: 264618.5628; train_gene_expr_recon_loss: 71885.4898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342448.8688; train_optim_loss: 342448.8688; val_kl_reg_loss: 5803.9303; val_edge_recon_loss: 268033.9223; val_gene_expr_recon_loss: 70258.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344096.3314; val_optim_loss: 344096.3314
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9655; val_auprc_score: 0.9569; val_best_acc_score: 0.9116; val_best_f1_score: 0.9148; train_kl_reg_loss: 5853.6279; train_edge_recon_loss: 263612.2092; train_gene_expr_recon_loss: 68675.5188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338141.3561; train_optim_loss: 338141.3561; val_kl_reg_loss: 5542.2772; val_edge_recon_loss: 268450.8269; val_gene_expr_recon_loss: 67542.6209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341535.7262; val_optim_loss: 341535.7262
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9676; val_auprc_score: 0.9595; val_best_acc_score: 0.9153; val_best_f1_score: 0.9185; train_kl_reg_loss: 5834.4447; train_edge_recon_loss: 262934.2221; train_gene_expr_recon_loss: 66569.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335338.0565; train_optim_loss: 335338.0565; val_kl_reg_loss: 5720.7567; val_edge_recon_loss: 267410.1174; val_gene_expr_recon_loss: 66115.5371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339246.4095; val_optim_loss: 339246.4095
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9699; val_auprc_score: 0.9615; val_best_acc_score: 0.9205; val_best_f1_score: 0.9233; train_kl_reg_loss: 5832.6822; train_edge_recon_loss: 262752.0123; train_gene_expr_recon_loss: 65180.0148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333764.7089; train_optim_loss: 333764.7089; val_kl_reg_loss: 5705.0532; val_edge_recon_loss: 266746.5471; val_gene_expr_recon_loss: 64718.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337169.8964; val_optim_loss: 337169.8964
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9638; val_best_acc_score: 0.9240; val_best_f1_score: 0.9267; train_kl_reg_loss: 5827.5712; train_edge_recon_loss: 262620.8318; train_gene_expr_recon_loss: 64186.2653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332634.6684; train_optim_loss: 332634.6684; val_kl_reg_loss: 5765.3009; val_edge_recon_loss: 266966.7070; val_gene_expr_recon_loss: 64050.7897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336782.7989; val_optim_loss: 336782.7989
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9736; val_auprc_score: 0.9668; val_best_acc_score: 0.9261; val_best_f1_score: 0.9283; train_kl_reg_loss: 5821.8395; train_edge_recon_loss: 262324.3383; train_gene_expr_recon_loss: 63487.4016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331633.5793; train_optim_loss: 331633.5793; val_kl_reg_loss: 5714.4856; val_edge_recon_loss: 266735.4811; val_gene_expr_recon_loss: 63460.0442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335910.0111; val_optim_loss: 335910.0111
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9745; val_auprc_score: 0.9676; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 5834.7801; train_edge_recon_loss: 262173.2307; train_gene_expr_recon_loss: 63001.9619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331009.9726; train_optim_loss: 331009.9726; val_kl_reg_loss: 5821.3107; val_edge_recon_loss: 266249.9433; val_gene_expr_recon_loss: 63011.9498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335083.2052; val_optim_loss: 335083.2052
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9737; val_auprc_score: 0.9665; val_best_acc_score: 0.9273; val_best_f1_score: 0.9294; train_kl_reg_loss: 5840.5700; train_edge_recon_loss: 261875.8748; train_gene_expr_recon_loss: 62595.6665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330312.1116; train_optim_loss: 330312.1116; val_kl_reg_loss: 5712.5992; val_edge_recon_loss: 266699.1569; val_gene_expr_recon_loss: 62705.4635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335117.2200; val_optim_loss: 335117.2200
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9755; val_auprc_score: 0.9692; val_best_acc_score: 0.9294; val_best_f1_score: 0.9313; train_kl_reg_loss: 5836.1417; train_edge_recon_loss: 262008.4991; train_gene_expr_recon_loss: 62259.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330104.0824; train_optim_loss: 330104.0824; val_kl_reg_loss: 5688.4467; val_edge_recon_loss: 266611.4831; val_gene_expr_recon_loss: 62419.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334719.1530; val_optim_loss: 334719.1530
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9748; val_auprc_score: 0.9679; val_best_acc_score: 0.9290; val_best_f1_score: 0.9311; train_kl_reg_loss: 5847.9301; train_edge_recon_loss: 261700.7760; train_gene_expr_recon_loss: 61999.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329547.8592; train_optim_loss: 329547.8592; val_kl_reg_loss: 5777.9021; val_edge_recon_loss: 266869.8734; val_gene_expr_recon_loss: 62147.8432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334795.6176; val_optim_loss: 334795.6176
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9772; val_auprc_score: 0.9710; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 5846.4071; train_edge_recon_loss: 261558.7043; train_gene_expr_recon_loss: 61816.2146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329221.3266; train_optim_loss: 329221.3266; val_kl_reg_loss: 5622.6561; val_edge_recon_loss: 266294.4394; val_gene_expr_recon_loss: 61936.5878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333853.6842; val_optim_loss: 333853.6842
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9761; val_auprc_score: 0.9695; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 5852.2912; train_edge_recon_loss: 261483.4221; train_gene_expr_recon_loss: 61599.1240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328934.8380; train_optim_loss: 328934.8380; val_kl_reg_loss: 5620.7260; val_edge_recon_loss: 266175.6739; val_gene_expr_recon_loss: 61879.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333675.6439; val_optim_loss: 333675.6439
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9769; val_auprc_score: 0.9708; val_best_acc_score: 0.9313; val_best_f1_score: 0.9331; train_kl_reg_loss: 5845.3263; train_edge_recon_loss: 261541.0890; train_gene_expr_recon_loss: 61451.2982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328837.7135; train_optim_loss: 328837.7135; val_kl_reg_loss: 5782.4193; val_edge_recon_loss: 265951.4665; val_gene_expr_recon_loss: 61610.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333344.1246; val_optim_loss: 333344.1246
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9767; val_auprc_score: 0.9703; val_best_acc_score: 0.9322; val_best_f1_score: 0.9336; train_kl_reg_loss: 5844.0827; train_edge_recon_loss: 261438.4920; train_gene_expr_recon_loss: 61345.9801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328628.5549; train_optim_loss: 328628.5549; val_kl_reg_loss: 5713.3866; val_edge_recon_loss: 265762.4681; val_gene_expr_recon_loss: 61545.8336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333021.6887; val_optim_loss: 333021.6887
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9341; val_best_f1_score: 0.9358; train_kl_reg_loss: 5845.5272; train_edge_recon_loss: 261355.9625; train_gene_expr_recon_loss: 61220.0443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328421.5348; train_optim_loss: 328421.5348; val_kl_reg_loss: 5713.7572; val_edge_recon_loss: 265921.3900; val_gene_expr_recon_loss: 61562.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333197.7274; val_optim_loss: 333197.7274
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9778; val_auprc_score: 0.9714; val_best_acc_score: 0.9352; val_best_f1_score: 0.9369; train_kl_reg_loss: 5851.2013; train_edge_recon_loss: 261418.4968; train_gene_expr_recon_loss: 61146.6479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328416.3458; train_optim_loss: 328416.3458; val_kl_reg_loss: 5673.0248; val_edge_recon_loss: 265629.7266; val_gene_expr_recon_loss: 61654.8061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332957.5580; val_optim_loss: 332957.5580
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9765; val_auprc_score: 0.9696; val_best_acc_score: 0.9337; val_best_f1_score: 0.9354; train_kl_reg_loss: 5851.2551; train_edge_recon_loss: 261205.8990; train_gene_expr_recon_loss: 61041.0945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328098.2492; train_optim_loss: 328098.2492; val_kl_reg_loss: 5821.8397; val_edge_recon_loss: 265870.0886; val_gene_expr_recon_loss: 61496.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333188.1324; val_optim_loss: 333188.1324
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9772; val_auprc_score: 0.9697; val_best_acc_score: 0.9338; val_best_f1_score: 0.9358; train_kl_reg_loss: 5858.4011; train_edge_recon_loss: 261089.3656; train_gene_expr_recon_loss: 60935.8185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327883.5849; train_optim_loss: 327883.5849; val_kl_reg_loss: 5761.0946; val_edge_recon_loss: 266051.7146; val_gene_expr_recon_loss: 61354.5321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333167.3413; val_optim_loss: 333167.3413
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9779; val_auprc_score: 0.9715; val_best_acc_score: 0.9356; val_best_f1_score: 0.9372; train_kl_reg_loss: 5851.8840; train_edge_recon_loss: 261140.4254; train_gene_expr_recon_loss: 60901.8604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327894.1696; train_optim_loss: 327894.1696; val_kl_reg_loss: 5769.9445; val_edge_recon_loss: 265952.8501; val_gene_expr_recon_loss: 61352.0936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333074.8894; val_optim_loss: 333074.8894
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9346; val_best_f1_score: 0.9362; train_kl_reg_loss: 5851.7845; train_edge_recon_loss: 261210.0969; train_gene_expr_recon_loss: 60843.1971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327905.0790; train_optim_loss: 327905.0790; val_kl_reg_loss: 5731.1635; val_edge_recon_loss: 266372.0674; val_gene_expr_recon_loss: 61365.6665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333468.8988; val_optim_loss: 333468.8988

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9787; val_auprc_score: 0.9729; val_best_acc_score: 0.9374; val_best_f1_score: 0.9387; train_kl_reg_loss: 5843.9582; train_edge_recon_loss: 260814.0350; train_gene_expr_recon_loss: 60461.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327119.5361; train_optim_loss: 327119.5361; val_kl_reg_loss: 5736.4812; val_edge_recon_loss: 265554.8941; val_gene_expr_recon_loss: 60896.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332187.5551; val_optim_loss: 332187.5551
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9793; val_auprc_score: 0.9737; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 5836.0532; train_edge_recon_loss: 260716.6310; train_gene_expr_recon_loss: 60386.5594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326939.2442; train_optim_loss: 326939.2442; val_kl_reg_loss: 5686.8175; val_edge_recon_loss: 265530.3242; val_gene_expr_recon_loss: 60899.6403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332116.7837; val_optim_loss: 332116.7837
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9792; val_auprc_score: 0.9728; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 5830.6889; train_edge_recon_loss: 260850.4956; train_gene_expr_recon_loss: 60338.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327019.9750; train_optim_loss: 327019.9750; val_kl_reg_loss: 5682.2644; val_edge_recon_loss: 265379.6275; val_gene_expr_recon_loss: 60842.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331904.4285; val_optim_loss: 331904.4285
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9788; val_auprc_score: 0.9726; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 5824.6545; train_edge_recon_loss: 260692.5810; train_gene_expr_recon_loss: 60319.3269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326836.5633; train_optim_loss: 326836.5633; val_kl_reg_loss: 5725.7763; val_edge_recon_loss: 265450.4141; val_gene_expr_recon_loss: 60727.3476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331903.5374; val_optim_loss: 331903.5374
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9791; val_auprc_score: 0.9734; val_best_acc_score: 0.9384; val_best_f1_score: 0.9397; train_kl_reg_loss: 5824.8708; train_edge_recon_loss: 260857.3747; train_gene_expr_recon_loss: 60333.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327015.7036; train_optim_loss: 327015.7036; val_kl_reg_loss: 5716.9247; val_edge_recon_loss: 265588.1484; val_gene_expr_recon_loss: 60895.0207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332200.0925; val_optim_loss: 332200.0925
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9800; val_auprc_score: 0.9746; val_best_acc_score: 0.9387; val_best_f1_score: 0.9403; train_kl_reg_loss: 5822.8689; train_edge_recon_loss: 260701.7013; train_gene_expr_recon_loss: 60294.3121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326818.8824; train_optim_loss: 326818.8824; val_kl_reg_loss: 5697.5278; val_edge_recon_loss: 265163.3333; val_gene_expr_recon_loss: 60783.1183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331643.9807; val_optim_loss: 331643.9807
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9804; val_auprc_score: 0.9754; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 5815.1721; train_edge_recon_loss: 260826.7291; train_gene_expr_recon_loss: 60313.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326955.6843; train_optim_loss: 326955.6843; val_kl_reg_loss: 5703.9831; val_edge_recon_loss: 265294.7527; val_gene_expr_recon_loss: 60711.4466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331710.1809; val_optim_loss: 331710.1809
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9791; val_auprc_score: 0.9732; val_best_acc_score: 0.9375; val_best_f1_score: 0.9389; train_kl_reg_loss: 5817.7014; train_edge_recon_loss: 260687.6770; train_gene_expr_recon_loss: 60249.9371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326755.3155; train_optim_loss: 326755.3155; val_kl_reg_loss: 5695.1953; val_edge_recon_loss: 265432.5286; val_gene_expr_recon_loss: 60695.1868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331822.9149; val_optim_loss: 331822.9149
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9800; val_auprc_score: 0.9748; val_best_acc_score: 0.9378; val_best_f1_score: 0.9393; train_kl_reg_loss: 5814.2333; train_edge_recon_loss: 260736.2152; train_gene_expr_recon_loss: 60276.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326826.5794; train_optim_loss: 326826.5794; val_kl_reg_loss: 5716.5465; val_edge_recon_loss: 265513.0265; val_gene_expr_recon_loss: 60762.2497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331991.8228; val_optim_loss: 331991.8228
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9801; val_auprc_score: 0.9746; val_best_acc_score: 0.9385; val_best_f1_score: 0.9400; train_kl_reg_loss: 5815.2784; train_edge_recon_loss: 260667.0365; train_gene_expr_recon_loss: 60305.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326787.5290; train_optim_loss: 326787.5290; val_kl_reg_loss: 5699.3500; val_edge_recon_loss: 265444.8933; val_gene_expr_recon_loss: 60798.4637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331942.7072; val_optim_loss: 331942.7072

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9806; val_auprc_score: 0.9756; val_best_acc_score: 0.9392; val_best_f1_score: 0.9408; train_kl_reg_loss: 5809.9940; train_edge_recon_loss: 260769.7793; train_gene_expr_recon_loss: 60209.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326789.3546; train_optim_loss: 326789.3546; val_kl_reg_loss: 5695.6216; val_edge_recon_loss: 265267.6205; val_gene_expr_recon_loss: 60699.2513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331662.4938; val_optim_loss: 331662.4938
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9799; val_auprc_score: 0.9744; val_best_acc_score: 0.9382; val_best_f1_score: 0.9399; train_kl_reg_loss: 5808.1434; train_edge_recon_loss: 260777.5176; train_gene_expr_recon_loss: 60197.3371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326782.9970; train_optim_loss: 326782.9970; val_kl_reg_loss: 5694.3584; val_edge_recon_loss: 265290.9077; val_gene_expr_recon_loss: 60627.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331612.3047; val_optim_loss: 331612.3047
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9802; val_auprc_score: 0.9749; val_best_acc_score: 0.9394; val_best_f1_score: 0.9408; train_kl_reg_loss: 5811.0925; train_edge_recon_loss: 260696.8548; train_gene_expr_recon_loss: 60184.4053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326692.3534; train_optim_loss: 326692.3534; val_kl_reg_loss: 5688.6553; val_edge_recon_loss: 265487.3211; val_gene_expr_recon_loss: 60772.4495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331948.4252; val_optim_loss: 331948.4252
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9803; val_auprc_score: 0.9749; val_best_acc_score: 0.9395; val_best_f1_score: 0.9410; train_kl_reg_loss: 5806.4613; train_edge_recon_loss: 260769.8024; train_gene_expr_recon_loss: 60182.7358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326758.9995; train_optim_loss: 326758.9995; val_kl_reg_loss: 5684.7422; val_edge_recon_loss: 265083.5697; val_gene_expr_recon_loss: 60572.5483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331340.8623; val_optim_loss: 331340.8623
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9793; val_auprc_score: 0.9738; val_best_acc_score: 0.9372; val_best_f1_score: 0.9389; train_kl_reg_loss: 5808.2425; train_edge_recon_loss: 260648.9202; train_gene_expr_recon_loss: 60188.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326646.0703; train_optim_loss: 326646.0703; val_kl_reg_loss: 5697.9253; val_edge_recon_loss: 265925.3988; val_gene_expr_recon_loss: 60705.4767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332328.8035; val_optim_loss: 332328.8035
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9801; val_auprc_score: 0.9749; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 5808.1037; train_edge_recon_loss: 260696.0162; train_gene_expr_recon_loss: 60173.8980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326678.0180; train_optim_loss: 326678.0180; val_kl_reg_loss: 5695.6673; val_edge_recon_loss: 265350.2377; val_gene_expr_recon_loss: 60604.0070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331649.9128; val_optim_loss: 331649.9128
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9805; val_auprc_score: 0.9752; val_best_acc_score: 0.9396; val_best_f1_score: 0.9411; train_kl_reg_loss: 5802.7310; train_edge_recon_loss: 260881.6521; train_gene_expr_recon_loss: 60186.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326870.9522; train_optim_loss: 326870.9522; val_kl_reg_loss: 5683.3474; val_edge_recon_loss: 265160.3141; val_gene_expr_recon_loss: 60684.6024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331528.2664; val_optim_loss: 331528.2664
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9801; val_auprc_score: 0.9751; val_best_acc_score: 0.9388; val_best_f1_score: 0.9403; train_kl_reg_loss: 5807.8749; train_edge_recon_loss: 260583.8725; train_gene_expr_recon_loss: 60177.1851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326568.9326; train_optim_loss: 326568.9326; val_kl_reg_loss: 5684.8374; val_edge_recon_loss: 265408.0319; val_gene_expr_recon_loss: 60664.6443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331757.5156; val_optim_loss: 331757.5156

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9794; val_auprc_score: 0.9731; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 5805.7590; train_edge_recon_loss: 260658.6964; train_gene_expr_recon_loss: 60169.3128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326633.7680; train_optim_loss: 326633.7680; val_kl_reg_loss: 5687.2099; val_edge_recon_loss: 265570.5403; val_gene_expr_recon_loss: 60735.5718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331993.3236; val_optim_loss: 331993.3236
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9803; val_auprc_score: 0.9747; val_best_acc_score: 0.9392; val_best_f1_score: 0.9404; train_kl_reg_loss: 5806.8609; train_edge_recon_loss: 260582.8183; train_gene_expr_recon_loss: 60162.3847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326552.0642; train_optim_loss: 326552.0642; val_kl_reg_loss: 5689.7332; val_edge_recon_loss: 265410.5576; val_gene_expr_recon_loss: 60531.7888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331632.0789; val_optim_loss: 331632.0789
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9800; val_auprc_score: 0.9749; val_best_acc_score: 0.9385; val_best_f1_score: 0.9403; train_kl_reg_loss: 5806.0617; train_edge_recon_loss: 260724.5443; train_gene_expr_recon_loss: 60206.9477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326737.5542; train_optim_loss: 326737.5542; val_kl_reg_loss: 5691.0992; val_edge_recon_loss: 265409.3028; val_gene_expr_recon_loss: 60748.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331849.1682; val_optim_loss: 331849.1682
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9800; val_auprc_score: 0.9739; val_best_acc_score: 0.9390; val_best_f1_score: 0.9406; train_kl_reg_loss: 5806.4206; train_edge_recon_loss: 260733.3410; train_gene_expr_recon_loss: 60189.1793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326728.9413; train_optim_loss: 326728.9413; val_kl_reg_loss: 5688.9246; val_edge_recon_loss: 265281.9661; val_gene_expr_recon_loss: 60682.2991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331653.1883; val_optim_loss: 331653.1883

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 67 min 38 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9796
Val AUPRC score: 0.9737
Val best accuracy score: 0.9381
Val best F1 score: 0.9398
Val gene expr MSE score: 1.4752

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
