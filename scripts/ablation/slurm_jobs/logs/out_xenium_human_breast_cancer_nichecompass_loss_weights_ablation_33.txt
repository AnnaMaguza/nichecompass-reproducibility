None
Run timestamp: 01072023_123540_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9469; val_auprc_score: 0.9313; val_best_acc_score: 0.8874; val_best_f1_score: 0.8937; train_kl_reg_loss: 6385.9556; train_edge_recon_loss: 271911.2601; train_gene_expr_recon_loss: 81610.0337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359907.2495; train_optim_loss: 359907.2495; val_kl_reg_loss: 6025.8020; val_edge_recon_loss: 269819.6719; val_gene_expr_recon_loss: 73695.2026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349540.6768; val_optim_loss: 349540.6768
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9610; val_auprc_score: 0.9501; val_best_acc_score: 0.9054; val_best_f1_score: 0.9098; train_kl_reg_loss: 6050.9265; train_edge_recon_loss: 264576.1118; train_gene_expr_recon_loss: 71702.1286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342329.1666; train_optim_loss: 342329.1666; val_kl_reg_loss: 5660.0984; val_edge_recon_loss: 268417.9663; val_gene_expr_recon_loss: 69989.5442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344067.6086; val_optim_loss: 344067.6086
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9667; val_auprc_score: 0.9573; val_best_acc_score: 0.9149; val_best_f1_score: 0.9181; train_kl_reg_loss: 5971.5433; train_edge_recon_loss: 263618.0136; train_gene_expr_recon_loss: 68685.3648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338274.9220; train_optim_loss: 338274.9220; val_kl_reg_loss: 5800.0425; val_edge_recon_loss: 267375.1770; val_gene_expr_recon_loss: 67313.5165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340488.7348; val_optim_loss: 340488.7348
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9700; val_auprc_score: 0.9629; val_best_acc_score: 0.9182; val_best_f1_score: 0.9210; train_kl_reg_loss: 5957.5971; train_edge_recon_loss: 262983.5764; train_gene_expr_recon_loss: 66744.4487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335685.6220; train_optim_loss: 335685.6220; val_kl_reg_loss: 5723.8658; val_edge_recon_loss: 267473.1382; val_gene_expr_recon_loss: 65566.3040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338763.3088; val_optim_loss: 338763.3088
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9707; val_auprc_score: 0.9624; val_best_acc_score: 0.9219; val_best_f1_score: 0.9245; train_kl_reg_loss: 5946.1457; train_edge_recon_loss: 262681.4758; train_gene_expr_recon_loss: 65448.5328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334076.1538; train_optim_loss: 334076.1538; val_kl_reg_loss: 5820.3363; val_edge_recon_loss: 267461.7179; val_gene_expr_recon_loss: 64747.8144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338029.8680; val_optim_loss: 338029.8680
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9735; val_auprc_score: 0.9670; val_best_acc_score: 0.9241; val_best_f1_score: 0.9265; train_kl_reg_loss: 5941.1088; train_edge_recon_loss: 262576.2839; train_gene_expr_recon_loss: 64547.9009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333065.2926; train_optim_loss: 333065.2926; val_kl_reg_loss: 5802.2745; val_edge_recon_loss: 267338.9747; val_gene_expr_recon_loss: 63707.8624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336849.1127; val_optim_loss: 336849.1127
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9741; val_auprc_score: 0.9677; val_best_acc_score: 0.9254; val_best_f1_score: 0.9280; train_kl_reg_loss: 5948.9072; train_edge_recon_loss: 262385.6154; train_gene_expr_recon_loss: 63889.8205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332224.3431; train_optim_loss: 332224.3431; val_kl_reg_loss: 5763.0934; val_edge_recon_loss: 267392.8705; val_gene_expr_recon_loss: 63265.3314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336421.2973; val_optim_loss: 336421.2973
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9746; val_auprc_score: 0.9681; val_best_acc_score: 0.9269; val_best_f1_score: 0.9292; train_kl_reg_loss: 5956.4452; train_edge_recon_loss: 262028.7765; train_gene_expr_recon_loss: 63425.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331410.5619; train_optim_loss: 331410.5619; val_kl_reg_loss: 5911.5389; val_edge_recon_loss: 266655.7749; val_gene_expr_recon_loss: 63119.0355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335686.3520; val_optim_loss: 335686.3520
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9766; val_auprc_score: 0.9705; val_best_acc_score: 0.9302; val_best_f1_score: 0.9322; train_kl_reg_loss: 5959.8888; train_edge_recon_loss: 261957.9918; train_gene_expr_recon_loss: 63015.3463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330933.2271; train_optim_loss: 330933.2271; val_kl_reg_loss: 5746.8354; val_edge_recon_loss: 266376.2430; val_gene_expr_recon_loss: 62605.3303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334728.4100; val_optim_loss: 334728.4100
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9752; val_auprc_score: 0.9684; val_best_acc_score: 0.9292; val_best_f1_score: 0.9317; train_kl_reg_loss: 5966.5304; train_edge_recon_loss: 261773.3908; train_gene_expr_recon_loss: 62719.8041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330459.7253; train_optim_loss: 330459.7253; val_kl_reg_loss: 5886.5591; val_edge_recon_loss: 266596.8078; val_gene_expr_recon_loss: 62352.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334836.2381; val_optim_loss: 334836.2381
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9774; val_auprc_score: 0.9718; val_best_acc_score: 0.9312; val_best_f1_score: 0.9329; train_kl_reg_loss: 5969.2025; train_edge_recon_loss: 261722.1892; train_gene_expr_recon_loss: 62462.7579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330154.1495; train_optim_loss: 330154.1495; val_kl_reg_loss: 5798.7975; val_edge_recon_loss: 266318.4593; val_gene_expr_recon_loss: 62094.2048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334211.4609; val_optim_loss: 334211.4609
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9770; val_auprc_score: 0.9706; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 5972.5941; train_edge_recon_loss: 261659.9842; train_gene_expr_recon_loss: 62295.9070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329928.4845; train_optim_loss: 329928.4845; val_kl_reg_loss: 5849.4619; val_edge_recon_loss: 266101.6417; val_gene_expr_recon_loss: 62064.6248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334015.7270; val_optim_loss: 334015.7270
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9771; val_auprc_score: 0.9701; val_best_acc_score: 0.9332; val_best_f1_score: 0.9348; train_kl_reg_loss: 5978.9226; train_edge_recon_loss: 261532.3453; train_gene_expr_recon_loss: 62099.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329611.0556; train_optim_loss: 329611.0556; val_kl_reg_loss: 5832.6256; val_edge_recon_loss: 266053.2486; val_gene_expr_recon_loss: 62068.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333954.6982; val_optim_loss: 333954.6982
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9777; val_auprc_score: 0.9715; val_best_acc_score: 0.9340; val_best_f1_score: 0.9357; train_kl_reg_loss: 5964.1680; train_edge_recon_loss: 261596.2401; train_gene_expr_recon_loss: 61988.2143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329548.6230; train_optim_loss: 329548.6230; val_kl_reg_loss: 5815.8360; val_edge_recon_loss: 266174.1421; val_gene_expr_recon_loss: 61842.8486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333832.8261; val_optim_loss: 333832.8261
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9778; val_auprc_score: 0.9714; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 5979.7186; train_edge_recon_loss: 261312.1935; train_gene_expr_recon_loss: 61842.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329134.4555; train_optim_loss: 329134.4555; val_kl_reg_loss: 5830.2256; val_edge_recon_loss: 266298.2714; val_gene_expr_recon_loss: 61416.7231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333545.2225; val_optim_loss: 333545.2225
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9781; val_auprc_score: 0.9723; val_best_acc_score: 0.9345; val_best_f1_score: 0.9359; train_kl_reg_loss: 5977.0212; train_edge_recon_loss: 261356.2401; train_gene_expr_recon_loss: 61756.4165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329089.6778; train_optim_loss: 329089.6778; val_kl_reg_loss: 5860.5814; val_edge_recon_loss: 266166.7560; val_gene_expr_recon_loss: 61487.9897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333515.3281; val_optim_loss: 333515.3281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9784; val_auprc_score: 0.9725; val_best_acc_score: 0.9345; val_best_f1_score: 0.9363; train_kl_reg_loss: 5987.8198; train_edge_recon_loss: 261212.3651; train_gene_expr_recon_loss: 61666.8745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328867.0596; train_optim_loss: 328867.0596; val_kl_reg_loss: 5880.6372; val_edge_recon_loss: 265429.6766; val_gene_expr_recon_loss: 61486.8059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332797.1188; val_optim_loss: 332797.1188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9788; val_auprc_score: 0.9728; val_best_acc_score: 0.9360; val_best_f1_score: 0.9375; train_kl_reg_loss: 5984.7947; train_edge_recon_loss: 261279.1828; train_gene_expr_recon_loss: 61603.6764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328867.6540; train_optim_loss: 328867.6540; val_kl_reg_loss: 5932.6937; val_edge_recon_loss: 265789.5929; val_gene_expr_recon_loss: 61475.4817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333197.7685; val_optim_loss: 333197.7685
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9783; val_auprc_score: 0.9717; val_best_acc_score: 0.9366; val_best_f1_score: 0.9380; train_kl_reg_loss: 5990.2172; train_edge_recon_loss: 261038.6945; train_gene_expr_recon_loss: 61506.3014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328535.2142; train_optim_loss: 328535.2142; val_kl_reg_loss: 5788.0073; val_edge_recon_loss: 265407.2116; val_gene_expr_recon_loss: 61182.7866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332378.0045; val_optim_loss: 332378.0045
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9783; val_auprc_score: 0.9725; val_best_acc_score: 0.9343; val_best_f1_score: 0.9358; train_kl_reg_loss: 5985.3666; train_edge_recon_loss: 261203.2699; train_gene_expr_recon_loss: 61458.5739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328647.2106; train_optim_loss: 328647.2106; val_kl_reg_loss: 5901.5106; val_edge_recon_loss: 266502.0629; val_gene_expr_recon_loss: 61418.3183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333821.8910; val_optim_loss: 333821.8910
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9789; val_auprc_score: 0.9729; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 5980.6571; train_edge_recon_loss: 261147.8577; train_gene_expr_recon_loss: 61353.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328481.5862; train_optim_loss: 328481.5862; val_kl_reg_loss: 5912.6411; val_edge_recon_loss: 265793.2708; val_gene_expr_recon_loss: 61263.1123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332969.0234; val_optim_loss: 332969.0234
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9794; val_auprc_score: 0.9736; val_best_acc_score: 0.9363; val_best_f1_score: 0.9384; train_kl_reg_loss: 5991.8416; train_edge_recon_loss: 261055.6080; train_gene_expr_recon_loss: 61336.2123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328383.6620; train_optim_loss: 328383.6620; val_kl_reg_loss: 5790.9718; val_edge_recon_loss: 265748.8008; val_gene_expr_recon_loss: 61172.5784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332712.3507; val_optim_loss: 332712.3507
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9787; val_auprc_score: 0.9727; val_best_acc_score: 0.9359; val_best_f1_score: 0.9376; train_kl_reg_loss: 5987.1677; train_edge_recon_loss: 261037.8871; train_gene_expr_recon_loss: 61276.8593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328301.9147; train_optim_loss: 328301.9147; val_kl_reg_loss: 5847.7199; val_edge_recon_loss: 266086.0056; val_gene_expr_recon_loss: 61147.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333081.2784; val_optim_loss: 333081.2784

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9799; val_auprc_score: 0.9741; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 5976.6884; train_edge_recon_loss: 260849.0185; train_gene_expr_recon_loss: 60836.0418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327661.7490; train_optim_loss: 327661.7490; val_kl_reg_loss: 5879.8089; val_edge_recon_loss: 265516.1194; val_gene_expr_recon_loss: 60745.0212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332140.9470; val_optim_loss: 332140.9470
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9806; val_auprc_score: 0.9755; val_best_acc_score: 0.9395; val_best_f1_score: 0.9409; train_kl_reg_loss: 5980.0031; train_edge_recon_loss: 260753.6549; train_gene_expr_recon_loss: 60765.2102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327498.8676; train_optim_loss: 327498.8676; val_kl_reg_loss: 5875.5279; val_edge_recon_loss: 265240.5826; val_gene_expr_recon_loss: 60728.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331844.4844; val_optim_loss: 331844.4844
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9800; val_auprc_score: 0.9743; val_best_acc_score: 0.9385; val_best_f1_score: 0.9401; train_kl_reg_loss: 5978.9890; train_edge_recon_loss: 260873.0063; train_gene_expr_recon_loss: 60744.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327596.9251; train_optim_loss: 327596.9251; val_kl_reg_loss: 5858.2006; val_edge_recon_loss: 265478.8150; val_gene_expr_recon_loss: 60753.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332090.4852; val_optim_loss: 332090.4852
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9813; val_auprc_score: 0.9766; val_best_acc_score: 0.9394; val_best_f1_score: 0.9408; train_kl_reg_loss: 5972.8166; train_edge_recon_loss: 260788.2088; train_gene_expr_recon_loss: 60726.7112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327487.7368; train_optim_loss: 327487.7368; val_kl_reg_loss: 5861.0289; val_edge_recon_loss: 265145.9718; val_gene_expr_recon_loss: 60660.5659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331667.5658; val_optim_loss: 331667.5658
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9802; val_auprc_score: 0.9748; val_best_acc_score: 0.9386; val_best_f1_score: 0.9403; train_kl_reg_loss: 5971.8358; train_edge_recon_loss: 260672.1128; train_gene_expr_recon_loss: 60697.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327341.7008; train_optim_loss: 327341.7008; val_kl_reg_loss: 5865.5990; val_edge_recon_loss: 265307.0078; val_gene_expr_recon_loss: 60765.8072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331938.4165; val_optim_loss: 331938.4165
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9809; val_auprc_score: 0.9757; val_best_acc_score: 0.9394; val_best_f1_score: 0.9408; train_kl_reg_loss: 5969.1337; train_edge_recon_loss: 260630.7942; train_gene_expr_recon_loss: 60734.0913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327334.0188; train_optim_loss: 327334.0188; val_kl_reg_loss: 5854.7892; val_edge_recon_loss: 265325.1086; val_gene_expr_recon_loss: 60546.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331725.9585; val_optim_loss: 331725.9585
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9800; val_auprc_score: 0.9743; val_best_acc_score: 0.9389; val_best_f1_score: 0.9406; train_kl_reg_loss: 5972.8455; train_edge_recon_loss: 260650.8272; train_gene_expr_recon_loss: 60707.6819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327331.3547; train_optim_loss: 327331.3547; val_kl_reg_loss: 5845.5861; val_edge_recon_loss: 265289.8501; val_gene_expr_recon_loss: 60639.4957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331774.9313; val_optim_loss: 331774.9313
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9807; val_auprc_score: 0.9749; val_best_acc_score: 0.9393; val_best_f1_score: 0.9408; train_kl_reg_loss: 5970.9626; train_edge_recon_loss: 260670.1828; train_gene_expr_recon_loss: 60648.8466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327289.9919; train_optim_loss: 327289.9919; val_kl_reg_loss: 5844.8078; val_edge_recon_loss: 265374.5074; val_gene_expr_recon_loss: 60650.2028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331869.5189; val_optim_loss: 331869.5189

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9806; val_auprc_score: 0.9753; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 5963.9822; train_edge_recon_loss: 260689.3314; train_gene_expr_recon_loss: 60596.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327249.5908; train_optim_loss: 327249.5908; val_kl_reg_loss: 5840.5702; val_edge_recon_loss: 265266.6994; val_gene_expr_recon_loss: 60569.9120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331677.1817; val_optim_loss: 331677.1817
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9811; val_auprc_score: 0.9759; val_best_acc_score: 0.9401; val_best_f1_score: 0.9416; train_kl_reg_loss: 5963.8860; train_edge_recon_loss: 260662.5457; train_gene_expr_recon_loss: 60613.1014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327239.5333; train_optim_loss: 327239.5333; val_kl_reg_loss: 5847.0201; val_edge_recon_loss: 264956.7222; val_gene_expr_recon_loss: 60582.8781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331386.6197; val_optim_loss: 331386.6197
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9805; val_auprc_score: 0.9755; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 5966.5183; train_edge_recon_loss: 260596.3589; train_gene_expr_recon_loss: 60594.7942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327157.6716; train_optim_loss: 327157.6716; val_kl_reg_loss: 5838.9872; val_edge_recon_loss: 265517.3298; val_gene_expr_recon_loss: 60479.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331835.4042; val_optim_loss: 331835.4042
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9810; val_auprc_score: 0.9753; val_best_acc_score: 0.9397; val_best_f1_score: 0.9413; train_kl_reg_loss: 5966.8678; train_edge_recon_loss: 260612.7937; train_gene_expr_recon_loss: 60604.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327183.7778; train_optim_loss: 327183.7778; val_kl_reg_loss: 5852.4025; val_edge_recon_loss: 265054.8651; val_gene_expr_recon_loss: 60583.0796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331490.3458; val_optim_loss: 331490.3458
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9809; val_auprc_score: 0.9753; val_best_acc_score: 0.9407; val_best_f1_score: 0.9421; train_kl_reg_loss: 5973.0293; train_edge_recon_loss: 260591.9127; train_gene_expr_recon_loss: 60582.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327147.4200; train_optim_loss: 327147.4200; val_kl_reg_loss: 5849.8900; val_edge_recon_loss: 264886.2599; val_gene_expr_recon_loss: 60549.7754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331285.9243; val_optim_loss: 331285.9243
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9813; val_auprc_score: 0.9756; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 5968.9940; train_edge_recon_loss: 260765.0112; train_gene_expr_recon_loss: 60591.2893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327325.2941; train_optim_loss: 327325.2941; val_kl_reg_loss: 5852.2921; val_edge_recon_loss: 264870.8982; val_gene_expr_recon_loss: 60539.6165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331262.8076; val_optim_loss: 331262.8076
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9804; val_auprc_score: 0.9748; val_best_acc_score: 0.9397; val_best_f1_score: 0.9412; train_kl_reg_loss: 5965.4564; train_edge_recon_loss: 260679.9272; train_gene_expr_recon_loss: 60584.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327229.4234; train_optim_loss: 327229.4234; val_kl_reg_loss: 5847.3622; val_edge_recon_loss: 265298.5886; val_gene_expr_recon_loss: 60537.4354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331683.3869; val_optim_loss: 331683.3869
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9805; val_auprc_score: 0.9747; val_best_acc_score: 0.9401; val_best_f1_score: 0.9411; train_kl_reg_loss: 5963.8141; train_edge_recon_loss: 260647.2394; train_gene_expr_recon_loss: 60562.4264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327173.4795; train_optim_loss: 327173.4795; val_kl_reg_loss: 5832.6231; val_edge_recon_loss: 264973.2317; val_gene_expr_recon_loss: 60683.5214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331489.3750; val_optim_loss: 331489.3750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9806; val_auprc_score: 0.9752; val_best_acc_score: 0.9390; val_best_f1_score: 0.9405; train_kl_reg_loss: 5966.8374; train_edge_recon_loss: 260568.8336; train_gene_expr_recon_loss: 60572.8191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327108.4909; train_optim_loss: 327108.4909; val_kl_reg_loss: 5849.6912; val_edge_recon_loss: 265581.0837; val_gene_expr_recon_loss: 60618.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332049.1768; val_optim_loss: 332049.1768
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9807; val_auprc_score: 0.9757; val_best_acc_score: 0.9387; val_best_f1_score: 0.9403; train_kl_reg_loss: 5961.4035; train_edge_recon_loss: 260683.9347; train_gene_expr_recon_loss: 60581.3004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327226.6386; train_optim_loss: 327226.6386; val_kl_reg_loss: 5835.8328; val_edge_recon_loss: 265614.0212; val_gene_expr_recon_loss: 60481.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331931.6188; val_optim_loss: 331931.6188

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9811; val_auprc_score: 0.9761; val_best_acc_score: 0.9404; val_best_f1_score: 0.9418; train_kl_reg_loss: 5960.6871; train_edge_recon_loss: 260526.3173; train_gene_expr_recon_loss: 60591.4267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327078.4320; train_optim_loss: 327078.4320; val_kl_reg_loss: 5843.1903; val_edge_recon_loss: 264759.4028; val_gene_expr_recon_loss: 60627.7579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331230.3512; val_optim_loss: 331230.3512
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9805; val_auprc_score: 0.9750; val_best_acc_score: 0.9397; val_best_f1_score: 0.9412; train_kl_reg_loss: 5963.3241; train_edge_recon_loss: 260656.5092; train_gene_expr_recon_loss: 60591.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327211.6598; train_optim_loss: 327211.6598; val_kl_reg_loss: 5844.9699; val_edge_recon_loss: 265219.5436; val_gene_expr_recon_loss: 60474.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331538.9708; val_optim_loss: 331538.9708
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9800; val_auprc_score: 0.9745; val_best_acc_score: 0.9383; val_best_f1_score: 0.9397; train_kl_reg_loss: 5962.3081; train_edge_recon_loss: 260677.3757; train_gene_expr_recon_loss: 60585.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327224.8059; train_optim_loss: 327224.8059; val_kl_reg_loss: 5845.8958; val_edge_recon_loss: 265861.2249; val_gene_expr_recon_loss: 60681.2624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332388.3812; val_optim_loss: 332388.3812
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9805; val_auprc_score: 0.9752; val_best_acc_score: 0.9389; val_best_f1_score: 0.9403; train_kl_reg_loss: 5962.5295; train_edge_recon_loss: 260744.4460; train_gene_expr_recon_loss: 60559.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327266.6045; train_optim_loss: 327266.6045; val_kl_reg_loss: 5843.0171; val_edge_recon_loss: 265468.8569; val_gene_expr_recon_loss: 60505.3569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331817.2303; val_optim_loss: 331817.2303
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9805; val_auprc_score: 0.9754; val_best_acc_score: 0.9387; val_best_f1_score: 0.9402; train_kl_reg_loss: 5961.5521; train_edge_recon_loss: 260732.0245; train_gene_expr_recon_loss: 60589.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327283.2517; train_optim_loss: 327283.2517; val_kl_reg_loss: 5842.5792; val_edge_recon_loss: 265724.2013; val_gene_expr_recon_loss: 60646.7893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332213.5687; val_optim_loss: 332213.5687

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9816; val_auprc_score: 0.9769; val_best_acc_score: 0.9402; val_best_f1_score: 0.9416; train_kl_reg_loss: 5962.0702; train_edge_recon_loss: 260712.0000; train_gene_expr_recon_loss: 60580.0377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327254.1085; train_optim_loss: 327254.1085; val_kl_reg_loss: 5841.5109; val_edge_recon_loss: 265114.8530; val_gene_expr_recon_loss: 60448.2270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331404.5892; val_optim_loss: 331404.5892
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9805; val_auprc_score: 0.9748; val_best_acc_score: 0.9391; val_best_f1_score: 0.9406; train_kl_reg_loss: 5962.6738; train_edge_recon_loss: 260619.8515; train_gene_expr_recon_loss: 60568.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327151.0426; train_optim_loss: 327151.0426; val_kl_reg_loss: 5844.1246; val_edge_recon_loss: 265460.3988; val_gene_expr_recon_loss: 60636.3728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331940.8956; val_optim_loss: 331940.8956
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9811; val_auprc_score: 0.9758; val_best_acc_score: 0.9402; val_best_f1_score: 0.9416; train_kl_reg_loss: 5962.6559; train_edge_recon_loss: 260727.2585; train_gene_expr_recon_loss: 60597.6246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327287.5392; train_optim_loss: 327287.5392; val_kl_reg_loss: 5843.4076; val_edge_recon_loss: 265339.3074; val_gene_expr_recon_loss: 60596.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331779.1484; val_optim_loss: 331779.1484
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9803; val_auprc_score: 0.9747; val_best_acc_score: 0.9394; val_best_f1_score: 0.9409; train_kl_reg_loss: 5963.3855; train_edge_recon_loss: 260646.6968; train_gene_expr_recon_loss: 60575.6715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327185.7546; train_optim_loss: 327185.7546; val_kl_reg_loss: 5845.2149; val_edge_recon_loss: 265538.0255; val_gene_expr_recon_loss: 60475.1653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331858.4079; val_optim_loss: 331858.4079

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 85 min 59 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9814
Val AUPRC score: 0.9761
Val best accuracy score: 0.9415
Val best F1 score: 0.9428
Val gene expr MSE score: 1.4260

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
