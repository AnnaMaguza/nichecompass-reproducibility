None
Run timestamp: 17072023_214157_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9946; val_auprc_score: 0.9942; val_best_acc_score: 0.9648; val_best_f1_score: 0.9649; train_kl_reg_loss: 15002.6146; train_edge_recon_loss: 26369109.0323; train_gene_expr_recon_loss: 21454643.4564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47838755.1027; train_optim_loss: 47838755.1027; val_kl_reg_loss: 16304.1716; val_edge_recon_loss: 26145162.9684; val_gene_expr_recon_loss: 20501731.4557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46663198.4430; val_optim_loss: 46663198.4430
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9954; val_auprc_score: 0.9950; val_best_acc_score: 0.9683; val_best_f1_score: 0.9684; train_kl_reg_loss: 17042.8801; train_edge_recon_loss: 25946462.1596; train_gene_expr_recon_loss: 20306645.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46270150.0380; train_optim_loss: 46270150.0380; val_kl_reg_loss: 16922.0849; val_edge_recon_loss: 26072652.6646; val_gene_expr_recon_loss: 20247694.6456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46337269.4051; val_optim_loss: 46337269.4051
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9951; val_best_acc_score: 0.9707; val_best_f1_score: 0.9709; train_kl_reg_loss: 17916.1454; train_edge_recon_loss: 25885152.7961; train_gene_expr_recon_loss: 20097766.0499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46000834.9958; train_optim_loss: 46000834.9958; val_kl_reg_loss: 18079.3030; val_edge_recon_loss: 26017866.4937; val_gene_expr_recon_loss: 20071406.7089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46107352.3671; val_optim_loss: 46107352.3671
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 18193.9352; train_edge_recon_loss: 25847016.3179; train_gene_expr_recon_loss: 20026393.8249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45891604.0127; train_optim_loss: 45891604.0127; val_kl_reg_loss: 17914.5071; val_edge_recon_loss: 25974012.1962; val_gene_expr_recon_loss: 20042776.7722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46034703.3038; val_optim_loss: 46034703.3038
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 18268.0353; train_edge_recon_loss: 25828304.8685; train_gene_expr_recon_loss: 19991082.5302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45837655.4248; train_optim_loss: 45837655.4248; val_kl_reg_loss: 18291.6325; val_edge_recon_loss: 25945920.4937; val_gene_expr_recon_loss: 19991262.8797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45955475.0380; val_optim_loss: 45955475.0380
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 18250.7189; train_edge_recon_loss: 25809206.9803; train_gene_expr_recon_loss: 19966927.1723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45794384.9142; train_optim_loss: 45794384.9142; val_kl_reg_loss: 17918.4638; val_edge_recon_loss: 25920319.0633; val_gene_expr_recon_loss: 19962264.6013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45900502.0886; val_optim_loss: 45900502.0886
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9757; val_best_f1_score: 0.9757; train_kl_reg_loss: 18193.2239; train_edge_recon_loss: 25795700.3762; train_gene_expr_recon_loss: 19949902.0717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45763795.6934; train_optim_loss: 45763795.6934; val_kl_reg_loss: 18224.2581; val_edge_recon_loss: 25915017.8734; val_gene_expr_recon_loss: 19957181.7025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45890423.7722; val_optim_loss: 45890423.7722
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 18153.1327; train_edge_recon_loss: 25777552.2841; train_gene_expr_recon_loss: 19941513.1336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45737218.5640; train_optim_loss: 45737218.5640; val_kl_reg_loss: 18772.6022; val_edge_recon_loss: 25901191.4810; val_gene_expr_recon_loss: 19968116.1456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45888080.1519; val_optim_loss: 45888080.1519
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 18113.6190; train_edge_recon_loss: 25775421.3376; train_gene_expr_recon_loss: 19935988.2932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45729523.2883; train_optim_loss: 45729523.2883; val_kl_reg_loss: 17484.7417; val_edge_recon_loss: 25896411.8734; val_gene_expr_recon_loss: 20028413.8038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45942310.3797; val_optim_loss: 45942310.3797
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 18042.8985; train_edge_recon_loss: 25761558.1301; train_gene_expr_recon_loss: 19922425.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45702026.4107; train_optim_loss: 45702026.4107; val_kl_reg_loss: 17382.2371; val_edge_recon_loss: 25911483.1203; val_gene_expr_recon_loss: 19970434.4367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45899299.8228; val_optim_loss: 45899299.8228
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 17970.7337; train_edge_recon_loss: 25756047.1519; train_gene_expr_recon_loss: 19915390.1118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45689407.9972; train_optim_loss: 45689407.9972; val_kl_reg_loss: 18422.8776; val_edge_recon_loss: 25909727.1329; val_gene_expr_recon_loss: 19942948.3987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45871098.3544; val_optim_loss: 45871098.3544
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 17913.6730; train_edge_recon_loss: 25753377.4515; train_gene_expr_recon_loss: 19914656.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45685947.7904; train_optim_loss: 45685947.7904; val_kl_reg_loss: 17519.0023; val_edge_recon_loss: 25859618.0696; val_gene_expr_recon_loss: 19946424.1582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45823561.1899; val_optim_loss: 45823561.1899
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 17867.6243; train_edge_recon_loss: 25740553.0331; train_gene_expr_recon_loss: 19907192.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45665613.0028; train_optim_loss: 45665613.0028; val_kl_reg_loss: 17809.5347; val_edge_recon_loss: 25857946.1709; val_gene_expr_recon_loss: 19961518.1772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45837273.8481; val_optim_loss: 45837273.8481
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 17799.2212; train_edge_recon_loss: 25739950.8059; train_gene_expr_recon_loss: 19899350.5316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45657100.5781; train_optim_loss: 45657100.5781; val_kl_reg_loss: 18056.3697; val_edge_recon_loss: 25857024.1519; val_gene_expr_recon_loss: 19952045.1456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45827125.7342; val_optim_loss: 45827125.7342
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 17733.9277; train_edge_recon_loss: 25730173.1329; train_gene_expr_recon_loss: 19889607.1716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45637514.2391; train_optim_loss: 45637514.2391; val_kl_reg_loss: 17793.8966; val_edge_recon_loss: 25828683.2215; val_gene_expr_recon_loss: 19930587.7278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45777064.7848; val_optim_loss: 45777064.7848
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 17683.2875; train_edge_recon_loss: 25730731.3994; train_gene_expr_recon_loss: 19890882.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45639297.1097; train_optim_loss: 45639297.1097; val_kl_reg_loss: 17586.7585; val_edge_recon_loss: 25844917.9937; val_gene_expr_recon_loss: 19957270.8165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45819775.6962; val_optim_loss: 45819775.6962
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 17649.3837; train_edge_recon_loss: 25725041.4740; train_gene_expr_recon_loss: 19887803.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45630494.0042; train_optim_loss: 45630494.0042; val_kl_reg_loss: 17803.8775; val_edge_recon_loss: 25835638.7848; val_gene_expr_recon_loss: 19926509.0759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45779951.7342; val_optim_loss: 45779951.7342
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 17566.3802; train_edge_recon_loss: 25720420.0394; train_gene_expr_recon_loss: 19885646.9641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45623633.4205; train_optim_loss: 45623633.4205; val_kl_reg_loss: 17113.1201; val_edge_recon_loss: 25829373.6456; val_gene_expr_recon_loss: 19926197.8291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45772684.6962; val_optim_loss: 45772684.6962
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 17532.5025; train_edge_recon_loss: 25717876.3903; train_gene_expr_recon_loss: 19879348.4747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45614757.3347; train_optim_loss: 45614757.3347; val_kl_reg_loss: 17533.7490; val_edge_recon_loss: 25832703.4367; val_gene_expr_recon_loss: 19933561.6329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45783798.7468; val_optim_loss: 45783798.7468
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 17495.1808; train_edge_recon_loss: 25714097.3875; train_gene_expr_recon_loss: 19877701.7335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45609294.2954; train_optim_loss: 45609294.2954; val_kl_reg_loss: 17422.9795; val_edge_recon_loss: 25803920.3101; val_gene_expr_recon_loss: 19917307.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45738650.5823; val_optim_loss: 45738650.5823
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 17472.0050; train_edge_recon_loss: 25711121.0823; train_gene_expr_recon_loss: 19869004.9740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45597598.0534; train_optim_loss: 45597598.0534; val_kl_reg_loss: 17492.3707; val_edge_recon_loss: 25808392.7911; val_gene_expr_recon_loss: 19923209.4747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45749094.6329; val_optim_loss: 45749094.6329
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 17409.2446; train_edge_recon_loss: 25700565.8340; train_gene_expr_recon_loss: 19869732.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45587707.2630; train_optim_loss: 45587707.2630; val_kl_reg_loss: 17543.8129; val_edge_recon_loss: 25825886.5063; val_gene_expr_recon_loss: 19935727.9367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45779158.2152; val_optim_loss: 45779158.2152
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9806; val_best_f1_score: 0.9806; train_kl_reg_loss: 17384.7308; train_edge_recon_loss: 25706567.5717; train_gene_expr_recon_loss: 19864734.4522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45588686.7637; train_optim_loss: 45588686.7637; val_kl_reg_loss: 17549.5478; val_edge_recon_loss: 25784238.2785; val_gene_expr_recon_loss: 19949598.8418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45751386.7595; val_optim_loss: 45751386.7595
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 17345.7773; train_edge_recon_loss: 25703689.2757; train_gene_expr_recon_loss: 19871628.0436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45592663.1406; train_optim_loss: 45592663.1406; val_kl_reg_loss: 16792.2925; val_edge_recon_loss: 25832302.7595; val_gene_expr_recon_loss: 19981213.9747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45830309.0886; val_optim_loss: 45830309.0886

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 18848.1561; train_edge_recon_loss: 25663451.2996; train_gene_expr_recon_loss: 19712242.3453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45394541.8158; train_optim_loss: 45394541.8158; val_kl_reg_loss: 17979.1803; val_edge_recon_loss: 25766959.8987; val_gene_expr_recon_loss: 19775826.3354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45560765.3671; val_optim_loss: 45560765.3671
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 17696.5818; train_edge_recon_loss: 25653833.3945; train_gene_expr_recon_loss: 19681076.7342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45352606.7201; train_optim_loss: 45352606.7201; val_kl_reg_loss: 17274.7612; val_edge_recon_loss: 25738884.4177; val_gene_expr_recon_loss: 19760102.2658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45516261.4051; val_optim_loss: 45516261.4051
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 17310.9445; train_edge_recon_loss: 25654971.5246; train_gene_expr_recon_loss: 19674350.2314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45346632.6596; train_optim_loss: 45346632.6596; val_kl_reg_loss: 17045.4951; val_edge_recon_loss: 25741973.1203; val_gene_expr_recon_loss: 19748546.8165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45507565.4304; val_optim_loss: 45507565.4304
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 17134.4477; train_edge_recon_loss: 25649074.2075; train_gene_expr_recon_loss: 19664546.1997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45330754.8734; train_optim_loss: 45330754.8734; val_kl_reg_loss: 16979.0147; val_edge_recon_loss: 25752084.3038; val_gene_expr_recon_loss: 19733057.9114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45502121.2658; val_optim_loss: 45502121.2658
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 17015.6701; train_edge_recon_loss: 25643832.8776; train_gene_expr_recon_loss: 19652863.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45313712.5021; train_optim_loss: 45313712.5021; val_kl_reg_loss: 16897.2245; val_edge_recon_loss: 25754031.1962; val_gene_expr_recon_loss: 19737326.9747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45508255.2152; val_optim_loss: 45508255.2152
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 16947.2625; train_edge_recon_loss: 25646497.0865; train_gene_expr_recon_loss: 19650055.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45313499.4008; train_optim_loss: 45313499.4008; val_kl_reg_loss: 16911.2960; val_edge_recon_loss: 25740607.6772; val_gene_expr_recon_loss: 19739964.4747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45497483.5696; val_optim_loss: 45497483.5696
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 16903.9603; train_edge_recon_loss: 25646029.7068; train_gene_expr_recon_loss: 19644575.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45307509.2996; train_optim_loss: 45307509.2996; val_kl_reg_loss: 16828.6526; val_edge_recon_loss: 25753312.1013; val_gene_expr_recon_loss: 19719957.9367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45490098.7089; val_optim_loss: 45490098.7089
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 16865.6981; train_edge_recon_loss: 25647150.2743; train_gene_expr_recon_loss: 19645397.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45309413.7961; train_optim_loss: 45309413.7961; val_kl_reg_loss: 16823.8632; val_edge_recon_loss: 25746661.1013; val_gene_expr_recon_loss: 19727518.5759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45491003.5570; val_optim_loss: 45491003.5570
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 16821.8035; train_edge_recon_loss: 25648483.3031; train_gene_expr_recon_loss: 19637227.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45302532.5767; train_optim_loss: 45302532.5767; val_kl_reg_loss: 16664.2154; val_edge_recon_loss: 25754831.5633; val_gene_expr_recon_loss: 19728593.8481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45500089.6835; val_optim_loss: 45500089.6835
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 16796.1644; train_edge_recon_loss: 25639266.0745; train_gene_expr_recon_loss: 19636459.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45292522.1308; train_optim_loss: 45292522.1308; val_kl_reg_loss: 16608.4365; val_edge_recon_loss: 25752227.9114; val_gene_expr_recon_loss: 19715954.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45484790.9241; val_optim_loss: 45484790.9241
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 16774.9824; train_edge_recon_loss: 25638085.3931; train_gene_expr_recon_loss: 19635681.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45290542.0239; train_optim_loss: 45290542.0239; val_kl_reg_loss: 16689.4990; val_edge_recon_loss: 25723282.3354; val_gene_expr_recon_loss: 19726932.9051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45466904.6076; val_optim_loss: 45466904.6076
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 16762.2453; train_edge_recon_loss: 25643362.7714; train_gene_expr_recon_loss: 19632316.5316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45292441.5499; train_optim_loss: 45292441.5499; val_kl_reg_loss: 16601.4744; val_edge_recon_loss: 25739858.5633; val_gene_expr_recon_loss: 19702673.8038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45459133.8354; val_optim_loss: 45459133.8354
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 16744.8081; train_edge_recon_loss: 25639164.9423; train_gene_expr_recon_loss: 19629097.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45285007.6414; train_optim_loss: 45285007.6414; val_kl_reg_loss: 16763.2711; val_edge_recon_loss: 25753105.5000; val_gene_expr_recon_loss: 19737283.8291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45507152.6962; val_optim_loss: 45507152.6962
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 16729.3552; train_edge_recon_loss: 25637964.1709; train_gene_expr_recon_loss: 19626564.7574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45281258.2925; train_optim_loss: 45281258.2925; val_kl_reg_loss: 16712.9168; val_edge_recon_loss: 25731102.0759; val_gene_expr_recon_loss: 19712298.6013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45460113.6709; val_optim_loss: 45460113.6709
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 16732.6364; train_edge_recon_loss: 25637139.8165; train_gene_expr_recon_loss: 19623708.8622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45277581.3685; train_optim_loss: 45277581.3685; val_kl_reg_loss: 16531.7189; val_edge_recon_loss: 25741198.8354; val_gene_expr_recon_loss: 19705783.2089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45463513.7722; val_optim_loss: 45463513.7722
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 16712.7539; train_edge_recon_loss: 25642513.6442; train_gene_expr_recon_loss: 19627556.9719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45286783.3376; train_optim_loss: 45286783.3376; val_kl_reg_loss: 16551.2028; val_edge_recon_loss: 25736575.2785; val_gene_expr_recon_loss: 19725207.6962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45478334.2025; val_optim_loss: 45478334.2025

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 16916.1528; train_edge_recon_loss: 25634776.9079; train_gene_expr_recon_loss: 19599430.2293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45251123.2546; train_optim_loss: 45251123.2546; val_kl_reg_loss: 16806.0629; val_edge_recon_loss: 25728120.6266; val_gene_expr_recon_loss: 19707807.4114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45452734.0633; val_optim_loss: 45452734.0633
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 16956.0865; train_edge_recon_loss: 25632766.9916; train_gene_expr_recon_loss: 19593672.4620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45243395.5246; train_optim_loss: 45243395.5246; val_kl_reg_loss: 16788.1182; val_edge_recon_loss: 25724993.7722; val_gene_expr_recon_loss: 19693854.7658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45435636.5316; val_optim_loss: 45435636.5316
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 16924.9581; train_edge_recon_loss: 25633106.2855; train_gene_expr_recon_loss: 19592917.8129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45242949.0281; train_optim_loss: 45242949.0281; val_kl_reg_loss: 16758.1676; val_edge_recon_loss: 25722566.9494; val_gene_expr_recon_loss: 19685247.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45424572.5570; val_optim_loss: 45424572.5570
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 16896.3072; train_edge_recon_loss: 25628793.1006; train_gene_expr_recon_loss: 19591631.0288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45237320.4023; train_optim_loss: 45237320.4023; val_kl_reg_loss: 16743.6310; val_edge_recon_loss: 25722621.4367; val_gene_expr_recon_loss: 19694693.4114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45434058.3038; val_optim_loss: 45434058.3038
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 16862.6144; train_edge_recon_loss: 25633266.5809; train_gene_expr_recon_loss: 19593650.7482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45243779.9677; train_optim_loss: 45243779.9677; val_kl_reg_loss: 16716.8711; val_edge_recon_loss: 25758432.5633; val_gene_expr_recon_loss: 19696958.6013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45472108.0759; val_optim_loss: 45472108.0759
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 16827.1573; train_edge_recon_loss: 25631092.4290; train_gene_expr_recon_loss: 19592830.0731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45240749.6568; train_optim_loss: 45240749.6568; val_kl_reg_loss: 16682.1286; val_edge_recon_loss: 25741259.6899; val_gene_expr_recon_loss: 19680194.7278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45438136.5570; val_optim_loss: 45438136.5570
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9818; val_best_f1_score: 0.9818; train_kl_reg_loss: 16812.7923; train_edge_recon_loss: 25636444.7307; train_gene_expr_recon_loss: 19589648.8917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45242906.4402; train_optim_loss: 45242906.4402; val_kl_reg_loss: 16680.4111; val_edge_recon_loss: 25728499.5506; val_gene_expr_recon_loss: 19689576.1392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45434756.2025; val_optim_loss: 45434756.2025

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 16801.2846; train_edge_recon_loss: 25635886.7686; train_gene_expr_recon_loss: 19587372.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45240060.7806; train_optim_loss: 45240060.7806; val_kl_reg_loss: 16662.6503; val_edge_recon_loss: 25742903.5949; val_gene_expr_recon_loss: 19682309.5316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45441875.7848; val_optim_loss: 45441875.7848
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 16813.4325; train_edge_recon_loss: 25629697.1174; train_gene_expr_recon_loss: 19587628.8762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45234139.4079; train_optim_loss: 45234139.4079; val_kl_reg_loss: 16690.0617; val_edge_recon_loss: 25731995.1899; val_gene_expr_recon_loss: 19696988.1962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45445673.4430; val_optim_loss: 45445673.4430
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 16821.3145; train_edge_recon_loss: 25633270.5781; train_gene_expr_recon_loss: 19588227.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45238319.8579; train_optim_loss: 45238319.8579; val_kl_reg_loss: 16689.2531; val_edge_recon_loss: 25717479.6899; val_gene_expr_recon_loss: 19694082.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45428251.0253; val_optim_loss: 45428251.0253
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 16830.2002; train_edge_recon_loss: 25633156.4838; train_gene_expr_recon_loss: 19595400.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45245386.8523; train_optim_loss: 45245386.8523; val_kl_reg_loss: 16693.2506; val_edge_recon_loss: 25738784.8354; val_gene_expr_recon_loss: 19689571.3544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45445049.4430; val_optim_loss: 45445049.4430

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1215 min 22 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9977
Val AUPRC score: 0.9973
Val best accuracy score: 0.9817
Val best F1 score: 0.9818
Val gene expr MSE score: 8.0365

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
