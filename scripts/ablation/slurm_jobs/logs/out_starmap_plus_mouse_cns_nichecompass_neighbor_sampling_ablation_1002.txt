None
Run timestamp: 19072023_022320_1002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9884; val_auprc_score: 0.9849; val_best_acc_score: 0.9582; val_best_f1_score: 0.9592; train_kl_reg_loss: 7731.6707; train_edge_recon_loss: 265979.8256; train_gene_expr_recon_loss: 123733.1784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397444.6748; train_optim_loss: 397444.6748; val_kl_reg_loss: 7490.9962; val_edge_recon_loss: 260552.8178; val_gene_expr_recon_loss: 112780.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380824.7090; val_optim_loss: 380824.7090
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9890; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 7293.4998; train_edge_recon_loss: 260537.8221; train_gene_expr_recon_loss: 109839.4637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377670.7861; train_optim_loss: 377670.7861; val_kl_reg_loss: 7068.2747; val_edge_recon_loss: 259570.3572; val_gene_expr_recon_loss: 107430.7089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374069.3402; val_optim_loss: 374069.3402
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9927; val_auprc_score: 0.9908; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 7061.1970; train_edge_recon_loss: 259832.6977; train_gene_expr_recon_loss: 105839.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372733.3850; train_optim_loss: 372733.3850; val_kl_reg_loss: 7029.4286; val_edge_recon_loss: 258828.3895; val_gene_expr_recon_loss: 104420.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370278.1504; val_optim_loss: 370278.1504
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 6926.9162; train_edge_recon_loss: 259292.8766; train_gene_expr_recon_loss: 103434.0406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369653.8341; train_optim_loss: 369653.8341; val_kl_reg_loss: 6866.8650; val_edge_recon_loss: 258615.3955; val_gene_expr_recon_loss: 102607.4393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368089.7023; val_optim_loss: 368089.7023
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 6822.0214; train_edge_recon_loss: 259018.4974; train_gene_expr_recon_loss: 101859.6205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367700.1387; train_optim_loss: 367700.1387; val_kl_reg_loss: 6768.1786; val_edge_recon_loss: 258106.3629; val_gene_expr_recon_loss: 101412.2613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366286.8027; val_optim_loss: 366286.8027
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 6754.7496; train_edge_recon_loss: 258623.6822; train_gene_expr_recon_loss: 100715.8156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366094.2477; train_optim_loss: 366094.2477; val_kl_reg_loss: 6594.1512; val_edge_recon_loss: 257863.8383; val_gene_expr_recon_loss: 100760.1726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365218.1621; val_optim_loss: 365218.1621
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9957; val_auprc_score: 0.9948; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 6698.8279; train_edge_recon_loss: 258352.1569; train_gene_expr_recon_loss: 99975.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365026.9617; train_optim_loss: 365026.9617; val_kl_reg_loss: 6712.7091; val_edge_recon_loss: 257636.5396; val_gene_expr_recon_loss: 100013.7385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364362.9863; val_optim_loss: 364362.9863
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 6655.5339; train_edge_recon_loss: 258033.6117; train_gene_expr_recon_loss: 99428.9736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364118.1188; train_optim_loss: 364118.1188; val_kl_reg_loss: 6520.6610; val_edge_recon_loss: 257351.3209; val_gene_expr_recon_loss: 99680.7228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363552.7039; val_optim_loss: 363552.7039
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 6628.6982; train_edge_recon_loss: 257832.7478; train_gene_expr_recon_loss: 98991.3666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363452.8126; train_optim_loss: 363452.8126; val_kl_reg_loss: 6573.5063; val_edge_recon_loss: 257022.7131; val_gene_expr_recon_loss: 99259.1246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362855.3457; val_optim_loss: 362855.3457
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 6613.7844; train_edge_recon_loss: 257594.8026; train_gene_expr_recon_loss: 98569.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362777.6760; train_optim_loss: 362777.6760; val_kl_reg_loss: 6520.3956; val_edge_recon_loss: 256952.2293; val_gene_expr_recon_loss: 98826.5954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362299.2191; val_optim_loss: 362299.2191
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6589.9248; train_edge_recon_loss: 257508.3272; train_gene_expr_recon_loss: 98172.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362270.5985; train_optim_loss: 362270.5985; val_kl_reg_loss: 6584.7240; val_edge_recon_loss: 256850.5713; val_gene_expr_recon_loss: 98609.8934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362045.1883; val_optim_loss: 362045.1883
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9968; val_auprc_score: 0.9957; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6583.7185; train_edge_recon_loss: 257292.2742; train_gene_expr_recon_loss: 97969.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361844.9940; train_optim_loss: 361844.9940; val_kl_reg_loss: 6545.3130; val_edge_recon_loss: 256726.1352; val_gene_expr_recon_loss: 98341.2420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361612.6906; val_optim_loss: 361612.6906
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 6576.6599; train_edge_recon_loss: 257265.6575; train_gene_expr_recon_loss: 97732.3364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361574.6542; train_optim_loss: 361574.6542; val_kl_reg_loss: 6487.4667; val_edge_recon_loss: 256616.5020; val_gene_expr_recon_loss: 98301.0362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361405.0070; val_optim_loss: 361405.0070
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 6569.8785; train_edge_recon_loss: 257171.5559; train_gene_expr_recon_loss: 97548.6323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361290.0665; train_optim_loss: 361290.0665; val_kl_reg_loss: 6541.9155; val_edge_recon_loss: 256618.0732; val_gene_expr_recon_loss: 98318.7287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361478.7184; val_optim_loss: 361478.7184
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6571.2627; train_edge_recon_loss: 257071.3041; train_gene_expr_recon_loss: 97329.8762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360972.4438; train_optim_loss: 360972.4438; val_kl_reg_loss: 6444.6108; val_edge_recon_loss: 256343.2703; val_gene_expr_recon_loss: 98157.3884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360945.2699; val_optim_loss: 360945.2699
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6572.0784; train_edge_recon_loss: 257047.9589; train_gene_expr_recon_loss: 97178.9571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360798.9943; train_optim_loss: 360798.9943; val_kl_reg_loss: 6461.6745; val_edge_recon_loss: 256287.1637; val_gene_expr_recon_loss: 97934.4787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360683.3156; val_optim_loss: 360683.3156
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6573.1560; train_edge_recon_loss: 256915.8290; train_gene_expr_recon_loss: 96961.5600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360450.5453; train_optim_loss: 360450.5453; val_kl_reg_loss: 6511.4466; val_edge_recon_loss: 256307.5336; val_gene_expr_recon_loss: 98131.6817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360950.6629; val_optim_loss: 360950.6629
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6579.5496; train_edge_recon_loss: 256849.9519; train_gene_expr_recon_loss: 96818.1054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360247.6084; train_optim_loss: 360247.6084; val_kl_reg_loss: 6541.8558; val_edge_recon_loss: 256253.7799; val_gene_expr_recon_loss: 97756.0919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360551.7254; val_optim_loss: 360551.7254
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6582.4417; train_edge_recon_loss: 256743.1042; train_gene_expr_recon_loss: 96660.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359986.3418; train_optim_loss: 359986.3418; val_kl_reg_loss: 6514.5739; val_edge_recon_loss: 256134.4570; val_gene_expr_recon_loss: 97815.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360464.4316; val_optim_loss: 360464.4316
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 6582.7501; train_edge_recon_loss: 256743.5041; train_gene_expr_recon_loss: 96633.9130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359960.1667; train_optim_loss: 359960.1667; val_kl_reg_loss: 6532.2811; val_edge_recon_loss: 256077.9641; val_gene_expr_recon_loss: 97848.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360458.5078; val_optim_loss: 360458.5078
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6589.4392; train_edge_recon_loss: 256689.5573; train_gene_expr_recon_loss: 96504.1743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359783.1705; train_optim_loss: 359783.1705; val_kl_reg_loss: 6528.4298; val_edge_recon_loss: 256029.3508; val_gene_expr_recon_loss: 97635.2209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360193.0027; val_optim_loss: 360193.0027
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6590.2382; train_edge_recon_loss: 256655.1018; train_gene_expr_recon_loss: 96290.3583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359535.6978; train_optim_loss: 359535.6978; val_kl_reg_loss: 6519.6846; val_edge_recon_loss: 256074.1648; val_gene_expr_recon_loss: 97580.4547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360174.3043; val_optim_loss: 360174.3043
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6600.0569; train_edge_recon_loss: 256555.4341; train_gene_expr_recon_loss: 96179.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359335.2357; train_optim_loss: 359335.2357; val_kl_reg_loss: 6599.6403; val_edge_recon_loss: 255910.2305; val_gene_expr_recon_loss: 97241.9289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359751.8012; val_optim_loss: 359751.8012
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6595.7693; train_edge_recon_loss: 256557.3052; train_gene_expr_recon_loss: 96132.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359285.6199; train_optim_loss: 359285.6199; val_kl_reg_loss: 6593.3490; val_edge_recon_loss: 256161.2137; val_gene_expr_recon_loss: 97477.2271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360231.7930; val_optim_loss: 360231.7930
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9861; val_best_f1_score: 0.9863; train_kl_reg_loss: 6604.6050; train_edge_recon_loss: 256520.9864; train_gene_expr_recon_loss: 96091.5441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359217.1350; train_optim_loss: 359217.1350; val_kl_reg_loss: 6546.3676; val_edge_recon_loss: 255652.7432; val_gene_expr_recon_loss: 97425.1911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359624.3020; val_optim_loss: 359624.3020
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6606.7750; train_edge_recon_loss: 256470.4518; train_gene_expr_recon_loss: 95943.2579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359020.4851; train_optim_loss: 359020.4851; val_kl_reg_loss: 6620.2750; val_edge_recon_loss: 255845.1564; val_gene_expr_recon_loss: 97098.4163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359563.8477; val_optim_loss: 359563.8477
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6608.5146; train_edge_recon_loss: 256522.1104; train_gene_expr_recon_loss: 95878.3261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359008.9509; train_optim_loss: 359008.9509; val_kl_reg_loss: 6621.3414; val_edge_recon_loss: 255769.5609; val_gene_expr_recon_loss: 97327.5830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359718.4863; val_optim_loss: 359718.4863
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6612.1734; train_edge_recon_loss: 256352.4424; train_gene_expr_recon_loss: 95794.9651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358759.5806; train_optim_loss: 358759.5806; val_kl_reg_loss: 6545.0494; val_edge_recon_loss: 255787.3754; val_gene_expr_recon_loss: 97280.3065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359612.7320; val_optim_loss: 359612.7320
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6616.8808; train_edge_recon_loss: 256317.9844; train_gene_expr_recon_loss: 95704.8640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358639.7291; train_optim_loss: 358639.7291; val_kl_reg_loss: 6549.5226; val_edge_recon_loss: 255872.8879; val_gene_expr_recon_loss: 97414.4666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359836.8797; val_optim_loss: 359836.8797
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6622.3306; train_edge_recon_loss: 256358.1307; train_gene_expr_recon_loss: 95597.9411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358578.4018; train_optim_loss: 358578.4018; val_kl_reg_loss: 6555.1029; val_edge_recon_loss: 255715.9412; val_gene_expr_recon_loss: 97372.1668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359643.2105; val_optim_loss: 359643.2105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9869; val_best_f1_score: 0.9869; train_kl_reg_loss: 6628.3714; train_edge_recon_loss: 256137.2787; train_gene_expr_recon_loss: 94899.8757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357665.5258; train_optim_loss: 357665.5258; val_kl_reg_loss: 6590.0811; val_edge_recon_loss: 255472.1035; val_gene_expr_recon_loss: 96547.0485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358609.2344; val_optim_loss: 358609.2344
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6624.9177; train_edge_recon_loss: 256149.6971; train_gene_expr_recon_loss: 94803.8143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357578.4288; train_optim_loss: 357578.4288; val_kl_reg_loss: 6594.4297; val_edge_recon_loss: 255472.8260; val_gene_expr_recon_loss: 96728.3733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358795.6262; val_optim_loss: 358795.6262
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6625.3926; train_edge_recon_loss: 256146.1235; train_gene_expr_recon_loss: 94733.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357505.1700; train_optim_loss: 357505.1700; val_kl_reg_loss: 6615.0109; val_edge_recon_loss: 255579.9555; val_gene_expr_recon_loss: 96788.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358983.1641; val_optim_loss: 358983.1641
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6625.7942; train_edge_recon_loss: 256170.5635; train_gene_expr_recon_loss: 94652.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357448.7324; train_optim_loss: 357448.7324; val_kl_reg_loss: 6604.4064; val_edge_recon_loss: 255666.2717; val_gene_expr_recon_loss: 96732.9748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359003.6496; val_optim_loss: 359003.6496
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6624.1745; train_edge_recon_loss: 256155.5188; train_gene_expr_recon_loss: 94707.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357487.2058; train_optim_loss: 357487.2058; val_kl_reg_loss: 6591.9119; val_edge_recon_loss: 255491.9020; val_gene_expr_recon_loss: 96692.7794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358776.5938; val_optim_loss: 358776.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6624.0544; train_edge_recon_loss: 256119.8805; train_gene_expr_recon_loss: 94575.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357319.4513; train_optim_loss: 357319.4513; val_kl_reg_loss: 6595.7344; val_edge_recon_loss: 255609.1727; val_gene_expr_recon_loss: 96591.7302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358796.6363; val_optim_loss: 358796.6363
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9873; val_best_f1_score: 0.9873; train_kl_reg_loss: 6624.7984; train_edge_recon_loss: 256120.2028; train_gene_expr_recon_loss: 94524.0028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357269.0032; train_optim_loss: 357269.0032; val_kl_reg_loss: 6591.2507; val_edge_recon_loss: 255590.0492; val_gene_expr_recon_loss: 96702.2924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358883.5949; val_optim_loss: 358883.5949
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6624.8257; train_edge_recon_loss: 256088.4313; train_gene_expr_recon_loss: 94551.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357265.2185; train_optim_loss: 357265.2185; val_kl_reg_loss: 6597.0392; val_edge_recon_loss: 255492.5203; val_gene_expr_recon_loss: 96625.9702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358715.5289; val_optim_loss: 358715.5289
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6624.0608; train_edge_recon_loss: 256179.2346; train_gene_expr_recon_loss: 94548.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357351.5340; train_optim_loss: 357351.5340; val_kl_reg_loss: 6596.5162; val_edge_recon_loss: 255452.4400; val_gene_expr_recon_loss: 96611.2998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358660.2551; val_optim_loss: 358660.2551

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 227 min 3 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9982
Val AUPRC score: 0.9976
Val best accuracy score: 0.9877
Val best F1 score: 0.9878
Val gene expr MSE score: 0.6519

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
