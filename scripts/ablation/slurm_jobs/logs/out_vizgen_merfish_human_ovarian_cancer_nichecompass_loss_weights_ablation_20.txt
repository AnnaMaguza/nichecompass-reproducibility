None
Run timestamp: 04072023_092735_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9941; val_auprc_score: 0.9940; val_best_acc_score: 0.9626; val_best_f1_score: 0.9626; train_kl_reg_loss: 2627.0451; train_edge_recon_loss: 27848.9901; train_gene_expr_recon_loss: 21848.6047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 52324.6399; train_optim_loss: 52324.6399; val_kl_reg_loss: 2683.7440; val_edge_recon_loss: 26202.6052; val_gene_expr_recon_loss: 20721.3824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49607.7318; val_optim_loss: 49607.7318
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9697; val_best_f1_score: 0.9698; train_kl_reg_loss: 2734.9889; train_edge_recon_loss: 27404.8528; train_gene_expr_recon_loss: 20795.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50935.0571; train_optim_loss: 50935.0571; val_kl_reg_loss: 2791.7012; val_edge_recon_loss: 26079.2101; val_gene_expr_recon_loss: 20424.5571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49295.4683; val_optim_loss: 49295.4683
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 2758.5775; train_edge_recon_loss: 27329.4234; train_gene_expr_recon_loss: 20661.7287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50749.7297; train_optim_loss: 50749.7297; val_kl_reg_loss: 2672.8840; val_edge_recon_loss: 26023.1782; val_gene_expr_recon_loss: 20349.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49045.6888; val_optim_loss: 49045.6888
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 2772.9919; train_edge_recon_loss: 27277.8623; train_gene_expr_recon_loss: 20563.0134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50613.8677; train_optim_loss: 50613.8677; val_kl_reg_loss: 2793.5916; val_edge_recon_loss: 26008.2588; val_gene_expr_recon_loss: 18367.6385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 47169.4889; val_optim_loss: 47169.4889
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9775; val_best_f1_score: 0.9776; train_kl_reg_loss: 2778.6297; train_edge_recon_loss: 27250.1166; train_gene_expr_recon_loss: 19192.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49221.5480; train_optim_loss: 49221.5480; val_kl_reg_loss: 2806.0191; val_edge_recon_loss: 25988.3003; val_gene_expr_recon_loss: 18438.4323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 47232.7517; val_optim_loss: 47232.7517
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9978; val_auprc_score: 0.9977; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 2784.1852; train_edge_recon_loss: 27217.3313; train_gene_expr_recon_loss: 15946.8601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45948.3766; train_optim_loss: 45948.3766; val_kl_reg_loss: 2752.4689; val_edge_recon_loss: 25942.0283; val_gene_expr_recon_loss: 15911.3596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44605.8568; val_optim_loss: 44605.8568
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9795; val_best_f1_score: 0.9795; train_kl_reg_loss: 2785.4636; train_edge_recon_loss: 27205.5748; train_gene_expr_recon_loss: 14231.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44222.7175; train_optim_loss: 44222.7175; val_kl_reg_loss: 2815.1109; val_edge_recon_loss: 25937.1279; val_gene_expr_recon_loss: 13949.4869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42701.7258; val_optim_loss: 42701.7258
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9981; val_auprc_score: 0.9980; val_best_acc_score: 0.9812; val_best_f1_score: 0.9812; train_kl_reg_loss: 2788.8680; train_edge_recon_loss: 27185.5579; train_gene_expr_recon_loss: 14131.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44106.3492; train_optim_loss: 44106.3492; val_kl_reg_loss: 2740.6126; val_edge_recon_loss: 25913.9099; val_gene_expr_recon_loss: 13863.4284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42517.9508; val_optim_loss: 42517.9508
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9813; val_best_f1_score: 0.9813; train_kl_reg_loss: 2791.1413; train_edge_recon_loss: 27172.2800; train_gene_expr_recon_loss: 14053.2119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44016.6331; train_optim_loss: 44016.6331; val_kl_reg_loss: 2758.0435; val_edge_recon_loss: 25908.7442; val_gene_expr_recon_loss: 13779.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42445.9529; val_optim_loss: 42445.9529
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 2792.6633; train_edge_recon_loss: 27162.2931; train_gene_expr_recon_loss: 14024.4455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43979.4019; train_optim_loss: 43979.4019; val_kl_reg_loss: 2809.0813; val_edge_recon_loss: 25916.9086; val_gene_expr_recon_loss: 13783.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42509.9141; val_optim_loss: 42509.9141
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9984; val_auprc_score: 0.9983; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 2794.2481; train_edge_recon_loss: 27151.1325; train_gene_expr_recon_loss: 13990.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43935.5077; train_optim_loss: 43935.5077; val_kl_reg_loss: 2749.0026; val_edge_recon_loss: 25880.8641; val_gene_expr_recon_loss: 13821.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42451.8062; val_optim_loss: 42451.8062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 2796.1910; train_edge_recon_loss: 27142.3731; train_gene_expr_recon_loss: 13970.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43908.8113; train_optim_loss: 43908.8113; val_kl_reg_loss: 2776.2837; val_edge_recon_loss: 25890.6673; val_gene_expr_recon_loss: 13835.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42502.6485; val_optim_loss: 42502.6485
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9831; val_best_f1_score: 0.9831; train_kl_reg_loss: 2797.8803; train_edge_recon_loss: 27131.7507; train_gene_expr_recon_loss: 13963.6156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43893.2466; train_optim_loss: 43893.2466; val_kl_reg_loss: 2749.6793; val_edge_recon_loss: 25893.5744; val_gene_expr_recon_loss: 13267.2082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41910.4619; val_optim_loss: 41910.4619
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9985; val_auprc_score: 0.9984; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 2799.2090; train_edge_recon_loss: 27126.2727; train_gene_expr_recon_loss: 13936.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43861.6938; train_optim_loss: 43861.6938; val_kl_reg_loss: 2807.0709; val_edge_recon_loss: 25852.9241; val_gene_expr_recon_loss: 14003.7182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42663.7131; val_optim_loss: 42663.7131
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2800.6660; train_edge_recon_loss: 27120.1103; train_gene_expr_recon_loss: 13932.8402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43853.6166; train_optim_loss: 43853.6166; val_kl_reg_loss: 2876.5074; val_edge_recon_loss: 25843.3952; val_gene_expr_recon_loss: 13751.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42471.6082; val_optim_loss: 42471.6082
