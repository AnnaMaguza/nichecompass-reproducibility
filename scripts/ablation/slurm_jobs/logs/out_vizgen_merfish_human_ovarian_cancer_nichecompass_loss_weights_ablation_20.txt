None
Run timestamp: 07072023_003715_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9668; val_best_f1_score: 0.9669; train_kl_reg_loss: 2511.0091; train_edge_recon_loss: 27996.8300; train_gene_expr_recon_loss: 14760.9585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45268.7977; train_optim_loss: 45268.7977; val_kl_reg_loss: 2593.3860; val_edge_recon_loss: 26560.0095; val_gene_expr_recon_loss: 13549.9246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42703.3201; val_optim_loss: 42703.3201
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 2641.2554; train_edge_recon_loss: 27414.0368; train_gene_expr_recon_loss: 13538.1507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43593.4430; train_optim_loss: 43593.4430; val_kl_reg_loss: 2711.3251; val_edge_recon_loss: 26382.0702; val_gene_expr_recon_loss: 13230.8795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42324.2748; val_optim_loss: 42324.2748
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 2677.8105; train_edge_recon_loss: 27277.1972; train_gene_expr_recon_loss: 13353.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43308.2567; train_optim_loss: 43308.2567; val_kl_reg_loss: 2627.4583; val_edge_recon_loss: 26221.2280; val_gene_expr_recon_loss: 13132.0093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41980.6957; val_optim_loss: 41980.6957
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9978; val_auprc_score: 0.9976; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 2695.0965; train_edge_recon_loss: 27204.0850; train_gene_expr_recon_loss: 13201.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43101.1095; train_optim_loss: 43101.1095; val_kl_reg_loss: 2707.2308; val_edge_recon_loss: 26157.5435; val_gene_expr_recon_loss: 13357.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42222.3690; val_optim_loss: 42222.3690
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 2704.5557; train_edge_recon_loss: 27164.3543; train_gene_expr_recon_loss: 12581.0235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42449.9336; train_optim_loss: 42449.9336; val_kl_reg_loss: 2711.6147; val_edge_recon_loss: 26131.8631; val_gene_expr_recon_loss: 11436.5059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40279.9837; val_optim_loss: 40279.9837
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9816; val_best_f1_score: 0.9816; train_kl_reg_loss: 2715.5717; train_edge_recon_loss: 27127.7704; train_gene_expr_recon_loss: 11519.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41363.3025; train_optim_loss: 41363.3025; val_kl_reg_loss: 2748.2487; val_edge_recon_loss: 26089.1682; val_gene_expr_recon_loss: 10944.4148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39781.8317; val_optim_loss: 39781.8317
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9822; val_best_f1_score: 0.9822; train_kl_reg_loss: 2722.8707; train_edge_recon_loss: 27108.8357; train_gene_expr_recon_loss: 11157.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40989.6890; train_optim_loss: 40989.6890; val_kl_reg_loss: 2747.6539; val_edge_recon_loss: 26070.8815; val_gene_expr_recon_loss: 11038.3260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39856.8613; val_optim_loss: 39856.8613
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 2727.3207; train_edge_recon_loss: 27087.9650; train_gene_expr_recon_loss: 11095.2156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40910.5013; train_optim_loss: 40910.5013; val_kl_reg_loss: 2703.4243; val_edge_recon_loss: 26039.3433; val_gene_expr_recon_loss: 10983.2017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39725.9694; val_optim_loss: 39725.9694
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9987; val_auprc_score: 0.9986; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 2728.8029; train_edge_recon_loss: 27071.1107; train_gene_expr_recon_loss: 11077.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40877.3538; train_optim_loss: 40877.3538; val_kl_reg_loss: 2728.2572; val_edge_recon_loss: 26045.4037; val_gene_expr_recon_loss: 10984.1913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39757.8521; val_optim_loss: 39757.8521
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9843; val_best_f1_score: 0.9843; train_kl_reg_loss: 2734.5042; train_edge_recon_loss: 27053.0607; train_gene_expr_recon_loss: 11045.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40832.6704; train_optim_loss: 40832.6704; val_kl_reg_loss: 2740.6679; val_edge_recon_loss: 26012.2399; val_gene_expr_recon_loss: 10916.3815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39669.2893; val_optim_loss: 39669.2893
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9986; val_auprc_score: 0.9985; val_best_acc_score: 0.9845; val_best_f1_score: 0.9845; train_kl_reg_loss: 2739.9281; train_edge_recon_loss: 27039.8848; train_gene_expr_recon_loss: 11031.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40811.7506; train_optim_loss: 40811.7506; val_kl_reg_loss: 2705.3102; val_edge_recon_loss: 26012.6380; val_gene_expr_recon_loss: 10929.8834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39647.8316; val_optim_loss: 39647.8316
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 2744.3624; train_edge_recon_loss: 27030.4866; train_gene_expr_recon_loss: 11022.4422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40797.2912; train_optim_loss: 40797.2912; val_kl_reg_loss: 2761.0854; val_edge_recon_loss: 25994.0033; val_gene_expr_recon_loss: 10915.3598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39670.4484; val_optim_loss: 39670.4484
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9987; val_auprc_score: 0.9985; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2748.3031; train_edge_recon_loss: 27021.5076; train_gene_expr_recon_loss: 11010.5329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40780.3437; train_optim_loss: 40780.3437; val_kl_reg_loss: 2701.0026; val_edge_recon_loss: 25966.5545; val_gene_expr_recon_loss: 10915.4825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39583.0396; val_optim_loss: 39583.0396
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9862; val_best_f1_score: 0.9862; train_kl_reg_loss: 2751.9500; train_edge_recon_loss: 27013.1890; train_gene_expr_recon_loss: 11006.8844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40772.0234; train_optim_loss: 40772.0234; val_kl_reg_loss: 2758.2025; val_edge_recon_loss: 25960.5626; val_gene_expr_recon_loss: 10907.5443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39626.3093; val_optim_loss: 39626.3093
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9858; val_best_f1_score: 0.9858; train_kl_reg_loss: 2755.3011; train_edge_recon_loss: 27006.1950; train_gene_expr_recon_loss: 11004.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40765.6913; train_optim_loss: 40765.6913; val_kl_reg_loss: 2742.5518; val_edge_recon_loss: 25966.7905; val_gene_expr_recon_loss: 10979.8263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39689.1685; val_optim_loss: 39689.1685
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2758.3050; train_edge_recon_loss: 26998.4116; train_gene_expr_recon_loss: 10992.7932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40749.5098; train_optim_loss: 40749.5098; val_kl_reg_loss: 2761.1691; val_edge_recon_loss: 25958.3435; val_gene_expr_recon_loss: 10905.1657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39624.6783; val_optim_loss: 39624.6783
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9864; val_best_f1_score: 0.9864; train_kl_reg_loss: 2761.0353; train_edge_recon_loss: 26991.7890; train_gene_expr_recon_loss: 10976.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40729.1394; train_optim_loss: 40729.1394; val_kl_reg_loss: 2777.9030; val_edge_recon_loss: 25942.3583; val_gene_expr_recon_loss: 10891.9664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39612.2275; val_optim_loss: 39612.2275

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 2760.0552; train_edge_recon_loss: 26953.5351; train_gene_expr_recon_loss: 10914.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40628.3781; train_optim_loss: 40628.3781; val_kl_reg_loss: 2753.2311; val_edge_recon_loss: 25917.4770; val_gene_expr_recon_loss: 10840.3005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39511.0085; val_optim_loss: 39511.0085
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 2753.9356; train_edge_recon_loss: 26960.5518; train_gene_expr_recon_loss: 10902.8389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40617.3263; train_optim_loss: 40617.3263; val_kl_reg_loss: 2750.1783; val_edge_recon_loss: 25919.6970; val_gene_expr_recon_loss: 10837.3399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39507.2153; val_optim_loss: 39507.2153
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 2753.1868; train_edge_recon_loss: 26955.6214; train_gene_expr_recon_loss: 10899.3613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40608.1695; train_optim_loss: 40608.1695; val_kl_reg_loss: 2755.6769; val_edge_recon_loss: 25914.0440; val_gene_expr_recon_loss: 10833.9515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39503.6724; val_optim_loss: 39503.6724
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 2753.5530; train_edge_recon_loss: 26953.4764; train_gene_expr_recon_loss: 10896.3168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40603.3463; train_optim_loss: 40603.3463; val_kl_reg_loss: 2747.0188; val_edge_recon_loss: 25931.3414; val_gene_expr_recon_loss: 10832.9357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39511.2959; val_optim_loss: 39511.2959
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 2753.2677; train_edge_recon_loss: 26953.5384; train_gene_expr_recon_loss: 10894.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40601.5293; train_optim_loss: 40601.5293; val_kl_reg_loss: 2758.5451; val_edge_recon_loss: 25906.9267; val_gene_expr_recon_loss: 10833.6308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39499.1026; val_optim_loss: 39499.1026
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 2754.2549; train_edge_recon_loss: 26946.1586; train_gene_expr_recon_loss: 10893.1442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40593.5577; train_optim_loss: 40593.5577; val_kl_reg_loss: 2738.2446; val_edge_recon_loss: 25908.8005; val_gene_expr_recon_loss: 10830.8877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39477.9327; val_optim_loss: 39477.9327
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 2753.3375; train_edge_recon_loss: 26952.0716; train_gene_expr_recon_loss: 10890.7182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40596.1272; train_optim_loss: 40596.1272; val_kl_reg_loss: 2754.9452; val_edge_recon_loss: 25895.6707; val_gene_expr_recon_loss: 10831.4652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39482.0812; val_optim_loss: 39482.0812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9991; val_auprc_score: 0.9987; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 2754.0361; train_edge_recon_loss: 26947.3564; train_gene_expr_recon_loss: 10890.5432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40591.9358; train_optim_loss: 40591.9358; val_kl_reg_loss: 2753.3839; val_edge_recon_loss: 25910.7682; val_gene_expr_recon_loss: 10828.6106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39492.7627; val_optim_loss: 39492.7627
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2754.7120; train_edge_recon_loss: 26946.5911; train_gene_expr_recon_loss: 10889.1343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40590.4374; train_optim_loss: 40590.4374; val_kl_reg_loss: 2762.0896; val_edge_recon_loss: 25900.6823; val_gene_expr_recon_loss: 10830.4557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39493.2276; val_optim_loss: 39493.2276
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2754.3681; train_edge_recon_loss: 26948.0278; train_gene_expr_recon_loss: 10887.4964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40589.8922; train_optim_loss: 40589.8922; val_kl_reg_loss: 2769.1485; val_edge_recon_loss: 25890.1935; val_gene_expr_recon_loss: 10827.6654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39487.0075; val_optim_loss: 39487.0075

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2755.4544; train_edge_recon_loss: 26943.2272; train_gene_expr_recon_loss: 10881.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40579.7574; train_optim_loss: 40579.7574; val_kl_reg_loss: 2754.2183; val_edge_recon_loss: 25902.1190; val_gene_expr_recon_loss: 10821.7494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39478.0866; val_optim_loss: 39478.0866
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 2755.3741; train_edge_recon_loss: 26939.7602; train_gene_expr_recon_loss: 10880.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40575.5297; train_optim_loss: 40575.5297; val_kl_reg_loss: 2752.5952; val_edge_recon_loss: 25901.5413; val_gene_expr_recon_loss: 10823.3742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39477.5106; val_optim_loss: 39477.5106
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 2755.3375; train_edge_recon_loss: 26939.3656; train_gene_expr_recon_loss: 10879.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40574.1954; train_optim_loss: 40574.1954; val_kl_reg_loss: 2753.6704; val_edge_recon_loss: 25911.6721; val_gene_expr_recon_loss: 10825.4534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39490.7960; val_optim_loss: 39490.7960
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2755.1592; train_edge_recon_loss: 26939.9467; train_gene_expr_recon_loss: 10879.2702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40574.3761; train_optim_loss: 40574.3761; val_kl_reg_loss: 2753.0321; val_edge_recon_loss: 25890.6118; val_gene_expr_recon_loss: 10823.5754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39467.2193; val_optim_loss: 39467.2193
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 2753.6651; train_edge_recon_loss: 26944.8449; train_gene_expr_recon_loss: 10878.9413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40577.4513; train_optim_loss: 40577.4513; val_kl_reg_loss: 2752.3706; val_edge_recon_loss: 25910.7505; val_gene_expr_recon_loss: 10822.9274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39486.0487; val_optim_loss: 39486.0487
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9992; val_auprc_score: 0.9990; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 2754.2341; train_edge_recon_loss: 26943.8227; train_gene_expr_recon_loss: 10879.3451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40577.4018; train_optim_loss: 40577.4018; val_kl_reg_loss: 2751.4288; val_edge_recon_loss: 25904.6342; val_gene_expr_recon_loss: 10825.6272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39481.6902; val_optim_loss: 39481.6902
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2753.4965; train_edge_recon_loss: 26944.7330; train_gene_expr_recon_loss: 10878.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40576.6526; train_optim_loss: 40576.6526; val_kl_reg_loss: 2751.1994; val_edge_recon_loss: 25895.8202; val_gene_expr_recon_loss: 10823.7771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39470.7966; val_optim_loss: 39470.7966
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9992; val_auprc_score: 0.9991; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 2754.4884; train_edge_recon_loss: 26940.3040; train_gene_expr_recon_loss: 10878.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40572.9091; train_optim_loss: 40572.9091; val_kl_reg_loss: 2751.9298; val_edge_recon_loss: 25904.2218; val_gene_expr_recon_loss: 10823.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39480.0810; val_optim_loss: 39480.0810

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2754.2709; train_edge_recon_loss: 26940.8710; train_gene_expr_recon_loss: 10877.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40573.0082; train_optim_loss: 40573.0082; val_kl_reg_loss: 2753.7028; val_edge_recon_loss: 25917.3557; val_gene_expr_recon_loss: 10825.1811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39496.2395; val_optim_loss: 39496.2395
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2754.8835; train_edge_recon_loss: 26937.6387; train_gene_expr_recon_loss: 10877.0111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40569.5334; train_optim_loss: 40569.5334; val_kl_reg_loss: 2754.4023; val_edge_recon_loss: 25907.5725; val_gene_expr_recon_loss: 10822.1554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39484.1301; val_optim_loss: 39484.1301
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 2754.8813; train_edge_recon_loss: 26938.6915; train_gene_expr_recon_loss: 10878.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40571.7466; train_optim_loss: 40571.7466; val_kl_reg_loss: 2753.3837; val_edge_recon_loss: 25907.9003; val_gene_expr_recon_loss: 10823.3987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39484.6828; val_optim_loss: 39484.6828
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9991; val_auprc_score: 0.9989; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 2754.5033; train_edge_recon_loss: 26939.8881; train_gene_expr_recon_loss: 10877.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40571.4151; train_optim_loss: 40571.4151; val_kl_reg_loss: 2753.2188; val_edge_recon_loss: 25907.8778; val_gene_expr_recon_loss: 10823.9566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39485.0531; val_optim_loss: 39485.0531

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1294 min 32 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9991
Val AUPRC score: 0.9990
Val best accuracy score: 0.9884
Val best F1 score: 0.9884
Val gene expr MSE score: 8.5328

Computing neighbor graph...
