None
Run timestamp: 15072023_114114_145.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_145']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9538; val_auprc_score: 0.9505; val_best_acc_score: 0.8862; val_best_f1_score: 0.8891; train_kl_reg_loss: 34111.1129; train_edge_recon_loss: 2808762.9868; train_gene_expr_recon_loss: 1474690.7644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4317564.8628; train_optim_loss: 4317564.8628; val_kl_reg_loss: 32334.4664; val_edge_recon_loss: 2727709.2227; val_gene_expr_recon_loss: 1361175.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4121218.8841; val_optim_loss: 4121218.8841
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9698; val_auprc_score: 0.9678; val_best_acc_score: 0.9117; val_best_f1_score: 0.9132; train_kl_reg_loss: 30032.2782; train_edge_recon_loss: 2653179.8597; train_gene_expr_recon_loss: 1325552.4907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4008764.6303; train_optim_loss: 4008764.6303; val_kl_reg_loss: 26703.8201; val_edge_recon_loss: 2691099.8250; val_gene_expr_recon_loss: 1296818.8739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4014622.5159; val_optim_loss: 4014622.5159
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9751; val_auprc_score: 0.9734; val_best_acc_score: 0.9205; val_best_f1_score: 0.9211; train_kl_reg_loss: 25769.9156; train_edge_recon_loss: 2630498.9488; train_gene_expr_recon_loss: 1280872.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3937141.4445; train_optim_loss: 3937141.4445; val_kl_reg_loss: 24080.3901; val_edge_recon_loss: 2676617.3114; val_gene_expr_recon_loss: 1265983.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3966681.6727; val_optim_loss: 3966681.6727
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9769; val_auprc_score: 0.9748; val_best_acc_score: 0.9242; val_best_f1_score: 0.9249; train_kl_reg_loss: 23680.3277; train_edge_recon_loss: 2621554.7839; train_gene_expr_recon_loss: 1255336.3145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3900571.4287; train_optim_loss: 3900571.4287; val_kl_reg_loss: 22392.9844; val_edge_recon_loss: 2668564.4432; val_gene_expr_recon_loss: 1246671.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3937629.2705; val_optim_loss: 3937629.2705
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9789; val_auprc_score: 0.9770; val_best_acc_score: 0.9280; val_best_f1_score: 0.9289; train_kl_reg_loss: 22196.0873; train_edge_recon_loss: 2617069.8926; train_gene_expr_recon_loss: 1238738.0989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3878004.0832; train_optim_loss: 3878004.0832; val_kl_reg_loss: 20842.9188; val_edge_recon_loss: 2664597.7545; val_gene_expr_recon_loss: 1234629.7693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3920070.4545; val_optim_loss: 3920070.4545
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9802; val_auprc_score: 0.9785; val_best_acc_score: 0.9302; val_best_f1_score: 0.9306; train_kl_reg_loss: 21121.8851; train_edge_recon_loss: 2614487.8816; train_gene_expr_recon_loss: 1227029.6539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3862639.4236; train_optim_loss: 3862639.4236; val_kl_reg_loss: 20110.5840; val_edge_recon_loss: 2662665.7091; val_gene_expr_recon_loss: 1224418.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3907195.1750; val_optim_loss: 3907195.1750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9808; val_auprc_score: 0.9788; val_best_acc_score: 0.9312; val_best_f1_score: 0.9316; train_kl_reg_loss: 20342.3032; train_edge_recon_loss: 2611891.4027; train_gene_expr_recon_loss: 1219142.1964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3851375.8977; train_optim_loss: 3851375.8977; val_kl_reg_loss: 19622.3211; val_edge_recon_loss: 2656168.7841; val_gene_expr_recon_loss: 1217628.5136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3893419.6091; val_optim_loss: 3893419.6091
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9816; val_auprc_score: 0.9805; val_best_acc_score: 0.9328; val_best_f1_score: 0.9333; train_kl_reg_loss: 19847.1586; train_edge_recon_loss: 2609249.8478; train_gene_expr_recon_loss: 1212612.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3841709.6471; train_optim_loss: 3841709.6471; val_kl_reg_loss: 19032.8389; val_edge_recon_loss: 2656448.6159; val_gene_expr_recon_loss: 1213885.3057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3889366.7614; val_optim_loss: 3889366.7614
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9819; val_auprc_score: 0.9802; val_best_acc_score: 0.9334; val_best_f1_score: 0.9341; train_kl_reg_loss: 19325.0257; train_edge_recon_loss: 2608638.9738; train_gene_expr_recon_loss: 1207781.0555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3835745.0606; train_optim_loss: 3835745.0606; val_kl_reg_loss: 18664.6042; val_edge_recon_loss: 2661178.3568; val_gene_expr_recon_loss: 1208698.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3888541.7955; val_optim_loss: 3888541.7955
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9823; val_auprc_score: 0.9806; val_best_acc_score: 0.9344; val_best_f1_score: 0.9350; train_kl_reg_loss: 18925.5675; train_edge_recon_loss: 2605875.9455; train_gene_expr_recon_loss: 1204489.8997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3829291.4157; train_optim_loss: 3829291.4157; val_kl_reg_loss: 18335.3932; val_edge_recon_loss: 2657701.2091; val_gene_expr_recon_loss: 1205999.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3882036.0023; val_optim_loss: 3882036.0023
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9837; val_auprc_score: 0.9824; val_best_acc_score: 0.9372; val_best_f1_score: 0.9379; train_kl_reg_loss: 18601.0416; train_edge_recon_loss: 2604990.5542; train_gene_expr_recon_loss: 1201923.8388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3825515.4323; train_optim_loss: 3825515.4323; val_kl_reg_loss: 17849.5244; val_edge_recon_loss: 2653509.7114; val_gene_expr_recon_loss: 1202284.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3873643.9864; val_optim_loss: 3873643.9864
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9844; val_auprc_score: 0.9830; val_best_acc_score: 0.9385; val_best_f1_score: 0.9390; train_kl_reg_loss: 18365.3485; train_edge_recon_loss: 2602310.7566; train_gene_expr_recon_loss: 1198792.3388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3819468.4453; train_optim_loss: 3819468.4453; val_kl_reg_loss: 17669.4476; val_edge_recon_loss: 2652043.6750; val_gene_expr_recon_loss: 1201731.2159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3871444.3455; val_optim_loss: 3871444.3455
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9846; val_auprc_score: 0.9833; val_best_acc_score: 0.9392; val_best_f1_score: 0.9396; train_kl_reg_loss: 18134.0682; train_edge_recon_loss: 2601768.0575; train_gene_expr_recon_loss: 1196245.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3816147.4669; train_optim_loss: 3816147.4669; val_kl_reg_loss: 17414.6485; val_edge_recon_loss: 2652774.7659; val_gene_expr_recon_loss: 1201191.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3871380.8727; val_optim_loss: 3871380.8727
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9850; val_auprc_score: 0.9835; val_best_acc_score: 0.9411; val_best_f1_score: 0.9414; train_kl_reg_loss: 17937.9889; train_edge_recon_loss: 2601166.9488; train_gene_expr_recon_loss: 1194772.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3813877.8503; train_optim_loss: 3813877.8503; val_kl_reg_loss: 17444.6178; val_edge_recon_loss: 2646975.3432; val_gene_expr_recon_loss: 1198530.0102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3862949.9727; val_optim_loss: 3862949.9727
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9849; val_auprc_score: 0.9837; val_best_acc_score: 0.9405; val_best_f1_score: 0.9408; train_kl_reg_loss: 17862.5506; train_edge_recon_loss: 2600750.5295; train_gene_expr_recon_loss: 1193213.2685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3811826.3521; train_optim_loss: 3811826.3521; val_kl_reg_loss: 17415.2411; val_edge_recon_loss: 2652443.7909; val_gene_expr_recon_loss: 1195982.5330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3865841.5500; val_optim_loss: 3865841.5500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9852; val_auprc_score: 0.9836; val_best_acc_score: 0.9418; val_best_f1_score: 0.9420; train_kl_reg_loss: 17759.2449; train_edge_recon_loss: 2598690.5267; train_gene_expr_recon_loss: 1191692.3278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3808142.1016; train_optim_loss: 3808142.1016; val_kl_reg_loss: 17040.5138; val_edge_recon_loss: 2650827.0705; val_gene_expr_recon_loss: 1195678.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3863545.9932; val_optim_loss: 3863545.9932
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9855; val_auprc_score: 0.9841; val_best_acc_score: 0.9424; val_best_f1_score: 0.9427; train_kl_reg_loss: 17657.5151; train_edge_recon_loss: 2599905.1757; train_gene_expr_recon_loss: 1190585.0126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3808147.6986; train_optim_loss: 3808147.6986; val_kl_reg_loss: 17172.3392; val_edge_recon_loss: 2645223.5182; val_gene_expr_recon_loss: 1196188.7659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3858584.6205; val_optim_loss: 3858584.6205
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9854; val_auprc_score: 0.9839; val_best_acc_score: 0.9421; val_best_f1_score: 0.9426; train_kl_reg_loss: 17583.2423; train_edge_recon_loss: 2597734.4575; train_gene_expr_recon_loss: 1189388.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804706.3806; train_optim_loss: 3804706.3806; val_kl_reg_loss: 16927.3364; val_edge_recon_loss: 2645542.3227; val_gene_expr_recon_loss: 1194101.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3856571.5818; val_optim_loss: 3856571.5818
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9852; val_auprc_score: 0.9837; val_best_acc_score: 0.9419; val_best_f1_score: 0.9421; train_kl_reg_loss: 17496.1533; train_edge_recon_loss: 2596425.3248; train_gene_expr_recon_loss: 1187669.9332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3801591.4094; train_optim_loss: 3801591.4094; val_kl_reg_loss: 17333.9327; val_edge_recon_loss: 2646977.2205; val_gene_expr_recon_loss: 1193682.1114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3857993.2705; val_optim_loss: 3857993.2705
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9850; val_auprc_score: 0.9833; val_best_acc_score: 0.9415; val_best_f1_score: 0.9421; train_kl_reg_loss: 17453.7834; train_edge_recon_loss: 2597845.8613; train_gene_expr_recon_loss: 1186922.2709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3802221.9119; train_optim_loss: 3802221.9119; val_kl_reg_loss: 17089.9645; val_edge_recon_loss: 2646035.1545; val_gene_expr_recon_loss: 1190832.4295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3853957.5614; val_optim_loss: 3853957.5614
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9857; val_auprc_score: 0.9837; val_best_acc_score: 0.9434; val_best_f1_score: 0.9438; train_kl_reg_loss: 17383.9444; train_edge_recon_loss: 2596949.9728; train_gene_expr_recon_loss: 1185593.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3799926.9916; train_optim_loss: 3799926.9916; val_kl_reg_loss: 16869.9639; val_edge_recon_loss: 2644280.4750; val_gene_expr_recon_loss: 1190689.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3851840.3045; val_optim_loss: 3851840.3045
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9860; val_auprc_score: 0.9844; val_best_acc_score: 0.9441; val_best_f1_score: 0.9446; train_kl_reg_loss: 17314.3479; train_edge_recon_loss: 2596513.9091; train_gene_expr_recon_loss: 1184850.4673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3798678.7273; train_optim_loss: 3798678.7273; val_kl_reg_loss: 17219.7642; val_edge_recon_loss: 2641928.4818; val_gene_expr_recon_loss: 1190168.5489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849316.7773; val_optim_loss: 3849316.7773
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9863; val_auprc_score: 0.9849; val_best_acc_score: 0.9444; val_best_f1_score: 0.9448; train_kl_reg_loss: 17311.3869; train_edge_recon_loss: 2595071.6795; train_gene_expr_recon_loss: 1184551.4930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3796934.5535; train_optim_loss: 3796934.5535; val_kl_reg_loss: 16548.7035; val_edge_recon_loss: 2648451.8409; val_gene_expr_recon_loss: 1191084.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3856085.2909; val_optim_loss: 3856085.2909
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9859; val_auprc_score: 0.9843; val_best_acc_score: 0.9442; val_best_f1_score: 0.9446; train_kl_reg_loss: 17194.6316; train_edge_recon_loss: 2595450.5947; train_gene_expr_recon_loss: 1183718.0582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3796363.2912; train_optim_loss: 3796363.2912; val_kl_reg_loss: 16344.4124; val_edge_recon_loss: 2642458.8295; val_gene_expr_recon_loss: 1189946.1193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3848749.3500; val_optim_loss: 3848749.3500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9862; val_auprc_score: 0.9844; val_best_acc_score: 0.9440; val_best_f1_score: 0.9445; train_kl_reg_loss: 17122.3800; train_edge_recon_loss: 2594575.4692; train_gene_expr_recon_loss: 1183485.7212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3795183.5626; train_optim_loss: 3795183.5626; val_kl_reg_loss: 16951.7229; val_edge_recon_loss: 2644813.5182; val_gene_expr_recon_loss: 1187360.6330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849125.8659; val_optim_loss: 3849125.8659
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9866; val_auprc_score: 0.9852; val_best_acc_score: 0.9453; val_best_f1_score: 0.9459; train_kl_reg_loss: 17033.3395; train_edge_recon_loss: 2596383.9099; train_gene_expr_recon_loss: 1182435.7995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3795853.0489; train_optim_loss: 3795853.0489; val_kl_reg_loss: 16533.7153; val_edge_recon_loss: 2642087.4477; val_gene_expr_recon_loss: 1188582.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847203.5818; val_optim_loss: 3847203.5818
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9868; val_auprc_score: 0.9851; val_best_acc_score: 0.9455; val_best_f1_score: 0.9459; train_kl_reg_loss: 16982.1732; train_edge_recon_loss: 2593740.3977; train_gene_expr_recon_loss: 1182448.9166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3793171.4865; train_optim_loss: 3793171.4865; val_kl_reg_loss: 16678.9350; val_edge_recon_loss: 2642244.0114; val_gene_expr_recon_loss: 1188707.3466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3847630.3159; val_optim_loss: 3847630.3159
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9858; val_auprc_score: 0.9842; val_best_acc_score: 0.9437; val_best_f1_score: 0.9444; train_kl_reg_loss: 16976.7879; train_edge_recon_loss: 2593338.9476; train_gene_expr_recon_loss: 1181669.9940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791985.7268; train_optim_loss: 3791985.7268; val_kl_reg_loss: 16560.6618; val_edge_recon_loss: 2645737.6636; val_gene_expr_recon_loss: 1187257.0966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3849555.4295; val_optim_loss: 3849555.4295
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9865; val_auprc_score: 0.9847; val_best_acc_score: 0.9454; val_best_f1_score: 0.9460; train_kl_reg_loss: 16938.1000; train_edge_recon_loss: 2591668.3717; train_gene_expr_recon_loss: 1181033.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3789639.9175; train_optim_loss: 3789639.9175; val_kl_reg_loss: 16327.3841; val_edge_recon_loss: 2643061.5068; val_gene_expr_recon_loss: 1189326.3943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3848715.2727; val_optim_loss: 3848715.2727
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9868; val_auprc_score: 0.9851; val_best_acc_score: 0.9459; val_best_f1_score: 0.9465; train_kl_reg_loss: 16839.2449; train_edge_recon_loss: 2593641.0204; train_gene_expr_recon_loss: 1181390.0432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3791870.3116; train_optim_loss: 3791870.3116; val_kl_reg_loss: 16244.3416; val_edge_recon_loss: 2639277.5977; val_gene_expr_recon_loss: 1187838.9886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3843360.9386; val_optim_loss: 3843360.9386
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9869; val_auprc_score: 0.9854; val_best_acc_score: 0.9456; val_best_f1_score: 0.9461; train_kl_reg_loss: 16765.1897; train_edge_recon_loss: 2592444.7599; train_gene_expr_recon_loss: 1180115.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3789325.5120; train_optim_loss: 3789325.5120; val_kl_reg_loss: 16374.0042; val_edge_recon_loss: 2641235.9364; val_gene_expr_recon_loss: 1186358.8886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3843968.8364; val_optim_loss: 3843968.8364
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9868; val_auprc_score: 0.9852; val_best_acc_score: 0.9465; val_best_f1_score: 0.9468; train_kl_reg_loss: 16750.6601; train_edge_recon_loss: 2592385.4338; train_gene_expr_recon_loss: 1179605.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3788741.2854; train_optim_loss: 3788741.2854; val_kl_reg_loss: 16169.0364; val_edge_recon_loss: 2639135.4091; val_gene_expr_recon_loss: 1185650.1295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3840954.5727; val_optim_loss: 3840954.5727
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9870; val_auprc_score: 0.9854; val_best_acc_score: 0.9464; val_best_f1_score: 0.9467; train_kl_reg_loss: 16713.5844; train_edge_recon_loss: 2593352.4870; train_gene_expr_recon_loss: 1179479.2485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3789545.3226; train_optim_loss: 3789545.3226; val_kl_reg_loss: 16357.7338; val_edge_recon_loss: 2640564.5136; val_gene_expr_recon_loss: 1189835.7795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3846758.0318; val_optim_loss: 3846758.0318
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9867; val_auprc_score: 0.9851; val_best_acc_score: 0.9460; val_best_f1_score: 0.9464; train_kl_reg_loss: 16602.2777; train_edge_recon_loss: 2593035.7887; train_gene_expr_recon_loss: 1179178.6110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3788816.6764; train_optim_loss: 3788816.6764; val_kl_reg_loss: 16304.8419; val_edge_recon_loss: 2640844.8386; val_gene_expr_recon_loss: 1187896.2864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3845045.9727; val_optim_loss: 3845045.9727
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9869; val_auprc_score: 0.9850; val_best_acc_score: 0.9465; val_best_f1_score: 0.9470; train_kl_reg_loss: 16567.0751; train_edge_recon_loss: 2593218.7798; train_gene_expr_recon_loss: 1178710.7840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3788496.6400; train_optim_loss: 3788496.6400; val_kl_reg_loss: 15952.8970; val_edge_recon_loss: 2645384.4841; val_gene_expr_recon_loss: 1184558.1034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3845895.4750; val_optim_loss: 3845895.4750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9872; val_auprc_score: 0.9858; val_best_acc_score: 0.9469; val_best_f1_score: 0.9474; train_kl_reg_loss: 16423.3048; train_edge_recon_loss: 2591948.3198; train_gene_expr_recon_loss: 1178667.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3787038.7536; train_optim_loss: 3787038.7536; val_kl_reg_loss: 16156.0343; val_edge_recon_loss: 2643057.8364; val_gene_expr_recon_loss: 1185741.1568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3844955.0250; val_optim_loss: 3844955.0250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9877; val_auprc_score: 0.9861; val_best_acc_score: 0.9477; val_best_f1_score: 0.9482; train_kl_reg_loss: 16724.9296; train_edge_recon_loss: 2589875.0443; train_gene_expr_recon_loss: 1167943.8481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3774543.8220; train_optim_loss: 3774543.8220; val_kl_reg_loss: 16299.3716; val_edge_recon_loss: 2639291.7750; val_gene_expr_recon_loss: 1176264.0386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3831855.1909; val_optim_loss: 3831855.1909
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9879; val_auprc_score: 0.9862; val_best_acc_score: 0.9492; val_best_f1_score: 0.9497; train_kl_reg_loss: 16807.3002; train_edge_recon_loss: 2589187.3360; train_gene_expr_recon_loss: 1167454.3716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3773449.0076; train_optim_loss: 3773449.0076; val_kl_reg_loss: 16475.6411; val_edge_recon_loss: 2635684.4591; val_gene_expr_recon_loss: 1175253.2034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3827413.3045; val_optim_loss: 3827413.3045
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9875; val_auprc_score: 0.9859; val_best_acc_score: 0.9478; val_best_f1_score: 0.9481; train_kl_reg_loss: 16812.9080; train_edge_recon_loss: 2588900.8467; train_gene_expr_recon_loss: 1166897.6032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3772611.3607; train_optim_loss: 3772611.3607; val_kl_reg_loss: 16356.6016; val_edge_recon_loss: 2637952.1364; val_gene_expr_recon_loss: 1175063.2739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3829372.0295; val_optim_loss: 3829372.0295
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9880; val_auprc_score: 0.9866; val_best_acc_score: 0.9485; val_best_f1_score: 0.9490; train_kl_reg_loss: 16788.1863; train_edge_recon_loss: 2587951.2688; train_gene_expr_recon_loss: 1165996.8497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3770736.2946; train_optim_loss: 3770736.2946; val_kl_reg_loss: 16360.9466; val_edge_recon_loss: 2636727.0273; val_gene_expr_recon_loss: 1175795.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3828883.1727; val_optim_loss: 3828883.1727
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9877; val_auprc_score: 0.9861; val_best_acc_score: 0.9479; val_best_f1_score: 0.9483; train_kl_reg_loss: 16726.3051; train_edge_recon_loss: 2588226.2391; train_gene_expr_recon_loss: 1166200.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3771152.8913; train_optim_loss: 3771152.8913; val_kl_reg_loss: 16310.8069; val_edge_recon_loss: 2638510.1273; val_gene_expr_recon_loss: 1175624.1568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3830445.0841; val_optim_loss: 3830445.0841
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9877; val_auprc_score: 0.9863; val_best_acc_score: 0.9481; val_best_f1_score: 0.9483; train_kl_reg_loss: 16690.0345; train_edge_recon_loss: 2589805.7396; train_gene_expr_recon_loss: 1166074.9649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3772570.7388; train_optim_loss: 3772570.7388; val_kl_reg_loss: 16234.7740; val_edge_recon_loss: 2640451.9205; val_gene_expr_recon_loss: 1174448.9170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3831135.6159; val_optim_loss: 3831135.6159

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9882; val_auprc_score: 0.9867; val_best_acc_score: 0.9493; val_best_f1_score: 0.9495; train_kl_reg_loss: 16644.5181; train_edge_recon_loss: 2589231.9692; train_gene_expr_recon_loss: 1164339.7620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3770216.2497; train_optim_loss: 3770216.2497; val_kl_reg_loss: 16224.2918; val_edge_recon_loss: 2636583.2409; val_gene_expr_recon_loss: 1172073.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3824881.2227; val_optim_loss: 3824881.2227
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9880; val_auprc_score: 0.9863; val_best_acc_score: 0.9489; val_best_f1_score: 0.9492; train_kl_reg_loss: 16658.1431; train_edge_recon_loss: 2587676.4575; train_gene_expr_recon_loss: 1164496.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3768831.1036; train_optim_loss: 3768831.1036; val_kl_reg_loss: 16242.4479; val_edge_recon_loss: 2639415.7409; val_gene_expr_recon_loss: 1173709.3114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3829367.5205; val_optim_loss: 3829367.5205
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9879; val_auprc_score: 0.9861; val_best_acc_score: 0.9485; val_best_f1_score: 0.9488; train_kl_reg_loss: 16657.2154; train_edge_recon_loss: 2588310.5728; train_gene_expr_recon_loss: 1164099.9252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769067.7220; train_optim_loss: 3769067.7220; val_kl_reg_loss: 16240.9828; val_edge_recon_loss: 2639066.7727; val_gene_expr_recon_loss: 1173138.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3828445.9682; val_optim_loss: 3828445.9682
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9880; val_auprc_score: 0.9865; val_best_acc_score: 0.9486; val_best_f1_score: 0.9489; train_kl_reg_loss: 16655.3301; train_edge_recon_loss: 2588527.0774; train_gene_expr_recon_loss: 1164320.7132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769503.1260; train_optim_loss: 3769503.1260; val_kl_reg_loss: 16244.1234; val_edge_recon_loss: 2638588.0341; val_gene_expr_recon_loss: 1173881.2489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3828713.3977; val_optim_loss: 3828713.3977
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9880; val_auprc_score: 0.9865; val_best_acc_score: 0.9491; val_best_f1_score: 0.9495; train_kl_reg_loss: 16643.5944; train_edge_recon_loss: 2588428.7340; train_gene_expr_recon_loss: 1164690.2503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769762.5787; train_optim_loss: 3769762.5787; val_kl_reg_loss: 16238.2569; val_edge_recon_loss: 2637377.6545; val_gene_expr_recon_loss: 1173865.0148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3827480.9159; val_optim_loss: 3827480.9159

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9879; val_auprc_score: 0.9862; val_best_acc_score: 0.9485; val_best_f1_score: 0.9487; train_kl_reg_loss: 16642.1419; train_edge_recon_loss: 2588320.8788; train_gene_expr_recon_loss: 1164404.2881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769367.3040; train_optim_loss: 3769367.3040; val_kl_reg_loss: 16230.6706; val_edge_recon_loss: 2639821.6682; val_gene_expr_recon_loss: 1173265.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3829317.7659; val_optim_loss: 3829317.7659
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9881; val_auprc_score: 0.9866; val_best_acc_score: 0.9491; val_best_f1_score: 0.9494; train_kl_reg_loss: 16648.1988; train_edge_recon_loss: 2588668.0703; train_gene_expr_recon_loss: 1164019.4178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769335.6861; train_optim_loss: 3769335.6861; val_kl_reg_loss: 16237.0094; val_edge_recon_loss: 2638062.0682; val_gene_expr_recon_loss: 1173466.0591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3827765.1250; val_optim_loss: 3827765.1250
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9881; val_auprc_score: 0.9865; val_best_acc_score: 0.9489; val_best_f1_score: 0.9492; train_kl_reg_loss: 16640.7134; train_edge_recon_loss: 2588993.8363; train_gene_expr_recon_loss: 1164267.5827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3769902.1357; train_optim_loss: 3769902.1357; val_kl_reg_loss: 16240.5988; val_edge_recon_loss: 2637298.5205; val_gene_expr_recon_loss: 1172492.8693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3826031.9818; val_optim_loss: 3826031.9818
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9882; val_auprc_score: 0.9867; val_best_acc_score: 0.9492; val_best_f1_score: 0.9495; train_kl_reg_loss: 16647.3280; train_edge_recon_loss: 2588046.6828; train_gene_expr_recon_loss: 1164108.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3768802.8658; train_optim_loss: 3768802.8658; val_kl_reg_loss: 16231.8207; val_edge_recon_loss: 2637059.9273; val_gene_expr_recon_loss: 1173210.8682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3826502.6068; val_optim_loss: 3826502.6068

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 141 min 13 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9884
Val AUPRC score: 0.9872
Val best accuracy score: 0.9485
Val best F1 score: 0.9491
Val gene expr MSE score: 8.5135

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
