None
Run timestamp: 18072023_080458_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9364; val_auprc_score: 0.9295; val_best_acc_score: 0.8671; val_best_f1_score: 0.8719; train_kl_reg_loss: 98920.7206; train_edge_recon_loss: 28346365.4094; train_gene_expr_recon_loss: 14438897.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42884183.9145; train_optim_loss: 42884183.9145; val_kl_reg_loss: 113651.6069; val_edge_recon_loss: 27329785.2364; val_gene_expr_recon_loss: 13345447.6636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40788884.6182; val_optim_loss: 40788884.6182
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9556; val_auprc_score: 0.9516; val_best_acc_score: 0.8895; val_best_f1_score: 0.8923; train_kl_reg_loss: 111134.7848; train_edge_recon_loss: 26577130.4949; train_gene_expr_recon_loss: 13085847.6079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39774112.8310; train_optim_loss: 39774112.8310; val_kl_reg_loss: 102469.5594; val_edge_recon_loss: 26899626.4364; val_gene_expr_recon_loss: 12819968.7182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39822064.8364; val_optim_loss: 39822064.8364
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9661; val_auprc_score: 0.9636; val_best_acc_score: 0.9067; val_best_f1_score: 0.9080; train_kl_reg_loss: 97564.8622; train_edge_recon_loss: 26387638.5804; train_gene_expr_recon_loss: 12709327.3931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39194530.8595; train_optim_loss: 39194530.8595; val_kl_reg_loss: 83981.9402; val_edge_recon_loss: 26809559.0000; val_gene_expr_recon_loss: 12583397.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39476937.9636; val_optim_loss: 39476937.9636
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9710; val_auprc_score: 0.9694; val_best_acc_score: 0.9143; val_best_f1_score: 0.9153; train_kl_reg_loss: 85302.9217; train_edge_recon_loss: 26251248.1365; train_gene_expr_recon_loss: 12492328.4521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38828879.4868; train_optim_loss: 38828879.4868; val_kl_reg_loss: 78897.2306; val_edge_recon_loss: 26690802.1818; val_gene_expr_recon_loss: 12407333.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39177032.8727; val_optim_loss: 39177032.8727
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9721; val_auprc_score: 0.9704; val_best_acc_score: 0.9171; val_best_f1_score: 0.9176; train_kl_reg_loss: 80134.0915; train_edge_recon_loss: 26203970.4868; train_gene_expr_recon_loss: 12343803.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38627908.2363; train_optim_loss: 38627908.2363; val_kl_reg_loss: 76804.3183; val_edge_recon_loss: 26679788.2000; val_gene_expr_recon_loss: 12295471.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39052064.0000; val_optim_loss: 39052064.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9765; val_auprc_score: 0.9746; val_best_acc_score: 0.9238; val_best_f1_score: 0.9246; train_kl_reg_loss: 75112.8879; train_edge_recon_loss: 26152205.0000; train_gene_expr_recon_loss: 12235803.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38463120.8961; train_optim_loss: 38463120.8961; val_kl_reg_loss: 70195.6239; val_edge_recon_loss: 26582951.8000; val_gene_expr_recon_loss: 12196395.0545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38849542.5091; val_optim_loss: 38849542.5091
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9765; val_auprc_score: 0.9745; val_best_acc_score: 0.9238; val_best_f1_score: 0.9246; train_kl_reg_loss: 73367.0533; train_edge_recon_loss: 26085832.7597; train_gene_expr_recon_loss: 12155175.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38314375.6334; train_optim_loss: 38314375.6334; val_kl_reg_loss: 70512.2812; val_edge_recon_loss: 26588569.4545; val_gene_expr_recon_loss: 12134883.0727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38793964.7636; val_optim_loss: 38793964.7636
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9792; val_auprc_score: 0.9772; val_best_acc_score: 0.9285; val_best_f1_score: 0.9295; train_kl_reg_loss: 72093.3386; train_edge_recon_loss: 26071840.8819; train_gene_expr_recon_loss: 12090429.6110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38234363.8248; train_optim_loss: 38234363.8248; val_kl_reg_loss: 69104.0985; val_edge_recon_loss: 26567051.5455; val_gene_expr_recon_loss: 12069747.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38705903.6727; val_optim_loss: 38705903.6727
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9789; val_auprc_score: 0.9767; val_best_acc_score: 0.9281; val_best_f1_score: 0.9285; train_kl_reg_loss: 70543.9394; train_edge_recon_loss: 26060283.4603; train_gene_expr_recon_loss: 12041895.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38172723.2016; train_optim_loss: 38172723.2016; val_kl_reg_loss: 67224.1112; val_edge_recon_loss: 26514419.8000; val_gene_expr_recon_loss: 12041671.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38623315.3091; val_optim_loss: 38623315.3091
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9787; val_auprc_score: 0.9773; val_best_acc_score: 0.9273; val_best_f1_score: 0.9278; train_kl_reg_loss: 68877.8506; train_edge_recon_loss: 26047373.0692; train_gene_expr_recon_loss: 12001131.7088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38117382.7291; train_optim_loss: 38117382.7291; val_kl_reg_loss: 67032.6838; val_edge_recon_loss: 26567229.7818; val_gene_expr_recon_loss: 12017319.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38651581.6364; val_optim_loss: 38651581.6364
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9800; val_auprc_score: 0.9776; val_best_acc_score: 0.9306; val_best_f1_score: 0.9312; train_kl_reg_loss: 68194.5039; train_edge_recon_loss: 26049360.3544; train_gene_expr_recon_loss: 11970402.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38087956.8635; train_optim_loss: 38087956.8635; val_kl_reg_loss: 63812.0634; val_edge_recon_loss: 26533614.2909; val_gene_expr_recon_loss: 11989640.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38587067.2000; val_optim_loss: 38587067.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9801; val_auprc_score: 0.9782; val_best_acc_score: 0.9304; val_best_f1_score: 0.9309; train_kl_reg_loss: 67416.7538; train_edge_recon_loss: 26034859.0143; train_gene_expr_recon_loss: 11941086.6802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38043362.4277; train_optim_loss: 38043362.4277; val_kl_reg_loss: 64839.4055; val_edge_recon_loss: 26505042.6909; val_gene_expr_recon_loss: 11965063.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38534945.4545; val_optim_loss: 38534945.4545
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9804; val_auprc_score: 0.9785; val_best_acc_score: 0.9322; val_best_f1_score: 0.9328; train_kl_reg_loss: 66502.3146; train_edge_recon_loss: 26029245.0550; train_gene_expr_recon_loss: 11917162.5051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38012909.9511; train_optim_loss: 38012909.9511; val_kl_reg_loss: 63769.2095; val_edge_recon_loss: 26506409.2364; val_gene_expr_recon_loss: 11949955.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38520133.5273; val_optim_loss: 38520133.5273
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9815; val_auprc_score: 0.9793; val_best_acc_score: 0.9337; val_best_f1_score: 0.9345; train_kl_reg_loss: 65932.3883; train_edge_recon_loss: 26013654.0509; train_gene_expr_recon_loss: 11902907.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37982493.7760; train_optim_loss: 37982493.7760; val_kl_reg_loss: 61787.1904; val_edge_recon_loss: 26510322.8727; val_gene_expr_recon_loss: 11935492.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38507602.7636; val_optim_loss: 38507602.7636
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9814; val_auprc_score: 0.9792; val_best_acc_score: 0.9331; val_best_f1_score: 0.9335; train_kl_reg_loss: 64979.4450; train_edge_recon_loss: 26010114.4094; train_gene_expr_recon_loss: 11884772.4308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37959866.2770; train_optim_loss: 37959866.2770; val_kl_reg_loss: 62555.8701; val_edge_recon_loss: 26495259.4000; val_gene_expr_recon_loss: 11905870.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38463686.3273; val_optim_loss: 38463686.3273
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9810; val_auprc_score: 0.9790; val_best_acc_score: 0.9324; val_best_f1_score: 0.9333; train_kl_reg_loss: 64572.4394; train_edge_recon_loss: 26005038.6925; train_gene_expr_recon_loss: 11867420.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37937031.3360; train_optim_loss: 37937031.3360; val_kl_reg_loss: 63334.5240; val_edge_recon_loss: 26525309.3455; val_gene_expr_recon_loss: 11900104.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38488747.9273; val_optim_loss: 38488747.9273
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9814; val_auprc_score: 0.9794; val_best_acc_score: 0.9329; val_best_f1_score: 0.9338; train_kl_reg_loss: 64096.8926; train_edge_recon_loss: 26003730.9246; train_gene_expr_recon_loss: 11860483.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37928311.6945; train_optim_loss: 37928311.6945; val_kl_reg_loss: 61737.9386; val_edge_recon_loss: 26449715.1636; val_gene_expr_recon_loss: 11887863.6909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38399316.7636; val_optim_loss: 38399316.7636
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9812; val_auprc_score: 0.9791; val_best_acc_score: 0.9334; val_best_f1_score: 0.9342; train_kl_reg_loss: 63361.1461; train_edge_recon_loss: 26008706.2749; train_gene_expr_recon_loss: 11847301.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37919369.0550; train_optim_loss: 37919369.0550; val_kl_reg_loss: 61497.1393; val_edge_recon_loss: 26445755.8182; val_gene_expr_recon_loss: 11895314.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38402566.8727; val_optim_loss: 38402566.8727
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9816; val_auprc_score: 0.9794; val_best_acc_score: 0.9347; val_best_f1_score: 0.9354; train_kl_reg_loss: 63288.0480; train_edge_recon_loss: 25995028.9491; train_gene_expr_recon_loss: 11841207.1690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37899524.2648; train_optim_loss: 37899524.2648; val_kl_reg_loss: 60627.3820; val_edge_recon_loss: 26447863.0364; val_gene_expr_recon_loss: 11875867.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38384357.9273; val_optim_loss: 38384357.9273
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9818; val_auprc_score: 0.9796; val_best_acc_score: 0.9336; val_best_f1_score: 0.9341; train_kl_reg_loss: 62713.1295; train_edge_recon_loss: 25997187.6415; train_gene_expr_recon_loss: 11827298.4134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37887199.1976; train_optim_loss: 37887199.1976; val_kl_reg_loss: 59706.4607; val_edge_recon_loss: 26456919.6727; val_gene_expr_recon_loss: 11855123.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38371750.0000; val_optim_loss: 38371750.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9826; val_auprc_score: 0.9809; val_best_acc_score: 0.9357; val_best_f1_score: 0.9362; train_kl_reg_loss: 61447.2800; train_edge_recon_loss: 25990178.6823; train_gene_expr_recon_loss: 11821392.1965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37873018.1548; train_optim_loss: 37873018.1548; val_kl_reg_loss: 59590.7604; val_edge_recon_loss: 26458264.3455; val_gene_expr_recon_loss: 11870864.8273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38388719.7818; val_optim_loss: 38388719.7818
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9823; val_auprc_score: 0.9801; val_best_acc_score: 0.9356; val_best_f1_score: 0.9362; train_kl_reg_loss: 61327.5787; train_edge_recon_loss: 25974476.3523; train_gene_expr_recon_loss: 11813395.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37849199.9511; train_optim_loss: 37849199.9511; val_kl_reg_loss: 60448.2457; val_edge_recon_loss: 26448960.1273; val_gene_expr_recon_loss: 11871174.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38380583.2364; val_optim_loss: 38380583.2364
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9821; val_auprc_score: 0.9800; val_best_acc_score: 0.9351; val_best_f1_score: 0.9361; train_kl_reg_loss: 61403.0612; train_edge_recon_loss: 25971128.3483; train_gene_expr_recon_loss: 11806612.5754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37839144.0407; train_optim_loss: 37839144.0407; val_kl_reg_loss: 58054.2040; val_edge_recon_loss: 26486164.7091; val_gene_expr_recon_loss: 11866093.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38410312.0727; val_optim_loss: 38410312.0727
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9822; val_auprc_score: 0.9802; val_best_acc_score: 0.9350; val_best_f1_score: 0.9358; train_kl_reg_loss: 60944.5126; train_edge_recon_loss: 25958655.8676; train_gene_expr_recon_loss: 11801151.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37820752.0204; train_optim_loss: 37820752.0204; val_kl_reg_loss: 59040.0263; val_edge_recon_loss: 26485639.8182; val_gene_expr_recon_loss: 11848194.2545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38392874.1455; val_optim_loss: 38392874.1455

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9831; val_auprc_score: 0.9811; val_best_acc_score: 0.9369; val_best_f1_score: 0.9377; train_kl_reg_loss: 62219.4420; train_edge_recon_loss: 25950627.3096; train_gene_expr_recon_loss: 11696865.8228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37709712.5173; train_optim_loss: 37709712.5173; val_kl_reg_loss: 60100.0439; val_edge_recon_loss: 26417016.1818; val_gene_expr_recon_loss: 11761757.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38238873.5273; val_optim_loss: 38238873.5273
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9826; val_auprc_score: 0.9804; val_best_acc_score: 0.9366; val_best_f1_score: 0.9372; train_kl_reg_loss: 62660.4237; train_edge_recon_loss: 25949909.4929; train_gene_expr_recon_loss: 11687805.2413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37700375.1324; train_optim_loss: 37700375.1324; val_kl_reg_loss: 60686.4109; val_edge_recon_loss: 26438559.8909; val_gene_expr_recon_loss: 11753663.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38252909.8545; val_optim_loss: 38252909.8545
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9830; val_auprc_score: 0.9812; val_best_acc_score: 0.9368; val_best_f1_score: 0.9377; train_kl_reg_loss: 62851.8625; train_edge_recon_loss: 25944693.0733; train_gene_expr_recon_loss: 11682770.4073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37690315.2953; train_optim_loss: 37690315.2953; val_kl_reg_loss: 60779.2623; val_edge_recon_loss: 26419429.1273; val_gene_expr_recon_loss: 11755919.1545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38236127.6727; val_optim_loss: 38236127.6727
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9834; val_auprc_score: 0.9815; val_best_acc_score: 0.9378; val_best_f1_score: 0.9385; train_kl_reg_loss: 62512.3333; train_edge_recon_loss: 25944862.4521; train_gene_expr_recon_loss: 11680668.6120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37688043.4379; train_optim_loss: 37688043.4379; val_kl_reg_loss: 60137.1795; val_edge_recon_loss: 26390656.1273; val_gene_expr_recon_loss: 11746067.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38196860.4364; val_optim_loss: 38196860.4364
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9833; val_auprc_score: 0.9814; val_best_acc_score: 0.9379; val_best_f1_score: 0.9387; train_kl_reg_loss: 61928.1436; train_edge_recon_loss: 25950557.7637; train_gene_expr_recon_loss: 11685767.1792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37698253.0957; train_optim_loss: 37698253.0957; val_kl_reg_loss: 59982.6691; val_edge_recon_loss: 26390963.4000; val_gene_expr_recon_loss: 11741542.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38192488.5818; val_optim_loss: 38192488.5818
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9836; val_auprc_score: 0.9822; val_best_acc_score: 0.9379; val_best_f1_score: 0.9384; train_kl_reg_loss: 62160.9861; train_edge_recon_loss: 25950298.6558; train_gene_expr_recon_loss: 11680633.4572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37693093.1446; train_optim_loss: 37693093.1446; val_kl_reg_loss: 60543.5097; val_edge_recon_loss: 26411451.8182; val_gene_expr_recon_loss: 11739808.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38211803.8545; val_optim_loss: 38211803.8545
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9840; val_auprc_score: 0.9823; val_best_acc_score: 0.9387; val_best_f1_score: 0.9392; train_kl_reg_loss: 62092.2656; train_edge_recon_loss: 25933239.8839; train_gene_expr_recon_loss: 11676057.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37671389.9430; train_optim_loss: 37671389.9430; val_kl_reg_loss: 59444.1169; val_edge_recon_loss: 26396974.9818; val_gene_expr_recon_loss: 11747958.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38204378.1818; val_optim_loss: 38204378.1818
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9835; val_auprc_score: 0.9816; val_best_acc_score: 0.9382; val_best_f1_score: 0.9391; train_kl_reg_loss: 61875.1692; train_edge_recon_loss: 25940500.0652; train_gene_expr_recon_loss: 11674718.5010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37677093.6619; train_optim_loss: 37677093.6619; val_kl_reg_loss: 59731.2804; val_edge_recon_loss: 26370925.5091; val_gene_expr_recon_loss: 11751242.6273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38181899.3091; val_optim_loss: 38181899.3091
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9832; val_auprc_score: 0.9810; val_best_acc_score: 0.9374; val_best_f1_score: 0.9382; train_kl_reg_loss: 61739.4040; train_edge_recon_loss: 25938528.2118; train_gene_expr_recon_loss: 11673702.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37673970.0285; train_optim_loss: 37673970.0285; val_kl_reg_loss: 59814.0170; val_edge_recon_loss: 26427937.2182; val_gene_expr_recon_loss: 11742177.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38229928.6909; val_optim_loss: 38229928.6909
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9838; val_auprc_score: 0.9821; val_best_acc_score: 0.9377; val_best_f1_score: 0.9386; train_kl_reg_loss: 61498.4719; train_edge_recon_loss: 25935031.8961; train_gene_expr_recon_loss: 11672300.3717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37668830.7576; train_optim_loss: 37668830.7576; val_kl_reg_loss: 59548.7731; val_edge_recon_loss: 26415162.2545; val_gene_expr_recon_loss: 11743827.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38218538.4727; val_optim_loss: 38218538.4727
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9839; val_auprc_score: 0.9819; val_best_acc_score: 0.9391; val_best_f1_score: 0.9396; train_kl_reg_loss: 61062.2644; train_edge_recon_loss: 25936043.7352; train_gene_expr_recon_loss: 11668284.9532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37665390.8880; train_optim_loss: 37665390.8880; val_kl_reg_loss: 59029.9504; val_edge_recon_loss: 26376193.5818; val_gene_expr_recon_loss: 11748257.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38183480.6909; val_optim_loss: 38183480.6909
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9839; val_auprc_score: 0.9824; val_best_acc_score: 0.9382; val_best_f1_score: 0.9390; train_kl_reg_loss: 60686.2700; train_edge_recon_loss: 25940767.5703; train_gene_expr_recon_loss: 11672158.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37673612.5336; train_optim_loss: 37673612.5336; val_kl_reg_loss: 59068.8041; val_edge_recon_loss: 26396906.0364; val_gene_expr_recon_loss: 11746061.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38202036.6182; val_optim_loss: 38202036.6182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9839; val_auprc_score: 0.9821; val_best_acc_score: 0.9388; val_best_f1_score: 0.9395; train_kl_reg_loss: 61021.0653; train_edge_recon_loss: 25927959.7617; train_gene_expr_recon_loss: 11657400.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37646381.6253; train_optim_loss: 37646381.6253; val_kl_reg_loss: 59090.3637; val_edge_recon_loss: 26422218.2727; val_gene_expr_recon_loss: 11734989.1455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38216297.5636; val_optim_loss: 38216297.5636
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9838; val_auprc_score: 0.9821; val_best_acc_score: 0.9386; val_best_f1_score: 0.9391; train_kl_reg_loss: 60973.6985; train_edge_recon_loss: 25920250.8982; train_gene_expr_recon_loss: 11654065.3859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37635289.9796; train_optim_loss: 37635289.9796; val_kl_reg_loss: 59031.6957; val_edge_recon_loss: 26397113.6545; val_gene_expr_recon_loss: 11730658.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38186803.9636; val_optim_loss: 38186803.9636
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9839; val_auprc_score: 0.9819; val_best_acc_score: 0.9386; val_best_f1_score: 0.9394; train_kl_reg_loss: 60971.1289; train_edge_recon_loss: 25945385.6334; train_gene_expr_recon_loss: 11651959.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37658316.0204; train_optim_loss: 37658316.0204; val_kl_reg_loss: 58982.2843; val_edge_recon_loss: 26374225.9818; val_gene_expr_recon_loss: 11731726.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38164934.4364; val_optim_loss: 38164934.4364
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9838; val_auprc_score: 0.9819; val_best_acc_score: 0.9388; val_best_f1_score: 0.9397; train_kl_reg_loss: 60933.3123; train_edge_recon_loss: 25928920.1202; train_gene_expr_recon_loss: 11652030.8106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37641884.2322; train_optim_loss: 37641884.2322; val_kl_reg_loss: 58898.0548; val_edge_recon_loss: 26406967.0182; val_gene_expr_recon_loss: 11725613.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38191478.3273; val_optim_loss: 38191478.3273
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9838; val_auprc_score: 0.9819; val_best_acc_score: 0.9387; val_best_f1_score: 0.9395; train_kl_reg_loss: 60800.2899; train_edge_recon_loss: 25936522.2831; train_gene_expr_recon_loss: 11658371.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37655694.5743; train_optim_loss: 37655694.5743; val_kl_reg_loss: 58802.7258; val_edge_recon_loss: 26384883.0364; val_gene_expr_recon_loss: 11716900.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38160586.4364; val_optim_loss: 38160586.4364
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9839; val_auprc_score: 0.9818; val_best_acc_score: 0.9393; val_best_f1_score: 0.9400; train_kl_reg_loss: 60846.6539; train_edge_recon_loss: 25942843.1894; train_gene_expr_recon_loss: 11651611.4756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37655301.3279; train_optim_loss: 37655301.3279; val_kl_reg_loss: 58959.7344; val_edge_recon_loss: 26397938.2182; val_gene_expr_recon_loss: 11724851.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38181749.4182; val_optim_loss: 38181749.4182
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9843; val_auprc_score: 0.9828; val_best_acc_score: 0.9393; val_best_f1_score: 0.9399; train_kl_reg_loss: 60767.4986; train_edge_recon_loss: 25927174.4073; train_gene_expr_recon_loss: 11647930.2739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37635872.1711; train_optim_loss: 37635872.1711; val_kl_reg_loss: 58762.7429; val_edge_recon_loss: 26396243.7636; val_gene_expr_recon_loss: 11730695.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38185702.0364; val_optim_loss: 38185702.0364
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9839; val_auprc_score: 0.9820; val_best_acc_score: 0.9388; val_best_f1_score: 0.9395; train_kl_reg_loss: 60663.6030; train_edge_recon_loss: 25935337.6721; train_gene_expr_recon_loss: 11650991.1772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37646992.4847; train_optim_loss: 37646992.4847; val_kl_reg_loss: 58754.5486; val_edge_recon_loss: 26381584.2182; val_gene_expr_recon_loss: 11723587.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38163926.4727; val_optim_loss: 38163926.4727
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9835; val_auprc_score: 0.9812; val_best_acc_score: 0.9383; val_best_f1_score: 0.9392; train_kl_reg_loss: 60645.9890; train_edge_recon_loss: 25928824.6436; train_gene_expr_recon_loss: 11656213.9745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37645684.6314; train_optim_loss: 37645684.6314; val_kl_reg_loss: 58704.8234; val_edge_recon_loss: 26409023.5091; val_gene_expr_recon_loss: 11714468.5636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38182196.7273; val_optim_loss: 38182196.7273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9840; val_auprc_score: 0.9819; val_best_acc_score: 0.9394; val_best_f1_score: 0.9401; train_kl_reg_loss: 60658.6952; train_edge_recon_loss: 25937331.3075; train_gene_expr_recon_loss: 11652608.3187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37650598.2851; train_optim_loss: 37650598.2851; val_kl_reg_loss: 58709.0901; val_edge_recon_loss: 26363832.0545; val_gene_expr_recon_loss: 11721829.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38144370.6909; val_optim_loss: 38144370.6909
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9839; val_auprc_score: 0.9820; val_best_acc_score: 0.9388; val_best_f1_score: 0.9396; train_kl_reg_loss: 60621.9961; train_edge_recon_loss: 25944834.5723; train_gene_expr_recon_loss: 11650628.8310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37656085.3890; train_optim_loss: 37656085.3890; val_kl_reg_loss: 58720.3688; val_edge_recon_loss: 26377778.3455; val_gene_expr_recon_loss: 11731186.8091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38167685.6727; val_optim_loss: 38167685.6727
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9845; val_auprc_score: 0.9826; val_best_acc_score: 0.9400; val_best_f1_score: 0.9407; train_kl_reg_loss: 60609.2054; train_edge_recon_loss: 25926168.0672; train_gene_expr_recon_loss: 11652158.2271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37638935.4908; train_optim_loss: 37638935.4908; val_kl_reg_loss: 58719.3962; val_edge_recon_loss: 26347951.8727; val_gene_expr_recon_loss: 11730846.3364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38137517.6364; val_optim_loss: 38137517.6364
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9841; val_auprc_score: 0.9824; val_best_acc_score: 0.9391; val_best_f1_score: 0.9399; train_kl_reg_loss: 60642.0576; train_edge_recon_loss: 25938330.9348; train_gene_expr_recon_loss: 11649283.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37648256.0244; train_optim_loss: 37648256.0244; val_kl_reg_loss: 58712.8686; val_edge_recon_loss: 26407022.6727; val_gene_expr_recon_loss: 11730922.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38196658.1818; val_optim_loss: 38196658.1818
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9840; val_auprc_score: 0.9821; val_best_acc_score: 0.9393; val_best_f1_score: 0.9398; train_kl_reg_loss: 60651.7124; train_edge_recon_loss: 25935761.6904; train_gene_expr_recon_loss: 11652373.5143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37648786.9084; train_optim_loss: 37648786.9084; val_kl_reg_loss: 58600.9661; val_edge_recon_loss: 26365192.1455; val_gene_expr_recon_loss: 11723102.3545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38146895.3455; val_optim_loss: 38146895.3455
