None
Run timestamp: 01072023_222634_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9747; val_auprc_score: 0.9690; val_best_acc_score: 0.9251; val_best_f1_score: 0.9276; train_kl_reg_loss: 5088.1538; train_edge_recon_loss: 266220.9578; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271309.1116; train_optim_loss: 271309.1116; val_kl_reg_loss: 4801.5343; val_edge_recon_loss: 262776.4775; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267578.0121; val_optim_loss: 267578.0121
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9787; val_auprc_score: 0.9734; val_best_acc_score: 0.9344; val_best_f1_score: 0.9363; train_kl_reg_loss: 5095.7900; train_edge_recon_loss: 261498.2623; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266594.0524; train_optim_loss: 266594.0524; val_kl_reg_loss: 5029.6680; val_edge_recon_loss: 262124.9036; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267154.5719; val_optim_loss: 267154.5719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9821; val_auprc_score: 0.9771; val_best_acc_score: 0.9420; val_best_f1_score: 0.9435; train_kl_reg_loss: 5099.3854; train_edge_recon_loss: 260831.5201; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265930.9058; train_optim_loss: 265930.9058; val_kl_reg_loss: 5022.6253; val_edge_recon_loss: 261504.6680; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266527.2945; val_optim_loss: 266527.2945
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9844; val_auprc_score: 0.9799; val_best_acc_score: 0.9474; val_best_f1_score: 0.9485; train_kl_reg_loss: 5095.2613; train_edge_recon_loss: 260338.9561; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265434.2173; train_optim_loss: 265434.2173; val_kl_reg_loss: 5007.3620; val_edge_recon_loss: 260979.9961; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265987.3588; val_optim_loss: 265987.3588
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9845; val_auprc_score: 0.9803; val_best_acc_score: 0.9473; val_best_f1_score: 0.9486; train_kl_reg_loss: 5088.3114; train_edge_recon_loss: 260098.8384; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265187.1493; train_optim_loss: 265187.1493; val_kl_reg_loss: 5145.3372; val_edge_recon_loss: 260820.2724; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265965.6091; val_optim_loss: 265965.6091
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9862; val_auprc_score: 0.9820; val_best_acc_score: 0.9519; val_best_f1_score: 0.9529; train_kl_reg_loss: 5089.6075; train_edge_recon_loss: 259845.7899; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264935.3974; train_optim_loss: 264935.3974; val_kl_reg_loss: 5085.2279; val_edge_recon_loss: 260872.3949; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265957.6237; val_optim_loss: 265957.6237
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9867; val_auprc_score: 0.9829; val_best_acc_score: 0.9525; val_best_f1_score: 0.9533; train_kl_reg_loss: 5095.3908; train_edge_recon_loss: 259729.7686; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264825.1594; train_optim_loss: 264825.1594; val_kl_reg_loss: 5131.0017; val_edge_recon_loss: 260109.5174; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265240.5184; val_optim_loss: 265240.5184
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9875; val_auprc_score: 0.9838; val_best_acc_score: 0.9548; val_best_f1_score: 0.9559; train_kl_reg_loss: 5101.5713; train_edge_recon_loss: 259458.6086; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264560.1797; train_optim_loss: 264560.1797; val_kl_reg_loss: 5007.5859; val_edge_recon_loss: 260174.2975; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265181.8833; val_optim_loss: 265181.8833
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9879; val_auprc_score: 0.9841; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 5102.9783; train_edge_recon_loss: 259347.1424; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264450.1206; train_optim_loss: 264450.1206; val_kl_reg_loss: 5106.6883; val_edge_recon_loss: 260118.3444; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265225.0337; val_optim_loss: 265225.0337
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9849; val_best_acc_score: 0.9558; val_best_f1_score: 0.9566; train_kl_reg_loss: 5103.5093; train_edge_recon_loss: 259332.4597; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264435.9686; train_optim_loss: 264435.9686; val_kl_reg_loss: 5039.0812; val_edge_recon_loss: 260002.6976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265041.7787; val_optim_loss: 265041.7787
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9890; val_auprc_score: 0.9859; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 5103.0460; train_edge_recon_loss: 259254.6012; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264357.6470; train_optim_loss: 264357.6470; val_kl_reg_loss: 4910.9796; val_edge_recon_loss: 260159.8857; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265070.8654; val_optim_loss: 265070.8654
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9890; val_auprc_score: 0.9856; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 5105.2702; train_edge_recon_loss: 259108.6378; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264213.9081; train_optim_loss: 264213.9081; val_kl_reg_loss: 4991.2818; val_edge_recon_loss: 259615.0962; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264606.3772; val_optim_loss: 264606.3772
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9893; val_auprc_score: 0.9860; val_best_acc_score: 0.9600; val_best_f1_score: 0.9607; train_kl_reg_loss: 5113.5532; train_edge_recon_loss: 259022.0160; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264135.5691; train_optim_loss: 264135.5691; val_kl_reg_loss: 5182.1746; val_edge_recon_loss: 259859.8848; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265042.0593; val_optim_loss: 265042.0593
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 5114.1484; train_edge_recon_loss: 258991.5181; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264105.6668; train_optim_loss: 264105.6668; val_kl_reg_loss: 4961.1497; val_edge_recon_loss: 259438.6011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264399.7504; val_optim_loss: 264399.7504
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9894; val_auprc_score: 0.9860; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 5112.1827; train_edge_recon_loss: 258784.4996; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263896.6822; train_optim_loss: 263896.6822; val_kl_reg_loss: 5175.0445; val_edge_recon_loss: 259573.8793; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264748.9243; val_optim_loss: 264748.9243
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9902; val_auprc_score: 0.9872; val_best_acc_score: 0.9610; val_best_f1_score: 0.9617; train_kl_reg_loss: 5123.1345; train_edge_recon_loss: 258695.2366; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263818.3710; train_optim_loss: 263818.3710; val_kl_reg_loss: 5053.2695; val_edge_recon_loss: 259354.4827; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264407.7524; val_optim_loss: 264407.7524
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9904; val_auprc_score: 0.9872; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 5117.6105; train_edge_recon_loss: 258793.6162; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263911.2269; train_optim_loss: 263911.2269; val_kl_reg_loss: 5124.0620; val_edge_recon_loss: 259451.2555; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264575.3175; val_optim_loss: 264575.3175
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 5120.4050; train_edge_recon_loss: 258723.2411; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263843.6461; train_optim_loss: 263843.6461; val_kl_reg_loss: 5101.5355; val_edge_recon_loss: 259441.2129; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264542.7482; val_optim_loss: 264542.7482

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 5105.4015; train_edge_recon_loss: 258508.8702; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263614.2718; train_optim_loss: 263614.2718; val_kl_reg_loss: 5044.1935; val_edge_recon_loss: 259020.5325; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264064.7269; val_optim_loss: 264064.7269
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9913; val_auprc_score: 0.9883; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 5098.8056; train_edge_recon_loss: 258394.6195; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263493.4256; train_optim_loss: 263493.4256; val_kl_reg_loss: 5061.2608; val_edge_recon_loss: 258730.1135; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263791.3743; val_optim_loss: 263791.3743
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 5100.4051; train_edge_recon_loss: 258279.6016; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263380.0066; train_optim_loss: 263380.0066; val_kl_reg_loss: 5065.0973; val_edge_recon_loss: 259003.4473; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264068.5445; val_optim_loss: 264068.5445
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9914; val_auprc_score: 0.9884; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 5095.9828; train_edge_recon_loss: 258430.5458; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263526.5285; train_optim_loss: 263526.5285; val_kl_reg_loss: 5049.2727; val_edge_recon_loss: 258930.1679; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263979.4404; val_optim_loss: 263979.4404
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9884; val_best_acc_score: 0.9652; val_best_f1_score: 0.9656; train_kl_reg_loss: 5097.0466; train_edge_recon_loss: 258250.1183; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263347.1650; train_optim_loss: 263347.1650; val_kl_reg_loss: 5080.6774; val_edge_recon_loss: 258757.6287; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263838.3057; val_optim_loss: 263838.3057
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5091.9766; train_edge_recon_loss: 258377.7845; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263469.7609; train_optim_loss: 263469.7609; val_kl_reg_loss: 5086.2617; val_edge_recon_loss: 259041.6111; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264127.8725; val_optim_loss: 264127.8725

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 5095.3801; train_edge_recon_loss: 258293.3852; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263388.7654; train_optim_loss: 263388.7654; val_kl_reg_loss: 5051.8724; val_edge_recon_loss: 258750.6160; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263802.4873; val_optim_loss: 263802.4873
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 5094.0276; train_edge_recon_loss: 258288.8566; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263382.8841; train_optim_loss: 263382.8841; val_kl_reg_loss: 5035.8786; val_edge_recon_loss: 258896.1298; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263932.0083; val_optim_loss: 263932.0083
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 5094.6307; train_edge_recon_loss: 258253.0765; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263347.7068; train_optim_loss: 263347.7068; val_kl_reg_loss: 5050.9607; val_edge_recon_loss: 258613.9479; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263664.9089; val_optim_loss: 263664.9089
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5094.5436; train_edge_recon_loss: 258220.2541; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263314.7977; train_optim_loss: 263314.7977; val_kl_reg_loss: 5048.0944; val_edge_recon_loss: 259045.2075; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264093.3016; val_optim_loss: 264093.3016
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9914; val_auprc_score: 0.9883; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 5093.9939; train_edge_recon_loss: 258219.9359; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263313.9297; train_optim_loss: 263313.9297; val_kl_reg_loss: 5049.7335; val_edge_recon_loss: 258696.7683; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263746.5019; val_optim_loss: 263746.5019
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9917; val_auprc_score: 0.9890; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 5093.5092; train_edge_recon_loss: 258308.5666; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263402.0757; train_optim_loss: 263402.0757; val_kl_reg_loss: 5050.1057; val_edge_recon_loss: 258843.6391; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263893.7442; val_optim_loss: 263893.7442
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 5094.4431; train_edge_recon_loss: 258276.0860; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263370.5289; train_optim_loss: 263370.5289; val_kl_reg_loss: 5043.6992; val_edge_recon_loss: 258711.9103; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263755.6104; val_optim_loss: 263755.6104

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 5095.3854; train_edge_recon_loss: 258295.4265; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263390.8122; train_optim_loss: 263390.8122; val_kl_reg_loss: 5046.1147; val_edge_recon_loss: 258912.5583; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263958.6738; val_optim_loss: 263958.6738
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9917; val_auprc_score: 0.9890; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5093.5037; train_edge_recon_loss: 258329.9234; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263423.4272; train_optim_loss: 263423.4272; val_kl_reg_loss: 5046.1608; val_edge_recon_loss: 258642.8695; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263689.0292; val_optim_loss: 263689.0292
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9916; val_auprc_score: 0.9887; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 5094.5663; train_edge_recon_loss: 258248.2364; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263342.8026; train_optim_loss: 263342.8026; val_kl_reg_loss: 5048.0414; val_edge_recon_loss: 258993.7217; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264041.7636; val_optim_loss: 264041.7636
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 5093.5294; train_edge_recon_loss: 258287.5437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263381.0733; train_optim_loss: 263381.0733; val_kl_reg_loss: 5045.5220; val_edge_recon_loss: 258755.9996; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263801.5217; val_optim_loss: 263801.5217

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 26 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9916
Val AUPRC score: 0.9888
Val best accuracy score: 0.9660
Val best F1 score: 0.9664
Val gene expr MSE score: 5.1420

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
