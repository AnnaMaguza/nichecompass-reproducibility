Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5425.4535; train_edge_recon_loss: 256672.4097; train_gene_expr_recon_loss: 6888.1420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268986.0052; train_optim_loss: 268986.0052; val_kl_reg_loss: 5406.2805; val_edge_recon_loss: 255918.7245; val_gene_expr_recon_loss: 6826.1233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268151.1278; val_optim_loss: 268151.1278
None
Run timestamp: 01072023_235654_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9861; val_auprc_score: 0.9834; val_best_acc_score: 0.9466; val_best_f1_score: 0.9476; train_kl_reg_loss: 5076.2125; train_edge_recon_loss: 264018.4340; train_gene_expr_recon_loss: 8658.9183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277753.5645; train_optim_loss: 277753.5645; val_kl_reg_loss: 5011.9741; val_edge_recon_loss: 261452.7906; val_gene_expr_recon_loss: 7825.7615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274290.5254; val_optim_loss: 274290.5254
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 5423.9084; train_edge_recon_loss: 256698.5424; train_gene_expr_recon_loss: 6887.6600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269010.1110; train_optim_loss: 269010.1110; val_kl_reg_loss: 5406.5101; val_edge_recon_loss: 255976.2510; val_gene_expr_recon_loss: 6823.7435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268206.5042; val_optim_loss: 268206.5042
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9605; val_best_f1_score: 0.9612; train_kl_reg_loss: 5139.2391; train_edge_recon_loss: 260505.8848; train_gene_expr_recon_loss: 7683.9987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273329.1228; train_optim_loss: 273329.1228; val_kl_reg_loss: 5005.7442; val_edge_recon_loss: 259899.9609; val_gene_expr_recon_loss: 7556.3294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272462.0348; val_optim_loss: 272462.0348
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 5422.4836; train_edge_recon_loss: 256708.5292; train_gene_expr_recon_loss: 6888.0881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269019.1010; train_optim_loss: 269019.1010; val_kl_reg_loss: 5424.7363; val_edge_recon_loss: 255779.4972; val_gene_expr_recon_loss: 6822.3384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268026.5716; val_optim_loss: 268026.5716
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9905; val_auprc_score: 0.9876; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 5166.6881; train_edge_recon_loss: 259601.5821; train_gene_expr_recon_loss: 7449.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272218.1203; train_optim_loss: 272218.1203; val_kl_reg_loss: 5187.8548; val_edge_recon_loss: 260296.6534; val_gene_expr_recon_loss: 7382.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272866.5904; val_optim_loss: 272866.5904
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 5423.8198; train_edge_recon_loss: 256627.8248; train_gene_expr_recon_loss: 6887.8476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268939.4923; train_optim_loss: 268939.4923; val_kl_reg_loss: 5409.0083; val_edge_recon_loss: 255985.0580; val_gene_expr_recon_loss: 6829.0152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268223.0834; val_optim_loss: 268223.0834
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 5187.5257; train_edge_recon_loss: 259208.8502; train_gene_expr_recon_loss: 7324.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271721.0196; train_optim_loss: 271721.0196; val_kl_reg_loss: 5193.6015; val_edge_recon_loss: 259150.7821; val_gene_expr_recon_loss: 7231.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271576.3501; val_optim_loss: 271576.3501
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5426.5566; train_edge_recon_loss: 256610.4000; train_gene_expr_recon_loss: 6886.5171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268923.4744; train_optim_loss: 268923.4744; val_kl_reg_loss: 5419.3612; val_edge_recon_loss: 255856.5213; val_gene_expr_recon_loss: 6826.1022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268101.9848; val_optim_loss: 268101.9848
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9936; val_auprc_score: 0.9920; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 5199.7970; train_edge_recon_loss: 258975.1065; train_gene_expr_recon_loss: 7240.5552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271415.4591; train_optim_loss: 271415.4591; val_kl_reg_loss: 5052.7130; val_edge_recon_loss: 258379.7296; val_gene_expr_recon_loss: 7167.0142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270599.4564; val_optim_loss: 270599.4564
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 5212.6688; train_edge_recon_loss: 258611.7557; train_gene_expr_recon_loss: 7178.8933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271003.3176; train_optim_loss: 271003.3176; val_kl_reg_loss: 5110.4644; val_edge_recon_loss: 258429.1895; val_gene_expr_recon_loss: 7110.8221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270650.4757; val_optim_loss: 270650.4757
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 5425.3197; train_edge_recon_loss: 256561.2831; train_gene_expr_recon_loss: 6887.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268874.5137; train_optim_loss: 268874.5137; val_kl_reg_loss: 5403.9948; val_edge_recon_loss: 255890.5405; val_gene_expr_recon_loss: 6828.5689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268123.1045; val_optim_loss: 268123.1045
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 5218.1077; train_edge_recon_loss: 258600.7728; train_gene_expr_recon_loss: 7142.8499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270961.7304; train_optim_loss: 270961.7304; val_kl_reg_loss: 5246.7240; val_edge_recon_loss: 258597.7276; val_gene_expr_recon_loss: 7078.2142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270922.6659; val_optim_loss: 270922.6659
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 5423.3888; train_edge_recon_loss: 256648.1665; train_gene_expr_recon_loss: 6885.0950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268956.6504; train_optim_loss: 268956.6504; val_kl_reg_loss: 5395.1177; val_edge_recon_loss: 255921.7355; val_gene_expr_recon_loss: 6829.7028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268146.5555; val_optim_loss: 268146.5555
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 5232.5903; train_edge_recon_loss: 258230.4114; train_gene_expr_recon_loss: 7102.6105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270565.6120; train_optim_loss: 270565.6120; val_kl_reg_loss: 5338.0747; val_edge_recon_loss: 257975.9990; val_gene_expr_recon_loss: 7009.5009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270323.5753; val_optim_loss: 270323.5753

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5423.9804; train_edge_recon_loss: 256628.6579; train_gene_expr_recon_loss: 6882.1129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268934.7513; train_optim_loss: 268934.7513; val_kl_reg_loss: 5401.8969; val_edge_recon_loss: 255792.3732; val_gene_expr_recon_loss: 6819.2402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268013.5096; val_optim_loss: 268013.5096
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5237.1398; train_edge_recon_loss: 258186.6356; train_gene_expr_recon_loss: 7073.3956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270497.1709; train_optim_loss: 270497.1709; val_kl_reg_loss: 5395.2946; val_edge_recon_loss: 257967.7212; val_gene_expr_recon_loss: 6994.3865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270357.4019; val_optim_loss: 270357.4019
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9967; val_auprc_score: 0.9954; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5421.4592; train_edge_recon_loss: 256633.1358; train_gene_expr_recon_loss: 6875.2501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268929.8451; train_optim_loss: 268929.8451; val_kl_reg_loss: 5405.5719; val_edge_recon_loss: 255849.8063; val_gene_expr_recon_loss: 6815.8122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268071.1909; val_optim_loss: 268071.1909
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 5245.6316; train_edge_recon_loss: 258033.1068; train_gene_expr_recon_loss: 7046.1721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270324.9106; train_optim_loss: 270324.9106; val_kl_reg_loss: 5075.2891; val_edge_recon_loss: 257708.1067; val_gene_expr_recon_loss: 6974.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269757.7352; val_optim_loss: 269757.7352
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5250.0441; train_edge_recon_loss: 257994.5831; train_gene_expr_recon_loss: 7026.3756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270271.0033; train_optim_loss: 270271.0033; val_kl_reg_loss: 5377.9762; val_edge_recon_loss: 257419.3221; val_gene_expr_recon_loss: 6948.4682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269745.7668; val_optim_loss: 269745.7668
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5422.0833; train_edge_recon_loss: 256567.2385; train_gene_expr_recon_loss: 6878.3415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268867.6629; train_optim_loss: 268867.6629; val_kl_reg_loss: 5415.9404; val_edge_recon_loss: 255795.1941; val_gene_expr_recon_loss: 6821.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268033.0760; val_optim_loss: 268033.0760
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 5257.7056; train_edge_recon_loss: 257788.5864; train_gene_expr_recon_loss: 7007.6407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270053.9328; train_optim_loss: 270053.9328; val_kl_reg_loss: 5108.7780; val_edge_recon_loss: 257576.9545; val_gene_expr_recon_loss: 6937.1190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269622.8505; val_optim_loss: 269622.8505
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5421.4736; train_edge_recon_loss: 256620.0955; train_gene_expr_recon_loss: 6877.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268918.7740; train_optim_loss: 268918.7740; val_kl_reg_loss: 5413.4117; val_edge_recon_loss: 255881.2871; val_gene_expr_recon_loss: 6821.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268116.0474; val_optim_loss: 268116.0474
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5264.9230; train_edge_recon_loss: 257781.3595; train_gene_expr_recon_loss: 6998.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270044.2852; train_optim_loss: 270044.2852; val_kl_reg_loss: 5323.8266; val_edge_recon_loss: 257752.5170; val_gene_expr_recon_loss: 6932.4747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270008.8186; val_optim_loss: 270008.8186
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 5420.7129; train_edge_recon_loss: 256645.5497; train_gene_expr_recon_loss: 6877.4437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268943.7060; train_optim_loss: 268943.7060; val_kl_reg_loss: 5415.7780; val_edge_recon_loss: 255800.5121; val_gene_expr_recon_loss: 6819.3357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268035.6262; val_optim_loss: 268035.6262
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5265.3251; train_edge_recon_loss: 257693.5502; train_gene_expr_recon_loss: 6983.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269942.2810; train_optim_loss: 269942.2810; val_kl_reg_loss: 5205.3274; val_edge_recon_loss: 257228.4004; val_gene_expr_recon_loss: 6910.0940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269343.8235; val_optim_loss: 269343.8235

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5419.6373; train_edge_recon_loss: 256604.7151; train_gene_expr_recon_loss: 6876.2430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268900.5956; train_optim_loss: 268900.5956; val_kl_reg_loss: 5404.3528; val_edge_recon_loss: 256022.8928; val_gene_expr_recon_loss: 6823.1865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268250.4335; val_optim_loss: 268250.4335
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 5268.9598; train_edge_recon_loss: 257591.2514; train_gene_expr_recon_loss: 6972.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269832.5291; train_optim_loss: 269832.5291; val_kl_reg_loss: 5382.5469; val_edge_recon_loss: 257434.8763; val_gene_expr_recon_loss: 6890.8198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269708.2430; val_optim_loss: 269708.2430
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 5274.7153; train_edge_recon_loss: 257448.1070; train_gene_expr_recon_loss: 6970.0021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269692.8243; train_optim_loss: 269692.8243; val_kl_reg_loss: 5160.2225; val_edge_recon_loss: 257012.3647; val_gene_expr_recon_loss: 6889.0731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269061.6604; val_optim_loss: 269061.6604
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 5420.0460; train_edge_recon_loss: 256566.6721; train_gene_expr_recon_loss: 6877.8837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268864.6016; train_optim_loss: 268864.6016; val_kl_reg_loss: 5405.2394; val_edge_recon_loss: 255959.7954; val_gene_expr_recon_loss: 6827.4471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268192.4819; val_optim_loss: 268192.4819
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5275.9083; train_edge_recon_loss: 257531.5464; train_gene_expr_recon_loss: 6955.9370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269763.3916; train_optim_loss: 269763.3916; val_kl_reg_loss: 5077.9431; val_edge_recon_loss: 257165.1761; val_gene_expr_recon_loss: 6886.2008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269129.3194; val_optim_loss: 269129.3194
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 5420.0760; train_edge_recon_loss: 256630.4184; train_gene_expr_recon_loss: 6878.4724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268928.9666; train_optim_loss: 268928.9666; val_kl_reg_loss: 5404.5102; val_edge_recon_loss: 255748.5759; val_gene_expr_recon_loss: 6812.8527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267965.9387; val_optim_loss: 267965.9387
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5278.0005; train_edge_recon_loss: 257360.3018; train_gene_expr_recon_loss: 6951.3748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269589.6772; train_optim_loss: 269589.6772; val_kl_reg_loss: 5332.5024; val_edge_recon_loss: 256779.9205; val_gene_expr_recon_loss: 6885.7413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268998.1654; val_optim_loss: 268998.1654
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5418.9007; train_edge_recon_loss: 256637.6308; train_gene_expr_recon_loss: 6879.6090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268936.1403; train_optim_loss: 268936.1403; val_kl_reg_loss: 5406.9118; val_edge_recon_loss: 255847.9435; val_gene_expr_recon_loss: 6823.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268078.0653; val_optim_loss: 268078.0653
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 5281.0623; train_edge_recon_loss: 257339.8500; train_gene_expr_recon_loss: 6944.2306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269565.1426; train_optim_loss: 269565.1426; val_kl_reg_loss: 5346.5329; val_edge_recon_loss: 257014.5271; val_gene_expr_recon_loss: 6856.6917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269217.7510; val_optim_loss: 269217.7510
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 5421.4553; train_edge_recon_loss: 256525.3491; train_gene_expr_recon_loss: 6877.4454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268824.2499; train_optim_loss: 268824.2499; val_kl_reg_loss: 5411.5836; val_edge_recon_loss: 255873.5318; val_gene_expr_recon_loss: 6815.5076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268100.6225; val_optim_loss: 268100.6225
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 5286.0646; train_edge_recon_loss: 257309.4176; train_gene_expr_recon_loss: 6938.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269533.7139; train_optim_loss: 269533.7139; val_kl_reg_loss: 5286.0619; val_edge_recon_loss: 256641.3895; val_gene_expr_recon_loss: 6844.2690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268771.7213; val_optim_loss: 268771.7213
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 5421.9458; train_edge_recon_loss: 256609.6519; train_gene_expr_recon_loss: 6877.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268908.6968; train_optim_loss: 268908.6968; val_kl_reg_loss: 5405.5783; val_edge_recon_loss: 255796.5294; val_gene_expr_recon_loss: 6813.8822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268015.9900; val_optim_loss: 268015.9900
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 5287.3643; train_edge_recon_loss: 257199.3991; train_gene_expr_recon_loss: 6931.8600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269418.6230; train_optim_loss: 269418.6230; val_kl_reg_loss: 5207.0494; val_edge_recon_loss: 257096.1617; val_gene_expr_recon_loss: 6854.8579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269158.0685; val_optim_loss: 269158.0685
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 5290.3519; train_edge_recon_loss: 257210.7773; train_gene_expr_recon_loss: 6927.5955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269428.7246; train_optim_loss: 269428.7246; val_kl_reg_loss: 5254.2632; val_edge_recon_loss: 256716.4196; val_gene_expr_recon_loss: 6845.1773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268815.8600; val_optim_loss: 268815.8600
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 5420.3055; train_edge_recon_loss: 256604.4192; train_gene_expr_recon_loss: 6877.4396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268902.1642; train_optim_loss: 268902.1642; val_kl_reg_loss: 5408.4371; val_edge_recon_loss: 255868.4660; val_gene_expr_recon_loss: 6813.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268090.0354; val_optim_loss: 268090.0354
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 5293.6112; train_edge_recon_loss: 257189.4436; train_gene_expr_recon_loss: 6921.0537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269404.1082; train_optim_loss: 269404.1082; val_kl_reg_loss: 5254.8061; val_edge_recon_loss: 256995.3981; val_gene_expr_recon_loss: 6837.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269087.6720; val_optim_loss: 269087.6720

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 5420.9638; train_edge_recon_loss: 256547.5626; train_gene_expr_recon_loss: 6879.4533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268847.9796; train_optim_loss: 268847.9796; val_kl_reg_loss: 5408.4492; val_edge_recon_loss: 255863.2180; val_gene_expr_recon_loss: 6815.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268086.8779; val_optim_loss: 268086.8779
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5295.1540; train_edge_recon_loss: 257124.8917; train_gene_expr_recon_loss: 6915.5760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269335.6215; train_optim_loss: 269335.6215; val_kl_reg_loss: 5106.4798; val_edge_recon_loss: 256966.4331; val_gene_expr_recon_loss: 6847.6324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268920.5467; val_optim_loss: 268920.5467
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 5421.0771; train_edge_recon_loss: 256583.8934; train_gene_expr_recon_loss: 6876.6677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268881.6386; train_optim_loss: 268881.6386; val_kl_reg_loss: 5408.8941; val_edge_recon_loss: 255938.9844; val_gene_expr_recon_loss: 6823.8859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268171.7642; val_optim_loss: 268171.7642

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 5281.5374; train_edge_recon_loss: 256917.2347; train_gene_expr_recon_loss: 6883.2317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269082.0035; train_optim_loss: 269082.0035; val_kl_reg_loss: 5218.0443; val_edge_recon_loss: 256171.4037; val_gene_expr_recon_loss: 6799.4045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268188.8527; val_optim_loss: 268188.8527
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 5420.9975; train_edge_recon_loss: 256591.4391; train_gene_expr_recon_loss: 6873.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268886.3762; train_optim_loss: 268886.3762; val_kl_reg_loss: 5408.8450; val_edge_recon_loss: 255778.3813; val_gene_expr_recon_loss: 6824.5745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268011.8005; val_optim_loss: 268011.8005
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 5277.9764; train_edge_recon_loss: 256851.1501; train_gene_expr_recon_loss: 6875.0961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269004.2226; train_optim_loss: 269004.2226; val_kl_reg_loss: 5201.1675; val_edge_recon_loss: 256202.9436; val_gene_expr_recon_loss: 6806.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268210.6657; val_optim_loss: 268210.6657
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5421.5575; train_edge_recon_loss: 256594.6906; train_gene_expr_recon_loss: 6876.3515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268892.5993; train_optim_loss: 268892.5993; val_kl_reg_loss: 5408.2731; val_edge_recon_loss: 256072.1384; val_gene_expr_recon_loss: 6818.9160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268299.3269; val_optim_loss: 268299.3269

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1150 min 57 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9952
Val best accuracy score: 0.9825
Val best F1 score: 0.9826
Val gene expr MSE score: 1.8315

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5276.4536; train_edge_recon_loss: 256872.0755; train_gene_expr_recon_loss: 6874.1056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269022.6349; train_optim_loss: 269022.6349; val_kl_reg_loss: 5252.9194; val_edge_recon_loss: 256023.4475; val_gene_expr_recon_loss: 6796.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268072.8722; val_optim_loss: 268072.8722
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5274.1001; train_edge_recon_loss: 256838.3990; train_gene_expr_recon_loss: 6869.5715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268982.0711; train_optim_loss: 268982.0711; val_kl_reg_loss: 5256.5897; val_edge_recon_loss: 256134.8406; val_gene_expr_recon_loss: 6789.3554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268180.7853; val_optim_loss: 268180.7853
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5272.8243; train_edge_recon_loss: 256808.1690; train_gene_expr_recon_loss: 6870.1433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268951.1367; train_optim_loss: 268951.1367; val_kl_reg_loss: 5265.5272; val_edge_recon_loss: 256485.9185; val_gene_expr_recon_loss: 6793.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268545.3309; val_optim_loss: 268545.3309
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5274.8155; train_edge_recon_loss: 256825.8830; train_gene_expr_recon_loss: 6869.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268970.6606; train_optim_loss: 268970.6606; val_kl_reg_loss: 5244.6252; val_edge_recon_loss: 256129.5445; val_gene_expr_recon_loss: 6790.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268164.7822; val_optim_loss: 268164.7822
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5272.6972; train_edge_recon_loss: 256832.7200; train_gene_expr_recon_loss: 6871.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268976.4970; train_optim_loss: 268976.4970; val_kl_reg_loss: 5275.2857; val_edge_recon_loss: 256143.9881; val_gene_expr_recon_loss: 6792.9908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268212.2652; val_optim_loss: 268212.2652

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5271.2692; train_edge_recon_loss: 256816.4429; train_gene_expr_recon_loss: 6866.9135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268954.6256; train_optim_loss: 268954.6256; val_kl_reg_loss: 5255.1845; val_edge_recon_loss: 256058.5473; val_gene_expr_recon_loss: 6790.3751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268104.1069; val_optim_loss: 268104.1069
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5270.1788; train_edge_recon_loss: 256781.1482; train_gene_expr_recon_loss: 6864.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268915.9441; train_optim_loss: 268915.9441; val_kl_reg_loss: 5259.4052; val_edge_recon_loss: 256218.2582; val_gene_expr_recon_loss: 6794.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268271.9952; val_optim_loss: 268271.9952
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 5271.7673; train_edge_recon_loss: 256728.1774; train_gene_expr_recon_loss: 6863.6611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268863.6061; train_optim_loss: 268863.6061; val_kl_reg_loss: 5253.7002; val_edge_recon_loss: 256049.1619; val_gene_expr_recon_loss: 6792.1810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268095.0431; val_optim_loss: 268095.0431
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 5271.8747; train_edge_recon_loss: 256801.5487; train_gene_expr_recon_loss: 6862.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268935.9789; train_optim_loss: 268935.9789; val_kl_reg_loss: 5255.9413; val_edge_recon_loss: 256122.8692; val_gene_expr_recon_loss: 6796.1843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268174.9954; val_optim_loss: 268174.9954

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 664 min 15 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9949
Val best accuracy score: 0.9811
Val best F1 score: 0.9813
Val gene expr MSE score: 1.9265

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
