None
Run timestamp: 01072023_123530_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9857; val_auprc_score: 0.9830; val_best_acc_score: 0.9461; val_best_f1_score: 0.9472; train_kl_reg_loss: 5226.2470; train_edge_recon_loss: 264227.9973; train_gene_expr_recon_loss: 8658.2430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278112.4872; train_optim_loss: 278112.4872; val_kl_reg_loss: 5146.6250; val_edge_recon_loss: 261233.6762; val_gene_expr_recon_loss: 7892.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274272.6640; val_optim_loss: 274272.6640
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9888; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 5285.5318; train_edge_recon_loss: 260559.7847; train_gene_expr_recon_loss: 7719.8697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273565.1864; train_optim_loss: 273565.1864; val_kl_reg_loss: 5404.8446; val_edge_recon_loss: 260251.6524; val_gene_expr_recon_loss: 7543.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273200.3273; val_optim_loss: 273200.3273
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9896; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 5312.2000; train_edge_recon_loss: 259741.1800; train_gene_expr_recon_loss: 7476.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272529.4760; train_optim_loss: 272529.4760; val_kl_reg_loss: 5246.3235; val_edge_recon_loss: 259408.9459; val_gene_expr_recon_loss: 7373.5801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272028.8495; val_optim_loss: 272028.8495
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9658; val_best_f1_score: 0.9662; train_kl_reg_loss: 5334.5081; train_edge_recon_loss: 259230.0533; train_gene_expr_recon_loss: 7352.6694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271917.2312; train_optim_loss: 271917.2312; val_kl_reg_loss: 5388.0218; val_edge_recon_loss: 258757.8550; val_gene_expr_recon_loss: 7223.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271368.9796; val_optim_loss: 271368.9796
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9677; val_best_f1_score: 0.9681; train_kl_reg_loss: 5349.8842; train_edge_recon_loss: 258929.6084; train_gene_expr_recon_loss: 7279.9685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271559.4610; train_optim_loss: 271559.4610; val_kl_reg_loss: 5473.0181; val_edge_recon_loss: 258572.3030; val_gene_expr_recon_loss: 7206.2968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271251.6186; val_optim_loss: 271251.6186
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9939; val_auprc_score: 0.9924; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 5357.1575; train_edge_recon_loss: 258759.4179; train_gene_expr_recon_loss: 7218.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271335.3998; train_optim_loss: 271335.3998; val_kl_reg_loss: 5499.3997; val_edge_recon_loss: 258243.5115; val_gene_expr_recon_loss: 7114.2192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270857.1299; val_optim_loss: 270857.1299
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 5369.3358; train_edge_recon_loss: 258611.0504; train_gene_expr_recon_loss: 7175.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271155.9117; train_optim_loss: 271155.9117; val_kl_reg_loss: 5519.8533; val_edge_recon_loss: 258142.0575; val_gene_expr_recon_loss: 7106.2746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270768.1847; val_optim_loss: 270768.1847
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 5382.1972; train_edge_recon_loss: 258373.5643; train_gene_expr_recon_loss: 7136.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270892.4817; train_optim_loss: 270892.4817; val_kl_reg_loss: 5532.2893; val_edge_recon_loss: 258119.8299; val_gene_expr_recon_loss: 7081.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270733.2021; val_optim_loss: 270733.2021
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5389.4640; train_edge_recon_loss: 258233.0114; train_gene_expr_recon_loss: 7108.6003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270731.0760; train_optim_loss: 270731.0760; val_kl_reg_loss: 5339.7974; val_edge_recon_loss: 257851.6447; val_gene_expr_recon_loss: 7044.0007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270235.4434; val_optim_loss: 270235.4434
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 5391.8964; train_edge_recon_loss: 258129.7320; train_gene_expr_recon_loss: 7081.0686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270602.6972; train_optim_loss: 270602.6972; val_kl_reg_loss: 5531.2997; val_edge_recon_loss: 257601.7934; val_gene_expr_recon_loss: 7021.8632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270154.9570; val_optim_loss: 270154.9570
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 5398.3061; train_edge_recon_loss: 257981.1135; train_gene_expr_recon_loss: 7064.8714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270444.2909; train_optim_loss: 270444.2909; val_kl_reg_loss: 5385.3121; val_edge_recon_loss: 257526.0231; val_gene_expr_recon_loss: 6983.9586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269895.2932; val_optim_loss: 269895.2932
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5405.0687; train_edge_recon_loss: 257833.9276; train_gene_expr_recon_loss: 7046.2395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270285.2361; train_optim_loss: 270285.2361; val_kl_reg_loss: 5483.5093; val_edge_recon_loss: 257369.5478; val_gene_expr_recon_loss: 6958.2297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269811.2861; val_optim_loss: 269811.2861
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 5403.9709; train_edge_recon_loss: 257832.2041; train_gene_expr_recon_loss: 7031.1688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270267.3440; train_optim_loss: 270267.3440; val_kl_reg_loss: 5456.7880; val_edge_recon_loss: 257558.3677; val_gene_expr_recon_loss: 6960.9831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269976.1362; val_optim_loss: 269976.1362
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 5411.2683; train_edge_recon_loss: 257720.8773; train_gene_expr_recon_loss: 7023.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270155.9769; train_optim_loss: 270155.9769; val_kl_reg_loss: 5269.3884; val_edge_recon_loss: 257504.8291; val_gene_expr_recon_loss: 6963.6853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269737.9023; val_optim_loss: 269737.9023
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 5414.3740; train_edge_recon_loss: 257643.2980; train_gene_expr_recon_loss: 7012.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270070.6133; train_optim_loss: 270070.6133; val_kl_reg_loss: 5659.3672; val_edge_recon_loss: 257133.1940; val_gene_expr_recon_loss: 6948.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269740.9348; val_optim_loss: 269740.9348
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5414.9710; train_edge_recon_loss: 257603.9714; train_gene_expr_recon_loss: 7004.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270023.4163; train_optim_loss: 270023.4163; val_kl_reg_loss: 5434.3056; val_edge_recon_loss: 256979.4631; val_gene_expr_recon_loss: 6941.6074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269355.3762; val_optim_loss: 269355.3762
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 5416.0333; train_edge_recon_loss: 257523.6350; train_gene_expr_recon_loss: 6995.4215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269935.0897; train_optim_loss: 269935.0897; val_kl_reg_loss: 5668.8024; val_edge_recon_loss: 256965.2238; val_gene_expr_recon_loss: 6941.0579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269575.0830; val_optim_loss: 269575.0830
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 5421.9981; train_edge_recon_loss: 257461.5005; train_gene_expr_recon_loss: 6993.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269877.1414; train_optim_loss: 269877.1414; val_kl_reg_loss: 5397.7759; val_edge_recon_loss: 257207.2548; val_gene_expr_recon_loss: 6930.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269535.0569; val_optim_loss: 269535.0569
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 5422.6971; train_edge_recon_loss: 257405.6079; train_gene_expr_recon_loss: 6980.7100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269809.0152; train_optim_loss: 269809.0152; val_kl_reg_loss: 5334.8481; val_edge_recon_loss: 256983.2261; val_gene_expr_recon_loss: 6966.0153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269284.0893; val_optim_loss: 269284.0893
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 5422.1798; train_edge_recon_loss: 257428.5150; train_gene_expr_recon_loss: 6978.1858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269828.8802; train_optim_loss: 269828.8802; val_kl_reg_loss: 5304.2148; val_edge_recon_loss: 257298.2227; val_gene_expr_recon_loss: 6924.7985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269527.2364; val_optim_loss: 269527.2364
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5425.6718; train_edge_recon_loss: 257286.4084; train_gene_expr_recon_loss: 6974.1769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269686.2570; train_optim_loss: 269686.2570; val_kl_reg_loss: 5490.4957; val_edge_recon_loss: 256609.5397; val_gene_expr_recon_loss: 6900.8326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269000.8680; val_optim_loss: 269000.8680
