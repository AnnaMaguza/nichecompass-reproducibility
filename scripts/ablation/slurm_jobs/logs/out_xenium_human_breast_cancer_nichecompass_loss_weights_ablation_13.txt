None
Run timestamp: 01072023_063601_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9449; val_auprc_score: 0.9263; val_best_acc_score: 0.8856; val_best_f1_score: 0.8919; train_kl_reg_loss: 1969.7267; train_edge_recon_loss: 28135.5964; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30105.3231; train_optim_loss: 30105.3231; val_kl_reg_loss: 2053.3089; val_edge_recon_loss: 26792.0666; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28845.3755; val_optim_loss: 28845.3755
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9596; val_auprc_score: 0.9474; val_best_acc_score: 0.9045; val_best_f1_score: 0.9083; train_kl_reg_loss: 2127.5554; train_edge_recon_loss: 27452.2322; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29579.7876; train_optim_loss: 29579.7876; val_kl_reg_loss: 2068.1185; val_edge_recon_loss: 26614.8141; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28682.9325; val_optim_loss: 28682.9325
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9646; val_auprc_score: 0.9519; val_best_acc_score: 0.9133; val_best_f1_score: 0.9170; train_kl_reg_loss: 2150.8766; train_edge_recon_loss: 27363.2808; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29514.1573; train_optim_loss: 29514.1573; val_kl_reg_loss: 2077.7011; val_edge_recon_loss: 26523.4098; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28601.1110; val_optim_loss: 28601.1110
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9633; val_auprc_score: 0.9497; val_best_acc_score: 0.9151; val_best_f1_score: 0.9186; train_kl_reg_loss: 2161.5240; train_edge_recon_loss: 27310.8060; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29472.3300; train_optim_loss: 29472.3300; val_kl_reg_loss: 2020.3785; val_edge_recon_loss: 26535.5287; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28555.9071; val_optim_loss: 28555.9071
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9653; val_auprc_score: 0.9535; val_best_acc_score: 0.9151; val_best_f1_score: 0.9181; train_kl_reg_loss: 2162.8511; train_edge_recon_loss: 27291.5904; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29454.4414; train_optim_loss: 29454.4414; val_kl_reg_loss: 2086.3700; val_edge_recon_loss: 26515.8607; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28602.2307; val_optim_loss: 28602.2307
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9661; val_auprc_score: 0.9535; val_best_acc_score: 0.9185; val_best_f1_score: 0.9219; train_kl_reg_loss: 2172.5517; train_edge_recon_loss: 27253.9043; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29426.4560; train_optim_loss: 29426.4560; val_kl_reg_loss: 2173.3888; val_edge_recon_loss: 26489.7955; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28663.1843; val_optim_loss: 28663.1843
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9673; val_auprc_score: 0.9555; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 2173.5054; train_edge_recon_loss: 27248.6479; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29422.1533; train_optim_loss: 29422.1533; val_kl_reg_loss: 2114.1623; val_edge_recon_loss: 26486.0498; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28600.2121; val_optim_loss: 28600.2121
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9688; val_auprc_score: 0.9588; val_best_acc_score: 0.9203; val_best_f1_score: 0.9231; train_kl_reg_loss: 2177.7557; train_edge_recon_loss: 27228.3681; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29406.1238; train_optim_loss: 29406.1238; val_kl_reg_loss: 2207.6323; val_edge_recon_loss: 26504.6231; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28712.2554; val_optim_loss: 28712.2554

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9594; val_best_acc_score: 0.9229; val_best_f1_score: 0.9255; train_kl_reg_loss: 2177.3101; train_edge_recon_loss: 27191.4180; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29368.7280; train_optim_loss: 29368.7280; val_kl_reg_loss: 2125.0491; val_edge_recon_loss: 26405.3648; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28530.4139; val_optim_loss: 28530.4139
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9704; val_auprc_score: 0.9599; val_best_acc_score: 0.9259; val_best_f1_score: 0.9286; train_kl_reg_loss: 2175.4144; train_edge_recon_loss: 27182.9656; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29358.3800; train_optim_loss: 29358.3800; val_kl_reg_loss: 2120.8312; val_edge_recon_loss: 26412.7062; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28533.5373; val_optim_loss: 28533.5373
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9711; val_auprc_score: 0.9611; val_best_acc_score: 0.9254; val_best_f1_score: 0.9282; train_kl_reg_loss: 2175.4607; train_edge_recon_loss: 27178.4833; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29353.9440; train_optim_loss: 29353.9440; val_kl_reg_loss: 2121.9694; val_edge_recon_loss: 26398.0717; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28520.0412; val_optim_loss: 28520.0412
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9710; val_auprc_score: 0.9608; val_best_acc_score: 0.9255; val_best_f1_score: 0.9281; train_kl_reg_loss: 2173.5163; train_edge_recon_loss: 27185.3250; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29358.8413; train_optim_loss: 29358.8413; val_kl_reg_loss: 2126.2336; val_edge_recon_loss: 26419.9176; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28546.1512; val_optim_loss: 28546.1512
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9716; val_auprc_score: 0.9617; val_best_acc_score: 0.9270; val_best_f1_score: 0.9294; train_kl_reg_loss: 2170.7971; train_edge_recon_loss: 27185.8805; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29356.6777; train_optim_loss: 29356.6777; val_kl_reg_loss: 2171.1821; val_edge_recon_loss: 26402.0455; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28573.2275; val_optim_loss: 28573.2275
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9717; val_auprc_score: 0.9621; val_best_acc_score: 0.9263; val_best_f1_score: 0.9290; train_kl_reg_loss: 2173.3251; train_edge_recon_loss: 27169.1640; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29342.4891; train_optim_loss: 29342.4891; val_kl_reg_loss: 2118.0663; val_edge_recon_loss: 26406.1707; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28524.2369; val_optim_loss: 28524.2369
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9711; val_auprc_score: 0.9610; val_best_acc_score: 0.9257; val_best_f1_score: 0.9281; train_kl_reg_loss: 2175.8896; train_edge_recon_loss: 27164.2111; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29340.1007; train_optim_loss: 29340.1007; val_kl_reg_loss: 2119.1522; val_edge_recon_loss: 26382.8043; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28501.9566; val_optim_loss: 28501.9566
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9715; val_auprc_score: 0.9621; val_best_acc_score: 0.9255; val_best_f1_score: 0.9281; train_kl_reg_loss: 2173.8168; train_edge_recon_loss: 27176.8928; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29350.7096; train_optim_loss: 29350.7096; val_kl_reg_loss: 2110.2238; val_edge_recon_loss: 26428.7217; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28538.9455; val_optim_loss: 28538.9455
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9725; val_auprc_score: 0.9634; val_best_acc_score: 0.9269; val_best_f1_score: 0.9293; train_kl_reg_loss: 2173.1175; train_edge_recon_loss: 27175.7538; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29348.8713; train_optim_loss: 29348.8713; val_kl_reg_loss: 2113.8459; val_edge_recon_loss: 26415.8827; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28529.7285; val_optim_loss: 28529.7285
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9726; val_auprc_score: 0.9634; val_best_acc_score: 0.9284; val_best_f1_score: 0.9309; train_kl_reg_loss: 2172.2095; train_edge_recon_loss: 27170.1091; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29342.3185; train_optim_loss: 29342.3185; val_kl_reg_loss: 2113.6055; val_edge_recon_loss: 26363.8494; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28477.4549; val_optim_loss: 28477.4549
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9728; val_auprc_score: 0.9635; val_best_acc_score: 0.9282; val_best_f1_score: 0.9305; train_kl_reg_loss: 2174.2483; train_edge_recon_loss: 27168.7308; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29342.9791; train_optim_loss: 29342.9791; val_kl_reg_loss: 2142.8514; val_edge_recon_loss: 26379.2193; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28522.0707; val_optim_loss: 28522.0707
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9740; val_auprc_score: 0.9653; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 2171.0983; train_edge_recon_loss: 27179.4480; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29350.5463; train_optim_loss: 29350.5463; val_kl_reg_loss: 2119.5305; val_edge_recon_loss: 26388.8801; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28508.4106; val_optim_loss: 28508.4106
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9736; val_auprc_score: 0.9655; val_best_acc_score: 0.9284; val_best_f1_score: 0.9309; train_kl_reg_loss: 2176.3076; train_edge_recon_loss: 27157.7933; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29334.1009; train_optim_loss: 29334.1009; val_kl_reg_loss: 2095.5154; val_edge_recon_loss: 26383.3870; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28478.9023; val_optim_loss: 28478.9023
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9740; val_auprc_score: 0.9648; val_best_acc_score: 0.9302; val_best_f1_score: 0.9324; train_kl_reg_loss: 2175.1357; train_edge_recon_loss: 27147.1150; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29322.2507; train_optim_loss: 29322.2507; val_kl_reg_loss: 2098.4889; val_edge_recon_loss: 26368.2780; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28466.7670; val_optim_loss: 28466.7670
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9733; val_auprc_score: 0.9647; val_best_acc_score: 0.9282; val_best_f1_score: 0.9304; train_kl_reg_loss: 2177.2628; train_edge_recon_loss: 27143.7400; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29321.0028; train_optim_loss: 29321.0028; val_kl_reg_loss: 2151.7709; val_edge_recon_loss: 26372.7062; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28524.4772; val_optim_loss: 28524.4772
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9737; val_auprc_score: 0.9650; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 2173.1695; train_edge_recon_loss: 27161.3020; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29334.4714; train_optim_loss: 29334.4714; val_kl_reg_loss: 2137.1202; val_edge_recon_loss: 26362.3929; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28499.5130; val_optim_loss: 28499.5130
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9727; val_auprc_score: 0.9627; val_best_acc_score: 0.9288; val_best_f1_score: 0.9311; train_kl_reg_loss: 2175.0700; train_edge_recon_loss: 27150.7056; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29325.7757; train_optim_loss: 29325.7757; val_kl_reg_loss: 2125.5789; val_edge_recon_loss: 26376.7632; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28502.3420; val_optim_loss: 28502.3420
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9731; val_auprc_score: 0.9639; val_best_acc_score: 0.9289; val_best_f1_score: 0.9311; train_kl_reg_loss: 2174.1011; train_edge_recon_loss: 27158.4924; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29332.5935; train_optim_loss: 29332.5935; val_kl_reg_loss: 2138.8048; val_edge_recon_loss: 26421.5395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28560.3443; val_optim_loss: 28560.3443

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9739; val_auprc_score: 0.9649; val_best_acc_score: 0.9293; val_best_f1_score: 0.9315; train_kl_reg_loss: 2174.1387; train_edge_recon_loss: 27154.8624; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29329.0011; train_optim_loss: 29329.0011; val_kl_reg_loss: 2124.4533; val_edge_recon_loss: 26340.1580; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28464.6113; val_optim_loss: 28464.6113
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9730; val_auprc_score: 0.9635; val_best_acc_score: 0.9281; val_best_f1_score: 0.9304; train_kl_reg_loss: 2173.8674; train_edge_recon_loss: 27158.4923; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29332.3597; train_optim_loss: 29332.3597; val_kl_reg_loss: 2130.5478; val_edge_recon_loss: 26387.0694; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28517.6173; val_optim_loss: 28517.6173
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9733; val_auprc_score: 0.9641; val_best_acc_score: 0.9292; val_best_f1_score: 0.9314; train_kl_reg_loss: 2171.4342; train_edge_recon_loss: 27165.0748; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29336.5090; train_optim_loss: 29336.5090; val_kl_reg_loss: 2118.6930; val_edge_recon_loss: 26345.2023; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28463.8953; val_optim_loss: 28463.8953
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9735; val_auprc_score: 0.9649; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 2175.4802; train_edge_recon_loss: 27151.8108; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29327.2911; train_optim_loss: 29327.2911; val_kl_reg_loss: 2123.9240; val_edge_recon_loss: 26386.4184; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28510.3423; val_optim_loss: 28510.3423
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9730; val_auprc_score: 0.9640; val_best_acc_score: 0.9279; val_best_f1_score: 0.9300; train_kl_reg_loss: 2174.9886; train_edge_recon_loss: 27153.5275; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29328.5161; train_optim_loss: 29328.5161; val_kl_reg_loss: 2125.5239; val_edge_recon_loss: 26390.6910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28516.2149; val_optim_loss: 28516.2149
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9734; val_auprc_score: 0.9644; val_best_acc_score: 0.9292; val_best_f1_score: 0.9315; train_kl_reg_loss: 2173.4277; train_edge_recon_loss: 27151.9595; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29325.3872; train_optim_loss: 29325.3872; val_kl_reg_loss: 2130.2289; val_edge_recon_loss: 26371.0397; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28501.2686; val_optim_loss: 28501.2686
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9731; val_auprc_score: 0.9636; val_best_acc_score: 0.9290; val_best_f1_score: 0.9312; train_kl_reg_loss: 2171.0168; train_edge_recon_loss: 27169.3425; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29340.3593; train_optim_loss: 29340.3593; val_kl_reg_loss: 2129.2766; val_edge_recon_loss: 26395.7407; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28525.0171; val_optim_loss: 28525.0171

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9734; val_auprc_score: 0.9635; val_best_acc_score: 0.9294; val_best_f1_score: 0.9316; train_kl_reg_loss: 2175.9932; train_edge_recon_loss: 27143.8010; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29319.7942; train_optim_loss: 29319.7942; val_kl_reg_loss: 2129.6272; val_edge_recon_loss: 26371.3503; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28500.9774; val_optim_loss: 28500.9774
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9744; val_auprc_score: 0.9656; val_best_acc_score: 0.9300; val_best_f1_score: 0.9319; train_kl_reg_loss: 2175.6286; train_edge_recon_loss: 27146.3870; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29322.0156; train_optim_loss: 29322.0156; val_kl_reg_loss: 2127.1751; val_edge_recon_loss: 26356.2888; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28483.4639; val_optim_loss: 28483.4639
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9729; val_auprc_score: 0.9638; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 2174.9023; train_edge_recon_loss: 27147.1658; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29322.0682; train_optim_loss: 29322.0682; val_kl_reg_loss: 2129.4849; val_edge_recon_loss: 26407.6493; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28537.1341; val_optim_loss: 28537.1341
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9729; val_auprc_score: 0.9634; val_best_acc_score: 0.9284; val_best_f1_score: 0.9307; train_kl_reg_loss: 2176.5112; train_edge_recon_loss: 27140.8975; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29317.4087; train_optim_loss: 29317.4087; val_kl_reg_loss: 2131.8443; val_edge_recon_loss: 26377.1776; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28509.0218; val_optim_loss: 28509.0218

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 57 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9731
Val AUPRC score: 0.9636
Val best accuracy score: 0.9289
Val best F1 score: 0.9311
Val gene expr MSE score: 5.1418

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
