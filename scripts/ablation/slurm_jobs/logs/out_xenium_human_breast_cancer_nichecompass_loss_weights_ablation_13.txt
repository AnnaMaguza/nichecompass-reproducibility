None
Run timestamp: 14072023_035350_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9187; val_auprc_score: 0.8939; val_best_acc_score: 0.8553; val_best_f1_score: 0.8663; train_kl_reg_loss: 59678.2588; train_edge_recon_loss: 27393810.6912; train_gene_expr_recon_loss: 7809516.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35263005.9794; train_optim_loss: 35263005.9794; val_kl_reg_loss: 69502.3579; val_edge_recon_loss: 27102896.6053; val_gene_expr_recon_loss: 7129649.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34302048.6053; val_optim_loss: 34302048.6053
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9376; val_auprc_score: 0.9191; val_best_acc_score: 0.8765; val_best_f1_score: 0.8848; train_kl_reg_loss: 64517.4132; train_edge_recon_loss: 26487186.6794; train_gene_expr_recon_loss: 6953988.9294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33505693.0853; train_optim_loss: 33505693.0853; val_kl_reg_loss: 61231.3745; val_edge_recon_loss: 26904563.7895; val_gene_expr_recon_loss: 6781725.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33747520.7632; val_optim_loss: 33747520.7632
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9424; val_auprc_score: 0.9252; val_best_acc_score: 0.8825; val_best_f1_score: 0.8901; train_kl_reg_loss: 60656.7915; train_edge_recon_loss: 26361604.9324; train_gene_expr_recon_loss: 6673912.5713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33096174.2676; train_optim_loss: 33096174.2676; val_kl_reg_loss: 56064.2260; val_edge_recon_loss: 26834065.7368; val_gene_expr_recon_loss: 6553764.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33443894.1316; val_optim_loss: 33443894.1316
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9505; val_auprc_score: 0.9365; val_best_acc_score: 0.8907; val_best_f1_score: 0.8964; train_kl_reg_loss: 55394.5896; train_edge_recon_loss: 26302255.5912; train_gene_expr_recon_loss: 6493405.2184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32851055.3971; train_optim_loss: 32851055.3971; val_kl_reg_loss: 51091.2306; val_edge_recon_loss: 26831653.7632; val_gene_expr_recon_loss: 6401911.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33284656.0000; val_optim_loss: 33284656.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9579; val_auprc_score: 0.9460; val_best_acc_score: 0.9001; val_best_f1_score: 0.9042; train_kl_reg_loss: 51178.7684; train_edge_recon_loss: 26246407.3147; train_gene_expr_recon_loss: 6373262.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32670848.8412; train_optim_loss: 32670848.8412; val_kl_reg_loss: 48944.7600; val_edge_recon_loss: 26659528.6316; val_gene_expr_recon_loss: 6311951.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33020425.4211; val_optim_loss: 33020425.4211
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9612; val_auprc_score: 0.9505; val_best_acc_score: 0.9058; val_best_f1_score: 0.9101; train_kl_reg_loss: 48471.6224; train_edge_recon_loss: 26227391.7971; train_gene_expr_recon_loss: 6291563.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32567427.2471; train_optim_loss: 32567427.2471; val_kl_reg_loss: 44360.2437; val_edge_recon_loss: 26699516.0000; val_gene_expr_recon_loss: 6241876.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32985752.5263; val_optim_loss: 32985752.5263
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9634; val_auprc_score: 0.9540; val_best_acc_score: 0.9089; val_best_f1_score: 0.9125; train_kl_reg_loss: 47313.2615; train_edge_recon_loss: 26153678.1118; train_gene_expr_recon_loss: 6223775.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32424766.8706; train_optim_loss: 32424766.8706; val_kl_reg_loss: 45619.6310; val_edge_recon_loss: 26649044.3947; val_gene_expr_recon_loss: 6187505.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32882169.2368; val_optim_loss: 32882169.2368
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9645; val_auprc_score: 0.9539; val_best_acc_score: 0.9120; val_best_f1_score: 0.9156; train_kl_reg_loss: 46471.1046; train_edge_recon_loss: 26144717.1765; train_gene_expr_recon_loss: 6182571.5199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32373759.8294; train_optim_loss: 32373759.8294; val_kl_reg_loss: 45469.4214; val_edge_recon_loss: 26617601.2105; val_gene_expr_recon_loss: 6160287.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32823357.7895; val_optim_loss: 32823357.7895
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9649; val_auprc_score: 0.9546; val_best_acc_score: 0.9138; val_best_f1_score: 0.9169; train_kl_reg_loss: 46143.1824; train_edge_recon_loss: 26121936.4147; train_gene_expr_recon_loss: 6141290.4618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32309370.0882; train_optim_loss: 32309370.0882; val_kl_reg_loss: 44789.8986; val_edge_recon_loss: 26616111.9737; val_gene_expr_recon_loss: 6118909.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32779811.5526; val_optim_loss: 32779811.5526
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9660; val_auprc_score: 0.9565; val_best_acc_score: 0.9148; val_best_f1_score: 0.9183; train_kl_reg_loss: 45924.0025; train_edge_recon_loss: 26108743.3176; train_gene_expr_recon_loss: 6111661.2059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32266328.5059; train_optim_loss: 32266328.5059; val_kl_reg_loss: 44567.3991; val_edge_recon_loss: 26541423.2632; val_gene_expr_recon_loss: 6100673.4211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32686664.1316; val_optim_loss: 32686664.1316
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9662; val_auprc_score: 0.9563; val_best_acc_score: 0.9162; val_best_f1_score: 0.9195; train_kl_reg_loss: 45907.2238; train_edge_recon_loss: 26089918.4118; train_gene_expr_recon_loss: 6088222.3169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32224047.9588; train_optim_loss: 32224047.9588; val_kl_reg_loss: 44434.0542; val_edge_recon_loss: 26588920.6579; val_gene_expr_recon_loss: 6083100.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32716455.1316; val_optim_loss: 32716455.1316
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9670; val_auprc_score: 0.9571; val_best_acc_score: 0.9173; val_best_f1_score: 0.9201; train_kl_reg_loss: 45277.2509; train_edge_recon_loss: 26087497.5529; train_gene_expr_recon_loss: 6066282.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32199057.7853; train_optim_loss: 32199057.7853; val_kl_reg_loss: 45326.2590; val_edge_recon_loss: 26530339.7895; val_gene_expr_recon_loss: 6059330.4145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32634996.5526; val_optim_loss: 32634996.5526
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9681; val_auprc_score: 0.9596; val_best_acc_score: 0.9170; val_best_f1_score: 0.9200; train_kl_reg_loss: 45494.2416; train_edge_recon_loss: 26079757.7647; train_gene_expr_recon_loss: 6050872.8846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32176124.8588; train_optim_loss: 32176124.8588; val_kl_reg_loss: 43417.6881; val_edge_recon_loss: 26538038.6579; val_gene_expr_recon_loss: 6049835.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32631291.6053; val_optim_loss: 32631291.6053
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9693; val_auprc_score: 0.9607; val_best_acc_score: 0.9198; val_best_f1_score: 0.9222; train_kl_reg_loss: 44488.2523; train_edge_recon_loss: 26061213.5000; train_gene_expr_recon_loss: 6037823.5522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32143525.3265; train_optim_loss: 32143525.3265; val_kl_reg_loss: 42744.0455; val_edge_recon_loss: 26561217.6579; val_gene_expr_recon_loss: 6037078.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32641039.8684; val_optim_loss: 32641039.8684
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9693; val_auprc_score: 0.9604; val_best_acc_score: 0.9201; val_best_f1_score: 0.9234; train_kl_reg_loss: 44600.2205; train_edge_recon_loss: 26057945.1441; train_gene_expr_recon_loss: 6027010.7191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32129556.0941; train_optim_loss: 32129556.0941; val_kl_reg_loss: 42738.1677; val_edge_recon_loss: 26513941.0789; val_gene_expr_recon_loss: 6024105.4474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32580784.7105; val_optim_loss: 32580784.7105
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9698; val_auprc_score: 0.9620; val_best_acc_score: 0.9207; val_best_f1_score: 0.9235; train_kl_reg_loss: 44058.0077; train_edge_recon_loss: 26041341.5441; train_gene_expr_recon_loss: 6015778.1235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32101177.6824; train_optim_loss: 32101177.6824; val_kl_reg_loss: 41365.7861; val_edge_recon_loss: 26570366.2895; val_gene_expr_recon_loss: 6022505.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32634237.7105; val_optim_loss: 32634237.7105
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9713; val_auprc_score: 0.9636; val_best_acc_score: 0.9215; val_best_f1_score: 0.9241; train_kl_reg_loss: 43863.8960; train_edge_recon_loss: 26030087.8412; train_gene_expr_recon_loss: 6007096.7676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32081048.4559; train_optim_loss: 32081048.4559; val_kl_reg_loss: 40692.3819; val_edge_recon_loss: 26531923.1053; val_gene_expr_recon_loss: 5992190.2895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32564805.7895; val_optim_loss: 32564805.7895
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9701; val_auprc_score: 0.9620; val_best_acc_score: 0.9220; val_best_f1_score: 0.9248; train_kl_reg_loss: 43485.8121; train_edge_recon_loss: 26025476.7029; train_gene_expr_recon_loss: 5996594.7610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32065557.2118; train_optim_loss: 32065557.2118; val_kl_reg_loss: 41940.4189; val_edge_recon_loss: 26509414.8421; val_gene_expr_recon_loss: 5994515.4145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32545870.7895; val_optim_loss: 32545870.7895
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9711; val_auprc_score: 0.9632; val_best_acc_score: 0.9224; val_best_f1_score: 0.9251; train_kl_reg_loss: 43577.1595; train_edge_recon_loss: 26013914.2382; train_gene_expr_recon_loss: 5989820.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32047311.9382; train_optim_loss: 32047311.9382; val_kl_reg_loss: 42255.6317; val_edge_recon_loss: 26538040.4211; val_gene_expr_recon_loss: 5995152.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32575448.2368; val_optim_loss: 32575448.2368
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9725; val_auprc_score: 0.9653; val_best_acc_score: 0.9237; val_best_f1_score: 0.9264; train_kl_reg_loss: 43528.2610; train_edge_recon_loss: 26018368.8853; train_gene_expr_recon_loss: 5984898.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32046795.8735; train_optim_loss: 32046795.8735; val_kl_reg_loss: 42008.9207; val_edge_recon_loss: 26460742.9474; val_gene_expr_recon_loss: 5999276.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32502027.9474; val_optim_loss: 32502027.9474
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9711; val_auprc_score: 0.9625; val_best_acc_score: 0.9231; val_best_f1_score: 0.9255; train_kl_reg_loss: 43174.0941; train_edge_recon_loss: 26011830.3176; train_gene_expr_recon_loss: 5976952.3257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32031956.6853; train_optim_loss: 32031956.6853; val_kl_reg_loss: 41287.0469; val_edge_recon_loss: 26509078.8684; val_gene_expr_recon_loss: 5963976.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32514342.6316; val_optim_loss: 32514342.6316
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9726; val_auprc_score: 0.9648; val_best_acc_score: 0.9245; val_best_f1_score: 0.9268; train_kl_reg_loss: 43400.2338; train_edge_recon_loss: 26000909.7500; train_gene_expr_recon_loss: 5972406.1463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32016716.0912; train_optim_loss: 32016716.0912; val_kl_reg_loss: 42034.6071; val_edge_recon_loss: 26506898.4737; val_gene_expr_recon_loss: 5979204.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32528137.4211; val_optim_loss: 32528137.4211
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9722; val_auprc_score: 0.9645; val_best_acc_score: 0.9248; val_best_f1_score: 0.9277; train_kl_reg_loss: 42924.9726; train_edge_recon_loss: 26000729.1588; train_gene_expr_recon_loss: 5969522.8316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32013176.9176; train_optim_loss: 32013176.9176; val_kl_reg_loss: 41500.3756; val_edge_recon_loss: 26529387.8684; val_gene_expr_recon_loss: 5993980.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32564868.5263; val_optim_loss: 32564868.5263
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9710; val_auprc_score: 0.9623; val_best_acc_score: 0.9231; val_best_f1_score: 0.9260; train_kl_reg_loss: 42997.0059; train_edge_recon_loss: 25993914.8088; train_gene_expr_recon_loss: 5962857.6478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31999769.4382; train_optim_loss: 31999769.4382; val_kl_reg_loss: 42339.7811; val_edge_recon_loss: 26538709.3684; val_gene_expr_recon_loss: 5978687.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32559736.5526; val_optim_loss: 32559736.5526

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9712; val_auprc_score: 0.9633; val_best_acc_score: 0.9232; val_best_f1_score: 0.9258; train_kl_reg_loss: 43255.4657; train_edge_recon_loss: 25983888.9941; train_gene_expr_recon_loss: 5926368.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31953513.0824; train_optim_loss: 31953513.0824; val_kl_reg_loss: 42139.6680; val_edge_recon_loss: 26530947.1316; val_gene_expr_recon_loss: 5939191.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32512278.3158; val_optim_loss: 32512278.3158
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9719; val_auprc_score: 0.9643; val_best_acc_score: 0.9242; val_best_f1_score: 0.9266; train_kl_reg_loss: 42984.1068; train_edge_recon_loss: 25992874.9029; train_gene_expr_recon_loss: 5921926.6926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31957785.7588; train_optim_loss: 31957785.7588; val_kl_reg_loss: 41640.2912; val_edge_recon_loss: 26518330.7105; val_gene_expr_recon_loss: 5925417.5461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32485388.5526; val_optim_loss: 32485388.5526
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9734; val_auprc_score: 0.9657; val_best_acc_score: 0.9270; val_best_f1_score: 0.9290; train_kl_reg_loss: 43115.0000; train_edge_recon_loss: 25977647.7588; train_gene_expr_recon_loss: 5918001.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31938764.1294; train_optim_loss: 31938764.1294; val_kl_reg_loss: 41949.1610; val_edge_recon_loss: 26478191.5000; val_gene_expr_recon_loss: 5938832.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32458973.4211; val_optim_loss: 32458973.4211
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9732; val_auprc_score: 0.9657; val_best_acc_score: 0.9253; val_best_f1_score: 0.9276; train_kl_reg_loss: 43473.8392; train_edge_recon_loss: 25959703.4471; train_gene_expr_recon_loss: 5917716.1926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31920893.5206; train_optim_loss: 31920893.5206; val_kl_reg_loss: 42125.1988; val_edge_recon_loss: 26490818.2105; val_gene_expr_recon_loss: 5934219.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32467162.8684; val_optim_loss: 32467162.8684
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9642; val_best_acc_score: 0.9250; val_best_f1_score: 0.9274; train_kl_reg_loss: 43387.3793; train_edge_recon_loss: 25974972.6882; train_gene_expr_recon_loss: 5917497.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31935857.4118; train_optim_loss: 31935857.4118; val_kl_reg_loss: 42056.6724; val_edge_recon_loss: 26486096.8947; val_gene_expr_recon_loss: 5933363.1382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32461516.6579; val_optim_loss: 32461516.6579
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9728; val_auprc_score: 0.9645; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 43636.8467; train_edge_recon_loss: 25970797.3000; train_gene_expr_recon_loss: 5914662.7463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31929096.9382; train_optim_loss: 31929096.9382; val_kl_reg_loss: 42404.3389; val_edge_recon_loss: 26477288.4737; val_gene_expr_recon_loss: 5927292.5329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32446985.3947; val_optim_loss: 32446985.3947
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9732; val_auprc_score: 0.9660; val_best_acc_score: 0.9258; val_best_f1_score: 0.9284; train_kl_reg_loss: 43434.7456; train_edge_recon_loss: 25963671.3000; train_gene_expr_recon_loss: 5915110.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31922216.7735; train_optim_loss: 31922216.7735; val_kl_reg_loss: 41972.8590; val_edge_recon_loss: 26471777.7895; val_gene_expr_recon_loss: 5937590.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32451341.2368; val_optim_loss: 32451341.2368
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9729; val_auprc_score: 0.9651; val_best_acc_score: 0.9266; val_best_f1_score: 0.9292; train_kl_reg_loss: 43359.4221; train_edge_recon_loss: 25979319.3765; train_gene_expr_recon_loss: 5912847.6890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31935526.4500; train_optim_loss: 31935526.4500; val_kl_reg_loss: 42002.8430; val_edge_recon_loss: 26473688.9211; val_gene_expr_recon_loss: 5927345.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32443037.2895; val_optim_loss: 32443037.2895
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9730; val_auprc_score: 0.9654; val_best_acc_score: 0.9268; val_best_f1_score: 0.9292; train_kl_reg_loss: 43332.7211; train_edge_recon_loss: 25974733.5588; train_gene_expr_recon_loss: 5911590.7404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31929657.0294; train_optim_loss: 31929657.0294; val_kl_reg_loss: 41689.8026; val_edge_recon_loss: 26464595.7368; val_gene_expr_recon_loss: 5929458.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32435743.6579; val_optim_loss: 32435743.6579
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9731; val_auprc_score: 0.9657; val_best_acc_score: 0.9250; val_best_f1_score: 0.9274; train_kl_reg_loss: 43159.8892; train_edge_recon_loss: 25962747.7471; train_gene_expr_recon_loss: 5912605.6610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31918513.3088; train_optim_loss: 31918513.3088; val_kl_reg_loss: 41797.2238; val_edge_recon_loss: 26502340.7632; val_gene_expr_recon_loss: 5921445.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32465583.7368; val_optim_loss: 32465583.7368
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9730; val_auprc_score: 0.9653; val_best_acc_score: 0.9266; val_best_f1_score: 0.9287; train_kl_reg_loss: 42992.7931; train_edge_recon_loss: 25975912.6471; train_gene_expr_recon_loss: 5908488.6162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31927394.0794; train_optim_loss: 31927394.0794; val_kl_reg_loss: 41511.0268; val_edge_recon_loss: 26521193.3421; val_gene_expr_recon_loss: 5921391.9803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32484096.3421; val_optim_loss: 32484096.3421
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9733; val_auprc_score: 0.9661; val_best_acc_score: 0.9265; val_best_f1_score: 0.9288; train_kl_reg_loss: 43172.4172; train_edge_recon_loss: 25956706.8235; train_gene_expr_recon_loss: 5908589.1235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31908468.3882; train_optim_loss: 31908468.3882; val_kl_reg_loss: 42104.1027; val_edge_recon_loss: 26471448.2105; val_gene_expr_recon_loss: 5934451.6645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32448004.1053; val_optim_loss: 32448004.1053
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9736; val_auprc_score: 0.9658; val_best_acc_score: 0.9268; val_best_f1_score: 0.9290; train_kl_reg_loss: 43158.0973; train_edge_recon_loss: 25958978.9882; train_gene_expr_recon_loss: 5908313.1338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31910450.1676; train_optim_loss: 31910450.1676; val_kl_reg_loss: 42219.4121; val_edge_recon_loss: 26461022.1842; val_gene_expr_recon_loss: 5924859.7961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32428101.4474; val_optim_loss: 32428101.4474
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9736; val_auprc_score: 0.9661; val_best_acc_score: 0.9276; val_best_f1_score: 0.9297; train_kl_reg_loss: 43100.1292; train_edge_recon_loss: 25957528.8676; train_gene_expr_recon_loss: 5909408.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31910037.8794; train_optim_loss: 31910037.8794; val_kl_reg_loss: 41861.1197; val_edge_recon_loss: 26451045.2632; val_gene_expr_recon_loss: 5926870.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32419776.7895; val_optim_loss: 32419776.7895
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9728; val_auprc_score: 0.9651; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 42999.0089; train_edge_recon_loss: 25965322.4206; train_gene_expr_recon_loss: 5906700.8831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31915022.3294; train_optim_loss: 31915022.3294; val_kl_reg_loss: 41698.2723; val_edge_recon_loss: 26510001.5000; val_gene_expr_recon_loss: 5941350.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32493050.2632; val_optim_loss: 32493050.2632
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9740; val_auprc_score: 0.9666; val_best_acc_score: 0.9276; val_best_f1_score: 0.9299; train_kl_reg_loss: 42571.3079; train_edge_recon_loss: 25976766.5324; train_gene_expr_recon_loss: 5909558.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31928896.0059; train_optim_loss: 31928896.0059; val_kl_reg_loss: 41425.9801; val_edge_recon_loss: 26482827.9211; val_gene_expr_recon_loss: 5926350.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32450603.7895; val_optim_loss: 32450603.7895
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9740; val_auprc_score: 0.9667; val_best_acc_score: 0.9270; val_best_f1_score: 0.9291; train_kl_reg_loss: 42872.7834; train_edge_recon_loss: 25970462.2500; train_gene_expr_recon_loss: 5908646.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31921981.8794; train_optim_loss: 31921981.8794; val_kl_reg_loss: 41623.6252; val_edge_recon_loss: 26456700.7632; val_gene_expr_recon_loss: 5917463.5724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32415788.0789; val_optim_loss: 32415788.0789
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9740; val_auprc_score: 0.9672; val_best_acc_score: 0.9281; val_best_f1_score: 0.9304; train_kl_reg_loss: 42807.4621; train_edge_recon_loss: 25972194.9382; train_gene_expr_recon_loss: 5906453.7912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31921456.1794; train_optim_loss: 31921456.1794; val_kl_reg_loss: 41463.9143; val_edge_recon_loss: 26457873.8421; val_gene_expr_recon_loss: 5922136.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32421474.3684; val_optim_loss: 32421474.3684
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9730; val_auprc_score: 0.9652; val_best_acc_score: 0.9262; val_best_f1_score: 0.9286; train_kl_reg_loss: 42429.1576; train_edge_recon_loss: 25961051.0206; train_gene_expr_recon_loss: 5902279.5375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31905759.7412; train_optim_loss: 31905759.7412; val_kl_reg_loss: 41263.0540; val_edge_recon_loss: 26515024.2368; val_gene_expr_recon_loss: 5923476.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32479763.9737; val_optim_loss: 32479763.9737
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9750; val_auprc_score: 0.9675; val_best_acc_score: 0.9291; val_best_f1_score: 0.9314; train_kl_reg_loss: 42322.6968; train_edge_recon_loss: 25968682.1412; train_gene_expr_recon_loss: 5907750.5235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31918755.3176; train_optim_loss: 31918755.3176; val_kl_reg_loss: 41055.9298; val_edge_recon_loss: 26401003.5000; val_gene_expr_recon_loss: 5925988.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368047.8684; val_optim_loss: 32368047.8684
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9731; val_auprc_score: 0.9654; val_best_acc_score: 0.9258; val_best_f1_score: 0.9285; train_kl_reg_loss: 42383.2643; train_edge_recon_loss: 25957683.3118; train_gene_expr_recon_loss: 5904729.3890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31904795.9735; train_optim_loss: 31904795.9735; val_kl_reg_loss: 41333.0778; val_edge_recon_loss: 26488441.5000; val_gene_expr_recon_loss: 5926155.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32455930.1842; val_optim_loss: 32455930.1842
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9734; val_auprc_score: 0.9653; val_best_acc_score: 0.9277; val_best_f1_score: 0.9301; train_kl_reg_loss: 42290.2343; train_edge_recon_loss: 25957395.7500; train_gene_expr_recon_loss: 5903342.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31903028.8353; train_optim_loss: 31903028.8353; val_kl_reg_loss: 40964.5052; val_edge_recon_loss: 26455741.5263; val_gene_expr_recon_loss: 5913417.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32410123.8421; val_optim_loss: 32410123.8421
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9736; val_auprc_score: 0.9657; val_best_acc_score: 0.9276; val_best_f1_score: 0.9297; train_kl_reg_loss: 42260.2754; train_edge_recon_loss: 25969159.9706; train_gene_expr_recon_loss: 5903759.9875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31915180.2471; train_optim_loss: 31915180.2471; val_kl_reg_loss: 40997.1659; val_edge_recon_loss: 26477552.3158; val_gene_expr_recon_loss: 5931072.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32449621.8947; val_optim_loss: 32449621.8947
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9742; val_auprc_score: 0.9673; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 41987.3984; train_edge_recon_loss: 25971510.3529; train_gene_expr_recon_loss: 5900851.4971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31914349.2500; train_optim_loss: 31914349.2500; val_kl_reg_loss: 40541.2020; val_edge_recon_loss: 26491971.5263; val_gene_expr_recon_loss: 5921876.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32454389.3421; val_optim_loss: 32454389.3421

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9739; val_auprc_score: 0.9669; val_best_acc_score: 0.9272; val_best_f1_score: 0.9292; train_kl_reg_loss: 41802.4877; train_edge_recon_loss: 25958802.9912; train_gene_expr_recon_loss: 5896350.5956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31896956.0941; train_optim_loss: 31896956.0941; val_kl_reg_loss: 40603.9133; val_edge_recon_loss: 26513271.8947; val_gene_expr_recon_loss: 5915368.5921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32469244.3947; val_optim_loss: 32469244.3947
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9736; val_auprc_score: 0.9660; val_best_acc_score: 0.9271; val_best_f1_score: 0.9293; train_kl_reg_loss: 41920.0766; train_edge_recon_loss: 25963309.8588; train_gene_expr_recon_loss: 5897422.6235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31902652.6147; train_optim_loss: 31902652.6147; val_kl_reg_loss: 40684.6608; val_edge_recon_loss: 26531237.7632; val_gene_expr_recon_loss: 5930031.0066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32501953.4474; val_optim_loss: 32501953.4474
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9733; val_auprc_score: 0.9654; val_best_acc_score: 0.9266; val_best_f1_score: 0.9292; train_kl_reg_loss: 41932.8797; train_edge_recon_loss: 25958969.2853; train_gene_expr_recon_loss: 5897141.7897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31898043.9588; train_optim_loss: 31898043.9588; val_kl_reg_loss: 40720.2046; val_edge_recon_loss: 26514292.6053; val_gene_expr_recon_loss: 5916613.3487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32471626.0263; val_optim_loss: 32471626.0263
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9739; val_auprc_score: 0.9666; val_best_acc_score: 0.9277; val_best_f1_score: 0.9298; train_kl_reg_loss: 41961.7194; train_edge_recon_loss: 25952106.2353; train_gene_expr_recon_loss: 5897382.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31891450.0471; train_optim_loss: 31891450.0471; val_kl_reg_loss: 40778.0940; val_edge_recon_loss: 26472934.7895; val_gene_expr_recon_loss: 5934061.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32447774.4211; val_optim_loss: 32447774.4211

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 0 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9741
Val AUPRC score: 0.9672
Val best accuracy score: 0.9276
Val best F1 score: 0.9298
Val gene expr MSE score: 1.4172

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
