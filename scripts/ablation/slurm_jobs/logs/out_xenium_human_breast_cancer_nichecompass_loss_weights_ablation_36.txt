None
Run timestamp: 01072023_140327_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9880; val_auprc_score: 0.9861; val_best_acc_score: 0.9489; val_best_f1_score: 0.9497; train_kl_reg_loss: 5906.7873; train_edge_recon_loss: 266254.6517; train_gene_expr_recon_loss: 76478.7150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348640.1540; train_optim_loss: 348640.1540; val_kl_reg_loss: 5661.8437; val_edge_recon_loss: 262866.9117; val_gene_expr_recon_loss: 71227.9283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339756.6839; val_optim_loss: 339756.6839
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9896; val_best_acc_score: 0.9596; val_best_f1_score: 0.9602; train_kl_reg_loss: 5821.0720; train_edge_recon_loss: 262072.8367; train_gene_expr_recon_loss: 69435.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337329.4893; train_optim_loss: 337329.4893; val_kl_reg_loss: 5721.2602; val_edge_recon_loss: 262296.0060; val_gene_expr_recon_loss: 68072.5325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336089.7994; val_optim_loss: 336089.7994
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 5812.3607; train_edge_recon_loss: 260961.6375; train_gene_expr_recon_loss: 67909.6358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334683.6338; train_optim_loss: 334683.6338; val_kl_reg_loss: 5801.7003; val_edge_recon_loss: 261291.6340; val_gene_expr_recon_loss: 67313.9253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334407.2591; val_optim_loss: 334407.2591
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 5806.2399; train_edge_recon_loss: 260294.4735; train_gene_expr_recon_loss: 67338.7711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333439.4846; train_optim_loss: 333439.4846; val_kl_reg_loss: 5749.3188; val_edge_recon_loss: 260845.6383; val_gene_expr_recon_loss: 66985.7357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333580.6916; val_optim_loss: 333580.6916
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 5806.1150; train_edge_recon_loss: 259909.0466; train_gene_expr_recon_loss: 67026.2618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332741.4233; train_optim_loss: 332741.4233; val_kl_reg_loss: 5689.8986; val_edge_recon_loss: 259729.2346; val_gene_expr_recon_loss: 66782.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332201.8596; val_optim_loss: 332201.8596
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9703; val_best_f1_score: 0.9706; train_kl_reg_loss: 5806.6350; train_edge_recon_loss: 259733.0945; train_gene_expr_recon_loss: 66819.3228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332359.0523; train_optim_loss: 332359.0523; val_kl_reg_loss: 5726.1602; val_edge_recon_loss: 259764.5586; val_gene_expr_recon_loss: 66519.3986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332010.1184; val_optim_loss: 332010.1184
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9720; val_best_f1_score: 0.9723; train_kl_reg_loss: 5804.9202; train_edge_recon_loss: 259448.1007; train_gene_expr_recon_loss: 66651.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331904.6744; train_optim_loss: 331904.6744; val_kl_reg_loss: 5708.9599; val_edge_recon_loss: 259336.6767; val_gene_expr_recon_loss: 66441.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331486.7517; val_optim_loss: 331486.7517
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 5809.1172; train_edge_recon_loss: 259294.6966; train_gene_expr_recon_loss: 66526.2315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331630.0451; train_optim_loss: 331630.0451; val_kl_reg_loss: 5748.9845; val_edge_recon_loss: 259152.0514; val_gene_expr_recon_loss: 66270.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331171.9021; val_optim_loss: 331171.9021
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9941; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 5814.5134; train_edge_recon_loss: 259113.5646; train_gene_expr_recon_loss: 66485.0386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331413.1168; train_optim_loss: 331413.1168; val_kl_reg_loss: 5614.6960; val_edge_recon_loss: 259200.1491; val_gene_expr_recon_loss: 66446.6322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331261.4778; val_optim_loss: 331261.4778
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 5819.0005; train_edge_recon_loss: 258966.3417; train_gene_expr_recon_loss: 66396.1844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331181.5262; train_optim_loss: 331181.5262; val_kl_reg_loss: 5721.3824; val_edge_recon_loss: 259216.1504; val_gene_expr_recon_loss: 66216.1866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331153.7204; val_optim_loss: 331153.7204
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 5827.2823; train_edge_recon_loss: 258826.3295; train_gene_expr_recon_loss: 66315.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330969.3631; train_optim_loss: 330969.3631; val_kl_reg_loss: 5898.7322; val_edge_recon_loss: 258882.4288; val_gene_expr_recon_loss: 66331.9992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331113.1583; val_optim_loss: 331113.1583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5827.4266; train_edge_recon_loss: 258752.1206; train_gene_expr_recon_loss: 66249.8318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330829.3793; train_optim_loss: 330829.3793; val_kl_reg_loss: 5766.6560; val_edge_recon_loss: 258666.0090; val_gene_expr_recon_loss: 66213.2358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330645.9000; val_optim_loss: 330645.9000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 5831.0411; train_edge_recon_loss: 258652.4425; train_gene_expr_recon_loss: 66223.1635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330706.6474; train_optim_loss: 330706.6474; val_kl_reg_loss: 5926.2685; val_edge_recon_loss: 258454.0466; val_gene_expr_recon_loss: 66195.6633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330575.9779; val_optim_loss: 330575.9779
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 5835.0372; train_edge_recon_loss: 258565.9393; train_gene_expr_recon_loss: 66154.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330555.2521; train_optim_loss: 330555.2521; val_kl_reg_loss: 5821.6501; val_edge_recon_loss: 258010.4602; val_gene_expr_recon_loss: 66087.3720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329919.4828; val_optim_loss: 329919.4828
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 5837.3170; train_edge_recon_loss: 258503.3883; train_gene_expr_recon_loss: 66135.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330476.2920; train_optim_loss: 330476.2920; val_kl_reg_loss: 5854.4859; val_edge_recon_loss: 258127.4715; val_gene_expr_recon_loss: 66112.8549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330094.8123; val_optim_loss: 330094.8123
