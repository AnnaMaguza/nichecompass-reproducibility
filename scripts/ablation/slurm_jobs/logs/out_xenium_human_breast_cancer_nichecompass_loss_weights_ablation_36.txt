Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5897.5766; train_edge_recon_loss: 257540.2164; train_gene_expr_recon_loss: 65334.2618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328772.0546; train_optim_loss: 328772.0546; val_kl_reg_loss: 5863.5594; val_edge_recon_loss: 257243.9264; val_gene_expr_recon_loss: 65588.3801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328695.8661; val_optim_loss: 328695.8661
None
Run timestamp: 02072023_010519_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9861; val_auprc_score: 0.9835; val_best_acc_score: 0.9459; val_best_f1_score: 0.9469; train_kl_reg_loss: 6032.7031; train_edge_recon_loss: 266408.4331; train_gene_expr_recon_loss: 76064.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348506.0318; train_optim_loss: 348506.0318; val_kl_reg_loss: 5781.6985; val_edge_recon_loss: 263430.1659; val_gene_expr_recon_loss: 69966.7262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339178.5910; val_optim_loss: 339178.5910
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5896.2894; train_edge_recon_loss: 257441.1232; train_gene_expr_recon_loss: 65315.6503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328653.0629; train_optim_loss: 328653.0629; val_kl_reg_loss: 5866.5790; val_edge_recon_loss: 257015.8686; val_gene_expr_recon_loss: 65526.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328408.4713; val_optim_loss: 328408.4713
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9910; val_auprc_score: 0.9893; val_best_acc_score: 0.9587; val_best_f1_score: 0.9595; train_kl_reg_loss: 5794.0425; train_edge_recon_loss: 262066.8967; train_gene_expr_recon_loss: 68794.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336655.7761; train_optim_loss: 336655.7761; val_kl_reg_loss: 5696.6103; val_edge_recon_loss: 261842.6780; val_gene_expr_recon_loss: 67691.3843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335230.6727; val_optim_loss: 335230.6727
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5890.6303; train_edge_recon_loss: 257489.0545; train_gene_expr_recon_loss: 65320.3657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328700.0500; train_optim_loss: 328700.0500; val_kl_reg_loss: 5878.5566; val_edge_recon_loss: 257184.2038; val_gene_expr_recon_loss: 65549.3165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328612.0773; val_optim_loss: 328612.0773
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 5754.8040; train_edge_recon_loss: 260913.8732; train_gene_expr_recon_loss: 67261.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333930.3236; train_optim_loss: 333930.3236; val_kl_reg_loss: 5786.7879; val_edge_recon_loss: 261756.5275; val_gene_expr_recon_loss: 66584.9039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334128.2194; val_optim_loss: 334128.2194
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9935; val_auprc_score: 0.9922; val_best_acc_score: 0.9671; val_best_f1_score: 0.9674; train_kl_reg_loss: 5733.6256; train_edge_recon_loss: 260244.3715; train_gene_expr_recon_loss: 66660.9047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332638.9016; train_optim_loss: 332638.9016; val_kl_reg_loss: 5681.3062; val_edge_recon_loss: 260309.7283; val_gene_expr_recon_loss: 66339.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332330.9783; val_optim_loss: 332330.9783
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5894.8907; train_edge_recon_loss: 257504.1039; train_gene_expr_recon_loss: 65288.2884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328687.2831; train_optim_loss: 328687.2831; val_kl_reg_loss: 5854.8701; val_edge_recon_loss: 257177.4330; val_gene_expr_recon_loss: 65529.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328561.3604; val_optim_loss: 328561.3604
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 5723.6141; train_edge_recon_loss: 259918.7682; train_gene_expr_recon_loss: 66342.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331985.2273; train_optim_loss: 331985.2273; val_kl_reg_loss: 5834.3025; val_edge_recon_loss: 259977.7087; val_gene_expr_recon_loss: 65979.4151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331791.4268; val_optim_loss: 331791.4268
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5890.7805; train_edge_recon_loss: 257531.0933; train_gene_expr_recon_loss: 65295.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328717.7870; train_optim_loss: 328717.7870; val_kl_reg_loss: 5866.8555; val_edge_recon_loss: 257121.4826; val_gene_expr_recon_loss: 65534.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328522.9571; val_optim_loss: 328522.9571
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 5714.4025; train_edge_recon_loss: 259674.8210; train_gene_expr_recon_loss: 66192.7453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331581.9689; train_optim_loss: 331581.9689; val_kl_reg_loss: 5638.8017; val_edge_recon_loss: 259805.2508; val_gene_expr_recon_loss: 65993.3335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331437.3869; val_optim_loss: 331437.3869
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5892.7130; train_edge_recon_loss: 257410.8228; train_gene_expr_recon_loss: 65288.6479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328592.1838; train_optim_loss: 328592.1838; val_kl_reg_loss: 5887.4320; val_edge_recon_loss: 257086.8178; val_gene_expr_recon_loss: 65460.7007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328434.9488; val_optim_loss: 328434.9488
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 5713.9056; train_edge_recon_loss: 259487.2689; train_gene_expr_recon_loss: 66027.0613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331228.2359; train_optim_loss: 331228.2359; val_kl_reg_loss: 5735.4763; val_edge_recon_loss: 259409.4147; val_gene_expr_recon_loss: 65824.3299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330969.2206; val_optim_loss: 330969.2206
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5715.0927; train_edge_recon_loss: 259269.2044; train_gene_expr_recon_loss: 65898.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330882.5203; train_optim_loss: 330882.5203; val_kl_reg_loss: 5638.2506; val_edge_recon_loss: 259272.9101; val_gene_expr_recon_loss: 65630.3927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330541.5541; val_optim_loss: 330541.5541

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5896.9735; train_edge_recon_loss: 257413.2888; train_gene_expr_recon_loss: 65207.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328517.8914; train_optim_loss: 328517.8914; val_kl_reg_loss: 5861.0640; val_edge_recon_loss: 256894.1640; val_gene_expr_recon_loss: 65473.1201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328228.3488; val_optim_loss: 328228.3488
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 5715.8287; train_edge_recon_loss: 259184.9583; train_gene_expr_recon_loss: 65809.2468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330710.0339; train_optim_loss: 330710.0339; val_kl_reg_loss: 5629.3726; val_edge_recon_loss: 258849.6699; val_gene_expr_recon_loss: 65677.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330156.0873; val_optim_loss: 330156.0873
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5895.5134; train_edge_recon_loss: 257464.4881; train_gene_expr_recon_loss: 65217.2771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328577.2787; train_optim_loss: 328577.2787; val_kl_reg_loss: 5864.5069; val_edge_recon_loss: 257016.6950; val_gene_expr_recon_loss: 65394.8038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328276.0058; val_optim_loss: 328276.0058
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 5717.4028; train_edge_recon_loss: 258991.5837; train_gene_expr_recon_loss: 65731.8543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330440.8410; train_optim_loss: 330440.8410; val_kl_reg_loss: 5690.5340; val_edge_recon_loss: 259613.7867; val_gene_expr_recon_loss: 65474.7931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330779.1138; val_optim_loss: 330779.1138
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 5721.5993; train_edge_recon_loss: 258830.2876; train_gene_expr_recon_loss: 65645.2086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330197.0957; train_optim_loss: 330197.0957; val_kl_reg_loss: 5736.1007; val_edge_recon_loss: 258729.5548; val_gene_expr_recon_loss: 65633.5671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330099.2238; val_optim_loss: 330099.2238
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5893.9137; train_edge_recon_loss: 257510.1242; train_gene_expr_recon_loss: 65230.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328634.2186; train_optim_loss: 328634.2186; val_kl_reg_loss: 5868.5643; val_edge_recon_loss: 257097.1076; val_gene_expr_recon_loss: 65505.3468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328471.0199; val_optim_loss: 328471.0199
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 5725.7405; train_edge_recon_loss: 258704.1951; train_gene_expr_recon_loss: 65649.8117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330079.7474; train_optim_loss: 330079.7474; val_kl_reg_loss: 5612.1885; val_edge_recon_loss: 258544.6738; val_gene_expr_recon_loss: 65545.9205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329702.7824; val_optim_loss: 329702.7824
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5895.2769; train_edge_recon_loss: 257457.9780; train_gene_expr_recon_loss: 65186.5164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328539.7711; train_optim_loss: 328539.7711; val_kl_reg_loss: 5869.7916; val_edge_recon_loss: 256898.3449; val_gene_expr_recon_loss: 65471.8583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328239.9939; val_optim_loss: 328239.9939
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 5727.5326; train_edge_recon_loss: 258697.9994; train_gene_expr_recon_loss: 65593.0368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330018.5689; train_optim_loss: 330018.5689; val_kl_reg_loss: 5715.0975; val_edge_recon_loss: 258546.5842; val_gene_expr_recon_loss: 65459.5473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329721.2279; val_optim_loss: 329721.2279
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5895.8075; train_edge_recon_loss: 257481.1673; train_gene_expr_recon_loss: 65198.4195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328575.3943; train_optim_loss: 328575.3943; val_kl_reg_loss: 5872.5862; val_edge_recon_loss: 257118.3875; val_gene_expr_recon_loss: 65404.4554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328395.4279; val_optim_loss: 328395.4279
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 5731.1728; train_edge_recon_loss: 258552.5331; train_gene_expr_recon_loss: 65542.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329826.0757; train_optim_loss: 329826.0757; val_kl_reg_loss: 5695.3148; val_edge_recon_loss: 258967.3532; val_gene_expr_recon_loss: 65396.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330059.1142; val_optim_loss: 330059.1142
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 5733.9963; train_edge_recon_loss: 258448.1689; train_gene_expr_recon_loss: 65521.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329704.1164; train_optim_loss: 329704.1164; val_kl_reg_loss: 5621.4963; val_edge_recon_loss: 258310.3286; val_gene_expr_recon_loss: 65383.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329314.9897; val_optim_loss: 329314.9897

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5894.2715; train_edge_recon_loss: 257471.6616; train_gene_expr_recon_loss: 65208.9402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328574.8737; train_optim_loss: 328574.8737; val_kl_reg_loss: 5864.8878; val_edge_recon_loss: 257069.1825; val_gene_expr_recon_loss: 65497.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328431.8705; val_optim_loss: 328431.8705
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 5736.4666; train_edge_recon_loss: 258368.3126; train_gene_expr_recon_loss: 65459.7142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329564.4932; train_optim_loss: 329564.4932; val_kl_reg_loss: 5588.0512; val_edge_recon_loss: 258486.2082; val_gene_expr_recon_loss: 65418.1842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329492.4443; val_optim_loss: 329492.4443
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5893.7655; train_edge_recon_loss: 257428.4186; train_gene_expr_recon_loss: 65187.2102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328509.3942; train_optim_loss: 328509.3942; val_kl_reg_loss: 5868.5140; val_edge_recon_loss: 257095.7938; val_gene_expr_recon_loss: 65488.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328452.4100; val_optim_loss: 328452.4100
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5738.5854; train_edge_recon_loss: 258366.5364; train_gene_expr_recon_loss: 65415.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329520.6473; train_optim_loss: 329520.6473; val_kl_reg_loss: 5844.7050; val_edge_recon_loss: 258154.4326; val_gene_expr_recon_loss: 65380.5105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329379.6471; val_optim_loss: 329379.6471
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5895.6564; train_edge_recon_loss: 257467.7033; train_gene_expr_recon_loss: 65172.2874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328535.6466; train_optim_loss: 328535.6466; val_kl_reg_loss: 5868.8547; val_edge_recon_loss: 257032.9814; val_gene_expr_recon_loss: 65423.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328324.9823; val_optim_loss: 328324.9823
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5739.4386; train_edge_recon_loss: 258276.6866; train_gene_expr_recon_loss: 65427.1003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329443.2260; train_optim_loss: 329443.2260; val_kl_reg_loss: 5700.1626; val_edge_recon_loss: 258351.0575; val_gene_expr_recon_loss: 65491.5415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329542.7621; val_optim_loss: 329542.7621
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 5743.5285; train_edge_recon_loss: 258180.0314; train_gene_expr_recon_loss: 65400.2488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329323.8086; train_optim_loss: 329323.8086; val_kl_reg_loss: 5815.1500; val_edge_recon_loss: 257938.4328; val_gene_expr_recon_loss: 65501.3725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329254.9561; val_optim_loss: 329254.9561
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5894.6509; train_edge_recon_loss: 257449.7568; train_gene_expr_recon_loss: 65191.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328536.0342; train_optim_loss: 328536.0342; val_kl_reg_loss: 5868.8909; val_edge_recon_loss: 257059.7274; val_gene_expr_recon_loss: 65473.5415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328402.1595; val_optim_loss: 328402.1595

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 989 min 58 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9967
Val AUPRC score: 0.9958
Val best accuracy score: 0.9811
Val best F1 score: 0.9813
Val gene expr MSE score: 1.6099

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 5745.7787; train_edge_recon_loss: 258165.8349; train_gene_expr_recon_loss: 65407.4452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329319.0588; train_optim_loss: 329319.0588; val_kl_reg_loss: 5732.6141; val_edge_recon_loss: 257980.2803; val_gene_expr_recon_loss: 65354.8566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329067.7507; val_optim_loss: 329067.7507
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 5745.6071; train_edge_recon_loss: 258095.4152; train_gene_expr_recon_loss: 65358.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329199.7909; train_optim_loss: 329199.7909; val_kl_reg_loss: 5701.5330; val_edge_recon_loss: 258152.6048; val_gene_expr_recon_loss: 65299.8478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329153.9845; val_optim_loss: 329153.9845
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5747.3681; train_edge_recon_loss: 258127.6849; train_gene_expr_recon_loss: 65384.4761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329259.5290; train_optim_loss: 329259.5290; val_kl_reg_loss: 5795.7671; val_edge_recon_loss: 258052.5533; val_gene_expr_recon_loss: 65307.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329155.7793; val_optim_loss: 329155.7793
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 5753.0755; train_edge_recon_loss: 258038.4301; train_gene_expr_recon_loss: 65309.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329100.8544; train_optim_loss: 329100.8544; val_kl_reg_loss: 5883.8475; val_edge_recon_loss: 257919.9317; val_gene_expr_recon_loss: 65356.4849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329160.2640; val_optim_loss: 329160.2640
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 5751.2513; train_edge_recon_loss: 258021.5908; train_gene_expr_recon_loss: 65307.5530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329080.3948; train_optim_loss: 329080.3948; val_kl_reg_loss: 5712.4360; val_edge_recon_loss: 257737.4523; val_gene_expr_recon_loss: 65339.5657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328789.4546; val_optim_loss: 328789.4546
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5753.2938; train_edge_recon_loss: 257990.3047; train_gene_expr_recon_loss: 65290.9594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329034.5578; train_optim_loss: 329034.5578; val_kl_reg_loss: 5795.7604; val_edge_recon_loss: 257630.7211; val_gene_expr_recon_loss: 65274.8061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328701.2869; val_optim_loss: 328701.2869
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5755.4639; train_edge_recon_loss: 257934.1352; train_gene_expr_recon_loss: 65259.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328948.7944; train_optim_loss: 328948.7944; val_kl_reg_loss: 5775.5117; val_edge_recon_loss: 257874.4542; val_gene_expr_recon_loss: 65162.1928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328812.1598; val_optim_loss: 328812.1598
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5755.7361; train_edge_recon_loss: 257931.7817; train_gene_expr_recon_loss: 65266.1104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328953.6287; train_optim_loss: 328953.6287; val_kl_reg_loss: 5715.4600; val_edge_recon_loss: 257446.1160; val_gene_expr_recon_loss: 65270.0956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328431.6705; val_optim_loss: 328431.6705
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 5756.8468; train_edge_recon_loss: 257868.4043; train_gene_expr_recon_loss: 65256.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328881.4213; train_optim_loss: 328881.4213; val_kl_reg_loss: 5757.6953; val_edge_recon_loss: 257632.5698; val_gene_expr_recon_loss: 65362.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328752.4757; val_optim_loss: 328752.4757
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5756.4783; train_edge_recon_loss: 257838.0223; train_gene_expr_recon_loss: 65267.8863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328862.3876; train_optim_loss: 328862.3876; val_kl_reg_loss: 5803.9181; val_edge_recon_loss: 257801.5881; val_gene_expr_recon_loss: 65232.2398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328837.7454; val_optim_loss: 328837.7454
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 5763.2505; train_edge_recon_loss: 257821.4303; train_gene_expr_recon_loss: 65235.6841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328820.3649; train_optim_loss: 328820.3649; val_kl_reg_loss: 5789.7222; val_edge_recon_loss: 257571.3956; val_gene_expr_recon_loss: 65279.5442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328640.6637; val_optim_loss: 328640.6637
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 5760.9914; train_edge_recon_loss: 257763.0315; train_gene_expr_recon_loss: 65253.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328777.9338; train_optim_loss: 328777.9338; val_kl_reg_loss: 5815.0450; val_edge_recon_loss: 257689.3908; val_gene_expr_recon_loss: 65214.4565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328718.8918; val_optim_loss: 328718.8918

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5789.1488; train_edge_recon_loss: 257525.2360; train_gene_expr_recon_loss: 64865.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328179.7246; train_optim_loss: 328179.7246; val_kl_reg_loss: 5766.5680; val_edge_recon_loss: 257215.1889; val_gene_expr_recon_loss: 64864.1229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327845.8802; val_optim_loss: 327845.8802
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 5782.0427; train_edge_recon_loss: 257464.4795; train_gene_expr_recon_loss: 64816.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328063.3529; train_optim_loss: 328063.3529; val_kl_reg_loss: 5754.7480; val_edge_recon_loss: 256913.9993; val_gene_expr_recon_loss: 65050.0470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327718.7950; val_optim_loss: 327718.7950
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5776.4113; train_edge_recon_loss: 257466.5610; train_gene_expr_recon_loss: 64783.1096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328026.0820; train_optim_loss: 328026.0820; val_kl_reg_loss: 5753.6401; val_edge_recon_loss: 257141.9359; val_gene_expr_recon_loss: 64923.0196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327818.5951; val_optim_loss: 327818.5951
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5771.6672; train_edge_recon_loss: 257502.3655; train_gene_expr_recon_loss: 64756.1340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328030.1668; train_optim_loss: 328030.1668; val_kl_reg_loss: 5729.6186; val_edge_recon_loss: 257264.0228; val_gene_expr_recon_loss: 64877.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327870.7295; val_optim_loss: 327870.7295
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 5768.2066; train_edge_recon_loss: 257446.7232; train_gene_expr_recon_loss: 64761.7788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327976.7087; train_optim_loss: 327976.7087; val_kl_reg_loss: 5722.9410; val_edge_recon_loss: 257115.2888; val_gene_expr_recon_loss: 64940.3189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327778.5470; val_optim_loss: 327778.5470
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5767.4453; train_edge_recon_loss: 257428.5744; train_gene_expr_recon_loss: 64765.3688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327961.3886; train_optim_loss: 327961.3886; val_kl_reg_loss: 5761.1200; val_edge_recon_loss: 257050.5363; val_gene_expr_recon_loss: 64923.3931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327735.0488; val_optim_loss: 327735.0488

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5770.6778; train_edge_recon_loss: 257449.4855; train_gene_expr_recon_loss: 64703.0335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327923.1971; train_optim_loss: 327923.1971; val_kl_reg_loss: 5745.2959; val_edge_recon_loss: 257012.1284; val_gene_expr_recon_loss: 64799.3374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327556.7628; val_optim_loss: 327556.7628
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 5771.4417; train_edge_recon_loss: 257445.4946; train_gene_expr_recon_loss: 64694.6346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327911.5706; train_optim_loss: 327911.5706; val_kl_reg_loss: 5740.1422; val_edge_recon_loss: 257202.9998; val_gene_expr_recon_loss: 64867.5302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327810.6725; val_optim_loss: 327810.6725
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5768.8652; train_edge_recon_loss: 257421.1788; train_gene_expr_recon_loss: 64661.4325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327851.4764; train_optim_loss: 327851.4764; val_kl_reg_loss: 5747.8190; val_edge_recon_loss: 257198.7247; val_gene_expr_recon_loss: 64906.9486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327853.4936; val_optim_loss: 327853.4936
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 5768.1498; train_edge_recon_loss: 257429.6770; train_gene_expr_recon_loss: 64721.9209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327919.7479; train_optim_loss: 327919.7479; val_kl_reg_loss: 5743.2932; val_edge_recon_loss: 257085.8291; val_gene_expr_recon_loss: 64821.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327650.4735; val_optim_loss: 327650.4735
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5766.5069; train_edge_recon_loss: 257457.1321; train_gene_expr_recon_loss: 64685.9103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327909.5492; train_optim_loss: 327909.5492; val_kl_reg_loss: 5741.0515; val_edge_recon_loss: 257159.0602; val_gene_expr_recon_loss: 64846.1178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327746.2301; val_optim_loss: 327746.2301

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5765.6738; train_edge_recon_loss: 257427.3491; train_gene_expr_recon_loss: 64688.8001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327881.8230; train_optim_loss: 327881.8230; val_kl_reg_loss: 5737.4597; val_edge_recon_loss: 257027.9317; val_gene_expr_recon_loss: 64911.5420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327676.9335; val_optim_loss: 327676.9335
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5765.3393; train_edge_recon_loss: 257470.3560; train_gene_expr_recon_loss: 64654.0168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327889.7118; train_optim_loss: 327889.7118; val_kl_reg_loss: 5739.6508; val_edge_recon_loss: 257107.2887; val_gene_expr_recon_loss: 64865.5810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327712.5219; val_optim_loss: 327712.5219
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5766.0190; train_edge_recon_loss: 257426.3693; train_gene_expr_recon_loss: 64710.3009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327902.6895; train_optim_loss: 327902.6895; val_kl_reg_loss: 5740.8076; val_edge_recon_loss: 257290.0923; val_gene_expr_recon_loss: 64853.6079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327884.5087; val_optim_loss: 327884.5087
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5765.3882; train_edge_recon_loss: 257384.8574; train_gene_expr_recon_loss: 64645.0774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327795.3233; train_optim_loss: 327795.3233; val_kl_reg_loss: 5740.3179; val_edge_recon_loss: 257082.5116; val_gene_expr_recon_loss: 64798.3960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327621.2257; val_optim_loss: 327621.2257

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 896 min 55 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9956
Val best accuracy score: 0.9808
Val best F1 score: 0.9810
Val gene expr MSE score: 1.6456

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
