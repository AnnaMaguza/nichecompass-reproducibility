None
Run timestamp: 16072023_064822_2006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9536; val_auprc_score: 0.9446; val_best_acc_score: 0.8881; val_best_f1_score: 0.8941; train_kl_reg_loss: 47303.7923; train_edge_recon_loss: 2804374.8904; train_gene_expr_recon_loss: 7196319.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10047997.8148; train_optim_loss: 10047997.8148; val_kl_reg_loss: 39482.5419; val_edge_recon_loss: 2706261.3356; val_gene_expr_recon_loss: 6778604.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9524347.9676; val_optim_loss: 9524347.9676
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9659; val_auprc_score: 0.9600; val_best_acc_score: 0.9063; val_best_f1_score: 0.9104; train_kl_reg_loss: 36745.5055; train_edge_recon_loss: 2679014.0396; train_gene_expr_recon_loss: 6647607.4015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9363366.9439; train_optim_loss: 9363366.9439; val_kl_reg_loss: 34646.5520; val_edge_recon_loss: 2679620.5995; val_gene_expr_recon_loss: 6578683.4329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9292950.5833; val_optim_loss: 9292950.5833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9714; val_auprc_score: 0.9664; val_best_acc_score: 0.9157; val_best_f1_score: 0.9189; train_kl_reg_loss: 32725.1887; train_edge_recon_loss: 2664549.7892; train_gene_expr_recon_loss: 6521357.6764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9218632.6564; train_optim_loss: 9218632.6564; val_kl_reg_loss: 31094.5853; val_edge_recon_loss: 2670211.4352; val_gene_expr_recon_loss: 6499033.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9200339.7222; val_optim_loss: 9200339.7222
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9767; val_auprc_score: 0.9733; val_best_acc_score: 0.9240; val_best_f1_score: 0.9265; train_kl_reg_loss: 30102.7576; train_edge_recon_loss: 2653822.7762; train_gene_expr_recon_loss: 6469808.0530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9153733.5833; train_optim_loss: 9153733.5833; val_kl_reg_loss: 29179.7475; val_edge_recon_loss: 2662170.2975; val_gene_expr_recon_loss: 6485067.4051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9176417.4352; val_optim_loss: 9176417.4352
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9784; val_auprc_score: 0.9753; val_best_acc_score: 0.9267; val_best_f1_score: 0.9289; train_kl_reg_loss: 28546.6357; train_edge_recon_loss: 2649199.5046; train_gene_expr_recon_loss: 6445540.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9123286.7225; train_optim_loss: 9123286.7225; val_kl_reg_loss: 27632.1302; val_edge_recon_loss: 2660548.4988; val_gene_expr_recon_loss: 6458205.7037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9146386.3380; val_optim_loss: 9146386.3380
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9798; val_auprc_score: 0.9767; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 27420.2488; train_edge_recon_loss: 2643108.7500; train_gene_expr_recon_loss: 6424454.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9094983.7042; train_optim_loss: 9094983.7042; val_kl_reg_loss: 27642.4719; val_edge_recon_loss: 2655153.6655; val_gene_expr_recon_loss: 6442958.9398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9125755.0370; val_optim_loss: 9125755.0370
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9823; val_auprc_score: 0.9797; val_best_acc_score: 0.9352; val_best_f1_score: 0.9369; train_kl_reg_loss: 26610.3418; train_edge_recon_loss: 2638269.7590; train_gene_expr_recon_loss: 6410922.1232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9075802.2243; train_optim_loss: 9075802.2243; val_kl_reg_loss: 26160.8320; val_edge_recon_loss: 2650993.7002; val_gene_expr_recon_loss: 6450391.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9127545.6806; val_optim_loss: 9127545.6806
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9841; val_auprc_score: 0.9817; val_best_acc_score: 0.9392; val_best_f1_score: 0.9406; train_kl_reg_loss: 25914.7680; train_edge_recon_loss: 2635430.0354; train_gene_expr_recon_loss: 6398554.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9059898.8308; train_optim_loss: 9059898.8308; val_kl_reg_loss: 25163.0398; val_edge_recon_loss: 2648722.1100; val_gene_expr_recon_loss: 6443511.8102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9117396.9444; val_optim_loss: 9117396.9444
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9849; val_auprc_score: 0.9827; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 25471.4010; train_edge_recon_loss: 2631414.2427; train_gene_expr_recon_loss: 6392843.6394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9049729.2922; train_optim_loss: 9049729.2922; val_kl_reg_loss: 24791.0943; val_edge_recon_loss: 2645316.7708; val_gene_expr_recon_loss: 6429083.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9099191.7315; val_optim_loss: 9099191.7315
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9861; val_auprc_score: 0.9840; val_best_acc_score: 0.9441; val_best_f1_score: 0.9452; train_kl_reg_loss: 25102.6600; train_edge_recon_loss: 2628633.7307; train_gene_expr_recon_loss: 6388984.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9042721.0532; train_optim_loss: 9042721.0532; val_kl_reg_loss: 24722.6491; val_edge_recon_loss: 2639758.8576; val_gene_expr_recon_loss: 6435661.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9100142.8889; val_optim_loss: 9100142.8889
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9873; val_auprc_score: 0.9854; val_best_acc_score: 0.9472; val_best_f1_score: 0.9481; train_kl_reg_loss: 24840.0828; train_edge_recon_loss: 2627127.0050; train_gene_expr_recon_loss: 6378893.9038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9030860.9895; train_optim_loss: 9030860.9895; val_kl_reg_loss: 24465.7507; val_edge_recon_loss: 2639409.1215; val_gene_expr_recon_loss: 6427388.6019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9091263.4815; val_optim_loss: 9091263.4815
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9873; val_auprc_score: 0.9854; val_best_acc_score: 0.9470; val_best_f1_score: 0.9480; train_kl_reg_loss: 24630.0566; train_edge_recon_loss: 2624751.8846; train_gene_expr_recon_loss: 6375572.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9024954.0111; train_optim_loss: 9024954.0111; val_kl_reg_loss: 24789.7275; val_edge_recon_loss: 2636761.2257; val_gene_expr_recon_loss: 6415159.5995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9076710.5556; val_optim_loss: 9076710.5556
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9878; val_auprc_score: 0.9860; val_best_acc_score: 0.9481; val_best_f1_score: 0.9489; train_kl_reg_loss: 24476.2684; train_edge_recon_loss: 2624192.8765; train_gene_expr_recon_loss: 6371593.1237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9020262.2644; train_optim_loss: 9020262.2644; val_kl_reg_loss: 24099.8658; val_edge_recon_loss: 2636609.7257; val_gene_expr_recon_loss: 6412452.2454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9073161.8611; val_optim_loss: 9073161.8611
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9885; val_auprc_score: 0.9867; val_best_acc_score: 0.9496; val_best_f1_score: 0.9505; train_kl_reg_loss: 24278.4952; train_edge_recon_loss: 2622986.7948; train_gene_expr_recon_loss: 6367792.9650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9015058.2554; train_optim_loss: 9015058.2554; val_kl_reg_loss: 24673.9540; val_edge_recon_loss: 2635352.3322; val_gene_expr_recon_loss: 6414547.5926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9074573.8519; val_optim_loss: 9074573.8519
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9886; val_auprc_score: 0.9869; val_best_acc_score: 0.9507; val_best_f1_score: 0.9517; train_kl_reg_loss: 24174.2717; train_edge_recon_loss: 2621723.4668; train_gene_expr_recon_loss: 6363567.4352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9009465.1721; train_optim_loss: 9009465.1721; val_kl_reg_loss: 24253.6444; val_edge_recon_loss: 2636702.1933; val_gene_expr_recon_loss: 6434314.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9095270.6944; val_optim_loss: 9095270.6944
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9887; val_auprc_score: 0.9871; val_best_acc_score: 0.9504; val_best_f1_score: 0.9512; train_kl_reg_loss: 24093.1733; train_edge_recon_loss: 2619989.0217; train_gene_expr_recon_loss: 6360897.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9004979.9859; train_optim_loss: 9004979.9859; val_kl_reg_loss: 23629.2256; val_edge_recon_loss: 2632486.4942; val_gene_expr_recon_loss: 6417705.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9073820.8750; val_optim_loss: 9073820.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9893; val_auprc_score: 0.9874; val_best_acc_score: 0.9528; val_best_f1_score: 0.9536; train_kl_reg_loss: 23816.3956; train_edge_recon_loss: 2619562.0075; train_gene_expr_recon_loss: 6359193.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9002571.8156; train_optim_loss: 9002571.8156; val_kl_reg_loss: 23343.7104; val_edge_recon_loss: 2629039.3854; val_gene_expr_recon_loss: 6427987.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9080370.9815; val_optim_loss: 9080370.9815

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9873; val_best_acc_score: 0.9528; val_best_f1_score: 0.9535; train_kl_reg_loss: 25183.3336; train_edge_recon_loss: 2617633.9783; train_gene_expr_recon_loss: 6315071.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8957888.8825; train_optim_loss: 8957888.8825; val_kl_reg_loss: 25307.6684; val_edge_recon_loss: 2629886.7465; val_gene_expr_recon_loss: 6378291.1366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9033485.5556; val_optim_loss: 9033485.5556
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9526; val_best_f1_score: 0.9534; train_kl_reg_loss: 25538.9876; train_edge_recon_loss: 2616501.2162; train_gene_expr_recon_loss: 6312454.9979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8954495.2186; train_optim_loss: 8954495.2186; val_kl_reg_loss: 25278.9851; val_edge_recon_loss: 2627232.6771; val_gene_expr_recon_loss: 6377532.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9030044.5463; val_optim_loss: 9030044.5463
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9896; val_auprc_score: 0.9880; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 25687.6301; train_edge_recon_loss: 2616434.4034; train_gene_expr_recon_loss: 6307796.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8949918.7081; train_optim_loss: 8949918.7081; val_kl_reg_loss: 25400.3288; val_edge_recon_loss: 2627866.1053; val_gene_expr_recon_loss: 6376022.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9029289.2083; val_optim_loss: 9029289.2083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9894; val_auprc_score: 0.9875; val_best_acc_score: 0.9530; val_best_f1_score: 0.9537; train_kl_reg_loss: 25670.1363; train_edge_recon_loss: 2615918.2546; train_gene_expr_recon_loss: 6309366.4388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8950954.8246; train_optim_loss: 8950954.8246; val_kl_reg_loss: 25596.5913; val_edge_recon_loss: 2629247.5231; val_gene_expr_recon_loss: 6381772.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9036616.1296; val_optim_loss: 9036616.1296
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9898; val_auprc_score: 0.9884; val_best_acc_score: 0.9534; val_best_f1_score: 0.9541; train_kl_reg_loss: 25666.0147; train_edge_recon_loss: 2616153.1626; train_gene_expr_recon_loss: 6304064.0653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8945883.2402; train_optim_loss: 8945883.2402; val_kl_reg_loss: 25574.4905; val_edge_recon_loss: 2630737.4676; val_gene_expr_recon_loss: 6376107.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9032419.1620; val_optim_loss: 9032419.1620
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9895; val_auprc_score: 0.9878; val_best_acc_score: 0.9532; val_best_f1_score: 0.9542; train_kl_reg_loss: 25716.3573; train_edge_recon_loss: 2615135.1337; train_gene_expr_recon_loss: 6303987.2312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8944838.7148; train_optim_loss: 8944838.7148; val_kl_reg_loss: 25360.9219; val_edge_recon_loss: 2630276.2419; val_gene_expr_recon_loss: 6368608.7801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9024245.9861; val_optim_loss: 9024245.9861
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9899; val_auprc_score: 0.9881; val_best_acc_score: 0.9541; val_best_f1_score: 0.9547; train_kl_reg_loss: 25653.5656; train_edge_recon_loss: 2616028.9097; train_gene_expr_recon_loss: 6303495.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8945177.5949; train_optim_loss: 8945177.5949; val_kl_reg_loss: 25293.3129; val_edge_recon_loss: 2627191.2049; val_gene_expr_recon_loss: 6378307.3403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9030791.8333; val_optim_loss: 9030791.8333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9544; val_best_f1_score: 0.9550; train_kl_reg_loss: 25605.7159; train_edge_recon_loss: 2614732.6276; train_gene_expr_recon_loss: 6303296.8963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8943635.2371; train_optim_loss: 8943635.2371; val_kl_reg_loss: 25258.3169; val_edge_recon_loss: 2627291.5035; val_gene_expr_recon_loss: 6377726.3241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9030276.1435; val_optim_loss: 9030276.1435
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9901; val_auprc_score: 0.9885; val_best_acc_score: 0.9550; val_best_f1_score: 0.9557; train_kl_reg_loss: 25564.2641; train_edge_recon_loss: 2615488.9706; train_gene_expr_recon_loss: 6303473.1983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8944526.4334; train_optim_loss: 8944526.4334; val_kl_reg_loss: 25242.8503; val_edge_recon_loss: 2624002.3623; val_gene_expr_recon_loss: 6369849.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9019094.7778; val_optim_loss: 9019094.7778
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9882; val_best_acc_score: 0.9546; val_best_f1_score: 0.9552; train_kl_reg_loss: 25496.6654; train_edge_recon_loss: 2615836.8278; train_gene_expr_recon_loss: 6301954.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8943288.1574; train_optim_loss: 8943288.1574; val_kl_reg_loss: 25160.7764; val_edge_recon_loss: 2629356.7315; val_gene_expr_recon_loss: 6381371.1366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9035888.6481; val_optim_loss: 9035888.6481
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9547; val_best_f1_score: 0.9554; train_kl_reg_loss: 25454.8293; train_edge_recon_loss: 2615416.2526; train_gene_expr_recon_loss: 6300365.3212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8941236.4151; train_optim_loss: 8941236.4151; val_kl_reg_loss: 25123.9823; val_edge_recon_loss: 2629295.0637; val_gene_expr_recon_loss: 6370543.1991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9024962.2546; val_optim_loss: 9024962.2546
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9899; val_auprc_score: 0.9880; val_best_acc_score: 0.9546; val_best_f1_score: 0.9554; train_kl_reg_loss: 25419.9705; train_edge_recon_loss: 2615774.2972; train_gene_expr_recon_loss: 6302490.5594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8943684.8251; train_optim_loss: 8943684.8251; val_kl_reg_loss: 25039.3939; val_edge_recon_loss: 2630861.6806; val_gene_expr_recon_loss: 6381179.3588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9037080.3889; val_optim_loss: 9037080.3889
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9553; val_best_f1_score: 0.9559; train_kl_reg_loss: 25376.4716; train_edge_recon_loss: 2614380.4348; train_gene_expr_recon_loss: 6299241.1178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8938998.0198; train_optim_loss: 8938998.0198; val_kl_reg_loss: 24995.4533; val_edge_recon_loss: 2625939.5590; val_gene_expr_recon_loss: 6373292.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9024227.5185; val_optim_loss: 9024227.5185

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9898; val_auprc_score: 0.9883; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 25386.4025; train_edge_recon_loss: 2614781.7182; train_gene_expr_recon_loss: 6292370.8902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8932539.0144; train_optim_loss: 8932539.0144; val_kl_reg_loss: 25182.3389; val_edge_recon_loss: 2629429.5775; val_gene_expr_recon_loss: 6367825.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022437.8287; val_optim_loss: 9022437.8287
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9898; val_auprc_score: 0.9882; val_best_acc_score: 0.9545; val_best_f1_score: 0.9551; train_kl_reg_loss: 25473.5189; train_edge_recon_loss: 2614366.8558; train_gene_expr_recon_loss: 6292944.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8932784.6299; train_optim_loss: 8932784.6299; val_kl_reg_loss: 25219.5543; val_edge_recon_loss: 2628859.5891; val_gene_expr_recon_loss: 6363715.8426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9017795.0000; val_optim_loss: 9017795.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 25501.8879; train_edge_recon_loss: 2614328.9492; train_gene_expr_recon_loss: 6294485.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8934316.0262; train_optim_loss: 8934316.0262; val_kl_reg_loss: 25169.2590; val_edge_recon_loss: 2626453.6806; val_gene_expr_recon_loss: 6365515.8310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9017138.7824; val_optim_loss: 9017138.7824
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9899; val_auprc_score: 0.9882; val_best_acc_score: 0.9542; val_best_f1_score: 0.9548; train_kl_reg_loss: 25523.0222; train_edge_recon_loss: 2613790.2636; train_gene_expr_recon_loss: 6293074.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8932387.6088; train_optim_loss: 8932387.6088; val_kl_reg_loss: 25222.3540; val_edge_recon_loss: 2628650.4028; val_gene_expr_recon_loss: 6372862.1806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9026734.9583; val_optim_loss: 9026734.9583
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9902; val_auprc_score: 0.9888; val_best_acc_score: 0.9552; val_best_f1_score: 0.9558; train_kl_reg_loss: 25527.5904; train_edge_recon_loss: 2613889.5269; train_gene_expr_recon_loss: 6292111.9504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931529.0707; train_optim_loss: 8931529.0707; val_kl_reg_loss: 25250.5291; val_edge_recon_loss: 2626582.6481; val_gene_expr_recon_loss: 6359695.9421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9011529.1296; val_optim_loss: 9011529.1296
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 25533.7156; train_edge_recon_loss: 2613414.9810; train_gene_expr_recon_loss: 6294780.6001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8933729.2881; train_optim_loss: 8933729.2881; val_kl_reg_loss: 25243.0060; val_edge_recon_loss: 2626166.9387; val_gene_expr_recon_loss: 6369718.1343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9021128.0787; val_optim_loss: 9021128.0787
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 25519.5349; train_edge_recon_loss: 2614541.7654; train_gene_expr_recon_loss: 6293147.9421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8933209.2479; train_optim_loss: 8933209.2479; val_kl_reg_loss: 25164.4790; val_edge_recon_loss: 2627843.6308; val_gene_expr_recon_loss: 6370305.6620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9023313.7639; val_optim_loss: 9023313.7639
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 25510.3703; train_edge_recon_loss: 2614163.3812; train_gene_expr_recon_loss: 6292143.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931816.9877; train_optim_loss: 8931816.9877; val_kl_reg_loss: 25207.8607; val_edge_recon_loss: 2628253.0938; val_gene_expr_recon_loss: 6372720.1435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9026181.0926; val_optim_loss: 9026181.0926
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 25531.9185; train_edge_recon_loss: 2613608.7539; train_gene_expr_recon_loss: 6292746.4704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931887.1355; train_optim_loss: 8931887.1355; val_kl_reg_loss: 25269.8840; val_edge_recon_loss: 2624943.9803; val_gene_expr_recon_loss: 6366248.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9016462.1574; val_optim_loss: 9016462.1574

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9901; val_auprc_score: 0.9883; val_best_acc_score: 0.9550; val_best_f1_score: 0.9557; train_kl_reg_loss: 25566.4959; train_edge_recon_loss: 2614743.0063; train_gene_expr_recon_loss: 6295172.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8935481.7791; train_optim_loss: 8935481.7791; val_kl_reg_loss: 25241.1135; val_edge_recon_loss: 2626774.6100; val_gene_expr_recon_loss: 6370642.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9022658.3611; val_optim_loss: 9022658.3611
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9549; val_best_f1_score: 0.9556; train_kl_reg_loss: 25563.2409; train_edge_recon_loss: 2614526.3040; train_gene_expr_recon_loss: 6295995.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8936084.5761; train_optim_loss: 8936084.5761; val_kl_reg_loss: 25239.6976; val_edge_recon_loss: 2627223.7604; val_gene_expr_recon_loss: 6364464.4630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9016927.8935; val_optim_loss: 9016927.8935
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9544; val_best_f1_score: 0.9551; train_kl_reg_loss: 25553.0333; train_edge_recon_loss: 2613784.5586; train_gene_expr_recon_loss: 6292363.8032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931701.4087; train_optim_loss: 8931701.4087; val_kl_reg_loss: 25237.8010; val_edge_recon_loss: 2627095.3356; val_gene_expr_recon_loss: 6365688.9491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9018022.0787; val_optim_loss: 9018022.0787
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9901; val_auprc_score: 0.9885; val_best_acc_score: 0.9548; val_best_f1_score: 0.9555; train_kl_reg_loss: 25555.0157; train_edge_recon_loss: 2613952.1722; train_gene_expr_recon_loss: 6290044.5520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8929551.7423; train_optim_loss: 8929551.7423; val_kl_reg_loss: 25273.3823; val_edge_recon_loss: 2627489.9491; val_gene_expr_recon_loss: 6363857.5648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9016620.9074; val_optim_loss: 9016620.9074

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 518 min 54 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9886
Val best accuracy score: 0.9547
Val best F1 score: 0.9555
Val gene expr MSE score: 1.5333

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
