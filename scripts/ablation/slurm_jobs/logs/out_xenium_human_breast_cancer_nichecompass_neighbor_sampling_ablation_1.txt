None
Run timestamp: 13072023_022227_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9471; val_auprc_score: 0.9312; val_best_acc_score: 0.8883; val_best_f1_score: 0.8945; train_kl_reg_loss: 6490.1717; train_edge_recon_loss: 271812.1235; train_gene_expr_recon_loss: 81020.5163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359322.8109; train_optim_loss: 359322.8109; val_kl_reg_loss: 6116.9159; val_edge_recon_loss: 269262.0498; val_gene_expr_recon_loss: 73128.6538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348507.6201; val_optim_loss: 348507.6201
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9600; val_auprc_score: 0.9486; val_best_acc_score: 0.9047; val_best_f1_score: 0.9086; train_kl_reg_loss: 5989.9351; train_edge_recon_loss: 264726.0340; train_gene_expr_recon_loss: 71319.9919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342035.9608; train_optim_loss: 342035.9608; val_kl_reg_loss: 5707.1232; val_edge_recon_loss: 268458.8524; val_gene_expr_recon_loss: 69479.0242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343644.9988; val_optim_loss: 343644.9988
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9659; val_auprc_score: 0.9566; val_best_acc_score: 0.9125; val_best_f1_score: 0.9161; train_kl_reg_loss: 5868.9040; train_edge_recon_loss: 263621.3325; train_gene_expr_recon_loss: 68391.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337881.9411; train_optim_loss: 337881.9411; val_kl_reg_loss: 5603.6326; val_edge_recon_loss: 267454.8583; val_gene_expr_recon_loss: 66971.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340029.5465; val_optim_loss: 340029.5465
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9685; val_auprc_score: 0.9597; val_best_acc_score: 0.9183; val_best_f1_score: 0.9214; train_kl_reg_loss: 5844.9753; train_edge_recon_loss: 263196.0708; train_gene_expr_recon_loss: 66485.2817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335526.3273; train_optim_loss: 335526.3273; val_kl_reg_loss: 5802.3486; val_edge_recon_loss: 267283.8353; val_gene_expr_recon_loss: 65335.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338422.1044; val_optim_loss: 338422.1044
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9712; val_auprc_score: 0.9635; val_best_acc_score: 0.9224; val_best_f1_score: 0.9250; train_kl_reg_loss: 5828.2264; train_edge_recon_loss: 262892.5041; train_gene_expr_recon_loss: 65180.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333900.9090; train_optim_loss: 333900.9090; val_kl_reg_loss: 5611.2485; val_edge_recon_loss: 267311.2605; val_gene_expr_recon_loss: 64513.0305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337435.5432; val_optim_loss: 337435.5432
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9728; val_auprc_score: 0.9655; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 5815.0369; train_edge_recon_loss: 262443.2583; train_gene_expr_recon_loss: 64196.5463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332454.8412; train_optim_loss: 332454.8412; val_kl_reg_loss: 5801.7603; val_edge_recon_loss: 266936.0687; val_gene_expr_recon_loss: 63806.5627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336544.3919; val_optim_loss: 336544.3919
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9727; val_auprc_score: 0.9654; val_best_acc_score: 0.9250; val_best_f1_score: 0.9272; train_kl_reg_loss: 5838.6970; train_edge_recon_loss: 262065.9173; train_gene_expr_recon_loss: 63573.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331477.8808; train_optim_loss: 331477.8808; val_kl_reg_loss: 5692.2825; val_edge_recon_loss: 267638.4134; val_gene_expr_recon_loss: 62850.7648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336181.4622; val_optim_loss: 336181.4622
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9747; val_auprc_score: 0.9680; val_best_acc_score: 0.9289; val_best_f1_score: 0.9308; train_kl_reg_loss: 5835.3892; train_edge_recon_loss: 262026.2592; train_gene_expr_recon_loss: 63067.3943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330929.0425; train_optim_loss: 330929.0425; val_kl_reg_loss: 5643.0879; val_edge_recon_loss: 266536.9328; val_gene_expr_recon_loss: 62447.2942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334627.3150; val_optim_loss: 334627.3150
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9757; val_auprc_score: 0.9692; val_best_acc_score: 0.9300; val_best_f1_score: 0.9319; train_kl_reg_loss: 5833.2239; train_edge_recon_loss: 261956.9079; train_gene_expr_recon_loss: 62648.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330438.9951; train_optim_loss: 330438.9951; val_kl_reg_loss: 5674.5224; val_edge_recon_loss: 266872.9457; val_gene_expr_recon_loss: 62144.8241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334692.2936; val_optim_loss: 334692.2936
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9753; val_auprc_score: 0.9688; val_best_acc_score: 0.9296; val_best_f1_score: 0.9316; train_kl_reg_loss: 5827.9169; train_edge_recon_loss: 261883.9862; train_gene_expr_recon_loss: 62330.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330042.7199; train_optim_loss: 330042.7199; val_kl_reg_loss: 5754.3908; val_edge_recon_loss: 266102.4912; val_gene_expr_recon_loss: 62017.3552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333874.2356; val_optim_loss: 333874.2356
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9751; val_auprc_score: 0.9679; val_best_acc_score: 0.9301; val_best_f1_score: 0.9323; train_kl_reg_loss: 5837.5082; train_edge_recon_loss: 261634.7959; train_gene_expr_recon_loss: 62050.8943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329523.1987; train_optim_loss: 329523.1987; val_kl_reg_loss: 5750.9137; val_edge_recon_loss: 266622.3481; val_gene_expr_recon_loss: 61912.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334285.5033; val_optim_loss: 334285.5033
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9750; val_auprc_score: 0.9678; val_best_acc_score: 0.9304; val_best_f1_score: 0.9323; train_kl_reg_loss: 5845.7926; train_edge_recon_loss: 261611.8163; train_gene_expr_recon_loss: 61903.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329361.4949; train_optim_loss: 329361.4949; val_kl_reg_loss: 5674.7354; val_edge_recon_loss: 265928.3400; val_gene_expr_recon_loss: 61636.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333239.9556; val_optim_loss: 333239.9556
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9768; val_auprc_score: 0.9710; val_best_acc_score: 0.9326; val_best_f1_score: 0.9342; train_kl_reg_loss: 5847.6558; train_edge_recon_loss: 261451.7349; train_gene_expr_recon_loss: 61721.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329021.0965; train_optim_loss: 329021.0965; val_kl_reg_loss: 5705.8028; val_edge_recon_loss: 266235.6877; val_gene_expr_recon_loss: 61413.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333354.8947; val_optim_loss: 333354.8947
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9773; val_auprc_score: 0.9715; val_best_acc_score: 0.9329; val_best_f1_score: 0.9346; train_kl_reg_loss: 5843.6101; train_edge_recon_loss: 261370.2661; train_gene_expr_recon_loss: 61589.8743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328803.7507; train_optim_loss: 328803.7507; val_kl_reg_loss: 5740.1313; val_edge_recon_loss: 266382.2496; val_gene_expr_recon_loss: 61433.2783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333555.6575; val_optim_loss: 333555.6575
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9776; val_auprc_score: 0.9718; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 5839.2403; train_edge_recon_loss: 261388.7561; train_gene_expr_recon_loss: 61455.7553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328683.7516; train_optim_loss: 328683.7516; val_kl_reg_loss: 5740.9705; val_edge_recon_loss: 265666.4120; val_gene_expr_recon_loss: 61128.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332535.4774; val_optim_loss: 332535.4774
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9782; val_auprc_score: 0.9727; val_best_acc_score: 0.9346; val_best_f1_score: 0.9362; train_kl_reg_loss: 5851.3096; train_edge_recon_loss: 261228.0196; train_gene_expr_recon_loss: 61315.1107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328394.4397; train_optim_loss: 328394.4397; val_kl_reg_loss: 5762.3773; val_edge_recon_loss: 266130.0693; val_gene_expr_recon_loss: 61019.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332911.4478; val_optim_loss: 332911.4478
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9775; val_auprc_score: 0.9707; val_best_acc_score: 0.9346; val_best_f1_score: 0.9367; train_kl_reg_loss: 5843.2363; train_edge_recon_loss: 261226.9842; train_gene_expr_recon_loss: 61236.9624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328307.1836; train_optim_loss: 328307.1836; val_kl_reg_loss: 5793.2743; val_edge_recon_loss: 265719.0625; val_gene_expr_recon_loss: 61071.9159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332584.2533; val_optim_loss: 332584.2533
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9785; val_auprc_score: 0.9724; val_best_acc_score: 0.9351; val_best_f1_score: 0.9367; train_kl_reg_loss: 5847.1808; train_edge_recon_loss: 261148.7880; train_gene_expr_recon_loss: 61158.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328154.6268; train_optim_loss: 328154.6268; val_kl_reg_loss: 5682.8784; val_edge_recon_loss: 265822.5391; val_gene_expr_recon_loss: 61051.1454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332556.5633; val_optim_loss: 332556.5633
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9786; val_auprc_score: 0.9724; val_best_acc_score: 0.9366; val_best_f1_score: 0.9383; train_kl_reg_loss: 5852.0353; train_edge_recon_loss: 261138.5591; train_gene_expr_recon_loss: 61062.4370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328053.0318; train_optim_loss: 328053.0318; val_kl_reg_loss: 5753.6133; val_edge_recon_loss: 265641.6933; val_gene_expr_recon_loss: 61081.1638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332476.4700; val_optim_loss: 332476.4700
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9792; val_auprc_score: 0.9733; val_best_acc_score: 0.9379; val_best_f1_score: 0.9392; train_kl_reg_loss: 5851.6337; train_edge_recon_loss: 261151.6668; train_gene_expr_recon_loss: 61060.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328063.6575; train_optim_loss: 328063.6575; val_kl_reg_loss: 5750.7521; val_edge_recon_loss: 265700.8812; val_gene_expr_recon_loss: 60754.5808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332206.2163; val_optim_loss: 332206.2163
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9788; val_auprc_score: 0.9729; val_best_acc_score: 0.9364; val_best_f1_score: 0.9378; train_kl_reg_loss: 5861.3085; train_edge_recon_loss: 260970.1729; train_gene_expr_recon_loss: 60942.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327773.6851; train_optim_loss: 327773.6851; val_kl_reg_loss: 5651.9701; val_edge_recon_loss: 265491.4124; val_gene_expr_recon_loss: 60775.3554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331918.7368; val_optim_loss: 331918.7368
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9782; val_auprc_score: 0.9722; val_best_acc_score: 0.9348; val_best_f1_score: 0.9367; train_kl_reg_loss: 5848.6278; train_edge_recon_loss: 261026.5753; train_gene_expr_recon_loss: 60926.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327801.7463; train_optim_loss: 327801.7463; val_kl_reg_loss: 5815.5344; val_edge_recon_loss: 265774.2449; val_gene_expr_recon_loss: 60772.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332361.8384; val_optim_loss: 332361.8384
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9735; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 5850.4585; train_edge_recon_loss: 261044.3149; train_gene_expr_recon_loss: 60870.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327765.3555; train_optim_loss: 327765.3555; val_kl_reg_loss: 5771.7273; val_edge_recon_loss: 265736.4447; val_gene_expr_recon_loss: 60731.5354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332239.7101; val_optim_loss: 332239.7101
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9801; val_auprc_score: 0.9752; val_best_acc_score: 0.9376; val_best_f1_score: 0.9392; train_kl_reg_loss: 5863.3474; train_edge_recon_loss: 260877.4481; train_gene_expr_recon_loss: 60768.8687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327509.6644; train_optim_loss: 327509.6644; val_kl_reg_loss: 5748.1296; val_edge_recon_loss: 264916.1316; val_gene_expr_recon_loss: 60586.5212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331250.7829; val_optim_loss: 331250.7829
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9790; val_auprc_score: 0.9729; val_best_acc_score: 0.9381; val_best_f1_score: 0.9397; train_kl_reg_loss: 5854.1761; train_edge_recon_loss: 260904.4531; train_gene_expr_recon_loss: 60754.8344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327513.4640; train_optim_loss: 327513.4640; val_kl_reg_loss: 5775.9209; val_edge_recon_loss: 265726.1620; val_gene_expr_recon_loss: 60575.7064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332077.7895; val_optim_loss: 332077.7895
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9790; val_auprc_score: 0.9731; val_best_acc_score: 0.9378; val_best_f1_score: 0.9391; train_kl_reg_loss: 5854.8921; train_edge_recon_loss: 260887.1176; train_gene_expr_recon_loss: 60713.4467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327455.4564; train_optim_loss: 327455.4564; val_kl_reg_loss: 5779.7909; val_edge_recon_loss: 265102.3882; val_gene_expr_recon_loss: 60494.0115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331376.1900; val_optim_loss: 331376.1900
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9788; val_auprc_score: 0.9720; val_best_acc_score: 0.9375; val_best_f1_score: 0.9390; train_kl_reg_loss: 5864.7872; train_edge_recon_loss: 260771.9920; train_gene_expr_recon_loss: 60679.2775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327316.0571; train_optim_loss: 327316.0571; val_kl_reg_loss: 5723.3277; val_edge_recon_loss: 265538.8429; val_gene_expr_recon_loss: 60602.9833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331865.1558; val_optim_loss: 331865.1558
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9797; val_auprc_score: 0.9741; val_best_acc_score: 0.9383; val_best_f1_score: 0.9397; train_kl_reg_loss: 5863.0404; train_edge_recon_loss: 260864.6205; train_gene_expr_recon_loss: 60627.1592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327354.8200; train_optim_loss: 327354.8200; val_kl_reg_loss: 5790.5646; val_edge_recon_loss: 265015.9190; val_gene_expr_recon_loss: 60466.6533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331273.1365; val_optim_loss: 331273.1365

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9806; val_auprc_score: 0.9749; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 5862.6593; train_edge_recon_loss: 260592.7222; train_gene_expr_recon_loss: 60239.3592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326694.7402; train_optim_loss: 326694.7402; val_kl_reg_loss: 5748.8714; val_edge_recon_loss: 264810.9891; val_gene_expr_recon_loss: 60087.8885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330647.7484; val_optim_loss: 330647.7484
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9803; val_auprc_score: 0.9749; val_best_acc_score: 0.9395; val_best_f1_score: 0.9407; train_kl_reg_loss: 5834.2513; train_edge_recon_loss: 260529.6198; train_gene_expr_recon_loss: 60161.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326525.6800; train_optim_loss: 326525.6800; val_kl_reg_loss: 5717.9588; val_edge_recon_loss: 265542.4895; val_gene_expr_recon_loss: 60155.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331416.3939; val_optim_loss: 331416.3939
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9798; val_auprc_score: 0.9740; val_best_acc_score: 0.9389; val_best_f1_score: 0.9405; train_kl_reg_loss: 5832.9946; train_edge_recon_loss: 260457.4488; train_gene_expr_recon_loss: 60169.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326459.8809; train_optim_loss: 326459.8809; val_kl_reg_loss: 5743.0617; val_edge_recon_loss: 265167.6377; val_gene_expr_recon_loss: 60147.9168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331058.6147; val_optim_loss: 331058.6147
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9807; val_auprc_score: 0.9751; val_best_acc_score: 0.9409; val_best_f1_score: 0.9421; train_kl_reg_loss: 5828.9535; train_edge_recon_loss: 260560.8365; train_gene_expr_recon_loss: 60184.3409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326574.1312; train_optim_loss: 326574.1312; val_kl_reg_loss: 5747.8025; val_edge_recon_loss: 264696.1340; val_gene_expr_recon_loss: 59996.7452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330440.6834; val_optim_loss: 330440.6834
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9806; val_auprc_score: 0.9754; val_best_acc_score: 0.9405; val_best_f1_score: 0.9420; train_kl_reg_loss: 5829.2019; train_edge_recon_loss: 260545.7372; train_gene_expr_recon_loss: 60143.8688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326518.8080; train_optim_loss: 326518.8080; val_kl_reg_loss: 5701.9707; val_edge_recon_loss: 264990.4484; val_gene_expr_recon_loss: 60067.4724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330759.8910; val_optim_loss: 330759.8910
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9805; val_auprc_score: 0.9751; val_best_acc_score: 0.9399; val_best_f1_score: 0.9412; train_kl_reg_loss: 5822.7796; train_edge_recon_loss: 260499.9317; train_gene_expr_recon_loss: 60137.8130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326460.5242; train_optim_loss: 326460.5242; val_kl_reg_loss: 5684.6963; val_edge_recon_loss: 265201.0892; val_gene_expr_recon_loss: 60006.2669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330892.0543; val_optim_loss: 330892.0543
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9806; val_auprc_score: 0.9756; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 5813.3381; train_edge_recon_loss: 260556.0622; train_gene_expr_recon_loss: 60106.6165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326476.0174; train_optim_loss: 326476.0174; val_kl_reg_loss: 5707.7519; val_edge_recon_loss: 265300.3997; val_gene_expr_recon_loss: 59975.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330983.2578; val_optim_loss: 330983.2578
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9816; val_auprc_score: 0.9766; val_best_acc_score: 0.9416; val_best_f1_score: 0.9431; train_kl_reg_loss: 5825.8746; train_edge_recon_loss: 260431.0770; train_gene_expr_recon_loss: 60076.7104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326333.6617; train_optim_loss: 326333.6617; val_kl_reg_loss: 5708.2915; val_edge_recon_loss: 264834.9507; val_gene_expr_recon_loss: 59956.9132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330500.1521; val_optim_loss: 330500.1521

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9814; val_auprc_score: 0.9770; val_best_acc_score: 0.9406; val_best_f1_score: 0.9418; train_kl_reg_loss: 5821.4246; train_edge_recon_loss: 260496.3930; train_gene_expr_recon_loss: 60075.1708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326392.9892; train_optim_loss: 326392.9892; val_kl_reg_loss: 5696.0691; val_edge_recon_loss: 264851.8450; val_gene_expr_recon_loss: 59941.5336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330489.4465; val_optim_loss: 330489.4465
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9810; val_auprc_score: 0.9759; val_best_acc_score: 0.9410; val_best_f1_score: 0.9424; train_kl_reg_loss: 5824.1884; train_edge_recon_loss: 260322.1093; train_gene_expr_recon_loss: 60043.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326189.6036; train_optim_loss: 326189.6036; val_kl_reg_loss: 5708.3304; val_edge_recon_loss: 264713.8988; val_gene_expr_recon_loss: 59939.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330361.4367; val_optim_loss: 330361.4367
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9808; val_auprc_score: 0.9757; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 5822.2197; train_edge_recon_loss: 260348.3604; train_gene_expr_recon_loss: 60014.6191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326185.1993; train_optim_loss: 326185.1993; val_kl_reg_loss: 5695.9583; val_edge_recon_loss: 265207.6795; val_gene_expr_recon_loss: 60003.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330907.5004; val_optim_loss: 330907.5004
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9808; val_auprc_score: 0.9747; val_best_acc_score: 0.9409; val_best_f1_score: 0.9424; train_kl_reg_loss: 5821.6132; train_edge_recon_loss: 260483.8702; train_gene_expr_recon_loss: 60014.3312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326319.8149; train_optim_loss: 326319.8149; val_kl_reg_loss: 5707.4716; val_edge_recon_loss: 264897.1811; val_gene_expr_recon_loss: 60057.4328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330662.0855; val_optim_loss: 330662.0855
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9810; val_auprc_score: 0.9757; val_best_acc_score: 0.9406; val_best_f1_score: 0.9421; train_kl_reg_loss: 5817.8393; train_edge_recon_loss: 260534.7861; train_gene_expr_recon_loss: 60038.7468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326391.3723; train_optim_loss: 326391.3723; val_kl_reg_loss: 5693.8561; val_edge_recon_loss: 265118.0208; val_gene_expr_recon_loss: 59918.0666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330729.9433; val_optim_loss: 330729.9433
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9808; val_auprc_score: 0.9756; val_best_acc_score: 0.9405; val_best_f1_score: 0.9419; train_kl_reg_loss: 5815.8663; train_edge_recon_loss: 260498.1219; train_gene_expr_recon_loss: 60027.6530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326341.6409; train_optim_loss: 326341.6409; val_kl_reg_loss: 5709.6163; val_edge_recon_loss: 265099.4739; val_gene_expr_recon_loss: 59892.8803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330701.9683; val_optim_loss: 330701.9683

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9804; val_auprc_score: 0.9749; val_best_acc_score: 0.9397; val_best_f1_score: 0.9412; train_kl_reg_loss: 5823.7354; train_edge_recon_loss: 260251.4357; train_gene_expr_recon_loss: 60043.9114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326119.0823; train_optim_loss: 326119.0823; val_kl_reg_loss: 5704.5823; val_edge_recon_loss: 265259.3616; val_gene_expr_recon_loss: 59940.0951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330904.0374; val_optim_loss: 330904.0374
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9808; val_auprc_score: 0.9753; val_best_acc_score: 0.9405; val_best_f1_score: 0.9420; train_kl_reg_loss: 5822.8563; train_edge_recon_loss: 260345.3230; train_gene_expr_recon_loss: 60061.3378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326229.5173; train_optim_loss: 326229.5173; val_kl_reg_loss: 5704.2155; val_edge_recon_loss: 265496.4389; val_gene_expr_recon_loss: 59829.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331030.0090; val_optim_loss: 331030.0090
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9808; val_auprc_score: 0.9756; val_best_acc_score: 0.9399; val_best_f1_score: 0.9414; train_kl_reg_loss: 5821.0904; train_edge_recon_loss: 260600.0737; train_gene_expr_recon_loss: 60052.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326473.1793; train_optim_loss: 326473.1793; val_kl_reg_loss: 5699.5236; val_edge_recon_loss: 265372.3935; val_gene_expr_recon_loss: 60038.9582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331110.8734; val_optim_loss: 331110.8734
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9805; val_auprc_score: 0.9752; val_best_acc_score: 0.9394; val_best_f1_score: 0.9409; train_kl_reg_loss: 5819.1892; train_edge_recon_loss: 260452.5894; train_gene_expr_recon_loss: 60048.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326320.3848; train_optim_loss: 326320.3848; val_kl_reg_loss: 5704.7704; val_edge_recon_loss: 265160.0415; val_gene_expr_recon_loss: 59914.6597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330779.4708; val_optim_loss: 330779.4708

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 74 min 15 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9807
Val AUPRC score: 0.9753
Val best accuracy score: 0.9406
Val best F1 score: 0.9420
Val gene expr MSE score: 1.4203

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
