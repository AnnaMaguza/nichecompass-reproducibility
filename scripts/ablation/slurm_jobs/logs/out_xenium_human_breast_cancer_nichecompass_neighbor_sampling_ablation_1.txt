None
Run timestamp: 01082023_132521_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9582; val_auprc_score: 0.9503; val_best_acc_score: 0.8970; val_best_f1_score: 0.9011; train_kl_reg_loss: 6119.1354; train_edge_recon_loss: 266559.4507; train_gene_expr_recon_loss: 119394.8178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392073.4038; train_optim_loss: 392073.4038; val_kl_reg_loss: 5886.9729; val_edge_recon_loss: 272260.8618; val_gene_expr_recon_loss: 108024.1557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 386171.9922; val_optim_loss: 386171.9922
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9643; val_auprc_score: 0.9568; val_best_acc_score: 0.9084; val_best_f1_score: 0.9115; train_kl_reg_loss: 5978.7552; train_edge_recon_loss: 262338.3634; train_gene_expr_recon_loss: 104813.4869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373130.6056; train_optim_loss: 373130.6056; val_kl_reg_loss: 5826.1638; val_edge_recon_loss: 270973.3957; val_gene_expr_recon_loss: 102168.6980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 378968.2579; val_optim_loss: 378968.2579
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9685; val_auprc_score: 0.9629; val_best_acc_score: 0.9135; val_best_f1_score: 0.9159; train_kl_reg_loss: 6011.4920; train_edge_recon_loss: 262054.5766; train_gene_expr_recon_loss: 101303.1089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369369.1774; train_optim_loss: 369369.1774; val_kl_reg_loss: 5750.0289; val_edge_recon_loss: 271654.1965; val_gene_expr_recon_loss: 100280.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377684.2849; val_optim_loss: 377684.2849
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9695; val_auprc_score: 0.9636; val_best_acc_score: 0.9158; val_best_f1_score: 0.9182; train_kl_reg_loss: 6037.4550; train_edge_recon_loss: 261511.9614; train_gene_expr_recon_loss: 100035.7845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367585.2014; train_optim_loss: 367585.2014; val_kl_reg_loss: 5837.2158; val_edge_recon_loss: 271381.0537; val_gene_expr_recon_loss: 99478.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376696.3839; val_optim_loss: 376696.3839
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9703; val_auprc_score: 0.9649; val_best_acc_score: 0.9171; val_best_f1_score: 0.9197; train_kl_reg_loss: 6047.9936; train_edge_recon_loss: 261319.5916; train_gene_expr_recon_loss: 99379.0003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366746.5855; train_optim_loss: 366746.5855; val_kl_reg_loss: 6008.3917; val_edge_recon_loss: 270739.4912; val_gene_expr_recon_loss: 98983.6340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375731.5159; val_optim_loss: 375731.5159
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9704; val_auprc_score: 0.9650; val_best_acc_score: 0.9182; val_best_f1_score: 0.9205; train_kl_reg_loss: 6053.3536; train_edge_recon_loss: 261177.3892; train_gene_expr_recon_loss: 98976.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366207.2679; train_optim_loss: 366207.2679; val_kl_reg_loss: 5849.8168; val_edge_recon_loss: 270739.3657; val_gene_expr_recon_loss: 98868.8503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375458.0314; val_optim_loss: 375458.0314
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9714; val_auprc_score: 0.9659; val_best_acc_score: 0.9193; val_best_f1_score: 0.9211; train_kl_reg_loss: 6063.0913; train_edge_recon_loss: 260999.1787; train_gene_expr_recon_loss: 98735.8453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365798.1150; train_optim_loss: 365798.1150; val_kl_reg_loss: 6106.7617; val_edge_recon_loss: 271218.6064; val_gene_expr_recon_loss: 98513.7761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375839.1441; val_optim_loss: 375839.1441
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9719; val_auprc_score: 0.9665; val_best_acc_score: 0.9196; val_best_f1_score: 0.9215; train_kl_reg_loss: 6067.0378; train_edge_recon_loss: 260841.1168; train_gene_expr_recon_loss: 98602.3298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365510.4845; train_optim_loss: 365510.4845; val_kl_reg_loss: 5919.2641; val_edge_recon_loss: 270539.6996; val_gene_expr_recon_loss: 98226.8064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374685.7692; val_optim_loss: 374685.7692
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9721; val_auprc_score: 0.9665; val_best_acc_score: 0.9206; val_best_f1_score: 0.9226; train_kl_reg_loss: 6068.5859; train_edge_recon_loss: 260802.9804; train_gene_expr_recon_loss: 98502.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365373.6384; train_optim_loss: 365373.6384; val_kl_reg_loss: 6010.4328; val_edge_recon_loss: 270229.5409; val_gene_expr_recon_loss: 98023.2064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374263.1806; val_optim_loss: 374263.1806
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9726; val_auprc_score: 0.9672; val_best_acc_score: 0.9231; val_best_f1_score: 0.9248; train_kl_reg_loss: 6068.7044; train_edge_recon_loss: 260810.1852; train_gene_expr_recon_loss: 98376.2562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365255.1461; train_optim_loss: 365255.1461; val_kl_reg_loss: 5978.4055; val_edge_recon_loss: 270463.3110; val_gene_expr_recon_loss: 98393.4313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374835.1476; val_optim_loss: 374835.1476
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9710; val_auprc_score: 0.9651; val_best_acc_score: 0.9196; val_best_f1_score: 0.9218; train_kl_reg_loss: 6073.5427; train_edge_recon_loss: 260654.7993; train_gene_expr_recon_loss: 98216.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364944.7446; train_optim_loss: 364944.7446; val_kl_reg_loss: 5869.0417; val_edge_recon_loss: 270384.4402; val_gene_expr_recon_loss: 98213.1018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374466.5835; val_optim_loss: 374466.5835
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9741; val_auprc_score: 0.9696; val_best_acc_score: 0.9238; val_best_f1_score: 0.9258; train_kl_reg_loss: 6068.5847; train_edge_recon_loss: 260618.8580; train_gene_expr_recon_loss: 98250.8037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364938.2469; train_optim_loss: 364938.2469; val_kl_reg_loss: 5985.0506; val_edge_recon_loss: 269627.1828; val_gene_expr_recon_loss: 98247.9963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373860.2303; val_optim_loss: 373860.2303
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9727; val_auprc_score: 0.9666; val_best_acc_score: 0.9239; val_best_f1_score: 0.9257; train_kl_reg_loss: 6063.7170; train_edge_recon_loss: 260688.2232; train_gene_expr_recon_loss: 98219.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364971.2134; train_optim_loss: 364971.2134; val_kl_reg_loss: 5895.8924; val_edge_recon_loss: 269975.5527; val_gene_expr_recon_loss: 98099.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373970.8863; val_optim_loss: 373970.8863
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9741; val_auprc_score: 0.9687; val_best_acc_score: 0.9247; val_best_f1_score: 0.9266; train_kl_reg_loss: 6073.8507; train_edge_recon_loss: 260495.7182; train_gene_expr_recon_loss: 98037.6190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364607.1877; train_optim_loss: 364607.1877; val_kl_reg_loss: 5920.3301; val_edge_recon_loss: 269560.3846; val_gene_expr_recon_loss: 97992.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373473.0811; val_optim_loss: 373473.0811
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9739; val_auprc_score: 0.9689; val_best_acc_score: 0.9242; val_best_f1_score: 0.9261; train_kl_reg_loss: 6061.8545; train_edge_recon_loss: 260522.2004; train_gene_expr_recon_loss: 98027.3764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364611.4312; train_optim_loss: 364611.4312; val_kl_reg_loss: 6054.2907; val_edge_recon_loss: 269725.6581; val_gene_expr_recon_loss: 97862.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373642.0958; val_optim_loss: 373642.0958
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9736; val_auprc_score: 0.9682; val_best_acc_score: 0.9237; val_best_f1_score: 0.9255; train_kl_reg_loss: 6064.1360; train_edge_recon_loss: 260598.0660; train_gene_expr_recon_loss: 98038.0474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364700.2496; train_optim_loss: 364700.2496; val_kl_reg_loss: 6136.8653; val_edge_recon_loss: 269545.7774; val_gene_expr_recon_loss: 97710.3225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373392.9653; val_optim_loss: 373392.9653
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9696; val_best_acc_score: 0.9249; val_best_f1_score: 0.9265; train_kl_reg_loss: 6066.2308; train_edge_recon_loss: 260417.3978; train_gene_expr_recon_loss: 97991.5575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364475.1863; train_optim_loss: 364475.1863; val_kl_reg_loss: 5881.3829; val_edge_recon_loss: 269907.3967; val_gene_expr_recon_loss: 97862.4584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373651.2393; val_optim_loss: 373651.2393
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9741; val_auprc_score: 0.9691; val_best_acc_score: 0.9242; val_best_f1_score: 0.9264; train_kl_reg_loss: 6068.6051; train_edge_recon_loss: 260352.4560; train_gene_expr_recon_loss: 97965.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364386.6661; train_optim_loss: 364386.6661; val_kl_reg_loss: 5902.9791; val_edge_recon_loss: 269255.6064; val_gene_expr_recon_loss: 98000.4478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373159.0327; val_optim_loss: 373159.0327
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9744; val_auprc_score: 0.9694; val_best_acc_score: 0.9244; val_best_f1_score: 0.9262; train_kl_reg_loss: 6069.3503; train_edge_recon_loss: 260286.1700; train_gene_expr_recon_loss: 97961.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364316.5272; train_optim_loss: 364316.5272; val_kl_reg_loss: 5928.8925; val_edge_recon_loss: 269168.3699; val_gene_expr_recon_loss: 97868.6847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372965.9477; val_optim_loss: 372965.9477
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9748; val_auprc_score: 0.9695; val_best_acc_score: 0.9258; val_best_f1_score: 0.9278; train_kl_reg_loss: 6057.1425; train_edge_recon_loss: 260382.3385; train_gene_expr_recon_loss: 97915.1578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364354.6387; train_optim_loss: 364354.6387; val_kl_reg_loss: 5872.3988; val_edge_recon_loss: 269000.3757; val_gene_expr_recon_loss: 97769.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372642.7708; val_optim_loss: 372642.7708
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9745; val_auprc_score: 0.9696; val_best_acc_score: 0.9254; val_best_f1_score: 0.9273; train_kl_reg_loss: 6065.2342; train_edge_recon_loss: 260265.4146; train_gene_expr_recon_loss: 97885.4368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364216.0856; train_optim_loss: 364216.0856; val_kl_reg_loss: 5977.9669; val_edge_recon_loss: 269440.1799; val_gene_expr_recon_loss: 97824.5594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373242.7077; val_optim_loss: 373242.7077
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9742; val_auprc_score: 0.9695; val_best_acc_score: 0.9250; val_best_f1_score: 0.9271; train_kl_reg_loss: 6069.6370; train_edge_recon_loss: 260220.7432; train_gene_expr_recon_loss: 97830.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364120.6303; train_optim_loss: 364120.6303; val_kl_reg_loss: 5969.0596; val_edge_recon_loss: 269301.5644; val_gene_expr_recon_loss: 97663.1732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372933.7981; val_optim_loss: 372933.7981
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9744; val_auprc_score: 0.9694; val_best_acc_score: 0.9254; val_best_f1_score: 0.9273; train_kl_reg_loss: 6060.6785; train_edge_recon_loss: 260260.2507; train_gene_expr_recon_loss: 97795.4202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364116.3496; train_optim_loss: 364116.3496; val_kl_reg_loss: 5926.4632; val_edge_recon_loss: 269585.0347; val_gene_expr_recon_loss: 97843.9846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373355.4839; val_optim_loss: 373355.4839
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9748; val_auprc_score: 0.9700; val_best_acc_score: 0.9249; val_best_f1_score: 0.9269; train_kl_reg_loss: 6065.5036; train_edge_recon_loss: 260161.8798; train_gene_expr_recon_loss: 97827.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364054.7970; train_optim_loss: 364054.7970; val_kl_reg_loss: 6008.8954; val_edge_recon_loss: 269452.7238; val_gene_expr_recon_loss: 97534.0704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372995.6903; val_optim_loss: 372995.6903

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9771; val_auprc_score: 0.9728; val_best_acc_score: 0.9295; val_best_f1_score: 0.9310; train_kl_reg_loss: 6046.4883; train_edge_recon_loss: 259678.2843; train_gene_expr_recon_loss: 96800.5870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362525.3593; train_optim_loss: 362525.3593; val_kl_reg_loss: 5901.4045; val_edge_recon_loss: 268636.4407; val_gene_expr_recon_loss: 96642.6560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371180.5015; val_optim_loss: 371180.5015
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9764; val_auprc_score: 0.9716; val_best_acc_score: 0.9291; val_best_f1_score: 0.9307; train_kl_reg_loss: 6016.5228; train_edge_recon_loss: 259725.3759; train_gene_expr_recon_loss: 96594.4543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362336.3533; train_optim_loss: 362336.3533; val_kl_reg_loss: 5905.7067; val_edge_recon_loss: 269076.5388; val_gene_expr_recon_loss: 96536.0447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371518.2900; val_optim_loss: 371518.2900
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9772; val_auprc_score: 0.9729; val_best_acc_score: 0.9299; val_best_f1_score: 0.9319; train_kl_reg_loss: 6018.7722; train_edge_recon_loss: 259719.6477; train_gene_expr_recon_loss: 96567.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362306.2013; train_optim_loss: 362306.2013; val_kl_reg_loss: 5932.9194; val_edge_recon_loss: 268582.2265; val_gene_expr_recon_loss: 96419.7855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370934.9313; val_optim_loss: 370934.9313
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9778; val_auprc_score: 0.9737; val_best_acc_score: 0.9299; val_best_f1_score: 0.9317; train_kl_reg_loss: 6011.5964; train_edge_recon_loss: 259778.9796; train_gene_expr_recon_loss: 96515.0082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362305.5839; train_optim_loss: 362305.5839; val_kl_reg_loss: 5925.3810; val_edge_recon_loss: 268668.8514; val_gene_expr_recon_loss: 96472.4686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371066.7010; val_optim_loss: 371066.7010
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9773; val_auprc_score: 0.9730; val_best_acc_score: 0.9297; val_best_f1_score: 0.9314; train_kl_reg_loss: 6001.2551; train_edge_recon_loss: 259761.7479; train_gene_expr_recon_loss: 96453.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362216.0181; train_optim_loss: 362216.0181; val_kl_reg_loss: 5887.0519; val_edge_recon_loss: 268744.2715; val_gene_expr_recon_loss: 96216.8211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370848.1438; val_optim_loss: 370848.1438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9778; val_auprc_score: 0.9740; val_best_acc_score: 0.9297; val_best_f1_score: 0.9315; train_kl_reg_loss: 5993.8230; train_edge_recon_loss: 259767.7282; train_gene_expr_recon_loss: 96432.4537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362194.0046; train_optim_loss: 362194.0046; val_kl_reg_loss: 5929.1469; val_edge_recon_loss: 268630.2010; val_gene_expr_recon_loss: 96417.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370977.0938; val_optim_loss: 370977.0938
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9768; val_auprc_score: 0.9723; val_best_acc_score: 0.9293; val_best_f1_score: 0.9314; train_kl_reg_loss: 5996.3105; train_edge_recon_loss: 259718.2606; train_gene_expr_recon_loss: 96433.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362147.6258; train_optim_loss: 362147.6258; val_kl_reg_loss: 5837.9549; val_edge_recon_loss: 268829.0886; val_gene_expr_recon_loss: 96394.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371061.9411; val_optim_loss: 371061.9411
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9723; val_best_acc_score: 0.9300; val_best_f1_score: 0.9315; train_kl_reg_loss: 5991.0681; train_edge_recon_loss: 259620.1560; train_gene_expr_recon_loss: 96358.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361969.5032; train_optim_loss: 361969.5032; val_kl_reg_loss: 5874.5134; val_edge_recon_loss: 268822.0176; val_gene_expr_recon_loss: 96548.3952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371244.9266; val_optim_loss: 371244.9266
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9771; val_auprc_score: 0.9723; val_best_acc_score: 0.9295; val_best_f1_score: 0.9310; train_kl_reg_loss: 5989.8071; train_edge_recon_loss: 259549.2294; train_gene_expr_recon_loss: 96371.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361910.7845; train_optim_loss: 361910.7845; val_kl_reg_loss: 5874.2677; val_edge_recon_loss: 268823.0040; val_gene_expr_recon_loss: 96421.8105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371119.0821; val_optim_loss: 371119.0821

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9773; val_auprc_score: 0.9732; val_best_acc_score: 0.9298; val_best_f1_score: 0.9316; train_kl_reg_loss: 5987.4262; train_edge_recon_loss: 259649.9402; train_gene_expr_recon_loss: 96276.6692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361914.0358; train_optim_loss: 361914.0358; val_kl_reg_loss: 5876.4221; val_edge_recon_loss: 268842.6008; val_gene_expr_recon_loss: 96157.3887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370876.4119; val_optim_loss: 370876.4119
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9783; val_auprc_score: 0.9742; val_best_acc_score: 0.9315; val_best_f1_score: 0.9331; train_kl_reg_loss: 5981.0945; train_edge_recon_loss: 259598.6123; train_gene_expr_recon_loss: 96220.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361800.4571; train_optim_loss: 361800.4571; val_kl_reg_loss: 5886.4338; val_edge_recon_loss: 268395.5653; val_gene_expr_recon_loss: 96293.7597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370575.7591; val_optim_loss: 370575.7591
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9777; val_auprc_score: 0.9735; val_best_acc_score: 0.9310; val_best_f1_score: 0.9327; train_kl_reg_loss: 5982.7729; train_edge_recon_loss: 259506.3479; train_gene_expr_recon_loss: 96215.6302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361704.7507; train_optim_loss: 361704.7507; val_kl_reg_loss: 5886.7296; val_edge_recon_loss: 268582.2135; val_gene_expr_recon_loss: 96182.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370651.8202; val_optim_loss: 370651.8202
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9779; val_auprc_score: 0.9733; val_best_acc_score: 0.9309; val_best_f1_score: 0.9327; train_kl_reg_loss: 5980.6252; train_edge_recon_loss: 259529.9290; train_gene_expr_recon_loss: 96226.6148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361737.1688; train_optim_loss: 361737.1688; val_kl_reg_loss: 5872.5119; val_edge_recon_loss: 268522.3720; val_gene_expr_recon_loss: 96106.6368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370501.5210; val_optim_loss: 370501.5210
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9769; val_auprc_score: 0.9724; val_best_acc_score: 0.9293; val_best_f1_score: 0.9313; train_kl_reg_loss: 5980.4510; train_edge_recon_loss: 259457.5502; train_gene_expr_recon_loss: 96242.1175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361680.1188; train_optim_loss: 361680.1188; val_kl_reg_loss: 5877.7445; val_edge_recon_loss: 268904.6110; val_gene_expr_recon_loss: 96239.5689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371021.9253; val_optim_loss: 371021.9253
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9775; val_auprc_score: 0.9727; val_best_acc_score: 0.9304; val_best_f1_score: 0.9319; train_kl_reg_loss: 5980.6772; train_edge_recon_loss: 259532.9768; train_gene_expr_recon_loss: 96258.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361772.5558; train_optim_loss: 361772.5558; val_kl_reg_loss: 5883.5747; val_edge_recon_loss: 268441.3645; val_gene_expr_recon_loss: 96127.6225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370452.5622; val_optim_loss: 370452.5622
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9775; val_auprc_score: 0.9734; val_best_acc_score: 0.9302; val_best_f1_score: 0.9316; train_kl_reg_loss: 5979.6848; train_edge_recon_loss: 259545.5571; train_gene_expr_recon_loss: 96230.6098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361755.8513; train_optim_loss: 361755.8513; val_kl_reg_loss: 5873.0112; val_edge_recon_loss: 268885.7402; val_gene_expr_recon_loss: 96313.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371072.4621; val_optim_loss: 371072.4621
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9775; val_auprc_score: 0.9727; val_best_acc_score: 0.9309; val_best_f1_score: 0.9323; train_kl_reg_loss: 5976.3544; train_edge_recon_loss: 259619.7246; train_gene_expr_recon_loss: 96197.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361793.4603; train_optim_loss: 361793.4603; val_kl_reg_loss: 5873.1931; val_edge_recon_loss: 268760.8772; val_gene_expr_recon_loss: 96259.5827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370893.6520; val_optim_loss: 370893.6520
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9777; val_auprc_score: 0.9735; val_best_acc_score: 0.9308; val_best_f1_score: 0.9325; train_kl_reg_loss: 5973.4819; train_edge_recon_loss: 259596.1156; train_gene_expr_recon_loss: 96227.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361796.8443; train_optim_loss: 361796.8443; val_kl_reg_loss: 5871.3932; val_edge_recon_loss: 268877.8301; val_gene_expr_recon_loss: 96174.1676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370923.3908; val_optim_loss: 370923.3908
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9778; val_auprc_score: 0.9736; val_best_acc_score: 0.9304; val_best_f1_score: 0.9325; train_kl_reg_loss: 5972.1183; train_edge_recon_loss: 259605.4616; train_gene_expr_recon_loss: 96221.8083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361799.3886; train_optim_loss: 361799.3886; val_kl_reg_loss: 5867.8793; val_edge_recon_loss: 268636.9070; val_gene_expr_recon_loss: 96397.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370902.5757; val_optim_loss: 370902.5757

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9777; val_auprc_score: 0.9734; val_best_acc_score: 0.9298; val_best_f1_score: 0.9312; train_kl_reg_loss: 5974.8166; train_edge_recon_loss: 259557.2230; train_gene_expr_recon_loss: 96210.4821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361742.5216; train_optim_loss: 361742.5216; val_kl_reg_loss: 5871.0244; val_edge_recon_loss: 268714.8712; val_gene_expr_recon_loss: 96159.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370745.1746; val_optim_loss: 370745.1746
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9774; val_auprc_score: 0.9729; val_best_acc_score: 0.9305; val_best_f1_score: 0.9320; train_kl_reg_loss: 5975.5330; train_edge_recon_loss: 259532.8531; train_gene_expr_recon_loss: 96188.2848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361696.6709; train_optim_loss: 361696.6709; val_kl_reg_loss: 5874.6753; val_edge_recon_loss: 268652.1132; val_gene_expr_recon_loss: 96305.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370832.7791; val_optim_loss: 370832.7791
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9780; val_auprc_score: 0.9742; val_best_acc_score: 0.9308; val_best_f1_score: 0.9325; train_kl_reg_loss: 5974.3552; train_edge_recon_loss: 259610.9645; train_gene_expr_recon_loss: 96146.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361731.7279; train_optim_loss: 361731.7279; val_kl_reg_loss: 5873.6335; val_edge_recon_loss: 268639.7878; val_gene_expr_recon_loss: 96309.2540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370822.6766; val_optim_loss: 370822.6766
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9774; val_auprc_score: 0.9728; val_best_acc_score: 0.9304; val_best_f1_score: 0.9320; train_kl_reg_loss: 5975.5856; train_edge_recon_loss: 259534.3372; train_gene_expr_recon_loss: 96224.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361734.1784; train_optim_loss: 361734.1784; val_kl_reg_loss: 5870.5548; val_edge_recon_loss: 268670.6271; val_gene_expr_recon_loss: 96369.4819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370910.6641; val_optim_loss: 370910.6641

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 221 min 8 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9776
val AUPRC score: 0.9737
val best accuracy score: 0.9298
val best F1 score: 0.9318
val target rna MSE score: 1.2508
val source rna MSE score: 0.3684

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
