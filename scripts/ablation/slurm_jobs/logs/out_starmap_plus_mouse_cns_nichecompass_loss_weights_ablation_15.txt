None
Run timestamp: 02072023_105639_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9849; val_auprc_score: 0.9765; val_best_acc_score: 0.9588; val_best_f1_score: 0.9596; train_kl_reg_loss: 2090.0315; train_edge_recon_loss: 27764.2769; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29854.3085; train_optim_loss: 29854.3085; val_kl_reg_loss: 2180.7729; val_edge_recon_loss: 25832.6165; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28013.3894; val_optim_loss: 28013.3894
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9885; val_auprc_score: 0.9821; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 2265.1838; train_edge_recon_loss: 27005.1930; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29270.3769; train_optim_loss: 29270.3769; val_kl_reg_loss: 2252.3465; val_edge_recon_loss: 25705.6001; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27957.9467; val_optim_loss: 27957.9467
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9896; val_auprc_score: 0.9838; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 2272.0626; train_edge_recon_loss: 26943.9039; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29215.9665; train_optim_loss: 29215.9665; val_kl_reg_loss: 2243.4050; val_edge_recon_loss: 25669.9962; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27913.4012; val_optim_loss: 27913.4012
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9896; val_auprc_score: 0.9840; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 2280.1106; train_edge_recon_loss: 26888.6715; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29168.7821; train_optim_loss: 29168.7821; val_kl_reg_loss: 2291.6034; val_edge_recon_loss: 25628.4620; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27920.0654; val_optim_loss: 27920.0654
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9862; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 2285.6780; train_edge_recon_loss: 26854.9196; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29140.5977; train_optim_loss: 29140.5977; val_kl_reg_loss: 2354.8027; val_edge_recon_loss: 25590.6371; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27945.4398; val_optim_loss: 27945.4398
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9865; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 2287.9199; train_edge_recon_loss: 26839.1871; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29127.1069; train_optim_loss: 29127.1069; val_kl_reg_loss: 2318.4842; val_edge_recon_loss: 25611.2157; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27929.6998; val_optim_loss: 27929.6998
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9921; val_auprc_score: 0.9877; val_best_acc_score: 0.9763; val_best_f1_score: 0.9767; train_kl_reg_loss: 2289.4989; train_edge_recon_loss: 26816.1840; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29105.6829; train_optim_loss: 29105.6829; val_kl_reg_loss: 2318.0467; val_edge_recon_loss: 25555.0347; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27873.0814; val_optim_loss: 27873.0814
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9879; val_best_acc_score: 0.9761; val_best_f1_score: 0.9765; train_kl_reg_loss: 2290.0713; train_edge_recon_loss: 26810.1202; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29100.1915; train_optim_loss: 29100.1915; val_kl_reg_loss: 2335.6525; val_edge_recon_loss: 25563.2085; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27898.8609; val_optim_loss: 27898.8609
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9890; val_best_acc_score: 0.9771; val_best_f1_score: 0.9775; train_kl_reg_loss: 2290.7560; train_edge_recon_loss: 26801.1242; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29091.8802; train_optim_loss: 29091.8802; val_kl_reg_loss: 2261.6672; val_edge_recon_loss: 25512.2878; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27773.9549; val_optim_loss: 27773.9549
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9927; val_auprc_score: 0.9888; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 2292.0456; train_edge_recon_loss: 26790.3892; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29082.4348; train_optim_loss: 29082.4348; val_kl_reg_loss: 2264.7755; val_edge_recon_loss: 25543.9609; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27808.7365; val_optim_loss: 27808.7365
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9890; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 2293.5656; train_edge_recon_loss: 26777.5975; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29071.1631; train_optim_loss: 29071.1631; val_kl_reg_loss: 2298.3880; val_edge_recon_loss: 25543.8434; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27842.2316; val_optim_loss: 27842.2316
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9936; val_auprc_score: 0.9899; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 2293.8424; train_edge_recon_loss: 26770.7007; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29064.5431; train_optim_loss: 29064.5431; val_kl_reg_loss: 2251.1406; val_edge_recon_loss: 25546.4011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27797.5418; val_optim_loss: 27797.5418
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9943; val_auprc_score: 0.9913; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 2296.1050; train_edge_recon_loss: 26758.5473; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29054.6523; train_optim_loss: 29054.6523; val_kl_reg_loss: 2262.2626; val_edge_recon_loss: 25515.6665; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27777.9291; val_optim_loss: 27777.9291

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9940; val_auprc_score: 0.9908; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2289.5089; train_edge_recon_loss: 26738.2891; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29027.7980; train_optim_loss: 29027.7980; val_kl_reg_loss: 2293.3861; val_edge_recon_loss: 25514.3707; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27807.7569; val_optim_loss: 27807.7569
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9948; val_auprc_score: 0.9920; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2288.7770; train_edge_recon_loss: 26733.0081; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29021.7851; train_optim_loss: 29021.7851; val_kl_reg_loss: 2282.7150; val_edge_recon_loss: 25482.7908; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27765.5058; val_optim_loss: 27765.5058
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9944; val_auprc_score: 0.9912; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2288.7515; train_edge_recon_loss: 26727.4632; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29016.2148; train_optim_loss: 29016.2148; val_kl_reg_loss: 2298.4509; val_edge_recon_loss: 25505.8806; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27804.3316; val_optim_loss: 27804.3316
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9946; val_auprc_score: 0.9917; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 2288.5487; train_edge_recon_loss: 26730.4439; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29018.9927; train_optim_loss: 29018.9927; val_kl_reg_loss: 2303.3705; val_edge_recon_loss: 25489.0680; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27792.4386; val_optim_loss: 27792.4386
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9947; val_auprc_score: 0.9919; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 2289.5796; train_edge_recon_loss: 26722.6326; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29012.2122; train_optim_loss: 29012.2122; val_kl_reg_loss: 2307.5516; val_edge_recon_loss: 25487.9168; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27795.4685; val_optim_loss: 27795.4685
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9925; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 2287.2062; train_edge_recon_loss: 26734.4239; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29021.6301; train_optim_loss: 29021.6301; val_kl_reg_loss: 2295.8285; val_edge_recon_loss: 25469.0343; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27764.8628; val_optim_loss: 27764.8628
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9922; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 2290.0189; train_edge_recon_loss: 26719.4530; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29009.4719; train_optim_loss: 29009.4719; val_kl_reg_loss: 2290.0202; val_edge_recon_loss: 25499.4266; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27789.4468; val_optim_loss: 27789.4468
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9918; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 2287.8992; train_edge_recon_loss: 26726.5798; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29014.4790; train_optim_loss: 29014.4790; val_kl_reg_loss: 2298.1429; val_edge_recon_loss: 25486.7551; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27784.8980; val_optim_loss: 27784.8980
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9922; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 2288.4369; train_edge_recon_loss: 26724.2324; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29012.6693; train_optim_loss: 29012.6693; val_kl_reg_loss: 2285.6226; val_edge_recon_loss: 25461.5907; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27747.2131; val_optim_loss: 27747.2131
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9919; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 2286.1488; train_edge_recon_loss: 26732.4364; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29018.5852; train_optim_loss: 29018.5852; val_kl_reg_loss: 2288.2778; val_edge_recon_loss: 25497.1019; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27785.3796; val_optim_loss: 27785.3796
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9923; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 2289.7081; train_edge_recon_loss: 26713.7399; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29003.4480; train_optim_loss: 29003.4480; val_kl_reg_loss: 2288.6394; val_edge_recon_loss: 25501.8743; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27790.5137; val_optim_loss: 27790.5137
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9924; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 2287.6417; train_edge_recon_loss: 26722.1839; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29009.8256; train_optim_loss: 29009.8256; val_kl_reg_loss: 2301.5655; val_edge_recon_loss: 25473.6470; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27775.2125; val_optim_loss: 27775.2125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9950; val_auprc_score: 0.9921; val_best_acc_score: 0.9821; val_best_f1_score: 0.9824; train_kl_reg_loss: 2287.8227; train_edge_recon_loss: 26721.8432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29009.6659; train_optim_loss: 29009.6659; val_kl_reg_loss: 2303.9288; val_edge_recon_loss: 25464.5157; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27768.4445; val_optim_loss: 27768.4445

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9952; val_auprc_score: 0.9928; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 2287.0417; train_edge_recon_loss: 26718.7897; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29005.8313; train_optim_loss: 29005.8313; val_kl_reg_loss: 2299.8921; val_edge_recon_loss: 25459.4029; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27759.2950; val_optim_loss: 27759.2950
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9951; val_auprc_score: 0.9929; val_best_acc_score: 0.9819; val_best_f1_score: 0.9822; train_kl_reg_loss: 2285.9514; train_edge_recon_loss: 26720.2782; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29006.2297; train_optim_loss: 29006.2297; val_kl_reg_loss: 2302.1018; val_edge_recon_loss: 25474.8951; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27776.9971; val_optim_loss: 27776.9971
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9952; val_auprc_score: 0.9926; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 2286.8858; train_edge_recon_loss: 26721.1894; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29008.0752; train_optim_loss: 29008.0752; val_kl_reg_loss: 2296.0134; val_edge_recon_loss: 25476.8477; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27772.8611; val_optim_loss: 27772.8611
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9925; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 2284.4280; train_edge_recon_loss: 26729.2393; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29013.6674; train_optim_loss: 29013.6674; val_kl_reg_loss: 2299.5147; val_edge_recon_loss: 25464.5258; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27764.0407; val_optim_loss: 27764.0407

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 157 min 52 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9925
Val best accuracy score: 0.9814
Val best F1 score: 0.9817
Val gene expr MSE score: 0.9437

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
