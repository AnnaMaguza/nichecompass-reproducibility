None
Run timestamp: 14072023_123829_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9820; val_auprc_score: 0.9747; val_best_acc_score: 0.9476; val_best_f1_score: 0.9490; train_kl_reg_loss: 122610.2296; train_edge_recon_loss: 27008463.5515; train_gene_expr_recon_loss: 11536779.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38667853.2868; train_optim_loss: 38667853.2868; val_kl_reg_loss: 140334.7549; val_edge_recon_loss: 26206278.3934; val_gene_expr_recon_loss: 10529437.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36876050.2951; val_optim_loss: 36876050.2951
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9838; val_auprc_score: 0.9780; val_best_acc_score: 0.9496; val_best_f1_score: 0.9509; train_kl_reg_loss: 134812.3576; train_edge_recon_loss: 26047005.4963; train_gene_expr_recon_loss: 10346905.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36528723.4485; train_optim_loss: 36528723.4485; val_kl_reg_loss: 122087.5218; val_edge_recon_loss: 26056668.4918; val_gene_expr_recon_loss: 10148780.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36327536.2623; val_optim_loss: 36327536.2623
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9869; val_auprc_score: 0.9827; val_best_acc_score: 0.9549; val_best_f1_score: 0.9560; train_kl_reg_loss: 113221.0308; train_edge_recon_loss: 25939027.6654; train_gene_expr_recon_loss: 10063297.2978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36115546.0221; train_optim_loss: 36115546.0221; val_kl_reg_loss: 102550.4995; val_edge_recon_loss: 25926677.0820; val_gene_expr_recon_loss: 9940277.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35969505.1803; val_optim_loss: 35969505.1803
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9833; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 101770.4926; train_edge_recon_loss: 25853973.9853; train_gene_expr_recon_loss: 9911459.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35867204.2279; train_optim_loss: 35867204.2279; val_kl_reg_loss: 86722.1922; val_edge_recon_loss: 26418329.3115; val_gene_expr_recon_loss: 9881653.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36386705.4426; val_optim_loss: 36386705.4426
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9885; val_auprc_score: 0.9845; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 93894.3853; train_edge_recon_loss: 25798517.0257; train_gene_expr_recon_loss: 9812249.1811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35704660.5993; train_optim_loss: 35704660.5993; val_kl_reg_loss: 89933.2117; val_edge_recon_loss: 25836282.2951; val_gene_expr_recon_loss: 9749814.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35676030.4262; val_optim_loss: 35676030.4262
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9891; val_auprc_score: 0.9854; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 88509.7792; train_edge_recon_loss: 25748130.7647; train_gene_expr_recon_loss: 9724119.8787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35560760.3971; train_optim_loss: 35560760.3971; val_kl_reg_loss: 83445.2868; val_edge_recon_loss: 25732288.4262; val_gene_expr_recon_loss: 9698091.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35513825.3115; val_optim_loss: 35513825.3115
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9901; val_auprc_score: 0.9869; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 81299.7382; train_edge_recon_loss: 25710058.6654; train_gene_expr_recon_loss: 9647270.7684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35438629.1324; train_optim_loss: 35438629.1324; val_kl_reg_loss: 77953.2830; val_edge_recon_loss: 25762508.4262; val_gene_expr_recon_loss: 9632806.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35473268.5246; val_optim_loss: 35473268.5246
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9909; val_auprc_score: 0.9877; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 76905.9932; train_edge_recon_loss: 25691168.3382; train_gene_expr_recon_loss: 9599443.6232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35367517.8382; train_optim_loss: 35367517.8382; val_kl_reg_loss: 74576.9247; val_edge_recon_loss: 25691533.2459; val_gene_expr_recon_loss: 9603576.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35369686.6885; val_optim_loss: 35369686.6885
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9913; val_auprc_score: 0.9881; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 73051.5776; train_edge_recon_loss: 25682882.6360; train_gene_expr_recon_loss: 9562184.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35318118.7059; train_optim_loss: 35318118.7059; val_kl_reg_loss: 70122.7450; val_edge_recon_loss: 25697646.9180; val_gene_expr_recon_loss: 9545845.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35313614.6885; val_optim_loss: 35313614.6885
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9919; val_auprc_score: 0.9889; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 70627.6464; train_edge_recon_loss: 25648423.8346; train_gene_expr_recon_loss: 9522626.3548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35241677.7868; train_optim_loss: 35241677.7868; val_kl_reg_loss: 68153.8065; val_edge_recon_loss: 25674188.6557; val_gene_expr_recon_loss: 9536967.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35279309.8361; val_optim_loss: 35279309.8361
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9922; val_auprc_score: 0.9895; val_best_acc_score: 0.9713; val_best_f1_score: 0.9719; train_kl_reg_loss: 67818.4850; train_edge_recon_loss: 25635423.1324; train_gene_expr_recon_loss: 9496883.8346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35200125.5000; train_optim_loss: 35200125.5000; val_kl_reg_loss: 65175.0217; val_edge_recon_loss: 25683042.8852; val_gene_expr_recon_loss: 9532835.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281053.9016; val_optim_loss: 35281053.9016
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9902; val_best_acc_score: 0.9711; val_best_f1_score: 0.9717; train_kl_reg_loss: 65257.4054; train_edge_recon_loss: 25615149.7243; train_gene_expr_recon_loss: 9465833.4301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35146240.5294; train_optim_loss: 35146240.5294; val_kl_reg_loss: 63793.7684; val_edge_recon_loss: 25696381.6393; val_gene_expr_recon_loss: 9505097.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35265272.3934; val_optim_loss: 35265272.3934
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9911; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 63705.0705; train_edge_recon_loss: 25609167.5147; train_gene_expr_recon_loss: 9439690.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35112563.1801; train_optim_loss: 35112563.1801; val_kl_reg_loss: 61965.2092; val_edge_recon_loss: 25648146.1311; val_gene_expr_recon_loss: 9495899.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35206010.6885; val_optim_loss: 35206010.6885
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9930; val_auprc_score: 0.9904; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 61791.9525; train_edge_recon_loss: 25605843.7390; train_gene_expr_recon_loss: 9419306.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35086941.7132; train_optim_loss: 35086941.7132; val_kl_reg_loss: 60821.8089; val_edge_recon_loss: 25660845.4754; val_gene_expr_recon_loss: 9499260.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35220927.9344; val_optim_loss: 35220927.9344
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 60355.8565; train_edge_recon_loss: 25595142.2022; train_gene_expr_recon_loss: 9394329.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35049827.2647; train_optim_loss: 35049827.2647; val_kl_reg_loss: 59078.3699; val_edge_recon_loss: 25626268.4590; val_gene_expr_recon_loss: 9473006.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35158352.9180; val_optim_loss: 35158352.9180
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9759; val_best_f1_score: 0.9761; train_kl_reg_loss: 59271.3459; train_edge_recon_loss: 25582863.7169; train_gene_expr_recon_loss: 9376881.8180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35019016.7574; train_optim_loss: 35019016.7574; val_kl_reg_loss: 57654.1347; val_edge_recon_loss: 25616631.3770; val_gene_expr_recon_loss: 9471906.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35146192.2623; val_optim_loss: 35146192.2623
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9938; val_auprc_score: 0.9914; val_best_acc_score: 0.9757; val_best_f1_score: 0.9761; train_kl_reg_loss: 58537.9302; train_edge_recon_loss: 25580325.3272; train_gene_expr_recon_loss: 9362003.2923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35000866.5956; train_optim_loss: 35000866.5956; val_kl_reg_loss: 56592.3830; val_edge_recon_loss: 25627112.5902; val_gene_expr_recon_loss: 9451131.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35134836.8525; val_optim_loss: 35134836.8525
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9941; val_auprc_score: 0.9920; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 57192.7997; train_edge_recon_loss: 25570799.4301; train_gene_expr_recon_loss: 9348023.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34976015.8824; train_optim_loss: 34976015.8824; val_kl_reg_loss: 56893.4900; val_edge_recon_loss: 25601020.9836; val_gene_expr_recon_loss: 9458077.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35115991.4098; val_optim_loss: 35115991.4098
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9917; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 56543.1164; train_edge_recon_loss: 25560035.8860; train_gene_expr_recon_loss: 9330104.0175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34946682.9265; train_optim_loss: 34946682.9265; val_kl_reg_loss: 56111.9475; val_edge_recon_loss: 25598551.8033; val_gene_expr_recon_loss: 9467940.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35122604.0000; val_optim_loss: 35122604.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 55564.4057; train_edge_recon_loss: 25560942.5699; train_gene_expr_recon_loss: 9314288.9706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34930795.9265; train_optim_loss: 34930795.9265; val_kl_reg_loss: 54368.9445; val_edge_recon_loss: 25597577.1475; val_gene_expr_recon_loss: 9476500.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35128446.9508; val_optim_loss: 35128446.9508
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9767; val_best_f1_score: 0.9771; train_kl_reg_loss: 55058.2797; train_edge_recon_loss: 25561610.4632; train_gene_expr_recon_loss: 9288171.1415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34904839.7941; train_optim_loss: 34904839.7941; val_kl_reg_loss: 54238.7474; val_edge_recon_loss: 25603846.0984; val_gene_expr_recon_loss: 9480757.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35138842.8197; val_optim_loss: 35138842.8197
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 54385.6806; train_edge_recon_loss: 25552824.0809; train_gene_expr_recon_loss: 9282074.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34889284.2279; train_optim_loss: 34889284.2279; val_kl_reg_loss: 53091.8364; val_edge_recon_loss: 25552524.8197; val_gene_expr_recon_loss: 9474668.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35080285.7049; val_optim_loss: 35080285.7049
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 53858.2837; train_edge_recon_loss: 25542276.1176; train_gene_expr_recon_loss: 9268579.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34864713.8162; train_optim_loss: 34864713.8162; val_kl_reg_loss: 53187.6383; val_edge_recon_loss: 25590398.1967; val_gene_expr_recon_loss: 9468164.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35111750.5574; val_optim_loss: 35111750.5574
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 53394.6778; train_edge_recon_loss: 25532469.8456; train_gene_expr_recon_loss: 9250265.6314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34836130.1103; train_optim_loss: 34836130.1103; val_kl_reg_loss: 52594.8489; val_edge_recon_loss: 25585227.2787; val_gene_expr_recon_loss: 9456329.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35094151.3443; val_optim_loss: 35094151.3443
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9935; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 52773.0355; train_edge_recon_loss: 25538478.2353; train_gene_expr_recon_loss: 9238746.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34829998.3750; train_optim_loss: 34829998.3750; val_kl_reg_loss: 52360.8089; val_edge_recon_loss: 25582150.4918; val_gene_expr_recon_loss: 9472163.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35106675.1475; val_optim_loss: 35106675.1475
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9953; val_auprc_score: 0.9935; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 52284.6591; train_edge_recon_loss: 25528678.2537; train_gene_expr_recon_loss: 9231634.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34812597.1765; train_optim_loss: 34812597.1765; val_kl_reg_loss: 51614.9874; val_edge_recon_loss: 25574345.7705; val_gene_expr_recon_loss: 9483533.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35109494.4918; val_optim_loss: 35109494.4918

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 53813.7160; train_edge_recon_loss: 25520643.6176; train_gene_expr_recon_loss: 9159336.2059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34733793.6397; train_optim_loss: 34733793.6397; val_kl_reg_loss: 54032.3321; val_edge_recon_loss: 25545740.9836; val_gene_expr_recon_loss: 9439461.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35039234.2295; val_optim_loss: 35039234.2295
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 55216.1448; train_edge_recon_loss: 25512513.4926; train_gene_expr_recon_loss: 9153968.1866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34721697.8897; train_optim_loss: 34721697.8897; val_kl_reg_loss: 54589.4810; val_edge_recon_loss: 25583023.6721; val_gene_expr_recon_loss: 9457258.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35094872.1967; val_optim_loss: 35094872.1967
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9935; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 55505.3052; train_edge_recon_loss: 25519186.3713; train_gene_expr_recon_loss: 9144623.4191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34719315.1324; train_optim_loss: 34719315.1324; val_kl_reg_loss: 54772.5499; val_edge_recon_loss: 25556367.9672; val_gene_expr_recon_loss: 9443255.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35054396.4590; val_optim_loss: 35054396.4590
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 55741.0394; train_edge_recon_loss: 25509396.2426; train_gene_expr_recon_loss: 9138275.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703412.3529; train_optim_loss: 34703412.3529; val_kl_reg_loss: 55108.9734; val_edge_recon_loss: 25598511.0820; val_gene_expr_recon_loss: 9444631.0738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35098251.2131; val_optim_loss: 35098251.2131
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 55967.2267; train_edge_recon_loss: 25513576.2279; train_gene_expr_recon_loss: 9135779.0506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34705322.4265; train_optim_loss: 34705322.4265; val_kl_reg_loss: 55140.8546; val_edge_recon_loss: 25537844.6885; val_gene_expr_recon_loss: 9458144.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35051129.6393; val_optim_loss: 35051129.6393

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9933; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 55905.6119; train_edge_recon_loss: 25521466.8529; train_gene_expr_recon_loss: 9135494.2197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34712866.8015; train_optim_loss: 34712866.8015; val_kl_reg_loss: 55200.9204; val_edge_recon_loss: 25565812.2951; val_gene_expr_recon_loss: 9428818.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35049831.7377; val_optim_loss: 35049831.7377
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 55972.1871; train_edge_recon_loss: 25508553.8824; train_gene_expr_recon_loss: 9122943.3621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34687469.5074; train_optim_loss: 34687469.5074; val_kl_reg_loss: 55295.3969; val_edge_recon_loss: 25568565.0492; val_gene_expr_recon_loss: 9437959.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35061819.8689; val_optim_loss: 35061819.8689
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 56074.1619; train_edge_recon_loss: 25518870.7316; train_gene_expr_recon_loss: 9132579.0028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34707523.9118; train_optim_loss: 34707523.9118; val_kl_reg_loss: 55354.5777; val_edge_recon_loss: 25544428.5246; val_gene_expr_recon_loss: 9449922.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35049705.7049; val_optim_loss: 35049705.7049
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 56127.0469; train_edge_recon_loss: 25512242.0993; train_gene_expr_recon_loss: 9132754.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34701123.5809; train_optim_loss: 34701123.5809; val_kl_reg_loss: 55427.2791; val_edge_recon_loss: 25576836.8852; val_gene_expr_recon_loss: 9439683.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35071947.4754; val_optim_loss: 35071947.4754

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 190 min 58 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9954
Val AUPRC score: 0.9940
Val best accuracy score: 0.9798
Val best F1 score: 0.9800
Val gene expr MSE score: 0.6147

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
