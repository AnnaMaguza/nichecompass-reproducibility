None
Run timestamp: 07082023_121143_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1094923
Number of validation edges: 121658
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9910; val_auprc_score: 0.9881; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 7370.0087; train_edge_recon_loss: 264108.2095; train_gene_expr_recon_loss: 199371.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470850.0245; train_optim_loss: 470850.0245; val_kl_reg_loss: 7011.8499; val_edge_recon_loss: 259420.0580; val_gene_expr_recon_loss: 182875.7152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449307.6225; val_optim_loss: 449307.6225
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 6828.1348; train_edge_recon_loss: 259287.6989; train_gene_expr_recon_loss: 179227.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445343.8184; train_optim_loss: 445343.8184; val_kl_reg_loss: 6659.9942; val_edge_recon_loss: 257800.5999; val_gene_expr_recon_loss: 176327.5794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440788.1712; val_optim_loss: 440788.1712
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6596.6624; train_edge_recon_loss: 258232.7617; train_gene_expr_recon_loss: 175155.2066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439984.6304; train_optim_loss: 439984.6304; val_kl_reg_loss: 6571.4420; val_edge_recon_loss: 256981.2612; val_gene_expr_recon_loss: 173726.6937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437279.3971; val_optim_loss: 437279.3971
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 6501.0109; train_edge_recon_loss: 257558.5734; train_gene_expr_recon_loss: 173580.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437640.4170; train_optim_loss: 437640.4170; val_kl_reg_loss: 6391.7516; val_edge_recon_loss: 256175.1180; val_gene_expr_recon_loss: 172981.4495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435548.3193; val_optim_loss: 435548.3193
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 6456.9270; train_edge_recon_loss: 257086.8878; train_gene_expr_recon_loss: 172809.9964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436353.8110; train_optim_loss: 436353.8110; val_kl_reg_loss: 6418.0414; val_edge_recon_loss: 256003.2244; val_gene_expr_recon_loss: 172522.9627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434944.2294; val_optim_loss: 434944.2294
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6435.6518; train_edge_recon_loss: 256787.5259; train_gene_expr_recon_loss: 172427.1785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435650.3567; train_optim_loss: 435650.3567; val_kl_reg_loss: 6347.4105; val_edge_recon_loss: 255721.1979; val_gene_expr_recon_loss: 172142.9645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434211.5726; val_optim_loss: 434211.5726
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6423.1943; train_edge_recon_loss: 256618.1010; train_gene_expr_recon_loss: 172023.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435064.7071; train_optim_loss: 435064.7071; val_kl_reg_loss: 6518.3569; val_edge_recon_loss: 255458.7131; val_gene_expr_recon_loss: 171860.3159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433837.3858; val_optim_loss: 433837.3858
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6424.6315; train_edge_recon_loss: 256391.6015; train_gene_expr_recon_loss: 171593.2037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434409.4366; train_optim_loss: 434409.4366; val_kl_reg_loss: 6447.9298; val_edge_recon_loss: 255416.8976; val_gene_expr_recon_loss: 171708.7510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433573.5792; val_optim_loss: 433573.5792
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6423.5227; train_edge_recon_loss: 256292.1783; train_gene_expr_recon_loss: 171031.0962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433746.7973; train_optim_loss: 433746.7973; val_kl_reg_loss: 6372.5552; val_edge_recon_loss: 255164.8559; val_gene_expr_recon_loss: 170959.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432497.1769; val_optim_loss: 432497.1769
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6425.0007; train_edge_recon_loss: 256136.6966; train_gene_expr_recon_loss: 170491.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433053.0833; train_optim_loss: 433053.0833; val_kl_reg_loss: 6448.8606; val_edge_recon_loss: 255116.0729; val_gene_expr_recon_loss: 164483.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 426048.8548; val_optim_loss: 426048.8548
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 6426.7518; train_edge_recon_loss: 256060.5236; train_gene_expr_recon_loss: 168531.4566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431018.7319; train_optim_loss: 431018.7319; val_kl_reg_loss: 6426.0174; val_edge_recon_loss: 254892.7899; val_gene_expr_recon_loss: 149569.5634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 410888.3716; val_optim_loss: 410888.3716
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9900; val_best_f1_score: 0.9900; train_kl_reg_loss: 6429.2243; train_edge_recon_loss: 256022.0073; train_gene_expr_recon_loss: 162440.8228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 424892.0546; train_optim_loss: 424892.0546; val_kl_reg_loss: 6385.4513; val_edge_recon_loss: 254964.7593; val_gene_expr_recon_loss: 196675.5638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 458025.7753; val_optim_loss: 458025.7753
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 6437.8934; train_edge_recon_loss: 255897.4056; train_gene_expr_recon_loss: 141498.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 403833.6404; train_optim_loss: 403833.6404; val_kl_reg_loss: 6427.5900; val_edge_recon_loss: 255008.3765; val_gene_expr_recon_loss: 141466.9191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 402902.8856; val_optim_loss: 402902.8856
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9900; val_best_f1_score: 0.9901; train_kl_reg_loss: 6438.8184; train_edge_recon_loss: 255822.2393; train_gene_expr_recon_loss: 117475.6622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 379736.7196; train_optim_loss: 379736.7196; val_kl_reg_loss: 6510.8386; val_edge_recon_loss: 255025.5659; val_gene_expr_recon_loss: 123458.6590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 384995.0636; val_optim_loss: 384995.0636
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9903; val_best_f1_score: 0.9904; train_kl_reg_loss: 6445.9057; train_edge_recon_loss: 255711.8358; train_gene_expr_recon_loss: 94052.8001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356210.5418; train_optim_loss: 356210.5418; val_kl_reg_loss: 6420.4958; val_edge_recon_loss: 254865.7627; val_gene_expr_recon_loss: 95585.8002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356872.0591; val_optim_loss: 356872.0591
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9909; val_best_f1_score: 0.9909; train_kl_reg_loss: 6450.2741; train_edge_recon_loss: 255690.0900; train_gene_expr_recon_loss: 92576.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354717.1454; train_optim_loss: 354717.1454; val_kl_reg_loss: 6415.6320; val_edge_recon_loss: 254719.2860; val_gene_expr_recon_loss: 99765.7660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360900.6840; val_optim_loss: 360900.6840
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9907; val_best_f1_score: 0.9908; train_kl_reg_loss: 6455.0153; train_edge_recon_loss: 255646.8922; train_gene_expr_recon_loss: 92179.6811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354281.5886; train_optim_loss: 354281.5886; val_kl_reg_loss: 6468.6067; val_edge_recon_loss: 254829.7348; val_gene_expr_recon_loss: 94332.2805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355630.6224; val_optim_loss: 355630.6224
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9911; val_best_f1_score: 0.9911; train_kl_reg_loss: 6459.3173; train_edge_recon_loss: 255610.5473; train_gene_expr_recon_loss: 92087.4920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354157.3569; train_optim_loss: 354157.3569; val_kl_reg_loss: 6469.8344; val_edge_recon_loss: 254651.6136; val_gene_expr_recon_loss: 98175.4976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359296.9462; val_optim_loss: 359296.9462
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9913; val_best_f1_score: 0.9913; train_kl_reg_loss: 6463.9493; train_edge_recon_loss: 255556.2172; train_gene_expr_recon_loss: 93006.0609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355026.2272; train_optim_loss: 355026.2272; val_kl_reg_loss: 6473.8144; val_edge_recon_loss: 254631.0613; val_gene_expr_recon_loss: 93487.1325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354592.0079; val_optim_loss: 354592.0079
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9916; val_best_f1_score: 0.9916; train_kl_reg_loss: 6471.7475; train_edge_recon_loss: 255474.5717; train_gene_expr_recon_loss: 92578.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354524.7667; train_optim_loss: 354524.7667; val_kl_reg_loss: 6488.9305; val_edge_recon_loss: 254647.2360; val_gene_expr_recon_loss: 97287.8058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358423.9736; val_optim_loss: 358423.9736
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9987; val_auprc_score: 0.9981; val_best_acc_score: 0.9915; val_best_f1_score: 0.9915; train_kl_reg_loss: 6475.5400; train_edge_recon_loss: 255483.9196; train_gene_expr_recon_loss: 93681.5577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355641.0170; train_optim_loss: 355641.0170; val_kl_reg_loss: 6438.2168; val_edge_recon_loss: 254621.6508; val_gene_expr_recon_loss: 95399.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356459.5536; val_optim_loss: 356459.5536
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9917; val_best_f1_score: 0.9917; train_kl_reg_loss: 6479.9773; train_edge_recon_loss: 255485.3576; train_gene_expr_recon_loss: 93630.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355595.9516; train_optim_loss: 355595.9516; val_kl_reg_loss: 6498.9643; val_edge_recon_loss: 254541.8166; val_gene_expr_recon_loss: 95253.2181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356294.0000; val_optim_loss: 356294.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9915; val_best_f1_score: 0.9915; train_kl_reg_loss: 6487.0147; train_edge_recon_loss: 255411.6767; train_gene_expr_recon_loss: 93545.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355444.5545; train_optim_loss: 355444.5545; val_kl_reg_loss: 6497.9573; val_edge_recon_loss: 254644.0038; val_gene_expr_recon_loss: 94791.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355933.2954; val_optim_loss: 355933.2954

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9986; val_auprc_score: 0.9978; val_best_acc_score: 0.9920; val_best_f1_score: 0.9920; train_kl_reg_loss: 6513.4275; train_edge_recon_loss: 255363.3962; train_gene_expr_recon_loss: 92903.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354780.3996; train_optim_loss: 354780.3996; val_kl_reg_loss: 6517.6929; val_edge_recon_loss: 254527.7840; val_gene_expr_recon_loss: 95116.0800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356161.5578; val_optim_loss: 356161.5578
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9988; val_auprc_score: 0.9984; val_best_acc_score: 0.9924; val_best_f1_score: 0.9924; train_kl_reg_loss: 6515.0126; train_edge_recon_loss: 255283.3801; train_gene_expr_recon_loss: 92806.2357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354604.6283; train_optim_loss: 354604.6283; val_kl_reg_loss: 6511.8846; val_edge_recon_loss: 254429.7409; val_gene_expr_recon_loss: 95054.8714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355996.4965; val_optim_loss: 355996.4965
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9988; val_auprc_score: 0.9983; val_best_acc_score: 0.9923; val_best_f1_score: 0.9923; train_kl_reg_loss: 6514.8922; train_edge_recon_loss: 255274.0605; train_gene_expr_recon_loss: 92735.6520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354524.6046; train_optim_loss: 354524.6046; val_kl_reg_loss: 6520.9341; val_edge_recon_loss: 254472.8810; val_gene_expr_recon_loss: 94610.9920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355604.8079; val_optim_loss: 355604.8079
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9989; val_auprc_score: 0.9984; val_best_acc_score: 0.9924; val_best_f1_score: 0.9924; train_kl_reg_loss: 6520.0259; train_edge_recon_loss: 255251.0990; train_gene_expr_recon_loss: 92644.1870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354415.3119; train_optim_loss: 354415.3119; val_kl_reg_loss: 6523.6224; val_edge_recon_loss: 254336.7329; val_gene_expr_recon_loss: 94878.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355738.5503; val_optim_loss: 355738.5503

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 378 min 2 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9984
val AUPRC score: 0.9977
val best accuracy score: 0.9911
val best F1 score: 0.9912
val target rna MSE score: 0.5879
val source rna MSE score: 0.0346

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
