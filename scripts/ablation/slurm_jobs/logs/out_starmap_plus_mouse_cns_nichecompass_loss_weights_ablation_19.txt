None
Run timestamp: 02072023_113729_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9870; val_auprc_score: 0.9818; val_best_acc_score: 0.9585; val_best_f1_score: 0.9594; train_kl_reg_loss: 2274.1460; train_edge_recon_loss: 27887.4385; train_gene_expr_recon_loss: 12772.4448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42934.0293; train_optim_loss: 42934.0293; val_kl_reg_loss: 2405.9199; val_edge_recon_loss: 26213.4327; val_gene_expr_recon_loss: 11451.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40070.9070; val_optim_loss: 40070.9070
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9865; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 2441.4872; train_edge_recon_loss: 27185.9065; train_gene_expr_recon_loss: 11172.6492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40800.0429; train_optim_loss: 40800.0429; val_kl_reg_loss: 2433.2955; val_edge_recon_loss: 26062.8081; val_gene_expr_recon_loss: 10847.5982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39343.7018; val_optim_loss: 39343.7018
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9921; val_auprc_score: 0.9893; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 2456.6920; train_edge_recon_loss: 27111.7320; train_gene_expr_recon_loss: 10734.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40302.9130; train_optim_loss: 40302.9130; val_kl_reg_loss: 2410.7089; val_edge_recon_loss: 26001.4044; val_gene_expr_recon_loss: 10540.5605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38952.6741; val_optim_loss: 38952.6741
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9923; val_auprc_score: 0.9893; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 2468.0433; train_edge_recon_loss: 27077.5366; train_gene_expr_recon_loss: 10473.8251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40019.4049; train_optim_loss: 40019.4049; val_kl_reg_loss: 2427.5853; val_edge_recon_loss: 25980.0220; val_gene_expr_recon_loss: 10321.3184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38728.9258; val_optim_loss: 38728.9258
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9728; val_best_f1_score: 0.9733; train_kl_reg_loss: 2483.8365; train_edge_recon_loss: 27029.3620; train_gene_expr_recon_loss: 10303.2618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39816.4602; train_optim_loss: 39816.4602; val_kl_reg_loss: 2481.0788; val_edge_recon_loss: 25976.5457; val_gene_expr_recon_loss: 10149.9776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38607.6021; val_optim_loss: 38607.6021
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9913; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 2495.8147; train_edge_recon_loss: 26994.9245; train_gene_expr_recon_loss: 10185.8129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39676.5522; train_optim_loss: 39676.5522; val_kl_reg_loss: 2402.0924; val_edge_recon_loss: 25900.4540; val_gene_expr_recon_loss: 10075.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38378.0202; val_optim_loss: 38378.0202
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 2508.0378; train_edge_recon_loss: 26959.8922; train_gene_expr_recon_loss: 10087.7212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39555.6513; train_optim_loss: 39555.6513; val_kl_reg_loss: 2501.0309; val_edge_recon_loss: 25904.1767; val_gene_expr_recon_loss: 9969.8609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38375.0686; val_optim_loss: 38375.0686
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 2518.5162; train_edge_recon_loss: 26938.7978; train_gene_expr_recon_loss: 10027.8407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39485.1548; train_optim_loss: 39485.1548; val_kl_reg_loss: 2525.3183; val_edge_recon_loss: 25867.4132; val_gene_expr_recon_loss: 9933.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38325.8919; val_optim_loss: 38325.8919
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 2527.2299; train_edge_recon_loss: 26911.8454; train_gene_expr_recon_loss: 9964.5552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39403.6305; train_optim_loss: 39403.6305; val_kl_reg_loss: 2491.1709; val_edge_recon_loss: 25847.4769; val_gene_expr_recon_loss: 9881.0396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.6875; val_optim_loss: 38219.6875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 2536.0194; train_edge_recon_loss: 26886.5350; train_gene_expr_recon_loss: 9921.4192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39343.9736; train_optim_loss: 39343.9736; val_kl_reg_loss: 2541.1185; val_edge_recon_loss: 25824.1666; val_gene_expr_recon_loss: 9875.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38240.5867; val_optim_loss: 38240.5867
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 2543.4273; train_edge_recon_loss: 26869.5378; train_gene_expr_recon_loss: 9884.8082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39297.7734; train_optim_loss: 39297.7734; val_kl_reg_loss: 2536.3287; val_edge_recon_loss: 25787.2426; val_gene_expr_recon_loss: 9814.4199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38137.9914; val_optim_loss: 38137.9914
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 2551.7466; train_edge_recon_loss: 26852.9965; train_gene_expr_recon_loss: 9860.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39265.3424; train_optim_loss: 39265.3424; val_kl_reg_loss: 2558.2996; val_edge_recon_loss: 25784.4241; val_gene_expr_recon_loss: 9797.5459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38140.2697; val_optim_loss: 38140.2697
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 2558.2428; train_edge_recon_loss: 26842.3417; train_gene_expr_recon_loss: 9825.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39226.3874; train_optim_loss: 39226.3874; val_kl_reg_loss: 2592.1998; val_edge_recon_loss: 25779.1399; val_gene_expr_recon_loss: 9781.2191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38152.5587; val_optim_loss: 38152.5587
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2565.4884; train_edge_recon_loss: 26825.0134; train_gene_expr_recon_loss: 9809.4156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39199.9173; train_optim_loss: 39199.9173; val_kl_reg_loss: 2562.7111; val_edge_recon_loss: 25808.2874; val_gene_expr_recon_loss: 9803.1444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38174.1431; val_optim_loss: 38174.1431
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 2569.7861; train_edge_recon_loss: 26814.0715; train_gene_expr_recon_loss: 9774.4620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39158.3196; train_optim_loss: 39158.3196; val_kl_reg_loss: 2545.3194; val_edge_recon_loss: 25740.5643; val_gene_expr_recon_loss: 9765.4441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38051.3275; val_optim_loss: 38051.3275
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 2576.4179; train_edge_recon_loss: 26800.2019; train_gene_expr_recon_loss: 9762.2931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39138.9130; train_optim_loss: 39138.9130; val_kl_reg_loss: 2603.0484; val_edge_recon_loss: 25725.2316; val_gene_expr_recon_loss: 9766.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38094.5069; val_optim_loss: 38094.5069
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9970; val_auprc_score: 0.9959; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 2581.2682; train_edge_recon_loss: 26788.8121; train_gene_expr_recon_loss: 9747.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39117.0998; train_optim_loss: 39117.0998; val_kl_reg_loss: 2545.6547; val_edge_recon_loss: 25742.1368; val_gene_expr_recon_loss: 9764.8015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38052.5929; val_optim_loss: 38052.5929
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 2584.8362; train_edge_recon_loss: 26787.2896; train_gene_expr_recon_loss: 9735.1441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39107.2698; train_optim_loss: 39107.2698; val_kl_reg_loss: 2592.8422; val_edge_recon_loss: 25724.8972; val_gene_expr_recon_loss: 9747.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38064.9460; val_optim_loss: 38064.9460
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 2588.6705; train_edge_recon_loss: 26783.2348; train_gene_expr_recon_loss: 9720.5291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39092.4343; train_optim_loss: 39092.4343; val_kl_reg_loss: 2589.8745; val_edge_recon_loss: 25730.4035; val_gene_expr_recon_loss: 9718.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38038.4424; val_optim_loss: 38038.4424
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 2593.1275; train_edge_recon_loss: 26769.9584; train_gene_expr_recon_loss: 9705.6724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39068.7584; train_optim_loss: 39068.7584; val_kl_reg_loss: 2600.5615; val_edge_recon_loss: 25716.0484; val_gene_expr_recon_loss: 9731.6390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38048.2490; val_optim_loss: 38048.2490
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 2597.4579; train_edge_recon_loss: 26762.5406; train_gene_expr_recon_loss: 9695.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39055.1899; train_optim_loss: 39055.1899; val_kl_reg_loss: 2607.6845; val_edge_recon_loss: 25715.8754; val_gene_expr_recon_loss: 9736.5014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38060.0613; val_optim_loss: 38060.0613
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 2600.3360; train_edge_recon_loss: 26760.1625; train_gene_expr_recon_loss: 9681.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39042.0369; train_optim_loss: 39042.0369; val_kl_reg_loss: 2626.9524; val_edge_recon_loss: 25711.9942; val_gene_expr_recon_loss: 9726.5166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38065.4635; val_optim_loss: 38065.4635
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 2602.6358; train_edge_recon_loss: 26760.2443; train_gene_expr_recon_loss: 9676.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39039.0434; train_optim_loss: 39039.0434; val_kl_reg_loss: 2610.5969; val_edge_recon_loss: 25689.2735; val_gene_expr_recon_loss: 9745.1160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38044.9862; val_optim_loss: 38044.9862

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2602.7257; train_edge_recon_loss: 26733.5866; train_gene_expr_recon_loss: 9642.8005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38979.1127; train_optim_loss: 38979.1127; val_kl_reg_loss: 2600.8071; val_edge_recon_loss: 25674.9655; val_gene_expr_recon_loss: 9701.1744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37976.9468; val_optim_loss: 37976.9468
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2601.2857; train_edge_recon_loss: 26728.8360; train_gene_expr_recon_loss: 9613.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38943.1907; train_optim_loss: 38943.1907; val_kl_reg_loss: 2604.9099; val_edge_recon_loss: 25678.8232; val_gene_expr_recon_loss: 9694.5262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37978.2590; val_optim_loss: 37978.2590
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2599.3762; train_edge_recon_loss: 26738.2935; train_gene_expr_recon_loss: 9617.7897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38955.4595; train_optim_loss: 38955.4595; val_kl_reg_loss: 2606.8433; val_edge_recon_loss: 25668.1129; val_gene_expr_recon_loss: 9720.0597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37995.0159; val_optim_loss: 37995.0159
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2601.2278; train_edge_recon_loss: 26729.6415; train_gene_expr_recon_loss: 9611.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38942.5246; train_optim_loss: 38942.5246; val_kl_reg_loss: 2604.3135; val_edge_recon_loss: 25690.1811; val_gene_expr_recon_loss: 9715.7076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38010.2024; val_optim_loss: 38010.2024
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2599.0976; train_edge_recon_loss: 26739.9221; train_gene_expr_recon_loss: 9619.5615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38958.5812; train_optim_loss: 38958.5812; val_kl_reg_loss: 2601.4712; val_edge_recon_loss: 25679.7930; val_gene_expr_recon_loss: 9718.7090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37999.9734; val_optim_loss: 37999.9734

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 2601.5747; train_edge_recon_loss: 26726.2262; train_gene_expr_recon_loss: 9612.0774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38939.8783; train_optim_loss: 38939.8783; val_kl_reg_loss: 2600.2344; val_edge_recon_loss: 25686.8154; val_gene_expr_recon_loss: 9700.4915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37987.5412; val_optim_loss: 37987.5412
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2600.3421; train_edge_recon_loss: 26730.9568; train_gene_expr_recon_loss: 9607.6714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38938.9703; train_optim_loss: 38938.9703; val_kl_reg_loss: 2604.0666; val_edge_recon_loss: 25671.4573; val_gene_expr_recon_loss: 9731.8090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38007.3329; val_optim_loss: 38007.3329
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 2601.7775; train_edge_recon_loss: 26722.9668; train_gene_expr_recon_loss: 9609.9071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38934.6515; train_optim_loss: 38934.6515; val_kl_reg_loss: 2603.7161; val_edge_recon_loss: 25681.0597; val_gene_expr_recon_loss: 9722.9335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38007.7094; val_optim_loss: 38007.7094
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 2600.7747; train_edge_recon_loss: 26728.4436; train_gene_expr_recon_loss: 9602.9580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38932.1763; train_optim_loss: 38932.1763; val_kl_reg_loss: 2601.4468; val_edge_recon_loss: 25659.8910; val_gene_expr_recon_loss: 9712.3407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37973.6787; val_optim_loss: 37973.6787
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2600.1167; train_edge_recon_loss: 26732.6517; train_gene_expr_recon_loss: 9601.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38934.1094; train_optim_loss: 38934.1094; val_kl_reg_loss: 2600.1051; val_edge_recon_loss: 25674.2381; val_gene_expr_recon_loss: 9711.6642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37986.0072; val_optim_loss: 37986.0072
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 2601.4342; train_edge_recon_loss: 26722.6135; train_gene_expr_recon_loss: 9605.7848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38929.8325; train_optim_loss: 38929.8325; val_kl_reg_loss: 2601.7938; val_edge_recon_loss: 25704.5829; val_gene_expr_recon_loss: 9709.9527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38016.3296; val_optim_loss: 38016.3296
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 2601.5786; train_edge_recon_loss: 26722.8190; train_gene_expr_recon_loss: 9604.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38929.1905; train_optim_loss: 38929.1905; val_kl_reg_loss: 2604.1046; val_edge_recon_loss: 25686.8267; val_gene_expr_recon_loss: 9727.5222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38018.4536; val_optim_loss: 38018.4536
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2602.2140; train_edge_recon_loss: 26716.6406; train_gene_expr_recon_loss: 9601.5501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38920.4047; train_optim_loss: 38920.4047; val_kl_reg_loss: 2603.8817; val_edge_recon_loss: 25673.4974; val_gene_expr_recon_loss: 9720.6327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37998.0117; val_optim_loss: 37998.0117

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 2602.3591; train_edge_recon_loss: 26724.5812; train_gene_expr_recon_loss: 9602.9338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38929.8742; train_optim_loss: 38929.8742; val_kl_reg_loss: 2604.2843; val_edge_recon_loss: 25667.8144; val_gene_expr_recon_loss: 9695.7471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37967.8457; val_optim_loss: 37967.8457
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2602.1346; train_edge_recon_loss: 26718.8955; train_gene_expr_recon_loss: 9605.9802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38927.0103; train_optim_loss: 38927.0103; val_kl_reg_loss: 2604.9301; val_edge_recon_loss: 25685.2632; val_gene_expr_recon_loss: 9714.8240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38005.0171; val_optim_loss: 38005.0171
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2601.6540; train_edge_recon_loss: 26730.4077; train_gene_expr_recon_loss: 9597.7208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38929.7827; train_optim_loss: 38929.7827; val_kl_reg_loss: 2603.6984; val_edge_recon_loss: 25676.5116; val_gene_expr_recon_loss: 9739.3062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38019.5161; val_optim_loss: 38019.5161
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 2601.3530; train_edge_recon_loss: 26725.4617; train_gene_expr_recon_loss: 9603.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38930.5053; train_optim_loss: 38930.5053; val_kl_reg_loss: 2603.5490; val_edge_recon_loss: 25684.0152; val_gene_expr_recon_loss: 9715.4137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38002.9780; val_optim_loss: 38002.9780
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2600.7908; train_edge_recon_loss: 26728.2775; train_gene_expr_recon_loss: 9606.2112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38935.2795; train_optim_loss: 38935.2795; val_kl_reg_loss: 2603.6930; val_edge_recon_loss: 25668.9595; val_gene_expr_recon_loss: 9704.8551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37977.5079; val_optim_loss: 37977.5079

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 2601.1310; train_edge_recon_loss: 26727.4392; train_gene_expr_recon_loss: 9603.6115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38932.1818; train_optim_loss: 38932.1818; val_kl_reg_loss: 2603.2929; val_edge_recon_loss: 25681.1112; val_gene_expr_recon_loss: 9726.5056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38010.9100; val_optim_loss: 38010.9100
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 2601.1928; train_edge_recon_loss: 26721.4358; train_gene_expr_recon_loss: 9601.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38923.6750; train_optim_loss: 38923.6750; val_kl_reg_loss: 2603.4710; val_edge_recon_loss: 25693.0481; val_gene_expr_recon_loss: 9711.2719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38007.7910; val_optim_loss: 38007.7910
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 2600.7860; train_edge_recon_loss: 26728.1753; train_gene_expr_recon_loss: 9601.1637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38930.1251; train_optim_loss: 38930.1251; val_kl_reg_loss: 2603.5071; val_edge_recon_loss: 25672.6362; val_gene_expr_recon_loss: 9729.7300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38005.8731; val_optim_loss: 38005.8731
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 2600.9885; train_edge_recon_loss: 26729.3001; train_gene_expr_recon_loss: 9614.8084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38945.0970; train_optim_loss: 38945.0970; val_kl_reg_loss: 2603.5517; val_edge_recon_loss: 25655.9531; val_gene_expr_recon_loss: 9716.7746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37976.2794; val_optim_loss: 37976.2794

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 250 min 22 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9967
Val best accuracy score: 0.9853
Val best F1 score: 0.9854
Val gene expr MSE score: 0.6477

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
