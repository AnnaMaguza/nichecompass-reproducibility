None
Run timestamp: 08082023_194704_100.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9789; val_best_acc_score: 0.9387; val_best_f1_score: 0.9402; train_kl_reg_loss: 16903.6175; train_edge_recon_loss: 26429286.3856; train_gene_expr_recon_loss: 1314184.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27760374.2475; train_optim_loss: 27760374.2475; val_kl_reg_loss: 14074.9064; val_edge_recon_loss: 26232453.4774; val_gene_expr_recon_loss: 1192844.0383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27439372.3624; val_optim_loss: 27439372.3624
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9878; val_auprc_score: 0.9852; val_best_acc_score: 0.9524; val_best_f1_score: 0.9532; train_kl_reg_loss: 13836.6520; train_edge_recon_loss: 25984273.6990; train_gene_expr_recon_loss: 1157232.9497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27155343.2925; train_optim_loss: 27155343.2925; val_kl_reg_loss: 13830.9188; val_edge_recon_loss: 25989300.8153; val_gene_expr_recon_loss: 1129549.9035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27132681.6794; val_optim_loss: 27132681.6794
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9574; val_best_f1_score: 0.9582; train_kl_reg_loss: 13765.4734; train_edge_recon_loss: 25863558.7867; train_gene_expr_recon_loss: 1121332.6430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26998656.8898; train_optim_loss: 26998656.8898; val_kl_reg_loss: 13753.7842; val_edge_recon_loss: 25928033.0453; val_gene_expr_recon_loss: 1109004.5296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27050791.3519; val_optim_loss: 27050791.3519
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9891; val_auprc_score: 0.9864; val_best_acc_score: 0.9572; val_best_f1_score: 0.9581; train_kl_reg_loss: 13917.8297; train_edge_recon_loss: 25826466.4965; train_gene_expr_recon_loss: 1105492.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26945876.5182; train_optim_loss: 26945876.5182; val_kl_reg_loss: 14486.1257; val_edge_recon_loss: 25917938.1045; val_gene_expr_recon_loss: 1098950.2489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27031374.4390; val_optim_loss: 27031374.4390
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9897; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 14077.3632; train_edge_recon_loss: 25795163.0551; train_gene_expr_recon_loss: 1096663.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26905904.0915; train_optim_loss: 26905904.0915; val_kl_reg_loss: 14167.0962; val_edge_recon_loss: 25858931.0244; val_gene_expr_recon_loss: 1092034.5756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26965132.7108; val_optim_loss: 26965132.7108
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9924; val_auprc_score: 0.9904; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 14020.7258; train_edge_recon_loss: 25764628.8495; train_gene_expr_recon_loss: 1091493.3083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26870142.9061; train_optim_loss: 26870142.9061; val_kl_reg_loss: 14389.4124; val_edge_recon_loss: 25864981.5052; val_gene_expr_recon_loss: 1088029.0189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26967399.9512; val_optim_loss: 26967399.9512
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9683; val_best_f1_score: 0.9688; train_kl_reg_loss: 14097.1741; train_edge_recon_loss: 25735384.6137; train_gene_expr_recon_loss: 1088006.2797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26837488.0760; train_optim_loss: 26837488.0760; val_kl_reg_loss: 14212.2683; val_edge_recon_loss: 25829592.7178; val_gene_expr_recon_loss: 1083350.2537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26927155.2822; val_optim_loss: 26927155.2822
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 14162.0931; train_edge_recon_loss: 25721413.4391; train_gene_expr_recon_loss: 1085363.1951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26820938.7517; train_optim_loss: 26820938.7517; val_kl_reg_loss: 13961.6500; val_edge_recon_loss: 25809068.6132; val_gene_expr_recon_loss: 1082736.9053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26905767.2125; val_optim_loss: 26905767.2125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9919; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 14180.7917; train_edge_recon_loss: 25701280.1536; train_gene_expr_recon_loss: 1083412.9724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26798873.9410; train_optim_loss: 26798873.9410; val_kl_reg_loss: 14232.0404; val_edge_recon_loss: 25813039.8885; val_gene_expr_recon_loss: 1079951.1137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26907223.0383; val_optim_loss: 26907223.0383
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 14071.7950; train_edge_recon_loss: 25693999.0946; train_gene_expr_recon_loss: 1081702.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26789772.9325; train_optim_loss: 26789772.9325; val_kl_reg_loss: 13851.5435; val_edge_recon_loss: 25785372.7735; val_gene_expr_recon_loss: 1077710.1235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26876934.4530; val_optim_loss: 26876934.4530
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 13923.7919; train_edge_recon_loss: 25687482.1839; train_gene_expr_recon_loss: 1081103.6867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26782509.6121; train_optim_loss: 26782509.6121; val_kl_reg_loss: 13764.2339; val_edge_recon_loss: 25753305.1359; val_gene_expr_recon_loss: 1079327.0638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26846396.4321; val_optim_loss: 26846396.4321
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 13954.0670; train_edge_recon_loss: 25668740.4903; train_gene_expr_recon_loss: 1080409.0451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26763103.6206; train_optim_loss: 26763103.6206; val_kl_reg_loss: 13814.4523; val_edge_recon_loss: 25753288.1951; val_gene_expr_recon_loss: 1074968.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26842071.5470; val_optim_loss: 26842071.5470
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 13938.8892; train_edge_recon_loss: 25655191.8270; train_gene_expr_recon_loss: 1078815.6159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26747946.3413; train_optim_loss: 26747946.3413; val_kl_reg_loss: 13444.2879; val_edge_recon_loss: 25738077.4286; val_gene_expr_recon_loss: 1076856.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26828377.9303; val_optim_loss: 26828377.9303
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 13891.8296; train_edge_recon_loss: 25650877.2071; train_gene_expr_recon_loss: 1077728.8648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26742497.8976; train_optim_loss: 26742497.8976; val_kl_reg_loss: 14025.1681; val_edge_recon_loss: 25721657.7143; val_gene_expr_recon_loss: 1075470.7831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26811153.5819; val_optim_loss: 26811153.5819
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 13808.2665; train_edge_recon_loss: 25654565.3018; train_gene_expr_recon_loss: 1077663.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26746037.1179; train_optim_loss: 26746037.1179; val_kl_reg_loss: 13877.8092; val_edge_recon_loss: 25717480.4390; val_gene_expr_recon_loss: 1074293.9510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26805652.2439; val_optim_loss: 26805652.2439
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 13827.8885; train_edge_recon_loss: 25637689.2870; train_gene_expr_recon_loss: 1076673.5112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26728190.6711; train_optim_loss: 26728190.6711; val_kl_reg_loss: 13654.7127; val_edge_recon_loss: 25717942.6690; val_gene_expr_recon_loss: 1075013.7683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26806611.1429; val_optim_loss: 26806611.1429
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 13832.9055; train_edge_recon_loss: 25628626.0683; train_gene_expr_recon_loss: 1076688.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26719147.2917; train_optim_loss: 26719147.2917; val_kl_reg_loss: 13620.9724; val_edge_recon_loss: 25705405.7700; val_gene_expr_recon_loss: 1074718.5181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26793745.1986; val_optim_loss: 26793745.1986
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 13766.2656; train_edge_recon_loss: 25623811.2366; train_gene_expr_recon_loss: 1075956.8273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26713534.3452; train_optim_loss: 26713534.3452; val_kl_reg_loss: 13861.6044; val_edge_recon_loss: 25692991.1638; val_gene_expr_recon_loss: 1073280.7424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26780133.5610; val_optim_loss: 26780133.5610
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9756; val_best_f1_score: 0.9760; train_kl_reg_loss: 13750.0028; train_edge_recon_loss: 25620144.1133; train_gene_expr_recon_loss: 1074938.2182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26708832.3072; train_optim_loss: 26708832.3072; val_kl_reg_loss: 13793.3423; val_edge_recon_loss: 25687733.2753; val_gene_expr_recon_loss: 1072789.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26774316.3693; val_optim_loss: 26774316.3693
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 13720.2871; train_edge_recon_loss: 25612461.3879; train_gene_expr_recon_loss: 1075304.7859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26701486.4670; train_optim_loss: 26701486.4670; val_kl_reg_loss: 13819.0986; val_edge_recon_loss: 25659202.1045; val_gene_expr_recon_loss: 1071532.4305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26744553.6725; val_optim_loss: 26744553.6725
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 13741.7255; train_edge_recon_loss: 25600013.1932; train_gene_expr_recon_loss: 1074700.5785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26688455.4802; train_optim_loss: 26688455.4802; val_kl_reg_loss: 13654.2959; val_edge_recon_loss: 25665788.1603; val_gene_expr_recon_loss: 1071551.0168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26750993.4564; val_optim_loss: 26750993.4564
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 13707.5677; train_edge_recon_loss: 25599642.6796; train_gene_expr_recon_loss: 1074589.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26687939.7626; train_optim_loss: 26687939.7626; val_kl_reg_loss: 13590.0746; val_edge_recon_loss: 25680506.3136; val_gene_expr_recon_loss: 1071988.8323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26766085.2404; val_optim_loss: 26766085.2404
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 13762.5955; train_edge_recon_loss: 25591889.3126; train_gene_expr_recon_loss: 1073085.4401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26678737.3569; train_optim_loss: 26678737.3569; val_kl_reg_loss: 13615.4729; val_edge_recon_loss: 25673208.5087; val_gene_expr_recon_loss: 1071044.5368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26757868.4878; val_optim_loss: 26757868.4878
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 13729.6354; train_edge_recon_loss: 25593657.8798; train_gene_expr_recon_loss: 1073153.6374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26680541.1559; train_optim_loss: 26680541.1559; val_kl_reg_loss: 13545.8195; val_edge_recon_loss: 25650549.8467; val_gene_expr_recon_loss: 1072019.6026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26736115.2404; val_optim_loss: 26736115.2404
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 13689.6297; train_edge_recon_loss: 25590581.6889; train_gene_expr_recon_loss: 1073048.4720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26677319.8123; train_optim_loss: 26677319.8123; val_kl_reg_loss: 13719.9479; val_edge_recon_loss: 25671732.5505; val_gene_expr_recon_loss: 1071816.6503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26757269.1707; val_optim_loss: 26757269.1707
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 13698.6477; train_edge_recon_loss: 25587248.4267; train_gene_expr_recon_loss: 1072217.8858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26673164.9744; train_optim_loss: 26673164.9744; val_kl_reg_loss: 13649.1879; val_edge_recon_loss: 25656105.4495; val_gene_expr_recon_loss: 1070150.7337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26739905.3519; val_optim_loss: 26739905.3519
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 13752.8188; train_edge_recon_loss: 25583082.3716; train_gene_expr_recon_loss: 1072161.0902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26668996.2971; train_optim_loss: 26668996.2971; val_kl_reg_loss: 13922.3113; val_edge_recon_loss: 25631356.8850; val_gene_expr_recon_loss: 1068840.9780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26714120.1882; val_optim_loss: 26714120.1882
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 13756.6821; train_edge_recon_loss: 25576493.3662; train_gene_expr_recon_loss: 1072066.1783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26662316.2118; train_optim_loss: 26662316.2118; val_kl_reg_loss: 13431.9947; val_edge_recon_loss: 25643630.6481; val_gene_expr_recon_loss: 1071450.3280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26728512.9826; val_optim_loss: 26728512.9826
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9951; val_auprc_score: 0.9932; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 13720.0310; train_edge_recon_loss: 25581804.2933; train_gene_expr_recon_loss: 1071556.5410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26667080.8627; train_optim_loss: 26667080.8627; val_kl_reg_loss: 13688.8563; val_edge_recon_loss: 25638555.2822; val_gene_expr_recon_loss: 1068211.6145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26720455.6585; val_optim_loss: 26720455.6585
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9931; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 13742.4059; train_edge_recon_loss: 25575392.2630; train_gene_expr_recon_loss: 1071052.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26660187.0023; train_optim_loss: 26660187.0023; val_kl_reg_loss: 13593.6935; val_edge_recon_loss: 25649417.2753; val_gene_expr_recon_loss: 1067589.7550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26730600.7456; val_optim_loss: 26730600.7456
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 13690.5286; train_edge_recon_loss: 25564267.2692; train_gene_expr_recon_loss: 1071256.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26649214.0551; train_optim_loss: 26649214.0551; val_kl_reg_loss: 13637.7832; val_edge_recon_loss: 25656529.0523; val_gene_expr_recon_loss: 1069851.8759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26740018.6829; val_optim_loss: 26740018.6829

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 13942.5695; train_edge_recon_loss: 25548520.3538; train_gene_expr_recon_loss: 1064092.3662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26626555.2832; train_optim_loss: 26626555.2832; val_kl_reg_loss: 13893.4195; val_edge_recon_loss: 25600250.0697; val_gene_expr_recon_loss: 1063077.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26677220.7526; val_optim_loss: 26677220.7526
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 14038.3200; train_edge_recon_loss: 25548174.1032; train_gene_expr_recon_loss: 1063752.3747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26625964.7983; train_optim_loss: 26625964.7983; val_kl_reg_loss: 13866.5134; val_edge_recon_loss: 25592056.3554; val_gene_expr_recon_loss: 1062389.4715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26668312.3693; val_optim_loss: 26668312.3693
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13939.8296; train_edge_recon_loss: 25550341.2537; train_gene_expr_recon_loss: 1063556.1573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26627837.2607; train_optim_loss: 26627837.2607; val_kl_reg_loss: 13881.9499; val_edge_recon_loss: 25586643.1150; val_gene_expr_recon_loss: 1062227.2032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26662752.2718; val_optim_loss: 26662752.2718
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 13889.8023; train_edge_recon_loss: 25544631.7936; train_gene_expr_recon_loss: 1063640.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26622161.9953; train_optim_loss: 26622161.9953; val_kl_reg_loss: 13670.3084; val_edge_recon_loss: 25589816.7317; val_gene_expr_recon_loss: 1062165.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26665653.0035; val_optim_loss: 26665653.0035
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 13846.7535; train_edge_recon_loss: 25544555.3871; train_gene_expr_recon_loss: 1063152.2018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26621554.3406; train_optim_loss: 26621554.3406; val_kl_reg_loss: 13709.3139; val_edge_recon_loss: 25572445.6655; val_gene_expr_recon_loss: 1061783.0381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26647938.0000; val_optim_loss: 26647938.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 13829.6774; train_edge_recon_loss: 25541035.6920; train_gene_expr_recon_loss: 1063028.3727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26617893.7525; train_optim_loss: 26617893.7525; val_kl_reg_loss: 13840.1962; val_edge_recon_loss: 25586186.1882; val_gene_expr_recon_loss: 1061176.8031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26661203.1568; val_optim_loss: 26661203.1568
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9956; val_auprc_score: 0.9938; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 13827.6650; train_edge_recon_loss: 25538463.7448; train_gene_expr_recon_loss: 1063216.3531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26615507.7432; train_optim_loss: 26615507.7432; val_kl_reg_loss: 13743.5403; val_edge_recon_loss: 25576834.2160; val_gene_expr_recon_loss: 1061490.8850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26652068.6272; val_optim_loss: 26652068.6272
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 13803.9388; train_edge_recon_loss: 25536784.2056; train_gene_expr_recon_loss: 1062852.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26613440.7184; train_optim_loss: 26613440.7184; val_kl_reg_loss: 13819.6309; val_edge_recon_loss: 25587869.5610; val_gene_expr_recon_loss: 1063108.6433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26664797.8328; val_optim_loss: 26664797.8328
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 13814.3288; train_edge_recon_loss: 25544775.2832; train_gene_expr_recon_loss: 1062993.4991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26621583.1001; train_optim_loss: 26621583.1001; val_kl_reg_loss: 13679.2905; val_edge_recon_loss: 25603894.1463; val_gene_expr_recon_loss: 1061667.2883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26679240.7247; val_optim_loss: 26679240.7247

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13757.6367; train_edge_recon_loss: 25540364.4151; train_gene_expr_recon_loss: 1061862.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26615984.1365; train_optim_loss: 26615984.1365; val_kl_reg_loss: 13653.7492; val_edge_recon_loss: 25581665.4983; val_gene_expr_recon_loss: 1061051.2404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26656370.5505; val_optim_loss: 26656370.5505
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 13764.1770; train_edge_recon_loss: 25535746.2537; train_gene_expr_recon_loss: 1062192.3036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26611702.7556; train_optim_loss: 26611702.7556; val_kl_reg_loss: 13638.0905; val_edge_recon_loss: 25587033.7700; val_gene_expr_recon_loss: 1061372.6494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26662044.4878; val_optim_loss: 26662044.4878
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13763.7142; train_edge_recon_loss: 25535377.4042; train_gene_expr_recon_loss: 1062040.5490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26611181.6555; train_optim_loss: 26611181.6555; val_kl_reg_loss: 13654.0790; val_edge_recon_loss: 25576278.2230; val_gene_expr_recon_loss: 1060582.6651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26650514.8990; val_optim_loss: 26650514.8990
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9955; val_auprc_score: 0.9937; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 13759.6511; train_edge_recon_loss: 25537279.2320; train_gene_expr_recon_loss: 1062323.1587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26613362.0303; train_optim_loss: 26613362.0303; val_kl_reg_loss: 13664.3266; val_edge_recon_loss: 25584129.0592; val_gene_expr_recon_loss: 1061107.4022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26658900.8362; val_optim_loss: 26658900.8362

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 708 min 4 sec.
Using best model state, which was in epoch 36.
