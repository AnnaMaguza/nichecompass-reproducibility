None
Run timestamp: 16072023_035049_2000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9336; val_auprc_score: 0.9114; val_best_acc_score: 0.8739; val_best_f1_score: 0.8820; train_kl_reg_loss: 19308.6481; train_edge_recon_loss: 2725280.7787; train_gene_expr_recon_loss: 792549.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3537138.4335; train_optim_loss: 3537138.4335; val_kl_reg_loss: 17448.5084; val_edge_recon_loss: 2701727.2434; val_gene_expr_recon_loss: 722014.1924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3441189.9243; val_optim_loss: 3441189.9243
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9501; val_auprc_score: 0.9366; val_best_acc_score: 0.8904; val_best_f1_score: 0.8964; train_kl_reg_loss: 16611.5453; train_edge_recon_loss: 2644618.5812; train_gene_expr_recon_loss: 703971.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3365201.2860; train_optim_loss: 3365201.2860; val_kl_reg_loss: 14947.7400; val_edge_recon_loss: 2687728.3618; val_gene_expr_recon_loss: 688674.4309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3391350.5428; val_optim_loss: 3391350.5428
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9594; val_auprc_score: 0.9491; val_best_acc_score: 0.9021; val_best_f1_score: 0.9062; train_kl_reg_loss: 15029.3494; train_edge_recon_loss: 2634140.1566; train_gene_expr_recon_loss: 675407.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3324576.5346; train_optim_loss: 3324576.5346; val_kl_reg_loss: 14076.5158; val_edge_recon_loss: 2682196.2895; val_gene_expr_recon_loss: 663191.9984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3359464.8092; val_optim_loss: 3359464.8092
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9647; val_auprc_score: 0.9559; val_best_acc_score: 0.9098; val_best_f1_score: 0.9133; train_kl_reg_loss: 14550.8708; train_edge_recon_loss: 2623672.0449; train_gene_expr_recon_loss: 656444.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3294667.5515; train_optim_loss: 3294667.5515; val_kl_reg_loss: 14182.3641; val_edge_recon_loss: 2672069.0658; val_gene_expr_recon_loss: 648008.7525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3334260.1908; val_optim_loss: 3334260.1908
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9644; val_auprc_score: 0.9542; val_best_acc_score: 0.9121; val_best_f1_score: 0.9154; train_kl_reg_loss: 14319.3396; train_edge_recon_loss: 2619445.1559; train_gene_expr_recon_loss: 644329.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3278093.8680; train_optim_loss: 3278093.8680; val_kl_reg_loss: 14058.9333; val_edge_recon_loss: 2674447.6316; val_gene_expr_recon_loss: 637496.5345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3326003.0954; val_optim_loss: 3326003.0954
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9685; val_auprc_score: 0.9600; val_best_acc_score: 0.9176; val_best_f1_score: 0.9199; train_kl_reg_loss: 14084.1454; train_edge_recon_loss: 2616492.4695; train_gene_expr_recon_loss: 635184.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3265761.1033; train_optim_loss: 3265761.1033; val_kl_reg_loss: 13596.6740; val_edge_recon_loss: 2664517.9441; val_gene_expr_recon_loss: 631011.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3309125.8816; val_optim_loss: 3309125.8816
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9697; val_auprc_score: 0.9623; val_best_acc_score: 0.9186; val_best_f1_score: 0.9215; train_kl_reg_loss: 13908.8948; train_edge_recon_loss: 2615057.9695; train_gene_expr_recon_loss: 629330.8445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3258297.7154; train_optim_loss: 3258297.7154; val_kl_reg_loss: 13294.2357; val_edge_recon_loss: 2666156.3816; val_gene_expr_recon_loss: 627782.2401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3307232.8586; val_optim_loss: 3307232.8586
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9697; val_auprc_score: 0.9614; val_best_acc_score: 0.9195; val_best_f1_score: 0.9220; train_kl_reg_loss: 13725.3795; train_edge_recon_loss: 2612024.4338; train_gene_expr_recon_loss: 624452.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250201.8379; train_optim_loss: 3250201.8379; val_kl_reg_loss: 12987.8521; val_edge_recon_loss: 2666627.1546; val_gene_expr_recon_loss: 622478.8495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3302093.8717; val_optim_loss: 3302093.8717
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9709; val_auprc_score: 0.9624; val_best_acc_score: 0.9215; val_best_f1_score: 0.9243; train_kl_reg_loss: 13569.2118; train_edge_recon_loss: 2611396.8283; train_gene_expr_recon_loss: 621196.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3246162.8290; train_optim_loss: 3246162.8290; val_kl_reg_loss: 13103.6823; val_edge_recon_loss: 2663047.6743; val_gene_expr_recon_loss: 620254.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3296405.7467; val_optim_loss: 3296405.7467
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9707; val_auprc_score: 0.9622; val_best_acc_score: 0.9219; val_best_f1_score: 0.9247; train_kl_reg_loss: 13414.7002; train_edge_recon_loss: 2610547.7393; train_gene_expr_recon_loss: 618051.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242013.5581; train_optim_loss: 3242013.5581; val_kl_reg_loss: 13245.7954; val_edge_recon_loss: 2660261.1612; val_gene_expr_recon_loss: 616313.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3289820.7928; val_optim_loss: 3289820.7928
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9727; val_auprc_score: 0.9651; val_best_acc_score: 0.9252; val_best_f1_score: 0.9276; train_kl_reg_loss: 13301.1169; train_edge_recon_loss: 2608931.8901; train_gene_expr_recon_loss: 615698.0407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237931.0460; train_optim_loss: 3237931.0460; val_kl_reg_loss: 12794.5993; val_edge_recon_loss: 2663854.1086; val_gene_expr_recon_loss: 615090.3331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3291739.0329; val_optim_loss: 3291739.0329
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9738; val_auprc_score: 0.9673; val_best_acc_score: 0.9258; val_best_f1_score: 0.9280; train_kl_reg_loss: 13256.2142; train_edge_recon_loss: 2606953.1831; train_gene_expr_recon_loss: 614267.1586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234476.5632; train_optim_loss: 3234476.5632; val_kl_reg_loss: 12751.8662; val_edge_recon_loss: 2658620.6743; val_gene_expr_recon_loss: 613709.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285081.7632; val_optim_loss: 3285081.7632
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9731; val_auprc_score: 0.9655; val_best_acc_score: 0.9255; val_best_f1_score: 0.9280; train_kl_reg_loss: 13167.3271; train_edge_recon_loss: 2605146.6732; train_gene_expr_recon_loss: 612349.5441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230663.5471; train_optim_loss: 3230663.5471; val_kl_reg_loss: 12798.4743; val_edge_recon_loss: 2661240.2697; val_gene_expr_recon_loss: 610956.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284994.7928; val_optim_loss: 3284994.7928
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9740; val_auprc_score: 0.9671; val_best_acc_score: 0.9264; val_best_f1_score: 0.9287; train_kl_reg_loss: 13118.0403; train_edge_recon_loss: 2606737.6301; train_gene_expr_recon_loss: 611061.8620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230917.5265; train_optim_loss: 3230917.5265; val_kl_reg_loss: 12826.4437; val_edge_recon_loss: 2658702.5493; val_gene_expr_recon_loss: 612938.3898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284467.3816; val_optim_loss: 3284467.3816
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9749; val_auprc_score: 0.9678; val_best_acc_score: 0.9288; val_best_f1_score: 0.9312; train_kl_reg_loss: 13058.2318; train_edge_recon_loss: 2603300.0746; train_gene_expr_recon_loss: 610085.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226443.5923; train_optim_loss: 3226443.5923; val_kl_reg_loss: 12486.2341; val_edge_recon_loss: 2651289.4803; val_gene_expr_recon_loss: 610151.1168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273926.8421; val_optim_loss: 3273926.8421
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9736; val_auprc_score: 0.9661; val_best_acc_score: 0.9268; val_best_f1_score: 0.9290; train_kl_reg_loss: 12956.2936; train_edge_recon_loss: 2604960.9662; train_gene_expr_recon_loss: 609307.2208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227224.4835; train_optim_loss: 3227224.4835; val_kl_reg_loss: 12540.1652; val_edge_recon_loss: 2659167.3914; val_gene_expr_recon_loss: 608009.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279716.7829; val_optim_loss: 3279716.7829
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9750; val_auprc_score: 0.9683; val_best_acc_score: 0.9278; val_best_f1_score: 0.9300; train_kl_reg_loss: 12904.1210; train_edge_recon_loss: 2603986.4743; train_gene_expr_recon_loss: 608443.3028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225333.9037; train_optim_loss: 3225333.9037; val_kl_reg_loss: 12518.8448; val_edge_recon_loss: 2657365.4474; val_gene_expr_recon_loss: 609294.4260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279178.7039; val_optim_loss: 3279178.7039
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9749; val_auprc_score: 0.9676; val_best_acc_score: 0.9290; val_best_f1_score: 0.9311; train_kl_reg_loss: 12912.3328; train_edge_recon_loss: 2601966.4382; train_gene_expr_recon_loss: 607891.0317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222769.7945; train_optim_loss: 3222769.7945; val_kl_reg_loss: 12533.8445; val_edge_recon_loss: 2656328.2500; val_gene_expr_recon_loss: 608523.3840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277385.4836; val_optim_loss: 3277385.4836
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9741; val_auprc_score: 0.9666; val_best_acc_score: 0.9287; val_best_f1_score: 0.9305; train_kl_reg_loss: 12840.0662; train_edge_recon_loss: 2600763.0926; train_gene_expr_recon_loss: 606761.4117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220364.5643; train_optim_loss: 3220364.5643; val_kl_reg_loss: 12445.9410; val_edge_recon_loss: 2659290.7204; val_gene_expr_recon_loss: 607645.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279382.2138; val_optim_loss: 3279382.2138

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9756; val_auprc_score: 0.9689; val_best_acc_score: 0.9309; val_best_f1_score: 0.9330; train_kl_reg_loss: 12863.7739; train_edge_recon_loss: 2600482.6051; train_gene_expr_recon_loss: 602009.1035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215355.4813; train_optim_loss: 3215355.4813; val_kl_reg_loss: 12662.9257; val_edge_recon_loss: 2651254.8487; val_gene_expr_recon_loss: 604347.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268264.8322; val_optim_loss: 3268264.8322
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9757; val_auprc_score: 0.9691; val_best_acc_score: 0.9304; val_best_f1_score: 0.9327; train_kl_reg_loss: 12977.1052; train_edge_recon_loss: 2600731.7801; train_gene_expr_recon_loss: 601548.9145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215257.8033; train_optim_loss: 3215257.8033; val_kl_reg_loss: 12637.2449; val_edge_recon_loss: 2653047.2467; val_gene_expr_recon_loss: 601815.3873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267499.8783; val_optim_loss: 3267499.8783
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9752; val_auprc_score: 0.9684; val_best_acc_score: 0.9301; val_best_f1_score: 0.9325; train_kl_reg_loss: 12992.4800; train_edge_recon_loss: 2598548.2923; train_gene_expr_recon_loss: 601074.9190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212615.6886; train_optim_loss: 3212615.6886; val_kl_reg_loss: 12730.0761; val_edge_recon_loss: 2654200.3388; val_gene_expr_recon_loss: 603599.7508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270530.1711; val_optim_loss: 3270530.1711
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9753; val_auprc_score: 0.9684; val_best_acc_score: 0.9289; val_best_f1_score: 0.9315; train_kl_reg_loss: 12983.2516; train_edge_recon_loss: 2598542.8989; train_gene_expr_recon_loss: 600960.5090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212486.6566; train_optim_loss: 3212486.6566; val_kl_reg_loss: 12747.8262; val_edge_recon_loss: 2658242.5724; val_gene_expr_recon_loss: 603970.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274961.1118; val_optim_loss: 3274961.1118
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9751; val_auprc_score: 0.9677; val_best_acc_score: 0.9304; val_best_f1_score: 0.9328; train_kl_reg_loss: 13006.9952; train_edge_recon_loss: 2599286.9930; train_gene_expr_recon_loss: 600654.1967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212948.1853; train_optim_loss: 3212948.1853; val_kl_reg_loss: 12605.4183; val_edge_recon_loss: 2653720.0921; val_gene_expr_recon_loss: 602223.3470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268548.8553; val_optim_loss: 3268548.8553
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9759; val_auprc_score: 0.9688; val_best_acc_score: 0.9308; val_best_f1_score: 0.9328; train_kl_reg_loss: 12962.3727; train_edge_recon_loss: 2600616.1313; train_gene_expr_recon_loss: 600372.4447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213950.9540; train_optim_loss: 3213950.9540; val_kl_reg_loss: 12648.4574; val_edge_recon_loss: 2650784.0987; val_gene_expr_recon_loss: 602659.4548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266092.0164; val_optim_loss: 3266092.0164
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9760; val_auprc_score: 0.9692; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 12938.6646; train_edge_recon_loss: 2600454.2313; train_gene_expr_recon_loss: 600417.0058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213809.9040; train_optim_loss: 3213809.9040; val_kl_reg_loss: 12616.1704; val_edge_recon_loss: 2653686.4671; val_gene_expr_recon_loss: 601981.6143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268284.2434; val_optim_loss: 3268284.2434
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9756; val_auprc_score: 0.9686; val_best_acc_score: 0.9301; val_best_f1_score: 0.9325; train_kl_reg_loss: 12941.6794; train_edge_recon_loss: 2599039.5110; train_gene_expr_recon_loss: 600350.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212331.9985; train_optim_loss: 3212331.9985; val_kl_reg_loss: 12606.0264; val_edge_recon_loss: 2654021.1875; val_gene_expr_recon_loss: 602188.4975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268815.7039; val_optim_loss: 3268815.7039
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9752; val_auprc_score: 0.9683; val_best_acc_score: 0.9288; val_best_f1_score: 0.9311; train_kl_reg_loss: 12923.7902; train_edge_recon_loss: 2597754.0592; train_gene_expr_recon_loss: 600250.5618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210928.4085; train_optim_loss: 3210928.4085; val_kl_reg_loss: 12711.2657; val_edge_recon_loss: 2659880.9276; val_gene_expr_recon_loss: 602741.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275334.1842; val_optim_loss: 3275334.1842
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9757; val_auprc_score: 0.9690; val_best_acc_score: 0.9313; val_best_f1_score: 0.9337; train_kl_reg_loss: 12947.8549; train_edge_recon_loss: 2598839.3438; train_gene_expr_recon_loss: 600136.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211924.1412; train_optim_loss: 3211924.1412; val_kl_reg_loss: 12690.0962; val_edge_recon_loss: 2650865.4770; val_gene_expr_recon_loss: 600648.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264204.3487; val_optim_loss: 3264204.3487
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9317; val_best_f1_score: 0.9336; train_kl_reg_loss: 12978.7477; train_edge_recon_loss: 2598081.7680; train_gene_expr_recon_loss: 599945.7947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211006.3048; train_optim_loss: 3211006.3048; val_kl_reg_loss: 12625.1734; val_edge_recon_loss: 2653234.5230; val_gene_expr_recon_loss: 602853.9638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268713.6579; val_optim_loss: 3268713.6579
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9762; val_auprc_score: 0.9698; val_best_acc_score: 0.9310; val_best_f1_score: 0.9332; train_kl_reg_loss: 12923.7248; train_edge_recon_loss: 2598740.5246; train_gene_expr_recon_loss: 599783.4524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211447.7051; train_optim_loss: 3211447.7051; val_kl_reg_loss: 12655.3103; val_edge_recon_loss: 2651911.6809; val_gene_expr_recon_loss: 603095.6012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267662.5822; val_optim_loss: 3267662.5822
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9767; val_auprc_score: 0.9702; val_best_acc_score: 0.9316; val_best_f1_score: 0.9339; train_kl_reg_loss: 12919.3640; train_edge_recon_loss: 2598141.5059; train_gene_expr_recon_loss: 600099.3015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211160.1732; train_optim_loss: 3211160.1732; val_kl_reg_loss: 12616.0081; val_edge_recon_loss: 2652588.3750; val_gene_expr_recon_loss: 601240.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266445.0921; val_optim_loss: 3266445.0921
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9762; val_auprc_score: 0.9690; val_best_acc_score: 0.9324; val_best_f1_score: 0.9345; train_kl_reg_loss: 12914.0791; train_edge_recon_loss: 2597561.8162; train_gene_expr_recon_loss: 599767.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210243.8908; train_optim_loss: 3210243.8908; val_kl_reg_loss: 12616.0271; val_edge_recon_loss: 2649758.6283; val_gene_expr_recon_loss: 601406.5510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263781.2039; val_optim_loss: 3263781.2039
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9766; val_auprc_score: 0.9700; val_best_acc_score: 0.9317; val_best_f1_score: 0.9340; train_kl_reg_loss: 12901.0490; train_edge_recon_loss: 2598395.2040; train_gene_expr_recon_loss: 599738.1106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211034.3621; train_optim_loss: 3211034.3621; val_kl_reg_loss: 12583.6044; val_edge_recon_loss: 2649959.2566; val_gene_expr_recon_loss: 600641.2919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263184.1513; val_optim_loss: 3263184.1513
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9759; val_auprc_score: 0.9694; val_best_acc_score: 0.9308; val_best_f1_score: 0.9327; train_kl_reg_loss: 12864.1295; train_edge_recon_loss: 2597898.5309; train_gene_expr_recon_loss: 599549.5392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210312.2015; train_optim_loss: 3210312.2015; val_kl_reg_loss: 12524.5703; val_edge_recon_loss: 2656873.5625; val_gene_expr_recon_loss: 601944.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271343.0461; val_optim_loss: 3271343.0461
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9760; val_auprc_score: 0.9698; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 12870.6571; train_edge_recon_loss: 2596820.2658; train_gene_expr_recon_loss: 599621.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209312.7680; train_optim_loss: 3209312.7680; val_kl_reg_loss: 12588.9433; val_edge_recon_loss: 2653287.9079; val_gene_expr_recon_loss: 601878.3199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267755.1678; val_optim_loss: 3267755.1678
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9313; val_best_f1_score: 0.9335; train_kl_reg_loss: 12897.0953; train_edge_recon_loss: 2597763.8813; train_gene_expr_recon_loss: 599411.1053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210072.0801; train_optim_loss: 3210072.0801; val_kl_reg_loss: 12608.6756; val_edge_recon_loss: 2652413.1645; val_gene_expr_recon_loss: 601637.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266659.4737; val_optim_loss: 3266659.4737
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9768; val_auprc_score: 0.9711; val_best_acc_score: 0.9320; val_best_f1_score: 0.9342; train_kl_reg_loss: 12858.5589; train_edge_recon_loss: 2596680.6625; train_gene_expr_recon_loss: 599480.5604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209019.7816; train_optim_loss: 3209019.7816; val_kl_reg_loss: 12647.5699; val_edge_recon_loss: 2650894.9539; val_gene_expr_recon_loss: 603376.0658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266918.6086; val_optim_loss: 3266918.6086

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9755; val_auprc_score: 0.9685; val_best_acc_score: 0.9304; val_best_f1_score: 0.9325; train_kl_reg_loss: 12943.9227; train_edge_recon_loss: 2597664.3022; train_gene_expr_recon_loss: 598342.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208951.1066; train_optim_loss: 3208951.1066; val_kl_reg_loss: 12596.3993; val_edge_recon_loss: 2654707.9276; val_gene_expr_recon_loss: 602046.9498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269351.2895; val_optim_loss: 3269351.2895
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9766; val_auprc_score: 0.9704; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 12897.2634; train_edge_recon_loss: 2598804.3305; train_gene_expr_recon_loss: 598364.4244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210066.0221; train_optim_loss: 3210066.0221; val_kl_reg_loss: 12559.5790; val_edge_recon_loss: 2650919.3487; val_gene_expr_recon_loss: 600301.5419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263780.4671; val_optim_loss: 3263780.4671
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9754; val_auprc_score: 0.9684; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 12882.0335; train_edge_recon_loss: 2597595.1926; train_gene_expr_recon_loss: 598324.1729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208801.4015; train_optim_loss: 3208801.4015; val_kl_reg_loss: 12564.9552; val_edge_recon_loss: 2654522.7039; val_gene_expr_recon_loss: 600820.9309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267908.5987; val_optim_loss: 3267908.5987
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9757; val_auprc_score: 0.9687; val_best_acc_score: 0.9307; val_best_f1_score: 0.9330; train_kl_reg_loss: 12864.0930; train_edge_recon_loss: 2597809.4721; train_gene_expr_recon_loss: 598491.9195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209165.4849; train_optim_loss: 3209165.4849; val_kl_reg_loss: 12551.8817; val_edge_recon_loss: 2653449.9704; val_gene_expr_recon_loss: 599590.0238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265591.8882; val_optim_loss: 3265591.8882

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 66 min 15 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9761
Val AUPRC score: 0.9698
Val best accuracy score: 0.9319
Val best F1 score: 0.9339
Val gene expr MSE score: 1.3965

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
