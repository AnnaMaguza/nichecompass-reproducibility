None
Run timestamp: 02072023_173407_1011.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1011']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9889; val_auprc_score: 0.9860; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 4748.1110; train_edge_recon_loss: 30706.7969; train_gene_expr_recon_loss: 114472.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149927.3263; train_optim_loss: 149927.3263; val_kl_reg_loss: 4049.6578; val_edge_recon_loss: 29160.4100; val_gene_expr_recon_loss: 106007.4684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139217.5357; val_optim_loss: 139217.5357
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9912; val_auprc_score: 0.9890; val_best_acc_score: 0.9616; val_best_f1_score: 0.9622; train_kl_reg_loss: 3935.8988; train_edge_recon_loss: 29163.7091; train_gene_expr_recon_loss: 104237.4625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137337.0705; train_optim_loss: 137337.0705; val_kl_reg_loss: 3691.2363; val_edge_recon_loss: 28335.0318; val_gene_expr_recon_loss: 101972.6524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133998.9210; val_optim_loss: 133998.9210
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 3690.4652; train_edge_recon_loss: 28662.7576; train_gene_expr_recon_loss: 101294.2575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133647.4801; train_optim_loss: 133647.4801; val_kl_reg_loss: 3564.1578; val_edge_recon_loss: 27957.8288; val_gene_expr_recon_loss: 99869.5763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131391.5622; val_optim_loss: 131391.5622
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9678; val_best_f1_score: 0.9681; train_kl_reg_loss: 3571.7565; train_edge_recon_loss: 28352.2988; train_gene_expr_recon_loss: 99547.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131471.4596; train_optim_loss: 131471.4596; val_kl_reg_loss: 3419.9459; val_edge_recon_loss: 27649.5917; val_gene_expr_recon_loss: 98532.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129602.0022; val_optim_loss: 129602.0022
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9939; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 3507.0145; train_edge_recon_loss: 28142.6303; train_gene_expr_recon_loss: 98299.5283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129949.1732; train_optim_loss: 129949.1732; val_kl_reg_loss: 3489.2034; val_edge_recon_loss: 27455.5886; val_gene_expr_recon_loss: 97783.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128728.6355; val_optim_loss: 128728.6355
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 3473.7301; train_edge_recon_loss: 27973.4266; train_gene_expr_recon_loss: 97508.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128955.6773; train_optim_loss: 128955.6773; val_kl_reg_loss: 3456.8603; val_edge_recon_loss: 27258.9824; val_gene_expr_recon_loss: 97220.7325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127936.5753; val_optim_loss: 127936.5753
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 3459.7044; train_edge_recon_loss: 27855.0649; train_gene_expr_recon_loss: 96815.3502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128130.1194; train_optim_loss: 128130.1194; val_kl_reg_loss: 3432.5558; val_edge_recon_loss: 27160.5042; val_gene_expr_recon_loss: 97176.0914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127769.1512; val_optim_loss: 127769.1512
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 3457.1588; train_edge_recon_loss: 27765.7909; train_gene_expr_recon_loss: 96372.7720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127595.7220; train_optim_loss: 127595.7220; val_kl_reg_loss: 3415.2847; val_edge_recon_loss: 27067.6031; val_gene_expr_recon_loss: 96713.1754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127196.0634; val_optim_loss: 127196.0634
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 3467.2548; train_edge_recon_loss: 27688.1763; train_gene_expr_recon_loss: 95998.7020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127154.1331; train_optim_loss: 127154.1331; val_kl_reg_loss: 3435.8039; val_edge_recon_loss: 27028.8590; val_gene_expr_recon_loss: 96561.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127026.5567; val_optim_loss: 127026.5567
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 3481.4230; train_edge_recon_loss: 27625.6723; train_gene_expr_recon_loss: 95691.3198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126798.4152; train_optim_loss: 126798.4152; val_kl_reg_loss: 3449.4743; val_edge_recon_loss: 26970.7235; val_gene_expr_recon_loss: 96397.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126817.7231; val_optim_loss: 126817.7231
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 3496.1038; train_edge_recon_loss: 27578.2240; train_gene_expr_recon_loss: 95305.9899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126380.3177; train_optim_loss: 126380.3177; val_kl_reg_loss: 3554.0545; val_edge_recon_loss: 26929.4776; val_gene_expr_recon_loss: 96337.2771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126820.8096; val_optim_loss: 126820.8096
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 3516.0983; train_edge_recon_loss: 27534.5195; train_gene_expr_recon_loss: 95067.6312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126118.2492; train_optim_loss: 126118.2492; val_kl_reg_loss: 3519.8472; val_edge_recon_loss: 26941.6965; val_gene_expr_recon_loss: 96580.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127041.7910; val_optim_loss: 127041.7910
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 3534.9046; train_edge_recon_loss: 27499.2947; train_gene_expr_recon_loss: 94753.0935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125787.2931; train_optim_loss: 125787.2931; val_kl_reg_loss: 3553.2898; val_edge_recon_loss: 26890.6113; val_gene_expr_recon_loss: 96365.5831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126809.4843; val_optim_loss: 126809.4843
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 3552.6119; train_edge_recon_loss: 27472.3354; train_gene_expr_recon_loss: 94521.3773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125546.3246; train_optim_loss: 125546.3246; val_kl_reg_loss: 3542.7127; val_edge_recon_loss: 26857.2199; val_gene_expr_recon_loss: 96253.3222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126653.2547; val_optim_loss: 126653.2547
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 3575.0873; train_edge_recon_loss: 27446.9157; train_gene_expr_recon_loss: 94439.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125461.0865; train_optim_loss: 125461.0865; val_kl_reg_loss: 3533.0140; val_edge_recon_loss: 26820.6845; val_gene_expr_recon_loss: 96441.4237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126795.1226; val_optim_loss: 126795.1226
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 3594.8874; train_edge_recon_loss: 27415.3507; train_gene_expr_recon_loss: 94241.7854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125252.0236; train_optim_loss: 125252.0236; val_kl_reg_loss: 3599.2298; val_edge_recon_loss: 26826.6684; val_gene_expr_recon_loss: 96325.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126751.1801; val_optim_loss: 126751.1801
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 3613.5368; train_edge_recon_loss: 27402.3440; train_gene_expr_recon_loss: 94045.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125061.4595; train_optim_loss: 125061.4595; val_kl_reg_loss: 3552.4515; val_edge_recon_loss: 26785.8913; val_gene_expr_recon_loss: 96591.7256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126930.0686; val_optim_loss: 126930.0686
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 3632.5191; train_edge_recon_loss: 27378.1409; train_gene_expr_recon_loss: 93861.4936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124872.1536; train_optim_loss: 124872.1536; val_kl_reg_loss: 3603.6591; val_edge_recon_loss: 26844.8434; val_gene_expr_recon_loss: 96620.7956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127069.2978; val_optim_loss: 127069.2978

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 3644.5989; train_edge_recon_loss: 27317.9279; train_gene_expr_recon_loss: 93123.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124086.4563; train_optim_loss: 124086.4563; val_kl_reg_loss: 3606.0690; val_edge_recon_loss: 26791.4780; val_gene_expr_recon_loss: 96145.6593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126543.2063; val_optim_loss: 126543.2063
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 3644.5021; train_edge_recon_loss: 27307.4499; train_gene_expr_recon_loss: 93002.0400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123953.9920; train_optim_loss: 123953.9920; val_kl_reg_loss: 3609.4650; val_edge_recon_loss: 26772.3087; val_gene_expr_recon_loss: 96305.8173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126687.5913; val_optim_loss: 126687.5913
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 3641.3747; train_edge_recon_loss: 27316.7595; train_gene_expr_recon_loss: 93055.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124014.0583; train_optim_loss: 124014.0583; val_kl_reg_loss: 3625.1565; val_edge_recon_loss: 26786.1654; val_gene_expr_recon_loss: 96232.9735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126644.2951; val_optim_loss: 126644.2951
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 3643.3270; train_edge_recon_loss: 27310.2437; train_gene_expr_recon_loss: 92953.4135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123906.9843; train_optim_loss: 123906.9843; val_kl_reg_loss: 3625.9173; val_edge_recon_loss: 26774.6062; val_gene_expr_recon_loss: 96572.1556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126972.6788; val_optim_loss: 126972.6788
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 3641.2937; train_edge_recon_loss: 27316.1610; train_gene_expr_recon_loss: 92903.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123860.9457; train_optim_loss: 123860.9457; val_kl_reg_loss: 3629.1622; val_edge_recon_loss: 26783.6386; val_gene_expr_recon_loss: 96558.3095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126971.1104; val_optim_loss: 126971.1104

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 3645.9686; train_edge_recon_loss: 27307.9148; train_gene_expr_recon_loss: 92731.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123684.9763; train_optim_loss: 123684.9763; val_kl_reg_loss: 3616.7364; val_edge_recon_loss: 26773.7346; val_gene_expr_recon_loss: 96408.7017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126799.1729; val_optim_loss: 126799.1729
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 3643.1534; train_edge_recon_loss: 27316.2862; train_gene_expr_recon_loss: 92739.4829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123698.9224; train_optim_loss: 123698.9224; val_kl_reg_loss: 3619.6936; val_edge_recon_loss: 26792.0703; val_gene_expr_recon_loss: 96511.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126923.7133; val_optim_loss: 126923.7133
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 3643.4589; train_edge_recon_loss: 27305.1247; train_gene_expr_recon_loss: 92744.3622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123692.9460; train_optim_loss: 123692.9460; val_kl_reg_loss: 3614.4407; val_edge_recon_loss: 26771.4338; val_gene_expr_recon_loss: 96430.9624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126816.8368; val_optim_loss: 126816.8368
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 3643.1563; train_edge_recon_loss: 27309.0840; train_gene_expr_recon_loss: 92763.2464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123715.4866; train_optim_loss: 123715.4866; val_kl_reg_loss: 3610.0110; val_edge_recon_loss: 26788.4565; val_gene_expr_recon_loss: 96356.1358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126754.6041; val_optim_loss: 126754.6041

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 235 min 15 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9969
Val best accuracy score: 0.9776
Val best F1 score: 0.9777
Val gene expr MSE score: 0.6107

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
