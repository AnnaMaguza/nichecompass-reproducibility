None
Run timestamp: 07082023_104849_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 6039.3277; train_edge_recon_loss: 264258.2582; train_gene_expr_recon_loss: 118587.6653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 388885.2513; train_optim_loss: 388885.2513; val_kl_reg_loss: 5728.3756; val_edge_recon_loss: 260698.7516; val_gene_expr_recon_loss: 110534.1035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376961.2307; val_optim_loss: 376961.2307
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9946; val_auprc_score: 0.9936; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 5880.1918; train_edge_recon_loss: 260397.2762; train_gene_expr_recon_loss: 109916.9335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 376194.4015; train_optim_loss: 376194.4015; val_kl_reg_loss: 5859.7174; val_edge_recon_loss: 259295.0514; val_gene_expr_recon_loss: 109319.7606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374474.5293; val_optim_loss: 374474.5293
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 5850.8648; train_edge_recon_loss: 259569.9613; train_gene_expr_recon_loss: 109314.8111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374735.6372; train_optim_loss: 374735.6372; val_kl_reg_loss: 5804.3895; val_edge_recon_loss: 258641.5713; val_gene_expr_recon_loss: 109090.2379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373536.1984; val_optim_loss: 373536.1984
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 5842.2399; train_edge_recon_loss: 259047.4736; train_gene_expr_recon_loss: 109121.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374011.6115; train_optim_loss: 374011.6115; val_kl_reg_loss: 5696.3507; val_edge_recon_loss: 258164.2174; val_gene_expr_recon_loss: 109056.6886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372917.2573; val_optim_loss: 372917.2573
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5842.4750; train_edge_recon_loss: 258684.2788; train_gene_expr_recon_loss: 108977.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373504.3602; train_optim_loss: 373504.3602; val_kl_reg_loss: 5750.2380; val_edge_recon_loss: 257970.1733; val_gene_expr_recon_loss: 108834.3205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372554.7314; val_optim_loss: 372554.7314
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5846.7132; train_edge_recon_loss: 258372.6188; train_gene_expr_recon_loss: 108913.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373132.7054; train_optim_loss: 373132.7054; val_kl_reg_loss: 5820.2791; val_edge_recon_loss: 257696.9119; val_gene_expr_recon_loss: 108698.8312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372216.0218; val_optim_loss: 372216.0218
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5846.5503; train_edge_recon_loss: 258217.7988; train_gene_expr_recon_loss: 108850.5476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372914.8967; train_optim_loss: 372914.8967; val_kl_reg_loss: 5857.5108; val_edge_recon_loss: 257647.4669; val_gene_expr_recon_loss: 108775.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372280.5627; val_optim_loss: 372280.5627
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5846.0316; train_edge_recon_loss: 258114.0809; train_gene_expr_recon_loss: 108832.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372792.3977; train_optim_loss: 372792.3977; val_kl_reg_loss: 5862.4745; val_edge_recon_loss: 257230.0150; val_gene_expr_recon_loss: 108709.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371801.8984; val_optim_loss: 371801.8984
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 5850.0779; train_edge_recon_loss: 257931.1130; train_gene_expr_recon_loss: 108807.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372588.5726; train_optim_loss: 372588.5726; val_kl_reg_loss: 5783.1106; val_edge_recon_loss: 257201.8670; val_gene_expr_recon_loss: 108766.5012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371751.4789; val_optim_loss: 371751.4789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5849.2907; train_edge_recon_loss: 257834.8505; train_gene_expr_recon_loss: 108780.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372465.1110; train_optim_loss: 372465.1110; val_kl_reg_loss: 5865.4390; val_edge_recon_loss: 257122.3404; val_gene_expr_recon_loss: 108659.1191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371646.8986; val_optim_loss: 371646.8986
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5852.2168; train_edge_recon_loss: 257750.0367; train_gene_expr_recon_loss: 108772.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372374.7241; train_optim_loss: 372374.7241; val_kl_reg_loss: 5833.4898; val_edge_recon_loss: 256874.4100; val_gene_expr_recon_loss: 108714.3261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371422.2262; val_optim_loss: 371422.2262
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5857.4637; train_edge_recon_loss: 257620.2888; train_gene_expr_recon_loss: 108755.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372233.0841; train_optim_loss: 372233.0841; val_kl_reg_loss: 5862.6863; val_edge_recon_loss: 256801.0024; val_gene_expr_recon_loss: 108798.3714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371462.0595; val_optim_loss: 371462.0595
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5857.9387; train_edge_recon_loss: 257551.3675; train_gene_expr_recon_loss: 108736.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372146.0873; train_optim_loss: 372146.0873; val_kl_reg_loss: 5859.0959; val_edge_recon_loss: 256716.9218; val_gene_expr_recon_loss: 108742.7652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371318.7830; val_optim_loss: 371318.7830
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5859.0009; train_edge_recon_loss: 257507.6752; train_gene_expr_recon_loss: 108728.3069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372094.9831; train_optim_loss: 372094.9831; val_kl_reg_loss: 5848.4608; val_edge_recon_loss: 256806.7649; val_gene_expr_recon_loss: 108770.6793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371425.9051; val_optim_loss: 371425.9051
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5861.3867; train_edge_recon_loss: 257419.0445; train_gene_expr_recon_loss: 108726.3089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372006.7399; train_optim_loss: 372006.7399; val_kl_reg_loss: 5885.5773; val_edge_recon_loss: 256693.4922; val_gene_expr_recon_loss: 108658.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371237.4995; val_optim_loss: 371237.4995
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5862.9037; train_edge_recon_loss: 257366.5096; train_gene_expr_recon_loss: 108701.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371931.0669; train_optim_loss: 371931.0669; val_kl_reg_loss: 5845.7664; val_edge_recon_loss: 256704.5686; val_gene_expr_recon_loss: 108671.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371221.7594; val_optim_loss: 371221.7594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 5863.6182; train_edge_recon_loss: 257312.6613; train_gene_expr_recon_loss: 108687.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371863.4237; train_optim_loss: 371863.4237; val_kl_reg_loss: 5885.1599; val_edge_recon_loss: 256565.5019; val_gene_expr_recon_loss: 108693.4624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371144.1245; val_optim_loss: 371144.1245
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 5866.2713; train_edge_recon_loss: 257267.0355; train_gene_expr_recon_loss: 108703.6592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371836.9660; train_optim_loss: 371836.9660; val_kl_reg_loss: 5866.4227; val_edge_recon_loss: 256453.5474; val_gene_expr_recon_loss: 108711.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371031.2484; val_optim_loss: 371031.2484
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5865.5116; train_edge_recon_loss: 257262.2075; train_gene_expr_recon_loss: 108682.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371810.5149; train_optim_loss: 371810.5149; val_kl_reg_loss: 5840.9163; val_edge_recon_loss: 256485.1236; val_gene_expr_recon_loss: 108621.0476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370947.0876; val_optim_loss: 370947.0876
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5867.2016; train_edge_recon_loss: 257239.0112; train_gene_expr_recon_loss: 108690.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371796.9496; train_optim_loss: 371796.9496; val_kl_reg_loss: 5888.6354; val_edge_recon_loss: 256477.1293; val_gene_expr_recon_loss: 108602.8319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370968.5968; val_optim_loss: 370968.5968
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5868.6511; train_edge_recon_loss: 257134.7240; train_gene_expr_recon_loss: 108683.1220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371686.4969; train_optim_loss: 371686.4969; val_kl_reg_loss: 5889.3909; val_edge_recon_loss: 256592.9512; val_gene_expr_recon_loss: 108773.8139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371256.1553; val_optim_loss: 371256.1553
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5872.1649; train_edge_recon_loss: 257105.2299; train_gene_expr_recon_loss: 108672.6349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371650.0296; train_optim_loss: 371650.0296; val_kl_reg_loss: 5921.9373; val_edge_recon_loss: 256309.2390; val_gene_expr_recon_loss: 108603.2970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370834.4732; val_optim_loss: 370834.4732
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5872.0185; train_edge_recon_loss: 257103.1291; train_gene_expr_recon_loss: 108675.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371650.4705; train_optim_loss: 371650.4705; val_kl_reg_loss: 5900.8233; val_edge_recon_loss: 256344.0487; val_gene_expr_recon_loss: 108645.7424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370890.6144; val_optim_loss: 370890.6144
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5875.8471; train_edge_recon_loss: 257063.7574; train_gene_expr_recon_loss: 108652.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371591.9878; train_optim_loss: 371591.9878; val_kl_reg_loss: 5885.5493; val_edge_recon_loss: 256328.7441; val_gene_expr_recon_loss: 108699.2551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370913.5484; val_optim_loss: 370913.5484
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5876.9210; train_edge_recon_loss: 256984.0040; train_gene_expr_recon_loss: 108673.6448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371534.5700; train_optim_loss: 371534.5700; val_kl_reg_loss: 5905.5872; val_edge_recon_loss: 256383.1029; val_gene_expr_recon_loss: 108653.2738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370941.9635; val_optim_loss: 370941.9635
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5879.0984; train_edge_recon_loss: 256932.1854; train_gene_expr_recon_loss: 108670.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371481.5471; train_optim_loss: 371481.5471; val_kl_reg_loss: 5912.5191; val_edge_recon_loss: 256417.0256; val_gene_expr_recon_loss: 108649.5306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370979.0751; val_optim_loss: 370979.0751

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 5869.7536; train_edge_recon_loss: 256734.2651; train_gene_expr_recon_loss: 108125.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370729.9882; train_optim_loss: 370729.9882; val_kl_reg_loss: 5870.3576; val_edge_recon_loss: 255926.1756; val_gene_expr_recon_loss: 108116.5733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369913.1071; val_optim_loss: 369913.1071
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 5868.4653; train_edge_recon_loss: 256763.8840; train_gene_expr_recon_loss: 108044.1323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370676.4815; train_optim_loss: 370676.4815; val_kl_reg_loss: 5883.2107; val_edge_recon_loss: 255936.8048; val_gene_expr_recon_loss: 108160.7516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369980.7671; val_optim_loss: 369980.7671
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5867.8272; train_edge_recon_loss: 256723.7729; train_gene_expr_recon_loss: 108016.1754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370607.7755; train_optim_loss: 370607.7755; val_kl_reg_loss: 5869.6140; val_edge_recon_loss: 255986.7530; val_gene_expr_recon_loss: 108088.8240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369945.1909; val_optim_loss: 369945.1909
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5868.7627; train_edge_recon_loss: 256693.2744; train_gene_expr_recon_loss: 108016.2513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370578.2887; train_optim_loss: 370578.2887; val_kl_reg_loss: 5895.9963; val_edge_recon_loss: 255976.6058; val_gene_expr_recon_loss: 108096.9365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369969.5380; val_optim_loss: 369969.5380
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 5868.9872; train_edge_recon_loss: 256681.7737; train_gene_expr_recon_loss: 107992.1044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370542.8652; train_optim_loss: 370542.8652; val_kl_reg_loss: 5886.6666; val_edge_recon_loss: 255981.4923; val_gene_expr_recon_loss: 108057.7892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369925.9479; val_optim_loss: 369925.9479

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 5861.8544; train_edge_recon_loss: 256695.6375; train_gene_expr_recon_loss: 107950.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370507.5850; train_optim_loss: 370507.5850; val_kl_reg_loss: 5877.6180; val_edge_recon_loss: 255964.7910; val_gene_expr_recon_loss: 108122.9240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369965.3326; val_optim_loss: 369965.3326
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5863.7807; train_edge_recon_loss: 256653.5836; train_gene_expr_recon_loss: 107930.2522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370447.6165; train_optim_loss: 370447.6165; val_kl_reg_loss: 5878.9410; val_edge_recon_loss: 256068.9503; val_gene_expr_recon_loss: 108018.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369966.8263; val_optim_loss: 369966.8263
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 5865.0162; train_edge_recon_loss: 256668.4004; train_gene_expr_recon_loss: 107917.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370450.8983; train_optim_loss: 370450.8983; val_kl_reg_loss: 5877.1759; val_edge_recon_loss: 255993.3681; val_gene_expr_recon_loss: 108045.2425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369915.7867; val_optim_loss: 369915.7867
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 5866.0945; train_edge_recon_loss: 256643.4861; train_gene_expr_recon_loss: 107913.0363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370422.6168; train_optim_loss: 370422.6168; val_kl_reg_loss: 5883.0976; val_edge_recon_loss: 255819.6158; val_gene_expr_recon_loss: 108060.1227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369762.8371; val_optim_loss: 369762.8371
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 5866.3713; train_edge_recon_loss: 256656.8093; train_gene_expr_recon_loss: 107920.0019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370443.1826; train_optim_loss: 370443.1826; val_kl_reg_loss: 5880.6961; val_edge_recon_loss: 255895.8913; val_gene_expr_recon_loss: 108053.2776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369829.8649; val_optim_loss: 369829.8649
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 5866.9135; train_edge_recon_loss: 256678.1664; train_gene_expr_recon_loss: 107915.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370460.7194; train_optim_loss: 370460.7194; val_kl_reg_loss: 5878.1291; val_edge_recon_loss: 255916.7274; val_gene_expr_recon_loss: 108049.4962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369844.3526; val_optim_loss: 369844.3526
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 5864.6401; train_edge_recon_loss: 256650.1565; train_gene_expr_recon_loss: 107926.4872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370441.2840; train_optim_loss: 370441.2840; val_kl_reg_loss: 5876.9039; val_edge_recon_loss: 255919.7414; val_gene_expr_recon_loss: 107973.8905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369770.5353; val_optim_loss: 369770.5353
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 5866.3845; train_edge_recon_loss: 256651.3620; train_gene_expr_recon_loss: 107917.4067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370435.1531; train_optim_loss: 370435.1531; val_kl_reg_loss: 5882.4303; val_edge_recon_loss: 255860.9586; val_gene_expr_recon_loss: 108041.4459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369784.8348; val_optim_loss: 369784.8348

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 5866.8736; train_edge_recon_loss: 256619.6157; train_gene_expr_recon_loss: 107907.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370393.6108; train_optim_loss: 370393.6108; val_kl_reg_loss: 5878.7404; val_edge_recon_loss: 255959.1355; val_gene_expr_recon_loss: 108061.0033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369898.8800; val_optim_loss: 369898.8800
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5866.0415; train_edge_recon_loss: 256611.5456; train_gene_expr_recon_loss: 107907.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370385.5753; train_optim_loss: 370385.5753; val_kl_reg_loss: 5878.1822; val_edge_recon_loss: 255945.0843; val_gene_expr_recon_loss: 108072.0013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369895.2669; val_optim_loss: 369895.2669
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 5865.2409; train_edge_recon_loss: 256654.0273; train_gene_expr_recon_loss: 107905.8257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370425.0938; train_optim_loss: 370425.0938; val_kl_reg_loss: 5876.9818; val_edge_recon_loss: 255917.9336; val_gene_expr_recon_loss: 108033.2501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369828.1658; val_optim_loss: 369828.1658
