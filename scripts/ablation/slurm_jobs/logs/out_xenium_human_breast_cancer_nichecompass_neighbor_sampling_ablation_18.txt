None
Run timestamp: 25072023_041512_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9903; val_auprc_score: 0.9885; val_best_acc_score: 0.9566; val_best_f1_score: 0.9573; train_kl_reg_loss: 14359.4962; train_edge_recon_loss: 2637467.2860; train_gene_expr_recon_loss: 731803.6678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3383630.4493; train_optim_loss: 3383630.4493; val_kl_reg_loss: 12492.3595; val_edge_recon_loss: 2610543.9570; val_gene_expr_recon_loss: 698518.0056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3321554.3203; val_optim_loss: 3321554.3203
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9647; val_best_f1_score: 0.9653; train_kl_reg_loss: 12090.5289; train_edge_recon_loss: 2594765.9839; train_gene_expr_recon_loss: 692594.7347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3299451.2494; train_optim_loss: 3299451.2494; val_kl_reg_loss: 11515.9493; val_edge_recon_loss: 2593976.8244; val_gene_expr_recon_loss: 689201.9638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3294694.7371; val_optim_loss: 3294694.7371
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 11467.8310; train_edge_recon_loss: 2586446.9823; train_gene_expr_recon_loss: 687166.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3285081.5839; train_optim_loss: 3285081.5839; val_kl_reg_loss: 11225.0829; val_edge_recon_loss: 2589600.4040; val_gene_expr_recon_loss: 686754.1880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3287579.6692; val_optim_loss: 3287579.6692
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 11120.8339; train_edge_recon_loss: 2581339.6478; train_gene_expr_recon_loss: 684608.4474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3277068.9284; train_optim_loss: 3277068.9284; val_kl_reg_loss: 10873.4984; val_edge_recon_loss: 2583588.8668; val_gene_expr_recon_loss: 685333.9697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279796.3367; val_optim_loss: 3279796.3367
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 10848.6706; train_edge_recon_loss: 2579148.9504; train_gene_expr_recon_loss: 682962.9749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3272960.5972; train_optim_loss: 3272960.5972; val_kl_reg_loss: 10604.2436; val_edge_recon_loss: 2581669.6809; val_gene_expr_recon_loss: 684681.6446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276955.5720; val_optim_loss: 3276955.5720
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 10670.5852; train_edge_recon_loss: 2575996.7347; train_gene_expr_recon_loss: 681934.0307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3268601.3506; train_optim_loss: 3268601.3506; val_kl_reg_loss: 10647.0993; val_edge_recon_loss: 2578856.3592; val_gene_expr_recon_loss: 682124.5605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271628.0193; val_optim_loss: 3271628.0193
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 10552.4012; train_edge_recon_loss: 2573297.4965; train_gene_expr_recon_loss: 681125.7502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3264975.6482; train_optim_loss: 3264975.6482; val_kl_reg_loss: 10502.1771; val_edge_recon_loss: 2576195.3331; val_gene_expr_recon_loss: 682485.2722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269182.7869; val_optim_loss: 3269182.7869
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 10472.9812; train_edge_recon_loss: 2571990.8329; train_gene_expr_recon_loss: 680464.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3262928.3539; train_optim_loss: 3262928.3539; val_kl_reg_loss: 10169.9727; val_edge_recon_loss: 2572500.3519; val_gene_expr_recon_loss: 683152.3942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265822.7131; val_optim_loss: 3265822.7131
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 10417.8637; train_edge_recon_loss: 2570334.4741; train_gene_expr_recon_loss: 680057.0016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3260809.3407; train_optim_loss: 3260809.3407; val_kl_reg_loss: 10265.2803; val_edge_recon_loss: 2572432.9429; val_gene_expr_recon_loss: 682466.7940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265165.0249; val_optim_loss: 3265165.0249
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 10351.7681; train_edge_recon_loss: 2568856.8825; train_gene_expr_recon_loss: 679512.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3258720.6731; train_optim_loss: 3258720.6731; val_kl_reg_loss: 10166.9297; val_edge_recon_loss: 2572708.3817; val_gene_expr_recon_loss: 681581.0242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264456.3437; val_optim_loss: 3264456.3437
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 10320.8685; train_edge_recon_loss: 2567837.0460; train_gene_expr_recon_loss: 679187.7426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257345.6525; train_optim_loss: 3257345.6525; val_kl_reg_loss: 10454.8737; val_edge_recon_loss: 2570537.5571; val_gene_expr_recon_loss: 682354.6508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263347.0814; val_optim_loss: 3263347.0814
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 10302.6227; train_edge_recon_loss: 2566921.5310; train_gene_expr_recon_loss: 678951.6894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3256175.8426; train_optim_loss: 3256175.8426; val_kl_reg_loss: 10233.3163; val_edge_recon_loss: 2569101.0588; val_gene_expr_recon_loss: 681408.1233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260742.4985; val_optim_loss: 3260742.4985
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 10259.2095; train_edge_recon_loss: 2565752.6276; train_gene_expr_recon_loss: 678677.6684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254689.5061; train_optim_loss: 3254689.5061; val_kl_reg_loss: 10282.1247; val_edge_recon_loss: 2568230.1080; val_gene_expr_recon_loss: 680762.3059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259274.5383; val_optim_loss: 3259274.5383
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 10241.4768; train_edge_recon_loss: 2565293.5183; train_gene_expr_recon_loss: 678358.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253893.0512; train_optim_loss: 3253893.0512; val_kl_reg_loss: 10110.5385; val_edge_recon_loss: 2567371.1569; val_gene_expr_recon_loss: 681287.3183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258769.0202; val_optim_loss: 3258769.0202
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 10226.3335; train_edge_recon_loss: 2564322.7427; train_gene_expr_recon_loss: 678268.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252817.9273; train_optim_loss: 3252817.9273; val_kl_reg_loss: 10150.9410; val_edge_recon_loss: 2567235.9271; val_gene_expr_recon_loss: 680949.9701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258336.8437; val_optim_loss: 3258336.8437
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 10208.1916; train_edge_recon_loss: 2564112.1884; train_gene_expr_recon_loss: 678048.4616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252368.8430; train_optim_loss: 3252368.8430; val_kl_reg_loss: 10090.7332; val_edge_recon_loss: 2565944.0515; val_gene_expr_recon_loss: 681131.1505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257165.9362; val_optim_loss: 3257165.9362
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 10196.3628; train_edge_recon_loss: 2563516.0527; train_gene_expr_recon_loss: 678034.1805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251746.5960; train_optim_loss: 3251746.5960; val_kl_reg_loss: 10212.9626; val_edge_recon_loss: 2565155.6162; val_gene_expr_recon_loss: 680787.8346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256156.4148; val_optim_loss: 3256156.4148
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 10176.6066; train_edge_recon_loss: 2563360.4614; train_gene_expr_recon_loss: 677871.9522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251409.0190; train_optim_loss: 3251409.0190; val_kl_reg_loss: 10114.4702; val_edge_recon_loss: 2564679.7207; val_gene_expr_recon_loss: 681439.7998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256233.9857; val_optim_loss: 3256233.9857
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 10180.4619; train_edge_recon_loss: 2562584.9937; train_gene_expr_recon_loss: 677801.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250566.4732; train_optim_loss: 3250566.4732; val_kl_reg_loss: 10139.3065; val_edge_recon_loss: 2565148.8255; val_gene_expr_recon_loss: 681177.0105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256465.1420; val_optim_loss: 3256465.1420
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 10154.8589; train_edge_recon_loss: 2562223.0643; train_gene_expr_recon_loss: 677601.9541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249979.8769; train_optim_loss: 3249979.8769; val_kl_reg_loss: 10038.7706; val_edge_recon_loss: 2565377.6282; val_gene_expr_recon_loss: 680810.5779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256226.9780; val_optim_loss: 3256226.9780
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 10162.7213; train_edge_recon_loss: 2561381.2344; train_gene_expr_recon_loss: 677518.4443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249062.4014; train_optim_loss: 3249062.4014; val_kl_reg_loss: 10189.8769; val_edge_recon_loss: 2563182.7201; val_gene_expr_recon_loss: 681295.5637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254668.1613; val_optim_loss: 3254668.1613
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 10129.5900; train_edge_recon_loss: 2561553.4981; train_gene_expr_recon_loss: 677410.1755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249093.2639; train_optim_loss: 3249093.2639; val_kl_reg_loss: 10120.7478; val_edge_recon_loss: 2561964.2515; val_gene_expr_recon_loss: 680681.4123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252766.4101; val_optim_loss: 3252766.4101
