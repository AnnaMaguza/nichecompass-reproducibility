None
Run timestamp: 07082023_104849_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 6039.3277; train_edge_recon_loss: 264258.2582; train_gene_expr_recon_loss: 118587.6653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 388885.2513; train_optim_loss: 388885.2513; val_kl_reg_loss: 5728.3756; val_edge_recon_loss: 260698.7516; val_gene_expr_recon_loss: 110534.1035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376961.2307; val_optim_loss: 376961.2307
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9946; val_auprc_score: 0.9936; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 5880.1918; train_edge_recon_loss: 260397.2762; train_gene_expr_recon_loss: 109916.9335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 376194.4015; train_optim_loss: 376194.4015; val_kl_reg_loss: 5859.7174; val_edge_recon_loss: 259295.0514; val_gene_expr_recon_loss: 109319.7606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374474.5293; val_optim_loss: 374474.5293
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 5850.8648; train_edge_recon_loss: 259569.9613; train_gene_expr_recon_loss: 109314.8111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374735.6372; train_optim_loss: 374735.6372; val_kl_reg_loss: 5804.3895; val_edge_recon_loss: 258641.5713; val_gene_expr_recon_loss: 109090.2379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373536.1984; val_optim_loss: 373536.1984
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 5842.2399; train_edge_recon_loss: 259047.4736; train_gene_expr_recon_loss: 109121.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374011.6115; train_optim_loss: 374011.6115; val_kl_reg_loss: 5696.3507; val_edge_recon_loss: 258164.2174; val_gene_expr_recon_loss: 109056.6886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372917.2573; val_optim_loss: 372917.2573
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5842.4750; train_edge_recon_loss: 258684.2788; train_gene_expr_recon_loss: 108977.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373504.3602; train_optim_loss: 373504.3602; val_kl_reg_loss: 5750.2380; val_edge_recon_loss: 257970.1733; val_gene_expr_recon_loss: 108834.3205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372554.7314; val_optim_loss: 372554.7314
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5846.7132; train_edge_recon_loss: 258372.6188; train_gene_expr_recon_loss: 108913.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373132.7054; train_optim_loss: 373132.7054; val_kl_reg_loss: 5820.2791; val_edge_recon_loss: 257696.9119; val_gene_expr_recon_loss: 108698.8312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372216.0218; val_optim_loss: 372216.0218
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5846.5503; train_edge_recon_loss: 258217.7988; train_gene_expr_recon_loss: 108850.5476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372914.8967; train_optim_loss: 372914.8967; val_kl_reg_loss: 5857.5108; val_edge_recon_loss: 257647.4669; val_gene_expr_recon_loss: 108775.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372280.5627; val_optim_loss: 372280.5627
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5846.0316; train_edge_recon_loss: 258114.0809; train_gene_expr_recon_loss: 108832.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372792.3977; train_optim_loss: 372792.3977; val_kl_reg_loss: 5862.4745; val_edge_recon_loss: 257230.0150; val_gene_expr_recon_loss: 108709.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371801.8984; val_optim_loss: 371801.8984
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 5850.0779; train_edge_recon_loss: 257931.1130; train_gene_expr_recon_loss: 108807.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372588.5726; train_optim_loss: 372588.5726; val_kl_reg_loss: 5783.1106; val_edge_recon_loss: 257201.8670; val_gene_expr_recon_loss: 108766.5012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371751.4789; val_optim_loss: 371751.4789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5849.2907; train_edge_recon_loss: 257834.8505; train_gene_expr_recon_loss: 108780.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372465.1110; train_optim_loss: 372465.1110; val_kl_reg_loss: 5865.4390; val_edge_recon_loss: 257122.3404; val_gene_expr_recon_loss: 108659.1191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371646.8986; val_optim_loss: 371646.8986
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5852.2168; train_edge_recon_loss: 257750.0367; train_gene_expr_recon_loss: 108772.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372374.7241; train_optim_loss: 372374.7241; val_kl_reg_loss: 5833.4898; val_edge_recon_loss: 256874.4100; val_gene_expr_recon_loss: 108714.3261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371422.2262; val_optim_loss: 371422.2262
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5857.4637; train_edge_recon_loss: 257620.2888; train_gene_expr_recon_loss: 108755.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372233.0841; train_optim_loss: 372233.0841; val_kl_reg_loss: 5862.6863; val_edge_recon_loss: 256801.0024; val_gene_expr_recon_loss: 108798.3714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371462.0595; val_optim_loss: 371462.0595
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 5857.9387; train_edge_recon_loss: 257551.3675; train_gene_expr_recon_loss: 108736.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372146.0873; train_optim_loss: 372146.0873; val_kl_reg_loss: 5859.0959; val_edge_recon_loss: 256716.9218; val_gene_expr_recon_loss: 108742.7652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371318.7830; val_optim_loss: 371318.7830
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5859.0009; train_edge_recon_loss: 257507.6752; train_gene_expr_recon_loss: 108728.3069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372094.9831; train_optim_loss: 372094.9831; val_kl_reg_loss: 5848.4608; val_edge_recon_loss: 256806.7649; val_gene_expr_recon_loss: 108770.6793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371425.9051; val_optim_loss: 371425.9051
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5861.3867; train_edge_recon_loss: 257419.0445; train_gene_expr_recon_loss: 108726.3089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372006.7399; train_optim_loss: 372006.7399; val_kl_reg_loss: 5885.5773; val_edge_recon_loss: 256693.4922; val_gene_expr_recon_loss: 108658.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371237.4995; val_optim_loss: 371237.4995
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5862.9037; train_edge_recon_loss: 257366.5096; train_gene_expr_recon_loss: 108701.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371931.0669; train_optim_loss: 371931.0669; val_kl_reg_loss: 5845.7664; val_edge_recon_loss: 256704.5686; val_gene_expr_recon_loss: 108671.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371221.7594; val_optim_loss: 371221.7594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 5863.6182; train_edge_recon_loss: 257312.6613; train_gene_expr_recon_loss: 108687.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371863.4237; train_optim_loss: 371863.4237; val_kl_reg_loss: 5885.1599; val_edge_recon_loss: 256565.5019; val_gene_expr_recon_loss: 108693.4624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371144.1245; val_optim_loss: 371144.1245
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 5866.2713; train_edge_recon_loss: 257267.0355; train_gene_expr_recon_loss: 108703.6592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371836.9660; train_optim_loss: 371836.9660; val_kl_reg_loss: 5866.4227; val_edge_recon_loss: 256453.5474; val_gene_expr_recon_loss: 108711.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371031.2484; val_optim_loss: 371031.2484
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5865.5116; train_edge_recon_loss: 257262.2075; train_gene_expr_recon_loss: 108682.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371810.5149; train_optim_loss: 371810.5149; val_kl_reg_loss: 5840.9163; val_edge_recon_loss: 256485.1236; val_gene_expr_recon_loss: 108621.0476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370947.0876; val_optim_loss: 370947.0876
