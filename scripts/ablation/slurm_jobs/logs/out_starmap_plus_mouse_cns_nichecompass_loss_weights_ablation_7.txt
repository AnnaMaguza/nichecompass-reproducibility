None
Run timestamp: 02072023_090838_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9839; val_auprc_score: 0.9817; val_best_acc_score: 0.9428; val_best_f1_score: 0.9427; train_kl_reg_loss: 767.3714; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12161.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12928.7665; train_optim_loss: 12928.7665; val_kl_reg_loss: 735.2076; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10842.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11577.4536; val_optim_loss: 11577.4536
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9873; val_auprc_score: 0.9857; val_best_acc_score: 0.9504; val_best_f1_score: 0.9507; train_kl_reg_loss: 688.4075; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10691.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11379.8997; train_optim_loss: 11379.8997; val_kl_reg_loss: 638.1709; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10356.8251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10994.9960; val_optim_loss: 10994.9960
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9887; val_auprc_score: 0.9873; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 611.7426; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10362.0722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10973.8148; train_optim_loss: 10973.8148; val_kl_reg_loss: 582.8539; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10109.7218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10692.5757; val_optim_loss: 10692.5757
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9900; val_auprc_score: 0.9891; val_best_acc_score: 0.9558; val_best_f1_score: 0.9561; train_kl_reg_loss: 571.4185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10164.2058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10735.6243; train_optim_loss: 10735.6243; val_kl_reg_loss: 552.7841; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9974.1420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10526.9260; val_optim_loss: 10526.9260
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9904; val_auprc_score: 0.9896; val_best_acc_score: 0.9561; val_best_f1_score: 0.9568; train_kl_reg_loss: 546.2226; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10033.3894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10579.6120; train_optim_loss: 10579.6120; val_kl_reg_loss: 530.3493; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9874.3743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10404.7236; val_optim_loss: 10404.7236
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9903; val_best_acc_score: 0.9581; val_best_f1_score: 0.9584; train_kl_reg_loss: 530.1340; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9951.6104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10481.7443; train_optim_loss: 10481.7443; val_kl_reg_loss: 524.0085; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9829.6834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10353.6919; val_optim_loss: 10353.6919
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9918; val_auprc_score: 0.9914; val_best_acc_score: 0.9590; val_best_f1_score: 0.9590; train_kl_reg_loss: 518.9066; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9878.6624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10397.5690; train_optim_loss: 10397.5690; val_kl_reg_loss: 511.9384; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9776.3185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10288.2569; val_optim_loss: 10288.2569
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9924; val_auprc_score: 0.9918; val_best_acc_score: 0.9605; val_best_f1_score: 0.9608; train_kl_reg_loss: 511.9142; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9830.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10342.0031; train_optim_loss: 10342.0031; val_kl_reg_loss: 489.2419; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9748.3269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10237.5687; val_optim_loss: 10237.5687
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9924; val_best_acc_score: 0.9616; val_best_f1_score: 0.9616; train_kl_reg_loss: 506.2903; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9789.2529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10295.5433; train_optim_loss: 10295.5433; val_kl_reg_loss: 488.0777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9700.6651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10188.7429; val_optim_loss: 10188.7429
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9930; val_auprc_score: 0.9925; val_best_acc_score: 0.9625; val_best_f1_score: 0.9629; train_kl_reg_loss: 503.8934; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9770.8373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10274.7307; train_optim_loss: 10274.7307; val_kl_reg_loss: 482.5422; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9716.7883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10199.3305; val_optim_loss: 10199.3305
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9630; val_best_f1_score: 0.9632; train_kl_reg_loss: 501.7907; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9742.4657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10244.2564; train_optim_loss: 10244.2564; val_kl_reg_loss: 493.6790; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9709.3114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10202.9904; val_optim_loss: 10202.9904
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9929; val_best_acc_score: 0.9629; val_best_f1_score: 0.9634; train_kl_reg_loss: 501.3215; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9710.2456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10211.5671; train_optim_loss: 10211.5671; val_kl_reg_loss: 487.4638; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9679.2035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10166.6673; val_optim_loss: 10166.6673
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9926; val_best_acc_score: 0.9617; val_best_f1_score: 0.9619; train_kl_reg_loss: 500.6976; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9701.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10202.4614; train_optim_loss: 10202.4614; val_kl_reg_loss: 496.4250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9694.4173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10190.8423; val_optim_loss: 10190.8423
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9934; val_auprc_score: 0.9931; val_best_acc_score: 0.9633; val_best_f1_score: 0.9635; train_kl_reg_loss: 501.1525; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9685.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10186.4155; train_optim_loss: 10186.4155; val_kl_reg_loss: 489.7507; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9693.1258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10182.8765; val_optim_loss: 10182.8765
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9939; val_auprc_score: 0.9936; val_best_acc_score: 0.9652; val_best_f1_score: 0.9652; train_kl_reg_loss: 501.5526; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9660.2101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10161.7627; train_optim_loss: 10161.7627; val_kl_reg_loss: 485.2421; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9694.1832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10179.4253; val_optim_loss: 10179.4253
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9938; val_auprc_score: 0.9934; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 502.0637; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9657.1857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10159.2495; train_optim_loss: 10159.2495; val_kl_reg_loss: 485.6726; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9703.3322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10189.0048; val_optim_loss: 10189.0048

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9940; val_auprc_score: 0.9939; val_best_acc_score: 0.9660; val_best_f1_score: 0.9661; train_kl_reg_loss: 500.3996; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9612.6880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10113.0877; train_optim_loss: 10113.0877; val_kl_reg_loss: 491.7243; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9674.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10165.9126; val_optim_loss: 10165.9126
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9940; val_auprc_score: 0.9938; val_best_acc_score: 0.9661; val_best_f1_score: 0.9662; train_kl_reg_loss: 500.4341; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9600.7783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10101.2124; train_optim_loss: 10101.2124; val_kl_reg_loss: 494.2368; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9702.7819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10197.0188; val_optim_loss: 10197.0188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9939; val_best_acc_score: 0.9660; val_best_f1_score: 0.9661; train_kl_reg_loss: 500.9456; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9593.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10094.5302; train_optim_loss: 10094.5302; val_kl_reg_loss: 490.0435; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9678.6188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10168.6623; val_optim_loss: 10168.6623
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9941; val_auprc_score: 0.9937; val_best_acc_score: 0.9659; val_best_f1_score: 0.9660; train_kl_reg_loss: 501.3604; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9593.7732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10095.1336; train_optim_loss: 10095.1336; val_kl_reg_loss: 496.2659; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9657.3084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10153.5743; val_optim_loss: 10153.5743
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9939; val_auprc_score: 0.9935; val_best_acc_score: 0.9655; val_best_f1_score: 0.9655; train_kl_reg_loss: 501.4962; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9591.5119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10093.0081; train_optim_loss: 10093.0081; val_kl_reg_loss: 489.9254; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9688.1293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10178.0547; val_optim_loss: 10178.0547
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9940; val_auprc_score: 0.9936; val_best_acc_score: 0.9658; val_best_f1_score: 0.9658; train_kl_reg_loss: 501.9526; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9587.3573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10089.3099; train_optim_loss: 10089.3099; val_kl_reg_loss: 493.8429; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9680.1448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10173.9877; val_optim_loss: 10173.9877
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9939; val_auprc_score: 0.9937; val_best_acc_score: 0.9655; val_best_f1_score: 0.9655; train_kl_reg_loss: 502.3589; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9592.3248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10094.6838; train_optim_loss: 10094.6838; val_kl_reg_loss: 492.4239; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9680.5119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10172.9357; val_optim_loss: 10172.9357
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9941; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 502.6198; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9595.9223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10098.5420; train_optim_loss: 10098.5420; val_kl_reg_loss: 489.8942; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9706.5661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10196.4602; val_optim_loss: 10196.4602

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9939; val_auprc_score: 0.9933; val_best_acc_score: 0.9651; val_best_f1_score: 0.9652; train_kl_reg_loss: 502.1149; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9572.3479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10074.4628; train_optim_loss: 10074.4628; val_kl_reg_loss: 493.4302; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9686.8713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10180.3016; val_optim_loss: 10180.3016
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9943; val_auprc_score: 0.9941; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 502.1847; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9572.5715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10074.7562; train_optim_loss: 10074.7562; val_kl_reg_loss: 492.2380; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9688.5584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10180.7964; val_optim_loss: 10180.7964
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9940; val_auprc_score: 0.9934; val_best_acc_score: 0.9660; val_best_f1_score: 0.9661; train_kl_reg_loss: 502.3272; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9565.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10068.3197; train_optim_loss: 10068.3197; val_kl_reg_loss: 492.4615; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9704.7203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10197.1818; val_optim_loss: 10197.1818
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9940; val_auprc_score: 0.9937; val_best_acc_score: 0.9652; val_best_f1_score: 0.9653; train_kl_reg_loss: 502.3764; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9577.7728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10080.1492; train_optim_loss: 10080.1492; val_kl_reg_loss: 493.0788; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9693.7200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10186.7987; val_optim_loss: 10186.7987

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 145 min 19 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9940
Val AUPRC score: 0.9939
Val best accuracy score: 0.9655
Val best F1 score: 0.9656
Val gene expr MSE score: 0.6611

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
