None
Run timestamp: 20072023_111648_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9664; val_auprc_score: 0.9567; val_best_acc_score: 0.9198; val_best_f1_score: 0.9222; train_kl_reg_loss: 64861.1152; train_edge_recon_loss: 26859264.8546; train_gene_expr_recon_loss: 11487592.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38411718.1359; train_optim_loss: 38411718.1359; val_kl_reg_loss: 80772.4395; val_edge_recon_loss: 26402572.7805; val_gene_expr_recon_loss: 10290594.5061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36773939.5610; val_optim_loss: 36773939.5610
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9708; val_auprc_score: 0.9599; val_best_acc_score: 0.9298; val_best_f1_score: 0.9322; train_kl_reg_loss: 79881.3552; train_edge_recon_loss: 26193385.3043; train_gene_expr_recon_loss: 9750794.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36024061.4796; train_optim_loss: 36024061.4796; val_kl_reg_loss: 78487.7704; val_edge_recon_loss: 26274019.8537; val_gene_expr_recon_loss: 9278187.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35630694.8293; val_optim_loss: 35630694.8293
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9746; val_auprc_score: 0.9648; val_best_acc_score: 0.9375; val_best_f1_score: 0.9396; train_kl_reg_loss: 78865.4890; train_edge_recon_loss: 26089002.5747; train_gene_expr_recon_loss: 8999093.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35166961.9266; train_optim_loss: 35166961.9266; val_kl_reg_loss: 72660.6606; val_edge_recon_loss: 26239466.9268; val_gene_expr_recon_loss: 8839790.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35151917.8049; val_optim_loss: 35151917.8049
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9729; val_auprc_score: 0.9623; val_best_acc_score: 0.9357; val_best_f1_score: 0.9381; train_kl_reg_loss: 78638.2516; train_edge_recon_loss: 26030358.1603; train_gene_expr_recon_loss: 8471796.0027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34580792.4117; train_optim_loss: 34580792.4117; val_kl_reg_loss: 79965.2682; val_edge_recon_loss: 26126968.1098; val_gene_expr_recon_loss: 8284086.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34491020.2317; val_optim_loss: 34491020.2317
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9743; val_auprc_score: 0.9640; val_best_acc_score: 0.9390; val_best_f1_score: 0.9413; train_kl_reg_loss: 81504.5568; train_edge_recon_loss: 25958145.2812; train_gene_expr_recon_loss: 8081799.2293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34121449.0571; train_optim_loss: 34121449.0571; val_kl_reg_loss: 86459.6709; val_edge_recon_loss: 25997142.9146; val_gene_expr_recon_loss: 7952467.8323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34036070.4878; val_optim_loss: 34036070.4878
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9751; val_auprc_score: 0.9651; val_best_acc_score: 0.9406; val_best_f1_score: 0.9427; train_kl_reg_loss: 85592.7070; train_edge_recon_loss: 25934485.9076; train_gene_expr_recon_loss: 7793933.4212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33814011.9878; train_optim_loss: 33814011.9878; val_kl_reg_loss: 85659.9747; val_edge_recon_loss: 26000879.9390; val_gene_expr_recon_loss: 7701179.3537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33787719.2927; val_optim_loss: 33787719.2927
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9775; val_auprc_score: 0.9694; val_best_acc_score: 0.9438; val_best_f1_score: 0.9456; train_kl_reg_loss: 84632.3765; train_edge_recon_loss: 25883698.8872; train_gene_expr_recon_loss: 7461582.2982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33429913.5557; train_optim_loss: 33429913.5557; val_kl_reg_loss: 85049.6970; val_edge_recon_loss: 25965712.3780; val_gene_expr_recon_loss: 7429636.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33480398.9146; val_optim_loss: 33480398.9146
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9767; val_auprc_score: 0.9667; val_best_acc_score: 0.9452; val_best_f1_score: 0.9472; train_kl_reg_loss: 83732.4253; train_edge_recon_loss: 25869327.1562; train_gene_expr_recon_loss: 7212348.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33165407.6399; train_optim_loss: 33165407.6399; val_kl_reg_loss: 83581.3032; val_edge_recon_loss: 25964802.2073; val_gene_expr_recon_loss: 7237006.6555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33285390.3293; val_optim_loss: 33285390.3293
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9780; val_auprc_score: 0.9688; val_best_acc_score: 0.9459; val_best_f1_score: 0.9477; train_kl_reg_loss: 83367.7342; train_edge_recon_loss: 25861530.4959; train_gene_expr_recon_loss: 7025123.2011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32970021.4497; train_optim_loss: 32970021.4497; val_kl_reg_loss: 81769.6927; val_edge_recon_loss: 25957966.8659; val_gene_expr_recon_loss: 7095510.9421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33135247.4512; val_optim_loss: 33135247.4512
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9798; val_auprc_score: 0.9712; val_best_acc_score: 0.9488; val_best_f1_score: 0.9504; train_kl_reg_loss: 83028.1688; train_edge_recon_loss: 25838911.9796; train_gene_expr_recon_loss: 6874060.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32796000.2337; train_optim_loss: 32796000.2337; val_kl_reg_loss: 87967.9052; val_edge_recon_loss: 25897472.2805; val_gene_expr_recon_loss: 6935251.8110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32920692.0488; val_optim_loss: 32920692.0488
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9806; val_auprc_score: 0.9721; val_best_acc_score: 0.9517; val_best_f1_score: 0.9531; train_kl_reg_loss: 83632.8752; train_edge_recon_loss: 25812625.2772; train_gene_expr_recon_loss: 6752096.7829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32648354.9565; train_optim_loss: 32648354.9565; val_kl_reg_loss: 85885.0329; val_edge_recon_loss: 25890722.0854; val_gene_expr_recon_loss: 6888855.3780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32865462.5610; val_optim_loss: 32865462.5610
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9817; val_auprc_score: 0.9733; val_best_acc_score: 0.9538; val_best_f1_score: 0.9550; train_kl_reg_loss: 85048.9788; train_edge_recon_loss: 25783146.0476; train_gene_expr_recon_loss: 6641444.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32509639.1712; train_optim_loss: 32509639.1712; val_kl_reg_loss: 89646.9101; val_edge_recon_loss: 25858486.6951; val_gene_expr_recon_loss: 6776396.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32724530.4024; val_optim_loss: 32724530.4024
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9838; val_auprc_score: 0.9773; val_best_acc_score: 0.9557; val_best_f1_score: 0.9569; train_kl_reg_loss: 86585.4639; train_edge_recon_loss: 25765678.5014; train_gene_expr_recon_loss: 6546559.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32398823.2677; train_optim_loss: 32398823.2677; val_kl_reg_loss: 89266.4175; val_edge_recon_loss: 25838394.7561; val_gene_expr_recon_loss: 6757070.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32684731.6585; val_optim_loss: 32684731.6585
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9836; val_auprc_score: 0.9773; val_best_acc_score: 0.9557; val_best_f1_score: 0.9570; train_kl_reg_loss: 88183.2454; train_edge_recon_loss: 25752029.7853; train_gene_expr_recon_loss: 6485343.5027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32325556.5163; train_optim_loss: 32325556.5163; val_kl_reg_loss: 89123.3586; val_edge_recon_loss: 25817658.1098; val_gene_expr_recon_loss: 6686657.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32593439.2317; val_optim_loss: 32593439.2317
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9831; val_auprc_score: 0.9757; val_best_acc_score: 0.9571; val_best_f1_score: 0.9583; train_kl_reg_loss: 91407.4819; train_edge_recon_loss: 25726516.6603; train_gene_expr_recon_loss: 6432004.4997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32249928.6549; train_optim_loss: 32249928.6549; val_kl_reg_loss: 91451.7204; val_edge_recon_loss: 25815892.8902; val_gene_expr_recon_loss: 6629336.4299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32536681.0732; val_optim_loss: 32536681.0732
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9831; val_auprc_score: 0.9758; val_best_acc_score: 0.9557; val_best_f1_score: 0.9569; train_kl_reg_loss: 87186405087.4925; train_edge_recon_loss: 25735814.5910; train_gene_expr_recon_loss: 6456235.3332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87218598364.2649; train_optim_loss: 87218598364.2649; val_kl_reg_loss: 89333.6362; val_edge_recon_loss: 25848522.1707; val_gene_expr_recon_loss: 6703606.8506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32641462.6707; val_optim_loss: 32641462.6707
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9841; val_auprc_score: 0.9781; val_best_acc_score: 0.9576; val_best_f1_score: 0.9587; train_kl_reg_loss: 94200.7480; train_edge_recon_loss: 25730299.2935; train_gene_expr_recon_loss: 6348526.7398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32173026.7663; train_optim_loss: 32173026.7663; val_kl_reg_loss: 99955.0072; val_edge_recon_loss: 25800833.0244; val_gene_expr_recon_loss: 6595888.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32496676.2683; val_optim_loss: 32496676.2683
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9847; val_auprc_score: 0.9787; val_best_acc_score: 0.9583; val_best_f1_score: 0.9595; train_kl_reg_loss: 96537.8751; train_edge_recon_loss: 25722251.9769; train_gene_expr_recon_loss: 6320594.8849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32139384.6984; train_optim_loss: 32139384.6984; val_kl_reg_loss: 99176.0600; val_edge_recon_loss: 25787177.7805; val_gene_expr_recon_loss: 6585151.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32471505.3902; val_optim_loss: 32471505.3902
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9822; val_auprc_score: 0.9733; val_best_acc_score: 0.9565; val_best_f1_score: 0.9578; train_kl_reg_loss: 10912545141.5763; train_edge_recon_loss: 25697266.2242; train_gene_expr_recon_loss: 6292234.2870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10944534959.2446; train_optim_loss: 10944534959.2446; val_kl_reg_loss: 98355.4469; val_edge_recon_loss: 25846464.1707; val_gene_expr_recon_loss: 6769753.9116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32714573.4390; val_optim_loss: 32714573.4390
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9846; val_auprc_score: 0.9774; val_best_acc_score: 0.9592; val_best_f1_score: 0.9604; train_kl_reg_loss: 101689.9313; train_edge_recon_loss: 25711298.7160; train_gene_expr_recon_loss: 6292345.4772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32105334.1196; train_optim_loss: 32105334.1196; val_kl_reg_loss: 98845.3733; val_edge_recon_loss: 25781929.3049; val_gene_expr_recon_loss: 6647226.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32528000.9512; val_optim_loss: 32528000.9512
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9849; val_auprc_score: 0.9785; val_best_acc_score: 0.9591; val_best_f1_score: 0.9603; train_kl_reg_loss: 101546.2836; train_edge_recon_loss: 25685453.9837; train_gene_expr_recon_loss: 6201343.5014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31988343.8234; train_optim_loss: 31988343.8234; val_kl_reg_loss: 105565.5655; val_edge_recon_loss: 25773607.9756; val_gene_expr_recon_loss: 6544635.1616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32423808.7073; val_optim_loss: 32423808.7073
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9853; val_auprc_score: 0.9787; val_best_acc_score: 0.9596; val_best_f1_score: 0.9608; train_kl_reg_loss: 102496.3886; train_edge_recon_loss: 25688587.4864; train_gene_expr_recon_loss: 6173173.5520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31964257.4552; train_optim_loss: 31964257.4552; val_kl_reg_loss: 101413.1124; val_edge_recon_loss: 25787664.8659; val_gene_expr_recon_loss: 6549327.6128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32438405.6098; val_optim_loss: 32438405.6098
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9850; val_auprc_score: 0.9784; val_best_acc_score: 0.9599; val_best_f1_score: 0.9610; train_kl_reg_loss: 104069.8454; train_edge_recon_loss: 25693426.8682; train_gene_expr_recon_loss: 6137504.0839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31935000.8193; train_optim_loss: 31935000.8193; val_kl_reg_loss: 106033.2776; val_edge_recon_loss: 25765277.7317; val_gene_expr_recon_loss: 6512409.2805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32383720.1951; val_optim_loss: 32383720.1951
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9849; val_auprc_score: 0.9783; val_best_acc_score: 0.9597; val_best_f1_score: 0.9607; train_kl_reg_loss: 127816.7061; train_edge_recon_loss: 25692161.2717; train_gene_expr_recon_loss: 6161304.5601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31981282.4891; train_optim_loss: 31981282.4891; val_kl_reg_loss: 102159.8272; val_edge_recon_loss: 25805854.3659; val_gene_expr_recon_loss: 6532690.2409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32440704.3780; val_optim_loss: 32440704.3780
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9864; val_auprc_score: 0.9815; val_best_acc_score: 0.9610; val_best_f1_score: 0.9620; train_kl_reg_loss: 106794.0771; train_edge_recon_loss: 25693139.4361; train_gene_expr_recon_loss: 6083655.6399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31883589.1685; train_optim_loss: 31883589.1685; val_kl_reg_loss: 107442.9550; val_edge_recon_loss: 25750069.7683; val_gene_expr_recon_loss: 6497340.5915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32354853.2439; val_optim_loss: 32354853.2439
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9854; val_auprc_score: 0.9789; val_best_acc_score: 0.9610; val_best_f1_score: 0.9620; train_kl_reg_loss: 108508.6832; train_edge_recon_loss: 25678882.0856; train_gene_expr_recon_loss: 6047575.6936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31834966.4932; train_optim_loss: 31834966.4932; val_kl_reg_loss: 110903.4867; val_edge_recon_loss: 25755325.4268; val_gene_expr_recon_loss: 6491011.4665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32357240.3659; val_optim_loss: 32357240.3659
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9865; val_auprc_score: 0.9810; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 108050.4696; train_edge_recon_loss: 25693699.0938; train_gene_expr_recon_loss: 6073085.4582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31874835.0027; train_optim_loss: 31874835.0027; val_kl_reg_loss: 111173.7510; val_edge_recon_loss: 25741704.2317; val_gene_expr_recon_loss: 6490150.0884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32343028.0854; val_optim_loss: 32343028.0854
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9863; val_auprc_score: 0.9803; val_best_acc_score: 0.9628; val_best_f1_score: 0.9637; train_kl_reg_loss: 111136.2523; train_edge_recon_loss: 25683102.9511; train_gene_expr_recon_loss: 6016558.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31810797.9321; train_optim_loss: 31810797.9321; val_kl_reg_loss: 105196.0558; val_edge_recon_loss: 25752475.8537; val_gene_expr_recon_loss: 6516300.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32373972.1098; val_optim_loss: 32373972.1098
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9853; val_auprc_score: 0.9789; val_best_acc_score: 0.9606; val_best_f1_score: 0.9616; train_kl_reg_loss: 115670.9310; train_edge_recon_loss: 25695734.8288; train_gene_expr_recon_loss: 6042058.6274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31853464.3655; train_optim_loss: 31853464.3655; val_kl_reg_loss: 107920.6369; val_edge_recon_loss: 25789950.9268; val_gene_expr_recon_loss: 6526881.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32424753.3293; val_optim_loss: 32424753.3293
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9865; val_auprc_score: 0.9810; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 112161.5840; train_edge_recon_loss: 25675958.0245; train_gene_expr_recon_loss: 6028705.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31816825.4688; train_optim_loss: 31816825.4688; val_kl_reg_loss: 108894.2417; val_edge_recon_loss: 25771648.1951; val_gene_expr_recon_loss: 6436818.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32317360.5488; val_optim_loss: 32317360.5488
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9864; val_auprc_score: 0.9806; val_best_acc_score: 0.9612; val_best_f1_score: 0.9621; train_kl_reg_loss: 111987.4312; train_edge_recon_loss: 25676304.4511; train_gene_expr_recon_loss: 6002011.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31790303.2745; train_optim_loss: 31790303.2745; val_kl_reg_loss: 114264.5351; val_edge_recon_loss: 25753816.4024; val_gene_expr_recon_loss: 6467104.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32335185.0000; val_optim_loss: 32335185.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9865; val_auprc_score: 0.9814; val_best_acc_score: 0.9613; val_best_f1_score: 0.9622; train_kl_reg_loss: 116280.9250; train_edge_recon_loss: 25673874.1902; train_gene_expr_recon_loss: 5950219.8679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31740374.9728; train_optim_loss: 31740374.9728; val_kl_reg_loss: 115280.2261; val_edge_recon_loss: 25763257.0610; val_gene_expr_recon_loss: 6431933.8994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32310471.1829; val_optim_loss: 32310471.1829
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9863; val_auprc_score: 0.9808; val_best_acc_score: 0.9614; val_best_f1_score: 0.9625; train_kl_reg_loss: 115063.6345; train_edge_recon_loss: 25683089.6685; train_gene_expr_recon_loss: 5957542.1787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31755695.4742; train_optim_loss: 31755695.4742; val_kl_reg_loss: 113982.0852; val_edge_recon_loss: 25753460.8171; val_gene_expr_recon_loss: 6444372.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32311815.6220; val_optim_loss: 32311815.6220
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9864; val_auprc_score: 0.9811; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 187451.5587; train_edge_recon_loss: 25695380.2052; train_gene_expr_recon_loss: 5984283.0577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31867114.8519; train_optim_loss: 31867114.8519; val_kl_reg_loss: 115096.3162; val_edge_recon_loss: 25787801.8780; val_gene_expr_recon_loss: 6482047.8720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32384946.0732; val_optim_loss: 32384946.0732
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9872; val_auprc_score: 0.9822; val_best_acc_score: 0.9621; val_best_f1_score: 0.9630; train_kl_reg_loss: 196213.5996; train_edge_recon_loss: 25677684.4239; train_gene_expr_recon_loss: 6024330.3995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31898228.4334; train_optim_loss: 31898228.4334; val_kl_reg_loss: 116231.8192; val_edge_recon_loss: 25779628.6585; val_gene_expr_recon_loss: 6457756.0610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32353616.4634; val_optim_loss: 32353616.4634
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9869; val_auprc_score: 0.9815; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 117913.6247; train_edge_recon_loss: 25684192.2052; train_gene_expr_recon_loss: 5965344.0791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31767449.9348; train_optim_loss: 31767449.9348; val_kl_reg_loss: 113417.3568; val_edge_recon_loss: 25806495.5610; val_gene_expr_recon_loss: 6481901.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32401814.4390; val_optim_loss: 32401814.4390

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9874; val_auprc_score: 0.9824; val_best_acc_score: 0.9630; val_best_f1_score: 0.9639; train_kl_reg_loss: 118925.4563; train_edge_recon_loss: 25667004.9062; train_gene_expr_recon_loss: 5792508.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31578439.2147; train_optim_loss: 31578439.2147; val_kl_reg_loss: 122273.0280; val_edge_recon_loss: 25751125.0122; val_gene_expr_recon_loss: 6350232.5976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32223630.6098; val_optim_loss: 32223630.6098
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9879; val_auprc_score: 0.9835; val_best_acc_score: 0.9637; val_best_f1_score: 0.9646; train_kl_reg_loss: 123239.6428; train_edge_recon_loss: 25642029.5435; train_gene_expr_recon_loss: 5744430.9708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31509700.1821; train_optim_loss: 31509700.1821; val_kl_reg_loss: 125782.3895; val_edge_recon_loss: 25699223.7561; val_gene_expr_recon_loss: 6304191.1128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32129197.3415; val_optim_loss: 32129197.3415
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9873; val_auprc_score: 0.9823; val_best_acc_score: 0.9632; val_best_f1_score: 0.9641; train_kl_reg_loss: 126456.0556; train_edge_recon_loss: 25640929.5054; train_gene_expr_recon_loss: 5708612.4412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31475997.9823; train_optim_loss: 31475997.9823; val_kl_reg_loss: 126444.8782; val_edge_recon_loss: 25728464.3537; val_gene_expr_recon_loss: 6338563.2348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32193472.4146; val_optim_loss: 32193472.4146
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9874; val_auprc_score: 0.9824; val_best_acc_score: 0.9631; val_best_f1_score: 0.9640; train_kl_reg_loss: 126712.6951; train_edge_recon_loss: 25641749.6236; train_gene_expr_recon_loss: 5690042.5513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31458504.9185; train_optim_loss: 31458504.9185; val_kl_reg_loss: 127445.5109; val_edge_recon_loss: 25743184.2805; val_gene_expr_recon_loss: 6333006.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32203636.1829; val_optim_loss: 32203636.1829
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9880; val_auprc_score: 0.9834; val_best_acc_score: 0.9633; val_best_f1_score: 0.9641; train_kl_reg_loss: 127104.6149; train_edge_recon_loss: 25650708.7174; train_gene_expr_recon_loss: 5668844.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31446658.0679; train_optim_loss: 31446658.0679; val_kl_reg_loss: 128126.2272; val_edge_recon_loss: 25713823.6220; val_gene_expr_recon_loss: 6296242.0396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32138191.8902; val_optim_loss: 32138191.8902
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9880; val_auprc_score: 0.9831; val_best_acc_score: 0.9638; val_best_f1_score: 0.9647; train_kl_reg_loss: 127689.4061; train_edge_recon_loss: 25653910.5353; train_gene_expr_recon_loss: 5648080.9759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31429680.9171; train_optim_loss: 31429680.9171; val_kl_reg_loss: 128415.7865; val_edge_recon_loss: 25713561.4268; val_gene_expr_recon_loss: 6314098.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32156075.4756; val_optim_loss: 32156075.4756

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9876; val_auprc_score: 0.9827; val_best_acc_score: 0.9629; val_best_f1_score: 0.9639; train_kl_reg_loss: 128036.5455; train_edge_recon_loss: 25644954.9171; train_gene_expr_recon_loss: 5623212.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31396203.7432; train_optim_loss: 31396203.7432; val_kl_reg_loss: 128743.9899; val_edge_recon_loss: 25728731.3902; val_gene_expr_recon_loss: 6290444.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32147920.1341; val_optim_loss: 32147920.1341
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9874; val_auprc_score: 0.9828; val_best_acc_score: 0.9627; val_best_f1_score: 0.9635; train_kl_reg_loss: 128047.4479; train_edge_recon_loss: 25648593.0666; train_gene_expr_recon_loss: 5621640.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31398280.4837; train_optim_loss: 31398280.4837; val_kl_reg_loss: 128334.3093; val_edge_recon_loss: 25729247.8537; val_gene_expr_recon_loss: 6287034.0610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32144616.2195; val_optim_loss: 32144616.2195
