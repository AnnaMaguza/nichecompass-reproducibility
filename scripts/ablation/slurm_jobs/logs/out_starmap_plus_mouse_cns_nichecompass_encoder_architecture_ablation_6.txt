None
Run timestamp: 26072023_082200_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '30.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9749; val_best_acc_score: 0.9492; val_best_f1_score: 0.9504; train_kl_reg_loss: 5685.3244; train_edge_recon_loss: 264101.9928; train_gene_expr_recon_loss: 13349.2897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283136.6074; train_optim_loss: 283136.6074; val_kl_reg_loss: 5688.0922; val_edge_recon_loss: 258011.3041; val_gene_expr_recon_loss: 12229.1886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275928.5848; val_optim_loss: 275928.5848
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9859; val_auprc_score: 0.9802; val_best_acc_score: 0.9607; val_best_f1_score: 0.9617; train_kl_reg_loss: 5689.6002; train_edge_recon_loss: 257927.2271; train_gene_expr_recon_loss: 11846.2459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275463.0735; train_optim_loss: 275463.0735; val_kl_reg_loss: 5807.8746; val_edge_recon_loss: 256676.6901; val_gene_expr_recon_loss: 11674.6743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274159.2386; val_optim_loss: 274159.2386
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9825; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 5673.4660; train_edge_recon_loss: 257333.1330; train_gene_expr_recon_loss: 11441.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274447.7999; train_optim_loss: 274447.7999; val_kl_reg_loss: 5678.0190; val_edge_recon_loss: 256524.0091; val_gene_expr_recon_loss: 11354.4520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273556.4792; val_optim_loss: 273556.4792
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9821; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 5667.3758; train_edge_recon_loss: 256946.0848; train_gene_expr_recon_loss: 11199.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273813.2976; train_optim_loss: 273813.2976; val_kl_reg_loss: 5626.4560; val_edge_recon_loss: 256431.3895; val_gene_expr_recon_loss: 11141.4770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273199.3216; val_optim_loss: 273199.3216
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9896; val_auprc_score: 0.9851; val_best_acc_score: 0.9684; val_best_f1_score: 0.9690; train_kl_reg_loss: 5663.6765; train_edge_recon_loss: 256653.6187; train_gene_expr_recon_loss: 11019.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273336.3119; train_optim_loss: 273336.3119; val_kl_reg_loss: 5671.2853; val_edge_recon_loss: 256037.4627; val_gene_expr_recon_loss: 10995.4051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272704.1538; val_optim_loss: 272704.1538
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9897; val_auprc_score: 0.9849; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 5660.8472; train_edge_recon_loss: 256564.6070; train_gene_expr_recon_loss: 10884.8624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273110.3164; train_optim_loss: 273110.3164; val_kl_reg_loss: 5723.5699; val_edge_recon_loss: 255755.9211; val_gene_expr_recon_loss: 10861.7680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272341.2595; val_optim_loss: 272341.2595
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9912; val_auprc_score: 0.9871; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 5669.0748; train_edge_recon_loss: 256406.4452; train_gene_expr_recon_loss: 10785.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272861.3571; train_optim_loss: 272861.3571; val_kl_reg_loss: 5604.5458; val_edge_recon_loss: 255696.8491; val_gene_expr_recon_loss: 10738.1502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272039.5440; val_optim_loss: 272039.5440
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9910; val_auprc_score: 0.9870; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 5667.4747; train_edge_recon_loss: 256340.7320; train_gene_expr_recon_loss: 10691.3553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272699.5622; train_optim_loss: 272699.5622; val_kl_reg_loss: 5717.4403; val_edge_recon_loss: 255963.3603; val_gene_expr_recon_loss: 10703.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272383.9785; val_optim_loss: 272383.9785
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9921; val_auprc_score: 0.9888; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 5674.3802; train_edge_recon_loss: 256284.5172; train_gene_expr_recon_loss: 10623.0073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272581.9047; train_optim_loss: 272581.9047; val_kl_reg_loss: 5578.0770; val_edge_recon_loss: 255760.4499; val_gene_expr_recon_loss: 10585.4073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271923.9343; val_optim_loss: 271923.9343
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9921; val_auprc_score: 0.9881; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 5676.4174; train_edge_recon_loss: 256077.0003; train_gene_expr_recon_loss: 10552.1461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272305.5640; train_optim_loss: 272305.5640; val_kl_reg_loss: 5599.1155; val_edge_recon_loss: 255741.8636; val_gene_expr_recon_loss: 10524.1650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271865.1442; val_optim_loss: 271865.1442
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9895; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 5680.4905; train_edge_recon_loss: 256131.1423; train_gene_expr_recon_loss: 10513.4513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272325.0841; train_optim_loss: 272325.0841; val_kl_reg_loss: 5710.6866; val_edge_recon_loss: 255459.2938; val_gene_expr_recon_loss: 10493.4334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271663.4129; val_optim_loss: 271663.4129
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9929; val_auprc_score: 0.9896; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 5686.3269; train_edge_recon_loss: 255922.5838; train_gene_expr_recon_loss: 10466.6799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272075.5902; train_optim_loss: 272075.5902; val_kl_reg_loss: 5715.0484; val_edge_recon_loss: 255312.0117; val_gene_expr_recon_loss: 10459.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271486.6921; val_optim_loss: 271486.6921
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9898; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 5689.9107; train_edge_recon_loss: 255866.0822; train_gene_expr_recon_loss: 10437.3543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271993.3470; train_optim_loss: 271993.3470; val_kl_reg_loss: 5674.1043; val_edge_recon_loss: 255196.7689; val_gene_expr_recon_loss: 10440.9908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271311.8641; val_optim_loss: 271311.8641
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9934; val_auprc_score: 0.9908; val_best_acc_score: 0.9763; val_best_f1_score: 0.9767; train_kl_reg_loss: 5694.4320; train_edge_recon_loss: 255755.9608; train_gene_expr_recon_loss: 10389.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271839.6731; train_optim_loss: 271839.6731; val_kl_reg_loss: 5748.2629; val_edge_recon_loss: 255196.6861; val_gene_expr_recon_loss: 10381.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271326.5753; val_optim_loss: 271326.5753
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9931; val_auprc_score: 0.9892; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 5701.4631; train_edge_recon_loss: 255711.7284; train_gene_expr_recon_loss: 10361.5370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271774.7284; train_optim_loss: 271774.7284; val_kl_reg_loss: 5769.7432; val_edge_recon_loss: 255097.5056; val_gene_expr_recon_loss: 10349.3491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271216.5976; val_optim_loss: 271216.5976
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9937; val_auprc_score: 0.9903; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5702.3457; train_edge_recon_loss: 255727.6847; train_gene_expr_recon_loss: 10336.8545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271766.8851; train_optim_loss: 271766.8851; val_kl_reg_loss: 5731.3673; val_edge_recon_loss: 255257.6593; val_gene_expr_recon_loss: 10331.1891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271320.2157; val_optim_loss: 271320.2157
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5703.8317; train_edge_recon_loss: 255702.6908; train_gene_expr_recon_loss: 10300.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271707.3827; train_optim_loss: 271707.3827; val_kl_reg_loss: 5770.7232; val_edge_recon_loss: 254973.8953; val_gene_expr_recon_loss: 10293.9569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271038.5751; val_optim_loss: 271038.5751
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9897; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 5710.9613; train_edge_recon_loss: 255512.3506; train_gene_expr_recon_loss: 10277.1519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271500.4636; train_optim_loss: 271500.4636; val_kl_reg_loss: 5788.5223; val_edge_recon_loss: 255432.8878; val_gene_expr_recon_loss: 10281.7842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271503.1942; val_optim_loss: 271503.1942
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9930; val_auprc_score: 0.9889; val_best_acc_score: 0.9780; val_best_f1_score: 0.9784; train_kl_reg_loss: 5714.3206; train_edge_recon_loss: 255604.8627; train_gene_expr_recon_loss: 10265.5522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271584.7355; train_optim_loss: 271584.7355; val_kl_reg_loss: 5692.4633; val_edge_recon_loss: 255158.0687; val_gene_expr_recon_loss: 10278.6767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271129.2088; val_optim_loss: 271129.2088
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9939; val_auprc_score: 0.9907; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5713.5229; train_edge_recon_loss: 255583.0944; train_gene_expr_recon_loss: 10231.7447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271528.3620; train_optim_loss: 271528.3620; val_kl_reg_loss: 5773.1650; val_edge_recon_loss: 254854.5725; val_gene_expr_recon_loss: 10232.3853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270860.1239; val_optim_loss: 270860.1239
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9936; val_auprc_score: 0.9898; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 5717.1617; train_edge_recon_loss: 255479.0995; train_gene_expr_recon_loss: 10221.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271417.8850; train_optim_loss: 271417.8850; val_kl_reg_loss: 5803.2252; val_edge_recon_loss: 254834.6583; val_gene_expr_recon_loss: 10244.5619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270882.4446; val_optim_loss: 270882.4446
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9935; val_auprc_score: 0.9899; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 5721.0877; train_edge_recon_loss: 255414.4215; train_gene_expr_recon_loss: 10201.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271336.5556; train_optim_loss: 271336.5556; val_kl_reg_loss: 5659.2132; val_edge_recon_loss: 255000.7926; val_gene_expr_recon_loss: 10189.9926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270849.9968; val_optim_loss: 270849.9968
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9942; val_auprc_score: 0.9915; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 5720.9857; train_edge_recon_loss: 255490.0016; train_gene_expr_recon_loss: 10184.1885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271395.1761; train_optim_loss: 271395.1761; val_kl_reg_loss: 5697.6922; val_edge_recon_loss: 255000.0741; val_gene_expr_recon_loss: 10191.9965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270889.7607; val_optim_loss: 270889.7607
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9942; val_auprc_score: 0.9916; val_best_acc_score: 0.9802; val_best_f1_score: 0.9805; train_kl_reg_loss: 5728.2393; train_edge_recon_loss: 255394.4480; train_gene_expr_recon_loss: 10156.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271279.0243; train_optim_loss: 271279.0243; val_kl_reg_loss: 5819.8018; val_edge_recon_loss: 254966.2281; val_gene_expr_recon_loss: 10194.2785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270980.3081; val_optim_loss: 270980.3081
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9944; val_auprc_score: 0.9912; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5731.0456; train_edge_recon_loss: 255284.3776; train_gene_expr_recon_loss: 10142.1394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271157.5632; train_optim_loss: 271157.5632; val_kl_reg_loss: 5753.6374; val_edge_recon_loss: 254832.6401; val_gene_expr_recon_loss: 10175.6323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270761.9101; val_optim_loss: 270761.9101
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9919; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5731.3158; train_edge_recon_loss: 255300.7445; train_gene_expr_recon_loss: 10138.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271170.7425; train_optim_loss: 271170.7425; val_kl_reg_loss: 5673.1494; val_edge_recon_loss: 254641.2406; val_gene_expr_recon_loss: 10126.6838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270441.0739; val_optim_loss: 270441.0739
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9948; val_auprc_score: 0.9923; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5732.9201; train_edge_recon_loss: 255336.8251; train_gene_expr_recon_loss: 10116.7033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271186.4482; train_optim_loss: 271186.4482; val_kl_reg_loss: 5802.8414; val_edge_recon_loss: 254611.5492; val_gene_expr_recon_loss: 10122.9218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270537.3127; val_optim_loss: 270537.3127
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9941; val_auprc_score: 0.9907; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 5736.8777; train_edge_recon_loss: 255282.1900; train_gene_expr_recon_loss: 10102.4526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271121.5206; train_optim_loss: 271121.5206; val_kl_reg_loss: 5691.1512; val_edge_recon_loss: 254708.0951; val_gene_expr_recon_loss: 10109.1215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270508.3676; val_optim_loss: 270508.3676
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9946; val_auprc_score: 0.9915; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5737.8529; train_edge_recon_loss: 255305.9501; train_gene_expr_recon_loss: 10083.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271126.8763; train_optim_loss: 271126.8763; val_kl_reg_loss: 5779.9563; val_edge_recon_loss: 254628.6084; val_gene_expr_recon_loss: 10098.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270506.9602; val_optim_loss: 270506.9602
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9943; val_auprc_score: 0.9910; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5740.2132; train_edge_recon_loss: 255239.4689; train_gene_expr_recon_loss: 10082.4499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271062.1315; train_optim_loss: 271062.1315; val_kl_reg_loss: 5654.4706; val_edge_recon_loss: 254845.1530; val_gene_expr_recon_loss: 10083.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270583.3542; val_optim_loss: 270583.3542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9953; val_auprc_score: 0.9929; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5719.9803; train_edge_recon_loss: 255152.7877; train_gene_expr_recon_loss: 10014.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270887.3702; train_optim_loss: 270887.3702; val_kl_reg_loss: 5759.2203; val_edge_recon_loss: 254412.5530; val_gene_expr_recon_loss: 10055.5306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270227.3049; val_optim_loss: 270227.3049
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9948; val_auprc_score: 0.9914; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 5714.5866; train_edge_recon_loss: 255086.9895; train_gene_expr_recon_loss: 10000.7028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270802.2791; train_optim_loss: 270802.2791; val_kl_reg_loss: 5729.8045; val_edge_recon_loss: 254389.8348; val_gene_expr_recon_loss: 10032.6369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270152.2753; val_optim_loss: 270152.2753
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9951; val_auprc_score: 0.9923; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5711.8280; train_edge_recon_loss: 255135.4604; train_gene_expr_recon_loss: 9992.5932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270839.8817; train_optim_loss: 270839.8817; val_kl_reg_loss: 5747.4979; val_edge_recon_loss: 254413.3867; val_gene_expr_recon_loss: 10013.3387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270174.2212; val_optim_loss: 270174.2212
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9949; val_auprc_score: 0.9921; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5712.2982; train_edge_recon_loss: 255070.7359; train_gene_expr_recon_loss: 9982.1119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270765.1462; train_optim_loss: 270765.1462; val_kl_reg_loss: 5750.8513; val_edge_recon_loss: 254541.0265; val_gene_expr_recon_loss: 10028.9448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270320.8234; val_optim_loss: 270320.8234
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9951; val_auprc_score: 0.9927; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 5709.9526; train_edge_recon_loss: 255014.0531; train_gene_expr_recon_loss: 9977.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270701.7241; train_optim_loss: 270701.7241; val_kl_reg_loss: 5745.2267; val_edge_recon_loss: 254360.7692; val_gene_expr_recon_loss: 10012.7064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270118.7024; val_optim_loss: 270118.7024
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9952; val_auprc_score: 0.9925; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 5709.9194; train_edge_recon_loss: 255012.4528; train_gene_expr_recon_loss: 9966.6013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270688.9738; train_optim_loss: 270688.9738; val_kl_reg_loss: 5735.9823; val_edge_recon_loss: 254279.8471; val_gene_expr_recon_loss: 10035.1003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270050.9291; val_optim_loss: 270050.9291
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9949; val_auprc_score: 0.9918; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 5706.4280; train_edge_recon_loss: 254999.5730; train_gene_expr_recon_loss: 9969.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270675.2438; train_optim_loss: 270675.2438; val_kl_reg_loss: 5750.4683; val_edge_recon_loss: 254296.2750; val_gene_expr_recon_loss: 10021.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270068.3495; val_optim_loss: 270068.3495
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9956; val_auprc_score: 0.9936; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 5704.7589; train_edge_recon_loss: 255063.3518; train_gene_expr_recon_loss: 9967.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270735.4964; train_optim_loss: 270735.4964; val_kl_reg_loss: 5713.8791; val_edge_recon_loss: 254074.5496; val_gene_expr_recon_loss: 10009.2999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269797.7290; val_optim_loss: 269797.7290
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9949; val_auprc_score: 0.9920; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 5704.9747; train_edge_recon_loss: 254988.8207; train_gene_expr_recon_loss: 9957.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270650.9749; train_optim_loss: 270650.9749; val_kl_reg_loss: 5741.9630; val_edge_recon_loss: 254392.2686; val_gene_expr_recon_loss: 9998.5978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270132.8293; val_optim_loss: 270132.8293
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9956; val_auprc_score: 0.9926; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 5707.7114; train_edge_recon_loss: 254908.1778; train_gene_expr_recon_loss: 9957.5475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270573.4364; train_optim_loss: 270573.4364; val_kl_reg_loss: 5729.1759; val_edge_recon_loss: 254089.7935; val_gene_expr_recon_loss: 10009.1020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269828.0720; val_optim_loss: 269828.0720
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9953; val_auprc_score: 0.9927; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 5704.4853; train_edge_recon_loss: 254998.5488; train_gene_expr_recon_loss: 9957.0978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270660.1322; train_optim_loss: 270660.1322; val_kl_reg_loss: 5763.2030; val_edge_recon_loss: 254176.6522; val_gene_expr_recon_loss: 9999.0545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269938.9089; val_optim_loss: 269938.9089
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9953; val_auprc_score: 0.9931; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 5702.1461; train_edge_recon_loss: 254976.5640; train_gene_expr_recon_loss: 9954.4564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270633.1662; train_optim_loss: 270633.1662; val_kl_reg_loss: 5758.5070; val_edge_recon_loss: 254390.8262; val_gene_expr_recon_loss: 9993.0177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270142.3519; val_optim_loss: 270142.3519

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9952; val_auprc_score: 0.9929; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 5698.8337; train_edge_recon_loss: 255053.9326; train_gene_expr_recon_loss: 9937.4777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270690.2443; train_optim_loss: 270690.2443; val_kl_reg_loss: 5726.5953; val_edge_recon_loss: 254374.5685; val_gene_expr_recon_loss: 9946.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270047.8765; val_optim_loss: 270047.8765
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9954; val_auprc_score: 0.9931; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 5699.4628; train_edge_recon_loss: 254992.3458; train_gene_expr_recon_loss: 9942.0107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270633.8188; train_optim_loss: 270633.8188; val_kl_reg_loss: 5729.7138; val_edge_recon_loss: 254001.4962; val_gene_expr_recon_loss: 9989.0146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269720.2239; val_optim_loss: 269720.2239
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9951; val_auprc_score: 0.9923; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 5701.4072; train_edge_recon_loss: 254981.2251; train_gene_expr_recon_loss: 9939.0510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270621.6833; train_optim_loss: 270621.6833; val_kl_reg_loss: 5730.8944; val_edge_recon_loss: 254126.3532; val_gene_expr_recon_loss: 9973.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269831.0360; val_optim_loss: 269831.0360
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9952; val_auprc_score: 0.9926; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 5701.6107; train_edge_recon_loss: 254911.0053; train_gene_expr_recon_loss: 9942.9128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270555.5291; train_optim_loss: 270555.5291; val_kl_reg_loss: 5738.7755; val_edge_recon_loss: 254459.8148; val_gene_expr_recon_loss: 9977.1852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270175.7772; val_optim_loss: 270175.7772
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9950; val_auprc_score: 0.9919; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 5703.3304; train_edge_recon_loss: 254925.2594; train_gene_expr_recon_loss: 9946.5463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270575.1364; train_optim_loss: 270575.1364; val_kl_reg_loss: 5739.7453; val_edge_recon_loss: 254391.0910; val_gene_expr_recon_loss: 9970.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270101.2262; val_optim_loss: 270101.2262
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9950; val_auprc_score: 0.9923; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 5700.2540; train_edge_recon_loss: 254930.5882; train_gene_expr_recon_loss: 9939.7884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270570.6305; train_optim_loss: 270570.6305; val_kl_reg_loss: 5735.2677; val_edge_recon_loss: 254314.5817; val_gene_expr_recon_loss: 9969.0554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270018.9045; val_optim_loss: 270018.9045

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9956; val_auprc_score: 0.9934; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 5700.2186; train_edge_recon_loss: 255042.5653; train_gene_expr_recon_loss: 9936.6190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270679.4031; train_optim_loss: 270679.4031; val_kl_reg_loss: 5733.6538; val_edge_recon_loss: 254044.0500; val_gene_expr_recon_loss: 9988.6361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269766.3397; val_optim_loss: 269766.3397
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9952; val_auprc_score: 0.9927; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 5700.7441; train_edge_recon_loss: 254854.0992; train_gene_expr_recon_loss: 9946.0802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270500.9239; train_optim_loss: 270500.9239; val_kl_reg_loss: 5737.1297; val_edge_recon_loss: 254193.7161; val_gene_expr_recon_loss: 9968.3410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269899.1864; val_optim_loss: 269899.1864
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9955; val_auprc_score: 0.9933; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 5701.2283; train_edge_recon_loss: 254939.8009; train_gene_expr_recon_loss: 9934.3155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270575.3446; train_optim_loss: 270575.3446; val_kl_reg_loss: 5735.5687; val_edge_recon_loss: 254047.8067; val_gene_expr_recon_loss: 9964.9918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269748.3679; val_optim_loss: 269748.3679
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9950; val_auprc_score: 0.9924; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 5701.5178; train_edge_recon_loss: 254946.6889; train_gene_expr_recon_loss: 9930.4064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270578.6126; train_optim_loss: 270578.6126; val_kl_reg_loss: 5734.8582; val_edge_recon_loss: 254517.3881; val_gene_expr_recon_loss: 9966.8795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270219.1256; val_optim_loss: 270219.1256

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 507 min 22 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9948
Val AUPRC score: 0.9919
Val best accuracy score: 0.9831
Val best F1 score: 0.9832
Val gene expr MSE score: 0.5611

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
