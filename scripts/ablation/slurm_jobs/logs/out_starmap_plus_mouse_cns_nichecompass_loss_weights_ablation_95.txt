None
Run timestamp: 08082023_220858_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9760; val_auprc_score: 0.9700; val_best_acc_score: 0.9298; val_best_f1_score: 0.9316; train_kl_reg_loss: 74847.2357; train_edge_recon_loss: 3030407.7730; train_gene_expr_recon_loss: 20330222.5294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 23435477.5404; train_optim_loss: 23435477.5404; val_kl_reg_loss: 70512.9576; val_edge_recon_loss: 2745031.4508; val_gene_expr_recon_loss: 18731344.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 21546888.7541; val_optim_loss: 21546888.7541
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9853; val_auprc_score: 0.9807; val_best_acc_score: 0.9513; val_best_f1_score: 0.9523; train_kl_reg_loss: 67121.4253; train_edge_recon_loss: 2688697.0097; train_gene_expr_recon_loss: 18418079.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 21173898.1875; train_optim_loss: 21173898.1875; val_kl_reg_loss: 61288.2462; val_edge_recon_loss: 2671655.2172; val_gene_expr_recon_loss: 17901939.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20634882.9180; val_optim_loss: 20634882.9180
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9872; val_auprc_score: 0.9838; val_best_acc_score: 0.9542; val_best_f1_score: 0.9552; train_kl_reg_loss: 57918.1170; train_edge_recon_loss: 2654014.8980; train_gene_expr_recon_loss: 17778802.3088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20490735.3125; train_optim_loss: 20490735.3125; val_kl_reg_loss: 53944.5164; val_edge_recon_loss: 2655980.5451; val_gene_expr_recon_loss: 17420018.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 20129944.0328; val_optim_loss: 20129944.0328
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9884; val_auprc_score: 0.9850; val_best_acc_score: 0.9581; val_best_f1_score: 0.9589; train_kl_reg_loss: 50902.2193; train_edge_recon_loss: 2639941.5643; train_gene_expr_recon_loss: 17385671.8051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20076515.6066; train_optim_loss: 20076515.6066; val_kl_reg_loss: 47367.7797; val_edge_recon_loss: 2638615.8893; val_gene_expr_recon_loss: 17176554.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19862538.3607; val_optim_loss: 19862538.3607
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9895; val_auprc_score: 0.9867; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 46037.2019; train_edge_recon_loss: 2630457.6852; train_gene_expr_recon_loss: 17134989.1489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19811484.0588; train_optim_loss: 19811484.0588; val_kl_reg_loss: 43302.0620; val_edge_recon_loss: 2634644.3238; val_gene_expr_recon_loss: 16946027.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19623974.3279; val_optim_loss: 19623974.3279
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9879; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 42506.5135; train_edge_recon_loss: 2622113.1811; train_gene_expr_recon_loss: 16943102.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19607722.2096; train_optim_loss: 19607722.2096; val_kl_reg_loss: 39771.5641; val_edge_recon_loss: 2628198.8770; val_gene_expr_recon_loss: 16830884.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19498855.0164; val_optim_loss: 19498855.0164
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 39994.0524; train_edge_recon_loss: 2617868.2431; train_gene_expr_recon_loss: 16797192.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19455055.1838; train_optim_loss: 19455055.1838; val_kl_reg_loss: 38710.8941; val_edge_recon_loss: 2620153.7213; val_gene_expr_recon_loss: 16719713.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19378578.4590; val_optim_loss: 19378578.4590
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9912; val_auprc_score: 0.9888; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 38169.8658; train_edge_recon_loss: 2614280.4504; train_gene_expr_recon_loss: 16681387.7592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19333838.0993; train_optim_loss: 19333838.0993; val_kl_reg_loss: 37417.9415; val_edge_recon_loss: 2614234.1680; val_gene_expr_recon_loss: 16602331.5574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19253983.7049; val_optim_loss: 19253983.7049
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9647; val_best_f1_score: 0.9653; train_kl_reg_loss: 36748.1725; train_edge_recon_loss: 2609931.4315; train_gene_expr_recon_loss: 16584377.1103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19231056.7022; train_optim_loss: 19231056.7022; val_kl_reg_loss: 35906.6256; val_edge_recon_loss: 2613773.3115; val_gene_expr_recon_loss: 16566461.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19216141.1475; val_optim_loss: 19216141.1475
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9912; val_auprc_score: 0.9887; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 35651.0444; train_edge_recon_loss: 2606382.0584; train_gene_expr_recon_loss: 16528700.7353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19170733.8493; train_optim_loss: 19170733.8493; val_kl_reg_loss: 34958.2168; val_edge_recon_loss: 2612248.4098; val_gene_expr_recon_loss: 16531391.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19178598.4590; val_optim_loss: 19178598.4590
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9915; val_auprc_score: 0.9898; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 34791.3700; train_edge_recon_loss: 2603477.0625; train_gene_expr_recon_loss: 16452081.9982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19090350.3897; train_optim_loss: 19090350.3897; val_kl_reg_loss: 33672.7243; val_edge_recon_loss: 2612677.0574; val_gene_expr_recon_loss: 16491185.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19137535.0820; val_optim_loss: 19137535.0820
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9919; val_auprc_score: 0.9900; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 34045.8484; train_edge_recon_loss: 2603105.4246; train_gene_expr_recon_loss: 16411598.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19048750.0919; train_optim_loss: 19048750.0919; val_kl_reg_loss: 33474.5568; val_edge_recon_loss: 2611059.6393; val_gene_expr_recon_loss: 16476786.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19121320.3607; val_optim_loss: 19121320.3607
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 33399.5305; train_edge_recon_loss: 2601756.2174; train_gene_expr_recon_loss: 16363979.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18999135.4228; train_optim_loss: 18999135.4228; val_kl_reg_loss: 32617.4614; val_edge_recon_loss: 2610375.8074; val_gene_expr_recon_loss: 16483144.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19126137.9672; val_optim_loss: 19126137.9672
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9921; val_auprc_score: 0.9905; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 32948.7732; train_edge_recon_loss: 2599682.0363; train_gene_expr_recon_loss: 16331439.0974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18964069.8897; train_optim_loss: 18964069.8897; val_kl_reg_loss: 32399.9532; val_edge_recon_loss: 2605913.2541; val_gene_expr_recon_loss: 16431564.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19069877.4754; val_optim_loss: 19069877.4754
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 32420.3970; train_edge_recon_loss: 2598827.7142; train_gene_expr_recon_loss: 16298718.5790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18929966.7243; train_optim_loss: 18929966.7243; val_kl_reg_loss: 31974.6952; val_edge_recon_loss: 2603746.5410; val_gene_expr_recon_loss: 16459197.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19094918.2951; val_optim_loss: 19094918.2951
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9923; val_auprc_score: 0.9905; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 32053.8683; train_edge_recon_loss: 2597982.6268; train_gene_expr_recon_loss: 16271069.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18901106.4154; train_optim_loss: 18901106.4154; val_kl_reg_loss: 31674.8231; val_edge_recon_loss: 2603669.8852; val_gene_expr_recon_loss: 16431482.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19066826.9180; val_optim_loss: 19066826.9180
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9923; val_auprc_score: 0.9907; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 31701.1522; train_edge_recon_loss: 2596786.0717; train_gene_expr_recon_loss: 16239438.2886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18867925.5404; train_optim_loss: 18867925.5404; val_kl_reg_loss: 31319.3141; val_edge_recon_loss: 2604520.4631; val_gene_expr_recon_loss: 16403630.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19039470.0984; val_optim_loss: 19039470.0984
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 31416.8183; train_edge_recon_loss: 2595665.9182; train_gene_expr_recon_loss: 16224354.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18851437.6838; train_optim_loss: 18851437.6838; val_kl_reg_loss: 31123.3433; val_edge_recon_loss: 2604411.0369; val_gene_expr_recon_loss: 16448504.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19084038.8197; val_optim_loss: 19084038.8197
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 31208.7105; train_edge_recon_loss: 2595271.7606; train_gene_expr_recon_loss: 16204061.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18830541.4669; train_optim_loss: 18830541.4669; val_kl_reg_loss: 31006.2699; val_edge_recon_loss: 2602735.8197; val_gene_expr_recon_loss: 16392710.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19026452.9180; val_optim_loss: 19026452.9180
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 30998.1480; train_edge_recon_loss: 2593618.0611; train_gene_expr_recon_loss: 16191013.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18815629.8676; train_optim_loss: 18815629.8676; val_kl_reg_loss: 30629.4860; val_edge_recon_loss: 2605317.6680; val_gene_expr_recon_loss: 16447012.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19082959.5410; val_optim_loss: 19082959.5410
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 30781.2322; train_edge_recon_loss: 2594197.3001; train_gene_expr_recon_loss: 16171967.7978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18796946.3088; train_optim_loss: 18796946.3088; val_kl_reg_loss: 30451.1638; val_edge_recon_loss: 2604309.2828; val_gene_expr_recon_loss: 16460824.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19095585.1148; val_optim_loss: 19095585.1148
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 30554.0198; train_edge_recon_loss: 2593467.4108; train_gene_expr_recon_loss: 16157146.1783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18781167.5956; train_optim_loss: 18781167.5956; val_kl_reg_loss: 30232.4757; val_edge_recon_loss: 2600978.1393; val_gene_expr_recon_loss: 16437677.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19068888.0000; val_optim_loss: 19068888.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 30357.8366; train_edge_recon_loss: 2593280.6990; train_gene_expr_recon_loss: 16143383.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18767022.2941; train_optim_loss: 18767022.2941; val_kl_reg_loss: 30210.8570; val_edge_recon_loss: 2600911.0287; val_gene_expr_recon_loss: 16446869.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19077991.5738; val_optim_loss: 19077991.5738

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9675; val_best_f1_score: 0.9682; train_kl_reg_loss: 30969.0797; train_edge_recon_loss: 2590979.8015; train_gene_expr_recon_loss: 16052961.0993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18674909.9853; train_optim_loss: 18674909.9853; val_kl_reg_loss: 30485.8132; val_edge_recon_loss: 2598288.8975; val_gene_expr_recon_loss: 16414583.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19043357.8033; val_optim_loss: 19043357.8033
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9925; val_auprc_score: 0.9905; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 30890.5714; train_edge_recon_loss: 2589705.5446; train_gene_expr_recon_loss: 16045240.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18665836.3695; train_optim_loss: 18665836.3695; val_kl_reg_loss: 30409.6074; val_edge_recon_loss: 2600147.2254; val_gene_expr_recon_loss: 16395112.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19025669.6721; val_optim_loss: 19025669.6721
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 30897.6874; train_edge_recon_loss: 2591003.0423; train_gene_expr_recon_loss: 16042160.0147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18664060.6912; train_optim_loss: 18664060.6912; val_kl_reg_loss: 30364.0504; val_edge_recon_loss: 2597460.4467; val_gene_expr_recon_loss: 16404221.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19032046.2951; val_optim_loss: 19032046.2951
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 30911.8791; train_edge_recon_loss: 2590654.9412; train_gene_expr_recon_loss: 16038091.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18659658.5515; train_optim_loss: 18659658.5515; val_kl_reg_loss: 30419.3441; val_edge_recon_loss: 2595493.0533; val_gene_expr_recon_loss: 16455588.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19081500.5246; val_optim_loss: 19081500.5246
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9670; val_best_f1_score: 0.9677; train_kl_reg_loss: 30907.7494; train_edge_recon_loss: 2590035.5579; train_gene_expr_recon_loss: 16041419.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18662362.7721; train_optim_loss: 18662362.7721; val_kl_reg_loss: 30484.4468; val_edge_recon_loss: 2595672.9303; val_gene_expr_recon_loss: 16418225.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19044382.3934; val_optim_loss: 19044382.3934
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 30911.3190; train_edge_recon_loss: 2588696.8415; train_gene_expr_recon_loss: 16040998.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18660606.4559; train_optim_loss: 18660606.4559; val_kl_reg_loss: 30429.6155; val_edge_recon_loss: 2601196.1557; val_gene_expr_recon_loss: 16439417.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19071042.7213; val_optim_loss: 19071042.7213

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 30925.1850; train_edge_recon_loss: 2589057.7031; train_gene_expr_recon_loss: 16034009.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18653992.5441; train_optim_loss: 18653992.5441; val_kl_reg_loss: 30489.8236; val_edge_recon_loss: 2595231.8811; val_gene_expr_recon_loss: 16391629.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19017351.2787; val_optim_loss: 19017351.2787
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 30963.0549; train_edge_recon_loss: 2588462.9196; train_gene_expr_recon_loss: 16018011.3713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18637437.3548; train_optim_loss: 18637437.3548; val_kl_reg_loss: 30512.6290; val_edge_recon_loss: 2601147.2705; val_gene_expr_recon_loss: 16407301.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19038961.2131; val_optim_loss: 19038961.2131
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 30975.3666; train_edge_recon_loss: 2588705.4903; train_gene_expr_recon_loss: 16014210.4853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18633891.3272; train_optim_loss: 18633891.3272; val_kl_reg_loss: 30530.0464; val_edge_recon_loss: 2600108.0574; val_gene_expr_recon_loss: 16444726.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19075364.5246; val_optim_loss: 19075364.5246
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 30962.6397; train_edge_recon_loss: 2589477.1029; train_gene_expr_recon_loss: 16027199.2831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18647639.0515; train_optim_loss: 18647639.0515; val_kl_reg_loss: 30532.9518; val_edge_recon_loss: 2597982.6189; val_gene_expr_recon_loss: 16400430.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19028946.1967; val_optim_loss: 19028946.1967
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 30965.8889; train_edge_recon_loss: 2589508.5781; train_gene_expr_recon_loss: 16014103.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18634577.4890; train_optim_loss: 18634577.4890; val_kl_reg_loss: 30490.9522; val_edge_recon_loss: 2598940.3934; val_gene_expr_recon_loss: 16440140.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19069572.0656; val_optim_loss: 19069572.0656

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 30946.9872; train_edge_recon_loss: 2588997.2008; train_gene_expr_recon_loss: 16041555.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18661499.3640; train_optim_loss: 18661499.3640; val_kl_reg_loss: 30485.4930; val_edge_recon_loss: 2597448.2869; val_gene_expr_recon_loss: 16415101.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19043035.6721; val_optim_loss: 19043035.6721
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 30953.2058; train_edge_recon_loss: 2586947.0188; train_gene_expr_recon_loss: 16027472.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18645372.9338; train_optim_loss: 18645372.9338; val_kl_reg_loss: 30512.2879; val_edge_recon_loss: 2596200.0984; val_gene_expr_recon_loss: 16432241.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19058953.4098; val_optim_loss: 19058953.4098
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9926; val_auprc_score: 0.9912; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 30955.2083; train_edge_recon_loss: 2588368.2767; train_gene_expr_recon_loss: 16022004.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18641327.8897; train_optim_loss: 18641327.8897; val_kl_reg_loss: 30471.6815; val_edge_recon_loss: 2599649.3852; val_gene_expr_recon_loss: 16416108.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19046229.4098; val_optim_loss: 19046229.4098
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 30953.9165; train_edge_recon_loss: 2589104.4416; train_gene_expr_recon_loss: 16021835.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18641893.9191; train_optim_loss: 18641893.9191; val_kl_reg_loss: 30520.0389; val_edge_recon_loss: 2595549.7049; val_gene_expr_recon_loss: 16435367.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19061436.8852; val_optim_loss: 19061436.8852

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 178 min 37 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9927
val AUPRC score: 0.9913
val best accuracy score: 0.9675
val best F1 score: 0.9682
val target rna MSE score: 0.6196
val source rna MSE score: 0.0353

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
