None
Run timestamp: 01072023_204411_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9753; val_auprc_score: 0.9704; val_best_acc_score: 0.9250; val_best_f1_score: 0.9273; train_kl_reg_loss: 2166.5919; train_edge_recon_loss: 27859.1905; train_gene_expr_recon_loss: 8074.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38100.1920; train_optim_loss: 38100.1920; val_kl_reg_loss: 2281.1812; val_edge_recon_loss: 26586.8237; val_gene_expr_recon_loss: 7288.3334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36156.3383; val_optim_loss: 36156.3383
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9800; val_auprc_score: 0.9756; val_best_acc_score: 0.9362; val_best_f1_score: 0.9379; train_kl_reg_loss: 2297.8912; train_edge_recon_loss: 27351.5976; train_gene_expr_recon_loss: 7165.6159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36815.1047; train_optim_loss: 36815.1047; val_kl_reg_loss: 2263.4452; val_edge_recon_loss: 26506.1699; val_gene_expr_recon_loss: 6921.2978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35690.9129; val_optim_loss: 35690.9129
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9823; val_auprc_score: 0.9785; val_best_acc_score: 0.9408; val_best_f1_score: 0.9424; train_kl_reg_loss: 2333.1449; train_edge_recon_loss: 27270.7631; train_gene_expr_recon_loss: 6931.9850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36535.8931; train_optim_loss: 36535.8931; val_kl_reg_loss: 2374.2583; val_edge_recon_loss: 26478.8910; val_gene_expr_recon_loss: 6762.7112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35615.8606; val_optim_loss: 35615.8606
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9828; val_best_acc_score: 0.9478; val_best_f1_score: 0.9490; train_kl_reg_loss: 2356.8970; train_edge_recon_loss: 27227.1366; train_gene_expr_recon_loss: 6809.2415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36393.2751; train_optim_loss: 36393.2751; val_kl_reg_loss: 2342.1415; val_edge_recon_loss: 26384.5877; val_gene_expr_recon_loss: 6667.2486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35393.9778; val_optim_loss: 35393.9778
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9877; val_auprc_score: 0.9853; val_best_acc_score: 0.9507; val_best_f1_score: 0.9516; train_kl_reg_loss: 2377.8379; train_edge_recon_loss: 27178.9404; train_gene_expr_recon_loss: 6736.4837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36293.2620; train_optim_loss: 36293.2620; val_kl_reg_loss: 2328.0184; val_edge_recon_loss: 26377.2815; val_gene_expr_recon_loss: 6614.1044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35319.4043; val_optim_loss: 35319.4043
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9879; val_auprc_score: 0.9856; val_best_acc_score: 0.9524; val_best_f1_score: 0.9532; train_kl_reg_loss: 2390.3794; train_edge_recon_loss: 27152.9742; train_gene_expr_recon_loss: 6684.1231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36227.4767; train_optim_loss: 36227.4767; val_kl_reg_loss: 2349.9755; val_edge_recon_loss: 26329.9635; val_gene_expr_recon_loss: 6574.4471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35254.3861; val_optim_loss: 35254.3861
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9891; val_auprc_score: 0.9870; val_best_acc_score: 0.9549; val_best_f1_score: 0.9558; train_kl_reg_loss: 2401.8211; train_edge_recon_loss: 27130.2209; train_gene_expr_recon_loss: 6651.6550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36183.6970; train_optim_loss: 36183.6970; val_kl_reg_loss: 2374.9824; val_edge_recon_loss: 26320.6571; val_gene_expr_recon_loss: 6539.4501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35235.0897; val_optim_loss: 35235.0897
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9894; val_auprc_score: 0.9873; val_best_acc_score: 0.9558; val_best_f1_score: 0.9564; train_kl_reg_loss: 2408.8353; train_edge_recon_loss: 27120.6233; train_gene_expr_recon_loss: 6628.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36158.3280; train_optim_loss: 36158.3280; val_kl_reg_loss: 2431.3534; val_edge_recon_loss: 26336.5589; val_gene_expr_recon_loss: 6539.0558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35306.9680; val_optim_loss: 35306.9680
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9897; val_auprc_score: 0.9876; val_best_acc_score: 0.9564; val_best_f1_score: 0.9572; train_kl_reg_loss: 2416.1327; train_edge_recon_loss: 27098.6128; train_gene_expr_recon_loss: 6609.5023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36124.2478; train_optim_loss: 36124.2478; val_kl_reg_loss: 2355.3456; val_edge_recon_loss: 26280.0993; val_gene_expr_recon_loss: 6511.8374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35147.2823; val_optim_loss: 35147.2823
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9894; val_auprc_score: 0.9871; val_best_acc_score: 0.9562; val_best_f1_score: 0.9571; train_kl_reg_loss: 2419.6869; train_edge_recon_loss: 27095.4033; train_gene_expr_recon_loss: 6598.0166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36113.1069; train_optim_loss: 36113.1069; val_kl_reg_loss: 2419.8267; val_edge_recon_loss: 26268.0333; val_gene_expr_recon_loss: 6503.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35190.9253; val_optim_loss: 35190.9253
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9902; val_auprc_score: 0.9883; val_best_acc_score: 0.9575; val_best_f1_score: 0.9581; train_kl_reg_loss: 2422.2579; train_edge_recon_loss: 27089.2435; train_gene_expr_recon_loss: 6585.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36097.1008; train_optim_loss: 36097.1008; val_kl_reg_loss: 2380.6866; val_edge_recon_loss: 26284.2080; val_gene_expr_recon_loss: 6484.3002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149.1947; val_optim_loss: 35149.1947
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9885; val_best_acc_score: 0.9591; val_best_f1_score: 0.9597; train_kl_reg_loss: 2425.0946; train_edge_recon_loss: 27083.6168; train_gene_expr_recon_loss: 6574.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36083.3386; train_optim_loss: 36083.3386; val_kl_reg_loss: 2395.7498; val_edge_recon_loss: 26241.5538; val_gene_expr_recon_loss: 6478.8504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35116.1539; val_optim_loss: 35116.1539
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9907; val_auprc_score: 0.9888; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 2431.0304; train_edge_recon_loss: 27061.1901; train_gene_expr_recon_loss: 6564.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36057.0634; train_optim_loss: 36057.0634; val_kl_reg_loss: 2419.5999; val_edge_recon_loss: 26243.2681; val_gene_expr_recon_loss: 6472.4975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35135.3657; val_optim_loss: 35135.3657
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9914; val_auprc_score: 0.9897; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 2432.0403; train_edge_recon_loss: 27061.4529; train_gene_expr_recon_loss: 6556.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36050.0634; train_optim_loss: 36050.0634; val_kl_reg_loss: 2428.5536; val_edge_recon_loss: 26214.9511; val_gene_expr_recon_loss: 6466.7206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35110.2254; val_optim_loss: 35110.2254
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9915; val_auprc_score: 0.9900; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 2432.6386; train_edge_recon_loss: 27066.3793; train_gene_expr_recon_loss: 6550.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36049.6467; train_optim_loss: 36049.6467; val_kl_reg_loss: 2419.4004; val_edge_recon_loss: 26221.5567; val_gene_expr_recon_loss: 6464.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35105.8407; val_optim_loss: 35105.8407
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9914; val_auprc_score: 0.9896; val_best_acc_score: 0.9613; val_best_f1_score: 0.9620; train_kl_reg_loss: 2436.3891; train_edge_recon_loss: 27049.2320; train_gene_expr_recon_loss: 6546.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36032.3944; train_optim_loss: 36032.3944; val_kl_reg_loss: 2458.1526; val_edge_recon_loss: 26249.6578; val_gene_expr_recon_loss: 6467.9581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35175.7684; val_optim_loss: 35175.7684
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9894; val_best_acc_score: 0.9624; val_best_f1_score: 0.9629; train_kl_reg_loss: 2438.2328; train_edge_recon_loss: 27045.0779; train_gene_expr_recon_loss: 6539.3174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36022.6281; train_optim_loss: 36022.6281; val_kl_reg_loss: 2425.6674; val_edge_recon_loss: 26197.5355; val_gene_expr_recon_loss: 6465.5441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35088.7469; val_optim_loss: 35088.7469
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9919; val_auprc_score: 0.9902; val_best_acc_score: 0.9631; val_best_f1_score: 0.9636; train_kl_reg_loss: 2438.3786; train_edge_recon_loss: 27051.1886; train_gene_expr_recon_loss: 6533.7059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36023.2732; train_optim_loss: 36023.2732; val_kl_reg_loss: 2393.3101; val_edge_recon_loss: 26192.8362; val_gene_expr_recon_loss: 6465.4524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35051.5986; val_optim_loss: 35051.5986
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 2443.6411; train_edge_recon_loss: 27028.0646; train_gene_expr_recon_loss: 6532.2677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36003.9733; train_optim_loss: 36003.9733; val_kl_reg_loss: 2466.5900; val_edge_recon_loss: 26222.6338; val_gene_expr_recon_loss: 6451.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35140.8456; val_optim_loss: 35140.8456
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9918; val_auprc_score: 0.9900; val_best_acc_score: 0.9621; val_best_f1_score: 0.9625; train_kl_reg_loss: 2442.5450; train_edge_recon_loss: 27041.4903; train_gene_expr_recon_loss: 6526.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36010.7217; train_optim_loss: 36010.7217; val_kl_reg_loss: 2402.6480; val_edge_recon_loss: 26228.1058; val_gene_expr_recon_loss: 6466.8970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35097.6508; val_optim_loss: 35097.6508
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9894; val_best_acc_score: 0.9610; val_best_f1_score: 0.9617; train_kl_reg_loss: 2443.7244; train_edge_recon_loss: 27035.6293; train_gene_expr_recon_loss: 6525.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36005.3218; train_optim_loss: 36005.3218; val_kl_reg_loss: 2428.1259; val_edge_recon_loss: 26248.7778; val_gene_expr_recon_loss: 6454.6272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35131.5310; val_optim_loss: 35131.5310
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9916; val_auprc_score: 0.9899; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 2445.6198; train_edge_recon_loss: 27029.7456; train_gene_expr_recon_loss: 6521.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35997.1624; train_optim_loss: 35997.1624; val_kl_reg_loss: 2461.1396; val_edge_recon_loss: 26201.9145; val_gene_expr_recon_loss: 6446.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35109.4802; val_optim_loss: 35109.4802

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9924; val_auprc_score: 0.9908; val_best_acc_score: 0.9643; val_best_f1_score: 0.9647; train_kl_reg_loss: 2446.6425; train_edge_recon_loss: 26993.0333; train_gene_expr_recon_loss: 6490.7581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35930.4339; train_optim_loss: 35930.4339; val_kl_reg_loss: 2425.8926; val_edge_recon_loss: 26188.1562; val_gene_expr_recon_loss: 6423.1368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35037.1857; val_optim_loss: 35037.1857
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9642; val_best_f1_score: 0.9647; train_kl_reg_loss: 2444.6869; train_edge_recon_loss: 26994.8144; train_gene_expr_recon_loss: 6489.1811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35928.6825; train_optim_loss: 35928.6825; val_kl_reg_loss: 2417.0691; val_edge_recon_loss: 26165.5164; val_gene_expr_recon_loss: 6418.3555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35000.9410; val_optim_loss: 35000.9410
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 2445.7892; train_edge_recon_loss: 26987.0609; train_gene_expr_recon_loss: 6484.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35917.4575; train_optim_loss: 35917.4575; val_kl_reg_loss: 2410.6252; val_edge_recon_loss: 26196.2084; val_gene_expr_recon_loss: 6412.0259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35018.8596; val_optim_loss: 35018.8596
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9642; val_best_f1_score: 0.9647; train_kl_reg_loss: 2445.9157; train_edge_recon_loss: 26988.8429; train_gene_expr_recon_loss: 6484.1662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35918.9248; train_optim_loss: 35918.9248; val_kl_reg_loss: 2413.2875; val_edge_recon_loss: 26177.5170; val_gene_expr_recon_loss: 6418.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35009.7497; val_optim_loss: 35009.7497
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 2445.0935; train_edge_recon_loss: 26990.8126; train_gene_expr_recon_loss: 6481.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35917.6852; train_optim_loss: 35917.6852; val_kl_reg_loss: 2441.2593; val_edge_recon_loss: 26179.7200; val_gene_expr_recon_loss: 6403.8101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35024.7894; val_optim_loss: 35024.7894
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 2445.9344; train_edge_recon_loss: 26982.1998; train_gene_expr_recon_loss: 6479.7306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35907.8649; train_optim_loss: 35907.8649; val_kl_reg_loss: 2411.8712; val_edge_recon_loss: 26162.5775; val_gene_expr_recon_loss: 6405.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34980.1311; val_optim_loss: 34980.1311
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 2445.5309; train_edge_recon_loss: 26986.8834; train_gene_expr_recon_loss: 6479.8914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35912.3057; train_optim_loss: 35912.3057; val_kl_reg_loss: 2440.3319; val_edge_recon_loss: 26145.7386; val_gene_expr_recon_loss: 6412.0620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34998.1325; val_optim_loss: 34998.1325
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9647; val_best_f1_score: 0.9651; train_kl_reg_loss: 2445.2692; train_edge_recon_loss: 26986.9243; train_gene_expr_recon_loss: 6472.9703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35905.1638; train_optim_loss: 35905.1638; val_kl_reg_loss: 2406.0499; val_edge_recon_loss: 26181.4149; val_gene_expr_recon_loss: 6407.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34994.4719; val_optim_loss: 34994.4719
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9930; val_auprc_score: 0.9918; val_best_acc_score: 0.9655; val_best_f1_score: 0.9659; train_kl_reg_loss: 2443.3011; train_edge_recon_loss: 26998.1123; train_gene_expr_recon_loss: 6478.4939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35919.9072; train_optim_loss: 35919.9072; val_kl_reg_loss: 2411.5283; val_edge_recon_loss: 26182.0022; val_gene_expr_recon_loss: 6405.4693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34998.9998; val_optim_loss: 34998.9998
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9928; val_auprc_score: 0.9914; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 2443.7507; train_edge_recon_loss: 26993.7943; train_gene_expr_recon_loss: 6477.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35914.8159; train_optim_loss: 35914.8159; val_kl_reg_loss: 2395.9793; val_edge_recon_loss: 26141.6231; val_gene_expr_recon_loss: 6416.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34954.5555; val_optim_loss: 34954.5555
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 2444.7355; train_edge_recon_loss: 26992.4733; train_gene_expr_recon_loss: 6475.1368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35912.3457; train_optim_loss: 35912.3457; val_kl_reg_loss: 2413.8737; val_edge_recon_loss: 26169.9435; val_gene_expr_recon_loss: 6397.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34981.1134; val_optim_loss: 34981.1134
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 2446.3226; train_edge_recon_loss: 26986.2884; train_gene_expr_recon_loss: 6473.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35906.3414; train_optim_loss: 35906.3414; val_kl_reg_loss: 2421.3445; val_edge_recon_loss: 26144.9079; val_gene_expr_recon_loss: 6400.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34966.6878; val_optim_loss: 34966.6878
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9931; val_auprc_score: 0.9918; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 2445.1110; train_edge_recon_loss: 26989.8241; train_gene_expr_recon_loss: 6473.2872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35908.2225; train_optim_loss: 35908.2225; val_kl_reg_loss: 2399.5324; val_edge_recon_loss: 26153.4321; val_gene_expr_recon_loss: 6407.5004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34960.4648; val_optim_loss: 34960.4648
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9931; val_auprc_score: 0.9917; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 2447.0183; train_edge_recon_loss: 26981.7988; train_gene_expr_recon_loss: 6475.7259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35904.5430; train_optim_loss: 35904.5430; val_kl_reg_loss: 2401.0651; val_edge_recon_loss: 26186.0329; val_gene_expr_recon_loss: 6398.0980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34985.1960; val_optim_loss: 34985.1960

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 2445.4839; train_edge_recon_loss: 26980.8572; train_gene_expr_recon_loss: 6472.4758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35898.8169; train_optim_loss: 35898.8169; val_kl_reg_loss: 2416.9323; val_edge_recon_loss: 26147.8953; val_gene_expr_recon_loss: 6402.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34967.7574; val_optim_loss: 34967.7574
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 2446.3503; train_edge_recon_loss: 26979.8274; train_gene_expr_recon_loss: 6469.0480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35895.2257; train_optim_loss: 35895.2257; val_kl_reg_loss: 2419.9791; val_edge_recon_loss: 26175.0532; val_gene_expr_recon_loss: 6398.2659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34993.2982; val_optim_loss: 34993.2982
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9929; val_auprc_score: 0.9914; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 2447.1120; train_edge_recon_loss: 26978.2696; train_gene_expr_recon_loss: 6466.9015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35892.2831; train_optim_loss: 35892.2831; val_kl_reg_loss: 2424.5711; val_edge_recon_loss: 26138.3811; val_gene_expr_recon_loss: 6396.5627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34959.5148; val_optim_loss: 34959.5148
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 2446.2729; train_edge_recon_loss: 26979.6349; train_gene_expr_recon_loss: 6470.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35896.3005; train_optim_loss: 35896.3005; val_kl_reg_loss: 2420.2720; val_edge_recon_loss: 26154.0766; val_gene_expr_recon_loss: 6401.1139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34975.4623; val_optim_loss: 34975.4623

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 184 min 4 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9927
Val AUPRC score: 0.9913
Val best accuracy score: 0.9647
Val best F1 score: 0.9652
Val gene expr MSE score: 1.6150

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
