None
Run timestamp: 04082023_211226_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9856; val_auprc_score: 0.9858; val_best_acc_score: 0.9386; val_best_f1_score: 0.9387; train_kl_reg_loss: 7913.9550; train_edge_recon_loss: 269243.9566; train_gene_expr_recon_loss: 198573.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 475730.9818; train_optim_loss: 475730.9818; val_kl_reg_loss: 7425.4768; val_edge_recon_loss: 267494.3612; val_gene_expr_recon_loss: 181078.7543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455998.5916; val_optim_loss: 455998.5916
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9895; val_auprc_score: 0.9894; val_best_acc_score: 0.9481; val_best_f1_score: 0.9484; train_kl_reg_loss: 7359.3476; train_edge_recon_loss: 263452.8996; train_gene_expr_recon_loss: 176756.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447568.3859; train_optim_loss: 447568.3859; val_kl_reg_loss: 7099.6372; val_edge_recon_loss: 266383.9028; val_gene_expr_recon_loss: 173604.9781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447088.5182; val_optim_loss: 447088.5182
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9901; val_auprc_score: 0.9902; val_best_acc_score: 0.9504; val_best_f1_score: 0.9505; train_kl_reg_loss: 7204.2644; train_edge_recon_loss: 262459.4891; train_gene_expr_recon_loss: 172258.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441921.7925; train_optim_loss: 441921.7925; val_kl_reg_loss: 7112.4272; val_edge_recon_loss: 265570.9788; val_gene_expr_recon_loss: 171334.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444018.0818; val_optim_loss: 444018.0818
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9902; val_auprc_score: 0.9901; val_best_acc_score: 0.9507; val_best_f1_score: 0.9508; train_kl_reg_loss: 7156.5654; train_edge_recon_loss: 261936.4184; train_gene_expr_recon_loss: 170674.0622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439767.0460; train_optim_loss: 439767.0460; val_kl_reg_loss: 7061.4928; val_edge_recon_loss: 265557.6887; val_gene_expr_recon_loss: 170141.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442760.3588; val_optim_loss: 442760.3588
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9912; val_best_acc_score: 0.9537; val_best_f1_score: 0.9540; train_kl_reg_loss: 7122.3102; train_edge_recon_loss: 261678.6917; train_gene_expr_recon_loss: 169667.6913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438468.6937; train_optim_loss: 438468.6937; val_kl_reg_loss: 6952.2888; val_edge_recon_loss: 265367.2602; val_gene_expr_recon_loss: 169499.8117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441819.3611; val_optim_loss: 441819.3611
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9916; val_best_acc_score: 0.9542; val_best_f1_score: 0.9544; train_kl_reg_loss: 7111.7494; train_edge_recon_loss: 261385.4551; train_gene_expr_recon_loss: 169198.2827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437695.4871; train_optim_loss: 437695.4871; val_kl_reg_loss: 7062.0585; val_edge_recon_loss: 264782.4596; val_gene_expr_recon_loss: 169190.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441034.9191; val_optim_loss: 441034.9191
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9912; val_auprc_score: 0.9913; val_best_acc_score: 0.9533; val_best_f1_score: 0.9535; train_kl_reg_loss: 7096.5360; train_edge_recon_loss: 261276.8804; train_gene_expr_recon_loss: 168788.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437161.6685; train_optim_loss: 437161.6685; val_kl_reg_loss: 7045.0273; val_edge_recon_loss: 265109.4421; val_gene_expr_recon_loss: 168829.2378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440983.7072; val_optim_loss: 440983.7072
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9919; val_auprc_score: 0.9919; val_best_acc_score: 0.9555; val_best_f1_score: 0.9557; train_kl_reg_loss: 7093.6459; train_edge_recon_loss: 261073.2000; train_gene_expr_recon_loss: 168702.7538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436869.6000; train_optim_loss: 436869.6000; val_kl_reg_loss: 6895.2495; val_edge_recon_loss: 264851.2391; val_gene_expr_recon_loss: 168868.7439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440615.2330; val_optim_loss: 440615.2330
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9916; val_best_acc_score: 0.9557; val_best_f1_score: 0.9558; train_kl_reg_loss: 7090.2859; train_edge_recon_loss: 260944.8803; train_gene_expr_recon_loss: 168384.1660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436419.3324; train_optim_loss: 436419.3324; val_kl_reg_loss: 6973.0589; val_edge_recon_loss: 264587.7540; val_gene_expr_recon_loss: 168667.8951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440228.7071; val_optim_loss: 440228.7071
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9920; val_auprc_score: 0.9919; val_best_acc_score: 0.9559; val_best_f1_score: 0.9561; train_kl_reg_loss: 7085.3636; train_edge_recon_loss: 260874.3980; train_gene_expr_recon_loss: 168319.8440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436279.6055; train_optim_loss: 436279.6055; val_kl_reg_loss: 6883.4568; val_edge_recon_loss: 264523.3881; val_gene_expr_recon_loss: 168305.2786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439712.1242; val_optim_loss: 439712.1242
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9922; val_auprc_score: 0.9921; val_best_acc_score: 0.9566; val_best_f1_score: 0.9568; train_kl_reg_loss: 7084.5534; train_edge_recon_loss: 260758.2310; train_gene_expr_recon_loss: 168555.9341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436398.7186; train_optim_loss: 436398.7186; val_kl_reg_loss: 6958.0371; val_edge_recon_loss: 264704.1887; val_gene_expr_recon_loss: 168508.7631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440170.9880; val_optim_loss: 440170.9880
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9922; val_auprc_score: 0.9920; val_best_acc_score: 0.9565; val_best_f1_score: 0.9567; train_kl_reg_loss: 7074.0279; train_edge_recon_loss: 260647.8670; train_gene_expr_recon_loss: 168223.6238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435945.5189; train_optim_loss: 435945.5189; val_kl_reg_loss: 7028.3074; val_edge_recon_loss: 264424.3995; val_gene_expr_recon_loss: 168196.8419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439649.5490; val_optim_loss: 439649.5490
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9924; val_auprc_score: 0.9920; val_best_acc_score: 0.9581; val_best_f1_score: 0.9582; train_kl_reg_loss: 7074.3249; train_edge_recon_loss: 260564.6789; train_gene_expr_recon_loss: 168051.0161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435690.0200; train_optim_loss: 435690.0200; val_kl_reg_loss: 7100.5073; val_edge_recon_loss: 264298.3728; val_gene_expr_recon_loss: 168279.1214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439678.0008; val_optim_loss: 439678.0008
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9925; val_auprc_score: 0.9924; val_best_acc_score: 0.9577; val_best_f1_score: 0.9578; train_kl_reg_loss: 7070.4943; train_edge_recon_loss: 260548.2747; train_gene_expr_recon_loss: 168032.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435651.7493; train_optim_loss: 435651.7493; val_kl_reg_loss: 7034.0421; val_edge_recon_loss: 264186.3053; val_gene_expr_recon_loss: 168770.4697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439990.8170; val_optim_loss: 439990.8170
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9927; val_auprc_score: 0.9925; val_best_acc_score: 0.9584; val_best_f1_score: 0.9586; train_kl_reg_loss: 7062.4126; train_edge_recon_loss: 260551.7892; train_gene_expr_recon_loss: 168033.5338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435647.7356; train_optim_loss: 435647.7356; val_kl_reg_loss: 6979.5439; val_edge_recon_loss: 264094.7333; val_gene_expr_recon_loss: 168481.8527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439556.1307; val_optim_loss: 439556.1307
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9926; val_auprc_score: 0.9926; val_best_acc_score: 0.9581; val_best_f1_score: 0.9583; train_kl_reg_loss: 7068.5578; train_edge_recon_loss: 260411.5717; train_gene_expr_recon_loss: 168016.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435496.5225; train_optim_loss: 435496.5225; val_kl_reg_loss: 7012.7551; val_edge_recon_loss: 264155.2177; val_gene_expr_recon_loss: 168109.7156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439277.6890; val_optim_loss: 439277.6890
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9929; val_best_acc_score: 0.9597; val_best_f1_score: 0.9597; train_kl_reg_loss: 7058.1474; train_edge_recon_loss: 260428.4346; train_gene_expr_recon_loss: 168039.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435526.3619; train_optim_loss: 435526.3619; val_kl_reg_loss: 6938.3445; val_edge_recon_loss: 264041.1537; val_gene_expr_recon_loss: 170737.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441716.9234; val_optim_loss: 441716.9234
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9928; val_auprc_score: 0.9925; val_best_acc_score: 0.9592; val_best_f1_score: 0.9595; train_kl_reg_loss: 7072.3098; train_edge_recon_loss: 260352.0191; train_gene_expr_recon_loss: 168951.8318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436376.1609; train_optim_loss: 436376.1609; val_kl_reg_loss: 7017.2151; val_edge_recon_loss: 263878.0195; val_gene_expr_recon_loss: 164184.8027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435080.0369; val_optim_loss: 435080.0369
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9927; val_auprc_score: 0.9925; val_best_acc_score: 0.9590; val_best_f1_score: 0.9592; train_kl_reg_loss: 7036.1295; train_edge_recon_loss: 260277.0774; train_gene_expr_recon_loss: 169370.3717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436683.5786; train_optim_loss: 436683.5786; val_kl_reg_loss: 6892.9500; val_edge_recon_loss: 264174.5150; val_gene_expr_recon_loss: 171285.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442352.8068; val_optim_loss: 442352.8068
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9930; val_auprc_score: 0.9927; val_best_acc_score: 0.9595; val_best_f1_score: 0.9597; train_kl_reg_loss: 7044.7372; train_edge_recon_loss: 260236.2384; train_gene_expr_recon_loss: 169178.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436459.3640; train_optim_loss: 436459.3640; val_kl_reg_loss: 6865.7893; val_edge_recon_loss: 264067.7296; val_gene_expr_recon_loss: 178075.0944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449008.6134; val_optim_loss: 449008.6134
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9934; val_auprc_score: 0.9931; val_best_acc_score: 0.9608; val_best_f1_score: 0.9610; train_kl_reg_loss: 7042.1640; train_edge_recon_loss: 260223.3224; train_gene_expr_recon_loss: 168664.4484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435929.9350; train_optim_loss: 435929.9350; val_kl_reg_loss: 6919.3740; val_edge_recon_loss: 263901.7513; val_gene_expr_recon_loss: 156688.1256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427509.2524; val_optim_loss: 427509.2524
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9931; val_auprc_score: 0.9930; val_best_acc_score: 0.9597; val_best_f1_score: 0.9597; train_kl_reg_loss: 7042.7530; train_edge_recon_loss: 260255.2025; train_gene_expr_recon_loss: 168486.3277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435784.2828; train_optim_loss: 435784.2828; val_kl_reg_loss: 6884.7983; val_edge_recon_loss: 263801.9487; val_gene_expr_recon_loss: 126094.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 396781.1169; val_optim_loss: 396781.1169
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9927; val_auprc_score: 0.9924; val_best_acc_score: 0.9589; val_best_f1_score: 0.9590; train_kl_reg_loss: 7040.8658; train_edge_recon_loss: 260157.2208; train_gene_expr_recon_loss: 170322.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437520.6499; train_optim_loss: 437520.6499; val_kl_reg_loss: 7032.0458; val_edge_recon_loss: 263760.1534; val_gene_expr_recon_loss: 207006.7924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 477798.9919; val_optim_loss: 477798.9919
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9928; val_auprc_score: 0.9927; val_best_acc_score: 0.9588; val_best_f1_score: 0.9589; train_kl_reg_loss: 7029.9970; train_edge_recon_loss: 260148.1011; train_gene_expr_recon_loss: 174091.6106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441269.7086; train_optim_loss: 441269.7086; val_kl_reg_loss: 6937.1438; val_edge_recon_loss: 263779.8903; val_gene_expr_recon_loss: 167761.0827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438478.1174; val_optim_loss: 438478.1174
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9931; val_auprc_score: 0.9929; val_best_acc_score: 0.9600; val_best_f1_score: 0.9601; train_kl_reg_loss: 7027.8410; train_edge_recon_loss: 260064.0499; train_gene_expr_recon_loss: 166549.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433641.2965; train_optim_loss: 433641.2965; val_kl_reg_loss: 6894.7363; val_edge_recon_loss: 263654.2391; val_gene_expr_recon_loss: 219952.9755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 490501.9518; val_optim_loss: 490501.9518
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9930; val_auprc_score: 0.9929; val_best_acc_score: 0.9594; val_best_f1_score: 0.9595; train_kl_reg_loss: 7028.6073; train_edge_recon_loss: 260074.5952; train_gene_expr_recon_loss: 174790.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441893.3726; train_optim_loss: 441893.3726; val_kl_reg_loss: 6906.2498; val_edge_recon_loss: 263801.9541; val_gene_expr_recon_loss: 150193.8506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420902.0530; val_optim_loss: 420902.0530

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9937; val_auprc_score: 0.9934; val_best_acc_score: 0.9619; val_best_f1_score: 0.9620; train_kl_reg_loss: 7014.9436; train_edge_recon_loss: 259714.9305; train_gene_expr_recon_loss: 175130.4113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441860.2855; train_optim_loss: 441860.2855; val_kl_reg_loss: 6889.6473; val_edge_recon_loss: 263468.3874; val_gene_expr_recon_loss: 180563.4931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450921.5275; val_optim_loss: 450921.5275
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9935; val_auprc_score: 0.9934; val_best_acc_score: 0.9614; val_best_f1_score: 0.9616; train_kl_reg_loss: 7003.7653; train_edge_recon_loss: 259656.7048; train_gene_expr_recon_loss: 202005.0440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 468665.5137; train_optim_loss: 468665.5137; val_kl_reg_loss: 6895.5829; val_edge_recon_loss: 263613.2794; val_gene_expr_recon_loss: 150198.4294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420707.2915; val_optim_loss: 420707.2915
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9938; val_auprc_score: 0.9936; val_best_acc_score: 0.9618; val_best_f1_score: 0.9619; train_kl_reg_loss: 6992.1312; train_edge_recon_loss: 259646.6112; train_gene_expr_recon_loss: 188104.8447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 454743.5870; train_optim_loss: 454743.5870; val_kl_reg_loss: 6944.7849; val_edge_recon_loss: 263446.6712; val_gene_expr_recon_loss: 172693.5777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443085.0341; val_optim_loss: 443085.0341
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9939; val_auprc_score: 0.9937; val_best_acc_score: 0.9623; val_best_f1_score: 0.9625; train_kl_reg_loss: 6987.2459; train_edge_recon_loss: 259620.8415; train_gene_expr_recon_loss: 156754.0468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 423362.1344; train_optim_loss: 423362.1344; val_kl_reg_loss: 6915.3702; val_edge_recon_loss: 263357.5128; val_gene_expr_recon_loss: 202661.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 472934.6445; val_optim_loss: 472934.6445

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 149 min 1 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9930
val AUPRC score: 0.9927
val best accuracy score: 0.9599
val best F1 score: 0.9601
val target rna MSE score: 4.7225
val source rna MSE score: 1.0672

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
