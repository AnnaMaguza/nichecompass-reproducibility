None
Run timestamp: 15082023_113455_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9901; val_auprc_score: 0.9867; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 7560.2808; train_edge_recon_loss: 263358.4747; train_gene_expr_recon_loss: 197949.0877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3777.1680; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 472645.0109; train_optim_loss: 472645.0109; val_kl_reg_loss: 7215.2408; val_edge_recon_loss: 259167.7645; val_gene_expr_recon_loss: 185155.2849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4366.2910; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455904.5716; val_optim_loss: 455904.5716
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 7101.2239; train_edge_recon_loss: 259345.9899; train_gene_expr_recon_loss: 181402.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4426.8695; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 452276.6476; train_optim_loss: 452276.6476; val_kl_reg_loss: 6765.2483; val_edge_recon_loss: 258316.5516; val_gene_expr_recon_loss: 180443.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4422.4390; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449948.0832; val_optim_loss: 449948.0832
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 6881.2355; train_edge_recon_loss: 258662.8079; train_gene_expr_recon_loss: 178772.9753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4291.0984; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448608.1168; train_optim_loss: 448608.1168; val_kl_reg_loss: 6790.0732; val_edge_recon_loss: 257705.1981; val_gene_expr_recon_loss: 179347.3829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4212.6362; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448055.2793; val_optim_loss: 448055.2793
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 6775.9394; train_edge_recon_loss: 258205.5921; train_gene_expr_recon_loss: 178118.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4150.2410; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447249.9086; train_optim_loss: 447249.9086; val_kl_reg_loss: 6679.3636; val_edge_recon_loss: 257261.0365; val_gene_expr_recon_loss: 178707.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4108.7637; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446756.6341; val_optim_loss: 446756.6341
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 6722.1532; train_edge_recon_loss: 257930.1425; train_gene_expr_recon_loss: 177759.1635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4087.4338; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446498.8934; train_optim_loss: 446498.8934; val_kl_reg_loss: 6708.6654; val_edge_recon_loss: 257023.8127; val_gene_expr_recon_loss: 178600.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4071.3904; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446403.9242; val_optim_loss: 446403.9242
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 6693.0195; train_edge_recon_loss: 257840.7515; train_gene_expr_recon_loss: 177748.2675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4083.2353; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446365.2741; train_optim_loss: 446365.2741; val_kl_reg_loss: 6639.2251; val_edge_recon_loss: 256975.1241; val_gene_expr_recon_loss: 178431.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4076.9895; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446122.6306; val_optim_loss: 446122.6306
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6680.0937; train_edge_recon_loss: 257523.7504; train_gene_expr_recon_loss: 177635.4746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4081.2176; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445920.5359; train_optim_loss: 445920.5359; val_kl_reg_loss: 6692.7643; val_edge_recon_loss: 256831.7527; val_gene_expr_recon_loss: 178478.1888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4070.8350; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446073.5504; val_optim_loss: 446073.5504
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 6667.5987; train_edge_recon_loss: 257415.0252; train_gene_expr_recon_loss: 177581.1021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4088.6550; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445752.3814; train_optim_loss: 445752.3814; val_kl_reg_loss: 6660.5280; val_edge_recon_loss: 256692.4814; val_gene_expr_recon_loss: 178650.2076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4089.4321; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446092.6546; val_optim_loss: 446092.6546
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 6660.9269; train_edge_recon_loss: 257350.8740; train_gene_expr_recon_loss: 177489.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4092.3541; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445594.1475; train_optim_loss: 445594.1475; val_kl_reg_loss: 6604.6326; val_edge_recon_loss: 256622.8114; val_gene_expr_recon_loss: 178494.4066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4082.9292; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445804.7888; val_optim_loss: 445804.7888
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 6654.8891; train_edge_recon_loss: 257314.5662; train_gene_expr_recon_loss: 177510.4999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4097.1563; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445577.1120; train_optim_loss: 445577.1120; val_kl_reg_loss: 6558.8340; val_edge_recon_loss: 256595.9643; val_gene_expr_recon_loss: 178891.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4115.1030; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446161.7725; val_optim_loss: 446161.7725
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6653.2281; train_edge_recon_loss: 257223.8232; train_gene_expr_recon_loss: 177466.1662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4102.6179; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445445.8357; train_optim_loss: 445445.8357; val_kl_reg_loss: 6632.4794; val_edge_recon_loss: 256457.8563; val_gene_expr_recon_loss: 178837.0136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4100.4028; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446027.7560; val_optim_loss: 446027.7560
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 6651.3162; train_edge_recon_loss: 257126.0670; train_gene_expr_recon_loss: 177581.4016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4100.1979; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445458.9824; train_optim_loss: 445458.9824; val_kl_reg_loss: 6666.7624; val_edge_recon_loss: 256391.5348; val_gene_expr_recon_loss: 178632.9673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4102.9683; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445794.2329; val_optim_loss: 445794.2329
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 6652.3383; train_edge_recon_loss: 257043.2047; train_gene_expr_recon_loss: 177390.1018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4100.4213; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445186.0663; train_optim_loss: 445186.0663; val_kl_reg_loss: 6636.1784; val_edge_recon_loss: 256180.5843; val_gene_expr_recon_loss: 178390.8718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4116.7461; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445324.3847; val_optim_loss: 445324.3847
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6649.8694; train_edge_recon_loss: 256983.1412; train_gene_expr_recon_loss: 177291.3358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4092.0614; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445016.4076; train_optim_loss: 445016.4076; val_kl_reg_loss: 6680.3140; val_edge_recon_loss: 256116.7592; val_gene_expr_recon_loss: 178747.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4083.1865; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445627.7124; val_optim_loss: 445627.7124
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6645.1388; train_edge_recon_loss: 256915.7429; train_gene_expr_recon_loss: 177331.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4095.1723; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444987.8192; train_optim_loss: 444987.8192; val_kl_reg_loss: 6535.2208; val_edge_recon_loss: 256214.3504; val_gene_expr_recon_loss: 178746.6526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4069.0645; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445565.2852; val_optim_loss: 445565.2852
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6644.8394; train_edge_recon_loss: 256879.1301; train_gene_expr_recon_loss: 177206.5776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4091.9348; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444822.4821; train_optim_loss: 444822.4821; val_kl_reg_loss: 6568.4054; val_edge_recon_loss: 256061.3759; val_gene_expr_recon_loss: 178335.7146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4089.6738; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445055.1836; val_optim_loss: 445055.1836
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6639.9026; train_edge_recon_loss: 256841.0859; train_gene_expr_recon_loss: 177215.8399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4098.3785; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444795.2070; train_optim_loss: 444795.2070; val_kl_reg_loss: 6598.6123; val_edge_recon_loss: 256107.6010; val_gene_expr_recon_loss: 178480.1112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4100.8701; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445287.2004; val_optim_loss: 445287.2004
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6639.0686; train_edge_recon_loss: 256867.9920; train_gene_expr_recon_loss: 177180.4153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4097.2316; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444784.7076; train_optim_loss: 444784.7076; val_kl_reg_loss: 6626.7525; val_edge_recon_loss: 256143.3254; val_gene_expr_recon_loss: 178471.0319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4087.1897; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445328.2978; val_optim_loss: 445328.2978
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6635.1536; train_edge_recon_loss: 256797.3646; train_gene_expr_recon_loss: 177145.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4087.7279; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444665.2543; train_optim_loss: 444665.2543; val_kl_reg_loss: 6627.4714; val_edge_recon_loss: 255887.5914; val_gene_expr_recon_loss: 178805.6964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4082.5151; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445403.2583; val_optim_loss: 445403.2583
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6637.7182; train_edge_recon_loss: 256751.5822; train_gene_expr_recon_loss: 177229.0899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4091.3656; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444709.7562; train_optim_loss: 444709.7562; val_kl_reg_loss: 6646.0732; val_edge_recon_loss: 256159.8368; val_gene_expr_recon_loss: 178443.8057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4092.5425; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445342.2461; val_optim_loss: 445342.2461

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6610.5090; train_edge_recon_loss: 256653.5512; train_gene_expr_recon_loss: 176847.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3923.7391; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444035.2399; train_optim_loss: 444035.2399; val_kl_reg_loss: 6599.7398; val_edge_recon_loss: 255965.3410; val_gene_expr_recon_loss: 178287.2113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3918.0913; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444770.3852; val_optim_loss: 444770.3852
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6611.2606; train_edge_recon_loss: 256559.6659; train_gene_expr_recon_loss: 176822.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3916.1794; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443909.4976; train_optim_loss: 443909.4976; val_kl_reg_loss: 6585.3463; val_edge_recon_loss: 255693.1804; val_gene_expr_recon_loss: 178086.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3915.9897; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444281.1843; val_optim_loss: 444281.1843
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6606.7451; train_edge_recon_loss: 256619.8771; train_gene_expr_recon_loss: 176670.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3917.7339; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443814.7780; train_optim_loss: 443814.7780; val_kl_reg_loss: 6601.5883; val_edge_recon_loss: 255685.9702; val_gene_expr_recon_loss: 177996.5922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3920.3340; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444204.4946; val_optim_loss: 444204.4946
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6607.7404; train_edge_recon_loss: 256599.6219; train_gene_expr_recon_loss: 176668.0185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3922.5975; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443797.9787; train_optim_loss: 443797.9787; val_kl_reg_loss: 6590.6282; val_edge_recon_loss: 255769.1985; val_gene_expr_recon_loss: 177666.2966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3923.8254; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443949.9356; val_optim_loss: 443949.9356
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6598.9871; train_edge_recon_loss: 256570.2239; train_gene_expr_recon_loss: 176776.5933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3926.5683; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443872.3730; train_optim_loss: 443872.3730; val_kl_reg_loss: 6582.7841; val_edge_recon_loss: 255706.2789; val_gene_expr_recon_loss: 178043.6618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3926.1890; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444258.9128; val_optim_loss: 444258.9128
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9889; val_auprc_score: 0.9854; val_best_acc_score: 0.9631; val_best_f1_score: 0.9639; train_kl_reg_loss: 2920.3809; train_edge_recon_loss: 260626.9603; train_gene_expr_recon_loss: 93694.8562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3186.4196; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360428.6170; train_optim_loss: 360428.6170; val_kl_reg_loss: 655.7504; val_edge_recon_loss: 259984.5519; val_gene_expr_recon_loss: 92823.9116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 2435.2998; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355899.5271; val_optim_loss: 355899.5271
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9901; val_auprc_score: 0.9870; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 1364.1780; train_edge_recon_loss: 258783.6490; train_gene_expr_recon_loss: 91878.2072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 1901.4993; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353927.5336; train_optim_loss: 353927.5336; val_kl_reg_loss: 751.9431; val_edge_recon_loss: 259351.5146; val_gene_expr_recon_loss: 91963.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 1534.0383; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353601.1934; val_optim_loss: 353601.1934
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9907; val_auprc_score: 0.9882; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 1131.2853; train_edge_recon_loss: 258018.5733; train_gene_expr_recon_loss: 91197.6963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 1339.2722; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351686.8271; train_optim_loss: 351686.8271; val_kl_reg_loss: 858.7956; val_edge_recon_loss: 258477.6164; val_gene_expr_recon_loss: 91541.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 1187.0250; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352065.4102; val_optim_loss: 352065.4102
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9911; val_auprc_score: 0.9881; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 1063.9200; train_edge_recon_loss: 257610.8833; train_gene_expr_recon_loss: 90944.5476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 1078.6092; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350697.9598; train_optim_loss: 350697.9598; val_kl_reg_loss: 925.4981; val_edge_recon_loss: 257943.4954; val_gene_expr_recon_loss: 91205.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 984.7994; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351059.0229; val_optim_loss: 351059.0229
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9680; val_best_f1_score: 0.9684; train_kl_reg_loss: 1026.1078; train_edge_recon_loss: 257173.2836; train_gene_expr_recon_loss: 90690.5777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 914.7592; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349804.7284; train_optim_loss: 349804.7284; val_kl_reg_loss: 944.6487; val_edge_recon_loss: 257562.0016; val_gene_expr_recon_loss: 91026.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 856.8469; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350389.8915; val_optim_loss: 350389.8915
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9922; val_auprc_score: 0.9898; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 999.3245; train_edge_recon_loss: 256951.2003; train_gene_expr_recon_loss: 90543.5863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 825.3564; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349319.4677; train_optim_loss: 349319.4677; val_kl_reg_loss: 943.4625; val_edge_recon_loss: 257458.4317; val_gene_expr_recon_loss: 90947.0177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 802.6875; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350151.5988; val_optim_loss: 350151.5988
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 984.7122; train_edge_recon_loss: 256758.6071; train_gene_expr_recon_loss: 90487.6018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 792.2725; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349023.1936; train_optim_loss: 349023.1936; val_kl_reg_loss: 894.6191; val_edge_recon_loss: 257310.2539; val_gene_expr_recon_loss: 90738.3657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 787.3330; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349730.5832; val_optim_loss: 349730.5832
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9922; val_auprc_score: 0.9899; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 981.8754; train_edge_recon_loss: 257061.1411; train_gene_expr_recon_loss: 90020.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 786.4081; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348850.2032; train_optim_loss: 348850.2032; val_kl_reg_loss: 822.4260; val_edge_recon_loss: 257974.8783; val_gene_expr_recon_loss: 90211.5487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 787.2651; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349796.1032; val_optim_loss: 349796.1032
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 969.8804; train_edge_recon_loss: 257224.4609; train_gene_expr_recon_loss: 89711.8666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 786.8451; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348693.0530; train_optim_loss: 348693.0530; val_kl_reg_loss: 841.8994; val_edge_recon_loss: 257433.3703; val_gene_expr_recon_loss: 90244.4406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 786.6503; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349306.3654; val_optim_loss: 349306.3654
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9905; val_auprc_score: 0.9874; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 935.9622; train_edge_recon_loss: 257353.7412; train_gene_expr_recon_loss: 89716.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 787.2736; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348793.2932; train_optim_loss: 348793.2932; val_kl_reg_loss: 811.6711; val_edge_recon_loss: 258129.3107; val_gene_expr_recon_loss: 90040.0392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 788.7195; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349769.7397; val_optim_loss: 349769.7397
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9883; val_auprc_score: 0.9841; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 907.2907; train_edge_recon_loss: 257517.9116; train_gene_expr_recon_loss: 89588.9705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 789.6116; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348803.7842; train_optim_loss: 348803.7842; val_kl_reg_loss: 759.6209; val_edge_recon_loss: 258480.6027; val_gene_expr_recon_loss: 90156.1580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 791.6077; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350187.9768; val_optim_loss: 350187.9768
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9888; val_auprc_score: 0.9849; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 899.5191; train_edge_recon_loss: 258135.9607; train_gene_expr_recon_loss: 89562.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 795.5436; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349393.2010; train_optim_loss: 349393.2010; val_kl_reg_loss: 788.2297; val_edge_recon_loss: 258036.3660; val_gene_expr_recon_loss: 90004.5402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 799.6771; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349628.8234; val_optim_loss: 349628.8234
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9876; val_auprc_score: 0.9843; val_best_acc_score: 0.9561; val_best_f1_score: 0.9568; train_kl_reg_loss: 854.0780; train_edge_recon_loss: 258443.0522; train_gene_expr_recon_loss: 89417.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 803.9353; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349518.0962; train_optim_loss: 349518.0962; val_kl_reg_loss: 685.8770; val_edge_recon_loss: 258933.5614; val_gene_expr_recon_loss: 89975.4612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 810.0739; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350404.9626; val_optim_loss: 350404.9626

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9871; val_auprc_score: 0.9837; val_best_acc_score: 0.9548; val_best_f1_score: 0.9557; train_kl_reg_loss: 831.3253; train_edge_recon_loss: 259051.1509; train_gene_expr_recon_loss: 89356.4133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 808.6786; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350047.5686; train_optim_loss: 350047.5686; val_kl_reg_loss: 687.9210; val_edge_recon_loss: 259615.3898; val_gene_expr_recon_loss: 89736.8139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 809.1981; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350849.3120; val_optim_loss: 350849.3120
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9868; val_auprc_score: 0.9832; val_best_acc_score: 0.9541; val_best_f1_score: 0.9551; train_kl_reg_loss: 817.1808; train_edge_recon_loss: 258942.7341; train_gene_expr_recon_loss: 89378.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 809.6840; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349948.5878; train_optim_loss: 349948.5878; val_kl_reg_loss: 690.8114; val_edge_recon_loss: 259562.7086; val_gene_expr_recon_loss: 90008.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 810.1718; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351071.9617; val_optim_loss: 351071.9617
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9876; val_auprc_score: 0.9844; val_best_acc_score: 0.9556; val_best_f1_score: 0.9564; train_kl_reg_loss: 797.5340; train_edge_recon_loss: 259087.7944; train_gene_expr_recon_loss: 89331.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 810.6079; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350027.5154; train_optim_loss: 350027.5154; val_kl_reg_loss: 688.9984; val_edge_recon_loss: 259402.3273; val_gene_expr_recon_loss: 89686.6663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 811.0585; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350589.0540; val_optim_loss: 350589.0540
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9872; val_auprc_score: 0.9840; val_best_acc_score: 0.9550; val_best_f1_score: 0.9559; train_kl_reg_loss: 777.2006; train_edge_recon_loss: 258993.2355; train_gene_expr_recon_loss: 89422.7362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 811.5917; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350004.7645; train_optim_loss: 350004.7645; val_kl_reg_loss: 688.6624; val_edge_recon_loss: 259661.2458; val_gene_expr_recon_loss: 89839.0611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 812.1533; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351001.1256; val_optim_loss: 351001.1256

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 359 min 4 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9920
val AUPRC score: 0.9896
val best accuracy score: 0.9683
val best F1 score: 0.9688
val target rna MSE score: 0.8076
val source rna MSE score: 0.0582

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
