None
Run timestamp: 15072023_150143_153.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_153']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9684; val_auprc_score: 0.9659; val_best_acc_score: 0.9096; val_best_f1_score: 0.9112; train_kl_reg_loss: 17222.8304; train_edge_recon_loss: 26642652.5275; train_gene_expr_recon_loss: 1728255.3551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28388130.6843; train_optim_loss: 28388130.6843; val_kl_reg_loss: 18751.8071; val_edge_recon_loss: 26638233.7455; val_gene_expr_recon_loss: 1534987.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28191973.4182; val_optim_loss: 28191973.4182
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9719; val_auprc_score: 0.9690; val_best_acc_score: 0.9176; val_best_f1_score: 0.9180; train_kl_reg_loss: 19824.7237; train_edge_recon_loss: 26104730.8065; train_gene_expr_recon_loss: 1481333.2912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27605888.8289; train_optim_loss: 27605888.8289; val_kl_reg_loss: 20120.7529; val_edge_recon_loss: 26521778.0909; val_gene_expr_recon_loss: 1434847.0170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27976745.9636; val_optim_loss: 27976745.9636
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9751; val_auprc_score: 0.9719; val_best_acc_score: 0.9212; val_best_f1_score: 0.9224; train_kl_reg_loss: 22000.9364; train_edge_recon_loss: 26044303.6375; train_gene_expr_recon_loss: 1404604.2735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27470908.8024; train_optim_loss: 27470908.8024; val_kl_reg_loss: 22314.4200; val_edge_recon_loss: 26495323.5455; val_gene_expr_recon_loss: 1375531.2807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27893169.2727; val_optim_loss: 27893169.2727
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9778; val_auprc_score: 0.9751; val_best_acc_score: 0.9279; val_best_f1_score: 0.9287; train_kl_reg_loss: 23153.3286; train_edge_recon_loss: 25992586.5927; train_gene_expr_recon_loss: 1364378.4260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27380118.3483; train_optim_loss: 27380118.3483; val_kl_reg_loss: 22222.8082; val_edge_recon_loss: 26440289.1455; val_gene_expr_recon_loss: 1342736.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27805248.4364; val_optim_loss: 27805248.4364
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9795; val_auprc_score: 0.9767; val_best_acc_score: 0.9309; val_best_f1_score: 0.9316; train_kl_reg_loss: 23879.9125; train_edge_recon_loss: 25949485.2668; train_gene_expr_recon_loss: 1341140.6292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27314505.8126; train_optim_loss: 27314505.8126; val_kl_reg_loss: 24247.1657; val_edge_recon_loss: 26374901.6000; val_gene_expr_recon_loss: 1329153.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27728302.7273; val_optim_loss: 27728302.7273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9812; val_auprc_score: 0.9788; val_best_acc_score: 0.9334; val_best_f1_score: 0.9339; train_kl_reg_loss: 24382.5460; train_edge_recon_loss: 25938094.4562; train_gene_expr_recon_loss: 1329548.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27292025.7475; train_optim_loss: 27292025.7475; val_kl_reg_loss: 22826.1329; val_edge_recon_loss: 26400672.5636; val_gene_expr_recon_loss: 1318614.6614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27742113.3455; val_optim_loss: 27742113.3455
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9813; val_auprc_score: 0.9785; val_best_acc_score: 0.9341; val_best_f1_score: 0.9348; train_kl_reg_loss: 24365.5015; train_edge_recon_loss: 25908160.4155; train_gene_expr_recon_loss: 1315839.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27248365.4338; train_optim_loss: 27248365.4338; val_kl_reg_loss: 24034.7420; val_edge_recon_loss: 26365891.8727; val_gene_expr_recon_loss: 1308260.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27698186.8545; val_optim_loss: 27698186.8545
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9814; val_auprc_score: 0.9788; val_best_acc_score: 0.9347; val_best_f1_score: 0.9352; train_kl_reg_loss: 24740.8933; train_edge_recon_loss: 25899899.7800; train_gene_expr_recon_loss: 1308779.6631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27233420.3157; train_optim_loss: 27233420.3157; val_kl_reg_loss: 24800.8502; val_edge_recon_loss: 26349223.3636; val_gene_expr_recon_loss: 1301370.3648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27675394.6000; val_optim_loss: 27675394.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9822; val_auprc_score: 0.9799; val_best_acc_score: 0.9359; val_best_f1_score: 0.9367; train_kl_reg_loss: 25056.8273; train_edge_recon_loss: 25877546.3014; train_gene_expr_recon_loss: 1300251.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27202854.7617; train_optim_loss: 27202854.7617; val_kl_reg_loss: 23556.8635; val_edge_recon_loss: 26356521.2909; val_gene_expr_recon_loss: 1295872.0489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27675950.1455; val_optim_loss: 27675950.1455
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9827; val_auprc_score: 0.9794; val_best_acc_score: 0.9382; val_best_f1_score: 0.9390; train_kl_reg_loss: 24889.1495; train_edge_recon_loss: 25868709.4603; train_gene_expr_recon_loss: 1294707.1703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27188305.8086; train_optim_loss: 27188305.8086; val_kl_reg_loss: 24256.2749; val_edge_recon_loss: 26317941.3455; val_gene_expr_recon_loss: 1288645.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27630843.3636; val_optim_loss: 27630843.3636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9837; val_auprc_score: 0.9812; val_best_acc_score: 0.9399; val_best_f1_score: 0.9403; train_kl_reg_loss: 24723.1835; train_edge_recon_loss: 25861951.7251; train_gene_expr_recon_loss: 1291026.3708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27177701.2220; train_optim_loss: 27177701.2220; val_kl_reg_loss: 25206.0254; val_edge_recon_loss: 26303388.7818; val_gene_expr_recon_loss: 1284884.9159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27613479.7091; val_optim_loss: 27613479.7091
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9855; val_auprc_score: 0.9840; val_best_acc_score: 0.9427; val_best_f1_score: 0.9433; train_kl_reg_loss: 24666.1095; train_edge_recon_loss: 25851264.7637; train_gene_expr_recon_loss: 1286489.9815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27162420.8880; train_optim_loss: 27162420.8880; val_kl_reg_loss: 24378.6163; val_edge_recon_loss: 26322565.6000; val_gene_expr_recon_loss: 1282262.8693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27629207.1091; val_optim_loss: 27629207.1091
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9848; val_auprc_score: 0.9825; val_best_acc_score: 0.9435; val_best_f1_score: 0.9441; train_kl_reg_loss: 24578.6722; train_edge_recon_loss: 25838740.6558; train_gene_expr_recon_loss: 1283387.5774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27146706.9226; train_optim_loss: 27146706.9226; val_kl_reg_loss: 23384.6064; val_edge_recon_loss: 26316051.4909; val_gene_expr_recon_loss: 1277424.1273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27616860.3636; val_optim_loss: 27616860.3636
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9865; val_auprc_score: 0.9845; val_best_acc_score: 0.9465; val_best_f1_score: 0.9470; train_kl_reg_loss: 24517.7547; train_edge_recon_loss: 25836641.5784; train_gene_expr_recon_loss: 1279501.9539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27140661.2892; train_optim_loss: 27140661.2892; val_kl_reg_loss: 24068.9021; val_edge_recon_loss: 26320468.9091; val_gene_expr_recon_loss: 1277560.6091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27622098.3091; val_optim_loss: 27622098.3091
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9863; val_auprc_score: 0.9847; val_best_acc_score: 0.9456; val_best_f1_score: 0.9460; train_kl_reg_loss: 24261.2677; train_edge_recon_loss: 25837311.5316; train_gene_expr_recon_loss: 1277596.5648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27139169.3910; train_optim_loss: 27139169.3910; val_kl_reg_loss: 24092.7370; val_edge_recon_loss: 26295919.2545; val_gene_expr_recon_loss: 1275221.7205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27595233.7273; val_optim_loss: 27595233.7273
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9868; val_auprc_score: 0.9849; val_best_acc_score: 0.9471; val_best_f1_score: 0.9475; train_kl_reg_loss: 24339.9241; train_edge_recon_loss: 25818629.7291; train_gene_expr_recon_loss: 1274987.9005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27117957.5255; train_optim_loss: 27117957.5255; val_kl_reg_loss: 23486.7027; val_edge_recon_loss: 26304237.0182; val_gene_expr_recon_loss: 1272910.2455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27600633.8182; val_optim_loss: 27600633.8182
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9869; val_auprc_score: 0.9849; val_best_acc_score: 0.9474; val_best_f1_score: 0.9481; train_kl_reg_loss: 24240.4687; train_edge_recon_loss: 25806640.4420; train_gene_expr_recon_loss: 1273219.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27104100.3666; train_optim_loss: 27104100.3666; val_kl_reg_loss: 23796.7215; val_edge_recon_loss: 26284851.1455; val_gene_expr_recon_loss: 1271590.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27580238.3818; val_optim_loss: 27580238.3818
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9879; val_auprc_score: 0.9858; val_best_acc_score: 0.9502; val_best_f1_score: 0.9508; train_kl_reg_loss: 24250.3889; train_edge_recon_loss: 25803670.4257; train_gene_expr_recon_loss: 1271306.6861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27099227.5092; train_optim_loss: 27099227.5092; val_kl_reg_loss: 23474.0181; val_edge_recon_loss: 26262693.6000; val_gene_expr_recon_loss: 1269452.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27555620.4182; val_optim_loss: 27555620.4182
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9882; val_auprc_score: 0.9868; val_best_acc_score: 0.9505; val_best_f1_score: 0.9509; train_kl_reg_loss: 24091.1223; train_edge_recon_loss: 25809213.6843; train_gene_expr_recon_loss: 1270263.9249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27103568.7495; train_optim_loss: 27103568.7495; val_kl_reg_loss: 22962.1987; val_edge_recon_loss: 26285850.6727; val_gene_expr_recon_loss: 1270394.4568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27579207.4000; val_optim_loss: 27579207.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9860; val_best_acc_score: 0.9506; val_best_f1_score: 0.9510; train_kl_reg_loss: 24085.2571; train_edge_recon_loss: 25803022.7128; train_gene_expr_recon_loss: 1269059.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27096167.2342; train_optim_loss: 27096167.2342; val_kl_reg_loss: 23634.1573; val_edge_recon_loss: 26279315.1818; val_gene_expr_recon_loss: 1266893.4682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27569842.8909; val_optim_loss: 27569842.8909
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9879; val_auprc_score: 0.9858; val_best_acc_score: 0.9502; val_best_f1_score: 0.9507; train_kl_reg_loss: 24196.3667; train_edge_recon_loss: 25785943.5499; train_gene_expr_recon_loss: 1267334.9314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27077474.8758; train_optim_loss: 27077474.8758; val_kl_reg_loss: 23904.1436; val_edge_recon_loss: 26216472.9636; val_gene_expr_recon_loss: 1265017.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27505394.1818; val_optim_loss: 27505394.1818
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9874; val_best_acc_score: 0.9518; val_best_f1_score: 0.9523; train_kl_reg_loss: 24142.6525; train_edge_recon_loss: 25787493.2790; train_gene_expr_recon_loss: 1265955.6850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27077591.6232; train_optim_loss: 27077591.6232; val_kl_reg_loss: 23234.5504; val_edge_recon_loss: 26244074.8727; val_gene_expr_recon_loss: 1265031.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27532340.7636; val_optim_loss: 27532340.7636
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9885; val_auprc_score: 0.9868; val_best_acc_score: 0.9514; val_best_f1_score: 0.9518; train_kl_reg_loss: 24003.9079; train_edge_recon_loss: 25792485.7821; train_gene_expr_recon_loss: 1266300.9154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27082790.5906; train_optim_loss: 27082790.5906; val_kl_reg_loss: 23528.3071; val_edge_recon_loss: 26252195.9818; val_gene_expr_recon_loss: 1261969.3773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27537693.6545; val_optim_loss: 27537693.6545
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9892; val_auprc_score: 0.9876; val_best_acc_score: 0.9531; val_best_f1_score: 0.9535; train_kl_reg_loss: 23931.1822; train_edge_recon_loss: 25785829.3971; train_gene_expr_recon_loss: 1264165.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27073925.8778; train_optim_loss: 27073925.8778; val_kl_reg_loss: 22914.2620; val_edge_recon_loss: 26251342.2727; val_gene_expr_recon_loss: 1263527.0955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27537783.7091; val_optim_loss: 27537783.7091
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9890; val_auprc_score: 0.9877; val_best_acc_score: 0.9520; val_best_f1_score: 0.9523; train_kl_reg_loss: 23973.9103; train_edge_recon_loss: 25786705.0794; train_gene_expr_recon_loss: 1262711.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27073390.0285; train_optim_loss: 27073390.0285; val_kl_reg_loss: 23338.2688; val_edge_recon_loss: 26260539.5636; val_gene_expr_recon_loss: 1261119.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27544997.7273; val_optim_loss: 27544997.7273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9892; val_auprc_score: 0.9872; val_best_acc_score: 0.9539; val_best_f1_score: 0.9544; train_kl_reg_loss: 24302.4816; train_edge_recon_loss: 25764951.1711; train_gene_expr_recon_loss: 1250241.5157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27039495.2098; train_optim_loss: 27039495.2098; val_kl_reg_loss: 24173.1840; val_edge_recon_loss: 26262748.6727; val_gene_expr_recon_loss: 1247987.3068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27534909.1636; val_optim_loss: 27534909.1636
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9876; val_best_acc_score: 0.9538; val_best_f1_score: 0.9541; train_kl_reg_loss: 24904.9857; train_edge_recon_loss: 25755312.7597; train_gene_expr_recon_loss: 1248327.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27028545.6354; train_optim_loss: 27028545.6354; val_kl_reg_loss: 24443.0696; val_edge_recon_loss: 26233506.8727; val_gene_expr_recon_loss: 1249037.3159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27506987.4364; val_optim_loss: 27506987.4364
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9883; val_best_acc_score: 0.9550; val_best_f1_score: 0.9553; train_kl_reg_loss: 24968.0833; train_edge_recon_loss: 25742591.2383; train_gene_expr_recon_loss: 1247165.4879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27014724.8086; train_optim_loss: 27014724.8086; val_kl_reg_loss: 24210.6576; val_edge_recon_loss: 26215680.1091; val_gene_expr_recon_loss: 1247055.4080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27486946.0364; val_optim_loss: 27486946.0364
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9895; val_auprc_score: 0.9876; val_best_acc_score: 0.9551; val_best_f1_score: 0.9555; train_kl_reg_loss: 24869.6384; train_edge_recon_loss: 25749311.8961; train_gene_expr_recon_loss: 1246784.8102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27020966.3198; train_optim_loss: 27020966.3198; val_kl_reg_loss: 24169.0928; val_edge_recon_loss: 26211496.0909; val_gene_expr_recon_loss: 1248218.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27483883.6727; val_optim_loss: 27483883.6727
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9553; val_best_f1_score: 0.9556; train_kl_reg_loss: 24864.0373; train_edge_recon_loss: 25752224.7108; train_gene_expr_recon_loss: 1247083.9631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27024172.7230; train_optim_loss: 27024172.7230; val_kl_reg_loss: 24277.5616; val_edge_recon_loss: 26228497.1636; val_gene_expr_recon_loss: 1246191.4011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27498966.1091; val_optim_loss: 27498966.1091
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9900; val_auprc_score: 0.9881; val_best_acc_score: 0.9553; val_best_f1_score: 0.9556; train_kl_reg_loss: 24789.6252; train_edge_recon_loss: 25743786.6090; train_gene_expr_recon_loss: 1246498.7513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27015074.9939; train_optim_loss: 27015074.9939; val_kl_reg_loss: 23961.8221; val_edge_recon_loss: 26214264.7818; val_gene_expr_recon_loss: 1245818.7170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27484045.4545; val_optim_loss: 27484045.4545
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9902; val_auprc_score: 0.9886; val_best_acc_score: 0.9560; val_best_f1_score: 0.9562; train_kl_reg_loss: 24548.7338; train_edge_recon_loss: 25746897.3381; train_gene_expr_recon_loss: 1246017.0715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27017463.1324; train_optim_loss: 27017463.1324; val_kl_reg_loss: 23762.3543; val_edge_recon_loss: 26207054.6364; val_gene_expr_recon_loss: 1247402.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27478219.2364; val_optim_loss: 27478219.2364
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9901; val_auprc_score: 0.9885; val_best_acc_score: 0.9551; val_best_f1_score: 0.9555; train_kl_reg_loss: 24478.1305; train_edge_recon_loss: 25753422.1955; train_gene_expr_recon_loss: 1245332.1106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27023232.3707; train_optim_loss: 27023232.3707; val_kl_reg_loss: 23925.9145; val_edge_recon_loss: 26207175.1636; val_gene_expr_recon_loss: 1244730.9170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27475831.9455; val_optim_loss: 27475831.9455
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9901; val_auprc_score: 0.9884; val_best_acc_score: 0.9555; val_best_f1_score: 0.9557; train_kl_reg_loss: 24502.3996; train_edge_recon_loss: 25748387.3218; train_gene_expr_recon_loss: 1245613.3569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27018503.0367; train_optim_loss: 27018503.0367; val_kl_reg_loss: 23800.1311; val_edge_recon_loss: 26219103.0182; val_gene_expr_recon_loss: 1245617.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27488520.2727; val_optim_loss: 27488520.2727
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9903; val_auprc_score: 0.9885; val_best_acc_score: 0.9563; val_best_f1_score: 0.9565; train_kl_reg_loss: 24419.6815; train_edge_recon_loss: 25754226.7699; train_gene_expr_recon_loss: 1245099.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27023746.0448; train_optim_loss: 27023746.0448; val_kl_reg_loss: 23966.9105; val_edge_recon_loss: 26211183.3455; val_gene_expr_recon_loss: 1244274.5580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27479424.8182; val_optim_loss: 27479424.8182
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9902; val_auprc_score: 0.9886; val_best_acc_score: 0.9559; val_best_f1_score: 0.9564; train_kl_reg_loss: 24307.0068; train_edge_recon_loss: 25737064.8269; train_gene_expr_recon_loss: 1245192.1338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27006563.9348; train_optim_loss: 27006563.9348; val_kl_reg_loss: 23675.1039; val_edge_recon_loss: 26206293.9273; val_gene_expr_recon_loss: 1245829.7114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27475798.7818; val_optim_loss: 27475798.7818
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9562; val_best_f1_score: 0.9567; train_kl_reg_loss: 24344.6425; train_edge_recon_loss: 25740486.8411; train_gene_expr_recon_loss: 1244694.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27009525.6925; train_optim_loss: 27009525.6925; val_kl_reg_loss: 23680.5537; val_edge_recon_loss: 26202824.5273; val_gene_expr_recon_loss: 1244213.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27470718.2545; val_optim_loss: 27470718.2545
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9566; val_best_f1_score: 0.9568; train_kl_reg_loss: 24143.5210; train_edge_recon_loss: 25739525.9715; train_gene_expr_recon_loss: 1244362.0829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27008031.5804; train_optim_loss: 27008031.5804; val_kl_reg_loss: 23473.1303; val_edge_recon_loss: 26176910.2000; val_gene_expr_recon_loss: 1245650.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27446034.2909; val_optim_loss: 27446034.2909
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9884; val_best_acc_score: 0.9562; val_best_f1_score: 0.9566; train_kl_reg_loss: 24009.8740; train_edge_recon_loss: 25740921.1609; train_gene_expr_recon_loss: 1244112.3306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27009043.3768; train_optim_loss: 27009043.3768; val_kl_reg_loss: 23289.6696; val_edge_recon_loss: 26204443.2182; val_gene_expr_recon_loss: 1245367.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27473100.0364; val_optim_loss: 27473100.0364
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9906; val_auprc_score: 0.9889; val_best_acc_score: 0.9568; val_best_f1_score: 0.9571; train_kl_reg_loss: 24080.0034; train_edge_recon_loss: 25740881.4033; train_gene_expr_recon_loss: 1243877.0288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27008838.4216; train_optim_loss: 27008838.4216; val_kl_reg_loss: 23448.4104; val_edge_recon_loss: 26195384.9091; val_gene_expr_recon_loss: 1243677.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27462511.2364; val_optim_loss: 27462511.2364
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9570; val_best_f1_score: 0.9574; train_kl_reg_loss: 24106.6775; train_edge_recon_loss: 25738515.4358; train_gene_expr_recon_loss: 1243921.8642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27006543.9776; train_optim_loss: 27006543.9776; val_kl_reg_loss: 23545.7296; val_edge_recon_loss: 26191680.0364; val_gene_expr_recon_loss: 1243720.4239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27458946.2545; val_optim_loss: 27458946.2545
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9557; val_best_f1_score: 0.9561; train_kl_reg_loss: 23972.7810; train_edge_recon_loss: 25742173.6477; train_gene_expr_recon_loss: 1243733.5848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27009879.9898; train_optim_loss: 27009879.9898; val_kl_reg_loss: 23294.5940; val_edge_recon_loss: 26201065.9455; val_gene_expr_recon_loss: 1245462.9841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27469823.5273; val_optim_loss: 27469823.5273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 23898.5018; train_edge_recon_loss: 25734189.9246; train_gene_expr_recon_loss: 1242711.1011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27000799.5519; train_optim_loss: 27000799.5519; val_kl_reg_loss: 23353.9694; val_edge_recon_loss: 26218360.2182; val_gene_expr_recon_loss: 1244342.6420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27486056.9818; val_optim_loss: 27486056.9818
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9909; val_auprc_score: 0.9896; val_best_acc_score: 0.9567; val_best_f1_score: 0.9571; train_kl_reg_loss: 23925.0760; train_edge_recon_loss: 25738392.1996; train_gene_expr_recon_loss: 1242230.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27004547.9898; train_optim_loss: 27004547.9898; val_kl_reg_loss: 23379.4328; val_edge_recon_loss: 26184029.8545; val_gene_expr_recon_loss: 1242629.0932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27450038.5091; val_optim_loss: 27450038.5091
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9557; val_best_f1_score: 0.9560; train_kl_reg_loss: 23959.5007; train_edge_recon_loss: 25736480.0265; train_gene_expr_recon_loss: 1242160.2890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27002599.8126; train_optim_loss: 27002599.8126; val_kl_reg_loss: 23434.3536; val_edge_recon_loss: 26203608.9818; val_gene_expr_recon_loss: 1241763.7545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27468807.0909; val_optim_loss: 27468807.0909
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9888; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 23924.5616; train_edge_recon_loss: 25738154.4277; train_gene_expr_recon_loss: 1241756.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27003835.2261; train_optim_loss: 27003835.2261; val_kl_reg_loss: 23357.8909; val_edge_recon_loss: 26199994.7273; val_gene_expr_recon_loss: 1242835.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27466187.9091; val_optim_loss: 27466187.9091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 121 min 23 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9905
Val AUPRC score: 0.9889
Val best accuracy score: 0.9570
Val best F1 score: 0.9573
Val gene expr MSE score: 8.7575

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
