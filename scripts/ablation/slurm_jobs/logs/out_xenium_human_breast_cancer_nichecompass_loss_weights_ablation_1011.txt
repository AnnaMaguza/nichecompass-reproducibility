None
Run timestamp: 15072023_230918_1011.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1011']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9880; val_auprc_score: 0.9857; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 16186.0466; train_edge_recon_loss: 26338306.9154; train_gene_expr_recon_loss: 1342873.8688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27697366.8154; train_optim_loss: 27697366.8154; val_kl_reg_loss: 14808.6284; val_edge_recon_loss: 26108224.3693; val_gene_expr_recon_loss: 1277433.3310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27400466.2997; val_optim_loss: 27400466.2997
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9880; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 15483.9891; train_edge_recon_loss: 25895614.5718; train_gene_expr_recon_loss: 1262428.8190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27173527.3770; train_optim_loss: 27173527.3770; val_kl_reg_loss: 15791.0331; val_edge_recon_loss: 25959546.6620; val_gene_expr_recon_loss: 1251396.5222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27226734.2648; val_optim_loss: 27226734.2648
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 16114.3343; train_edge_recon_loss: 25812117.4763; train_gene_expr_recon_loss: 1249845.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27078076.8231; train_optim_loss: 27078076.8231; val_kl_reg_loss: 16267.0744; val_edge_recon_loss: 25930823.1498; val_gene_expr_recon_loss: 1246748.4578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27193838.6481; val_optim_loss: 27193838.6481
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 16385.3820; train_edge_recon_loss: 25765738.6245; train_gene_expr_recon_loss: 1245501.3922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27027625.4399; train_optim_loss: 27027625.4399; val_kl_reg_loss: 16664.9583; val_edge_recon_loss: 25897390.5366; val_gene_expr_recon_loss: 1245373.6803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27159429.1498; val_optim_loss: 27159429.1498
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 16532.8993; train_edge_recon_loss: 25730880.6734; train_gene_expr_recon_loss: 1244327.6202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26991741.1598; train_optim_loss: 26991741.1598; val_kl_reg_loss: 16502.0338; val_edge_recon_loss: 25915868.2927; val_gene_expr_recon_loss: 1241597.5762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27173967.9024; val_optim_loss: 27173967.9024
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 16661.0273; train_edge_recon_loss: 25710917.3351; train_gene_expr_recon_loss: 1243176.0637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26970754.4189; train_optim_loss: 26970754.4189; val_kl_reg_loss: 16055.0835; val_edge_recon_loss: 25793918.7805; val_gene_expr_recon_loss: 1241580.9220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27051554.7875; val_optim_loss: 27051554.7875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9936; val_auprc_score: 0.9913; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 16704.9884; train_edge_recon_loss: 25691033.8867; train_gene_expr_recon_loss: 1242079.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26949818.5299; train_optim_loss: 26949818.5299; val_kl_reg_loss: 16438.2904; val_edge_recon_loss: 25734725.9373; val_gene_expr_recon_loss: 1242348.6847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26993512.8780; val_optim_loss: 26993512.8780
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 16777.7796; train_edge_recon_loss: 25671993.4802; train_gene_expr_recon_loss: 1241256.8970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26930028.1474; train_optim_loss: 26930028.1474; val_kl_reg_loss: 16503.2867; val_edge_recon_loss: 25774477.0732; val_gene_expr_recon_loss: 1245361.7108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27036342.0697; val_optim_loss: 27036342.0697
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9941; val_auprc_score: 0.9922; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 16800.6755; train_edge_recon_loss: 25655165.5865; train_gene_expr_recon_loss: 1241504.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26913470.3010; train_optim_loss: 26913470.3010; val_kl_reg_loss: 17018.0929; val_edge_recon_loss: 25770363.6098; val_gene_expr_recon_loss: 1240246.6921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27027628.4251; val_optim_loss: 27027628.4251
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 16821.0125; train_edge_recon_loss: 25647120.2552; train_gene_expr_recon_loss: 1241107.1184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26905048.3770; train_optim_loss: 26905048.3770; val_kl_reg_loss: 16618.8504; val_edge_recon_loss: 25712538.6690; val_gene_expr_recon_loss: 1241701.8027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26970859.4146; val_optim_loss: 26970859.4146
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 16855.0139; train_edge_recon_loss: 25631386.4779; train_gene_expr_recon_loss: 1240858.0559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26889099.5609; train_optim_loss: 26889099.5609; val_kl_reg_loss: 16498.2767; val_edge_recon_loss: 25691835.4564; val_gene_expr_recon_loss: 1239897.5383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26948231.2822; val_optim_loss: 26948231.2822
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 16876.8923; train_edge_recon_loss: 25629040.9814; train_gene_expr_recon_loss: 1240622.4098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26886540.2979; train_optim_loss: 26886540.2979; val_kl_reg_loss: 16666.2999; val_edge_recon_loss: 25704520.9965; val_gene_expr_recon_loss: 1238551.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26959739.1847; val_optim_loss: 26959739.1847
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 16925.3521; train_edge_recon_loss: 25610955.1148; train_gene_expr_recon_loss: 1240296.7548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26868177.1971; train_optim_loss: 26868177.1971; val_kl_reg_loss: 16941.7928; val_edge_recon_loss: 25658094.6551; val_gene_expr_recon_loss: 1240028.9978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26915065.4355; val_optim_loss: 26915065.4355
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 16910.3487; train_edge_recon_loss: 25599162.8394; train_gene_expr_recon_loss: 1240127.5075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26856200.6695; train_optim_loss: 26856200.6695; val_kl_reg_loss: 17007.1749; val_edge_recon_loss: 25688276.9826; val_gene_expr_recon_loss: 1243129.3088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26948413.5122; val_optim_loss: 26948413.5122
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 16939.1818; train_edge_recon_loss: 25598852.4337; train_gene_expr_recon_loss: 1240466.8226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26856258.4538; train_optim_loss: 26856258.4538; val_kl_reg_loss: 17193.3749; val_edge_recon_loss: 25683747.3171; val_gene_expr_recon_loss: 1241342.4834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26942283.2195; val_optim_loss: 26942283.2195
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9942; val_auprc_score: 0.9921; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 16953.8256; train_edge_recon_loss: 25593128.4500; train_gene_expr_recon_loss: 1239689.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26849772.1319; train_optim_loss: 26849772.1319; val_kl_reg_loss: 17309.3558; val_edge_recon_loss: 25745401.1986; val_gene_expr_recon_loss: 1240180.3458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27002890.9408; val_optim_loss: 27002890.9408
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 16980.0430; train_edge_recon_loss: 25585798.9635; train_gene_expr_recon_loss: 1239753.4207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26842532.4391; train_optim_loss: 26842532.4391; val_kl_reg_loss: 17410.1970; val_edge_recon_loss: 25635390.5854; val_gene_expr_recon_loss: 1240595.2879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26893396.0627; val_optim_loss: 26893396.0627
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 16966.4112; train_edge_recon_loss: 25575558.2801; train_gene_expr_recon_loss: 1239710.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26832235.1094; train_optim_loss: 26832235.1094; val_kl_reg_loss: 17207.0760; val_edge_recon_loss: 25627412.2160; val_gene_expr_recon_loss: 1239391.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26884010.9268; val_optim_loss: 26884010.9268
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 16971.0203; train_edge_recon_loss: 25573275.6711; train_gene_expr_recon_loss: 1240105.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26830352.2979; train_optim_loss: 26830352.2979; val_kl_reg_loss: 16980.9336; val_edge_recon_loss: 25644866.4181; val_gene_expr_recon_loss: 1238964.6132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26900811.9233; val_optim_loss: 26900811.9233
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 16977.8948; train_edge_recon_loss: 25560252.7137; train_gene_expr_recon_loss: 1239928.8693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26817159.4787; train_optim_loss: 26817159.4787; val_kl_reg_loss: 16535.8075; val_edge_recon_loss: 25598584.2091; val_gene_expr_recon_loss: 1240548.6577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26855668.7038; val_optim_loss: 26855668.7038
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 16967.5686; train_edge_recon_loss: 25557276.9147; train_gene_expr_recon_loss: 1239891.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26814136.1381; train_optim_loss: 26814136.1381; val_kl_reg_loss: 16553.6708; val_edge_recon_loss: 25606163.8049; val_gene_expr_recon_loss: 1238098.0688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26860815.5958; val_optim_loss: 26860815.5958
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9929; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 16991.0910; train_edge_recon_loss: 25560643.1730; train_gene_expr_recon_loss: 1239889.2267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26817523.4670; train_optim_loss: 26817523.4670; val_kl_reg_loss: 17227.8453; val_edge_recon_loss: 25606440.5366; val_gene_expr_recon_loss: 1242062.6607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26865731.0523; val_optim_loss: 26865731.0523
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 17005.1956; train_edge_recon_loss: 25556279.4608; train_gene_expr_recon_loss: 1239127.0074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26812411.6843; train_optim_loss: 26812411.6843; val_kl_reg_loss: 17065.7300; val_edge_recon_loss: 25592857.2404; val_gene_expr_recon_loss: 1239340.1280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26849263.1220; val_optim_loss: 26849263.1220
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9945; val_auprc_score: 0.9924; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17004.1483; train_edge_recon_loss: 25550007.5283; train_gene_expr_recon_loss: 1239913.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26806925.5803; train_optim_loss: 26806925.5803; val_kl_reg_loss: 17176.3435; val_edge_recon_loss: 25596647.4495; val_gene_expr_recon_loss: 1236862.8262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26850686.6551; val_optim_loss: 26850686.6551
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 17003.9874; train_edge_recon_loss: 25548388.9116; train_gene_expr_recon_loss: 1239740.1813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26805133.0551; train_optim_loss: 26805133.0551; val_kl_reg_loss: 16998.4889; val_edge_recon_loss: 25598237.8188; val_gene_expr_recon_loss: 1241291.6145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26856527.9652; val_optim_loss: 26856527.9652
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9945; val_auprc_score: 0.9923; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 17047.7590; train_edge_recon_loss: 25540173.8945; train_gene_expr_recon_loss: 1239903.4422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26797125.0853; train_optim_loss: 26797125.0853; val_kl_reg_loss: 16680.7890; val_edge_recon_loss: 25576024.0279; val_gene_expr_recon_loss: 1242135.5871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26834840.3833; val_optim_loss: 26834840.3833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9945; val_auprc_score: 0.9923; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 17076.9112; train_edge_recon_loss: 25539379.9721; train_gene_expr_recon_loss: 1239531.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26795988.2358; train_optim_loss: 26795988.2358; val_kl_reg_loss: 16849.3177; val_edge_recon_loss: 25587678.2369; val_gene_expr_recon_loss: 1242736.4856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26847263.9721; val_optim_loss: 26847263.9721
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 17063.1805; train_edge_recon_loss: 25536571.8875; train_gene_expr_recon_loss: 1239750.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26793385.6152; train_optim_loss: 26793385.6152; val_kl_reg_loss: 16960.1359; val_edge_recon_loss: 25601378.5993; val_gene_expr_recon_loss: 1238883.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26857222.6132; val_optim_loss: 26857222.6132
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 17088.7834; train_edge_recon_loss: 25530658.3336; train_gene_expr_recon_loss: 1239518.5134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26787265.6175; train_optim_loss: 26787265.6175; val_kl_reg_loss: 16821.3024; val_edge_recon_loss: 25573142.9129; val_gene_expr_recon_loss: 1241013.4307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26830977.6028; val_optim_loss: 26830977.6028
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9946; val_auprc_score: 0.9923; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17098.3088; train_edge_recon_loss: 25532313.5881; train_gene_expr_recon_loss: 1239378.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26788790.4608; train_optim_loss: 26788790.4608; val_kl_reg_loss: 17269.9344; val_edge_recon_loss: 25593180.8502; val_gene_expr_recon_loss: 1240386.2409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26850837.0732; val_optim_loss: 26850837.0732
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 17102.8215; train_edge_recon_loss: 25523028.2645; train_gene_expr_recon_loss: 1239360.9540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26779492.0248; train_optim_loss: 26779492.0248; val_kl_reg_loss: 16954.9920; val_edge_recon_loss: 25563889.4634; val_gene_expr_recon_loss: 1239229.1124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26820073.5679; val_optim_loss: 26820073.5679
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 17126.8335; train_edge_recon_loss: 25515739.8301; train_gene_expr_recon_loss: 1239704.4438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26772571.0985; train_optim_loss: 26772571.0985; val_kl_reg_loss: 17047.0887; val_edge_recon_loss: 25550939.1638; val_gene_expr_recon_loss: 1240175.7017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26808161.9652; val_optim_loss: 26808161.9652
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9943; val_auprc_score: 0.9920; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 17153.8555; train_edge_recon_loss: 25516133.3926; train_gene_expr_recon_loss: 1239488.7650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26772776.0310; train_optim_loss: 26772776.0310; val_kl_reg_loss: 17142.5703; val_edge_recon_loss: 25579162.2021; val_gene_expr_recon_loss: 1239334.7513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26835639.5958; val_optim_loss: 26835639.5958
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17162.7555; train_edge_recon_loss: 25517208.7680; train_gene_expr_recon_loss: 1239644.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26774016.3786; train_optim_loss: 26774016.3786; val_kl_reg_loss: 17113.0018; val_edge_recon_loss: 25563328.3066; val_gene_expr_recon_loss: 1236996.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26817437.4495; val_optim_loss: 26817437.4495
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9943; val_auprc_score: 0.9923; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 17187.0264; train_edge_recon_loss: 25510487.2459; train_gene_expr_recon_loss: 1240060.3641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26767734.6439; train_optim_loss: 26767734.6439; val_kl_reg_loss: 16869.3839; val_edge_recon_loss: 25552031.1847; val_gene_expr_recon_loss: 1240150.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26809051.1638; val_optim_loss: 26809051.1638
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9942; val_auprc_score: 0.9918; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 17188.6196; train_edge_recon_loss: 25509421.6718; train_gene_expr_recon_loss: 1239656.8645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26766267.1606; train_optim_loss: 26766267.1606; val_kl_reg_loss: 17198.1049; val_edge_recon_loss: 25542183.6167; val_gene_expr_recon_loss: 1238331.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26797713.1150; val_optim_loss: 26797713.1150
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9943; val_auprc_score: 0.9921; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 17220.8346; train_edge_recon_loss: 25505800.9922; train_gene_expr_recon_loss: 1239695.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26762716.9085; train_optim_loss: 26762716.9085; val_kl_reg_loss: 17291.1440; val_edge_recon_loss: 25546223.5401; val_gene_expr_recon_loss: 1238072.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26801587.3519; val_optim_loss: 26801587.3519
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9942; val_auprc_score: 0.9920; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17238.3086; train_edge_recon_loss: 25505136.9953; train_gene_expr_recon_loss: 1239977.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26762353.0085; train_optim_loss: 26762353.0085; val_kl_reg_loss: 16973.1796; val_edge_recon_loss: 25540172.5436; val_gene_expr_recon_loss: 1240921.0205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26798066.6620; val_optim_loss: 26798066.6620
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 17270.0064; train_edge_recon_loss: 25499298.2754; train_gene_expr_recon_loss: 1239748.9992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26756317.2886; train_optim_loss: 26756317.2886; val_kl_reg_loss: 17340.9714; val_edge_recon_loss: 25523275.2753; val_gene_expr_recon_loss: 1239912.7709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26780529.1080; val_optim_loss: 26780529.1080
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 17290.0637; train_edge_recon_loss: 25492530.2894; train_gene_expr_recon_loss: 1239828.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26749648.6168; train_optim_loss: 26749648.6168; val_kl_reg_loss: 17180.8272; val_edge_recon_loss: 25532914.8362; val_gene_expr_recon_loss: 1239352.1934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26789447.8049; val_optim_loss: 26789447.8049
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9943; val_auprc_score: 0.9922; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 17303.1543; train_edge_recon_loss: 25494057.9193; train_gene_expr_recon_loss: 1239807.9004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26751168.9814; train_optim_loss: 26751168.9814; val_kl_reg_loss: 17395.5273; val_edge_recon_loss: 25529227.2822; val_gene_expr_recon_loss: 1239938.9403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26786561.7073; val_optim_loss: 26786561.7073
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9940; val_auprc_score: 0.9916; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17339.5940; train_edge_recon_loss: 25495171.7013; train_gene_expr_recon_loss: 1239159.6243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26751670.9085; train_optim_loss: 26751670.9085; val_kl_reg_loss: 17451.9339; val_edge_recon_loss: 25537819.9721; val_gene_expr_recon_loss: 1240068.0963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26795339.9791; val_optim_loss: 26795339.9791
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9942; val_auprc_score: 0.9920; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 17348.7717; train_edge_recon_loss: 25485501.8953; train_gene_expr_recon_loss: 1239555.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26742406.3794; train_optim_loss: 26742406.3794; val_kl_reg_loss: 17260.3986; val_edge_recon_loss: 25541888.6202; val_gene_expr_recon_loss: 1238591.8062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26797740.8223; val_optim_loss: 26797740.8223

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9946; val_auprc_score: 0.9924; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 17476.7507; train_edge_recon_loss: 25466480.1939; train_gene_expr_recon_loss: 1229134.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26713091.0791; train_optim_loss: 26713091.0791; val_kl_reg_loss: 17472.9219; val_edge_recon_loss: 25502468.0000; val_gene_expr_recon_loss: 1229092.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26749033.7840; val_optim_loss: 26749033.7840
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9943; val_auprc_score: 0.9922; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 17495.3410; train_edge_recon_loss: 25464549.4694; train_gene_expr_recon_loss: 1228449.1053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26710493.9201; train_optim_loss: 26710493.9201; val_kl_reg_loss: 17426.3490; val_edge_recon_loss: 25493110.8084; val_gene_expr_recon_loss: 1229703.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26740240.8641; val_optim_loss: 26740240.8641
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 17461.4608; train_edge_recon_loss: 25462887.5058; train_gene_expr_recon_loss: 1228507.9772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26708856.9216; train_optim_loss: 26708856.9216; val_kl_reg_loss: 17435.4335; val_edge_recon_loss: 25479585.0941; val_gene_expr_recon_loss: 1229296.3132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26726316.8223; val_optim_loss: 26726316.8223
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 17454.2648; train_edge_recon_loss: 25455914.8130; train_gene_expr_recon_loss: 1228550.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26701919.7851; train_optim_loss: 26701919.7851; val_kl_reg_loss: 17421.5469; val_edge_recon_loss: 25482856.3624; val_gene_expr_recon_loss: 1228388.5775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26728666.4669; val_optim_loss: 26728666.4669
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 17433.9223; train_edge_recon_loss: 25461247.5112; train_gene_expr_recon_loss: 1228178.8067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26706860.2227; train_optim_loss: 26706860.2227; val_kl_reg_loss: 17468.0654; val_edge_recon_loss: 25484846.1603; val_gene_expr_recon_loss: 1228195.5209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26730509.7352; val_optim_loss: 26730509.7352
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9945; val_auprc_score: 0.9923; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 17422.4280; train_edge_recon_loss: 25460669.4011; train_gene_expr_recon_loss: 1228230.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26706322.4701; train_optim_loss: 26706322.4701; val_kl_reg_loss: 17415.7239; val_edge_recon_loss: 25486582.6969; val_gene_expr_recon_loss: 1227879.2073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731877.6237; val_optim_loss: 26731877.6237
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9945; val_auprc_score: 0.9923; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 17421.9321; train_edge_recon_loss: 25455793.7238; train_gene_expr_recon_loss: 1228413.8193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26701629.4469; train_optim_loss: 26701629.4469; val_kl_reg_loss: 17554.2629; val_edge_recon_loss: 25486665.1777; val_gene_expr_recon_loss: 1227458.2265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26731677.7073; val_optim_loss: 26731677.7073

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 17457.7304; train_edge_recon_loss: 25459289.2878; train_gene_expr_recon_loss: 1227003.5399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26703750.5687; train_optim_loss: 26703750.5687; val_kl_reg_loss: 17432.1382; val_edge_recon_loss: 25493664.6690; val_gene_expr_recon_loss: 1227759.0832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26738855.9930; val_optim_loss: 26738855.9930
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 17442.6711; train_edge_recon_loss: 25457827.1893; train_gene_expr_recon_loss: 1227271.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26702540.9038; train_optim_loss: 26702540.9038; val_kl_reg_loss: 17450.9979; val_edge_recon_loss: 25497881.4146; val_gene_expr_recon_loss: 1227966.0706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26743298.5575; val_optim_loss: 26743298.5575
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 17446.1042; train_edge_recon_loss: 25457489.7556; train_gene_expr_recon_loss: 1226547.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26701483.1078; train_optim_loss: 26701483.1078; val_kl_reg_loss: 17415.4803; val_edge_recon_loss: 25490982.5087; val_gene_expr_recon_loss: 1226986.9077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26735384.9338; val_optim_loss: 26735384.9338
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9945; val_auprc_score: 0.9922; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 17443.2649; train_edge_recon_loss: 25457233.3041; train_gene_expr_recon_loss: 1226970.5207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26701647.0465; train_optim_loss: 26701647.0465; val_kl_reg_loss: 17447.8021; val_edge_recon_loss: 25481686.2509; val_gene_expr_recon_loss: 1227718.7726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26726852.7666; val_optim_loss: 26726852.7666

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1323 min 27 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9924
Val best accuracy score: 0.9794
Val best F1 score: 0.9796
Val gene expr MSE score: 2.6469

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
