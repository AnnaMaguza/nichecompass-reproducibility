None
Run timestamp: 02072023_053747_2007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_2007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9850; val_auprc_score: 0.9818; val_best_acc_score: 0.9443; val_best_f1_score: 0.9455; train_kl_reg_loss: 5221.9897; train_edge_recon_loss: 264120.9161; train_gene_expr_recon_loss: 8620.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277963.5652; train_optim_loss: 277963.5652; val_kl_reg_loss: 5351.7577; val_edge_recon_loss: 261375.7366; val_gene_expr_recon_loss: 7910.1214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274637.6141; val_optim_loss: 274637.6141
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9892; val_auprc_score: 0.9866; val_best_acc_score: 0.9569; val_best_f1_score: 0.9577; train_kl_reg_loss: 5291.4454; train_edge_recon_loss: 260437.7346; train_gene_expr_recon_loss: 7731.2533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273460.4336; train_optim_loss: 273460.4336; val_kl_reg_loss: 5186.6917; val_edge_recon_loss: 259778.4767; val_gene_expr_recon_loss: 7493.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272458.8372; val_optim_loss: 272458.8372
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9909; val_auprc_score: 0.9884; val_best_acc_score: 0.9619; val_best_f1_score: 0.9625; train_kl_reg_loss: 5318.0866; train_edge_recon_loss: 259696.7919; train_gene_expr_recon_loss: 7488.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272503.3741; train_optim_loss: 272503.3741; val_kl_reg_loss: 5273.9314; val_edge_recon_loss: 260027.9619; val_gene_expr_recon_loss: 7335.1854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272637.0781; val_optim_loss: 272637.0781
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 5338.4213; train_edge_recon_loss: 259243.2555; train_gene_expr_recon_loss: 7363.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271944.8195; train_optim_loss: 271944.8195; val_kl_reg_loss: 5352.9741; val_edge_recon_loss: 259102.1743; val_gene_expr_recon_loss: 7203.4636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271658.6122; val_optim_loss: 271658.6122
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9926; val_auprc_score: 0.9910; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 5349.7723; train_edge_recon_loss: 258971.8574; train_gene_expr_recon_loss: 7281.9953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271603.6246; train_optim_loss: 271603.6246; val_kl_reg_loss: 5354.2160; val_edge_recon_loss: 259265.8882; val_gene_expr_recon_loss: 7201.0676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271821.1724; val_optim_loss: 271821.1724
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 5358.8740; train_edge_recon_loss: 258752.2160; train_gene_expr_recon_loss: 7219.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271330.0982; train_optim_loss: 271330.0982; val_kl_reg_loss: 5181.4205; val_edge_recon_loss: 258921.5707; val_gene_expr_recon_loss: 7128.4105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271231.4019; val_optim_loss: 271231.4019
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 5369.6761; train_edge_recon_loss: 258523.4286; train_gene_expr_recon_loss: 7172.9943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271066.0989; train_optim_loss: 271066.0989; val_kl_reg_loss: 5531.9161; val_edge_recon_loss: 258269.9486; val_gene_expr_recon_loss: 7050.1941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270852.0596; val_optim_loss: 270852.0596
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 5374.6552; train_edge_recon_loss: 258326.9227; train_gene_expr_recon_loss: 7129.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270831.2595; train_optim_loss: 270831.2595; val_kl_reg_loss: 5528.3824; val_edge_recon_loss: 258312.7967; val_gene_expr_recon_loss: 7039.3900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270880.5700; val_optim_loss: 270880.5700
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5382.1572; train_edge_recon_loss: 258220.5091; train_gene_expr_recon_loss: 7100.7288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270703.3951; train_optim_loss: 270703.3951; val_kl_reg_loss: 5493.8026; val_edge_recon_loss: 258097.4215; val_gene_expr_recon_loss: 6993.1514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270584.3754; val_optim_loss: 270584.3754
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 5389.8301; train_edge_recon_loss: 258089.2447; train_gene_expr_recon_loss: 7075.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270554.4872; train_optim_loss: 270554.4872; val_kl_reg_loss: 5321.9775; val_edge_recon_loss: 257639.8549; val_gene_expr_recon_loss: 6983.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269945.2501; val_optim_loss: 269945.2501
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 5394.6502; train_edge_recon_loss: 257969.4015; train_gene_expr_recon_loss: 7057.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270421.8502; train_optim_loss: 270421.8502; val_kl_reg_loss: 5514.4510; val_edge_recon_loss: 257486.6038; val_gene_expr_recon_loss: 6971.1563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269972.2107; val_optim_loss: 269972.2107
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9758; val_best_f1_score: 0.9762; train_kl_reg_loss: 5394.6615; train_edge_recon_loss: 257888.3387; train_gene_expr_recon_loss: 7039.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270322.2728; train_optim_loss: 270322.2728; val_kl_reg_loss: 5302.9823; val_edge_recon_loss: 257626.6236; val_gene_expr_recon_loss: 6939.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269868.7045; val_optim_loss: 269868.7045
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 5397.9617; train_edge_recon_loss: 257800.9449; train_gene_expr_recon_loss: 7025.6850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270224.5915; train_optim_loss: 270224.5915; val_kl_reg_loss: 5633.1614; val_edge_recon_loss: 257531.8573; val_gene_expr_recon_loss: 6941.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270106.3267; val_optim_loss: 270106.3267
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 5407.5877; train_edge_recon_loss: 257685.2234; train_gene_expr_recon_loss: 7016.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270109.4695; train_optim_loss: 270109.4695; val_kl_reg_loss: 5245.4089; val_edge_recon_loss: 257044.9641; val_gene_expr_recon_loss: 6923.7939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269214.1674; val_optim_loss: 269214.1674
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 5406.7821; train_edge_recon_loss: 257696.3920; train_gene_expr_recon_loss: 7009.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270112.2129; train_optim_loss: 270112.2129; val_kl_reg_loss: 5477.8535; val_edge_recon_loss: 257329.5685; val_gene_expr_recon_loss: 6901.1541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269708.5764; val_optim_loss: 269708.5764
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 5411.1218; train_edge_recon_loss: 257592.8473; train_gene_expr_recon_loss: 6998.8586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270002.8272; train_optim_loss: 270002.8272; val_kl_reg_loss: 5389.8654; val_edge_recon_loss: 257155.6060; val_gene_expr_recon_loss: 6917.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269462.5210; val_optim_loss: 269462.5210
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5411.6180; train_edge_recon_loss: 257531.1263; train_gene_expr_recon_loss: 6991.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269934.0649; train_optim_loss: 269934.0649; val_kl_reg_loss: 5214.2916; val_edge_recon_loss: 257046.6730; val_gene_expr_recon_loss: 6906.3950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269167.3596; val_optim_loss: 269167.3596
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5416.1656; train_edge_recon_loss: 257496.1672; train_gene_expr_recon_loss: 6985.4657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269897.7987; train_optim_loss: 269897.7987; val_kl_reg_loss: 5367.5240; val_edge_recon_loss: 256879.9594; val_gene_expr_recon_loss: 6917.0558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269164.5394; val_optim_loss: 269164.5394
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 5416.7852; train_edge_recon_loss: 257422.9934; train_gene_expr_recon_loss: 6980.3550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269820.1335; train_optim_loss: 269820.1335; val_kl_reg_loss: 5524.8148; val_edge_recon_loss: 257049.6948; val_gene_expr_recon_loss: 6868.3890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269442.8997; val_optim_loss: 269442.8997
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 5418.6687; train_edge_recon_loss: 257446.0045; train_gene_expr_recon_loss: 6973.4486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269838.1218; train_optim_loss: 269838.1218; val_kl_reg_loss: 5326.1040; val_edge_recon_loss: 257123.4691; val_gene_expr_recon_loss: 6877.8205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269327.3926; val_optim_loss: 269327.3926
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 5422.9948; train_edge_recon_loss: 257306.6271; train_gene_expr_recon_loss: 6970.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269699.7915; train_optim_loss: 269699.7915; val_kl_reg_loss: 5566.2388; val_edge_recon_loss: 256755.0867; val_gene_expr_recon_loss: 6877.4824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269198.8074; val_optim_loss: 269198.8074
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5425.8601; train_edge_recon_loss: 257238.7678; train_gene_expr_recon_loss: 6964.8522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269629.4801; train_optim_loss: 269629.4801; val_kl_reg_loss: 5386.5578; val_edge_recon_loss: 256799.3647; val_gene_expr_recon_loss: 6881.2201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269067.1431; val_optim_loss: 269067.1431
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 5425.9400; train_edge_recon_loss: 257245.4824; train_gene_expr_recon_loss: 6960.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269631.7517; train_optim_loss: 269631.7517; val_kl_reg_loss: 5556.8681; val_edge_recon_loss: 256631.0039; val_gene_expr_recon_loss: 6885.7702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269073.6418; val_optim_loss: 269073.6418
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 5427.8412; train_edge_recon_loss: 257224.9383; train_gene_expr_recon_loss: 6956.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269609.7030; train_optim_loss: 269609.7030; val_kl_reg_loss: 5605.0651; val_edge_recon_loss: 256605.5012; val_gene_expr_recon_loss: 6860.2011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269070.7680; val_optim_loss: 269070.7680
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 5432.4981; train_edge_recon_loss: 257133.0637; train_gene_expr_recon_loss: 6951.9261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269517.4877; train_optim_loss: 269517.4877; val_kl_reg_loss: 5368.1306; val_edge_recon_loss: 256745.9989; val_gene_expr_recon_loss: 6870.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268984.5814; val_optim_loss: 268984.5814
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5434.1037; train_edge_recon_loss: 257130.4367; train_gene_expr_recon_loss: 6950.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269514.7518; train_optim_loss: 269514.7518; val_kl_reg_loss: 5509.8095; val_edge_recon_loss: 256547.1895; val_gene_expr_recon_loss: 6864.0355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268921.0336; val_optim_loss: 268921.0336
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5434.3044; train_edge_recon_loss: 257107.4065; train_gene_expr_recon_loss: 6946.5239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269488.2347; train_optim_loss: 269488.2347; val_kl_reg_loss: 5458.8702; val_edge_recon_loss: 256534.3741; val_gene_expr_recon_loss: 6845.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268838.8252; val_optim_loss: 268838.8252
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5436.0917; train_edge_recon_loss: 257070.2301; train_gene_expr_recon_loss: 6945.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269451.6733; train_optim_loss: 269451.6733; val_kl_reg_loss: 5496.9751; val_edge_recon_loss: 256579.4573; val_gene_expr_recon_loss: 6859.8809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268936.3129; val_optim_loss: 268936.3129
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5436.9111; train_edge_recon_loss: 257062.5868; train_gene_expr_recon_loss: 6943.7113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269443.2091; train_optim_loss: 269443.2091; val_kl_reg_loss: 5454.2062; val_edge_recon_loss: 256593.4121; val_gene_expr_recon_loss: 6852.4722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268900.0904; val_optim_loss: 268900.0904
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 5437.6345; train_edge_recon_loss: 257026.1509; train_gene_expr_recon_loss: 6938.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269402.2963; train_optim_loss: 269402.2963; val_kl_reg_loss: 5358.7763; val_edge_recon_loss: 256235.6153; val_gene_expr_recon_loss: 6868.2645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268462.6570; val_optim_loss: 268462.6570
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5438.4371; train_edge_recon_loss: 256952.3692; train_gene_expr_recon_loss: 6939.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269330.5461; train_optim_loss: 269330.5461; val_kl_reg_loss: 5446.1924; val_edge_recon_loss: 256424.8079; val_gene_expr_recon_loss: 6848.4586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268719.4598; val_optim_loss: 268719.4598
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9803; val_best_f1_score: 0.9806; train_kl_reg_loss: 5438.5796; train_edge_recon_loss: 256963.0929; train_gene_expr_recon_loss: 6935.3668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269337.0390; train_optim_loss: 269337.0390; val_kl_reg_loss: 5448.7303; val_edge_recon_loss: 256222.9573; val_gene_expr_recon_loss: 6844.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268516.6273; val_optim_loss: 268516.6273
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5441.1668; train_edge_recon_loss: 256923.9979; train_gene_expr_recon_loss: 6933.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269298.1764; train_optim_loss: 269298.1764; val_kl_reg_loss: 5567.7926; val_edge_recon_loss: 256337.3434; val_gene_expr_recon_loss: 6849.6150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268754.7514; val_optim_loss: 268754.7514
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5445.3450; train_edge_recon_loss: 256857.8966; train_gene_expr_recon_loss: 6931.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269234.8631; train_optim_loss: 269234.8631; val_kl_reg_loss: 5504.3144; val_edge_recon_loss: 256728.0989; val_gene_expr_recon_loss: 6847.5103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269079.9231; val_optim_loss: 269079.9231

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5432.6133; train_edge_recon_loss: 256686.2736; train_gene_expr_recon_loss: 6892.5736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269011.4603; train_optim_loss: 269011.4603; val_kl_reg_loss: 5423.3387; val_edge_recon_loss: 256132.4495; val_gene_expr_recon_loss: 6801.3939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268357.1824; val_optim_loss: 268357.1824
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 5426.3381; train_edge_recon_loss: 256693.8691; train_gene_expr_recon_loss: 6886.9878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269007.1951; train_optim_loss: 269007.1951; val_kl_reg_loss: 5426.1582; val_edge_recon_loss: 255790.1959; val_gene_expr_recon_loss: 6796.7880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268013.1429; val_optim_loss: 268013.1429
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9951; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 5426.9845; train_edge_recon_loss: 256610.3883; train_gene_expr_recon_loss: 6883.1560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268920.5289; train_optim_loss: 268920.5289; val_kl_reg_loss: 5428.9985; val_edge_recon_loss: 255951.7095; val_gene_expr_recon_loss: 6798.6592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268179.3674; val_optim_loss: 268179.3674
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5424.5272; train_edge_recon_loss: 256593.4262; train_gene_expr_recon_loss: 6883.4415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268901.3953; train_optim_loss: 268901.3953; val_kl_reg_loss: 5415.8436; val_edge_recon_loss: 255874.1218; val_gene_expr_recon_loss: 6797.7745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268087.7398; val_optim_loss: 268087.7398
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 5423.9077; train_edge_recon_loss: 256615.9490; train_gene_expr_recon_loss: 6881.3921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268921.2488; train_optim_loss: 268921.2488; val_kl_reg_loss: 5397.4735; val_edge_recon_loss: 255832.1019; val_gene_expr_recon_loss: 6798.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268028.4573; val_optim_loss: 268028.4573
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 5422.6585; train_edge_recon_loss: 256592.0596; train_gene_expr_recon_loss: 6881.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268896.5295; train_optim_loss: 268896.5295; val_kl_reg_loss: 5405.6974; val_edge_recon_loss: 256040.3105; val_gene_expr_recon_loss: 6796.4542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268242.4632; val_optim_loss: 268242.4632

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5417.1060; train_edge_recon_loss: 256672.9134; train_gene_expr_recon_loss: 6877.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268967.1083; train_optim_loss: 268967.1083; val_kl_reg_loss: 5393.6205; val_edge_recon_loss: 256007.9875; val_gene_expr_recon_loss: 6795.7152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268197.3223; val_optim_loss: 268197.3223
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 5419.3763; train_edge_recon_loss: 256587.6957; train_gene_expr_recon_loss: 6876.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268883.8957; train_optim_loss: 268883.8957; val_kl_reg_loss: 5408.7406; val_edge_recon_loss: 255845.5189; val_gene_expr_recon_loss: 6788.9608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268043.2193; val_optim_loss: 268043.2193
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 5419.5234; train_edge_recon_loss: 256555.9880; train_gene_expr_recon_loss: 6875.5416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268851.0530; train_optim_loss: 268851.0530; val_kl_reg_loss: 5421.6226; val_edge_recon_loss: 255752.8325; val_gene_expr_recon_loss: 6797.2935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267971.7478; val_optim_loss: 267971.7478
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 5421.5145; train_edge_recon_loss: 256579.1343; train_gene_expr_recon_loss: 6877.1089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268877.7575; train_optim_loss: 268877.7575; val_kl_reg_loss: 5407.1580; val_edge_recon_loss: 255941.9338; val_gene_expr_recon_loss: 6796.6063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268145.6980; val_optim_loss: 268145.6980
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 5419.5275; train_edge_recon_loss: 256598.7249; train_gene_expr_recon_loss: 6875.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268893.3173; train_optim_loss: 268893.3173; val_kl_reg_loss: 5413.5439; val_edge_recon_loss: 255892.2063; val_gene_expr_recon_loss: 6789.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268095.5375; val_optim_loss: 268095.5375
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 5418.7659; train_edge_recon_loss: 256566.9710; train_gene_expr_recon_loss: 6875.5387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268861.2749; train_optim_loss: 268861.2749; val_kl_reg_loss: 5389.9174; val_edge_recon_loss: 255793.5821; val_gene_expr_recon_loss: 6796.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267979.9445; val_optim_loss: 267979.9445
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5416.9269; train_edge_recon_loss: 256666.7621; train_gene_expr_recon_loss: 6878.3795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268962.0685; train_optim_loss: 268962.0685; val_kl_reg_loss: 5399.7374; val_edge_recon_loss: 255925.1917; val_gene_expr_recon_loss: 6793.2481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268118.1776; val_optim_loss: 268118.1776

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5416.3388; train_edge_recon_loss: 256657.5607; train_gene_expr_recon_loss: 6875.4690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268949.3688; train_optim_loss: 268949.3688; val_kl_reg_loss: 5404.2595; val_edge_recon_loss: 255866.5849; val_gene_expr_recon_loss: 6797.0314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268067.8765; val_optim_loss: 268067.8765
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 5416.9825; train_edge_recon_loss: 256637.1526; train_gene_expr_recon_loss: 6873.0032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268927.1385; train_optim_loss: 268927.1385; val_kl_reg_loss: 5404.5175; val_edge_recon_loss: 255920.1205; val_gene_expr_recon_loss: 6796.0201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268120.6578; val_optim_loss: 268120.6578
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 5417.5551; train_edge_recon_loss: 256591.4147; train_gene_expr_recon_loss: 6875.2202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268884.1903; train_optim_loss: 268884.1903; val_kl_reg_loss: 5407.0452; val_edge_recon_loss: 255901.2845; val_gene_expr_recon_loss: 6801.1129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268109.4425; val_optim_loss: 268109.4425
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 5418.2259; train_edge_recon_loss: 256667.7713; train_gene_expr_recon_loss: 6873.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268959.9948; train_optim_loss: 268959.9948; val_kl_reg_loss: 5404.3929; val_edge_recon_loss: 255929.3111; val_gene_expr_recon_loss: 6786.0975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268119.8006; val_optim_loss: 268119.8006

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1039 min 44 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9955
Val best accuracy score: 0.9823
Val best F1 score: 0.9824
Val gene expr MSE score: 1.8000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
