None
Run timestamp: 16072023_075936_2007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9600; val_auprc_score: 0.9527; val_best_acc_score: 0.8963; val_best_f1_score: 0.9020; train_kl_reg_loss: 47042.6123; train_edge_recon_loss: 2773122.4908; train_gene_expr_recon_loss: 7106437.3962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9926602.5078; train_optim_loss: 9926602.5078; val_kl_reg_loss: 37724.2639; val_edge_recon_loss: 2694892.8188; val_gene_expr_recon_loss: 6729718.1672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9462335.2683; val_optim_loss: 9462335.2683
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9710; val_auprc_score: 0.9664; val_best_acc_score: 0.9132; val_best_f1_score: 0.9167; train_kl_reg_loss: 35705.3781; train_edge_recon_loss: 2673739.3263; train_gene_expr_recon_loss: 6656281.7640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9365726.4794; train_optim_loss: 9365726.4794; val_kl_reg_loss: 32530.0803; val_edge_recon_loss: 2675304.5984; val_gene_expr_recon_loss: 6602109.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9309943.9338; val_optim_loss: 9309943.9338
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9780; val_auprc_score: 0.9748; val_best_acc_score: 0.9256; val_best_f1_score: 0.9279; train_kl_reg_loss: 31036.9172; train_edge_recon_loss: 2659405.9272; train_gene_expr_recon_loss: 6575167.4825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9265610.3305; train_optim_loss: 9265610.3305; val_kl_reg_loss: 29299.3325; val_edge_recon_loss: 2662136.4599; val_gene_expr_recon_loss: 6548525.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9239961.2544; val_optim_loss: 9239961.2544
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9822; val_auprc_score: 0.9797; val_best_acc_score: 0.9341; val_best_f1_score: 0.9359; train_kl_reg_loss: 28336.0476; train_edge_recon_loss: 2648352.4466; train_gene_expr_recon_loss: 6541288.2126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9217976.7048; train_optim_loss: 9217976.7048; val_kl_reg_loss: 26684.8567; val_edge_recon_loss: 2654537.0253; val_gene_expr_recon_loss: 6528784.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9210005.8711; val_optim_loss: 9210005.8711
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9850; val_auprc_score: 0.9829; val_best_acc_score: 0.9399; val_best_f1_score: 0.9413; train_kl_reg_loss: 26944.4843; train_edge_recon_loss: 2639029.5796; train_gene_expr_recon_loss: 6520670.2149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9186644.2793; train_optim_loss: 9186644.2793; val_kl_reg_loss: 26092.4387; val_edge_recon_loss: 2647748.4146; val_gene_expr_recon_loss: 6511818.4425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9185659.3101; val_optim_loss: 9185659.3101
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9866; val_auprc_score: 0.9847; val_best_acc_score: 0.9449; val_best_f1_score: 0.9459; train_kl_reg_loss: 25888.9398; train_edge_recon_loss: 2633775.4462; train_gene_expr_recon_loss: 6506328.6274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9165993.0225; train_optim_loss: 9165993.0225; val_kl_reg_loss: 24974.1144; val_edge_recon_loss: 2641446.6237; val_gene_expr_recon_loss: 6500057.4373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9166478.2021; val_optim_loss: 9166478.2021
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9882; val_auprc_score: 0.9865; val_best_acc_score: 0.9492; val_best_f1_score: 0.9502; train_kl_reg_loss: 25151.5268; train_edge_recon_loss: 2629446.7108; train_gene_expr_recon_loss: 6497905.2081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9152503.4461; train_optim_loss: 9152503.4461; val_kl_reg_loss: 24421.9390; val_edge_recon_loss: 2635406.7300; val_gene_expr_recon_loss: 6506095.8240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9165924.4843; val_optim_loss: 9165924.4843
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9892; val_auprc_score: 0.9876; val_best_acc_score: 0.9518; val_best_f1_score: 0.9528; train_kl_reg_loss: 24668.9466; train_edge_recon_loss: 2625323.3120; train_gene_expr_recon_loss: 6489697.1385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9139689.3988; train_optim_loss: 9139689.3988; val_kl_reg_loss: 24481.3622; val_edge_recon_loss: 2636122.4713; val_gene_expr_recon_loss: 6503179.1847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9163783.0105; val_optim_loss: 9163783.0105
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9875; val_best_acc_score: 0.9527; val_best_f1_score: 0.9534; train_kl_reg_loss: 24274.7877; train_edge_recon_loss: 2623531.9857; train_gene_expr_recon_loss: 6478085.2228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9125892.0012; train_optim_loss: 9125892.0012; val_kl_reg_loss: 23999.9536; val_edge_recon_loss: 2632873.9991; val_gene_expr_recon_loss: 6495058.4617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9151932.4321; val_optim_loss: 9151932.4321
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9552; val_best_f1_score: 0.9558; train_kl_reg_loss: 23947.2616; train_edge_recon_loss: 2620220.8475; train_gene_expr_recon_loss: 6475384.8834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9119552.9882; train_optim_loss: 9119552.9882; val_kl_reg_loss: 23403.5652; val_edge_recon_loss: 2628685.5044; val_gene_expr_recon_loss: 6484453.0610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9136542.1551; val_optim_loss: 9136542.1551
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9899; val_auprc_score: 0.9882; val_best_acc_score: 0.9543; val_best_f1_score: 0.9551; train_kl_reg_loss: 23671.7792; train_edge_recon_loss: 2619465.2072; train_gene_expr_recon_loss: 6470060.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9113197.6197; train_optim_loss: 9113197.6197; val_kl_reg_loss: 23066.4446; val_edge_recon_loss: 2628093.1341; val_gene_expr_recon_loss: 6500189.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9151349.4634; val_optim_loss: 9151349.4634
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9903; val_auprc_score: 0.9885; val_best_acc_score: 0.9551; val_best_f1_score: 0.9560; train_kl_reg_loss: 23356.8269; train_edge_recon_loss: 2618196.4912; train_gene_expr_recon_loss: 6462632.1464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9104185.4709; train_optim_loss: 9104185.4709; val_kl_reg_loss: 23170.0089; val_edge_recon_loss: 2626813.4887; val_gene_expr_recon_loss: 6486156.6289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9136140.1254; val_optim_loss: 9136140.1254
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9560; val_best_f1_score: 0.9569; train_kl_reg_loss: 23199.4803; train_edge_recon_loss: 2616715.2028; train_gene_expr_recon_loss: 6464088.8382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9104003.5258; train_optim_loss: 9104003.5258; val_kl_reg_loss: 23498.7034; val_edge_recon_loss: 2626526.8876; val_gene_expr_recon_loss: 6494007.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9144033.0767; val_optim_loss: 9144033.0767
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9569; val_best_f1_score: 0.9576; train_kl_reg_loss: 22947.5557; train_edge_recon_loss: 2616014.5718; train_gene_expr_recon_loss: 6459724.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9098686.1288; train_optim_loss: 9098686.1288; val_kl_reg_loss: 22927.5250; val_edge_recon_loss: 2623673.7718; val_gene_expr_recon_loss: 6487078.1202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9133679.3902; val_optim_loss: 9133679.3902
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 22773.6296; train_edge_recon_loss: 2615042.7017; train_gene_expr_recon_loss: 6457289.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9095106.1491; train_optim_loss: 9095106.1491; val_kl_reg_loss: 22682.5440; val_edge_recon_loss: 2624664.8389; val_gene_expr_recon_loss: 6495453.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9142800.7561; val_optim_loss: 9142800.7561
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 22610.5238; train_edge_recon_loss: 2613501.7640; train_gene_expr_recon_loss: 6452089.8033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9088202.0974; train_optim_loss: 9088202.0974; val_kl_reg_loss: 21917.1128; val_edge_recon_loss: 2619753.8223; val_gene_expr_recon_loss: 6486702.9564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9128373.8868; val_optim_loss: 9128373.8868
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9911; val_auprc_score: 0.9895; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 22446.3865; train_edge_recon_loss: 2613336.8103; train_gene_expr_recon_loss: 6450452.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9086236.1637; train_optim_loss: 9086236.1637; val_kl_reg_loss: 21947.3269; val_edge_recon_loss: 2627220.1246; val_gene_expr_recon_loss: 6487447.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9136615.3937; val_optim_loss: 9136615.3937
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9898; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 22361.8129; train_edge_recon_loss: 2611547.5653; train_gene_expr_recon_loss: 6447927.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9081836.6387; train_optim_loss: 9081836.6387; val_kl_reg_loss: 22231.8939; val_edge_recon_loss: 2622423.4486; val_gene_expr_recon_loss: 6491052.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9135708.1533; val_optim_loss: 9135708.1533
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9917; val_auprc_score: 0.9902; val_best_acc_score: 0.9605; val_best_f1_score: 0.9612; train_kl_reg_loss: 22231.4645; train_edge_recon_loss: 2611253.9418; train_gene_expr_recon_loss: 6449870.5283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9083355.9354; train_optim_loss: 9083355.9354; val_kl_reg_loss: 22212.9770; val_edge_recon_loss: 2621883.0305; val_gene_expr_recon_loss: 6493098.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9137194.3206; val_optim_loss: 9137194.3206
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9920; val_auprc_score: 0.9906; val_best_acc_score: 0.9618; val_best_f1_score: 0.9624; train_kl_reg_loss: 22164.7861; train_edge_recon_loss: 2609915.0420; train_gene_expr_recon_loss: 6443991.4631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9076071.2940; train_optim_loss: 9076071.2940; val_kl_reg_loss: 22295.4674; val_edge_recon_loss: 2619067.6010; val_gene_expr_recon_loss: 6484034.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9125397.5923; val_optim_loss: 9125397.5923
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9920; val_auprc_score: 0.9905; val_best_acc_score: 0.9619; val_best_f1_score: 0.9625; train_kl_reg_loss: 22080.8890; train_edge_recon_loss: 2609480.4346; train_gene_expr_recon_loss: 6444412.2618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9075973.5815; train_optim_loss: 9075973.5815; val_kl_reg_loss: 20995.5225; val_edge_recon_loss: 2620251.8963; val_gene_expr_recon_loss: 6492699.9460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9133947.3484; val_optim_loss: 9133947.3484
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9919; val_auprc_score: 0.9904; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 22041.3357; train_edge_recon_loss: 2608871.2533; train_gene_expr_recon_loss: 6441035.6967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9071948.2869; train_optim_loss: 9071948.2869; val_kl_reg_loss: 22741.4981; val_edge_recon_loss: 2618720.6106; val_gene_expr_recon_loss: 6480981.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9122443.2787; val_optim_loss: 9122443.2787
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 21908.4232; train_edge_recon_loss: 2607572.5580; train_gene_expr_recon_loss: 6441187.5289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9070668.5209; train_optim_loss: 9070668.5209; val_kl_reg_loss: 21766.5772; val_edge_recon_loss: 2618882.0192; val_gene_expr_recon_loss: 6481165.4303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9121814.0383; val_optim_loss: 9121814.0383
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9922; val_auprc_score: 0.9908; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 21867.3801; train_edge_recon_loss: 2607844.6050; train_gene_expr_recon_loss: 6438436.0355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9068148.0196; train_optim_loss: 9068148.0196; val_kl_reg_loss: 21386.8124; val_edge_recon_loss: 2617059.5009; val_gene_expr_recon_loss: 6478879.3537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9117325.6864; val_optim_loss: 9117325.6864
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 21864.7176; train_edge_recon_loss: 2606793.6273; train_gene_expr_recon_loss: 6437616.6891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9066275.0332; train_optim_loss: 9066275.0332; val_kl_reg_loss: 21482.9839; val_edge_recon_loss: 2616382.9904; val_gene_expr_recon_loss: 6485139.0035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9123004.9826; val_optim_loss: 9123004.9826
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 21758.4449; train_edge_recon_loss: 2606185.3524; train_gene_expr_recon_loss: 6435258.2655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9063202.0648; train_optim_loss: 9063202.0648; val_kl_reg_loss: 21557.4408; val_edge_recon_loss: 2616211.4408; val_gene_expr_recon_loss: 6483480.8432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9121249.7265; val_optim_loss: 9121249.7265
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9922; val_auprc_score: 0.9907; val_best_acc_score: 0.9639; val_best_f1_score: 0.9645; train_kl_reg_loss: 21755.3676; train_edge_recon_loss: 2605261.2451; train_gene_expr_recon_loss: 6434621.0403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9061637.6503; train_optim_loss: 9061637.6503; val_kl_reg_loss: 21986.1932; val_edge_recon_loss: 2612651.6071; val_gene_expr_recon_loss: 6490533.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9125171.4739; val_optim_loss: 9125171.4739
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9636; val_best_f1_score: 0.9641; train_kl_reg_loss: 21664.4662; train_edge_recon_loss: 2606204.5761; train_gene_expr_recon_loss: 6432450.7106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9060319.7527; train_optim_loss: 9060319.7527; val_kl_reg_loss: 21130.6393; val_edge_recon_loss: 2612773.5000; val_gene_expr_recon_loss: 6473228.1254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9107132.2997; val_optim_loss: 9107132.2997
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 21540.8792; train_edge_recon_loss: 2605224.5276; train_gene_expr_recon_loss: 6432522.7925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9059288.1908; train_optim_loss: 9059288.1908; val_kl_reg_loss: 20926.5409; val_edge_recon_loss: 2613425.0296; val_gene_expr_recon_loss: 6478588.6620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9112940.2456; val_optim_loss: 9112940.2456
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 21605.5959; train_edge_recon_loss: 2603907.3167; train_gene_expr_recon_loss: 6431891.9090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9057404.8282; train_optim_loss: 9057404.8282; val_kl_reg_loss: 21684.2684; val_edge_recon_loss: 2612742.3815; val_gene_expr_recon_loss: 6480555.2596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9114981.9059; val_optim_loss: 9114981.9059
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9922; val_auprc_score: 0.9907; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 21571.9288; train_edge_recon_loss: 2604217.8234; train_gene_expr_recon_loss: 6430847.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9056637.1780; train_optim_loss: 9056637.1780; val_kl_reg_loss: 21726.2802; val_edge_recon_loss: 2613507.8737; val_gene_expr_recon_loss: 6482970.1411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9118204.2753; val_optim_loss: 9118204.2753
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9645; val_best_f1_score: 0.9650; train_kl_reg_loss: 21495.1883; train_edge_recon_loss: 2604002.6221; train_gene_expr_recon_loss: 6430179.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9055677.6782; train_optim_loss: 9055677.6782; val_kl_reg_loss: 20935.0160; val_edge_recon_loss: 2610315.4120; val_gene_expr_recon_loss: 6480561.0366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9111811.4774; val_optim_loss: 9111811.4774

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9928; val_auprc_score: 0.9916; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 22860.9729; train_edge_recon_loss: 2602345.3994; train_gene_expr_recon_loss: 6385206.1280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9010412.5054; train_optim_loss: 9010412.5054; val_kl_reg_loss: 22812.3396; val_edge_recon_loss: 2608634.8789; val_gene_expr_recon_loss: 6459067.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9090514.4216; val_optim_loss: 9090514.4216
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 23197.3046; train_edge_recon_loss: 2600499.8316; train_gene_expr_recon_loss: 6382542.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006239.7632; train_optim_loss: 9006239.7632; val_kl_reg_loss: 22987.1110; val_edge_recon_loss: 2609058.0601; val_gene_expr_recon_loss: 6442425.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9074470.2091; val_optim_loss: 9074470.2091
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9929; val_auprc_score: 0.9916; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 23301.8282; train_edge_recon_loss: 2601471.8405; train_gene_expr_recon_loss: 6381517.2878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006290.9525; train_optim_loss: 9006290.9525; val_kl_reg_loss: 23084.1802; val_edge_recon_loss: 2610541.7317; val_gene_expr_recon_loss: 6450858.6132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9084484.5505; val_optim_loss: 9084484.5505
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 23361.8105; train_edge_recon_loss: 2600904.0018; train_gene_expr_recon_loss: 6379308.9451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9003574.7614; train_optim_loss: 9003574.7614; val_kl_reg_loss: 23091.8619; val_edge_recon_loss: 2609033.4800; val_gene_expr_recon_loss: 6452924.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9085049.5906; val_optim_loss: 9085049.5906
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9929; val_auprc_score: 0.9915; val_best_acc_score: 0.9649; val_best_f1_score: 0.9655; train_kl_reg_loss: 23415.3455; train_edge_recon_loss: 2600135.7662; train_gene_expr_recon_loss: 6379634.7647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9003185.8741; train_optim_loss: 9003185.8741; val_kl_reg_loss: 23106.1163; val_edge_recon_loss: 2610948.5322; val_gene_expr_recon_loss: 6442621.1237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9076675.8014; val_optim_loss: 9076675.8014
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9930; val_auprc_score: 0.9915; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 23404.7933; train_edge_recon_loss: 2600874.3929; train_gene_expr_recon_loss: 6380384.3218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9004663.5064; train_optim_loss: 9004663.5064; val_kl_reg_loss: 23149.1809; val_edge_recon_loss: 2608817.9059; val_gene_expr_recon_loss: 6443864.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9075831.9686; val_optim_loss: 9075831.9686

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9931; val_auprc_score: 0.9917; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 23475.4318; train_edge_recon_loss: 2600946.4478; train_gene_expr_recon_loss: 6372146.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8996568.1808; train_optim_loss: 8996568.1808; val_kl_reg_loss: 23264.6850; val_edge_recon_loss: 2609358.8946; val_gene_expr_recon_loss: 6449264.9617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9081888.5157; val_optim_loss: 9081888.5157
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9931; val_auprc_score: 0.9918; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 23543.8133; train_edge_recon_loss: 2600994.1639; train_gene_expr_recon_loss: 6372376.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8996914.5593; train_optim_loss: 8996914.5593; val_kl_reg_loss: 23248.1042; val_edge_recon_loss: 2608633.6707; val_gene_expr_recon_loss: 6444993.8206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9076875.6063; val_optim_loss: 9076875.6063
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 23544.5657; train_edge_recon_loss: 2601152.6154; train_gene_expr_recon_loss: 6371585.4267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8996282.6181; train_optim_loss: 8996282.6181; val_kl_reg_loss: 23225.1079; val_edge_recon_loss: 2610075.6934; val_gene_expr_recon_loss: 6444911.8101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9078212.5993; val_optim_loss: 9078212.5993
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9929; val_auprc_score: 0.9916; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 23565.4993; train_edge_recon_loss: 2600755.3545; train_gene_expr_recon_loss: 6373569.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8997890.8033; train_optim_loss: 8997890.8033; val_kl_reg_loss: 23254.2765; val_edge_recon_loss: 2610292.8632; val_gene_expr_recon_loss: 6451957.6690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9085504.8084; val_optim_loss: 9085504.8084

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 838 min 59 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9928
Val AUPRC score: 0.9916
Val best accuracy score: 0.9652
Val best F1 score: 0.9657
Val gene expr MSE score: 1.5345

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
