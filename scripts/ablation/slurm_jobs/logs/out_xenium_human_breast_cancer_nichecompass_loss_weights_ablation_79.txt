None
Run timestamp: 28072023_181248_79.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_79']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9817; val_auprc_score: 0.9779; val_best_acc_score: 0.9381; val_best_f1_score: 0.9396; train_kl_reg_loss: 5232.3107; train_edge_recon_loss: 264980.6449; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 270212.9552; train_optim_loss: 270212.9552; val_kl_reg_loss: 5263.8729; val_edge_recon_loss: 261675.7106; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266939.5833; val_optim_loss: 266939.5833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9857; val_auprc_score: 0.9821; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 5273.7306; train_edge_recon_loss: 260947.2877; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266221.0182; train_optim_loss: 266221.0182; val_kl_reg_loss: 5260.0912; val_edge_recon_loss: 260434.3545; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265694.4461; val_optim_loss: 265694.4461
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9880; val_auprc_score: 0.9848; val_best_acc_score: 0.9547; val_best_f1_score: 0.9556; train_kl_reg_loss: 5264.2116; train_edge_recon_loss: 260229.4730; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265493.6847; train_optim_loss: 265493.6847; val_kl_reg_loss: 5353.8418; val_edge_recon_loss: 259776.0574; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265129.8995; val_optim_loss: 265129.8995
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9868; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 5267.2189; train_edge_recon_loss: 259695.2209; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264962.4398; train_optim_loss: 264962.4398; val_kl_reg_loss: 5297.3366; val_edge_recon_loss: 259182.4187; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264479.7548; val_optim_loss: 264479.7548
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9899; val_auprc_score: 0.9869; val_best_acc_score: 0.9610; val_best_f1_score: 0.9616; train_kl_reg_loss: 5273.7668; train_edge_recon_loss: 259392.8403; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264666.6071; train_optim_loss: 264666.6071; val_kl_reg_loss: 5201.4697; val_edge_recon_loss: 258984.1277; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264185.5974; val_optim_loss: 264185.5974
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9907; val_auprc_score: 0.9879; val_best_acc_score: 0.9627; val_best_f1_score: 0.9633; train_kl_reg_loss: 5273.4750; train_edge_recon_loss: 259218.9901; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264492.4651; train_optim_loss: 264492.4651; val_kl_reg_loss: 5167.8821; val_edge_recon_loss: 259064.0523; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264231.9334; val_optim_loss: 264231.9334
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9890; val_best_acc_score: 0.9645; val_best_f1_score: 0.9650; train_kl_reg_loss: 5278.6001; train_edge_recon_loss: 259023.5813; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264302.1811; train_optim_loss: 264302.1811; val_kl_reg_loss: 5264.3615; val_edge_recon_loss: 258669.6210; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263933.9831; val_optim_loss: 263933.9831
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9917; val_auprc_score: 0.9893; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 5285.2832; train_edge_recon_loss: 258846.3731; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264131.6560; train_optim_loss: 264131.6560; val_kl_reg_loss: 5221.3460; val_edge_recon_loss: 258398.5015; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263619.8476; val_optim_loss: 263619.8476
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 5285.2981; train_edge_recon_loss: 258778.5029; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264063.8010; train_optim_loss: 264063.8010; val_kl_reg_loss: 5318.7791; val_edge_recon_loss: 258468.8947; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263787.6737; val_optim_loss: 263787.6737
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9925; val_auprc_score: 0.9901; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 5285.8543; train_edge_recon_loss: 258531.3165; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263817.1707; train_optim_loss: 263817.1707; val_kl_reg_loss: 5405.1967; val_edge_recon_loss: 258032.8572; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263438.0536; val_optim_loss: 263438.0536
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 5286.8594; train_edge_recon_loss: 258403.3266; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263690.1860; train_optim_loss: 263690.1860; val_kl_reg_loss: 5276.0271; val_edge_recon_loss: 258025.9476; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263301.9748; val_optim_loss: 263301.9748
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9908; val_best_acc_score: 0.9703; val_best_f1_score: 0.9706; train_kl_reg_loss: 5290.2236; train_edge_recon_loss: 258378.1679; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263668.3914; train_optim_loss: 263668.3914; val_kl_reg_loss: 5233.0884; val_edge_recon_loss: 257973.4574; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263206.5462; val_optim_loss: 263206.5462
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9911; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5292.0795; train_edge_recon_loss: 258277.0133; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263569.0925; train_optim_loss: 263569.0925; val_kl_reg_loss: 5165.6314; val_edge_recon_loss: 257869.6848; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263035.3162; val_optim_loss: 263035.3162
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9934; val_auprc_score: 0.9913; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 5292.4204; train_edge_recon_loss: 258173.7596; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263466.1800; train_optim_loss: 263466.1800; val_kl_reg_loss: 5199.3890; val_edge_recon_loss: 257940.9967; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263140.3855; val_optim_loss: 263140.3855
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9938; val_auprc_score: 0.9915; val_best_acc_score: 0.9718; val_best_f1_score: 0.9721; train_kl_reg_loss: 5288.0152; train_edge_recon_loss: 258192.0110; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263480.0259; train_optim_loss: 263480.0259; val_kl_reg_loss: 5352.2957; val_edge_recon_loss: 257910.8603; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263263.1569; val_optim_loss: 263263.1569
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 5289.7895; train_edge_recon_loss: 258068.9438; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263358.7334; train_optim_loss: 263358.7334; val_kl_reg_loss: 5139.2500; val_edge_recon_loss: 257542.8763; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262682.1262; val_optim_loss: 262682.1262
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9939; val_auprc_score: 0.9918; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 5289.0136; train_edge_recon_loss: 257974.3623; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263263.3761; train_optim_loss: 263263.3761; val_kl_reg_loss: 5316.0336; val_edge_recon_loss: 257510.1984; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262826.2313; val_optim_loss: 262826.2313
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9911; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 5290.8809; train_edge_recon_loss: 257923.8970; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263214.7779; train_optim_loss: 263214.7779; val_kl_reg_loss: 5395.0762; val_edge_recon_loss: 257639.5236; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263034.6001; val_optim_loss: 263034.6001
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9936; val_auprc_score: 0.9913; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 5288.5594; train_edge_recon_loss: 257912.2383; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263200.7977; train_optim_loss: 263200.7977; val_kl_reg_loss: 5311.7660; val_edge_recon_loss: 257486.3459; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262798.1117; val_optim_loss: 262798.1117
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9938; val_auprc_score: 0.9915; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 5293.1941; train_edge_recon_loss: 257839.7902; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263132.9841; train_optim_loss: 263132.9841; val_kl_reg_loss: 5139.4282; val_edge_recon_loss: 257554.5456; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262693.9745; val_optim_loss: 262693.9745

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 5278.3143; train_edge_recon_loss: 257548.7437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262827.0580; train_optim_loss: 262827.0580; val_kl_reg_loss: 5256.3054; val_edge_recon_loss: 257159.4913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262415.7971; val_optim_loss: 262415.7971
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5270.6510; train_edge_recon_loss: 257512.0215; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262782.6728; train_optim_loss: 262782.6728; val_kl_reg_loss: 5224.3579; val_edge_recon_loss: 256975.5733; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262199.9321; val_optim_loss: 262199.9321
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5268.2240; train_edge_recon_loss: 257496.5436; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262764.7675; train_optim_loss: 262764.7675; val_kl_reg_loss: 5230.1524; val_edge_recon_loss: 257033.9847; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262264.1379; val_optim_loss: 262264.1379
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5267.9389; train_edge_recon_loss: 257476.7855; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262744.7241; train_optim_loss: 262744.7241; val_kl_reg_loss: 5213.1787; val_edge_recon_loss: 256953.3829; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262166.5621; val_optim_loss: 262166.5621
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9944; val_auprc_score: 0.9924; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 5266.6965; train_edge_recon_loss: 257435.1649; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262701.8618; train_optim_loss: 262701.8618; val_kl_reg_loss: 5224.8479; val_edge_recon_loss: 257061.4851; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262286.3333; val_optim_loss: 262286.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 5261.5300; train_edge_recon_loss: 257581.2722; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262842.8025; train_optim_loss: 262842.8025; val_kl_reg_loss: 5209.6521; val_edge_recon_loss: 257207.1684; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262416.8204; val_optim_loss: 262416.8204
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 5262.5896; train_edge_recon_loss: 257455.9760; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262718.5658; train_optim_loss: 262718.5658; val_kl_reg_loss: 5230.3824; val_edge_recon_loss: 257033.7470; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262264.1293; val_optim_loss: 262264.1293
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5264.6938; train_edge_recon_loss: 257416.5710; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262681.2646; train_optim_loss: 262681.2646; val_kl_reg_loss: 5262.4260; val_edge_recon_loss: 257108.1664; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262370.5924; val_optim_loss: 262370.5924

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 5262.3611; train_edge_recon_loss: 257453.5623; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262715.9233; train_optim_loss: 262715.9233; val_kl_reg_loss: 5233.3449; val_edge_recon_loss: 256764.0619; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 261997.4068; val_optim_loss: 261997.4068
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 5260.6949; train_edge_recon_loss: 257467.1306; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262727.8254; train_optim_loss: 262727.8254; val_kl_reg_loss: 5224.0850; val_edge_recon_loss: 256855.9905; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262080.0757; val_optim_loss: 262080.0757
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 5261.4851; train_edge_recon_loss: 257349.9524; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262611.4376; train_optim_loss: 262611.4376; val_kl_reg_loss: 5237.9441; val_edge_recon_loss: 257087.2039; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262325.1489; val_optim_loss: 262325.1489
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 5260.2577; train_edge_recon_loss: 257459.9388; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262720.1963; train_optim_loss: 262720.1963; val_kl_reg_loss: 5234.6245; val_edge_recon_loss: 257091.9146; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262326.5384; val_optim_loss: 262326.5384
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5262.3624; train_edge_recon_loss: 257344.2432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262606.6059; train_optim_loss: 262606.6059; val_kl_reg_loss: 5233.0195; val_edge_recon_loss: 256985.0106; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262218.0304; val_optim_loss: 262218.0304

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5261.1378; train_edge_recon_loss: 257380.7339; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262641.8720; train_optim_loss: 262641.8720; val_kl_reg_loss: 5235.0515; val_edge_recon_loss: 256983.0424; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262218.0930; val_optim_loss: 262218.0930
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 5259.6663; train_edge_recon_loss: 257414.0255; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262673.6919; train_optim_loss: 262673.6919; val_kl_reg_loss: 5233.0531; val_edge_recon_loss: 256932.7938; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262165.8474; val_optim_loss: 262165.8474
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9946; val_auprc_score: 0.9924; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 5260.4635; train_edge_recon_loss: 257384.0192; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262644.4828; train_optim_loss: 262644.4828; val_kl_reg_loss: 5234.7377; val_edge_recon_loss: 256968.7953; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262203.5337; val_optim_loss: 262203.5337
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9946; val_auprc_score: 0.9925; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5259.0580; train_edge_recon_loss: 257403.4838; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262662.5418; train_optim_loss: 262662.5418; val_kl_reg_loss: 5229.5226; val_edge_recon_loss: 256924.2745; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262153.7974; val_optim_loss: 262153.7974

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 340 min 10 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9943
val AUPRC score: 0.9922
val best accuracy score: 0.9760
val best F1 score: 0.9764
val target rna MSE score: 5.3317
val source rna MSE score: 3.2663

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
