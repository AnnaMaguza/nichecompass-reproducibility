None
Run timestamp: 19072023_194637_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9583; val_auprc_score: 0.9493; val_best_acc_score: 0.8967; val_best_f1_score: 0.9020; train_kl_reg_loss: 49243.9919; train_edge_recon_loss: 26857617.5401; train_gene_expr_recon_loss: 7508968.5939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34415830.0494; train_optim_loss: 34415830.0494; val_kl_reg_loss: 48590.4739; val_edge_recon_loss: 26570977.1481; val_gene_expr_recon_loss: 6952938.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33572506.0556; val_optim_loss: 33572506.0556
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9767; val_auprc_score: 0.9722; val_best_acc_score: 0.9270; val_best_f1_score: 0.9295; train_kl_reg_loss: 42114.8476; train_edge_recon_loss: 26291464.6409; train_gene_expr_recon_loss: 6838334.6662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33171914.1348; train_optim_loss: 33171914.1348; val_kl_reg_loss: 36678.6018; val_edge_recon_loss: 26334765.9352; val_gene_expr_recon_loss: 6734449.3102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33105893.7222; val_optim_loss: 33105893.7222
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9818; val_auprc_score: 0.9787; val_best_acc_score: 0.9358; val_best_f1_score: 0.9375; train_kl_reg_loss: 35908.7606; train_edge_recon_loss: 26110389.1091; train_gene_expr_recon_loss: 6696799.2258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32843097.0772; train_optim_loss: 32843097.0772; val_kl_reg_loss: 34543.8674; val_edge_recon_loss: 26261015.4722; val_gene_expr_recon_loss: 6645269.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32940828.3333; val_optim_loss: 32940828.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9842; val_auprc_score: 0.9813; val_best_acc_score: 0.9419; val_best_f1_score: 0.9431; train_kl_reg_loss: 34876.8133; train_edge_recon_loss: 26058053.0905; train_gene_expr_recon_loss: 6622783.3128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32715713.1862; train_optim_loss: 32715713.1862; val_kl_reg_loss: 34641.9469; val_edge_recon_loss: 26195771.7593; val_gene_expr_recon_loss: 6577710.5671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32808124.2222; val_optim_loss: 32808124.2222
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9858; val_auprc_score: 0.9832; val_best_acc_score: 0.9454; val_best_f1_score: 0.9466; train_kl_reg_loss: 33781.8065; train_edge_recon_loss: 26018305.9763; train_gene_expr_recon_loss: 6582203.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32634290.8323; train_optim_loss: 32634290.8323; val_kl_reg_loss: 32151.2819; val_edge_recon_loss: 26192316.3056; val_gene_expr_recon_loss: 6546067.9468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32770535.5556; val_optim_loss: 32770535.5556
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9866; val_auprc_score: 0.9843; val_best_acc_score: 0.9472; val_best_f1_score: 0.9483; train_kl_reg_loss: 32852.3071; train_edge_recon_loss: 25987000.9681; train_gene_expr_recon_loss: 6558486.3729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32578339.6636; train_optim_loss: 32578339.6636; val_kl_reg_loss: 31089.4690; val_edge_recon_loss: 26128754.7222; val_gene_expr_recon_loss: 6535977.4028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32695821.5833; val_optim_loss: 32695821.5833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9875; val_auprc_score: 0.9851; val_best_acc_score: 0.9501; val_best_f1_score: 0.9510; train_kl_reg_loss: 31810.5828; train_edge_recon_loss: 25965742.2582; train_gene_expr_recon_loss: 6541706.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32539259.2315; train_optim_loss: 32539259.2315; val_kl_reg_loss: 30979.0263; val_edge_recon_loss: 26120854.5556; val_gene_expr_recon_loss: 6521122.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32672956.3611; val_optim_loss: 32672956.3611
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9884; val_auprc_score: 0.9864; val_best_acc_score: 0.9525; val_best_f1_score: 0.9534; train_kl_reg_loss: 31539.4780; train_edge_recon_loss: 25941314.7490; train_gene_expr_recon_loss: 6523442.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32496296.6708; train_optim_loss: 32496296.6708; val_kl_reg_loss: 30934.1220; val_edge_recon_loss: 26082187.1759; val_gene_expr_recon_loss: 6510023.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32623144.3519; val_optim_loss: 32623144.3519
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9889; val_auprc_score: 0.9867; val_best_acc_score: 0.9534; val_best_f1_score: 0.9543; train_kl_reg_loss: 31319.1139; train_edge_recon_loss: 25917793.0000; train_gene_expr_recon_loss: 6516362.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32465474.5195; train_optim_loss: 32465474.5195; val_kl_reg_loss: 31163.1063; val_edge_recon_loss: 26053989.0741; val_gene_expr_recon_loss: 6493382.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32578534.5463; val_optim_loss: 32578534.5463
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9862; val_best_acc_score: 0.9528; val_best_f1_score: 0.9538; train_kl_reg_loss: 31046.8049; train_edge_recon_loss: 25908911.8580; train_gene_expr_recon_loss: 6500802.4985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32440761.1553; train_optim_loss: 32440761.1553; val_kl_reg_loss: 30446.4250; val_edge_recon_loss: 26082895.7315; val_gene_expr_recon_loss: 6497822.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32611164.9815; val_optim_loss: 32611164.9815
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9891; val_auprc_score: 0.9869; val_best_acc_score: 0.9551; val_best_f1_score: 0.9560; train_kl_reg_loss: 30889.3814; train_edge_recon_loss: 25896556.7891; train_gene_expr_recon_loss: 6495700.6178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32423146.7798; train_optim_loss: 32423146.7798; val_kl_reg_loss: 30243.4429; val_edge_recon_loss: 26069148.6852; val_gene_expr_recon_loss: 6488232.4815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32587624.5926; val_optim_loss: 32587624.5926
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9894; val_auprc_score: 0.9870; val_best_acc_score: 0.9564; val_best_f1_score: 0.9571; train_kl_reg_loss: 30847.5005; train_edge_recon_loss: 25877815.4609; train_gene_expr_recon_loss: 6491352.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32400015.1163; train_optim_loss: 32400015.1163; val_kl_reg_loss: 30019.7106; val_edge_recon_loss: 26033628.5000; val_gene_expr_recon_loss: 6480787.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32544435.2130; val_optim_loss: 32544435.2130
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9896; val_auprc_score: 0.9875; val_best_acc_score: 0.9564; val_best_f1_score: 0.9573; train_kl_reg_loss: 30532.5327; train_edge_recon_loss: 25874588.8261; train_gene_expr_recon_loss: 6483408.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32388530.1368; train_optim_loss: 32388530.1368; val_kl_reg_loss: 29656.4145; val_edge_recon_loss: 26032773.2685; val_gene_expr_recon_loss: 6483204.3935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32545634.1481; val_optim_loss: 32545634.1481
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9892; val_auprc_score: 0.9868; val_best_acc_score: 0.9563; val_best_f1_score: 0.9570; train_kl_reg_loss: 30414.6294; train_edge_recon_loss: 25873607.6564; train_gene_expr_recon_loss: 6480390.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32384412.3745; train_optim_loss: 32384412.3745; val_kl_reg_loss: 30518.5902; val_edge_recon_loss: 26041099.4444; val_gene_expr_recon_loss: 6481205.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32552823.7963; val_optim_loss: 32552823.7963
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9899; val_auprc_score: 0.9878; val_best_acc_score: 0.9572; val_best_f1_score: 0.9579; train_kl_reg_loss: 30377.3692; train_edge_recon_loss: 25860590.1101; train_gene_expr_recon_loss: 6472761.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32363729.3148; train_optim_loss: 32363729.3148; val_kl_reg_loss: 30422.4318; val_edge_recon_loss: 26018486.7130; val_gene_expr_recon_loss: 6473810.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32522719.2222; val_optim_loss: 32522719.2222
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 29990.1089; train_edge_recon_loss: 25858033.7922; train_gene_expr_recon_loss: 6468429.1283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32356453.0144; train_optim_loss: 32356453.0144; val_kl_reg_loss: 29251.4239; val_edge_recon_loss: 26006574.8981; val_gene_expr_recon_loss: 6468853.7824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32504680.0648; val_optim_loss: 32504680.0648
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9882; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 30072.8663; train_edge_recon_loss: 25853544.0782; train_gene_expr_recon_loss: 6467907.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32351524.6358; train_optim_loss: 32351524.6358; val_kl_reg_loss: 29651.1557; val_edge_recon_loss: 25983865.0000; val_gene_expr_recon_loss: 6470178.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32483694.6296; val_optim_loss: 32483694.6296
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9904; val_auprc_score: 0.9883; val_best_acc_score: 0.9591; val_best_f1_score: 0.9598; train_kl_reg_loss: 30120.1658; train_edge_recon_loss: 25841636.6286; train_gene_expr_recon_loss: 6463170.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32334927.0823; train_optim_loss: 32334927.0823; val_kl_reg_loss: 29300.7569; val_edge_recon_loss: 26019254.9167; val_gene_expr_recon_loss: 6463881.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32512437.0833; val_optim_loss: 32512437.0833
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9904; val_auprc_score: 0.9883; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 29977.5693; train_edge_recon_loss: 25839902.2099; train_gene_expr_recon_loss: 6465357.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32335237.0000; train_optim_loss: 32335237.0000; val_kl_reg_loss: 29704.2171; val_edge_recon_loss: 26034855.4259; val_gene_expr_recon_loss: 6463221.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32527780.8426; val_optim_loss: 32527780.8426
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9896; val_auprc_score: 0.9872; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 30019.7546; train_edge_recon_loss: 25832174.6276; train_gene_expr_recon_loss: 6461840.2027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32324034.5720; train_optim_loss: 32324034.5720; val_kl_reg_loss: 29753.7495; val_edge_recon_loss: 26014531.4259; val_gene_expr_recon_loss: 6471374.9190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32515660.1389; val_optim_loss: 32515660.1389
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9903; val_auprc_score: 0.9882; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 29921.4124; train_edge_recon_loss: 25826028.0813; train_gene_expr_recon_loss: 6457284.2467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32313233.7459; train_optim_loss: 32313233.7459; val_kl_reg_loss: 29622.8108; val_edge_recon_loss: 25988764.2500; val_gene_expr_recon_loss: 6459999.4676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32478386.5185; val_optim_loss: 32478386.5185
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9901; val_auprc_score: 0.9878; val_best_acc_score: 0.9600; val_best_f1_score: 0.9607; train_kl_reg_loss: 29819.0232; train_edge_recon_loss: 25830383.9311; train_gene_expr_recon_loss: 6455414.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32315617.6204; train_optim_loss: 32315617.6204; val_kl_reg_loss: 29719.5435; val_edge_recon_loss: 25986900.7593; val_gene_expr_recon_loss: 6467159.3472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32483779.7037; val_optim_loss: 32483779.7037
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9905; val_auprc_score: 0.9881; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 29667.1889; train_edge_recon_loss: 25821494.1152; train_gene_expr_recon_loss: 6452465.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32303627.0412; train_optim_loss: 32303627.0412; val_kl_reg_loss: 29738.5259; val_edge_recon_loss: 25975338.5000; val_gene_expr_recon_loss: 6444337.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32449414.2963; val_optim_loss: 32449414.2963
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9905; val_auprc_score: 0.9882; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 29712.4961; train_edge_recon_loss: 25817392.1471; train_gene_expr_recon_loss: 6452882.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32299987.0329; train_optim_loss: 32299987.0329; val_kl_reg_loss: 28815.0225; val_edge_recon_loss: 25984608.8333; val_gene_expr_recon_loss: 6450626.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32464050.0093; val_optim_loss: 32464050.0093
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 29660.7420; train_edge_recon_loss: 25819715.4383; train_gene_expr_recon_loss: 6447318.0998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32296694.2778; train_optim_loss: 32296694.2778; val_kl_reg_loss: 28522.3684; val_edge_recon_loss: 25978393.5463; val_gene_expr_recon_loss: 6453994.2685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32460910.0741; val_optim_loss: 32460910.0741
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9607; val_best_f1_score: 0.9614; train_kl_reg_loss: 29565.7703; train_edge_recon_loss: 25818232.7109; train_gene_expr_recon_loss: 6445943.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32293741.8683; train_optim_loss: 32293741.8683; val_kl_reg_loss: 29734.8456; val_edge_recon_loss: 25966808.4722; val_gene_expr_recon_loss: 6451452.5347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32447995.8796; val_optim_loss: 32447995.8796
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9616; val_best_f1_score: 0.9622; train_kl_reg_loss: 29774.8629; train_edge_recon_loss: 25805679.4444; train_gene_expr_recon_loss: 6445793.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32281247.8138; train_optim_loss: 32281247.8138; val_kl_reg_loss: 29605.4480; val_edge_recon_loss: 25961065.6852; val_gene_expr_recon_loss: 6456602.3218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32447273.5185; val_optim_loss: 32447273.5185
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9911; val_auprc_score: 0.9891; val_best_acc_score: 0.9618; val_best_f1_score: 0.9624; train_kl_reg_loss: 29712.5172; train_edge_recon_loss: 25798123.6965; train_gene_expr_recon_loss: 6445478.8771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32273315.0864; train_optim_loss: 32273315.0864; val_kl_reg_loss: 28507.6758; val_edge_recon_loss: 25952279.7222; val_gene_expr_recon_loss: 6445599.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32426387.0463; val_optim_loss: 32426387.0463
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9907; val_auprc_score: 0.9884; val_best_acc_score: 0.9616; val_best_f1_score: 0.9622; train_kl_reg_loss: 29402.8663; train_edge_recon_loss: 25801948.6831; train_gene_expr_recon_loss: 6444787.9594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276139.4928; train_optim_loss: 32276139.4928; val_kl_reg_loss: 29693.0030; val_edge_recon_loss: 25952527.9907; val_gene_expr_recon_loss: 6446778.5440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32428999.5185; val_optim_loss: 32428999.5185
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9910; val_auprc_score: 0.9886; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 29249.4691; train_edge_recon_loss: 25798430.8663; train_gene_expr_recon_loss: 6446547.4617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32274227.7819; train_optim_loss: 32274227.7819; val_kl_reg_loss: 28969.3867; val_edge_recon_loss: 25940049.3333; val_gene_expr_recon_loss: 6447998.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32417017.0278; val_optim_loss: 32417017.0278
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 29467.9631; train_edge_recon_loss: 25793889.4393; train_gene_expr_recon_loss: 6441327.0206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32264684.4290; train_optim_loss: 32264684.4290; val_kl_reg_loss: 28576.1602; val_edge_recon_loss: 25938603.0093; val_gene_expr_recon_loss: 6431946.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32399125.6481; val_optim_loss: 32399125.6481
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 29336.6819; train_edge_recon_loss: 25791073.2942; train_gene_expr_recon_loss: 6441575.0841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32261985.0597; train_optim_loss: 32261985.0597; val_kl_reg_loss: 28224.7622; val_edge_recon_loss: 25942731.4722; val_gene_expr_recon_loss: 6449735.3449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32420691.5370; val_optim_loss: 32420691.5370
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 29187.8536; train_edge_recon_loss: 25795958.5144; train_gene_expr_recon_loss: 6440634.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32265781.1646; train_optim_loss: 32265781.1646; val_kl_reg_loss: 28966.0032; val_edge_recon_loss: 25943279.5093; val_gene_expr_recon_loss: 6442044.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32414290.2130; val_optim_loss: 32414290.2130
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9632; val_best_f1_score: 0.9637; train_kl_reg_loss: 29137.2186; train_edge_recon_loss: 25787484.8025; train_gene_expr_recon_loss: 6440609.1402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32257231.1718; train_optim_loss: 32257231.1718; val_kl_reg_loss: 28781.3626; val_edge_recon_loss: 25920030.7222; val_gene_expr_recon_loss: 6444889.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32393701.2500; val_optim_loss: 32393701.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9919; val_auprc_score: 0.9902; val_best_acc_score: 0.9637; val_best_f1_score: 0.9642; train_kl_reg_loss: 29301.3772; train_edge_recon_loss: 25782722.0607; train_gene_expr_recon_loss: 6440122.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32252146.3200; train_optim_loss: 32252146.3200; val_kl_reg_loss: 28395.4055; val_edge_recon_loss: 25947288.8426; val_gene_expr_recon_loss: 6437893.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32413578.1111; val_optim_loss: 32413578.1111
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9641; val_best_f1_score: 0.9648; train_kl_reg_loss: 29027.4722; train_edge_recon_loss: 25792321.0370; train_gene_expr_recon_loss: 6439475.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32260824.3796; train_optim_loss: 32260824.3796; val_kl_reg_loss: 27947.1198; val_edge_recon_loss: 25939814.6759; val_gene_expr_recon_loss: 6438044.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32405806.3148; val_optim_loss: 32405806.3148
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9922; val_auprc_score: 0.9905; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 29093.6605; train_edge_recon_loss: 25782257.8004; train_gene_expr_recon_loss: 6435351.7289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32246703.1615; train_optim_loss: 32246703.1615; val_kl_reg_loss: 29144.6605; val_edge_recon_loss: 25911811.0556; val_gene_expr_recon_loss: 6449117.5301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32390073.2315; val_optim_loss: 32390073.2315
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9918; val_auprc_score: 0.9896; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 29081.4171; train_edge_recon_loss: 25783802.4465; train_gene_expr_recon_loss: 6435592.5309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32248476.3961; train_optim_loss: 32248476.3961; val_kl_reg_loss: 28157.2231; val_edge_recon_loss: 25929059.0278; val_gene_expr_recon_loss: 6436685.0231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32393901.2593; val_optim_loss: 32393901.2593
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9917; val_auprc_score: 0.9896; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 29182.4475; train_edge_recon_loss: 25782431.2675; train_gene_expr_recon_loss: 6437723.7191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32249337.4033; train_optim_loss: 32249337.4033; val_kl_reg_loss: 28503.2844; val_edge_recon_loss: 25904394.7500; val_gene_expr_recon_loss: 6436782.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32369679.9815; val_optim_loss: 32369679.9815
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 29046.9744; train_edge_recon_loss: 25776793.2778; train_gene_expr_recon_loss: 6434224.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32240064.9753; train_optim_loss: 32240064.9753; val_kl_reg_loss: 29071.7003; val_edge_recon_loss: 25915873.8148; val_gene_expr_recon_loss: 6436749.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32381695.2315; val_optim_loss: 32381695.2315
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9919; val_auprc_score: 0.9900; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 28944.8585; train_edge_recon_loss: 25779601.7325; train_gene_expr_recon_loss: 6437414.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32245961.0000; train_optim_loss: 32245961.0000; val_kl_reg_loss: 28044.7697; val_edge_recon_loss: 25915254.7037; val_gene_expr_recon_loss: 6427821.9954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32371121.5093; val_optim_loss: 32371121.5093
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9916; val_auprc_score: 0.9897; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 29065.4934; train_edge_recon_loss: 25775771.4588; train_gene_expr_recon_loss: 6432488.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32237325.0998; train_optim_loss: 32237325.0998; val_kl_reg_loss: 29259.6591; val_edge_recon_loss: 25891298.5926; val_gene_expr_recon_loss: 6444317.4954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32364875.7315; val_optim_loss: 32364875.7315
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 28750.8975; train_edge_recon_loss: 25769492.8611; train_gene_expr_recon_loss: 6431864.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32230108.3076; train_optim_loss: 32230108.3076; val_kl_reg_loss: 27821.3471; val_edge_recon_loss: 25924663.4167; val_gene_expr_recon_loss: 6442291.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32394776.2870; val_optim_loss: 32394776.2870
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9920; val_auprc_score: 0.9899; val_best_acc_score: 0.9650; val_best_f1_score: 0.9655; train_kl_reg_loss: 29051.8710; train_edge_recon_loss: 25767270.6204; train_gene_expr_recon_loss: 6431726.8447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32228049.3354; train_optim_loss: 32228049.3354; val_kl_reg_loss: 29251.5877; val_edge_recon_loss: 25908352.3148; val_gene_expr_recon_loss: 6432827.4630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32370431.4074; val_optim_loss: 32370431.4074
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9919; val_auprc_score: 0.9898; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 28967.2885; train_edge_recon_loss: 25775145.5802; train_gene_expr_recon_loss: 6428321.2649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32232434.1132; train_optim_loss: 32232434.1132; val_kl_reg_loss: 28592.6373; val_edge_recon_loss: 25939599.9444; val_gene_expr_recon_loss: 6443922.4931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32412115.0926; val_optim_loss: 32412115.0926
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9923; val_auprc_score: 0.9905; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 28844.1770; train_edge_recon_loss: 25766247.4331; train_gene_expr_recon_loss: 6430358.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32225450.0206; train_optim_loss: 32225450.0206; val_kl_reg_loss: 28327.6536; val_edge_recon_loss: 25913257.3333; val_gene_expr_recon_loss: 6429694.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32371279.1204; val_optim_loss: 32371279.1204

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 30481.5406; train_edge_recon_loss: 25748845.8097; train_gene_expr_recon_loss: 6370623.8400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32149951.2088; train_optim_loss: 32149951.2088; val_kl_reg_loss: 30726.4597; val_edge_recon_loss: 25887708.8796; val_gene_expr_recon_loss: 6378928.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32297363.6296; val_optim_loss: 32297363.6296
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9923; val_auprc_score: 0.9903; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 31453.2060; train_edge_recon_loss: 25746302.8117; train_gene_expr_recon_loss: 6367462.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32145218.9228; train_optim_loss: 32145218.9228; val_kl_reg_loss: 31128.8228; val_edge_recon_loss: 25878583.2222; val_gene_expr_recon_loss: 6381643.7870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32291355.7778; val_optim_loss: 32291355.7778
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 31770.2818; train_edge_recon_loss: 25741477.5545; train_gene_expr_recon_loss: 6363217.1798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32136464.9969; train_optim_loss: 32136464.9969; val_kl_reg_loss: 31261.5562; val_edge_recon_loss: 25904653.5833; val_gene_expr_recon_loss: 6382141.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32318056.1481; val_optim_loss: 32318056.1481
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 31959.8372; train_edge_recon_loss: 25754073.1451; train_gene_expr_recon_loss: 6357421.6669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32143454.6584; train_optim_loss: 32143454.6584; val_kl_reg_loss: 31413.7484; val_edge_recon_loss: 25880001.8056; val_gene_expr_recon_loss: 6376778.0579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32288193.5370; val_optim_loss: 32288193.5370
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 31936.3972; train_edge_recon_loss: 25740030.8014; train_gene_expr_recon_loss: 6357429.8747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32129397.0905; train_optim_loss: 32129397.0905; val_kl_reg_loss: 31564.0698; val_edge_recon_loss: 25907726.8333; val_gene_expr_recon_loss: 6372185.3866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32311476.3056; val_optim_loss: 32311476.3056
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 32230.6892; train_edge_recon_loss: 25747121.3395; train_gene_expr_recon_loss: 6356840.2996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32136192.3426; train_optim_loss: 32136192.3426; val_kl_reg_loss: 31581.2612; val_edge_recon_loss: 25890311.4167; val_gene_expr_recon_loss: 6371057.8032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32292950.5093; val_optim_loss: 32292950.5093
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 32075.2034; train_edge_recon_loss: 25747444.8107; train_gene_expr_recon_loss: 6357639.5062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32137159.5226; train_optim_loss: 32137159.5226; val_kl_reg_loss: 31447.0123; val_edge_recon_loss: 25895428.7685; val_gene_expr_recon_loss: 6373060.9676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32299936.7500; val_optim_loss: 32299936.7500
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 32127.6078; train_edge_recon_loss: 25748212.3241; train_gene_expr_recon_loss: 6355002.1785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32135342.1029; train_optim_loss: 32135342.1029; val_kl_reg_loss: 31601.0888; val_edge_recon_loss: 25897496.3519; val_gene_expr_recon_loss: 6369695.4028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32298792.8333; val_optim_loss: 32298792.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 32188.8132; train_edge_recon_loss: 25738529.7078; train_gene_expr_recon_loss: 6346606.6011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32117325.1440; train_optim_loss: 32117325.1440; val_kl_reg_loss: 31745.3546; val_edge_recon_loss: 25883136.2407; val_gene_expr_recon_loss: 6345481.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32260362.8889; val_optim_loss: 32260362.8889
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 32306.5846; train_edge_recon_loss: 25736371.2798; train_gene_expr_recon_loss: 6344020.4002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32112698.2881; train_optim_loss: 32112698.2881; val_kl_reg_loss: 31818.1070; val_edge_recon_loss: 25870389.5556; val_gene_expr_recon_loss: 6364494.0509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32266701.8056; val_optim_loss: 32266701.8056
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9666; val_best_f1_score: 0.9671; train_kl_reg_loss: 32307.3227; train_edge_recon_loss: 25740154.2582; train_gene_expr_recon_loss: 6343716.1160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32116177.6965; train_optim_loss: 32116177.6965; val_kl_reg_loss: 31860.9016; val_edge_recon_loss: 25892675.0926; val_gene_expr_recon_loss: 6361637.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32286173.0833; val_optim_loss: 32286173.0833
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9929; val_auprc_score: 0.9912; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 32351.5526; train_edge_recon_loss: 25744721.2366; train_gene_expr_recon_loss: 6347084.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32124157.5823; train_optim_loss: 32124157.5823; val_kl_reg_loss: 31911.4764; val_edge_recon_loss: 25860693.5648; val_gene_expr_recon_loss: 6372405.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32265010.2500; val_optim_loss: 32265010.2500
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 32391.8459; train_edge_recon_loss: 25747735.8344; train_gene_expr_recon_loss: 6344110.3413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32124237.9959; train_optim_loss: 32124237.9959; val_kl_reg_loss: 31932.6692; val_edge_recon_loss: 25907196.2407; val_gene_expr_recon_loss: 6357006.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32296135.0370; val_optim_loss: 32296135.0370

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 32375.6870; train_edge_recon_loss: 25740886.8632; train_gene_expr_recon_loss: 6344179.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32117442.1842; train_optim_loss: 32117442.1842; val_kl_reg_loss: 31876.6462; val_edge_recon_loss: 25893350.2407; val_gene_expr_recon_loss: 6354866.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32280093.0185; val_optim_loss: 32280093.0185
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 32368.7222; train_edge_recon_loss: 25749240.8858; train_gene_expr_recon_loss: 6340447.7770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32122057.3683; train_optim_loss: 32122057.3683; val_kl_reg_loss: 31915.0602; val_edge_recon_loss: 25889838.1296; val_gene_expr_recon_loss: 6367538.6690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32289291.8148; val_optim_loss: 32289291.8148
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 32391.9364; train_edge_recon_loss: 25749585.4558; train_gene_expr_recon_loss: 6343688.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32125666.0113; train_optim_loss: 32125666.0113; val_kl_reg_loss: 31889.2513; val_edge_recon_loss: 25880943.7500; val_gene_expr_recon_loss: 6362117.8102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32274950.7963; val_optim_loss: 32274950.7963
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9928; val_auprc_score: 0.9912; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 32405.3964; train_edge_recon_loss: 25744066.2191; train_gene_expr_recon_loss: 6345035.5872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32121507.2171; train_optim_loss: 32121507.2171; val_kl_reg_loss: 31910.2966; val_edge_recon_loss: 25879516.8426; val_gene_expr_recon_loss: 6365884.1620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32277311.1667; val_optim_loss: 32277311.1667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 515 min 3 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
Val AUROC score: 0.9926
Val AUPRC score: 0.9909
Val best accuracy score: 0.9663
Val best F1 score: 0.9668
Val gene expr MSE score: 1.6149

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
