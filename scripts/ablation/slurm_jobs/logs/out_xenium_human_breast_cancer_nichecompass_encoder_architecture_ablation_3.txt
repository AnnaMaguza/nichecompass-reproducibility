None
Run timestamp: 02082023_225338_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9862; val_auprc_score: 0.9836; val_best_acc_score: 0.9468; val_best_f1_score: 0.9479; train_kl_reg_loss: 6055.4325; train_edge_recon_loss: 264667.9301; train_gene_expr_recon_loss: 116373.5875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 387096.9499; train_optim_loss: 387096.9499; val_kl_reg_loss: 5846.9471; val_edge_recon_loss: 263168.3621; val_gene_expr_recon_loss: 108912.1508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377927.4601; val_optim_loss: 377927.4601
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9566; val_best_f1_score: 0.9572; train_kl_reg_loss: 5922.7826; train_edge_recon_loss: 261507.1243; train_gene_expr_recon_loss: 108318.2253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375748.1324; train_optim_loss: 375748.1324; val_kl_reg_loss: 5814.4631; val_edge_recon_loss: 261998.8974; val_gene_expr_recon_loss: 107626.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375439.9255; val_optim_loss: 375439.9255
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9911; val_auprc_score: 0.9893; val_best_acc_score: 0.9588; val_best_f1_score: 0.9594; train_kl_reg_loss: 5920.8435; train_edge_recon_loss: 260709.9796; train_gene_expr_recon_loss: 107633.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374263.8831; train_optim_loss: 374263.8831; val_kl_reg_loss: 5709.8421; val_edge_recon_loss: 261267.5150; val_gene_expr_recon_loss: 107377.4934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374354.8507; val_optim_loss: 374354.8507
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9912; val_auprc_score: 0.9894; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 5925.9260; train_edge_recon_loss: 260363.1704; train_gene_expr_recon_loss: 107365.6563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373654.7528; train_optim_loss: 373654.7528; val_kl_reg_loss: 5914.2009; val_edge_recon_loss: 261010.6697; val_gene_expr_recon_loss: 107262.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374187.0317; val_optim_loss: 374187.0317
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9915; val_auprc_score: 0.9900; val_best_acc_score: 0.9608; val_best_f1_score: 0.9613; train_kl_reg_loss: 5929.5202; train_edge_recon_loss: 260068.9647; train_gene_expr_recon_loss: 107318.1545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373316.6397; train_optim_loss: 373316.6397; val_kl_reg_loss: 5891.2789; val_edge_recon_loss: 260977.0141; val_gene_expr_recon_loss: 107207.4744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374075.7675; val_optim_loss: 374075.7675
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9642; val_best_f1_score: 0.9646; train_kl_reg_loss: 5929.3196; train_edge_recon_loss: 259876.0903; train_gene_expr_recon_loss: 107168.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372973.4687; train_optim_loss: 372973.4687; val_kl_reg_loss: 5985.2317; val_edge_recon_loss: 260477.8690; val_gene_expr_recon_loss: 107154.0140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373617.1146; val_optim_loss: 373617.1146
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 5936.1766; train_edge_recon_loss: 259652.7141; train_gene_expr_recon_loss: 107148.3617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372737.2523; train_optim_loss: 372737.2523; val_kl_reg_loss: 5890.6954; val_edge_recon_loss: 260327.0943; val_gene_expr_recon_loss: 107170.2752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373388.0654; val_optim_loss: 373388.0654
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9645; val_best_f1_score: 0.9651; train_kl_reg_loss: 5936.9472; train_edge_recon_loss: 259584.8928; train_gene_expr_recon_loss: 107096.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372618.3702; train_optim_loss: 372618.3702; val_kl_reg_loss: 5986.2183; val_edge_recon_loss: 260183.8151; val_gene_expr_recon_loss: 106999.2359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373169.2696; val_optim_loss: 373169.2696
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5941.4581; train_edge_recon_loss: 259451.1084; train_gene_expr_recon_loss: 107094.7782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372487.3444; train_optim_loss: 372487.3444; val_kl_reg_loss: 5896.5434; val_edge_recon_loss: 259753.3440; val_gene_expr_recon_loss: 106980.9497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372630.8363; val_optim_loss: 372630.8363
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9659; val_best_f1_score: 0.9662; train_kl_reg_loss: 5942.0307; train_edge_recon_loss: 259382.7629; train_gene_expr_recon_loss: 107077.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372402.4000; train_optim_loss: 372402.4000; val_kl_reg_loss: 5888.9730; val_edge_recon_loss: 260118.5195; val_gene_expr_recon_loss: 107060.5758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373068.0678; val_optim_loss: 373068.0678
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 5945.5141; train_edge_recon_loss: 259324.5623; train_gene_expr_recon_loss: 107045.6896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372315.7660; train_optim_loss: 372315.7660; val_kl_reg_loss: 5959.8663; val_edge_recon_loss: 259834.3335; val_gene_expr_recon_loss: 107030.3319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372824.5319; val_optim_loss: 372824.5319
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 5950.0741; train_edge_recon_loss: 259158.4306; train_gene_expr_recon_loss: 107008.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372117.2246; train_optim_loss: 372117.2246; val_kl_reg_loss: 5919.9420; val_edge_recon_loss: 260044.8705; val_gene_expr_recon_loss: 106924.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372889.6930; val_optim_loss: 372889.6930
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 5952.1518; train_edge_recon_loss: 259134.1303; train_gene_expr_recon_loss: 106978.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372064.9885; train_optim_loss: 372064.9885; val_kl_reg_loss: 5952.2202; val_edge_recon_loss: 259959.0921; val_gene_expr_recon_loss: 107024.0237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372935.3358; val_optim_loss: 372935.3358

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9941; val_auprc_score: 0.9929; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 5985.7829; train_edge_recon_loss: 258773.2365; train_gene_expr_recon_loss: 106149.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370908.6497; train_optim_loss: 370908.6497; val_kl_reg_loss: 5930.6232; val_edge_recon_loss: 259134.5869; val_gene_expr_recon_loss: 106054.7299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371119.9399; val_optim_loss: 371119.9399
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 5972.6646; train_edge_recon_loss: 258725.8773; train_gene_expr_recon_loss: 105978.7577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370677.2996; train_optim_loss: 370677.2996; val_kl_reg_loss: 5942.2010; val_edge_recon_loss: 259288.7925; val_gene_expr_recon_loss: 106036.2550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371267.2488; val_optim_loss: 371267.2488
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5968.6463; train_edge_recon_loss: 258715.1953; train_gene_expr_recon_loss: 105887.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370571.2701; train_optim_loss: 370571.2701; val_kl_reg_loss: 5945.6494; val_edge_recon_loss: 259460.1489; val_gene_expr_recon_loss: 105968.4132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371374.2116; val_optim_loss: 371374.2116
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9698; val_best_f1_score: 0.9702; train_kl_reg_loss: 5965.1571; train_edge_recon_loss: 258634.9396; train_gene_expr_recon_loss: 105858.9579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370459.0544; train_optim_loss: 370459.0544; val_kl_reg_loss: 5975.2278; val_edge_recon_loss: 259234.5452; val_gene_expr_recon_loss: 105915.3102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371125.0826; val_optim_loss: 371125.0826
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 5959.5898; train_edge_recon_loss: 258667.5627; train_gene_expr_recon_loss: 105809.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370436.6957; train_optim_loss: 370436.6957; val_kl_reg_loss: 5947.7751; val_edge_recon_loss: 259287.6210; val_gene_expr_recon_loss: 105932.9107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371168.3073; val_optim_loss: 371168.3073

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9940; val_auprc_score: 0.9927; val_best_acc_score: 0.9697; val_best_f1_score: 0.9701; train_kl_reg_loss: 5966.5166; train_edge_recon_loss: 258621.1353; train_gene_expr_recon_loss: 105724.6126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370312.2648; train_optim_loss: 370312.2648; val_kl_reg_loss: 5949.2235; val_edge_recon_loss: 259270.2505; val_gene_expr_recon_loss: 105682.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370901.7136; val_optim_loss: 370901.7136
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9709; val_best_f1_score: 0.9712; train_kl_reg_loss: 5964.8422; train_edge_recon_loss: 258621.8430; train_gene_expr_recon_loss: 105670.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370257.0906; train_optim_loss: 370257.0906; val_kl_reg_loss: 5936.8263; val_edge_recon_loss: 258900.3016; val_gene_expr_recon_loss: 105780.1290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370617.2566; val_optim_loss: 370617.2566
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9932; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 5961.2268; train_edge_recon_loss: 258664.0485; train_gene_expr_recon_loss: 105650.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370275.9646; train_optim_loss: 370275.9646; val_kl_reg_loss: 5936.4256; val_edge_recon_loss: 259097.5716; val_gene_expr_recon_loss: 105826.0619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370860.0584; val_optim_loss: 370860.0584
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 5961.6693; train_edge_recon_loss: 258488.4051; train_gene_expr_recon_loss: 105688.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370138.5566; train_optim_loss: 370138.5566; val_kl_reg_loss: 5943.1256; val_edge_recon_loss: 258895.1443; val_gene_expr_recon_loss: 105665.1134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370503.3828; val_optim_loss: 370503.3828
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 5961.3798; train_edge_recon_loss: 258578.4363; train_gene_expr_recon_loss: 105706.7794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370246.5955; train_optim_loss: 370246.5955; val_kl_reg_loss: 5933.5894; val_edge_recon_loss: 259100.9825; val_gene_expr_recon_loss: 105755.0256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370789.5978; val_optim_loss: 370789.5978
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9930; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 5960.6959; train_edge_recon_loss: 258567.7503; train_gene_expr_recon_loss: 105712.6199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370241.0663; train_optim_loss: 370241.0663; val_kl_reg_loss: 5941.1512; val_edge_recon_loss: 259063.2678; val_gene_expr_recon_loss: 105773.9547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370778.3745; val_optim_loss: 370778.3745
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 5960.4251; train_edge_recon_loss: 258603.7578; train_gene_expr_recon_loss: 105698.0697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370262.2527; train_optim_loss: 370262.2527; val_kl_reg_loss: 5943.3899; val_edge_recon_loss: 259062.7070; val_gene_expr_recon_loss: 105864.2774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370870.3742; val_optim_loss: 370870.3742
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9942; val_auprc_score: 0.9930; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5960.4589; train_edge_recon_loss: 258593.4957; train_gene_expr_recon_loss: 105677.2588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370231.2136; train_optim_loss: 370231.2136; val_kl_reg_loss: 5944.5556; val_edge_recon_loss: 258915.8721; val_gene_expr_recon_loss: 105646.0034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370506.4311; val_optim_loss: 370506.4311

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 5963.7482; train_edge_recon_loss: 258569.1662; train_gene_expr_recon_loss: 105675.1633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370208.0776; train_optim_loss: 370208.0776; val_kl_reg_loss: 5943.0664; val_edge_recon_loss: 259072.1523; val_gene_expr_recon_loss: 105638.7276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370653.9470; val_optim_loss: 370653.9470
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9943; val_auprc_score: 0.9931; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 5962.6973; train_edge_recon_loss: 258601.6750; train_gene_expr_recon_loss: 105671.4187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370235.7907; train_optim_loss: 370235.7907; val_kl_reg_loss: 5939.7574; val_edge_recon_loss: 259038.4684; val_gene_expr_recon_loss: 105626.0158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370604.2415; val_optim_loss: 370604.2415
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9705; val_best_f1_score: 0.9708; train_kl_reg_loss: 5960.3669; train_edge_recon_loss: 258580.5687; train_gene_expr_recon_loss: 105650.2883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370191.2240; train_optim_loss: 370191.2240; val_kl_reg_loss: 5939.4485; val_edge_recon_loss: 259190.0566; val_gene_expr_recon_loss: 105679.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370808.9867; val_optim_loss: 370808.9867
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 5962.5227; train_edge_recon_loss: 258582.7768; train_gene_expr_recon_loss: 105666.4839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370211.7834; train_optim_loss: 370211.7834; val_kl_reg_loss: 5940.6902; val_edge_recon_loss: 258777.1340; val_gene_expr_recon_loss: 105795.2569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370513.0810; val_optim_loss: 370513.0810

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 303 min 13 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9942
val AUPRC score: 0.9930
val best accuracy score: 0.9703
val best F1 score: 0.9706
val target rna MSE score: 1.4508
val source rna MSE score: 0.2091

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
