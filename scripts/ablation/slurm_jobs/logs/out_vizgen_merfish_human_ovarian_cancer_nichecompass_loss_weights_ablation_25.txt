None
Run timestamp: 06072023_042358_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9713; val_auprc_score: 0.9685; val_best_acc_score: 0.9171; val_best_f1_score: 0.9178; train_kl_reg_loss: 5540.3299; train_edge_recon_loss: 266497.3387; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272037.6686; train_optim_loss: 272037.6686; val_kl_reg_loss: 5423.5785; val_edge_recon_loss: 265343.9500; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270767.5287; val_optim_loss: 270767.5287
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9771; val_auprc_score: 0.9749; val_best_acc_score: 0.9259; val_best_f1_score: 0.9266; train_kl_reg_loss: 5549.7125; train_edge_recon_loss: 261555.0314; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267104.7437; train_optim_loss: 267104.7437; val_kl_reg_loss: 5483.3826; val_edge_recon_loss: 264321.7064; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269805.0895; val_optim_loss: 269805.0895
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9804; val_auprc_score: 0.9778; val_best_acc_score: 0.9322; val_best_f1_score: 0.9330; train_kl_reg_loss: 5509.4790; train_edge_recon_loss: 260848.8062; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266358.2854; train_optim_loss: 266358.2854; val_kl_reg_loss: 5412.9270; val_edge_recon_loss: 263622.6611; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269035.5892; val_optim_loss: 269035.5892
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9816; val_auprc_score: 0.9792; val_best_acc_score: 0.9349; val_best_f1_score: 0.9356; train_kl_reg_loss: 5490.1410; train_edge_recon_loss: 260617.8756; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266108.0168; train_optim_loss: 266108.0168; val_kl_reg_loss: 5432.0441; val_edge_recon_loss: 263477.3729; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268909.4162; val_optim_loss: 268909.4162
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9822; val_auprc_score: 0.9801; val_best_acc_score: 0.9363; val_best_f1_score: 0.9369; train_kl_reg_loss: 5491.1895; train_edge_recon_loss: 260271.0319; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265762.2209; train_optim_loss: 265762.2209; val_kl_reg_loss: 5373.2876; val_edge_recon_loss: 263018.1412; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268391.4284; val_optim_loss: 268391.4284
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9839; val_auprc_score: 0.9818; val_best_acc_score: 0.9392; val_best_f1_score: 0.9403; train_kl_reg_loss: 5484.4576; train_edge_recon_loss: 260095.3728; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265579.8307; train_optim_loss: 265579.8307; val_kl_reg_loss: 5231.3019; val_edge_recon_loss: 263477.9112; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268709.2131; val_optim_loss: 268709.2131
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9850; val_auprc_score: 0.9831; val_best_acc_score: 0.9427; val_best_f1_score: 0.9432; train_kl_reg_loss: 5478.0914; train_edge_recon_loss: 259981.5270; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265459.6181; train_optim_loss: 265459.6181; val_kl_reg_loss: 5452.6990; val_edge_recon_loss: 263256.1003; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268708.7996; val_optim_loss: 268708.7996
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9838; val_best_acc_score: 0.9437; val_best_f1_score: 0.9443; train_kl_reg_loss: 5479.8960; train_edge_recon_loss: 259782.1446; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265262.0411; train_optim_loss: 265262.0411; val_kl_reg_loss: 5370.5413; val_edge_recon_loss: 263337.1122; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268707.6526; val_optim_loss: 268707.6526
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9857; val_auprc_score: 0.9838; val_best_acc_score: 0.9454; val_best_f1_score: 0.9459; train_kl_reg_loss: 5478.7533; train_edge_recon_loss: 259751.5391; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265230.2928; train_optim_loss: 265230.2928; val_kl_reg_loss: 5380.7780; val_edge_recon_loss: 263028.4490; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268409.2273; val_optim_loss: 268409.2273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9881; val_auprc_score: 0.9862; val_best_acc_score: 0.9508; val_best_f1_score: 0.9513; train_kl_reg_loss: 5456.5788; train_edge_recon_loss: 259445.3569; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264901.9358; train_optim_loss: 264901.9358; val_kl_reg_loss: 5331.3129; val_edge_recon_loss: 262472.5398; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267803.8511; val_optim_loss: 267803.8511
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9877; val_auprc_score: 0.9859; val_best_acc_score: 0.9493; val_best_f1_score: 0.9497; train_kl_reg_loss: 5449.1861; train_edge_recon_loss: 259244.6333; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264693.8195; train_optim_loss: 264693.8195; val_kl_reg_loss: 5354.9210; val_edge_recon_loss: 262697.2561; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268052.1778; val_optim_loss: 268052.1778
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9877; val_auprc_score: 0.9857; val_best_acc_score: 0.9502; val_best_f1_score: 0.9507; train_kl_reg_loss: 5441.1224; train_edge_recon_loss: 259238.3670; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264679.4891; train_optim_loss: 264679.4891; val_kl_reg_loss: 5376.8773; val_edge_recon_loss: 262549.6403; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267926.5176; val_optim_loss: 267926.5176
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9883; val_auprc_score: 0.9865; val_best_acc_score: 0.9510; val_best_f1_score: 0.9511; train_kl_reg_loss: 5441.1943; train_edge_recon_loss: 259274.9308; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264716.1255; train_optim_loss: 264716.1255; val_kl_reg_loss: 5342.6149; val_edge_recon_loss: 262411.3994; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267754.0142; val_optim_loss: 267754.0142
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9882; val_auprc_score: 0.9861; val_best_acc_score: 0.9514; val_best_f1_score: 0.9517; train_kl_reg_loss: 5438.0140; train_edge_recon_loss: 259164.3406; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264602.3548; train_optim_loss: 264602.3548; val_kl_reg_loss: 5374.4884; val_edge_recon_loss: 262249.3415; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267623.8290; val_optim_loss: 267623.8290
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9862; val_best_acc_score: 0.9514; val_best_f1_score: 0.9515; train_kl_reg_loss: 5432.8989; train_edge_recon_loss: 259202.0628; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264634.9617; train_optim_loss: 264634.9617; val_kl_reg_loss: 5336.9250; val_edge_recon_loss: 262618.5642; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267955.4886; val_optim_loss: 267955.4886
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9880; val_auprc_score: 0.9860; val_best_acc_score: 0.9507; val_best_f1_score: 0.9511; train_kl_reg_loss: 5434.1478; train_edge_recon_loss: 259175.8338; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264609.9817; train_optim_loss: 264609.9817; val_kl_reg_loss: 5329.5273; val_edge_recon_loss: 262621.3888; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267950.9170; val_optim_loss: 267950.9170
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9885; val_auprc_score: 0.9868; val_best_acc_score: 0.9508; val_best_f1_score: 0.9513; train_kl_reg_loss: 5432.7930; train_edge_recon_loss: 259117.2558; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264550.0487; train_optim_loss: 264550.0487; val_kl_reg_loss: 5339.4156; val_edge_recon_loss: 262336.7420; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267676.1588; val_optim_loss: 267676.1588
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9870; val_best_acc_score: 0.9522; val_best_f1_score: 0.9525; train_kl_reg_loss: 5430.7672; train_edge_recon_loss: 259007.5698; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264438.3372; train_optim_loss: 264438.3372; val_kl_reg_loss: 5296.4430; val_edge_recon_loss: 262237.1982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267533.6409; val_optim_loss: 267533.6409
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9886; val_auprc_score: 0.9868; val_best_acc_score: 0.9525; val_best_f1_score: 0.9527; train_kl_reg_loss: 5432.9035; train_edge_recon_loss: 259069.9191; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264502.8230; train_optim_loss: 264502.8230; val_kl_reg_loss: 5293.2237; val_edge_recon_loss: 262377.2682; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267670.4912; val_optim_loss: 267670.4912
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9867; val_best_acc_score: 0.9530; val_best_f1_score: 0.9533; train_kl_reg_loss: 5431.2734; train_edge_recon_loss: 259050.0103; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264481.2840; train_optim_loss: 264481.2840; val_kl_reg_loss: 5350.9606; val_edge_recon_loss: 262501.8055; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267852.7673; val_optim_loss: 267852.7673
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9872; val_best_acc_score: 0.9534; val_best_f1_score: 0.9536; train_kl_reg_loss: 5432.8379; train_edge_recon_loss: 259072.3056; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264505.1439; train_optim_loss: 264505.1439; val_kl_reg_loss: 5323.5307; val_edge_recon_loss: 261971.4315; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267294.9602; val_optim_loss: 267294.9602
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9891; val_auprc_score: 0.9875; val_best_acc_score: 0.9523; val_best_f1_score: 0.9525; train_kl_reg_loss: 5429.8836; train_edge_recon_loss: 258923.7670; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264353.6505; train_optim_loss: 264353.6505; val_kl_reg_loss: 5320.8304; val_edge_recon_loss: 262373.8399; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267694.6702; val_optim_loss: 267694.6702
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9888; val_auprc_score: 0.9867; val_best_acc_score: 0.9520; val_best_f1_score: 0.9523; train_kl_reg_loss: 5426.8005; train_edge_recon_loss: 259132.3742; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264559.1747; train_optim_loss: 264559.1747; val_kl_reg_loss: 5411.0892; val_edge_recon_loss: 262543.0619; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267954.1489; val_optim_loss: 267954.1489
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9891; val_auprc_score: 0.9874; val_best_acc_score: 0.9525; val_best_f1_score: 0.9528; train_kl_reg_loss: 5425.3012; train_edge_recon_loss: 258977.5468; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264402.8475; train_optim_loss: 264402.8475; val_kl_reg_loss: 5352.0859; val_edge_recon_loss: 262407.0293; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267759.1142; val_optim_loss: 267759.1142
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9883; val_best_acc_score: 0.9534; val_best_f1_score: 0.9539; train_kl_reg_loss: 5427.0421; train_edge_recon_loss: 258956.0651; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264383.1075; train_optim_loss: 264383.1075; val_kl_reg_loss: 5327.9368; val_edge_recon_loss: 262235.9246; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267563.8614; val_optim_loss: 267563.8614

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9893; val_auprc_score: 0.9876; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 5422.7633; train_edge_recon_loss: 258971.9589; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264394.7225; train_optim_loss: 264394.7225; val_kl_reg_loss: 5330.2932; val_edge_recon_loss: 262146.4293; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267476.7224; val_optim_loss: 267476.7224
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9879; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 5424.7355; train_edge_recon_loss: 258875.2931; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264300.0282; train_optim_loss: 264300.0282; val_kl_reg_loss: 5322.6894; val_edge_recon_loss: 262141.4679; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267464.1574; val_optim_loss: 267464.1574
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9536; val_best_f1_score: 0.9540; train_kl_reg_loss: 5425.5573; train_edge_recon_loss: 258895.4315; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264320.9889; train_optim_loss: 264320.9889; val_kl_reg_loss: 5299.4982; val_edge_recon_loss: 262291.6067; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267591.1055; val_optim_loss: 267591.1055
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9890; val_auprc_score: 0.9869; val_best_acc_score: 0.9532; val_best_f1_score: 0.9535; train_kl_reg_loss: 5424.2428; train_edge_recon_loss: 258850.1788; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264274.4212; train_optim_loss: 264274.4212; val_kl_reg_loss: 5325.4954; val_edge_recon_loss: 262607.1780; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267932.6736; val_optim_loss: 267932.6736

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 56 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9880
Val best accuracy score: 0.9534
Val best F1 score: 0.9537
Val gene expr MSE score: 14.6659

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
