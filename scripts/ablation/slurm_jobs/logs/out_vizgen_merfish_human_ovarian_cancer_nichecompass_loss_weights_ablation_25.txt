None
Run timestamp: 07072023_025520_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9727; val_auprc_score: 0.9705; val_best_acc_score: 0.9175; val_best_f1_score: 0.9184; train_kl_reg_loss: 5574.0647; train_edge_recon_loss: 266486.0863; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272060.1516; train_optim_loss: 272060.1516; val_kl_reg_loss: 5522.6652; val_edge_recon_loss: 265071.7702; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270594.4352; val_optim_loss: 270594.4352
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9791; val_auprc_score: 0.9771; val_best_acc_score: 0.9287; val_best_f1_score: 0.9297; train_kl_reg_loss: 5590.5007; train_edge_recon_loss: 261451.0647; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267041.5654; train_optim_loss: 267041.5654; val_kl_reg_loss: 5621.1090; val_edge_recon_loss: 264245.1256; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269866.2347; val_optim_loss: 269866.2347
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9792; val_auprc_score: 0.9773; val_best_acc_score: 0.9303; val_best_f1_score: 0.9308; train_kl_reg_loss: 5550.7003; train_edge_recon_loss: 260786.1429; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266336.8430; train_optim_loss: 266336.8430; val_kl_reg_loss: 5423.3210; val_edge_recon_loss: 264091.3986; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269514.7190; val_optim_loss: 269514.7190
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9809; val_auprc_score: 0.9777; val_best_acc_score: 0.9345; val_best_f1_score: 0.9352; train_kl_reg_loss: 5539.4134; train_edge_recon_loss: 260449.4849; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265988.8978; train_optim_loss: 265988.8978; val_kl_reg_loss: 5502.2028; val_edge_recon_loss: 263901.0023; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269403.2053; val_optim_loss: 269403.2053
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9836; val_auprc_score: 0.9816; val_best_acc_score: 0.9394; val_best_f1_score: 0.9399; train_kl_reg_loss: 5536.4493; train_edge_recon_loss: 260299.0680; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265835.5169; train_optim_loss: 265835.5169; val_kl_reg_loss: 5405.4414; val_edge_recon_loss: 263518.2700; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268923.7131; val_optim_loss: 268923.7131
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9842; val_auprc_score: 0.9823; val_best_acc_score: 0.9413; val_best_f1_score: 0.9419; train_kl_reg_loss: 5530.7170; train_edge_recon_loss: 260177.9735; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265708.6905; train_optim_loss: 265708.6905; val_kl_reg_loss: 5349.1659; val_edge_recon_loss: 263180.3151; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268529.4813; val_optim_loss: 268529.4813
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9840; val_auprc_score: 0.9815; val_best_acc_score: 0.9412; val_best_f1_score: 0.9421; train_kl_reg_loss: 5539.9611; train_edge_recon_loss: 259854.2410; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265394.2019; train_optim_loss: 265394.2019; val_kl_reg_loss: 5465.2727; val_edge_recon_loss: 263716.0857; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269181.3591; val_optim_loss: 269181.3591
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9860; val_auprc_score: 0.9842; val_best_acc_score: 0.9449; val_best_f1_score: 0.9455; train_kl_reg_loss: 5538.0446; train_edge_recon_loss: 259849.0281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265387.0725; train_optim_loss: 265387.0725; val_kl_reg_loss: 5267.7568; val_edge_recon_loss: 263405.1536; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268672.9114; val_optim_loss: 268672.9114
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9862; val_auprc_score: 0.9845; val_best_acc_score: 0.9453; val_best_f1_score: 0.9458; train_kl_reg_loss: 5535.2460; train_edge_recon_loss: 259646.6023; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265181.8484; train_optim_loss: 265181.8484; val_kl_reg_loss: 5270.5651; val_edge_recon_loss: 263192.6909; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268463.2574; val_optim_loss: 268463.2574
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9858; val_auprc_score: 0.9839; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 5532.4220; train_edge_recon_loss: 259622.0668; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265154.4888; train_optim_loss: 265154.4888; val_kl_reg_loss: 5510.6928; val_edge_recon_loss: 263486.7314; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268997.4250; val_optim_loss: 268997.4250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9867; val_auprc_score: 0.9847; val_best_acc_score: 0.9464; val_best_f1_score: 0.9469; train_kl_reg_loss: 5534.1540; train_edge_recon_loss: 259528.5712; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265062.7256; train_optim_loss: 265062.7256; val_kl_reg_loss: 5357.6250; val_edge_recon_loss: 262920.2072; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268277.8318; val_optim_loss: 268277.8318
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9875; val_auprc_score: 0.9857; val_best_acc_score: 0.9494; val_best_f1_score: 0.9497; train_kl_reg_loss: 5530.2215; train_edge_recon_loss: 259474.3827; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265004.6045; train_optim_loss: 265004.6045; val_kl_reg_loss: 5490.3347; val_edge_recon_loss: 262454.7797; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267945.1168; val_optim_loss: 267945.1168
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9877; val_auprc_score: 0.9859; val_best_acc_score: 0.9498; val_best_f1_score: 0.9502; train_kl_reg_loss: 5530.8125; train_edge_recon_loss: 259442.0485; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264972.8613; train_optim_loss: 264972.8613; val_kl_reg_loss: 5477.4160; val_edge_recon_loss: 262970.8560; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268448.2727; val_optim_loss: 268448.2727
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9880; val_auprc_score: 0.9859; val_best_acc_score: 0.9496; val_best_f1_score: 0.9500; train_kl_reg_loss: 5530.0425; train_edge_recon_loss: 259387.5958; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264917.6385; train_optim_loss: 264917.6385; val_kl_reg_loss: 5583.4547; val_edge_recon_loss: 263189.4911; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268772.9460; val_optim_loss: 268772.9460
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9876; val_auprc_score: 0.9859; val_best_acc_score: 0.9498; val_best_f1_score: 0.9503; train_kl_reg_loss: 5527.4703; train_edge_recon_loss: 259346.5658; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264874.0362; train_optim_loss: 264874.0362; val_kl_reg_loss: 5546.5293; val_edge_recon_loss: 262826.6490; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268373.1773; val_optim_loss: 268373.1773
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9883; val_auprc_score: 0.9864; val_best_acc_score: 0.9504; val_best_f1_score: 0.9508; train_kl_reg_loss: 5527.3862; train_edge_recon_loss: 259305.0475; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264832.4335; train_optim_loss: 264832.4335; val_kl_reg_loss: 5555.4227; val_edge_recon_loss: 262612.7425; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268168.1645; val_optim_loss: 268168.1645

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9539; val_best_f1_score: 0.9541; train_kl_reg_loss: 5515.0430; train_edge_recon_loss: 258958.0837; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264473.1273; train_optim_loss: 264473.1273; val_kl_reg_loss: 5451.8934; val_edge_recon_loss: 262663.8016; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268115.6943; val_optim_loss: 268115.6943
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9546; val_best_f1_score: 0.9551; train_kl_reg_loss: 5505.8660; train_edge_recon_loss: 258783.4290; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264289.2954; train_optim_loss: 264289.2954; val_kl_reg_loss: 5414.5545; val_edge_recon_loss: 262427.2180; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267841.7730; val_optim_loss: 267841.7730
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9896; val_auprc_score: 0.9876; val_best_acc_score: 0.9550; val_best_f1_score: 0.9553; train_kl_reg_loss: 5497.4953; train_edge_recon_loss: 258786.6829; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264284.1785; train_optim_loss: 264284.1785; val_kl_reg_loss: 5470.6833; val_edge_recon_loss: 262165.4990; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267636.1835; val_optim_loss: 267636.1835
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9896; val_auprc_score: 0.9877; val_best_acc_score: 0.9547; val_best_f1_score: 0.9550; train_kl_reg_loss: 5491.4144; train_edge_recon_loss: 258827.2431; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264318.6579; train_optim_loss: 264318.6579; val_kl_reg_loss: 5388.7925; val_edge_recon_loss: 262305.6699; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267694.4608; val_optim_loss: 267694.4608
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9899; val_auprc_score: 0.9879; val_best_acc_score: 0.9557; val_best_f1_score: 0.9562; train_kl_reg_loss: 5488.4389; train_edge_recon_loss: 258826.5648; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264315.0039; train_optim_loss: 264315.0039; val_kl_reg_loss: 5413.0557; val_edge_recon_loss: 262074.9077; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267487.9645; val_optim_loss: 267487.9645
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9899; val_auprc_score: 0.9882; val_best_acc_score: 0.9557; val_best_f1_score: 0.9561; train_kl_reg_loss: 5487.6333; train_edge_recon_loss: 258764.3735; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264252.0065; train_optim_loss: 264252.0065; val_kl_reg_loss: 5426.0623; val_edge_recon_loss: 262176.5611; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267602.6241; val_optim_loss: 267602.6241
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9896; val_auprc_score: 0.9875; val_best_acc_score: 0.9552; val_best_f1_score: 0.9557; train_kl_reg_loss: 5490.4388; train_edge_recon_loss: 258700.4884; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264190.9272; train_optim_loss: 264190.9272; val_kl_reg_loss: 5376.4485; val_edge_recon_loss: 262398.5572; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267775.0061; val_optim_loss: 267775.0061
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9894; val_auprc_score: 0.9874; val_best_acc_score: 0.9547; val_best_f1_score: 0.9551; train_kl_reg_loss: 5489.0003; train_edge_recon_loss: 258721.0281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264210.0286; train_optim_loss: 264210.0286; val_kl_reg_loss: 5437.1824; val_edge_recon_loss: 262132.5801; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267569.7618; val_optim_loss: 267569.7618
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9901; val_auprc_score: 0.9882; val_best_acc_score: 0.9565; val_best_f1_score: 0.9568; train_kl_reg_loss: 5480.1745; train_edge_recon_loss: 258842.5730; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264322.7470; train_optim_loss: 264322.7470; val_kl_reg_loss: 5411.4866; val_edge_recon_loss: 262207.7994; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267619.2852; val_optim_loss: 267619.2852

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9560; val_best_f1_score: 0.9563; train_kl_reg_loss: 5489.7397; train_edge_recon_loss: 258625.5023; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264115.2422; train_optim_loss: 264115.2422; val_kl_reg_loss: 5397.6790; val_edge_recon_loss: 261828.3898; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267226.0669; val_optim_loss: 267226.0669
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9884; val_best_acc_score: 0.9570; val_best_f1_score: 0.9574; train_kl_reg_loss: 5482.6899; train_edge_recon_loss: 258740.5692; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264223.2596; train_optim_loss: 264223.2596; val_kl_reg_loss: 5397.7451; val_edge_recon_loss: 261794.3598; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267192.1045; val_optim_loss: 267192.1045
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9562; val_best_f1_score: 0.9566; train_kl_reg_loss: 5482.8191; train_edge_recon_loss: 258685.5748; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264168.3938; train_optim_loss: 264168.3938; val_kl_reg_loss: 5396.2431; val_edge_recon_loss: 261953.7244; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267349.9680; val_optim_loss: 267349.9680
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9568; val_best_f1_score: 0.9572; train_kl_reg_loss: 5480.5702; train_edge_recon_loss: 258691.0320; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264171.6023; train_optim_loss: 264171.6023; val_kl_reg_loss: 5399.9375; val_edge_recon_loss: 261979.8241; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267379.7622; val_optim_loss: 267379.7622
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9561; val_best_f1_score: 0.9565; train_kl_reg_loss: 5482.0830; train_edge_recon_loss: 258629.3888; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264111.4718; train_optim_loss: 264111.4718; val_kl_reg_loss: 5403.9988; val_edge_recon_loss: 262099.9705; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267503.9682; val_optim_loss: 267503.9682
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9899; val_auprc_score: 0.9879; val_best_acc_score: 0.9561; val_best_f1_score: 0.9563; train_kl_reg_loss: 5479.2718; train_edge_recon_loss: 258736.1682; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264215.4403; train_optim_loss: 264215.4403; val_kl_reg_loss: 5399.3323; val_edge_recon_loss: 262269.9337; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267669.2653; val_optim_loss: 267669.2653

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9903; val_auprc_score: 0.9889; val_best_acc_score: 0.9566; val_best_f1_score: 0.9569; train_kl_reg_loss: 5478.8408; train_edge_recon_loss: 258701.4947; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264180.3351; train_optim_loss: 264180.3351; val_kl_reg_loss: 5397.2018; val_edge_recon_loss: 262174.4689; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267571.6702; val_optim_loss: 267571.6702
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9562; val_best_f1_score: 0.9565; train_kl_reg_loss: 5480.9357; train_edge_recon_loss: 258649.4720; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264130.4080; train_optim_loss: 264130.4080; val_kl_reg_loss: 5400.9447; val_edge_recon_loss: 262018.5652; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267419.5108; val_optim_loss: 267419.5108
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9902; val_auprc_score: 0.9886; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 5482.1532; train_edge_recon_loss: 258691.8026; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264173.9559; train_optim_loss: 264173.9559; val_kl_reg_loss: 5396.1180; val_edge_recon_loss: 262311.8499; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267707.9688; val_optim_loss: 267707.9688
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9902; val_auprc_score: 0.9882; val_best_acc_score: 0.9569; val_best_f1_score: 0.9574; train_kl_reg_loss: 5480.8763; train_edge_recon_loss: 258613.9621; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264094.8384; train_optim_loss: 264094.8384; val_kl_reg_loss: 5398.2559; val_edge_recon_loss: 261829.7446; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267228.0010; val_optim_loss: 267228.0010

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 79 min 28 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9884
Val best accuracy score: 0.9562
Val best F1 score: 0.9567
Val gene expr MSE score: 15.1099

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
