None
Run timestamp: 01072023_001429_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9683; val_auprc_score: 0.9655; val_best_acc_score: 0.9117; val_best_f1_score: 0.9127; train_kl_reg_loss: 5529.3256; train_edge_recon_loss: 269317.1248; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274846.4505; train_optim_loss: 274846.4505; val_kl_reg_loss: 5484.0015; val_edge_recon_loss: 265970.8369; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271454.8398; val_optim_loss: 271454.8398
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9752; val_auprc_score: 0.9728; val_best_acc_score: 0.9226; val_best_f1_score: 0.9232; train_kl_reg_loss: 5608.3952; train_edge_recon_loss: 261748.8492; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267357.2447; train_optim_loss: 267357.2447; val_kl_reg_loss: 5568.9244; val_edge_recon_loss: 264450.6722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270019.5966; val_optim_loss: 270019.5966
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9792; val_best_acc_score: 0.9334; val_best_f1_score: 0.9342; train_kl_reg_loss: 5563.6167; train_edge_recon_loss: 261172.8238; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266736.4405; train_optim_loss: 266736.4405; val_kl_reg_loss: 5440.7304; val_edge_recon_loss: 263815.1071; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269255.8403; val_optim_loss: 269255.8403
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9812; val_auprc_score: 0.9795; val_best_acc_score: 0.9341; val_best_f1_score: 0.9347; train_kl_reg_loss: 5536.7206; train_edge_recon_loss: 260781.1278; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266317.8482; train_optim_loss: 266317.8482; val_kl_reg_loss: 5357.2257; val_edge_recon_loss: 263621.0741; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268978.3006; val_optim_loss: 268978.3006
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9820; val_auprc_score: 0.9800; val_best_acc_score: 0.9359; val_best_f1_score: 0.9364; train_kl_reg_loss: 5514.3366; train_edge_recon_loss: 260570.4496; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266084.7862; train_optim_loss: 266084.7862; val_kl_reg_loss: 5455.5210; val_edge_recon_loss: 263993.9108; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269449.4301; val_optim_loss: 269449.4301
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9818; val_best_acc_score: 0.9393; val_best_f1_score: 0.9398; train_kl_reg_loss: 5503.1611; train_edge_recon_loss: 260436.0060; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265939.1666; train_optim_loss: 265939.1666; val_kl_reg_loss: 5393.7038; val_edge_recon_loss: 263160.8088; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268554.5131; val_optim_loss: 268554.5131
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9839; val_auprc_score: 0.9820; val_best_acc_score: 0.9397; val_best_f1_score: 0.9403; train_kl_reg_loss: 5501.9938; train_edge_recon_loss: 260154.3602; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265656.3540; train_optim_loss: 265656.3540; val_kl_reg_loss: 5344.3970; val_edge_recon_loss: 263199.0889; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268543.4852; val_optim_loss: 268543.4852
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9850; val_auprc_score: 0.9831; val_best_acc_score: 0.9422; val_best_f1_score: 0.9428; train_kl_reg_loss: 5501.3327; train_edge_recon_loss: 260072.2560; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265573.5891; train_optim_loss: 265573.5891; val_kl_reg_loss: 5234.5907; val_edge_recon_loss: 263496.7997; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268731.3903; val_optim_loss: 268731.3903
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9863; val_auprc_score: 0.9845; val_best_acc_score: 0.9458; val_best_f1_score: 0.9465; train_kl_reg_loss: 5502.3794; train_edge_recon_loss: 259938.9956; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265441.3752; train_optim_loss: 265441.3752; val_kl_reg_loss: 5384.2311; val_edge_recon_loss: 262723.5940; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268107.8239; val_optim_loss: 268107.8239
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9861; val_auprc_score: 0.9841; val_best_acc_score: 0.9457; val_best_f1_score: 0.9463; train_kl_reg_loss: 5512.7208; train_edge_recon_loss: 259697.0520; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265209.7727; train_optim_loss: 265209.7727; val_kl_reg_loss: 5410.6998; val_edge_recon_loss: 263328.5747; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268739.2739; val_optim_loss: 268739.2739
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9868; val_auprc_score: 0.9850; val_best_acc_score: 0.9468; val_best_f1_score: 0.9472; train_kl_reg_loss: 5510.2687; train_edge_recon_loss: 259732.4876; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265242.7560; train_optim_loss: 265242.7560; val_kl_reg_loss: 5235.8950; val_edge_recon_loss: 262991.2477; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268227.1426; val_optim_loss: 268227.1426
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9866; val_auprc_score: 0.9845; val_best_acc_score: 0.9467; val_best_f1_score: 0.9472; train_kl_reg_loss: 5508.9495; train_edge_recon_loss: 259602.5075; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265111.4570; train_optim_loss: 265111.4570; val_kl_reg_loss: 5496.3677; val_edge_recon_loss: 262987.0352; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268483.4040; val_optim_loss: 268483.4040
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9869; val_auprc_score: 0.9851; val_best_acc_score: 0.9476; val_best_f1_score: 0.9479; train_kl_reg_loss: 5515.3423; train_edge_recon_loss: 259482.6323; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264997.9743; train_optim_loss: 264997.9743; val_kl_reg_loss: 5603.3676; val_edge_recon_loss: 262925.6460; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268529.0136; val_optim_loss: 268529.0136

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9877; val_auprc_score: 0.9859; val_best_acc_score: 0.9498; val_best_f1_score: 0.9503; train_kl_reg_loss: 5504.2481; train_edge_recon_loss: 259170.4155; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264674.6631; train_optim_loss: 264674.6631; val_kl_reg_loss: 5362.8755; val_edge_recon_loss: 262544.1250; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267906.9989; val_optim_loss: 267906.9989
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9877; val_auprc_score: 0.9857; val_best_acc_score: 0.9496; val_best_f1_score: 0.9499; train_kl_reg_loss: 5490.6356; train_edge_recon_loss: 259185.5604; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264676.1959; train_optim_loss: 264676.1959; val_kl_reg_loss: 5403.0826; val_edge_recon_loss: 262600.1199; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268003.2034; val_optim_loss: 268003.2034
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9883; val_auprc_score: 0.9865; val_best_acc_score: 0.9507; val_best_f1_score: 0.9510; train_kl_reg_loss: 5489.9775; train_edge_recon_loss: 259173.3949; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264663.3725; train_optim_loss: 264663.3725; val_kl_reg_loss: 5346.6387; val_edge_recon_loss: 262543.2443; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267889.8812; val_optim_loss: 267889.8812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9883; val_auprc_score: 0.9863; val_best_acc_score: 0.9509; val_best_f1_score: 0.9513; train_kl_reg_loss: 5489.2165; train_edge_recon_loss: 259102.7227; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264591.9391; train_optim_loss: 264591.9391; val_kl_reg_loss: 5380.5054; val_edge_recon_loss: 262855.0619; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268235.5665; val_optim_loss: 268235.5665
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9887; val_auprc_score: 0.9868; val_best_acc_score: 0.9518; val_best_f1_score: 0.9524; train_kl_reg_loss: 5480.4320; train_edge_recon_loss: 259163.6233; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264644.0555; train_optim_loss: 264644.0555; val_kl_reg_loss: 5406.2476; val_edge_recon_loss: 262457.9801; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267864.2250; val_optim_loss: 267864.2250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9520; val_best_f1_score: 0.9524; train_kl_reg_loss: 5481.9355; train_edge_recon_loss: 259088.9171; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264570.8528; train_optim_loss: 264570.8528; val_kl_reg_loss: 5367.7258; val_edge_recon_loss: 262499.8656; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267867.5898; val_optim_loss: 267867.5898
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9885; val_auprc_score: 0.9868; val_best_acc_score: 0.9515; val_best_f1_score: 0.9519; train_kl_reg_loss: 5484.1619; train_edge_recon_loss: 258976.8401; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264461.0019; train_optim_loss: 264461.0019; val_kl_reg_loss: 5343.1781; val_edge_recon_loss: 262588.9261; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267932.1063; val_optim_loss: 267932.1063
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9886; val_auprc_score: 0.9868; val_best_acc_score: 0.9518; val_best_f1_score: 0.9522; train_kl_reg_loss: 5479.3518; train_edge_recon_loss: 258967.3125; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264446.6646; train_optim_loss: 264446.6646; val_kl_reg_loss: 5369.6587; val_edge_recon_loss: 262526.7307; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267896.3909; val_optim_loss: 267896.3909
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9871; val_best_acc_score: 0.9522; val_best_f1_score: 0.9524; train_kl_reg_loss: 5480.5973; train_edge_recon_loss: 258991.0099; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264471.6072; train_optim_loss: 264471.6072; val_kl_reg_loss: 5390.1856; val_edge_recon_loss: 262484.4994; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267874.6858; val_optim_loss: 267874.6858

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9890; val_auprc_score: 0.9873; val_best_acc_score: 0.9525; val_best_f1_score: 0.9526; train_kl_reg_loss: 5474.6930; train_edge_recon_loss: 259059.6274; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264534.3208; train_optim_loss: 264534.3208; val_kl_reg_loss: 5370.1853; val_edge_recon_loss: 262612.5457; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267982.7301; val_optim_loss: 267982.7301
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9890; val_auprc_score: 0.9876; val_best_acc_score: 0.9524; val_best_f1_score: 0.9528; train_kl_reg_loss: 5475.9502; train_edge_recon_loss: 259012.7690; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264488.7191; train_optim_loss: 264488.7191; val_kl_reg_loss: 5369.7076; val_edge_recon_loss: 262499.9207; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267869.6295; val_optim_loss: 267869.6295
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9887; val_auprc_score: 0.9867; val_best_acc_score: 0.9522; val_best_f1_score: 0.9526; train_kl_reg_loss: 5472.8203; train_edge_recon_loss: 258965.9277; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264438.7478; train_optim_loss: 264438.7478; val_kl_reg_loss: 5367.0508; val_edge_recon_loss: 262578.7395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267945.7903; val_optim_loss: 267945.7903
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9892; val_auprc_score: 0.9875; val_best_acc_score: 0.9537; val_best_f1_score: 0.9540; train_kl_reg_loss: 5473.5821; train_edge_recon_loss: 259043.1547; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264516.7369; train_optim_loss: 264516.7369; val_kl_reg_loss: 5367.6059; val_edge_recon_loss: 261960.7179; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267328.3250; val_optim_loss: 267328.3250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9892; val_auprc_score: 0.9877; val_best_acc_score: 0.9530; val_best_f1_score: 0.9534; train_kl_reg_loss: 5471.9475; train_edge_recon_loss: 259046.6754; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264518.6233; train_optim_loss: 264518.6233; val_kl_reg_loss: 5358.0309; val_edge_recon_loss: 262160.9420; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267518.9733; val_optim_loss: 267518.9733
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9887; val_auprc_score: 0.9869; val_best_acc_score: 0.9517; val_best_f1_score: 0.9521; train_kl_reg_loss: 5473.7899; train_edge_recon_loss: 258972.0830; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264445.8733; train_optim_loss: 264445.8733; val_kl_reg_loss: 5357.8842; val_edge_recon_loss: 262602.2673; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267960.1500; val_optim_loss: 267960.1500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9877; val_best_acc_score: 0.9527; val_best_f1_score: 0.9530; train_kl_reg_loss: 5471.0710; train_edge_recon_loss: 259056.7054; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264527.7763; train_optim_loss: 264527.7763; val_kl_reg_loss: 5371.8769; val_edge_recon_loss: 262097.2207; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267469.0977; val_optim_loss: 267469.0977
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9893; val_auprc_score: 0.9877; val_best_acc_score: 0.9533; val_best_f1_score: 0.9537; train_kl_reg_loss: 5472.4537; train_edge_recon_loss: 258941.0054; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264413.4586; train_optim_loss: 264413.4586; val_kl_reg_loss: 5376.0175; val_edge_recon_loss: 262076.1565; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267452.1756; val_optim_loss: 267452.1756

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9892; val_auprc_score: 0.9874; val_best_acc_score: 0.9532; val_best_f1_score: 0.9535; train_kl_reg_loss: 5475.6289; train_edge_recon_loss: 259025.7153; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264501.3446; train_optim_loss: 264501.3446; val_kl_reg_loss: 5372.2068; val_edge_recon_loss: 262254.6574; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267626.8642; val_optim_loss: 267626.8642
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9892; val_auprc_score: 0.9874; val_best_acc_score: 0.9533; val_best_f1_score: 0.9535; train_kl_reg_loss: 5473.6141; train_edge_recon_loss: 258992.9935; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264466.6071; train_optim_loss: 264466.6071; val_kl_reg_loss: 5372.3755; val_edge_recon_loss: 262388.3727; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267760.7494; val_optim_loss: 267760.7494
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9888; val_auprc_score: 0.9867; val_best_acc_score: 0.9532; val_best_f1_score: 0.9535; train_kl_reg_loss: 5473.5282; train_edge_recon_loss: 258986.5700; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264460.0981; train_optim_loss: 264460.0981; val_kl_reg_loss: 5371.0315; val_edge_recon_loss: 262509.7318; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267880.7642; val_optim_loss: 267880.7642
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9889; val_auprc_score: 0.9869; val_best_acc_score: 0.9523; val_best_f1_score: 0.9526; train_kl_reg_loss: 5476.2162; train_edge_recon_loss: 258931.9641; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264408.1802; train_optim_loss: 264408.1802; val_kl_reg_loss: 5376.1934; val_edge_recon_loss: 262661.8003; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268037.9955; val_optim_loss: 268037.9955

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 63 min 18 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9888
Val AUPRC score: 0.9869
Val best accuracy score: 0.9531
Val best F1 score: 0.9533
Val gene expr MSE score: 14.8330

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
