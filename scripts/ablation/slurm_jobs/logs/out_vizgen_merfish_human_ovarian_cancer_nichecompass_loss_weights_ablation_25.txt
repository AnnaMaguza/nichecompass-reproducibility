None
Run timestamp: 03072023_074325_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9681; val_auprc_score: 0.9650; val_best_acc_score: 0.9104; val_best_f1_score: 0.9122; train_kl_reg_loss: 5536.5659; train_edge_recon_loss: 268544.0561; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274080.6226; train_optim_loss: 274080.6226; val_kl_reg_loss: 5470.5290; val_edge_recon_loss: 265490.0071; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270960.5352; val_optim_loss: 270960.5352
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9748; val_auprc_score: 0.9723; val_best_acc_score: 0.9214; val_best_f1_score: 0.9223; train_kl_reg_loss: 5558.5993; train_edge_recon_loss: 261709.2071; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267267.8055; train_optim_loss: 267267.8055; val_kl_reg_loss: 5286.5535; val_edge_recon_loss: 265180.7787; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270467.3330; val_optim_loss: 270467.3330
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9782; val_auprc_score: 0.9755; val_best_acc_score: 0.9281; val_best_f1_score: 0.9285; train_kl_reg_loss: 5526.4379; train_edge_recon_loss: 261169.1307; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266695.5680; train_optim_loss: 266695.5680; val_kl_reg_loss: 5475.0388; val_edge_recon_loss: 264354.5332; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269829.5705; val_optim_loss: 269829.5705
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9791; val_auprc_score: 0.9775; val_best_acc_score: 0.9306; val_best_f1_score: 0.9310; train_kl_reg_loss: 5502.0070; train_edge_recon_loss: 260702.0167; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266204.0234; train_optim_loss: 266204.0234; val_kl_reg_loss: 5411.3173; val_edge_recon_loss: 264567.1955; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269978.5136; val_optim_loss: 269978.5136
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9808; val_auprc_score: 0.9786; val_best_acc_score: 0.9328; val_best_f1_score: 0.9335; train_kl_reg_loss: 5483.5452; train_edge_recon_loss: 260626.8516; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266110.3966; train_optim_loss: 266110.3966; val_kl_reg_loss: 5271.1993; val_edge_recon_loss: 263959.4787; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269230.6795; val_optim_loss: 269230.6795
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9833; val_auprc_score: 0.9812; val_best_acc_score: 0.9384; val_best_f1_score: 0.9389; train_kl_reg_loss: 5468.9389; train_edge_recon_loss: 260454.4511; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265923.3898; train_optim_loss: 265923.3898; val_kl_reg_loss: 5231.1442; val_edge_recon_loss: 263549.0321; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268780.1756; val_optim_loss: 268780.1756
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9825; val_auprc_score: 0.9805; val_best_acc_score: 0.9366; val_best_f1_score: 0.9373; train_kl_reg_loss: 5471.9952; train_edge_recon_loss: 260123.0626; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265595.0575; train_optim_loss: 265595.0575; val_kl_reg_loss: 5389.6247; val_edge_recon_loss: 263590.8011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268980.4250; val_optim_loss: 268980.4250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9842; val_auprc_score: 0.9823; val_best_acc_score: 0.9411; val_best_f1_score: 0.9416; train_kl_reg_loss: 5469.6362; train_edge_recon_loss: 260028.2432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265497.8789; train_optim_loss: 265497.8789; val_kl_reg_loss: 5525.4963; val_edge_recon_loss: 263222.3764; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268747.8722; val_optim_loss: 268747.8722
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9848; val_auprc_score: 0.9830; val_best_acc_score: 0.9421; val_best_f1_score: 0.9426; train_kl_reg_loss: 5463.1021; train_edge_recon_loss: 259947.3473; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265410.4495; train_optim_loss: 265410.4495; val_kl_reg_loss: 5265.2671; val_edge_recon_loss: 263036.4489; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268301.7165; val_optim_loss: 268301.7165
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9836; val_auprc_score: 0.9813; val_best_acc_score: 0.9398; val_best_f1_score: 0.9405; train_kl_reg_loss: 5469.7740; train_edge_recon_loss: 259798.9453; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265268.7200; train_optim_loss: 265268.7200; val_kl_reg_loss: 5327.5020; val_edge_recon_loss: 263678.0213; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269005.5233; val_optim_loss: 269005.5233
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9854; val_auprc_score: 0.9836; val_best_acc_score: 0.9439; val_best_f1_score: 0.9444; train_kl_reg_loss: 5463.5510; train_edge_recon_loss: 259606.0662; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265069.6167; train_optim_loss: 265069.6167; val_kl_reg_loss: 5230.7008; val_edge_recon_loss: 263127.8605; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268358.5597; val_optim_loss: 268358.5597
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9859; val_auprc_score: 0.9840; val_best_acc_score: 0.9444; val_best_f1_score: 0.9449; train_kl_reg_loss: 5464.3558; train_edge_recon_loss: 259605.4792; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265069.8347; train_optim_loss: 265069.8347; val_kl_reg_loss: 5303.5019; val_edge_recon_loss: 262868.2844; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268171.7858; val_optim_loss: 268171.7858
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9862; val_auprc_score: 0.9844; val_best_acc_score: 0.9459; val_best_f1_score: 0.9463; train_kl_reg_loss: 5465.0480; train_edge_recon_loss: 259671.0450; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265136.0929; train_optim_loss: 265136.0929; val_kl_reg_loss: 5433.3281; val_edge_recon_loss: 262834.6972; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268268.0256; val_optim_loss: 268268.0256
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9859; val_best_acc_score: 0.9482; val_best_f1_score: 0.9488; train_kl_reg_loss: 5471.4575; train_edge_recon_loss: 259428.6986; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264900.1569; train_optim_loss: 264900.1569; val_kl_reg_loss: 5336.9379; val_edge_recon_loss: 262799.6793; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268136.6153; val_optim_loss: 268136.6153
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9874; val_auprc_score: 0.9856; val_best_acc_score: 0.9495; val_best_f1_score: 0.9498; train_kl_reg_loss: 5465.5623; train_edge_recon_loss: 259496.7686; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264962.3304; train_optim_loss: 264962.3304; val_kl_reg_loss: 5620.0081; val_edge_recon_loss: 262703.7057; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268323.7136; val_optim_loss: 268323.7136
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9874; val_auprc_score: 0.9859; val_best_acc_score: 0.9481; val_best_f1_score: 0.9486; train_kl_reg_loss: 5469.0910; train_edge_recon_loss: 259344.6405; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264813.7323; train_optim_loss: 264813.7323; val_kl_reg_loss: 5366.8498; val_edge_recon_loss: 262399.5017; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267766.3523; val_optim_loss: 267766.3523
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9880; val_auprc_score: 0.9867; val_best_acc_score: 0.9502; val_best_f1_score: 0.9505; train_kl_reg_loss: 5474.4101; train_edge_recon_loss: 259286.3522; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264760.7622; train_optim_loss: 264760.7622; val_kl_reg_loss: 5320.5475; val_edge_recon_loss: 262719.2670; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268039.8153; val_optim_loss: 268039.8153
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9884; val_auprc_score: 0.9866; val_best_acc_score: 0.9523; val_best_f1_score: 0.9526; train_kl_reg_loss: 5466.7337; train_edge_recon_loss: 259280.5171; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264747.2514; train_optim_loss: 264747.2514; val_kl_reg_loss: 5365.3981; val_edge_recon_loss: 262517.4128; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267882.8108; val_optim_loss: 267882.8108
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9873; val_best_acc_score: 0.9522; val_best_f1_score: 0.9524; train_kl_reg_loss: 5465.3969; train_edge_recon_loss: 259214.6542; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264680.0507; train_optim_loss: 264680.0507; val_kl_reg_loss: 5264.8217; val_edge_recon_loss: 262452.9670; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267717.7898; val_optim_loss: 267717.7898
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9880; val_auprc_score: 0.9859; val_best_acc_score: 0.9514; val_best_f1_score: 0.9517; train_kl_reg_loss: 5466.2891; train_edge_recon_loss: 259169.9374; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264636.2261; train_optim_loss: 264636.2261; val_kl_reg_loss: 5351.0565; val_edge_recon_loss: 262926.4722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268277.5284; val_optim_loss: 268277.5284
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9873; val_best_acc_score: 0.9524; val_best_f1_score: 0.9528; train_kl_reg_loss: 5469.5889; train_edge_recon_loss: 259120.5323; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264590.1210; train_optim_loss: 264590.1210; val_kl_reg_loss: 5373.3215; val_edge_recon_loss: 262675.2926; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268048.6125; val_optim_loss: 268048.6125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9876; val_best_acc_score: 0.9524; val_best_f1_score: 0.9526; train_kl_reg_loss: 5475.6566; train_edge_recon_loss: 259021.9634; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264497.6199; train_optim_loss: 264497.6199; val_kl_reg_loss: 5396.8417; val_edge_recon_loss: 262315.2804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267712.1233; val_optim_loss: 267712.1233
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9890; val_auprc_score: 0.9876; val_best_acc_score: 0.9524; val_best_f1_score: 0.9526; train_kl_reg_loss: 5464.7664; train_edge_recon_loss: 259072.1281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264536.8943; train_optim_loss: 264536.8943; val_kl_reg_loss: 5322.3133; val_edge_recon_loss: 262619.2759; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267941.5886; val_optim_loss: 267941.5886
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9882; val_best_acc_score: 0.9534; val_best_f1_score: 0.9540; train_kl_reg_loss: 5466.6550; train_edge_recon_loss: 259097.9288; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264564.5832; train_optim_loss: 264564.5832; val_kl_reg_loss: 5253.9876; val_edge_recon_loss: 262680.3281; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267934.3159; val_optim_loss: 267934.3159
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9883; val_best_acc_score: 0.9542; val_best_f1_score: 0.9543; train_kl_reg_loss: 5469.7767; train_edge_recon_loss: 259086.8603; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264556.6369; train_optim_loss: 264556.6369; val_kl_reg_loss: 5481.2635; val_edge_recon_loss: 262413.8392; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267895.1028; val_optim_loss: 267895.1028
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9887; val_auprc_score: 0.9868; val_best_acc_score: 0.9526; val_best_f1_score: 0.9529; train_kl_reg_loss: 5469.2408; train_edge_recon_loss: 258874.7325; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264343.9737; train_optim_loss: 264343.9737; val_kl_reg_loss: 5366.3750; val_edge_recon_loss: 262518.5116; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267884.8881; val_optim_loss: 267884.8881

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9888; val_best_acc_score: 0.9558; val_best_f1_score: 0.9561; train_kl_reg_loss: 5452.0732; train_edge_recon_loss: 258756.2557; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264208.3290; train_optim_loss: 264208.3290; val_kl_reg_loss: 5359.9111; val_edge_recon_loss: 262236.7577; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267596.6682; val_optim_loss: 267596.6682
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9906; val_auprc_score: 0.9893; val_best_acc_score: 0.9566; val_best_f1_score: 0.9569; train_kl_reg_loss: 5450.8162; train_edge_recon_loss: 258643.4602; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264094.2762; train_optim_loss: 264094.2762; val_kl_reg_loss: 5399.0078; val_edge_recon_loss: 262157.1906; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267556.1966; val_optim_loss: 267556.1966
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9906; val_auprc_score: 0.9892; val_best_acc_score: 0.9566; val_best_f1_score: 0.9568; train_kl_reg_loss: 5448.2863; train_edge_recon_loss: 258591.2054; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264039.4911; train_optim_loss: 264039.4911; val_kl_reg_loss: 5364.6654; val_edge_recon_loss: 261937.3713; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267302.0352; val_optim_loss: 267302.0352
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9562; val_best_f1_score: 0.9563; train_kl_reg_loss: 5445.2260; train_edge_recon_loss: 258635.9437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264081.1697; train_optim_loss: 264081.1697; val_kl_reg_loss: 5363.1954; val_edge_recon_loss: 262107.6881; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267470.8830; val_optim_loss: 267470.8830
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9908; val_auprc_score: 0.9896; val_best_acc_score: 0.9572; val_best_f1_score: 0.9575; train_kl_reg_loss: 5444.3944; train_edge_recon_loss: 258565.8497; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264010.2444; train_optim_loss: 264010.2444; val_kl_reg_loss: 5402.3322; val_edge_recon_loss: 261754.2702; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267156.6040; val_optim_loss: 267156.6040
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9907; val_auprc_score: 0.9889; val_best_acc_score: 0.9575; val_best_f1_score: 0.9579; train_kl_reg_loss: 5439.2380; train_edge_recon_loss: 258596.4971; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264035.7351; train_optim_loss: 264035.7351; val_kl_reg_loss: 5327.5966; val_edge_recon_loss: 262095.5080; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267423.1074; val_optim_loss: 267423.1074
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9569; val_best_f1_score: 0.9572; train_kl_reg_loss: 5435.7502; train_edge_recon_loss: 258647.5250; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264083.2750; train_optim_loss: 264083.2750; val_kl_reg_loss: 5356.1649; val_edge_recon_loss: 261862.6128; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267218.7778; val_optim_loss: 267218.7778
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9905; val_auprc_score: 0.9891; val_best_acc_score: 0.9574; val_best_f1_score: 0.9576; train_kl_reg_loss: 5436.0544; train_edge_recon_loss: 258674.4291; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264110.4832; train_optim_loss: 264110.4832; val_kl_reg_loss: 5314.8753; val_edge_recon_loss: 262173.2099; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267488.0864; val_optim_loss: 267488.0864
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9910; val_auprc_score: 0.9898; val_best_acc_score: 0.9580; val_best_f1_score: 0.9583; train_kl_reg_loss: 5434.3893; train_edge_recon_loss: 258577.5759; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264011.9649; train_optim_loss: 264011.9649; val_kl_reg_loss: 5279.4293; val_edge_recon_loss: 261800.2290; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267079.6574; val_optim_loss: 267079.6574
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9580; val_best_f1_score: 0.9582; train_kl_reg_loss: 5435.1633; train_edge_recon_loss: 258496.1233; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263931.2863; train_optim_loss: 263931.2863; val_kl_reg_loss: 5343.1745; val_edge_recon_loss: 261813.4435; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267156.6205; val_optim_loss: 267156.6205
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9909; val_auprc_score: 0.9896; val_best_acc_score: 0.9579; val_best_f1_score: 0.9583; train_kl_reg_loss: 5431.9000; train_edge_recon_loss: 258622.7384; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264054.6382; train_optim_loss: 264054.6382; val_kl_reg_loss: 5357.0751; val_edge_recon_loss: 262016.3713; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267373.4477; val_optim_loss: 267373.4477
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9569; val_best_f1_score: 0.9572; train_kl_reg_loss: 5437.4524; train_edge_recon_loss: 258595.8351; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264033.2878; train_optim_loss: 264033.2878; val_kl_reg_loss: 5328.8773; val_edge_recon_loss: 262036.9722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267365.8477; val_optim_loss: 267365.8477
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9909; val_auprc_score: 0.9896; val_best_acc_score: 0.9580; val_best_f1_score: 0.9583; train_kl_reg_loss: 5432.3960; train_edge_recon_loss: 258563.5208; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263995.9169; train_optim_loss: 263995.9169; val_kl_reg_loss: 5348.6817; val_edge_recon_loss: 261547.8148; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266896.4972; val_optim_loss: 266896.4972
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9913; val_auprc_score: 0.9898; val_best_acc_score: 0.9584; val_best_f1_score: 0.9587; train_kl_reg_loss: 5434.6634; train_edge_recon_loss: 258562.5683; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263997.2317; train_optim_loss: 263997.2317; val_kl_reg_loss: 5371.4739; val_edge_recon_loss: 261871.1551; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267242.6307; val_optim_loss: 267242.6307
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9909; val_auprc_score: 0.9895; val_best_acc_score: 0.9588; val_best_f1_score: 0.9590; train_kl_reg_loss: 5434.3930; train_edge_recon_loss: 258502.6717; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263937.0643; train_optim_loss: 263937.0643; val_kl_reg_loss: 5386.6092; val_edge_recon_loss: 261862.9795; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267249.5886; val_optim_loss: 267249.5886
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9576; val_best_f1_score: 0.9580; train_kl_reg_loss: 5433.1634; train_edge_recon_loss: 258554.0885; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263987.2520; train_optim_loss: 263987.2520; val_kl_reg_loss: 5353.9371; val_edge_recon_loss: 261946.4682; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267300.4045; val_optim_loss: 267300.4045
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9910; val_auprc_score: 0.9893; val_best_acc_score: 0.9586; val_best_f1_score: 0.9589; train_kl_reg_loss: 5432.4364; train_edge_recon_loss: 258494.7482; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263927.1840; train_optim_loss: 263927.1840; val_kl_reg_loss: 5338.9601; val_edge_recon_loss: 261762.5560; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267101.5165; val_optim_loss: 267101.5165

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9591; val_best_f1_score: 0.9593; train_kl_reg_loss: 5427.2257; train_edge_recon_loss: 258529.2026; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263956.4273; train_optim_loss: 263956.4273; val_kl_reg_loss: 5354.4681; val_edge_recon_loss: 261822.2807; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267176.7494; val_optim_loss: 267176.7494
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9911; val_auprc_score: 0.9899; val_best_acc_score: 0.9581; val_best_f1_score: 0.9585; train_kl_reg_loss: 5430.5066; train_edge_recon_loss: 258449.8539; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263880.3606; train_optim_loss: 263880.3606; val_kl_reg_loss: 5351.7025; val_edge_recon_loss: 261872.5278; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267224.2324; val_optim_loss: 267224.2324
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9913; val_auprc_score: 0.9898; val_best_acc_score: 0.9585; val_best_f1_score: 0.9587; train_kl_reg_loss: 5429.0618; train_edge_recon_loss: 258446.8599; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263875.9215; train_optim_loss: 263875.9215; val_kl_reg_loss: 5354.9761; val_edge_recon_loss: 261882.3412; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267237.3165; val_optim_loss: 267237.3165
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9913; val_auprc_score: 0.9898; val_best_acc_score: 0.9594; val_best_f1_score: 0.9598; train_kl_reg_loss: 5427.3528; train_edge_recon_loss: 258507.4710; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263934.8240; train_optim_loss: 263934.8240; val_kl_reg_loss: 5341.8923; val_edge_recon_loss: 261675.5679; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267017.4602; val_optim_loss: 267017.4602

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 98 min 28 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9907
Val AUPRC score: 0.9891
Val best accuracy score: 0.9574
Val best F1 score: 0.9578
Val gene expr MSE score: 14.6235

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
