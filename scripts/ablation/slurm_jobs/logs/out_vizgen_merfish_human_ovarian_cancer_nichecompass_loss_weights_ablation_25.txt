None
Run timestamp: 04072023_115207_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9728; val_auprc_score: 0.9696; val_best_acc_score: 0.9190; val_best_f1_score: 0.9198; train_kl_reg_loss: 6397.2265; train_edge_recon_loss: 267112.4882; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273509.7145; train_optim_loss: 273509.7145; val_kl_reg_loss: 6219.8949; val_edge_recon_loss: 264873.2997; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271093.1946; val_optim_loss: 271093.1946
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9788; val_auprc_score: 0.9761; val_best_acc_score: 0.9299; val_best_f1_score: 0.9304; train_kl_reg_loss: 6441.7815; train_edge_recon_loss: 261797.9373; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268239.7188; train_optim_loss: 268239.7188; val_kl_reg_loss: 6318.7680; val_edge_recon_loss: 264127.9803; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270446.7483; val_optim_loss: 270446.7483
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9816; val_auprc_score: 0.9795; val_best_acc_score: 0.9347; val_best_f1_score: 0.9350; train_kl_reg_loss: 6400.5624; train_edge_recon_loss: 261098.2227; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267498.7844; train_optim_loss: 267498.7844; val_kl_reg_loss: 6279.9525; val_edge_recon_loss: 263618.4372; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269898.3918; val_optim_loss: 269898.3918
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9818; val_auprc_score: 0.9797; val_best_acc_score: 0.9362; val_best_f1_score: 0.9368; train_kl_reg_loss: 6389.4877; train_edge_recon_loss: 260728.2247; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267117.7119; train_optim_loss: 267117.7119; val_kl_reg_loss: 6278.0355; val_edge_recon_loss: 264069.4297; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270347.4642; val_optim_loss: 270347.4642
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9829; val_auprc_score: 0.9807; val_best_acc_score: 0.9392; val_best_f1_score: 0.9394; train_kl_reg_loss: 6385.1251; train_edge_recon_loss: 260521.3840; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266906.5092; train_optim_loss: 266906.5092; val_kl_reg_loss: 6261.1828; val_edge_recon_loss: 263505.3672; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269766.5497; val_optim_loss: 269766.5497
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9845; val_auprc_score: 0.9823; val_best_acc_score: 0.9419; val_best_f1_score: 0.9422; train_kl_reg_loss: 6387.4050; train_edge_recon_loss: 260411.7357; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266799.1402; train_optim_loss: 266799.1402; val_kl_reg_loss: 6218.3866; val_edge_recon_loss: 263311.2732; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269529.6582; val_optim_loss: 269529.6582
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9853; val_auprc_score: 0.9829; val_best_acc_score: 0.9437; val_best_f1_score: 0.9441; train_kl_reg_loss: 6389.4309; train_edge_recon_loss: 260234.0406; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266623.4714; train_optim_loss: 266623.4714; val_kl_reg_loss: 6407.8773; val_edge_recon_loss: 263410.7578; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269818.6361; val_optim_loss: 269818.6361
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9856; val_auprc_score: 0.9840; val_best_acc_score: 0.9437; val_best_f1_score: 0.9443; train_kl_reg_loss: 6389.6958; train_edge_recon_loss: 260158.0864; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266547.7820; train_optim_loss: 266547.7820; val_kl_reg_loss: 6427.6239; val_edge_recon_loss: 263507.6419; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269935.2653; val_optim_loss: 269935.2653
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9858; val_auprc_score: 0.9836; val_best_acc_score: 0.9450; val_best_f1_score: 0.9455; train_kl_reg_loss: 6394.5335; train_edge_recon_loss: 259975.0286; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266369.5623; train_optim_loss: 266369.5623; val_kl_reg_loss: 6351.4793; val_edge_recon_loss: 262954.4503; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269305.9290; val_optim_loss: 269305.9290
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9867; val_auprc_score: 0.9847; val_best_acc_score: 0.9472; val_best_f1_score: 0.9477; train_kl_reg_loss: 6394.9107; train_edge_recon_loss: 259869.1389; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266264.0498; train_optim_loss: 266264.0498; val_kl_reg_loss: 5995.2324; val_edge_recon_loss: 263032.2578; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269027.4909; val_optim_loss: 269027.4909
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9875; val_auprc_score: 0.9856; val_best_acc_score: 0.9492; val_best_f1_score: 0.9496; train_kl_reg_loss: 6391.2214; train_edge_recon_loss: 259803.3963; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266194.6176; train_optim_loss: 266194.6176; val_kl_reg_loss: 6302.5608; val_edge_recon_loss: 262670.0831; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268972.6429; val_optim_loss: 268972.6429
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9872; val_auprc_score: 0.9852; val_best_acc_score: 0.9480; val_best_f1_score: 0.9485; train_kl_reg_loss: 6384.4524; train_edge_recon_loss: 259840.2440; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266224.6963; train_optim_loss: 266224.6963; val_kl_reg_loss: 6255.6253; val_edge_recon_loss: 262732.9260; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268988.5520; val_optim_loss: 268988.5520
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9870; val_best_acc_score: 0.9500; val_best_f1_score: 0.9503; train_kl_reg_loss: 6385.0981; train_edge_recon_loss: 259730.1260; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266115.2242; train_optim_loss: 266115.2242; val_kl_reg_loss: 5950.7348; val_edge_recon_loss: 262769.6426; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268720.3778; val_optim_loss: 268720.3778
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9886; val_auprc_score: 0.9871; val_best_acc_score: 0.9518; val_best_f1_score: 0.9519; train_kl_reg_loss: 6381.2682; train_edge_recon_loss: 259689.0801; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266070.3477; train_optim_loss: 266070.3477; val_kl_reg_loss: 6297.6319; val_edge_recon_loss: 262231.0624; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268528.6935; val_optim_loss: 268528.6935
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9881; val_auprc_score: 0.9866; val_best_acc_score: 0.9505; val_best_f1_score: 0.9507; train_kl_reg_loss: 6388.0411; train_edge_recon_loss: 259553.0063; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265941.0474; train_optim_loss: 265941.0474; val_kl_reg_loss: 6317.1661; val_edge_recon_loss: 262970.1966; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269287.3625; val_optim_loss: 269287.3625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9888; val_auprc_score: 0.9870; val_best_acc_score: 0.9517; val_best_f1_score: 0.9520; train_kl_reg_loss: 6380.1578; train_edge_recon_loss: 259667.5215; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266047.6799; train_optim_loss: 266047.6799; val_kl_reg_loss: 6328.9899; val_edge_recon_loss: 262877.1261; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269206.1159; val_optim_loss: 269206.1159
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9526; val_best_f1_score: 0.9531; train_kl_reg_loss: 6380.8088; train_edge_recon_loss: 259543.4373; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265924.2464; train_optim_loss: 265924.2464; val_kl_reg_loss: 6355.3722; val_edge_recon_loss: 262370.9036; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268726.2753; val_optim_loss: 268726.2753
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9889; val_auprc_score: 0.9868; val_best_acc_score: 0.9533; val_best_f1_score: 0.9536; train_kl_reg_loss: 6381.1619; train_edge_recon_loss: 259456.0595; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265837.2213; train_optim_loss: 265837.2213; val_kl_reg_loss: 6482.2505; val_edge_recon_loss: 262425.4537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268907.7034; val_optim_loss: 268907.7034

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9899; val_auprc_score: 0.9883; val_best_acc_score: 0.9553; val_best_f1_score: 0.9556; train_kl_reg_loss: 6361.8770; train_edge_recon_loss: 259194.6041; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265556.4811; train_optim_loss: 265556.4811; val_kl_reg_loss: 6215.4648; val_edge_recon_loss: 262032.8702; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268248.3327; val_optim_loss: 268248.3327
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9899; val_auprc_score: 0.9883; val_best_acc_score: 0.9559; val_best_f1_score: 0.9564; train_kl_reg_loss: 6357.2438; train_edge_recon_loss: 259123.7787; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265481.0223; train_optim_loss: 265481.0223; val_kl_reg_loss: 6250.2625; val_edge_recon_loss: 262245.7192; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268495.9815; val_optim_loss: 268495.9815
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9901; val_auprc_score: 0.9887; val_best_acc_score: 0.9555; val_best_f1_score: 0.9557; train_kl_reg_loss: 6353.8038; train_edge_recon_loss: 259125.9241; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265479.7274; train_optim_loss: 265479.7274; val_kl_reg_loss: 6248.8060; val_edge_recon_loss: 262320.5732; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268569.3795; val_optim_loss: 268569.3795
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9905; val_auprc_score: 0.9888; val_best_acc_score: 0.9567; val_best_f1_score: 0.9570; train_kl_reg_loss: 6344.7921; train_edge_recon_loss: 259092.6956; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265437.4874; train_optim_loss: 265437.4874; val_kl_reg_loss: 6257.6384; val_edge_recon_loss: 262338.4712; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268596.1111; val_optim_loss: 268596.1111
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9906; val_auprc_score: 0.9891; val_best_acc_score: 0.9568; val_best_f1_score: 0.9571; train_kl_reg_loss: 6344.9549; train_edge_recon_loss: 259071.4546; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265416.4094; train_optim_loss: 265416.4094; val_kl_reg_loss: 6264.6277; val_edge_recon_loss: 262112.8838; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268377.5108; val_optim_loss: 268377.5108

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9906; val_auprc_score: 0.9892; val_best_acc_score: 0.9575; val_best_f1_score: 0.9577; train_kl_reg_loss: 6343.7513; train_edge_recon_loss: 259042.4079; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265386.1595; train_optim_loss: 265386.1595; val_kl_reg_loss: 6234.0145; val_edge_recon_loss: 261949.8820; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268183.8980; val_optim_loss: 268183.8980
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9567; val_best_f1_score: 0.9569; train_kl_reg_loss: 6337.1491; train_edge_recon_loss: 259070.1815; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265407.3300; train_optim_loss: 265407.3300; val_kl_reg_loss: 6232.8313; val_edge_recon_loss: 262033.7990; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268266.6307; val_optim_loss: 268266.6307
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 6339.5130; train_edge_recon_loss: 259012.4519; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265351.9650; train_optim_loss: 265351.9650; val_kl_reg_loss: 6234.9445; val_edge_recon_loss: 262092.0489; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268326.9946; val_optim_loss: 268326.9946
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9908; val_auprc_score: 0.9894; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 6339.4410; train_edge_recon_loss: 258979.1473; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265318.5882; train_optim_loss: 265318.5882; val_kl_reg_loss: 6237.8312; val_edge_recon_loss: 261957.0304; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268194.8608; val_optim_loss: 268194.8608
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9567; val_best_f1_score: 0.9569; train_kl_reg_loss: 6336.0355; train_edge_recon_loss: 259040.0552; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265376.0907; train_optim_loss: 265376.0907; val_kl_reg_loss: 6253.2667; val_edge_recon_loss: 262025.4902; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268278.7574; val_optim_loss: 268278.7574

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9564; val_best_f1_score: 0.9567; train_kl_reg_loss: 6338.0335; train_edge_recon_loss: 259028.6819; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265366.7152; train_optim_loss: 265366.7152; val_kl_reg_loss: 6242.0510; val_edge_recon_loss: 262074.0331; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268316.0832; val_optim_loss: 268316.0832
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9884; val_best_acc_score: 0.9573; val_best_f1_score: 0.9577; train_kl_reg_loss: 6337.3551; train_edge_recon_loss: 259005.8662; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265343.2209; train_optim_loss: 265343.2209; val_kl_reg_loss: 6246.8099; val_edge_recon_loss: 261995.8145; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268242.6250; val_optim_loss: 268242.6250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9907; val_auprc_score: 0.9894; val_best_acc_score: 0.9567; val_best_f1_score: 0.9571; train_kl_reg_loss: 6338.8005; train_edge_recon_loss: 258917.3342; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265256.1344; train_optim_loss: 265256.1344; val_kl_reg_loss: 6247.1169; val_edge_recon_loss: 262121.5808; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268368.6963; val_optim_loss: 268368.6963
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9576; val_best_f1_score: 0.9577; train_kl_reg_loss: 6339.2742; train_edge_recon_loss: 258948.6621; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265287.9364; train_optim_loss: 265287.9364; val_kl_reg_loss: 6248.8060; val_edge_recon_loss: 261857.6631; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268106.4685; val_optim_loss: 268106.4685
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9560; val_best_f1_score: 0.9563; train_kl_reg_loss: 6338.5121; train_edge_recon_loss: 259010.9697; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265349.4821; train_optim_loss: 265349.4821; val_kl_reg_loss: 6242.7101; val_edge_recon_loss: 262240.1001; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268482.8114; val_optim_loss: 268482.8114
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9908; val_auprc_score: 0.9894; val_best_acc_score: 0.9574; val_best_f1_score: 0.9577; train_kl_reg_loss: 6337.7119; train_edge_recon_loss: 258975.4948; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265313.2065; train_optim_loss: 265313.2065; val_kl_reg_loss: 6245.7344; val_edge_recon_loss: 261902.7286; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268148.4634; val_optim_loss: 268148.4634
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9901; val_auprc_score: 0.9881; val_best_acc_score: 0.9564; val_best_f1_score: 0.9569; train_kl_reg_loss: 6338.7821; train_edge_recon_loss: 258951.0221; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265289.8039; train_optim_loss: 265289.8039; val_kl_reg_loss: 6249.6079; val_edge_recon_loss: 262020.4570; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268270.0662; val_optim_loss: 268270.0662
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9572; val_best_f1_score: 0.9574; train_kl_reg_loss: 6339.9912; train_edge_recon_loss: 259003.9494; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265343.9411; train_optim_loss: 265343.9411; val_kl_reg_loss: 6245.3933; val_edge_recon_loss: 261918.9026; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268164.2949; val_optim_loss: 268164.2949

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9904; val_auprc_score: 0.9886; val_best_acc_score: 0.9566; val_best_f1_score: 0.9569; train_kl_reg_loss: 6337.0284; train_edge_recon_loss: 259031.7973; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265368.8264; train_optim_loss: 265368.8264; val_kl_reg_loss: 6243.6930; val_edge_recon_loss: 262121.3057; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268364.9969; val_optim_loss: 268364.9969
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9905; val_auprc_score: 0.9890; val_best_acc_score: 0.9571; val_best_f1_score: 0.9574; train_kl_reg_loss: 6336.6901; train_edge_recon_loss: 258941.2220; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265277.9118; train_optim_loss: 265277.9118; val_kl_reg_loss: 6243.4788; val_edge_recon_loss: 261819.4156; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268062.8946; val_optim_loss: 268062.8946
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9884; val_best_acc_score: 0.9567; val_best_f1_score: 0.9571; train_kl_reg_loss: 6336.3247; train_edge_recon_loss: 259037.2319; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265373.5565; train_optim_loss: 265373.5565; val_kl_reg_loss: 6244.3613; val_edge_recon_loss: 262250.3767; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268494.7381; val_optim_loss: 268494.7381
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9566; val_best_f1_score: 0.9570; train_kl_reg_loss: 6336.5862; train_edge_recon_loss: 258990.9842; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265327.5695; train_optim_loss: 265327.5695; val_kl_reg_loss: 6245.1267; val_edge_recon_loss: 262009.7109; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268254.8378; val_optim_loss: 268254.8378
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9907; val_auprc_score: 0.9891; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 6337.2668; train_edge_recon_loss: 258886.5460; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265223.8132; train_optim_loss: 265223.8132; val_kl_reg_loss: 6245.5006; val_edge_recon_loss: 261888.3183; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268133.8179; val_optim_loss: 268133.8179
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9908; val_auprc_score: 0.9894; val_best_acc_score: 0.9571; val_best_f1_score: 0.9576; train_kl_reg_loss: 6337.8492; train_edge_recon_loss: 258959.6781; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265297.5282; train_optim_loss: 265297.5282; val_kl_reg_loss: 6243.7372; val_edge_recon_loss: 261780.3014; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268024.0369; val_optim_loss: 268024.0369
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9885; val_best_acc_score: 0.9562; val_best_f1_score: 0.9565; train_kl_reg_loss: 6337.2664; train_edge_recon_loss: 258987.6834; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265324.9502; train_optim_loss: 265324.9502; val_kl_reg_loss: 6245.8243; val_edge_recon_loss: 262209.8477; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268455.6722; val_optim_loss: 268455.6722
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9909; val_auprc_score: 0.9898; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 6336.5821; train_edge_recon_loss: 259057.0262; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265393.6081; train_optim_loss: 265393.6081; val_kl_reg_loss: 6244.2085; val_edge_recon_loss: 261853.2135; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268097.4216; val_optim_loss: 268097.4216
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9569; val_best_f1_score: 0.9572; train_kl_reg_loss: 6336.4683; train_edge_recon_loss: 259012.1432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265348.6113; train_optim_loss: 265348.6113; val_kl_reg_loss: 6244.4283; val_edge_recon_loss: 261721.9710; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267966.4001; val_optim_loss: 267966.4001
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9905; val_auprc_score: 0.9891; val_best_acc_score: 0.9567; val_best_f1_score: 0.9570; train_kl_reg_loss: 6337.7043; train_edge_recon_loss: 258968.3966; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265306.1013; train_optim_loss: 265306.1013; val_kl_reg_loss: 6244.7631; val_edge_recon_loss: 262095.8379; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268340.6003; val_optim_loss: 268340.6003
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9906; val_auprc_score: 0.9891; val_best_acc_score: 0.9562; val_best_f1_score: 0.9567; train_kl_reg_loss: 6337.9863; train_edge_recon_loss: 258999.5975; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265337.5837; train_optim_loss: 265337.5837; val_kl_reg_loss: 6244.3811; val_edge_recon_loss: 262261.7636; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268506.1449; val_optim_loss: 268506.1449
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9563; val_best_f1_score: 0.9568; train_kl_reg_loss: 6338.4332; train_edge_recon_loss: 259015.2214; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265353.6542; train_optim_loss: 265353.6542; val_kl_reg_loss: 6246.0388; val_edge_recon_loss: 262080.3115; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268326.3500; val_optim_loss: 268326.3500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9568; val_best_f1_score: 0.9572; train_kl_reg_loss: 6338.7387; train_edge_recon_loss: 259002.7202; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265341.4588; train_optim_loss: 265341.4588; val_kl_reg_loss: 6246.3963; val_edge_recon_loss: 261971.4033; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268217.8006; val_optim_loss: 268217.8006

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9565; val_best_f1_score: 0.9568; train_kl_reg_loss: 6339.1042; train_edge_recon_loss: 258987.0512; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265326.1559; train_optim_loss: 265326.1559; val_kl_reg_loss: 6246.5395; val_edge_recon_loss: 262064.7001; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268311.2395; val_optim_loss: 268311.2395
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9908; val_auprc_score: 0.9895; val_best_acc_score: 0.9566; val_best_f1_score: 0.9569; train_kl_reg_loss: 6338.9798; train_edge_recon_loss: 258983.7243; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265322.7041; train_optim_loss: 265322.7041; val_kl_reg_loss: 6246.6645; val_edge_recon_loss: 262143.9679; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268390.6318; val_optim_loss: 268390.6318
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9568; val_best_f1_score: 0.9571; train_kl_reg_loss: 6338.5592; train_edge_recon_loss: 259041.9437; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265380.5032; train_optim_loss: 265380.5032; val_kl_reg_loss: 6245.8786; val_edge_recon_loss: 262062.1313; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268308.0102; val_optim_loss: 268308.0102
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9903; val_auprc_score: 0.9889; val_best_acc_score: 0.9566; val_best_f1_score: 0.9569; train_kl_reg_loss: 6338.7863; train_edge_recon_loss: 258992.4216; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265331.2080; train_optim_loss: 265331.2080; val_kl_reg_loss: 6245.8027; val_edge_recon_loss: 262099.1320; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268344.9341; val_optim_loss: 268344.9341

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 168 min 41 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9892
Val best accuracy score: 0.9566
Val best F1 score: 0.9569
Val gene expr MSE score: 11.2154

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
