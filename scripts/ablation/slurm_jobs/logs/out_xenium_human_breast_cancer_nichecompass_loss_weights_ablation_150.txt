None
Run timestamp: 15072023_003648_150.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_150']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9439; val_auprc_score: 0.9311; val_best_acc_score: 0.8792; val_best_f1_score: 0.8859; train_kl_reg_loss: 49724.9042; train_edge_recon_loss: 2824576.0386; train_gene_expr_recon_loss: 7224507.6984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10098808.6346; train_optim_loss: 10098808.6346; val_kl_reg_loss: 43881.7192; val_edge_recon_loss: 2724861.3031; val_gene_expr_recon_loss: 6764545.5377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9533288.5479; val_optim_loss: 9533288.5479
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9579; val_auprc_score: 0.9491; val_best_acc_score: 0.8963; val_best_f1_score: 0.9019; train_kl_reg_loss: 40084.6764; train_edge_recon_loss: 2689613.3588; train_gene_expr_recon_loss: 6625422.1139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9355120.1437; train_optim_loss: 9355120.1437; val_kl_reg_loss: 36971.1760; val_edge_recon_loss: 2696737.9401; val_gene_expr_recon_loss: 6519619.9144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9253329.0479; val_optim_loss: 9253329.0479
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9628; val_auprc_score: 0.9558; val_best_acc_score: 0.9031; val_best_f1_score: 0.9078; train_kl_reg_loss: 35324.6139; train_edge_recon_loss: 2670235.5705; train_gene_expr_recon_loss: 6454732.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9160292.2806; train_optim_loss: 9160292.2806; val_kl_reg_loss: 32936.9051; val_edge_recon_loss: 2686900.9795; val_gene_expr_recon_loss: 6425920.6336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9145758.5000; val_optim_loss: 9145758.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9672; val_auprc_score: 0.9609; val_best_acc_score: 0.9103; val_best_f1_score: 0.9140; train_kl_reg_loss: 32689.7769; train_edge_recon_loss: 2661048.2699; train_gene_expr_recon_loss: 6374503.7840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9068241.8287; train_optim_loss: 9068241.8287; val_kl_reg_loss: 31370.4437; val_edge_recon_loss: 2677024.3870; val_gene_expr_recon_loss: 6369041.4589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9077436.3014; val_optim_loss: 9077436.3014
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9694; val_auprc_score: 0.9639; val_best_acc_score: 0.9127; val_best_f1_score: 0.9160; train_kl_reg_loss: 31208.7406; train_edge_recon_loss: 2657066.0975; train_gene_expr_recon_loss: 6329038.4893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017313.3249; train_optim_loss: 9017313.3249; val_kl_reg_loss: 30119.5100; val_edge_recon_loss: 2678904.5668; val_gene_expr_recon_loss: 6334504.0377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9043528.1233; val_optim_loss: 9043528.1233
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9720; val_auprc_score: 0.9669; val_best_acc_score: 0.9171; val_best_f1_score: 0.9200; train_kl_reg_loss: 30009.5985; train_edge_recon_loss: 2651991.2158; train_gene_expr_recon_loss: 6301503.8161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8983504.6407; train_optim_loss: 8983504.6407; val_kl_reg_loss: 28913.9702; val_edge_recon_loss: 2670521.8904; val_gene_expr_recon_loss: 6313375.2192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9012811.1301; val_optim_loss: 9012811.1301
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9733; val_auprc_score: 0.9683; val_best_acc_score: 0.9205; val_best_f1_score: 0.9233; train_kl_reg_loss: 29059.2098; train_edge_recon_loss: 2647964.7678; train_gene_expr_recon_loss: 6280769.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8957793.8823; train_optim_loss: 8957793.8823; val_kl_reg_loss: 28430.8712; val_edge_recon_loss: 2668566.5565; val_gene_expr_recon_loss: 6305864.7466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9002862.1712; val_optim_loss: 9002862.1712
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9750; val_auprc_score: 0.9703; val_best_acc_score: 0.9229; val_best_f1_score: 0.9257; train_kl_reg_loss: 28373.4799; train_edge_recon_loss: 2646064.3773; train_gene_expr_recon_loss: 6266244.3792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8940682.2294; train_optim_loss: 8940682.2294; val_kl_reg_loss: 27797.8832; val_edge_recon_loss: 2664689.9521; val_gene_expr_recon_loss: 6288179.6884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8980667.5342; val_optim_loss: 8980667.5342
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9766; val_auprc_score: 0.9723; val_best_acc_score: 0.9259; val_best_f1_score: 0.9283; train_kl_reg_loss: 27871.4499; train_edge_recon_loss: 2643106.5703; train_gene_expr_recon_loss: 6254914.4278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8925892.4415; train_optim_loss: 8925892.4415; val_kl_reg_loss: 26766.1060; val_edge_recon_loss: 2660802.2825; val_gene_expr_recon_loss: 6279729.2945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8967297.6301; val_optim_loss: 8967297.6301
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9773; val_auprc_score: 0.9734; val_best_acc_score: 0.9273; val_best_f1_score: 0.9297; train_kl_reg_loss: 27455.0569; train_edge_recon_loss: 2638193.9570; train_gene_expr_recon_loss: 6247685.5753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8913334.5822; train_optim_loss: 8913334.5822; val_kl_reg_loss: 26761.9402; val_edge_recon_loss: 2661235.6524; val_gene_expr_recon_loss: 6278642.3253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8966639.9315; val_optim_loss: 8966639.9315
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9780; val_auprc_score: 0.9741; val_best_acc_score: 0.9286; val_best_f1_score: 0.9310; train_kl_reg_loss: 27064.8911; train_edge_recon_loss: 2635608.2127; train_gene_expr_recon_loss: 6236276.4778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8898949.5787; train_optim_loss: 8898949.5787; val_kl_reg_loss: 26613.2469; val_edge_recon_loss: 2656529.1353; val_gene_expr_recon_loss: 6281377.3151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8964519.6986; val_optim_loss: 8964519.6986
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9794; val_auprc_score: 0.9755; val_best_acc_score: 0.9314; val_best_f1_score: 0.9334; train_kl_reg_loss: 26622.1574; train_edge_recon_loss: 2636400.0755; train_gene_expr_recon_loss: 6231396.2343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8894418.4629; train_optim_loss: 8894418.4629; val_kl_reg_loss: 26060.4350; val_edge_recon_loss: 2653316.9538; val_gene_expr_recon_loss: 6271951.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8951328.7877; val_optim_loss: 8951328.7877
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9800; val_auprc_score: 0.9764; val_best_acc_score: 0.9321; val_best_f1_score: 0.9341; train_kl_reg_loss: 26420.4432; train_edge_recon_loss: 2633212.7295; train_gene_expr_recon_loss: 6226649.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8886282.6693; train_optim_loss: 8886282.6693; val_kl_reg_loss: 25789.5285; val_edge_recon_loss: 2654130.3493; val_gene_expr_recon_loss: 6272983.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8952903.1370; val_optim_loss: 8952903.1370
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9807; val_auprc_score: 0.9777; val_best_acc_score: 0.9334; val_best_f1_score: 0.9354; train_kl_reg_loss: 26157.2146; train_edge_recon_loss: 2630745.1007; train_gene_expr_recon_loss: 6221172.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8878074.8509; train_optim_loss: 8878074.8509; val_kl_reg_loss: 25849.2274; val_edge_recon_loss: 2652935.2586; val_gene_expr_recon_loss: 6283445.2260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8962229.7055; val_optim_loss: 8962229.7055
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9814; val_auprc_score: 0.9780; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 25897.8304; train_edge_recon_loss: 2630624.2691; train_gene_expr_recon_loss: 6217840.7756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8874362.8708; train_optim_loss: 8874362.8708; val_kl_reg_loss: 25099.4003; val_edge_recon_loss: 2649328.5668; val_gene_expr_recon_loss: 6267133.6404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8941561.6027; val_optim_loss: 8941561.6027
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9821; val_auprc_score: 0.9794; val_best_acc_score: 0.9354; val_best_f1_score: 0.9370; train_kl_reg_loss: 25769.8948; train_edge_recon_loss: 2628847.7682; train_gene_expr_recon_loss: 6217964.7718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8872582.4411; train_optim_loss: 8872582.4411; val_kl_reg_loss: 25056.0868; val_edge_recon_loss: 2651967.6935; val_gene_expr_recon_loss: 6267387.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8944411.1438; val_optim_loss: 8944411.1438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9825; val_auprc_score: 0.9799; val_best_acc_score: 0.9364; val_best_f1_score: 0.9383; train_kl_reg_loss: 25604.0171; train_edge_recon_loss: 2628589.2555; train_gene_expr_recon_loss: 6211714.3658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8865907.6391; train_optim_loss: 8865907.6391; val_kl_reg_loss: 24824.5364; val_edge_recon_loss: 2653269.2979; val_gene_expr_recon_loss: 6254136.1952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8932230.0548; val_optim_loss: 8932230.0548
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9826; val_auprc_score: 0.9797; val_best_acc_score: 0.9370; val_best_f1_score: 0.9386; train_kl_reg_loss: 25558.6552; train_edge_recon_loss: 2626888.6411; train_gene_expr_recon_loss: 6209559.5914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8862006.8941; train_optim_loss: 8862006.8941; val_kl_reg_loss: 24663.1244; val_edge_recon_loss: 2650765.0086; val_gene_expr_recon_loss: 6272907.9212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8948336.0890; val_optim_loss: 8948336.0890
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9823; val_auprc_score: 0.9792; val_best_acc_score: 0.9378; val_best_f1_score: 0.9393; train_kl_reg_loss: 25376.2170; train_edge_recon_loss: 2625595.1395; train_gene_expr_recon_loss: 6211241.2416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8862212.6055; train_optim_loss: 8862212.6055; val_kl_reg_loss: 24701.9094; val_edge_recon_loss: 2649400.6747; val_gene_expr_recon_loss: 6250002.3630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8924104.9384; val_optim_loss: 8924104.9384
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9830; val_auprc_score: 0.9799; val_best_acc_score: 0.9381; val_best_f1_score: 0.9396; train_kl_reg_loss: 25340.4153; train_edge_recon_loss: 2624156.4448; train_gene_expr_recon_loss: 6207753.5963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8857250.4568; train_optim_loss: 8857250.4568; val_kl_reg_loss: 24712.3338; val_edge_recon_loss: 2645352.2723; val_gene_expr_recon_loss: 6248143.0377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8918207.6164; val_optim_loss: 8918207.6164
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9832; val_auprc_score: 0.9804; val_best_acc_score: 0.9385; val_best_f1_score: 0.9401; train_kl_reg_loss: 25134.2008; train_edge_recon_loss: 2624569.9027; train_gene_expr_recon_loss: 6202881.2099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8852585.3127; train_optim_loss: 8852585.3127; val_kl_reg_loss: 24945.7500; val_edge_recon_loss: 2644571.6541; val_gene_expr_recon_loss: 6257714.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8927232.0103; val_optim_loss: 8927232.0103
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9836; val_auprc_score: 0.9809; val_best_acc_score: 0.9390; val_best_f1_score: 0.9407; train_kl_reg_loss: 25022.8585; train_edge_recon_loss: 2623651.8555; train_gene_expr_recon_loss: 6201613.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8850288.5398; train_optim_loss: 8850288.5398; val_kl_reg_loss: 24384.9271; val_edge_recon_loss: 2644959.1284; val_gene_expr_recon_loss: 6253613.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8922957.8219; val_optim_loss: 8922957.8219
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9842; val_auprc_score: 0.9817; val_best_acc_score: 0.9403; val_best_f1_score: 0.9417; train_kl_reg_loss: 24917.4748; train_edge_recon_loss: 2624821.1260; train_gene_expr_recon_loss: 6199334.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8849073.0459; train_optim_loss: 8849073.0459; val_kl_reg_loss: 23845.5223; val_edge_recon_loss: 2647539.3065; val_gene_expr_recon_loss: 6252686.2123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8924071.0616; val_optim_loss: 8924071.0616
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9838; val_auprc_score: 0.9810; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 24795.6160; train_edge_recon_loss: 2624403.2288; train_gene_expr_recon_loss: 6196855.2661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8846054.1024; train_optim_loss: 8846054.1024; val_kl_reg_loss: 24448.0552; val_edge_recon_loss: 2645832.9640; val_gene_expr_recon_loss: 6251296.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8921577.7877; val_optim_loss: 8921577.7877

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9845; val_auprc_score: 0.9818; val_best_acc_score: 0.9416; val_best_f1_score: 0.9429; train_kl_reg_loss: 25669.4830; train_edge_recon_loss: 2621858.4851; train_gene_expr_recon_loss: 6156062.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8803590.4687; train_optim_loss: 8803590.4687; val_kl_reg_loss: 25241.3984; val_edge_recon_loss: 2641826.8973; val_gene_expr_recon_loss: 6210932.8493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8878001.1884; val_optim_loss: 8878001.1884
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9844; val_auprc_score: 0.9819; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 25919.7718; train_edge_recon_loss: 2619514.9501; train_gene_expr_recon_loss: 6156802.7164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8802237.4358; train_optim_loss: 8802237.4358; val_kl_reg_loss: 25461.0994; val_edge_recon_loss: 2641956.1130; val_gene_expr_recon_loss: 6218084.8185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8885502.0548; val_optim_loss: 8885502.0548
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9837; val_auprc_score: 0.9808; val_best_acc_score: 0.9400; val_best_f1_score: 0.9418; train_kl_reg_loss: 26094.7880; train_edge_recon_loss: 2619497.7452; train_gene_expr_recon_loss: 6151211.4683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8796804.0099; train_optim_loss: 8796804.0099; val_kl_reg_loss: 25642.7024; val_edge_recon_loss: 2642691.9247; val_gene_expr_recon_loss: 6213236.3425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8881571.0205; val_optim_loss: 8881571.0205
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9844; val_auprc_score: 0.9818; val_best_acc_score: 0.9411; val_best_f1_score: 0.9424; train_kl_reg_loss: 26193.1286; train_edge_recon_loss: 2620909.7966; train_gene_expr_recon_loss: 6148739.7080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8795842.6307; train_optim_loss: 8795842.6307; val_kl_reg_loss: 25599.2842; val_edge_recon_loss: 2642174.7962; val_gene_expr_recon_loss: 6221934.0171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8889708.1096; val_optim_loss: 8889708.1096
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9843; val_auprc_score: 0.9817; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 26194.3022; train_edge_recon_loss: 2619885.0812; train_gene_expr_recon_loss: 6146795.0768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8792874.4618; train_optim_loss: 8792874.4618; val_kl_reg_loss: 25727.6032; val_edge_recon_loss: 2642611.9092; val_gene_expr_recon_loss: 6222491.6336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8890831.1370; val_optim_loss: 8890831.1370

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9846; val_auprc_score: 0.9820; val_best_acc_score: 0.9417; val_best_f1_score: 0.9431; train_kl_reg_loss: 26278.1735; train_edge_recon_loss: 2620449.9323; train_gene_expr_recon_loss: 6142567.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8789295.4094; train_optim_loss: 8789295.4094; val_kl_reg_loss: 25758.8613; val_edge_recon_loss: 2641795.2791; val_gene_expr_recon_loss: 6200187.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8867741.2808; val_optim_loss: 8867741.2808
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9842; val_auprc_score: 0.9814; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 26308.5777; train_edge_recon_loss: 2619851.2510; train_gene_expr_recon_loss: 6143968.5677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8790128.3968; train_optim_loss: 8790128.3968; val_kl_reg_loss: 25769.0468; val_edge_recon_loss: 2644770.5685; val_gene_expr_recon_loss: 6209998.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8880537.8630; val_optim_loss: 8880537.8630
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9847; val_auprc_score: 0.9821; val_best_acc_score: 0.9423; val_best_f1_score: 0.9436; train_kl_reg_loss: 26303.8856; train_edge_recon_loss: 2619946.0776; train_gene_expr_recon_loss: 6143604.9144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8789854.8846; train_optim_loss: 8789854.8846; val_kl_reg_loss: 25775.2469; val_edge_recon_loss: 2640116.7671; val_gene_expr_recon_loss: 6211061.0753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8876953.0822; val_optim_loss: 8876953.0822
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9841; val_auprc_score: 0.9814; val_best_acc_score: 0.9412; val_best_f1_score: 0.9426; train_kl_reg_loss: 26345.3155; train_edge_recon_loss: 2620099.7345; train_gene_expr_recon_loss: 6143916.2053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8790361.2439; train_optim_loss: 8790361.2439; val_kl_reg_loss: 25800.0160; val_edge_recon_loss: 2644256.0565; val_gene_expr_recon_loss: 6213639.4726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8883695.5548; val_optim_loss: 8883695.5548
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9843; val_auprc_score: 0.9814; val_best_acc_score: 0.9413; val_best_f1_score: 0.9426; train_kl_reg_loss: 26341.4554; train_edge_recon_loss: 2619224.8819; train_gene_expr_recon_loss: 6141945.7213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8787512.0558; train_optim_loss: 8787512.0558; val_kl_reg_loss: 25826.3369; val_edge_recon_loss: 2641812.0514; val_gene_expr_recon_loss: 6205953.0479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8873591.4795; val_optim_loss: 8873591.4795

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9848; val_auprc_score: 0.9822; val_best_acc_score: 0.9425; val_best_f1_score: 0.9440; train_kl_reg_loss: 26339.9158; train_edge_recon_loss: 2620062.4998; train_gene_expr_recon_loss: 6140853.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8787255.8200; train_optim_loss: 8787255.8200; val_kl_reg_loss: 25800.7143; val_edge_recon_loss: 2638275.4675; val_gene_expr_recon_loss: 6209229.7466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8873305.9178; val_optim_loss: 8873305.9178
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9842; val_auprc_score: 0.9814; val_best_acc_score: 0.9408; val_best_f1_score: 0.9422; train_kl_reg_loss: 26334.2408; train_edge_recon_loss: 2619324.0401; train_gene_expr_recon_loss: 6139717.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8785375.8219; train_optim_loss: 8785375.8219; val_kl_reg_loss: 25784.0360; val_edge_recon_loss: 2645919.1952; val_gene_expr_recon_loss: 6219390.7329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8891093.9315; val_optim_loss: 8891093.9315
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9846; val_auprc_score: 0.9819; val_best_acc_score: 0.9417; val_best_f1_score: 0.9431; train_kl_reg_loss: 26333.5689; train_edge_recon_loss: 2620724.6449; train_gene_expr_recon_loss: 6142514.7007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8789572.9197; train_optim_loss: 8789572.9197; val_kl_reg_loss: 25797.1793; val_edge_recon_loss: 2640500.3082; val_gene_expr_recon_loss: 6204157.6267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8870455.1096; val_optim_loss: 8870455.1096
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9847; val_auprc_score: 0.9820; val_best_acc_score: 0.9416; val_best_f1_score: 0.9430; train_kl_reg_loss: 26327.4286; train_edge_recon_loss: 2619327.9948; train_gene_expr_recon_loss: 6143382.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8789037.7072; train_optim_loss: 8789037.7072; val_kl_reg_loss: 25779.5993; val_edge_recon_loss: 2639105.7072; val_gene_expr_recon_loss: 6208738.6301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8873623.9384; val_optim_loss: 8873623.9384

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 173 min 57 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9845
Val AUPRC score: 0.9820
Val best accuracy score: 0.9413
Val best F1 score: 0.9428
Val gene expr MSE score: 1.4754

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
