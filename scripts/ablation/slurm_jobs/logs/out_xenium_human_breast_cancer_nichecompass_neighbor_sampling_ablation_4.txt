None
Run timestamp: 13072023_034417_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9865; val_auprc_score: 0.9842; val_best_acc_score: 0.9469; val_best_f1_score: 0.9480; train_kl_reg_loss: 6155.0374; train_edge_recon_loss: 266525.1083; train_gene_expr_recon_loss: 77139.7410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349819.8867; train_optim_loss: 349819.8867; val_kl_reg_loss: 5978.0627; val_edge_recon_loss: 263888.7798; val_gene_expr_recon_loss: 70864.7725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340731.6154; val_optim_loss: 340731.6154
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9917; val_auprc_score: 0.9903; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 5914.5862; train_edge_recon_loss: 262132.1536; train_gene_expr_recon_loss: 69633.6030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337680.3429; train_optim_loss: 337680.3429; val_kl_reg_loss: 5846.1648; val_edge_recon_loss: 262315.3166; val_gene_expr_recon_loss: 68507.8883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336669.3679; val_optim_loss: 336669.3679
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9912; val_auprc_score: 0.9891; val_best_acc_score: 0.9623; val_best_f1_score: 0.9629; train_kl_reg_loss: 5855.6117; train_edge_recon_loss: 260960.9023; train_gene_expr_recon_loss: 68105.4189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334921.9329; train_optim_loss: 334921.9329; val_kl_reg_loss: 5899.9591; val_edge_recon_loss: 260956.9799; val_gene_expr_recon_loss: 67518.3709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334375.3106; val_optim_loss: 334375.3106
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 5814.5284; train_edge_recon_loss: 260413.2109; train_gene_expr_recon_loss: 67509.3805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333737.1197; train_optim_loss: 333737.1197; val_kl_reg_loss: 5818.5668; val_edge_recon_loss: 260055.1744; val_gene_expr_recon_loss: 67395.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333269.0865; val_optim_loss: 333269.0865
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 5797.1573; train_edge_recon_loss: 260037.4061; train_gene_expr_recon_loss: 67224.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333059.4433; train_optim_loss: 333059.4433; val_kl_reg_loss: 5746.5505; val_edge_recon_loss: 260075.8453; val_gene_expr_recon_loss: 66847.4139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332669.8100; val_optim_loss: 332669.8100
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 5783.7892; train_edge_recon_loss: 259817.1307; train_gene_expr_recon_loss: 66980.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332580.9939; train_optim_loss: 332580.9939; val_kl_reg_loss: 5672.7465; val_edge_recon_loss: 260016.9097; val_gene_expr_recon_loss: 66929.7072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332619.3642; val_optim_loss: 332619.3642
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 5777.5037; train_edge_recon_loss: 259569.6419; train_gene_expr_recon_loss: 66835.1902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332182.3358; train_optim_loss: 332182.3358; val_kl_reg_loss: 5807.6762; val_edge_recon_loss: 259641.8025; val_gene_expr_recon_loss: 66714.6712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332164.1500; val_optim_loss: 332164.1500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 5769.8720; train_edge_recon_loss: 259387.5944; train_gene_expr_recon_loss: 66680.8699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331838.3365; train_optim_loss: 331838.3365; val_kl_reg_loss: 5721.5406; val_edge_recon_loss: 259410.6937; val_gene_expr_recon_loss: 66585.7707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331718.0038; val_optim_loss: 331718.0038
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 5761.8684; train_edge_recon_loss: 259275.8379; train_gene_expr_recon_loss: 66635.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331673.0446; train_optim_loss: 331673.0446; val_kl_reg_loss: 5749.8531; val_edge_recon_loss: 259293.6654; val_gene_expr_recon_loss: 66473.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331517.0259; val_optim_loss: 331517.0259
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 5761.0689; train_edge_recon_loss: 259076.4551; train_gene_expr_recon_loss: 66550.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331388.2633; train_optim_loss: 331388.2633; val_kl_reg_loss: 5862.8808; val_edge_recon_loss: 259470.8691; val_gene_expr_recon_loss: 66757.7649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332091.5147; val_optim_loss: 332091.5147
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 5756.1088; train_edge_recon_loss: 258978.8842; train_gene_expr_recon_loss: 66460.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331195.3325; train_optim_loss: 331195.3325; val_kl_reg_loss: 5725.1784; val_edge_recon_loss: 259032.5684; val_gene_expr_recon_loss: 66344.3372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331102.0849; val_optim_loss: 331102.0849
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 5753.4347; train_edge_recon_loss: 258900.2661; train_gene_expr_recon_loss: 66435.6320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331089.3329; train_optim_loss: 331089.3329; val_kl_reg_loss: 5666.4897; val_edge_recon_loss: 258715.1882; val_gene_expr_recon_loss: 66427.8810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330809.5600; val_optim_loss: 330809.5600
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 5754.0441; train_edge_recon_loss: 258808.3272; train_gene_expr_recon_loss: 66370.6826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330933.0536; train_optim_loss: 330933.0536; val_kl_reg_loss: 5667.1968; val_edge_recon_loss: 258611.9146; val_gene_expr_recon_loss: 66435.3692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330714.4800; val_optim_loss: 330714.4800
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5753.2030; train_edge_recon_loss: 258644.0745; train_gene_expr_recon_loss: 66361.7678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330759.0455; train_optim_loss: 330759.0455; val_kl_reg_loss: 5713.9000; val_edge_recon_loss: 258525.4684; val_gene_expr_recon_loss: 66402.3604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330641.7296; val_optim_loss: 330641.7296
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 5752.4695; train_edge_recon_loss: 258563.0563; train_gene_expr_recon_loss: 66306.2478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330621.7734; train_optim_loss: 330621.7734; val_kl_reg_loss: 5802.9123; val_edge_recon_loss: 258340.7656; val_gene_expr_recon_loss: 66234.1060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330377.7845; val_optim_loss: 330377.7845
