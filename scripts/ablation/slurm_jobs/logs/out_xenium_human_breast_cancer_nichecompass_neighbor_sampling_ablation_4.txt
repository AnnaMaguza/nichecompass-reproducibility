None
Run timestamp: 24072023_222451_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9567; val_auprc_score: 0.9492; val_best_acc_score: 0.8936; val_best_f1_score: 0.8983; train_kl_reg_loss: 17089.4085; train_edge_recon_loss: 2678815.1445; train_gene_expr_recon_loss: 760523.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3456427.7317; train_optim_loss: 3456427.7317; val_kl_reg_loss: 14144.3863; val_edge_recon_loss: 2684843.2038; val_gene_expr_recon_loss: 696461.1588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3395448.7688; val_optim_loss: 3395448.7688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9658; val_best_acc_score: 0.9134; val_best_f1_score: 0.9161; train_kl_reg_loss: 14216.5587; train_edge_recon_loss: 2621864.2727; train_gene_expr_recon_loss: 673326.4914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3309407.3190; train_optim_loss: 3309407.3190; val_kl_reg_loss: 13745.5892; val_edge_recon_loss: 2671020.3185; val_gene_expr_recon_loss: 655403.6807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3340169.5925; val_optim_loss: 3340169.5925
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9749; val_auprc_score: 0.9713; val_best_acc_score: 0.9216; val_best_f1_score: 0.9236; train_kl_reg_loss: 13676.1710; train_edge_recon_loss: 2612843.4526; train_gene_expr_recon_loss: 643170.8885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3269690.5136; train_optim_loss: 3269690.5136; val_kl_reg_loss: 13411.5836; val_edge_recon_loss: 2665959.7055; val_gene_expr_recon_loss: 634064.4405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3313435.7192; val_optim_loss: 3313435.7192
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9766; val_auprc_score: 0.9732; val_best_acc_score: 0.9250; val_best_f1_score: 0.9270; train_kl_reg_loss: 13451.2576; train_edge_recon_loss: 2606943.3591; train_gene_expr_recon_loss: 627626.1793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248020.7980; train_optim_loss: 3248020.7980; val_kl_reg_loss: 13214.8899; val_edge_recon_loss: 2666080.1541; val_gene_expr_recon_loss: 623720.0569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3303015.1079; val_optim_loss: 3303015.1079
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9783; val_auprc_score: 0.9750; val_best_acc_score: 0.9297; val_best_f1_score: 0.9314; train_kl_reg_loss: 13235.5680; train_edge_recon_loss: 2604413.0562; train_gene_expr_recon_loss: 619161.6039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236810.2317; train_optim_loss: 3236810.2317; val_kl_reg_loss: 12951.7318; val_edge_recon_loss: 2658848.3938; val_gene_expr_recon_loss: 613585.1896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285385.3322; val_optim_loss: 3285385.3322
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9785; val_auprc_score: 0.9749; val_best_acc_score: 0.9301; val_best_f1_score: 0.9316; train_kl_reg_loss: 13094.4520; train_edge_recon_loss: 2602155.7752; train_gene_expr_recon_loss: 613545.0282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228795.2550; train_optim_loss: 3228795.2550; val_kl_reg_loss: 12652.2967; val_edge_recon_loss: 2656186.1712; val_gene_expr_recon_loss: 610978.4696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279816.9298; val_optim_loss: 3279816.9298
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9792; val_auprc_score: 0.9762; val_best_acc_score: 0.9309; val_best_f1_score: 0.9326; train_kl_reg_loss: 12985.4273; train_edge_recon_loss: 2599528.5526; train_gene_expr_recon_loss: 609825.3262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222339.2980; train_optim_loss: 3222339.2980; val_kl_reg_loss: 12410.2723; val_edge_recon_loss: 2662964.3219; val_gene_expr_recon_loss: 608979.2517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284353.8596; val_optim_loss: 3284353.8596
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9811; val_auprc_score: 0.9783; val_best_acc_score: 0.9343; val_best_f1_score: 0.9356; train_kl_reg_loss: 12861.3573; train_edge_recon_loss: 2599169.7502; train_gene_expr_recon_loss: 607147.7163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219178.8236; train_optim_loss: 3219178.8236; val_kl_reg_loss: 12449.1876; val_edge_recon_loss: 2656132.4846; val_gene_expr_recon_loss: 608063.1318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276644.8099; val_optim_loss: 3276644.8099
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9817; val_auprc_score: 0.9791; val_best_acc_score: 0.9351; val_best_f1_score: 0.9368; train_kl_reg_loss: 12766.5406; train_edge_recon_loss: 2598492.6999; train_gene_expr_recon_loss: 605009.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216268.6198; train_optim_loss: 3216268.6198; val_kl_reg_loss: 12453.7141; val_edge_recon_loss: 2651357.8870; val_gene_expr_recon_loss: 605214.3737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269025.9863; val_optim_loss: 3269025.9863
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9816; val_auprc_score: 0.9789; val_best_acc_score: 0.9356; val_best_f1_score: 0.9370; train_kl_reg_loss: 12777.3493; train_edge_recon_loss: 2596492.0281; train_gene_expr_recon_loss: 603225.8362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212495.2177; train_optim_loss: 3212495.2177; val_kl_reg_loss: 12434.6741; val_edge_recon_loss: 2650720.1147; val_gene_expr_recon_loss: 601870.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265025.5291; val_optim_loss: 3265025.5291
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9773; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 12678.7756; train_edge_recon_loss: 2596960.5749; train_gene_expr_recon_loss: 602234.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211873.7362; train_optim_loss: 3211873.7362; val_kl_reg_loss: 12418.5545; val_edge_recon_loss: 2654535.2363; val_gene_expr_recon_loss: 603260.5557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270214.3425; val_optim_loss: 3270214.3425
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9815; val_auprc_score: 0.9784; val_best_acc_score: 0.9359; val_best_f1_score: 0.9372; train_kl_reg_loss: 12696.6356; train_edge_recon_loss: 2594502.8804; train_gene_expr_recon_loss: 601155.2393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208354.7557; train_optim_loss: 3208354.7557; val_kl_reg_loss: 12359.9076; val_edge_recon_loss: 2649632.9332; val_gene_expr_recon_loss: 601067.4058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263060.2534; val_optim_loss: 3263060.2534
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9823; val_auprc_score: 0.9796; val_best_acc_score: 0.9371; val_best_f1_score: 0.9383; train_kl_reg_loss: 12626.5613; train_edge_recon_loss: 2593534.2747; train_gene_expr_recon_loss: 600137.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206298.2555; train_optim_loss: 3206298.2555; val_kl_reg_loss: 12406.6512; val_edge_recon_loss: 2648433.5942; val_gene_expr_recon_loss: 600406.2860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261246.5325; val_optim_loss: 3261246.5325
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9821; val_auprc_score: 0.9787; val_best_acc_score: 0.9373; val_best_f1_score: 0.9384; train_kl_reg_loss: 12602.3686; train_edge_recon_loss: 2593247.8071; train_gene_expr_recon_loss: 599152.7560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205002.9314; train_optim_loss: 3205002.9314; val_kl_reg_loss: 12157.7698; val_edge_recon_loss: 2651245.9486; val_gene_expr_recon_loss: 599574.5240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262978.2346; val_optim_loss: 3262978.2346
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9838; val_auprc_score: 0.9816; val_best_acc_score: 0.9393; val_best_f1_score: 0.9407; train_kl_reg_loss: 12568.9677; train_edge_recon_loss: 2593941.9750; train_gene_expr_recon_loss: 598969.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205480.8911; train_optim_loss: 3205480.8911; val_kl_reg_loss: 12047.8651; val_edge_recon_loss: 2648895.0753; val_gene_expr_recon_loss: 598787.2705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259730.2106; val_optim_loss: 3259730.2106
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9830; val_auprc_score: 0.9802; val_best_acc_score: 0.9388; val_best_f1_score: 0.9399; train_kl_reg_loss: 12592.1495; train_edge_recon_loss: 2591796.4312; train_gene_expr_recon_loss: 598139.3843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202527.9627; train_optim_loss: 3202527.9627; val_kl_reg_loss: 12314.8843; val_edge_recon_loss: 2646367.1062; val_gene_expr_recon_loss: 596918.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255600.2123; val_optim_loss: 3255600.2123
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9829; val_auprc_score: 0.9801; val_best_acc_score: 0.9394; val_best_f1_score: 0.9405; train_kl_reg_loss: 12560.8624; train_edge_recon_loss: 2591412.3012; train_gene_expr_recon_loss: 597293.4865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201266.6514; train_optim_loss: 3201266.6514; val_kl_reg_loss: 11998.5309; val_edge_recon_loss: 2648011.5137; val_gene_expr_recon_loss: 599424.7967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259434.8545; val_optim_loss: 3259434.8545
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9827; val_auprc_score: 0.9799; val_best_acc_score: 0.9392; val_best_f1_score: 0.9404; train_kl_reg_loss: 12529.7962; train_edge_recon_loss: 2592787.1216; train_gene_expr_recon_loss: 597407.8011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202724.7211; train_optim_loss: 3202724.7211; val_kl_reg_loss: 12244.2346; val_edge_recon_loss: 2647694.6729; val_gene_expr_recon_loss: 599110.6477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259049.5668; val_optim_loss: 3259049.5668
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9838; val_auprc_score: 0.9813; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 12486.6433; train_edge_recon_loss: 2591275.7095; train_gene_expr_recon_loss: 596881.0985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200643.4511; train_optim_loss: 3200643.4511; val_kl_reg_loss: 12124.5471; val_edge_recon_loss: 2643238.7175; val_gene_expr_recon_loss: 597546.2138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252909.4777; val_optim_loss: 3252909.4777
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9838; val_auprc_score: 0.9808; val_best_acc_score: 0.9406; val_best_f1_score: 0.9417; train_kl_reg_loss: 12486.9749; train_edge_recon_loss: 2590413.9599; train_gene_expr_recon_loss: 596485.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3199386.0153; train_optim_loss: 3199386.0153; val_kl_reg_loss: 12250.8055; val_edge_recon_loss: 2642627.1524; val_gene_expr_recon_loss: 597879.0681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252757.0154; val_optim_loss: 3252757.0154
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9830; val_auprc_score: 0.9802; val_best_acc_score: 0.9389; val_best_f1_score: 0.9400; train_kl_reg_loss: 12484.7946; train_edge_recon_loss: 2590718.3570; train_gene_expr_recon_loss: 595949.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3199152.5503; train_optim_loss: 3199152.5503; val_kl_reg_loss: 12173.6707; val_edge_recon_loss: 2644981.7500; val_gene_expr_recon_loss: 595957.0278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253112.4486; val_optim_loss: 3253112.4486
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9836; val_auprc_score: 0.9808; val_best_acc_score: 0.9405; val_best_f1_score: 0.9415; train_kl_reg_loss: 12426.1243; train_edge_recon_loss: 2590244.3748; train_gene_expr_recon_loss: 595759.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3198429.5143; train_optim_loss: 3198429.5143; val_kl_reg_loss: 12162.0273; val_edge_recon_loss: 2645808.2209; val_gene_expr_recon_loss: 595964.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253935.0890; val_optim_loss: 3253935.0890
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9835; val_auprc_score: 0.9805; val_best_acc_score: 0.9409; val_best_f1_score: 0.9421; train_kl_reg_loss: 12408.5879; train_edge_recon_loss: 2590254.5147; train_gene_expr_recon_loss: 595567.7918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3198230.8937; train_optim_loss: 3198230.8937; val_kl_reg_loss: 12238.5271; val_edge_recon_loss: 2646852.5205; val_gene_expr_recon_loss: 596613.1267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255704.1884; val_optim_loss: 3255704.1884
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9841; val_auprc_score: 0.9813; val_best_acc_score: 0.9410; val_best_f1_score: 0.9421; train_kl_reg_loss: 12344.0810; train_edge_recon_loss: 2590034.1728; train_gene_expr_recon_loss: 595749.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3198127.3777; train_optim_loss: 3198127.3777; val_kl_reg_loss: 12099.4210; val_edge_recon_loss: 2645646.4212; val_gene_expr_recon_loss: 595136.2693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252882.1113; val_optim_loss: 3252882.1113

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9844; val_auprc_score: 0.9817; val_best_acc_score: 0.9419; val_best_f1_score: 0.9432; train_kl_reg_loss: 12398.7718; train_edge_recon_loss: 2587117.2473; train_gene_expr_recon_loss: 588468.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3187984.5445; train_optim_loss: 3187984.5445; val_kl_reg_loss: 12192.5908; val_edge_recon_loss: 2642729.8253; val_gene_expr_recon_loss: 589748.4499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244670.8682; val_optim_loss: 3244670.8682
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9848; val_auprc_score: 0.9823; val_best_acc_score: 0.9432; val_best_f1_score: 0.9442; train_kl_reg_loss: 12483.6631; train_edge_recon_loss: 2586769.5547; train_gene_expr_recon_loss: 587961.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3187215.1265; train_optim_loss: 3187215.1265; val_kl_reg_loss: 12246.1362; val_edge_recon_loss: 2642377.1301; val_gene_expr_recon_loss: 588249.9525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242873.2158; val_optim_loss: 3242873.2158
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9846; val_auprc_score: 0.9821; val_best_acc_score: 0.9421; val_best_f1_score: 0.9433; train_kl_reg_loss: 12530.5168; train_edge_recon_loss: 2586484.0531; train_gene_expr_recon_loss: 587502.5405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3186517.1044; train_optim_loss: 3186517.1044; val_kl_reg_loss: 12354.0705; val_edge_recon_loss: 2641595.8048; val_gene_expr_recon_loss: 588239.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242189.2466; val_optim_loss: 3242189.2466
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9849; val_auprc_score: 0.9825; val_best_acc_score: 0.9430; val_best_f1_score: 0.9441; train_kl_reg_loss: 12549.4792; train_edge_recon_loss: 2587520.2026; train_gene_expr_recon_loss: 587329.2297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3187398.9138; train_optim_loss: 3187398.9138; val_kl_reg_loss: 12365.1537; val_edge_recon_loss: 2641929.0702; val_gene_expr_recon_loss: 587991.1229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242285.3356; val_optim_loss: 3242285.3356
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9852; val_auprc_score: 0.9827; val_best_acc_score: 0.9440; val_best_f1_score: 0.9449; train_kl_reg_loss: 12576.4373; train_edge_recon_loss: 2585577.3029; train_gene_expr_recon_loss: 587030.0501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3185183.7898; train_optim_loss: 3185183.7898; val_kl_reg_loss: 12263.5585; val_edge_recon_loss: 2639871.2774; val_gene_expr_recon_loss: 587955.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240090.4281; val_optim_loss: 3240090.4281
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9855; val_auprc_score: 0.9831; val_best_acc_score: 0.9439; val_best_f1_score: 0.9449; train_kl_reg_loss: 12536.2163; train_edge_recon_loss: 2587454.2152; train_gene_expr_recon_loss: 586471.4534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3186461.8893; train_optim_loss: 3186461.8893; val_kl_reg_loss: 12251.8564; val_edge_recon_loss: 2642704.9897; val_gene_expr_recon_loss: 588163.7466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243120.5942; val_optim_loss: 3243120.5942
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9849; val_auprc_score: 0.9822; val_best_acc_score: 0.9432; val_best_f1_score: 0.9444; train_kl_reg_loss: 12531.9390; train_edge_recon_loss: 2586562.7896; train_gene_expr_recon_loss: 586751.0914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3185845.8167; train_optim_loss: 3185845.8167; val_kl_reg_loss: 12223.5624; val_edge_recon_loss: 2641979.4880; val_gene_expr_recon_loss: 587016.9435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241219.9949; val_optim_loss: 3241219.9949
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9851; val_auprc_score: 0.9829; val_best_acc_score: 0.9435; val_best_f1_score: 0.9446; train_kl_reg_loss: 12545.6535; train_edge_recon_loss: 2585830.3121; train_gene_expr_recon_loss: 586306.6604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3184682.6279; train_optim_loss: 3184682.6279; val_kl_reg_loss: 12270.7373; val_edge_recon_loss: 2639350.1079; val_gene_expr_recon_loss: 587258.8729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238879.7140; val_optim_loss: 3238879.7140
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9856; val_auprc_score: 0.9833; val_best_acc_score: 0.9446; val_best_f1_score: 0.9455; train_kl_reg_loss: 12485.3723; train_edge_recon_loss: 2587031.0969; train_gene_expr_recon_loss: 586344.5805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3185861.0524; train_optim_loss: 3185861.0524; val_kl_reg_loss: 12221.5431; val_edge_recon_loss: 2637206.5120; val_gene_expr_recon_loss: 587439.4580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236867.5223; val_optim_loss: 3236867.5223
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9848; val_auprc_score: 0.9822; val_best_acc_score: 0.9429; val_best_f1_score: 0.9439; train_kl_reg_loss: 12482.7600; train_edge_recon_loss: 2586056.3257; train_gene_expr_recon_loss: 586761.1777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3185300.2592; train_optim_loss: 3185300.2592; val_kl_reg_loss: 12276.2917; val_edge_recon_loss: 2643278.8253; val_gene_expr_recon_loss: 587648.5642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243203.6764; val_optim_loss: 3243203.6764
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9848; val_auprc_score: 0.9825; val_best_acc_score: 0.9432; val_best_f1_score: 0.9442; train_kl_reg_loss: 12506.5980; train_edge_recon_loss: 2585734.3175; train_gene_expr_recon_loss: 586635.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3184876.6942; train_optim_loss: 3184876.6942; val_kl_reg_loss: 12210.7217; val_edge_recon_loss: 2642846.0360; val_gene_expr_recon_loss: 587811.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242868.7055; val_optim_loss: 3242868.7055
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9858; val_auprc_score: 0.9833; val_best_acc_score: 0.9442; val_best_f1_score: 0.9454; train_kl_reg_loss: 12472.6351; train_edge_recon_loss: 2586011.0593; train_gene_expr_recon_loss: 586101.2877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3184584.9832; train_optim_loss: 3184584.9832; val_kl_reg_loss: 12160.7334; val_edge_recon_loss: 2639895.1627; val_gene_expr_recon_loss: 587284.1085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239340.0103; val_optim_loss: 3239340.0103
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9850; val_auprc_score: 0.9826; val_best_acc_score: 0.9433; val_best_f1_score: 0.9443; train_kl_reg_loss: 12469.1936; train_edge_recon_loss: 2586041.2209; train_gene_expr_recon_loss: 586092.3417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3184602.7550; train_optim_loss: 3184602.7550; val_kl_reg_loss: 12278.1536; val_edge_recon_loss: 2639894.5274; val_gene_expr_recon_loss: 586448.3746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238621.0822; val_optim_loss: 3238621.0822

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9845; val_auprc_score: 0.9818; val_best_acc_score: 0.9425; val_best_f1_score: 0.9436; train_kl_reg_loss: 12507.9115; train_edge_recon_loss: 2585285.0608; train_gene_expr_recon_loss: 585400.0715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3183193.0447; train_optim_loss: 3183193.0447; val_kl_reg_loss: 12244.7905; val_edge_recon_loss: 2643873.1199; val_gene_expr_recon_loss: 585689.1177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241807.0308; val_optim_loss: 3241807.0308
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9850; val_auprc_score: 0.9825; val_best_acc_score: 0.9434; val_best_f1_score: 0.9444; train_kl_reg_loss: 12489.3336; train_edge_recon_loss: 2585501.2099; train_gene_expr_recon_loss: 585299.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3183290.3733; train_optim_loss: 3183290.3733; val_kl_reg_loss: 12253.7833; val_edge_recon_loss: 2640112.2825; val_gene_expr_recon_loss: 586661.8223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239027.8784; val_optim_loss: 3239027.8784
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9853; val_auprc_score: 0.9827; val_best_acc_score: 0.9436; val_best_f1_score: 0.9447; train_kl_reg_loss: 12464.6042; train_edge_recon_loss: 2585912.3817; train_gene_expr_recon_loss: 585430.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3183807.1309; train_optim_loss: 3183807.1309; val_kl_reg_loss: 12240.2152; val_edge_recon_loss: 2639719.3390; val_gene_expr_recon_loss: 586613.4033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238572.9486; val_optim_loss: 3238572.9486
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9851; val_auprc_score: 0.9827; val_best_acc_score: 0.9439; val_best_f1_score: 0.9449; train_kl_reg_loss: 12465.0345; train_edge_recon_loss: 2585362.8347; train_gene_expr_recon_loss: 584894.5618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3182722.4306; train_optim_loss: 3182722.4306; val_kl_reg_loss: 12209.7902; val_edge_recon_loss: 2641546.9384; val_gene_expr_recon_loss: 587492.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241249.5719; val_optim_loss: 3241249.5719

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 95 min 55 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9852
Val AUPRC score: 0.9829
Val best accuracy score: 0.9438
Val best F1 score: 0.9449
Val gene expr MSE score: 1.5061

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
