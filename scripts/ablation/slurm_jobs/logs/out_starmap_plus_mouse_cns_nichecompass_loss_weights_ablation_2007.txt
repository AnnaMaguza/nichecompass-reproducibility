None
Run timestamp: 03072023_131004_2007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9873; val_auprc_score: 0.9821; val_best_acc_score: 0.9598; val_best_f1_score: 0.9607; train_kl_reg_loss: 5748.5571; train_edge_recon_loss: 263122.5726; train_gene_expr_recon_loss: 13676.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282547.7863; train_optim_loss: 282547.7863; val_kl_reg_loss: 5672.6982; val_edge_recon_loss: 257175.4018; val_gene_expr_recon_loss: 12532.2527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275380.3539; val_optim_loss: 275380.3539
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9864; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 5684.6637; train_edge_recon_loss: 257668.0077; train_gene_expr_recon_loss: 12141.1440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275493.8155; train_optim_loss: 275493.8155; val_kl_reg_loss: 5718.1262; val_edge_recon_loss: 256181.0908; val_gene_expr_recon_loss: 11848.1452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273747.3625; val_optim_loss: 273747.3625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9919; val_auprc_score: 0.9884; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 5685.4197; train_edge_recon_loss: 257099.2434; train_gene_expr_recon_loss: 11665.0115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274449.6745; train_optim_loss: 274449.6745; val_kl_reg_loss: 5545.4841; val_edge_recon_loss: 255979.7369; val_gene_expr_recon_loss: 11514.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273039.8898; val_optim_loss: 273039.8898
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9930; val_auprc_score: 0.9900; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 5685.9388; train_edge_recon_loss: 256630.5434; train_gene_expr_recon_loss: 11393.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273710.4121; train_optim_loss: 273710.4121; val_kl_reg_loss: 5652.2289; val_edge_recon_loss: 255447.0098; val_gene_expr_recon_loss: 11268.3349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272367.5711; val_optim_loss: 272367.5711
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9942; val_auprc_score: 0.9917; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 5683.7734; train_edge_recon_loss: 256574.1334; train_gene_expr_recon_loss: 11208.0297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273465.9372; train_optim_loss: 273465.9372; val_kl_reg_loss: 5678.1545; val_edge_recon_loss: 255263.3254; val_gene_expr_recon_loss: 11140.2030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272081.6824; val_optim_loss: 272081.6824
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9949; val_auprc_score: 0.9927; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 5681.1228; train_edge_recon_loss: 256352.3468; train_gene_expr_recon_loss: 11066.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273099.8386; train_optim_loss: 273099.8386; val_kl_reg_loss: 5677.2729; val_edge_recon_loss: 255048.0518; val_gene_expr_recon_loss: 11025.4656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271750.7902; val_optim_loss: 271750.7902
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9952; val_auprc_score: 0.9930; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5684.3872; train_edge_recon_loss: 256152.8226; train_gene_expr_recon_loss: 10969.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272806.5235; train_optim_loss: 272806.5235; val_kl_reg_loss: 5612.4766; val_edge_recon_loss: 255214.8645; val_gene_expr_recon_loss: 10884.3533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271711.6945; val_optim_loss: 271711.6945
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9957; val_auprc_score: 0.9936; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5684.9698; train_edge_recon_loss: 255965.4380; train_gene_expr_recon_loss: 10870.2343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272520.6424; train_optim_loss: 272520.6424; val_kl_reg_loss: 5632.5319; val_edge_recon_loss: 254803.5576; val_gene_expr_recon_loss: 10798.1550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271234.2469; val_optim_loss: 271234.2469
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9962; val_auprc_score: 0.9943; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 5680.4445; train_edge_recon_loss: 255889.6481; train_gene_expr_recon_loss: 10784.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272354.6755; train_optim_loss: 272354.6755; val_kl_reg_loss: 5540.9270; val_edge_recon_loss: 254774.9635; val_gene_expr_recon_loss: 10702.1381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271018.0305; val_optim_loss: 271018.0305
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9936; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 5683.3769; train_edge_recon_loss: 255712.5607; train_gene_expr_recon_loss: 10714.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272110.6593; train_optim_loss: 272110.6593; val_kl_reg_loss: 5611.7140; val_edge_recon_loss: 254758.2164; val_gene_expr_recon_loss: 10681.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271051.6797; val_optim_loss: 271051.6797
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9962; val_auprc_score: 0.9946; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 5682.8532; train_edge_recon_loss: 255629.6536; train_gene_expr_recon_loss: 10651.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271964.1588; train_optim_loss: 271964.1588; val_kl_reg_loss: 5621.2989; val_edge_recon_loss: 254627.2074; val_gene_expr_recon_loss: 10613.4753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270861.9832; val_optim_loss: 270861.9832
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9965; val_auprc_score: 0.9948; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 5680.9106; train_edge_recon_loss: 255588.3868; train_gene_expr_recon_loss: 10602.8243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271872.1210; train_optim_loss: 271872.1210; val_kl_reg_loss: 5724.4306; val_edge_recon_loss: 254461.4574; val_gene_expr_recon_loss: 10530.4525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270716.3406; val_optim_loss: 270716.3406
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9966; val_auprc_score: 0.9949; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 5684.3990; train_edge_recon_loss: 255521.0396; train_gene_expr_recon_loss: 10553.2182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271758.6567; train_optim_loss: 271758.6567; val_kl_reg_loss: 5601.7043; val_edge_recon_loss: 254425.4148; val_gene_expr_recon_loss: 10530.9078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270558.0262; val_optim_loss: 270558.0262
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9869; val_best_f1_score: 0.9869; train_kl_reg_loss: 5680.7781; train_edge_recon_loss: 255450.0624; train_gene_expr_recon_loss: 10528.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271659.7198; train_optim_loss: 271659.7198; val_kl_reg_loss: 5720.8535; val_edge_recon_loss: 254262.8229; val_gene_expr_recon_loss: 10468.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270452.3203; val_optim_loss: 270452.3203
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9967; val_auprc_score: 0.9947; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 5683.8385; train_edge_recon_loss: 255391.3738; train_gene_expr_recon_loss: 10483.4367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271558.6493; train_optim_loss: 271558.6493; val_kl_reg_loss: 5645.7416; val_edge_recon_loss: 254203.4809; val_gene_expr_recon_loss: 10433.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270283.0078; val_optim_loss: 270283.0078
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9953; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 5687.0348; train_edge_recon_loss: 255303.3844; train_gene_expr_recon_loss: 10462.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271452.9476; train_optim_loss: 271452.9476; val_kl_reg_loss: 5646.9396; val_edge_recon_loss: 254184.8707; val_gene_expr_recon_loss: 10434.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270266.7590; val_optim_loss: 270266.7590
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 5687.9528; train_edge_recon_loss: 255273.3591; train_gene_expr_recon_loss: 10427.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271388.5768; train_optim_loss: 271388.5768; val_kl_reg_loss: 5655.4709; val_edge_recon_loss: 254029.9732; val_gene_expr_recon_loss: 10400.0985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270085.5398; val_optim_loss: 270085.5398
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9955; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 5687.0672; train_edge_recon_loss: 255225.7721; train_gene_expr_recon_loss: 10413.7360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271326.5763; train_optim_loss: 271326.5763; val_kl_reg_loss: 5707.7251; val_edge_recon_loss: 254101.4914; val_gene_expr_recon_loss: 10379.5754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270188.7941; val_optim_loss: 270188.7941
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9959; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 5687.5227; train_edge_recon_loss: 255204.5780; train_gene_expr_recon_loss: 10393.4346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271285.5349; train_optim_loss: 271285.5349; val_kl_reg_loss: 5698.4968; val_edge_recon_loss: 253952.8539; val_gene_expr_recon_loss: 10383.9709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270035.3227; val_optim_loss: 270035.3227
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9976; val_auprc_score: 0.9963; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 5691.3377; train_edge_recon_loss: 255124.0650; train_gene_expr_recon_loss: 10369.2311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271184.6335; train_optim_loss: 271184.6335; val_kl_reg_loss: 5749.3372; val_edge_recon_loss: 253748.0156; val_gene_expr_recon_loss: 10346.8650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269844.2180; val_optim_loss: 269844.2180
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9958; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 5690.4290; train_edge_recon_loss: 255114.4989; train_gene_expr_recon_loss: 10351.4618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271156.3897; train_optim_loss: 271156.3897; val_kl_reg_loss: 5657.0594; val_edge_recon_loss: 254025.4143; val_gene_expr_recon_loss: 10345.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270028.1871; val_optim_loss: 270028.1871
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 5692.3683; train_edge_recon_loss: 255057.5700; train_gene_expr_recon_loss: 10335.4199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271085.3580; train_optim_loss: 271085.3580; val_kl_reg_loss: 5698.4320; val_edge_recon_loss: 253750.6441; val_gene_expr_recon_loss: 10322.9785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269772.0566; val_optim_loss: 269772.0566
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9896; val_best_f1_score: 0.9897; train_kl_reg_loss: 5692.5523; train_edge_recon_loss: 255026.8536; train_gene_expr_recon_loss: 10321.1480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271040.5537; train_optim_loss: 271040.5537; val_kl_reg_loss: 5624.5335; val_edge_recon_loss: 253671.9410; val_gene_expr_recon_loss: 10285.5642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269582.0383; val_optim_loss: 269582.0383
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9977; val_auprc_score: 0.9966; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 5693.0224; train_edge_recon_loss: 254997.2057; train_gene_expr_recon_loss: 10306.9104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270997.1380; train_optim_loss: 270997.1380; val_kl_reg_loss: 5719.4555; val_edge_recon_loss: 254009.7354; val_gene_expr_recon_loss: 10278.2613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270007.4520; val_optim_loss: 270007.4520
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9962; val_best_acc_score: 0.9899; val_best_f1_score: 0.9899; train_kl_reg_loss: 5694.0576; train_edge_recon_loss: 255012.0430; train_gene_expr_recon_loss: 10298.9923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271005.0931; train_optim_loss: 271005.0931; val_kl_reg_loss: 5679.4987; val_edge_recon_loss: 253710.1984; val_gene_expr_recon_loss: 10287.3980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269677.0938; val_optim_loss: 269677.0938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9900; val_best_f1_score: 0.9901; train_kl_reg_loss: 5695.5697; train_edge_recon_loss: 254920.0091; train_gene_expr_recon_loss: 10278.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270894.3607; train_optim_loss: 270894.3607; val_kl_reg_loss: 5660.5586; val_edge_recon_loss: 253649.2578; val_gene_expr_recon_loss: 10266.0838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269575.8988; val_optim_loss: 269575.8988
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9980; val_auprc_score: 0.9969; val_best_acc_score: 0.9906; val_best_f1_score: 0.9907; train_kl_reg_loss: 5697.3900; train_edge_recon_loss: 254883.0075; train_gene_expr_recon_loss: 10280.2219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270860.6193; train_optim_loss: 270860.6193; val_kl_reg_loss: 5690.6000; val_edge_recon_loss: 253715.6082; val_gene_expr_recon_loss: 10276.0611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269682.2687; val_optim_loss: 269682.2687
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9965; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 5699.3409; train_edge_recon_loss: 254811.2412; train_gene_expr_recon_loss: 10265.2700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270775.8520; train_optim_loss: 270775.8520; val_kl_reg_loss: 5702.0827; val_edge_recon_loss: 253659.8713; val_gene_expr_recon_loss: 10258.6205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269620.5750; val_optim_loss: 269620.5750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9979; val_auprc_score: 0.9968; val_best_acc_score: 0.9906; val_best_f1_score: 0.9906; train_kl_reg_loss: 5699.6726; train_edge_recon_loss: 254802.0881; train_gene_expr_recon_loss: 10263.1885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270764.9497; train_optim_loss: 270764.9497; val_kl_reg_loss: 5656.6188; val_edge_recon_loss: 253683.1033; val_gene_expr_recon_loss: 10259.3353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269599.0555; val_optim_loss: 269599.0555
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9979; val_auprc_score: 0.9968; val_best_acc_score: 0.9909; val_best_f1_score: 0.9909; train_kl_reg_loss: 5699.8951; train_edge_recon_loss: 254833.1480; train_gene_expr_recon_loss: 10258.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270791.3083; train_optim_loss: 270791.3083; val_kl_reg_loss: 5723.8365; val_edge_recon_loss: 253576.1562; val_gene_expr_recon_loss: 10259.6708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269559.6633; val_optim_loss: 269559.6633
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9907; val_best_f1_score: 0.9908; train_kl_reg_loss: 5699.2551; train_edge_recon_loss: 254828.2014; train_gene_expr_recon_loss: 10246.5695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270774.0264; train_optim_loss: 270774.0264; val_kl_reg_loss: 5691.5242; val_edge_recon_loss: 253608.7848; val_gene_expr_recon_loss: 10249.4184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269549.7277; val_optim_loss: 269549.7277
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9981; val_auprc_score: 0.9970; val_best_acc_score: 0.9909; val_best_f1_score: 0.9909; train_kl_reg_loss: 5702.1261; train_edge_recon_loss: 254803.9676; train_gene_expr_recon_loss: 10233.5472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270739.6416; train_optim_loss: 270739.6416; val_kl_reg_loss: 5615.6537; val_edge_recon_loss: 253621.9732; val_gene_expr_recon_loss: 10237.8343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269475.4594; val_optim_loss: 269475.4594
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9981; val_auprc_score: 0.9967; val_best_acc_score: 0.9913; val_best_f1_score: 0.9914; train_kl_reg_loss: 5699.9868; train_edge_recon_loss: 254806.3587; train_gene_expr_recon_loss: 10229.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270735.6959; train_optim_loss: 270735.6959; val_kl_reg_loss: 5659.8144; val_edge_recon_loss: 253761.6520; val_gene_expr_recon_loss: 10233.5394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269655.0051; val_optim_loss: 269655.0051
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9910; val_best_f1_score: 0.9911; train_kl_reg_loss: 5702.6716; train_edge_recon_loss: 254746.7027; train_gene_expr_recon_loss: 10225.3606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270674.7348; train_optim_loss: 270674.7348; val_kl_reg_loss: 5691.5273; val_edge_recon_loss: 253678.4318; val_gene_expr_recon_loss: 10231.8572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269601.8156; val_optim_loss: 269601.8156
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9982; val_auprc_score: 0.9972; val_best_acc_score: 0.9912; val_best_f1_score: 0.9913; train_kl_reg_loss: 5706.4449; train_edge_recon_loss: 254711.7157; train_gene_expr_recon_loss: 10220.8245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270638.9852; train_optim_loss: 270638.9852; val_kl_reg_loss: 5704.2077; val_edge_recon_loss: 253400.3502; val_gene_expr_recon_loss: 10210.8744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269315.4313; val_optim_loss: 269315.4313
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9972; val_best_acc_score: 0.9916; val_best_f1_score: 0.9916; train_kl_reg_loss: 5704.7058; train_edge_recon_loss: 254676.8175; train_gene_expr_recon_loss: 10218.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270599.7070; train_optim_loss: 270599.7070; val_kl_reg_loss: 5711.4773; val_edge_recon_loss: 253408.5527; val_gene_expr_recon_loss: 10219.4328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269339.4613; val_optim_loss: 269339.4613
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9915; val_best_f1_score: 0.9916; train_kl_reg_loss: 5706.1336; train_edge_recon_loss: 254677.8257; train_gene_expr_recon_loss: 10214.3297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270598.2893; train_optim_loss: 270598.2893; val_kl_reg_loss: 5684.7985; val_edge_recon_loss: 253575.8135; val_gene_expr_recon_loss: 10231.1931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269491.8051; val_optim_loss: 269491.8051
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9973; val_best_acc_score: 0.9916; val_best_f1_score: 0.9917; train_kl_reg_loss: 5706.3848; train_edge_recon_loss: 254720.0663; train_gene_expr_recon_loss: 10210.4566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270636.9081; train_optim_loss: 270636.9081; val_kl_reg_loss: 5741.0222; val_edge_recon_loss: 253466.9279; val_gene_expr_recon_loss: 10181.7398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269389.6910; val_optim_loss: 269389.6910
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9973; val_best_acc_score: 0.9920; val_best_f1_score: 0.9920; train_kl_reg_loss: 5709.6772; train_edge_recon_loss: 254602.0739; train_gene_expr_recon_loss: 10208.5188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270520.2702; train_optim_loss: 270520.2702; val_kl_reg_loss: 5710.5073; val_edge_recon_loss: 253438.7094; val_gene_expr_recon_loss: 10189.7005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269338.9164; val_optim_loss: 269338.9164

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9923; val_best_f1_score: 0.9923; train_kl_reg_loss: 5697.1021; train_edge_recon_loss: 254589.0438; train_gene_expr_recon_loss: 10160.4060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270446.5516; train_optim_loss: 270446.5516; val_kl_reg_loss: 5696.8485; val_edge_recon_loss: 253431.4359; val_gene_expr_recon_loss: 10166.6253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269294.9090; val_optim_loss: 269294.9090
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9984; val_auprc_score: 0.9975; val_best_acc_score: 0.9926; val_best_f1_score: 0.9927; train_kl_reg_loss: 5692.3254; train_edge_recon_loss: 254611.9851; train_gene_expr_recon_loss: 10164.4907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270468.8009; train_optim_loss: 270468.8009; val_kl_reg_loss: 5692.2901; val_edge_recon_loss: 253365.8916; val_gene_expr_recon_loss: 10170.1782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269228.3605; val_optim_loss: 269228.3605
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9984; val_auprc_score: 0.9974; val_best_acc_score: 0.9924; val_best_f1_score: 0.9925; train_kl_reg_loss: 5693.7628; train_edge_recon_loss: 254544.8343; train_gene_expr_recon_loss: 10160.9450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270399.5422; train_optim_loss: 270399.5422; val_kl_reg_loss: 5682.9987; val_edge_recon_loss: 253260.7697; val_gene_expr_recon_loss: 10179.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269123.5691; val_optim_loss: 269123.5691
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9984; val_auprc_score: 0.9975; val_best_acc_score: 0.9922; val_best_f1_score: 0.9922; train_kl_reg_loss: 5691.8668; train_edge_recon_loss: 254547.6244; train_gene_expr_recon_loss: 10158.1925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270397.6838; train_optim_loss: 270397.6838; val_kl_reg_loss: 5688.0216; val_edge_recon_loss: 253466.6211; val_gene_expr_recon_loss: 10151.4525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269306.0957; val_optim_loss: 269306.0957
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9984; val_auprc_score: 0.9973; val_best_acc_score: 0.9921; val_best_f1_score: 0.9922; train_kl_reg_loss: 5690.5960; train_edge_recon_loss: 254565.8387; train_gene_expr_recon_loss: 10152.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270409.2906; train_optim_loss: 270409.2906; val_kl_reg_loss: 5705.5975; val_edge_recon_loss: 253451.2514; val_gene_expr_recon_loss: 10165.3347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269322.1840; val_optim_loss: 269322.1840
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9925; val_best_f1_score: 0.9926; train_kl_reg_loss: 5689.9053; train_edge_recon_loss: 254571.1983; train_gene_expr_recon_loss: 10150.3985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270411.5021; train_optim_loss: 270411.5021; val_kl_reg_loss: 5721.3822; val_edge_recon_loss: 253355.2662; val_gene_expr_recon_loss: 10166.3138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269242.9641; val_optim_loss: 269242.9641
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9924; val_best_f1_score: 0.9925; train_kl_reg_loss: 5690.6085; train_edge_recon_loss: 254515.9975; train_gene_expr_recon_loss: 10152.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270358.8058; train_optim_loss: 270358.8058; val_kl_reg_loss: 5699.0154; val_edge_recon_loss: 253333.1854; val_gene_expr_recon_loss: 10142.6762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269174.8781; val_optim_loss: 269174.8781

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9983; val_auprc_score: 0.9974; val_best_acc_score: 0.9920; val_best_f1_score: 0.9921; train_kl_reg_loss: 5690.6435; train_edge_recon_loss: 254527.4955; train_gene_expr_recon_loss: 10153.8888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270372.0276; train_optim_loss: 270372.0276; val_kl_reg_loss: 5690.9707; val_edge_recon_loss: 253463.9080; val_gene_expr_recon_loss: 10172.3738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269327.2527; val_optim_loss: 269327.2527
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9984; val_auprc_score: 0.9974; val_best_acc_score: 0.9925; val_best_f1_score: 0.9925; train_kl_reg_loss: 5689.2593; train_edge_recon_loss: 254511.5507; train_gene_expr_recon_loss: 10146.3052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270347.1153; train_optim_loss: 270347.1153; val_kl_reg_loss: 5690.0109; val_edge_recon_loss: 253470.9252; val_gene_expr_recon_loss: 10147.0454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269307.9832; val_optim_loss: 269307.9832
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9984; val_auprc_score: 0.9975; val_best_acc_score: 0.9923; val_best_f1_score: 0.9924; train_kl_reg_loss: 5687.8568; train_edge_recon_loss: 254552.9571; train_gene_expr_recon_loss: 10145.3610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270386.1747; train_optim_loss: 270386.1747; val_kl_reg_loss: 5688.0558; val_edge_recon_loss: 253355.8639; val_gene_expr_recon_loss: 10156.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269200.1289; val_optim_loss: 269200.1289
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9984; val_auprc_score: 0.9975; val_best_acc_score: 0.9923; val_best_f1_score: 0.9924; train_kl_reg_loss: 5688.7164; train_edge_recon_loss: 254517.4260; train_gene_expr_recon_loss: 10146.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270352.9794; train_optim_loss: 270352.9794; val_kl_reg_loss: 5691.3508; val_edge_recon_loss: 253422.5600; val_gene_expr_recon_loss: 10152.8235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269266.7320; val_optim_loss: 269266.7320

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 502 min 35 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9984
Val AUPRC score: 0.9976
Val best accuracy score: 0.9925
Val best F1 score: 0.9926
Val gene expr MSE score: 0.6212

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
