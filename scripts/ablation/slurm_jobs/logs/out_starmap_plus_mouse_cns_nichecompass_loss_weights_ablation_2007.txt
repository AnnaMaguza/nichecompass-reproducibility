None
Run timestamp: 16072023_220225_2007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9772; val_best_acc_score: 0.9439; val_best_f1_score: 0.9448; train_kl_reg_loss: 98608.2980; train_edge_recon_loss: 2977022.0396; train_gene_expr_recon_loss: 11023691.3519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14099321.6982; train_optim_loss: 14099321.6982; val_kl_reg_loss: 89890.3284; val_edge_recon_loss: 2729602.6344; val_gene_expr_recon_loss: 10330248.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13149741.5375; val_optim_loss: 13149741.5375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9875; val_auprc_score: 0.9839; val_best_acc_score: 0.9544; val_best_f1_score: 0.9554; train_kl_reg_loss: 82702.9390; train_edge_recon_loss: 2694391.9002; train_gene_expr_recon_loss: 10179172.4478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12956267.2921; train_optim_loss: 12956267.2921; val_kl_reg_loss: 74657.2234; val_edge_recon_loss: 2675685.6156; val_gene_expr_recon_loss: 10041737.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12792080.0875; val_optim_loss: 12792080.0875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9888; val_auprc_score: 0.9859; val_best_acc_score: 0.9572; val_best_f1_score: 0.9581; train_kl_reg_loss: 70478.8363; train_edge_recon_loss: 2663753.8707; train_gene_expr_recon_loss: 9940071.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12674304.2643; train_optim_loss: 12674304.2643; val_kl_reg_loss: 65583.2406; val_edge_recon_loss: 2658262.6938; val_gene_expr_recon_loss: 9849349.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12573195.4000; val_optim_loss: 12573195.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9899; val_auprc_score: 0.9876; val_best_acc_score: 0.9587; val_best_f1_score: 0.9597; train_kl_reg_loss: 62114.7278; train_edge_recon_loss: 2650269.1686; train_gene_expr_recon_loss: 9794560.5619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12506944.4729; train_optim_loss: 12506944.4729; val_kl_reg_loss: 58225.6980; val_edge_recon_loss: 2644752.1063; val_gene_expr_recon_loss: 9758399.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12461377.4500; val_optim_loss: 12461377.4500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9908; val_auprc_score: 0.9888; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 56527.3168; train_edge_recon_loss: 2639052.2364; train_gene_expr_recon_loss: 9687768.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12383347.9555; train_optim_loss: 12383347.9555; val_kl_reg_loss: 54041.6416; val_edge_recon_loss: 2637377.3344; val_gene_expr_recon_loss: 9681511.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12372930.9000; val_optim_loss: 12372930.9000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9893; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 52478.6184; train_edge_recon_loss: 2631864.3647; train_gene_expr_recon_loss: 9625873.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12310216.8498; train_optim_loss: 12310216.8498; val_kl_reg_loss: 49457.9981; val_edge_recon_loss: 2627254.5375; val_gene_expr_recon_loss: 9654012.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12330724.8375; val_optim_loss: 12330724.8375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9918; val_auprc_score: 0.9900; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 49476.9919; train_edge_recon_loss: 2626707.1579; train_gene_expr_recon_loss: 9567320.9346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12243505.0834; train_optim_loss: 12243505.0834; val_kl_reg_loss: 47885.1602; val_edge_recon_loss: 2625286.7969; val_gene_expr_recon_loss: 9633955.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12307127.8375; val_optim_loss: 12307127.8375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9919; val_auprc_score: 0.9902; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 47190.8781; train_edge_recon_loss: 2622413.5052; train_gene_expr_recon_loss: 9520572.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12190176.5897; train_optim_loss: 12190176.5897; val_kl_reg_loss: 45500.9398; val_edge_recon_loss: 2623748.3219; val_gene_expr_recon_loss: 9582532.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12251782.2375; val_optim_loss: 12251782.2375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9639; val_best_f1_score: 0.9643; train_kl_reg_loss: 45451.3328; train_edge_recon_loss: 2617764.6579; train_gene_expr_recon_loss: 9478754.2531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12141970.2323; train_optim_loss: 12141970.2323; val_kl_reg_loss: 44518.3530; val_edge_recon_loss: 2620012.4719; val_gene_expr_recon_loss: 9564920.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12229451.0250; val_optim_loss: 12229451.0250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 44071.8408; train_edge_recon_loss: 2615687.7027; train_gene_expr_recon_loss: 9444764.3561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12104523.8943; train_optim_loss: 12104523.8943; val_kl_reg_loss: 43278.2653; val_edge_recon_loss: 2618042.0000; val_gene_expr_recon_loss: 9582823.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12244143.8750; val_optim_loss: 12244143.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 42820.5422; train_edge_recon_loss: 2614181.0935; train_gene_expr_recon_loss: 9415051.4485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12072053.0974; train_optim_loss: 12072053.0974; val_kl_reg_loss: 42223.3521; val_edge_recon_loss: 2615567.6938; val_gene_expr_recon_loss: 9548984.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12206775.4500; val_optim_loss: 12206775.4500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9930; val_auprc_score: 0.9920; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 41948.8954; train_edge_recon_loss: 2610250.5403; train_gene_expr_recon_loss: 9386770.0765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12038969.4882; train_optim_loss: 12038969.4882; val_kl_reg_loss: 41378.4723; val_edge_recon_loss: 2615138.0750; val_gene_expr_recon_loss: 9542795.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12199311.9000; val_optim_loss: 12199311.9000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9920; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 41105.7743; train_edge_recon_loss: 2610369.6485; train_gene_expr_recon_loss: 9357732.1008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12009207.5229; train_optim_loss: 12009207.5229; val_kl_reg_loss: 40876.9196; val_edge_recon_loss: 2613904.2875; val_gene_expr_recon_loss: 9581772.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12236554.0625; val_optim_loss: 12236554.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 40389.9225; train_edge_recon_loss: 2608063.7396; train_gene_expr_recon_loss: 9345624.4917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11994078.1544; train_optim_loss: 11994078.1544; val_kl_reg_loss: 40067.7033; val_edge_recon_loss: 2612219.6031; val_gene_expr_recon_loss: 9558840.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12211127.4875; val_optim_loss: 12211127.4875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9933; val_auprc_score: 0.9919; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 39869.0206; train_edge_recon_loss: 2605565.5236; train_gene_expr_recon_loss: 9331855.8032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11977290.3853; train_optim_loss: 11977290.3853; val_kl_reg_loss: 39660.7000; val_edge_recon_loss: 2607740.2687; val_gene_expr_recon_loss: 9566591.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12213992.5625; val_optim_loss: 12213992.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9932; val_auprc_score: 0.9919; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 39244.0042; train_edge_recon_loss: 2605020.2486; train_gene_expr_recon_loss: 9295631.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11939895.9555; train_optim_loss: 11939895.9555; val_kl_reg_loss: 39078.4906; val_edge_recon_loss: 2609450.7563; val_gene_expr_recon_loss: 9587449.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12235979.0500; val_optim_loss: 12235979.0500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9935; val_auprc_score: 0.9924; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 40600.1418; train_edge_recon_loss: 2602768.5195; train_gene_expr_recon_loss: 9217136.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11860504.7650; train_optim_loss: 11860504.7650; val_kl_reg_loss: 40386.6573; val_edge_recon_loss: 2608099.5719; val_gene_expr_recon_loss: 9558015.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12206501.8500; val_optim_loss: 12206501.8500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 40840.5515; train_edge_recon_loss: 2602990.1519; train_gene_expr_recon_loss: 9211277.4847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11855108.2058; train_optim_loss: 11855108.2058; val_kl_reg_loss: 40520.1147; val_edge_recon_loss: 2606317.6906; val_gene_expr_recon_loss: 9550302.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12197140.5000; val_optim_loss: 12197140.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9932; val_auprc_score: 0.9920; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 40962.5800; train_edge_recon_loss: 2599714.7719; train_gene_expr_recon_loss: 9208689.7295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11849367.1085; train_optim_loss: 11849367.1085; val_kl_reg_loss: 40525.2288; val_edge_recon_loss: 2604564.2719; val_gene_expr_recon_loss: 9528730.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12173819.5375; val_optim_loss: 12173819.5375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9933; val_auprc_score: 0.9920; val_best_acc_score: 0.9676; val_best_f1_score: 0.9682; train_kl_reg_loss: 40910.4847; train_edge_recon_loss: 2600283.0223; train_gene_expr_recon_loss: 9198975.6551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11840169.1836; train_optim_loss: 11840169.1836; val_kl_reg_loss: 40615.8903; val_edge_recon_loss: 2608677.7219; val_gene_expr_recon_loss: 9530226.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12179520.5625; val_optim_loss: 12179520.5625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9935; val_auprc_score: 0.9924; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 40889.8345; train_edge_recon_loss: 2599267.0876; train_gene_expr_recon_loss: 9202540.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11842697.0807; train_optim_loss: 11842697.0807; val_kl_reg_loss: 40369.6460; val_edge_recon_loss: 2608065.8937; val_gene_expr_recon_loss: 9547692.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12196127.8875; val_optim_loss: 12196127.8875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9935; val_auprc_score: 0.9922; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 40765.7665; train_edge_recon_loss: 2600253.7204; train_gene_expr_recon_loss: 9188649.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11829669.4534; train_optim_loss: 11829669.4534; val_kl_reg_loss: 40384.9838; val_edge_recon_loss: 2604504.9031; val_gene_expr_recon_loss: 9560455.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12205345.5125; val_optim_loss: 12205345.5125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9936; val_auprc_score: 0.9924; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 40661.7082; train_edge_recon_loss: 2600500.9016; train_gene_expr_recon_loss: 9185322.9332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11826485.5313; train_optim_loss: 11826485.5313; val_kl_reg_loss: 40212.8000; val_edge_recon_loss: 2603493.9438; val_gene_expr_recon_loss: 9519505.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12163212.5875; val_optim_loss: 12163212.5875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9936; val_auprc_score: 0.9924; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 40557.9557; train_edge_recon_loss: 2599763.3449; train_gene_expr_recon_loss: 9188430.1252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11828751.4409; train_optim_loss: 11828751.4409; val_kl_reg_loss: 39973.5039; val_edge_recon_loss: 2601276.2938; val_gene_expr_recon_loss: 9565199.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12206448.9875; val_optim_loss: 12206448.9875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9936; val_auprc_score: 0.9925; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 40468.7683; train_edge_recon_loss: 2600128.6255; train_gene_expr_recon_loss: 9185186.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11825783.6662; train_optim_loss: 11825783.6662; val_kl_reg_loss: 40083.3833; val_edge_recon_loss: 2604483.6437; val_gene_expr_recon_loss: 9566621.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12211188.8625; val_optim_loss: 12211188.8625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 40370.9548; train_edge_recon_loss: 2599699.5139; train_gene_expr_recon_loss: 9181069.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11821140.1377; train_optim_loss: 11821140.1377; val_kl_reg_loss: 39761.4723; val_edge_recon_loss: 2603600.6000; val_gene_expr_recon_loss: 9576102.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12219464.9625; val_optim_loss: 12219464.9625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9934; val_auprc_score: 0.9922; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 40262.9948; train_edge_recon_loss: 2598763.2027; train_gene_expr_recon_loss: 9185934.0633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11824960.2643; train_optim_loss: 11824960.2643; val_kl_reg_loss: 39643.2873; val_edge_recon_loss: 2604668.3844; val_gene_expr_recon_loss: 9558988.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12203299.7875; val_optim_loss: 12203299.7875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9934; val_auprc_score: 0.9923; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 40241.0271; train_edge_recon_loss: 2598898.7097; train_gene_expr_recon_loss: 9167541.5146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11806681.2295; train_optim_loss: 11806681.2295; val_kl_reg_loss: 39902.8051; val_edge_recon_loss: 2607212.6281; val_gene_expr_recon_loss: 9554398.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12201514.1875; val_optim_loss: 12201514.1875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 40351.5701; train_edge_recon_loss: 2598955.9830; train_gene_expr_recon_loss: 9171454.0494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11810761.6036; train_optim_loss: 11810761.6036; val_kl_reg_loss: 39919.0607; val_edge_recon_loss: 2605774.0688; val_gene_expr_recon_loss: 9563457.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12209151.0500; val_optim_loss: 12209151.0500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9939; val_auprc_score: 0.9929; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 40347.5168; train_edge_recon_loss: 2598604.9927; train_gene_expr_recon_loss: 9165177.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11804130.3477; train_optim_loss: 11804130.3477; val_kl_reg_loss: 39944.8796; val_edge_recon_loss: 2601800.2125; val_gene_expr_recon_loss: 9560559.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12202304.6500; val_optim_loss: 12202304.6500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9936; val_auprc_score: 0.9925; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 40369.1165; train_edge_recon_loss: 2598879.4211; train_gene_expr_recon_loss: 9167083.9110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11806332.4409; train_optim_loss: 11806332.4409; val_kl_reg_loss: 39870.0278; val_edge_recon_loss: 2603324.6688; val_gene_expr_recon_loss: 9558487.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12201681.8125; val_optim_loss: 12201681.8125

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 282 min 14 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9938
Val AUPRC score: 0.9925
Val best accuracy score: 0.9685
Val best F1 score: 0.9691
Val gene expr MSE score: 0.5878

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
