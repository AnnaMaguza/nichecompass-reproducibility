None
Run timestamp: 25072023_035639_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9888; val_auprc_score: 0.9870; val_best_acc_score: 0.9512; val_best_f1_score: 0.9519; train_kl_reg_loss: 14748.4153; train_edge_recon_loss: 2635537.7296; train_gene_expr_recon_loss: 729123.0237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3379409.1682; train_optim_loss: 3379409.1682; val_kl_reg_loss: 12869.4454; val_edge_recon_loss: 2616442.7509; val_gene_expr_recon_loss: 690810.2228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3320122.4174; val_optim_loss: 3320122.4174
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9911; val_auprc_score: 0.9894; val_best_acc_score: 0.9594; val_best_f1_score: 0.9600; train_kl_reg_loss: 12322.6844; train_edge_recon_loss: 2596974.7131; train_gene_expr_recon_loss: 687602.7961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3296900.1921; train_optim_loss: 3296900.1921; val_kl_reg_loss: 12147.0102; val_edge_recon_loss: 2601250.7998; val_gene_expr_recon_loss: 686310.9601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3299708.7676; val_optim_loss: 3299708.7676
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9929; val_auprc_score: 0.9915; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 11772.1110; train_edge_recon_loss: 2589530.4278; train_gene_expr_recon_loss: 681628.6258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3282931.1633; train_optim_loss: 3282931.1633; val_kl_reg_loss: 11673.4865; val_edge_recon_loss: 2595671.9075; val_gene_expr_recon_loss: 680600.7799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3287946.1715; val_optim_loss: 3287946.1715
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 11535.9518; train_edge_recon_loss: 2585719.3065; train_gene_expr_recon_loss: 679217.5862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3276472.8432; train_optim_loss: 3276472.8432; val_kl_reg_loss: 11441.0503; val_edge_recon_loss: 2592721.4546; val_gene_expr_recon_loss: 678657.0397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282819.5392; val_optim_loss: 3282819.5392
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 11352.6172; train_edge_recon_loss: 2583144.1537; train_gene_expr_recon_loss: 677696.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3272193.7110; train_optim_loss: 3272193.7110; val_kl_reg_loss: 11020.9459; val_edge_recon_loss: 2590046.4909; val_gene_expr_recon_loss: 678249.8706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279317.3021; val_optim_loss: 3279317.3021
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 11226.3328; train_edge_recon_loss: 2580701.2324; train_gene_expr_recon_loss: 676630.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3268558.4890; train_optim_loss: 3268558.4890; val_kl_reg_loss: 10963.8222; val_edge_recon_loss: 2588146.4921; val_gene_expr_recon_loss: 676786.3337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275896.6434; val_optim_loss: 3275896.6434
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9936; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 11123.4595; train_edge_recon_loss: 2579385.7274; train_gene_expr_recon_loss: 675991.5165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3266500.7042; train_optim_loss: 3266500.7042; val_kl_reg_loss: 11085.6245; val_edge_recon_loss: 2585577.0427; val_gene_expr_recon_loss: 676499.6717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273162.3405; val_optim_loss: 3273162.3405
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 11054.0983; train_edge_recon_loss: 2577608.8957; train_gene_expr_recon_loss: 675198.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3263861.9154; train_optim_loss: 3263861.9154; val_kl_reg_loss: 11118.7697; val_edge_recon_loss: 2584429.5345; val_gene_expr_recon_loss: 675899.3522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271447.6578; val_optim_loss: 3271447.6578
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 10993.1770; train_edge_recon_loss: 2577006.9045; train_gene_expr_recon_loss: 674839.3083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3262839.3895; train_optim_loss: 3262839.3895; val_kl_reg_loss: 11136.5214; val_edge_recon_loss: 2584344.9576; val_gene_expr_recon_loss: 675385.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270866.9341; val_optim_loss: 3270866.9341
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 10938.7345; train_edge_recon_loss: 2575966.4361; train_gene_expr_recon_loss: 674552.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261458.0805; train_optim_loss: 3261458.0805; val_kl_reg_loss: 10951.3867; val_edge_recon_loss: 2582405.4368; val_gene_expr_recon_loss: 676376.6478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269733.4731; val_optim_loss: 3269733.4731
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9725; val_best_f1_score: 0.9728; train_kl_reg_loss: 10925.2163; train_edge_recon_loss: 2574340.1651; train_gene_expr_recon_loss: 674455.6980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3259721.0795; train_optim_loss: 3259721.0795; val_kl_reg_loss: 10730.1971; val_edge_recon_loss: 2580415.4605; val_gene_expr_recon_loss: 675613.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266759.1783; val_optim_loss: 3266759.1783
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 10882.9343; train_edge_recon_loss: 2573711.3428; train_gene_expr_recon_loss: 673918.5829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3258512.8599; train_optim_loss: 3258512.8599; val_kl_reg_loss: 10756.4194; val_edge_recon_loss: 2580073.8244; val_gene_expr_recon_loss: 674692.0261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265522.2711; val_optim_loss: 3265522.2711
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 10866.3005; train_edge_recon_loss: 2572709.2356; train_gene_expr_recon_loss: 673694.4165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257269.9551; train_optim_loss: 3257269.9551; val_kl_reg_loss: 11029.9632; val_edge_recon_loss: 2579938.9657; val_gene_expr_recon_loss: 675422.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266391.5138; val_optim_loss: 3266391.5138
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9941; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 10850.0774; train_edge_recon_loss: 2571793.9270; train_gene_expr_recon_loss: 673360.5609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3256004.5667; train_optim_loss: 3256004.5667; val_kl_reg_loss: 10709.3854; val_edge_recon_loss: 2580028.8249; val_gene_expr_recon_loss: 674143.0184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264881.2278; val_optim_loss: 3264881.2278
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 10815.5998; train_edge_recon_loss: 2572005.1233; train_gene_expr_recon_loss: 673452.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3256273.0708; train_optim_loss: 3256273.0708; val_kl_reg_loss: 10939.4551; val_edge_recon_loss: 2578001.9491; val_gene_expr_recon_loss: 673912.2757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262853.6754; val_optim_loss: 3262853.6754
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9938; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 10807.1260; train_edge_recon_loss: 2571347.2765; train_gene_expr_recon_loss: 672980.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3255134.6095; train_optim_loss: 3255134.6095; val_kl_reg_loss: 10698.6126; val_edge_recon_loss: 2576925.3416; val_gene_expr_recon_loss: 674210.1779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261834.1314; val_optim_loss: 3261834.1314
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9938; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 10795.2737; train_edge_recon_loss: 2570391.0243; train_gene_expr_recon_loss: 673195.9272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254382.2253; train_optim_loss: 3254382.2253; val_kl_reg_loss: 10701.5932; val_edge_recon_loss: 2576847.8437; val_gene_expr_recon_loss: 674444.6238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261994.0662; val_optim_loss: 3261994.0662
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 10778.3359; train_edge_recon_loss: 2570592.9551; train_gene_expr_recon_loss: 672907.6647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254278.9574; train_optim_loss: 3254278.9574; val_kl_reg_loss: 10789.4110; val_edge_recon_loss: 2577082.2857; val_gene_expr_recon_loss: 674385.2668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262256.9643; val_optim_loss: 3262256.9643
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 10770.2729; train_edge_recon_loss: 2569968.6360; train_gene_expr_recon_loss: 672755.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253494.1073; train_optim_loss: 3253494.1073; val_kl_reg_loss: 10631.9648; val_edge_recon_loss: 2575470.4333; val_gene_expr_recon_loss: 673826.7643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259929.1639; val_optim_loss: 3259929.1639
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 10772.3405; train_edge_recon_loss: 2569255.9365; train_gene_expr_recon_loss: 672672.9507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252701.2284; train_optim_loss: 3252701.2284; val_kl_reg_loss: 10554.8965; val_edge_recon_loss: 2575229.2430; val_gene_expr_recon_loss: 673773.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259557.5506; val_optim_loss: 3259557.5506
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 10776.3308; train_edge_recon_loss: 2568974.5066; train_gene_expr_recon_loss: 672837.7041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252588.5422; train_optim_loss: 3252588.5422; val_kl_reg_loss: 10753.0838; val_edge_recon_loss: 2574690.5793; val_gene_expr_recon_loss: 674662.6689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260106.3349; val_optim_loss: 3260106.3349
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 10744.2627; train_edge_recon_loss: 2568805.2327; train_gene_expr_recon_loss: 672530.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252079.8911; train_optim_loss: 3252079.8911; val_kl_reg_loss: 10761.2693; val_edge_recon_loss: 2572541.1174; val_gene_expr_recon_loss: 673833.4108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257135.7974; val_optim_loss: 3257135.7974
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 10761.4031; train_edge_recon_loss: 2568119.8790; train_gene_expr_recon_loss: 672416.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251297.2911; train_optim_loss: 3251297.2911; val_kl_reg_loss: 10649.8810; val_edge_recon_loss: 2574596.9845; val_gene_expr_recon_loss: 673176.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258423.1794; val_optim_loss: 3258423.1794
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 10741.7823; train_edge_recon_loss: 2568010.4878; train_gene_expr_recon_loss: 672404.7060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251156.9753; train_optim_loss: 3251156.9753; val_kl_reg_loss: 10664.6004; val_edge_recon_loss: 2574431.3144; val_gene_expr_recon_loss: 673060.4008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258156.3194; val_optim_loss: 3258156.3194
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 10743.4832; train_edge_recon_loss: 2567538.9396; train_gene_expr_recon_loss: 672363.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250646.0130; train_optim_loss: 3250646.0130; val_kl_reg_loss: 10672.6886; val_edge_recon_loss: 2573361.8864; val_gene_expr_recon_loss: 673531.8041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257566.3785; val_optim_loss: 3257566.3785
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 10731.3531; train_edge_recon_loss: 2567528.7545; train_gene_expr_recon_loss: 672280.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250540.7672; train_optim_loss: 3250540.7672; val_kl_reg_loss: 10787.6034; val_edge_recon_loss: 2574058.7954; val_gene_expr_recon_loss: 673623.8023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258470.2008; val_optim_loss: 3258470.2008

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 11160.6373; train_edge_recon_loss: 2564640.2435; train_gene_expr_recon_loss: 665159.4802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240960.3611; train_optim_loss: 3240960.3611; val_kl_reg_loss: 11203.3804; val_edge_recon_loss: 2571575.4532; val_gene_expr_recon_loss: 666103.2479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248882.0799; val_optim_loss: 3248882.0799
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 11287.3395; train_edge_recon_loss: 2564877.9805; train_gene_expr_recon_loss: 664240.9553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240406.2793; train_optim_loss: 3240406.2793; val_kl_reg_loss: 11251.8203; val_edge_recon_loss: 2569049.2799; val_gene_expr_recon_loss: 665516.2330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245817.3343; val_optim_loss: 3245817.3343
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 11295.1270; train_edge_recon_loss: 2564436.4974; train_gene_expr_recon_loss: 663711.6356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239443.2594; train_optim_loss: 3239443.2594; val_kl_reg_loss: 11223.2273; val_edge_recon_loss: 2569567.1642; val_gene_expr_recon_loss: 665582.9997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246373.3893; val_optim_loss: 3246373.3893
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 11316.3498; train_edge_recon_loss: 2563942.9160; train_gene_expr_recon_loss: 663548.2835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238807.5484; train_optim_loss: 3238807.5484; val_kl_reg_loss: 11287.1077; val_edge_recon_loss: 2569607.7734; val_gene_expr_recon_loss: 664904.9689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245799.8498; val_optim_loss: 3245799.8498
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 11305.2348; train_edge_recon_loss: 2563943.2596; train_gene_expr_recon_loss: 663235.4624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238483.9573; train_optim_loss: 3238483.9573; val_kl_reg_loss: 11234.8727; val_edge_recon_loss: 2568986.5460; val_gene_expr_recon_loss: 665508.4888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245729.9081; val_optim_loss: 3245729.9081
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 11286.4082; train_edge_recon_loss: 2563985.8316; train_gene_expr_recon_loss: 663226.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238498.6191; train_optim_loss: 3238498.6191; val_kl_reg_loss: 11217.9567; val_edge_recon_loss: 2568981.2761; val_gene_expr_recon_loss: 664158.1774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244357.4148; val_optim_loss: 3244357.4148
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 11282.9191; train_edge_recon_loss: 2563359.1269; train_gene_expr_recon_loss: 662883.0205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237525.0641; train_optim_loss: 3237525.0641; val_kl_reg_loss: 11174.4016; val_edge_recon_loss: 2570043.7073; val_gene_expr_recon_loss: 664906.1586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246124.2676; val_optim_loss: 3246124.2676
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 11247.6834; train_edge_recon_loss: 2563923.3223; train_gene_expr_recon_loss: 662915.5995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238086.6050; train_optim_loss: 3238086.6050; val_kl_reg_loss: 11270.1042; val_edge_recon_loss: 2570121.7755; val_gene_expr_recon_loss: 664723.6056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246115.4827; val_optim_loss: 3246115.4827
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 11275.5075; train_edge_recon_loss: 2563517.0303; train_gene_expr_recon_loss: 662818.7321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237611.2703; train_optim_loss: 3237611.2703; val_kl_reg_loss: 11203.9149; val_edge_recon_loss: 2568441.6145; val_gene_expr_recon_loss: 664335.4982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243981.0310; val_optim_loss: 3243981.0310
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 11248.8608; train_edge_recon_loss: 2563784.2319; train_gene_expr_recon_loss: 662688.5552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237721.6467; train_optim_loss: 3237721.6467; val_kl_reg_loss: 11210.0822; val_edge_recon_loss: 2569251.8905; val_gene_expr_recon_loss: 664680.7645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245142.7351; val_optim_loss: 3245142.7351
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 11236.5886; train_edge_recon_loss: 2563315.6194; train_gene_expr_recon_loss: 662616.6690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237168.8769; train_optim_loss: 3237168.8769; val_kl_reg_loss: 11173.2085; val_edge_recon_loss: 2566524.0141; val_gene_expr_recon_loss: 664044.3775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241741.6028; val_optim_loss: 3241741.6028
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 11228.4470; train_edge_recon_loss: 2563257.3625; train_gene_expr_recon_loss: 662325.5181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236811.3278; train_optim_loss: 3236811.3278; val_kl_reg_loss: 11131.4841; val_edge_recon_loss: 2569748.1680; val_gene_expr_recon_loss: 664225.8427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245105.4933; val_optim_loss: 3245105.4933
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 11227.8147; train_edge_recon_loss: 2563505.8159; train_gene_expr_recon_loss: 662349.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237082.7705; train_optim_loss: 3237082.7705; val_kl_reg_loss: 11217.2547; val_edge_recon_loss: 2568685.7535; val_gene_expr_recon_loss: 663971.8675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243874.8721; val_optim_loss: 3243874.8721
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 11219.9356; train_edge_recon_loss: 2563305.0327; train_gene_expr_recon_loss: 662212.5419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236737.5117; train_optim_loss: 3236737.5117; val_kl_reg_loss: 11117.1802; val_edge_recon_loss: 2569010.4324; val_gene_expr_recon_loss: 664536.4331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244664.0492; val_optim_loss: 3244664.0492
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 11206.9165; train_edge_recon_loss: 2563330.0213; train_gene_expr_recon_loss: 662088.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236625.4241; train_optim_loss: 3236625.4241; val_kl_reg_loss: 11160.9615; val_edge_recon_loss: 2567747.0902; val_gene_expr_recon_loss: 663773.7508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242681.8001; val_optim_loss: 3242681.8001

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 11225.3639; train_edge_recon_loss: 2562654.7299; train_gene_expr_recon_loss: 661423.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235303.3141; train_optim_loss: 3235303.3141; val_kl_reg_loss: 11161.4769; val_edge_recon_loss: 2568966.7781; val_gene_expr_recon_loss: 663153.8384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243282.0864; val_optim_loss: 3243282.0864
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 11245.7900; train_edge_recon_loss: 2562898.5052; train_gene_expr_recon_loss: 661230.7365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235375.0311; train_optim_loss: 3235375.0311; val_kl_reg_loss: 11173.7102; val_edge_recon_loss: 2566756.8709; val_gene_expr_recon_loss: 663209.4939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241140.0752; val_optim_loss: 3241140.0752
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 11247.4652; train_edge_recon_loss: 2562955.0817; train_gene_expr_recon_loss: 661177.5527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235380.0990; train_optim_loss: 3235380.0990; val_kl_reg_loss: 11184.6573; val_edge_recon_loss: 2568898.7535; val_gene_expr_recon_loss: 663562.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243646.1674; val_optim_loss: 3243646.1674
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 11253.3166; train_edge_recon_loss: 2562642.9556; train_gene_expr_recon_loss: 661159.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235056.2058; train_optim_loss: 3235056.2058; val_kl_reg_loss: 11185.3007; val_edge_recon_loss: 2568001.7020; val_gene_expr_recon_loss: 663437.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242624.1130; val_optim_loss: 3242624.1130
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 11247.2703; train_edge_recon_loss: 2562669.1170; train_gene_expr_recon_loss: 661173.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235090.0265; train_optim_loss: 3235090.0265; val_kl_reg_loss: 11207.3649; val_edge_recon_loss: 2567897.1262; val_gene_expr_recon_loss: 663482.4280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242586.9259; val_optim_loss: 3242586.9259
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 11260.9107; train_edge_recon_loss: 2563049.7419; train_gene_expr_recon_loss: 661102.9827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235413.6351; train_optim_loss: 3235413.6351; val_kl_reg_loss: 11203.9062; val_edge_recon_loss: 2568501.8721; val_gene_expr_recon_loss: 663550.8302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243256.6066; val_optim_loss: 3243256.6066

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 11273.2974; train_edge_recon_loss: 2562240.2837; train_gene_expr_recon_loss: 661107.7491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234621.3295; train_optim_loss: 3234621.3295; val_kl_reg_loss: 11211.4602; val_edge_recon_loss: 2567789.2421; val_gene_expr_recon_loss: 663104.8290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242105.5255; val_optim_loss: 3242105.5255
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 11271.3306; train_edge_recon_loss: 2562601.4517; train_gene_expr_recon_loss: 661134.6338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235007.4156; train_optim_loss: 3235007.4156; val_kl_reg_loss: 11206.7361; val_edge_recon_loss: 2568111.7506; val_gene_expr_recon_loss: 662853.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242172.0694; val_optim_loss: 3242172.0694
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 11274.1615; train_edge_recon_loss: 2562762.7881; train_gene_expr_recon_loss: 661024.6526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235061.6032; train_optim_loss: 3235061.6032; val_kl_reg_loss: 11231.8641; val_edge_recon_loss: 2568022.3604; val_gene_expr_recon_loss: 662821.6456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242075.8691; val_optim_loss: 3242075.8691
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 11267.2134; train_edge_recon_loss: 2562865.3799; train_gene_expr_recon_loss: 661038.5689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235171.1611; train_optim_loss: 3235171.1611; val_kl_reg_loss: 11208.0355; val_edge_recon_loss: 2568138.6352; val_gene_expr_recon_loss: 663062.1590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242408.8214; val_optim_loss: 3242408.8214

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 846 min 39 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9958
Val AUPRC score: 0.9947
Val best accuracy score: 0.9777
Val best F1 score: 0.9780
Val gene expr MSE score: 1.7589

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
