None
Run timestamp: 15082023_115746_61.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '10.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_61']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9768; val_auprc_score: 0.9669; val_best_acc_score: 0.9390; val_best_f1_score: 0.9409; train_kl_reg_loss: 7630.5373; train_edge_recon_loss: 269841.6431; train_gene_expr_recon_loss: 213377.8885; train_masked_gp_l1_reg_loss: 1224.1372; train_group_lasso_reg_loss: 2198.3451; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 494272.5510; train_optim_loss: 494272.5510; val_kl_reg_loss: 7299.7909; val_edge_recon_loss: 263984.7393; val_gene_expr_recon_loss: 198973.4982; val_masked_gp_l1_reg_loss: 1378.0642; val_group_lasso_reg_loss: 2646.2183; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 474282.3092; val_optim_loss: 474282.3092
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9810; val_auprc_score: 0.9720; val_best_acc_score: 0.9496; val_best_f1_score: 0.9509; train_kl_reg_loss: 7523.2448; train_edge_recon_loss: 261533.9072; train_gene_expr_recon_loss: 192130.2785; train_masked_gp_l1_reg_loss: 1456.1076; train_group_lasso_reg_loss: 2843.6004; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 465487.1394; train_optim_loss: 465487.1394; val_kl_reg_loss: 7178.3106; val_edge_recon_loss: 261913.7945; val_gene_expr_recon_loss: 189844.6455; val_masked_gp_l1_reg_loss: 1514.5807; val_group_lasso_reg_loss: 2992.1597; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 463443.5015; val_optim_loss: 463443.5015
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9820; val_auprc_score: 0.9744; val_best_acc_score: 0.9522; val_best_f1_score: 0.9535; train_kl_reg_loss: 7311.1007; train_edge_recon_loss: 260607.5188; train_gene_expr_recon_loss: 185601.5008; train_masked_gp_l1_reg_loss: 1535.0017; train_group_lasso_reg_loss: 3060.6321; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 458115.7548; train_optim_loss: 458115.7548; val_kl_reg_loss: 7057.1741; val_edge_recon_loss: 261982.2698; val_gene_expr_recon_loss: 184951.1417; val_masked_gp_l1_reg_loss: 1548.9081; val_group_lasso_reg_loss: 3098.1973; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 458637.6810; val_optim_loss: 458637.6810
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9836; val_auprc_score: 0.9766; val_best_acc_score: 0.9561; val_best_f1_score: 0.9573; train_kl_reg_loss: 7164.9115; train_edge_recon_loss: 260067.1786; train_gene_expr_recon_loss: 182108.9519; train_masked_gp_l1_reg_loss: 1531.5750; train_group_lasso_reg_loss: 3092.4310; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 453965.0482; train_optim_loss: 453965.0482; val_kl_reg_loss: 6972.8737; val_edge_recon_loss: 261389.4537; val_gene_expr_recon_loss: 182478.3347; val_masked_gp_l1_reg_loss: 1519.1028; val_group_lasso_reg_loss: 3086.4443; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455446.1908; val_optim_loss: 455446.1908
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9852; val_auprc_score: 0.9794; val_best_acc_score: 0.9574; val_best_f1_score: 0.9586; train_kl_reg_loss: 7057.3606; train_edge_recon_loss: 259894.8548; train_gene_expr_recon_loss: 180077.7287; train_masked_gp_l1_reg_loss: 1500.1224; train_group_lasso_reg_loss: 3064.7865; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 451594.8514; train_optim_loss: 451594.8514; val_kl_reg_loss: 6863.4470; val_edge_recon_loss: 261444.4293; val_gene_expr_recon_loss: 180822.8612; val_masked_gp_l1_reg_loss: 1476.4700; val_group_lasso_reg_loss: 3031.3916; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 453638.6141; val_optim_loss: 453638.6141
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9845; val_auprc_score: 0.9783; val_best_acc_score: 0.9578; val_best_f1_score: 0.9588; train_kl_reg_loss: 6983.4649; train_edge_recon_loss: 259357.7418; train_gene_expr_recon_loss: 178941.6215; train_masked_gp_l1_reg_loss: 1455.8076; train_group_lasso_reg_loss: 3002.9033; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449741.5394; train_optim_loss: 449741.5394; val_kl_reg_loss: 6905.4917; val_edge_recon_loss: 261612.2823; val_gene_expr_recon_loss: 180648.1503; val_masked_gp_l1_reg_loss: 1435.3916; val_group_lasso_reg_loss: 2970.4197; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 453571.7362; val_optim_loss: 453571.7362
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9842; val_auprc_score: 0.9773; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 6919.6513; train_edge_recon_loss: 259121.8579; train_gene_expr_recon_loss: 178102.7975; train_masked_gp_l1_reg_loss: 1420.3719; train_group_lasso_reg_loss: 2940.7462; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448505.4253; train_optim_loss: 448505.4253; val_kl_reg_loss: 6764.2541; val_edge_recon_loss: 261245.4079; val_gene_expr_recon_loss: 180048.6795; val_masked_gp_l1_reg_loss: 1409.0802; val_group_lasso_reg_loss: 2913.4927; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 452380.9360; val_optim_loss: 452380.9360
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9856; val_auprc_score: 0.9790; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 6877.6449; train_edge_recon_loss: 258825.7229; train_gene_expr_recon_loss: 177674.8383; train_masked_gp_l1_reg_loss: 1403.8594; train_group_lasso_reg_loss: 2892.1457; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447674.2119; train_optim_loss: 447674.2119; val_kl_reg_loss: 6620.1811; val_edge_recon_loss: 260568.3385; val_gene_expr_recon_loss: 179166.7039; val_masked_gp_l1_reg_loss: 1397.1409; val_group_lasso_reg_loss: 2870.2122; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450622.5992; val_optim_loss: 450622.5992
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9863; val_auprc_score: 0.9808; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 6839.4309; train_edge_recon_loss: 258794.8214; train_gene_expr_recon_loss: 177317.8700; train_masked_gp_l1_reg_loss: 1395.0711; train_group_lasso_reg_loss: 2855.2779; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447202.4713; train_optim_loss: 447202.4713; val_kl_reg_loss: 6791.0802; val_edge_recon_loss: 260945.4379; val_gene_expr_recon_loss: 179272.2553; val_masked_gp_l1_reg_loss: 1396.8523; val_group_lasso_reg_loss: 2844.5081; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451250.1152; val_optim_loss: 451250.1152
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9870; val_auprc_score: 0.9817; val_best_acc_score: 0.9635; val_best_f1_score: 0.9644; train_kl_reg_loss: 6826.8823; train_edge_recon_loss: 258757.4739; train_gene_expr_recon_loss: 176950.6519; train_masked_gp_l1_reg_loss: 1393.8822; train_group_lasso_reg_loss: 2840.6324; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446769.5219; train_optim_loss: 446769.5219; val_kl_reg_loss: 6677.5336; val_edge_recon_loss: 260517.3145; val_gene_expr_recon_loss: 178674.5031; val_masked_gp_l1_reg_loss: 1393.9724; val_group_lasso_reg_loss: 2834.4265; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450097.7576; val_optim_loss: 450097.7576
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9881; val_auprc_score: 0.9836; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 6799.5475; train_edge_recon_loss: 258596.8782; train_gene_expr_recon_loss: 176895.0356; train_masked_gp_l1_reg_loss: 1393.4253; train_group_lasso_reg_loss: 2829.1979; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446514.0842; train_optim_loss: 446514.0842; val_kl_reg_loss: 6687.5225; val_edge_recon_loss: 260302.4658; val_gene_expr_recon_loss: 178660.3468; val_masked_gp_l1_reg_loss: 1396.5959; val_group_lasso_reg_loss: 2828.8135; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449875.7409; val_optim_loss: 449875.7409
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9883; val_auprc_score: 0.9835; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 6788.4043; train_edge_recon_loss: 258559.6324; train_gene_expr_recon_loss: 176580.2655; train_masked_gp_l1_reg_loss: 1395.7690; train_group_lasso_reg_loss: 2829.5766; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446153.6480; train_optim_loss: 446153.6480; val_kl_reg_loss: 6776.7151; val_edge_recon_loss: 259567.4533; val_gene_expr_recon_loss: 178680.8359; val_masked_gp_l1_reg_loss: 1401.1976; val_group_lasso_reg_loss: 2834.3481; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449260.5374; val_optim_loss: 449260.5374
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9878; val_auprc_score: 0.9827; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 6787.9641; train_edge_recon_loss: 258360.2002; train_gene_expr_recon_loss: 176380.8306; train_masked_gp_l1_reg_loss: 1401.2764; train_group_lasso_reg_loss: 2834.2820; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445764.5530; train_optim_loss: 445764.5530; val_kl_reg_loss: 6718.7288; val_edge_recon_loss: 260302.1448; val_gene_expr_recon_loss: 178258.2796; val_masked_gp_l1_reg_loss: 1397.8912; val_group_lasso_reg_loss: 2827.4412; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449504.4967; val_optim_loss: 449504.4967
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9892; val_auprc_score: 0.9852; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 6778.4073; train_edge_recon_loss: 258267.0007; train_gene_expr_recon_loss: 176348.3944; train_masked_gp_l1_reg_loss: 1403.9243; train_group_lasso_reg_loss: 2834.9338; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445632.6588; train_optim_loss: 445632.6588; val_kl_reg_loss: 6713.8564; val_edge_recon_loss: 259593.9891; val_gene_expr_recon_loss: 178325.9715; val_masked_gp_l1_reg_loss: 1405.9192; val_group_lasso_reg_loss: 2839.8718; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448879.5977; val_optim_loss: 448879.5977
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9890; val_auprc_score: 0.9848; val_best_acc_score: 0.9670; val_best_f1_score: 0.9677; train_kl_reg_loss: 6758.0179; train_edge_recon_loss: 258340.0781; train_gene_expr_recon_loss: 176230.0223; train_masked_gp_l1_reg_loss: 1408.1429; train_group_lasso_reg_loss: 2843.8271; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445580.0875; train_optim_loss: 445580.0875; val_kl_reg_loss: 6540.6214; val_edge_recon_loss: 259677.6277; val_gene_expr_recon_loss: 178375.0905; val_masked_gp_l1_reg_loss: 1406.9082; val_group_lasso_reg_loss: 2841.8403; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448842.0905; val_optim_loss: 448842.0905
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9882; val_auprc_score: 0.9835; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 6762.6533; train_edge_recon_loss: 258241.4497; train_gene_expr_recon_loss: 176057.5133; train_masked_gp_l1_reg_loss: 1411.3552; train_group_lasso_reg_loss: 2850.7165; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445323.6882; train_optim_loss: 445323.6882; val_kl_reg_loss: 6678.1516; val_edge_recon_loss: 260308.5665; val_gene_expr_recon_loss: 178176.3957; val_masked_gp_l1_reg_loss: 1415.7791; val_group_lasso_reg_loss: 2862.2458; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449441.1450; val_optim_loss: 449441.1450
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9894; val_auprc_score: 0.9854; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 6750.9932; train_edge_recon_loss: 258334.1507; train_gene_expr_recon_loss: 176095.1070; train_masked_gp_l1_reg_loss: 1414.2441; train_group_lasso_reg_loss: 2858.6517; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445453.1456; train_optim_loss: 445453.1456; val_kl_reg_loss: 6712.1104; val_edge_recon_loss: 259388.7017; val_gene_expr_recon_loss: 178453.3765; val_masked_gp_l1_reg_loss: 1412.5012; val_group_lasso_reg_loss: 2861.6265; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448828.3140; val_optim_loss: 448828.3140
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9893; val_auprc_score: 0.9851; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 6762.1868; train_edge_recon_loss: 258072.9945; train_gene_expr_recon_loss: 176037.0550; train_masked_gp_l1_reg_loss: 1417.3460; train_group_lasso_reg_loss: 2863.3355; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445152.9188; train_optim_loss: 445152.9188; val_kl_reg_loss: 6725.8385; val_edge_recon_loss: 259985.6003; val_gene_expr_recon_loss: 177970.9251; val_masked_gp_l1_reg_loss: 1420.5370; val_group_lasso_reg_loss: 2863.1641; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448966.0531; val_optim_loss: 448966.0531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9904; val_auprc_score: 0.9864; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 6743.0854; train_edge_recon_loss: 258329.6673; train_gene_expr_recon_loss: 175976.5369; train_masked_gp_l1_reg_loss: 1421.4140; train_group_lasso_reg_loss: 2873.9302; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445344.6332; train_optim_loss: 445344.6332; val_kl_reg_loss: 6665.7474; val_edge_recon_loss: 259377.4262; val_gene_expr_recon_loss: 178193.7934; val_masked_gp_l1_reg_loss: 1422.8816; val_group_lasso_reg_loss: 2878.5205; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448538.3725; val_optim_loss: 448538.3725
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9902; val_auprc_score: 0.9860; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 6747.1034; train_edge_recon_loss: 258085.3318; train_gene_expr_recon_loss: 175835.3063; train_masked_gp_l1_reg_loss: 1423.7137; train_group_lasso_reg_loss: 2881.0233; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444972.4794; train_optim_loss: 444972.4794; val_kl_reg_loss: 6572.1460; val_edge_recon_loss: 259655.2447; val_gene_expr_recon_loss: 177712.0105; val_masked_gp_l1_reg_loss: 1420.3623; val_group_lasso_reg_loss: 2878.2642; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448238.0294; val_optim_loss: 448238.0294
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9890; val_auprc_score: 0.9843; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 6737.6128; train_edge_recon_loss: 258183.9372; train_gene_expr_recon_loss: 175782.9355; train_masked_gp_l1_reg_loss: 1422.0888; train_group_lasso_reg_loss: 2879.4447; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445006.0191; train_optim_loss: 445006.0191; val_kl_reg_loss: 6647.6074; val_edge_recon_loss: 260255.2912; val_gene_expr_recon_loss: 178629.7004; val_masked_gp_l1_reg_loss: 1425.0254; val_group_lasso_reg_loss: 2888.1394; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449845.7551; val_optim_loss: 449845.7551
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9904; val_auprc_score: 0.9868; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 6742.9278; train_edge_recon_loss: 258071.8743; train_gene_expr_recon_loss: 175736.0680; train_masked_gp_l1_reg_loss: 1424.3018; train_group_lasso_reg_loss: 2884.4270; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444859.5995; train_optim_loss: 444859.5995; val_kl_reg_loss: 6652.0735; val_edge_recon_loss: 259409.0578; val_gene_expr_recon_loss: 178390.9141; val_masked_gp_l1_reg_loss: 1430.7111; val_group_lasso_reg_loss: 2894.2822; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448777.0451; val_optim_loss: 448777.0451
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9906; val_auprc_score: 0.9870; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 6747.1155; train_edge_recon_loss: 257976.9368; train_gene_expr_recon_loss: 175872.6240; train_masked_gp_l1_reg_loss: 1425.9134; train_group_lasso_reg_loss: 2891.1884; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444913.7782; train_optim_loss: 444913.7782; val_kl_reg_loss: 6692.4776; val_edge_recon_loss: 260002.5905; val_gene_expr_recon_loss: 178239.1077; val_masked_gp_l1_reg_loss: 1425.3674; val_group_lasso_reg_loss: 2892.7974; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449252.3634; val_optim_loss: 449252.3634
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9912; val_auprc_score: 0.9879; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 6740.6280; train_edge_recon_loss: 257971.9998; train_gene_expr_recon_loss: 175584.8904; train_masked_gp_l1_reg_loss: 1428.1440; train_group_lasso_reg_loss: 2897.6835; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444623.3460; train_optim_loss: 444623.3460; val_kl_reg_loss: 6683.3692; val_edge_recon_loss: 259237.9895; val_gene_expr_recon_loss: 177842.2753; val_masked_gp_l1_reg_loss: 1427.0889; val_group_lasso_reg_loss: 2893.9546; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448084.6962; val_optim_loss: 448084.6962
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9901; val_auprc_score: 0.9863; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 6749.1243; train_edge_recon_loss: 257748.5282; train_gene_expr_recon_loss: 175596.4658; train_masked_gp_l1_reg_loss: 1426.4902; train_group_lasso_reg_loss: 2895.9610; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444416.5696; train_optim_loss: 444416.5696; val_kl_reg_loss: 6749.2122; val_edge_recon_loss: 259385.8817; val_gene_expr_recon_loss: 177883.5365; val_masked_gp_l1_reg_loss: 1430.0405; val_group_lasso_reg_loss: 2906.7583; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448355.4117; val_optim_loss: 448355.4117
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9801; val_auprc_score: 0.9696; val_best_acc_score: 0.9519; val_best_f1_score: 0.9531; train_kl_reg_loss: 1931.7333; train_edge_recon_loss: 259333.5747; train_gene_expr_recon_loss: 91473.4122; train_masked_gp_l1_reg_loss: 875.2397; train_group_lasso_reg_loss: 1490.9655; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355104.9253; train_optim_loss: 355104.9253; val_kl_reg_loss: 953.1439; val_edge_recon_loss: 260316.9126; val_gene_expr_recon_loss: 91345.2903; val_masked_gp_l1_reg_loss: 676.2805; val_group_lasso_reg_loss: 876.3898; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354168.0044; val_optim_loss: 354168.0044
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9824; val_auprc_score: 0.9738; val_best_acc_score: 0.9539; val_best_f1_score: 0.9550; train_kl_reg_loss: 1313.2565; train_edge_recon_loss: 257772.3980; train_gene_expr_recon_loss: 90074.2383; train_masked_gp_l1_reg_loss: 630.8366; train_group_lasso_reg_loss: 778.2955; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350569.0252; train_optim_loss: 350569.0252; val_kl_reg_loss: 963.1925; val_edge_recon_loss: 259698.6415; val_gene_expr_recon_loss: 90766.2119; val_masked_gp_l1_reg_loss: 602.0051; val_group_lasso_reg_loss: 740.4080; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352770.4528; val_optim_loss: 352770.4528
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9819; val_auprc_score: 0.9734; val_best_acc_score: 0.9535; val_best_f1_score: 0.9546; train_kl_reg_loss: 1218.9609; train_edge_recon_loss: 257648.4172; train_gene_expr_recon_loss: 89582.5844; train_masked_gp_l1_reg_loss: 585.7896; train_group_lasso_reg_loss: 728.2386; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349763.9901; train_optim_loss: 349763.9901; val_kl_reg_loss: 933.3883; val_edge_recon_loss: 259637.7048; val_gene_expr_recon_loss: 90386.9044; val_masked_gp_l1_reg_loss: 575.6860; val_group_lasso_reg_loss: 722.4696; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352256.1548; val_optim_loss: 352256.1548
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9819; val_auprc_score: 0.9729; val_best_acc_score: 0.9541; val_best_f1_score: 0.9553; train_kl_reg_loss: 1142.1622; train_edge_recon_loss: 257492.8109; train_gene_expr_recon_loss: 89407.5933; train_masked_gp_l1_reg_loss: 574.1160; train_group_lasso_reg_loss: 723.9393; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349340.6216; train_optim_loss: 349340.6216; val_kl_reg_loss: 940.6214; val_edge_recon_loss: 259537.4400; val_gene_expr_recon_loss: 90409.2845; val_masked_gp_l1_reg_loss: 572.4960; val_group_lasso_reg_loss: 724.8479; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 352184.6922; val_optim_loss: 352184.6922
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9837; val_auprc_score: 0.9752; val_best_acc_score: 0.9577; val_best_f1_score: 0.9588; train_kl_reg_loss: 1085.4224; train_edge_recon_loss: 257257.8434; train_gene_expr_recon_loss: 89324.0566; train_masked_gp_l1_reg_loss: 570.6969; train_group_lasso_reg_loss: 725.1724; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348963.1914; train_optim_loss: 348963.1914; val_kl_reg_loss: 959.4469; val_edge_recon_loss: 258350.1257; val_gene_expr_recon_loss: 90443.3404; val_masked_gp_l1_reg_loss: 568.6621; val_group_lasso_reg_loss: 724.7999; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351046.3823; val_optim_loss: 351046.3823
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9823; val_auprc_score: 0.9735; val_best_acc_score: 0.9561; val_best_f1_score: 0.9573; train_kl_reg_loss: 1051.7535; train_edge_recon_loss: 257189.9430; train_gene_expr_recon_loss: 89285.2404; train_masked_gp_l1_reg_loss: 569.6687; train_group_lasso_reg_loss: 727.1745; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348823.7804; train_optim_loss: 348823.7804; val_kl_reg_loss: 969.4913; val_edge_recon_loss: 258614.8045; val_gene_expr_recon_loss: 90239.1259; val_masked_gp_l1_reg_loss: 570.2621; val_group_lasso_reg_loss: 728.5411; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351122.2039; val_optim_loss: 351122.2039
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9832; val_auprc_score: 0.9746; val_best_acc_score: 0.9579; val_best_f1_score: 0.9590; train_kl_reg_loss: 1034.1825; train_edge_recon_loss: 256967.9804; train_gene_expr_recon_loss: 89202.1953; train_masked_gp_l1_reg_loss: 571.6037; train_group_lasso_reg_loss: 730.8590; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348506.8201; train_optim_loss: 348506.8201; val_kl_reg_loss: 944.8694; val_edge_recon_loss: 258609.2963; val_gene_expr_recon_loss: 90115.3902; val_masked_gp_l1_reg_loss: 574.7769; val_group_lasso_reg_loss: 735.1074; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350979.4313; val_optim_loss: 350979.4313
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9828; val_auprc_score: 0.9747; val_best_acc_score: 0.9554; val_best_f1_score: 0.9567; train_kl_reg_loss: 1002.7362; train_edge_recon_loss: 257092.7913; train_gene_expr_recon_loss: 89175.5913; train_masked_gp_l1_reg_loss: 577.6738; train_group_lasso_reg_loss: 738.8197; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348587.6128; train_optim_loss: 348587.6128; val_kl_reg_loss: 926.2519; val_edge_recon_loss: 259368.8984; val_gene_expr_recon_loss: 90264.7439; val_masked_gp_l1_reg_loss: 579.2327; val_group_lasso_reg_loss: 741.2281; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351880.3299; val_optim_loss: 351880.3299
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9835; val_auprc_score: 0.9757; val_best_acc_score: 0.9575; val_best_f1_score: 0.9587; train_kl_reg_loss: 986.0231; train_edge_recon_loss: 257007.0678; train_gene_expr_recon_loss: 89108.0139; train_masked_gp_l1_reg_loss: 581.7948; train_group_lasso_reg_loss: 744.5518; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348427.4532; train_optim_loss: 348427.4532; val_kl_reg_loss: 935.6938; val_edge_recon_loss: 258919.7244; val_gene_expr_recon_loss: 90278.4928; val_masked_gp_l1_reg_loss: 583.7750; val_group_lasso_reg_loss: 747.5054; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351465.1930; val_optim_loss: 351465.1930
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9833; val_auprc_score: 0.9752; val_best_acc_score: 0.9583; val_best_f1_score: 0.9593; train_kl_reg_loss: 979.5125; train_edge_recon_loss: 256838.3207; train_gene_expr_recon_loss: 89196.5629; train_masked_gp_l1_reg_loss: 584.9471; train_group_lasso_reg_loss: 748.8863; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348348.2309; train_optim_loss: 348348.2309; val_kl_reg_loss: 952.8155; val_edge_recon_loss: 258842.3794; val_gene_expr_recon_loss: 90215.4940; val_masked_gp_l1_reg_loss: 586.6916; val_group_lasso_reg_loss: 750.3339; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351347.7202; val_optim_loss: 351347.7202
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9813; val_auprc_score: 0.9725; val_best_acc_score: 0.9551; val_best_f1_score: 0.9563; train_kl_reg_loss: 997.6513; train_edge_recon_loss: 257104.9368; train_gene_expr_recon_loss: 89089.8475; train_masked_gp_l1_reg_loss: 587.1401; train_group_lasso_reg_loss: 751.8415; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348531.4173; train_optim_loss: 348531.4173; val_kl_reg_loss: 906.8690; val_edge_recon_loss: 258813.5131; val_gene_expr_recon_loss: 90075.1190; val_masked_gp_l1_reg_loss: 587.7206; val_group_lasso_reg_loss: 754.0038; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351137.2213; val_optim_loss: 351137.2213

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9829; val_auprc_score: 0.9748; val_best_acc_score: 0.9556; val_best_f1_score: 0.9569; train_kl_reg_loss: 987.8445; train_edge_recon_loss: 257131.4863; train_gene_expr_recon_loss: 88965.9463; train_masked_gp_l1_reg_loss: 565.5725; train_group_lasso_reg_loss: 730.1211; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348380.9694; train_optim_loss: 348380.9694; val_kl_reg_loss: 899.5419; val_edge_recon_loss: 259239.3981; val_gene_expr_recon_loss: 90269.8757; val_masked_gp_l1_reg_loss: 565.5561; val_group_lasso_reg_loss: 730.1539; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351704.5316; val_optim_loss: 351704.5316
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9833; val_auprc_score: 0.9759; val_best_acc_score: 0.9565; val_best_f1_score: 0.9577; train_kl_reg_loss: 985.8500; train_edge_recon_loss: 256960.9467; train_gene_expr_recon_loss: 88902.4257; train_masked_gp_l1_reg_loss: 566.2887; train_group_lasso_reg_loss: 731.1111; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348146.6230; train_optim_loss: 348146.6230; val_kl_reg_loss: 899.1077; val_edge_recon_loss: 258723.7644; val_gene_expr_recon_loss: 89959.6340; val_masked_gp_l1_reg_loss: 566.6511; val_group_lasso_reg_loss: 731.6146; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350880.7878; val_optim_loss: 350880.7878
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9836; val_auprc_score: 0.9763; val_best_acc_score: 0.9561; val_best_f1_score: 0.9572; train_kl_reg_loss: 981.6566; train_edge_recon_loss: 257143.7752; train_gene_expr_recon_loss: 88828.5076; train_masked_gp_l1_reg_loss: 567.1869; train_group_lasso_reg_loss: 732.3840; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348253.5109; train_optim_loss: 348253.5109; val_kl_reg_loss: 899.6057; val_edge_recon_loss: 258592.8986; val_gene_expr_recon_loss: 89979.2270; val_masked_gp_l1_reg_loss: 568.1600; val_group_lasso_reg_loss: 733.5503; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350773.4473; val_optim_loss: 350773.4473
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9839; val_auprc_score: 0.9769; val_best_acc_score: 0.9567; val_best_f1_score: 0.9578; train_kl_reg_loss: 977.6520; train_edge_recon_loss: 256957.5183; train_gene_expr_recon_loss: 88878.6989; train_masked_gp_l1_reg_loss: 568.2260; train_group_lasso_reg_loss: 733.7551; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348115.8508; train_optim_loss: 348115.8508; val_kl_reg_loss: 905.9075; val_edge_recon_loss: 258265.6306; val_gene_expr_recon_loss: 89931.9678; val_masked_gp_l1_reg_loss: 568.3920; val_group_lasso_reg_loss: 734.1548; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350406.0694; val_optim_loss: 350406.0694
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9832; val_auprc_score: 0.9749; val_best_acc_score: 0.9565; val_best_f1_score: 0.9576; train_kl_reg_loss: 975.0698; train_edge_recon_loss: 257093.9078; train_gene_expr_recon_loss: 88886.1430; train_masked_gp_l1_reg_loss: 569.1719; train_group_lasso_reg_loss: 735.0595; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348259.3524; train_optim_loss: 348259.3524; val_kl_reg_loss: 900.8136; val_edge_recon_loss: 258988.3301; val_gene_expr_recon_loss: 89898.9696; val_masked_gp_l1_reg_loss: 569.5179; val_group_lasso_reg_loss: 735.4407; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351093.0832; val_optim_loss: 351093.0832
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9830; val_auprc_score: 0.9754; val_best_acc_score: 0.9550; val_best_f1_score: 0.9562; train_kl_reg_loss: 964.7077; train_edge_recon_loss: 257043.1223; train_gene_expr_recon_loss: 88849.0199; train_masked_gp_l1_reg_loss: 569.9196; train_group_lasso_reg_loss: 735.9376; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348162.7068; train_optim_loss: 348162.7068; val_kl_reg_loss: 901.6825; val_edge_recon_loss: 259220.0767; val_gene_expr_recon_loss: 90107.1651; val_masked_gp_l1_reg_loss: 570.6232; val_group_lasso_reg_loss: 736.6693; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351536.2068; val_optim_loss: 351536.2068
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9831; val_auprc_score: 0.9753; val_best_acc_score: 0.9547; val_best_f1_score: 0.9560; train_kl_reg_loss: 958.0981; train_edge_recon_loss: 256908.4443; train_gene_expr_recon_loss: 88855.9022; train_masked_gp_l1_reg_loss: 570.5950; train_group_lasso_reg_loss: 736.6991; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348029.7390; train_optim_loss: 348029.7390; val_kl_reg_loss: 910.6202; val_edge_recon_loss: 259107.8930; val_gene_expr_recon_loss: 90022.8940; val_masked_gp_l1_reg_loss: 570.5414; val_group_lasso_reg_loss: 736.7475; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351348.6897; val_optim_loss: 351348.6897
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9830; val_auprc_score: 0.9748; val_best_acc_score: 0.9555; val_best_f1_score: 0.9567; train_kl_reg_loss: 953.0249; train_edge_recon_loss: 257052.8863; train_gene_expr_recon_loss: 88847.3844; train_masked_gp_l1_reg_loss: 570.9486; train_group_lasso_reg_loss: 737.0619; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348161.3065; train_optim_loss: 348161.3065; val_kl_reg_loss: 905.9462; val_edge_recon_loss: 258777.3841; val_gene_expr_recon_loss: 90173.6424; val_masked_gp_l1_reg_loss: 571.1119; val_group_lasso_reg_loss: 737.2413; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351165.3463; val_optim_loss: 351165.3463

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9834; val_auprc_score: 0.9763; val_best_acc_score: 0.9544; val_best_f1_score: 0.9557; train_kl_reg_loss: 948.3624; train_edge_recon_loss: 256955.6342; train_gene_expr_recon_loss: 88705.1132; train_masked_gp_l1_reg_loss: 568.2996; train_group_lasso_reg_loss: 734.3399; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347911.7504; train_optim_loss: 347911.7504; val_kl_reg_loss: 906.4271; val_edge_recon_loss: 259044.0692; val_gene_expr_recon_loss: 90024.7344; val_masked_gp_l1_reg_loss: 568.2902; val_group_lasso_reg_loss: 734.3326; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351277.8550; val_optim_loss: 351277.8550
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9831; val_auprc_score: 0.9749; val_best_acc_score: 0.9553; val_best_f1_score: 0.9563; train_kl_reg_loss: 948.2290; train_edge_recon_loss: 257041.3927; train_gene_expr_recon_loss: 88781.6087; train_masked_gp_l1_reg_loss: 568.3224; train_group_lasso_reg_loss: 734.3802; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348073.9332; train_optim_loss: 348073.9332; val_kl_reg_loss: 907.3624; val_edge_recon_loss: 258688.4635; val_gene_expr_recon_loss: 90020.5343; val_masked_gp_l1_reg_loss: 568.3578; val_group_lasso_reg_loss: 734.4131; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350919.1108; val_optim_loss: 350919.1108
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9835; val_auprc_score: 0.9761; val_best_acc_score: 0.9559; val_best_f1_score: 0.9571; train_kl_reg_loss: 946.2160; train_edge_recon_loss: 257036.5863; train_gene_expr_recon_loss: 88759.8637; train_masked_gp_l1_reg_loss: 568.3815; train_group_lasso_reg_loss: 734.4354; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348045.4829; train_optim_loss: 348045.4829; val_kl_reg_loss: 904.3474; val_edge_recon_loss: 258494.5332; val_gene_expr_recon_loss: 90110.4936; val_masked_gp_l1_reg_loss: 568.4032; val_group_lasso_reg_loss: 734.4663; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 350812.2482; val_optim_loss: 350812.2482
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9835; val_auprc_score: 0.9762; val_best_acc_score: 0.9571; val_best_f1_score: 0.9581; train_kl_reg_loss: 944.6266; train_edge_recon_loss: 257000.1760; train_gene_expr_recon_loss: 88764.7272; train_masked_gp_l1_reg_loss: 568.4274; train_group_lasso_reg_loss: 734.5057; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348012.4622; train_optim_loss: 348012.4622; val_kl_reg_loss: 904.2554; val_edge_recon_loss: 258877.2827; val_gene_expr_recon_loss: 90024.1946; val_masked_gp_l1_reg_loss: 568.4466; val_group_lasso_reg_loss: 734.5416; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 351108.7017; val_optim_loss: 351108.7017

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 90 min 40 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9828
val AUPRC score: 0.9751
val best accuracy score: 0.9547
val best F1 score: 0.9560
val target rna MSE score: 1.1835
val source rna MSE score: 0.0931

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
