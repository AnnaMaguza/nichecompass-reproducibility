None
Run timestamp: 29072023_074311_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9923; val_auprc_score: 0.9920; val_best_acc_score: 0.9563; val_best_f1_score: 0.9563; train_kl_reg_loss: 7830.9399; train_edge_recon_loss: 269861.5962; train_gene_expr_recon_loss: 201362.1057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 479054.6420; train_optim_loss: 479054.6420; val_kl_reg_loss: 7285.1430; val_edge_recon_loss: 264746.5790; val_gene_expr_recon_loss: 183206.4557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455238.1785; val_optim_loss: 455238.1785
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9946; val_best_acc_score: 0.9650; val_best_f1_score: 0.9651; train_kl_reg_loss: 7105.4268; train_edge_recon_loss: 263166.1831; train_gene_expr_recon_loss: 179207.9163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449479.5260; train_optim_loss: 449479.5260; val_kl_reg_loss: 6746.6536; val_edge_recon_loss: 263335.7800; val_gene_expr_recon_loss: 176504.7146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446587.1487; val_optim_loss: 446587.1487
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9954; val_best_acc_score: 0.9689; val_best_f1_score: 0.9691; train_kl_reg_loss: 6830.6713; train_edge_recon_loss: 261857.1813; train_gene_expr_recon_loss: 175402.6052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444090.4578; train_optim_loss: 444090.4578; val_kl_reg_loss: 6672.6425; val_edge_recon_loss: 261666.1602; val_gene_expr_recon_loss: 174292.8753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442631.6776; val_optim_loss: 442631.6776
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9717; val_best_f1_score: 0.9719; train_kl_reg_loss: 6735.9500; train_edge_recon_loss: 261031.9756; train_gene_expr_recon_loss: 174007.4665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441775.3926; train_optim_loss: 441775.3926; val_kl_reg_loss: 6644.3012; val_edge_recon_loss: 261014.5592; val_gene_expr_recon_loss: 173327.6227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440986.4836; val_optim_loss: 440986.4836
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 6695.2305; train_edge_recon_loss: 260655.7737; train_gene_expr_recon_loss: 173347.8985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440698.9024; train_optim_loss: 440698.9024; val_kl_reg_loss: 6563.1425; val_edge_recon_loss: 260918.5839; val_gene_expr_recon_loss: 173053.7017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440535.4283; val_optim_loss: 440535.4283
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9741; val_best_f1_score: 0.9742; train_kl_reg_loss: 6679.6834; train_edge_recon_loss: 260342.4678; train_gene_expr_recon_loss: 173075.7854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440097.9364; train_optim_loss: 440097.9364; val_kl_reg_loss: 6734.7771; val_edge_recon_loss: 260503.5945; val_gene_expr_recon_loss: 172533.9646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439772.3369; val_optim_loss: 439772.3369
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 6676.8171; train_edge_recon_loss: 260134.3012; train_gene_expr_recon_loss: 172852.6103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439663.7286; train_optim_loss: 439663.7286; val_kl_reg_loss: 6559.4030; val_edge_recon_loss: 260507.2543; val_gene_expr_recon_loss: 172622.3572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439689.0152; val_optim_loss: 439689.0152
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 6675.0583; train_edge_recon_loss: 259945.2246; train_gene_expr_recon_loss: 172596.1488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439216.4316; train_optim_loss: 439216.4316; val_kl_reg_loss: 6586.0298; val_edge_recon_loss: 260305.7406; val_gene_expr_recon_loss: 172225.9916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439117.7608; val_optim_loss: 439117.7608
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9768; val_best_f1_score: 0.9768; train_kl_reg_loss: 6681.5250; train_edge_recon_loss: 259725.9719; train_gene_expr_recon_loss: 172501.9740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438909.4707; train_optim_loss: 438909.4707; val_kl_reg_loss: 6652.2149; val_edge_recon_loss: 260186.8032; val_gene_expr_recon_loss: 172362.7564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439201.7748; val_optim_loss: 439201.7748
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 6678.3195; train_edge_recon_loss: 259618.4420; train_gene_expr_recon_loss: 172360.2230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438656.9844; train_optim_loss: 438656.9844; val_kl_reg_loss: 6743.1903; val_edge_recon_loss: 259829.4912; val_gene_expr_recon_loss: 172082.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438655.2460; val_optim_loss: 438655.2460
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 6679.0984; train_edge_recon_loss: 259532.8157; train_gene_expr_recon_loss: 172304.1763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438516.0902; train_optim_loss: 438516.0902; val_kl_reg_loss: 6663.1066; val_edge_recon_loss: 259772.0527; val_gene_expr_recon_loss: 172101.5197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438536.6798; val_optim_loss: 438536.6798
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9782; val_best_f1_score: 0.9782; train_kl_reg_loss: 6681.3656; train_edge_recon_loss: 259357.8514; train_gene_expr_recon_loss: 172243.4608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438282.6777; train_optim_loss: 438282.6777; val_kl_reg_loss: 6652.3812; val_edge_recon_loss: 259720.1952; val_gene_expr_recon_loss: 172157.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438530.2177; val_optim_loss: 438530.2177
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 6684.2481; train_edge_recon_loss: 259297.6610; train_gene_expr_recon_loss: 172153.8545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438135.7633; train_optim_loss: 438135.7633; val_kl_reg_loss: 6662.6376; val_edge_recon_loss: 259401.7341; val_gene_expr_recon_loss: 171988.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438052.4183; val_optim_loss: 438052.4183
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 6683.2815; train_edge_recon_loss: 259233.6632; train_gene_expr_recon_loss: 172152.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438069.0748; train_optim_loss: 438069.0748; val_kl_reg_loss: 6640.1135; val_edge_recon_loss: 259598.0536; val_gene_expr_recon_loss: 172122.7041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438360.8698; val_optim_loss: 438360.8698
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9798; val_best_f1_score: 0.9798; train_kl_reg_loss: 6684.9152; train_edge_recon_loss: 259172.6267; train_gene_expr_recon_loss: 172263.6866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438121.2283; train_optim_loss: 438121.2283; val_kl_reg_loss: 6661.3487; val_edge_recon_loss: 259600.1165; val_gene_expr_recon_loss: 172261.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438522.4701; val_optim_loss: 438522.4701
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 6687.2043; train_edge_recon_loss: 259068.6250; train_gene_expr_recon_loss: 172370.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438126.0715; train_optim_loss: 438126.0715; val_kl_reg_loss: 6577.6470; val_edge_recon_loss: 259386.4319; val_gene_expr_recon_loss: 171665.2867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437629.3659; val_optim_loss: 437629.3659
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 6689.6461; train_edge_recon_loss: 259022.0214; train_gene_expr_recon_loss: 172552.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438264.3488; train_optim_loss: 438264.3488; val_kl_reg_loss: 6694.8269; val_edge_recon_loss: 259379.6499; val_gene_expr_recon_loss: 167903.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433977.4954; val_optim_loss: 433977.4954
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 6688.0231; train_edge_recon_loss: 258974.3316; train_gene_expr_recon_loss: 172995.8376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438658.1924; train_optim_loss: 438658.1924; val_kl_reg_loss: 6652.5702; val_edge_recon_loss: 259176.6174; val_gene_expr_recon_loss: 176410.3924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442239.5796; val_optim_loss: 442239.5796
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 6689.9181; train_edge_recon_loss: 258894.6709; train_gene_expr_recon_loss: 173279.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438863.8963; train_optim_loss: 438863.8963; val_kl_reg_loss: 6736.2211; val_edge_recon_loss: 259294.1319; val_gene_expr_recon_loss: 173871.2759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439901.6274; val_optim_loss: 439901.6274
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 6690.2298; train_edge_recon_loss: 258876.3034; train_gene_expr_recon_loss: 173324.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438890.9883; train_optim_loss: 438890.9883; val_kl_reg_loss: 6700.5513; val_edge_recon_loss: 259023.4702; val_gene_expr_recon_loss: 156760.5588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 422484.5803; val_optim_loss: 422484.5803
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 6692.1380; train_edge_recon_loss: 258798.3466; train_gene_expr_recon_loss: 170339.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435830.2135; train_optim_loss: 435830.2135; val_kl_reg_loss: 6620.6874; val_edge_recon_loss: 259042.7439; val_gene_expr_recon_loss: 146070.5635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 411733.9948; val_optim_loss: 411733.9948
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 6690.1885; train_edge_recon_loss: 258802.4215; train_gene_expr_recon_loss: 176073.5685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441566.1785; train_optim_loss: 441566.1785; val_kl_reg_loss: 6539.3180; val_edge_recon_loss: 259031.6952; val_gene_expr_recon_loss: 136251.2417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 401822.2538; val_optim_loss: 401822.2538
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 6691.0951; train_edge_recon_loss: 258757.6090; train_gene_expr_recon_loss: 178368.4533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443817.1575; train_optim_loss: 443817.1575; val_kl_reg_loss: 6693.8133; val_edge_recon_loss: 259147.7827; val_gene_expr_recon_loss: 179821.5242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445663.1202; val_optim_loss: 445663.1202
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9980; val_auprc_score: 0.9978; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 6694.9457; train_edge_recon_loss: 258701.6473; train_gene_expr_recon_loss: 194152.5426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 459549.1359; train_optim_loss: 459549.1359; val_kl_reg_loss: 6675.3875; val_edge_recon_loss: 258837.5022; val_gene_expr_recon_loss: 245038.5860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 510551.4759; val_optim_loss: 510551.4759
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 6693.8289; train_edge_recon_loss: 258704.1959; train_gene_expr_recon_loss: 168087.0623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433485.0872; train_optim_loss: 433485.0872; val_kl_reg_loss: 6668.8659; val_edge_recon_loss: 258695.6332; val_gene_expr_recon_loss: 147678.3311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 413042.8301; val_optim_loss: 413042.8301
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 6698.1126; train_edge_recon_loss: 258626.2456; train_gene_expr_recon_loss: 182467.8607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447792.2192; train_optim_loss: 447792.2192; val_kl_reg_loss: 6766.8134; val_edge_recon_loss: 259161.5970; val_gene_expr_recon_loss: 240842.5020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 506770.9132; val_optim_loss: 506770.9132

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 6745.6157; train_edge_recon_loss: 258301.3855; train_gene_expr_recon_loss: 181107.8296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446154.8306; train_optim_loss: 446154.8306; val_kl_reg_loss: 6692.7432; val_edge_recon_loss: 258558.7508; val_gene_expr_recon_loss: 202259.6219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 467511.1166; val_optim_loss: 467511.1166
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9830; val_best_f1_score: 0.9830; train_kl_reg_loss: 6726.4061; train_edge_recon_loss: 258346.4220; train_gene_expr_recon_loss: 185497.4320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 450570.2602; train_optim_loss: 450570.2602; val_kl_reg_loss: 6694.7385; val_edge_recon_loss: 258493.9611; val_gene_expr_recon_loss: 110856.8673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376045.5663; val_optim_loss: 376045.5663
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9827; val_best_f1_score: 0.9827; train_kl_reg_loss: 6720.8690; train_edge_recon_loss: 258290.8859; train_gene_expr_recon_loss: 163876.2141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428887.9687; train_optim_loss: 428887.9687; val_kl_reg_loss: 6688.5698; val_edge_recon_loss: 258574.9720; val_gene_expr_recon_loss: 61522.1109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 326785.6530; val_optim_loss: 326785.6530
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 6717.9669; train_edge_recon_loss: 258253.9455; train_gene_expr_recon_loss: 116005.9320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 380977.8442; train_optim_loss: 380977.8442; val_kl_reg_loss: 6643.4361; val_edge_recon_loss: 258429.6668; val_gene_expr_recon_loss: 64314.7442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 329387.8490; val_optim_loss: 329387.8490
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9830; val_best_f1_score: 0.9830; train_kl_reg_loss: 6716.4326; train_edge_recon_loss: 258265.5098; train_gene_expr_recon_loss: 121040.1040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 386022.0466; train_optim_loss: 386022.0466; val_kl_reg_loss: 6680.5310; val_edge_recon_loss: 258491.0041; val_gene_expr_recon_loss: 121042.9172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 386214.4531; val_optim_loss: 386214.4531
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9835; train_kl_reg_loss: 6715.3128; train_edge_recon_loss: 258239.4239; train_gene_expr_recon_loss: 183007.0923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447961.8289; train_optim_loss: 447961.8289; val_kl_reg_loss: 6669.6500; val_edge_recon_loss: 258450.1685; val_gene_expr_recon_loss: 233245.6808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 498365.5001; val_optim_loss: 498365.5001
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9835; train_kl_reg_loss: 6713.6817; train_edge_recon_loss: 258201.8067; train_gene_expr_recon_loss: 116889.3076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 381804.7959; train_optim_loss: 381804.7959; val_kl_reg_loss: 6673.7789; val_edge_recon_loss: 258537.8255; val_gene_expr_recon_loss: 135130.6385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 400342.2446; val_optim_loss: 400342.2446

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9836; val_best_f1_score: 0.9836; train_kl_reg_loss: 6722.0895; train_edge_recon_loss: 258175.8477; train_gene_expr_recon_loss: 135840.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 400738.7573; train_optim_loss: 400738.7573; val_kl_reg_loss: 6678.8341; val_edge_recon_loss: 258373.0867; val_gene_expr_recon_loss: 100541.7618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365593.6830; val_optim_loss: 365593.6830
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9835; val_best_f1_score: 0.9836; train_kl_reg_loss: 6716.8857; train_edge_recon_loss: 258284.9670; train_gene_expr_recon_loss: 91303.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356305.5438; train_optim_loss: 356305.5438; val_kl_reg_loss: 6671.2086; val_edge_recon_loss: 258414.5775; val_gene_expr_recon_loss: 118536.1402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 383621.9264; val_optim_loss: 383621.9264
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 6717.0418; train_edge_recon_loss: 258198.8232; train_gene_expr_recon_loss: 105823.6595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370739.5248; train_optim_loss: 370739.5248; val_kl_reg_loss: 6680.5008; val_edge_recon_loss: 258418.7391; val_gene_expr_recon_loss: 104650.0458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369749.2860; val_optim_loss: 369749.2860
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 6715.3917; train_edge_recon_loss: 258243.7855; train_gene_expr_recon_loss: 111896.4749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 376855.6523; train_optim_loss: 376855.6523; val_kl_reg_loss: 6672.5890; val_edge_recon_loss: 258389.5811; val_gene_expr_recon_loss: 131752.3713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 396814.5405; val_optim_loss: 396814.5405

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 647 min 57 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9983
val AUPRC score: 0.9981
val best accuracy score: 0.9828
val best F1 score: 0.9828
val target rna MSE score: 3.8230
val source rna MSE score: 0.2632

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
