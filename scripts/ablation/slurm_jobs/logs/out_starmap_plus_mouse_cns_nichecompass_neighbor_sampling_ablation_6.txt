None
Run timestamp: 19072023_152123_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9817; val_auprc_score: 0.9753; val_best_acc_score: 0.9436; val_best_f1_score: 0.9450; train_kl_reg_loss: 87537.1710; train_edge_recon_loss: 26998276.1838; train_gene_expr_recon_loss: 11969325.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39055139.0000; train_optim_loss: 39055139.0000; val_kl_reg_loss: 104762.1815; val_edge_recon_loss: 26156968.6885; val_gene_expr_recon_loss: 10962261.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37223992.4590; val_optim_loss: 37223992.4590
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9838; val_auprc_score: 0.9787; val_best_acc_score: 0.9474; val_best_f1_score: 0.9488; train_kl_reg_loss: 106731.7215; train_edge_recon_loss: 26022887.6507; train_gene_expr_recon_loss: 10706253.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36835873.3162; train_optim_loss: 36835873.3162; val_kl_reg_loss: 98775.1642; val_edge_recon_loss: 26085574.3607; val_gene_expr_recon_loss: 10496495.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36680844.9180; val_optim_loss: 36680844.9180
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9860; val_auprc_score: 0.9818; val_best_acc_score: 0.9523; val_best_f1_score: 0.9534; train_kl_reg_loss: 97219.1511; train_edge_recon_loss: 25958941.8419; train_gene_expr_recon_loss: 10373162.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36429323.6838; train_optim_loss: 36429323.6838; val_kl_reg_loss: 91769.3696; val_edge_recon_loss: 25952984.8197; val_gene_expr_recon_loss: 10252017.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36296771.4754; val_optim_loss: 36296771.4754
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9836; val_best_acc_score: 0.9576; val_best_f1_score: 0.9584; train_kl_reg_loss: 87006.7956; train_edge_recon_loss: 25884658.8640; train_gene_expr_recon_loss: 10173840.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36145506.1912; train_optim_loss: 36145506.1912; val_kl_reg_loss: 81657.4659; val_edge_recon_loss: 25893564.3279; val_gene_expr_recon_loss: 10094021.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36069243.4754; val_optim_loss: 36069243.4754
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9882; val_auprc_score: 0.9850; val_best_acc_score: 0.9591; val_best_f1_score: 0.9601; train_kl_reg_loss: 82929.9142; train_edge_recon_loss: 25794643.2831; train_gene_expr_recon_loss: 10033343.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35910916.6618; train_optim_loss: 35910916.6618; val_kl_reg_loss: 79375.0661; val_edge_recon_loss: 25838502.2951; val_gene_expr_recon_loss: 9985169.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35903047.5410; val_optim_loss: 35903047.5410
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9882; val_auprc_score: 0.9846; val_best_acc_score: 0.9595; val_best_f1_score: 0.9603; train_kl_reg_loss: 78806.6703; train_edge_recon_loss: 25765845.0515; train_gene_expr_recon_loss: 9931089.7996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35775741.4706; train_optim_loss: 35775741.4706; val_kl_reg_loss: 73494.5374; val_edge_recon_loss: 25832611.4754; val_gene_expr_recon_loss: 9920593.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35826699.4754; val_optim_loss: 35826699.4754
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9899; val_auprc_score: 0.9871; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 74237.8614; train_edge_recon_loss: 25742642.4596; train_gene_expr_recon_loss: 9858010.4099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35674890.7868; train_optim_loss: 35674890.7868; val_kl_reg_loss: 70543.0350; val_edge_recon_loss: 25775273.7377; val_gene_expr_recon_loss: 9807623.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35653440.7869; val_optim_loss: 35653440.7869
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9902; val_auprc_score: 0.9875; val_best_acc_score: 0.9646; val_best_f1_score: 0.9655; train_kl_reg_loss: 70476.7667; train_edge_recon_loss: 25722491.3529; train_gene_expr_recon_loss: 9785801.5790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35578769.7353; train_optim_loss: 35578769.7353; val_kl_reg_loss: 69479.1514; val_edge_recon_loss: 25754923.0164; val_gene_expr_recon_loss: 9778881.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35603283.6066; val_optim_loss: 35603283.6066
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9903; val_auprc_score: 0.9873; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 68385.3027; train_edge_recon_loss: 25687989.8272; train_gene_expr_recon_loss: 9741705.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35498080.3897; train_optim_loss: 35498080.3897; val_kl_reg_loss: 65760.7647; val_edge_recon_loss: 25742659.4098; val_gene_expr_recon_loss: 9760814.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35569234.4262; val_optim_loss: 35569234.4262
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9910; val_auprc_score: 0.9884; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 65942.9011; train_edge_recon_loss: 25690998.6324; train_gene_expr_recon_loss: 9700135.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35457076.5662; train_optim_loss: 35457076.5662; val_kl_reg_loss: 63689.7464; val_edge_recon_loss: 25721357.9016; val_gene_expr_recon_loss: 9746951.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35531999.2787; val_optim_loss: 35531999.2787
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 64151.7553; train_edge_recon_loss: 25663743.8088; train_gene_expr_recon_loss: 9664846.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35392741.4853; train_optim_loss: 35392741.4853; val_kl_reg_loss: 62603.8377; val_edge_recon_loss: 25714385.1803; val_gene_expr_recon_loss: 9722446.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35499436.1311; val_optim_loss: 35499436.1311
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9919; val_auprc_score: 0.9896; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 61232.9877; train_edge_recon_loss: 25656872.0257; train_gene_expr_recon_loss: 9641384.9540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35359489.9706; train_optim_loss: 35359489.9706; val_kl_reg_loss: 59071.2586; val_edge_recon_loss: 25711686.8852; val_gene_expr_recon_loss: 9700527.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35471285.9016; val_optim_loss: 35471285.9016
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9921; val_auprc_score: 0.9897; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 60450.2824; train_edge_recon_loss: 25630886.6471; train_gene_expr_recon_loss: 9612712.8768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35304049.8015; train_optim_loss: 35304049.8015; val_kl_reg_loss: 56529.8584; val_edge_recon_loss: 25714659.9016; val_gene_expr_recon_loss: 9678480.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35449669.7049; val_optim_loss: 35449669.7049
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 59538.0699; train_edge_recon_loss: 25627109.4154; train_gene_expr_recon_loss: 9575458.3768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35262105.7941; train_optim_loss: 35262105.7941; val_kl_reg_loss: 58046.4046; val_edge_recon_loss: 25689306.8852; val_gene_expr_recon_loss: 9653238.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35400591.7377; val_optim_loss: 35400591.7377
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9925; val_auprc_score: 0.9901; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 58805.0800; train_edge_recon_loss: 25621744.6360; train_gene_expr_recon_loss: 9547767.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35228317.3456; train_optim_loss: 35228317.3456; val_kl_reg_loss: 57099.2497; val_edge_recon_loss: 25667765.2131; val_gene_expr_recon_loss: 9658122.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35382987.2131; val_optim_loss: 35382987.2131
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 57974.9157; train_edge_recon_loss: 25618683.2904; train_gene_expr_recon_loss: 9524987.6838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35201645.8971; train_optim_loss: 35201645.8971; val_kl_reg_loss: 56212.3949; val_edge_recon_loss: 25684127.1148; val_gene_expr_recon_loss: 9624651.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35364991.1475; val_optim_loss: 35364991.1475
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9925; val_auprc_score: 0.9898; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 57170.2069; train_edge_recon_loss: 25607871.5993; train_gene_expr_recon_loss: 9502821.5404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35167863.2868; train_optim_loss: 35167863.2868; val_kl_reg_loss: 55793.6942; val_edge_recon_loss: 25651785.2787; val_gene_expr_recon_loss: 9621574.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35329153.5738; val_optim_loss: 35329153.5738
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 56800.0900; train_edge_recon_loss: 25609950.0221; train_gene_expr_recon_loss: 9491071.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35157821.9412; train_optim_loss: 35157821.9412; val_kl_reg_loss: 55276.6091; val_edge_recon_loss: 25689329.9016; val_gene_expr_recon_loss: 9586071.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35330677.8361; val_optim_loss: 35330677.8361
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9930; val_auprc_score: 0.9907; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 56675.9358; train_edge_recon_loss: 25590685.7353; train_gene_expr_recon_loss: 9469489.4256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35116851.0515; train_optim_loss: 35116851.0515; val_kl_reg_loss: 55561.7615; val_edge_recon_loss: 25646107.5410; val_gene_expr_recon_loss: 9586671.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35288340.7213; val_optim_loss: 35288340.7213
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9934; val_auprc_score: 0.9916; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 55477.8703; train_edge_recon_loss: 25602307.5588; train_gene_expr_recon_loss: 9473998.6765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35131783.9779; train_optim_loss: 35131783.9779; val_kl_reg_loss: 56209.4522; val_edge_recon_loss: 25883267.9344; val_gene_expr_recon_loss: 9844189.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35783666.8852; val_optim_loss: 35783666.8852
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9933; val_auprc_score: 0.9907; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 54990.3471; train_edge_recon_loss: 25607639.7279; train_gene_expr_recon_loss: 9475762.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35138392.1471; train_optim_loss: 35138392.1471; val_kl_reg_loss: 51349.6967; val_edge_recon_loss: 25632651.6066; val_gene_expr_recon_loss: 9612891.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35296893.1148; val_optim_loss: 35296893.1148
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 54713.7645; train_edge_recon_loss: 25586312.0809; train_gene_expr_recon_loss: 9429892.3686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35070918.3162; train_optim_loss: 35070918.3162; val_kl_reg_loss: 54165.6787; val_edge_recon_loss: 25628838.5574; val_gene_expr_recon_loss: 9589542.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35272547.3443; val_optim_loss: 35272547.3443
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9908; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 54464.5397; train_edge_recon_loss: 25583362.5184; train_gene_expr_recon_loss: 9420576.9301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35058404.0294; train_optim_loss: 35058404.0294; val_kl_reg_loss: 52161.7832; val_edge_recon_loss: 25673952.2623; val_gene_expr_recon_loss: 9584141.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35310255.7377; val_optim_loss: 35310255.7377
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 53933.5624; train_edge_recon_loss: 25570543.0956; train_gene_expr_recon_loss: 9409325.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35033802.4044; train_optim_loss: 35033802.4044; val_kl_reg_loss: 52811.5453; val_edge_recon_loss: 25642656.0656; val_gene_expr_recon_loss: 9589691.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35285159.4754; val_optim_loss: 35285159.4754
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 54126.7140; train_edge_recon_loss: 25573097.7721; train_gene_expr_recon_loss: 9389118.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35016343.2647; train_optim_loss: 35016343.2647; val_kl_reg_loss: 52985.0505; val_edge_recon_loss: 25636435.5738; val_gene_expr_recon_loss: 9575571.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35264992.2623; val_optim_loss: 35264992.2623
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 53924.8265; train_edge_recon_loss: 25566226.2684; train_gene_expr_recon_loss: 9378080.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34998231.7279; train_optim_loss: 34998231.7279; val_kl_reg_loss: 52127.0105; val_edge_recon_loss: 25625504.7213; val_gene_expr_recon_loss: 9560694.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35238326.4262; val_optim_loss: 35238326.4262
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 53260.5625; train_edge_recon_loss: 25573991.1544; train_gene_expr_recon_loss: 9356419.8695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34983671.5809; train_optim_loss: 34983671.5809; val_kl_reg_loss: 53482.3104; val_edge_recon_loss: 25614059.8689; val_gene_expr_recon_loss: 9545613.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35213155.7377; val_optim_loss: 35213155.7377
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 53479.5239; train_edge_recon_loss: 25553603.3088; train_gene_expr_recon_loss: 9349272.9026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34956355.7426; train_optim_loss: 34956355.7426; val_kl_reg_loss: 52416.1331; val_edge_recon_loss: 25598564.5902; val_gene_expr_recon_loss: 9554660.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35205641.6393; val_optim_loss: 35205641.6393
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 53131.8787; train_edge_recon_loss: 25556887.2022; train_gene_expr_recon_loss: 9346653.2482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34956672.3456; train_optim_loss: 34956672.3456; val_kl_reg_loss: 52173.8897; val_edge_recon_loss: 25628708.5902; val_gene_expr_recon_loss: 9562165.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35243047.9344; val_optim_loss: 35243047.9344
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 52759.9766; train_edge_recon_loss: 25559998.2721; train_gene_expr_recon_loss: 9334957.2390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34947715.3824; train_optim_loss: 34947715.3824; val_kl_reg_loss: 52225.8424; val_edge_recon_loss: 25633535.9672; val_gene_expr_recon_loss: 9553142.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35238904.7213; val_optim_loss: 35238904.7213
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 52751.2378; train_edge_recon_loss: 25564438.8088; train_gene_expr_recon_loss: 9341351.4926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34958541.5809; train_optim_loss: 34958541.5809; val_kl_reg_loss: 51548.0007; val_edge_recon_loss: 25625008.5246; val_gene_expr_recon_loss: 9551563.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35228120.3934; val_optim_loss: 35228120.3934
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 52717.3985; train_edge_recon_loss: 25542146.5110; train_gene_expr_recon_loss: 9314804.3566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34909668.2500; train_optim_loss: 34909668.2500; val_kl_reg_loss: 51848.5024; val_edge_recon_loss: 25623042.0000; val_gene_expr_recon_loss: 9551021.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35225912.2623; val_optim_loss: 35225912.2623

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9763; val_best_f1_score: 0.9767; train_kl_reg_loss: 54243.1823; train_edge_recon_loss: 25543832.0699; train_gene_expr_recon_loss: 9234609.9053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34832685.1250; train_optim_loss: 34832685.1250; val_kl_reg_loss: 54965.8286; val_edge_recon_loss: 25586430.6885; val_gene_expr_recon_loss: 9527004.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35168400.5246; val_optim_loss: 35168400.5246
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 56284.9072; train_edge_recon_loss: 25526441.7169; train_gene_expr_recon_loss: 9226434.6581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34809161.1838; train_optim_loss: 34809161.1838; val_kl_reg_loss: 56348.9445; val_edge_recon_loss: 25583800.6230; val_gene_expr_recon_loss: 9488463.5574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35128613.1148; val_optim_loss: 35128613.1148
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9942; val_auprc_score: 0.9922; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 56880.9765; train_edge_recon_loss: 25536166.1581; train_gene_expr_recon_loss: 9224620.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34817667.2500; train_optim_loss: 34817667.2500; val_kl_reg_loss: 56431.1649; val_edge_recon_loss: 25591061.1148; val_gene_expr_recon_loss: 9480579.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35128071.4754; val_optim_loss: 35128071.4754
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 57257.5095; train_edge_recon_loss: 25539288.6838; train_gene_expr_recon_loss: 9211468.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34808014.7537; train_optim_loss: 34808014.7537; val_kl_reg_loss: 56651.5879; val_edge_recon_loss: 25552688.6885; val_gene_expr_recon_loss: 9489061.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35098401.7705; val_optim_loss: 35098401.7705
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 57492.7804; train_edge_recon_loss: 25541263.2537; train_gene_expr_recon_loss: 9214555.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34813311.5074; train_optim_loss: 34813311.5074; val_kl_reg_loss: 56656.2405; val_edge_recon_loss: 25612849.7049; val_gene_expr_recon_loss: 9469966.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35139471.8689; val_optim_loss: 35139471.8689
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 57665.3094; train_edge_recon_loss: 25536255.4301; train_gene_expr_recon_loss: 9211801.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34805722.3971; train_optim_loss: 34805722.3971; val_kl_reg_loss: 56865.2321; val_edge_recon_loss: 25582600.4262; val_gene_expr_recon_loss: 9481092.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35120558.3607; val_optim_loss: 35120558.3607
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 57868.5747; train_edge_recon_loss: 25528041.7022; train_gene_expr_recon_loss: 9211019.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34796929.9853; train_optim_loss: 34796929.9853; val_kl_reg_loss: 57062.1789; val_edge_recon_loss: 25570289.0164; val_gene_expr_recon_loss: 9459556.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35086907.2787; val_optim_loss: 35086907.2787
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 58037.8650; train_edge_recon_loss: 25531048.0809; train_gene_expr_recon_loss: 9204308.6728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34793394.6029; train_optim_loss: 34793394.6029; val_kl_reg_loss: 57368.2730; val_edge_recon_loss: 25564487.5738; val_gene_expr_recon_loss: 9473192.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35095048.5246; val_optim_loss: 35095048.5246
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 58048.5070; train_edge_recon_loss: 25535355.6066; train_gene_expr_recon_loss: 9200257.2711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34793661.4118; train_optim_loss: 34793661.4118; val_kl_reg_loss: 57023.5568; val_edge_recon_loss: 25599802.7869; val_gene_expr_recon_loss: 9492982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149808.3279; val_optim_loss: 35149808.3279
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 58093.5433; train_edge_recon_loss: 25527323.7022; train_gene_expr_recon_loss: 9201847.0506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34787264.1654; train_optim_loss: 34787264.1654; val_kl_reg_loss: 57336.0993; val_edge_recon_loss: 25597703.2131; val_gene_expr_recon_loss: 9494420.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149460.3279; val_optim_loss: 35149460.3279
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 58214.6638; train_edge_recon_loss: 25544167.8015; train_gene_expr_recon_loss: 9206709.4835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34809091.9265; train_optim_loss: 34809091.9265; val_kl_reg_loss: 57672.4947; val_edge_recon_loss: 25604516.4918; val_gene_expr_recon_loss: 9481191.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35143380.3934; val_optim_loss: 35143380.3934

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9781; val_best_f1_score: 0.9785; train_kl_reg_loss: 58405.1961; train_edge_recon_loss: 25524040.7978; train_gene_expr_recon_loss: 9194141.9154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34776587.8750; train_optim_loss: 34776587.8750; val_kl_reg_loss: 57598.7471; val_edge_recon_loss: 25542299.8033; val_gene_expr_recon_loss: 9476484.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35076382.4918; val_optim_loss: 35076382.4918
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 58351.8190; train_edge_recon_loss: 25530949.9338; train_gene_expr_recon_loss: 9191746.3309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34781048.0294; train_optim_loss: 34781048.0294; val_kl_reg_loss: 57705.8726; val_edge_recon_loss: 25574540.0000; val_gene_expr_recon_loss: 9498043.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130289.9016; val_optim_loss: 35130289.9016
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 58358.2247; train_edge_recon_loss: 25534796.3493; train_gene_expr_recon_loss: 9173053.1039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34766207.7500; train_optim_loss: 34766207.7500; val_kl_reg_loss: 57546.3334; val_edge_recon_loss: 25580192.6230; val_gene_expr_recon_loss: 9474580.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35112319.4098; val_optim_loss: 35112319.4098
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 58395.6762; train_edge_recon_loss: 25542061.1029; train_gene_expr_recon_loss: 9184099.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34784556.4044; train_optim_loss: 34784556.4044; val_kl_reg_loss: 57789.6833; val_edge_recon_loss: 25598824.0656; val_gene_expr_recon_loss: 9465027.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35121641.4426; val_optim_loss: 35121641.4426
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 58430.8787; train_edge_recon_loss: 25530599.7316; train_gene_expr_recon_loss: 9182852.1029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34771882.7426; train_optim_loss: 34771882.7426; val_kl_reg_loss: 57692.8957; val_edge_recon_loss: 25583493.7377; val_gene_expr_recon_loss: 9468468.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35109655.4098; val_optim_loss: 35109655.4098

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 58422.1898; train_edge_recon_loss: 25527238.0294; train_gene_expr_recon_loss: 9190169.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34775829.7868; train_optim_loss: 34775829.7868; val_kl_reg_loss: 57568.9068; val_edge_recon_loss: 25566035.8033; val_gene_expr_recon_loss: 9456361.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35079965.9016; val_optim_loss: 35079965.9016
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 58403.8648; train_edge_recon_loss: 25525412.3162; train_gene_expr_recon_loss: 9188502.8557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34772319.0000; train_optim_loss: 34772319.0000; val_kl_reg_loss: 57583.6749; val_edge_recon_loss: 25566505.8033; val_gene_expr_recon_loss: 9470087.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35094176.6557; val_optim_loss: 35094176.6557
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 58404.4405; train_edge_recon_loss: 25540356.0919; train_gene_expr_recon_loss: 9189290.7583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34788051.2647; train_optim_loss: 34788051.2647; val_kl_reg_loss: 57560.7536; val_edge_recon_loss: 25579891.9344; val_gene_expr_recon_loss: 9484979.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35122432.5246; val_optim_loss: 35122432.5246
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 58464.2678; train_edge_recon_loss: 25524101.6471; train_gene_expr_recon_loss: 9183070.7123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34765636.5588; train_optim_loss: 34765636.5588; val_kl_reg_loss: 57642.0485; val_edge_recon_loss: 25559252.8852; val_gene_expr_recon_loss: 9466830.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35083724.9180; val_optim_loss: 35083724.9180

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 219 min 6 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9944
Val AUPRC score: 0.9927
Val best accuracy score: 0.9763
Val best F1 score: 0.9767
Val gene expr MSE score: 0.6275

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
