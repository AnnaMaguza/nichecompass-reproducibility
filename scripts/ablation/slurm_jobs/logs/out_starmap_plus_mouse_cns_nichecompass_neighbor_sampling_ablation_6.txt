None
Run timestamp: 24072023_201321_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9728; val_auprc_score: 0.9633; val_best_acc_score: 0.9262; val_best_f1_score: 0.9286; train_kl_reg_loss: 93340.5513; train_edge_recon_loss: 27472311.5489; train_gene_expr_recon_loss: 12244039.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39809692.0109; train_optim_loss: 39809692.0109; val_kl_reg_loss: 101691.6383; val_edge_recon_loss: 26447996.2439; val_gene_expr_recon_loss: 11129884.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37679572.6829; val_optim_loss: 37679572.6829
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9801; val_auprc_score: 0.9724; val_best_acc_score: 0.9426; val_best_f1_score: 0.9443; train_kl_reg_loss: 114723.7245; train_edge_recon_loss: 26160706.1304; train_gene_expr_recon_loss: 10803053.1413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37078483.0543; train_optim_loss: 37078483.0543; val_kl_reg_loss: 114753.4728; val_edge_recon_loss: 26107580.1463; val_gene_expr_recon_loss: 10614588.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36836921.7561; val_optim_loss: 36836921.7561
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9817; val_auprc_score: 0.9745; val_best_acc_score: 0.9451; val_best_f1_score: 0.9464; train_kl_reg_loss: 113321.9098; train_edge_recon_loss: 26019946.2609; train_gene_expr_recon_loss: 10441221.5571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36574489.5870; train_optim_loss: 36574489.5870; val_kl_reg_loss: 106091.6227; val_edge_recon_loss: 26054346.5366; val_gene_expr_recon_loss: 10381321.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36541759.4146; val_optim_loss: 36541759.4146
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9830; val_auprc_score: 0.9773; val_best_acc_score: 0.9476; val_best_f1_score: 0.9489; train_kl_reg_loss: 104357.2513; train_edge_recon_loss: 25953343.2880; train_gene_expr_recon_loss: 10234089.5842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36291790.0978; train_optim_loss: 36291790.0978; val_kl_reg_loss: 98787.4606; val_edge_recon_loss: 26024234.7317; val_gene_expr_recon_loss: 10189798.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36312820.8780; val_optim_loss: 36312820.8780
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9843; val_auprc_score: 0.9787; val_best_acc_score: 0.9508; val_best_f1_score: 0.9521; train_kl_reg_loss: 96886.4173; train_edge_recon_loss: 25910194.7772; train_gene_expr_recon_loss: 10083439.1440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36090520.4022; train_optim_loss: 36090520.4022; val_kl_reg_loss: 91242.7670; val_edge_recon_loss: 25953130.3415; val_gene_expr_recon_loss: 10089475.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36133849.2683; val_optim_loss: 36133849.2683
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9842; val_auprc_score: 0.9784; val_best_acc_score: 0.9536; val_best_f1_score: 0.9549; train_kl_reg_loss: 89625.3100; train_edge_recon_loss: 25867116.3587; train_gene_expr_recon_loss: 9972245.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35928987.2717; train_optim_loss: 35928987.2717; val_kl_reg_loss: 84136.0678; val_edge_recon_loss: 25961576.5854; val_gene_expr_recon_loss: 9988255.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36033968.0976; val_optim_loss: 36033968.0976
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9862; val_auprc_score: 0.9815; val_best_acc_score: 0.9567; val_best_f1_score: 0.9578; train_kl_reg_loss: 85037.2259; train_edge_recon_loss: 25825008.8696; train_gene_expr_recon_loss: 9881298.6005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35791344.6630; train_optim_loss: 35791344.6630; val_kl_reg_loss: 82992.5798; val_edge_recon_loss: 25859972.0000; val_gene_expr_recon_loss: 9899776.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35842741.6585; val_optim_loss: 35842741.6585
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9865; val_auprc_score: 0.9815; val_best_acc_score: 0.9591; val_best_f1_score: 0.9602; train_kl_reg_loss: 81754.8594; train_edge_recon_loss: 25788834.0707; train_gene_expr_recon_loss: 9814757.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35685346.2609; train_optim_loss: 35685346.2609; val_kl_reg_loss: 78825.0581; val_edge_recon_loss: 25787946.7805; val_gene_expr_recon_loss: 9845387.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35712159.5122; val_optim_loss: 35712159.5122
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9859; val_auprc_score: 0.9808; val_best_acc_score: 0.9580; val_best_f1_score: 0.9592; train_kl_reg_loss: 79189.3242; train_edge_recon_loss: 25746111.2772; train_gene_expr_recon_loss: 9753619.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35578920.6196; train_optim_loss: 35578920.6196; val_kl_reg_loss: 77179.0187; val_edge_recon_loss: 25848486.9756; val_gene_expr_recon_loss: 9823132.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35748798.6341; val_optim_loss: 35748798.6341
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9874; val_auprc_score: 0.9831; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 76473.5636; train_edge_recon_loss: 25726757.1848; train_gene_expr_recon_loss: 9699753.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35502984.6196; train_optim_loss: 35502984.6196; val_kl_reg_loss: 74160.1307; val_edge_recon_loss: 25827614.8780; val_gene_expr_recon_loss: 9778561.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35680336.2927; val_optim_loss: 35680336.2927
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9839; val_best_acc_score: 0.9616; val_best_f1_score: 0.9626; train_kl_reg_loss: 73685.2913; train_edge_recon_loss: 25713613.0272; train_gene_expr_recon_loss: 9653598.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35440897.3261; train_optim_loss: 35440897.3261; val_kl_reg_loss: 70296.0743; val_edge_recon_loss: 25803153.7561; val_gene_expr_recon_loss: 9762693.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35636142.7317; val_optim_loss: 35636142.7317
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9850; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 71496.9647; train_edge_recon_loss: 25693066.6522; train_gene_expr_recon_loss: 9607550.0870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35372113.9130; train_optim_loss: 35372113.9130; val_kl_reg_loss: 69644.3390; val_edge_recon_loss: 25784698.8293; val_gene_expr_recon_loss: 9723793.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35578137.0732; val_optim_loss: 35578137.0732
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9883; val_auprc_score: 0.9843; val_best_acc_score: 0.9615; val_best_f1_score: 0.9625; train_kl_reg_loss: 69361.0948; train_edge_recon_loss: 25678994.1250; train_gene_expr_recon_loss: 9580265.7717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35328621.0543; train_optim_loss: 35328621.0543; val_kl_reg_loss: 67789.0277; val_edge_recon_loss: 25759332.3415; val_gene_expr_recon_loss: 9707425.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35534547.3171; val_optim_loss: 35534547.3171
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9890; val_auprc_score: 0.9852; val_best_acc_score: 0.9632; val_best_f1_score: 0.9641; train_kl_reg_loss: 68058.9805; train_edge_recon_loss: 25675413.4837; train_gene_expr_recon_loss: 9552811.9457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35296284.2500; train_optim_loss: 35296284.2500; val_kl_reg_loss: 65674.3052; val_edge_recon_loss: 25767826.6829; val_gene_expr_recon_loss: 9679759.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35513260.9756; val_optim_loss: 35513260.9756
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9892; val_auprc_score: 0.9856; val_best_acc_score: 0.9641; val_best_f1_score: 0.9649; train_kl_reg_loss: 66560.8856; train_edge_recon_loss: 25653753.4837; train_gene_expr_recon_loss: 9518955.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35239270.3478; train_optim_loss: 35239270.3478; val_kl_reg_loss: 65139.4087; val_edge_recon_loss: 25756092.2439; val_gene_expr_recon_loss: 9662206.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35483438.4390; val_optim_loss: 35483438.4390
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9897; val_auprc_score: 0.9866; val_best_acc_score: 0.9647; val_best_f1_score: 0.9656; train_kl_reg_loss: 65127.3413; train_edge_recon_loss: 25644067.7174; train_gene_expr_recon_loss: 9486437.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35195632.0978; train_optim_loss: 35195632.0978; val_kl_reg_loss: 64152.1211; val_edge_recon_loss: 25742722.0976; val_gene_expr_recon_loss: 9613540.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35420414.3415; val_optim_loss: 35420414.3415
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9902; val_auprc_score: 0.9872; val_best_acc_score: 0.9658; val_best_f1_score: 0.9666; train_kl_reg_loss: 63512.8244; train_edge_recon_loss: 25648028.3478; train_gene_expr_recon_loss: 9466364.7717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35177905.8587; train_optim_loss: 35177905.8587; val_kl_reg_loss: 61409.6964; val_edge_recon_loss: 25710378.3415; val_gene_expr_recon_loss: 9640243.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35412031.3171; val_optim_loss: 35412031.3171
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9898; val_auprc_score: 0.9863; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 62601.2931; train_edge_recon_loss: 25643497.6250; train_gene_expr_recon_loss: 9439688.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35145787.5326; train_optim_loss: 35145787.5326; val_kl_reg_loss: 60505.4795; val_edge_recon_loss: 25726589.2683; val_gene_expr_recon_loss: 9628926.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35416020.9756; val_optim_loss: 35416020.9756
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9903; val_auprc_score: 0.9864; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 61190.3535; train_edge_recon_loss: 25624428.4402; train_gene_expr_recon_loss: 9416929.9592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35102548.7065; train_optim_loss: 35102548.7065; val_kl_reg_loss: 60088.8361; val_edge_recon_loss: 25738423.1220; val_gene_expr_recon_loss: 9614034.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35412546.9268; val_optim_loss: 35412546.9268
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9902; val_auprc_score: 0.9872; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 61206.1911; train_edge_recon_loss: 25623138.1196; train_gene_expr_recon_loss: 9389727.2962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35074071.5870; train_optim_loss: 35074071.5870; val_kl_reg_loss: 59302.9862; val_edge_recon_loss: 25719608.7805; val_gene_expr_recon_loss: 9619376.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35398288.4878; val_optim_loss: 35398288.4878
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 60346.6582; train_edge_recon_loss: 25609349.7500; train_gene_expr_recon_loss: 9362934.1114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35032630.5326; train_optim_loss: 35032630.5326; val_kl_reg_loss: 60009.0243; val_edge_recon_loss: 25669796.8780; val_gene_expr_recon_loss: 9596867.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35326673.5610; val_optim_loss: 35326673.5610
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 59586.0251; train_edge_recon_loss: 25608896.4402; train_gene_expr_recon_loss: 9350426.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018908.7717; train_optim_loss: 35018908.7717; val_kl_reg_loss: 59132.4561; val_edge_recon_loss: 25693203.8049; val_gene_expr_recon_loss: 9609427.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35361763.5122; val_optim_loss: 35361763.5122
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9890; val_best_acc_score: 0.9696; val_best_f1_score: 0.9702; train_kl_reg_loss: 59054.7803; train_edge_recon_loss: 25606788.1630; train_gene_expr_recon_loss: 9327322.8696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34993165.7935; train_optim_loss: 34993165.7935; val_kl_reg_loss: 58484.3591; val_edge_recon_loss: 25694363.7561; val_gene_expr_recon_loss: 9590342.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35343190.7317; val_optim_loss: 35343190.7317
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9915; val_auprc_score: 0.9884; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 58686.8492; train_edge_recon_loss: 25599650.9837; train_gene_expr_recon_loss: 9310582.2527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34968920.0870; train_optim_loss: 34968920.0870; val_kl_reg_loss: 59376.2167; val_edge_recon_loss: 25682119.9512; val_gene_expr_recon_loss: 9605871.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35347368.0976; val_optim_loss: 35347368.0976
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 58616.8146; train_edge_recon_loss: 25600758.7772; train_gene_expr_recon_loss: 9287452.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34946828.5000; train_optim_loss: 34946828.5000; val_kl_reg_loss: 57367.3890; val_edge_recon_loss: 25672361.6098; val_gene_expr_recon_loss: 9619192.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35348921.4634; val_optim_loss: 35348921.4634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 59918.0203; train_edge_recon_loss: 25595732.4837; train_gene_expr_recon_loss: 9219093.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34874744.2935; train_optim_loss: 34874744.2935; val_kl_reg_loss: 59853.6964; val_edge_recon_loss: 25687969.8537; val_gene_expr_recon_loss: 9554900.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302723.9024; val_optim_loss: 35302723.9024
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 61531.8187; train_edge_recon_loss: 25577653.7228; train_gene_expr_recon_loss: 9200997.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34840183.2174; train_optim_loss: 34840183.2174; val_kl_reg_loss: 60571.3293; val_edge_recon_loss: 25679127.8049; val_gene_expr_recon_loss: 9561905.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301604.2927; val_optim_loss: 35301604.2927
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 61956.4517; train_edge_recon_loss: 25582879.3152; train_gene_expr_recon_loss: 9198182.6495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34843018.3696; train_optim_loss: 34843018.3696; val_kl_reg_loss: 60994.9822; val_edge_recon_loss: 25619013.3171; val_gene_expr_recon_loss: 9594951.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274959.9024; val_optim_loss: 35274959.9024
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 62301.4741; train_edge_recon_loss: 25582388.4674; train_gene_expr_recon_loss: 9191908.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34836598.0870; train_optim_loss: 34836598.0870; val_kl_reg_loss: 61379.1720; val_edge_recon_loss: 25639966.5854; val_gene_expr_recon_loss: 9565175.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35266520.9756; val_optim_loss: 35266520.9756
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 62379.5466; train_edge_recon_loss: 25588686.6630; train_gene_expr_recon_loss: 9187981.2120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34839047.4457; train_optim_loss: 34839047.4457; val_kl_reg_loss: 61097.5894; val_edge_recon_loss: 25678589.2195; val_gene_expr_recon_loss: 9555887.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35295574.6341; val_optim_loss: 35295574.6341
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 62256.2675; train_edge_recon_loss: 25573098.2500; train_gene_expr_recon_loss: 9189303.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34824658.3587; train_optim_loss: 34824658.3587; val_kl_reg_loss: 61382.6076; val_edge_recon_loss: 25664059.0244; val_gene_expr_recon_loss: 9569739.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35295180.7805; val_optim_loss: 35295180.7805
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9715; val_best_f1_score: 0.9720; train_kl_reg_loss: 62300.3905; train_edge_recon_loss: 25581716.5326; train_gene_expr_recon_loss: 9185834.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34829851.4130; train_optim_loss: 34829851.4130; val_kl_reg_loss: 61416.0005; val_edge_recon_loss: 25646071.8049; val_gene_expr_recon_loss: 9582311.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289799.8049; val_optim_loss: 35289799.8049
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9916; val_auprc_score: 0.9886; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 62436.6795; train_edge_recon_loss: 25584226.9783; train_gene_expr_recon_loss: 9182587.4620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34829251.2391; train_optim_loss: 34829251.2391; val_kl_reg_loss: 61386.9152; val_edge_recon_loss: 25652587.0244; val_gene_expr_recon_loss: 9566528.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280502.6341; val_optim_loss: 35280502.6341

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9695; val_best_f1_score: 0.9701; train_kl_reg_loss: 62439.2248; train_edge_recon_loss: 25582463.7663; train_gene_expr_recon_loss: 9177285.3777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34822188.3804; train_optim_loss: 34822188.3804; val_kl_reg_loss: 61372.3979; val_edge_recon_loss: 25669739.9512; val_gene_expr_recon_loss: 9539547.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270659.5122; val_optim_loss: 35270659.5122
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9913; val_auprc_score: 0.9880; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 62510.5678; train_edge_recon_loss: 25564650.7826; train_gene_expr_recon_loss: 9169525.2554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34796686.6739; train_optim_loss: 34796686.6739; val_kl_reg_loss: 61582.9816; val_edge_recon_loss: 25672930.6341; val_gene_expr_recon_loss: 9553175.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35287688.6829; val_optim_loss: 35287688.6829
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9920; val_auprc_score: 0.9893; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 62630.4345; train_edge_recon_loss: 25573275.2391; train_gene_expr_recon_loss: 9170132.0408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34806037.5761; train_optim_loss: 34806037.5761; val_kl_reg_loss: 61536.7504; val_edge_recon_loss: 25663523.6098; val_gene_expr_recon_loss: 9548983.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274043.7073; val_optim_loss: 35274043.7073
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9918; val_auprc_score: 0.9887; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 62661.2191; train_edge_recon_loss: 25571872.9348; train_gene_expr_recon_loss: 9165418.9103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34799952.9783; train_optim_loss: 34799952.9783; val_kl_reg_loss: 61588.1698; val_edge_recon_loss: 25652545.3171; val_gene_expr_recon_loss: 9564501.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278634.6341; val_optim_loss: 35278634.6341

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 117 min 26 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9912
Val AUPRC score: 0.9878
Val best accuracy score: 0.9697
Val best F1 score: 0.9703
Val gene expr MSE score: 0.6144

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
