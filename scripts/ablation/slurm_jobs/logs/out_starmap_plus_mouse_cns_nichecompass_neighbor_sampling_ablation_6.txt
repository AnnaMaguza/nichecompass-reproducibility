None
Run timestamp: 12072023_130422_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 1094923
Number of validation edges: 121658
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9901; val_auprc_score: 0.9870; val_best_acc_score: 0.9633; val_best_f1_score: 0.9640; train_kl_reg_loss: 7585.8739; train_edge_recon_loss: 264452.8439; train_gene_expr_recon_loss: 118765.3494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390804.0671; train_optim_loss: 390804.0671; val_kl_reg_loss: 7276.0976; val_edge_recon_loss: 259883.7916; val_gene_expr_recon_loss: 108943.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376103.5538; val_optim_loss: 376103.5538
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 7032.0382; train_edge_recon_loss: 260094.6127; train_gene_expr_recon_loss: 105944.0605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373070.7115; train_optim_loss: 373070.7115; val_kl_reg_loss: 6912.0969; val_edge_recon_loss: 258898.7337; val_gene_expr_recon_loss: 103865.2145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369676.0449; val_optim_loss: 369676.0449
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 6773.4966; train_edge_recon_loss: 259265.7424; train_gene_expr_recon_loss: 102363.6765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368402.9155; train_optim_loss: 368402.9155; val_kl_reg_loss: 6636.9809; val_edge_recon_loss: 258162.5101; val_gene_expr_recon_loss: 101638.4837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366437.9743; val_optim_loss: 366437.9743
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 6624.4768; train_edge_recon_loss: 258655.9565; train_gene_expr_recon_loss: 100497.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365777.9462; train_optim_loss: 365777.9462; val_kl_reg_loss: 6443.5999; val_edge_recon_loss: 257590.6333; val_gene_expr_recon_loss: 100225.6855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364259.9181; val_optim_loss: 364259.9181
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6509.9127; train_edge_recon_loss: 258325.3249; train_gene_expr_recon_loss: 99422.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364257.3528; train_optim_loss: 364257.3528; val_kl_reg_loss: 6432.5091; val_edge_recon_loss: 257110.6704; val_gene_expr_recon_loss: 99414.5011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362957.6801; val_optim_loss: 362957.6801
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 6450.1211; train_edge_recon_loss: 257808.2966; train_gene_expr_recon_loss: 98677.6925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362936.1104; train_optim_loss: 362936.1104; val_kl_reg_loss: 6412.0361; val_edge_recon_loss: 256640.6400; val_gene_expr_recon_loss: 98969.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362021.8763; val_optim_loss: 362021.8763
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 6401.3655; train_edge_recon_loss: 257553.0816; train_gene_expr_recon_loss: 98175.6245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362130.0715; train_optim_loss: 362130.0715; val_kl_reg_loss: 6470.2790; val_edge_recon_loss: 256396.2357; val_gene_expr_recon_loss: 98649.5270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361516.0415; val_optim_loss: 361516.0415
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 6367.9700; train_edge_recon_loss: 257343.2475; train_gene_expr_recon_loss: 97809.4675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361520.6845; train_optim_loss: 361520.6845; val_kl_reg_loss: 6407.7614; val_edge_recon_loss: 256490.3487; val_gene_expr_recon_loss: 98086.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360984.5617; val_optim_loss: 360984.5617
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6347.8293; train_edge_recon_loss: 257152.4884; train_gene_expr_recon_loss: 97487.7548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360988.0713; train_optim_loss: 360988.0713; val_kl_reg_loss: 6379.2925; val_edge_recon_loss: 256325.9504; val_gene_expr_recon_loss: 97888.0184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360593.2605; val_optim_loss: 360593.2605
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6328.8481; train_edge_recon_loss: 257044.9298; train_gene_expr_recon_loss: 97274.1244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360647.9028; train_optim_loss: 360647.9028; val_kl_reg_loss: 6315.5294; val_edge_recon_loss: 256137.1698; val_gene_expr_recon_loss: 97878.6312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360331.3306; val_optim_loss: 360331.3306
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6317.5924; train_edge_recon_loss: 256895.9269; train_gene_expr_recon_loss: 96986.5988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360200.1178; train_optim_loss: 360200.1178; val_kl_reg_loss: 6265.3451; val_edge_recon_loss: 255915.7067; val_gene_expr_recon_loss: 97639.7470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359820.8002; val_optim_loss: 359820.8002
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6316.6335; train_edge_recon_loss: 256711.8454; train_gene_expr_recon_loss: 96831.4587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359859.9376; train_optim_loss: 359859.9376; val_kl_reg_loss: 6310.4598; val_edge_recon_loss: 255747.9056; val_gene_expr_recon_loss: 97446.8647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359505.2298; val_optim_loss: 359505.2298
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6311.2157; train_edge_recon_loss: 256642.0927; train_gene_expr_recon_loss: 96681.7885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359635.0976; train_optim_loss: 359635.0976; val_kl_reg_loss: 6359.0417; val_edge_recon_loss: 255728.4772; val_gene_expr_recon_loss: 97418.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359505.9945; val_optim_loss: 359505.9945
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9866; val_best_f1_score: 0.9868; train_kl_reg_loss: 6304.8448; train_edge_recon_loss: 256492.0237; train_gene_expr_recon_loss: 96498.9761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359295.8449; train_optim_loss: 359295.8449; val_kl_reg_loss: 6301.0330; val_edge_recon_loss: 255796.6312; val_gene_expr_recon_loss: 97340.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359438.5864; val_optim_loss: 359438.5864
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6301.6599; train_edge_recon_loss: 256478.9909; train_gene_expr_recon_loss: 96376.2047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359156.8561; train_optim_loss: 359156.8561; val_kl_reg_loss: 6316.8995; val_edge_recon_loss: 255577.1922; val_gene_expr_recon_loss: 97266.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359160.8149; val_optim_loss: 359160.8149
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9871; val_best_f1_score: 0.9873; train_kl_reg_loss: 6305.5157; train_edge_recon_loss: 256429.6201; train_gene_expr_recon_loss: 96232.5913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358967.7270; train_optim_loss: 358967.7270; val_kl_reg_loss: 6237.0539; val_edge_recon_loss: 255472.5839; val_gene_expr_recon_loss: 97307.6497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359017.2881; val_optim_loss: 359017.2881
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6302.0805; train_edge_recon_loss: 256411.1029; train_gene_expr_recon_loss: 96167.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358880.8278; train_optim_loss: 358880.8278; val_kl_reg_loss: 6274.6247; val_edge_recon_loss: 255513.5382; val_gene_expr_recon_loss: 97063.3095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358851.4735; val_optim_loss: 358851.4735
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9981; val_auprc_score: 0.9972; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6307.4772; train_edge_recon_loss: 256264.7680; train_gene_expr_recon_loss: 96011.3598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358583.6053; train_optim_loss: 358583.6053; val_kl_reg_loss: 6234.1369; val_edge_recon_loss: 255493.7143; val_gene_expr_recon_loss: 97011.3318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358739.1830; val_optim_loss: 358739.1830
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6304.4820; train_edge_recon_loss: 256250.5586; train_gene_expr_recon_loss: 95917.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358472.8592; train_optim_loss: 358472.8592; val_kl_reg_loss: 6305.3984; val_edge_recon_loss: 255538.0454; val_gene_expr_recon_loss: 96999.4328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358842.8768; val_optim_loss: 358842.8768
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6305.4986; train_edge_recon_loss: 256117.2973; train_gene_expr_recon_loss: 95739.5487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358162.3443; train_optim_loss: 358162.3443; val_kl_reg_loss: 6353.1766; val_edge_recon_loss: 255175.8944; val_gene_expr_recon_loss: 96021.5794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357550.6502; val_optim_loss: 357550.6502
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6303.9129; train_edge_recon_loss: 256208.5505; train_gene_expr_recon_loss: 95645.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358157.8989; train_optim_loss: 358157.8989; val_kl_reg_loss: 6310.5667; val_edge_recon_loss: 255257.6699; val_gene_expr_recon_loss: 96686.9855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358255.2222; val_optim_loss: 358255.2222
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 6305.6678; train_edge_recon_loss: 256129.0362; train_gene_expr_recon_loss: 95480.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357915.0855; train_optim_loss: 357915.0855; val_kl_reg_loss: 6339.9997; val_edge_recon_loss: 255358.4133; val_gene_expr_recon_loss: 96534.6830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358233.0953; val_optim_loss: 358233.0953
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 6311.9407; train_edge_recon_loss: 256061.2359; train_gene_expr_recon_loss: 95251.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357624.8055; train_optim_loss: 357624.8055; val_kl_reg_loss: 6276.0001; val_edge_recon_loss: 255302.3473; val_gene_expr_recon_loss: 96578.5020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358156.8506; val_optim_loss: 358156.8506
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 6310.5063; train_edge_recon_loss: 256010.4239; train_gene_expr_recon_loss: 95225.4751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357546.4057; train_optim_loss: 357546.4057; val_kl_reg_loss: 6315.3951; val_edge_recon_loss: 255317.8770; val_gene_expr_recon_loss: 96033.3133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357666.5859; val_optim_loss: 357666.5859

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9896; val_best_f1_score: 0.9896; train_kl_reg_loss: 6318.7900; train_edge_recon_loss: 255817.0949; train_gene_expr_recon_loss: 94531.2339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356667.1190; train_optim_loss: 356667.1190; val_kl_reg_loss: 6307.7383; val_edge_recon_loss: 254988.4190; val_gene_expr_recon_loss: 94078.7151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355374.8708; val_optim_loss: 355374.8708
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 6312.4781; train_edge_recon_loss: 255832.3847; train_gene_expr_recon_loss: 94526.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356671.5733; train_optim_loss: 356671.5733; val_kl_reg_loss: 6277.0391; val_edge_recon_loss: 255029.4932; val_gene_expr_recon_loss: 101358.8879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362665.4210; val_optim_loss: 362665.4210
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9899; val_best_f1_score: 0.9900; train_kl_reg_loss: 6310.6366; train_edge_recon_loss: 255864.7704; train_gene_expr_recon_loss: 94372.5759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356547.9828; train_optim_loss: 356547.9828; val_kl_reg_loss: 6317.1523; val_edge_recon_loss: 255044.0302; val_gene_expr_recon_loss: 94136.5400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355497.7240; val_optim_loss: 355497.7240
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 6310.8335; train_edge_recon_loss: 255785.5931; train_gene_expr_recon_loss: 94303.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356399.4961; train_optim_loss: 356399.4961; val_kl_reg_loss: 6268.7457; val_edge_recon_loss: 254943.2726; val_gene_expr_recon_loss: 95302.2686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356514.2868; val_optim_loss: 356514.2868
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 6306.2914; train_edge_recon_loss: 255853.9479; train_gene_expr_recon_loss: 94331.9346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356492.1744; train_optim_loss: 356492.1744; val_kl_reg_loss: 6315.4767; val_edge_recon_loss: 255079.6713; val_gene_expr_recon_loss: 97641.7672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359036.9126; val_optim_loss: 359036.9126

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9900; val_best_f1_score: 0.9900; train_kl_reg_loss: 6311.8855; train_edge_recon_loss: 255830.4370; train_gene_expr_recon_loss: 93112.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355254.5037; train_optim_loss: 355254.5037; val_kl_reg_loss: 6304.8904; val_edge_recon_loss: 255028.9062; val_gene_expr_recon_loss: 96370.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357703.9233; val_optim_loss: 357703.9233
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 6310.0293; train_edge_recon_loss: 255818.5485; train_gene_expr_recon_loss: 94831.3386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356959.9158; train_optim_loss: 356959.9158; val_kl_reg_loss: 6290.7223; val_edge_recon_loss: 255057.9544; val_gene_expr_recon_loss: 95564.5892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356913.2650; val_optim_loss: 356913.2650
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9898; val_best_f1_score: 0.9899; train_kl_reg_loss: 6307.1265; train_edge_recon_loss: 255842.1573; train_gene_expr_recon_loss: 95112.5087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357261.7928; train_optim_loss: 357261.7928; val_kl_reg_loss: 6303.8923; val_edge_recon_loss: 254957.5474; val_gene_expr_recon_loss: 99045.0643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360306.5050; val_optim_loss: 360306.5050
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 6308.5967; train_edge_recon_loss: 255830.7532; train_gene_expr_recon_loss: 93691.5143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355830.8641; train_optim_loss: 355830.8641; val_kl_reg_loss: 6293.6750; val_edge_recon_loss: 255188.6518; val_gene_expr_recon_loss: 96243.4519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357725.7786; val_optim_loss: 357725.7786

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 313 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9984
Val AUPRC score: 0.9980
Val best accuracy score: 0.9894
Val best F1 score: 0.9895
Val gene expr MSE score: 0.6547

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
