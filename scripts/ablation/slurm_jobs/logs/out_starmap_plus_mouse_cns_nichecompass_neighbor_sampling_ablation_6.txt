None
Run timestamp: 04082023_180945_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9826; val_auprc_score: 0.9762; val_best_acc_score: 0.9487; val_best_f1_score: 0.9499; train_kl_reg_loss: 7465.2846; train_edge_recon_loss: 272991.9015; train_gene_expr_recon_loss: 221832.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 502289.7524; train_optim_loss: 502289.7524; val_kl_reg_loss: 7647.7115; val_edge_recon_loss: 262385.8491; val_gene_expr_recon_loss: 201889.6612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 471923.2210; val_optim_loss: 471923.2210
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9858; val_auprc_score: 0.9808; val_best_acc_score: 0.9556; val_best_f1_score: 0.9568; train_kl_reg_loss: 7555.6903; train_edge_recon_loss: 261990.0750; train_gene_expr_recon_loss: 196540.7480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 466086.5138; train_optim_loss: 466086.5138; val_kl_reg_loss: 7232.4912; val_edge_recon_loss: 261329.4402; val_gene_expr_recon_loss: 191734.8575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 460296.7889; val_optim_loss: 460296.7889
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9878; val_auprc_score: 0.9837; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 7241.0101; train_edge_recon_loss: 260947.6164; train_gene_expr_recon_loss: 188536.4938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 456725.1200; train_optim_loss: 456725.1200; val_kl_reg_loss: 6918.2719; val_edge_recon_loss: 260781.0248; val_gene_expr_recon_loss: 185455.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 453155.2302; val_optim_loss: 453155.2302
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9895; val_auprc_score: 0.9857; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 7085.6827; train_edge_recon_loss: 260459.8367; train_gene_expr_recon_loss: 183293.4952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 450839.0148; train_optim_loss: 450839.0148; val_kl_reg_loss: 6893.3198; val_edge_recon_loss: 260050.7260; val_gene_expr_recon_loss: 181362.1071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448306.1524; val_optim_loss: 448306.1524
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 6983.2748; train_edge_recon_loss: 259991.6672; train_gene_expr_recon_loss: 179728.9640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446703.9068; train_optim_loss: 446703.9068; val_kl_reg_loss: 6772.4745; val_edge_recon_loss: 259823.3392; val_gene_expr_recon_loss: 178437.3552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445033.1677; val_optim_loss: 445033.1677
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9912; val_auprc_score: 0.9886; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 6900.9341; train_edge_recon_loss: 259640.8803; train_gene_expr_recon_loss: 176951.8402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443493.6539; train_optim_loss: 443493.6539; val_kl_reg_loss: 6739.8637; val_edge_recon_loss: 259391.3697; val_gene_expr_recon_loss: 176331.2081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442462.4428; val_optim_loss: 442462.4428
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9920; val_auprc_score: 0.9896; val_best_acc_score: 0.9692; val_best_f1_score: 0.9698; train_kl_reg_loss: 6845.0126; train_edge_recon_loss: 259369.8478; train_gene_expr_recon_loss: 175035.0245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441249.8854; train_optim_loss: 441249.8854; val_kl_reg_loss: 6742.4944; val_edge_recon_loss: 259196.6875; val_gene_expr_recon_loss: 174885.0358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440824.2188; val_optim_loss: 440824.2188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 6796.0866; train_edge_recon_loss: 259053.7700; train_gene_expr_recon_loss: 173555.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439405.6828; train_optim_loss: 439405.6828; val_kl_reg_loss: 6656.8986; val_edge_recon_loss: 258749.4962; val_gene_expr_recon_loss: 173517.1864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438923.5793; val_optim_loss: 438923.5793
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 6755.4995; train_edge_recon_loss: 258772.3929; train_gene_expr_recon_loss: 172296.3060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437824.1977; train_optim_loss: 437824.1977; val_kl_reg_loss: 6611.7358; val_edge_recon_loss: 258487.4150; val_gene_expr_recon_loss: 172286.6734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437385.8186; val_optim_loss: 437385.8186
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9902; val_best_acc_score: 0.9719; val_best_f1_score: 0.9724; train_kl_reg_loss: 6732.7001; train_edge_recon_loss: 258651.9974; train_gene_expr_recon_loss: 171328.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436712.9181; train_optim_loss: 436712.9181; val_kl_reg_loss: 6615.8035; val_edge_recon_loss: 258657.3133; val_gene_expr_recon_loss: 171765.8338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437038.9482; val_optim_loss: 437038.9482
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9900; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 6715.3628; train_edge_recon_loss: 258490.7926; train_gene_expr_recon_loss: 170269.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435475.4931; train_optim_loss: 435475.4931; val_kl_reg_loss: 6713.8874; val_edge_recon_loss: 258375.7039; val_gene_expr_recon_loss: 170849.6730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435939.2607; val_optim_loss: 435939.2607
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9911; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 6694.1501; train_edge_recon_loss: 258460.3677; train_gene_expr_recon_loss: 169629.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434784.4077; train_optim_loss: 434784.4077; val_kl_reg_loss: 6620.5722; val_edge_recon_loss: 258171.5621; val_gene_expr_recon_loss: 170300.6673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435092.8003; val_optim_loss: 435092.8003
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 6693.1605; train_edge_recon_loss: 258184.8916; train_gene_expr_recon_loss: 168968.4993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433846.5515; train_optim_loss: 433846.5515; val_kl_reg_loss: 6646.0381; val_edge_recon_loss: 258109.8998; val_gene_expr_recon_loss: 169402.9238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434158.8582; val_optim_loss: 434158.8582
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 6680.7152; train_edge_recon_loss: 258102.8503; train_gene_expr_recon_loss: 168468.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433252.5566; train_optim_loss: 433252.5566; val_kl_reg_loss: 6614.0996; val_edge_recon_loss: 258165.7069; val_gene_expr_recon_loss: 169101.3357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433881.1425; val_optim_loss: 433881.1425
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9941; val_auprc_score: 0.9925; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 6673.6071; train_edge_recon_loss: 258067.1101; train_gene_expr_recon_loss: 167914.3669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432655.0846; train_optim_loss: 432655.0846; val_kl_reg_loss: 6644.1238; val_edge_recon_loss: 258207.6380; val_gene_expr_recon_loss: 168547.6616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433399.4215; val_optim_loss: 433399.4215
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 6685.3611; train_edge_recon_loss: 257849.1425; train_gene_expr_recon_loss: 167515.7534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432050.2552; train_optim_loss: 432050.2552; val_kl_reg_loss: 6581.9131; val_edge_recon_loss: 257749.4036; val_gene_expr_recon_loss: 168719.0861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433050.4017; val_optim_loss: 433050.4017
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 6678.0998; train_edge_recon_loss: 257770.8837; train_gene_expr_recon_loss: 167161.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431610.4524; train_optim_loss: 431610.4524; val_kl_reg_loss: 6612.1268; val_edge_recon_loss: 257747.1120; val_gene_expr_recon_loss: 168613.4905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432972.7302; val_optim_loss: 432972.7302
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 6675.2220; train_edge_recon_loss: 257714.6437; train_gene_expr_recon_loss: 166860.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431250.4690; train_optim_loss: 431250.4690; val_kl_reg_loss: 6561.5005; val_edge_recon_loss: 257650.5038; val_gene_expr_recon_loss: 168323.7329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432535.7386; val_optim_loss: 432535.7386
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9767; val_best_f1_score: 0.9771; train_kl_reg_loss: 6680.0367; train_edge_recon_loss: 257613.9256; train_gene_expr_recon_loss: 166471.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430765.2250; train_optim_loss: 430765.2250; val_kl_reg_loss: 6573.2518; val_edge_recon_loss: 257698.4596; val_gene_expr_recon_loss: 168116.7058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432388.4200; val_optim_loss: 432388.4200
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 6680.8704; train_edge_recon_loss: 257610.0565; train_gene_expr_recon_loss: 166289.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430580.1666; train_optim_loss: 430580.1666; val_kl_reg_loss: 6581.0018; val_edge_recon_loss: 257478.6860; val_gene_expr_recon_loss: 167976.7397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432036.4238; val_optim_loss: 432036.4238
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9931; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 6695.3539; train_edge_recon_loss: 257485.0014; train_gene_expr_recon_loss: 165961.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430142.0038; train_optim_loss: 430142.0038; val_kl_reg_loss: 6609.2125; val_edge_recon_loss: 257093.7980; val_gene_expr_recon_loss: 167831.2508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431534.2599; val_optim_loss: 431534.2599
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 6699.3920; train_edge_recon_loss: 257341.6163; train_gene_expr_recon_loss: 165820.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429861.0435; train_optim_loss: 429861.0435; val_kl_reg_loss: 6634.0632; val_edge_recon_loss: 257471.6258; val_gene_expr_recon_loss: 167752.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431858.5648; val_optim_loss: 431858.5648
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9933; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 6699.4970; train_edge_recon_loss: 257408.8166; train_gene_expr_recon_loss: 165444.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429552.8218; train_optim_loss: 429552.8218; val_kl_reg_loss: 6620.0260; val_edge_recon_loss: 257266.2744; val_gene_expr_recon_loss: 167425.2435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431311.5442; val_optim_loss: 431311.5442
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 6707.5370; train_edge_recon_loss: 257408.4111; train_gene_expr_recon_loss: 165277.2414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429393.1887; train_optim_loss: 429393.1887; val_kl_reg_loss: 6645.0459; val_edge_recon_loss: 257388.2107; val_gene_expr_recon_loss: 167426.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431460.0998; val_optim_loss: 431460.0998
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 6715.7213; train_edge_recon_loss: 257284.2145; train_gene_expr_recon_loss: 165314.4907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429314.4258; train_optim_loss: 429314.4258; val_kl_reg_loss: 6619.6067; val_edge_recon_loss: 257532.5938; val_gene_expr_recon_loss: 167855.6246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432007.8247; val_optim_loss: 432007.8247
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 6721.9013; train_edge_recon_loss: 257307.8922; train_gene_expr_recon_loss: 165067.4073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429097.2007; train_optim_loss: 429097.2007; val_kl_reg_loss: 6613.3032; val_edge_recon_loss: 257487.3327; val_gene_expr_recon_loss: 167367.9040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431468.5412; val_optim_loss: 431468.5412
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6727.2228; train_edge_recon_loss: 257314.0422; train_gene_expr_recon_loss: 164827.1972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428868.4614; train_optim_loss: 428868.4614; val_kl_reg_loss: 6636.6128; val_edge_recon_loss: 257167.9375; val_gene_expr_recon_loss: 167666.2279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431470.7767; val_optim_loss: 431470.7767

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6734.2842; train_edge_recon_loss: 257012.8328; train_gene_expr_recon_loss: 164140.3071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427887.4224; train_optim_loss: 427887.4224; val_kl_reg_loss: 6654.4205; val_edge_recon_loss: 257276.4554; val_gene_expr_recon_loss: 167120.5549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431051.4261; val_optim_loss: 431051.4261
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 6729.3948; train_edge_recon_loss: 257053.5092; train_gene_expr_recon_loss: 164162.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427945.2914; train_optim_loss: 427945.2914; val_kl_reg_loss: 6658.5381; val_edge_recon_loss: 256926.6014; val_gene_expr_recon_loss: 167293.2466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430878.3849; val_optim_loss: 430878.3849
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 6735.8364; train_edge_recon_loss: 256936.6920; train_gene_expr_recon_loss: 164055.5293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427728.0579; train_optim_loss: 427728.0579; val_kl_reg_loss: 6655.3486; val_edge_recon_loss: 257382.1547; val_gene_expr_recon_loss: 167146.3586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431183.8643; val_optim_loss: 431183.8643
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 6729.0600; train_edge_recon_loss: 256997.1848; train_gene_expr_recon_loss: 163944.0892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427670.3329; train_optim_loss: 427670.3329; val_kl_reg_loss: 6645.2354; val_edge_recon_loss: 257007.8296; val_gene_expr_recon_loss: 166957.3498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430610.4131; val_optim_loss: 430610.4131
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 6734.1150; train_edge_recon_loss: 256936.6173; train_gene_expr_recon_loss: 163853.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427523.7979; train_optim_loss: 427523.7979; val_kl_reg_loss: 6647.7464; val_edge_recon_loss: 256945.3098; val_gene_expr_recon_loss: 167419.8018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431012.8582; val_optim_loss: 431012.8582
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6729.7699; train_edge_recon_loss: 257033.7961; train_gene_expr_recon_loss: 163974.3530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427737.9187; train_optim_loss: 427737.9187; val_kl_reg_loss: 6661.6316; val_edge_recon_loss: 257230.7039; val_gene_expr_recon_loss: 167367.5659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431259.8994; val_optim_loss: 431259.8994
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6731.5969; train_edge_recon_loss: 256958.2356; train_gene_expr_recon_loss: 163866.2998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427556.1329; train_optim_loss: 427556.1329; val_kl_reg_loss: 6652.2565; val_edge_recon_loss: 257043.3971; val_gene_expr_recon_loss: 167124.4821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430820.1364; val_optim_loss: 430820.1364
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 6729.9782; train_edge_recon_loss: 256975.6077; train_gene_expr_recon_loss: 163882.3916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427587.9776; train_optim_loss: 427587.9776; val_kl_reg_loss: 6655.3851; val_edge_recon_loss: 257005.6745; val_gene_expr_recon_loss: 167041.7893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430702.8491; val_optim_loss: 430702.8491

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 6727.9867; train_edge_recon_loss: 257018.4343; train_gene_expr_recon_loss: 163671.0907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427417.5113; train_optim_loss: 427417.5113; val_kl_reg_loss: 6644.7294; val_edge_recon_loss: 256974.8163; val_gene_expr_recon_loss: 167302.2664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430921.8102; val_optim_loss: 430921.8102
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6730.3100; train_edge_recon_loss: 256940.7957; train_gene_expr_recon_loss: 163766.5766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427437.6825; train_optim_loss: 427437.6825; val_kl_reg_loss: 6657.1880; val_edge_recon_loss: 257177.3735; val_gene_expr_recon_loss: 167227.8365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431062.4002; val_optim_loss: 431062.4002
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 6728.0796; train_edge_recon_loss: 256985.7224; train_gene_expr_recon_loss: 163727.3498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427441.1510; train_optim_loss: 427441.1510; val_kl_reg_loss: 6651.1629; val_edge_recon_loss: 257013.1902; val_gene_expr_recon_loss: 167362.0309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431026.3834; val_optim_loss: 431026.3834
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 6729.4678; train_edge_recon_loss: 256943.9679; train_gene_expr_recon_loss: 163734.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427407.8298; train_optim_loss: 427407.8298; val_kl_reg_loss: 6652.3813; val_edge_recon_loss: 256877.1456; val_gene_expr_recon_loss: 167416.9447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430946.4703; val_optim_loss: 430946.4703

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 95 min 1 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9957
val AUPRC score: 0.9940
val best accuracy score: 0.9805
val best F1 score: 0.9807
val target rna MSE score: 0.6336
val source rna MSE score: 0.0568

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
