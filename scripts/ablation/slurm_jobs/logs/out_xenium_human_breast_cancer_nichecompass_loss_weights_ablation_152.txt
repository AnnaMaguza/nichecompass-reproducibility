None
Run timestamp: 15072023_012337_152.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_152']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9605; val_auprc_score: 0.9536; val_best_acc_score: 0.8971; val_best_f1_score: 0.9020; train_kl_reg_loss: 45967.2197; train_edge_recon_loss: 2778737.0885; train_gene_expr_recon_loss: 7127433.1177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9952137.4279; train_optim_loss: 9952137.4279; val_kl_reg_loss: 37858.8237; val_edge_recon_loss: 2693665.1925; val_gene_expr_recon_loss: 6745648.7056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9477172.7422; val_optim_loss: 9477172.7422
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9715; val_auprc_score: 0.9670; val_best_acc_score: 0.9139; val_best_f1_score: 0.9171; train_kl_reg_loss: 35261.0293; train_edge_recon_loss: 2673179.9389; train_gene_expr_recon_loss: 6655444.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9363885.3840; train_optim_loss: 9363885.3840; val_kl_reg_loss: 31568.9273; val_edge_recon_loss: 2674607.7221; val_gene_expr_recon_loss: 6603313.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9309490.0209; val_optim_loss: 9309490.0209
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9773; val_auprc_score: 0.9742; val_best_acc_score: 0.9236; val_best_f1_score: 0.9259; train_kl_reg_loss: 30712.4674; train_edge_recon_loss: 2658966.4326; train_gene_expr_recon_loss: 6574561.5659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9264240.4624; train_optim_loss: 9264240.4624; val_kl_reg_loss: 28658.5170; val_edge_recon_loss: 2663636.5636; val_gene_expr_recon_loss: 6554949.2108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9247244.2979; val_optim_loss: 9247244.2979
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9822; val_auprc_score: 0.9799; val_best_acc_score: 0.9333; val_best_f1_score: 0.9350; train_kl_reg_loss: 28120.6886; train_edge_recon_loss: 2647285.4355; train_gene_expr_recon_loss: 6540981.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9216387.9170; train_optim_loss: 9216387.9170; val_kl_reg_loss: 26802.8458; val_edge_recon_loss: 2653981.2901; val_gene_expr_recon_loss: 6545880.3833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9226664.5087; val_optim_loss: 9226664.5087
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9851; val_auprc_score: 0.9831; val_best_acc_score: 0.9403; val_best_f1_score: 0.9414; train_kl_reg_loss: 26633.1813; train_edge_recon_loss: 2639303.0125; train_gene_expr_recon_loss: 6518906.5062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9184842.7095; train_optim_loss: 9184842.7095; val_kl_reg_loss: 25409.2561; val_edge_recon_loss: 2643851.5949; val_gene_expr_recon_loss: 6530058.5889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9199319.4460; val_optim_loss: 9199319.4460
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9874; val_auprc_score: 0.9857; val_best_acc_score: 0.9463; val_best_f1_score: 0.9473; train_kl_reg_loss: 25703.9435; train_edge_recon_loss: 2633205.1107; train_gene_expr_recon_loss: 6504185.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9163094.9884; train_optim_loss: 9163094.9884; val_kl_reg_loss: 24665.7788; val_edge_recon_loss: 2639447.4869; val_gene_expr_recon_loss: 6518995.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9183108.4007; val_optim_loss: 9183108.4007
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9878; val_auprc_score: 0.9860; val_best_acc_score: 0.9477; val_best_f1_score: 0.9488; train_kl_reg_loss: 25118.8827; train_edge_recon_loss: 2628232.6473; train_gene_expr_recon_loss: 6496579.7880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9149931.3175; train_optim_loss: 9149931.3175; val_kl_reg_loss: 24752.4149; val_edge_recon_loss: 2638015.3458; val_gene_expr_recon_loss: 6503689.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9166457.6864; val_optim_loss: 9166457.6864
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9885; val_auprc_score: 0.9868; val_best_acc_score: 0.9505; val_best_f1_score: 0.9513; train_kl_reg_loss: 24713.0124; train_edge_recon_loss: 2624885.5881; train_gene_expr_recon_loss: 6485523.0945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9135121.6955; train_optim_loss: 9135121.6955; val_kl_reg_loss: 24462.4966; val_edge_recon_loss: 2633627.4146; val_gene_expr_recon_loss: 6514709.7334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9172799.6725; val_optim_loss: 9172799.6725
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9889; val_auprc_score: 0.9872; val_best_acc_score: 0.9518; val_best_f1_score: 0.9528; train_kl_reg_loss: 24360.1846; train_edge_recon_loss: 2622525.7671; train_gene_expr_recon_loss: 6478811.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9125697.2209; train_optim_loss: 9125697.2209; val_kl_reg_loss: 24362.0153; val_edge_recon_loss: 2629783.4756; val_gene_expr_recon_loss: 6503391.8955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9157537.4111; val_optim_loss: 9157537.4111
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9874; val_best_acc_score: 0.9522; val_best_f1_score: 0.9530; train_kl_reg_loss: 24015.6464; train_edge_recon_loss: 2621195.5501; train_gene_expr_recon_loss: 6471372.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9116583.2574; train_optim_loss: 9116583.2574; val_kl_reg_loss: 23470.0046; val_edge_recon_loss: 2634305.4512; val_gene_expr_recon_loss: 6502502.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9160278.4007; val_optim_loss: 9160278.4007
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9542; val_best_f1_score: 0.9549; train_kl_reg_loss: 23675.8796; train_edge_recon_loss: 2620161.7608; train_gene_expr_recon_loss: 6469529.8656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9113367.5031; train_optim_loss: 9113367.5031; val_kl_reg_loss: 23457.8309; val_edge_recon_loss: 2625655.6969; val_gene_expr_recon_loss: 6508446.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9157560.0314; val_optim_loss: 9157560.0314
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9900; val_auprc_score: 0.9886; val_best_acc_score: 0.9541; val_best_f1_score: 0.9548; train_kl_reg_loss: 23446.1900; train_edge_recon_loss: 2617784.2827; train_gene_expr_recon_loss: 6461728.6879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9102959.1614; train_optim_loss: 9102959.1614; val_kl_reg_loss: 23172.1613; val_edge_recon_loss: 2626932.6333; val_gene_expr_recon_loss: 6495688.3049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9145793.0871; val_optim_loss: 9145793.0871
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 23242.8339; train_edge_recon_loss: 2617189.7727; train_gene_expr_recon_loss: 6456904.4742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9097337.0776; train_optim_loss: 9097337.0776; val_kl_reg_loss: 22987.6153; val_edge_recon_loss: 2628054.0314; val_gene_expr_recon_loss: 6495179.6045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9146221.2509; val_optim_loss: 9146221.2509
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9569; val_best_f1_score: 0.9575; train_kl_reg_loss: 23072.5992; train_edge_recon_loss: 2616652.9248; train_gene_expr_recon_loss: 6454200.7473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9093926.2799; train_optim_loss: 9093926.2799; val_kl_reg_loss: 23029.5108; val_edge_recon_loss: 2625000.2326; val_gene_expr_recon_loss: 6484399.7613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9132429.5314; val_optim_loss: 9132429.5314
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9567; val_best_f1_score: 0.9573; train_kl_reg_loss: 22904.0509; train_edge_recon_loss: 2614515.2802; train_gene_expr_recon_loss: 6454027.8419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9091447.1720; train_optim_loss: 9091447.1720; val_kl_reg_loss: 22664.9381; val_edge_recon_loss: 2626420.3571; val_gene_expr_recon_loss: 6496280.8118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9145366.1115; val_optim_loss: 9145366.1115
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9585; val_best_f1_score: 0.9591; train_kl_reg_loss: 22736.3690; train_edge_recon_loss: 2614607.8744; train_gene_expr_recon_loss: 6452170.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9089514.8710; train_optim_loss: 9089514.8710; val_kl_reg_loss: 22595.9595; val_edge_recon_loss: 2619492.5575; val_gene_expr_recon_loss: 6489863.9321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9131952.4495; val_optim_loss: 9131952.4495
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9911; val_auprc_score: 0.9897; val_best_acc_score: 0.9584; val_best_f1_score: 0.9590; train_kl_reg_loss: 22687.8136; train_edge_recon_loss: 2613823.2231; train_gene_expr_recon_loss: 6448089.2818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9084600.3150; train_optim_loss: 9084600.3150; val_kl_reg_loss: 21777.1403; val_edge_recon_loss: 2622213.0758; val_gene_expr_recon_loss: 6494090.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9138080.7770; val_optim_loss: 9138080.7770
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9586; val_best_f1_score: 0.9591; train_kl_reg_loss: 22521.1934; train_edge_recon_loss: 2612988.6930; train_gene_expr_recon_loss: 6444272.7277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9079782.6078; train_optim_loss: 9079782.6078; val_kl_reg_loss: 22890.8467; val_edge_recon_loss: 2624162.9268; val_gene_expr_recon_loss: 6492713.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9139767.5296; val_optim_loss: 9139767.5296
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9914; val_auprc_score: 0.9898; val_best_acc_score: 0.9598; val_best_f1_score: 0.9603; train_kl_reg_loss: 22358.2043; train_edge_recon_loss: 2612940.7757; train_gene_expr_recon_loss: 6441646.7541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9076945.7384; train_optim_loss: 9076945.7384; val_kl_reg_loss: 22612.7776; val_edge_recon_loss: 2621396.7056; val_gene_expr_recon_loss: 6491921.6620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9135931.1429; val_optim_loss: 9135931.1429
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9915; val_auprc_score: 0.9901; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 22304.5202; train_edge_recon_loss: 2611338.1989; train_gene_expr_recon_loss: 6441611.5487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9075254.2630; train_optim_loss: 9075254.2630; val_kl_reg_loss: 22002.1765; val_edge_recon_loss: 2621906.0488; val_gene_expr_recon_loss: 6488601.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9132509.6620; val_optim_loss: 9132509.6620

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9918; val_auprc_score: 0.9905; val_best_acc_score: 0.9604; val_best_f1_score: 0.9609; train_kl_reg_loss: 23650.5300; train_edge_recon_loss: 2609949.8405; train_gene_expr_recon_loss: 6398889.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9032489.8485; train_optim_loss: 9032489.8485; val_kl_reg_loss: 23755.0166; val_edge_recon_loss: 2618330.1237; val_gene_expr_recon_loss: 6461596.0662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9103681.1812; val_optim_loss: 9103681.1812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9920; val_auprc_score: 0.9907; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 24056.6632; train_edge_recon_loss: 2609007.3802; train_gene_expr_recon_loss: 6393881.1164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9026945.1623; train_optim_loss: 9026945.1623; val_kl_reg_loss: 23903.7896; val_edge_recon_loss: 2617316.2300; val_gene_expr_recon_loss: 6453836.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9095056.3937; val_optim_loss: 9095056.3937
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9904; val_best_acc_score: 0.9607; val_best_f1_score: 0.9613; train_kl_reg_loss: 24189.2943; train_edge_recon_loss: 2609017.6622; train_gene_expr_recon_loss: 6392522.3875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9025729.3450; train_optim_loss: 9025729.3450; val_kl_reg_loss: 24050.9633; val_edge_recon_loss: 2617116.3833; val_gene_expr_recon_loss: 6458289.9181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9099457.3031; val_optim_loss: 9099457.3031
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9921; val_auprc_score: 0.9907; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 24247.1208; train_edge_recon_loss: 2608271.2630; train_gene_expr_recon_loss: 6391057.9967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9023576.3776; train_optim_loss: 9023576.3776; val_kl_reg_loss: 23902.9689; val_edge_recon_loss: 2614745.2953; val_gene_expr_recon_loss: 6453570.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092218.6237; val_optim_loss: 9092218.6237
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9910; val_best_acc_score: 0.9618; val_best_f1_score: 0.9624; train_kl_reg_loss: 24252.7479; train_edge_recon_loss: 2607064.3844; train_gene_expr_recon_loss: 6390103.2828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9021420.4151; train_optim_loss: 9021420.4151; val_kl_reg_loss: 23943.8777; val_edge_recon_loss: 2615993.0017; val_gene_expr_recon_loss: 6458212.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9098149.7439; val_optim_loss: 9098149.7439
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9907; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 24213.4535; train_edge_recon_loss: 2607285.0172; train_gene_expr_recon_loss: 6385704.0888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017202.5580; train_optim_loss: 9017202.5580; val_kl_reg_loss: 24187.7350; val_edge_recon_loss: 2616942.9477; val_gene_expr_recon_loss: 6462867.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9103998.0627; val_optim_loss: 9103998.0627
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9922; val_auprc_score: 0.9909; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 24235.4406; train_edge_recon_loss: 2607890.3798; train_gene_expr_recon_loss: 6387218.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9019344.6383; train_optim_loss: 9019344.6383; val_kl_reg_loss: 23904.1745; val_edge_recon_loss: 2615179.2613; val_gene_expr_recon_loss: 6447526.6725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9086610.1220; val_optim_loss: 9086610.1220
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9924; val_auprc_score: 0.9911; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 24222.7009; train_edge_recon_loss: 2606772.4345; train_gene_expr_recon_loss: 6386744.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017739.4738; train_optim_loss: 9017739.4738; val_kl_reg_loss: 23904.6581; val_edge_recon_loss: 2613657.2474; val_gene_expr_recon_loss: 6453030.9843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9090592.8502; val_optim_loss: 9090592.8502
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9921; val_auprc_score: 0.9906; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 24150.9450; train_edge_recon_loss: 2606892.0043; train_gene_expr_recon_loss: 6387082.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9018125.5524; train_optim_loss: 9018125.5524; val_kl_reg_loss: 23865.4332; val_edge_recon_loss: 2616186.5017; val_gene_expr_recon_loss: 6458437.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9098489.2247; val_optim_loss: 9098489.2247
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9911; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 24079.8426; train_edge_recon_loss: 2607685.1848; train_gene_expr_recon_loss: 6385973.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017738.1557; train_optim_loss: 9017738.1557; val_kl_reg_loss: 23866.0696; val_edge_recon_loss: 2616863.9469; val_gene_expr_recon_loss: 6453475.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9094205.7805; val_optim_loss: 9094205.7805
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 24051.7030; train_edge_recon_loss: 2607278.3161; train_gene_expr_recon_loss: 6384734.4820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9016064.4903; train_optim_loss: 9016064.4903; val_kl_reg_loss: 23799.2736; val_edge_recon_loss: 2616838.4512; val_gene_expr_recon_loss: 6443847.6551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9084485.3763; val_optim_loss: 9084485.3763
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9924; val_auprc_score: 0.9911; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 24003.7662; train_edge_recon_loss: 2606832.5601; train_gene_expr_recon_loss: 6386868.3813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9017704.7102; train_optim_loss: 9017704.7102; val_kl_reg_loss: 23720.7414; val_edge_recon_loss: 2617060.4120; val_gene_expr_recon_loss: 6453688.6376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9094469.7805; val_optim_loss: 9094469.7805
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9623; val_best_f1_score: 0.9629; train_kl_reg_loss: 24015.2736; train_edge_recon_loss: 2605627.7404; train_gene_expr_recon_loss: 6386473.3844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9016116.3984; train_optim_loss: 9016116.3984; val_kl_reg_loss: 23711.0182; val_edge_recon_loss: 2616901.6350; val_gene_expr_recon_loss: 6449966.3589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9090579.0000; val_optim_loss: 9090579.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9926; val_auprc_score: 0.9912; val_best_acc_score: 0.9628; val_best_f1_score: 0.9635; train_kl_reg_loss: 23935.5696; train_edge_recon_loss: 2606037.1304; train_gene_expr_recon_loss: 6384116.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9014089.4630; train_optim_loss: 9014089.4630; val_kl_reg_loss: 23663.1049; val_edge_recon_loss: 2612038.7326; val_gene_expr_recon_loss: 6453862.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9089563.9251; val_optim_loss: 9089563.9251
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9927; val_auprc_score: 0.9914; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 23883.7536; train_edge_recon_loss: 2606767.3731; train_gene_expr_recon_loss: 6384953.8037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9015604.9370; train_optim_loss: 9015604.9370; val_kl_reg_loss: 23419.5771; val_edge_recon_loss: 2612505.1969; val_gene_expr_recon_loss: 6456995.8937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092920.6585; val_optim_loss: 9092920.6585

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9908; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 23896.5068; train_edge_recon_loss: 2606791.5684; train_gene_expr_recon_loss: 6377838.3635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9008526.4329; train_optim_loss: 9008526.4329; val_kl_reg_loss: 23675.5336; val_edge_recon_loss: 2616052.3737; val_gene_expr_recon_loss: 6460846.4965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9100574.3868; val_optim_loss: 9100574.3868
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 24010.6712; train_edge_recon_loss: 2605906.2929; train_gene_expr_recon_loss: 6376170.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006087.3611; train_optim_loss: 9006087.3611; val_kl_reg_loss: 23753.4565; val_edge_recon_loss: 2615314.3075; val_gene_expr_recon_loss: 6448974.7056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9088042.4634; val_optim_loss: 9088042.4634
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9630; val_best_f1_score: 0.9636; train_kl_reg_loss: 24033.7286; train_edge_recon_loss: 2606405.6083; train_gene_expr_recon_loss: 6379880.1468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9010319.4779; train_optim_loss: 9010319.4779; val_kl_reg_loss: 23749.5921; val_edge_recon_loss: 2612340.5052; val_gene_expr_recon_loss: 6447053.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9083143.9338; val_optim_loss: 9083143.9338
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 24055.3654; train_edge_recon_loss: 2606939.7203; train_gene_expr_recon_loss: 6376745.5272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9007740.6185; train_optim_loss: 9007740.6185; val_kl_reg_loss: 23817.8484; val_edge_recon_loss: 2615432.5557; val_gene_expr_recon_loss: 6458774.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9098024.5540; val_optim_loss: 9098024.5540
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9926; val_auprc_score: 0.9914; val_best_acc_score: 0.9626; val_best_f1_score: 0.9632; train_kl_reg_loss: 24066.2146; train_edge_recon_loss: 2606726.2987; train_gene_expr_recon_loss: 6378299.8596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9009092.3799; train_optim_loss: 9009092.3799; val_kl_reg_loss: 23809.3629; val_edge_recon_loss: 2614126.7221; val_gene_expr_recon_loss: 6455707.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9093643.6341; val_optim_loss: 9093643.6341
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9626; val_best_f1_score: 0.9632; train_kl_reg_loss: 24075.9208; train_edge_recon_loss: 2606515.6083; train_gene_expr_recon_loss: 6378616.2244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9009207.7525; train_optim_loss: 9009207.7525; val_kl_reg_loss: 23756.0647; val_edge_recon_loss: 2617475.7343; val_gene_expr_recon_loss: 6451653.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092885.3868; val_optim_loss: 9092885.3868
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9928; val_auprc_score: 0.9917; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 24056.2490; train_edge_recon_loss: 2606698.0508; train_gene_expr_recon_loss: 6377626.4984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9008380.8004; train_optim_loss: 9008380.8004; val_kl_reg_loss: 23760.1336; val_edge_recon_loss: 2613892.3362; val_gene_expr_recon_loss: 6447345.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9084998.2718; val_optim_loss: 9084998.2718

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9925; val_auprc_score: 0.9911; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 24051.0905; train_edge_recon_loss: 2606267.7666; train_gene_expr_recon_loss: 6377776.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9008095.3464; train_optim_loss: 9008095.3464; val_kl_reg_loss: 23796.6533; val_edge_recon_loss: 2615334.1481; val_gene_expr_recon_loss: 6440602.2108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9079732.9895; val_optim_loss: 9079732.9895
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9925; val_auprc_score: 0.9913; val_best_acc_score: 0.9626; val_best_f1_score: 0.9632; train_kl_reg_loss: 24058.4646; train_edge_recon_loss: 2606221.4987; train_gene_expr_recon_loss: 6375972.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006251.9922; train_optim_loss: 9006251.9922; val_kl_reg_loss: 23811.1945; val_edge_recon_loss: 2615040.1716; val_gene_expr_recon_loss: 6458518.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9097369.3868; val_optim_loss: 9097369.3868
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 24064.9153; train_edge_recon_loss: 2606514.4285; train_gene_expr_recon_loss: 6374373.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9004952.7843; train_optim_loss: 9004952.7843; val_kl_reg_loss: 23806.0015; val_edge_recon_loss: 2616229.7831; val_gene_expr_recon_loss: 6439643.8467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9079679.6237; val_optim_loss: 9079679.6237
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 24064.1221; train_edge_recon_loss: 2605556.7970; train_gene_expr_recon_loss: 6376585.8076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006206.7291; train_optim_loss: 9006206.7291; val_kl_reg_loss: 23804.4655; val_edge_recon_loss: 2615616.1812; val_gene_expr_recon_loss: 6455075.8449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9094496.4704; val_optim_loss: 9094496.4704
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 24070.7884; train_edge_recon_loss: 2606137.6200; train_gene_expr_recon_loss: 6376279.0287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9006487.4410; train_optim_loss: 9006487.4410; val_kl_reg_loss: 23783.2350; val_edge_recon_loss: 2615724.5200; val_gene_expr_recon_loss: 6453408.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092916.7282; val_optim_loss: 9092916.7282
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9926; val_auprc_score: 0.9915; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 24067.4371; train_edge_recon_loss: 2606443.1517; train_gene_expr_recon_loss: 6377020.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9007531.4484; train_optim_loss: 9007531.4484; val_kl_reg_loss: 23805.0044; val_edge_recon_loss: 2613927.7134; val_gene_expr_recon_loss: 6450202.2718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9087935.0070; val_optim_loss: 9087935.0070
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9925; val_auprc_score: 0.9914; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 24071.9255; train_edge_recon_loss: 2605574.0917; train_gene_expr_recon_loss: 6378482.6226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9008128.6305; train_optim_loss: 9008128.6305; val_kl_reg_loss: 23809.0595; val_edge_recon_loss: 2616171.2683; val_gene_expr_recon_loss: 6447750.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9087730.7108; val_optim_loss: 9087730.7108

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9926; val_auprc_score: 0.9913; val_best_acc_score: 0.9630; val_best_f1_score: 0.9636; train_kl_reg_loss: 24074.8448; train_edge_recon_loss: 2606476.4800; train_gene_expr_recon_loss: 6374760.6100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9005311.9370; train_optim_loss: 9005311.9370; val_kl_reg_loss: 23819.6888; val_edge_recon_loss: 2613367.7483; val_gene_expr_recon_loss: 6450226.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9087413.6063; val_optim_loss: 9087413.6063
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9923; val_auprc_score: 0.9910; val_best_acc_score: 0.9627; val_best_f1_score: 0.9633; train_kl_reg_loss: 24069.5691; train_edge_recon_loss: 2606194.3358; train_gene_expr_recon_loss: 6374097.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9004360.9558; train_optim_loss: 9004360.9558; val_kl_reg_loss: 23821.7976; val_edge_recon_loss: 2613408.7160; val_gene_expr_recon_loss: 6452994.9530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9090225.4495; val_optim_loss: 9090225.4495
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9924; val_auprc_score: 0.9913; val_best_acc_score: 0.9622; val_best_f1_score: 0.9628; train_kl_reg_loss: 24076.0001; train_edge_recon_loss: 2606708.1046; train_gene_expr_recon_loss: 6373081.4595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9003865.5541; train_optim_loss: 9003865.5541; val_kl_reg_loss: 23817.0551; val_edge_recon_loss: 2614820.8467; val_gene_expr_recon_loss: 6442807.9443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9081445.8432; val_optim_loss: 9081445.8432
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9925; val_auprc_score: 0.9912; val_best_acc_score: 0.9630; val_best_f1_score: 0.9635; train_kl_reg_loss: 24077.0982; train_edge_recon_loss: 2606588.2291; train_gene_expr_recon_loss: 6378876.5378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9009541.8673; train_optim_loss: 9009541.8673; val_kl_reg_loss: 23811.6389; val_edge_recon_loss: 2615475.7875; val_gene_expr_recon_loss: 6451170.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9090457.8362; val_optim_loss: 9090457.8362

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 828 min 57 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9924
Val AUPRC score: 0.9910
Val best accuracy score: 0.9624
Val best F1 score: 0.9630
Val gene expr MSE score: 1.5814

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
