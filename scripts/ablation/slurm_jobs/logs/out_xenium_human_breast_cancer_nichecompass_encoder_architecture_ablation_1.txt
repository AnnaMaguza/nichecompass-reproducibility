None
Run timestamp: 26072023_041547_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9527; val_auprc_score: 0.9380; val_best_acc_score: 0.8955; val_best_f1_score: 0.9007; train_kl_reg_loss: 17982.9165; train_edge_recon_loss: 26500622.9750; train_gene_expr_recon_loss: 817414.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27336020.4632; train_optim_loss: 27336020.4632; val_kl_reg_loss: 15849.7254; val_edge_recon_loss: 26684464.4884; val_gene_expr_recon_loss: 758198.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27458512.4356; val_optim_loss: 27458512.4356
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9605; val_auprc_score: 0.9490; val_best_acc_score: 0.9057; val_best_f1_score: 0.9099; train_kl_reg_loss: 16069.6893; train_edge_recon_loss: 26096107.2404; train_gene_expr_recon_loss: 736044.6784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26848221.5904; train_optim_loss: 26848221.5904; val_kl_reg_loss: 16318.8446; val_edge_recon_loss: 26611914.7393; val_gene_expr_recon_loss: 721850.6409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27350084.2706; val_optim_loss: 27350084.2706
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9669; val_auprc_score: 0.9567; val_best_acc_score: 0.9165; val_best_f1_score: 0.9194; train_kl_reg_loss: 16751.8723; train_edge_recon_loss: 26018576.0169; train_gene_expr_recon_loss: 710231.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26745559.6574; train_optim_loss: 26745559.6574; val_kl_reg_loss: 17115.6606; val_edge_recon_loss: 26478439.4257; val_gene_expr_recon_loss: 703031.2067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27198586.2442; val_optim_loss: 27198586.2442
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9682; val_auprc_score: 0.9583; val_best_acc_score: 0.9191; val_best_f1_score: 0.9216; train_kl_reg_loss: 17758.6358; train_edge_recon_loss: 25983114.7110; train_gene_expr_recon_loss: 695236.0450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26696109.3934; train_optim_loss: 26696109.3934; val_kl_reg_loss: 17740.3627; val_edge_recon_loss: 26516340.3168; val_gene_expr_recon_loss: 690929.0873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27225009.7162; val_optim_loss: 27225009.7162
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9707; val_auprc_score: 0.9616; val_best_acc_score: 0.9240; val_best_f1_score: 0.9264; train_kl_reg_loss: 18322.4125; train_edge_recon_loss: 25961285.9529; train_gene_expr_recon_loss: 686565.5048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26666173.8529; train_optim_loss: 26666173.8529; val_kl_reg_loss: 18096.8863; val_edge_recon_loss: 26425256.5875; val_gene_expr_recon_loss: 683367.3199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27126720.8053; val_optim_loss: 27126720.8053
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9718; val_auprc_score: 0.9618; val_best_acc_score: 0.9266; val_best_f1_score: 0.9287; train_kl_reg_loss: 18926.0239; train_edge_recon_loss: 25954808.0574; train_gene_expr_recon_loss: 680016.9686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26653751.0353; train_optim_loss: 26653751.0353; val_kl_reg_loss: 19108.8313; val_edge_recon_loss: 26426569.6040; val_gene_expr_recon_loss: 676681.1681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27122359.6040; val_optim_loss: 27122359.6040
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9747; val_auprc_score: 0.9674; val_best_acc_score: 0.9277; val_best_f1_score: 0.9299; train_kl_reg_loss: 19303.8102; train_edge_recon_loss: 25945074.7993; train_gene_expr_recon_loss: 676245.6079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26640624.2074; train_optim_loss: 26640624.2074; val_kl_reg_loss: 18588.0476; val_edge_recon_loss: 26436896.2838; val_gene_expr_recon_loss: 674840.8168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27130325.1551; val_optim_loss: 27130325.1551
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9749; val_auprc_score: 0.9674; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 19484.0077; train_edge_recon_loss: 25933363.4022; train_gene_expr_recon_loss: 673777.6295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26626625.0544; train_optim_loss: 26626625.0544; val_kl_reg_loss: 19212.8442; val_edge_recon_loss: 26367989.5710; val_gene_expr_recon_loss: 673991.1394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27061193.5974; val_optim_loss: 27061193.5974
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9766; val_auprc_score: 0.9698; val_best_acc_score: 0.9321; val_best_f1_score: 0.9337; train_kl_reg_loss: 19467.4332; train_edge_recon_loss: 25934018.2000; train_gene_expr_recon_loss: 672846.1793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26626331.7860; train_optim_loss: 26626331.7860; val_kl_reg_loss: 18721.0823; val_edge_recon_loss: 26475068.4554; val_gene_expr_recon_loss: 670669.1912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27164458.7393; val_optim_loss: 27164458.7393
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9755; val_auprc_score: 0.9675; val_best_acc_score: 0.9314; val_best_f1_score: 0.9333; train_kl_reg_loss: 19592.8966; train_edge_recon_loss: 25910661.3868; train_gene_expr_recon_loss: 670841.1601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26601095.4397; train_optim_loss: 26601095.4397; val_kl_reg_loss: 19457.8903; val_edge_recon_loss: 26431165.9604; val_gene_expr_recon_loss: 669970.4963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27120594.3300; val_optim_loss: 27120594.3300
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9776; val_auprc_score: 0.9710; val_best_acc_score: 0.9350; val_best_f1_score: 0.9369; train_kl_reg_loss: 19642.4190; train_edge_recon_loss: 25915748.9096; train_gene_expr_recon_loss: 669313.1151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26604704.4434; train_optim_loss: 26604704.4434; val_kl_reg_loss: 19136.6316; val_edge_recon_loss: 26412313.9472; val_gene_expr_recon_loss: 668404.0097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27099854.6469; val_optim_loss: 27099854.6469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9780; val_auprc_score: 0.9718; val_best_acc_score: 0.9352; val_best_f1_score: 0.9372; train_kl_reg_loss: 19572.0335; train_edge_recon_loss: 25881123.3162; train_gene_expr_recon_loss: 667513.6149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26568208.9610; train_optim_loss: 26568208.9610; val_kl_reg_loss: 19430.7889; val_edge_recon_loss: 26374110.4026; val_gene_expr_recon_loss: 669969.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27063510.4092; val_optim_loss: 27063510.4092

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9790; val_auprc_score: 0.9729; val_best_acc_score: 0.9366; val_best_f1_score: 0.9384; train_kl_reg_loss: 19763.7406; train_edge_recon_loss: 25870451.5338; train_gene_expr_recon_loss: 659166.0089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26549381.2838; train_optim_loss: 26549381.2838; val_kl_reg_loss: 19506.7006; val_edge_recon_loss: 26357136.8581; val_gene_expr_recon_loss: 659051.5598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27035695.1551; val_optim_loss: 27035695.1551
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9790; val_auprc_score: 0.9727; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 19687.4315; train_edge_recon_loss: 25849006.3676; train_gene_expr_recon_loss: 657455.6868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26526149.4890; train_optim_loss: 26526149.4890; val_kl_reg_loss: 19322.0056; val_edge_recon_loss: 26354811.8944; val_gene_expr_recon_loss: 658251.3575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27032385.2079; val_optim_loss: 27032385.2079
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9802; val_auprc_score: 0.9745; val_best_acc_score: 0.9391; val_best_f1_score: 0.9406; train_kl_reg_loss: 19501.4949; train_edge_recon_loss: 25853936.7875; train_gene_expr_recon_loss: 656937.0775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530375.3860; train_optim_loss: 26530375.3860; val_kl_reg_loss: 19123.4819; val_edge_recon_loss: 26352917.3729; val_gene_expr_recon_loss: 656292.7510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27028333.5512; val_optim_loss: 27028333.5512
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9792; val_auprc_score: 0.9730; val_best_acc_score: 0.9385; val_best_f1_score: 0.9398; train_kl_reg_loss: 19631.7846; train_edge_recon_loss: 25835996.6919; train_gene_expr_recon_loss: 656440.1856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26512068.6412; train_optim_loss: 26512068.6412; val_kl_reg_loss: 19262.6935; val_edge_recon_loss: 26362959.4389; val_gene_expr_recon_loss: 656556.7275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27038778.8515; val_optim_loss: 27038778.8515
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9794; val_auprc_score: 0.9720; val_best_acc_score: 0.9392; val_best_f1_score: 0.9408; train_kl_reg_loss: 19431.8112; train_edge_recon_loss: 25835263.8176; train_gene_expr_recon_loss: 655831.2946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26510526.8949; train_optim_loss: 26510526.8949; val_kl_reg_loss: 18889.8677; val_edge_recon_loss: 26328833.5182; val_gene_expr_recon_loss: 657418.7611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27005142.0858; val_optim_loss: 27005142.0858
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9797; val_auprc_score: 0.9736; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 19214.8938; train_edge_recon_loss: 25835601.0022; train_gene_expr_recon_loss: 655787.7850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26510603.6949; train_optim_loss: 26510603.6949; val_kl_reg_loss: 18800.8093; val_edge_recon_loss: 26332512.5149; val_gene_expr_recon_loss: 657112.3505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27008425.6568; val_optim_loss: 27008425.6568
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9798; val_auprc_score: 0.9737; val_best_acc_score: 0.9390; val_best_f1_score: 0.9405; train_kl_reg_loss: 19272.1255; train_edge_recon_loss: 25824598.0331; train_gene_expr_recon_loss: 655545.7110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26499415.8676; train_optim_loss: 26499415.8676; val_kl_reg_loss: 18694.7859; val_edge_recon_loss: 26331349.0957; val_gene_expr_recon_loss: 658258.5382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27008302.3894; val_optim_loss: 27008302.3894
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9801; val_auprc_score: 0.9741; val_best_acc_score: 0.9394; val_best_f1_score: 0.9405; train_kl_reg_loss: 19125.9170; train_edge_recon_loss: 25822001.7721; train_gene_expr_recon_loss: 655079.6463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26496207.3051; train_optim_loss: 26496207.3051; val_kl_reg_loss: 18702.0042; val_edge_recon_loss: 26336072.0660; val_gene_expr_recon_loss: 656913.8575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27011687.9208; val_optim_loss: 27011687.9208
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9806; val_auprc_score: 0.9752; val_best_acc_score: 0.9411; val_best_f1_score: 0.9425; train_kl_reg_loss: 18906.2459; train_edge_recon_loss: 25837432.9360; train_gene_expr_recon_loss: 654959.9247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26511299.1000; train_optim_loss: 26511299.1000; val_kl_reg_loss: 18602.9460; val_edge_recon_loss: 26318240.6865; val_gene_expr_recon_loss: 656705.0994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26993548.8053; val_optim_loss: 26993548.8053
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9809; val_auprc_score: 0.9753; val_best_acc_score: 0.9405; val_best_f1_score: 0.9422; train_kl_reg_loss: 18789.2432; train_edge_recon_loss: 25834415.9294; train_gene_expr_recon_loss: 655066.7597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26508271.9162; train_optim_loss: 26508271.9162; val_kl_reg_loss: 18273.1726; val_edge_recon_loss: 26338494.8581; val_gene_expr_recon_loss: 656244.8350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27013012.9043; val_optim_loss: 27013012.9043
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9744; val_best_acc_score: 0.9388; val_best_f1_score: 0.9405; train_kl_reg_loss: 18765.4211; train_edge_recon_loss: 25825725.3529; train_gene_expr_recon_loss: 654489.5639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26498980.3390; train_optim_loss: 26498980.3390; val_kl_reg_loss: 18531.5940; val_edge_recon_loss: 26352623.2475; val_gene_expr_recon_loss: 655877.8181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27027032.6271; val_optim_loss: 27027032.6271
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9808; val_auprc_score: 0.9749; val_best_acc_score: 0.9412; val_best_f1_score: 0.9426; train_kl_reg_loss: 18736.4607; train_edge_recon_loss: 25829976.0471; train_gene_expr_recon_loss: 654800.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26503513.0228; train_optim_loss: 26503513.0228; val_kl_reg_loss: 18123.9363; val_edge_recon_loss: 26314552.6799; val_gene_expr_recon_loss: 655684.5353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26988361.1155; val_optim_loss: 26988361.1155
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9808; val_auprc_score: 0.9753; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 18626.2955; train_edge_recon_loss: 25826601.9824; train_gene_expr_recon_loss: 654285.5192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26499513.8074; train_optim_loss: 26499513.8074; val_kl_reg_loss: 18152.5386; val_edge_recon_loss: 26293931.4059; val_gene_expr_recon_loss: 656766.5221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26968850.4950; val_optim_loss: 26968850.4950
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9807; val_auprc_score: 0.9751; val_best_acc_score: 0.9414; val_best_f1_score: 0.9430; train_kl_reg_loss: 18548.5987; train_edge_recon_loss: 25829922.7250; train_gene_expr_recon_loss: 653964.6278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26502435.9654; train_optim_loss: 26502435.9654; val_kl_reg_loss: 18275.7481; val_edge_recon_loss: 26308904.7789; val_gene_expr_recon_loss: 655559.0912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26982739.6634; val_optim_loss: 26982739.6634
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9812; val_auprc_score: 0.9756; val_best_acc_score: 0.9415; val_best_f1_score: 0.9430; train_kl_reg_loss: 18531.1609; train_edge_recon_loss: 25818138.2934; train_gene_expr_recon_loss: 653774.1392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26490443.6044; train_optim_loss: 26490443.6044; val_kl_reg_loss: 18155.2476; val_edge_recon_loss: 26307481.5644; val_gene_expr_recon_loss: 655769.0726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26981405.9010; val_optim_loss: 26981405.9010
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9807; val_auprc_score: 0.9752; val_best_acc_score: 0.9405; val_best_f1_score: 0.9418; train_kl_reg_loss: 18368.2588; train_edge_recon_loss: 25839888.0765; train_gene_expr_recon_loss: 653646.6568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26511903.0059; train_optim_loss: 26511903.0059; val_kl_reg_loss: 17859.5042; val_edge_recon_loss: 26333298.9967; val_gene_expr_recon_loss: 654857.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27006016.3828; val_optim_loss: 27006016.3828
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9808; val_auprc_score: 0.9752; val_best_acc_score: 0.9416; val_best_f1_score: 0.9429; train_kl_reg_loss: 18234.1165; train_edge_recon_loss: 25825998.0426; train_gene_expr_recon_loss: 653428.9361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26497661.1243; train_optim_loss: 26497661.1243; val_kl_reg_loss: 17856.3396; val_edge_recon_loss: 26299066.1056; val_gene_expr_recon_loss: 655067.4412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26971989.9208; val_optim_loss: 26971989.9208

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9807; val_auprc_score: 0.9751; val_best_acc_score: 0.9402; val_best_f1_score: 0.9416; train_kl_reg_loss: 18201.2124; train_edge_recon_loss: 25826275.3574; train_gene_expr_recon_loss: 652889.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26497366.4051; train_optim_loss: 26497366.4051; val_kl_reg_loss: 17927.3325; val_edge_recon_loss: 26320892.6271; val_gene_expr_recon_loss: 654279.7867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26993099.8020; val_optim_loss: 26993099.8020
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9806; val_auprc_score: 0.9745; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 18196.5489; train_edge_recon_loss: 25827876.6441; train_gene_expr_recon_loss: 652721.0248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26498794.2118; train_optim_loss: 26498794.2118; val_kl_reg_loss: 17872.2614; val_edge_recon_loss: 26326342.9241; val_gene_expr_recon_loss: 654222.6097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26998437.8086; val_optim_loss: 26998437.8086
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9816; val_auprc_score: 0.9764; val_best_acc_score: 0.9416; val_best_f1_score: 0.9432; train_kl_reg_loss: 18168.7717; train_edge_recon_loss: 25809185.0368; train_gene_expr_recon_loss: 652685.8284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26480039.6243; train_optim_loss: 26480039.6243; val_kl_reg_loss: 17803.2880; val_edge_recon_loss: 26313507.7096; val_gene_expr_recon_loss: 655323.6380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26986634.6007; val_optim_loss: 26986634.6007
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9814; val_auprc_score: 0.9757; val_best_acc_score: 0.9424; val_best_f1_score: 0.9439; train_kl_reg_loss: 18181.4569; train_edge_recon_loss: 25814005.0191; train_gene_expr_recon_loss: 652496.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26484682.5257; train_optim_loss: 26484682.5257; val_kl_reg_loss: 17839.5121; val_edge_recon_loss: 26286639.7822; val_gene_expr_recon_loss: 654215.2642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26958694.5479; val_optim_loss: 26958694.5479
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9811; val_auprc_score: 0.9758; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 18163.4297; train_edge_recon_loss: 25815694.4515; train_gene_expr_recon_loss: 652351.3291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26486209.2162; train_optim_loss: 26486209.2162; val_kl_reg_loss: 17806.5010; val_edge_recon_loss: 26323155.0693; val_gene_expr_recon_loss: 655372.2508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26996333.8416; val_optim_loss: 26996333.8416
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9806; val_auprc_score: 0.9749; val_best_acc_score: 0.9411; val_best_f1_score: 0.9428; train_kl_reg_loss: 18145.6286; train_edge_recon_loss: 25814688.7088; train_gene_expr_recon_loss: 652254.8226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26485089.1390; train_optim_loss: 26485089.1390; val_kl_reg_loss: 17827.9346; val_edge_recon_loss: 26320275.0297; val_gene_expr_recon_loss: 655046.3078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26993149.3003; val_optim_loss: 26993149.3003
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9807; val_auprc_score: 0.9750; val_best_acc_score: 0.9400; val_best_f1_score: 0.9417; train_kl_reg_loss: 18169.3072; train_edge_recon_loss: 25821680.3235; train_gene_expr_recon_loss: 652444.3731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26492294.0199; train_optim_loss: 26492294.0199; val_kl_reg_loss: 17807.5512; val_edge_recon_loss: 26358728.5149; val_gene_expr_recon_loss: 654382.6120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27030918.7393; val_optim_loss: 27030918.7393
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9811; val_auprc_score: 0.9751; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 18115.3902; train_edge_recon_loss: 25829193.6132; train_gene_expr_recon_loss: 652268.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26499577.5963; train_optim_loss: 26499577.5963; val_kl_reg_loss: 17769.8496; val_edge_recon_loss: 26287477.7624; val_gene_expr_recon_loss: 653610.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26958858.4224; val_optim_loss: 26958858.4224

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9813; val_auprc_score: 0.9759; val_best_acc_score: 0.9414; val_best_f1_score: 0.9430; train_kl_reg_loss: 18113.0958; train_edge_recon_loss: 25831561.8691; train_gene_expr_recon_loss: 652258.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26501933.6382; train_optim_loss: 26501933.6382; val_kl_reg_loss: 17765.8756; val_edge_recon_loss: 26309488.6931; val_gene_expr_recon_loss: 653960.8152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26981215.3729; val_optim_loss: 26981215.3729
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9809; val_auprc_score: 0.9757; val_best_acc_score: 0.9400; val_best_f1_score: 0.9415; train_kl_reg_loss: 18102.4860; train_edge_recon_loss: 25815958.8779; train_gene_expr_recon_loss: 652305.6778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26486367.0757; train_optim_loss: 26486367.0757; val_kl_reg_loss: 17744.6270; val_edge_recon_loss: 26350109.4851; val_gene_expr_recon_loss: 653822.5330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27021676.6931; val_optim_loss: 27021676.6931
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9810; val_auprc_score: 0.9753; val_best_acc_score: 0.9420; val_best_f1_score: 0.9434; train_kl_reg_loss: 18092.1728; train_edge_recon_loss: 25819448.8566; train_gene_expr_recon_loss: 652356.1718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26489897.1816; train_optim_loss: 26489897.1816; val_kl_reg_loss: 17769.4772; val_edge_recon_loss: 26327179.2673; val_gene_expr_recon_loss: 654338.5085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26999287.3201; val_optim_loss: 26999287.3201
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9806; val_auprc_score: 0.9746; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 18102.5654; train_edge_recon_loss: 25824124.5412; train_gene_expr_recon_loss: 652240.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26494467.6287; train_optim_loss: 26494467.6287; val_kl_reg_loss: 17778.2972; val_edge_recon_loss: 26323027.4125; val_gene_expr_recon_loss: 653861.4732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26994667.1815; val_optim_loss: 26994667.1815

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 190 min 4 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9815
Val AUPRC score: 0.9762
Val best accuracy score: 0.9412
Val best F1 score: 0.9423
Val gene expr MSE score: 1.6373

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
