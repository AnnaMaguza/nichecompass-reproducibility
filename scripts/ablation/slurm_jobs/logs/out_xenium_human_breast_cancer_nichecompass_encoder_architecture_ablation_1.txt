None
Run timestamp: 19072023_194637_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9250; val_auprc_score: 0.8991; val_best_acc_score: 0.8644; val_best_f1_score: 0.8733; train_kl_reg_loss: 45010.6507; train_edge_recon_loss: 27406968.8618; train_gene_expr_recon_loss: 7859224.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35311204.3118; train_optim_loss: 35311204.3118; val_kl_reg_loss: 48996.2921; val_edge_recon_loss: 27072475.1579; val_gene_expr_recon_loss: 7184640.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34306112.1579; val_optim_loss: 34306112.1579
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9393; val_auprc_score: 0.9214; val_best_acc_score: 0.8780; val_best_f1_score: 0.8864; train_kl_reg_loss: 48951.4428; train_edge_recon_loss: 26479670.9765; train_gene_expr_recon_loss: 6980792.2206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33509414.6118; train_optim_loss: 33509414.6118; val_kl_reg_loss: 48614.2822; val_edge_recon_loss: 26842337.0526; val_gene_expr_recon_loss: 6844467.7368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33735418.9211; val_optim_loss: 33735418.9211
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9448; val_auprc_score: 0.9293; val_best_acc_score: 0.8838; val_best_f1_score: 0.8910; train_kl_reg_loss: 48124.1942; train_edge_recon_loss: 26355703.6441; train_gene_expr_recon_loss: 6709657.8162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33113485.6176; train_optim_loss: 33113485.6176; val_kl_reg_loss: 45181.1762; val_edge_recon_loss: 26851215.6842; val_gene_expr_recon_loss: 6620300.2961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33516697.3947; val_optim_loss: 33516697.3947
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9514; val_auprc_score: 0.9382; val_best_acc_score: 0.8918; val_best_f1_score: 0.8976; train_kl_reg_loss: 44240.9352; train_edge_recon_loss: 26303505.3294; train_gene_expr_recon_loss: 6545316.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32893063.0794; train_optim_loss: 32893063.0794; val_kl_reg_loss: 40796.7131; val_edge_recon_loss: 26776166.7895; val_gene_expr_recon_loss: 6479673.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33296636.6316; val_optim_loss: 33296636.6316
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9569; val_auprc_score: 0.9456; val_best_acc_score: 0.8983; val_best_f1_score: 0.9026; train_kl_reg_loss: 40908.7582; train_edge_recon_loss: 26256546.6559; train_gene_expr_recon_loss: 6422020.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32719475.7294; train_optim_loss: 32719475.7294; val_kl_reg_loss: 38580.7866; val_edge_recon_loss: 26824264.6842; val_gene_expr_recon_loss: 6372146.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33234992.3947; val_optim_loss: 33234992.3947
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9605; val_auprc_score: 0.9493; val_best_acc_score: 0.9058; val_best_f1_score: 0.9100; train_kl_reg_loss: 39177.2792; train_edge_recon_loss: 26214681.1794; train_gene_expr_recon_loss: 6336767.3868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32590625.8853; train_optim_loss: 32590625.8853; val_kl_reg_loss: 38273.7834; val_edge_recon_loss: 26677308.7368; val_gene_expr_recon_loss: 6316190.7434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33031773.1579; val_optim_loss: 33031773.1579
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9623; val_auprc_score: 0.9532; val_best_acc_score: 0.9067; val_best_f1_score: 0.9108; train_kl_reg_loss: 38460.2572; train_edge_recon_loss: 26173070.5588; train_gene_expr_recon_loss: 6278029.3735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32489560.1941; train_optim_loss: 32489560.1941; val_kl_reg_loss: 36950.7270; val_edge_recon_loss: 26743065.5789; val_gene_expr_recon_loss: 6271135.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33051151.9737; val_optim_loss: 33051151.9737
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9634; val_auprc_score: 0.9542; val_best_acc_score: 0.9098; val_best_f1_score: 0.9132; train_kl_reg_loss: 38010.8480; train_edge_recon_loss: 26146512.8735; train_gene_expr_recon_loss: 6233492.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32418016.0088; train_optim_loss: 32418016.0088; val_kl_reg_loss: 36611.1056; val_edge_recon_loss: 26706058.0263; val_gene_expr_recon_loss: 6221917.5066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32964586.7632; val_optim_loss: 32964586.7632
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9646; val_auprc_score: 0.9558; val_best_acc_score: 0.9107; val_best_f1_score: 0.9142; train_kl_reg_loss: 37780.5518; train_edge_recon_loss: 26127952.3147; train_gene_expr_recon_loss: 6194824.0265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32360556.8412; train_optim_loss: 32360556.8412; val_kl_reg_loss: 36433.2657; val_edge_recon_loss: 26694754.4211; val_gene_expr_recon_loss: 6203491.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32934679.0789; val_optim_loss: 32934679.0789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9663; val_auprc_score: 0.9579; val_best_acc_score: 0.9141; val_best_f1_score: 0.9175; train_kl_reg_loss: 37571.4013; train_edge_recon_loss: 26108675.3176; train_gene_expr_recon_loss: 6166489.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32312735.7471; train_optim_loss: 32312735.7471; val_kl_reg_loss: 37196.9678; val_edge_recon_loss: 26625897.3158; val_gene_expr_recon_loss: 6182297.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32845391.3158; val_optim_loss: 32845391.3158
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9657; val_auprc_score: 0.9568; val_best_acc_score: 0.9137; val_best_f1_score: 0.9169; train_kl_reg_loss: 37647.2138; train_edge_recon_loss: 26090525.0676; train_gene_expr_recon_loss: 6149839.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32278011.3059; train_optim_loss: 32278011.3059; val_kl_reg_loss: 37171.0498; val_edge_recon_loss: 26606432.0000; val_gene_expr_recon_loss: 6173422.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32817025.6053; val_optim_loss: 32817025.6053
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9661; val_auprc_score: 0.9574; val_best_acc_score: 0.9140; val_best_f1_score: 0.9174; train_kl_reg_loss: 37195.5821; train_edge_recon_loss: 26091345.6941; train_gene_expr_recon_loss: 6136745.8169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32265287.1353; train_optim_loss: 32265287.1353; val_kl_reg_loss: 35866.5883; val_edge_recon_loss: 26617468.8158; val_gene_expr_recon_loss: 6130836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32784171.2105; val_optim_loss: 32784171.2105
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9658; val_auprc_score: 0.9563; val_best_acc_score: 0.9148; val_best_f1_score: 0.9180; train_kl_reg_loss: 36917.9609; train_edge_recon_loss: 26078696.9118; train_gene_expr_recon_loss: 6113767.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32229382.6265; train_optim_loss: 32229382.6265; val_kl_reg_loss: 37270.6598; val_edge_recon_loss: 26603286.6842; val_gene_expr_recon_loss: 6135949.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32776506.8421; val_optim_loss: 32776506.8421
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9675; val_auprc_score: 0.9596; val_best_acc_score: 0.9149; val_best_f1_score: 0.9178; train_kl_reg_loss: 36381.1320; train_edge_recon_loss: 26091162.5824; train_gene_expr_recon_loss: 6103681.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32231225.6324; train_optim_loss: 32231225.6324; val_kl_reg_loss: 34911.9424; val_edge_recon_loss: 26626871.3158; val_gene_expr_recon_loss: 6118178.0724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32779961.1579; val_optim_loss: 32779961.1579
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9683; val_auprc_score: 0.9609; val_best_acc_score: 0.9164; val_best_f1_score: 0.9193; train_kl_reg_loss: 36264.3068; train_edge_recon_loss: 26070280.7765; train_gene_expr_recon_loss: 6093028.0750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32199573.1382; train_optim_loss: 32199573.1382; val_kl_reg_loss: 35667.2948; val_edge_recon_loss: 26560477.1316; val_gene_expr_recon_loss: 6096172.2303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32692316.6316; val_optim_loss: 32692316.6316
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9679; val_auprc_score: 0.9599; val_best_acc_score: 0.9164; val_best_f1_score: 0.9191; train_kl_reg_loss: 36437.4138; train_edge_recon_loss: 26059729.8735; train_gene_expr_recon_loss: 6082311.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32178479.0441; train_optim_loss: 32178479.0441; val_kl_reg_loss: 35820.9157; val_edge_recon_loss: 26603920.3684; val_gene_expr_recon_loss: 6103558.7829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32743300.0263; val_optim_loss: 32743300.0263
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9691; val_auprc_score: 0.9609; val_best_acc_score: 0.9181; val_best_f1_score: 0.9210; train_kl_reg_loss: 35964.4336; train_edge_recon_loss: 26052132.7118; train_gene_expr_recon_loss: 6074196.0096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32162293.2088; train_optim_loss: 32162293.2088; val_kl_reg_loss: 35170.0040; val_edge_recon_loss: 26552337.9474; val_gene_expr_recon_loss: 6100480.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32687988.2368; val_optim_loss: 32687988.2368
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9704; val_auprc_score: 0.9624; val_best_acc_score: 0.9210; val_best_f1_score: 0.9233; train_kl_reg_loss: 35556.4602; train_edge_recon_loss: 26055229.0235; train_gene_expr_recon_loss: 6068691.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32159477.1294; train_optim_loss: 32159477.1294; val_kl_reg_loss: 35122.6351; val_edge_recon_loss: 26497264.0789; val_gene_expr_recon_loss: 6079034.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32611420.8158; val_optim_loss: 32611420.8158
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9705; val_auprc_score: 0.9625; val_best_acc_score: 0.9200; val_best_f1_score: 0.9231; train_kl_reg_loss: 35043.7007; train_edge_recon_loss: 26042956.1471; train_gene_expr_recon_loss: 6062100.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32140100.8471; train_optim_loss: 32140100.8471; val_kl_reg_loss: 34422.9059; val_edge_recon_loss: 26548343.5789; val_gene_expr_recon_loss: 6077928.7697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32660695.1579; val_optim_loss: 32660695.1579
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9697; val_auprc_score: 0.9625; val_best_acc_score: 0.9191; val_best_f1_score: 0.9214; train_kl_reg_loss: 34994.3700; train_edge_recon_loss: 26038938.6676; train_gene_expr_recon_loss: 6054470.5456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32128403.6088; train_optim_loss: 32128403.6088; val_kl_reg_loss: 34797.6994; val_edge_recon_loss: 26568977.1053; val_gene_expr_recon_loss: 6084260.9276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32688035.8684; val_optim_loss: 32688035.8684
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9711; val_auprc_score: 0.9637; val_best_acc_score: 0.9216; val_best_f1_score: 0.9240; train_kl_reg_loss: 35064.4766; train_edge_recon_loss: 26030759.4706; train_gene_expr_recon_loss: 6051723.3772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32117547.3088; train_optim_loss: 32117547.3088; val_kl_reg_loss: 33697.9404; val_edge_recon_loss: 26576071.6316; val_gene_expr_recon_loss: 6060606.4408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32670376.0526; val_optim_loss: 32670376.0526
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9698; val_auprc_score: 0.9617; val_best_acc_score: 0.9212; val_best_f1_score: 0.9242; train_kl_reg_loss: 34854.5374; train_edge_recon_loss: 26026788.3500; train_gene_expr_recon_loss: 6045628.7949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32107271.6765; train_optim_loss: 32107271.6765; val_kl_reg_loss: 34449.9612; val_edge_recon_loss: 26541034.8684; val_gene_expr_recon_loss: 6067415.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32642900.4211; val_optim_loss: 32642900.4211

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9713; val_auprc_score: 0.9638; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 35321.2293; train_edge_recon_loss: 26009699.7794; train_gene_expr_recon_loss: 5996408.5213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32041429.5765; train_optim_loss: 32041429.5765; val_kl_reg_loss: 34892.2344; val_edge_recon_loss: 26550458.9474; val_gene_expr_recon_loss: 6037539.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32622890.5263; val_optim_loss: 32622890.5263
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9715; val_auprc_score: 0.9642; val_best_acc_score: 0.9227; val_best_f1_score: 0.9252; train_kl_reg_loss: 35869.9679; train_edge_recon_loss: 25998224.4882; train_gene_expr_recon_loss: 5989506.7287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32023601.2206; train_optim_loss: 32023601.2206; val_kl_reg_loss: 35315.2217; val_edge_recon_loss: 26527120.1316; val_gene_expr_recon_loss: 6008598.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32571034.0263; val_optim_loss: 32571034.0263
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9710; val_auprc_score: 0.9634; val_best_acc_score: 0.9217; val_best_f1_score: 0.9245; train_kl_reg_loss: 36085.3681; train_edge_recon_loss: 26009496.6882; train_gene_expr_recon_loss: 5988532.4669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32034114.5265; train_optim_loss: 32034114.5265; val_kl_reg_loss: 35327.5078; val_edge_recon_loss: 26536312.1316; val_gene_expr_recon_loss: 6025964.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32597603.7895; val_optim_loss: 32597603.7895
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9712; val_auprc_score: 0.9632; val_best_acc_score: 0.9222; val_best_f1_score: 0.9247; train_kl_reg_loss: 36403.5226; train_edge_recon_loss: 25999924.2265; train_gene_expr_recon_loss: 5987363.0926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32023690.8176; train_optim_loss: 32023690.8176; val_kl_reg_loss: 35888.5173; val_edge_recon_loss: 26556508.5263; val_gene_expr_recon_loss: 6025152.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32617549.1579; val_optim_loss: 32617549.1579
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9732; val_auprc_score: 0.9663; val_best_acc_score: 0.9244; val_best_f1_score: 0.9269; train_kl_reg_loss: 36559.5244; train_edge_recon_loss: 25996178.8706; train_gene_expr_recon_loss: 5986206.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32018945.3794; train_optim_loss: 32018945.3794; val_kl_reg_loss: 35794.8991; val_edge_recon_loss: 26470767.3158; val_gene_expr_recon_loss: 6039462.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32546024.8158; val_optim_loss: 32546024.8158
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9722; val_auprc_score: 0.9646; val_best_acc_score: 0.9237; val_best_f1_score: 0.9264; train_kl_reg_loss: 36712.3729; train_edge_recon_loss: 25991700.1000; train_gene_expr_recon_loss: 5987692.6265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32016105.0941; train_optim_loss: 32016105.0941; val_kl_reg_loss: 36068.3641; val_edge_recon_loss: 26492978.6053; val_gene_expr_recon_loss: 6026815.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32555862.2368; val_optim_loss: 32555862.2368
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9717; val_auprc_score: 0.9644; val_best_acc_score: 0.9234; val_best_f1_score: 0.9261; train_kl_reg_loss: 36856.9848; train_edge_recon_loss: 26001072.9500; train_gene_expr_recon_loss: 5982342.3890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32020272.3088; train_optim_loss: 32020272.3088; val_kl_reg_loss: 35914.0535; val_edge_recon_loss: 26514400.1842; val_gene_expr_recon_loss: 6004330.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32554644.4737; val_optim_loss: 32554644.4737
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9727; val_auprc_score: 0.9655; val_best_acc_score: 0.9247; val_best_f1_score: 0.9269; train_kl_reg_loss: 36769.0418; train_edge_recon_loss: 25999300.3971; train_gene_expr_recon_loss: 5978196.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32014266.3265; train_optim_loss: 32014266.3265; val_kl_reg_loss: 36190.7547; val_edge_recon_loss: 26500897.0000; val_gene_expr_recon_loss: 6008983.3882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32546071.2105; val_optim_loss: 32546071.2105
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9727; val_auprc_score: 0.9660; val_best_acc_score: 0.9234; val_best_f1_score: 0.9261; train_kl_reg_loss: 37049.2673; train_edge_recon_loss: 25995691.6294; train_gene_expr_recon_loss: 5980189.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32012930.2971; train_optim_loss: 32012930.2971; val_kl_reg_loss: 35988.3670; val_edge_recon_loss: 26538716.1842; val_gene_expr_recon_loss: 6010798.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32585503.1842; val_optim_loss: 32585503.1842

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9721; val_auprc_score: 0.9647; val_best_acc_score: 0.9242; val_best_f1_score: 0.9268; train_kl_reg_loss: 36955.5531; train_edge_recon_loss: 25971028.5941; train_gene_expr_recon_loss: 5972656.3831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31980640.5176; train_optim_loss: 31980640.5176; val_kl_reg_loss: 36126.4820; val_edge_recon_loss: 26517401.1579; val_gene_expr_recon_loss: 5998396.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32551924.1316; val_optim_loss: 32551924.1316
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9715; val_auprc_score: 0.9639; val_best_acc_score: 0.9230; val_best_f1_score: 0.9256; train_kl_reg_loss: 37048.2774; train_edge_recon_loss: 25987473.9294; train_gene_expr_recon_loss: 5971605.6809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31996127.8912; train_optim_loss: 31996127.8912; val_kl_reg_loss: 36098.5877; val_edge_recon_loss: 26557757.8421; val_gene_expr_recon_loss: 6016037.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32609893.5263; val_optim_loss: 32609893.5263
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9724; val_auprc_score: 0.9656; val_best_acc_score: 0.9235; val_best_f1_score: 0.9261; train_kl_reg_loss: 37067.7179; train_edge_recon_loss: 26000957.3735; train_gene_expr_recon_loss: 5972310.9316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32010336.0824; train_optim_loss: 32010336.0824; val_kl_reg_loss: 36178.5217; val_edge_recon_loss: 26536477.2632; val_gene_expr_recon_loss: 5995846.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32568502.4737; val_optim_loss: 32568502.4737
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9723; val_auprc_score: 0.9649; val_best_acc_score: 0.9239; val_best_f1_score: 0.9263; train_kl_reg_loss: 37093.4249; train_edge_recon_loss: 25996517.0441; train_gene_expr_recon_loss: 5974199.9610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32007810.4235; train_optim_loss: 32007810.4235; val_kl_reg_loss: 36259.3153; val_edge_recon_loss: 26523432.4211; val_gene_expr_recon_loss: 6018526.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32578218.5789; val_optim_loss: 32578218.5789

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 61 min 43 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9719
Val AUPRC score: 0.9647
Val best accuracy score: 0.9228
Val best F1 score: 0.9255
Val gene expr MSE score: 1.4341

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
