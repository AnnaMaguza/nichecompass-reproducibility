None
Run timestamp: 14072023_070809_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9834; val_auprc_score: 0.9775; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 32001.4857; train_edge_recon_loss: 2679537.7215; train_gene_expr_recon_loss: 1176843.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3888382.9517; train_optim_loss: 3888382.9517; val_kl_reg_loss: 29574.3427; val_edge_recon_loss: 2615237.7910; val_gene_expr_recon_loss: 1074613.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3719425.2295; val_optim_loss: 3719425.2295
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9537; val_best_f1_score: 0.9548; train_kl_reg_loss: 27743.3612; train_edge_recon_loss: 2601058.7808; train_gene_expr_recon_loss: 1050861.7085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3679663.8598; train_optim_loss: 3679663.8598; val_kl_reg_loss: 25191.1396; val_edge_recon_loss: 2599745.5820; val_gene_expr_recon_loss: 1034633.8822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3659570.6025; val_optim_loss: 3659570.6025
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9888; val_auprc_score: 0.9850; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 24641.5789; train_edge_recon_loss: 2590673.7449; train_gene_expr_recon_loss: 1017585.5171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3632900.8424; train_optim_loss: 3632900.8424; val_kl_reg_loss: 23584.6442; val_edge_recon_loss: 2589965.5861; val_gene_expr_recon_loss: 1008366.7900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3621917.0287; val_optim_loss: 3621917.0287
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 22867.5583; train_edge_recon_loss: 2582600.4324; train_gene_expr_recon_loss: 997026.1349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3602494.1333; train_optim_loss: 3602494.1333; val_kl_reg_loss: 22103.9755; val_edge_recon_loss: 2585166.0164; val_gene_expr_recon_loss: 993452.5400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3600722.5164; val_optim_loss: 3600722.5164
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9884; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 21373.9519; train_edge_recon_loss: 2577476.7215; train_gene_expr_recon_loss: 984549.9404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3583400.6209; train_optim_loss: 3583400.6209; val_kl_reg_loss: 20509.9854; val_edge_recon_loss: 2582621.5943; val_gene_expr_recon_loss: 984864.3914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3587995.9877; val_optim_loss: 3587995.9877
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9917; val_auprc_score: 0.9890; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 20283.6186; train_edge_recon_loss: 2573579.8451; train_gene_expr_recon_loss: 975841.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3569705.1815; train_optim_loss: 3569705.1815; val_kl_reg_loss: 19412.8625; val_edge_recon_loss: 2580209.6311; val_gene_expr_recon_loss: 978031.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3577654.4467; val_optim_loss: 3577654.4467
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9930; val_auprc_score: 0.9909; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 19373.7620; train_edge_recon_loss: 2570549.5643; train_gene_expr_recon_loss: 968604.4007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3558527.7293; train_optim_loss: 3558527.7293; val_kl_reg_loss: 18805.4001; val_edge_recon_loss: 2574656.8607; val_gene_expr_recon_loss: 973170.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566632.7992; val_optim_loss: 3566632.7992
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 18643.4877; train_edge_recon_loss: 2569066.3768; train_gene_expr_recon_loss: 963132.0587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3550841.9237; train_optim_loss: 3550841.9237; val_kl_reg_loss: 18196.0400; val_edge_recon_loss: 2571628.4754; val_gene_expr_recon_loss: 970945.0512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3560769.5902; val_optim_loss: 3560769.5902
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9917; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 18019.1497; train_edge_recon_loss: 2565561.2183; train_gene_expr_recon_loss: 959346.2189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3542926.5947; train_optim_loss: 3542926.5947; val_kl_reg_loss: 17359.9373; val_edge_recon_loss: 2571582.9672; val_gene_expr_recon_loss: 965533.0564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3554475.9508; val_optim_loss: 3554475.9508
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 17431.0471; train_edge_recon_loss: 2566295.2302; train_gene_expr_recon_loss: 955828.6675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3539554.9490; train_optim_loss: 3539554.9490; val_kl_reg_loss: 17216.2121; val_edge_recon_loss: 2569395.5820; val_gene_expr_recon_loss: 961548.0799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548159.8770; val_optim_loss: 3548159.8770
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 17057.2338; train_edge_recon_loss: 2564327.7794; train_gene_expr_recon_loss: 952703.8481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3534088.8686; train_optim_loss: 3534088.8686; val_kl_reg_loss: 16746.6056; val_edge_recon_loss: 2567560.6844; val_gene_expr_recon_loss: 963719.8996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548027.1967; val_optim_loss: 3548027.1967
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 16661.5843; train_edge_recon_loss: 2562778.1176; train_gene_expr_recon_loss: 949387.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3528826.8493; train_optim_loss: 3528826.8493; val_kl_reg_loss: 16514.3038; val_edge_recon_loss: 2567113.8852; val_gene_expr_recon_loss: 960194.9068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543823.1025; val_optim_loss: 3543823.1025
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 16323.2329; train_edge_recon_loss: 2560628.2137; train_gene_expr_recon_loss: 948058.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3525010.3254; train_optim_loss: 3525010.3254; val_kl_reg_loss: 16031.7749; val_edge_recon_loss: 2564014.1639; val_gene_expr_recon_loss: 962151.0154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542196.9836; val_optim_loss: 3542196.9836
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 16070.8576; train_edge_recon_loss: 2559327.9802; train_gene_expr_recon_loss: 944958.6754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3520357.5078; train_optim_loss: 3520357.5078; val_kl_reg_loss: 15659.5752; val_edge_recon_loss: 2565020.3320; val_gene_expr_recon_loss: 959207.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539887.3811; val_optim_loss: 3539887.3811
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 15805.7022; train_edge_recon_loss: 2558799.2325; train_gene_expr_recon_loss: 942987.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3517592.8571; train_optim_loss: 3517592.8571; val_kl_reg_loss: 15397.9597; val_edge_recon_loss: 2561835.2951; val_gene_expr_recon_loss: 958738.7787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535972.0451; val_optim_loss: 3535972.0451
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 15675.1561; train_edge_recon_loss: 2557148.4044; train_gene_expr_recon_loss: 941050.8847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3513874.4462; train_optim_loss: 3513874.4462; val_kl_reg_loss: 15345.2589; val_edge_recon_loss: 2565294.5451; val_gene_expr_recon_loss: 958267.2828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538907.1107; val_optim_loss: 3538907.1107
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 15467.0356; train_edge_recon_loss: 2557488.4637; train_gene_expr_recon_loss: 939600.7925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3512556.2918; train_optim_loss: 3512556.2918; val_kl_reg_loss: 15041.1407; val_edge_recon_loss: 2562866.8811; val_gene_expr_recon_loss: 955728.3586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3533636.3893; val_optim_loss: 3533636.3893
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 15291.8737; train_edge_recon_loss: 2556681.7335; train_gene_expr_recon_loss: 938177.9162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3510151.5179; train_optim_loss: 3510151.5179; val_kl_reg_loss: 14938.5328; val_edge_recon_loss: 2560512.8934; val_gene_expr_recon_loss: 956492.1189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3531943.5492; val_optim_loss: 3531943.5492
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9941; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 15179.1574; train_edge_recon_loss: 2556247.8189; train_gene_expr_recon_loss: 935581.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3507008.0850; train_optim_loss: 3507008.0850; val_kl_reg_loss: 14872.8352; val_edge_recon_loss: 2559812.4918; val_gene_expr_recon_loss: 957288.1424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3531973.4877; val_optim_loss: 3531973.4877
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 15040.2380; train_edge_recon_loss: 2555836.3364; train_gene_expr_recon_loss: 934288.8010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3505165.3768; train_optim_loss: 3505165.3768; val_kl_reg_loss: 14844.2670; val_edge_recon_loss: 2560826.3402; val_gene_expr_recon_loss: 958407.4518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3534078.0697; val_optim_loss: 3534078.0697
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 14955.4514; train_edge_recon_loss: 2554937.9292; train_gene_expr_recon_loss: 933056.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3502949.9306; train_optim_loss: 3502949.9306; val_kl_reg_loss: 14888.6892; val_edge_recon_loss: 2559051.4057; val_gene_expr_recon_loss: 959018.7244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3532958.8197; val_optim_loss: 3532958.8197
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 14883.1173; train_edge_recon_loss: 2553960.1016; train_gene_expr_recon_loss: 932039.8512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3500883.0754; train_optim_loss: 3500883.0754; val_kl_reg_loss: 14759.7497; val_edge_recon_loss: 2555931.3852; val_gene_expr_recon_loss: 957121.6352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3527812.7664; val_optim_loss: 3527812.7664
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 14753.7591; train_edge_recon_loss: 2553771.2937; train_gene_expr_recon_loss: 929714.9729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3498240.0211; train_optim_loss: 3498240.0211; val_kl_reg_loss: 14541.3012; val_edge_recon_loss: 2557540.9426; val_gene_expr_recon_loss: 958116.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530198.5000; val_optim_loss: 3530198.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 14683.9580; train_edge_recon_loss: 2553381.7555; train_gene_expr_recon_loss: 929013.1295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3497078.8479; train_optim_loss: 3497078.8479; val_kl_reg_loss: 14555.1974; val_edge_recon_loss: 2558432.2172; val_gene_expr_recon_loss: 957809.4529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530796.8443; val_optim_loss: 3530796.8443
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 14672.0726; train_edge_recon_loss: 2553126.4816; train_gene_expr_recon_loss: 926877.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3494676.4706; train_optim_loss: 3494676.4706; val_kl_reg_loss: 14487.8279; val_edge_recon_loss: 2554772.9713; val_gene_expr_recon_loss: 959378.0379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3528638.8402; val_optim_loss: 3528638.8402
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 14569.8859; train_edge_recon_loss: 2552556.4389; train_gene_expr_recon_loss: 926060.9214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3493187.2385; train_optim_loss: 3493187.2385; val_kl_reg_loss: 14278.3380; val_edge_recon_loss: 2558450.6885; val_gene_expr_recon_loss: 958238.5635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530967.5820; val_optim_loss: 3530967.5820

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 14714.4823; train_edge_recon_loss: 2550889.0464; train_gene_expr_recon_loss: 919748.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3485352.1333; train_optim_loss: 3485352.1333; val_kl_reg_loss: 14638.1352; val_edge_recon_loss: 2555816.9221; val_gene_expr_recon_loss: 957470.3084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3527925.3607; val_optim_loss: 3527925.3607
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 14784.6864; train_edge_recon_loss: 2551466.9527; train_gene_expr_recon_loss: 918484.5308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484736.1687; train_optim_loss: 3484736.1687; val_kl_reg_loss: 14625.2339; val_edge_recon_loss: 2554369.8934; val_gene_expr_recon_loss: 956717.2418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3525712.3648; val_optim_loss: 3525712.3648
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 14785.4988; train_edge_recon_loss: 2551965.6452; train_gene_expr_recon_loss: 917992.0878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484743.2353; train_optim_loss: 3484743.2353; val_kl_reg_loss: 14636.8676; val_edge_recon_loss: 2553684.7377; val_gene_expr_recon_loss: 956692.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3525013.6967; val_optim_loss: 3525013.6967
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 14756.5299; train_edge_recon_loss: 2551562.7385; train_gene_expr_recon_loss: 918140.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484459.3180; train_optim_loss: 3484459.3180; val_kl_reg_loss: 14603.5893; val_edge_recon_loss: 2553499.7172; val_gene_expr_recon_loss: 955932.7090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524036.0000; val_optim_loss: 3524036.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 14754.3943; train_edge_recon_loss: 2550748.8755; train_gene_expr_recon_loss: 917734.5679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483237.8341; train_optim_loss: 3483237.8341; val_kl_reg_loss: 14557.8715; val_edge_recon_loss: 2555775.9754; val_gene_expr_recon_loss: 957394.5092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3527728.3648; val_optim_loss: 3527728.3648
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 14748.1462; train_edge_recon_loss: 2551062.7615; train_gene_expr_recon_loss: 917366.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483177.5620; train_optim_loss: 3483177.5620; val_kl_reg_loss: 14558.5913; val_edge_recon_loss: 2553969.8525; val_gene_expr_recon_loss: 957811.5184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3526339.9508; val_optim_loss: 3526339.9508
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 14735.7739; train_edge_recon_loss: 2550822.0602; train_gene_expr_recon_loss: 916833.7086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482391.5377; train_optim_loss: 3482391.5377; val_kl_reg_loss: 14611.5869; val_edge_recon_loss: 2554197.9959; val_gene_expr_recon_loss: 956767.3043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3525576.8811; val_optim_loss: 3525576.8811
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 14725.3847; train_edge_recon_loss: 2551205.0873; train_gene_expr_recon_loss: 917215.3303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483145.8051; train_optim_loss: 3483145.8051; val_kl_reg_loss: 14631.4091; val_edge_recon_loss: 2553593.6475; val_gene_expr_recon_loss: 960821.5236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529046.5492; val_optim_loss: 3529046.5492

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 14766.6857; train_edge_recon_loss: 2551011.2155; train_gene_expr_recon_loss: 915973.0579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481750.9600; train_optim_loss: 3481750.9600; val_kl_reg_loss: 14595.5639; val_edge_recon_loss: 2556114.9385; val_gene_expr_recon_loss: 960017.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530727.9344; val_optim_loss: 3530727.9344
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 14759.7992; train_edge_recon_loss: 2550858.8529; train_gene_expr_recon_loss: 915991.5693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481610.2188; train_optim_loss: 3481610.2188; val_kl_reg_loss: 14587.3224; val_edge_recon_loss: 2555768.9508; val_gene_expr_recon_loss: 956434.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3526790.5082; val_optim_loss: 3526790.5082
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 14740.7168; train_edge_recon_loss: 2551125.6140; train_gene_expr_recon_loss: 915499.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481365.5878; train_optim_loss: 3481365.5878; val_kl_reg_loss: 14577.6037; val_edge_recon_loss: 2556327.9303; val_gene_expr_recon_loss: 958224.8535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529130.3934; val_optim_loss: 3529130.3934
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 14739.1639; train_edge_recon_loss: 2551188.5726; train_gene_expr_recon_loss: 915583.4041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481511.1415; train_optim_loss: 3481511.1415; val_kl_reg_loss: 14578.1838; val_edge_recon_loss: 2552473.7254; val_gene_expr_recon_loss: 957717.9027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3524769.8197; val_optim_loss: 3524769.8197

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 163 min 26 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9968
Val AUPRC score: 0.9956
Val best accuracy score: 0.9833
Val best F1 score: 0.9835
Val gene expr MSE score: 0.6338

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
