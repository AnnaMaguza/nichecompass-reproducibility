None
Run timestamp: 30062023_100001_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9837; val_auprc_score: 0.9762; val_best_acc_score: 0.9549; val_best_f1_score: 0.9558; train_kl_reg_loss: 2245.6594; train_edge_recon_loss: 28191.6678; train_gene_expr_recon_loss: 13337.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43774.3481; train_optim_loss: 43774.3481; val_kl_reg_loss: 2420.5975; val_edge_recon_loss: 26356.0241; val_gene_expr_recon_loss: 11839.8303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40616.4518; val_optim_loss: 40616.4518
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9874; val_auprc_score: 0.9824; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 2484.6542; train_edge_recon_loss: 27319.4869; train_gene_expr_recon_loss: 11592.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41396.8089; train_optim_loss: 41396.8089; val_kl_reg_loss: 2444.2377; val_edge_recon_loss: 26245.8727; val_gene_expr_recon_loss: 11155.6056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39845.7159; val_optim_loss: 39845.7159
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9889; val_auprc_score: 0.9848; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 2499.2743; train_edge_recon_loss: 27235.6760; train_gene_expr_recon_loss: 11127.9087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40862.8589; train_optim_loss: 40862.8589; val_kl_reg_loss: 2474.8429; val_edge_recon_loss: 26210.6347; val_gene_expr_recon_loss: 10808.5464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39494.0239; val_optim_loss: 39494.0239
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9895; val_auprc_score: 0.9852; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 2513.6476; train_edge_recon_loss: 27190.7361; train_gene_expr_recon_loss: 10839.2329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40543.6166; train_optim_loss: 40543.6166; val_kl_reg_loss: 2506.8996; val_edge_recon_loss: 26166.7501; val_gene_expr_recon_loss: 10631.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39304.8314; val_optim_loss: 39304.8314
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9881; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 2527.3572; train_edge_recon_loss: 27140.3322; train_gene_expr_recon_loss: 10630.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40297.8709; train_optim_loss: 40297.8709; val_kl_reg_loss: 2507.2175; val_edge_recon_loss: 26100.6365; val_gene_expr_recon_loss: 10391.0947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38998.9486; val_optim_loss: 38998.9486
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9919; val_auprc_score: 0.9893; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 2535.3354; train_edge_recon_loss: 27131.4939; train_gene_expr_recon_loss: 10483.4109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40150.2404; train_optim_loss: 40150.2404; val_kl_reg_loss: 2473.4551; val_edge_recon_loss: 26032.9102; val_gene_expr_recon_loss: 10270.3216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38776.6866; val_optim_loss: 38776.6866
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9881; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 2549.2147; train_edge_recon_loss: 27081.8841; train_gene_expr_recon_loss: 10363.3376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39994.4364; train_optim_loss: 39994.4364; val_kl_reg_loss: 2550.8818; val_edge_recon_loss: 26084.9250; val_gene_expr_recon_loss: 10175.2597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38811.0662; val_optim_loss: 38811.0662
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9891; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 2554.9355; train_edge_recon_loss: 27074.4423; train_gene_expr_recon_loss: 10263.6025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39892.9803; train_optim_loss: 39892.9803; val_kl_reg_loss: 2526.4624; val_edge_recon_loss: 26018.0483; val_gene_expr_recon_loss: 10112.1570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38656.6674; val_optim_loss: 38656.6674
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9929; val_auprc_score: 0.9900; val_best_acc_score: 0.9725; val_best_f1_score: 0.9730; train_kl_reg_loss: 2564.2289; train_edge_recon_loss: 27046.4415; train_gene_expr_recon_loss: 10186.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39797.2649; train_optim_loss: 39797.2649; val_kl_reg_loss: 2525.2064; val_edge_recon_loss: 26019.7717; val_gene_expr_recon_loss: 10043.7077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38588.6858; val_optim_loss: 38588.6858
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9900; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 2574.1788; train_edge_recon_loss: 27022.9617; train_gene_expr_recon_loss: 10118.3536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39715.4942; train_optim_loss: 39715.4942; val_kl_reg_loss: 2518.2650; val_edge_recon_loss: 25995.1639; val_gene_expr_recon_loss: 10009.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38522.4480; val_optim_loss: 38522.4480
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9933; val_auprc_score: 0.9910; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 2580.4433; train_edge_recon_loss: 27003.2840; train_gene_expr_recon_loss: 10071.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39654.8647; train_optim_loss: 39654.8647; val_kl_reg_loss: 2567.0038; val_edge_recon_loss: 26006.1951; val_gene_expr_recon_loss: 9949.6446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38522.8434; val_optim_loss: 38522.8434
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9917; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 2585.4696; train_edge_recon_loss: 26998.0749; train_gene_expr_recon_loss: 10024.7688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39608.3132; train_optim_loss: 39608.3132; val_kl_reg_loss: 2566.4805; val_edge_recon_loss: 25894.4635; val_gene_expr_recon_loss: 9928.7428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38389.6868; val_optim_loss: 38389.6868
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 2590.5685; train_edge_recon_loss: 26988.9090; train_gene_expr_recon_loss: 9989.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39568.5540; train_optim_loss: 39568.5540; val_kl_reg_loss: 2552.6904; val_edge_recon_loss: 25927.6815; val_gene_expr_recon_loss: 9903.7259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38384.0981; val_optim_loss: 38384.0981
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 2595.2520; train_edge_recon_loss: 26983.7090; train_gene_expr_recon_loss: 9947.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39526.6406; train_optim_loss: 39526.6406; val_kl_reg_loss: 2581.7004; val_edge_recon_loss: 25920.9028; val_gene_expr_recon_loss: 9857.1429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38359.7464; val_optim_loss: 38359.7464
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 2606.1792; train_edge_recon_loss: 26942.9148; train_gene_expr_recon_loss: 9914.2269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39463.3210; train_optim_loss: 39463.3210; val_kl_reg_loss: 2557.4917; val_edge_recon_loss: 25907.6497; val_gene_expr_recon_loss: 9877.4789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38342.6200; val_optim_loss: 38342.6200
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 2607.9864; train_edge_recon_loss: 26941.0786; train_gene_expr_recon_loss: 9891.9422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39441.0075; train_optim_loss: 39441.0075; val_kl_reg_loss: 2624.2390; val_edge_recon_loss: 25916.0149; val_gene_expr_recon_loss: 9832.4264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38372.6804; val_optim_loss: 38372.6804
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9769; val_best_f1_score: 0.9773; train_kl_reg_loss: 2613.2956; train_edge_recon_loss: 26929.2186; train_gene_expr_recon_loss: 9856.4165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39398.9309; train_optim_loss: 39398.9309; val_kl_reg_loss: 2603.3669; val_edge_recon_loss: 25923.4902; val_gene_expr_recon_loss: 9839.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38366.6863; val_optim_loss: 38366.6863
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 2619.7724; train_edge_recon_loss: 26916.2792; train_gene_expr_recon_loss: 9850.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39387.0405; train_optim_loss: 39387.0405; val_kl_reg_loss: 2611.4750; val_edge_recon_loss: 25890.0430; val_gene_expr_recon_loss: 9826.4447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38327.9626; val_optim_loss: 38327.9626
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 2622.4209; train_edge_recon_loss: 26919.8327; train_gene_expr_recon_loss: 9828.8562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39371.1098; train_optim_loss: 39371.1098; val_kl_reg_loss: 2637.7116; val_edge_recon_loss: 25897.0637; val_gene_expr_recon_loss: 9770.6652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38305.4407; val_optim_loss: 38305.4407
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 2628.6965; train_edge_recon_loss: 26901.9390; train_gene_expr_recon_loss: 9816.5414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39347.1769; train_optim_loss: 39347.1769; val_kl_reg_loss: 2588.9151; val_edge_recon_loss: 25841.2046; val_gene_expr_recon_loss: 9810.6874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38240.8068; val_optim_loss: 38240.8068
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 2632.4803; train_edge_recon_loss: 26895.8006; train_gene_expr_recon_loss: 9797.3894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39325.6703; train_optim_loss: 39325.6703; val_kl_reg_loss: 2572.2476; val_edge_recon_loss: 25879.2949; val_gene_expr_recon_loss: 9765.4059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38216.9487; val_optim_loss: 38216.9487
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9956; val_auprc_score: 0.9938; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 2635.5928; train_edge_recon_loss: 26895.7351; train_gene_expr_recon_loss: 9778.7354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39310.0633; train_optim_loss: 39310.0633; val_kl_reg_loss: 2628.5281; val_edge_recon_loss: 25868.5358; val_gene_expr_recon_loss: 9780.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38277.5261; val_optim_loss: 38277.5261
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2641.4650; train_edge_recon_loss: 26877.8720; train_gene_expr_recon_loss: 9764.4405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39283.7775; train_optim_loss: 39283.7775; val_kl_reg_loss: 2616.9074; val_edge_recon_loss: 25829.5167; val_gene_expr_recon_loss: 9773.1748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.5989; val_optim_loss: 38219.5989
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 2645.9630; train_edge_recon_loss: 26871.4035; train_gene_expr_recon_loss: 9758.6612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39276.0278; train_optim_loss: 39276.0278; val_kl_reg_loss: 2662.8413; val_edge_recon_loss: 25837.0473; val_gene_expr_recon_loss: 9780.4697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38280.3580; val_optim_loss: 38280.3580
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2646.7908; train_edge_recon_loss: 26877.3034; train_gene_expr_recon_loss: 9742.0022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39266.0963; train_optim_loss: 39266.0963; val_kl_reg_loss: 2628.5823; val_edge_recon_loss: 25840.9745; val_gene_expr_recon_loss: 9759.0400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38228.5965; val_optim_loss: 38228.5965

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 2644.9963; train_edge_recon_loss: 26859.7054; train_gene_expr_recon_loss: 9694.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39199.5435; train_optim_loss: 39199.5435; val_kl_reg_loss: 2624.8466; val_edge_recon_loss: 25825.3127; val_gene_expr_recon_loss: 9762.3193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38212.4787; val_optim_loss: 38212.4787
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 2644.1137; train_edge_recon_loss: 26851.6452; train_gene_expr_recon_loss: 9683.2312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39178.9900; train_optim_loss: 39178.9900; val_kl_reg_loss: 2640.3506; val_edge_recon_loss: 25820.8407; val_gene_expr_recon_loss: 9752.9283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38214.1197; val_optim_loss: 38214.1197
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 2642.9994; train_edge_recon_loss: 26854.9998; train_gene_expr_recon_loss: 9687.4585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39185.4578; train_optim_loss: 39185.4578; val_kl_reg_loss: 2632.2762; val_edge_recon_loss: 25808.5943; val_gene_expr_recon_loss: 9752.4202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38193.2907; val_optim_loss: 38193.2907
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2641.9476; train_edge_recon_loss: 26853.8707; train_gene_expr_recon_loss: 9678.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39174.0969; train_optim_loss: 39174.0969; val_kl_reg_loss: 2642.7573; val_edge_recon_loss: 25836.2998; val_gene_expr_recon_loss: 9750.2934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38229.3506; val_optim_loss: 38229.3506
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 2643.1878; train_edge_recon_loss: 26853.2776; train_gene_expr_recon_loss: 9678.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39174.5553; train_optim_loss: 39174.5553; val_kl_reg_loss: 2637.0123; val_edge_recon_loss: 25864.7272; val_gene_expr_recon_loss: 9757.8083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38259.5478; val_optim_loss: 38259.5478
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 2642.6326; train_edge_recon_loss: 26857.5788; train_gene_expr_recon_loss: 9674.9776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39175.1890; train_optim_loss: 39175.1890; val_kl_reg_loss: 2633.9943; val_edge_recon_loss: 25808.6639; val_gene_expr_recon_loss: 9744.7809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38187.4394; val_optim_loss: 38187.4394
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2646.8813; train_edge_recon_loss: 26835.7948; train_gene_expr_recon_loss: 9672.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39154.6797; train_optim_loss: 39154.6797; val_kl_reg_loss: 2631.9130; val_edge_recon_loss: 25832.8906; val_gene_expr_recon_loss: 9754.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.7046; val_optim_loss: 38219.7046
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9964; val_auprc_score: 0.9950; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2646.7216; train_edge_recon_loss: 26839.3298; train_gene_expr_recon_loss: 9678.3876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39164.4389; train_optim_loss: 39164.4389; val_kl_reg_loss: 2643.0119; val_edge_recon_loss: 25826.3947; val_gene_expr_recon_loss: 9742.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38212.3287; val_optim_loss: 38212.3287
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 2645.0380; train_edge_recon_loss: 26849.0069; train_gene_expr_recon_loss: 9660.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39154.9406; train_optim_loss: 39154.9406; val_kl_reg_loss: 2626.2505; val_edge_recon_loss: 25846.7207; val_gene_expr_recon_loss: 9753.8974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38226.8687; val_optim_loss: 38226.8687
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2646.1274; train_edge_recon_loss: 26843.0829; train_gene_expr_recon_loss: 9660.6709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39149.8811; train_optim_loss: 39149.8811; val_kl_reg_loss: 2634.0892; val_edge_recon_loss: 25811.8002; val_gene_expr_recon_loss: 9727.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38173.1522; val_optim_loss: 38173.1522
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2647.3165; train_edge_recon_loss: 26840.7177; train_gene_expr_recon_loss: 9663.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39151.0585; train_optim_loss: 39151.0585; val_kl_reg_loss: 2647.1785; val_edge_recon_loss: 25833.2595; val_gene_expr_recon_loss: 9750.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38230.5958; val_optim_loss: 38230.5958
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2648.1114; train_edge_recon_loss: 26836.7418; train_gene_expr_recon_loss: 9664.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39149.5137; train_optim_loss: 39149.5137; val_kl_reg_loss: 2655.8246; val_edge_recon_loss: 25824.9546; val_gene_expr_recon_loss: 9717.9441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38198.7231; val_optim_loss: 38198.7231
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 2648.8468; train_edge_recon_loss: 26837.0990; train_gene_expr_recon_loss: 9657.6423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39143.5880; train_optim_loss: 39143.5880; val_kl_reg_loss: 2644.5720; val_edge_recon_loss: 25794.7881; val_gene_expr_recon_loss: 9743.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38183.1807; val_optim_loss: 38183.1807
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 2647.6385; train_edge_recon_loss: 26845.2636; train_gene_expr_recon_loss: 9651.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39144.6503; train_optim_loss: 39144.6503; val_kl_reg_loss: 2640.6046; val_edge_recon_loss: 25832.0934; val_gene_expr_recon_loss: 9732.8725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38205.5706; val_optim_loss: 38205.5706

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2647.6982; train_edge_recon_loss: 26842.9641; train_gene_expr_recon_loss: 9658.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39148.9064; train_optim_loss: 39148.9064; val_kl_reg_loss: 2642.4561; val_edge_recon_loss: 25832.0101; val_gene_expr_recon_loss: 9753.1835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38227.6495; val_optim_loss: 38227.6495
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2647.1660; train_edge_recon_loss: 26844.6655; train_gene_expr_recon_loss: 9646.9984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39138.8299; train_optim_loss: 39138.8299; val_kl_reg_loss: 2645.4355; val_edge_recon_loss: 25828.6557; val_gene_expr_recon_loss: 9741.1532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38215.2446; val_optim_loss: 38215.2446
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2648.3001; train_edge_recon_loss: 26836.9328; train_gene_expr_recon_loss: 9650.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39136.1689; train_optim_loss: 39136.1689; val_kl_reg_loss: 2645.0953; val_edge_recon_loss: 25830.8857; val_gene_expr_recon_loss: 9751.1002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38227.0811; val_optim_loss: 38227.0811
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2648.3153; train_edge_recon_loss: 26833.8930; train_gene_expr_recon_loss: 9647.6267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39129.8349; train_optim_loss: 39129.8349; val_kl_reg_loss: 2649.8332; val_edge_recon_loss: 25813.1267; val_gene_expr_recon_loss: 9744.6078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38207.5674; val_optim_loss: 38207.5674

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 118 min 47 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9949
Val best accuracy score: 0.9800
Val best F1 score: 0.9802
Val gene expr MSE score: 0.6244

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
