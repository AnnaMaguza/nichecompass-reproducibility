None
Run timestamp: 02072023_092520_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9862; val_auprc_score: 0.9844; val_best_acc_score: 0.9473; val_best_f1_score: 0.9477; train_kl_reg_loss: 759.0736; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11877.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12636.4689; train_optim_loss: 12636.4689; val_kl_reg_loss: 695.0407; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10650.3064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11345.3471; val_optim_loss: 11345.3471
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9885; val_auprc_score: 0.9873; val_best_acc_score: 0.9515; val_best_f1_score: 0.9523; train_kl_reg_loss: 643.4759; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10563.4458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11206.9216; train_optim_loss: 11206.9216; val_kl_reg_loss: 605.1207; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10194.4061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10799.5268; val_optim_loss: 10799.5268
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9901; val_auprc_score: 0.9892; val_best_acc_score: 0.9566; val_best_f1_score: 0.9568; train_kl_reg_loss: 574.3272; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10263.5617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10837.8889; train_optim_loss: 10837.8889; val_kl_reg_loss: 549.2467; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9979.0780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10528.3247; val_optim_loss: 10528.3247
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9908; val_auprc_score: 0.9900; val_best_acc_score: 0.9568; val_best_f1_score: 0.9567; train_kl_reg_loss: 537.3399; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10104.0675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10641.4074; train_optim_loss: 10641.4074; val_kl_reg_loss: 527.4007; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9889.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10416.4706; val_optim_loss: 10416.4706
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9909; val_best_acc_score: 0.9591; val_best_f1_score: 0.9595; train_kl_reg_loss: 515.0095; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9991.1594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10506.1688; train_optim_loss: 10506.1688; val_kl_reg_loss: 511.4577; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9810.9359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10322.3937; val_optim_loss: 10322.3937
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9920; val_auprc_score: 0.9913; val_best_acc_score: 0.9592; val_best_f1_score: 0.9592; train_kl_reg_loss: 501.8287; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9926.0730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10427.9017; train_optim_loss: 10427.9017; val_kl_reg_loss: 499.2974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9754.5272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10253.8246; val_optim_loss: 10253.8246
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9921; val_best_acc_score: 0.9611; val_best_f1_score: 0.9614; train_kl_reg_loss: 493.9589; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9879.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10373.4451; train_optim_loss: 10373.4451; val_kl_reg_loss: 477.9415; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9738.9341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10216.8756; val_optim_loss: 10216.8756
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9929; val_best_acc_score: 0.9629; val_best_f1_score: 0.9630; train_kl_reg_loss: 488.9823; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9840.1524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10329.1346; train_optim_loss: 10329.1346; val_kl_reg_loss: 481.0821; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9753.1520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10234.2341; val_optim_loss: 10234.2341
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9931; val_auprc_score: 0.9928; val_best_acc_score: 0.9624; val_best_f1_score: 0.9624; train_kl_reg_loss: 485.9819; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9816.0159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10301.9978; train_optim_loss: 10301.9978; val_kl_reg_loss: 480.9826; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9709.4449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10190.4275; val_optim_loss: 10190.4275
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9934; val_auprc_score: 0.9932; val_best_acc_score: 0.9633; val_best_f1_score: 0.9636; train_kl_reg_loss: 484.6282; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9789.4873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10274.1155; train_optim_loss: 10274.1155; val_kl_reg_loss: 484.6884; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9700.2900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10184.9784; val_optim_loss: 10184.9784
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9936; val_best_acc_score: 0.9640; val_best_f1_score: 0.9641; train_kl_reg_loss: 483.5297; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9776.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10260.4784; train_optim_loss: 10260.4784; val_kl_reg_loss: 473.3791; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9731.8907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10205.2698; val_optim_loss: 10205.2698
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9938; val_auprc_score: 0.9933; val_best_acc_score: 0.9648; val_best_f1_score: 0.9647; train_kl_reg_loss: 482.9566; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9760.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10242.9787; train_optim_loss: 10242.9787; val_kl_reg_loss: 479.7132; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9715.5076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10195.2208; val_optim_loss: 10195.2208
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9943; val_auprc_score: 0.9940; val_best_acc_score: 0.9654; val_best_f1_score: 0.9657; train_kl_reg_loss: 483.1988; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9737.2508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10220.4496; train_optim_loss: 10220.4496; val_kl_reg_loss: 462.7771; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9709.6310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10172.4081; val_optim_loss: 10172.4081
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9939; val_auprc_score: 0.9937; val_best_acc_score: 0.9646; val_best_f1_score: 0.9648; train_kl_reg_loss: 484.0726; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9726.4862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10210.5588; train_optim_loss: 10210.5588; val_kl_reg_loss: 484.7474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9707.4628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10192.2102; val_optim_loss: 10192.2102
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9938; val_auprc_score: 0.9933; val_best_acc_score: 0.9650; val_best_f1_score: 0.9651; train_kl_reg_loss: 484.9404; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9714.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10199.8279; train_optim_loss: 10199.8279; val_kl_reg_loss: 468.0074; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9723.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10191.5800; val_optim_loss: 10191.5800
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9939; val_best_acc_score: 0.9650; val_best_f1_score: 0.9653; train_kl_reg_loss: 485.8752; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9705.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10191.0367; train_optim_loss: 10191.0367; val_kl_reg_loss: 476.4988; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9708.3991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10184.8978; val_optim_loss: 10184.8978
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9943; val_auprc_score: 0.9941; val_best_acc_score: 0.9656; val_best_f1_score: 0.9659; train_kl_reg_loss: 486.8283; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9696.4049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10183.2332; train_optim_loss: 10183.2332; val_kl_reg_loss: 474.7711; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9739.4596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10214.2307; val_optim_loss: 10214.2307

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9945; val_auprc_score: 0.9942; val_best_acc_score: 0.9665; val_best_f1_score: 0.9666; train_kl_reg_loss: 486.0565; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9652.6144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10138.6709; train_optim_loss: 10138.6709; val_kl_reg_loss: 480.1976; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9705.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10185.4850; val_optim_loss: 10185.4850
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9941; val_best_acc_score: 0.9666; val_best_f1_score: 0.9667; train_kl_reg_loss: 485.8518; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9640.4972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10126.3489; train_optim_loss: 10126.3489; val_kl_reg_loss: 481.5073; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9693.7497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10175.2570; val_optim_loss: 10175.2570
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9943; val_best_acc_score: 0.9666; val_best_f1_score: 0.9666; train_kl_reg_loss: 486.3523; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9642.9957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10129.3481; train_optim_loss: 10129.3481; val_kl_reg_loss: 477.3399; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9721.9238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10199.2637; val_optim_loss: 10199.2637
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9948; val_auprc_score: 0.9946; val_best_acc_score: 0.9672; val_best_f1_score: 0.9672; train_kl_reg_loss: 486.6296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9636.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10122.6575; train_optim_loss: 10122.6575; val_kl_reg_loss: 474.8790; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9694.0877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10168.9667; val_optim_loss: 10168.9667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9945; val_auprc_score: 0.9941; val_best_acc_score: 0.9670; val_best_f1_score: 0.9670; train_kl_reg_loss: 486.8210; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9631.4135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10118.2344; train_optim_loss: 10118.2344; val_kl_reg_loss: 480.1659; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9711.1850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10191.3509; val_optim_loss: 10191.3509
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9944; val_best_acc_score: 0.9670; val_best_f1_score: 0.9669; train_kl_reg_loss: 487.4521; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9633.3699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10120.8219; train_optim_loss: 10120.8219; val_kl_reg_loss: 480.4010; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9719.1792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10199.5802; val_optim_loss: 10199.5802
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9948; val_auprc_score: 0.9944; val_best_acc_score: 0.9673; val_best_f1_score: 0.9675; train_kl_reg_loss: 488.0440; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9634.3343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10122.3783; train_optim_loss: 10122.3783; val_kl_reg_loss: 478.5503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9725.9117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10204.4619; val_optim_loss: 10204.4619
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9947; val_auprc_score: 0.9943; val_best_acc_score: 0.9666; val_best_f1_score: 0.9665; train_kl_reg_loss: 487.9082; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9626.3730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10114.2812; train_optim_loss: 10114.2812; val_kl_reg_loss: 478.7286; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9720.6165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10199.3451; val_optim_loss: 10199.3451

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9947; val_auprc_score: 0.9945; val_best_acc_score: 0.9666; val_best_f1_score: 0.9668; train_kl_reg_loss: 488.2302; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9616.2393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10104.4695; train_optim_loss: 10104.4695; val_kl_reg_loss: 479.9982; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9708.6326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10188.6308; val_optim_loss: 10188.6308
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9947; val_auprc_score: 0.9943; val_best_acc_score: 0.9666; val_best_f1_score: 0.9669; train_kl_reg_loss: 488.2775; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9624.5108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10112.7882; train_optim_loss: 10112.7882; val_kl_reg_loss: 480.2645; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9721.0332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10201.2977; val_optim_loss: 10201.2977
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9945; val_best_acc_score: 0.9668; val_best_f1_score: 0.9669; train_kl_reg_loss: 488.1530; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9618.4224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10106.5753; train_optim_loss: 10106.5753; val_kl_reg_loss: 480.1055; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9715.0423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10195.1479; val_optim_loss: 10195.1479
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9948; val_auprc_score: 0.9945; val_best_acc_score: 0.9669; val_best_f1_score: 0.9671; train_kl_reg_loss: 488.2471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 9615.2183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10103.4654; train_optim_loss: 10103.4654; val_kl_reg_loss: 479.9393; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 9726.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10206.8898; val_optim_loss: 10206.8898

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 255 min 7 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9947
Val AUPRC score: 0.9946
Val best accuracy score: 0.9671
Val best F1 score: 0.9670
Val gene expr MSE score: 0.6844

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
