None
Run timestamp: 08082023_194740_103.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_103']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9618; val_auprc_score: 0.9531; val_best_acc_score: 0.9028; val_best_f1_score: 0.9072; train_kl_reg_loss: 42142.5189; train_edge_recon_loss: 26882120.8621; train_gene_expr_recon_loss: 12468250.2840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39392513.6770; train_optim_loss: 39392513.6770; val_kl_reg_loss: 41300.4017; val_edge_recon_loss: 26562719.0370; val_gene_expr_recon_loss: 11309737.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37913757.0000; val_optim_loss: 37913757.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9796; val_auprc_score: 0.9760; val_best_acc_score: 0.9314; val_best_f1_score: 0.9333; train_kl_reg_loss: 36276.5254; train_edge_recon_loss: 26290462.4949; train_gene_expr_recon_loss: 11046035.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37372774.5350; train_optim_loss: 37372774.5350; val_kl_reg_loss: 30323.0653; val_edge_recon_loss: 26314002.3704; val_gene_expr_recon_loss: 10762255.2639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37106580.7222; val_optim_loss: 37106580.7222
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9841; val_auprc_score: 0.9810; val_best_acc_score: 0.9421; val_best_f1_score: 0.9434; train_kl_reg_loss: 30527.5565; train_edge_recon_loss: 26099567.8693; train_gene_expr_recon_loss: 10705132.6600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36835228.0905; train_optim_loss: 36835228.0905; val_kl_reg_loss: 28973.5603; val_edge_recon_loss: 26170148.6296; val_gene_expr_recon_loss: 10571093.6991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36770215.9444; val_optim_loss: 36770215.9444
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9863; val_auprc_score: 0.9839; val_best_acc_score: 0.9466; val_best_f1_score: 0.9476; train_kl_reg_loss: 28575.6477; train_edge_recon_loss: 26027367.4825; train_gene_expr_recon_loss: 10570270.1147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36626213.2284; train_optim_loss: 36626213.2284; val_kl_reg_loss: 27811.6148; val_edge_recon_loss: 26156965.4167; val_gene_expr_recon_loss: 10472603.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36657380.5741; val_optim_loss: 36657380.5741
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9873; val_auprc_score: 0.9849; val_best_acc_score: 0.9492; val_best_f1_score: 0.9502; train_kl_reg_loss: 27198.7481; train_edge_recon_loss: 25987863.3992; train_gene_expr_recon_loss: 10510110.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36525172.1749; train_optim_loss: 36525172.1749; val_kl_reg_loss: 26427.9843; val_edge_recon_loss: 26117474.0926; val_gene_expr_recon_loss: 10439746.9815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36583648.9444; val_optim_loss: 36583648.9444
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9887; val_auprc_score: 0.9867; val_best_acc_score: 0.9537; val_best_f1_score: 0.9545; train_kl_reg_loss: 26132.9213; train_edge_recon_loss: 25960087.5998; train_gene_expr_recon_loss: 10477007.9470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36463228.4588; train_optim_loss: 36463228.4588; val_kl_reg_loss: 24455.1552; val_edge_recon_loss: 26102464.6667; val_gene_expr_recon_loss: 10415329.7685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36542249.5370; val_optim_loss: 36542249.5370
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9891; val_auprc_score: 0.9868; val_best_acc_score: 0.9544; val_best_f1_score: 0.9552; train_kl_reg_loss: 25181.9438; train_edge_recon_loss: 25937182.3920; train_gene_expr_recon_loss: 10450934.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36413298.7058; train_optim_loss: 36413298.7058; val_kl_reg_loss: 24461.9228; val_edge_recon_loss: 26065082.0833; val_gene_expr_recon_loss: 10418921.8472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36508465.8889; val_optim_loss: 36508465.8889
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9900; val_auprc_score: 0.9881; val_best_acc_score: 0.9569; val_best_f1_score: 0.9576; train_kl_reg_loss: 24477.6066; train_edge_recon_loss: 25900434.1502; train_gene_expr_recon_loss: 10436617.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36361529.5144; train_optim_loss: 36361529.5144; val_kl_reg_loss: 24003.9317; val_edge_recon_loss: 26023266.3981; val_gene_expr_recon_loss: 10398584.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36445854.6852; val_optim_loss: 36445854.6852
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9903; val_auprc_score: 0.9881; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 23956.6458; train_edge_recon_loss: 25884487.4105; train_gene_expr_recon_loss: 10431973.8879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36340417.9588; train_optim_loss: 36340417.9588; val_kl_reg_loss: 23284.3835; val_edge_recon_loss: 26013328.8056; val_gene_expr_recon_loss: 10380915.5185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36417528.6481; val_optim_loss: 36417528.6481
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9883; val_best_acc_score: 0.9597; val_best_f1_score: 0.9604; train_kl_reg_loss: 23688.5248; train_edge_recon_loss: 25870529.7840; train_gene_expr_recon_loss: 10418056.2186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36312274.5082; train_optim_loss: 36312274.5082; val_kl_reg_loss: 23269.2028; val_edge_recon_loss: 25984281.9259; val_gene_expr_recon_loss: 10380857.0185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36388408.0370; val_optim_loss: 36388408.0370
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9903; val_auprc_score: 0.9882; val_best_acc_score: 0.9588; val_best_f1_score: 0.9596; train_kl_reg_loss: 23506.9039; train_edge_recon_loss: 25848097.7695; train_gene_expr_recon_loss: 10417086.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36288690.7181; train_optim_loss: 36288690.7181; val_kl_reg_loss: 23567.9349; val_edge_recon_loss: 25985720.5463; val_gene_expr_recon_loss: 10386369.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36395658.4630; val_optim_loss: 36395658.4630
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 23314.0975; train_edge_recon_loss: 25839793.5340; train_gene_expr_recon_loss: 10408183.0725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36271290.6852; train_optim_loss: 36271290.6852; val_kl_reg_loss: 23373.6671; val_edge_recon_loss: 25944635.1759; val_gene_expr_recon_loss: 10380020.2639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36348029.0185; val_optim_loss: 36348029.0185
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9917; val_auprc_score: 0.9899; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 23033.5831; train_edge_recon_loss: 25841327.4084; train_gene_expr_recon_loss: 10403452.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36267813.2840; train_optim_loss: 36267813.2840; val_kl_reg_loss: 22469.1689; val_edge_recon_loss: 25961863.6944; val_gene_expr_recon_loss: 10370283.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36354616.0926; val_optim_loss: 36354616.0926
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9915; val_auprc_score: 0.9895; val_best_acc_score: 0.9635; val_best_f1_score: 0.9642; train_kl_reg_loss: 22882.4335; train_edge_recon_loss: 25826873.3529; train_gene_expr_recon_loss: 10398692.1024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36248447.9630; train_optim_loss: 36248447.9630; val_kl_reg_loss: 22464.8746; val_edge_recon_loss: 25935584.4630; val_gene_expr_recon_loss: 10378174.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36336223.5370; val_optim_loss: 36336223.5370
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9911; val_auprc_score: 0.9888; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 22670.9768; train_edge_recon_loss: 25820031.1214; train_gene_expr_recon_loss: 10398515.3987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36241217.5226; train_optim_loss: 36241217.5226; val_kl_reg_loss: 22319.1564; val_edge_recon_loss: 25963190.7778; val_gene_expr_recon_loss: 10349586.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36335096.4630; val_optim_loss: 36335096.4630
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9913; val_auprc_score: 0.9893; val_best_acc_score: 0.9624; val_best_f1_score: 0.9629; train_kl_reg_loss: 22473.3101; train_edge_recon_loss: 25815355.2521; train_gene_expr_recon_loss: 10397771.2124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36235599.7798; train_optim_loss: 36235599.7798; val_kl_reg_loss: 23118.9930; val_edge_recon_loss: 25913175.9167; val_gene_expr_recon_loss: 10370042.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36306337.4074; val_optim_loss: 36306337.4074
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 22418.9786; train_edge_recon_loss: 25807978.8210; train_gene_expr_recon_loss: 10390517.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36220914.9671; train_optim_loss: 36220914.9671; val_kl_reg_loss: 22224.8961; val_edge_recon_loss: 25930174.8796; val_gene_expr_recon_loss: 10367231.7130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36319631.5741; val_optim_loss: 36319631.5741
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 22469.5519; train_edge_recon_loss: 25794648.5082; train_gene_expr_recon_loss: 10385762.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36202880.1132; train_optim_loss: 36202880.1132; val_kl_reg_loss: 22133.9784; val_edge_recon_loss: 25911406.8611; val_gene_expr_recon_loss: 10352923.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36286464.7593; val_optim_loss: 36286464.7593
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9922; val_auprc_score: 0.9903; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 22194.0074; train_edge_recon_loss: 25799535.8354; train_gene_expr_recon_loss: 10386578.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36208307.8251; train_optim_loss: 36208307.8251; val_kl_reg_loss: 21648.3763; val_edge_recon_loss: 25893220.8889; val_gene_expr_recon_loss: 10369472.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36284341.9815; val_optim_loss: 36284341.9815
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 22142.3211; train_edge_recon_loss: 25787614.2202; train_gene_expr_recon_loss: 10385327.8102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36195084.3539; train_optim_loss: 36195084.3539; val_kl_reg_loss: 21178.0766; val_edge_recon_loss: 25888903.7778; val_gene_expr_recon_loss: 10371563.6019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36281645.6852; val_optim_loss: 36281645.6852
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9657; val_best_f1_score: 0.9662; train_kl_reg_loss: 22021.3477; train_edge_recon_loss: 25788528.1132; train_gene_expr_recon_loss: 10385117.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36195667.0988; train_optim_loss: 36195667.0988; val_kl_reg_loss: 21643.3087; val_edge_recon_loss: 25895370.1667; val_gene_expr_recon_loss: 10367405.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36284419.1667; val_optim_loss: 36284419.1667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 21911.5571; train_edge_recon_loss: 25772333.5154; train_gene_expr_recon_loss: 10382927.2284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36177172.3251; train_optim_loss: 36177172.3251; val_kl_reg_loss: 21340.3539; val_edge_recon_loss: 25878120.2222; val_gene_expr_recon_loss: 10369401.5093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36268862.1296; val_optim_loss: 36268862.1296
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9668; val_best_f1_score: 0.9672; train_kl_reg_loss: 21785.1814; train_edge_recon_loss: 25778422.7438; train_gene_expr_recon_loss: 10381609.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36181817.6420; train_optim_loss: 36181817.6420; val_kl_reg_loss: 21238.9578; val_edge_recon_loss: 25897410.8981; val_gene_expr_recon_loss: 10361978.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36280627.8704; val_optim_loss: 36280627.8704
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9925; val_auprc_score: 0.9908; val_best_acc_score: 0.9666; val_best_f1_score: 0.9670; train_kl_reg_loss: 21943.7325; train_edge_recon_loss: 25771771.8827; train_gene_expr_recon_loss: 10378754.8431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36172470.4547; train_optim_loss: 36172470.4547; val_kl_reg_loss: 21664.2321; val_edge_recon_loss: 25897307.0278; val_gene_expr_recon_loss: 10363760.4722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36282731.8148; val_optim_loss: 36282731.8148
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 21919.8444; train_edge_recon_loss: 25768645.4393; train_gene_expr_recon_loss: 10383153.1348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36173718.3765; train_optim_loss: 36173718.3765; val_kl_reg_loss: 21124.1966; val_edge_recon_loss: 25882213.1481; val_gene_expr_recon_loss: 10356217.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36259554.6852; val_optim_loss: 36259554.6852
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 21803.9206; train_edge_recon_loss: 25757424.3405; train_gene_expr_recon_loss: 10380720.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36159948.3230; train_optim_loss: 36159948.3230; val_kl_reg_loss: 21789.0161; val_edge_recon_loss: 25859053.8333; val_gene_expr_recon_loss: 10356534.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36237377.0741; val_optim_loss: 36237377.0741
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9672; val_best_f1_score: 0.9676; train_kl_reg_loss: 21664.3144; train_edge_recon_loss: 25761974.0751; train_gene_expr_recon_loss: 10378296.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36161934.9547; train_optim_loss: 36161934.9547; val_kl_reg_loss: 21090.9186; val_edge_recon_loss: 25903551.7963; val_gene_expr_recon_loss: 10348517.5093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36273160.1852; val_optim_loss: 36273160.1852
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 21660.6507; train_edge_recon_loss: 25760493.8416; train_gene_expr_recon_loss: 10378838.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36160992.9609; train_optim_loss: 36160992.9609; val_kl_reg_loss: 21331.5179; val_edge_recon_loss: 25860382.6852; val_gene_expr_recon_loss: 10362901.0972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36244615.2593; val_optim_loss: 36244615.2593
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9928; val_auprc_score: 0.9908; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 21633.3290; train_edge_recon_loss: 25760411.5792; train_gene_expr_recon_loss: 10376260.1749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36158305.0638; train_optim_loss: 36158305.0638; val_kl_reg_loss: 21145.1474; val_edge_recon_loss: 25867711.0185; val_gene_expr_recon_loss: 10361060.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36249916.6296; val_optim_loss: 36249916.6296
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 21606.1317; train_edge_recon_loss: 25744698.8447; train_gene_expr_recon_loss: 10370299.5679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36136604.5473; train_optim_loss: 36136604.5473; val_kl_reg_loss: 21221.9455; val_edge_recon_loss: 25860734.2870; val_gene_expr_recon_loss: 10358164.6944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36240120.9815; val_optim_loss: 36240120.9815

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9930; val_auprc_score: 0.9910; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 22708.1620; train_edge_recon_loss: 25730147.4969; train_gene_expr_recon_loss: 10320732.6209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36073588.2675; train_optim_loss: 36073588.2675; val_kl_reg_loss: 22755.7781; val_edge_recon_loss: 25864202.0926; val_gene_expr_recon_loss: 10312022.8380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36198980.7778; val_optim_loss: 36198980.7778
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9933; val_auprc_score: 0.9918; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 23125.1282; train_edge_recon_loss: 25728351.5340; train_gene_expr_recon_loss: 10316862.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36068339.4362; train_optim_loss: 36068339.4362; val_kl_reg_loss: 22990.3849; val_edge_recon_loss: 25866397.0185; val_gene_expr_recon_loss: 10307292.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36196680.4444; val_optim_loss: 36196680.4444
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 23294.6363; train_edge_recon_loss: 25732573.9578; train_gene_expr_recon_loss: 10313540.5818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36069409.1852; train_optim_loss: 36069409.1852; val_kl_reg_loss: 22969.7093; val_edge_recon_loss: 25837259.6111; val_gene_expr_recon_loss: 10306782.7593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36167011.9074; val_optim_loss: 36167011.9074
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 23384.9532; train_edge_recon_loss: 25723130.5782; train_gene_expr_recon_loss: 10312429.4079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36058944.9733; train_optim_loss: 36058944.9733; val_kl_reg_loss: 23167.9553; val_edge_recon_loss: 25853241.6944; val_gene_expr_recon_loss: 10304114.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36180523.9074; val_optim_loss: 36180523.9074
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9935; val_auprc_score: 0.9917; val_best_acc_score: 0.9702; val_best_f1_score: 0.9706; train_kl_reg_loss: 23432.4077; train_edge_recon_loss: 25723429.2099; train_gene_expr_recon_loss: 10305751.5098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36052613.1564; train_optim_loss: 36052613.1564; val_kl_reg_loss: 23218.9854; val_edge_recon_loss: 25816157.4722; val_gene_expr_recon_loss: 10302373.1065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36141749.5000; val_optim_loss: 36141749.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 23514.9502; train_edge_recon_loss: 25725556.6214; train_gene_expr_recon_loss: 10306441.4084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36055513.0123; train_optim_loss: 36055513.0123; val_kl_reg_loss: 23165.9333; val_edge_recon_loss: 25819538.6574; val_gene_expr_recon_loss: 10302426.1435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36145130.5185; val_optim_loss: 36145130.5185
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 23437.3620; train_edge_recon_loss: 25721694.0165; train_gene_expr_recon_loss: 10305707.3349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36050838.6646; train_optim_loss: 36050838.6646; val_kl_reg_loss: 22970.5028; val_edge_recon_loss: 25828628.8148; val_gene_expr_recon_loss: 10302326.4213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36153925.7778; val_optim_loss: 36153925.7778
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9933; val_auprc_score: 0.9916; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 23372.9735; train_edge_recon_loss: 25726616.2068; train_gene_expr_recon_loss: 10307829.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36057818.8765; train_optim_loss: 36057818.8765; val_kl_reg_loss: 22972.9127; val_edge_recon_loss: 25838491.5278; val_gene_expr_recon_loss: 10305262.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36166727.2037; val_optim_loss: 36166727.2037
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 23485.9511; train_edge_recon_loss: 25727162.2490; train_gene_expr_recon_loss: 10306817.9686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36057466.1564; train_optim_loss: 36057466.1564; val_kl_reg_loss: 23338.8717; val_edge_recon_loss: 25846916.8426; val_gene_expr_recon_loss: 10310209.1157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36180464.8333; val_optim_loss: 36180464.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 23653.1776; train_edge_recon_loss: 25720554.7294; train_gene_expr_recon_loss: 10297416.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36041624.7819; train_optim_loss: 36041624.7819; val_kl_reg_loss: 23374.2503; val_edge_recon_loss: 25826442.0926; val_gene_expr_recon_loss: 10310611.9306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36160428.1852; val_optim_loss: 36160428.1852
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 23666.5921; train_edge_recon_loss: 25726520.2881; train_gene_expr_recon_loss: 10298253.4841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36048440.4074; train_optim_loss: 36048440.4074; val_kl_reg_loss: 23340.8243; val_edge_recon_loss: 25851179.9074; val_gene_expr_recon_loss: 10311174.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36185695.5185; val_optim_loss: 36185695.5185
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 23638.4703; train_edge_recon_loss: 25724615.7675; train_gene_expr_recon_loss: 10295893.2155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36044147.4424; train_optim_loss: 36044147.4424; val_kl_reg_loss: 23284.8922; val_edge_recon_loss: 25837134.4352; val_gene_expr_recon_loss: 10300156.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36160575.8889; val_optim_loss: 36160575.8889
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 23637.9170; train_edge_recon_loss: 25725063.0556; train_gene_expr_recon_loss: 10296072.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36044773.6235; train_optim_loss: 36044773.6235; val_kl_reg_loss: 23284.1159; val_edge_recon_loss: 25840022.0741; val_gene_expr_recon_loss: 10301515.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36164822.0556; val_optim_loss: 36164822.0556

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 372 min 46 sec.
Using best model state, which was in epoch 35.
