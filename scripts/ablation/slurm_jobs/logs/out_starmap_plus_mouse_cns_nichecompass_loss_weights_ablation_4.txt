None
Run timestamp: 14072023_082229_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9861; val_auprc_score: 0.9816; val_best_acc_score: 0.9518; val_best_f1_score: 0.9529; train_kl_reg_loss: 31752.1850; train_edge_recon_loss: 2665069.9033; train_gene_expr_recon_loss: 1165277.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3862099.9357; train_optim_loss: 3862099.9357; val_kl_reg_loss: 28640.9906; val_edge_recon_loss: 2609545.2781; val_gene_expr_recon_loss: 1076490.5203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3714676.7875; val_optim_loss: 3714676.7875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9850; val_best_acc_score: 0.9622; val_best_f1_score: 0.9630; train_kl_reg_loss: 26341.5910; train_edge_recon_loss: 2596164.5031; train_gene_expr_recon_loss: 1044412.2602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3666918.3557; train_optim_loss: 3666918.3557; val_kl_reg_loss: 24533.5277; val_edge_recon_loss: 2592048.5094; val_gene_expr_recon_loss: 1032286.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3648868.8438; val_optim_loss: 3648868.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9910; val_auprc_score: 0.9880; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 23349.0316; train_edge_recon_loss: 2584969.8561; train_gene_expr_recon_loss: 1009513.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3617832.5400; train_optim_loss: 3617832.5400; val_kl_reg_loss: 22084.7905; val_edge_recon_loss: 2583415.4656; val_gene_expr_recon_loss: 1011136.0609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3616636.3344; val_optim_loss: 3616636.3344
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 21362.3864; train_edge_recon_loss: 2577235.6551; train_gene_expr_recon_loss: 992247.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3590845.9054; train_optim_loss: 3590845.9054; val_kl_reg_loss: 20263.9221; val_edge_recon_loss: 2577912.6938; val_gene_expr_recon_loss: 996723.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3594900.0781; val_optim_loss: 3594900.0781
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9937; val_auprc_score: 0.9917; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 19971.2948; train_edge_recon_loss: 2572825.5313; train_gene_expr_recon_loss: 979933.4332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3572730.2608; train_optim_loss: 3572730.2608; val_kl_reg_loss: 19630.7355; val_edge_recon_loss: 2575566.2750; val_gene_expr_recon_loss: 984971.5422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3580168.5281; val_optim_loss: 3580168.5281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 19004.3413; train_edge_recon_loss: 2569615.4099; train_gene_expr_recon_loss: 972395.8072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3561015.5556; train_optim_loss: 3561015.5556; val_kl_reg_loss: 18280.8484; val_edge_recon_loss: 2569762.1063; val_gene_expr_recon_loss: 979463.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3567506.0063; val_optim_loss: 3567506.0063
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 18220.0938; train_edge_recon_loss: 2566727.5688; train_gene_expr_recon_loss: 965974.2798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3550921.9371; train_optim_loss: 3550921.9371; val_kl_reg_loss: 17678.0369; val_edge_recon_loss: 2570981.9469; val_gene_expr_recon_loss: 975964.8266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3564624.8281; val_optim_loss: 3564624.8281
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 17544.3223; train_edge_recon_loss: 2564299.1603; train_gene_expr_recon_loss: 961916.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3543759.4875; train_optim_loss: 3543759.4875; val_kl_reg_loss: 16849.7883; val_edge_recon_loss: 2567426.6594; val_gene_expr_recon_loss: 973317.5414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3557593.9906; val_optim_loss: 3557593.9906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 16995.4235; train_edge_recon_loss: 2562333.8334; train_gene_expr_recon_loss: 957432.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3536761.3620; train_optim_loss: 3536761.3620; val_kl_reg_loss: 16691.0880; val_edge_recon_loss: 2564488.3875; val_gene_expr_recon_loss: 969579.7898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550759.2656; val_optim_loss: 3550759.2656
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 16504.1760; train_edge_recon_loss: 2560551.0605; train_gene_expr_recon_loss: 954556.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3531611.8814; train_optim_loss: 3531611.8814; val_kl_reg_loss: 16125.6317; val_edge_recon_loss: 2561618.3813; val_gene_expr_recon_loss: 968937.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3546681.4344; val_optim_loss: 3546681.4344
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 16083.5782; train_edge_recon_loss: 2559009.6318; train_gene_expr_recon_loss: 950970.4378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3526063.6513; train_optim_loss: 3526063.6513; val_kl_reg_loss: 15796.4577; val_edge_recon_loss: 2562559.2625; val_gene_expr_recon_loss: 965105.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543461.2344; val_optim_loss: 3543461.2344
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 15773.8560; train_edge_recon_loss: 2557572.5671; train_gene_expr_recon_loss: 949571.4009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3522917.8216; train_optim_loss: 3522917.8216; val_kl_reg_loss: 15392.9616; val_edge_recon_loss: 2560576.2656; val_gene_expr_recon_loss: 968876.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544845.7250; val_optim_loss: 3544845.7250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 15506.7202; train_edge_recon_loss: 2556907.6043; train_gene_expr_recon_loss: 946300.5783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3518714.8988; train_optim_loss: 3518714.8988; val_kl_reg_loss: 15381.4985; val_edge_recon_loss: 2557520.4562; val_gene_expr_recon_loss: 964801.2547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537703.2219; val_optim_loss: 3537703.2219
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9952; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 15278.6239; train_edge_recon_loss: 2556039.4461; train_gene_expr_recon_loss: 944887.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3516205.6575; train_optim_loss: 3516205.6575; val_kl_reg_loss: 15059.9250; val_edge_recon_loss: 2557174.7469; val_gene_expr_recon_loss: 963806.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536041.3031; val_optim_loss: 3536041.3031
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 15044.5491; train_edge_recon_loss: 2555410.1134; train_gene_expr_recon_loss: 942496.4808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3512951.1398; train_optim_loss: 3512951.1398; val_kl_reg_loss: 14757.0190; val_edge_recon_loss: 2556475.8531; val_gene_expr_recon_loss: 964283.0422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535515.9031; val_optim_loss: 3535515.9031
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 14833.0513; train_edge_recon_loss: 2555140.0090; train_gene_expr_recon_loss: 940892.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3510865.5622; train_optim_loss: 3510865.5622; val_kl_reg_loss: 14770.4561; val_edge_recon_loss: 2556782.7500; val_gene_expr_recon_loss: 965669.6984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537222.9125; val_optim_loss: 3537222.9125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 14689.2116; train_edge_recon_loss: 2553217.9652; train_gene_expr_recon_loss: 939428.4678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3507335.6481; train_optim_loss: 3507335.6481; val_kl_reg_loss: 14633.3920; val_edge_recon_loss: 2554284.0938; val_gene_expr_recon_loss: 966141.0680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535058.5594; val_optim_loss: 3535058.5594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 14592.8609; train_edge_recon_loss: 2552418.0435; train_gene_expr_recon_loss: 937335.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3504346.0560; train_optim_loss: 3504346.0560; val_kl_reg_loss: 14385.0464; val_edge_recon_loss: 2555035.9906; val_gene_expr_recon_loss: 964641.8688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3534062.9000; val_optim_loss: 3534062.9000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 14429.3601; train_edge_recon_loss: 2552744.7034; train_gene_expr_recon_loss: 936164.4493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3503338.5143; train_optim_loss: 3503338.5143; val_kl_reg_loss: 14210.9240; val_edge_recon_loss: 2553407.6750; val_gene_expr_recon_loss: 964013.7977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3531632.3969; val_optim_loss: 3531632.3969
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 14335.4505; train_edge_recon_loss: 2552361.7104; train_gene_expr_recon_loss: 935126.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3501823.3964; train_optim_loss: 3501823.3964; val_kl_reg_loss: 14288.0516; val_edge_recon_loss: 2552176.6000; val_gene_expr_recon_loss: 967121.0289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3533585.6656; val_optim_loss: 3533585.6656
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 14271.3349; train_edge_recon_loss: 2550816.2048; train_gene_expr_recon_loss: 934069.4465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3499156.9844; train_optim_loss: 3499156.9844; val_kl_reg_loss: 14155.2899; val_edge_recon_loss: 2549757.1219; val_gene_expr_recon_loss: 966524.9820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530437.4094; val_optim_loss: 3530437.4094
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9959; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 14172.5273; train_edge_recon_loss: 2550712.7250; train_gene_expr_recon_loss: 932648.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3497534.2083; train_optim_loss: 3497534.2083; val_kl_reg_loss: 13892.3251; val_edge_recon_loss: 2552351.8219; val_gene_expr_recon_loss: 965837.4461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3532081.5812; val_optim_loss: 3532081.5812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9960; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 14126.9851; train_edge_recon_loss: 2550017.7695; train_gene_expr_recon_loss: 931152.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3495297.2083; train_optim_loss: 3495297.2083; val_kl_reg_loss: 14148.2864; val_edge_recon_loss: 2552942.4500; val_gene_expr_recon_loss: 965371.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3532462.6094; val_optim_loss: 3532462.6094
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 14060.9657; train_edge_recon_loss: 2550131.9913; train_gene_expr_recon_loss: 930265.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3494458.0028; train_optim_loss: 3494458.0028; val_kl_reg_loss: 13869.8782; val_edge_recon_loss: 2550177.3594; val_gene_expr_recon_loss: 968666.5258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3532713.7594; val_optim_loss: 3532713.7594
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 13998.0826; train_edge_recon_loss: 2549757.2792; train_gene_expr_recon_loss: 929548.1708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3493303.5299; train_optim_loss: 3493303.5299; val_kl_reg_loss: 13840.8184; val_edge_recon_loss: 2553504.1406; val_gene_expr_recon_loss: 967074.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3534418.9750; val_optim_loss: 3534418.9750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 14236.3391; train_edge_recon_loss: 2549120.9478; train_gene_expr_recon_loss: 922272.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3485630.0793; train_optim_loss: 3485630.0793; val_kl_reg_loss: 14257.7682; val_edge_recon_loss: 2548464.2969; val_gene_expr_recon_loss: 962817.5578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3525539.6219; val_optim_loss: 3525539.6219
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 14336.2250; train_edge_recon_loss: 2548543.8105; train_gene_expr_recon_loss: 921060.0738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483940.1043; train_optim_loss: 3483940.1043; val_kl_reg_loss: 14215.2235; val_edge_recon_loss: 2548771.2750; val_gene_expr_recon_loss: 966039.7477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529026.2500; val_optim_loss: 3529026.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 14335.9737; train_edge_recon_loss: 2548804.4684; train_gene_expr_recon_loss: 920250.8674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483391.3129; train_optim_loss: 3483391.3129; val_kl_reg_loss: 14237.5907; val_edge_recon_loss: 2551010.8188; val_gene_expr_recon_loss: 967850.8773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3533099.2875; val_optim_loss: 3533099.2875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 14358.4042; train_edge_recon_loss: 2548073.6547; train_gene_expr_recon_loss: 919992.0760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482424.1408; train_optim_loss: 3482424.1408; val_kl_reg_loss: 14271.8968; val_edge_recon_loss: 2549662.8031; val_gene_expr_recon_loss: 966012.0773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529946.7594; val_optim_loss: 3529946.7594
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 14355.5281; train_edge_recon_loss: 2547886.1975; train_gene_expr_recon_loss: 919625.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481867.5014; train_optim_loss: 3481867.5014; val_kl_reg_loss: 14215.2677; val_edge_recon_loss: 2547277.9219; val_gene_expr_recon_loss: 966411.8211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3527905.0063; val_optim_loss: 3527905.0063

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 14323.5020; train_edge_recon_loss: 2548488.7917; train_gene_expr_recon_loss: 919245.3807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482057.6787; train_optim_loss: 3482057.6787; val_kl_reg_loss: 14238.7536; val_edge_recon_loss: 2549579.6625; val_gene_expr_recon_loss: 966628.5891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530447.0125; val_optim_loss: 3530447.0125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 14346.3148; train_edge_recon_loss: 2548302.8498; train_gene_expr_recon_loss: 919416.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482065.3807; train_optim_loss: 3482065.3807; val_kl_reg_loss: 14241.4299; val_edge_recon_loss: 2551281.8094; val_gene_expr_recon_loss: 963483.7492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529006.9906; val_optim_loss: 3529006.9906
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9963; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 14339.3246; train_edge_recon_loss: 2548067.6453; train_gene_expr_recon_loss: 918721.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481128.1033; train_optim_loss: 3481128.1033; val_kl_reg_loss: 14231.3614; val_edge_recon_loss: 2551281.3469; val_gene_expr_recon_loss: 963105.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3528617.9438; val_optim_loss: 3528617.9438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 14348.4332; train_edge_recon_loss: 2547644.5167; train_gene_expr_recon_loss: 919009.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481002.1213; train_optim_loss: 3481002.1213; val_kl_reg_loss: 14267.6236; val_edge_recon_loss: 2552566.9281; val_gene_expr_recon_loss: 965102.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3531936.7969; val_optim_loss: 3531936.7969

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 296 min 13 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9973
Val AUPRC score: 0.9962
Val best accuracy score: 0.9865
Val best F1 score: 0.9866
Val gene expr MSE score: 0.6388

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
