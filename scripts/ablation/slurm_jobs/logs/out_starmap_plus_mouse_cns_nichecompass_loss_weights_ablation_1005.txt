None
Run timestamp: 02072023_162554_1005.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1005']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9835; val_auprc_score: 0.9760; val_best_acc_score: 0.9520; val_best_f1_score: 0.9533; train_kl_reg_loss: 2249.8689; train_edge_recon_loss: 28253.8748; train_gene_expr_recon_loss: 13381.6071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43885.3508; train_optim_loss: 43885.3508; val_kl_reg_loss: 2443.4149; val_edge_recon_loss: 26311.8910; val_gene_expr_recon_loss: 11894.3756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40649.6814; val_optim_loss: 40649.6814
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9827; val_best_acc_score: 0.9620; val_best_f1_score: 0.9629; train_kl_reg_loss: 2494.5755; train_edge_recon_loss: 27323.8317; train_gene_expr_recon_loss: 11598.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41417.1405; train_optim_loss: 41417.1405; val_kl_reg_loss: 2498.3074; val_edge_recon_loss: 26218.7974; val_gene_expr_recon_loss: 11193.9224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39911.0270; val_optim_loss: 39911.0270
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9891; val_auprc_score: 0.9848; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 2505.6541; train_edge_recon_loss: 27242.3370; train_gene_expr_recon_loss: 11102.7056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40850.6966; train_optim_loss: 40850.6966; val_kl_reg_loss: 2473.6712; val_edge_recon_loss: 26163.2516; val_gene_expr_recon_loss: 10856.3074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39493.2299; val_optim_loss: 39493.2299
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9901; val_auprc_score: 0.9865; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 2515.7137; train_edge_recon_loss: 27197.2010; train_gene_expr_recon_loss: 10824.9161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40537.8308; train_optim_loss: 40537.8308; val_kl_reg_loss: 2475.1351; val_edge_recon_loss: 26138.9290; val_gene_expr_recon_loss: 10636.4241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39250.4881; val_optim_loss: 39250.4881
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9880; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 2529.3137; train_edge_recon_loss: 27152.1294; train_gene_expr_recon_loss: 10620.0249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40301.4680; train_optim_loss: 40301.4680; val_kl_reg_loss: 2461.3740; val_edge_recon_loss: 26094.8950; val_gene_expr_recon_loss: 10468.9852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39025.2541; val_optim_loss: 39025.2541
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9882; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 2537.7571; train_edge_recon_loss: 27130.4768; train_gene_expr_recon_loss: 10464.1063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40132.3401; train_optim_loss: 40132.3401; val_kl_reg_loss: 2503.3051; val_edge_recon_loss: 26071.7654; val_gene_expr_recon_loss: 10319.6105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38894.6808; val_optim_loss: 38894.6808
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9919; val_auprc_score: 0.9888; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 2548.9432; train_edge_recon_loss: 27088.4036; train_gene_expr_recon_loss: 10346.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39983.6886; train_optim_loss: 39983.6886; val_kl_reg_loss: 2510.3099; val_edge_recon_loss: 26040.9146; val_gene_expr_recon_loss: 10241.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38792.4201; val_optim_loss: 38792.4201
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9898; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 2556.4274; train_edge_recon_loss: 27078.0477; train_gene_expr_recon_loss: 10255.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39889.8445; train_optim_loss: 39889.8445; val_kl_reg_loss: 2536.3930; val_edge_recon_loss: 26008.2772; val_gene_expr_recon_loss: 10146.5381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38691.2085; val_optim_loss: 38691.2085
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9928; val_auprc_score: 0.9904; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 2564.5317; train_edge_recon_loss: 27049.4659; train_gene_expr_recon_loss: 10182.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39796.0133; train_optim_loss: 39796.0133; val_kl_reg_loss: 2522.4618; val_edge_recon_loss: 25978.8328; val_gene_expr_recon_loss: 10082.2558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38583.5506; val_optim_loss: 38583.5506
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9931; val_auprc_score: 0.9905; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 2570.5188; train_edge_recon_loss: 27043.3059; train_gene_expr_recon_loss: 10112.8798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39726.7045; train_optim_loss: 39726.7045; val_kl_reg_loss: 2536.2142; val_edge_recon_loss: 25983.5347; val_gene_expr_recon_loss: 10036.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38555.8070; val_optim_loss: 38555.8070
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 2581.2851; train_edge_recon_loss: 27005.3474; train_gene_expr_recon_loss: 10063.7798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39650.4124; train_optim_loss: 39650.4124; val_kl_reg_loss: 2585.1591; val_edge_recon_loss: 25959.9070; val_gene_expr_recon_loss: 9999.0515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38544.1175; val_optim_loss: 38544.1175
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9933; val_auprc_score: 0.9910; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 2584.6792; train_edge_recon_loss: 27005.0779; train_gene_expr_recon_loss: 10011.9672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39601.7243; train_optim_loss: 39601.7243; val_kl_reg_loss: 2546.2067; val_edge_recon_loss: 25954.6516; val_gene_expr_recon_loss: 9960.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38461.0664; val_optim_loss: 38461.0664
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9918; val_best_acc_score: 0.9751; val_best_f1_score: 0.9753; train_kl_reg_loss: 2592.2856; train_edge_recon_loss: 26986.7627; train_gene_expr_recon_loss: 9978.5466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39557.5949; train_optim_loss: 39557.5949; val_kl_reg_loss: 2566.5839; val_edge_recon_loss: 25931.6379; val_gene_expr_recon_loss: 9922.9212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38421.1434; val_optim_loss: 38421.1434
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 2597.8406; train_edge_recon_loss: 26972.4929; train_gene_expr_recon_loss: 9946.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39517.1403; train_optim_loss: 39517.1403; val_kl_reg_loss: 2586.8195; val_edge_recon_loss: 25910.5399; val_gene_expr_recon_loss: 9886.1872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38383.5465; val_optim_loss: 38383.5465
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 2604.8699; train_edge_recon_loss: 26958.2412; train_gene_expr_recon_loss: 9925.3142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39488.4253; train_optim_loss: 39488.4253; val_kl_reg_loss: 2588.3338; val_edge_recon_loss: 25928.0404; val_gene_expr_recon_loss: 9860.9501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38377.3242; val_optim_loss: 38377.3242
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9758; val_best_f1_score: 0.9762; train_kl_reg_loss: 2609.7033; train_edge_recon_loss: 26948.8496; train_gene_expr_recon_loss: 9887.9767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39446.5296; train_optim_loss: 39446.5296; val_kl_reg_loss: 2618.9464; val_edge_recon_loss: 25903.4203; val_gene_expr_recon_loss: 9874.3510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38396.7175; val_optim_loss: 38396.7175
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 2615.9709; train_edge_recon_loss: 26930.0201; train_gene_expr_recon_loss: 9868.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39414.7945; train_optim_loss: 39414.7945; val_kl_reg_loss: 2630.1045; val_edge_recon_loss: 25898.7805; val_gene_expr_recon_loss: 9861.6262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38390.5111; val_optim_loss: 38390.5111
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 2621.7447; train_edge_recon_loss: 26922.9956; train_gene_expr_recon_loss: 9846.9733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39391.7137; train_optim_loss: 39391.7137; val_kl_reg_loss: 2592.0157; val_edge_recon_loss: 25877.3498; val_gene_expr_recon_loss: 9848.5565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38317.9222; val_optim_loss: 38317.9222
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 2625.5705; train_edge_recon_loss: 26917.3952; train_gene_expr_recon_loss: 9821.2241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39364.1897; train_optim_loss: 39364.1897; val_kl_reg_loss: 2593.9605; val_edge_recon_loss: 25859.3809; val_gene_expr_recon_loss: 9848.9713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38302.3122; val_optim_loss: 38302.3122
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 2631.5958; train_edge_recon_loss: 26902.4551; train_gene_expr_recon_loss: 9801.7173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39335.7681; train_optim_loss: 39335.7681; val_kl_reg_loss: 2617.0777; val_edge_recon_loss: 25896.6409; val_gene_expr_recon_loss: 9836.8334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38350.5519; val_optim_loss: 38350.5519
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 2634.9189; train_edge_recon_loss: 26898.9740; train_gene_expr_recon_loss: 9790.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39324.4236; train_optim_loss: 39324.4236; val_kl_reg_loss: 2619.8386; val_edge_recon_loss: 25849.6036; val_gene_expr_recon_loss: 9812.2050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38281.6471; val_optim_loss: 38281.6471
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 2638.8994; train_edge_recon_loss: 26891.2943; train_gene_expr_recon_loss: 9778.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39308.9815; train_optim_loss: 39308.9815; val_kl_reg_loss: 2599.1183; val_edge_recon_loss: 25865.6345; val_gene_expr_recon_loss: 9795.0650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38259.8175; val_optim_loss: 38259.8175
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 2642.6884; train_edge_recon_loss: 26884.0874; train_gene_expr_recon_loss: 9752.3792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39279.1550; train_optim_loss: 39279.1550; val_kl_reg_loss: 2640.2294; val_edge_recon_loss: 25837.3761; val_gene_expr_recon_loss: 9825.3694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38302.9747; val_optim_loss: 38302.9747
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 2646.1699; train_edge_recon_loss: 26882.8644; train_gene_expr_recon_loss: 9750.3211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39279.3555; train_optim_loss: 39279.3555; val_kl_reg_loss: 2651.2610; val_edge_recon_loss: 25844.2336; val_gene_expr_recon_loss: 9783.8290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38279.3236; val_optim_loss: 38279.3236
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 2650.1700; train_edge_recon_loss: 26875.3754; train_gene_expr_recon_loss: 9726.2037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39251.7491; train_optim_loss: 39251.7491; val_kl_reg_loss: 2632.7907; val_edge_recon_loss: 25857.5596; val_gene_expr_recon_loss: 9792.7676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38283.1178; val_optim_loss: 38283.1178
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 2653.3379; train_edge_recon_loss: 26870.5657; train_gene_expr_recon_loss: 9725.2709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39249.1744; train_optim_loss: 39249.1744; val_kl_reg_loss: 2661.3727; val_edge_recon_loss: 25829.6688; val_gene_expr_recon_loss: 9811.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38302.2163; val_optim_loss: 38302.2163

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 2652.0534; train_edge_recon_loss: 26849.5814; train_gene_expr_recon_loss: 9675.3205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39176.9552; train_optim_loss: 39176.9552; val_kl_reg_loss: 2650.2377; val_edge_recon_loss: 25855.1111; val_gene_expr_recon_loss: 9791.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38297.3031; val_optim_loss: 38297.3031
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2649.4988; train_edge_recon_loss: 26851.3164; train_gene_expr_recon_loss: 9661.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39162.7145; train_optim_loss: 39162.7145; val_kl_reg_loss: 2651.2609; val_edge_recon_loss: 25821.0855; val_gene_expr_recon_loss: 9783.1407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38255.4870; val_optim_loss: 38255.4870
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2648.8462; train_edge_recon_loss: 26849.4109; train_gene_expr_recon_loss: 9662.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39160.3969; train_optim_loss: 39160.3969; val_kl_reg_loss: 2650.0256; val_edge_recon_loss: 25824.7558; val_gene_expr_recon_loss: 9767.8155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38242.5969; val_optim_loss: 38242.5969
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 2649.7408; train_edge_recon_loss: 26847.1829; train_gene_expr_recon_loss: 9651.5526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39148.4763; train_optim_loss: 39148.4763; val_kl_reg_loss: 2637.9176; val_edge_recon_loss: 25816.6734; val_gene_expr_recon_loss: 9773.1109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38227.7023; val_optim_loss: 38227.7023
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 2651.1325; train_edge_recon_loss: 26839.7266; train_gene_expr_recon_loss: 9654.6494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39145.5085; train_optim_loss: 39145.5085; val_kl_reg_loss: 2644.4568; val_edge_recon_loss: 25839.5290; val_gene_expr_recon_loss: 9757.7819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38241.7677; val_optim_loss: 38241.7677
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 2650.9532; train_edge_recon_loss: 26840.6117; train_gene_expr_recon_loss: 9652.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39144.0325; train_optim_loss: 39144.0325; val_kl_reg_loss: 2643.6259; val_edge_recon_loss: 25810.3108; val_gene_expr_recon_loss: 9771.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38225.0097; val_optim_loss: 38225.0097
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 2652.1210; train_edge_recon_loss: 26836.5757; train_gene_expr_recon_loss: 9648.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39137.1657; train_optim_loss: 39137.1657; val_kl_reg_loss: 2645.7215; val_edge_recon_loss: 25814.9770; val_gene_expr_recon_loss: 9769.1369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38229.8353; val_optim_loss: 38229.8353
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2650.4345; train_edge_recon_loss: 26845.6220; train_gene_expr_recon_loss: 9651.6088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39147.6653; train_optim_loss: 39147.6653; val_kl_reg_loss: 2638.6217; val_edge_recon_loss: 25790.8437; val_gene_expr_recon_loss: 9778.4694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38207.9351; val_optim_loss: 38207.9351
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9952; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2648.5029; train_edge_recon_loss: 26855.8048; train_gene_expr_recon_loss: 9648.9991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39153.3068; train_optim_loss: 39153.3068; val_kl_reg_loss: 2646.5444; val_edge_recon_loss: 25809.8151; val_gene_expr_recon_loss: 9778.7807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38235.1403; val_optim_loss: 38235.1403
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 2652.3649; train_edge_recon_loss: 26840.3649; train_gene_expr_recon_loss: 9646.7659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39139.4956; train_optim_loss: 39139.4956; val_kl_reg_loss: 2653.9490; val_edge_recon_loss: 25801.5998; val_gene_expr_recon_loss: 9764.0759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38219.6243; val_optim_loss: 38219.6243
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9967; val_auprc_score: 0.9954; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 2652.7484; train_edge_recon_loss: 26841.4798; train_gene_expr_recon_loss: 9650.9982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39145.2264; train_optim_loss: 39145.2264; val_kl_reg_loss: 2646.6569; val_edge_recon_loss: 25807.2674; val_gene_expr_recon_loss: 9762.1998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38216.1243; val_optim_loss: 38216.1243
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 2653.0130; train_edge_recon_loss: 26836.5105; train_gene_expr_recon_loss: 9641.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39131.4853; train_optim_loss: 39131.4853; val_kl_reg_loss: 2642.4690; val_edge_recon_loss: 25848.9936; val_gene_expr_recon_loss: 9766.0158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38257.4785; val_optim_loss: 38257.4785

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2652.1637; train_edge_recon_loss: 26835.6066; train_gene_expr_recon_loss: 9640.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39127.9780; train_optim_loss: 39127.9780; val_kl_reg_loss: 2648.1368; val_edge_recon_loss: 25806.8175; val_gene_expr_recon_loss: 9785.1256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38240.0800; val_optim_loss: 38240.0800
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2652.5989; train_edge_recon_loss: 26833.9180; train_gene_expr_recon_loss: 9637.0050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39123.5219; train_optim_loss: 39123.5219; val_kl_reg_loss: 2653.5608; val_edge_recon_loss: 25823.6277; val_gene_expr_recon_loss: 9773.9998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38251.1888; val_optim_loss: 38251.1888
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 2652.1024; train_edge_recon_loss: 26844.0928; train_gene_expr_recon_loss: 9630.4374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39126.6326; train_optim_loss: 39126.6326; val_kl_reg_loss: 2647.1246; val_edge_recon_loss: 25818.0522; val_gene_expr_recon_loss: 9745.8202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38210.9974; val_optim_loss: 38210.9974
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 2650.6710; train_edge_recon_loss: 26842.1365; train_gene_expr_recon_loss: 9636.6925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39129.4999; train_optim_loss: 39129.4999; val_kl_reg_loss: 2649.5376; val_edge_recon_loss: 25812.2603; val_gene_expr_recon_loss: 9751.9312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38213.7288; val_optim_loss: 38213.7288

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 119 min 27 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9948
Val best accuracy score: 0.9800
Val best F1 score: 0.9802
Val gene expr MSE score: 0.6445

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
