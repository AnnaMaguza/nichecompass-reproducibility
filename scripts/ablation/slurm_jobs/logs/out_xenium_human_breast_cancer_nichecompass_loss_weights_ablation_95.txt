None
Run timestamp: 08082023_193800_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9499; val_auprc_score: 0.9390; val_best_acc_score: 0.8836; val_best_f1_score: 0.8906; train_kl_reg_loss: 37302.0628; train_edge_recon_loss: 2803554.5476; train_gene_expr_recon_loss: 12209170.8318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15050027.4480; train_optim_loss: 15050027.4480; val_kl_reg_loss: 32661.1668; val_edge_recon_loss: 2702776.1308; val_gene_expr_recon_loss: 11182512.6528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13917950.0185; val_optim_loss: 13917950.0185
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9633; val_auprc_score: 0.9562; val_best_acc_score: 0.9032; val_best_f1_score: 0.9083; train_kl_reg_loss: 29139.6913; train_edge_recon_loss: 2670723.5082; train_gene_expr_recon_loss: 10912562.6245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13612425.8328; train_optim_loss: 13612425.8328; val_kl_reg_loss: 26412.7840; val_edge_recon_loss: 2671483.6898; val_gene_expr_recon_loss: 10633097.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13330993.9120; val_optim_loss: 13330993.9120
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9705; val_auprc_score: 0.9654; val_best_acc_score: 0.9141; val_best_f1_score: 0.9177; train_kl_reg_loss: 25035.3104; train_edge_recon_loss: 2655056.7632; train_gene_expr_recon_loss: 10590093.7881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13270185.8611; train_optim_loss: 13270185.8611; val_kl_reg_loss: 22926.5719; val_edge_recon_loss: 2662468.4213; val_gene_expr_recon_loss: 10467610.6157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13153005.6343; val_optim_loss: 13153005.6343
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9744; val_auprc_score: 0.9704; val_best_acc_score: 0.9200; val_best_f1_score: 0.9229; train_kl_reg_loss: 22803.2140; train_edge_recon_loss: 2647167.0103; train_gene_expr_recon_loss: 10465701.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13135671.6471; train_optim_loss: 13135671.6471; val_kl_reg_loss: 21670.5796; val_edge_recon_loss: 2652427.4653; val_gene_expr_recon_loss: 10390249.7963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13064347.8380; val_optim_loss: 13064347.8380
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9794; val_auprc_score: 0.9763; val_best_acc_score: 0.9291; val_best_f1_score: 0.9312; train_kl_reg_loss: 21299.4686; train_edge_recon_loss: 2641419.1588; train_gene_expr_recon_loss: 10406727.4552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13069446.0849; train_optim_loss: 13069446.0849; val_kl_reg_loss: 20379.7392; val_edge_recon_loss: 2647295.7569; val_gene_expr_recon_loss: 10356066.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13023741.8935; val_optim_loss: 13023741.8935
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9819; val_auprc_score: 0.9792; val_best_acc_score: 0.9349; val_best_f1_score: 0.9363; train_kl_reg_loss: 20210.5453; train_edge_recon_loss: 2634886.4137; train_gene_expr_recon_loss: 10373069.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13028166.5761; train_optim_loss: 13028166.5761; val_kl_reg_loss: 19601.3707; val_edge_recon_loss: 2645711.3218; val_gene_expr_recon_loss: 10334293.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12999605.8148; val_optim_loss: 12999605.8148
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9843; val_auprc_score: 0.9822; val_best_acc_score: 0.9386; val_best_f1_score: 0.9399; train_kl_reg_loss: 19699.4089; train_edge_recon_loss: 2629273.2833; train_gene_expr_recon_loss: 10357575.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13006548.6744; train_optim_loss: 13006548.6744; val_kl_reg_loss: 19370.7957; val_edge_recon_loss: 2641093.1944; val_gene_expr_recon_loss: 10329789.3796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12990253.3843; val_optim_loss: 12990253.3843
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9847; val_auprc_score: 0.9825; val_best_acc_score: 0.9402; val_best_f1_score: 0.9417; train_kl_reg_loss: 19350.7057; train_edge_recon_loss: 2624626.7753; train_gene_expr_recon_loss: 10351390.2937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12995367.7824; train_optim_loss: 12995367.7824; val_kl_reg_loss: 19304.3607; val_edge_recon_loss: 2637516.5544; val_gene_expr_recon_loss: 10325505.5741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12982326.4907; val_optim_loss: 12982326.4907
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9860; val_auprc_score: 0.9837; val_best_acc_score: 0.9442; val_best_f1_score: 0.9455; train_kl_reg_loss: 19122.5643; train_edge_recon_loss: 2621511.7151; train_gene_expr_recon_loss: 10338738.8729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12979373.1533; train_optim_loss: 12979373.1533; val_kl_reg_loss: 18852.7221; val_edge_recon_loss: 2633597.4653; val_gene_expr_recon_loss: 10315560.1806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12968010.3426; val_optim_loss: 12968010.3426
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9853; val_best_acc_score: 0.9464; val_best_f1_score: 0.9474; train_kl_reg_loss: 19009.0822; train_edge_recon_loss: 2617983.5747; train_gene_expr_recon_loss: 10334448.0396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12971440.6893; train_optim_loss: 12971440.6893; val_kl_reg_loss: 18600.6738; val_edge_recon_loss: 2631666.3414; val_gene_expr_recon_loss: 10322219.2130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12972486.2454; val_optim_loss: 12972486.2454
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9873; val_auprc_score: 0.9852; val_best_acc_score: 0.9473; val_best_f1_score: 0.9484; train_kl_reg_loss: 18918.9696; train_edge_recon_loss: 2616327.5296; train_gene_expr_recon_loss: 10328591.3205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12963837.8256; train_optim_loss: 12963837.8256; val_kl_reg_loss: 18491.6229; val_edge_recon_loss: 2631009.3449; val_gene_expr_recon_loss: 10303269.3519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12952770.3056; val_optim_loss: 12952770.3056
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9879; val_auprc_score: 0.9861; val_best_acc_score: 0.9487; val_best_f1_score: 0.9498; train_kl_reg_loss: 18799.8044; train_edge_recon_loss: 2615392.2149; train_gene_expr_recon_loss: 10325348.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12959540.7860; train_optim_loss: 12959540.7860; val_kl_reg_loss: 18635.3511; val_edge_recon_loss: 2628876.8484; val_gene_expr_recon_loss: 10315452.5880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12962964.7731; val_optim_loss: 12962964.7731
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9866; val_best_acc_score: 0.9497; val_best_f1_score: 0.9507; train_kl_reg_loss: 18684.7797; train_edge_recon_loss: 2615276.2515; train_gene_expr_recon_loss: 10314744.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12948705.3040; train_optim_loss: 12948705.3040; val_kl_reg_loss: 18253.5677; val_edge_recon_loss: 2627897.3368; val_gene_expr_recon_loss: 10317427.9120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12963578.8426; val_optim_loss: 12963578.8426
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9886; val_auprc_score: 0.9868; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 18617.6992; train_edge_recon_loss: 2613291.3008; train_gene_expr_recon_loss: 10317719.8117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12949628.8200; train_optim_loss: 12949628.8200; val_kl_reg_loss: 17944.3795; val_edge_recon_loss: 2626724.0197; val_gene_expr_recon_loss: 10317950.1759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12962618.5880; val_optim_loss: 12962618.5880
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9884; val_auprc_score: 0.9867; val_best_acc_score: 0.9502; val_best_f1_score: 0.9512; train_kl_reg_loss: 18519.0007; train_edge_recon_loss: 2612742.8071; train_gene_expr_recon_loss: 10316316.4969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12947578.3164; train_optim_loss: 12947578.3164; val_kl_reg_loss: 18253.7766; val_edge_recon_loss: 2626708.7975; val_gene_expr_recon_loss: 10299433.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12944395.5926; val_optim_loss: 12944395.5926
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9888; val_auprc_score: 0.9871; val_best_acc_score: 0.9507; val_best_f1_score: 0.9517; train_kl_reg_loss: 18413.2008; train_edge_recon_loss: 2613297.6754; train_gene_expr_recon_loss: 10312713.3246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12944424.2058; train_optim_loss: 12944424.2058; val_kl_reg_loss: 18545.4728; val_edge_recon_loss: 2626869.4479; val_gene_expr_recon_loss: 10296687.5602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12942102.5046; val_optim_loss: 12942102.5046
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9888; val_auprc_score: 0.9870; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 18381.1974; train_edge_recon_loss: 2611038.4389; train_gene_expr_recon_loss: 10306378.6235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12935798.2762; train_optim_loss: 12935798.2762; val_kl_reg_loss: 17893.1813; val_edge_recon_loss: 2627064.0243; val_gene_expr_recon_loss: 10307503.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12952460.8426; val_optim_loss: 12952460.8426
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9888; val_auprc_score: 0.9869; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 18275.1696; train_edge_recon_loss: 2611543.5846; train_gene_expr_recon_loss: 10304913.8215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12934732.5689; train_optim_loss: 12934732.5689; val_kl_reg_loss: 18128.7965; val_edge_recon_loss: 2627643.6192; val_gene_expr_recon_loss: 10300410.9815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12946183.4028; val_optim_loss: 12946183.4028
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9895; val_auprc_score: 0.9879; val_best_acc_score: 0.9533; val_best_f1_score: 0.9541; train_kl_reg_loss: 18236.6241; train_edge_recon_loss: 2610874.9992; train_gene_expr_recon_loss: 10304637.0329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12933748.6502; train_optim_loss: 12933748.6502; val_kl_reg_loss: 17877.5821; val_edge_recon_loss: 2624941.8275; val_gene_expr_recon_loss: 10299767.1620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12942586.5602; val_optim_loss: 12942586.5602
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9892; val_auprc_score: 0.9874; val_best_acc_score: 0.9528; val_best_f1_score: 0.9537; train_kl_reg_loss: 18226.3964; train_edge_recon_loss: 2609881.8924; train_gene_expr_recon_loss: 10304408.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12932516.7984; train_optim_loss: 12932516.7984; val_kl_reg_loss: 18106.3961; val_edge_recon_loss: 2623231.4664; val_gene_expr_recon_loss: 10308457.6944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12949795.5926; val_optim_loss: 12949795.5926

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9898; val_auprc_score: 0.9882; val_best_acc_score: 0.9535; val_best_f1_score: 0.9543; train_kl_reg_loss: 18810.6328; train_edge_recon_loss: 2607222.5356; train_gene_expr_recon_loss: 10260522.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12886556.1543; train_optim_loss: 12886556.1543; val_kl_reg_loss: 18430.9974; val_edge_recon_loss: 2621585.9826; val_gene_expr_recon_loss: 10267454.6204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12907471.6389; val_optim_loss: 12907471.6389
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9538; val_best_f1_score: 0.9546; train_kl_reg_loss: 18786.7268; train_edge_recon_loss: 2606248.2940; train_gene_expr_recon_loss: 10251597.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12876632.1281; train_optim_loss: 12876632.1281; val_kl_reg_loss: 18601.5952; val_edge_recon_loss: 2621529.7211; val_gene_expr_recon_loss: 10258608.1620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12898739.4583; val_optim_loss: 12898739.4583
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9536; val_best_f1_score: 0.9544; train_kl_reg_loss: 18830.2573; train_edge_recon_loss: 2605834.4873; train_gene_expr_recon_loss: 10251844.6507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12876509.3817; train_optim_loss: 12876509.3817; val_kl_reg_loss: 18586.6383; val_edge_recon_loss: 2620594.6921; val_gene_expr_recon_loss: 10257273.5509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12896454.8843; val_optim_loss: 12896454.8843
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9899; val_auprc_score: 0.9883; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 18827.0721; train_edge_recon_loss: 2606304.9811; train_gene_expr_recon_loss: 10250238.9938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12875371.0473; train_optim_loss: 12875371.0473; val_kl_reg_loss: 18446.6787; val_edge_recon_loss: 2620961.7188; val_gene_expr_recon_loss: 10257059.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12896468.1065; val_optim_loss: 12896468.1065
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9545; val_best_f1_score: 0.9553; train_kl_reg_loss: 18813.3824; train_edge_recon_loss: 2605978.6650; train_gene_expr_recon_loss: 10251626.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12876418.9645; train_optim_loss: 12876418.9645; val_kl_reg_loss: 18499.0514; val_edge_recon_loss: 2619087.7801; val_gene_expr_recon_loss: 10273409.7037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12910996.5463; val_optim_loss: 12910996.5463
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9899; val_auprc_score: 0.9882; val_best_acc_score: 0.9544; val_best_f1_score: 0.9552; train_kl_reg_loss: 18798.4564; train_edge_recon_loss: 2605067.5067; train_gene_expr_recon_loss: 10249672.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12873538.0458; train_optim_loss: 12873538.0458; val_kl_reg_loss: 18648.9723; val_edge_recon_loss: 2619777.4363; val_gene_expr_recon_loss: 10259417.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12897843.4167; val_optim_loss: 12897843.4167
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9539; val_best_f1_score: 0.9547; train_kl_reg_loss: 18768.6483; train_edge_recon_loss: 2606313.6905; train_gene_expr_recon_loss: 10250255.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12875338.3143; train_optim_loss: 12875338.3143; val_kl_reg_loss: 18568.1371; val_edge_recon_loss: 2623860.9190; val_gene_expr_recon_loss: 10270155.6574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12912584.7083; val_optim_loss: 12912584.7083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9902; val_auprc_score: 0.9888; val_best_acc_score: 0.9548; val_best_f1_score: 0.9555; train_kl_reg_loss: 18839.8298; train_edge_recon_loss: 2606439.3291; train_gene_expr_recon_loss: 10241241.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12866520.4964; train_optim_loss: 12866520.4964; val_kl_reg_loss: 18536.2150; val_edge_recon_loss: 2619124.0903; val_gene_expr_recon_loss: 10253529.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12891190.2361; val_optim_loss: 12891190.2361
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9900; val_auprc_score: 0.9883; val_best_acc_score: 0.9547; val_best_f1_score: 0.9555; train_kl_reg_loss: 18849.1762; train_edge_recon_loss: 2605977.7701; train_gene_expr_recon_loss: 10240081.7248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12864908.6723; train_optim_loss: 12864908.6723; val_kl_reg_loss: 18600.3585; val_edge_recon_loss: 2620030.4039; val_gene_expr_recon_loss: 10246957.3472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12885588.0833; val_optim_loss: 12885588.0833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 18864.9263; train_edge_recon_loss: 2605470.4878; train_gene_expr_recon_loss: 10242298.4228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12866633.8426; train_optim_loss: 12866633.8426; val_kl_reg_loss: 18580.4183; val_edge_recon_loss: 2618334.4664; val_gene_expr_recon_loss: 10259231.1065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12896146.0093; val_optim_loss: 12896146.0093
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9901; val_auprc_score: 0.9885; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 18854.0751; train_edge_recon_loss: 2605491.2521; train_gene_expr_recon_loss: 10242722.4300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12867067.7629; train_optim_loss: 12867067.7629; val_kl_reg_loss: 18573.2559; val_edge_recon_loss: 2617034.2593; val_gene_expr_recon_loss: 10258448.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12894055.5833; val_optim_loss: 12894055.5833
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 18844.8060; train_edge_recon_loss: 2605256.1118; train_gene_expr_recon_loss: 10240867.0154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12864967.9378; train_optim_loss: 12864967.9378; val_kl_reg_loss: 18566.0920; val_edge_recon_loss: 2619585.0683; val_gene_expr_recon_loss: 10258066.3796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12896217.5463; val_optim_loss: 12896217.5463
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9905; val_auprc_score: 0.9890; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 18830.7067; train_edge_recon_loss: 2605792.9312; train_gene_expr_recon_loss: 10246181.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12870804.6862; train_optim_loss: 12870804.6862; val_kl_reg_loss: 18549.9965; val_edge_recon_loss: 2618372.3889; val_gene_expr_recon_loss: 10262731.9861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12899654.3796; val_optim_loss: 12899654.3796

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9552; val_best_f1_score: 0.9559; train_kl_reg_loss: 18832.5067; train_edge_recon_loss: 2605085.8404; train_gene_expr_recon_loss: 10244249.2027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12868167.5520; train_optim_loss: 12868167.5520; val_kl_reg_loss: 18549.6155; val_edge_recon_loss: 2620026.3750; val_gene_expr_recon_loss: 10263205.6343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12901781.6111; val_optim_loss: 12901781.6111
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9545; val_best_f1_score: 0.9552; train_kl_reg_loss: 18834.4684; train_edge_recon_loss: 2605783.4762; train_gene_expr_recon_loss: 10242253.9763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12866871.9146; train_optim_loss: 12866871.9146; val_kl_reg_loss: 18548.4574; val_edge_recon_loss: 2622826.8102; val_gene_expr_recon_loss: 10252984.2454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12894359.5231; val_optim_loss: 12894359.5231
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9904; val_auprc_score: 0.9888; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 18838.4498; train_edge_recon_loss: 2605096.3695; train_gene_expr_recon_loss: 10243007.3534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12866942.1656; train_optim_loss: 12866942.1656; val_kl_reg_loss: 18555.7672; val_edge_recon_loss: 2618278.4201; val_gene_expr_recon_loss: 10248509.1343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12885343.3102; val_optim_loss: 12885343.3102
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9901; val_auprc_score: 0.9885; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 18834.9354; train_edge_recon_loss: 2605840.7867; train_gene_expr_recon_loss: 10243084.4712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12867760.1950; train_optim_loss: 12867760.1950; val_kl_reg_loss: 18549.5519; val_edge_recon_loss: 2619631.7882; val_gene_expr_recon_loss: 10252237.7407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12890419.0926; val_optim_loss: 12890419.0926
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 18841.1435; train_edge_recon_loss: 2605417.9883; train_gene_expr_recon_loss: 10240768.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12865027.1893; train_optim_loss: 12865027.1893; val_kl_reg_loss: 18549.0005; val_edge_recon_loss: 2618512.8125; val_gene_expr_recon_loss: 10262214.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12899276.2917; val_optim_loss: 12899276.2917
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9901; val_auprc_score: 0.9883; val_best_acc_score: 0.9550; val_best_f1_score: 0.9557; train_kl_reg_loss: 18837.2509; train_edge_recon_loss: 2605487.6678; train_gene_expr_recon_loss: 10237818.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12862143.2150; train_optim_loss: 12862143.2150; val_kl_reg_loss: 18558.5489; val_edge_recon_loss: 2621624.1019; val_gene_expr_recon_loss: 10257949.7407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12898132.3843; val_optim_loss: 12898132.3843
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 18836.7497; train_edge_recon_loss: 2604763.5997; train_gene_expr_recon_loss: 10239125.8447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12862726.1893; train_optim_loss: 12862726.1893; val_kl_reg_loss: 18568.2246; val_edge_recon_loss: 2619959.5625; val_gene_expr_recon_loss: 10255516.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12894044.4259; val_optim_loss: 12894044.4259

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9553; val_best_f1_score: 0.9559; train_kl_reg_loss: 18833.9102; train_edge_recon_loss: 2606700.6651; train_gene_expr_recon_loss: 10244346.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12869881.0190; train_optim_loss: 12869881.0190; val_kl_reg_loss: 18543.8641; val_edge_recon_loss: 2617525.1053; val_gene_expr_recon_loss: 10253967.4306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12890036.3657; val_optim_loss: 12890036.3657
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9904; val_auprc_score: 0.9888; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 18836.1881; train_edge_recon_loss: 2605915.8308; train_gene_expr_recon_loss: 10239893.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12864645.8441; train_optim_loss: 12864645.8441; val_kl_reg_loss: 18563.5423; val_edge_recon_loss: 2617076.8403; val_gene_expr_recon_loss: 10268485.5787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12904125.9861; val_optim_loss: 12904125.9861
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9554; val_best_f1_score: 0.9561; train_kl_reg_loss: 18838.3071; train_edge_recon_loss: 2605135.9983; train_gene_expr_recon_loss: 10241276.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12865250.3308; train_optim_loss: 12865250.3308; val_kl_reg_loss: 18552.6428; val_edge_recon_loss: 2618731.2500; val_gene_expr_recon_loss: 10250392.9676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12887676.8750; val_optim_loss: 12887676.8750
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9903; val_auprc_score: 0.9889; val_best_acc_score: 0.9546; val_best_f1_score: 0.9553; train_kl_reg_loss: 18836.9720; train_edge_recon_loss: 2605012.0768; train_gene_expr_recon_loss: 10243563.7963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12867412.8493; train_optim_loss: 12867412.8493; val_kl_reg_loss: 18544.3268; val_edge_recon_loss: 2618897.3877; val_gene_expr_recon_loss: 10252780.3009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12890222.0139; val_optim_loss: 12890222.0139

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 261 min 23 sec.
Using best model state, which was in epoch 36.
