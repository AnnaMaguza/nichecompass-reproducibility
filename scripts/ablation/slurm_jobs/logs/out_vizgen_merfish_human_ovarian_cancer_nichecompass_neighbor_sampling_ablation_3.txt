None
Run timestamp: 12072023_192850_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9921; val_auprc_score: 0.9917; val_best_acc_score: 0.9560; val_best_f1_score: 0.9561; train_kl_reg_loss: 8622.4039; train_edge_recon_loss: 269782.2211; train_gene_expr_recon_loss: 144500.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422905.3682; train_optim_loss: 422905.3682; val_kl_reg_loss: 7612.4232; val_edge_recon_loss: 264957.3937; val_gene_expr_recon_loss: 134301.5282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406871.3459; val_optim_loss: 406871.3459
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9945; val_auprc_score: 0.9942; val_best_acc_score: 0.9640; val_best_f1_score: 0.9642; train_kl_reg_loss: 7392.4014; train_edge_recon_loss: 263349.8717; train_gene_expr_recon_loss: 131835.0109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402577.2842; train_optim_loss: 402577.2842; val_kl_reg_loss: 7074.0427; val_edge_recon_loss: 263005.9107; val_gene_expr_recon_loss: 130608.5448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400688.4977; val_optim_loss: 400688.4977
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9950; val_auprc_score: 0.9947; val_best_acc_score: 0.9662; val_best_f1_score: 0.9663; train_kl_reg_loss: 7036.0400; train_edge_recon_loss: 262071.3822; train_gene_expr_recon_loss: 129621.6911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398729.1136; train_optim_loss: 398729.1136; val_kl_reg_loss: 6897.6502; val_edge_recon_loss: 262409.1308; val_gene_expr_recon_loss: 129203.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398510.0588; val_optim_loss: 398510.0588
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9705; val_best_f1_score: 0.9706; train_kl_reg_loss: 6879.1723; train_edge_recon_loss: 261321.3191; train_gene_expr_recon_loss: 128743.5771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396944.0685; train_optim_loss: 396944.0685; val_kl_reg_loss: 6746.4760; val_edge_recon_loss: 262113.0441; val_gene_expr_recon_loss: 128399.8652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397259.3847; val_optim_loss: 397259.3847
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9710; val_best_f1_score: 0.9710; train_kl_reg_loss: 6807.1133; train_edge_recon_loss: 260912.4056; train_gene_expr_recon_loss: 128198.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395917.9979; train_optim_loss: 395917.9979; val_kl_reg_loss: 6707.6273; val_edge_recon_loss: 261312.1314; val_gene_expr_recon_loss: 128263.5559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396283.3143; val_optim_loss: 396283.3143
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9736; val_best_f1_score: 0.9736; train_kl_reg_loss: 6774.2647; train_edge_recon_loss: 260554.1439; train_gene_expr_recon_loss: 127853.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395181.6450; train_optim_loss: 395181.6450; val_kl_reg_loss: 6639.1537; val_edge_recon_loss: 261135.5583; val_gene_expr_recon_loss: 127914.3564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395689.0702; val_optim_loss: 395689.0702
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 6751.6084; train_edge_recon_loss: 260347.7645; train_gene_expr_recon_loss: 127612.3332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394711.7061; train_optim_loss: 394711.7061; val_kl_reg_loss: 6713.4943; val_edge_recon_loss: 261163.1677; val_gene_expr_recon_loss: 127521.2923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395397.9559; val_optim_loss: 395397.9559
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9728; val_best_f1_score: 0.9728; train_kl_reg_loss: 6738.1735; train_edge_recon_loss: 260163.0562; train_gene_expr_recon_loss: 127446.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394347.2536; train_optim_loss: 394347.2536; val_kl_reg_loss: 6602.9852; val_edge_recon_loss: 260869.2338; val_gene_expr_recon_loss: 127545.1460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395017.3661; val_optim_loss: 395017.3661
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 6729.7648; train_edge_recon_loss: 259963.5569; train_gene_expr_recon_loss: 127286.6236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393979.9450; train_optim_loss: 393979.9450; val_kl_reg_loss: 6602.5993; val_edge_recon_loss: 260548.0443; val_gene_expr_recon_loss: 127427.5688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394578.2125; val_optim_loss: 394578.2125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9754; val_best_f1_score: 0.9754; train_kl_reg_loss: 6717.5652; train_edge_recon_loss: 259921.1493; train_gene_expr_recon_loss: 127168.9357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393807.6507; train_optim_loss: 393807.6507; val_kl_reg_loss: 6638.5155; val_edge_recon_loss: 260505.8477; val_gene_expr_recon_loss: 127394.3809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394538.7445; val_optim_loss: 394538.7445
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 6711.8283; train_edge_recon_loss: 259882.6519; train_gene_expr_recon_loss: 127080.1271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393674.6074; train_optim_loss: 393674.6074; val_kl_reg_loss: 6762.0327; val_edge_recon_loss: 260660.1176; val_gene_expr_recon_loss: 127149.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394571.5370; val_optim_loss: 394571.5370
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 6706.7460; train_edge_recon_loss: 259740.1081; train_gene_expr_recon_loss: 127071.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393518.5513; train_optim_loss: 393518.5513; val_kl_reg_loss: 6811.3485; val_edge_recon_loss: 260393.2391; val_gene_expr_recon_loss: 127361.4036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394565.9909; val_optim_loss: 394565.9909
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 6703.8689; train_edge_recon_loss: 259617.8842; train_gene_expr_recon_loss: 126941.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393263.0846; train_optim_loss: 393263.0846; val_kl_reg_loss: 6640.3471; val_edge_recon_loss: 260431.5424; val_gene_expr_recon_loss: 127225.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394297.2776; val_optim_loss: 394297.2776
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 6696.1618; train_edge_recon_loss: 259555.4611; train_gene_expr_recon_loss: 126867.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393119.1828; train_optim_loss: 393119.1828; val_kl_reg_loss: 6602.6549; val_edge_recon_loss: 260093.2656; val_gene_expr_recon_loss: 127069.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393765.0611; val_optim_loss: 393765.0611
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9761; val_best_f1_score: 0.9761; train_kl_reg_loss: 6698.3876; train_edge_recon_loss: 259475.9690; train_gene_expr_recon_loss: 126789.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392963.7797; train_optim_loss: 392963.7797; val_kl_reg_loss: 6678.9937; val_edge_recon_loss: 260376.8963; val_gene_expr_recon_loss: 127171.8100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394227.6998; val_optim_loss: 394227.6998
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 6685.8951; train_edge_recon_loss: 259504.0187; train_gene_expr_recon_loss: 126725.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392915.0979; train_optim_loss: 392915.0979; val_kl_reg_loss: 6744.1437; val_edge_recon_loss: 260146.7764; val_gene_expr_recon_loss: 126901.2186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393792.1388; val_optim_loss: 393792.1388
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 6686.8676; train_edge_recon_loss: 259434.7692; train_gene_expr_recon_loss: 126715.6246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392837.2620; train_optim_loss: 392837.2620; val_kl_reg_loss: 6625.1190; val_edge_recon_loss: 260182.9771; val_gene_expr_recon_loss: 127244.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394052.9835; val_optim_loss: 394052.9835
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 6691.3484; train_edge_recon_loss: 259353.9466; train_gene_expr_recon_loss: 126704.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392749.8980; train_optim_loss: 392749.8980; val_kl_reg_loss: 6613.0241; val_edge_recon_loss: 259960.2324; val_gene_expr_recon_loss: 126812.2950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393385.5508; val_optim_loss: 393385.5508
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 6681.9840; train_edge_recon_loss: 259301.0371; train_gene_expr_recon_loss: 126684.7896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392667.8109; train_optim_loss: 392667.8109; val_kl_reg_loss: 6676.6089; val_edge_recon_loss: 259868.4031; val_gene_expr_recon_loss: 127003.5369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393548.5486; val_optim_loss: 393548.5486
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 6680.7270; train_edge_recon_loss: 259239.9888; train_gene_expr_recon_loss: 126644.2260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392564.9418; train_optim_loss: 392564.9418; val_kl_reg_loss: 6668.2687; val_edge_recon_loss: 259697.5140; val_gene_expr_recon_loss: 126621.5976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392987.3811; val_optim_loss: 392987.3811
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 6676.0033; train_edge_recon_loss: 259208.8896; train_gene_expr_recon_loss: 126596.5263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392481.4187; train_optim_loss: 392481.4187; val_kl_reg_loss: 6645.2111; val_edge_recon_loss: 260003.7113; val_gene_expr_recon_loss: 126774.2837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393423.2075; val_optim_loss: 393423.2075
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 6673.6672; train_edge_recon_loss: 259196.6448; train_gene_expr_recon_loss: 126594.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392464.8349; train_optim_loss: 392464.8349; val_kl_reg_loss: 6637.0605; val_edge_recon_loss: 259945.8971; val_gene_expr_recon_loss: 126890.4139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393473.3724; val_optim_loss: 393473.3724
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 6669.7601; train_edge_recon_loss: 259131.8662; train_gene_expr_recon_loss: 126471.9137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392273.5399; train_optim_loss: 392273.5399; val_kl_reg_loss: 6634.5488; val_edge_recon_loss: 259755.4639; val_gene_expr_recon_loss: 127057.1339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393447.1477; val_optim_loss: 393447.1477
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 6664.8669; train_edge_recon_loss: 259120.2139; train_gene_expr_recon_loss: 126347.4981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392132.5787; train_optim_loss: 392132.5787; val_kl_reg_loss: 6684.0695; val_edge_recon_loss: 259495.9741; val_gene_expr_recon_loss: 126713.5173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392893.5605; val_optim_loss: 392893.5605
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 6664.5917; train_edge_recon_loss: 259089.3878; train_gene_expr_recon_loss: 126157.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391911.5365; train_optim_loss: 391911.5365; val_kl_reg_loss: 6614.5423; val_edge_recon_loss: 259732.7274; val_gene_expr_recon_loss: 128049.3265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394396.5964; val_optim_loss: 394396.5964
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 6662.6710; train_edge_recon_loss: 259030.8715; train_gene_expr_recon_loss: 125971.1620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391664.7048; train_optim_loss: 391664.7048; val_kl_reg_loss: 6701.1008; val_edge_recon_loss: 259752.7861; val_gene_expr_recon_loss: 126388.7861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392842.6734; val_optim_loss: 392842.6734
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 6661.2437; train_edge_recon_loss: 259063.9554; train_gene_expr_recon_loss: 125885.5293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391610.7281; train_optim_loss: 391610.7281; val_kl_reg_loss: 6607.1806; val_edge_recon_loss: 259554.3255; val_gene_expr_recon_loss: 124570.2728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390731.7797; val_optim_loss: 390731.7797
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 6661.7721; train_edge_recon_loss: 258971.5101; train_gene_expr_recon_loss: 126340.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391974.1471; train_optim_loss: 391974.1471; val_kl_reg_loss: 6647.7393; val_edge_recon_loss: 259470.2340; val_gene_expr_recon_loss: 123328.0210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389445.9940; val_optim_loss: 389445.9940
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 6654.5903; train_edge_recon_loss: 259001.8627; train_gene_expr_recon_loss: 126694.7496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392351.2024; train_optim_loss: 392351.2024; val_kl_reg_loss: 6575.7259; val_edge_recon_loss: 259400.2846; val_gene_expr_recon_loss: 125196.5667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391172.5774; val_optim_loss: 391172.5774
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 6654.0876; train_edge_recon_loss: 258968.4883; train_gene_expr_recon_loss: 127400.7470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393023.3228; train_optim_loss: 393023.3228; val_kl_reg_loss: 6594.8894; val_edge_recon_loss: 259564.9626; val_gene_expr_recon_loss: 125821.3173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391981.1687; val_optim_loss: 391981.1687
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 6652.9661; train_edge_recon_loss: 258947.4904; train_gene_expr_recon_loss: 127540.4703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393140.9271; train_optim_loss: 393140.9271; val_kl_reg_loss: 6678.1503; val_edge_recon_loss: 259507.0051; val_gene_expr_recon_loss: 130580.3246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396765.4804; val_optim_loss: 396765.4804
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 6656.3554; train_edge_recon_loss: 258858.3926; train_gene_expr_recon_loss: 128264.8170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393779.5651; train_optim_loss: 393779.5651; val_kl_reg_loss: 6647.3822; val_edge_recon_loss: 259439.7040; val_gene_expr_recon_loss: 140282.5801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406369.6661; val_optim_loss: 406369.6661

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 6678.0746; train_edge_recon_loss: 258627.9528; train_gene_expr_recon_loss: 129731.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395037.3680; train_optim_loss: 395037.3680; val_kl_reg_loss: 6649.0134; val_edge_recon_loss: 259073.8097; val_gene_expr_recon_loss: 119199.6991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384922.5224; val_optim_loss: 384922.5224
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 6673.4625; train_edge_recon_loss: 258587.9887; train_gene_expr_recon_loss: 127551.5389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392812.9903; train_optim_loss: 392812.9903; val_kl_reg_loss: 6628.2898; val_edge_recon_loss: 259068.3194; val_gene_expr_recon_loss: 124444.7792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390141.3881; val_optim_loss: 390141.3881
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9976; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 6667.1114; train_edge_recon_loss: 258585.1135; train_gene_expr_recon_loss: 125940.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391193.2003; train_optim_loss: 391193.2003; val_kl_reg_loss: 6631.6107; val_edge_recon_loss: 259158.3294; val_gene_expr_recon_loss: 111625.3810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377415.3219; val_optim_loss: 377415.3219
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 6664.3500; train_edge_recon_loss: 258559.9251; train_gene_expr_recon_loss: 124622.4991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389846.7739; train_optim_loss: 389846.7739; val_kl_reg_loss: 6619.5345; val_edge_recon_loss: 259054.0996; val_gene_expr_recon_loss: 134201.0359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399874.6702; val_optim_loss: 399874.6702
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 6659.4233; train_edge_recon_loss: 258577.9977; train_gene_expr_recon_loss: 126976.1190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392213.5400; train_optim_loss: 392213.5400; val_kl_reg_loss: 6649.5689; val_edge_recon_loss: 259129.2577; val_gene_expr_recon_loss: 119658.7542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385437.5808; val_optim_loss: 385437.5808
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 6656.9917; train_edge_recon_loss: 258543.0793; train_gene_expr_recon_loss: 129377.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394577.4400; train_optim_loss: 394577.4400; val_kl_reg_loss: 6626.6456; val_edge_recon_loss: 258954.0601; val_gene_expr_recon_loss: 151365.9467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416946.6516; val_optim_loss: 416946.6516
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 6652.4782; train_edge_recon_loss: 258536.4790; train_gene_expr_recon_loss: 130265.7751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395454.7319; train_optim_loss: 395454.7319; val_kl_reg_loss: 6619.6225; val_edge_recon_loss: 259021.7562; val_gene_expr_recon_loss: 100839.5292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366480.9077; val_optim_loss: 366480.9077
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 6650.0893; train_edge_recon_loss: 258517.8161; train_gene_expr_recon_loss: 123670.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388838.5918; train_optim_loss: 388838.5918; val_kl_reg_loss: 6637.8134; val_edge_recon_loss: 258894.6447; val_gene_expr_recon_loss: 134916.2001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400448.6591; val_optim_loss: 400448.6591
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9808; val_best_f1_score: 0.9808; train_kl_reg_loss: 6650.9011; train_edge_recon_loss: 258444.2119; train_gene_expr_recon_loss: 127998.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393093.6453; train_optim_loss: 393093.6453; val_kl_reg_loss: 6622.9310; val_edge_recon_loss: 259029.4107; val_gene_expr_recon_loss: 128916.3840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394568.7261; val_optim_loss: 394568.7261
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9811; val_best_f1_score: 0.9811; train_kl_reg_loss: 6646.3600; train_edge_recon_loss: 258465.8134; train_gene_expr_recon_loss: 127830.3425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392942.5164; train_optim_loss: 392942.5164; val_kl_reg_loss: 6646.4124; val_edge_recon_loss: 258918.5880; val_gene_expr_recon_loss: 130598.6599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396163.6607; val_optim_loss: 396163.6607
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 6642.5208; train_edge_recon_loss: 258427.3244; train_gene_expr_recon_loss: 128405.1567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393475.0019; train_optim_loss: 393475.0019; val_kl_reg_loss: 6605.2843; val_edge_recon_loss: 259011.5467; val_gene_expr_recon_loss: 113497.2537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379114.0850; val_optim_loss: 379114.0850

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 6646.1924; train_edge_recon_loss: 258454.9165; train_gene_expr_recon_loss: 114086.8271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379187.9359; train_optim_loss: 379187.9359; val_kl_reg_loss: 6620.2446; val_edge_recon_loss: 259069.1986; val_gene_expr_recon_loss: 121467.2958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387156.7392; val_optim_loss: 387156.7392
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9814; val_best_f1_score: 0.9814; train_kl_reg_loss: 6644.0257; train_edge_recon_loss: 258435.5400; train_gene_expr_recon_loss: 128224.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393304.2477; train_optim_loss: 393304.2477; val_kl_reg_loss: 6622.6663; val_edge_recon_loss: 258899.7277; val_gene_expr_recon_loss: 148950.1391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414472.5326; val_optim_loss: 414472.5326
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9810; val_best_f1_score: 0.9810; train_kl_reg_loss: 6645.7357; train_edge_recon_loss: 258417.1944; train_gene_expr_recon_loss: 138914.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403976.9520; train_optim_loss: 403976.9520; val_kl_reg_loss: 6622.5178; val_edge_recon_loss: 258896.1350; val_gene_expr_recon_loss: 148385.1689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413903.8232; val_optim_loss: 413903.8232
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 6645.2690; train_edge_recon_loss: 258366.8732; train_gene_expr_recon_loss: 135165.0552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400177.1976; train_optim_loss: 400177.1976; val_kl_reg_loss: 6623.2136; val_edge_recon_loss: 259021.1476; val_gene_expr_recon_loss: 147856.1739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413500.5360; val_optim_loss: 413500.5360

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 542 min 39 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9980
Val AUPRC score: 0.9978
Val best accuracy score: 0.9810
Val best F1 score: 0.9811
Val gene expr MSE score: 9.3058

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
