None
Run timestamp: 13072023_140028_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9930; val_auprc_score: 0.9925; val_best_acc_score: 0.9595; val_best_f1_score: 0.9598; train_kl_reg_loss: 8988.5585; train_edge_recon_loss: 270693.4278; train_gene_expr_recon_loss: 145379.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425061.8401; train_optim_loss: 425061.8401; val_kl_reg_loss: 7738.7047; val_edge_recon_loss: 264632.4791; val_gene_expr_recon_loss: 134720.5868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407091.7709; val_optim_loss: 407091.7709
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9953; val_auprc_score: 0.9950; val_best_acc_score: 0.9678; val_best_f1_score: 0.9679; train_kl_reg_loss: 7445.1498; train_edge_recon_loss: 263526.0006; train_gene_expr_recon_loss: 132415.8623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403387.0130; train_optim_loss: 403387.0130; val_kl_reg_loss: 7034.9975; val_edge_recon_loss: 263161.2818; val_gene_expr_recon_loss: 130685.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400882.0679; val_optim_loss: 400882.0679
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9705; val_best_f1_score: 0.9706; train_kl_reg_loss: 7006.7726; train_edge_recon_loss: 261999.4781; train_gene_expr_recon_loss: 130274.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399280.5264; train_optim_loss: 399280.5264; val_kl_reg_loss: 6711.5699; val_edge_recon_loss: 261973.1371; val_gene_expr_recon_loss: 129609.6684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398294.3755; val_optim_loss: 398294.3755
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 6826.7324; train_edge_recon_loss: 261171.1049; train_gene_expr_recon_loss: 129435.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397433.3957; train_optim_loss: 397433.3957; val_kl_reg_loss: 6747.0593; val_edge_recon_loss: 261288.4950; val_gene_expr_recon_loss: 128936.6183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396972.1723; val_optim_loss: 396972.1723
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 6738.8720; train_edge_recon_loss: 260726.8035; train_gene_expr_recon_loss: 128975.5485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396441.2238; train_optim_loss: 396441.2238; val_kl_reg_loss: 6591.1201; val_edge_recon_loss: 260772.0915; val_gene_expr_recon_loss: 128825.2294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396188.4428; val_optim_loss: 396188.4428
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 6690.3351; train_edge_recon_loss: 260393.8338; train_gene_expr_recon_loss: 128652.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395736.9828; train_optim_loss: 395736.9828; val_kl_reg_loss: 6577.0611; val_edge_recon_loss: 260609.8705; val_gene_expr_recon_loss: 128452.4335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395639.3664; val_optim_loss: 395639.3664
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9767; val_best_f1_score: 0.9767; train_kl_reg_loss: 6659.9161; train_edge_recon_loss: 260142.6785; train_gene_expr_recon_loss: 128426.3686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395228.9633; train_optim_loss: 395228.9633; val_kl_reg_loss: 6734.3063; val_edge_recon_loss: 260355.9635; val_gene_expr_recon_loss: 128193.0846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395283.3549; val_optim_loss: 395283.3549
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 6642.2190; train_edge_recon_loss: 259947.6074; train_gene_expr_recon_loss: 128247.9020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394837.7288; train_optim_loss: 394837.7288; val_kl_reg_loss: 6519.2960; val_edge_recon_loss: 259886.5671; val_gene_expr_recon_loss: 128262.9650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394668.8279; val_optim_loss: 394668.8279
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9976; val_auprc_score: 0.9973; val_best_acc_score: 0.9787; val_best_f1_score: 0.9787; train_kl_reg_loss: 6627.1705; train_edge_recon_loss: 259752.3120; train_gene_expr_recon_loss: 128123.1919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394502.6744; train_optim_loss: 394502.6744; val_kl_reg_loss: 6480.0824; val_edge_recon_loss: 259594.5965; val_gene_expr_recon_loss: 128101.8298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394176.5084; val_optim_loss: 394176.5084
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 6618.5369; train_edge_recon_loss: 259631.4183; train_gene_expr_recon_loss: 128050.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394300.7515; train_optim_loss: 394300.7515; val_kl_reg_loss: 6442.9072; val_edge_recon_loss: 259615.9938; val_gene_expr_recon_loss: 128112.4087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394171.3099; val_optim_loss: 394171.3099
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 6611.2612; train_edge_recon_loss: 259498.5647; train_gene_expr_recon_loss: 127929.1826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394039.0090; train_optim_loss: 394039.0090; val_kl_reg_loss: 6468.5189; val_edge_recon_loss: 259642.0331; val_gene_expr_recon_loss: 127958.6047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394069.1558; val_optim_loss: 394069.1558
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9802; val_best_f1_score: 0.9803; train_kl_reg_loss: 6603.0335; train_edge_recon_loss: 259390.2058; train_gene_expr_recon_loss: 127864.9243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393858.1637; train_optim_loss: 393858.1637; val_kl_reg_loss: 6425.2492; val_edge_recon_loss: 259387.6056; val_gene_expr_recon_loss: 127854.2747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393667.1286; val_optim_loss: 393667.1286
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 6600.7645; train_edge_recon_loss: 259301.0086; train_gene_expr_recon_loss: 127796.4705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393698.2439; train_optim_loss: 393698.2439; val_kl_reg_loss: 6584.6530; val_edge_recon_loss: 259449.5258; val_gene_expr_recon_loss: 127883.1865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393917.3646; val_optim_loss: 393917.3646
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 6591.1208; train_edge_recon_loss: 259195.8022; train_gene_expr_recon_loss: 127715.9155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393502.8386; train_optim_loss: 393502.8386; val_kl_reg_loss: 6558.7165; val_edge_recon_loss: 259397.9035; val_gene_expr_recon_loss: 128134.3748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394090.9953; val_optim_loss: 394090.9953
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 6587.6608; train_edge_recon_loss: 259118.3071; train_gene_expr_recon_loss: 127750.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393456.8153; train_optim_loss: 393456.8153; val_kl_reg_loss: 6560.8392; val_edge_recon_loss: 259545.2846; val_gene_expr_recon_loss: 127936.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394042.6486; val_optim_loss: 394042.6486
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 6585.1595; train_edge_recon_loss: 259120.4504; train_gene_expr_recon_loss: 127688.5924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393394.2026; train_optim_loss: 393394.2026; val_kl_reg_loss: 6544.4942; val_edge_recon_loss: 259274.1776; val_gene_expr_recon_loss: 127770.7360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393589.4094; val_optim_loss: 393589.4094
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9978; val_auprc_score: 0.9976; val_best_acc_score: 0.9810; val_best_f1_score: 0.9810; train_kl_reg_loss: 6576.8673; train_edge_recon_loss: 259028.6790; train_gene_expr_recon_loss: 127665.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393270.9537; train_optim_loss: 393270.9537; val_kl_reg_loss: 6529.4804; val_edge_recon_loss: 259120.4308; val_gene_expr_recon_loss: 127688.1845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393338.0949; val_optim_loss: 393338.0949
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9814; val_best_f1_score: 0.9814; train_kl_reg_loss: 6578.2942; train_edge_recon_loss: 258934.8553; train_gene_expr_recon_loss: 127573.3402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393086.4899; train_optim_loss: 393086.4899; val_kl_reg_loss: 6539.7095; val_edge_recon_loss: 259168.5306; val_gene_expr_recon_loss: 127854.8088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393563.0503; val_optim_loss: 393563.0503
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 6575.1292; train_edge_recon_loss: 258931.8696; train_gene_expr_recon_loss: 127544.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393051.4874; train_optim_loss: 393051.4874; val_kl_reg_loss: 6563.6081; val_edge_recon_loss: 258913.0252; val_gene_expr_recon_loss: 127608.2309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393084.8652; val_optim_loss: 393084.8652
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 6575.5160; train_edge_recon_loss: 258799.5912; train_gene_expr_recon_loss: 127553.4832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392928.5902; train_optim_loss: 392928.5902; val_kl_reg_loss: 6549.5868; val_edge_recon_loss: 258982.6819; val_gene_expr_recon_loss: 127756.3007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393288.5691; val_optim_loss: 393288.5691
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 6569.0755; train_edge_recon_loss: 258779.1841; train_gene_expr_recon_loss: 127508.5837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392856.8435; train_optim_loss: 392856.8435; val_kl_reg_loss: 6515.1266; val_edge_recon_loss: 258952.4251; val_gene_expr_recon_loss: 127889.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393357.4631; val_optim_loss: 393357.4631
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 6567.1821; train_edge_recon_loss: 258780.5489; train_gene_expr_recon_loss: 127467.8730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392815.6039; train_optim_loss: 392815.6039; val_kl_reg_loss: 6537.2772; val_edge_recon_loss: 258944.2055; val_gene_expr_recon_loss: 128015.8490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393497.3303; val_optim_loss: 393497.3303
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 6563.7414; train_edge_recon_loss: 258735.0024; train_gene_expr_recon_loss: 127470.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392769.1847; train_optim_loss: 392769.1847; val_kl_reg_loss: 6557.5321; val_edge_recon_loss: 259080.5728; val_gene_expr_recon_loss: 127108.9523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392747.0583; val_optim_loss: 392747.0583
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 6565.9258; train_edge_recon_loss: 258683.2451; train_gene_expr_recon_loss: 127270.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392519.8428; train_optim_loss: 392519.8428; val_kl_reg_loss: 6476.8056; val_edge_recon_loss: 258953.7295; val_gene_expr_recon_loss: 127489.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392920.5065; val_optim_loss: 392920.5065
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 6563.8857; train_edge_recon_loss: 258632.2645; train_gene_expr_recon_loss: 127010.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392206.8623; train_optim_loss: 392206.8623; val_kl_reg_loss: 6537.5689; val_edge_recon_loss: 258804.8112; val_gene_expr_recon_loss: 127880.0584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393222.4405; val_optim_loss: 393222.4405
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 6559.5954; train_edge_recon_loss: 258626.9794; train_gene_expr_recon_loss: 126797.5063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391984.0812; train_optim_loss: 391984.0812; val_kl_reg_loss: 6558.3230; val_edge_recon_loss: 258688.7450; val_gene_expr_recon_loss: 126722.7022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391969.7691; val_optim_loss: 391969.7691
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 6557.6020; train_edge_recon_loss: 258567.9866; train_gene_expr_recon_loss: 126725.1206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391850.7090; train_optim_loss: 391850.7090; val_kl_reg_loss: 6543.4839; val_edge_recon_loss: 258815.6922; val_gene_expr_recon_loss: 127411.6143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392770.7913; val_optim_loss: 392770.7913
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 6557.2510; train_edge_recon_loss: 258532.9011; train_gene_expr_recon_loss: 127075.3619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392165.5136; train_optim_loss: 392165.5136; val_kl_reg_loss: 6519.2873; val_edge_recon_loss: 258406.0082; val_gene_expr_recon_loss: 129236.9592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394162.2539; val_optim_loss: 394162.2539
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 6554.7347; train_edge_recon_loss: 258546.2658; train_gene_expr_recon_loss: 127848.5716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392949.5717; train_optim_loss: 392949.5717; val_kl_reg_loss: 6542.6236; val_edge_recon_loss: 258637.5450; val_gene_expr_recon_loss: 130324.4539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395504.6233; val_optim_loss: 395504.6233
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 6552.7019; train_edge_recon_loss: 258506.3240; train_gene_expr_recon_loss: 128454.9526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393513.9785; train_optim_loss: 393513.9785; val_kl_reg_loss: 6569.2953; val_edge_recon_loss: 258653.2878; val_gene_expr_recon_loss: 129707.5841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394930.1677; val_optim_loss: 394930.1677

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 6586.6512; train_edge_recon_loss: 258185.3793; train_gene_expr_recon_loss: 127344.0756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392116.1056; train_optim_loss: 392116.1056; val_kl_reg_loss: 6581.2681; val_edge_recon_loss: 258188.6859; val_gene_expr_recon_loss: 131363.8003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396133.7534; val_optim_loss: 396133.7534
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 6587.2406; train_edge_recon_loss: 258114.7211; train_gene_expr_recon_loss: 127905.8185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392607.7806; train_optim_loss: 392607.7806; val_kl_reg_loss: 6580.7902; val_edge_recon_loss: 258421.0057; val_gene_expr_recon_loss: 123260.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388262.6036; val_optim_loss: 388262.6036
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 6583.9581; train_edge_recon_loss: 258084.1779; train_gene_expr_recon_loss: 128686.1907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393354.3269; train_optim_loss: 393354.3269; val_kl_reg_loss: 6569.8093; val_edge_recon_loss: 258304.1799; val_gene_expr_recon_loss: 130345.1378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395219.1282; val_optim_loss: 395219.1282
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6581.1803; train_edge_recon_loss: 258079.8306; train_gene_expr_recon_loss: 128615.4140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393276.4247; train_optim_loss: 393276.4247; val_kl_reg_loss: 6562.3720; val_edge_recon_loss: 258107.9655; val_gene_expr_recon_loss: 134564.5830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399234.9208; val_optim_loss: 399234.9208
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 6574.6044; train_edge_recon_loss: 258138.1829; train_gene_expr_recon_loss: 129744.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394457.4060; train_optim_loss: 394457.4060; val_kl_reg_loss: 6570.1925; val_edge_recon_loss: 258251.5740; val_gene_expr_recon_loss: 125750.9157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390572.6829; val_optim_loss: 390572.6829
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 6574.0436; train_edge_recon_loss: 258064.5963; train_gene_expr_recon_loss: 127661.7226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392300.3622; train_optim_loss: 392300.3622; val_kl_reg_loss: 6561.5710; val_edge_recon_loss: 258097.8783; val_gene_expr_recon_loss: 133425.4858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398084.9346; val_optim_loss: 398084.9346

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6574.5735; train_edge_recon_loss: 258081.8361; train_gene_expr_recon_loss: 128776.5311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393432.9410; train_optim_loss: 393432.9410; val_kl_reg_loss: 6558.4566; val_edge_recon_loss: 258197.3456; val_gene_expr_recon_loss: 130685.5112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395441.3133; val_optim_loss: 395441.3133
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9851; val_best_f1_score: 0.9851; train_kl_reg_loss: 6575.9498; train_edge_recon_loss: 258004.3056; train_gene_expr_recon_loss: 127331.8613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391912.1170; train_optim_loss: 391912.1170; val_kl_reg_loss: 6561.0349; val_edge_recon_loss: 258076.0501; val_gene_expr_recon_loss: 125585.2042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390222.2892; val_optim_loss: 390222.2892
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6576.7877; train_edge_recon_loss: 258045.8206; train_gene_expr_recon_loss: 123222.8190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387845.4270; train_optim_loss: 387845.4270; val_kl_reg_loss: 6558.7682; val_edge_recon_loss: 258013.6070; val_gene_expr_recon_loss: 120769.4677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385341.8427; val_optim_loss: 385341.8427
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6574.0544; train_edge_recon_loss: 258080.0428; train_gene_expr_recon_loss: 121119.1634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385773.2606; train_optim_loss: 385773.2606; val_kl_reg_loss: 6558.2072; val_edge_recon_loss: 258097.7681; val_gene_expr_recon_loss: 124644.4218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389300.3966; val_optim_loss: 389300.3966
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9851; val_best_f1_score: 0.9851; train_kl_reg_loss: 6572.3088; train_edge_recon_loss: 258046.5476; train_gene_expr_recon_loss: 124104.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388723.0428; train_optim_loss: 388723.0428; val_kl_reg_loss: 6555.6003; val_edge_recon_loss: 258019.9330; val_gene_expr_recon_loss: 120015.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384590.8951; val_optim_loss: 384590.8951
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 6569.6948; train_edge_recon_loss: 258099.0239; train_gene_expr_recon_loss: 124330.0054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388998.7241; train_optim_loss: 388998.7241; val_kl_reg_loss: 6558.0731; val_edge_recon_loss: 258041.1388; val_gene_expr_recon_loss: 120836.7469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385435.9589; val_optim_loss: 385435.9589
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 6569.5588; train_edge_recon_loss: 258086.3916; train_gene_expr_recon_loss: 124909.0612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389565.0113; train_optim_loss: 389565.0113; val_kl_reg_loss: 6558.8433; val_edge_recon_loss: 258108.4237; val_gene_expr_recon_loss: 134465.3100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399132.5768; val_optim_loss: 399132.5768
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6574.5135; train_edge_recon_loss: 258039.9203; train_gene_expr_recon_loss: 124446.4736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389060.9074; train_optim_loss: 389060.9074; val_kl_reg_loss: 6562.4177; val_edge_recon_loss: 257933.0871; val_gene_expr_recon_loss: 120191.2184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384686.7235; val_optim_loss: 384686.7235
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 6573.2647; train_edge_recon_loss: 258055.9020; train_gene_expr_recon_loss: 123139.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387768.8036; train_optim_loss: 387768.8036; val_kl_reg_loss: 6559.6667; val_edge_recon_loss: 258183.5582; val_gene_expr_recon_loss: 116680.7988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381424.0238; val_optim_loss: 381424.0238
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 6572.4898; train_edge_recon_loss: 258004.8103; train_gene_expr_recon_loss: 123460.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388037.4724; train_optim_loss: 388037.4724; val_kl_reg_loss: 6559.3689; val_edge_recon_loss: 258067.1822; val_gene_expr_recon_loss: 124518.3430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389144.8943; val_optim_loss: 389144.8943
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6572.4297; train_edge_recon_loss: 258076.7385; train_gene_expr_recon_loss: 124517.5416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389166.7097; train_optim_loss: 389166.7097; val_kl_reg_loss: 6558.9968; val_edge_recon_loss: 258213.5652; val_gene_expr_recon_loss: 120117.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384889.7886; val_optim_loss: 384889.7886
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9850; train_kl_reg_loss: 6571.3421; train_edge_recon_loss: 258080.0330; train_gene_expr_recon_loss: 124854.8839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389506.2590; train_optim_loss: 389506.2590; val_kl_reg_loss: 6555.1134; val_edge_recon_loss: 258109.5451; val_gene_expr_recon_loss: 130212.8532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394877.5108; val_optim_loss: 394877.5108
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6570.7182; train_edge_recon_loss: 258066.2678; train_gene_expr_recon_loss: 125168.8928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389805.8789; train_optim_loss: 389805.8789; val_kl_reg_loss: 6556.4914; val_edge_recon_loss: 258172.2804; val_gene_expr_recon_loss: 131874.7122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396603.4830; val_optim_loss: 396603.4830

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9848; val_best_f1_score: 0.9848; train_kl_reg_loss: 6569.9921; train_edge_recon_loss: 258049.1917; train_gene_expr_recon_loss: 130150.0181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394769.2019; train_optim_loss: 394769.2019; val_kl_reg_loss: 6555.6128; val_edge_recon_loss: 258063.6398; val_gene_expr_recon_loss: 124575.9654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389195.2174; val_optim_loss: 389195.2174
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 6571.7698; train_edge_recon_loss: 258095.1302; train_gene_expr_recon_loss: 123998.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388665.6939; train_optim_loss: 388665.6939; val_kl_reg_loss: 6557.7814; val_edge_recon_loss: 257924.7457; val_gene_expr_recon_loss: 125728.2022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390210.7289; val_optim_loss: 390210.7289
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6571.6866; train_edge_recon_loss: 258046.1298; train_gene_expr_recon_loss: 123982.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388600.3870; train_optim_loss: 388600.3870; val_kl_reg_loss: 6558.6505; val_edge_recon_loss: 258104.1091; val_gene_expr_recon_loss: 128474.4548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393137.2150; val_optim_loss: 393137.2150
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6570.6692; train_edge_recon_loss: 258066.4041; train_gene_expr_recon_loss: 129857.4904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394494.5633; train_optim_loss: 394494.5633; val_kl_reg_loss: 6556.5479; val_edge_recon_loss: 258036.6454; val_gene_expr_recon_loss: 130341.5834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394934.7773; val_optim_loss: 394934.7773

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 978 min 34 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9983
Val best accuracy score: 0.9848
Val best F1 score: 0.9849
Val gene expr MSE score: 8.8151

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
