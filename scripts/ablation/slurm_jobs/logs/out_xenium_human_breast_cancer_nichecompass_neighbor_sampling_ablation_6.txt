Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5794.9811; train_edge_recon_loss: 257326.8174; train_gene_expr_recon_loss: 67215.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330337.5152; train_optim_loss: 330337.5152; val_kl_reg_loss: 5794.0443; val_edge_recon_loss: 256828.1842; val_gene_expr_recon_loss: 66917.2284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329539.4570; val_optim_loss: 329539.4570
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 5792.9840; train_edge_recon_loss: 257346.0129; train_gene_expr_recon_loss: 67205.7412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330344.7378; train_optim_loss: 330344.7378; val_kl_reg_loss: 5787.9282; val_edge_recon_loss: 256812.9625; val_gene_expr_recon_loss: 66789.9994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329390.8903; val_optim_loss: 329390.8903
None
Run timestamp: 13072023_044637_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9918; val_auprc_score: 0.9905; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 6081.7234; train_edge_recon_loss: 265235.0049; train_gene_expr_recon_loss: 76200.4051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347517.1333; train_optim_loss: 347517.1333; val_kl_reg_loss: 5887.9538; val_edge_recon_loss: 261549.5767; val_gene_expr_recon_loss: 70229.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337666.7327; val_optim_loss: 337666.7327
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5795.5247; train_edge_recon_loss: 257268.6632; train_gene_expr_recon_loss: 67200.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330264.6221; train_optim_loss: 330264.6221; val_kl_reg_loss: 5788.0217; val_edge_recon_loss: 256803.8559; val_gene_expr_recon_loss: 66858.4374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329450.3146; val_optim_loss: 329450.3146
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9934; val_auprc_score: 0.9920; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 5874.0389; train_edge_recon_loss: 261093.3527; train_gene_expr_recon_loss: 69644.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336612.1450; train_optim_loss: 336612.1450; val_kl_reg_loss: 5811.1304; val_edge_recon_loss: 260195.6036; val_gene_expr_recon_loss: 68535.0749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334541.8080; val_optim_loss: 334541.8080
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 5797.5314; train_edge_recon_loss: 257248.9282; train_gene_expr_recon_loss: 67220.4368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330266.8964; train_optim_loss: 330266.8964; val_kl_reg_loss: 5779.5636; val_edge_recon_loss: 256759.2729; val_gene_expr_recon_loss: 66965.1868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329504.0236; val_optim_loss: 329504.0236
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9704; val_best_f1_score: 0.9707; train_kl_reg_loss: 5808.3605; train_edge_recon_loss: 260173.5793; train_gene_expr_recon_loss: 68623.6790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334605.6190; train_optim_loss: 334605.6190; val_kl_reg_loss: 5681.7512; val_edge_recon_loss: 259487.9865; val_gene_expr_recon_loss: 68135.3757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333305.1133; val_optim_loss: 333305.1133
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 5796.8333; train_edge_recon_loss: 257260.2836; train_gene_expr_recon_loss: 67209.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330266.1256; train_optim_loss: 330266.1256; val_kl_reg_loss: 5783.2030; val_edge_recon_loss: 256768.3323; val_gene_expr_recon_loss: 66860.8200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329412.3562; val_optim_loss: 329412.3562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9955; val_auprc_score: 0.9946; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 5770.2076; train_edge_recon_loss: 259615.6870; train_gene_expr_recon_loss: 68218.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333604.1613; train_optim_loss: 333604.1613; val_kl_reg_loss: 5790.6218; val_edge_recon_loss: 258887.8540; val_gene_expr_recon_loss: 67904.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332582.9470; val_optim_loss: 332582.9470
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 5796.9866; train_edge_recon_loss: 257211.0380; train_gene_expr_recon_loss: 67196.9382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330204.9628; train_optim_loss: 330204.9628; val_kl_reg_loss: 5796.3831; val_edge_recon_loss: 256674.6609; val_gene_expr_recon_loss: 66836.4491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329307.4935; val_optim_loss: 329307.4935
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9957; val_auprc_score: 0.9948; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 5748.7893; train_edge_recon_loss: 259204.6138; train_gene_expr_recon_loss: 67985.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332939.0819; train_optim_loss: 332939.0819; val_kl_reg_loss: 5804.3359; val_edge_recon_loss: 258575.8267; val_gene_expr_recon_loss: 67630.0349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332010.1970; val_optim_loss: 332010.1970
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5795.8208; train_edge_recon_loss: 257212.4684; train_gene_expr_recon_loss: 67193.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330201.4490; train_optim_loss: 330201.4490; val_kl_reg_loss: 5789.5358; val_edge_recon_loss: 256703.2602; val_gene_expr_recon_loss: 66880.9287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329373.7236; val_optim_loss: 329373.7236
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5797.2318; train_edge_recon_loss: 257180.1838; train_gene_expr_recon_loss: 67195.7602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330173.1760; train_optim_loss: 330173.1760; val_kl_reg_loss: 5815.5941; val_edge_recon_loss: 256600.9284; val_gene_expr_recon_loss: 66841.9497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329258.4715; val_optim_loss: 329258.4715
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 5732.5446; train_edge_recon_loss: 258921.3179; train_gene_expr_recon_loss: 67937.1907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332591.0531; train_optim_loss: 332591.0531; val_kl_reg_loss: 5688.6607; val_edge_recon_loss: 258155.8547; val_gene_expr_recon_loss: 60398.9767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324243.4913; val_optim_loss: 324243.4913
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5801.5114; train_edge_recon_loss: 257149.7196; train_gene_expr_recon_loss: 67180.4304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330131.6615; train_optim_loss: 330131.6615; val_kl_reg_loss: 5796.5869; val_edge_recon_loss: 256697.3221; val_gene_expr_recon_loss: 66859.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329353.6149; val_optim_loss: 329353.6149
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 5721.2084; train_edge_recon_loss: 258753.7026; train_gene_expr_recon_loss: 68093.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332568.1400; train_optim_loss: 332568.1400; val_kl_reg_loss: 5713.7539; val_edge_recon_loss: 258163.9421; val_gene_expr_recon_loss: 63114.3765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326992.0725; val_optim_loss: 326992.0725
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5800.7558; train_edge_recon_loss: 257138.1086; train_gene_expr_recon_loss: 67185.2100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330124.0743; train_optim_loss: 330124.0743; val_kl_reg_loss: 5822.1745; val_edge_recon_loss: 256553.0645; val_gene_expr_recon_loss: 66798.6040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329173.8430; val_optim_loss: 329173.8430
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5723.7417; train_edge_recon_loss: 258469.1532; train_gene_expr_recon_loss: 64455.2522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328648.1470; train_optim_loss: 328648.1470; val_kl_reg_loss: 5728.4261; val_edge_recon_loss: 258027.2173; val_gene_expr_recon_loss: 71797.1437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335552.7867; val_optim_loss: 335552.7867
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5800.5506; train_edge_recon_loss: 257152.5754; train_gene_expr_recon_loss: 67177.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330130.7501; train_optim_loss: 330130.7501; val_kl_reg_loss: 5799.8822; val_edge_recon_loss: 256565.9615; val_gene_expr_recon_loss: 66852.3141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329218.1578; val_optim_loss: 329218.1578
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 5713.9609; train_edge_recon_loss: 258307.7901; train_gene_expr_recon_loss: 59186.1750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323207.9263; train_optim_loss: 323207.9263; val_kl_reg_loss: 5722.0910; val_edge_recon_loss: 257670.7359; val_gene_expr_recon_loss: 64304.5056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327697.3323; val_optim_loss: 327697.3323
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5801.6867; train_edge_recon_loss: 257073.3261; train_gene_expr_recon_loss: 67202.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330077.8998; train_optim_loss: 330077.8998; val_kl_reg_loss: 5789.6700; val_edge_recon_loss: 256539.9964; val_gene_expr_recon_loss: 66873.5032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329203.1700; val_optim_loss: 329203.1700
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5803.6636; train_edge_recon_loss: 257067.4937; train_gene_expr_recon_loss: 67178.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330049.7865; train_optim_loss: 330049.7865; val_kl_reg_loss: 5804.9823; val_edge_recon_loss: 256525.6932; val_gene_expr_recon_loss: 66842.2191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329172.8945; val_optim_loss: 329172.8945
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 5711.0356; train_edge_recon_loss: 258253.2136; train_gene_expr_recon_loss: 58336.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322300.8295; train_optim_loss: 322300.8295; val_kl_reg_loss: 5624.3653; val_edge_recon_loss: 257524.8528; val_gene_expr_recon_loss: 57155.7277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320304.9464; val_optim_loss: 320304.9464
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 5804.3856; train_edge_recon_loss: 257075.2568; train_gene_expr_recon_loss: 67150.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330030.1866; train_optim_loss: 330030.1866; val_kl_reg_loss: 5799.3826; val_edge_recon_loss: 256444.8197; val_gene_expr_recon_loss: 66873.4756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329117.6778; val_optim_loss: 329117.6778
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5709.2409; train_edge_recon_loss: 258066.7339; train_gene_expr_recon_loss: 58230.2221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322006.1970; train_optim_loss: 322006.1970; val_kl_reg_loss: 5753.1693; val_edge_recon_loss: 257394.5022; val_gene_expr_recon_loss: 54222.9323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317370.6034; val_optim_loss: 317370.6034
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 5804.8325; train_edge_recon_loss: 257071.0404; train_gene_expr_recon_loss: 67168.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330044.3620; train_optim_loss: 330044.3620; val_kl_reg_loss: 5786.9255; val_edge_recon_loss: 256624.2396; val_gene_expr_recon_loss: 66769.3022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329180.4669; val_optim_loss: 329180.4669
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5704.0659; train_edge_recon_loss: 258000.7471; train_gene_expr_recon_loss: 57949.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321654.7772; train_optim_loss: 321654.7772; val_kl_reg_loss: 5686.6304; val_edge_recon_loss: 257435.1198; val_gene_expr_recon_loss: 57612.0934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320733.8436; val_optim_loss: 320733.8436
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 5808.1498; train_edge_recon_loss: 257045.8271; train_gene_expr_recon_loss: 67146.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330000.4500; train_optim_loss: 330000.4500; val_kl_reg_loss: 5814.9793; val_edge_recon_loss: 256304.9138; val_gene_expr_recon_loss: 66876.6412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328996.5350; val_optim_loss: 328996.5350
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5703.2974; train_edge_recon_loss: 257944.1954; train_gene_expr_recon_loss: 57764.2018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321411.6948; train_optim_loss: 321411.6948; val_kl_reg_loss: 5681.2162; val_edge_recon_loss: 257178.5500; val_gene_expr_recon_loss: 57434.4136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320294.1793; val_optim_loss: 320294.1793
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 5805.9643; train_edge_recon_loss: 257011.7176; train_gene_expr_recon_loss: 67172.1363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329989.8180; train_optim_loss: 329989.8180; val_kl_reg_loss: 5805.6308; val_edge_recon_loss: 256427.5424; val_gene_expr_recon_loss: 66801.0084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329034.1813; val_optim_loss: 329034.1813
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 5808.5359; train_edge_recon_loss: 256973.4948; train_gene_expr_recon_loss: 67190.4230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329972.4539; train_optim_loss: 329972.4539; val_kl_reg_loss: 5800.9788; val_edge_recon_loss: 256448.5320; val_gene_expr_recon_loss: 66808.9864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329058.4977; val_optim_loss: 329058.4977
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5702.7448; train_edge_recon_loss: 257894.0758; train_gene_expr_recon_loss: 57779.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321376.4262; train_optim_loss: 321376.4262; val_kl_reg_loss: 5711.6588; val_edge_recon_loss: 257156.7242; val_gene_expr_recon_loss: 57466.4195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320334.8029; val_optim_loss: 320334.8029
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5808.6041; train_edge_recon_loss: 256951.2459; train_gene_expr_recon_loss: 67184.7859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329944.6359; train_optim_loss: 329944.6359; val_kl_reg_loss: 5801.3870; val_edge_recon_loss: 256500.5905; val_gene_expr_recon_loss: 66805.4176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329107.3955; val_optim_loss: 329107.3955
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5702.4315; train_edge_recon_loss: 257770.8930; train_gene_expr_recon_loss: 57741.0048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321214.3295; train_optim_loss: 321214.3295; val_kl_reg_loss: 5684.0803; val_edge_recon_loss: 257247.9307; val_gene_expr_recon_loss: 57498.3913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320430.4028; val_optim_loss: 320430.4028
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 5809.7173; train_edge_recon_loss: 256974.9940; train_gene_expr_recon_loss: 67184.5464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329969.2577; train_optim_loss: 329969.2577; val_kl_reg_loss: 5814.2049; val_edge_recon_loss: 256460.9488; val_gene_expr_recon_loss: 66796.9590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329072.1125; val_optim_loss: 329072.1125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5703.1114; train_edge_recon_loss: 257533.2039; train_gene_expr_recon_loss: 57418.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320654.3981; train_optim_loss: 320654.3981; val_kl_reg_loss: 5716.6866; val_edge_recon_loss: 256957.0063; val_gene_expr_recon_loss: 57281.8147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319955.5072; val_optim_loss: 319955.5072

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5806.4037; train_edge_recon_loss: 256809.2974; train_gene_expr_recon_loss: 66702.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329318.5175; train_optim_loss: 329318.5175; val_kl_reg_loss: 5802.4228; val_edge_recon_loss: 256087.0792; val_gene_expr_recon_loss: 66403.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328292.7948; val_optim_loss: 328292.7948
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 5705.6193; train_edge_recon_loss: 257501.6147; train_gene_expr_recon_loss: 57358.1130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320565.3465; train_optim_loss: 320565.3465; val_kl_reg_loss: 5714.9007; val_edge_recon_loss: 256853.9338; val_gene_expr_recon_loss: 57189.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319758.2120; val_optim_loss: 319758.2120
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5804.1874; train_edge_recon_loss: 256726.9972; train_gene_expr_recon_loss: 66613.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329144.4653; train_optim_loss: 329144.4653; val_kl_reg_loss: 5805.8022; val_edge_recon_loss: 256140.2964; val_gene_expr_recon_loss: 66386.2856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328332.3844; val_optim_loss: 328332.3844
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5801.7437; train_edge_recon_loss: 256719.4382; train_gene_expr_recon_loss: 66584.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329105.9422; train_optim_loss: 329105.9422; val_kl_reg_loss: 5801.1335; val_edge_recon_loss: 256120.8454; val_gene_expr_recon_loss: 66298.7921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328220.7715; val_optim_loss: 328220.7715
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5702.5257; train_edge_recon_loss: 257494.6423; train_gene_expr_recon_loss: 57345.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320542.7564; train_optim_loss: 320542.7564; val_kl_reg_loss: 5708.5401; val_edge_recon_loss: 256858.3598; val_gene_expr_recon_loss: 57169.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319736.0212; val_optim_loss: 319736.0212
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5802.7852; train_edge_recon_loss: 256690.3931; train_gene_expr_recon_loss: 66568.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329062.0110; train_optim_loss: 329062.0110; val_kl_reg_loss: 5801.1325; val_edge_recon_loss: 256130.6221; val_gene_expr_recon_loss: 66289.3113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328221.0656; val_optim_loss: 328221.0656
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 5700.2967; train_edge_recon_loss: 257508.4773; train_gene_expr_recon_loss: 57325.4309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320534.2048; train_optim_loss: 320534.2048; val_kl_reg_loss: 5695.8745; val_edge_recon_loss: 256832.7787; val_gene_expr_recon_loss: 57165.3603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319694.0140; val_optim_loss: 319694.0140

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 722 min 33 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9956
Val best accuracy score: 0.9800
Val best F1 score: 0.9802
Val gene expr MSE score: 1.9246

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5799.4851; train_edge_recon_loss: 256703.1568; train_gene_expr_recon_loss: 66556.6334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329059.2748; train_optim_loss: 329059.2748; val_kl_reg_loss: 5798.1531; val_edge_recon_loss: 256107.5591; val_gene_expr_recon_loss: 66220.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328126.6106; val_optim_loss: 328126.6106
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5798.7015; train_edge_recon_loss: 256692.9023; train_gene_expr_recon_loss: 66515.5100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329007.1139; train_optim_loss: 329007.1139; val_kl_reg_loss: 5799.5076; val_edge_recon_loss: 256071.5344; val_gene_expr_recon_loss: 66361.7272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328232.7688; val_optim_loss: 328232.7688
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5798.8582; train_edge_recon_loss: 256675.4103; train_gene_expr_recon_loss: 66529.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329003.7001; train_optim_loss: 329003.7001; val_kl_reg_loss: 5806.8881; val_edge_recon_loss: 255950.8623; val_gene_expr_recon_loss: 66252.9253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328010.6754; val_optim_loss: 328010.6754
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5796.6453; train_edge_recon_loss: 256674.9722; train_gene_expr_recon_loss: 66520.4644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328992.0816; train_optim_loss: 328992.0816; val_kl_reg_loss: 5798.6062; val_edge_recon_loss: 256052.3463; val_gene_expr_recon_loss: 66241.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328092.0193; val_optim_loss: 328092.0193
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5797.4577; train_edge_recon_loss: 256681.7172; train_gene_expr_recon_loss: 66530.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329009.7552; train_optim_loss: 329009.7552; val_kl_reg_loss: 5796.4725; val_edge_recon_loss: 256018.4697; val_gene_expr_recon_loss: 66245.9511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328060.8931; val_optim_loss: 328060.8931
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5795.3759; train_edge_recon_loss: 256653.4718; train_gene_expr_recon_loss: 66495.0176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328943.8653; train_optim_loss: 328943.8653; val_kl_reg_loss: 5794.0310; val_edge_recon_loss: 256065.2237; val_gene_expr_recon_loss: 66261.2657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328120.5198; val_optim_loss: 328120.5198
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5793.4286; train_edge_recon_loss: 256665.9792; train_gene_expr_recon_loss: 66510.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328969.7265; train_optim_loss: 328969.7265; val_kl_reg_loss: 5800.7922; val_edge_recon_loss: 256097.3066; val_gene_expr_recon_loss: 66285.8617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328183.9604; val_optim_loss: 328183.9604

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5794.0441; train_edge_recon_loss: 256666.1635; train_gene_expr_recon_loss: 66451.6142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328911.8216; train_optim_loss: 328911.8216; val_kl_reg_loss: 5792.4385; val_edge_recon_loss: 256095.3829; val_gene_expr_recon_loss: 66172.6327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328060.4539; val_optim_loss: 328060.4539
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5793.4402; train_edge_recon_loss: 256666.1990; train_gene_expr_recon_loss: 66434.0347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328893.6739; train_optim_loss: 328893.6739; val_kl_reg_loss: 5794.1073; val_edge_recon_loss: 256064.0477; val_gene_expr_recon_loss: 66182.0918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328040.2475; val_optim_loss: 328040.2475
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5794.0808; train_edge_recon_loss: 256663.1804; train_gene_expr_recon_loss: 66428.8007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328886.0621; train_optim_loss: 328886.0621; val_kl_reg_loss: 5794.9793; val_edge_recon_loss: 256093.4412; val_gene_expr_recon_loss: 66233.7657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328122.1867; val_optim_loss: 328122.1867
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5793.3209; train_edge_recon_loss: 256622.8071; train_gene_expr_recon_loss: 66426.9087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328843.0366; train_optim_loss: 328843.0366; val_kl_reg_loss: 5794.5776; val_edge_recon_loss: 256095.7460; val_gene_expr_recon_loss: 66142.3728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328032.6961; val_optim_loss: 328032.6961

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1791 min 22 sec.
Using best model state, which was in epoch 59.

--- MODEL EVALUATION ---
Val AUROC score: 0.9968
Val AUPRC score: 0.9961
Val best accuracy score: 0.9801
Val best F1 score: 0.9802
Val gene expr MSE score: 1.8162

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
