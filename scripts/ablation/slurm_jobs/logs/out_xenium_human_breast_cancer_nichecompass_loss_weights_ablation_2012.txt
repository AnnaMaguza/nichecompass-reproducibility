None
Run timestamp: 16072023_100044_2012.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2012']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9211; val_auprc_score: 0.8961; val_best_acc_score: 0.8582; val_best_f1_score: 0.8683; train_kl_reg_loss: 47926.1165; train_edge_recon_loss: 27499783.2588; train_gene_expr_recon_loss: 7803691.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35351401.2471; train_optim_loss: 35351401.2471; val_kl_reg_loss: 53351.1453; val_edge_recon_loss: 27113459.1053; val_gene_expr_recon_loss: 7148130.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34314940.2105; val_optim_loss: 34314940.2105
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9376; val_auprc_score: 0.9180; val_best_acc_score: 0.8775; val_best_f1_score: 0.8854; train_kl_reg_loss: 50566.7208; train_edge_recon_loss: 26493577.7676; train_gene_expr_recon_loss: 6955644.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33499788.6706; train_optim_loss: 33499788.6706; val_kl_reg_loss: 47790.5462; val_edge_recon_loss: 26891626.5000; val_gene_expr_recon_loss: 6793157.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33732574.6579; val_optim_loss: 33732574.6579
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9435; val_auprc_score: 0.9274; val_best_acc_score: 0.8829; val_best_f1_score: 0.8904; train_kl_reg_loss: 48597.5900; train_edge_recon_loss: 26380730.3265; train_gene_expr_recon_loss: 6687483.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33116811.7971; train_optim_loss: 33116811.7971; val_kl_reg_loss: 45391.5137; val_edge_recon_loss: 26853893.0526; val_gene_expr_recon_loss: 6573296.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33472580.6579; val_optim_loss: 33472580.6579
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9528; val_auprc_score: 0.9410; val_best_acc_score: 0.8920; val_best_f1_score: 0.8973; train_kl_reg_loss: 44730.4486; train_edge_recon_loss: 26297351.9971; train_gene_expr_recon_loss: 6511710.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32853792.5912; train_optim_loss: 32853792.5912; val_kl_reg_loss: 41388.0283; val_edge_recon_loss: 26789932.3158; val_gene_expr_recon_loss: 6443822.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33275142.2368; val_optim_loss: 33275142.2368
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9589; val_auprc_score: 0.9483; val_best_acc_score: 0.9005; val_best_f1_score: 0.9055; train_kl_reg_loss: 40811.6217; train_edge_recon_loss: 26248853.7000; train_gene_expr_recon_loss: 6402012.3801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32691677.6971; train_optim_loss: 32691677.6971; val_kl_reg_loss: 37871.9524; val_edge_recon_loss: 26787019.8158; val_gene_expr_recon_loss: 6365975.4934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33190867.2895; val_optim_loss: 33190867.2895
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9621; val_auprc_score: 0.9528; val_best_acc_score: 0.9066; val_best_f1_score: 0.9106; train_kl_reg_loss: 39327.4968; train_edge_recon_loss: 26195633.7000; train_gene_expr_recon_loss: 6317199.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32552160.6353; train_optim_loss: 32552160.6353; val_kl_reg_loss: 37567.9721; val_edge_recon_loss: 26689840.4474; val_gene_expr_recon_loss: 6299401.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33026809.9211; val_optim_loss: 33026809.9211
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9638; val_auprc_score: 0.9539; val_best_acc_score: 0.9094; val_best_f1_score: 0.9135; train_kl_reg_loss: 38448.0374; train_edge_recon_loss: 26167438.6147; train_gene_expr_recon_loss: 6262298.9051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32468185.5706; train_optim_loss: 32468185.5706; val_kl_reg_loss: 36323.8891; val_edge_recon_loss: 26658445.0263; val_gene_expr_recon_loss: 6239179.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32933948.5789; val_optim_loss: 32933948.5789
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9629; val_auprc_score: 0.9529; val_best_acc_score: 0.9084; val_best_f1_score: 0.9122; train_kl_reg_loss: 37607.0417; train_edge_recon_loss: 26145033.1059; train_gene_expr_recon_loss: 6214293.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32396934.1647; train_optim_loss: 32396934.1647; val_kl_reg_loss: 36493.6675; val_edge_recon_loss: 26691088.1053; val_gene_expr_recon_loss: 6210143.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32937725.0263; val_optim_loss: 32937725.0263
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9663; val_auprc_score: 0.9571; val_best_acc_score: 0.9136; val_best_f1_score: 0.9169; train_kl_reg_loss: 36467.5064; train_edge_recon_loss: 26133422.7971; train_gene_expr_recon_loss: 6188670.4632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32358560.7647; train_optim_loss: 32358560.7647; val_kl_reg_loss: 35683.8343; val_edge_recon_loss: 26616107.4211; val_gene_expr_recon_loss: 6183000.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32834791.5789; val_optim_loss: 32834791.5789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9670; val_auprc_score: 0.9584; val_best_acc_score: 0.9145; val_best_f1_score: 0.9176; train_kl_reg_loss: 36819.0328; train_edge_recon_loss: 26118037.4000; train_gene_expr_recon_loss: 6157166.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32312023.1206; train_optim_loss: 32312023.1206; val_kl_reg_loss: 35571.5656; val_edge_recon_loss: 26571421.2368; val_gene_expr_recon_loss: 6177650.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32784643.0000; val_optim_loss: 32784643.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9670; val_auprc_score: 0.9574; val_best_acc_score: 0.9160; val_best_f1_score: 0.9192; train_kl_reg_loss: 36686.2166; train_edge_recon_loss: 26086843.9529; train_gene_expr_recon_loss: 6130956.0860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32254486.2235; train_optim_loss: 32254486.2235; val_kl_reg_loss: 35385.2530; val_edge_recon_loss: 26560465.0526; val_gene_expr_recon_loss: 6132286.2039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32728136.5526; val_optim_loss: 32728136.5526
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9680; val_auprc_score: 0.9597; val_best_acc_score: 0.9175; val_best_f1_score: 0.9206; train_kl_reg_loss: 36105.0959; train_edge_recon_loss: 26097452.8676; train_gene_expr_recon_loss: 6111779.3169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32245337.3265; train_optim_loss: 32245337.3265; val_kl_reg_loss: 34024.1852; val_edge_recon_loss: 26600351.1053; val_gene_expr_recon_loss: 6112117.7632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32746493.1842; val_optim_loss: 32746493.1842
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9679; val_auprc_score: 0.9583; val_best_acc_score: 0.9179; val_best_f1_score: 0.9209; train_kl_reg_loss: 35572.5846; train_edge_recon_loss: 26076174.5000; train_gene_expr_recon_loss: 6103506.0412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215253.1471; train_optim_loss: 32215253.1471; val_kl_reg_loss: 34263.6885; val_edge_recon_loss: 26569903.1316; val_gene_expr_recon_loss: 6116819.7763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32720986.5789; val_optim_loss: 32720986.5789
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9673; val_auprc_score: 0.9581; val_best_acc_score: 0.9177; val_best_f1_score: 0.9212; train_kl_reg_loss: 35566.5806; train_edge_recon_loss: 26067951.4441; train_gene_expr_recon_loss: 6089534.7853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32193052.7912; train_optim_loss: 32193052.7912; val_kl_reg_loss: 34125.5358; val_edge_recon_loss: 26586861.0526; val_gene_expr_recon_loss: 6116658.0461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32737644.7105; val_optim_loss: 32737644.7105
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9695; val_auprc_score: 0.9611; val_best_acc_score: 0.9196; val_best_f1_score: 0.9228; train_kl_reg_loss: 35437.6136; train_edge_recon_loss: 26067123.6265; train_gene_expr_recon_loss: 6076898.6846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32179459.9412; train_optim_loss: 32179459.9412; val_kl_reg_loss: 34254.0679; val_edge_recon_loss: 26535566.2895; val_gene_expr_recon_loss: 6099132.7303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32668953.0789; val_optim_loss: 32668953.0789
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9690; val_auprc_score: 0.9601; val_best_acc_score: 0.9199; val_best_f1_score: 0.9225; train_kl_reg_loss: 35320.7179; train_edge_recon_loss: 26060873.7000; train_gene_expr_recon_loss: 6067222.4625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32163416.8500; train_optim_loss: 32163416.8500; val_kl_reg_loss: 34484.2305; val_edge_recon_loss: 26565896.4211; val_gene_expr_recon_loss: 6093657.7039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32694038.3684; val_optim_loss: 32694038.3684
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9680; val_auprc_score: 0.9592; val_best_acc_score: 0.9176; val_best_f1_score: 0.9204; train_kl_reg_loss: 35049.3137; train_edge_recon_loss: 26036688.6500; train_gene_expr_recon_loss: 6062961.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32134699.3118; train_optim_loss: 32134699.3118; val_kl_reg_loss: 33048.1268; val_edge_recon_loss: 26661471.8421; val_gene_expr_recon_loss: 6075386.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32769906.1579; val_optim_loss: 32769906.1579
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9700; val_auprc_score: 0.9618; val_best_acc_score: 0.9208; val_best_f1_score: 0.9234; train_kl_reg_loss: 34782.8149; train_edge_recon_loss: 26055345.6118; train_gene_expr_recon_loss: 6051050.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32141179.1941; train_optim_loss: 32141179.1941; val_kl_reg_loss: 33469.8265; val_edge_recon_loss: 26573230.6053; val_gene_expr_recon_loss: 6062571.5329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32669271.9211; val_optim_loss: 32669271.9211
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9696; val_auprc_score: 0.9610; val_best_acc_score: 0.9211; val_best_f1_score: 0.9239; train_kl_reg_loss: 34473.3628; train_edge_recon_loss: 26042363.2088; train_gene_expr_recon_loss: 6042662.0426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119498.6294; train_optim_loss: 32119498.6294; val_kl_reg_loss: 34187.6112; val_edge_recon_loss: 26547998.7105; val_gene_expr_recon_loss: 6057732.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32639918.9211; val_optim_loss: 32639918.9211
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9706; val_auprc_score: 0.9625; val_best_acc_score: 0.9229; val_best_f1_score: 0.9254; train_kl_reg_loss: 34434.7279; train_edge_recon_loss: 26040614.8147; train_gene_expr_recon_loss: 6035778.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32110827.9235; train_optim_loss: 32110827.9235; val_kl_reg_loss: 34001.0910; val_edge_recon_loss: 26517266.6053; val_gene_expr_recon_loss: 6073241.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32624508.7895; val_optim_loss: 32624508.7895
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9693; val_auprc_score: 0.9599; val_best_acc_score: 0.9211; val_best_f1_score: 0.9240; train_kl_reg_loss: 34713.6768; train_edge_recon_loss: 26008099.7941; train_gene_expr_recon_loss: 6035777.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32078590.6029; train_optim_loss: 32078590.6029; val_kl_reg_loss: 33742.6414; val_edge_recon_loss: 26544995.9211; val_gene_expr_recon_loss: 6078337.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32657075.7368; val_optim_loss: 32657075.7368
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9714; val_auprc_score: 0.9636; val_best_acc_score: 0.9219; val_best_f1_score: 0.9248; train_kl_reg_loss: 34240.3392; train_edge_recon_loss: 26031515.3294; train_gene_expr_recon_loss: 6026855.6750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32092611.3412; train_optim_loss: 32092611.3412; val_kl_reg_loss: 32748.8308; val_edge_recon_loss: 26504519.2895; val_gene_expr_recon_loss: 6072776.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32610044.6842; val_optim_loss: 32610044.6842
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9702; val_auprc_score: 0.9615; val_best_acc_score: 0.9209; val_best_f1_score: 0.9238; train_kl_reg_loss: 33742.7026; train_edge_recon_loss: 26030107.5353; train_gene_expr_recon_loss: 6026789.2301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32090639.4882; train_optim_loss: 32090639.4882; val_kl_reg_loss: 33509.8966; val_edge_recon_loss: 26580361.0526; val_gene_expr_recon_loss: 6041323.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32655194.2105; val_optim_loss: 32655194.2105
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9704; val_auprc_score: 0.9616; val_best_acc_score: 0.9216; val_best_f1_score: 0.9244; train_kl_reg_loss: 34365.3651; train_edge_recon_loss: 26007449.2029; train_gene_expr_recon_loss: 6018280.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32060094.7000; train_optim_loss: 32060094.7000; val_kl_reg_loss: 33207.1696; val_edge_recon_loss: 26540583.6579; val_gene_expr_recon_loss: 6036331.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32610122.7368; val_optim_loss: 32610122.7368
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9705; val_auprc_score: 0.9623; val_best_acc_score: 0.9225; val_best_f1_score: 0.9252; train_kl_reg_loss: 34445.3835; train_edge_recon_loss: 26009338.9265; train_gene_expr_recon_loss: 6014555.7294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32058340.0676; train_optim_loss: 32058340.0676; val_kl_reg_loss: 33862.8231; val_edge_recon_loss: 26557899.4211; val_gene_expr_recon_loss: 6039556.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32631319.2632; val_optim_loss: 32631319.2632
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9712; val_auprc_score: 0.9619; val_best_acc_score: 0.9235; val_best_f1_score: 0.9266; train_kl_reg_loss: 34473.8046; train_edge_recon_loss: 26003528.4588; train_gene_expr_recon_loss: 6012850.6743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32050852.9735; train_optim_loss: 32050852.9735; val_kl_reg_loss: 32987.0821; val_edge_recon_loss: 26472085.7895; val_gene_expr_recon_loss: 6041974.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32547047.0789; val_optim_loss: 32547047.0789
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9710; val_auprc_score: 0.9621; val_best_acc_score: 0.9238; val_best_f1_score: 0.9264; train_kl_reg_loss: 33875.7757; train_edge_recon_loss: 25998103.0941; train_gene_expr_recon_loss: 6008290.0772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32040268.9647; train_optim_loss: 32040268.9647; val_kl_reg_loss: 33142.1512; val_edge_recon_loss: 26526527.3421; val_gene_expr_recon_loss: 6039935.0132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32599604.6579; val_optim_loss: 32599604.6579
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9719; val_auprc_score: 0.9632; val_best_acc_score: 0.9244; val_best_f1_score: 0.9269; train_kl_reg_loss: 33670.8785; train_edge_recon_loss: 26005719.1529; train_gene_expr_recon_loss: 6004068.9882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32043459.0765; train_optim_loss: 32043459.0765; val_kl_reg_loss: 33229.5673; val_edge_recon_loss: 26515220.1579; val_gene_expr_recon_loss: 6032631.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32581081.2105; val_optim_loss: 32581081.2105
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9720; val_auprc_score: 0.9640; val_best_acc_score: 0.9247; val_best_f1_score: 0.9272; train_kl_reg_loss: 34153.2852; train_edge_recon_loss: 25980169.5941; train_gene_expr_recon_loss: 6002152.4037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32016475.2882; train_optim_loss: 32016475.2882; val_kl_reg_loss: 33928.9539; val_edge_recon_loss: 26469424.2368; val_gene_expr_recon_loss: 6042981.4474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32546334.5000; val_optim_loss: 32546334.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9709; val_auprc_score: 0.9620; val_best_acc_score: 0.9236; val_best_f1_score: 0.9262; train_kl_reg_loss: 33767.2587; train_edge_recon_loss: 25993578.5647; train_gene_expr_recon_loss: 6001208.9037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32028554.7265; train_optim_loss: 32028554.7265; val_kl_reg_loss: 33026.0536; val_edge_recon_loss: 26547601.8947; val_gene_expr_recon_loss: 6033013.3882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32613641.4737; val_optim_loss: 32613641.4737
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9736; val_auprc_score: 0.9665; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 33533.8118; train_edge_recon_loss: 25977241.9353; train_gene_expr_recon_loss: 5998792.4515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32009568.1971; train_optim_loss: 32009568.1971; val_kl_reg_loss: 32419.7929; val_edge_recon_loss: 26500870.5789; val_gene_expr_recon_loss: 6034190.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32567480.7105; val_optim_loss: 32567480.7105
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9732; val_auprc_score: 0.9651; val_best_acc_score: 0.9281; val_best_f1_score: 0.9307; train_kl_reg_loss: 33683.9112; train_edge_recon_loss: 25983475.0529; train_gene_expr_recon_loss: 5992704.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32009863.8412; train_optim_loss: 32009863.8412; val_kl_reg_loss: 33124.7862; val_edge_recon_loss: 26439570.6579; val_gene_expr_recon_loss: 6031313.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32504009.4211; val_optim_loss: 32504009.4211
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9725; val_auprc_score: 0.9652; val_best_acc_score: 0.9256; val_best_f1_score: 0.9282; train_kl_reg_loss: 34058.9748; train_edge_recon_loss: 25972434.4382; train_gene_expr_recon_loss: 5992917.4088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31999410.7618; train_optim_loss: 31999410.7618; val_kl_reg_loss: 33063.6624; val_edge_recon_loss: 26492120.5526; val_gene_expr_recon_loss: 6013461.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32538646.3158; val_optim_loss: 32538646.3158
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9737; val_auprc_score: 0.9662; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 33411.3322; train_edge_recon_loss: 25990707.3618; train_gene_expr_recon_loss: 5989890.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32014009.3294; train_optim_loss: 32014009.3294; val_kl_reg_loss: 32484.4788; val_edge_recon_loss: 26470612.2368; val_gene_expr_recon_loss: 6024397.2961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32527493.8947; val_optim_loss: 32527493.8947
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9739; val_auprc_score: 0.9671; val_best_acc_score: 0.9272; val_best_f1_score: 0.9295; train_kl_reg_loss: 33414.1477; train_edge_recon_loss: 25997469.1118; train_gene_expr_recon_loss: 5991571.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32022454.5706; train_optim_loss: 32022454.5706; val_kl_reg_loss: 31999.3827; val_edge_recon_loss: 26521413.6579; val_gene_expr_recon_loss: 6029414.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32582827.5789; val_optim_loss: 32582827.5789
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9737; val_auprc_score: 0.9662; val_best_acc_score: 0.9269; val_best_f1_score: 0.9294; train_kl_reg_loss: 33583.4004; train_edge_recon_loss: 25963272.9588; train_gene_expr_recon_loss: 5985475.4610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31982331.8029; train_optim_loss: 31982331.8029; val_kl_reg_loss: 32812.7550; val_edge_recon_loss: 26451626.5000; val_gene_expr_recon_loss: 6021691.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32506130.5789; val_optim_loss: 32506130.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9731; val_auprc_score: 0.9646; val_best_acc_score: 0.9271; val_best_f1_score: 0.9291; train_kl_reg_loss: 33920.1166; train_edge_recon_loss: 25961843.5824; train_gene_expr_recon_loss: 5935177.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31930941.1853; train_optim_loss: 31930941.1853; val_kl_reg_loss: 33342.6796; val_edge_recon_loss: 26517533.3158; val_gene_expr_recon_loss: 5967876.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32518752.0789; val_optim_loss: 32518752.0789
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9734; val_auprc_score: 0.9657; val_best_acc_score: 0.9269; val_best_f1_score: 0.9293; train_kl_reg_loss: 34436.4117; train_edge_recon_loss: 25969997.4118; train_gene_expr_recon_loss: 5934433.0912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31938866.9382; train_optim_loss: 31938866.9382; val_kl_reg_loss: 33698.3197; val_edge_recon_loss: 26475832.1579; val_gene_expr_recon_loss: 5966167.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32475697.7105; val_optim_loss: 32475697.7105
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9734; val_auprc_score: 0.9655; val_best_acc_score: 0.9268; val_best_f1_score: 0.9293; train_kl_reg_loss: 34638.1340; train_edge_recon_loss: 25954693.4765; train_gene_expr_recon_loss: 5933072.3971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31922403.9971; train_optim_loss: 31922403.9971; val_kl_reg_loss: 33790.5518; val_edge_recon_loss: 26499258.0789; val_gene_expr_recon_loss: 5950281.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32483330.0263; val_optim_loss: 32483330.0263
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9745; val_auprc_score: 0.9671; val_best_acc_score: 0.9286; val_best_f1_score: 0.9310; train_kl_reg_loss: 34853.8828; train_edge_recon_loss: 25957798.3294; train_gene_expr_recon_loss: 5927405.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31920057.9441; train_optim_loss: 31920057.9441; val_kl_reg_loss: 34153.2758; val_edge_recon_loss: 26480449.9211; val_gene_expr_recon_loss: 5961419.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32476022.7105; val_optim_loss: 32476022.7105
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9751; val_auprc_score: 0.9677; val_best_acc_score: 0.9295; val_best_f1_score: 0.9316; train_kl_reg_loss: 34993.2950; train_edge_recon_loss: 25967480.3471; train_gene_expr_recon_loss: 5929129.1676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31931602.8235; train_optim_loss: 31931602.8235; val_kl_reg_loss: 33884.4236; val_edge_recon_loss: 26445210.7632; val_gene_expr_recon_loss: 5967722.7303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32446817.8684; val_optim_loss: 32446817.8684
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9747; val_auprc_score: 0.9673; val_best_acc_score: 0.9296; val_best_f1_score: 0.9319; train_kl_reg_loss: 35001.3013; train_edge_recon_loss: 25945293.3706; train_gene_expr_recon_loss: 5928680.1926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31908974.8441; train_optim_loss: 31908974.8441; val_kl_reg_loss: 34255.2013; val_edge_recon_loss: 26461281.7895; val_gene_expr_recon_loss: 5968170.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32463707.0000; val_optim_loss: 32463707.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9750; val_auprc_score: 0.9677; val_best_acc_score: 0.9298; val_best_f1_score: 0.9322; train_kl_reg_loss: 35338.0503; train_edge_recon_loss: 25940802.1029; train_gene_expr_recon_loss: 5925495.1978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31901635.2647; train_optim_loss: 31901635.2647; val_kl_reg_loss: 34680.1286; val_edge_recon_loss: 26453872.0789; val_gene_expr_recon_loss: 5962056.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32450608.5526; val_optim_loss: 32450608.5526
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9755; val_auprc_score: 0.9682; val_best_acc_score: 0.9304; val_best_f1_score: 0.9326; train_kl_reg_loss: 35518.2940; train_edge_recon_loss: 25954499.9265; train_gene_expr_recon_loss: 5925961.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31915979.3353; train_optim_loss: 31915979.3353; val_kl_reg_loss: 34517.1806; val_edge_recon_loss: 26429701.5526; val_gene_expr_recon_loss: 5970186.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32434404.8947; val_optim_loss: 32434404.8947
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9756; val_auprc_score: 0.9685; val_best_acc_score: 0.9293; val_best_f1_score: 0.9315; train_kl_reg_loss: 35339.0175; train_edge_recon_loss: 25951581.1059; train_gene_expr_recon_loss: 5926210.3353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31913130.4529; train_optim_loss: 31913130.4529; val_kl_reg_loss: 34270.0049; val_edge_recon_loss: 26453258.0526; val_gene_expr_recon_loss: 5959596.6645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32447124.7105; val_optim_loss: 32447124.7105
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9744; val_auprc_score: 0.9669; val_best_acc_score: 0.9280; val_best_f1_score: 0.9306; train_kl_reg_loss: 35484.8656; train_edge_recon_loss: 25944560.2324; train_gene_expr_recon_loss: 5925288.0934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31905333.1912; train_optim_loss: 31905333.1912; val_kl_reg_loss: 34382.1288; val_edge_recon_loss: 26493237.2632; val_gene_expr_recon_loss: 5963846.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32491466.3684; val_optim_loss: 32491466.3684
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9752; val_auprc_score: 0.9683; val_best_acc_score: 0.9296; val_best_f1_score: 0.9318; train_kl_reg_loss: 35504.6725; train_edge_recon_loss: 25960954.1676; train_gene_expr_recon_loss: 5925396.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31921855.3176; train_optim_loss: 31921855.3176; val_kl_reg_loss: 34285.3397; val_edge_recon_loss: 26479111.4211; val_gene_expr_recon_loss: 5962829.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32476226.0526; val_optim_loss: 32476226.0526
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9747; val_auprc_score: 0.9672; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 35341.1191; train_edge_recon_loss: 25941373.4912; train_gene_expr_recon_loss: 5924565.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31901279.6382; train_optim_loss: 31901279.6382; val_kl_reg_loss: 34558.4976; val_edge_recon_loss: 26465753.8684; val_gene_expr_recon_loss: 5970511.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32470823.5000; val_optim_loss: 32470823.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9738; val_auprc_score: 0.9657; val_best_acc_score: 0.9293; val_best_f1_score: 0.9316; train_kl_reg_loss: 35542.3621; train_edge_recon_loss: 25925556.1824; train_gene_expr_recon_loss: 5918298.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31879397.5235; train_optim_loss: 31879397.5235; val_kl_reg_loss: 34534.7782; val_edge_recon_loss: 26465143.0263; val_gene_expr_recon_loss: 5951710.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32451388.7895; val_optim_loss: 32451388.7895
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9738; val_auprc_score: 0.9661; val_best_acc_score: 0.9274; val_best_f1_score: 0.9299; train_kl_reg_loss: 35532.0555; train_edge_recon_loss: 25940495.4941; train_gene_expr_recon_loss: 5920138.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31896166.0853; train_optim_loss: 31896166.0853; val_kl_reg_loss: 34521.2225; val_edge_recon_loss: 26495563.2368; val_gene_expr_recon_loss: 5952175.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32482259.6053; val_optim_loss: 32482259.6053
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9750; val_auprc_score: 0.9670; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 35510.2812; train_edge_recon_loss: 25946142.7647; train_gene_expr_recon_loss: 5914003.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31895656.7618; train_optim_loss: 31895656.7618; val_kl_reg_loss: 34516.8695; val_edge_recon_loss: 26444364.5526; val_gene_expr_recon_loss: 5967867.9342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32446749.1053; val_optim_loss: 32446749.1053
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9745; val_auprc_score: 0.9665; val_best_acc_score: 0.9286; val_best_f1_score: 0.9308; train_kl_reg_loss: 35500.3311; train_edge_recon_loss: 25940426.5676; train_gene_expr_recon_loss: 5914903.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31890830.7206; train_optim_loss: 31890830.7206; val_kl_reg_loss: 34532.3959; val_edge_recon_loss: 26477160.0789; val_gene_expr_recon_loss: 5963069.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32474762.2105; val_optim_loss: 32474762.2105

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 90 min 29 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9748
Val AUPRC score: 0.9675
Val best accuracy score: 0.9299
Val best F1 score: 0.9321
Val gene expr MSE score: 1.3787

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
