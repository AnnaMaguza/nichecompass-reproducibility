None
Run timestamp: 19072023_130407_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9672; val_auprc_score: 0.9611; val_best_acc_score: 0.9085; val_best_f1_score: 0.9122; train_kl_reg_loss: 50416.9452; train_edge_recon_loss: 26780949.3445; train_gene_expr_recon_loss: 7482261.3838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34313627.7029; train_optim_loss: 34313627.7029; val_kl_reg_loss: 47037.6288; val_edge_recon_loss: 26512346.2509; val_gene_expr_recon_loss: 6969651.9582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33529035.8467; val_optim_loss: 33529035.8467
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9834; val_auprc_score: 0.9810; val_best_acc_score: 0.9373; val_best_f1_score: 0.9387; train_kl_reg_loss: 39922.4310; train_edge_recon_loss: 26224013.8278; train_gene_expr_recon_loss: 6845785.2657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33109721.5369; train_optim_loss: 33109721.5369; val_kl_reg_loss: 36883.5703; val_edge_recon_loss: 26322408.7735; val_gene_expr_recon_loss: 6793839.7962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33153132.0279; val_optim_loss: 33153132.0279
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9868; val_auprc_score: 0.9850; val_best_acc_score: 0.9456; val_best_f1_score: 0.9466; train_kl_reg_loss: 35249.1115; train_edge_recon_loss: 26075043.3716; train_gene_expr_recon_loss: 6724071.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32834363.6843; train_optim_loss: 32834363.6843; val_kl_reg_loss: 34259.5653; val_edge_recon_loss: 26188851.7213; val_gene_expr_recon_loss: 6710130.3554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32933241.6307; val_optim_loss: 32933241.6307
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9888; val_auprc_score: 0.9871; val_best_acc_score: 0.9512; val_best_f1_score: 0.9521; train_kl_reg_loss: 33712.9086; train_edge_recon_loss: 26007184.8518; train_gene_expr_recon_loss: 6669477.9703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32710375.7486; train_optim_loss: 32710375.7486; val_kl_reg_loss: 32623.6636; val_edge_recon_loss: 26134649.1359; val_gene_expr_recon_loss: 6682406.0767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32849678.8780; val_optim_loss: 32849678.8780
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9889; val_auprc_score: 0.9871; val_best_acc_score: 0.9522; val_best_f1_score: 0.9529; train_kl_reg_loss: 32483.5555; train_edge_recon_loss: 25965638.5446; train_gene_expr_recon_loss: 6640160.5943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32638282.7285; train_optim_loss: 32638282.7285; val_kl_reg_loss: 31771.2016; val_edge_recon_loss: 26124603.6167; val_gene_expr_recon_loss: 6656856.8728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32813231.6725; val_optim_loss: 32813231.6725
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9899; val_auprc_score: 0.9881; val_best_acc_score: 0.9561; val_best_f1_score: 0.9568; train_kl_reg_loss: 31135.7791; train_edge_recon_loss: 25944722.6649; train_gene_expr_recon_loss: 6624955.0002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32600813.4383; train_optim_loss: 32600813.4383; val_kl_reg_loss: 30574.6229; val_edge_recon_loss: 26066079.5889; val_gene_expr_recon_loss: 6634198.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32730852.5854; val_optim_loss: 32730852.5854
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9905; val_auprc_score: 0.9888; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 30720.1935; train_edge_recon_loss: 25910596.3033; train_gene_expr_recon_loss: 6606944.5896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32548261.0923; train_optim_loss: 32548261.0923; val_kl_reg_loss: 30382.0055; val_edge_recon_loss: 26030627.7700; val_gene_expr_recon_loss: 6651501.0157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32712510.8990; val_optim_loss: 32712510.8990
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 30369.4118; train_edge_recon_loss: 25885187.4399; train_gene_expr_recon_loss: 6597535.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32513092.3165; train_optim_loss: 32513092.3165; val_kl_reg_loss: 30294.9532; val_edge_recon_loss: 26021243.6307; val_gene_expr_recon_loss: 6621346.5732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32672885.2613; val_optim_loss: 32672885.2613
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9914; val_auprc_score: 0.9900; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 30239.1003; train_edge_recon_loss: 25875375.0365; train_gene_expr_recon_loss: 6585587.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32491201.3662; train_optim_loss: 32491201.3662; val_kl_reg_loss: 29076.3543; val_edge_recon_loss: 26006100.0767; val_gene_expr_recon_loss: 6626130.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32661306.8293; val_optim_loss: 32661306.8293
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9909; val_auprc_score: 0.9890; val_best_acc_score: 0.9605; val_best_f1_score: 0.9611; train_kl_reg_loss: 29864.1652; train_edge_recon_loss: 25861194.0031; train_gene_expr_recon_loss: 6580793.2184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32471851.4034; train_optim_loss: 32471851.4034; val_kl_reg_loss: 29503.8695; val_edge_recon_loss: 25982674.0557; val_gene_expr_recon_loss: 6626215.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32638393.6167; val_optim_loss: 32638393.6167
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9917; val_auprc_score: 0.9899; val_best_acc_score: 0.9617; val_best_f1_score: 0.9623; train_kl_reg_loss: 29699.8728; train_edge_recon_loss: 25852469.7711; train_gene_expr_recon_loss: 6572987.0830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32455156.7075; train_optim_loss: 32455156.7075; val_kl_reg_loss: 29119.6876; val_edge_recon_loss: 25990557.1498; val_gene_expr_recon_loss: 6603264.4111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32622941.2195; val_optim_loss: 32622941.2195
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9912; val_auprc_score: 0.9894; val_best_acc_score: 0.9605; val_best_f1_score: 0.9611; train_kl_reg_loss: 29399.5491; train_edge_recon_loss: 25830472.9666; train_gene_expr_recon_loss: 6566675.8088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32426548.3305; train_optim_loss: 32426548.3305; val_kl_reg_loss: 29240.8996; val_edge_recon_loss: 25973274.3902; val_gene_expr_recon_loss: 6598198.2160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32600713.4983; val_optim_loss: 32600713.4983
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9916; val_auprc_score: 0.9898; val_best_acc_score: 0.9627; val_best_f1_score: 0.9632; train_kl_reg_loss: 29276.5134; train_edge_recon_loss: 25831738.5725; train_gene_expr_recon_loss: 6565221.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32426236.2281; train_optim_loss: 32426236.2281; val_kl_reg_loss: 28516.0615; val_edge_recon_loss: 25981803.2613; val_gene_expr_recon_loss: 6594468.3084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32604787.5819; val_optim_loss: 32604787.5819
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9623; val_best_f1_score: 0.9629; train_kl_reg_loss: 29085.2570; train_edge_recon_loss: 25828323.4026; train_gene_expr_recon_loss: 6556712.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32414121.5570; train_optim_loss: 32414121.5570; val_kl_reg_loss: 29572.4490; val_edge_recon_loss: 25950921.7352; val_gene_expr_recon_loss: 6595065.2282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32575559.4077; val_optim_loss: 32575559.4077
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9635; val_best_f1_score: 0.9640; train_kl_reg_loss: 29139.4971; train_edge_recon_loss: 25813073.9240; train_gene_expr_recon_loss: 6557466.9474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32399680.3732; train_optim_loss: 32399680.3732; val_kl_reg_loss: 28681.5441; val_edge_recon_loss: 25939764.0000; val_gene_expr_recon_loss: 6605600.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32574045.9582; val_optim_loss: 32574045.9582
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 29106.8407; train_edge_recon_loss: 25813945.4787; train_gene_expr_recon_loss: 6548935.2923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32391987.6191; train_optim_loss: 32391987.6191; val_kl_reg_loss: 28775.6790; val_edge_recon_loss: 25966415.3798; val_gene_expr_recon_loss: 6598756.8397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32593947.8815; val_optim_loss: 32593947.8815
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 28861.3569; train_edge_recon_loss: 25812051.2196; train_gene_expr_recon_loss: 6545777.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32386690.3491; train_optim_loss: 32386690.3491; val_kl_reg_loss: 28609.6174; val_edge_recon_loss: 25937257.2334; val_gene_expr_recon_loss: 6577629.0993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32543495.8537; val_optim_loss: 32543495.8537
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9651; val_best_f1_score: 0.9655; train_kl_reg_loss: 28629.9394; train_edge_recon_loss: 25803686.0993; train_gene_expr_recon_loss: 6546394.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32378710.8130; train_optim_loss: 32378710.8130; val_kl_reg_loss: 27727.3240; val_edge_recon_loss: 25914233.7700; val_gene_expr_recon_loss: 6575436.7857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32517397.9024; val_optim_loss: 32517397.9024
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 28748.0801; train_edge_recon_loss: 25800444.2320; train_gene_expr_recon_loss: 6542726.6257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32371918.9480; train_optim_loss: 32371918.9480; val_kl_reg_loss: 29157.9561; val_edge_recon_loss: 25900999.9652; val_gene_expr_recon_loss: 6591520.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32521678.5784; val_optim_loss: 32521678.5784
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 28753.6178; train_edge_recon_loss: 25790402.2172; train_gene_expr_recon_loss: 6538673.2062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32357829.0442; train_optim_loss: 32357829.0442; val_kl_reg_loss: 28170.7795; val_edge_recon_loss: 25939705.9373; val_gene_expr_recon_loss: 6590882.9373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32558759.6028; val_optim_loss: 32558759.6028
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9931; val_auprc_score: 0.9917; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 28482.1077; train_edge_recon_loss: 25783317.2995; train_gene_expr_recon_loss: 6539878.6699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32351678.0714; train_optim_loss: 32351678.0714; val_kl_reg_loss: 28553.1120; val_edge_recon_loss: 25899322.1185; val_gene_expr_recon_loss: 6570245.9826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32498121.1986; val_optim_loss: 32498121.1986
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9932; val_auprc_score: 0.9918; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 28437.2844; train_edge_recon_loss: 25785081.5912; train_gene_expr_recon_loss: 6540287.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32353806.6804; train_optim_loss: 32353806.6804; val_kl_reg_loss: 27899.1044; val_edge_recon_loss: 25925863.5749; val_gene_expr_recon_loss: 6575716.6969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32529479.4286; val_optim_loss: 32529479.4286
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 28263.0649; train_edge_recon_loss: 25782774.8177; train_gene_expr_recon_loss: 6538340.7624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32349378.6672; train_optim_loss: 32349378.6672; val_kl_reg_loss: 28313.6418; val_edge_recon_loss: 25898659.6516; val_gene_expr_recon_loss: 6581862.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32508835.6376; val_optim_loss: 32508835.6376
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 28041.9666; train_edge_recon_loss: 25781969.4787; train_gene_expr_recon_loss: 6536759.4711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32346770.9573; train_optim_loss: 32346770.9573; val_kl_reg_loss: 27440.1341; val_edge_recon_loss: 25909471.7700; val_gene_expr_recon_loss: 6579536.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32516448.1812; val_optim_loss: 32516448.1812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 28148.8825; train_edge_recon_loss: 25784293.9597; train_gene_expr_recon_loss: 6534330.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32346773.1435; train_optim_loss: 32346773.1435; val_kl_reg_loss: 27918.8719; val_edge_recon_loss: 25902377.5192; val_gene_expr_recon_loss: 6578872.4756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32509168.9199; val_optim_loss: 32509168.9199

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 30190.1440; train_edge_recon_loss: 25760213.2304; train_gene_expr_recon_loss: 6471525.1594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32261928.5578; train_optim_loss: 32261928.5578; val_kl_reg_loss: 30532.7105; val_edge_recon_loss: 25850358.1603; val_gene_expr_recon_loss: 6514997.6777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32395888.6063; val_optim_loss: 32395888.6063
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9934; val_auprc_score: 0.9920; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 31370.6340; train_edge_recon_loss: 25749652.7153; train_gene_expr_recon_loss: 6465032.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32246055.5570; train_optim_loss: 32246055.5570; val_kl_reg_loss: 31397.9509; val_edge_recon_loss: 25859885.2474; val_gene_expr_recon_loss: 6507781.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32399064.5157; val_optim_loss: 32399064.5157
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 31772.2444; train_edge_recon_loss: 25743818.6005; train_gene_expr_recon_loss: 6463596.3390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32239187.1699; train_optim_loss: 32239187.1699; val_kl_reg_loss: 31370.3410; val_edge_recon_loss: 25882121.1220; val_gene_expr_recon_loss: 6511565.7282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32425057.1707; val_optim_loss: 32425057.1707
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 31882.4164; train_edge_recon_loss: 25746818.2801; train_gene_expr_recon_loss: 6459540.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32238241.6563; train_optim_loss: 32238241.6563; val_kl_reg_loss: 31419.5660; val_edge_recon_loss: 25864157.2474; val_gene_expr_recon_loss: 6508929.1672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32404505.9721; val_optim_loss: 32404505.9721
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 32092.8465; train_edge_recon_loss: 25746897.7052; train_gene_expr_recon_loss: 6454792.1903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32233782.7510; train_optim_loss: 32233782.7510; val_kl_reg_loss: 31776.6625; val_edge_recon_loss: 25854573.3310; val_gene_expr_recon_loss: 6497803.5418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32384153.4355; val_optim_loss: 32384153.4355
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 32124.1132; train_edge_recon_loss: 25746208.4182; train_gene_expr_recon_loss: 6453986.2702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32232318.8208; train_optim_loss: 32232318.8208; val_kl_reg_loss: 31701.8804; val_edge_recon_loss: 25854831.2474; val_gene_expr_recon_loss: 6504680.5523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32391213.6864; val_optim_loss: 32391213.6864
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9682; val_best_f1_score: 0.9686; train_kl_reg_loss: 32222.3516; train_edge_recon_loss: 25750496.5795; train_gene_expr_recon_loss: 6449582.6779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32232301.6067; train_optim_loss: 32232301.6067; val_kl_reg_loss: 32063.8691; val_edge_recon_loss: 25858844.4181; val_gene_expr_recon_loss: 6497558.3606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388466.5784; val_optim_loss: 32388466.5784
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9937; val_auprc_score: 0.9922; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 32260.9846; train_edge_recon_loss: 25746996.0993; train_gene_expr_recon_loss: 6452006.0266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32231263.1047; train_optim_loss: 32231263.1047; val_kl_reg_loss: 31621.9368; val_edge_recon_loss: 25868153.9303; val_gene_expr_recon_loss: 6506940.9564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32406716.8362; val_optim_loss: 32406716.8362
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 32234.2481; train_edge_recon_loss: 25745565.8673; train_gene_expr_recon_loss: 6448895.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32226695.4554; train_optim_loss: 32226695.4554; val_kl_reg_loss: 31837.3250; val_edge_recon_loss: 25858038.8432; val_gene_expr_recon_loss: 6505148.2944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32395024.4530; val_optim_loss: 32395024.4530

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9937; val_auprc_score: 0.9922; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 32261.4383; train_edge_recon_loss: 25745664.4531; train_gene_expr_recon_loss: 6441373.7971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32219299.6656; train_optim_loss: 32219299.6656; val_kl_reg_loss: 31985.5674; val_edge_recon_loss: 25849351.9861; val_gene_expr_recon_loss: 6489720.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32371058.4251; val_optim_loss: 32371058.4251
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 32351.8286; train_edge_recon_loss: 25749738.1241; train_gene_expr_recon_loss: 6442631.1571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32224721.1024; train_optim_loss: 32224721.1024; val_kl_reg_loss: 32001.0317; val_edge_recon_loss: 25847180.4042; val_gene_expr_recon_loss: 6489158.9042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368340.3624; val_optim_loss: 32368340.3624
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 32474.2934; train_edge_recon_loss: 25741489.2839; train_gene_expr_recon_loss: 6441880.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215843.8161; train_optim_loss: 32215843.8161; val_kl_reg_loss: 32187.7322; val_edge_recon_loss: 25857992.4739; val_gene_expr_recon_loss: 6489377.4077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32379557.5540; val_optim_loss: 32379557.5540
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 32540.3329; train_edge_recon_loss: 25739461.3390; train_gene_expr_recon_loss: 6441097.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32213099.5306; train_optim_loss: 32213099.5306; val_kl_reg_loss: 32162.3583; val_edge_recon_loss: 25851163.2125; val_gene_expr_recon_loss: 6490461.7787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32373787.2544; val_optim_loss: 32373787.2544
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9937; val_auprc_score: 0.9923; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 32547.3404; train_edge_recon_loss: 25739081.3274; train_gene_expr_recon_loss: 6440958.1827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32212586.8891; train_optim_loss: 32212586.8891; val_kl_reg_loss: 32147.9325; val_edge_recon_loss: 25848237.2753; val_gene_expr_recon_loss: 6486383.1655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32366768.4808; val_optim_loss: 32366768.4808
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9938; val_auprc_score: 0.9924; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 32528.9864; train_edge_recon_loss: 25745146.6230; train_gene_expr_recon_loss: 6437781.2516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215456.8642; train_optim_loss: 32215456.8642; val_kl_reg_loss: 32162.4272; val_edge_recon_loss: 25850614.0279; val_gene_expr_recon_loss: 6492982.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32375759.0035; val_optim_loss: 32375759.0035
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 32551.2767; train_edge_recon_loss: 25743009.5648; train_gene_expr_recon_loss: 6441697.6614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32217258.4732; train_optim_loss: 32217258.4732; val_kl_reg_loss: 32211.6698; val_edge_recon_loss: 25857794.7247; val_gene_expr_recon_loss: 6483081.6707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32373088.2230; val_optim_loss: 32373088.2230
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 32582.2211; train_edge_recon_loss: 25750718.6951; train_gene_expr_recon_loss: 6441170.0454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32224470.9472; train_optim_loss: 32224470.9472; val_kl_reg_loss: 32272.7466; val_edge_recon_loss: 25844708.5784; val_gene_expr_recon_loss: 6494032.2561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32371013.6098; val_optim_loss: 32371013.6098
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 32586.0655; train_edge_recon_loss: 25743196.6889; train_gene_expr_recon_loss: 6440308.3796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32216091.1241; train_optim_loss: 32216091.1241; val_kl_reg_loss: 32226.6789; val_edge_recon_loss: 25847772.1115; val_gene_expr_recon_loss: 6498721.2404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32378720.0279; val_optim_loss: 32378720.0279

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9941; val_auprc_score: 0.9929; val_best_acc_score: 0.9697; val_best_f1_score: 0.9700; train_kl_reg_loss: 32603.7396; train_edge_recon_loss: 25742186.6819; train_gene_expr_recon_loss: 6437631.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32212421.5935; train_optim_loss: 32212421.5935; val_kl_reg_loss: 32247.8010; val_edge_recon_loss: 25848722.0279; val_gene_expr_recon_loss: 6493140.6533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32374110.6620; val_optim_loss: 32374110.6620
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 32629.1689; train_edge_recon_loss: 25743780.0737; train_gene_expr_recon_loss: 6437328.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32213737.3708; train_optim_loss: 32213737.3708; val_kl_reg_loss: 32306.3442; val_edge_recon_loss: 25848711.3519; val_gene_expr_recon_loss: 6480129.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32361146.9617; val_optim_loss: 32361146.9617
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9938; val_auprc_score: 0.9925; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 32617.7662; train_edge_recon_loss: 25738416.1319; train_gene_expr_recon_loss: 6438118.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32209152.6439; train_optim_loss: 32209152.6439; val_kl_reg_loss: 32267.4996; val_edge_recon_loss: 25848339.3310; val_gene_expr_recon_loss: 6487419.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368026.6063; val_optim_loss: 32368026.6063
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9939; val_auprc_score: 0.9927; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 32627.0705; train_edge_recon_loss: 25741365.9310; train_gene_expr_recon_loss: 6439224.6173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32213217.6222; train_optim_loss: 32213217.6222; val_kl_reg_loss: 32219.3737; val_edge_recon_loss: 25860549.3659; val_gene_expr_recon_loss: 6489484.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32382253.4774; val_optim_loss: 32382253.4774
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9938; val_auprc_score: 0.9924; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 32600.9417; train_edge_recon_loss: 25735997.2793; train_gene_expr_recon_loss: 6439963.1691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32208561.4011; train_optim_loss: 32208561.4011; val_kl_reg_loss: 32214.5206; val_edge_recon_loss: 25859153.0244; val_gene_expr_recon_loss: 6483759.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32375127.4146; val_optim_loss: 32375127.4146
