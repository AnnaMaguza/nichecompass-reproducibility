None
Run timestamp: 24072023_233349_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9679; val_auprc_score: 0.9629; val_best_acc_score: 0.9092; val_best_f1_score: 0.9124; train_kl_reg_loss: 16556.3097; train_edge_recon_loss: 2667595.1665; train_gene_expr_recon_loss: 747229.0518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3431380.5307; train_optim_loss: 3431380.5307; val_kl_reg_loss: 14111.0892; val_edge_recon_loss: 2667231.1065; val_gene_expr_recon_loss: 685794.3819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3367136.5637; val_optim_loss: 3367136.5637
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9790; val_auprc_score: 0.9766; val_best_acc_score: 0.9282; val_best_f1_score: 0.9296; train_kl_reg_loss: 13924.0217; train_edge_recon_loss: 2615727.0481; train_gene_expr_recon_loss: 666424.2460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3296075.3155; train_optim_loss: 3296075.3155; val_kl_reg_loss: 13424.7119; val_edge_recon_loss: 2651434.9062; val_gene_expr_recon_loss: 648878.4135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3313738.0324; val_optim_loss: 3313738.0324
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9807; val_auprc_score: 0.9782; val_best_acc_score: 0.9319; val_best_f1_score: 0.9334; train_kl_reg_loss: 13441.1154; train_edge_recon_loss: 2607791.9919; train_gene_expr_recon_loss: 643015.7150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3264248.8228; train_optim_loss: 3264248.8228; val_kl_reg_loss: 13047.6427; val_edge_recon_loss: 2650047.9919; val_gene_expr_recon_loss: 634946.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3298041.6470; val_optim_loss: 3298041.6470
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9823; val_auprc_score: 0.9798; val_best_acc_score: 0.9352; val_best_f1_score: 0.9365; train_kl_reg_loss: 13127.3325; train_edge_recon_loss: 2604325.1759; train_gene_expr_recon_loss: 632101.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249553.5340; train_optim_loss: 3249553.5340; val_kl_reg_loss: 12821.0419; val_edge_recon_loss: 2645764.4039; val_gene_expr_recon_loss: 629205.6730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3287791.1123; val_optim_loss: 3287791.1123
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9841; val_auprc_score: 0.9820; val_best_acc_score: 0.9390; val_best_f1_score: 0.9402; train_kl_reg_loss: 12943.8737; train_edge_recon_loss: 2600611.0117; train_gene_expr_recon_loss: 626760.1209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240315.0062; train_optim_loss: 3240315.0062; val_kl_reg_loss: 12559.6406; val_edge_recon_loss: 2642714.8044; val_gene_expr_recon_loss: 624635.9343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279910.3796; val_optim_loss: 3279910.3796
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9811; val_best_acc_score: 0.9387; val_best_f1_score: 0.9399; train_kl_reg_loss: 12865.6912; train_edge_recon_loss: 2598984.4974; train_gene_expr_recon_loss: 622793.6644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234643.8502; train_optim_loss: 3234643.8502; val_kl_reg_loss: 12578.7006; val_edge_recon_loss: 2639043.9109; val_gene_expr_recon_loss: 622108.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273731.4745; val_optim_loss: 3273731.4745
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9845; val_auprc_score: 0.9823; val_best_acc_score: 0.9417; val_best_f1_score: 0.9427; train_kl_reg_loss: 12777.1484; train_edge_recon_loss: 2596907.8332; train_gene_expr_recon_loss: 620103.7477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229788.7279; train_optim_loss: 3229788.7279; val_kl_reg_loss: 12430.4472; val_edge_recon_loss: 2641031.5035; val_gene_expr_recon_loss: 619064.1505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272526.1065; val_optim_loss: 3272526.1065
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9844; val_auprc_score: 0.9822; val_best_acc_score: 0.9408; val_best_f1_score: 0.9419; train_kl_reg_loss: 12730.6610; train_edge_recon_loss: 2595208.8021; train_gene_expr_recon_loss: 618003.1388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225942.6030; train_optim_loss: 3225942.6030; val_kl_reg_loss: 12281.7282; val_edge_recon_loss: 2639686.7581; val_gene_expr_recon_loss: 619593.1606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271561.6574; val_optim_loss: 3271561.6574
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9855; val_auprc_score: 0.9834; val_best_acc_score: 0.9432; val_best_f1_score: 0.9441; train_kl_reg_loss: 12727.4711; train_edge_recon_loss: 2594392.6716; train_gene_expr_recon_loss: 616719.6097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223839.7510; train_optim_loss: 3223839.7510; val_kl_reg_loss: 12637.4177; val_edge_recon_loss: 2636198.3148; val_gene_expr_recon_loss: 618538.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267373.7998; val_optim_loss: 3267373.7998
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9856; val_auprc_score: 0.9836; val_best_acc_score: 0.9437; val_best_f1_score: 0.9448; train_kl_reg_loss: 12660.2358; train_edge_recon_loss: 2593379.2283; train_gene_expr_recon_loss: 615729.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221769.0513; train_optim_loss: 3221769.0513; val_kl_reg_loss: 12282.5477; val_edge_recon_loss: 2635820.6470; val_gene_expr_recon_loss: 615819.3857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263922.5729; val_optim_loss: 3263922.5729
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9854; val_auprc_score: 0.9834; val_best_acc_score: 0.9435; val_best_f1_score: 0.9445; train_kl_reg_loss: 12652.1533; train_edge_recon_loss: 2592475.7995; train_gene_expr_recon_loss: 614558.9405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219686.8940; train_optim_loss: 3219686.8940; val_kl_reg_loss: 12462.3182; val_edge_recon_loss: 2637561.7292; val_gene_expr_recon_loss: 614394.2934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264418.3333; val_optim_loss: 3264418.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9860; val_auprc_score: 0.9840; val_best_acc_score: 0.9454; val_best_f1_score: 0.9462; train_kl_reg_loss: 12588.3029; train_edge_recon_loss: 2591752.7342; train_gene_expr_recon_loss: 614270.2340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218611.2689; train_optim_loss: 3218611.2689; val_kl_reg_loss: 12523.4688; val_edge_recon_loss: 2635539.1053; val_gene_expr_recon_loss: 613395.1869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261457.7697; val_optim_loss: 3261457.7697
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9864; val_auprc_score: 0.9844; val_best_acc_score: 0.9458; val_best_f1_score: 0.9465; train_kl_reg_loss: 12595.8752; train_edge_recon_loss: 2591055.3463; train_gene_expr_recon_loss: 613145.3370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216796.5592; train_optim_loss: 3216796.5592; val_kl_reg_loss: 12279.8093; val_edge_recon_loss: 2635060.6690; val_gene_expr_recon_loss: 612771.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260111.6042; val_optim_loss: 3260111.6042
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9866; val_auprc_score: 0.9845; val_best_acc_score: 0.9462; val_best_f1_score: 0.9470; train_kl_reg_loss: 12555.0043; train_edge_recon_loss: 2590930.2319; train_gene_expr_recon_loss: 612474.7499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215959.9848; train_optim_loss: 3215959.9848; val_kl_reg_loss: 12378.5663; val_edge_recon_loss: 2630679.6597; val_gene_expr_recon_loss: 612274.4601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255332.6933; val_optim_loss: 3255332.6933
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9854; val_best_acc_score: 0.9467; val_best_f1_score: 0.9477; train_kl_reg_loss: 12488.9915; train_edge_recon_loss: 2590514.0667; train_gene_expr_recon_loss: 612384.8888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215387.9500; train_optim_loss: 3215387.9500; val_kl_reg_loss: 12160.4087; val_edge_recon_loss: 2628282.9815; val_gene_expr_recon_loss: 612049.2138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252492.6030; val_optim_loss: 3252492.6030
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9865; val_auprc_score: 0.9845; val_best_acc_score: 0.9465; val_best_f1_score: 0.9475; train_kl_reg_loss: 12466.5635; train_edge_recon_loss: 2589189.0967; train_gene_expr_recon_loss: 611946.2958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213601.9560; train_optim_loss: 3213601.9560; val_kl_reg_loss: 12131.0493; val_edge_recon_loss: 2630145.1655; val_gene_expr_recon_loss: 613262.8336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255539.0509; val_optim_loss: 3255539.0509
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9868; val_auprc_score: 0.9847; val_best_acc_score: 0.9466; val_best_f1_score: 0.9475; train_kl_reg_loss: 12400.2191; train_edge_recon_loss: 2590179.5832; train_gene_expr_recon_loss: 611286.1547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213865.9537; train_optim_loss: 3213865.9537; val_kl_reg_loss: 12354.2186; val_edge_recon_loss: 2630276.6736; val_gene_expr_recon_loss: 615493.9340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258124.8252; val_optim_loss: 3258124.8252
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9868; val_auprc_score: 0.9850; val_best_acc_score: 0.9461; val_best_f1_score: 0.9471; train_kl_reg_loss: 12471.1354; train_edge_recon_loss: 2588061.2190; train_gene_expr_recon_loss: 610983.6920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211516.0478; train_optim_loss: 3211516.0478; val_kl_reg_loss: 12114.6304; val_edge_recon_loss: 2631027.0914; val_gene_expr_recon_loss: 611704.4045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254846.1308; val_optim_loss: 3254846.1308
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9873; val_auprc_score: 0.9855; val_best_acc_score: 0.9473; val_best_f1_score: 0.9482; train_kl_reg_loss: 12428.4485; train_edge_recon_loss: 2587963.3722; train_gene_expr_recon_loss: 610629.2487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211021.0701; train_optim_loss: 3211021.0701; val_kl_reg_loss: 12294.7685; val_edge_recon_loss: 2629871.1192; val_gene_expr_recon_loss: 611137.9563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253303.8426; val_optim_loss: 3253303.8426

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9878; val_auprc_score: 0.9858; val_best_acc_score: 0.9491; val_best_f1_score: 0.9500; train_kl_reg_loss: 12608.2237; train_edge_recon_loss: 2585549.9907; train_gene_expr_recon_loss: 603165.5864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201323.8041; train_optim_loss: 3201323.8041; val_kl_reg_loss: 12341.0519; val_edge_recon_loss: 2625149.4502; val_gene_expr_recon_loss: 603699.4462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241189.9502; val_optim_loss: 3241189.9502
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9877; val_auprc_score: 0.9860; val_best_acc_score: 0.9492; val_best_f1_score: 0.9498; train_kl_reg_loss: 12652.5384; train_edge_recon_loss: 2585536.9745; train_gene_expr_recon_loss: 602086.7558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200276.2677; train_optim_loss: 3200276.2677; val_kl_reg_loss: 12398.6526; val_edge_recon_loss: 2627920.6065; val_gene_expr_recon_loss: 603563.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243882.3565; val_optim_loss: 3243882.3565
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9878; val_auprc_score: 0.9861; val_best_acc_score: 0.9493; val_best_f1_score: 0.9501; train_kl_reg_loss: 12634.4601; train_edge_recon_loss: 2585872.8579; train_gene_expr_recon_loss: 601321.1455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3199828.4686; train_optim_loss: 3199828.4686; val_kl_reg_loss: 12353.4783; val_edge_recon_loss: 2628195.9363; val_gene_expr_recon_loss: 601738.3971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242287.8067; val_optim_loss: 3242287.8067
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9877; val_auprc_score: 0.9856; val_best_acc_score: 0.9494; val_best_f1_score: 0.9501; train_kl_reg_loss: 12668.1059; train_edge_recon_loss: 2585697.6964; train_gene_expr_recon_loss: 600987.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3199353.6672; train_optim_loss: 3199353.6672; val_kl_reg_loss: 12421.2524; val_edge_recon_loss: 2626873.2720; val_gene_expr_recon_loss: 602303.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241597.7593; val_optim_loss: 3241597.7593
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9879; val_auprc_score: 0.9860; val_best_acc_score: 0.9485; val_best_f1_score: 0.9494; train_kl_reg_loss: 12641.4594; train_edge_recon_loss: 2585792.0004; train_gene_expr_recon_loss: 601159.3692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3199592.8247; train_optim_loss: 3199592.8247; val_kl_reg_loss: 12336.6757; val_edge_recon_loss: 2628466.0012; val_gene_expr_recon_loss: 601809.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242611.7118; val_optim_loss: 3242611.7118

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9880; val_auprc_score: 0.9863; val_best_acc_score: 0.9492; val_best_f1_score: 0.9499; train_kl_reg_loss: 12612.9512; train_edge_recon_loss: 2584755.6350; train_gene_expr_recon_loss: 599921.1383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197289.7287; train_optim_loss: 3197289.7287; val_kl_reg_loss: 12392.4384; val_edge_recon_loss: 2626602.0625; val_gene_expr_recon_loss: 600718.5431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239713.0336; val_optim_loss: 3239713.0336
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9879; val_auprc_score: 0.9860; val_best_acc_score: 0.9495; val_best_f1_score: 0.9504; train_kl_reg_loss: 12646.0097; train_edge_recon_loss: 2585287.2391; train_gene_expr_recon_loss: 599939.6091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197872.8564; train_optim_loss: 3197872.8564; val_kl_reg_loss: 12410.5378; val_edge_recon_loss: 2627016.8206; val_gene_expr_recon_loss: 600855.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240282.3611; val_optim_loss: 3240282.3611
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9879; val_auprc_score: 0.9860; val_best_acc_score: 0.9491; val_best_f1_score: 0.9497; train_kl_reg_loss: 12654.4572; train_edge_recon_loss: 2584543.7251; train_gene_expr_recon_loss: 599686.5015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196884.6830; train_optim_loss: 3196884.6830; val_kl_reg_loss: 12412.9962; val_edge_recon_loss: 2626088.6470; val_gene_expr_recon_loss: 600818.9343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239320.5741; val_optim_loss: 3239320.5741
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9877; val_auprc_score: 0.9859; val_best_acc_score: 0.9490; val_best_f1_score: 0.9499; train_kl_reg_loss: 12665.7099; train_edge_recon_loss: 2584343.1209; train_gene_expr_recon_loss: 599979.2167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196988.0469; train_optim_loss: 3196988.0469; val_kl_reg_loss: 12430.6139; val_edge_recon_loss: 2628053.5081; val_gene_expr_recon_loss: 601960.4705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242444.5787; val_optim_loss: 3242444.5787
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9882; val_auprc_score: 0.9864; val_best_acc_score: 0.9503; val_best_f1_score: 0.9510; train_kl_reg_loss: 12658.8776; train_edge_recon_loss: 2585246.9664; train_gene_expr_recon_loss: 599931.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197837.1407; train_optim_loss: 3197837.1407; val_kl_reg_loss: 12394.3092; val_edge_recon_loss: 2624541.1898; val_gene_expr_recon_loss: 601588.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238524.4340; val_optim_loss: 3238524.4340
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9880; val_auprc_score: 0.9863; val_best_acc_score: 0.9490; val_best_f1_score: 0.9498; train_kl_reg_loss: 12645.8373; train_edge_recon_loss: 2584364.1413; train_gene_expr_recon_loss: 599301.3716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196311.3461; train_optim_loss: 3196311.3461; val_kl_reg_loss: 12398.5997; val_edge_recon_loss: 2626081.0532; val_gene_expr_recon_loss: 600037.6331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238517.2963; val_optim_loss: 3238517.2963
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9881; val_auprc_score: 0.9863; val_best_acc_score: 0.9501; val_best_f1_score: 0.9508; train_kl_reg_loss: 12664.8463; train_edge_recon_loss: 2584222.6696; train_gene_expr_recon_loss: 600159.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197046.6368; train_optim_loss: 3197046.6368; val_kl_reg_loss: 12398.5625; val_edge_recon_loss: 2624823.2604; val_gene_expr_recon_loss: 600515.3420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237737.1655; val_optim_loss: 3237737.1655
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9880; val_auprc_score: 0.9864; val_best_acc_score: 0.9498; val_best_f1_score: 0.9506; train_kl_reg_loss: 12656.9878; train_edge_recon_loss: 2584719.3948; train_gene_expr_recon_loss: 599725.8658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197102.2499; train_optim_loss: 3197102.2499; val_kl_reg_loss: 12385.7125; val_edge_recon_loss: 2624521.2384; val_gene_expr_recon_loss: 600559.7190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237466.6736; val_optim_loss: 3237466.6736
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9880; val_auprc_score: 0.9863; val_best_acc_score: 0.9497; val_best_f1_score: 0.9504; train_kl_reg_loss: 12649.1318; train_edge_recon_loss: 2585773.2275; train_gene_expr_recon_loss: 599865.1218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3198287.4821; train_optim_loss: 3198287.4821; val_kl_reg_loss: 12390.9253; val_edge_recon_loss: 2625564.7315; val_gene_expr_recon_loss: 599473.3394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237428.9803; val_optim_loss: 3237428.9803
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9879; val_auprc_score: 0.9859; val_best_acc_score: 0.9499; val_best_f1_score: 0.9507; train_kl_reg_loss: 12646.3259; train_edge_recon_loss: 2585134.2760; train_gene_expr_recon_loss: 599696.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197477.2270; train_optim_loss: 3197477.2270; val_kl_reg_loss: 12393.2894; val_edge_recon_loss: 2624207.4028; val_gene_expr_recon_loss: 600609.7390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237210.4271; val_optim_loss: 3237210.4271
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9882; val_auprc_score: 0.9864; val_best_acc_score: 0.9506; val_best_f1_score: 0.9514; train_kl_reg_loss: 12635.5290; train_edge_recon_loss: 2585415.6262; train_gene_expr_recon_loss: 600192.2516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3198243.4072; train_optim_loss: 3198243.4072; val_kl_reg_loss: 12380.7037; val_edge_recon_loss: 2623659.0567; val_gene_expr_recon_loss: 600587.8953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236627.6528; val_optim_loss: 3236627.6528
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9880; val_auprc_score: 0.9862; val_best_acc_score: 0.9498; val_best_f1_score: 0.9507; train_kl_reg_loss: 12624.5985; train_edge_recon_loss: 2584744.1395; train_gene_expr_recon_loss: 599783.0345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197151.7722; train_optim_loss: 3197151.7722; val_kl_reg_loss: 12394.3745; val_edge_recon_loss: 2625322.2558; val_gene_expr_recon_loss: 601593.7185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239310.3484; val_optim_loss: 3239310.3484
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9878; val_auprc_score: 0.9859; val_best_acc_score: 0.9492; val_best_f1_score: 0.9501; train_kl_reg_loss: 12642.4597; train_edge_recon_loss: 2584274.2478; train_gene_expr_recon_loss: 599480.9238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196397.6265; train_optim_loss: 3196397.6265; val_kl_reg_loss: 12391.1777; val_edge_recon_loss: 2627010.2986; val_gene_expr_recon_loss: 600526.1565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239927.6354; val_optim_loss: 3239927.6354
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9880; val_auprc_score: 0.9863; val_best_acc_score: 0.9492; val_best_f1_score: 0.9500; train_kl_reg_loss: 12627.5830; train_edge_recon_loss: 2584988.3607; train_gene_expr_recon_loss: 599852.2175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197468.1605; train_optim_loss: 3197468.1605; val_kl_reg_loss: 12384.0220; val_edge_recon_loss: 2626007.7812; val_gene_expr_recon_loss: 601769.8154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240161.6169; val_optim_loss: 3240161.6169
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9883; val_auprc_score: 0.9867; val_best_acc_score: 0.9497; val_best_f1_score: 0.9505; train_kl_reg_loss: 12624.2953; train_edge_recon_loss: 2584662.3774; train_gene_expr_recon_loss: 600035.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197321.7010; train_optim_loss: 3197321.7010; val_kl_reg_loss: 12384.3567; val_edge_recon_loss: 2623868.6447; val_gene_expr_recon_loss: 601295.9670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237548.9699; val_optim_loss: 3237548.9699

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9877; val_auprc_score: 0.9858; val_best_acc_score: 0.9490; val_best_f1_score: 0.9498; train_kl_reg_loss: 12636.9342; train_edge_recon_loss: 2584856.2590; train_gene_expr_recon_loss: 599579.8057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197072.9972; train_optim_loss: 3197072.9972; val_kl_reg_loss: 12410.4449; val_edge_recon_loss: 2626322.1123; val_gene_expr_recon_loss: 601563.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240296.2025; val_optim_loss: 3240296.2025
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9880; val_auprc_score: 0.9861; val_best_acc_score: 0.9498; val_best_f1_score: 0.9507; train_kl_reg_loss: 12636.6969; train_edge_recon_loss: 2585183.6562; train_gene_expr_recon_loss: 599349.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197170.3510; train_optim_loss: 3197170.3510; val_kl_reg_loss: 12394.3066; val_edge_recon_loss: 2624308.2546; val_gene_expr_recon_loss: 600080.8707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236783.4213; val_optim_loss: 3236783.4213
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9883; val_auprc_score: 0.9867; val_best_acc_score: 0.9504; val_best_f1_score: 0.9512; train_kl_reg_loss: 12639.6648; train_edge_recon_loss: 2585171.7303; train_gene_expr_recon_loss: 599707.6164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197519.0100; train_optim_loss: 3197519.0100; val_kl_reg_loss: 12388.7857; val_edge_recon_loss: 2623819.4699; val_gene_expr_recon_loss: 601182.7234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237390.9757; val_optim_loss: 3237390.9757
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9883; val_auprc_score: 0.9866; val_best_acc_score: 0.9496; val_best_f1_score: 0.9502; train_kl_reg_loss: 12634.4060; train_edge_recon_loss: 2584836.3773; train_gene_expr_recon_loss: 599524.1964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196994.9797; train_optim_loss: 3196994.9797; val_kl_reg_loss: 12398.0187; val_edge_recon_loss: 2623434.8287; val_gene_expr_recon_loss: 600754.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236587.6019; val_optim_loss: 3236587.6019
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9882; val_auprc_score: 0.9867; val_best_acc_score: 0.9495; val_best_f1_score: 0.9504; train_kl_reg_loss: 12637.8525; train_edge_recon_loss: 2584386.7497; train_gene_expr_recon_loss: 599616.1533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196640.7585; train_optim_loss: 3196640.7585; val_kl_reg_loss: 12384.5268; val_edge_recon_loss: 2625574.8449; val_gene_expr_recon_loss: 600268.1878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238227.5648; val_optim_loss: 3238227.5648
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9880; val_auprc_score: 0.9864; val_best_acc_score: 0.9497; val_best_f1_score: 0.9506; train_kl_reg_loss: 12642.9498; train_edge_recon_loss: 2584639.4911; train_gene_expr_recon_loss: 599417.1996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196699.6420; train_optim_loss: 3196699.6420; val_kl_reg_loss: 12375.6656; val_edge_recon_loss: 2627114.7569; val_gene_expr_recon_loss: 600363.6916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239854.1123; val_optim_loss: 3239854.1123
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9883; val_auprc_score: 0.9868; val_best_acc_score: 0.9502; val_best_f1_score: 0.9510; train_kl_reg_loss: 12636.2307; train_edge_recon_loss: 2584468.1211; train_gene_expr_recon_loss: 599675.3325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196779.6860; train_optim_loss: 3196779.6860; val_kl_reg_loss: 12373.4128; val_edge_recon_loss: 2624925.3623; val_gene_expr_recon_loss: 599820.3215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237119.0926; val_optim_loss: 3237119.0926
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9876; val_auprc_score: 0.9856; val_best_acc_score: 0.9492; val_best_f1_score: 0.9500; train_kl_reg_loss: 12635.1891; train_edge_recon_loss: 2584683.3392; train_gene_expr_recon_loss: 599634.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196952.7088; train_optim_loss: 3196952.7088; val_kl_reg_loss: 12380.9544; val_edge_recon_loss: 2626874.0775; val_gene_expr_recon_loss: 600420.0211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239675.0451; val_optim_loss: 3239675.0451

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9879; val_auprc_score: 0.9862; val_best_acc_score: 0.9498; val_best_f1_score: 0.9507; train_kl_reg_loss: 12635.5270; train_edge_recon_loss: 2585013.3248; train_gene_expr_recon_loss: 599085.1303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196733.9823; train_optim_loss: 3196733.9823; val_kl_reg_loss: 12387.6529; val_edge_recon_loss: 2626187.7431; val_gene_expr_recon_loss: 600595.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239171.3553; val_optim_loss: 3239171.3553
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9880; val_auprc_score: 0.9860; val_best_acc_score: 0.9496; val_best_f1_score: 0.9504; train_kl_reg_loss: 12626.3797; train_edge_recon_loss: 2583609.4185; train_gene_expr_recon_loss: 599441.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3195677.7348; train_optim_loss: 3195677.7348; val_kl_reg_loss: 12389.6578; val_edge_recon_loss: 2626631.8021; val_gene_expr_recon_loss: 599611.8064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238633.2685; val_optim_loss: 3238633.2685
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9878; val_auprc_score: 0.9859; val_best_acc_score: 0.9494; val_best_f1_score: 0.9501; train_kl_reg_loss: 12637.8168; train_edge_recon_loss: 2585187.1244; train_gene_expr_recon_loss: 599489.6689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3197314.6089; train_optim_loss: 3197314.6089; val_kl_reg_loss: 12390.9817; val_edge_recon_loss: 2628865.7546; val_gene_expr_recon_loss: 600714.2150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241970.9525; val_optim_loss: 3241970.9525
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9882; val_auprc_score: 0.9867; val_best_acc_score: 0.9500; val_best_f1_score: 0.9506; train_kl_reg_loss: 12637.7507; train_edge_recon_loss: 2584356.5186; train_gene_expr_recon_loss: 599511.6131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3196505.8774; train_optim_loss: 3196505.8774; val_kl_reg_loss: 12371.5171; val_edge_recon_loss: 2624859.7604; val_gene_expr_recon_loss: 600362.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237593.3819; val_optim_loss: 3237593.3819

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 165 min 18 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9879
Val AUPRC score: 0.9861
Val best accuracy score: 0.9494
Val best F1 score: 0.9502
Val gene expr MSE score: 1.5614

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
