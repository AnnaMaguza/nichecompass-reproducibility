None
Run timestamp: 25072023_014655_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '24', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1966960
Number of validation edges: 218551
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9797; val_best_acc_score: 0.9336; val_best_f1_score: 0.9348; train_kl_reg_loss: 14401.9160; train_edge_recon_loss: 2636300.6548; train_gene_expr_recon_loss: 709769.1177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3360471.6895; train_optim_loss: 3360471.6895; val_kl_reg_loss: 12870.5505; val_edge_recon_loss: 2641354.3738; val_gene_expr_recon_loss: 666696.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3320921.6666; val_optim_loss: 3320921.6666
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9847; val_auprc_score: 0.9830; val_best_acc_score: 0.9404; val_best_f1_score: 0.9415; train_kl_reg_loss: 12783.9944; train_edge_recon_loss: 2604232.9054; train_gene_expr_recon_loss: 660206.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3277223.5781; train_optim_loss: 3277223.5781; val_kl_reg_loss: 12452.9766; val_edge_recon_loss: 2632586.0105; val_gene_expr_recon_loss: 654412.7932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3299451.7863; val_optim_loss: 3299451.7863
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9870; val_auprc_score: 0.9854; val_best_acc_score: 0.9462; val_best_f1_score: 0.9471; train_kl_reg_loss: 12641.1798; train_edge_recon_loss: 2597883.9029; train_gene_expr_recon_loss: 652346.5670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3262871.6486; train_optim_loss: 3262871.6486; val_kl_reg_loss: 12372.1193; val_edge_recon_loss: 2625786.5697; val_gene_expr_recon_loss: 648693.2627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3286851.9535; val_optim_loss: 3286851.9535
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9876; val_auprc_score: 0.9859; val_best_acc_score: 0.9482; val_best_f1_score: 0.9491; train_kl_reg_loss: 12545.5336; train_edge_recon_loss: 2594834.9525; train_gene_expr_recon_loss: 648068.8405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3255449.3254; train_optim_loss: 3255449.3254; val_kl_reg_loss: 12172.5853; val_edge_recon_loss: 2625630.8987; val_gene_expr_recon_loss: 646874.0114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284677.4971; val_optim_loss: 3284677.4971
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9886; val_auprc_score: 0.9871; val_best_acc_score: 0.9505; val_best_f1_score: 0.9512; train_kl_reg_loss: 12544.3593; train_edge_recon_loss: 2592505.5274; train_gene_expr_recon_loss: 645857.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250907.0091; train_optim_loss: 3250907.0091; val_kl_reg_loss: 12335.5368; val_edge_recon_loss: 2622788.2292; val_gene_expr_recon_loss: 647754.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282878.1156; val_optim_loss: 3282878.1156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9884; val_auprc_score: 0.9868; val_best_acc_score: 0.9506; val_best_f1_score: 0.9514; train_kl_reg_loss: 12479.4384; train_edge_recon_loss: 2591024.2307; train_gene_expr_recon_loss: 644642.1521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248145.8197; train_optim_loss: 3248145.8197; val_kl_reg_loss: 11849.7546; val_edge_recon_loss: 2620677.8999; val_gene_expr_recon_loss: 644080.7810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276608.4388; val_optim_loss: 3276608.4388
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9514; val_best_f1_score: 0.9522; train_kl_reg_loss: 12474.2673; train_edge_recon_loss: 2589170.7487; train_gene_expr_recon_loss: 643517.7108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3245162.7274; train_optim_loss: 3245162.7274; val_kl_reg_loss: 12386.9749; val_edge_recon_loss: 2619851.2178; val_gene_expr_recon_loss: 642064.4736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274302.6695; val_optim_loss: 3274302.6695
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9890; val_auprc_score: 0.9873; val_best_acc_score: 0.9520; val_best_f1_score: 0.9527; train_kl_reg_loss: 12437.7948; train_edge_recon_loss: 2588113.5068; train_gene_expr_recon_loss: 642953.3599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243504.6610; train_optim_loss: 3243504.6610; val_kl_reg_loss: 12174.5775; val_edge_recon_loss: 2616959.7837; val_gene_expr_recon_loss: 642666.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271800.9997; val_optim_loss: 3271800.9997
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9876; val_best_acc_score: 0.9529; val_best_f1_score: 0.9536; train_kl_reg_loss: 12422.4790; train_edge_recon_loss: 2587568.0664; train_gene_expr_recon_loss: 642095.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242086.1007; train_optim_loss: 3242086.1007; val_kl_reg_loss: 11957.8303; val_edge_recon_loss: 2616415.0196; val_gene_expr_recon_loss: 643708.2504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272081.1030; val_optim_loss: 3272081.1030
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9898; val_auprc_score: 0.9882; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 12428.1866; train_edge_recon_loss: 2586755.5879; train_gene_expr_recon_loss: 641971.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3241155.7064; train_optim_loss: 3241155.7064; val_kl_reg_loss: 11958.6922; val_edge_recon_loss: 2617467.1139; val_gene_expr_recon_loss: 644478.6041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273904.4119; val_optim_loss: 3273904.4119
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9899; val_auprc_score: 0.9885; val_best_acc_score: 0.9543; val_best_f1_score: 0.9550; train_kl_reg_loss: 12413.8231; train_edge_recon_loss: 2585777.8860; train_gene_expr_recon_loss: 641132.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239324.5023; train_optim_loss: 3239324.5023; val_kl_reg_loss: 12172.2769; val_edge_recon_loss: 2615443.8809; val_gene_expr_recon_loss: 641962.2824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269578.4356; val_optim_loss: 3269578.4356
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9897; val_auprc_score: 0.9881; val_best_acc_score: 0.9545; val_best_f1_score: 0.9551; train_kl_reg_loss: 12382.1514; train_edge_recon_loss: 2585681.9340; train_gene_expr_recon_loss: 641262.8395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239326.9218; train_optim_loss: 3239326.9218; val_kl_reg_loss: 12217.7096; val_edge_recon_loss: 2613384.4862; val_gene_expr_recon_loss: 640973.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266575.8662; val_optim_loss: 3266575.8662
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9552; val_best_f1_score: 0.9559; train_kl_reg_loss: 12381.7872; train_edge_recon_loss: 2585195.3373; train_gene_expr_recon_loss: 640870.8909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238448.0143; train_optim_loss: 3238448.0143; val_kl_reg_loss: 11943.0647; val_edge_recon_loss: 2614611.7834; val_gene_expr_recon_loss: 641327.5259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267882.3724; val_optim_loss: 3267882.3724
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9900; val_auprc_score: 0.9881; val_best_acc_score: 0.9552; val_best_f1_score: 0.9558; train_kl_reg_loss: 12368.8560; train_edge_recon_loss: 2584447.6174; train_gene_expr_recon_loss: 640266.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237082.8600; train_optim_loss: 3237082.8600; val_kl_reg_loss: 12199.0843; val_edge_recon_loss: 2614989.7254; val_gene_expr_recon_loss: 641797.9584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268986.7655; val_optim_loss: 3268986.7655
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9905; val_auprc_score: 0.9888; val_best_acc_score: 0.9566; val_best_f1_score: 0.9572; train_kl_reg_loss: 12363.6501; train_edge_recon_loss: 2584089.8589; train_gene_expr_recon_loss: 640129.0426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236582.5496; train_optim_loss: 3236582.5496; val_kl_reg_loss: 12037.9548; val_edge_recon_loss: 2611542.4728; val_gene_expr_recon_loss: 641649.2776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265229.7040; val_optim_loss: 3265229.7040
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9901; val_auprc_score: 0.9883; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 12382.1847; train_edge_recon_loss: 2583268.2512; train_gene_expr_recon_loss: 639667.3972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235317.8310; train_optim_loss: 3235317.8310; val_kl_reg_loss: 12148.8631; val_edge_recon_loss: 2612607.0556; val_gene_expr_recon_loss: 639095.9784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263851.8964; val_optim_loss: 3263851.8964
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9888; val_best_acc_score: 0.9560; val_best_f1_score: 0.9567; train_kl_reg_loss: 12366.0787; train_edge_recon_loss: 2582938.6534; train_gene_expr_recon_loss: 639555.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234859.9219; train_optim_loss: 3234859.9219; val_kl_reg_loss: 12119.4845; val_edge_recon_loss: 2611948.7093; val_gene_expr_recon_loss: 638771.6174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262839.8088; val_optim_loss: 3262839.8088
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9904; val_auprc_score: 0.9887; val_best_acc_score: 0.9571; val_best_f1_score: 0.9578; train_kl_reg_loss: 12389.5349; train_edge_recon_loss: 2582284.4656; train_gene_expr_recon_loss: 639222.9128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233896.9125; train_optim_loss: 3233896.9125; val_kl_reg_loss: 12105.4131; val_edge_recon_loss: 2611255.7087; val_gene_expr_recon_loss: 639467.4177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262828.5430; val_optim_loss: 3262828.5430
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9567; val_best_f1_score: 0.9572; train_kl_reg_loss: 12346.0342; train_edge_recon_loss: 2582081.4258; train_gene_expr_recon_loss: 639259.3475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233686.8095; train_optim_loss: 3233686.8095; val_kl_reg_loss: 12198.7132; val_edge_recon_loss: 2612519.1250; val_gene_expr_recon_loss: 639871.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264589.0960; val_optim_loss: 3264589.0960
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9905; val_auprc_score: 0.9887; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 12353.9829; train_edge_recon_loss: 2582280.6028; train_gene_expr_recon_loss: 639049.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233684.5344; train_optim_loss: 3233684.5344; val_kl_reg_loss: 12203.1183; val_edge_recon_loss: 2612606.0179; val_gene_expr_recon_loss: 638512.3518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263321.4865; val_optim_loss: 3263321.4865
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9905; val_auprc_score: 0.9889; val_best_acc_score: 0.9573; val_best_f1_score: 0.9580; train_kl_reg_loss: 12381.3717; train_edge_recon_loss: 2581954.9476; train_gene_expr_recon_loss: 638792.4794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233128.7970; train_optim_loss: 3233128.7970; val_kl_reg_loss: 11991.5448; val_edge_recon_loss: 2610148.9259; val_gene_expr_recon_loss: 639796.2527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261936.7231; val_optim_loss: 3261936.7231
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9578; val_best_f1_score: 0.9584; train_kl_reg_loss: 12346.3576; train_edge_recon_loss: 2581377.8045; train_gene_expr_recon_loss: 638782.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232506.9897; train_optim_loss: 3232506.9897; val_kl_reg_loss: 12155.3718; val_edge_recon_loss: 2610687.7769; val_gene_expr_recon_loss: 637353.4986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260196.6431; val_optim_loss: 3260196.6431
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9902; val_auprc_score: 0.9884; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 12340.6862; train_edge_recon_loss: 2581440.1040; train_gene_expr_recon_loss: 638191.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231971.9984; train_optim_loss: 3231971.9984; val_kl_reg_loss: 12424.0564; val_edge_recon_loss: 2608248.6557; val_gene_expr_recon_loss: 638538.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259211.0559; val_optim_loss: 3259211.0559
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9579; val_best_f1_score: 0.9585; train_kl_reg_loss: 12381.6604; train_edge_recon_loss: 2580813.7580; train_gene_expr_recon_loss: 638676.4212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231871.8380; train_optim_loss: 3231871.8380; val_kl_reg_loss: 12150.0877; val_edge_recon_loss: 2609559.4028; val_gene_expr_recon_loss: 639380.4283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261089.9207; val_optim_loss: 3261089.9207
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9907; val_auprc_score: 0.9888; val_best_acc_score: 0.9587; val_best_f1_score: 0.9593; train_kl_reg_loss: 12345.4894; train_edge_recon_loss: 2580536.3518; train_gene_expr_recon_loss: 638301.1492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231182.9888; train_optim_loss: 3231182.9888; val_kl_reg_loss: 12232.8276; val_edge_recon_loss: 2608573.0383; val_gene_expr_recon_loss: 637804.4800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258610.3457; val_optim_loss: 3258610.3457
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9883; val_best_acc_score: 0.9581; val_best_f1_score: 0.9588; train_kl_reg_loss: 12381.2529; train_edge_recon_loss: 2580177.9273; train_gene_expr_recon_loss: 637940.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230499.3058; train_optim_loss: 3230499.3058; val_kl_reg_loss: 12191.6249; val_edge_recon_loss: 2609816.6329; val_gene_expr_recon_loss: 639329.7960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261338.0465; val_optim_loss: 3261338.0465
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9908; val_auprc_score: 0.9891; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 12362.4825; train_edge_recon_loss: 2580364.8416; train_gene_expr_recon_loss: 638107.0782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230834.4032; train_optim_loss: 3230834.4032; val_kl_reg_loss: 12175.2252; val_edge_recon_loss: 2608310.5184; val_gene_expr_recon_loss: 638673.0190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259158.7655; val_optim_loss: 3259158.7655
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9591; val_best_f1_score: 0.9597; train_kl_reg_loss: 12356.8458; train_edge_recon_loss: 2579705.5492; train_gene_expr_recon_loss: 638090.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230153.1390; train_optim_loss: 3230153.1390; val_kl_reg_loss: 11832.7753; val_edge_recon_loss: 2609896.8492; val_gene_expr_recon_loss: 638105.5539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259835.1786; val_optim_loss: 3259835.1786
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9906; val_auprc_score: 0.9887; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 12376.6370; train_edge_recon_loss: 2579959.4565; train_gene_expr_recon_loss: 638052.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230388.9178; train_optim_loss: 3230388.9178; val_kl_reg_loss: 12339.3089; val_edge_recon_loss: 2607613.3762; val_gene_expr_recon_loss: 638962.4015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258915.0899; val_optim_loss: 3258915.0899

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9912; val_auprc_score: 0.9895; val_best_acc_score: 0.9595; val_best_f1_score: 0.9600; train_kl_reg_loss: 12695.4275; train_edge_recon_loss: 2577312.1670; train_gene_expr_recon_loss: 626734.9946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216742.5873; train_optim_loss: 3216742.5873; val_kl_reg_loss: 12487.4886; val_edge_recon_loss: 2605893.5343; val_gene_expr_recon_loss: 626367.8848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3244748.9049; val_optim_loss: 3244748.9049
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9916; val_auprc_score: 0.9901; val_best_acc_score: 0.9605; val_best_f1_score: 0.9610; train_kl_reg_loss: 12731.0591; train_edge_recon_loss: 2576809.2626; train_gene_expr_recon_loss: 624645.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214186.0039; train_optim_loss: 3214186.0039; val_kl_reg_loss: 12509.0627; val_edge_recon_loss: 2604504.4819; val_gene_expr_recon_loss: 625937.6964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242951.2386; val_optim_loss: 3242951.2386
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9918; val_auprc_score: 0.9905; val_best_acc_score: 0.9609; val_best_f1_score: 0.9614; train_kl_reg_loss: 12747.9970; train_edge_recon_loss: 2576978.7701; train_gene_expr_recon_loss: 623801.7590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213528.5259; train_optim_loss: 3213528.5259; val_kl_reg_loss: 12524.4408; val_edge_recon_loss: 2603532.5527; val_gene_expr_recon_loss: 624711.2095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240768.2096; val_optim_loss: 3240768.2096
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9917; val_auprc_score: 0.9902; val_best_acc_score: 0.9609; val_best_f1_score: 0.9614; train_kl_reg_loss: 12707.0061; train_edge_recon_loss: 2576454.8622; train_gene_expr_recon_loss: 622553.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211715.6230; train_optim_loss: 3211715.6230; val_kl_reg_loss: 12516.7829; val_edge_recon_loss: 2604005.2207; val_gene_expr_recon_loss: 623336.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239858.1022; val_optim_loss: 3239858.1022
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9915; val_auprc_score: 0.9899; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 12688.6492; train_edge_recon_loss: 2576389.4811; train_gene_expr_recon_loss: 622350.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211428.3525; train_optim_loss: 3211428.3525; val_kl_reg_loss: 12472.4732; val_edge_recon_loss: 2605016.5536; val_gene_expr_recon_loss: 623045.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240534.6092; val_optim_loss: 3240534.6092
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9916; val_auprc_score: 0.9901; val_best_acc_score: 0.9608; val_best_f1_score: 0.9613; train_kl_reg_loss: 12683.1353; train_edge_recon_loss: 2576494.9861; train_gene_expr_recon_loss: 622159.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211337.6979; train_optim_loss: 3211337.6979; val_kl_reg_loss: 12473.6050; val_edge_recon_loss: 2604114.9438; val_gene_expr_recon_loss: 623100.4433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239688.9950; val_optim_loss: 3239688.9950
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9916; val_auprc_score: 0.9899; val_best_acc_score: 0.9607; val_best_f1_score: 0.9613; train_kl_reg_loss: 12647.6597; train_edge_recon_loss: 2576182.6499; train_gene_expr_recon_loss: 622228.3337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211058.6430; train_optim_loss: 3211058.6430; val_kl_reg_loss: 12523.2475; val_edge_recon_loss: 2605370.3618; val_gene_expr_recon_loss: 623009.3246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240902.9324; val_optim_loss: 3240902.9324
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9919; val_auprc_score: 0.9904; val_best_acc_score: 0.9610; val_best_f1_score: 0.9617; train_kl_reg_loss: 12600.3301; train_edge_recon_loss: 2576236.0161; train_gene_expr_recon_loss: 622096.0033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210932.3518; train_optim_loss: 3210932.3518; val_kl_reg_loss: 12336.3783; val_edge_recon_loss: 2603152.5231; val_gene_expr_recon_loss: 622275.0951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237763.9944; val_optim_loss: 3237763.9944
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 12580.7680; train_edge_recon_loss: 2576184.5365; train_gene_expr_recon_loss: 621935.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210700.5387; train_optim_loss: 3210700.5387; val_kl_reg_loss: 12309.9294; val_edge_recon_loss: 2603478.9479; val_gene_expr_recon_loss: 623393.9085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239182.7916; val_optim_loss: 3239182.7916
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9918; val_auprc_score: 0.9904; val_best_acc_score: 0.9614; val_best_f1_score: 0.9619; train_kl_reg_loss: 12533.8378; train_edge_recon_loss: 2576123.4489; train_gene_expr_recon_loss: 621822.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210479.5089; train_optim_loss: 3210479.5089; val_kl_reg_loss: 12317.3760; val_edge_recon_loss: 2603086.9145; val_gene_expr_recon_loss: 622987.7234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238392.0126; val_optim_loss: 3238392.0126
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9916; val_auprc_score: 0.9900; val_best_acc_score: 0.9613; val_best_f1_score: 0.9618; train_kl_reg_loss: 12480.0215; train_edge_recon_loss: 2576198.1736; train_gene_expr_recon_loss: 621535.3484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210213.5436; train_optim_loss: 3210213.5436; val_kl_reg_loss: 12287.5702; val_edge_recon_loss: 2603235.9236; val_gene_expr_recon_loss: 623114.0835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238637.5785; val_optim_loss: 3238637.5785
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9919; val_auprc_score: 0.9905; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 12508.4366; train_edge_recon_loss: 2575600.7189; train_gene_expr_recon_loss: 621613.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209722.5817; train_optim_loss: 3209722.5817; val_kl_reg_loss: 12333.3244; val_edge_recon_loss: 2603792.9406; val_gene_expr_recon_loss: 623916.6547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240042.9245; val_optim_loss: 3240042.9245

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9612; val_best_f1_score: 0.9617; train_kl_reg_loss: 12513.2119; train_edge_recon_loss: 2575504.8429; train_gene_expr_recon_loss: 619968.4835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207986.5377; train_optim_loss: 3207986.5377; val_kl_reg_loss: 12326.7855; val_edge_recon_loss: 2603465.6355; val_gene_expr_recon_loss: 621810.6215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237603.0413; val_optim_loss: 3237603.0413
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9918; val_auprc_score: 0.9902; val_best_acc_score: 0.9614; val_best_f1_score: 0.9619; train_kl_reg_loss: 12511.3840; train_edge_recon_loss: 2575406.7178; train_gene_expr_recon_loss: 620276.4354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208194.5374; train_optim_loss: 3208194.5374; val_kl_reg_loss: 12332.7373; val_edge_recon_loss: 2603547.4359; val_gene_expr_recon_loss: 621798.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237678.3232; val_optim_loss: 3237678.3232
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9919; val_auprc_score: 0.9904; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 12499.6173; train_edge_recon_loss: 2575719.7419; train_gene_expr_recon_loss: 619760.8152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207980.1752; train_optim_loss: 3207980.1752; val_kl_reg_loss: 12311.1194; val_edge_recon_loss: 2601909.0363; val_gene_expr_recon_loss: 620869.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235089.7535; val_optim_loss: 3235089.7535
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9612; val_best_f1_score: 0.9617; train_kl_reg_loss: 12482.3759; train_edge_recon_loss: 2575260.6291; train_gene_expr_recon_loss: 620014.7720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207757.7767; train_optim_loss: 3207757.7767; val_kl_reg_loss: 12311.6085; val_edge_recon_loss: 2603593.5053; val_gene_expr_recon_loss: 621111.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237016.1408; val_optim_loss: 3237016.1408
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9615; val_best_f1_score: 0.9620; train_kl_reg_loss: 12473.9760; train_edge_recon_loss: 2575477.6510; train_gene_expr_recon_loss: 619589.3124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207540.9386; train_optim_loss: 3207540.9386; val_kl_reg_loss: 12305.7591; val_edge_recon_loss: 2602658.3677; val_gene_expr_recon_loss: 621269.5912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236233.7201; val_optim_loss: 3236233.7201
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9918; val_auprc_score: 0.9904; val_best_acc_score: 0.9610; val_best_f1_score: 0.9615; train_kl_reg_loss: 12465.6348; train_edge_recon_loss: 2575201.5934; train_gene_expr_recon_loss: 620015.3342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207682.5611; train_optim_loss: 3207682.5611; val_kl_reg_loss: 12265.6531; val_edge_recon_loss: 2603433.9233; val_gene_expr_recon_loss: 621631.4057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237330.9833; val_optim_loss: 3237330.9833
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9611; val_best_f1_score: 0.9616; train_kl_reg_loss: 12448.9455; train_edge_recon_loss: 2575361.8711; train_gene_expr_recon_loss: 619594.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207405.5344; train_optim_loss: 3207405.5344; val_kl_reg_loss: 12269.0408; val_edge_recon_loss: 2603384.1010; val_gene_expr_recon_loss: 621574.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237227.6402; val_optim_loss: 3237227.6402

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9918; val_auprc_score: 0.9901; val_best_acc_score: 0.9616; val_best_f1_score: 0.9621; train_kl_reg_loss: 12462.8012; train_edge_recon_loss: 2575138.7196; train_gene_expr_recon_loss: 619590.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207192.2140; train_optim_loss: 3207192.2140; val_kl_reg_loss: 12294.2172; val_edge_recon_loss: 2602541.9763; val_gene_expr_recon_loss: 621120.0186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235956.2081; val_optim_loss: 3235956.2081
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9919; val_auprc_score: 0.9903; val_best_acc_score: 0.9616; val_best_f1_score: 0.9621; train_kl_reg_loss: 12465.9661; train_edge_recon_loss: 2575513.9315; train_gene_expr_recon_loss: 619731.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207711.4058; train_optim_loss: 3207711.4058; val_kl_reg_loss: 12310.7249; val_edge_recon_loss: 2601905.9160; val_gene_expr_recon_loss: 621541.0525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235757.6915; val_optim_loss: 3235757.6915
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9612; val_best_f1_score: 0.9617; train_kl_reg_loss: 12457.9908; train_edge_recon_loss: 2575537.8199; train_gene_expr_recon_loss: 619452.8772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207448.6864; train_optim_loss: 3207448.6864; val_kl_reg_loss: 12280.9119; val_edge_recon_loss: 2603044.3334; val_gene_expr_recon_loss: 621753.5856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237078.8358; val_optim_loss: 3237078.8358
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9613; val_best_f1_score: 0.9618; train_kl_reg_loss: 12458.7988; train_edge_recon_loss: 2575688.3065; train_gene_expr_recon_loss: 619386.0024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207533.1060; train_optim_loss: 3207533.1060; val_kl_reg_loss: 12271.4146; val_edge_recon_loss: 2602840.5957; val_gene_expr_recon_loss: 620707.0366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235819.0445; val_optim_loss: 3235819.0445

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 737 min 20 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9919
Val AUPRC score: 0.9904
Val best accuracy score: 0.9612
Val best F1 score: 0.9617
Val gene expr MSE score: 1.6426

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
