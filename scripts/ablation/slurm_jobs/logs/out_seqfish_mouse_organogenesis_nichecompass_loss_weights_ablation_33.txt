None
Run timestamp: 28062023_140430_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 16025
Number of validation nodes: 1781
Number of training edges: 108147
Number of validation edges: 12016
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9365; val_auprc_score: 0.9336; val_best_acc_score: 0.8626; val_best_f1_score: 0.8642; train_kl_reg_loss: 4050.9075; train_edge_recon_loss: 315349.7512; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319400.6609; train_optim_loss: 319400.6609; val_kl_reg_loss: 13527.7191; val_edge_recon_loss: 275871.6042; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 289399.3229; val_optim_loss: 289399.3229
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9761; val_auprc_score: 0.9710; val_best_acc_score: 0.9275; val_best_f1_score: 0.9287; train_kl_reg_loss: 9449.3547; train_edge_recon_loss: 269274.5255; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278723.8819; train_optim_loss: 278723.8819; val_kl_reg_loss: 8020.9202; val_edge_recon_loss: 263617.2396; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271638.1562; val_optim_loss: 271638.1562
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9822; val_auprc_score: 0.9783; val_best_acc_score: 0.9395; val_best_f1_score: 0.9409; train_kl_reg_loss: 7624.2087; train_edge_recon_loss: 265292.9005; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272917.1088; train_optim_loss: 272917.1088; val_kl_reg_loss: 7338.8286; val_edge_recon_loss: 262371.4427; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269710.2708; val_optim_loss: 269710.2708
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9876; val_auprc_score: 0.9857; val_best_acc_score: 0.9487; val_best_f1_score: 0.9494; train_kl_reg_loss: 7252.3032; train_edge_recon_loss: 263379.5353; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270631.8391; train_optim_loss: 270631.8391; val_kl_reg_loss: 7126.9427; val_edge_recon_loss: 261471.0104; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268597.9583; val_optim_loss: 268597.9583
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9887; val_best_acc_score: 0.9573; val_best_f1_score: 0.9578; train_kl_reg_loss: 7097.5930; train_edge_recon_loss: 262287.7309; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269385.3252; train_optim_loss: 269385.3252; val_kl_reg_loss: 6880.3859; val_edge_recon_loss: 259786.3854; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266666.7708; val_optim_loss: 266666.7708
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9589; val_best_f1_score: 0.9597; train_kl_reg_loss: 6957.9686; train_edge_recon_loss: 261444.2604; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268402.2315; train_optim_loss: 268402.2315; val_kl_reg_loss: 6725.1909; val_edge_recon_loss: 259679.3177; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266404.5000; val_optim_loss: 266404.5000
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9916; val_auprc_score: 0.9894; val_best_acc_score: 0.9606; val_best_f1_score: 0.9611; train_kl_reg_loss: 6899.0421; train_edge_recon_loss: 260708.1042; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267607.1447; train_optim_loss: 267607.1447; val_kl_reg_loss: 6692.6969; val_edge_recon_loss: 259173.0312; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265865.7396; val_optim_loss: 265865.7396
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 6831.0141; train_edge_recon_loss: 260796.4844; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267627.4977; train_optim_loss: 267627.4977; val_kl_reg_loss: 6652.9181; val_edge_recon_loss: 258776.7344; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265429.6458; val_optim_loss: 265429.6458
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9926; val_auprc_score: 0.9896; val_best_acc_score: 0.9653; val_best_f1_score: 0.9657; train_kl_reg_loss: 6788.1451; train_edge_recon_loss: 260397.9323; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267186.0787; train_optim_loss: 267186.0787; val_kl_reg_loss: 6675.4458; val_edge_recon_loss: 258401.4844; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265076.9271; val_optim_loss: 265076.9271
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9932; val_auprc_score: 0.9909; val_best_acc_score: 0.9661; val_best_f1_score: 0.9665; train_kl_reg_loss: 6763.5698; train_edge_recon_loss: 260386.2384; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267149.8079; train_optim_loss: 267149.8079; val_kl_reg_loss: 6614.1722; val_edge_recon_loss: 259365.1510; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265979.3125; val_optim_loss: 265979.3125
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9932; val_auprc_score: 0.9905; val_best_acc_score: 0.9670; val_best_f1_score: 0.9674; train_kl_reg_loss: 6744.1755; train_edge_recon_loss: 259835.9942; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266580.1690; train_optim_loss: 266580.1690; val_kl_reg_loss: 6570.7243; val_edge_recon_loss: 258456.0417; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265026.7708; val_optim_loss: 265026.7708
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9939; val_auprc_score: 0.9921; val_best_acc_score: 0.9681; val_best_f1_score: 0.9685; train_kl_reg_loss: 6694.3050; train_edge_recon_loss: 260205.2326; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266899.5394; train_optim_loss: 266899.5394; val_kl_reg_loss: 6647.2949; val_edge_recon_loss: 258697.3385; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265344.6354; val_optim_loss: 265344.6354
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9937; val_auprc_score: 0.9922; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 6705.5762; train_edge_recon_loss: 259641.4381; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266347.0150; train_optim_loss: 266347.0150; val_kl_reg_loss: 6607.3896; val_edge_recon_loss: 259238.5573; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265845.9479; val_optim_loss: 265845.9479
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9934; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 6669.3332; train_edge_recon_loss: 260181.8084; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266851.1435; train_optim_loss: 266851.1435; val_kl_reg_loss: 6510.4245; val_edge_recon_loss: 258372.7292; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264883.1458; val_optim_loss: 264883.1458
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9942; val_auprc_score: 0.9906; val_best_acc_score: 0.9708; val_best_f1_score: 0.9711; train_kl_reg_loss: 6686.2302; train_edge_recon_loss: 259327.7448; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266013.9722; train_optim_loss: 266013.9722; val_kl_reg_loss: 6570.0500; val_edge_recon_loss: 257539.8125; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264109.8646; val_optim_loss: 264109.8646
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 6667.6032; train_edge_recon_loss: 259718.4392; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266386.0417; train_optim_loss: 266386.0417; val_kl_reg_loss: 6542.8856; val_edge_recon_loss: 257275.6198; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263818.5104; val_optim_loss: 263818.5104
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 6657.6043; train_edge_recon_loss: 259241.2598; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265898.8657; train_optim_loss: 265898.8657; val_kl_reg_loss: 6532.5715; val_edge_recon_loss: 258091.0625; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264623.6354; val_optim_loss: 264623.6354
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9942; val_auprc_score: 0.9926; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 6637.9771; train_edge_recon_loss: 259496.6557; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266134.6343; train_optim_loss: 266134.6343; val_kl_reg_loss: 6554.1302; val_edge_recon_loss: 258272.3177; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264826.4479; val_optim_loss: 264826.4479
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9924; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 6647.5756; train_edge_recon_loss: 259272.8819; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265920.4537; train_optim_loss: 265920.4537; val_kl_reg_loss: 6587.9382; val_edge_recon_loss: 257602.1823; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264190.1250; val_optim_loss: 264190.1250
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 6638.7418; train_edge_recon_loss: 259442.9786; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266081.7222; train_optim_loss: 266081.7222; val_kl_reg_loss: 6493.1908; val_edge_recon_loss: 257593.7031; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264086.8958; val_optim_loss: 264086.8958

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 6613.1755; train_edge_recon_loss: 259105.9398; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265719.1123; train_optim_loss: 265719.1123; val_kl_reg_loss: 6549.9764; val_edge_recon_loss: 257880.7135; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264430.6875; val_optim_loss: 264430.6875
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9929; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 6626.6291; train_edge_recon_loss: 259087.9711; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265714.6042; train_optim_loss: 265714.6042; val_kl_reg_loss: 6525.2036; val_edge_recon_loss: 257273.1198; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263798.3229; val_optim_loss: 263798.3229
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 6611.6247; train_edge_recon_loss: 259286.5556; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265898.1829; train_optim_loss: 265898.1829; val_kl_reg_loss: 6506.2817; val_edge_recon_loss: 257680.7240; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264187.0104; val_optim_loss: 264187.0104
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 6621.7533; train_edge_recon_loss: 258816.3310; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265438.0845; train_optim_loss: 265438.0845; val_kl_reg_loss: 6518.9943; val_edge_recon_loss: 257331.7500; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263850.7500; val_optim_loss: 263850.7500
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9957; val_auprc_score: 0.9948; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 6638.2043; train_edge_recon_loss: 258744.9005; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265383.1065; train_optim_loss: 265383.1065; val_kl_reg_loss: 6542.2918; val_edge_recon_loss: 257216.4740; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263758.7604; val_optim_loss: 263758.7604
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9950; val_auprc_score: 0.9925; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 6628.3537; train_edge_recon_loss: 258989.8183; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265618.1736; train_optim_loss: 265618.1736; val_kl_reg_loss: 6537.8566; val_edge_recon_loss: 257170.9844; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263708.8333; val_optim_loss: 263708.8333
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9954; val_auprc_score: 0.9935; val_best_acc_score: 0.9746; val_best_f1_score: 0.9748; train_kl_reg_loss: 6636.6903; train_edge_recon_loss: 259037.2465; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265673.9375; train_optim_loss: 265673.9375; val_kl_reg_loss: 6532.5098; val_edge_recon_loss: 257477.3229; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264009.8333; val_optim_loss: 264009.8333
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 6610.6325; train_edge_recon_loss: 259111.6221; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265722.2535; train_optim_loss: 265722.2535; val_kl_reg_loss: 6524.8932; val_edge_recon_loss: 258032.7396; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264557.6354; val_optim_loss: 264557.6354
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 6619.3476; train_edge_recon_loss: 259320.7477; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265940.0949; train_optim_loss: 265940.0949; val_kl_reg_loss: 6527.2474; val_edge_recon_loss: 257663.3906; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264190.6354; val_optim_loss: 264190.6354
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 6621.3157; train_edge_recon_loss: 259058.8941; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265680.2130; train_optim_loss: 265680.2130; val_kl_reg_loss: 6544.4735; val_edge_recon_loss: 257073.3698; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263617.8438; val_optim_loss: 263617.8438
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9949; val_auprc_score: 0.9929; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 6624.4112; train_edge_recon_loss: 258939.1088; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265563.5208; train_optim_loss: 265563.5208; val_kl_reg_loss: 6528.4264; val_edge_recon_loss: 258120.3385; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264648.7708; val_optim_loss: 264648.7708
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9948; val_auprc_score: 0.9926; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 6618.7558; train_edge_recon_loss: 259116.9884; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265735.7442; train_optim_loss: 265735.7442; val_kl_reg_loss: 6534.0426; val_edge_recon_loss: 258088.3802; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264622.4167; val_optim_loss: 264622.4167
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9955; val_auprc_score: 0.9924; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 6628.1258; train_edge_recon_loss: 258845.2095; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265473.3345; train_optim_loss: 265473.3345; val_kl_reg_loss: 6532.0679; val_edge_recon_loss: 257805.6250; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264337.6875; val_optim_loss: 264337.6875
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 6616.7074; train_edge_recon_loss: 259150.7049; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265767.4144; train_optim_loss: 265767.4144; val_kl_reg_loss: 6528.5270; val_edge_recon_loss: 256935.6510; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263464.1771; val_optim_loss: 263464.1771
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 6628.2797; train_edge_recon_loss: 258754.3883; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265382.6678; train_optim_loss: 265382.6678; val_kl_reg_loss: 6546.6400; val_edge_recon_loss: 256879.1094; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263425.7500; val_optim_loss: 263425.7500
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 6631.7289; train_edge_recon_loss: 259032.4641; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265664.1921; train_optim_loss: 265664.1921; val_kl_reg_loss: 6546.5116; val_edge_recon_loss: 257661.2760; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264207.7917; val_optim_loss: 264207.7917
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9948; val_auprc_score: 0.9927; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 6625.8348; train_edge_recon_loss: 258883.4306; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265509.2639; train_optim_loss: 265509.2639; val_kl_reg_loss: 6531.1772; val_edge_recon_loss: 257088.5208; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263619.6979; val_optim_loss: 263619.6979
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9946; val_auprc_score: 0.9917; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 6622.6521; train_edge_recon_loss: 258886.9722; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265509.6250; train_optim_loss: 265509.6250; val_kl_reg_loss: 6508.2565; val_edge_recon_loss: 258039.2031; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264547.4583; val_optim_loss: 264547.4583
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 6629.8862; train_edge_recon_loss: 258710.4404; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265340.3252; train_optim_loss: 265340.3252; val_kl_reg_loss: 6542.1605; val_edge_recon_loss: 257790.6719; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264332.8333; val_optim_loss: 264332.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 6633.6362; train_edge_recon_loss: 258898.4028; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265532.0382; train_optim_loss: 265532.0382; val_kl_reg_loss: 6533.0864; val_edge_recon_loss: 258147.5990; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264680.6875; val_optim_loss: 264680.6875
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9953; val_auprc_score: 0.9923; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 6631.8235; train_edge_recon_loss: 258956.0110; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265587.8356; train_optim_loss: 265587.8356; val_kl_reg_loss: 6533.1383; val_edge_recon_loss: 257396.8802; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263930.0104; val_optim_loss: 263930.0104
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9951; val_auprc_score: 0.9932; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 6626.7681; train_edge_recon_loss: 258790.6875; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265417.4537; train_optim_loss: 265417.4537; val_kl_reg_loss: 6529.1369; val_edge_recon_loss: 257847.8125; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264376.9583; val_optim_loss: 264376.9583
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 6623.3001; train_edge_recon_loss: 258998.9722; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265622.2720; train_optim_loss: 265622.2720; val_kl_reg_loss: 6528.0894; val_edge_recon_loss: 257538.3490; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264066.4375; val_optim_loss: 264066.4375

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 30 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9958
Val AUPRC score: 0.9949
Val best accuracy score: 0.9755
Val best F1 score: 0.9757
Val gene expr MSE score: 1.7274

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
