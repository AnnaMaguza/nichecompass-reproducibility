None
Run timestamp: 17072023_202607_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9875; val_auprc_score: 0.9877; val_best_acc_score: 0.9420; val_best_f1_score: 0.9422; train_kl_reg_loss: 12139.7295; train_edge_recon_loss: 2736530.4818; train_gene_expr_recon_loss: 21234867.7300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23983537.9351; train_optim_loss: 23983537.9351; val_kl_reg_loss: 14358.3878; val_edge_recon_loss: 2692454.9589; val_gene_expr_recon_loss: 20236736.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22943549.9718; val_optim_loss: 22943549.9718
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9888; val_best_acc_score: 0.9460; val_best_f1_score: 0.9463; train_kl_reg_loss: 15019.9329; train_edge_recon_loss: 2653385.3603; train_gene_expr_recon_loss: 19954060.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22622466.2449; train_optim_loss: 22622466.2449; val_kl_reg_loss: 14143.0212; val_edge_recon_loss: 2672799.8075; val_gene_expr_recon_loss: 19730418.3474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22417361.0423; val_optim_loss: 22417361.0423
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9883; val_auprc_score: 0.9883; val_best_acc_score: 0.9449; val_best_f1_score: 0.9450; train_kl_reg_loss: 15518.6687; train_edge_recon_loss: 2642829.2326; train_gene_expr_recon_loss: 19596907.9508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22255255.8650; train_optim_loss: 22255255.8650; val_kl_reg_loss: 15964.1855; val_edge_recon_loss: 2672532.2160; val_gene_expr_recon_loss: 19557189.2019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22245685.5681; val_optim_loss: 22245685.5681
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9887; val_auprc_score: 0.9886; val_best_acc_score: 0.9459; val_best_f1_score: 0.9461; train_kl_reg_loss: 15721.6983; train_edge_recon_loss: 2636728.6010; train_gene_expr_recon_loss: 19466937.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22119387.5228; train_optim_loss: 22119387.5228; val_kl_reg_loss: 15700.7414; val_edge_recon_loss: 2664222.3204; val_gene_expr_recon_loss: 19453343.5587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22133266.6197; val_optim_loss: 22133266.6197
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9891; val_auprc_score: 0.9888; val_best_acc_score: 0.9473; val_best_f1_score: 0.9475; train_kl_reg_loss: 15824.3479; train_edge_recon_loss: 2633772.3936; train_gene_expr_recon_loss: 19403681.7342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22053278.4783; train_optim_loss: 22053278.4783; val_kl_reg_loss: 16039.5596; val_edge_recon_loss: 2661288.3134; val_gene_expr_recon_loss: 19392701.2488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22070029.1643; val_optim_loss: 22070029.1643
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9890; val_auprc_score: 0.9888; val_best_acc_score: 0.9472; val_best_f1_score: 0.9474; train_kl_reg_loss: 15852.5860; train_edge_recon_loss: 2630804.5455; train_gene_expr_recon_loss: 19376222.0555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22022879.2109; train_optim_loss: 22022879.2109; val_kl_reg_loss: 15959.1557; val_edge_recon_loss: 2656970.4085; val_gene_expr_recon_loss: 19395990.9296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22068920.5728; val_optim_loss: 22068920.5728
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9892; val_auprc_score: 0.9890; val_best_acc_score: 0.9476; val_best_f1_score: 0.9477; train_kl_reg_loss: 15825.0751; train_edge_recon_loss: 2627179.7365; train_gene_expr_recon_loss: 19354597.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21997602.5118; train_optim_loss: 21997602.5118; val_kl_reg_loss: 15808.7634; val_edge_recon_loss: 2655289.2981; val_gene_expr_recon_loss: 19406379.1643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22077477.2113; val_optim_loss: 22077477.2113
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9890; val_auprc_score: 0.9889; val_best_acc_score: 0.9471; val_best_f1_score: 0.9474; train_kl_reg_loss: 15815.3529; train_edge_recon_loss: 2627660.7766; train_gene_expr_recon_loss: 19343934.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21987411.0780; train_optim_loss: 21987411.0780; val_kl_reg_loss: 15506.6713; val_edge_recon_loss: 2653820.1068; val_gene_expr_recon_loss: 19365421.3991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22034748.1690; val_optim_loss: 22034748.1690
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9894; val_auprc_score: 0.9889; val_best_acc_score: 0.9484; val_best_f1_score: 0.9487; train_kl_reg_loss: 15776.9497; train_edge_recon_loss: 2625185.4708; train_gene_expr_recon_loss: 19341205.3543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21982167.7666; train_optim_loss: 21982167.7666; val_kl_reg_loss: 15531.4746; val_edge_recon_loss: 2653658.6526; val_gene_expr_recon_loss: 19341857.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22011048.0188; val_optim_loss: 22011048.0188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9899; val_auprc_score: 0.9897; val_best_acc_score: 0.9497; val_best_f1_score: 0.9499; train_kl_reg_loss: 15747.4008; train_edge_recon_loss: 2625063.2121; train_gene_expr_recon_loss: 19329659.2077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21970469.8210; train_optim_loss: 21970469.8210; val_kl_reg_loss: 15433.3395; val_edge_recon_loss: 2649531.3439; val_gene_expr_recon_loss: 19369535.7465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22034500.4977; val_optim_loss: 22034500.4977
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9893; val_auprc_score: 0.9889; val_best_acc_score: 0.9488; val_best_f1_score: 0.9490; train_kl_reg_loss: 15700.8377; train_edge_recon_loss: 2623877.6310; train_gene_expr_recon_loss: 19320959.8817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21960538.3632; train_optim_loss: 21960538.3632; val_kl_reg_loss: 15904.7061; val_edge_recon_loss: 2652489.4437; val_gene_expr_recon_loss: 19367619.8685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22036014.0751; val_optim_loss: 22036014.0751
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9895; val_auprc_score: 0.9892; val_best_acc_score: 0.9488; val_best_f1_score: 0.9490; train_kl_reg_loss: 15686.7903; train_edge_recon_loss: 2623625.5207; train_gene_expr_recon_loss: 19316605.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21955917.8598; train_optim_loss: 21955917.8598; val_kl_reg_loss: 15609.5698; val_edge_recon_loss: 2650455.7465; val_gene_expr_recon_loss: 19350309.5399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22016374.8920; val_optim_loss: 22016374.8920
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9495; val_best_f1_score: 0.9498; train_kl_reg_loss: 15631.9680; train_edge_recon_loss: 2622530.5789; train_gene_expr_recon_loss: 19311038.8603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21949201.4014; train_optim_loss: 21949201.4014; val_kl_reg_loss: 15269.1292; val_edge_recon_loss: 2646351.9331; val_gene_expr_recon_loss: 19363424.9108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22025045.8873; val_optim_loss: 22025045.8873

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9902; val_auprc_score: 0.9899; val_best_acc_score: 0.9507; val_best_f1_score: 0.9510; train_kl_reg_loss: 16366.1070; train_edge_recon_loss: 2611565.9320; train_gene_expr_recon_loss: 19134687.9895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21762620.0440; train_optim_loss: 21762620.0440; val_kl_reg_loss: 15227.2799; val_edge_recon_loss: 2636518.2254; val_gene_expr_recon_loss: 19187621.2676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21839366.7606; val_optim_loss: 21839366.7606
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9899; val_auprc_score: 0.9895; val_best_acc_score: 0.9500; val_best_f1_score: 0.9502; train_kl_reg_loss: 15385.5717; train_edge_recon_loss: 2609008.7342; train_gene_expr_recon_loss: 19108165.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21732559.3574; train_optim_loss: 21732559.3574; val_kl_reg_loss: 15171.7763; val_edge_recon_loss: 2633596.5763; val_gene_expr_recon_loss: 19169169.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21817937.8216; val_optim_loss: 21817937.8216
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9897; val_auprc_score: 0.9894; val_best_acc_score: 0.9494; val_best_f1_score: 0.9497; train_kl_reg_loss: 15282.4579; train_edge_recon_loss: 2608008.8032; train_gene_expr_recon_loss: 19096299.3417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21719590.5777; train_optim_loss: 21719590.5777; val_kl_reg_loss: 15033.2537; val_edge_recon_loss: 2636786.7559; val_gene_expr_recon_loss: 19180962.2254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21832782.2254; val_optim_loss: 21832782.2254
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9897; val_auprc_score: 0.9893; val_best_acc_score: 0.9498; val_best_f1_score: 0.9500; train_kl_reg_loss: 15214.7109; train_edge_recon_loss: 2606471.7949; train_gene_expr_recon_loss: 19098799.1774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21720485.6797; train_optim_loss: 21720485.6797; val_kl_reg_loss: 14981.3069; val_edge_recon_loss: 2631348.8592; val_gene_expr_recon_loss: 19175288.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21821618.6103; val_optim_loss: 21821618.6103
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9899; val_auprc_score: 0.9895; val_best_acc_score: 0.9501; val_best_f1_score: 0.9501; train_kl_reg_loss: 15178.0029; train_edge_recon_loss: 2606787.1209; train_gene_expr_recon_loss: 19096178.0565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21718143.1826; train_optim_loss: 21718143.1826; val_kl_reg_loss: 14968.8953; val_edge_recon_loss: 2630465.4542; val_gene_expr_recon_loss: 19170831.3615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21816265.7277; val_optim_loss: 21816265.7277
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9497; val_best_f1_score: 0.9499; train_kl_reg_loss: 15172.4852; train_edge_recon_loss: 2605877.4311; train_gene_expr_recon_loss: 19090621.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21711671.4694; train_optim_loss: 21711671.4694; val_kl_reg_loss: 14932.2181; val_edge_recon_loss: 2631430.4671; val_gene_expr_recon_loss: 19170315.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21816678.1690; val_optim_loss: 21816678.1690
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9901; val_auprc_score: 0.9897; val_best_acc_score: 0.9506; val_best_f1_score: 0.9506; train_kl_reg_loss: 15148.1285; train_edge_recon_loss: 2605991.8272; train_gene_expr_recon_loss: 19087770.8844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21708910.8592; train_optim_loss: 21708910.8592; val_kl_reg_loss: 15035.3308; val_edge_recon_loss: 2628791.6467; val_gene_expr_recon_loss: 19152330.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21796157.6056; val_optim_loss: 21796157.6056
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9899; val_auprc_score: 0.9896; val_best_acc_score: 0.9504; val_best_f1_score: 0.9508; train_kl_reg_loss: 15134.9056; train_edge_recon_loss: 2605594.2966; train_gene_expr_recon_loss: 19086955.3396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21707684.5076; train_optim_loss: 21707684.5076; val_kl_reg_loss: 14879.6715; val_edge_recon_loss: 2628764.7899; val_gene_expr_recon_loss: 19162135.9624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21805780.4695; val_optim_loss: 21805780.4695
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9899; val_auprc_score: 0.9894; val_best_acc_score: 0.9500; val_best_f1_score: 0.9503; train_kl_reg_loss: 15115.7996; train_edge_recon_loss: 2605146.4029; train_gene_expr_recon_loss: 19086162.9116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21706425.0738; train_optim_loss: 21706425.0738; val_kl_reg_loss: 14931.3413; val_edge_recon_loss: 2629687.3298; val_gene_expr_recon_loss: 19168250.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21812869.3427; val_optim_loss: 21812869.3427
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9902; val_auprc_score: 0.9898; val_best_acc_score: 0.9504; val_best_f1_score: 0.9508; train_kl_reg_loss: 15127.5451; train_edge_recon_loss: 2605124.0536; train_gene_expr_recon_loss: 19082943.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21703194.9712; train_optim_loss: 21703194.9712; val_kl_reg_loss: 15028.3977; val_edge_recon_loss: 2627060.0904; val_gene_expr_recon_loss: 19171391.2958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21813479.8028; val_optim_loss: 21813479.8028
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9902; val_auprc_score: 0.9898; val_best_acc_score: 0.9505; val_best_f1_score: 0.9509; train_kl_reg_loss: 15117.3314; train_edge_recon_loss: 2604553.5149; train_gene_expr_recon_loss: 19080957.8545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21700628.6886; train_optim_loss: 21700628.6886; val_kl_reg_loss: 14967.0602; val_edge_recon_loss: 2627752.5974; val_gene_expr_recon_loss: 19156989.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21799709.1737; val_optim_loss: 21799709.1737

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9901; val_auprc_score: 0.9897; val_best_acc_score: 0.9504; val_best_f1_score: 0.9507; train_kl_reg_loss: 15289.1668; train_edge_recon_loss: 2604072.4647; train_gene_expr_recon_loss: 19055091.8964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21674453.5207; train_optim_loss: 21674453.5207; val_kl_reg_loss: 15115.3590; val_edge_recon_loss: 2626765.7629; val_gene_expr_recon_loss: 19149481.5305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21791362.6667; val_optim_loss: 21791362.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9901; val_auprc_score: 0.9897; val_best_acc_score: 0.9504; val_best_f1_score: 0.9508; train_kl_reg_loss: 15297.8501; train_edge_recon_loss: 2602577.7113; train_gene_expr_recon_loss: 19048320.8414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21666196.3883; train_optim_loss: 21666196.3883; val_kl_reg_loss: 15080.7974; val_edge_recon_loss: 2626770.1009; val_gene_expr_recon_loss: 19146940.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21788791.6526; val_optim_loss: 21788791.6526
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9898; val_auprc_score: 0.9893; val_best_acc_score: 0.9494; val_best_f1_score: 0.9497; train_kl_reg_loss: 15240.5480; train_edge_recon_loss: 2603325.5191; train_gene_expr_recon_loss: 19048309.6954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21666875.7541; train_optim_loss: 21666875.7541; val_kl_reg_loss: 15007.3308; val_edge_recon_loss: 2627855.8427; val_gene_expr_recon_loss: 19136073.4085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21778936.6291; val_optim_loss: 21778936.6291
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9893; val_best_acc_score: 0.9502; val_best_f1_score: 0.9506; train_kl_reg_loss: 15193.9507; train_edge_recon_loss: 2603450.6968; train_gene_expr_recon_loss: 19050230.8781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21668875.5196; train_optim_loss: 21668875.5196; val_kl_reg_loss: 14971.1860; val_edge_recon_loss: 2627370.2465; val_gene_expr_recon_loss: 19137410.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21779751.6432; val_optim_loss: 21779751.6432
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9494; val_best_f1_score: 0.9497; train_kl_reg_loss: 15175.9770; train_edge_recon_loss: 2602163.8032; train_gene_expr_recon_loss: 19048020.3998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21665360.1769; train_optim_loss: 21665360.1769; val_kl_reg_loss: 14986.3652; val_edge_recon_loss: 2628108.8955; val_gene_expr_recon_loss: 19139754.1972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21782849.5023; val_optim_loss: 21782849.5023
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9901; val_auprc_score: 0.9897; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 15162.1431; train_edge_recon_loss: 2603445.3182; train_gene_expr_recon_loss: 19048103.9979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21666711.4233; train_optim_loss: 21666711.4233; val_kl_reg_loss: 14947.8923; val_edge_recon_loss: 2628875.9272; val_gene_expr_recon_loss: 19148801.9906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21792625.8404; val_optim_loss: 21792625.8404
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9900; val_auprc_score: 0.9897; val_best_acc_score: 0.9505; val_best_f1_score: 0.9506; train_kl_reg_loss: 15145.2483; train_edge_recon_loss: 2602888.3371; train_gene_expr_recon_loss: 19050143.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21668176.7598; train_optim_loss: 21668176.7598; val_kl_reg_loss: 14956.7038; val_edge_recon_loss: 2628060.2066; val_gene_expr_recon_loss: 19136053.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21779070.3474; val_optim_loss: 21779070.3474

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9899; val_auprc_score: 0.9894; val_best_acc_score: 0.9500; val_best_f1_score: 0.9504; train_kl_reg_loss: 15151.4729; train_edge_recon_loss: 2602612.8868; train_gene_expr_recon_loss: 19051221.6054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21668985.9288; train_optim_loss: 21668985.9288; val_kl_reg_loss: 14959.4264; val_edge_recon_loss: 2624566.5775; val_gene_expr_recon_loss: 19143885.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21783411.4648; val_optim_loss: 21783411.4648
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9900; val_auprc_score: 0.9895; val_best_acc_score: 0.9504; val_best_f1_score: 0.9507; train_kl_reg_loss: 15159.6336; train_edge_recon_loss: 2602800.5582; train_gene_expr_recon_loss: 19040501.5144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21658461.6934; train_optim_loss: 21658461.6934; val_kl_reg_loss: 14965.7911; val_edge_recon_loss: 2626069.1092; val_gene_expr_recon_loss: 19135599.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21776634.4413; val_optim_loss: 21776634.4413
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9898; val_auprc_score: 0.9892; val_best_acc_score: 0.9502; val_best_f1_score: 0.9506; train_kl_reg_loss: 15165.4356; train_edge_recon_loss: 2603264.9096; train_gene_expr_recon_loss: 19046322.7556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21664753.1334; train_optim_loss: 21664753.1334; val_kl_reg_loss: 14969.2387; val_edge_recon_loss: 2627750.5117; val_gene_expr_recon_loss: 19142655.7089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21785375.4085; val_optim_loss: 21785375.4085
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9896; val_auprc_score: 0.9891; val_best_acc_score: 0.9501; val_best_f1_score: 0.9504; train_kl_reg_loss: 15170.9302; train_edge_recon_loss: 2602311.4597; train_gene_expr_recon_loss: 19050400.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21667882.6866; train_optim_loss: 21667882.6866; val_kl_reg_loss: 14973.4019; val_edge_recon_loss: 2627875.3685; val_gene_expr_recon_loss: 19113012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21755860.7324; val_optim_loss: 21755860.7324
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9899; val_auprc_score: 0.9894; val_best_acc_score: 0.9499; val_best_f1_score: 0.9503; train_kl_reg_loss: 15168.2546; train_edge_recon_loss: 2602279.6371; train_gene_expr_recon_loss: 19047921.2381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21665369.1282; train_optim_loss: 21665369.1282; val_kl_reg_loss: 14962.4482; val_edge_recon_loss: 2628749.4824; val_gene_expr_recon_loss: 19130488.9014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21774200.7793; val_optim_loss: 21774200.7793
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9897; val_auprc_score: 0.9891; val_best_acc_score: 0.9497; val_best_f1_score: 0.9500; train_kl_reg_loss: 15168.1256; train_edge_recon_loss: 2603016.8161; train_gene_expr_recon_loss: 19043969.0623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21662154.0178; train_optim_loss: 21662154.0178; val_kl_reg_loss: 14969.8297; val_edge_recon_loss: 2628774.3744; val_gene_expr_recon_loss: 19136151.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21779895.8779; val_optim_loss: 21779895.8779
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9901; val_auprc_score: 0.9897; val_best_acc_score: 0.9508; val_best_f1_score: 0.9511; train_kl_reg_loss: 15169.2663; train_edge_recon_loss: 2602189.1504; train_gene_expr_recon_loss: 19039282.2899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21656640.7117; train_optim_loss: 21656640.7117; val_kl_reg_loss: 14963.8253; val_edge_recon_loss: 2624507.5387; val_gene_expr_recon_loss: 19144178.9014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21783650.2911; val_optim_loss: 21783650.2911
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9897; val_auprc_score: 0.9891; val_best_acc_score: 0.9498; val_best_f1_score: 0.9500; train_kl_reg_loss: 15167.2981; train_edge_recon_loss: 2602253.6502; train_gene_expr_recon_loss: 19042845.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21660266.8666; train_optim_loss: 21660266.8666; val_kl_reg_loss: 14971.7711; val_edge_recon_loss: 2627527.7113; val_gene_expr_recon_loss: 19137766.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21780265.8967; val_optim_loss: 21780265.8967

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9499; val_best_f1_score: 0.9502; train_kl_reg_loss: 15169.6747; train_edge_recon_loss: 2603356.7664; train_gene_expr_recon_loss: 19039488.5222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21658014.9482; train_optim_loss: 21658014.9482; val_kl_reg_loss: 14970.7714; val_edge_recon_loss: 2628219.9847; val_gene_expr_recon_loss: 19146504.7042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21789695.4272; val_optim_loss: 21789695.4272
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9899; val_auprc_score: 0.9894; val_best_acc_score: 0.9504; val_best_f1_score: 0.9506; train_kl_reg_loss: 15169.1968; train_edge_recon_loss: 2603230.2185; train_gene_expr_recon_loss: 19046644.7881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21665044.2083; train_optim_loss: 21665044.2083; val_kl_reg_loss: 14968.8744; val_edge_recon_loss: 2627750.1678; val_gene_expr_recon_loss: 19133598.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21776317.7089; val_optim_loss: 21776317.7089
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9899; val_auprc_score: 0.9893; val_best_acc_score: 0.9502; val_best_f1_score: 0.9503; train_kl_reg_loss: 15169.7724; train_edge_recon_loss: 2603068.6605; train_gene_expr_recon_loss: 19044358.2198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21662596.6426; train_optim_loss: 21662596.6426; val_kl_reg_loss: 14972.0463; val_edge_recon_loss: 2627804.6608; val_gene_expr_recon_loss: 19123456.0939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21766232.8357; val_optim_loss: 21766232.8357
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9898; val_auprc_score: 0.9893; val_best_acc_score: 0.9499; val_best_f1_score: 0.9502; train_kl_reg_loss: 15170.3364; train_edge_recon_loss: 2602493.0606; train_gene_expr_recon_loss: 19044821.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21662485.2193; train_optim_loss: 21662485.2193; val_kl_reg_loss: 14969.8983; val_edge_recon_loss: 2626390.6150; val_gene_expr_recon_loss: 19121718.8075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21763079.2488; val_optim_loss: 21763079.2488

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 400 min 31 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9898
Val AUPRC score: 0.9893
Val best accuracy score: 0.9495
Val best F1 score: 0.9497
Val gene expr MSE score: 8.1153

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
