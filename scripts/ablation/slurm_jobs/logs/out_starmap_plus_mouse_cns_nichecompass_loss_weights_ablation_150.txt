None
Run timestamp: 15072023_080812_150.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_150']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9405; val_auprc_score: 0.9350; val_best_acc_score: 0.8590; val_best_f1_score: 0.8620; train_kl_reg_loss: 79066.6344; train_edge_recon_loss: 3190007.3499; train_gene_expr_recon_loss: 11576069.7011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14845143.6712; train_optim_loss: 14845143.6712; val_kl_reg_loss: 94128.2597; val_edge_recon_loss: 2866773.7134; val_gene_expr_recon_loss: 10643411.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13604313.2927; val_optim_loss: 13604313.2927
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9705; val_auprc_score: 0.9635; val_best_acc_score: 0.9166; val_best_f1_score: 0.9186; train_kl_reg_loss: 85984.6979; train_edge_recon_loss: 2791767.4192; train_gene_expr_recon_loss: 10408381.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13286133.2147; train_optim_loss: 13286133.2147; val_kl_reg_loss: 78477.8478; val_edge_recon_loss: 2744356.7622; val_gene_expr_recon_loss: 10280711.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13103545.8780; val_optim_loss: 13103545.8780
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9760; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 77257.8522; train_edge_recon_loss: 2709073.7500; train_gene_expr_recon_loss: 10137214.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12923546.5598; train_optim_loss: 12923546.5598; val_kl_reg_loss: 72297.1595; val_edge_recon_loss: 2701458.5976; val_gene_expr_recon_loss: 10081843.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12855598.9756; val_optim_loss: 12855598.9756
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9839; val_auprc_score: 0.9788; val_best_acc_score: 0.9485; val_best_f1_score: 0.9496; train_kl_reg_loss: 70652.2732; train_edge_recon_loss: 2678394.4321; train_gene_expr_recon_loss: 9953891.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12702938.0435; train_optim_loss: 12702938.0435; val_kl_reg_loss: 66322.1678; val_edge_recon_loss: 2682602.9756; val_gene_expr_recon_loss: 9931529.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12680454.5854; val_optim_loss: 12680454.5854
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9852; val_auprc_score: 0.9806; val_best_acc_score: 0.9521; val_best_f1_score: 0.9530; train_kl_reg_loss: 65260.7559; train_edge_recon_loss: 2663489.7711; train_gene_expr_recon_loss: 9803672.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12532422.7228; train_optim_loss: 12532422.7228; val_kl_reg_loss: 61793.2720; val_edge_recon_loss: 2669412.8720; val_gene_expr_recon_loss: 9786048.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12517254.7317; val_optim_loss: 12517254.7317
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9857; val_auprc_score: 0.9810; val_best_acc_score: 0.9536; val_best_f1_score: 0.9546; train_kl_reg_loss: 61032.7976; train_edge_recon_loss: 2656143.0034; train_gene_expr_recon_loss: 9687519.8505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12404695.6766; train_optim_loss: 12404695.6766; val_kl_reg_loss: 57384.9014; val_edge_recon_loss: 2662291.2012; val_gene_expr_recon_loss: 9704187.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12423863.6341; val_optim_loss: 12423863.6341
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9865; val_auprc_score: 0.9826; val_best_acc_score: 0.9552; val_best_f1_score: 0.9561; train_kl_reg_loss: 57380.3658; train_edge_recon_loss: 2650117.2989; train_gene_expr_recon_loss: 9593044.6630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12300542.3207; train_optim_loss: 12300542.3207; val_kl_reg_loss: 55036.4264; val_edge_recon_loss: 2658681.2073; val_gene_expr_recon_loss: 9627445.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12341162.7317; val_optim_loss: 12341162.7317
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9868; val_auprc_score: 0.9829; val_best_acc_score: 0.9550; val_best_f1_score: 0.9559; train_kl_reg_loss: 54670.9932; train_edge_recon_loss: 2645829.2548; train_gene_expr_recon_loss: 9506229.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12206729.8424; train_optim_loss: 12206729.8424; val_kl_reg_loss: 52568.0363; val_edge_recon_loss: 2651652.2866; val_gene_expr_recon_loss: 9546509.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12250729.9756; val_optim_loss: 12250729.9756
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9877; val_auprc_score: 0.9843; val_best_acc_score: 0.9570; val_best_f1_score: 0.9578; train_kl_reg_loss: 52704.6244; train_edge_recon_loss: 2640874.2935; train_gene_expr_recon_loss: 9433653.2554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12127232.1766; train_optim_loss: 12127232.1766; val_kl_reg_loss: 50370.6263; val_edge_recon_loss: 2649388.1524; val_gene_expr_recon_loss: 9500471.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12200230.1951; val_optim_loss: 12200230.1951
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9848; val_best_acc_score: 0.9561; val_best_f1_score: 0.9571; train_kl_reg_loss: 51041.3292; train_edge_recon_loss: 2637994.5611; train_gene_expr_recon_loss: 9362909.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12051945.6440; train_optim_loss: 12051945.6440; val_kl_reg_loss: 49617.6723; val_edge_recon_loss: 2649647.3171; val_gene_expr_recon_loss: 9462080.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12161345.5122; val_optim_loss: 12161345.5122
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9849; val_best_acc_score: 0.9571; val_best_f1_score: 0.9580; train_kl_reg_loss: 49687.5254; train_edge_recon_loss: 2635143.1583; train_gene_expr_recon_loss: 9304292.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11989123.0788; train_optim_loss: 11989123.0788; val_kl_reg_loss: 48283.0702; val_edge_recon_loss: 2641244.8110; val_gene_expr_recon_loss: 9440895.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12130423.4390; val_optim_loss: 12130423.4390
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9857; val_best_acc_score: 0.9578; val_best_f1_score: 0.9586; train_kl_reg_loss: 48673.9863; train_edge_recon_loss: 2631859.8105; train_gene_expr_recon_loss: 9262999.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11943533.3179; train_optim_loss: 11943533.3179; val_kl_reg_loss: 47101.8213; val_edge_recon_loss: 2642388.1524; val_gene_expr_recon_loss: 9434659.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12124149.5610; val_optim_loss: 12124149.5610
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9889; val_auprc_score: 0.9860; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 47666.9354; train_edge_recon_loss: 2630673.5387; train_gene_expr_recon_loss: 9219455.6848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11897796.1386; train_optim_loss: 11897796.1386; val_kl_reg_loss: 46611.3796; val_edge_recon_loss: 2638433.2378; val_gene_expr_recon_loss: 9395713.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12080757.6341; val_optim_loss: 12080757.6341
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9887; val_auprc_score: 0.9860; val_best_acc_score: 0.9579; val_best_f1_score: 0.9586; train_kl_reg_loss: 46923.8248; train_edge_recon_loss: 2626688.2724; train_gene_expr_recon_loss: 9181558.2065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11855170.3288; train_optim_loss: 11855170.3288; val_kl_reg_loss: 46164.5932; val_edge_recon_loss: 2639838.8354; val_gene_expr_recon_loss: 9410159.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12096162.9024; val_optim_loss: 12096162.9024
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9892; val_auprc_score: 0.9865; val_best_acc_score: 0.9585; val_best_f1_score: 0.9594; train_kl_reg_loss: 46267.9590; train_edge_recon_loss: 2625109.8662; train_gene_expr_recon_loss: 9141213.9674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11812591.8016; train_optim_loss: 11812591.8016; val_kl_reg_loss: 45281.9175; val_edge_recon_loss: 2638624.4939; val_gene_expr_recon_loss: 9363997.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12047903.9756; val_optim_loss: 12047903.9756
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9889; val_auprc_score: 0.9858; val_best_acc_score: 0.9584; val_best_f1_score: 0.9593; train_kl_reg_loss: 45799.3417; train_edge_recon_loss: 2623337.3655; train_gene_expr_recon_loss: 9111112.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11780249.1603; train_optim_loss: 11780249.1603; val_kl_reg_loss: 44535.0004; val_edge_recon_loss: 2637636.9695; val_gene_expr_recon_loss: 9374121.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12056293.8293; val_optim_loss: 12056293.8293
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9593; val_best_f1_score: 0.9602; train_kl_reg_loss: 45338.6903; train_edge_recon_loss: 2621113.9341; train_gene_expr_recon_loss: 9087566.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11754018.7582; train_optim_loss: 11754018.7582; val_kl_reg_loss: 44756.0944; val_edge_recon_loss: 2631398.4207; val_gene_expr_recon_loss: 9361675.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12037830.1951; val_optim_loss: 12037830.1951
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9888; val_auprc_score: 0.9862; val_best_acc_score: 0.9593; val_best_f1_score: 0.9602; train_kl_reg_loss: 44763.5583; train_edge_recon_loss: 2621862.5224; train_gene_expr_recon_loss: 9064260.7704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11730886.8505; train_optim_loss: 11730886.8505; val_kl_reg_loss: 43930.5216; val_edge_recon_loss: 2629572.0122; val_gene_expr_recon_loss: 9358033.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12031536.4146; val_optim_loss: 12031536.4146
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9863; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 44366.2832; train_edge_recon_loss: 2619365.9674; train_gene_expr_recon_loss: 9036509.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11700241.4701; train_optim_loss: 11700241.4701; val_kl_reg_loss: 43773.2585; val_edge_recon_loss: 2632402.6524; val_gene_expr_recon_loss: 9380728.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12056904.5122; val_optim_loss: 12056904.5122
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 44073.6886; train_edge_recon_loss: 2618694.7330; train_gene_expr_recon_loss: 9009561.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11672330.2174; train_optim_loss: 11672330.2174; val_kl_reg_loss: 43185.5916; val_edge_recon_loss: 2628240.5305; val_gene_expr_recon_loss: 9344185.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12015611.1707; val_optim_loss: 12015611.1707
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9901; val_auprc_score: 0.9879; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 43702.9860; train_edge_recon_loss: 2617811.5272; train_gene_expr_recon_loss: 8998011.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11659525.8533; train_optim_loss: 11659525.8533; val_kl_reg_loss: 42792.8863; val_edge_recon_loss: 2627098.6402; val_gene_expr_recon_loss: 9376355.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12046246.6829; val_optim_loss: 12046246.6829
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9895; val_auprc_score: 0.9870; val_best_acc_score: 0.9616; val_best_f1_score: 0.9624; train_kl_reg_loss: 43341.7572; train_edge_recon_loss: 2616608.4090; train_gene_expr_recon_loss: 8987742.0068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11647692.1875; train_optim_loss: 11647692.1875; val_kl_reg_loss: 42313.0361; val_edge_recon_loss: 2625341.8232; val_gene_expr_recon_loss: 9355380.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12023034.9756; val_optim_loss: 12023034.9756
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9891; val_auprc_score: 0.9863; val_best_acc_score: 0.9602; val_best_f1_score: 0.9612; train_kl_reg_loss: 42994.7905; train_edge_recon_loss: 2617570.0652; train_gene_expr_recon_loss: 8966063.0435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11626627.8913; train_optim_loss: 11626627.8913; val_kl_reg_loss: 42503.4464; val_edge_recon_loss: 2628963.6829; val_gene_expr_recon_loss: 9374534.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12046001.8537; val_optim_loss: 12046001.8537
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9891; val_auprc_score: 0.9864; val_best_acc_score: 0.9602; val_best_f1_score: 0.9610; train_kl_reg_loss: 42881.0598; train_edge_recon_loss: 2615208.3770; train_gene_expr_recon_loss: 8946847.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11604936.8451; train_optim_loss: 11604936.8451; val_kl_reg_loss: 42345.9215; val_edge_recon_loss: 2629148.4451; val_gene_expr_recon_loss: 9381546.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12053040.3415; val_optim_loss: 12053040.3415

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9895; val_auprc_score: 0.9870; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 43632.4474; train_edge_recon_loss: 2613352.5312; train_gene_expr_recon_loss: 8865061.9823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11522046.9701; train_optim_loss: 11522046.9701; val_kl_reg_loss: 42878.8892; val_edge_recon_loss: 2627167.6768; val_gene_expr_recon_loss: 9324537.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11994583.5366; val_optim_loss: 11994583.5366
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9890; val_auprc_score: 0.9859; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 43648.5998; train_edge_recon_loss: 2610378.9212; train_gene_expr_recon_loss: 8861240.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11515267.7120; train_optim_loss: 11515267.7120; val_kl_reg_loss: 42824.2936; val_edge_recon_loss: 2623898.4878; val_gene_expr_recon_loss: 9340191.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12006914.1463; val_optim_loss: 12006914.1463
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9604; val_best_f1_score: 0.9612; train_kl_reg_loss: 43585.8019; train_edge_recon_loss: 2612314.1793; train_gene_expr_recon_loss: 8864919.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11520819.0489; train_optim_loss: 11520819.0489; val_kl_reg_loss: 42723.5191; val_edge_recon_loss: 2626324.8415; val_gene_expr_recon_loss: 9342948.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12011996.4146; val_optim_loss: 12011996.4146
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9895; val_auprc_score: 0.9866; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 43590.7781; train_edge_recon_loss: 2611170.4986; train_gene_expr_recon_loss: 8859657.3668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11514418.6250; train_optim_loss: 11514418.6250; val_kl_reg_loss: 42725.8849; val_edge_recon_loss: 2625184.9756; val_gene_expr_recon_loss: 9337425.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12005336.5610; val_optim_loss: 12005336.5610
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9862; val_best_acc_score: 0.9600; val_best_f1_score: 0.9609; train_kl_reg_loss: 43565.1013; train_edge_recon_loss: 2611263.4450; train_gene_expr_recon_loss: 8854792.3152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11509620.8315; train_optim_loss: 11509620.8315; val_kl_reg_loss: 42840.1243; val_edge_recon_loss: 2622842.0976; val_gene_expr_recon_loss: 9348866.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12014548.4146; val_optim_loss: 12014548.4146

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9894; val_auprc_score: 0.9866; val_best_acc_score: 0.9614; val_best_f1_score: 0.9621; train_kl_reg_loss: 43622.6707; train_edge_recon_loss: 2611839.1175; train_gene_expr_recon_loss: 8838767.4552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11494229.1875; train_optim_loss: 11494229.1875; val_kl_reg_loss: 42730.0715; val_edge_recon_loss: 2622052.6829; val_gene_expr_recon_loss: 9330561.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11995343.8049; val_optim_loss: 11995343.8049
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9892; val_auprc_score: 0.9867; val_best_acc_score: 0.9606; val_best_f1_score: 0.9614; train_kl_reg_loss: 43603.9303; train_edge_recon_loss: 2610580.8838; train_gene_expr_recon_loss: 8834346.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11488531.3587; train_optim_loss: 11488531.3587; val_kl_reg_loss: 42754.4788; val_edge_recon_loss: 2624125.8963; val_gene_expr_recon_loss: 9327598.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11994478.6829; val_optim_loss: 11994478.6829
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 43608.2931; train_edge_recon_loss: 2610645.9586; train_gene_expr_recon_loss: 8842792.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11497046.4538; train_optim_loss: 11497046.4538; val_kl_reg_loss: 42727.1080; val_edge_recon_loss: 2627445.7683; val_gene_expr_recon_loss: 9333902.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12004075.3171; val_optim_loss: 12004075.3171
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9896; val_auprc_score: 0.9870; val_best_acc_score: 0.9618; val_best_f1_score: 0.9627; train_kl_reg_loss: 43610.4009; train_edge_recon_loss: 2610724.5353; train_gene_expr_recon_loss: 8836878.2310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11491213.2174; train_optim_loss: 11491213.2174; val_kl_reg_loss: 42735.6889; val_edge_recon_loss: 2623443.7866; val_gene_expr_recon_loss: 9355959.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12022138.5610; val_optim_loss: 12022138.5610
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9900; val_auprc_score: 0.9877; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 43613.7782; train_edge_recon_loss: 2610842.1535; train_gene_expr_recon_loss: 8844778.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11499234.1712; train_optim_loss: 11499234.1712; val_kl_reg_loss: 42683.4425; val_edge_recon_loss: 2618793.5732; val_gene_expr_recon_loss: 9341293.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12002770.7073; val_optim_loss: 12002770.7073
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9890; val_auprc_score: 0.9858; val_best_acc_score: 0.9598; val_best_f1_score: 0.9608; train_kl_reg_loss: 43577.6655; train_edge_recon_loss: 2610322.7385; train_gene_expr_recon_loss: 8838844.9728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11492745.3668; train_optim_loss: 11492745.3668; val_kl_reg_loss: 42742.6423; val_edge_recon_loss: 2625327.1037; val_gene_expr_recon_loss: 9305959.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11974029.6585; val_optim_loss: 11974029.6585
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 43581.2023; train_edge_recon_loss: 2610544.2031; train_gene_expr_recon_loss: 8838709.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11492834.4592; train_optim_loss: 11492834.4592; val_kl_reg_loss: 42727.6162; val_edge_recon_loss: 2625608.2500; val_gene_expr_recon_loss: 9326818.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11995154.3415; val_optim_loss: 11995154.3415
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9899; val_auprc_score: 0.9871; val_best_acc_score: 0.9616; val_best_f1_score: 0.9624; train_kl_reg_loss: 43585.3613; train_edge_recon_loss: 2611092.2099; train_gene_expr_recon_loss: 8838309.6332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11492987.1902; train_optim_loss: 11492987.1902; val_kl_reg_loss: 42729.4677; val_edge_recon_loss: 2623664.2134; val_gene_expr_recon_loss: 9312192.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11978586.1463; val_optim_loss: 11978586.1463
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9868; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 43566.8022; train_edge_recon_loss: 2610169.2058; train_gene_expr_recon_loss: 8838473.8682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11492209.8723; train_optim_loss: 11492209.8723; val_kl_reg_loss: 42726.2599; val_edge_recon_loss: 2623280.2866; val_gene_expr_recon_loss: 9318909.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11984916.3659; val_optim_loss: 11984916.3659
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9897; val_auprc_score: 0.9871; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 43595.3991; train_edge_recon_loss: 2611189.2466; train_gene_expr_recon_loss: 8840502.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11495286.8451; train_optim_loss: 11495286.8451; val_kl_reg_loss: 42821.3437; val_edge_recon_loss: 2621478.9939; val_gene_expr_recon_loss: 9360531.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12024832.0488; val_optim_loss: 12024832.0488

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9892; val_auprc_score: 0.9866; val_best_acc_score: 0.9608; val_best_f1_score: 0.9616; train_kl_reg_loss: 43608.2805; train_edge_recon_loss: 2610653.9952; train_gene_expr_recon_loss: 8839121.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11493383.5489; train_optim_loss: 11493383.5489; val_kl_reg_loss: 42706.0277; val_edge_recon_loss: 2626425.6585; val_gene_expr_recon_loss: 9348304.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12017436.4634; val_optim_loss: 12017436.4634
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9902; val_auprc_score: 0.9880; val_best_acc_score: 0.9618; val_best_f1_score: 0.9627; train_kl_reg_loss: 43599.2363; train_edge_recon_loss: 2610659.1562; train_gene_expr_recon_loss: 8832981.9457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11487240.3424; train_optim_loss: 11487240.3424; val_kl_reg_loss: 42756.3962; val_edge_recon_loss: 2621979.4512; val_gene_expr_recon_loss: 9342820.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12007556.3415; val_optim_loss: 12007556.3415
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9897; val_auprc_score: 0.9871; val_best_acc_score: 0.9616; val_best_f1_score: 0.9623; train_kl_reg_loss: 43599.6008; train_edge_recon_loss: 2612281.7432; train_gene_expr_recon_loss: 8838196.0421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11494077.3804; train_optim_loss: 11494077.3804; val_kl_reg_loss: 42663.8134; val_edge_recon_loss: 2622747.3232; val_gene_expr_recon_loss: 9316887.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11982298.5610; val_optim_loss: 11982298.5610
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9895; val_auprc_score: 0.9868; val_best_acc_score: 0.9617; val_best_f1_score: 0.9625; train_kl_reg_loss: 43604.2597; train_edge_recon_loss: 2610152.5435; train_gene_expr_recon_loss: 8840781.3546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11494538.1467; train_optim_loss: 11494538.1467; val_kl_reg_loss: 42699.2520; val_edge_recon_loss: 2622683.0000; val_gene_expr_recon_loss: 9308766.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11974148.7317; val_optim_loss: 11974148.7317

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 118 min 40 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9869
Val best accuracy score: 0.9609
Val best F1 score: 0.9618
Val gene expr MSE score: 0.6277

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
