None
Run timestamp: 13072023_220005_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9824; val_auprc_score: 0.9793; val_best_acc_score: 0.9366; val_best_f1_score: 0.9382; train_kl_reg_loss: 19110.9439; train_edge_recon_loss: 2668216.8269; train_gene_expr_recon_loss: 739132.9636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3426460.7330; train_optim_loss: 3426460.7330; val_kl_reg_loss: 16088.1734; val_edge_recon_loss: 2634245.3232; val_gene_expr_recon_loss: 685576.8423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3335910.3423; val_optim_loss: 3335910.3423
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9853; val_best_acc_score: 0.9499; val_best_f1_score: 0.9510; train_kl_reg_loss: 15086.0284; train_edge_recon_loss: 2612145.8519; train_gene_expr_recon_loss: 677993.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3305225.8150; train_optim_loss: 3305225.8150; val_kl_reg_loss: 14130.2715; val_edge_recon_loss: 2625175.6010; val_gene_expr_recon_loss: 667766.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3307072.5592; val_optim_loss: 3307072.5592
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9909; val_auprc_score: 0.9889; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 13703.2812; train_edge_recon_loss: 2602117.5657; train_gene_expr_recon_loss: 666125.2272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3281946.0771; train_optim_loss: 3281946.0771; val_kl_reg_loss: 13338.7713; val_edge_recon_loss: 2607012.1307; val_gene_expr_recon_loss: 661025.4053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281376.3031; val_optim_loss: 3281376.3031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 12971.2677; train_edge_recon_loss: 2594295.8722; train_gene_expr_recon_loss: 661102.7977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3268369.9332; train_optim_loss: 3268369.9332; val_kl_reg_loss: 12657.3093; val_edge_recon_loss: 2602590.9878; val_gene_expr_recon_loss: 658419.3253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273667.6185; val_optim_loss: 3273667.6185
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9923; val_auprc_score: 0.9905; val_best_acc_score: 0.9642; val_best_f1_score: 0.9646; train_kl_reg_loss: 12566.1924; train_edge_recon_loss: 2589707.0907; train_gene_expr_recon_loss: 658231.1565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3260504.4439; train_optim_loss: 3260504.4439; val_kl_reg_loss: 12407.8758; val_edge_recon_loss: 2600536.8319; val_gene_expr_recon_loss: 657489.6076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270434.3118; val_optim_loss: 3270434.3118
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9910; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 12319.1737; train_edge_recon_loss: 2586418.8411; train_gene_expr_recon_loss: 656415.5310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3255153.5450; train_optim_loss: 3255153.5450; val_kl_reg_loss: 12154.4245; val_edge_recon_loss: 2598847.8815; val_gene_expr_recon_loss: 655217.0878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266219.3990; val_optim_loss: 3266219.3990
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9928; val_auprc_score: 0.9912; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 12136.4429; train_edge_recon_loss: 2584632.9847; train_gene_expr_recon_loss: 654805.5428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3251574.9690; train_optim_loss: 3251574.9690; val_kl_reg_loss: 12108.4623; val_edge_recon_loss: 2593935.8868; val_gene_expr_recon_loss: 652976.8478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259021.1986; val_optim_loss: 3259021.1986
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9919; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 11971.7077; train_edge_recon_loss: 2582719.2976; train_gene_expr_recon_loss: 653955.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248646.5377; train_optim_loss: 3248646.5377; val_kl_reg_loss: 11609.0126; val_edge_recon_loss: 2591940.5801; val_gene_expr_recon_loss: 653441.6045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256991.1969; val_optim_loss: 3256991.1969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 11818.9220; train_edge_recon_loss: 2581752.9821; train_gene_expr_recon_loss: 652630.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3246202.3802; train_optim_loss: 3246202.3802; val_kl_reg_loss: 11574.5770; val_edge_recon_loss: 2590267.0383; val_gene_expr_recon_loss: 651776.3855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253618.0035; val_optim_loss: 3253618.0035
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 11692.2848; train_edge_recon_loss: 2580502.8460; train_gene_expr_recon_loss: 652469.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244664.9033; train_optim_loss: 3244664.9033; val_kl_reg_loss: 11420.5291; val_edge_recon_loss: 2589081.7613; val_gene_expr_recon_loss: 651706.2605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252208.5497; val_optim_loss: 3252208.5497
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9705; val_best_f1_score: 0.9708; train_kl_reg_loss: 11597.2321; train_edge_recon_loss: 2578618.3991; train_gene_expr_recon_loss: 651828.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242044.1124; train_optim_loss: 3242044.1124; val_kl_reg_loss: 11718.3336; val_edge_recon_loss: 2591541.6429; val_gene_expr_recon_loss: 651291.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254551.3598; val_optim_loss: 3254551.3598
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 11486.2139; train_edge_recon_loss: 2577781.7210; train_gene_expr_recon_loss: 651216.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240483.9609; train_optim_loss: 3240483.9609; val_kl_reg_loss: 11453.1369; val_edge_recon_loss: 2585563.2030; val_gene_expr_recon_loss: 651308.8454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248325.1855; val_optim_loss: 3248325.1855
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 11429.0786; train_edge_recon_loss: 2577028.5097; train_gene_expr_recon_loss: 650784.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239242.4738; train_optim_loss: 3239242.4738; val_kl_reg_loss: 11268.0920; val_edge_recon_loss: 2584531.4774; val_gene_expr_recon_loss: 650903.8804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246703.4408; val_optim_loss: 3246703.4408
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 11378.6695; train_edge_recon_loss: 2576893.8655; train_gene_expr_recon_loss: 650615.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238888.1694; train_optim_loss: 3238888.1694; val_kl_reg_loss: 11112.6579; val_edge_recon_loss: 2584484.7718; val_gene_expr_recon_loss: 650549.1257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246146.5488; val_optim_loss: 3246146.5488
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 11308.9636; train_edge_recon_loss: 2575370.9822; train_gene_expr_recon_loss: 650141.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236821.7552; train_optim_loss: 3236821.7552; val_kl_reg_loss: 11054.6896; val_edge_recon_loss: 2580870.8693; val_gene_expr_recon_loss: 650848.5666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242774.1211; val_optim_loss: 3242774.1211
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 11279.9682; train_edge_recon_loss: 2574520.1016; train_gene_expr_recon_loss: 649802.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235602.4567; train_optim_loss: 3235602.4567; val_kl_reg_loss: 11133.3188; val_edge_recon_loss: 2584517.3772; val_gene_expr_recon_loss: 650326.3029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245977.0044; val_optim_loss: 3245977.0044
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 11221.8469; train_edge_recon_loss: 2574244.8658; train_gene_expr_recon_loss: 649445.1524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234911.8648; train_optim_loss: 3234911.8648; val_kl_reg_loss: 11447.4897; val_edge_recon_loss: 2584418.9652; val_gene_expr_recon_loss: 649293.3898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245159.8510; val_optim_loss: 3245159.8510
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 11186.3170; train_edge_recon_loss: 2572745.5205; train_gene_expr_recon_loss: 649372.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233304.3504; train_optim_loss: 3233304.3504; val_kl_reg_loss: 11316.6118; val_edge_recon_loss: 2581509.3293; val_gene_expr_recon_loss: 650188.1601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243014.1010; val_optim_loss: 3243014.1010
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 11165.8932; train_edge_recon_loss: 2572359.5089; train_gene_expr_recon_loss: 648991.0657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232516.4694; train_optim_loss: 3232516.4694; val_kl_reg_loss: 10969.6241; val_edge_recon_loss: 2578511.4190; val_gene_expr_recon_loss: 650277.5531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239758.5984; val_optim_loss: 3239758.5984
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 11151.4695; train_edge_recon_loss: 2571834.7713; train_gene_expr_recon_loss: 648886.7111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231872.9528; train_optim_loss: 3231872.9528; val_kl_reg_loss: 11212.7376; val_edge_recon_loss: 2576844.1054; val_gene_expr_recon_loss: 650311.3931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238368.2282; val_optim_loss: 3238368.2282
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 11124.4034; train_edge_recon_loss: 2571796.9956; train_gene_expr_recon_loss: 648935.8654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231857.2686; train_optim_loss: 3231857.2686; val_kl_reg_loss: 10772.1866; val_edge_recon_loss: 2579260.5636; val_gene_expr_recon_loss: 649747.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239779.7648; val_optim_loss: 3239779.7648
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 11099.2059; train_edge_recon_loss: 2571336.6911; train_gene_expr_recon_loss: 648555.7636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230991.6577; train_optim_loss: 3230991.6577; val_kl_reg_loss: 11272.5921; val_edge_recon_loss: 2578462.7003; val_gene_expr_recon_loss: 649113.3256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238848.6159; val_optim_loss: 3238848.6159
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 11090.1281; train_edge_recon_loss: 2570174.4151; train_gene_expr_recon_loss: 648532.9346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229797.4770; train_optim_loss: 3229797.4770; val_kl_reg_loss: 11127.2026; val_edge_recon_loss: 2576493.7657; val_gene_expr_recon_loss: 649183.4031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236804.3641; val_optim_loss: 3236804.3641
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 11074.3904; train_edge_recon_loss: 2569234.7799; train_gene_expr_recon_loss: 648565.6077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228874.7770; train_optim_loss: 3228874.7770; val_kl_reg_loss: 11230.3472; val_edge_recon_loss: 2576972.7962; val_gene_expr_recon_loss: 649676.8034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237879.9538; val_optim_loss: 3237879.9538
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 11054.0496; train_edge_recon_loss: 2569403.7488; train_gene_expr_recon_loss: 647999.5472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228457.3456; train_optim_loss: 3228457.3456; val_kl_reg_loss: 10884.9231; val_edge_recon_loss: 2576345.9077; val_gene_expr_recon_loss: 648882.3275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236113.1542; val_optim_loss: 3236113.1542
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 11041.4279; train_edge_recon_loss: 2569634.3345; train_gene_expr_recon_loss: 648068.7709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228744.5353; train_optim_loss: 3228744.5353; val_kl_reg_loss: 11038.1779; val_edge_recon_loss: 2573937.2334; val_gene_expr_recon_loss: 649102.7618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234078.1794; val_optim_loss: 3234078.1794
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 11016.7328; train_edge_recon_loss: 2569324.4001; train_gene_expr_recon_loss: 648059.9118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228401.0448; train_optim_loss: 3228401.0448; val_kl_reg_loss: 11050.5092; val_edge_recon_loss: 2576706.7082; val_gene_expr_recon_loss: 650081.7395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237838.9469; val_optim_loss: 3237838.9469
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 11016.8527; train_edge_recon_loss: 2568116.3109; train_gene_expr_recon_loss: 647955.4640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227088.6271; train_optim_loss: 3227088.6271; val_kl_reg_loss: 10991.2951; val_edge_recon_loss: 2578666.1455; val_gene_expr_recon_loss: 648471.3567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238128.7979; val_optim_loss: 3238128.7979
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 10996.0097; train_edge_recon_loss: 2568376.4840; train_gene_expr_recon_loss: 647887.8323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227260.3275; train_optim_loss: 3227260.3275; val_kl_reg_loss: 11165.5732; val_edge_recon_loss: 2575429.4443; val_gene_expr_recon_loss: 648317.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234912.6463; val_optim_loss: 3234912.6463
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 11002.7300; train_edge_recon_loss: 2568504.5727; train_gene_expr_recon_loss: 647909.5638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227416.8691; train_optim_loss: 3227416.8691; val_kl_reg_loss: 11031.3165; val_edge_recon_loss: 2573712.1542; val_gene_expr_recon_loss: 649442.4599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234185.9355; val_optim_loss: 3234185.9355

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 11202.4148; train_edge_recon_loss: 2566342.1178; train_gene_expr_recon_loss: 643419.9784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220964.5088; train_optim_loss: 3220964.5088; val_kl_reg_loss: 11121.1747; val_edge_recon_loss: 2570995.7439; val_gene_expr_recon_loss: 645567.7215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227684.6368; val_optim_loss: 3227684.6368
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 11267.9969; train_edge_recon_loss: 2564923.5016; train_gene_expr_recon_loss: 642999.9678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219191.4665; train_optim_loss: 3219191.4665; val_kl_reg_loss: 11228.2661; val_edge_recon_loss: 2572120.5828; val_gene_expr_recon_loss: 645965.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229314.3929; val_optim_loss: 3229314.3929
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 11274.4546; train_edge_recon_loss: 2565304.0271; train_gene_expr_recon_loss: 642615.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219193.7415; train_optim_loss: 3219193.7415; val_kl_reg_loss: 11154.1421; val_edge_recon_loss: 2570980.5418; val_gene_expr_recon_loss: 644968.7304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227103.4138; val_optim_loss: 3227103.4138
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 11239.7612; train_edge_recon_loss: 2565361.8401; train_gene_expr_recon_loss: 642500.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219102.3259; train_optim_loss: 3219102.3259; val_kl_reg_loss: 11182.0072; val_edge_recon_loss: 2571142.6803; val_gene_expr_recon_loss: 645328.5540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227653.2413; val_optim_loss: 3227653.2413
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 11230.4904; train_edge_recon_loss: 2565329.4625; train_gene_expr_recon_loss: 642155.4804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218715.4333; train_optim_loss: 3218715.4333; val_kl_reg_loss: 11133.3803; val_edge_recon_loss: 2568906.9233; val_gene_expr_recon_loss: 644493.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3224534.1777; val_optim_loss: 3224534.1777
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9946; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 11238.8588; train_edge_recon_loss: 2564892.0312; train_gene_expr_recon_loss: 642364.7325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218495.6231; train_optim_loss: 3218495.6231; val_kl_reg_loss: 11117.6606; val_edge_recon_loss: 2571530.4625; val_gene_expr_recon_loss: 645274.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227923.0061; val_optim_loss: 3227923.0061
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 11218.9152; train_edge_recon_loss: 2565554.9815; train_gene_expr_recon_loss: 642137.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218911.0653; train_optim_loss: 3218911.0653; val_kl_reg_loss: 11135.9605; val_edge_recon_loss: 2570487.0740; val_gene_expr_recon_loss: 645211.8251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3226834.8580; val_optim_loss: 3226834.8580
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 11192.3294; train_edge_recon_loss: 2564938.1770; train_gene_expr_recon_loss: 642026.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218156.6859; train_optim_loss: 3218156.6859; val_kl_reg_loss: 11050.1368; val_edge_recon_loss: 2571402.4695; val_gene_expr_recon_loss: 645300.4005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227753.0078; val_optim_loss: 3227753.0078
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 11155.6430; train_edge_recon_loss: 2564884.0613; train_gene_expr_recon_loss: 642270.6716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218310.3750; train_optim_loss: 3218310.3750; val_kl_reg_loss: 11137.4760; val_edge_recon_loss: 2570699.3136; val_gene_expr_recon_loss: 645971.6084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3227808.3868; val_optim_loss: 3227808.3868

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 11194.7038; train_edge_recon_loss: 2564769.9296; train_gene_expr_recon_loss: 641591.7504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217556.3826; train_optim_loss: 3217556.3826; val_kl_reg_loss: 11122.5835; val_edge_recon_loss: 2569072.6472; val_gene_expr_recon_loss: 644511.7128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3224706.9530; val_optim_loss: 3224706.9530
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 11219.7814; train_edge_recon_loss: 2564919.9496; train_gene_expr_recon_loss: 641406.5886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217546.3201; train_optim_loss: 3217546.3201; val_kl_reg_loss: 11129.4575; val_edge_recon_loss: 2570978.6533; val_gene_expr_recon_loss: 644856.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3226964.7082; val_optim_loss: 3226964.7082
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 11218.7645; train_edge_recon_loss: 2564459.7706; train_gene_expr_recon_loss: 641293.5596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216972.0934; train_optim_loss: 3216972.0934; val_kl_reg_loss: 11119.1012; val_edge_recon_loss: 2570065.2822; val_gene_expr_recon_loss: 645554.9405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3226739.3319; val_optim_loss: 3226739.3319
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 11213.9861; train_edge_recon_loss: 2564632.7733; train_gene_expr_recon_loss: 641187.1501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217033.9108; train_optim_loss: 3217033.9108; val_kl_reg_loss: 11125.6994; val_edge_recon_loss: 2570077.8650; val_gene_expr_recon_loss: 644759.3323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3225962.8937; val_optim_loss: 3225962.8937

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 838 min 28 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9959
Val AUPRC score: 0.9947
Val best accuracy score: 0.9791
Val best F1 score: 0.9794
Val gene expr MSE score: 1.5981

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
