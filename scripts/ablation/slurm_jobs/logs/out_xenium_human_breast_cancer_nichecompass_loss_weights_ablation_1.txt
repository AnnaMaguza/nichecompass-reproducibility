None
Run timestamp: 13072023_183018_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9341; val_auprc_score: 0.9147; val_best_acc_score: 0.8718; val_best_f1_score: 0.8805; train_kl_reg_loss: 21429.3182; train_edge_recon_loss: 2726738.0070; train_gene_expr_recon_loss: 788934.5272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3537101.8570; train_optim_loss: 3537101.8570; val_kl_reg_loss: 18168.0497; val_edge_recon_loss: 2707050.3421; val_gene_expr_recon_loss: 719283.1480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3444501.5461; val_optim_loss: 3444501.5461
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9513; val_auprc_score: 0.9383; val_best_acc_score: 0.8910; val_best_f1_score: 0.8971; train_kl_reg_loss: 17400.9764; train_edge_recon_loss: 2641685.4371; train_gene_expr_recon_loss: 701437.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3360523.4254; train_optim_loss: 3360523.4254; val_kl_reg_loss: 15327.7663; val_edge_recon_loss: 2691204.7862; val_gene_expr_recon_loss: 683069.0847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3389601.6217; val_optim_loss: 3389601.6217
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9596; val_auprc_score: 0.9492; val_best_acc_score: 0.9015; val_best_f1_score: 0.9058; train_kl_reg_loss: 15830.2833; train_edge_recon_loss: 2630950.2790; train_gene_expr_recon_loss: 672633.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3319414.4316; train_optim_loss: 3319414.4316; val_kl_reg_loss: 15294.6786; val_edge_recon_loss: 2682436.8849; val_gene_expr_recon_loss: 658898.2484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3356629.8158; val_optim_loss: 3356629.8158
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9634; val_auprc_score: 0.9527; val_best_acc_score: 0.9094; val_best_f1_score: 0.9129; train_kl_reg_loss: 15455.2102; train_edge_recon_loss: 2621925.9309; train_gene_expr_recon_loss: 653541.1811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3290922.3202; train_optim_loss: 3290922.3202; val_kl_reg_loss: 15067.4944; val_edge_recon_loss: 2672292.3421; val_gene_expr_recon_loss: 643120.8734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3330480.7072; val_optim_loss: 3330480.7072
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9662; val_auprc_score: 0.9573; val_best_acc_score: 0.9141; val_best_f1_score: 0.9169; train_kl_reg_loss: 15178.0802; train_edge_recon_loss: 2618358.7930; train_gene_expr_recon_loss: 640106.5687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3273643.4393; train_optim_loss: 3273643.4393; val_kl_reg_loss: 14434.5492; val_edge_recon_loss: 2668677.5757; val_gene_expr_recon_loss: 634829.3528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3317941.4770; val_optim_loss: 3317941.4770
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9662; val_auprc_score: 0.9564; val_best_acc_score: 0.9159; val_best_f1_score: 0.9186; train_kl_reg_loss: 14865.7312; train_edge_recon_loss: 2616224.8129; train_gene_expr_recon_loss: 631161.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3262251.7188; train_optim_loss: 3262251.7188; val_kl_reg_loss: 14469.7712; val_edge_recon_loss: 2668211.8059; val_gene_expr_recon_loss: 627334.2377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3310015.7961; val_optim_loss: 3310015.7961
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9687; val_auprc_score: 0.9611; val_best_acc_score: 0.9177; val_best_f1_score: 0.9203; train_kl_reg_loss: 14575.6201; train_edge_recon_loss: 2613537.8853; train_gene_expr_recon_loss: 624471.9483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252585.4581; train_optim_loss: 3252585.4581; val_kl_reg_loss: 13967.5042; val_edge_recon_loss: 2666646.4836; val_gene_expr_recon_loss: 619386.8331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3300000.8224; val_optim_loss: 3300000.8224
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9701; val_auprc_score: 0.9621; val_best_acc_score: 0.9213; val_best_f1_score: 0.9239; train_kl_reg_loss: 14261.0119; train_edge_recon_loss: 2610972.3515; train_gene_expr_recon_loss: 619200.1617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3244433.5346; train_optim_loss: 3244433.5346; val_kl_reg_loss: 13889.1262; val_edge_recon_loss: 2662205.4605; val_gene_expr_recon_loss: 618499.9827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3294594.5691; val_optim_loss: 3294594.5691
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9705; val_auprc_score: 0.9614; val_best_acc_score: 0.9237; val_best_f1_score: 0.9263; train_kl_reg_loss: 14089.1151; train_edge_recon_loss: 2612397.7309; train_gene_expr_recon_loss: 616066.4914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242553.3382; train_optim_loss: 3242553.3382; val_kl_reg_loss: 13381.9564; val_edge_recon_loss: 2662601.7697; val_gene_expr_recon_loss: 614326.1785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3290309.8914; val_optim_loss: 3290309.8914
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9715; val_auprc_score: 0.9631; val_best_acc_score: 0.9245; val_best_f1_score: 0.9268; train_kl_reg_loss: 14019.7341; train_edge_recon_loss: 2607828.2882; train_gene_expr_recon_loss: 613010.9634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234858.9831; train_optim_loss: 3234858.9831; val_kl_reg_loss: 13474.3454; val_edge_recon_loss: 2658258.9276; val_gene_expr_recon_loss: 611029.5535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3282762.8322; val_optim_loss: 3282762.8322
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9731; val_auprc_score: 0.9654; val_best_acc_score: 0.9261; val_best_f1_score: 0.9283; train_kl_reg_loss: 13902.0524; train_edge_recon_loss: 2607389.6827; train_gene_expr_recon_loss: 610891.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232183.3680; train_optim_loss: 3232183.3680; val_kl_reg_loss: 13420.0718; val_edge_recon_loss: 2659779.7467; val_gene_expr_recon_loss: 608646.0641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281845.8651; val_optim_loss: 3281845.8651
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9726; val_auprc_score: 0.9650; val_best_acc_score: 0.9257; val_best_f1_score: 0.9279; train_kl_reg_loss: 13817.9174; train_edge_recon_loss: 2605805.0070; train_gene_expr_recon_loss: 609015.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228638.6482; train_optim_loss: 3228638.6482; val_kl_reg_loss: 13354.6250; val_edge_recon_loss: 2658904.0395; val_gene_expr_recon_loss: 607577.5329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279836.1908; val_optim_loss: 3279836.1908
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9743; val_auprc_score: 0.9680; val_best_acc_score: 0.9260; val_best_f1_score: 0.9283; train_kl_reg_loss: 13653.2400; train_edge_recon_loss: 2606165.0540; train_gene_expr_recon_loss: 607579.2649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227397.5588; train_optim_loss: 3227397.5588; val_kl_reg_loss: 13081.7820; val_edge_recon_loss: 2660238.7961; val_gene_expr_recon_loss: 607869.6867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281190.2697; val_optim_loss: 3281190.2697
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9744; val_auprc_score: 0.9673; val_best_acc_score: 0.9274; val_best_f1_score: 0.9294; train_kl_reg_loss: 13595.8783; train_edge_recon_loss: 2604757.9732; train_gene_expr_recon_loss: 605837.6444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224191.4886; train_optim_loss: 3224191.4886; val_kl_reg_loss: 13545.1935; val_edge_recon_loss: 2654255.5329; val_gene_expr_recon_loss: 605128.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272929.0099; val_optim_loss: 3272929.0099
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9739; val_auprc_score: 0.9662; val_best_acc_score: 0.9285; val_best_f1_score: 0.9303; train_kl_reg_loss: 13515.8095; train_edge_recon_loss: 2604233.4335; train_gene_expr_recon_loss: 604928.0460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222677.2915; train_optim_loss: 3222677.2915; val_kl_reg_loss: 13240.0168; val_edge_recon_loss: 2656082.1809; val_gene_expr_recon_loss: 604567.3717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3273889.5691; val_optim_loss: 3273889.5691
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9746; val_auprc_score: 0.9675; val_best_acc_score: 0.9285; val_best_f1_score: 0.9304; train_kl_reg_loss: 13471.2846; train_edge_recon_loss: 2603441.5162; train_gene_expr_recon_loss: 604043.3720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220956.1713; train_optim_loss: 3220956.1713; val_kl_reg_loss: 13042.2371; val_edge_recon_loss: 2654846.2007; val_gene_expr_recon_loss: 603378.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271266.7467; val_optim_loss: 3271266.7467
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9751; val_auprc_score: 0.9680; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 13341.0710; train_edge_recon_loss: 2602911.1699; train_gene_expr_recon_loss: 603427.9843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219680.2239; train_optim_loss: 3219680.2239; val_kl_reg_loss: 12441.4241; val_edge_recon_loss: 2656755.0362; val_gene_expr_recon_loss: 602924.9211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272121.3750; val_optim_loss: 3272121.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9760; val_auprc_score: 0.9697; val_best_acc_score: 0.9299; val_best_f1_score: 0.9317; train_kl_reg_loss: 13315.9747; train_edge_recon_loss: 2602621.8246; train_gene_expr_recon_loss: 602556.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218494.6085; train_optim_loss: 3218494.6085; val_kl_reg_loss: 12666.3453; val_edge_recon_loss: 2654462.7138; val_gene_expr_recon_loss: 603370.0510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270499.0987; val_optim_loss: 3270499.0987
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9753; val_auprc_score: 0.9682; val_best_acc_score: 0.9304; val_best_f1_score: 0.9324; train_kl_reg_loss: 13307.4434; train_edge_recon_loss: 2601450.2496; train_gene_expr_recon_loss: 601684.2908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216441.9816; train_optim_loss: 3216441.9816; val_kl_reg_loss: 12941.7050; val_edge_recon_loss: 2652192.5263; val_gene_expr_recon_loss: 602572.3808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267706.6118; val_optim_loss: 3267706.6118
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9748; val_auprc_score: 0.9670; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 13219.4218; train_edge_recon_loss: 2601628.4324; train_gene_expr_recon_loss: 601173.2313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216021.0827; train_optim_loss: 3216021.0827; val_kl_reg_loss: 12760.4863; val_edge_recon_loss: 2657194.9572; val_gene_expr_recon_loss: 602156.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272111.4901; val_optim_loss: 3272111.4901
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9759; val_auprc_score: 0.9693; val_best_acc_score: 0.9307; val_best_f1_score: 0.9326; train_kl_reg_loss: 13229.7711; train_edge_recon_loss: 2600159.9261; train_gene_expr_recon_loss: 600625.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214015.6044; train_optim_loss: 3214015.6044; val_kl_reg_loss: 12821.2579; val_edge_recon_loss: 2655678.1908; val_gene_expr_recon_loss: 599796.0863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268295.5493; val_optim_loss: 3268295.5493
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9767; val_auprc_score: 0.9707; val_best_acc_score: 0.9319; val_best_f1_score: 0.9337; train_kl_reg_loss: 13171.3296; train_edge_recon_loss: 2601775.9842; train_gene_expr_recon_loss: 600011.1945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214958.5099; train_optim_loss: 3214958.5099; val_kl_reg_loss: 12876.2442; val_edge_recon_loss: 2649148.8520; val_gene_expr_recon_loss: 600932.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262957.3487; val_optim_loss: 3262957.3487
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9760; val_auprc_score: 0.9687; val_best_acc_score: 0.9300; val_best_f1_score: 0.9321; train_kl_reg_loss: 13137.8239; train_edge_recon_loss: 2599726.2346; train_gene_expr_recon_loss: 599649.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212513.7820; train_optim_loss: 3212513.7820; val_kl_reg_loss: 12859.2415; val_edge_recon_loss: 2652303.9572; val_gene_expr_recon_loss: 599484.6735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264647.8651; val_optim_loss: 3264647.8651
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9756; val_auprc_score: 0.9688; val_best_acc_score: 0.9304; val_best_f1_score: 0.9324; train_kl_reg_loss: 13102.9406; train_edge_recon_loss: 2600606.1529; train_gene_expr_recon_loss: 599023.1553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212732.2485; train_optim_loss: 3212732.2485; val_kl_reg_loss: 12592.8569; val_edge_recon_loss: 2656149.3882; val_gene_expr_recon_loss: 602038.8298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270781.0724; val_optim_loss: 3270781.0724
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9764; val_auprc_score: 0.9699; val_best_acc_score: 0.9327; val_best_f1_score: 0.9343; train_kl_reg_loss: 13053.6403; train_edge_recon_loss: 2598417.6787; train_gene_expr_recon_loss: 598590.2991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210061.6140; train_optim_loss: 3210061.6140; val_kl_reg_loss: 12503.1491; val_edge_recon_loss: 2654625.5724; val_gene_expr_recon_loss: 599343.2113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266471.9145; val_optim_loss: 3266471.9145
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9748; val_auprc_score: 0.9668; val_best_acc_score: 0.9308; val_best_f1_score: 0.9325; train_kl_reg_loss: 13074.9047; train_edge_recon_loss: 2595925.9669; train_gene_expr_recon_loss: 598230.5040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207231.3757; train_optim_loss: 3207231.3757; val_kl_reg_loss: 12872.4473; val_edge_recon_loss: 2651184.3947; val_gene_expr_recon_loss: 599191.3586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263248.1974; val_optim_loss: 3263248.1974

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9764; val_auprc_score: 0.9694; val_best_acc_score: 0.9326; val_best_f1_score: 0.9343; train_kl_reg_loss: 12968.5955; train_edge_recon_loss: 2598241.8518; train_gene_expr_recon_loss: 594181.1483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3205391.5897; train_optim_loss: 3205391.5897; val_kl_reg_loss: 12662.3651; val_edge_recon_loss: 2650030.4243; val_gene_expr_recon_loss: 595417.2097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258109.9967; val_optim_loss: 3258109.9967
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9766; val_auprc_score: 0.9702; val_best_acc_score: 0.9321; val_best_f1_score: 0.9340; train_kl_reg_loss: 12986.2576; train_edge_recon_loss: 2596894.0790; train_gene_expr_recon_loss: 593766.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203646.7728; train_optim_loss: 3203646.7728; val_kl_reg_loss: 12724.0383; val_edge_recon_loss: 2651800.6118; val_gene_expr_recon_loss: 595919.4021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260444.0493; val_optim_loss: 3260444.0493
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9774; val_auprc_score: 0.9705; val_best_acc_score: 0.9342; val_best_f1_score: 0.9362; train_kl_reg_loss: 12984.4240; train_edge_recon_loss: 2595754.3838; train_gene_expr_recon_loss: 593836.9298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202575.7342; train_optim_loss: 3202575.7342; val_kl_reg_loss: 12643.7093; val_edge_recon_loss: 2646939.9704; val_gene_expr_recon_loss: 595418.0132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255001.6776; val_optim_loss: 3255001.6776
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9774; val_auprc_score: 0.9709; val_best_acc_score: 0.9328; val_best_f1_score: 0.9348; train_kl_reg_loss: 12967.3030; train_edge_recon_loss: 2597124.8305; train_gene_expr_recon_loss: 593286.6593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203378.7945; train_optim_loss: 3203378.7945; val_kl_reg_loss: 12643.8609; val_edge_recon_loss: 2653181.6283; val_gene_expr_recon_loss: 595175.7360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261001.2204; val_optim_loss: 3261001.2204
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9768; val_auprc_score: 0.9697; val_best_acc_score: 0.9337; val_best_f1_score: 0.9357; train_kl_reg_loss: 12977.6120; train_edge_recon_loss: 2595793.3059; train_gene_expr_recon_loss: 593376.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202146.9724; train_optim_loss: 3202146.9724; val_kl_reg_loss: 12614.8078; val_edge_recon_loss: 2649015.8355; val_gene_expr_recon_loss: 594024.7426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255655.3684; val_optim_loss: 3255655.3684
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9343; val_best_f1_score: 0.9360; train_kl_reg_loss: 12856.7793; train_edge_recon_loss: 2596130.4993; train_gene_expr_recon_loss: 593204.4493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202191.7257; train_optim_loss: 3202191.7257; val_kl_reg_loss: 12462.7593; val_edge_recon_loss: 2648956.9441; val_gene_expr_recon_loss: 594678.7952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256098.4868; val_optim_loss: 3256098.4868
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9335; val_best_f1_score: 0.9358; train_kl_reg_loss: 12840.2053; train_edge_recon_loss: 2596884.9298; train_gene_expr_recon_loss: 593296.9120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203022.0467; train_optim_loss: 3203022.0467; val_kl_reg_loss: 12573.8203; val_edge_recon_loss: 2647670.3750; val_gene_expr_recon_loss: 596258.2804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256502.4836; val_optim_loss: 3256502.4836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9768; val_auprc_score: 0.9699; val_best_acc_score: 0.9335; val_best_f1_score: 0.9354; train_kl_reg_loss: 12867.7613; train_edge_recon_loss: 2594969.0849; train_gene_expr_recon_loss: 592593.5006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200430.3500; train_optim_loss: 3200430.3500; val_kl_reg_loss: 12557.4499; val_edge_recon_loss: 2650121.0263; val_gene_expr_recon_loss: 595407.6916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258086.1546; val_optim_loss: 3258086.1546
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9774; val_auprc_score: 0.9707; val_best_acc_score: 0.9344; val_best_f1_score: 0.9362; train_kl_reg_loss: 12868.3469; train_edge_recon_loss: 2595004.5540; train_gene_expr_recon_loss: 592759.9011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200632.7989; train_optim_loss: 3200632.7989; val_kl_reg_loss: 12564.3072; val_edge_recon_loss: 2648418.2895; val_gene_expr_recon_loss: 593763.7229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254746.3092; val_optim_loss: 3254746.3092
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9771; val_auprc_score: 0.9703; val_best_acc_score: 0.9335; val_best_f1_score: 0.9355; train_kl_reg_loss: 12875.0670; train_edge_recon_loss: 2595637.3489; train_gene_expr_recon_loss: 592657.3849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201169.8040; train_optim_loss: 3201169.8040; val_kl_reg_loss: 12547.0911; val_edge_recon_loss: 2648737.4934; val_gene_expr_recon_loss: 593841.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255125.6250; val_optim_loss: 3255125.6250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9774; val_auprc_score: 0.9710; val_best_acc_score: 0.9343; val_best_f1_score: 0.9360; train_kl_reg_loss: 12872.3947; train_edge_recon_loss: 2596269.3507; train_gene_expr_recon_loss: 592413.4269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201555.1732; train_optim_loss: 3201555.1732; val_kl_reg_loss: 12548.4583; val_edge_recon_loss: 2649034.8026; val_gene_expr_recon_loss: 594334.2229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255917.4868; val_optim_loss: 3255917.4868
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9773; val_auprc_score: 0.9705; val_best_acc_score: 0.9347; val_best_f1_score: 0.9365; train_kl_reg_loss: 12873.8414; train_edge_recon_loss: 2597089.8713; train_gene_expr_recon_loss: 592496.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202460.1765; train_optim_loss: 3202460.1765; val_kl_reg_loss: 12528.2376; val_edge_recon_loss: 2648525.5230; val_gene_expr_recon_loss: 593485.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254539.4868; val_optim_loss: 3254539.4868
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9772; val_auprc_score: 0.9703; val_best_acc_score: 0.9340; val_best_f1_score: 0.9358; train_kl_reg_loss: 12867.4986; train_edge_recon_loss: 2596256.8029; train_gene_expr_recon_loss: 592220.4068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201344.7062; train_optim_loss: 3201344.7062; val_kl_reg_loss: 12563.5488; val_edge_recon_loss: 2649895.6941; val_gene_expr_recon_loss: 594812.3454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257271.5888; val_optim_loss: 3257271.5888
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9345; val_best_f1_score: 0.9364; train_kl_reg_loss: 12877.3545; train_edge_recon_loss: 2595602.1482; train_gene_expr_recon_loss: 592537.0280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201016.5279; train_optim_loss: 3201016.5279; val_kl_reg_loss: 12556.8615; val_edge_recon_loss: 2648237.7138; val_gene_expr_recon_loss: 594590.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255384.7039; val_optim_loss: 3255384.7039
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9772; val_auprc_score: 0.9708; val_best_acc_score: 0.9330; val_best_f1_score: 0.9350; train_kl_reg_loss: 12854.6696; train_edge_recon_loss: 2596064.7118; train_gene_expr_recon_loss: 592452.7487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201372.1342; train_optim_loss: 3201372.1342; val_kl_reg_loss: 12522.6074; val_edge_recon_loss: 2651408.1447; val_gene_expr_recon_loss: 594968.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258899.5132; val_optim_loss: 3258899.5132
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9336; val_best_f1_score: 0.9355; train_kl_reg_loss: 12863.3671; train_edge_recon_loss: 2595297.9489; train_gene_expr_recon_loss: 592509.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200670.4408; train_optim_loss: 3200670.4408; val_kl_reg_loss: 12543.8414; val_edge_recon_loss: 2650190.2862; val_gene_expr_recon_loss: 594666.8306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257400.9605; val_optim_loss: 3257400.9605

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9779; val_auprc_score: 0.9717; val_best_acc_score: 0.9338; val_best_f1_score: 0.9356; train_kl_reg_loss: 12866.3806; train_edge_recon_loss: 2595582.5063; train_gene_expr_recon_loss: 592405.7592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200854.6467; train_optim_loss: 3200854.6467; val_kl_reg_loss: 12552.4060; val_edge_recon_loss: 2646944.6776; val_gene_expr_recon_loss: 595530.5247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255027.6118; val_optim_loss: 3255027.6118
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9778; val_auprc_score: 0.9714; val_best_acc_score: 0.9344; val_best_f1_score: 0.9362; train_kl_reg_loss: 12864.1583; train_edge_recon_loss: 2596173.7989; train_gene_expr_recon_loss: 592348.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201385.9893; train_optim_loss: 3201385.9893; val_kl_reg_loss: 12544.0839; val_edge_recon_loss: 2646249.0493; val_gene_expr_recon_loss: 595142.0987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253935.2138; val_optim_loss: 3253935.2138
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9772; val_auprc_score: 0.9708; val_best_acc_score: 0.9335; val_best_f1_score: 0.9354; train_kl_reg_loss: 12862.2366; train_edge_recon_loss: 2597875.5654; train_gene_expr_recon_loss: 592432.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3203170.7691; train_optim_loss: 3203170.7691; val_kl_reg_loss: 12536.8980; val_edge_recon_loss: 2647796.4408; val_gene_expr_recon_loss: 594402.4967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254735.8257; val_optim_loss: 3254735.8257
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9775; val_auprc_score: 0.9713; val_best_acc_score: 0.9343; val_best_f1_score: 0.9359; train_kl_reg_loss: 12863.6114; train_edge_recon_loss: 2595283.2952; train_gene_expr_recon_loss: 592304.7974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200451.7048; train_optim_loss: 3200451.7048; val_kl_reg_loss: 12541.7368; val_edge_recon_loss: 2647289.0395; val_gene_expr_recon_loss: 593594.2516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253425.0132; val_optim_loss: 3253425.0132
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 12856.7467; train_edge_recon_loss: 2595747.3250; train_gene_expr_recon_loss: 592166.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200770.5706; train_optim_loss: 3200770.5706; val_kl_reg_loss: 12536.1440; val_edge_recon_loss: 2646703.4507; val_gene_expr_recon_loss: 593727.9581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252967.5164; val_optim_loss: 3252967.5164
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9773; val_auprc_score: 0.9707; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 12856.6483; train_edge_recon_loss: 2596200.2963; train_gene_expr_recon_loss: 592318.8826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201375.8283; train_optim_loss: 3201375.8283; val_kl_reg_loss: 12529.8509; val_edge_recon_loss: 2647548.0559; val_gene_expr_recon_loss: 594342.7212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254420.6316; val_optim_loss: 3254420.6316
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9771; val_auprc_score: 0.9703; val_best_acc_score: 0.9339; val_best_f1_score: 0.9358; train_kl_reg_loss: 12855.7925; train_edge_recon_loss: 2595806.3335; train_gene_expr_recon_loss: 592285.9322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200948.0566; train_optim_loss: 3200948.0566; val_kl_reg_loss: 12547.0993; val_edge_recon_loss: 2649896.5526; val_gene_expr_recon_loss: 594081.0214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256524.6776; val_optim_loss: 3256524.6776
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9777; val_auprc_score: 0.9717; val_best_acc_score: 0.9342; val_best_f1_score: 0.9360; train_kl_reg_loss: 12858.5341; train_edge_recon_loss: 2595734.3000; train_gene_expr_recon_loss: 592427.5632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201020.3934; train_optim_loss: 3201020.3934; val_kl_reg_loss: 12537.2361; val_edge_recon_loss: 2651709.4737; val_gene_expr_recon_loss: 594971.5592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259218.2599; val_optim_loss: 3259218.2599
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9780; val_auprc_score: 0.9716; val_best_acc_score: 0.9353; val_best_f1_score: 0.9369; train_kl_reg_loss: 12854.5912; train_edge_recon_loss: 2596761.8390; train_gene_expr_recon_loss: 592585.5751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202202.0096; train_optim_loss: 3202202.0096; val_kl_reg_loss: 12525.2066; val_edge_recon_loss: 2645541.1382; val_gene_expr_recon_loss: 594575.5238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252641.8684; val_optim_loss: 3252641.8684
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9775; val_auprc_score: 0.9712; val_best_acc_score: 0.9335; val_best_f1_score: 0.9355; train_kl_reg_loss: 12854.3679; train_edge_recon_loss: 2595704.2022; train_gene_expr_recon_loss: 592574.1105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201132.6816; train_optim_loss: 3201132.6816; val_kl_reg_loss: 12526.7095; val_edge_recon_loss: 2649895.1546; val_gene_expr_recon_loss: 595658.9572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258080.8322; val_optim_loss: 3258080.8322
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9776; val_auprc_score: 0.9715; val_best_acc_score: 0.9343; val_best_f1_score: 0.9362; train_kl_reg_loss: 12854.7931; train_edge_recon_loss: 2595346.2059; train_gene_expr_recon_loss: 592270.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200471.4151; train_optim_loss: 3200471.4151; val_kl_reg_loss: 12523.7650; val_edge_recon_loss: 2648262.0493; val_gene_expr_recon_loss: 593351.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254137.7401; val_optim_loss: 3254137.7401
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9778; val_auprc_score: 0.9711; val_best_acc_score: 0.9353; val_best_f1_score: 0.9371; train_kl_reg_loss: 12855.1373; train_edge_recon_loss: 2595850.9415; train_gene_expr_recon_loss: 592331.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201037.6504; train_optim_loss: 3201037.6504; val_kl_reg_loss: 12541.2361; val_edge_recon_loss: 2643327.4770; val_gene_expr_recon_loss: 594936.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250804.8322; val_optim_loss: 3250804.8322
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9783; val_auprc_score: 0.9722; val_best_acc_score: 0.9343; val_best_f1_score: 0.9360; train_kl_reg_loss: 12848.1682; train_edge_recon_loss: 2596211.4254; train_gene_expr_recon_loss: 592262.3898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201321.9893; train_optim_loss: 3201321.9893; val_kl_reg_loss: 12526.8912; val_edge_recon_loss: 2647259.1645; val_gene_expr_recon_loss: 594722.3446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254508.3947; val_optim_loss: 3254508.3947
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9785; val_auprc_score: 0.9725; val_best_acc_score: 0.9362; val_best_f1_score: 0.9380; train_kl_reg_loss: 12852.7037; train_edge_recon_loss: 2597179.9239; train_gene_expr_recon_loss: 592386.5602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3202419.1842; train_optim_loss: 3202419.1842; val_kl_reg_loss: 12517.1555; val_edge_recon_loss: 2642917.4342; val_gene_expr_recon_loss: 593590.5896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249025.1842; val_optim_loss: 3249025.1842
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9776; val_auprc_score: 0.9713; val_best_acc_score: 0.9350; val_best_f1_score: 0.9368; train_kl_reg_loss: 12849.0528; train_edge_recon_loss: 2594961.2169; train_gene_expr_recon_loss: 592394.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200204.3430; train_optim_loss: 3200204.3430; val_kl_reg_loss: 12533.0241; val_edge_recon_loss: 2645489.4408; val_gene_expr_recon_loss: 596363.6998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254386.1678; val_optim_loss: 3254386.1678
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9771; val_auprc_score: 0.9701; val_best_acc_score: 0.9346; val_best_f1_score: 0.9365; train_kl_reg_loss: 12848.2576; train_edge_recon_loss: 2594937.2449; train_gene_expr_recon_loss: 592263.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200049.4599; train_optim_loss: 3200049.4599; val_kl_reg_loss: 12535.5156; val_edge_recon_loss: 2647498.7961; val_gene_expr_recon_loss: 594377.1957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254411.4836; val_optim_loss: 3254411.4836
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9779; val_auprc_score: 0.9717; val_best_acc_score: 0.9343; val_best_f1_score: 0.9362; train_kl_reg_loss: 12846.1291; train_edge_recon_loss: 2596679.7993; train_gene_expr_recon_loss: 592157.2585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201683.1787; train_optim_loss: 3201683.1787; val_kl_reg_loss: 12528.9941; val_edge_recon_loss: 2648651.0296; val_gene_expr_recon_loss: 595968.1645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257148.1678; val_optim_loss: 3257148.1678
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9780; val_auprc_score: 0.9717; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 12848.4845; train_edge_recon_loss: 2595579.6669; train_gene_expr_recon_loss: 592392.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200820.7283; train_optim_loss: 3200820.7283; val_kl_reg_loss: 12536.5039; val_edge_recon_loss: 2648097.5888; val_gene_expr_recon_loss: 594868.8396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255502.9375; val_optim_loss: 3255502.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9779; val_auprc_score: 0.9720; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 12852.1371; train_edge_recon_loss: 2595497.8779; train_gene_expr_recon_loss: 592551.9173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200901.9265; train_optim_loss: 3200901.9265; val_kl_reg_loss: 12524.2396; val_edge_recon_loss: 2649219.5559; val_gene_expr_recon_loss: 593198.7056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254942.5132; val_optim_loss: 3254942.5132
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9772; val_auprc_score: 0.9711; val_best_acc_score: 0.9331; val_best_f1_score: 0.9351; train_kl_reg_loss: 12851.5692; train_edge_recon_loss: 2596597.5559; train_gene_expr_recon_loss: 592433.3010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201882.4276; train_optim_loss: 3201882.4276; val_kl_reg_loss: 12536.7902; val_edge_recon_loss: 2653779.4276; val_gene_expr_recon_loss: 594746.6727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261062.8914; val_optim_loss: 3261062.8914
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9786; val_auprc_score: 0.9724; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 12851.1474; train_edge_recon_loss: 2596646.9085; train_gene_expr_recon_loss: 592484.5917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3201982.6544; train_optim_loss: 3201982.6544; val_kl_reg_loss: 12526.0663; val_edge_recon_loss: 2645090.7829; val_gene_expr_recon_loss: 594345.1242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3251961.9770; val_optim_loss: 3251961.9770
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9780; val_auprc_score: 0.9719; val_best_acc_score: 0.9342; val_best_f1_score: 0.9361; train_kl_reg_loss: 12852.2138; train_edge_recon_loss: 2595415.7044; train_gene_expr_recon_loss: 592517.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3200785.0460; train_optim_loss: 3200785.0460; val_kl_reg_loss: 12539.3706; val_edge_recon_loss: 2649969.5197; val_gene_expr_recon_loss: 593214.4827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3255723.3717; val_optim_loss: 3255723.3717

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 118 min 3 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
Val AUROC score: 0.9770
Val AUPRC score: 0.9703
Val best accuracy score: 0.9326
Val best F1 score: 0.9344
Val gene expr MSE score: 1.3931

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
