Run timestamp: 27062023_123648_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'patient', 'batch', '--cat_covariates_no_edges', 'True', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 5242555
Number of validation edges: 582506
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9934; val_auprc_score: 0.9934; val_best_acc_score: 0.9604; val_best_f1_score: 0.9605; train_kl_reg_loss: 5026.1424; train_edge_recon_loss: 126222.1750; train_gene_expr_recon_loss: 143089.4293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274337.7467; train_optim_loss: 274337.7467; val_kl_reg_loss: 4714.3163; val_edge_recon_loss: 123310.5164; val_gene_expr_recon_loss: 136459.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264484.2267; val_optim_loss: 264484.2267
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9948; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 4734.7417; train_edge_recon_loss: 123494.5804; train_gene_expr_recon_loss: 136041.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264271.1847; train_optim_loss: 264271.1847; val_kl_reg_loss: 4541.6234; val_edge_recon_loss: 122994.9858; val_gene_expr_recon_loss: 135261.2896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262797.8985; val_optim_loss: 262797.8985
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9956; val_auprc_score: 0.9955; val_best_acc_score: 0.9687; val_best_f1_score: 0.9688; train_kl_reg_loss: 4781.1388; train_edge_recon_loss: 123187.1285; train_gene_expr_recon_loss: 135365.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263334.1029; train_optim_loss: 263334.1029; val_kl_reg_loss: 4631.4607; val_edge_recon_loss: 123050.1352; val_gene_expr_recon_loss: 134902.4139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262584.0095; val_optim_loss: 262584.0095
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9961; val_auprc_score: 0.9960; val_best_acc_score: 0.9707; val_best_f1_score: 0.9708; train_kl_reg_loss: 4814.6468; train_edge_recon_loss: 123144.5417; train_gene_expr_recon_loss: 135039.0454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262998.2341; train_optim_loss: 262998.2341; val_kl_reg_loss: 4805.4510; val_edge_recon_loss: 123127.0377; val_gene_expr_recon_loss: 134612.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262544.9943; val_optim_loss: 262544.9943
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 4844.7590; train_edge_recon_loss: 123126.7347; train_gene_expr_recon_loss: 134798.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262770.4850; train_optim_loss: 262770.4850; val_kl_reg_loss: 4914.2115; val_edge_recon_loss: 123212.3294; val_gene_expr_recon_loss: 134409.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262536.0862; val_optim_loss: 262536.0862
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9724; val_best_f1_score: 0.9725; train_kl_reg_loss: 4869.3626; train_edge_recon_loss: 123041.2122; train_gene_expr_recon_loss: 134615.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262525.7157; train_optim_loss: 262525.7157; val_kl_reg_loss: 4820.9663; val_edge_recon_loss: 122663.3285; val_gene_expr_recon_loss: 134340.6950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261824.9891; val_optim_loss: 261824.9891
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 4884.1003; train_edge_recon_loss: 122789.7352; train_gene_expr_recon_loss: 134484.9158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262158.7516; train_optim_loss: 262158.7516; val_kl_reg_loss: 4898.1694; val_edge_recon_loss: 122586.9576; val_gene_expr_recon_loss: 134085.2264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261570.3535; val_optim_loss: 261570.3535
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 4905.7656; train_edge_recon_loss: 122921.2427; train_gene_expr_recon_loss: 134378.1606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262205.1686; train_optim_loss: 262205.1686; val_kl_reg_loss: 4968.1056; val_edge_recon_loss: 123012.9295; val_gene_expr_recon_loss: 133993.4789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261974.5139; val_optim_loss: 261974.5139
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 4916.4821; train_edge_recon_loss: 122882.8116; train_gene_expr_recon_loss: 134295.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262095.1910; train_optim_loss: 262095.1910; val_kl_reg_loss: 4828.2794; val_edge_recon_loss: 122534.3945; val_gene_expr_recon_loss: 133989.5300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261352.2039; val_optim_loss: 261352.2039
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9966; val_auprc_score: 0.9965; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 4929.5276; train_edge_recon_loss: 122897.6402; train_gene_expr_recon_loss: 134225.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262053.0545; train_optim_loss: 262053.0545; val_kl_reg_loss: 4931.8302; val_edge_recon_loss: 123011.7288; val_gene_expr_recon_loss: 133955.4269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261898.9861; val_optim_loss: 261898.9861
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 4938.7534; train_edge_recon_loss: 122870.0765; train_gene_expr_recon_loss: 134168.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261976.8987; train_optim_loss: 261976.8987; val_kl_reg_loss: 4859.5825; val_edge_recon_loss: 122939.5755; val_gene_expr_recon_loss: 133901.7308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261700.8895; val_optim_loss: 261700.8895
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 4945.4018; train_edge_recon_loss: 122877.8755; train_gene_expr_recon_loss: 134104.1898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261927.4672; train_optim_loss: 261927.4672; val_kl_reg_loss: 4954.8278; val_edge_recon_loss: 122436.0828; val_gene_expr_recon_loss: 133825.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261216.2659; val_optim_loss: 261216.2659
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 4953.8843; train_edge_recon_loss: 122861.0769; train_gene_expr_recon_loss: 134081.5293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261896.4906; train_optim_loss: 261896.4906; val_kl_reg_loss: 4967.3804; val_edge_recon_loss: 122701.0397; val_gene_expr_recon_loss: 133802.7366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261471.1571; val_optim_loss: 261471.1571
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 4960.0813; train_edge_recon_loss: 122725.7103; train_gene_expr_recon_loss: 134042.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261728.3263; train_optim_loss: 261728.3263; val_kl_reg_loss: 5046.9630; val_edge_recon_loss: 122650.1237; val_gene_expr_recon_loss: 133820.4399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261517.5272; val_optim_loss: 261517.5272
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9969; val_auprc_score: 0.9968; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 4966.3184; train_edge_recon_loss: 122798.3768; train_gene_expr_recon_loss: 133996.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261761.4910; train_optim_loss: 261761.4910; val_kl_reg_loss: 4862.0935; val_edge_recon_loss: 122741.5125; val_gene_expr_recon_loss: 133659.0550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261262.6608; val_optim_loss: 261262.6608

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 4929.3124; train_edge_recon_loss: 122576.4772; train_gene_expr_recon_loss: 133382.0472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260887.8368; train_optim_loss: 260887.8368; val_kl_reg_loss: 4908.9510; val_edge_recon_loss: 122094.6104; val_gene_expr_recon_loss: 133129.3980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260132.9596; val_optim_loss: 260132.9596
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 4917.1876; train_edge_recon_loss: 122626.5718; train_gene_expr_recon_loss: 133279.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260822.9469; train_optim_loss: 260822.9469; val_kl_reg_loss: 4912.4516; val_edge_recon_loss: 122273.9520; val_gene_expr_recon_loss: 133124.0696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260310.4731; val_optim_loss: 260310.4731
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 4913.3877; train_edge_recon_loss: 122606.6363; train_gene_expr_recon_loss: 133207.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260727.2024; train_optim_loss: 260727.2024; val_kl_reg_loss: 4926.2062; val_edge_recon_loss: 122619.2782; val_gene_expr_recon_loss: 133044.5552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260590.0398; val_optim_loss: 260590.0398
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 4913.2312; train_edge_recon_loss: 122582.1397; train_gene_expr_recon_loss: 133167.3995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260662.7702; train_optim_loss: 260662.7702; val_kl_reg_loss: 4870.8359; val_edge_recon_loss: 122412.9211; val_gene_expr_recon_loss: 133019.6964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260303.4535; val_optim_loss: 260303.4535

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 4908.6368; train_edge_recon_loss: 122447.6812; train_gene_expr_recon_loss: 133109.9841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260466.3019; train_optim_loss: 260466.3019; val_kl_reg_loss: 4883.2656; val_edge_recon_loss: 122292.4468; val_gene_expr_recon_loss: 133015.9534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260191.6661; val_optim_loss: 260191.6661
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 4907.4749; train_edge_recon_loss: 122560.3124; train_gene_expr_recon_loss: 133095.8916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260563.6789; train_optim_loss: 260563.6789; val_kl_reg_loss: 4856.9639; val_edge_recon_loss: 122653.9095; val_gene_expr_recon_loss: 132927.8097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260438.6829; val_optim_loss: 260438.6829
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 4907.2918; train_edge_recon_loss: 122576.8111; train_gene_expr_recon_loss: 133096.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260581.0418; train_optim_loss: 260581.0418; val_kl_reg_loss: 4872.4357; val_edge_recon_loss: 122261.2328; val_gene_expr_recon_loss: 132954.0873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260087.7558; val_optim_loss: 260087.7558
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 4907.3349; train_edge_recon_loss: 122469.3719; train_gene_expr_recon_loss: 133064.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260440.8596; train_optim_loss: 260440.8596; val_kl_reg_loss: 4887.4032; val_edge_recon_loss: 122004.1249; val_gene_expr_recon_loss: 132875.1819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259766.7100; val_optim_loss: 259766.7100
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 4906.7308; train_edge_recon_loss: 122501.7458; train_gene_expr_recon_loss: 133101.1469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260509.6236; train_optim_loss: 260509.6236; val_kl_reg_loss: 4884.9818; val_edge_recon_loss: 122685.0916; val_gene_expr_recon_loss: 132906.4401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260476.5130; val_optim_loss: 260476.5130
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 4905.0949; train_edge_recon_loss: 122485.0078; train_gene_expr_recon_loss: 133069.3536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260459.4561; train_optim_loss: 260459.4561; val_kl_reg_loss: 4880.5069; val_edge_recon_loss: 122619.2495; val_gene_expr_recon_loss: 132883.3353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260383.0917; val_optim_loss: 260383.0917
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9954; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 4853.7367; train_edge_recon_loss: 123832.9163; train_gene_expr_recon_loss: 133005.5120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261692.1653; train_optim_loss: 261692.1653; val_kl_reg_loss: 3774.9617; val_edge_recon_loss: 123838.0187; val_gene_expr_recon_loss: 133038.3919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260651.3726; val_optim_loss: 260651.3726

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9954; val_best_acc_score: 0.9701; val_best_f1_score: 0.9701; train_kl_reg_loss: 4711.6040; train_edge_recon_loss: 123655.6807; train_gene_expr_recon_loss: 132996.7594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261364.0440; train_optim_loss: 261364.0440; val_kl_reg_loss: 3767.3558; val_edge_recon_loss: 124351.0738; val_gene_expr_recon_loss: 133016.3079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261134.7377; val_optim_loss: 261134.7377
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 4673.6761; train_edge_recon_loss: 123683.5387; train_gene_expr_recon_loss: 132997.7646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261354.9793; train_optim_loss: 261354.9793; val_kl_reg_loss: 3761.3131; val_edge_recon_loss: 124358.0044; val_gene_expr_recon_loss: 132953.7346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261073.0519; val_optim_loss: 261073.0519
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9956; val_auprc_score: 0.9954; val_best_acc_score: 0.9700; val_best_f1_score: 0.9702; train_kl_reg_loss: 4639.5862; train_edge_recon_loss: 123604.4920; train_gene_expr_recon_loss: 133014.3881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261258.4663; train_optim_loss: 261258.4663; val_kl_reg_loss: 3753.9843; val_edge_recon_loss: 124352.0633; val_gene_expr_recon_loss: 132957.0506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261063.0977; val_optim_loss: 261063.0977

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1802 min 31 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9951
Val AUPRC score: 0.9949
Val best accuracy score: 0.9684
Val best F1 score: 0.9685
Val gene expr MSE score: 8.9175
