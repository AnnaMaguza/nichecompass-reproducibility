None
Run timestamp: 04082023_192551_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '2', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 2, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9620; val_auprc_score: 0.9506; val_best_acc_score: 0.9094; val_best_f1_score: 0.9133; train_kl_reg_loss: 6170.2889; train_edge_recon_loss: 267726.2606; train_gene_expr_recon_loss: 119472.1098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 393368.6591; train_optim_loss: 393368.6591; val_kl_reg_loss: 5935.2890; val_edge_recon_loss: 268081.0043; val_gene_expr_recon_loss: 107623.9578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381640.2527; val_optim_loss: 381640.2527
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9649; val_auprc_score: 0.9540; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 6144.8909; train_edge_recon_loss: 263110.8567; train_gene_expr_recon_loss: 102389.6438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371645.3913; train_optim_loss: 371645.3913; val_kl_reg_loss: 6487.3229; val_edge_recon_loss: 267840.0251; val_gene_expr_recon_loss: 98272.0581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372599.4060; val_optim_loss: 372599.4060
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9726; val_auprc_score: 0.9656; val_best_acc_score: 0.9241; val_best_f1_score: 0.9265; train_kl_reg_loss: 6275.9910; train_edge_recon_loss: 262526.8789; train_gene_expr_recon_loss: 95878.8670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364681.7370; train_optim_loss: 364681.7370; val_kl_reg_loss: 6372.4664; val_edge_recon_loss: 267292.7438; val_gene_expr_recon_loss: 94153.6630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367818.8721; val_optim_loss: 367818.8721
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9712; val_auprc_score: 0.9631; val_best_acc_score: 0.9234; val_best_f1_score: 0.9259; train_kl_reg_loss: 6318.2170; train_edge_recon_loss: 262180.0522; train_gene_expr_recon_loss: 92882.4119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361380.6810; train_optim_loss: 361380.6810; val_kl_reg_loss: 6386.1850; val_edge_recon_loss: 266323.1399; val_gene_expr_recon_loss: 91888.9787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 364598.3031; val_optim_loss: 364598.3031
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9644; val_best_acc_score: 0.9260; val_best_f1_score: 0.9287; train_kl_reg_loss: 6322.6107; train_edge_recon_loss: 261693.0687; train_gene_expr_recon_loss: 91278.2172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 359293.8967; train_optim_loss: 359293.8967; val_kl_reg_loss: 6403.8888; val_edge_recon_loss: 266573.3307; val_gene_expr_recon_loss: 90526.3152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 363503.5348; val_optim_loss: 363503.5348
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9738; val_auprc_score: 0.9662; val_best_acc_score: 0.9264; val_best_f1_score: 0.9289; train_kl_reg_loss: 6324.9770; train_edge_recon_loss: 261355.5447; train_gene_expr_recon_loss: 90178.1877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 357858.7095; train_optim_loss: 357858.7095; val_kl_reg_loss: 6349.6879; val_edge_recon_loss: 265826.5825; val_gene_expr_recon_loss: 89716.7916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 361893.0625; val_optim_loss: 361893.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9751; val_auprc_score: 0.9674; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 6318.1426; train_edge_recon_loss: 261291.0041; train_gene_expr_recon_loss: 89344.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356953.3005; train_optim_loss: 356953.3005; val_kl_reg_loss: 6313.3846; val_edge_recon_loss: 265798.3692; val_gene_expr_recon_loss: 89008.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 361120.4319; val_optim_loss: 361120.4319
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9760; val_auprc_score: 0.9693; val_best_acc_score: 0.9304; val_best_f1_score: 0.9325; train_kl_reg_loss: 6323.3016; train_edge_recon_loss: 261027.2383; train_gene_expr_recon_loss: 88767.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356118.2729; train_optim_loss: 356118.2729; val_kl_reg_loss: 6361.9071; val_edge_recon_loss: 265358.6154; val_gene_expr_recon_loss: 88613.2619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360333.7825; val_optim_loss: 360333.7825
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9713; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 6328.8983; train_edge_recon_loss: 260943.6967; train_gene_expr_recon_loss: 88262.3715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 355534.9667; train_optim_loss: 355534.9667; val_kl_reg_loss: 6320.2105; val_edge_recon_loss: 265617.8011; val_gene_expr_recon_loss: 88032.9015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359970.9130; val_optim_loss: 359970.9130
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9775; val_auprc_score: 0.9712; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 6338.2730; train_edge_recon_loss: 260783.9775; train_gene_expr_recon_loss: 87841.7036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354963.9545; train_optim_loss: 354963.9545; val_kl_reg_loss: 6371.4911; val_edge_recon_loss: 265554.1669; val_gene_expr_recon_loss: 87414.8951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359340.5524; val_optim_loss: 359340.5524
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9761; val_auprc_score: 0.9698; val_best_acc_score: 0.9313; val_best_f1_score: 0.9333; train_kl_reg_loss: 6343.9894; train_edge_recon_loss: 260693.9268; train_gene_expr_recon_loss: 87450.3440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354488.2604; train_optim_loss: 354488.2604; val_kl_reg_loss: 6304.6494; val_edge_recon_loss: 266352.7558; val_gene_expr_recon_loss: 87410.6468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360068.0517; val_optim_loss: 360068.0517
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9766; val_auprc_score: 0.9697; val_best_acc_score: 0.9324; val_best_f1_score: 0.9346; train_kl_reg_loss: 6346.9259; train_edge_recon_loss: 260693.2630; train_gene_expr_recon_loss: 87171.7307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 354211.9197; train_optim_loss: 354211.9197; val_kl_reg_loss: 6413.7501; val_edge_recon_loss: 265598.6936; val_gene_expr_recon_loss: 86936.9265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358949.3703; val_optim_loss: 358949.3703
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9781; val_auprc_score: 0.9710; val_best_acc_score: 0.9357; val_best_f1_score: 0.9374; train_kl_reg_loss: 6345.3172; train_edge_recon_loss: 260587.1525; train_gene_expr_recon_loss: 86807.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353739.8025; train_optim_loss: 353739.8025; val_kl_reg_loss: 6386.9265; val_edge_recon_loss: 265169.5151; val_gene_expr_recon_loss: 86762.4056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358318.8477; val_optim_loss: 358318.8477
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9782; val_auprc_score: 0.9718; val_best_acc_score: 0.9359; val_best_f1_score: 0.9378; train_kl_reg_loss: 6348.1879; train_edge_recon_loss: 260616.9371; train_gene_expr_recon_loss: 86568.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353533.3314; train_optim_loss: 353533.3314; val_kl_reg_loss: 6429.7773; val_edge_recon_loss: 265129.6633; val_gene_expr_recon_loss: 86430.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357990.3819; val_optim_loss: 357990.3819
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9780; val_auprc_score: 0.9712; val_best_acc_score: 0.9346; val_best_f1_score: 0.9366; train_kl_reg_loss: 6349.7664; train_edge_recon_loss: 260608.3747; train_gene_expr_recon_loss: 86306.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 353264.3589; train_optim_loss: 353264.3589; val_kl_reg_loss: 6430.5240; val_edge_recon_loss: 264754.9413; val_gene_expr_recon_loss: 86210.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357396.4182; val_optim_loss: 357396.4182
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9791; val_auprc_score: 0.9730; val_best_acc_score: 0.9360; val_best_f1_score: 0.9376; train_kl_reg_loss: 6352.4067; train_edge_recon_loss: 260461.7198; train_gene_expr_recon_loss: 86124.8824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352939.0084; train_optim_loss: 352939.0084; val_kl_reg_loss: 6396.8612; val_edge_recon_loss: 264425.7485; val_gene_expr_recon_loss: 86013.8692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356836.4795; val_optim_loss: 356836.4795
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9779; val_auprc_score: 0.9715; val_best_acc_score: 0.9348; val_best_f1_score: 0.9366; train_kl_reg_loss: 6356.9101; train_edge_recon_loss: 260352.9860; train_gene_expr_recon_loss: 85893.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352603.1571; train_optim_loss: 352603.1571; val_kl_reg_loss: 6475.0281; val_edge_recon_loss: 264482.0518; val_gene_expr_recon_loss: 85812.3559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356769.4352; val_optim_loss: 356769.4352
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9772; val_auprc_score: 0.9701; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 6358.0789; train_edge_recon_loss: 260341.0910; train_gene_expr_recon_loss: 85696.7050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352395.8749; train_optim_loss: 352395.8749; val_kl_reg_loss: 6403.2374; val_edge_recon_loss: 264703.7627; val_gene_expr_recon_loss: 85625.3685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356732.3678; val_optim_loss: 356732.3678
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9783; val_auprc_score: 0.9719; val_best_acc_score: 0.9353; val_best_f1_score: 0.9370; train_kl_reg_loss: 6357.2014; train_edge_recon_loss: 260289.3709; train_gene_expr_recon_loss: 85563.5700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 352210.1421; train_optim_loss: 352210.1421; val_kl_reg_loss: 6401.7626; val_edge_recon_loss: 264574.3562; val_gene_expr_recon_loss: 85383.6047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356359.7239; val_optim_loss: 356359.7239
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9787; val_auprc_score: 0.9727; val_best_acc_score: 0.9356; val_best_f1_score: 0.9370; train_kl_reg_loss: 6361.5528; train_edge_recon_loss: 260108.1408; train_gene_expr_recon_loss: 85420.1430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351889.8368; train_optim_loss: 351889.8368; val_kl_reg_loss: 6598.8552; val_edge_recon_loss: 264837.8360; val_gene_expr_recon_loss: 85318.2939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356754.9853; val_optim_loss: 356754.9853
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9766; val_auprc_score: 0.9692; val_best_acc_score: 0.9339; val_best_f1_score: 0.9356; train_kl_reg_loss: 6359.1149; train_edge_recon_loss: 260262.4886; train_gene_expr_recon_loss: 85255.4769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351877.0803; train_optim_loss: 351877.0803; val_kl_reg_loss: 6493.9027; val_edge_recon_loss: 264797.6986; val_gene_expr_recon_loss: 85303.1037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356594.7046; val_optim_loss: 356594.7046
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9776; val_auprc_score: 0.9708; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 6361.5068; train_edge_recon_loss: 260253.0881; train_gene_expr_recon_loss: 85096.7406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351711.3354; train_optim_loss: 351711.3354; val_kl_reg_loss: 6443.2958; val_edge_recon_loss: 264756.7288; val_gene_expr_recon_loss: 84934.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356134.5147; val_optim_loss: 356134.5147
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9779; val_auprc_score: 0.9708; val_best_acc_score: 0.9347; val_best_f1_score: 0.9365; train_kl_reg_loss: 6359.3805; train_edge_recon_loss: 260136.9274; train_gene_expr_recon_loss: 84980.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351476.9899; train_optim_loss: 351476.9899; val_kl_reg_loss: 6573.2238; val_edge_recon_loss: 264710.9411; val_gene_expr_recon_loss: 84983.3716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356267.5371; val_optim_loss: 356267.5371
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9776; val_auprc_score: 0.9703; val_best_acc_score: 0.9351; val_best_f1_score: 0.9371; train_kl_reg_loss: 6359.1214; train_edge_recon_loss: 260275.6743; train_gene_expr_recon_loss: 84862.4424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351497.2379; train_optim_loss: 351497.2379; val_kl_reg_loss: 6429.4839; val_edge_recon_loss: 264400.7989; val_gene_expr_recon_loss: 84982.7717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355813.0534; val_optim_loss: 355813.0534
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9775; val_auprc_score: 0.9704; val_best_acc_score: 0.9353; val_best_f1_score: 0.9372; train_kl_reg_loss: 6357.5889; train_edge_recon_loss: 260317.0967; train_gene_expr_recon_loss: 84778.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351453.3227; train_optim_loss: 351453.3227; val_kl_reg_loss: 6407.8406; val_edge_recon_loss: 264908.4851; val_gene_expr_recon_loss: 84735.1462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 356051.4712; val_optim_loss: 356051.4712
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9780; val_auprc_score: 0.9709; val_best_acc_score: 0.9353; val_best_f1_score: 0.9371; train_kl_reg_loss: 6356.0336; train_edge_recon_loss: 260191.8817; train_gene_expr_recon_loss: 84666.0477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351213.9628; train_optim_loss: 351213.9628; val_kl_reg_loss: 6468.5722; val_edge_recon_loss: 264703.0547; val_gene_expr_recon_loss: 84733.1954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355904.8224; val_optim_loss: 355904.8224
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9784; val_auprc_score: 0.9719; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 6357.9650; train_edge_recon_loss: 260118.6328; train_gene_expr_recon_loss: 84526.3914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351002.9889; train_optim_loss: 351002.9889; val_kl_reg_loss: 6418.2174; val_edge_recon_loss: 264968.9616; val_gene_expr_recon_loss: 84519.0371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355906.2176; val_optim_loss: 355906.2176
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9781; val_auprc_score: 0.9710; val_best_acc_score: 0.9360; val_best_f1_score: 0.9379; train_kl_reg_loss: 6355.4000; train_edge_recon_loss: 260026.6968; train_gene_expr_recon_loss: 84513.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350895.4549; train_optim_loss: 350895.4549; val_kl_reg_loss: 6509.7582; val_edge_recon_loss: 264325.6704; val_gene_expr_recon_loss: 84527.9340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355363.3633; val_optim_loss: 355363.3633
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9790; val_auprc_score: 0.9721; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 6351.1093; train_edge_recon_loss: 260075.4707; train_gene_expr_recon_loss: 84391.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350817.7888; train_optim_loss: 350817.7888; val_kl_reg_loss: 6473.2350; val_edge_recon_loss: 264795.7547; val_gene_expr_recon_loss: 84454.5126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355723.5021; val_optim_loss: 355723.5021
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9790; val_auprc_score: 0.9723; val_best_acc_score: 0.9371; val_best_f1_score: 0.9387; train_kl_reg_loss: 6345.2051; train_edge_recon_loss: 259989.6177; train_gene_expr_recon_loss: 84338.5314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350673.3545; train_optim_loss: 350673.3545; val_kl_reg_loss: 6483.0068; val_edge_recon_loss: 264571.0958; val_gene_expr_recon_loss: 84321.3599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355375.4621; val_optim_loss: 355375.4621
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9796; val_auprc_score: 0.9735; val_best_acc_score: 0.9375; val_best_f1_score: 0.9391; train_kl_reg_loss: 6343.3837; train_edge_recon_loss: 260068.3650; train_gene_expr_recon_loss: 84244.0609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350655.8101; train_optim_loss: 350655.8101; val_kl_reg_loss: 6514.6052; val_edge_recon_loss: 264257.5004; val_gene_expr_recon_loss: 84375.3098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355147.4162; val_optim_loss: 355147.4162
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9797; val_auprc_score: 0.9734; val_best_acc_score: 0.9384; val_best_f1_score: 0.9401; train_kl_reg_loss: 6339.6130; train_edge_recon_loss: 260020.7725; train_gene_expr_recon_loss: 84155.1265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350515.5121; train_optim_loss: 350515.5121; val_kl_reg_loss: 6404.4606; val_edge_recon_loss: 263918.9509; val_gene_expr_recon_loss: 84235.5357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354558.9479; val_optim_loss: 354558.9479
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9789; val_auprc_score: 0.9726; val_best_acc_score: 0.9376; val_best_f1_score: 0.9393; train_kl_reg_loss: 6338.8041; train_edge_recon_loss: 259936.6844; train_gene_expr_recon_loss: 84118.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350394.0354; train_optim_loss: 350394.0354; val_kl_reg_loss: 6568.8383; val_edge_recon_loss: 264185.8464; val_gene_expr_recon_loss: 84139.9923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 354894.6775; val_optim_loss: 354894.6775
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9785; val_auprc_score: 0.9718; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 6339.7532; train_edge_recon_loss: 259847.8419; train_gene_expr_recon_loss: 84032.9080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350220.5030; train_optim_loss: 350220.5030; val_kl_reg_loss: 6470.9042; val_edge_recon_loss: 264626.6372; val_gene_expr_recon_loss: 84044.4889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355142.0309; val_optim_loss: 355142.0309
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9782; val_auprc_score: 0.9715; val_best_acc_score: 0.9363; val_best_f1_score: 0.9379; train_kl_reg_loss: 6335.8686; train_edge_recon_loss: 259771.0511; train_gene_expr_recon_loss: 84009.9335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350116.8531; train_optim_loss: 350116.8531; val_kl_reg_loss: 6532.8536; val_edge_recon_loss: 264594.3421; val_gene_expr_recon_loss: 84067.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355194.7275; val_optim_loss: 355194.7275
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9775; val_auprc_score: 0.9700; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 6318.8879; train_edge_recon_loss: 259988.7536; train_gene_expr_recon_loss: 83943.7465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 350251.3879; train_optim_loss: 350251.3879; val_kl_reg_loss: 6581.7553; val_edge_recon_loss: 264719.2044; val_gene_expr_recon_loss: 83974.8761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 355275.8358; val_optim_loss: 355275.8358

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9806; val_auprc_score: 0.9752; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 6317.1547; train_edge_recon_loss: 259622.2141; train_gene_expr_recon_loss: 83178.0744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 349117.4433; train_optim_loss: 349117.4433; val_kl_reg_loss: 6510.2487; val_edge_recon_loss: 264034.2355; val_gene_expr_recon_loss: 83298.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353842.9169; val_optim_loss: 353842.9169
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9795; val_auprc_score: 0.9730; val_best_acc_score: 0.9388; val_best_f1_score: 0.9406; train_kl_reg_loss: 6303.2215; train_edge_recon_loss: 259610.6195; train_gene_expr_recon_loss: 83072.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348986.2073; train_optim_loss: 348986.2073; val_kl_reg_loss: 6575.3145; val_edge_recon_loss: 264189.5036; val_gene_expr_recon_loss: 83163.2923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353928.1098; val_optim_loss: 353928.1098
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9807; val_auprc_score: 0.9750; val_best_acc_score: 0.9410; val_best_f1_score: 0.9424; train_kl_reg_loss: 6297.1571; train_edge_recon_loss: 259514.0359; train_gene_expr_recon_loss: 83041.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348852.7664; train_optim_loss: 348852.7664; val_kl_reg_loss: 6509.2121; val_edge_recon_loss: 263586.5999; val_gene_expr_recon_loss: 83219.4747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353315.2874; val_optim_loss: 353315.2874
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9802; val_auprc_score: 0.9739; val_best_acc_score: 0.9403; val_best_f1_score: 0.9417; train_kl_reg_loss: 6303.0473; train_edge_recon_loss: 259584.8587; train_gene_expr_recon_loss: 83027.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348915.5326; train_optim_loss: 348915.5326; val_kl_reg_loss: 6568.1176; val_edge_recon_loss: 264150.0925; val_gene_expr_recon_loss: 83164.3901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353882.6002; val_optim_loss: 353882.6002
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9810; val_auprc_score: 0.9752; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 6301.7175; train_edge_recon_loss: 259525.8543; train_gene_expr_recon_loss: 83024.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348851.8553; train_optim_loss: 348851.8553; val_kl_reg_loss: 6518.8490; val_edge_recon_loss: 263660.8245; val_gene_expr_recon_loss: 83209.1326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353388.8066; val_optim_loss: 353388.8066
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9814; val_auprc_score: 0.9761; val_best_acc_score: 0.9414; val_best_f1_score: 0.9431; train_kl_reg_loss: 6297.1953; train_edge_recon_loss: 259512.2074; train_gene_expr_recon_loss: 82970.2307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348779.6340; train_optim_loss: 348779.6340; val_kl_reg_loss: 6576.3812; val_edge_recon_loss: 263721.7438; val_gene_expr_recon_loss: 83091.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353390.0488; val_optim_loss: 353390.0488
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9807; val_auprc_score: 0.9743; val_best_acc_score: 0.9416; val_best_f1_score: 0.9430; train_kl_reg_loss: 6294.4749; train_edge_recon_loss: 259473.9908; train_gene_expr_recon_loss: 82967.4692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348735.9346; train_optim_loss: 348735.9346; val_kl_reg_loss: 6535.5280; val_edge_recon_loss: 263804.4941; val_gene_expr_recon_loss: 83084.2659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353424.2879; val_optim_loss: 353424.2879

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9810; val_auprc_score: 0.9749; val_best_acc_score: 0.9421; val_best_f1_score: 0.9436; train_kl_reg_loss: 6294.9720; train_edge_recon_loss: 259378.4800; train_gene_expr_recon_loss: 82892.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348565.6675; train_optim_loss: 348565.6675; val_kl_reg_loss: 6568.7768; val_edge_recon_loss: 263909.6677; val_gene_expr_recon_loss: 83025.5383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353503.9821; val_optim_loss: 353503.9821
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9808; val_auprc_score: 0.9749; val_best_acc_score: 0.9412; val_best_f1_score: 0.9428; train_kl_reg_loss: 6293.7894; train_edge_recon_loss: 259446.6829; train_gene_expr_recon_loss: 82879.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348619.5947; train_optim_loss: 348619.5947; val_kl_reg_loss: 6572.8552; val_edge_recon_loss: 263920.4801; val_gene_expr_recon_loss: 82990.3193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353483.6551; val_optim_loss: 353483.6551
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9812; val_auprc_score: 0.9757; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 6286.4468; train_edge_recon_loss: 259462.5232; train_gene_expr_recon_loss: 82914.7460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348663.7160; train_optim_loss: 348663.7160; val_kl_reg_loss: 6589.4612; val_edge_recon_loss: 263799.8004; val_gene_expr_recon_loss: 83073.5199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353462.7829; val_optim_loss: 353462.7829
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9807; val_auprc_score: 0.9747; val_best_acc_score: 0.9412; val_best_f1_score: 0.9426; train_kl_reg_loss: 6290.8463; train_edge_recon_loss: 259428.5350; train_gene_expr_recon_loss: 82886.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348605.3900; train_optim_loss: 348605.3900; val_kl_reg_loss: 6613.0589; val_edge_recon_loss: 263913.0979; val_gene_expr_recon_loss: 83075.1432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 353601.2995; val_optim_loss: 353601.2995

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 232 min 30 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9799
val AUPRC score: 0.9738
val best accuracy score: 0.9399
val best F1 score: 0.9416
val target rna MSE score: 0.3019
val source rna MSE score: 0.2280

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
