Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 3535.6952; train_edge_recon_loss: 27438.0259; train_gene_expr_recon_loss: 106355.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137329.1382; train_optim_loss: 137329.1382; val_kl_reg_loss: 3509.8749; val_edge_recon_loss: 26792.4554; val_gene_expr_recon_loss: 107037.6733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137340.0035; val_optim_loss: 137340.0035
None
Run timestamp: 06072023_035926_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9916; val_auprc_score: 0.9917; val_best_acc_score: 0.9522; val_best_f1_score: 0.9523; train_kl_reg_loss: 4467.7775; train_edge_recon_loss: 30520.7396; train_gene_expr_recon_loss: 137402.6239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172391.1409; train_optim_loss: 172391.1409; val_kl_reg_loss: 3742.4445; val_edge_recon_loss: 28430.9023; val_gene_expr_recon_loss: 130105.3149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 162278.6610; val_optim_loss: 162278.6610
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9805; val_best_f1_score: 0.9805; train_kl_reg_loss: 3536.1847; train_edge_recon_loss: 27435.8942; train_gene_expr_recon_loss: 106356.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137328.2774; train_optim_loss: 137328.2774; val_kl_reg_loss: 3510.1410; val_edge_recon_loss: 26805.0112; val_gene_expr_recon_loss: 107036.0153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137351.1675; val_optim_loss: 137351.1675
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9952; val_auprc_score: 0.9952; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 3627.2248; train_edge_recon_loss: 28511.6014; train_gene_expr_recon_loss: 129174.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 161312.9504; train_optim_loss: 161312.9504; val_kl_reg_loss: 3543.6779; val_edge_recon_loss: 27711.9400; val_gene_expr_recon_loss: 128213.8070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159469.4247; val_optim_loss: 159469.4247
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9962; val_auprc_score: 0.9961; val_best_acc_score: 0.9694; val_best_f1_score: 0.9694; train_kl_reg_loss: 3538.3413; train_edge_recon_loss: 28068.4332; train_gene_expr_recon_loss: 128055.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159662.0192; train_optim_loss: 159662.0192; val_kl_reg_loss: 3613.5429; val_edge_recon_loss: 27385.2809; val_gene_expr_recon_loss: 128142.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159141.6958; val_optim_loss: 159141.6958
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.1542; train_edge_recon_loss: 27436.3798; train_gene_expr_recon_loss: 106362.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137335.1494; train_optim_loss: 137335.1494; val_kl_reg_loss: 3510.0034; val_edge_recon_loss: 26792.8977; val_gene_expr_recon_loss: 107028.4065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137331.3077; val_optim_loss: 137331.3077
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9967; val_auprc_score: 0.9967; val_best_acc_score: 0.9718; val_best_f1_score: 0.9719; train_kl_reg_loss: 3527.4037; train_edge_recon_loss: 27876.9479; train_gene_expr_recon_loss: 127164.7631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158569.1148; train_optim_loss: 158569.1148; val_kl_reg_loss: 3374.8588; val_edge_recon_loss: 27190.9012; val_gene_expr_recon_loss: 126048.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156614.3888; val_optim_loss: 156614.3888
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.3877; train_edge_recon_loss: 27434.0932; train_gene_expr_recon_loss: 106357.7748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137328.2559; train_optim_loss: 137328.2559; val_kl_reg_loss: 3509.8029; val_edge_recon_loss: 26797.6677; val_gene_expr_recon_loss: 107031.2555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137338.7262; val_optim_loss: 137338.7262
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9728; val_best_f1_score: 0.9729; train_kl_reg_loss: 3521.5975; train_edge_recon_loss: 27781.5994; train_gene_expr_recon_loss: 123070.6366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 154373.8334; train_optim_loss: 154373.8334; val_kl_reg_loss: 3501.7026; val_edge_recon_loss: 27113.8610; val_gene_expr_recon_loss: 127436.8653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158052.4291; val_optim_loss: 158052.4291
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9806; val_best_f1_score: 0.9806; train_kl_reg_loss: 3535.7860; train_edge_recon_loss: 27438.0168; train_gene_expr_recon_loss: 106362.1020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137335.9048; train_optim_loss: 137335.9048; val_kl_reg_loss: 3510.2952; val_edge_recon_loss: 26790.9824; val_gene_expr_recon_loss: 107045.1506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137346.4283; val_optim_loss: 137346.4283
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9971; val_auprc_score: 0.9971; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 3524.9462; train_edge_recon_loss: 27705.9897; train_gene_expr_recon_loss: 114359.4184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145590.3543; train_optim_loss: 145590.3543; val_kl_reg_loss: 3575.9422; val_edge_recon_loss: 27058.9424; val_gene_expr_recon_loss: 109446.5441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140081.4290; val_optim_loss: 140081.4290
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 3536.1690; train_edge_recon_loss: 27435.1408; train_gene_expr_recon_loss: 106355.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137326.6079; train_optim_loss: 137326.6079; val_kl_reg_loss: 3509.9735; val_edge_recon_loss: 26801.1358; val_gene_expr_recon_loss: 107020.1432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137331.2522; val_optim_loss: 137331.2522
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9751; val_best_f1_score: 0.9751; train_kl_reg_loss: 3527.5336; train_edge_recon_loss: 27656.4250; train_gene_expr_recon_loss: 108443.1872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139627.1459; train_optim_loss: 139627.1459; val_kl_reg_loss: 3458.0364; val_edge_recon_loss: 27001.0606; val_gene_expr_recon_loss: 107146.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137605.7407; val_optim_loss: 137605.7407
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 3529.0670; train_edge_recon_loss: 27625.0681; train_gene_expr_recon_loss: 106922.8608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138076.9959; train_optim_loss: 138076.9959; val_kl_reg_loss: 3570.5207; val_edge_recon_loss: 27010.5919; val_gene_expr_recon_loss: 106894.5386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137475.6510; val_optim_loss: 137475.6510
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.2232; train_edge_recon_loss: 27438.5113; train_gene_expr_recon_loss: 106358.5777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137333.3122; train_optim_loss: 137333.3122; val_kl_reg_loss: 3510.2335; val_edge_recon_loss: 26793.9390; val_gene_expr_recon_loss: 107040.8898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137345.0619; val_optim_loss: 137345.0619
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 3530.7953; train_edge_recon_loss: 27595.4723; train_gene_expr_recon_loss: 106586.2133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137712.4808; train_optim_loss: 137712.4808; val_kl_reg_loss: 3515.2562; val_edge_recon_loss: 26950.5245; val_gene_expr_recon_loss: 106935.4834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137401.2639; val_optim_loss: 137401.2639
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.2391; train_edge_recon_loss: 27436.9819; train_gene_expr_recon_loss: 106365.4114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137338.6326; train_optim_loss: 137338.6326; val_kl_reg_loss: 3510.2453; val_edge_recon_loss: 26790.4496; val_gene_expr_recon_loss: 107008.1092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137308.8044; val_optim_loss: 137308.8044
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 3532.5620; train_edge_recon_loss: 27573.4442; train_gene_expr_recon_loss: 106438.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137544.6372; train_optim_loss: 137544.6372; val_kl_reg_loss: 3501.9296; val_edge_recon_loss: 26928.5614; val_gene_expr_recon_loss: 106666.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137096.8618; val_optim_loss: 137096.8618
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 3536.1890; train_edge_recon_loss: 27436.9274; train_gene_expr_recon_loss: 106356.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137329.5865; train_optim_loss: 137329.5865; val_kl_reg_loss: 3510.4580; val_edge_recon_loss: 26783.1413; val_gene_expr_recon_loss: 107038.1034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137331.7022; val_optim_loss: 137331.7022
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9978; val_auprc_score: 0.9976; val_best_acc_score: 0.9779; val_best_f1_score: 0.9779; train_kl_reg_loss: 3534.5678; train_edge_recon_loss: 27554.0668; train_gene_expr_recon_loss: 106299.2916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137387.9263; train_optim_loss: 137387.9263; val_kl_reg_loss: 3529.9694; val_edge_recon_loss: 26908.9691; val_gene_expr_recon_loss: 106658.5142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137097.4520; val_optim_loss: 137097.4520
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 3536.2361; train_edge_recon_loss: 27436.0514; train_gene_expr_recon_loss: 106359.8559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137332.1434; train_optim_loss: 137332.1434; val_kl_reg_loss: 3510.5132; val_edge_recon_loss: 26804.8953; val_gene_expr_recon_loss: 107032.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137347.7342; val_optim_loss: 137347.7342
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9978; val_auprc_score: 0.9978; val_best_acc_score: 0.9776; val_best_f1_score: 0.9776; train_kl_reg_loss: 3537.2135; train_edge_recon_loss: 27540.2519; train_gene_expr_recon_loss: 106301.1578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137378.6234; train_optim_loss: 137378.6234; val_kl_reg_loss: 3497.9561; val_edge_recon_loss: 26895.6590; val_gene_expr_recon_loss: 106321.9778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136715.5932; val_optim_loss: 136715.5932
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9805; val_best_f1_score: 0.9805; train_kl_reg_loss: 3536.3810; train_edge_recon_loss: 27438.6540; train_gene_expr_recon_loss: 106358.6063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137333.6412; train_optim_loss: 137333.6412; val_kl_reg_loss: 3510.2525; val_edge_recon_loss: 26801.0332; val_gene_expr_recon_loss: 107048.8400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137360.1257; val_optim_loss: 137360.1257
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9979; val_auprc_score: 0.9978; val_best_acc_score: 0.9779; val_best_f1_score: 0.9779; train_kl_reg_loss: 3536.6351; train_edge_recon_loss: 27529.5422; train_gene_expr_recon_loss: 105995.2511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137061.4283; train_optim_loss: 137061.4283; val_kl_reg_loss: 3454.9825; val_edge_recon_loss: 26892.4646; val_gene_expr_recon_loss: 106493.9192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136841.3662; val_optim_loss: 136841.3662
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9980; val_auprc_score: 0.9979; val_best_acc_score: 0.9785; val_best_f1_score: 0.9785; train_kl_reg_loss: 3539.8090; train_edge_recon_loss: 27514.7236; train_gene_expr_recon_loss: 106022.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137077.4032; train_optim_loss: 137077.4032; val_kl_reg_loss: 3467.6793; val_edge_recon_loss: 26905.8760; val_gene_expr_recon_loss: 103326.5251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133700.0804; val_optim_loss: 133700.0804
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.0621; train_edge_recon_loss: 27436.6247; train_gene_expr_recon_loss: 106356.6604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137329.3473; train_optim_loss: 137329.3473; val_kl_reg_loss: 3510.5473; val_edge_recon_loss: 26781.1982; val_gene_expr_recon_loss: 107037.0543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137328.8001; val_optim_loss: 137328.8001
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9979; val_auprc_score: 0.9978; val_best_acc_score: 0.9786; val_best_f1_score: 0.9786; train_kl_reg_loss: 3542.1322; train_edge_recon_loss: 27505.1324; train_gene_expr_recon_loss: 105641.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136688.3610; train_optim_loss: 136688.3610; val_kl_reg_loss: 3504.0339; val_edge_recon_loss: 26864.0257; val_gene_expr_recon_loss: 106068.8781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136436.9379; val_optim_loss: 136436.9379

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9806; val_best_f1_score: 0.9806; train_kl_reg_loss: 3536.3417; train_edge_recon_loss: 27436.6889; train_gene_expr_recon_loss: 106355.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137328.2144; train_optim_loss: 137328.2144; val_kl_reg_loss: 3510.4862; val_edge_recon_loss: 26791.2824; val_gene_expr_recon_loss: 107038.6672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137340.4357; val_optim_loss: 137340.4357
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9782; val_best_f1_score: 0.9781; train_kl_reg_loss: 3542.1704; train_edge_recon_loss: 27497.6407; train_gene_expr_recon_loss: 105485.7502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136525.5613; train_optim_loss: 136525.5613; val_kl_reg_loss: 3539.2647; val_edge_recon_loss: 26860.7711; val_gene_expr_recon_loss: 105964.5746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136364.6106; val_optim_loss: 136364.6106
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9983; val_auprc_score: 0.9983; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 3536.4005; train_edge_recon_loss: 27440.3147; train_gene_expr_recon_loss: 106361.4889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137338.2041; train_optim_loss: 137338.2041; val_kl_reg_loss: 3510.4602; val_edge_recon_loss: 26796.6782; val_gene_expr_recon_loss: 107033.8334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137340.9716; val_optim_loss: 137340.9716
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 3545.0060; train_edge_recon_loss: 27493.5804; train_gene_expr_recon_loss: 105141.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136179.8094; train_optim_loss: 136179.8094; val_kl_reg_loss: 3412.9115; val_edge_recon_loss: 26872.8144; val_gene_expr_recon_loss: 104754.7925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135040.5183; val_optim_loss: 135040.5183
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.4642; train_edge_recon_loss: 27437.0180; train_gene_expr_recon_loss: 106352.4078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137325.8900; train_optim_loss: 137325.8900; val_kl_reg_loss: 3510.2737; val_edge_recon_loss: 26790.2143; val_gene_expr_recon_loss: 107050.4076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137350.8956; val_optim_loss: 137350.8956
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9977; val_best_acc_score: 0.9779; val_best_f1_score: 0.9779; train_kl_reg_loss: 3546.9542; train_edge_recon_loss: 27480.9644; train_gene_expr_recon_loss: 104935.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135963.9130; train_optim_loss: 135963.9130; val_kl_reg_loss: 3516.5953; val_edge_recon_loss: 26872.3461; val_gene_expr_recon_loss: 106038.2892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136427.2306; val_optim_loss: 136427.2306

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9982; val_auprc_score: 0.9981; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 3568.4444; train_edge_recon_loss: 27410.4725; train_gene_expr_recon_loss: 104203.0844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135182.0013; train_optim_loss: 135182.0013; val_kl_reg_loss: 3544.7772; val_edge_recon_loss: 26817.5017; val_gene_expr_recon_loss: 105714.7987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136077.0773; val_optim_loss: 136077.0773
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9983; val_auprc_score: 0.9983; val_best_acc_score: 0.9807; val_best_f1_score: 0.9807; train_kl_reg_loss: 3536.2775; train_edge_recon_loss: 27434.6021; train_gene_expr_recon_loss: 106358.5620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137329.4417; train_optim_loss: 137329.4417; val_kl_reg_loss: 3510.4627; val_edge_recon_loss: 26782.1773; val_gene_expr_recon_loss: 107037.9979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137330.6379; val_optim_loss: 137330.6379

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1882 min 38 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9983
Val AUPRC score: 0.9982
Val best accuracy score: 0.9808
Val best F1 score: 0.9808
Val gene expr MSE score: 8.3501

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9984; val_auprc_score: 0.9984; val_best_acc_score: 0.9808; val_best_f1_score: 0.9808; train_kl_reg_loss: 3552.5234; train_edge_recon_loss: 27429.7855; train_gene_expr_recon_loss: 104044.5242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135026.8330; train_optim_loss: 135026.8330; val_kl_reg_loss: 3542.0941; val_edge_recon_loss: 26818.2816; val_gene_expr_recon_loss: 104486.0544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134846.4298; val_optim_loss: 134846.4298
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9983; val_auprc_score: 0.9982; val_best_acc_score: 0.9805; val_best_f1_score: 0.9805; train_kl_reg_loss: 3548.5837; train_edge_recon_loss: 27429.7221; train_gene_expr_recon_loss: 104054.4053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135032.7112; train_optim_loss: 135032.7112; val_kl_reg_loss: 3524.1106; val_edge_recon_loss: 26834.9333; val_gene_expr_recon_loss: 105726.0567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136085.1005; val_optim_loss: 136085.1005
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9984; val_auprc_score: 0.9983; val_best_acc_score: 0.9810; val_best_f1_score: 0.9810; train_kl_reg_loss: 3547.6046; train_edge_recon_loss: 27432.7578; train_gene_expr_recon_loss: 104029.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135010.3555; train_optim_loss: 135010.3555; val_kl_reg_loss: 3515.3552; val_edge_recon_loss: 26842.6723; val_gene_expr_recon_loss: 104695.8727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135053.9000; val_optim_loss: 135053.9000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 695 min 5 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9979
Val AUPRC score: 0.9978
Val best accuracy score: 0.9787
Val best F1 score: 0.9787
Val gene expr MSE score: 8.5647

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
