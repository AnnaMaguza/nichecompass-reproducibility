None
Run timestamp: 15072023_072111_146.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_146']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9801; val_auprc_score: 0.9723; val_best_acc_score: 0.9437; val_best_f1_score: 0.9449; train_kl_reg_loss: 29151.9335; train_edge_recon_loss: 2716057.5170; train_gene_expr_recon_loss: 1228538.5241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3973747.9803; train_optim_loss: 3973747.9803; val_kl_reg_loss: 29969.2692; val_edge_recon_loss: 2627090.7561; val_gene_expr_recon_loss: 1115937.8232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3772997.8537; val_optim_loss: 3772997.8537
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9840; val_auprc_score: 0.9782; val_best_acc_score: 0.9506; val_best_f1_score: 0.9519; train_kl_reg_loss: 27714.9721; train_edge_recon_loss: 2606734.1019; train_gene_expr_recon_loss: 1090836.1153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3725285.1929; train_optim_loss: 3725285.1929; val_kl_reg_loss: 24888.6535; val_edge_recon_loss: 2608434.7805; val_gene_expr_recon_loss: 1069290.8963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3702614.3171; val_optim_loss: 3702614.3171
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9855; val_auprc_score: 0.9798; val_best_acc_score: 0.9562; val_best_f1_score: 0.9572; train_kl_reg_loss: 24795.8325; train_edge_recon_loss: 2596465.9355; train_gene_expr_recon_loss: 1053926.3903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3675188.1515; train_optim_loss: 3675188.1515; val_kl_reg_loss: 23748.1009; val_edge_recon_loss: 2596701.6098; val_gene_expr_recon_loss: 1042410.0396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3662859.7561; val_optim_loss: 3662859.7561
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9865; val_auprc_score: 0.9811; val_best_acc_score: 0.9586; val_best_f1_score: 0.9595; train_kl_reg_loss: 23630.7944; train_edge_recon_loss: 2588922.0632; train_gene_expr_recon_loss: 1029707.3595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3642260.2147; train_optim_loss: 3642260.2147; val_kl_reg_loss: 22717.4523; val_edge_recon_loss: 2596367.9085; val_gene_expr_recon_loss: 1023279.2348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3642364.6159; val_optim_loss: 3642364.6159
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9869; val_auprc_score: 0.9818; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 22390.6344; train_edge_recon_loss: 2586143.0469; train_gene_expr_recon_loss: 1012720.0904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3621253.7561; train_optim_loss: 3621253.7561; val_kl_reg_loss: 21441.2691; val_edge_recon_loss: 2592116.9512; val_gene_expr_recon_loss: 1008523.2043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3622081.4451; val_optim_loss: 3622081.4451
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9885; val_auprc_score: 0.9839; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 21559.2333; train_edge_recon_loss: 2580633.1148; train_gene_expr_recon_loss: 1000912.2724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3603104.6182; train_optim_loss: 3603104.6182; val_kl_reg_loss: 20452.6169; val_edge_recon_loss: 2587522.2195; val_gene_expr_recon_loss: 996818.4162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3604793.2439; val_optim_loss: 3604793.2439
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9898; val_auprc_score: 0.9865; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 20706.8192; train_edge_recon_loss: 2578543.2364; train_gene_expr_recon_loss: 990863.3392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3590113.3933; train_optim_loss: 3590113.3933; val_kl_reg_loss: 19633.9625; val_edge_recon_loss: 2586738.3841; val_gene_expr_recon_loss: 991404.3765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3597776.7439; val_optim_loss: 3597776.7439
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9903; val_auprc_score: 0.9865; val_best_acc_score: 0.9660; val_best_f1_score: 0.9666; train_kl_reg_loss: 20046.2649; train_edge_recon_loss: 2577567.3023; train_gene_expr_recon_loss: 982998.8037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3580612.3662; train_optim_loss: 3580612.3662; val_kl_reg_loss: 19473.1998; val_edge_recon_loss: 2588184.5366; val_gene_expr_recon_loss: 983780.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3591438.1159; val_optim_loss: 3591438.1159
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9902; val_auprc_score: 0.9869; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 19489.0918; train_edge_recon_loss: 2574183.7201; train_gene_expr_recon_loss: 976686.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3570359.1950; train_optim_loss: 3570359.1950; val_kl_reg_loss: 18884.1078; val_edge_recon_loss: 2583043.6524; val_gene_expr_recon_loss: 980591.8216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3582519.5976; val_optim_loss: 3582519.5976
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9914; val_auprc_score: 0.9881; val_best_acc_score: 0.9682; val_best_f1_score: 0.9689; train_kl_reg_loss: 18990.6041; train_edge_recon_loss: 2573564.7874; train_gene_expr_recon_loss: 971127.4679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3563682.8668; train_optim_loss: 3563682.8668; val_kl_reg_loss: 18237.3344; val_edge_recon_loss: 2577646.5305; val_gene_expr_recon_loss: 978604.8796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3574488.7378; val_optim_loss: 3574488.7378
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9696; val_best_f1_score: 0.9702; train_kl_reg_loss: 18592.8138; train_edge_recon_loss: 2570655.0605; train_gene_expr_recon_loss: 965321.0314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3554568.9110; train_optim_loss: 3554568.9110; val_kl_reg_loss: 18082.0266; val_edge_recon_loss: 2574195.2439; val_gene_expr_recon_loss: 974503.8216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566781.0915; val_optim_loss: 3566781.0915
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 18300.0679; train_edge_recon_loss: 2568634.2079; train_gene_expr_recon_loss: 962107.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3549042.1338; train_optim_loss: 3549042.1338; val_kl_reg_loss: 17688.4052; val_edge_recon_loss: 2578604.2195; val_gene_expr_recon_loss: 970414.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566707.1585; val_optim_loss: 3566707.1585
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9926; val_auprc_score: 0.9904; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 17941.4708; train_edge_recon_loss: 2568740.8920; train_gene_expr_recon_loss: 957524.3434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3544206.7058; train_optim_loss: 3544206.7058; val_kl_reg_loss: 17420.2791; val_edge_recon_loss: 2576027.8537; val_gene_expr_recon_loss: 969618.6540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3563066.7683; val_optim_loss: 3563066.7683
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9924; val_auprc_score: 0.9900; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 17709.8920; train_edge_recon_loss: 2567048.7113; train_gene_expr_recon_loss: 953854.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3538612.6821; train_optim_loss: 3538612.6821; val_kl_reg_loss: 17180.4275; val_edge_recon_loss: 2575691.3110; val_gene_expr_recon_loss: 968734.3598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3561606.0549; val_optim_loss: 3561606.0549
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 17479.4930; train_edge_recon_loss: 2566611.9171; train_gene_expr_recon_loss: 951542.7843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3535634.1902; train_optim_loss: 3535634.1902; val_kl_reg_loss: 16854.8398; val_edge_recon_loss: 2572367.6220; val_gene_expr_recon_loss: 966065.1921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3555287.6707; val_optim_loss: 3555287.6707
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9928; val_auprc_score: 0.9901; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 17254.5178; train_edge_recon_loss: 2565065.3546; train_gene_expr_recon_loss: 947426.2232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3529746.0992; train_optim_loss: 3529746.0992; val_kl_reg_loss: 16945.0838; val_edge_recon_loss: 2570977.7622; val_gene_expr_recon_loss: 962168.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550091.7683; val_optim_loss: 3550091.7683
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 17022.4379; train_edge_recon_loss: 2564924.0965; train_gene_expr_recon_loss: 945478.5735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3527425.1080; train_optim_loss: 3527425.1080; val_kl_reg_loss: 16286.0877; val_edge_recon_loss: 2571669.2317; val_gene_expr_recon_loss: 962895.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550851.1646; val_optim_loss: 3550851.1646
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9730; val_best_f1_score: 0.9735; train_kl_reg_loss: 16905.6330; train_edge_recon_loss: 2563689.9728; train_gene_expr_recon_loss: 942124.7758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3522720.3784; train_optim_loss: 3522720.3784; val_kl_reg_loss: 16723.8644; val_edge_recon_loss: 2573936.0061; val_gene_expr_recon_loss: 959647.6479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550307.5244; val_optim_loss: 3550307.5244
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 16795.9169; train_edge_recon_loss: 2562924.2052; train_gene_expr_recon_loss: 941005.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3520726.0734; train_optim_loss: 3520726.0734; val_kl_reg_loss: 16147.6714; val_edge_recon_loss: 2575667.9512; val_gene_expr_recon_loss: 962030.9040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3553846.5183; val_optim_loss: 3553846.5183
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 16614.8643; train_edge_recon_loss: 2562728.3954; train_gene_expr_recon_loss: 938350.7999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3517694.0605; train_optim_loss: 3517694.0605; val_kl_reg_loss: 16176.6632; val_edge_recon_loss: 2570838.6524; val_gene_expr_recon_loss: 962528.8155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3549544.1220; val_optim_loss: 3549544.1220
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 16493.7279; train_edge_recon_loss: 2561718.2894; train_gene_expr_recon_loss: 936483.5374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3514695.5577; train_optim_loss: 3514695.5577; val_kl_reg_loss: 15909.2125; val_edge_recon_loss: 2571994.0000; val_gene_expr_recon_loss: 960966.3872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548869.5915; val_optim_loss: 3548869.5915
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 16374.6012; train_edge_recon_loss: 2561643.0666; train_gene_expr_recon_loss: 934083.0944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3512100.7649; train_optim_loss: 3512100.7649; val_kl_reg_loss: 15827.5566; val_edge_recon_loss: 2572126.4878; val_gene_expr_recon_loss: 960253.0107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548207.0427; val_optim_loss: 3548207.0427
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9750; val_best_f1_score: 0.9754; train_kl_reg_loss: 16279.9812; train_edge_recon_loss: 2561240.9334; train_gene_expr_recon_loss: 931950.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3509470.9192; train_optim_loss: 3509470.9192; val_kl_reg_loss: 15973.0453; val_edge_recon_loss: 2570263.2256; val_gene_expr_recon_loss: 962952.4466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3549188.7256; val_optim_loss: 3549188.7256
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 16182.1862; train_edge_recon_loss: 2560730.4599; train_gene_expr_recon_loss: 931017.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3507930.4457; train_optim_loss: 3507930.4457; val_kl_reg_loss: 15931.2515; val_edge_recon_loss: 2571895.0732; val_gene_expr_recon_loss: 962932.2835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3550758.5976; val_optim_loss: 3550758.5976
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 16154.7625; train_edge_recon_loss: 2559391.2772; train_gene_expr_recon_loss: 928631.4715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3504177.5163; train_optim_loss: 3504177.5163; val_kl_reg_loss: 15795.4235; val_edge_recon_loss: 2570740.5549; val_gene_expr_recon_loss: 960255.8887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3546791.8537; val_optim_loss: 3546791.8537
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9760; val_best_f1_score: 0.9764; train_kl_reg_loss: 16031.9949; train_edge_recon_loss: 2559608.9592; train_gene_expr_recon_loss: 927795.6807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3503436.6325; train_optim_loss: 3503436.6325; val_kl_reg_loss: 15854.7748; val_edge_recon_loss: 2569012.5793; val_gene_expr_recon_loss: 959004.2744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543871.6768; val_optim_loss: 3543871.6768
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 16012.0185; train_edge_recon_loss: 2560551.7147; train_gene_expr_recon_loss: 926726.6625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3503290.3988; train_optim_loss: 3503290.3988; val_kl_reg_loss: 15627.8856; val_edge_recon_loss: 2566530.4024; val_gene_expr_recon_loss: 959703.7591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541862.0305; val_optim_loss: 3541862.0305
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9942; val_auprc_score: 0.9922; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 15922.6128; train_edge_recon_loss: 2559454.5802; train_gene_expr_recon_loss: 924073.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3499450.4178; train_optim_loss: 3499450.4178; val_kl_reg_loss: 15626.9356; val_edge_recon_loss: 2570202.3598; val_gene_expr_recon_loss: 960271.8979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3546101.1829; val_optim_loss: 3546101.1829
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 15906.1310; train_edge_recon_loss: 2558947.6671; train_gene_expr_recon_loss: 922873.6987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3497727.5007; train_optim_loss: 3497727.5007; val_kl_reg_loss: 15487.1901; val_edge_recon_loss: 2566240.0244; val_gene_expr_recon_loss: 960246.4284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541973.6463; val_optim_loss: 3541973.6463
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 15851.5505; train_edge_recon_loss: 2558546.5924; train_gene_expr_recon_loss: 921614.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3496013.0774; train_optim_loss: 3496013.0774; val_kl_reg_loss: 15607.1873; val_edge_recon_loss: 2567149.5915; val_gene_expr_recon_loss: 961977.0579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544733.8537; val_optim_loss: 3544733.8537
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 15834.4928; train_edge_recon_loss: 2557996.2745; train_gene_expr_recon_loss: 920522.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3494353.6678; train_optim_loss: 3494353.6678; val_kl_reg_loss: 15617.0331; val_edge_recon_loss: 2565828.5000; val_gene_expr_recon_loss: 962312.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543758.4268; val_optim_loss: 3543758.4268

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9942; val_auprc_score: 0.9919; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 16083.3710; train_edge_recon_loss: 2556726.8370; train_gene_expr_recon_loss: 912300.7835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3485110.9864; train_optim_loss: 3485110.9864; val_kl_reg_loss: 15874.1668; val_edge_recon_loss: 2566396.0549; val_gene_expr_recon_loss: 957645.7226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539915.9390; val_optim_loss: 3539915.9390
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 16159.3856; train_edge_recon_loss: 2555766.6019; train_gene_expr_recon_loss: 910112.3806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482038.3675; train_optim_loss: 3482038.3675; val_kl_reg_loss: 15902.4930; val_edge_recon_loss: 2565006.2195; val_gene_expr_recon_loss: 956489.5015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537398.2378; val_optim_loss: 3537398.2378
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9945; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 16144.5375; train_edge_recon_loss: 2556704.6821; train_gene_expr_recon_loss: 911415.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484264.3560; train_optim_loss: 3484264.3560; val_kl_reg_loss: 15905.2079; val_edge_recon_loss: 2565607.2500; val_gene_expr_recon_loss: 958926.9497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3540439.4024; val_optim_loss: 3540439.4024
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 16167.0544; train_edge_recon_loss: 2555747.7989; train_gene_expr_recon_loss: 910227.7950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482142.6420; train_optim_loss: 3482142.6420; val_kl_reg_loss: 15886.7435; val_edge_recon_loss: 2565703.6707; val_gene_expr_recon_loss: 957993.9695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539584.4024; val_optim_loss: 3539584.4024
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 16162.8549; train_edge_recon_loss: 2555756.7745; train_gene_expr_recon_loss: 910953.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482873.5143; train_optim_loss: 3482873.5143; val_kl_reg_loss: 15839.0790; val_edge_recon_loss: 2561844.8963; val_gene_expr_recon_loss: 958923.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536607.1768; val_optim_loss: 3536607.1768
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 16125.9663; train_edge_recon_loss: 2555842.6026; train_gene_expr_recon_loss: 911380.4260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3483348.9905; train_optim_loss: 3483348.9905; val_kl_reg_loss: 15840.6767; val_edge_recon_loss: 2565118.7317; val_gene_expr_recon_loss: 960823.8369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541783.2256; val_optim_loss: 3541783.2256
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 16064.5196; train_edge_recon_loss: 2557035.4647; train_gene_expr_recon_loss: 909535.6943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482635.6807; train_optim_loss: 3482635.6807; val_kl_reg_loss: 15886.5034; val_edge_recon_loss: 2565817.5244; val_gene_expr_recon_loss: 959716.7820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541420.8171; val_optim_loss: 3541420.8171
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 16108.2319; train_edge_recon_loss: 2555885.5564; train_gene_expr_recon_loss: 909037.4789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3481031.2649; train_optim_loss: 3481031.2649; val_kl_reg_loss: 15855.9759; val_edge_recon_loss: 2567011.4085; val_gene_expr_recon_loss: 960061.0274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542928.4268; val_optim_loss: 3542928.4268
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 16115.0416; train_edge_recon_loss: 2556107.2853; train_gene_expr_recon_loss: 909839.8339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3482062.1692; train_optim_loss: 3482062.1692; val_kl_reg_loss: 15831.5413; val_edge_recon_loss: 2565928.5915; val_gene_expr_recon_loss: 958501.5030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3540261.6341; val_optim_loss: 3540261.6341

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 16121.4411; train_edge_recon_loss: 2555462.7045; train_gene_expr_recon_loss: 908278.0722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3479862.2167; train_optim_loss: 3479862.2167; val_kl_reg_loss: 15833.6039; val_edge_recon_loss: 2562782.0549; val_gene_expr_recon_loss: 959616.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538232.3293; val_optim_loss: 3538232.3293
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9950; val_auprc_score: 0.9932; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 16117.9480; train_edge_recon_loss: 2555729.8825; train_gene_expr_recon_loss: 908082.7480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3479930.5700; train_optim_loss: 3479930.5700; val_kl_reg_loss: 15825.2046; val_edge_recon_loss: 2563715.1768; val_gene_expr_recon_loss: 958417.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537958.0061; val_optim_loss: 3537958.0061
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 16108.6779; train_edge_recon_loss: 2556647.3417; train_gene_expr_recon_loss: 907945.8288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3480701.8410; train_optim_loss: 3480701.8410; val_kl_reg_loss: 15795.7982; val_edge_recon_loss: 2563418.8659; val_gene_expr_recon_loss: 960562.7104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539777.3841; val_optim_loss: 3539777.3841
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 16100.8196; train_edge_recon_loss: 2556677.2656; train_gene_expr_recon_loss: 908167.1540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3480945.2337; train_optim_loss: 3480945.2337; val_kl_reg_loss: 15798.8999; val_edge_recon_loss: 2562874.3354; val_gene_expr_recon_loss: 958676.7256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537349.9329; val_optim_loss: 3537349.9329

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 124 min 32 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9947
Val AUPRC score: 0.9930
Val best accuracy score: 0.9783
Val best F1 score: 0.9785
Val gene expr MSE score: 0.6095

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
