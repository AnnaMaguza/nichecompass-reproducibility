None
Run timestamp: 30062023_234511_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9865; val_auprc_score: 0.9866; val_best_acc_score: 0.9390; val_best_f1_score: 0.9391; train_kl_reg_loss: 5015.9105; train_edge_recon_loss: 31655.2246; train_gene_expr_recon_loss: 145233.0943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181904.2293; train_optim_loss: 181904.2293; val_kl_reg_loss: 4190.4769; val_edge_recon_loss: 29808.8366; val_gene_expr_recon_loss: 135121.4322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169120.7457; val_optim_loss: 169120.7457
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9913; val_best_acc_score: 0.9519; val_best_f1_score: 0.9520; train_kl_reg_loss: 4004.6378; train_edge_recon_loss: 29332.5147; train_gene_expr_recon_loss: 132830.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166167.6957; train_optim_loss: 166167.6957; val_kl_reg_loss: 3822.1851; val_edge_recon_loss: 28600.6565; val_gene_expr_recon_loss: 130907.8658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163330.7079; val_optim_loss: 163330.7079
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9930; val_auprc_score: 0.9930; val_best_acc_score: 0.9570; val_best_f1_score: 0.9572; train_kl_reg_loss: 3770.6809; train_edge_recon_loss: 28691.0071; train_gene_expr_recon_loss: 129891.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162353.2566; train_optim_loss: 162353.2566; val_kl_reg_loss: 3582.8418; val_edge_recon_loss: 28080.1239; val_gene_expr_recon_loss: 129096.7966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160759.7623; val_optim_loss: 160759.7623
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9943; val_auprc_score: 0.9943; val_best_acc_score: 0.9618; val_best_f1_score: 0.9618; train_kl_reg_loss: 3675.5061; train_edge_recon_loss: 28353.4349; train_gene_expr_recon_loss: 128601.7043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160630.6452; train_optim_loss: 160630.6452; val_kl_reg_loss: 3594.5155; val_edge_recon_loss: 27780.5767; val_gene_expr_recon_loss: 128184.4269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159559.5194; val_optim_loss: 159559.5194
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9646; val_best_f1_score: 0.9646; train_kl_reg_loss: 3646.4738; train_edge_recon_loss: 28128.8397; train_gene_expr_recon_loss: 127909.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159685.1065; train_optim_loss: 159685.1065; val_kl_reg_loss: 3604.4613; val_edge_recon_loss: 27580.1822; val_gene_expr_recon_loss: 127568.9833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158753.6273; val_optim_loss: 158753.6273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9952; val_best_acc_score: 0.9654; val_best_f1_score: 0.9655; train_kl_reg_loss: 3638.7924; train_edge_recon_loss: 27991.4442; train_gene_expr_recon_loss: 127437.3770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159067.6138; train_optim_loss: 159067.6138; val_kl_reg_loss: 3572.3181; val_edge_recon_loss: 27426.5791; val_gene_expr_recon_loss: 127329.4801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158328.3775; val_optim_loss: 158328.3775
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9958; val_best_acc_score: 0.9673; val_best_f1_score: 0.9673; train_kl_reg_loss: 3644.8806; train_edge_recon_loss: 27890.6092; train_gene_expr_recon_loss: 127094.3291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158629.8191; train_optim_loss: 158629.8191; val_kl_reg_loss: 3615.2882; val_edge_recon_loss: 27360.4357; val_gene_expr_recon_loss: 127023.0035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157998.7280; val_optim_loss: 157998.7280
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9959; val_best_acc_score: 0.9680; val_best_f1_score: 0.9680; train_kl_reg_loss: 3651.7121; train_edge_recon_loss: 27823.6828; train_gene_expr_recon_loss: 126779.4835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158254.8783; train_optim_loss: 158254.8783; val_kl_reg_loss: 3607.7515; val_edge_recon_loss: 27335.4876; val_gene_expr_recon_loss: 126864.5416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157807.7806; val_optim_loss: 157807.7806
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9962; val_auprc_score: 0.9961; val_best_acc_score: 0.9693; val_best_f1_score: 0.9693; train_kl_reg_loss: 3659.7925; train_edge_recon_loss: 27766.1080; train_gene_expr_recon_loss: 126598.8132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158024.7136; train_optim_loss: 158024.7136; val_kl_reg_loss: 3574.8328; val_edge_recon_loss: 27265.0824; val_gene_expr_recon_loss: 126870.9562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157710.8706; val_optim_loss: 157710.8706
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9966; val_auprc_score: 0.9965; val_best_acc_score: 0.9712; val_best_f1_score: 0.9713; train_kl_reg_loss: 3667.8356; train_edge_recon_loss: 27728.5554; train_gene_expr_recon_loss: 126429.1380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157825.5289; train_optim_loss: 157825.5289; val_kl_reg_loss: 3623.2092; val_edge_recon_loss: 27236.1195; val_gene_expr_recon_loss: 126665.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157524.3388; val_optim_loss: 157524.3388
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9965; val_auprc_score: 0.9965; val_best_acc_score: 0.9709; val_best_f1_score: 0.9709; train_kl_reg_loss: 3676.3670; train_edge_recon_loss: 27691.5171; train_gene_expr_recon_loss: 126281.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157649.3023; train_optim_loss: 157649.3023; val_kl_reg_loss: 3651.4910; val_edge_recon_loss: 27216.2355; val_gene_expr_recon_loss: 126536.0951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157403.8212; val_optim_loss: 157403.8212
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9965; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 3680.8209; train_edge_recon_loss: 27672.4583; train_gene_expr_recon_loss: 126142.5305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157495.8097; train_optim_loss: 157495.8097; val_kl_reg_loss: 3625.5323; val_edge_recon_loss: 27164.2179; val_gene_expr_recon_loss: 126535.5822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157325.3327; val_optim_loss: 157325.3327
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9721; val_best_f1_score: 0.9721; train_kl_reg_loss: 3692.6395; train_edge_recon_loss: 27630.9956; train_gene_expr_recon_loss: 126042.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157366.0479; train_optim_loss: 157366.0479; val_kl_reg_loss: 3589.8152; val_edge_recon_loss: 27203.5025; val_gene_expr_recon_loss: 126486.6194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157279.9372; val_optim_loss: 157279.9372
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9968; val_best_acc_score: 0.9727; val_best_f1_score: 0.9727; train_kl_reg_loss: 3696.6858; train_edge_recon_loss: 27618.5591; train_gene_expr_recon_loss: 125944.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157259.9907; train_optim_loss: 157259.9907; val_kl_reg_loss: 3634.5338; val_edge_recon_loss: 27156.4729; val_gene_expr_recon_loss: 126226.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157017.9202; val_optim_loss: 157017.9202
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9969; val_auprc_score: 0.9969; val_best_acc_score: 0.9731; val_best_f1_score: 0.9731; train_kl_reg_loss: 3700.8514; train_edge_recon_loss: 27604.5739; train_gene_expr_recon_loss: 125857.1922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157162.6174; train_optim_loss: 157162.6174; val_kl_reg_loss: 3645.4800; val_edge_recon_loss: 27151.8018; val_gene_expr_recon_loss: 126263.7418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157061.0241; val_optim_loss: 157061.0241
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9971; val_auprc_score: 0.9971; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 3704.5446; train_edge_recon_loss: 27587.6833; train_gene_expr_recon_loss: 125743.2914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157035.5193; train_optim_loss: 157035.5193; val_kl_reg_loss: 3628.6083; val_edge_recon_loss: 27104.0978; val_gene_expr_recon_loss: 126420.1912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157152.8976; val_optim_loss: 157152.8976
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 3708.2575; train_edge_recon_loss: 27573.1571; train_gene_expr_recon_loss: 125679.1263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156960.5411; train_optim_loss: 156960.5411; val_kl_reg_loss: 3686.7415; val_edge_recon_loss: 27133.2635; val_gene_expr_recon_loss: 126288.9748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157108.9795; val_optim_loss: 157108.9795
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9968; val_auprc_score: 0.9969; val_best_acc_score: 0.9722; val_best_f1_score: 0.9722; train_kl_reg_loss: 3712.2561; train_edge_recon_loss: 27564.0589; train_gene_expr_recon_loss: 125661.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156937.8099; train_optim_loss: 156937.8099; val_kl_reg_loss: 3706.1301; val_edge_recon_loss: 27124.4775; val_gene_expr_recon_loss: 126196.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157027.0396; val_optim_loss: 157027.0396

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9754; val_best_f1_score: 0.9754; train_kl_reg_loss: 3698.1071; train_edge_recon_loss: 27502.0887; train_gene_expr_recon_loss: 124973.3876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156173.5834; train_optim_loss: 156173.5834; val_kl_reg_loss: 3643.1811; val_edge_recon_loss: 27045.1473; val_gene_expr_recon_loss: 125646.3377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156334.6659; val_optim_loss: 156334.6659
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9753; val_best_f1_score: 0.9753; train_kl_reg_loss: 3671.4568; train_edge_recon_loss: 27525.7504; train_gene_expr_recon_loss: 124881.5077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156078.7148; train_optim_loss: 156078.7148; val_kl_reg_loss: 3638.9848; val_edge_recon_loss: 27060.9724; val_gene_expr_recon_loss: 125573.7187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156273.6756; val_optim_loss: 156273.6756
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9757; val_best_f1_score: 0.9756; train_kl_reg_loss: 3663.1280; train_edge_recon_loss: 27535.6849; train_gene_expr_recon_loss: 124764.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155963.3343; train_optim_loss: 155963.3343; val_kl_reg_loss: 3606.2575; val_edge_recon_loss: 27034.2074; val_gene_expr_recon_loss: 125492.1440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156132.6086; val_optim_loss: 156132.6086
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 3658.8046; train_edge_recon_loss: 27536.0625; train_gene_expr_recon_loss: 124766.9145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155961.7815; train_optim_loss: 155961.7815; val_kl_reg_loss: 3607.1031; val_edge_recon_loss: 27047.5584; val_gene_expr_recon_loss: 125529.7721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156184.4328; val_optim_loss: 156184.4328
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9756; val_best_f1_score: 0.9755; train_kl_reg_loss: 3655.3455; train_edge_recon_loss: 27535.3634; train_gene_expr_recon_loss: 124731.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155921.9203; train_optim_loss: 155921.9203; val_kl_reg_loss: 3635.1088; val_edge_recon_loss: 27042.8463; val_gene_expr_recon_loss: 125402.5927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156080.5480; val_optim_loss: 156080.5480
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 3653.9856; train_edge_recon_loss: 27532.9224; train_gene_expr_recon_loss: 124730.2423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155917.1502; train_optim_loss: 155917.1502; val_kl_reg_loss: 3622.9489; val_edge_recon_loss: 27029.5335; val_gene_expr_recon_loss: 125568.0438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156220.5261; val_optim_loss: 156220.5261
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 3650.2919; train_edge_recon_loss: 27541.4292; train_gene_expr_recon_loss: 124721.3859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155913.1071; train_optim_loss: 155913.1071; val_kl_reg_loss: 3615.9121; val_edge_recon_loss: 27060.0337; val_gene_expr_recon_loss: 125468.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156143.9747; val_optim_loss: 156143.9747
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9760; val_best_f1_score: 0.9760; train_kl_reg_loss: 3649.2902; train_edge_recon_loss: 27543.3554; train_gene_expr_recon_loss: 124687.1773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155879.8230; train_optim_loss: 155879.8230; val_kl_reg_loss: 3604.7547; val_edge_recon_loss: 27064.3885; val_gene_expr_recon_loss: 125523.2411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156192.3845; val_optim_loss: 156192.3845
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9976; val_auprc_score: 0.9976; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3648.4586; train_edge_recon_loss: 27539.9864; train_gene_expr_recon_loss: 124626.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155814.8843; train_optim_loss: 155814.8843; val_kl_reg_loss: 3614.7805; val_edge_recon_loss: 27058.6692; val_gene_expr_recon_loss: 125480.0212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156153.4711; val_optim_loss: 156153.4711

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9976; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 3651.1240; train_edge_recon_loss: 27527.8831; train_gene_expr_recon_loss: 124570.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155749.0263; train_optim_loss: 155749.0263; val_kl_reg_loss: 3616.7396; val_edge_recon_loss: 27039.4984; val_gene_expr_recon_loss: 125435.1363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156091.3740; val_optim_loss: 156091.3740
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9759; val_best_f1_score: 0.9759; train_kl_reg_loss: 3650.4300; train_edge_recon_loss: 27529.9501; train_gene_expr_recon_loss: 124564.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155744.4452; train_optim_loss: 155744.4452; val_kl_reg_loss: 3614.0957; val_edge_recon_loss: 27056.3635; val_gene_expr_recon_loss: 125458.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156128.7432; val_optim_loss: 156128.7432
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9976; val_auprc_score: 0.9976; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 3648.7528; train_edge_recon_loss: 27526.2730; train_gene_expr_recon_loss: 124510.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155685.8678; train_optim_loss: 155685.8678; val_kl_reg_loss: 3613.3365; val_edge_recon_loss: 27048.4662; val_gene_expr_recon_loss: 125381.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156043.6652; val_optim_loss: 156043.6652
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 3648.1511; train_edge_recon_loss: 27531.4858; train_gene_expr_recon_loss: 124543.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155723.4800; train_optim_loss: 155723.4800; val_kl_reg_loss: 3615.2186; val_edge_recon_loss: 27042.8718; val_gene_expr_recon_loss: 125407.1993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156065.2900; val_optim_loss: 156065.2900
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9756; val_best_f1_score: 0.9757; train_kl_reg_loss: 3647.2211; train_edge_recon_loss: 27527.1338; train_gene_expr_recon_loss: 124513.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155688.1829; train_optim_loss: 155688.1829; val_kl_reg_loss: 3617.6491; val_edge_recon_loss: 27066.1749; val_gene_expr_recon_loss: 125367.7032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156051.5270; val_optim_loss: 156051.5270
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 3645.8839; train_edge_recon_loss: 27536.2945; train_gene_expr_recon_loss: 124523.0212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155705.1997; train_optim_loss: 155705.1997; val_kl_reg_loss: 3614.0714; val_edge_recon_loss: 27055.9523; val_gene_expr_recon_loss: 125386.0647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156056.0883; val_optim_loss: 156056.0883
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9761; val_best_f1_score: 0.9761; train_kl_reg_loss: 3645.5912; train_edge_recon_loss: 27536.7586; train_gene_expr_recon_loss: 124554.8564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155737.2062; train_optim_loss: 155737.2062; val_kl_reg_loss: 3603.0631; val_edge_recon_loss: 27064.6646; val_gene_expr_recon_loss: 125406.4536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156074.1818; val_optim_loss: 156074.1818

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 3643.1283; train_edge_recon_loss: 27537.4110; train_gene_expr_recon_loss: 124496.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155676.9796; train_optim_loss: 155676.9796; val_kl_reg_loss: 3609.4437; val_edge_recon_loss: 27057.4003; val_gene_expr_recon_loss: 125434.9936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156101.8373; val_optim_loss: 156101.8373
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 3645.4649; train_edge_recon_loss: 27530.1303; train_gene_expr_recon_loss: 124542.0728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155717.6679; train_optim_loss: 155717.6679; val_kl_reg_loss: 3609.5487; val_edge_recon_loss: 27048.0037; val_gene_expr_recon_loss: 125438.0723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156095.6243; val_optim_loss: 156095.6243
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9761; val_best_f1_score: 0.9761; train_kl_reg_loss: 3645.2566; train_edge_recon_loss: 27533.2224; train_gene_expr_recon_loss: 124547.7480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155726.2272; train_optim_loss: 155726.2272; val_kl_reg_loss: 3608.6696; val_edge_recon_loss: 27059.7055; val_gene_expr_recon_loss: 125288.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155957.1230; val_optim_loss: 155957.1230
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9764; val_best_f1_score: 0.9764; train_kl_reg_loss: 3645.6331; train_edge_recon_loss: 27532.7743; train_gene_expr_recon_loss: 124539.9193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155718.3266; train_optim_loss: 155718.3266; val_kl_reg_loss: 3607.3064; val_edge_recon_loss: 27053.2538; val_gene_expr_recon_loss: 125302.5096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155963.0693; val_optim_loss: 155963.0693
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 3644.9675; train_edge_recon_loss: 27531.2526; train_gene_expr_recon_loss: 124500.9943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155677.2145; train_optim_loss: 155677.2145; val_kl_reg_loss: 3609.4262; val_edge_recon_loss: 27046.7539; val_gene_expr_recon_loss: 125270.9673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155927.1468; val_optim_loss: 155927.1468
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3645.5729; train_edge_recon_loss: 27535.4693; train_gene_expr_recon_loss: 124494.8153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155675.8575; train_optim_loss: 155675.8575; val_kl_reg_loss: 3608.1861; val_edge_recon_loss: 27065.1136; val_gene_expr_recon_loss: 125443.9445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156117.2443; val_optim_loss: 156117.2443
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9760; val_best_f1_score: 0.9760; train_kl_reg_loss: 3645.7271; train_edge_recon_loss: 27529.0050; train_gene_expr_recon_loss: 124524.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155698.8901; train_optim_loss: 155698.8901; val_kl_reg_loss: 3608.8461; val_edge_recon_loss: 27061.2641; val_gene_expr_recon_loss: 125388.4462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156058.5565; val_optim_loss: 156058.5565
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9764; val_best_f1_score: 0.9764; train_kl_reg_loss: 3644.7875; train_edge_recon_loss: 27534.4769; train_gene_expr_recon_loss: 124547.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155727.2077; train_optim_loss: 155727.2077; val_kl_reg_loss: 3609.5351; val_edge_recon_loss: 27036.6113; val_gene_expr_recon_loss: 125421.9403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156068.0869; val_optim_loss: 156068.0869
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 3644.8968; train_edge_recon_loss: 27531.8524; train_gene_expr_recon_loss: 124492.7693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155669.5185; train_optim_loss: 155669.5185; val_kl_reg_loss: 3609.5192; val_edge_recon_loss: 27044.7798; val_gene_expr_recon_loss: 125451.7680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156106.0665; val_optim_loss: 156106.0665

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 3645.1528; train_edge_recon_loss: 27526.8055; train_gene_expr_recon_loss: 124532.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155704.5369; train_optim_loss: 155704.5369; val_kl_reg_loss: 3609.5771; val_edge_recon_loss: 27063.1158; val_gene_expr_recon_loss: 125515.4270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156188.1197; val_optim_loss: 156188.1197
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9976; val_auprc_score: 0.9976; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3644.7192; train_edge_recon_loss: 27535.6690; train_gene_expr_recon_loss: 124480.6911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155661.0792; train_optim_loss: 155661.0792; val_kl_reg_loss: 3608.6716; val_edge_recon_loss: 27045.8949; val_gene_expr_recon_loss: 125352.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156007.4593; val_optim_loss: 156007.4593
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 3645.0458; train_edge_recon_loss: 27531.9472; train_gene_expr_recon_loss: 124473.2895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155650.2826; train_optim_loss: 155650.2826; val_kl_reg_loss: 3609.8417; val_edge_recon_loss: 27044.7869; val_gene_expr_recon_loss: 125494.4350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156149.0640; val_optim_loss: 156149.0640
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3644.8750; train_edge_recon_loss: 27537.3079; train_gene_expr_recon_loss: 124527.3748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155709.5580; train_optim_loss: 155709.5580; val_kl_reg_loss: 3609.9046; val_edge_recon_loss: 27054.1369; val_gene_expr_recon_loss: 125472.2725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156136.3136; val_optim_loss: 156136.3136

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 728 min 19 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9974
Val best accuracy score: 0.9762
Val best F1 score: 0.9763
Val gene expr MSE score: 8.6309

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
