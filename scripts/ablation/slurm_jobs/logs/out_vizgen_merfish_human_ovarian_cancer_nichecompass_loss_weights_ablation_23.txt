None
Run timestamp: 05072023_051732_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9890; val_auprc_score: 0.9892; val_best_acc_score: 0.9453; val_best_f1_score: 0.9453; train_kl_reg_loss: 4553.7610; train_edge_recon_loss: 30590.2916; train_gene_expr_recon_loss: 139143.1088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174287.1614; train_optim_loss: 174287.1614; val_kl_reg_loss: 3786.2398; val_edge_recon_loss: 28698.0860; val_gene_expr_recon_loss: 131312.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163796.8908; val_optim_loss: 163796.8908
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9928; val_auprc_score: 0.9928; val_best_acc_score: 0.9565; val_best_f1_score: 0.9566; train_kl_reg_loss: 3754.7859; train_edge_recon_loss: 28598.2279; train_gene_expr_recon_loss: 129996.0007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 162349.0144; train_optim_loss: 162349.0144; val_kl_reg_loss: 3741.3573; val_edge_recon_loss: 27895.9536; val_gene_expr_recon_loss: 128798.4230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 160435.7336; val_optim_loss: 160435.7336
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9941; val_auprc_score: 0.9941; val_best_acc_score: 0.9612; val_best_f1_score: 0.9612; train_kl_reg_loss: 3659.5527; train_edge_recon_loss: 28132.8166; train_gene_expr_recon_loss: 128456.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160249.2300; train_optim_loss: 160249.2300; val_kl_reg_loss: 3697.8534; val_edge_recon_loss: 27585.9828; val_gene_expr_recon_loss: 127842.1373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 159125.9732; val_optim_loss: 159125.9732
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9951; val_auprc_score: 0.9951; val_best_acc_score: 0.9648; val_best_f1_score: 0.9649; train_kl_reg_loss: 3648.1029; train_edge_recon_loss: 27926.3120; train_gene_expr_recon_loss: 127810.7313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159385.1463; train_optim_loss: 159385.1463; val_kl_reg_loss: 3562.6808; val_edge_recon_loss: 27377.5160; val_gene_expr_recon_loss: 127517.8008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 158457.9977; val_optim_loss: 158457.9977
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9658; val_best_f1_score: 0.9658; train_kl_reg_loss: 3654.3109; train_edge_recon_loss: 27802.6153; train_gene_expr_recon_loss: 127333.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158790.2478; train_optim_loss: 158790.2478; val_kl_reg_loss: 3575.7464; val_edge_recon_loss: 27260.1692; val_gene_expr_recon_loss: 127135.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157970.9779; val_optim_loss: 157970.9779
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9961; val_auprc_score: 0.9961; val_best_acc_score: 0.9688; val_best_f1_score: 0.9688; train_kl_reg_loss: 3662.8975; train_edge_recon_loss: 27728.8610; train_gene_expr_recon_loss: 127096.1065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158487.8651; train_optim_loss: 158487.8651; val_kl_reg_loss: 3676.5144; val_edge_recon_loss: 27209.4487; val_gene_expr_recon_loss: 127033.3899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157919.3535; val_optim_loss: 157919.3535
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9963; val_auprc_score: 0.9962; val_best_acc_score: 0.9700; val_best_f1_score: 0.9700; train_kl_reg_loss: 3672.2591; train_edge_recon_loss: 27671.2932; train_gene_expr_recon_loss: 126823.0914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 158166.6438; train_optim_loss: 158166.6438; val_kl_reg_loss: 3628.2046; val_edge_recon_loss: 27192.4032; val_gene_expr_recon_loss: 126973.3635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157793.9715; val_optim_loss: 157793.9715
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9701; val_best_f1_score: 0.9702; train_kl_reg_loss: 3676.5456; train_edge_recon_loss: 27640.5080; train_gene_expr_recon_loss: 126611.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157928.5446; train_optim_loss: 157928.5446; val_kl_reg_loss: 3735.9152; val_edge_recon_loss: 27118.5863; val_gene_expr_recon_loss: 126650.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157505.3855; val_optim_loss: 157505.3855
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9712; val_best_f1_score: 0.9712; train_kl_reg_loss: 3686.6626; train_edge_recon_loss: 27607.3147; train_gene_expr_recon_loss: 126505.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157799.7810; train_optim_loss: 157799.7810; val_kl_reg_loss: 3708.2332; val_edge_recon_loss: 27088.2986; val_gene_expr_recon_loss: 126661.4554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157457.9873; val_optim_loss: 157457.9873
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9707; val_best_f1_score: 0.9707; train_kl_reg_loss: 3691.0543; train_edge_recon_loss: 27584.6498; train_gene_expr_recon_loss: 126391.8549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157667.5590; train_optim_loss: 157667.5590; val_kl_reg_loss: 3672.4259; val_edge_recon_loss: 27090.5375; val_gene_expr_recon_loss: 126726.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157489.5453; val_optim_loss: 157489.5453
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9966; val_best_acc_score: 0.9715; val_best_f1_score: 0.9714; train_kl_reg_loss: 3695.4303; train_edge_recon_loss: 27560.7390; train_gene_expr_recon_loss: 126289.0219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157545.1913; train_optim_loss: 157545.1913; val_kl_reg_loss: 3660.2107; val_edge_recon_loss: 27106.6128; val_gene_expr_recon_loss: 126665.3393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157432.1624; val_optim_loss: 157432.1624
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9967; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 3698.6817; train_edge_recon_loss: 27554.6677; train_gene_expr_recon_loss: 126228.6521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157482.0016; train_optim_loss: 157482.0016; val_kl_reg_loss: 3656.2275; val_edge_recon_loss: 27097.4836; val_gene_expr_recon_loss: 126593.1965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157346.9079; val_optim_loss: 157346.9079
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 3703.9709; train_edge_recon_loss: 27530.3991; train_gene_expr_recon_loss: 126170.3007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157404.6707; train_optim_loss: 157404.6707; val_kl_reg_loss: 3691.6598; val_edge_recon_loss: 27028.0134; val_gene_expr_recon_loss: 126588.9416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157308.6147; val_optim_loss: 157308.6147
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9968; val_best_acc_score: 0.9727; val_best_f1_score: 0.9727; train_kl_reg_loss: 3705.5424; train_edge_recon_loss: 27522.4776; train_gene_expr_recon_loss: 126045.1461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157273.1659; train_optim_loss: 157273.1659; val_kl_reg_loss: 3664.6256; val_edge_recon_loss: 27035.0263; val_gene_expr_recon_loss: 126580.9251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157280.5773; val_optim_loss: 157280.5773
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 3707.2587; train_edge_recon_loss: 27514.6989; train_gene_expr_recon_loss: 125983.0395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157204.9971; train_optim_loss: 157204.9971; val_kl_reg_loss: 3663.6931; val_edge_recon_loss: 27050.9497; val_gene_expr_recon_loss: 126582.9646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157297.6073; val_optim_loss: 157297.6073
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9969; val_auprc_score: 0.9968; val_best_acc_score: 0.9726; val_best_f1_score: 0.9726; train_kl_reg_loss: 3709.4466; train_edge_recon_loss: 27511.1281; train_gene_expr_recon_loss: 125949.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157170.5006; train_optim_loss: 157170.5006; val_kl_reg_loss: 3666.2777; val_edge_recon_loss: 27099.3493; val_gene_expr_recon_loss: 126321.7508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157087.3780; val_optim_loss: 157087.3780
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9971; val_best_acc_score: 0.9739; val_best_f1_score: 0.9739; train_kl_reg_loss: 3712.3087; train_edge_recon_loss: 27495.2393; train_gene_expr_recon_loss: 125926.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157133.9807; train_optim_loss: 157133.9807; val_kl_reg_loss: 3588.8372; val_edge_recon_loss: 27066.8893; val_gene_expr_recon_loss: 126445.8582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157101.5843; val_optim_loss: 157101.5843
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9732; val_best_f1_score: 0.9732; train_kl_reg_loss: 3715.3804; train_edge_recon_loss: 27487.5164; train_gene_expr_recon_loss: 125924.7874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157127.6844; train_optim_loss: 157127.6844; val_kl_reg_loss: 3601.3436; val_edge_recon_loss: 27047.1613; val_gene_expr_recon_loss: 126549.6614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157198.1665; val_optim_loss: 157198.1665
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9971; val_best_acc_score: 0.9738; val_best_f1_score: 0.9738; train_kl_reg_loss: 3714.7226; train_edge_recon_loss: 27484.9903; train_gene_expr_recon_loss: 125887.7952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157087.5080; train_optim_loss: 157087.5080; val_kl_reg_loss: 3641.9386; val_edge_recon_loss: 27019.8631; val_gene_expr_recon_loss: 126388.9955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157050.7973; val_optim_loss: 157050.7973
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9736; val_best_f1_score: 0.9736; train_kl_reg_loss: 3715.9233; train_edge_recon_loss: 27481.3528; train_gene_expr_recon_loss: 125848.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 157045.6822; train_optim_loss: 157045.6822; val_kl_reg_loss: 3724.6837; val_edge_recon_loss: 27014.8866; val_gene_expr_recon_loss: 126497.6722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157237.2427; val_optim_loss: 157237.2427
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 3717.4221; train_edge_recon_loss: 27469.8253; train_gene_expr_recon_loss: 125805.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156993.0452; train_optim_loss: 156993.0452; val_kl_reg_loss: 3743.1506; val_edge_recon_loss: 27048.3543; val_gene_expr_recon_loss: 126501.3343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157292.8392; val_optim_loss: 157292.8392
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9972; val_best_acc_score: 0.9744; val_best_f1_score: 0.9744; train_kl_reg_loss: 3720.0033; train_edge_recon_loss: 27460.4975; train_gene_expr_recon_loss: 125757.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156938.1888; train_optim_loss: 156938.1888; val_kl_reg_loss: 3616.2606; val_edge_recon_loss: 27033.9070; val_gene_expr_recon_loss: 126629.8515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157280.0193; val_optim_loss: 157280.0193
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9741; val_best_f1_score: 0.9741; train_kl_reg_loss: 3718.9778; train_edge_recon_loss: 27460.3434; train_gene_expr_recon_loss: 125742.8665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 156922.1877; train_optim_loss: 156922.1877; val_kl_reg_loss: 3780.5511; val_edge_recon_loss: 26983.2111; val_gene_expr_recon_loss: 126475.0436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157238.8056; val_optim_loss: 157238.8056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9756; val_best_f1_score: 0.9757; train_kl_reg_loss: 3700.0825; train_edge_recon_loss: 27405.2037; train_gene_expr_recon_loss: 124765.9105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155871.1967; train_optim_loss: 155871.1967; val_kl_reg_loss: 3652.6940; val_edge_recon_loss: 26972.5387; val_gene_expr_recon_loss: 126285.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156911.1340; val_optim_loss: 156911.1340
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 3665.3093; train_edge_recon_loss: 27441.4949; train_gene_expr_recon_loss: 124622.0389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155728.8433; train_optim_loss: 155728.8433; val_kl_reg_loss: 3628.7399; val_edge_recon_loss: 26951.4565; val_gene_expr_recon_loss: 125780.6718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156360.8681; val_optim_loss: 156360.8681
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3656.5733; train_edge_recon_loss: 27451.3057; train_gene_expr_recon_loss: 124552.5707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155660.4499; train_optim_loss: 155660.4499; val_kl_reg_loss: 3646.4258; val_edge_recon_loss: 26968.1602; val_gene_expr_recon_loss: 124729.0771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155343.6628; val_optim_loss: 155343.6628
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9976; val_auprc_score: 0.9975; val_best_acc_score: 0.9761; val_best_f1_score: 0.9760; train_kl_reg_loss: 3651.1985; train_edge_recon_loss: 27458.7282; train_gene_expr_recon_loss: 124489.1479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155599.0744; train_optim_loss: 155599.0744; val_kl_reg_loss: 3616.8252; val_edge_recon_loss: 26984.9210; val_gene_expr_recon_loss: 126461.1061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157062.8524; val_optim_loss: 157062.8524
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9976; val_auprc_score: 0.9976; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 3648.0026; train_edge_recon_loss: 27460.0646; train_gene_expr_recon_loss: 124428.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155537.0320; train_optim_loss: 155537.0320; val_kl_reg_loss: 3621.5006; val_edge_recon_loss: 26982.5707; val_gene_expr_recon_loss: 125770.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156374.9533; val_optim_loss: 156374.9533
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 3646.8305; train_edge_recon_loss: 27460.0068; train_gene_expr_recon_loss: 124397.1826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155504.0199; train_optim_loss: 155504.0199; val_kl_reg_loss: 3607.6914; val_edge_recon_loss: 26972.4899; val_gene_expr_recon_loss: 125963.2274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156543.4087; val_optim_loss: 156543.4087
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9976; val_best_acc_score: 0.9771; val_best_f1_score: 0.9771; train_kl_reg_loss: 3642.8787; train_edge_recon_loss: 27471.4902; train_gene_expr_recon_loss: 124359.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155474.0207; train_optim_loss: 155474.0207; val_kl_reg_loss: 3610.8343; val_edge_recon_loss: 26975.8622; val_gene_expr_recon_loss: 126465.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157052.6042; val_optim_loss: 157052.6042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 3645.9357; train_edge_recon_loss: 27458.7991; train_gene_expr_recon_loss: 124776.9332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155881.6681; train_optim_loss: 155881.6681; val_kl_reg_loss: 3617.0381; val_edge_recon_loss: 26981.0542; val_gene_expr_recon_loss: 124862.5857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155460.6783; val_optim_loss: 155460.6783
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 3643.4553; train_edge_recon_loss: 27455.8766; train_gene_expr_recon_loss: 124297.9705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155397.3023; train_optim_loss: 155397.3023; val_kl_reg_loss: 3613.8366; val_edge_recon_loss: 26976.2453; val_gene_expr_recon_loss: 124486.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155076.6055; val_optim_loss: 155076.6055
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 3641.0427; train_edge_recon_loss: 27461.7910; train_gene_expr_recon_loss: 124337.1131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155439.9468; train_optim_loss: 155439.9468; val_kl_reg_loss: 3606.9591; val_edge_recon_loss: 26990.0792; val_gene_expr_recon_loss: 125843.8560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156440.8937; val_optim_loss: 156440.8937
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 3640.5206; train_edge_recon_loss: 27460.7065; train_gene_expr_recon_loss: 124284.4853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155385.7125; train_optim_loss: 155385.7125; val_kl_reg_loss: 3607.2882; val_edge_recon_loss: 26981.9519; val_gene_expr_recon_loss: 125149.3540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155738.5941; val_optim_loss: 155738.5941
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9975; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 3639.8153; train_edge_recon_loss: 27461.8448; train_gene_expr_recon_loss: 124219.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155321.0864; train_optim_loss: 155321.0864; val_kl_reg_loss: 3609.3579; val_edge_recon_loss: 26982.8887; val_gene_expr_recon_loss: 125213.3735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155805.6195; val_optim_loss: 155805.6195
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 3638.3095; train_edge_recon_loss: 27466.0876; train_gene_expr_recon_loss: 124247.3575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155351.7545; train_optim_loss: 155351.7545; val_kl_reg_loss: 3603.8300; val_edge_recon_loss: 27000.5472; val_gene_expr_recon_loss: 125028.4264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155632.8040; val_optim_loss: 155632.8040

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9977; val_auprc_score: 0.9976; val_best_acc_score: 0.9771; val_best_f1_score: 0.9771; train_kl_reg_loss: 3638.5626; train_edge_recon_loss: 27460.8881; train_gene_expr_recon_loss: 124382.2747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155481.7254; train_optim_loss: 155481.7254; val_kl_reg_loss: 3609.5684; val_edge_recon_loss: 26987.9838; val_gene_expr_recon_loss: 125054.7758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155652.3283; val_optim_loss: 155652.3283
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9977; val_auprc_score: 0.9977; val_best_acc_score: 0.9768; val_best_f1_score: 0.9768; train_kl_reg_loss: 3639.7420; train_edge_recon_loss: 27458.9846; train_gene_expr_recon_loss: 124403.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155501.7654; train_optim_loss: 155501.7654; val_kl_reg_loss: 3609.6257; val_edge_recon_loss: 26978.5713; val_gene_expr_recon_loss: 125739.0373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156327.2338; val_optim_loss: 156327.2338
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9976; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 3639.2814; train_edge_recon_loss: 27465.2436; train_gene_expr_recon_loss: 124347.2359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155451.7609; train_optim_loss: 155451.7609; val_kl_reg_loss: 3608.8094; val_edge_recon_loss: 26984.2972; val_gene_expr_recon_loss: 126064.4893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156657.5958; val_optim_loss: 156657.5958
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9978; val_auprc_score: 0.9977; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 3638.9732; train_edge_recon_loss: 27463.9257; train_gene_expr_recon_loss: 124342.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155445.3798; train_optim_loss: 155445.3798; val_kl_reg_loss: 3609.3490; val_edge_recon_loss: 26972.0898; val_gene_expr_recon_loss: 125846.0724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 156427.5112; val_optim_loss: 156427.5112

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 695 min 6 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9976
Val best accuracy score: 0.9768
Val best F1 score: 0.9768
Val gene expr MSE score: 8.5660

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
