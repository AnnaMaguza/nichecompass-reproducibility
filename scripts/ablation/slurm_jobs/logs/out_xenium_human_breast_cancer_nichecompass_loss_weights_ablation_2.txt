None
Run timestamp: 13072023_203906_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9604; val_auprc_score: 0.9502; val_best_acc_score: 0.9025; val_best_f1_score: 0.9075; train_kl_reg_loss: 19999.3924; train_edge_recon_loss: 2693621.7097; train_gene_expr_recon_loss: 762983.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3476604.4170; train_optim_loss: 3476604.4170; val_kl_reg_loss: 17265.7936; val_edge_recon_loss: 2659678.2089; val_gene_expr_recon_loss: 700987.5771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3377931.5719; val_optim_loss: 3377931.5719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9762; val_auprc_score: 0.9712; val_best_acc_score: 0.9265; val_best_f1_score: 0.9288; train_kl_reg_loss: 16108.0959; train_edge_recon_loss: 2630558.8020; train_gene_expr_recon_loss: 684714.4471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3331381.3467; train_optim_loss: 3331381.3467; val_kl_reg_loss: 15267.7309; val_edge_recon_loss: 2646274.4281; val_gene_expr_recon_loss: 668254.9705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3329797.1353; val_optim_loss: 3329797.1353
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9771; val_best_acc_score: 0.9365; val_best_f1_score: 0.9384; train_kl_reg_loss: 15153.2799; train_edge_recon_loss: 2615407.6630; train_gene_expr_recon_loss: 662032.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3292592.9914; train_optim_loss: 3292592.9914; val_kl_reg_loss: 14284.2488; val_edge_recon_loss: 2634986.0890; val_gene_expr_recon_loss: 654670.9015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3303941.2312; val_optim_loss: 3303941.2312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9828; val_auprc_score: 0.9794; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 14515.0743; train_edge_recon_loss: 2609554.6390; train_gene_expr_recon_loss: 651113.3755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3275183.0904; train_optim_loss: 3275183.0904; val_kl_reg_loss: 13832.1991; val_edge_recon_loss: 2631656.6866; val_gene_expr_recon_loss: 647549.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3293038.3476; val_optim_loss: 3293038.3476
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9849; val_auprc_score: 0.9818; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 14045.9155; train_edge_recon_loss: 2606142.5338; train_gene_expr_recon_loss: 644683.0640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3264871.5147; train_optim_loss: 3264871.5147; val_kl_reg_loss: 13384.7213; val_edge_recon_loss: 2628556.3408; val_gene_expr_recon_loss: 641744.8463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3283685.9092; val_optim_loss: 3283685.9092
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9852; val_auprc_score: 0.9816; val_best_acc_score: 0.9465; val_best_f1_score: 0.9478; train_kl_reg_loss: 13602.0607; train_edge_recon_loss: 2603842.2418; train_gene_expr_recon_loss: 640674.6684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3258118.9706; train_optim_loss: 3258118.9706; val_kl_reg_loss: 13132.2948; val_edge_recon_loss: 2625926.7928; val_gene_expr_recon_loss: 639309.2414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3278368.3356; val_optim_loss: 3278368.3356
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9865; val_auprc_score: 0.9836; val_best_acc_score: 0.9493; val_best_f1_score: 0.9503; train_kl_reg_loss: 13369.2538; train_edge_recon_loss: 2601180.4681; train_gene_expr_recon_loss: 638152.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252702.1359; train_optim_loss: 3252702.1359; val_kl_reg_loss: 12986.6909; val_edge_recon_loss: 2620805.0599; val_gene_expr_recon_loss: 636833.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270624.8082; val_optim_loss: 3270624.8082
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9865; val_auprc_score: 0.9835; val_best_acc_score: 0.9502; val_best_f1_score: 0.9513; train_kl_reg_loss: 13138.4750; train_edge_recon_loss: 2598670.5854; train_gene_expr_recon_loss: 636021.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3247831.0199; train_optim_loss: 3247831.0199; val_kl_reg_loss: 12916.6390; val_edge_recon_loss: 2617536.6661; val_gene_expr_recon_loss: 635193.9311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265647.2226; val_optim_loss: 3265647.2226
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9871; val_auprc_score: 0.9843; val_best_acc_score: 0.9514; val_best_f1_score: 0.9524; train_kl_reg_loss: 12995.6702; train_edge_recon_loss: 2595989.9098; train_gene_expr_recon_loss: 634261.7600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3243247.3387; train_optim_loss: 3243247.3387; val_kl_reg_loss: 12802.1248; val_edge_recon_loss: 2618592.5445; val_gene_expr_recon_loss: 634483.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265878.0325; val_optim_loss: 3265878.0325
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9851; val_best_acc_score: 0.9535; val_best_f1_score: 0.9544; train_kl_reg_loss: 12885.5445; train_edge_recon_loss: 2595625.6097; train_gene_expr_recon_loss: 633147.1826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3241658.3351; train_optim_loss: 3241658.3351; val_kl_reg_loss: 12760.8045; val_edge_recon_loss: 2615718.2877; val_gene_expr_recon_loss: 633658.4709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262137.5616; val_optim_loss: 3262137.5616
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9873; val_auprc_score: 0.9844; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 12752.6910; train_edge_recon_loss: 2593982.8689; train_gene_expr_recon_loss: 632065.2356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238800.7917; train_optim_loss: 3238800.7917; val_kl_reg_loss: 12379.0010; val_edge_recon_loss: 2615928.4983; val_gene_expr_recon_loss: 633009.3664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261316.8716; val_optim_loss: 3261316.8716
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9858; val_best_acc_score: 0.9555; val_best_f1_score: 0.9562; train_kl_reg_loss: 12707.1965; train_edge_recon_loss: 2592512.5409; train_gene_expr_recon_loss: 630818.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236038.7269; train_optim_loss: 3236038.7269; val_kl_reg_loss: 12249.0263; val_edge_recon_loss: 2612107.6045; val_gene_expr_recon_loss: 632292.3074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256648.9366; val_optim_loss: 3256648.9366
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9881; val_auprc_score: 0.9851; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 12602.9783; train_edge_recon_loss: 2591798.1231; train_gene_expr_recon_loss: 630020.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234421.4872; train_optim_loss: 3234421.4872; val_kl_reg_loss: 12416.6591; val_edge_recon_loss: 2612625.4384; val_gene_expr_recon_loss: 631464.4829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3256506.5839; val_optim_loss: 3256506.5839
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9565; val_best_f1_score: 0.9572; train_kl_reg_loss: 12580.6409; train_edge_recon_loss: 2590938.8851; train_gene_expr_recon_loss: 629480.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232999.7238; train_optim_loss: 3232999.7238; val_kl_reg_loss: 12510.1706; val_edge_recon_loss: 2611167.3955; val_gene_expr_recon_loss: 628364.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252041.7192; val_optim_loss: 3252041.7192
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9889; val_auprc_score: 0.9859; val_best_acc_score: 0.9563; val_best_f1_score: 0.9571; train_kl_reg_loss: 12507.8577; train_edge_recon_loss: 2589701.4253; train_gene_expr_recon_loss: 629118.7622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231328.0384; train_optim_loss: 3231328.0384; val_kl_reg_loss: 12375.0249; val_edge_recon_loss: 2610119.7123; val_gene_expr_recon_loss: 629003.3074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3251498.0497; val_optim_loss: 3251498.0497
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9886; val_auprc_score: 0.9855; val_best_acc_score: 0.9561; val_best_f1_score: 0.9568; train_kl_reg_loss: 12432.8096; train_edge_recon_loss: 2587959.4339; train_gene_expr_recon_loss: 628375.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228767.5317; train_optim_loss: 3228767.5317; val_kl_reg_loss: 12344.5752; val_edge_recon_loss: 2609898.9914; val_gene_expr_recon_loss: 629582.1807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3251825.7500; val_optim_loss: 3251825.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9890; val_auprc_score: 0.9862; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 12423.0198; train_edge_recon_loss: 2589076.8622; train_gene_expr_recon_loss: 628216.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229716.2708; train_optim_loss: 3229716.2708; val_kl_reg_loss: 12077.2652; val_edge_recon_loss: 2608392.4503; val_gene_expr_recon_loss: 628920.0745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249389.7842; val_optim_loss: 3249389.7842
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9896; val_auprc_score: 0.9872; val_best_acc_score: 0.9579; val_best_f1_score: 0.9587; train_kl_reg_loss: 12316.1467; train_edge_recon_loss: 2589262.8855; train_gene_expr_recon_loss: 627842.1972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229421.2332; train_optim_loss: 3229421.2332; val_kl_reg_loss: 12467.4352; val_edge_recon_loss: 2605655.5668; val_gene_expr_recon_loss: 628738.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246861.8425; val_optim_loss: 3246861.8425
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9860; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 12305.3903; train_edge_recon_loss: 2588135.8012; train_gene_expr_recon_loss: 627278.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227719.6649; train_optim_loss: 3227719.6649; val_kl_reg_loss: 12027.6913; val_edge_recon_loss: 2609811.6661; val_gene_expr_recon_loss: 628231.3189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250070.6764; val_optim_loss: 3250070.6764
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 12295.4693; train_edge_recon_loss: 2586923.8540; train_gene_expr_recon_loss: 627008.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226227.9304; train_optim_loss: 3226227.9304; val_kl_reg_loss: 12013.8885; val_edge_recon_loss: 2604735.0908; val_gene_expr_recon_loss: 629402.6550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246151.6164; val_optim_loss: 3246151.6164
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9891; val_auprc_score: 0.9862; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 12240.5450; train_edge_recon_loss: 2586576.2936; train_gene_expr_recon_loss: 626617.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225434.2143; train_optim_loss: 3225434.2143; val_kl_reg_loss: 11970.8126; val_edge_recon_loss: 2610876.9041; val_gene_expr_recon_loss: 629286.2209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3252133.9435; val_optim_loss: 3252133.9435
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9588; val_best_f1_score: 0.9597; train_kl_reg_loss: 12211.9722; train_edge_recon_loss: 2586049.4979; train_gene_expr_recon_loss: 626299.5230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224560.9943; train_optim_loss: 3224560.9943; val_kl_reg_loss: 11883.5628; val_edge_recon_loss: 2607647.2945; val_gene_expr_recon_loss: 628302.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247833.1935; val_optim_loss: 3247833.1935
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9896; val_auprc_score: 0.9869; val_best_acc_score: 0.9595; val_best_f1_score: 0.9603; train_kl_reg_loss: 12149.2979; train_edge_recon_loss: 2586066.5671; train_gene_expr_recon_loss: 625987.6994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224203.5661; train_optim_loss: 3224203.5661; val_kl_reg_loss: 12105.0488; val_edge_recon_loss: 2603472.0479; val_gene_expr_recon_loss: 628082.5098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243659.6027; val_optim_loss: 3243659.6027
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9584; val_best_f1_score: 0.9592; train_kl_reg_loss: 12159.5511; train_edge_recon_loss: 2585519.5617; train_gene_expr_recon_loss: 625907.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223586.9968; train_optim_loss: 3223586.9968; val_kl_reg_loss: 12031.7857; val_edge_recon_loss: 2605719.0873; val_gene_expr_recon_loss: 627795.1229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245546.0103; val_optim_loss: 3245546.0103
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9902; val_auprc_score: 0.9876; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 12116.5933; train_edge_recon_loss: 2585335.6296; train_gene_expr_recon_loss: 625579.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223031.2603; train_optim_loss: 3223031.2603; val_kl_reg_loss: 11930.6602; val_edge_recon_loss: 2602289.7671; val_gene_expr_recon_loss: 627187.8420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241408.2671; val_optim_loss: 3241408.2671
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9891; val_auprc_score: 0.9858; val_best_acc_score: 0.9594; val_best_f1_score: 0.9602; train_kl_reg_loss: 12054.5436; train_edge_recon_loss: 2585617.8112; train_gene_expr_recon_loss: 625046.3975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3222718.7496; train_optim_loss: 3222718.7496; val_kl_reg_loss: 12048.7814; val_edge_recon_loss: 2607098.4572; val_gene_expr_recon_loss: 626867.4730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246014.7003; val_optim_loss: 3246014.7003
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9899; val_auprc_score: 0.9873; val_best_acc_score: 0.9604; val_best_f1_score: 0.9609; train_kl_reg_loss: 12078.7611; train_edge_recon_loss: 2584528.8524; train_gene_expr_recon_loss: 625272.5797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221880.1906; train_optim_loss: 3221880.1906; val_kl_reg_loss: 12045.8503; val_edge_recon_loss: 2603365.8442; val_gene_expr_recon_loss: 627586.3348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242998.0223; val_optim_loss: 3242998.0223
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9901; val_auprc_score: 0.9875; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 12048.2424; train_edge_recon_loss: 2584286.7401; train_gene_expr_recon_loss: 625048.6109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221383.5938; train_optim_loss: 3221383.5938; val_kl_reg_loss: 11986.8757; val_edge_recon_loss: 2602193.1130; val_gene_expr_recon_loss: 627152.1002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241332.0942; val_optim_loss: 3241332.0942
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9901; val_auprc_score: 0.9874; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 12000.0695; train_edge_recon_loss: 2583962.6674; train_gene_expr_recon_loss: 625027.0994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220989.8349; train_optim_loss: 3220989.8349; val_kl_reg_loss: 11749.8610; val_edge_recon_loss: 2600659.1147; val_gene_expr_recon_loss: 627505.0394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239913.9966; val_optim_loss: 3239913.9966
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9898; val_auprc_score: 0.9871; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 11957.1992; train_edge_recon_loss: 2585179.4729; train_gene_expr_recon_loss: 624731.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221868.0329; train_optim_loss: 3221868.0329; val_kl_reg_loss: 11701.9998; val_edge_recon_loss: 2604598.7928; val_gene_expr_recon_loss: 627533.3082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243834.0959; val_optim_loss: 3243834.0959
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9901; val_auprc_score: 0.9875; val_best_acc_score: 0.9607; val_best_f1_score: 0.9613; train_kl_reg_loss: 11976.0957; train_edge_recon_loss: 2583428.0067; train_gene_expr_recon_loss: 624772.3593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3220176.4664; train_optim_loss: 3220176.4664; val_kl_reg_loss: 11986.1349; val_edge_recon_loss: 2603318.1490; val_gene_expr_recon_loss: 627257.3998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3242561.6884; val_optim_loss: 3242561.6884
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 11995.3997; train_edge_recon_loss: 2582400.6277; train_gene_expr_recon_loss: 624495.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218891.5524; train_optim_loss: 3218891.5524; val_kl_reg_loss: 11778.1876; val_edge_recon_loss: 2603455.4110; val_gene_expr_recon_loss: 627970.7072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3243204.3134; val_optim_loss: 3243204.3134
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9903; val_auprc_score: 0.9877; val_best_acc_score: 0.9621; val_best_f1_score: 0.9626; train_kl_reg_loss: 11873.3911; train_edge_recon_loss: 2583015.7122; train_gene_expr_recon_loss: 624294.3012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219183.4069; train_optim_loss: 3219183.4069; val_kl_reg_loss: 11766.0116; val_edge_recon_loss: 2600924.8955; val_gene_expr_recon_loss: 628174.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240865.4692; val_optim_loss: 3240865.4692

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9906; val_auprc_score: 0.9881; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 12068.7581; train_edge_recon_loss: 2580542.4981; train_gene_expr_recon_loss: 619547.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3212159.1550; train_optim_loss: 3212159.1550; val_kl_reg_loss: 11985.7238; val_edge_recon_loss: 2597958.9777; val_gene_expr_recon_loss: 622720.6408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232665.3322; val_optim_loss: 3232665.3322
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9910; val_auprc_score: 0.9885; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 12079.4313; train_edge_recon_loss: 2580049.3198; train_gene_expr_recon_loss: 619133.4634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211262.2190; train_optim_loss: 3211262.2190; val_kl_reg_loss: 11897.1398; val_edge_recon_loss: 2598306.2894; val_gene_expr_recon_loss: 622779.8694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232983.2928; val_optim_loss: 3232983.2928
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9911; val_auprc_score: 0.9886; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 12101.8602; train_edge_recon_loss: 2579932.9646; train_gene_expr_recon_loss: 619003.6848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211038.5097; train_optim_loss: 3211038.5097; val_kl_reg_loss: 11898.7558; val_edge_recon_loss: 2599239.0822; val_gene_expr_recon_loss: 622427.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233565.7140; val_optim_loss: 3233565.7140
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 12091.8223; train_edge_recon_loss: 2580210.4601; train_gene_expr_recon_loss: 618781.7373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211084.0168; train_optim_loss: 3211084.0168; val_kl_reg_loss: 11866.1065; val_edge_recon_loss: 2598055.1627; val_gene_expr_recon_loss: 623016.6220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232937.8938; val_optim_loss: 3232937.8938
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9911; val_auprc_score: 0.9886; val_best_acc_score: 0.9637; val_best_f1_score: 0.9644; train_kl_reg_loss: 12034.3803; train_edge_recon_loss: 2580008.6862; train_gene_expr_recon_loss: 618697.6114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210740.6793; train_optim_loss: 3210740.6793; val_kl_reg_loss: 11803.6877; val_edge_recon_loss: 2601012.6695; val_gene_expr_recon_loss: 621766.0342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234582.3904; val_optim_loss: 3234582.3904

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9912; val_auprc_score: 0.9886; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 12012.4864; train_edge_recon_loss: 2580626.4138; train_gene_expr_recon_loss: 617849.6025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210488.4990; train_optim_loss: 3210488.4990; val_kl_reg_loss: 11820.3213; val_edge_recon_loss: 2600044.8082; val_gene_expr_recon_loss: 621425.5972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233290.7209; val_optim_loss: 3233290.7209
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9911; val_auprc_score: 0.9882; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 12040.8158; train_edge_recon_loss: 2579395.6032; train_gene_expr_recon_loss: 617851.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209287.8396; train_optim_loss: 3209287.8396; val_kl_reg_loss: 11849.1227; val_edge_recon_loss: 2598479.9195; val_gene_expr_recon_loss: 621968.8639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232297.8955; val_optim_loss: 3232297.8955
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9648; val_best_f1_score: 0.9653; train_kl_reg_loss: 12044.7228; train_edge_recon_loss: 2580548.1311; train_gene_expr_recon_loss: 617751.8130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210344.6642; train_optim_loss: 3210344.6642; val_kl_reg_loss: 11858.4395; val_edge_recon_loss: 2597073.6421; val_gene_expr_recon_loss: 622152.6905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231084.7620; val_optim_loss: 3231084.7620
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9913; val_auprc_score: 0.9890; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 12025.0574; train_edge_recon_loss: 2580675.2271; train_gene_expr_recon_loss: 617744.8023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210445.0831; train_optim_loss: 3210445.0831; val_kl_reg_loss: 11847.2208; val_edge_recon_loss: 2598675.1644; val_gene_expr_recon_loss: 621146.0514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231668.4212; val_optim_loss: 3231668.4212
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9914; val_auprc_score: 0.9890; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 12014.9958; train_edge_recon_loss: 2580935.3790; train_gene_expr_recon_loss: 617758.3150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210708.6844; train_optim_loss: 3210708.6844; val_kl_reg_loss: 11829.1949; val_edge_recon_loss: 2599752.1164; val_gene_expr_recon_loss: 621132.1314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232713.4366; val_optim_loss: 3232713.4366
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9910; val_auprc_score: 0.9886; val_best_acc_score: 0.9631; val_best_f1_score: 0.9637; train_kl_reg_loss: 12008.9033; train_edge_recon_loss: 2580220.1965; train_gene_expr_recon_loss: 617613.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209842.2984; train_optim_loss: 3209842.2984; val_kl_reg_loss: 11830.5465; val_edge_recon_loss: 2600717.5942; val_gene_expr_recon_loss: 621164.7624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233712.9007; val_optim_loss: 3233712.9007
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 12018.6793; train_edge_recon_loss: 2580580.3544; train_gene_expr_recon_loss: 617984.7271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210583.7653; train_optim_loss: 3210583.7653; val_kl_reg_loss: 11817.0501; val_edge_recon_loss: 2595229.7055; val_gene_expr_recon_loss: 622520.6657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3229567.4127; val_optim_loss: 3229567.4127
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9910; val_auprc_score: 0.9883; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 12022.2880; train_edge_recon_loss: 2579930.0929; train_gene_expr_recon_loss: 617664.2003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209616.5793; train_optim_loss: 3209616.5793; val_kl_reg_loss: 11865.5110; val_edge_recon_loss: 2600031.2945; val_gene_expr_recon_loss: 621268.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233165.2243; val_optim_loss: 3233165.2243
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9910; val_auprc_score: 0.9884; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 12033.5188; train_edge_recon_loss: 2579539.5669; train_gene_expr_recon_loss: 617971.9504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209545.0336; train_optim_loss: 3209545.0336; val_kl_reg_loss: 11837.5109; val_edge_recon_loss: 2599009.5634; val_gene_expr_recon_loss: 620575.1167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3231422.1952; val_optim_loss: 3231422.1952
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9910; val_auprc_score: 0.9884; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 12024.3381; train_edge_recon_loss: 2580184.8200; train_gene_expr_recon_loss: 617973.2522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210182.4119; train_optim_loss: 3210182.4119; val_kl_reg_loss: 11840.4832; val_edge_recon_loss: 2599174.1164; val_gene_expr_recon_loss: 621929.4559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232944.0565; val_optim_loss: 3232944.0565
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9639; val_best_f1_score: 0.9645; train_kl_reg_loss: 12026.7902; train_edge_recon_loss: 2579604.0912; train_gene_expr_recon_loss: 617759.0187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209389.8956; train_optim_loss: 3209389.8956; val_kl_reg_loss: 11843.2956; val_edge_recon_loss: 2600601.6901; val_gene_expr_recon_loss: 622407.4795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234852.4469; val_optim_loss: 3234852.4469

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 12030.9053; train_edge_recon_loss: 2579374.4960; train_gene_expr_recon_loss: 617603.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209009.2905; train_optim_loss: 3209009.2905; val_kl_reg_loss: 11842.5871; val_edge_recon_loss: 2598393.7860; val_gene_expr_recon_loss: 622853.4623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3233089.8202; val_optim_loss: 3233089.8202
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9911; val_auprc_score: 0.9887; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 12025.6436; train_edge_recon_loss: 2580438.6663; train_gene_expr_recon_loss: 617839.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210304.0883; train_optim_loss: 3210304.0883; val_kl_reg_loss: 11834.6942; val_edge_recon_loss: 2598891.9726; val_gene_expr_recon_loss: 621942.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232669.4726; val_optim_loss: 3232669.4726
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9911; val_auprc_score: 0.9888; val_best_acc_score: 0.9638; val_best_f1_score: 0.9644; train_kl_reg_loss: 12021.4606; train_edge_recon_loss: 2579797.4427; train_gene_expr_recon_loss: 617950.0214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209768.9193; train_optim_loss: 3209768.9193; val_kl_reg_loss: 11838.5270; val_edge_recon_loss: 2600522.0514; val_gene_expr_recon_loss: 622445.3065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234805.8955; val_optim_loss: 3234805.8955
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9913; val_auprc_score: 0.9889; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 12021.6540; train_edge_recon_loss: 2579290.7802; train_gene_expr_recon_loss: 617363.4646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208675.8976; train_optim_loss: 3208675.8976; val_kl_reg_loss: 11839.6580; val_edge_recon_loss: 2598971.8596; val_gene_expr_recon_loss: 621457.1113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3232268.6182; val_optim_loss: 3232268.6182

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 269 min 14 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9912
Val AUPRC score: 0.9888
Val best accuracy score: 0.9637
Val best F1 score: 0.9643
Val gene expr MSE score: 1.5155

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
