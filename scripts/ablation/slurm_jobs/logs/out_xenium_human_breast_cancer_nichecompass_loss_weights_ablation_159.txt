None
Run timestamp: 15072023_051808_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9598; val_auprc_score: 0.9508; val_best_acc_score: 0.8994; val_best_f1_score: 0.9051; train_kl_reg_loss: 49568.6175; train_edge_recon_loss: 26879114.5988; train_gene_expr_recon_loss: 7471632.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34400315.8364; train_optim_loss: 34400315.8364; val_kl_reg_loss: 47171.9108; val_edge_recon_loss: 26481798.3981; val_gene_expr_recon_loss: 6935880.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33464851.1574; val_optim_loss: 33464851.1574
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9799; val_auprc_score: 0.9764; val_best_acc_score: 0.9318; val_best_f1_score: 0.9337; train_kl_reg_loss: 41204.1276; train_edge_recon_loss: 26304050.2665; train_gene_expr_recon_loss: 6799931.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33145185.5010; train_optim_loss: 33145185.5010; val_kl_reg_loss: 35099.2410; val_edge_recon_loss: 26325132.6667; val_gene_expr_recon_loss: 6701410.0301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33061642.0370; val_optim_loss: 33061642.0370
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9848; val_auprc_score: 0.9821; val_best_acc_score: 0.9431; val_best_f1_score: 0.9443; train_kl_reg_loss: 34452.4392; train_edge_recon_loss: 26116065.2912; train_gene_expr_recon_loss: 6659921.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32810439.1934; train_optim_loss: 32810439.1934; val_kl_reg_loss: 33114.9749; val_edge_recon_loss: 26213070.7130; val_gene_expr_recon_loss: 6615686.2222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32861871.8611; val_optim_loss: 32861871.8611
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9830; val_best_acc_score: 0.9454; val_best_f1_score: 0.9467; train_kl_reg_loss: 33575.1191; train_edge_recon_loss: 26036048.7953; train_gene_expr_recon_loss: 6591328.3735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32660952.2757; train_optim_loss: 32660952.2757; val_kl_reg_loss: 32129.8487; val_edge_recon_loss: 26164275.3889; val_gene_expr_recon_loss: 6587979.8912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32784385.2037; val_optim_loss: 32784385.2037
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9873; val_auprc_score: 0.9849; val_best_acc_score: 0.9497; val_best_f1_score: 0.9509; train_kl_reg_loss: 32261.0781; train_edge_recon_loss: 26002220.8457; train_gene_expr_recon_loss: 6555708.2423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32590190.1553; train_optim_loss: 32590190.1553; val_kl_reg_loss: 31602.9831; val_edge_recon_loss: 26117521.9907; val_gene_expr_recon_loss: 6552917.0903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32702042.0741; val_optim_loss: 32702042.0741
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9879; val_auprc_score: 0.9854; val_best_acc_score: 0.9514; val_best_f1_score: 0.9522; train_kl_reg_loss: 31104.3629; train_edge_recon_loss: 25973129.0175; train_gene_expr_recon_loss: 6534465.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32538699.3632; train_optim_loss: 32538699.3632; val_kl_reg_loss: 29573.8696; val_edge_recon_loss: 26077724.3519; val_gene_expr_recon_loss: 6534564.4259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32641862.5926; val_optim_loss: 32641862.5926
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9891; val_auprc_score: 0.9867; val_best_acc_score: 0.9553; val_best_f1_score: 0.9561; train_kl_reg_loss: 29972.1171; train_edge_recon_loss: 25946933.7243; train_gene_expr_recon_loss: 6521730.3400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32498636.1924; train_optim_loss: 32498636.1924; val_kl_reg_loss: 29394.7272; val_edge_recon_loss: 26043557.9630; val_gene_expr_recon_loss: 6523739.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32596692.5648; val_optim_loss: 32596692.5648
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9898; val_auprc_score: 0.9875; val_best_acc_score: 0.9571; val_best_f1_score: 0.9579; train_kl_reg_loss: 29193.9031; train_edge_recon_loss: 25912169.7572; train_gene_expr_recon_loss: 6508013.2647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32449376.9198; train_optim_loss: 32449376.9198; val_kl_reg_loss: 28903.4306; val_edge_recon_loss: 25988457.5463; val_gene_expr_recon_loss: 6509263.7569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32526624.6944; val_optim_loss: 32526624.6944
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9904; val_auprc_score: 0.9883; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 28810.8035; train_edge_recon_loss: 25895392.2767; train_gene_expr_recon_loss: 6497556.8215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32421759.9218; train_optim_loss: 32421759.9218; val_kl_reg_loss: 27896.0722; val_edge_recon_loss: 26003669.8241; val_gene_expr_recon_loss: 6512055.7755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32543621.7037; val_optim_loss: 32543621.7037
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9900; val_auprc_score: 0.9878; val_best_acc_score: 0.9586; val_best_f1_score: 0.9593; train_kl_reg_loss: 28472.5099; train_edge_recon_loss: 25877460.2685; train_gene_expr_recon_loss: 6487120.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32393053.7346; train_optim_loss: 32393053.7346; val_kl_reg_loss: 27613.9882; val_edge_recon_loss: 26010301.9167; val_gene_expr_recon_loss: 6517768.5579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32555684.5185; val_optim_loss: 32555684.5185
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9905; val_auprc_score: 0.9882; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 28210.5907; train_edge_recon_loss: 25868803.3591; train_gene_expr_recon_loss: 6482962.7742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32379976.7078; train_optim_loss: 32379976.7078; val_kl_reg_loss: 28349.4088; val_edge_recon_loss: 25987476.8796; val_gene_expr_recon_loss: 6492173.1782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32507999.4259; val_optim_loss: 32507999.4259
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9612; val_best_f1_score: 0.9619; train_kl_reg_loss: 27975.8623; train_edge_recon_loss: 25853499.5247; train_gene_expr_recon_loss: 6475175.2613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32356650.6512; train_optim_loss: 32356650.6512; val_kl_reg_loss: 27859.3931; val_edge_recon_loss: 25974450.2222; val_gene_expr_recon_loss: 6493206.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32495515.7685; val_optim_loss: 32495515.7685
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 27604.3328; train_edge_recon_loss: 25847808.8796; train_gene_expr_recon_loss: 6468893.9887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32344307.2243; train_optim_loss: 32344307.2243; val_kl_reg_loss: 26708.3687; val_edge_recon_loss: 25956590.4722; val_gene_expr_recon_loss: 6503812.0903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32487110.8611; val_optim_loss: 32487110.8611
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9910; val_auprc_score: 0.9887; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 27208.2039; train_edge_recon_loss: 25828924.3508; train_gene_expr_recon_loss: 6466516.4887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32322649.0607; train_optim_loss: 32322649.0607; val_kl_reg_loss: 26634.8708; val_edge_recon_loss: 25942824.2037; val_gene_expr_recon_loss: 6491296.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32460755.1296; val_optim_loss: 32460755.1296
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9909; val_auprc_score: 0.9886; val_best_acc_score: 0.9618; val_best_f1_score: 0.9625; train_kl_reg_loss: 27078.4481; train_edge_recon_loss: 25826514.0144; train_gene_expr_recon_loss: 6459101.9282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32312694.4136; train_optim_loss: 32312694.4136; val_kl_reg_loss: 27185.4318; val_edge_recon_loss: 25949701.9167; val_gene_expr_recon_loss: 6487648.9051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32464536.2963; val_optim_loss: 32464536.2963
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9639; val_best_f1_score: 0.9644; train_kl_reg_loss: 26975.4370; train_edge_recon_loss: 25819549.3837; train_gene_expr_recon_loss: 6460064.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32306588.9897; train_optim_loss: 32306588.9897; val_kl_reg_loss: 26179.7212; val_edge_recon_loss: 25924104.7870; val_gene_expr_recon_loss: 6495275.8866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32445560.3056; val_optim_loss: 32445560.3056
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9914; val_auprc_score: 0.9892; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 26776.8648; train_edge_recon_loss: 25820986.6132; train_gene_expr_recon_loss: 6455477.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32303240.7377; train_optim_loss: 32303240.7377; val_kl_reg_loss: 26121.5199; val_edge_recon_loss: 25925761.9722; val_gene_expr_recon_loss: 6485714.2130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32437597.7407; val_optim_loss: 32437597.7407
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9919; val_auprc_score: 0.9900; val_best_acc_score: 0.9650; val_best_f1_score: 0.9655; train_kl_reg_loss: 26568.1857; train_edge_recon_loss: 25808224.9650; train_gene_expr_recon_loss: 6450958.0350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32285751.1677; train_optim_loss: 32285751.1677; val_kl_reg_loss: 26105.2407; val_edge_recon_loss: 25940229.4259; val_gene_expr_recon_loss: 6472877.6898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32439212.3519; val_optim_loss: 32439212.3519
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9916; val_auprc_score: 0.9895; val_best_acc_score: 0.9645; val_best_f1_score: 0.9651; train_kl_reg_loss: 26418.5417; train_edge_recon_loss: 25800199.8837; train_gene_expr_recon_loss: 6449572.7505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276191.1883; train_optim_loss: 32276191.1883; val_kl_reg_loss: 25582.0640; val_edge_recon_loss: 25922716.6667; val_gene_expr_recon_loss: 6490407.1597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32438705.8981; val_optim_loss: 32438705.8981
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 26323.6187; train_edge_recon_loss: 25799966.4259; train_gene_expr_recon_loss: 6450078.7726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32276368.8261; train_optim_loss: 32276368.8261; val_kl_reg_loss: 25885.9826; val_edge_recon_loss: 25943569.6111; val_gene_expr_recon_loss: 6474495.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32443950.8241; val_optim_loss: 32443950.8241
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9899; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 26219.6778; train_edge_recon_loss: 25795045.2809; train_gene_expr_recon_loss: 6445757.3670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32267022.3210; train_optim_loss: 32267022.3210; val_kl_reg_loss: 26188.6249; val_edge_recon_loss: 25904355.7130; val_gene_expr_recon_loss: 6479189.1898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32409733.5185; val_optim_loss: 32409733.5185
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 26266.0057; train_edge_recon_loss: 25783427.2654; train_gene_expr_recon_loss: 6439846.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32249539.7160; train_optim_loss: 32249539.7160; val_kl_reg_loss: 25839.5939; val_edge_recon_loss: 25899685.4259; val_gene_expr_recon_loss: 6468959.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32394484.9259; val_optim_loss: 32394484.9259
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9895; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 26043.1689; train_edge_recon_loss: 25772868.5823; train_gene_expr_recon_loss: 6437067.5720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32235979.3693; train_optim_loss: 32235979.3693; val_kl_reg_loss: 25903.8016; val_edge_recon_loss: 25874739.7037; val_gene_expr_recon_loss: 6475665.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32376308.5833; val_optim_loss: 32376308.5833
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 26023.8952; train_edge_recon_loss: 25779939.4177; train_gene_expr_recon_loss: 6435562.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32241525.6121; train_optim_loss: 32241525.6121; val_kl_reg_loss: 25854.0774; val_edge_recon_loss: 25895745.5000; val_gene_expr_recon_loss: 6471282.0463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32392881.6667; val_optim_loss: 32392881.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9920; val_auprc_score: 0.9896; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 25963.0681; train_edge_recon_loss: 25776248.8765; train_gene_expr_recon_loss: 6435939.3470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32238151.2788; train_optim_loss: 32238151.2788; val_kl_reg_loss: 25700.4153; val_edge_recon_loss: 25865830.6296; val_gene_expr_recon_loss: 6477417.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368948.4537; val_optim_loss: 32368948.4537
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 25782.5781; train_edge_recon_loss: 25776956.6173; train_gene_expr_recon_loss: 6433490.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32236229.5638; train_optim_loss: 32236229.5638; val_kl_reg_loss: 25170.9273; val_edge_recon_loss: 25870164.2500; val_gene_expr_recon_loss: 6467224.6806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32362559.7685; val_optim_loss: 32362559.7685
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9904; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 25633.7009; train_edge_recon_loss: 25775858.1728; train_gene_expr_recon_loss: 6429968.2395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32231460.0885; train_optim_loss: 32231460.0885; val_kl_reg_loss: 25033.8792; val_edge_recon_loss: 25869122.4352; val_gene_expr_recon_loss: 6470915.8218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32365072.1852; val_optim_loss: 32365072.1852
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 25571.4035; train_edge_recon_loss: 25766088.8385; train_gene_expr_recon_loss: 6430430.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32222090.9599; train_optim_loss: 32222090.9599; val_kl_reg_loss: 25530.2281; val_edge_recon_loss: 25895529.5648; val_gene_expr_recon_loss: 6467128.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388187.9907; val_optim_loss: 32388187.9907
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9904; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 25635.6558; train_edge_recon_loss: 25762951.0391; train_gene_expr_recon_loss: 6429983.3591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32218570.0658; train_optim_loss: 32218570.0658; val_kl_reg_loss: 25120.3275; val_edge_recon_loss: 25878852.5185; val_gene_expr_recon_loss: 6465953.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32369926.7593; val_optim_loss: 32369926.7593
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 25532.4966; train_edge_recon_loss: 25759939.2191; train_gene_expr_recon_loss: 6429724.1325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215195.8333; train_optim_loss: 32215195.8333; val_kl_reg_loss: 24976.3916; val_edge_recon_loss: 25866311.5741; val_gene_expr_recon_loss: 6477908.1713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32369196.1481; val_optim_loss: 32369196.1481

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 27232.3983; train_edge_recon_loss: 25746579.4249; train_gene_expr_recon_loss: 6371739.8840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32145551.7130; train_optim_loss: 32145551.7130; val_kl_reg_loss: 27631.6724; val_edge_recon_loss: 25862781.9722; val_gene_expr_recon_loss: 6422460.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32312874.6111; val_optim_loss: 32312874.6111
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 28014.0147; train_edge_recon_loss: 25740483.0916; train_gene_expr_recon_loss: 6366973.7433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32135470.8560; train_optim_loss: 32135470.8560; val_kl_reg_loss: 27914.9167; val_edge_recon_loss: 25853622.2778; val_gene_expr_recon_loss: 6416634.9190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32298172.1019; val_optim_loss: 32298172.1019
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9697; val_best_f1_score: 0.9700; train_kl_reg_loss: 28252.7153; train_edge_recon_loss: 25739678.9763; train_gene_expr_recon_loss: 6364630.4252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32132562.1163; train_optim_loss: 32132562.1163; val_kl_reg_loss: 27987.0372; val_edge_recon_loss: 25824957.5463; val_gene_expr_recon_loss: 6414366.2407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32267310.7778; val_optim_loss: 32267310.7778
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 28526.9341; train_edge_recon_loss: 25736118.9969; train_gene_expr_recon_loss: 6364989.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32129635.7675; train_optim_loss: 32129635.7675; val_kl_reg_loss: 27906.1600; val_edge_recon_loss: 25833333.4074; val_gene_expr_recon_loss: 6408069.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32269309.3241; val_optim_loss: 32269309.3241
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9930; val_auprc_score: 0.9909; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 28504.5228; train_edge_recon_loss: 25734752.2243; train_gene_expr_recon_loss: 6361712.3251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32124969.0700; train_optim_loss: 32124969.0700; val_kl_reg_loss: 28354.0757; val_edge_recon_loss: 25842954.1111; val_gene_expr_recon_loss: 6409377.7894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32280685.9259; val_optim_loss: 32280685.9259
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 28680.5541; train_edge_recon_loss: 25730230.6224; train_gene_expr_recon_loss: 6360399.0674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119310.2654; train_optim_loss: 32119310.2654; val_kl_reg_loss: 28334.6319; val_edge_recon_loss: 25838655.3796; val_gene_expr_recon_loss: 6408474.0718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32275464.0648; val_optim_loss: 32275464.0648
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9929; val_auprc_score: 0.9907; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 28782.0281; train_edge_recon_loss: 25734900.5453; train_gene_expr_recon_loss: 6360510.2140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32124192.7716; train_optim_loss: 32124192.7716; val_kl_reg_loss: 28422.2355; val_edge_recon_loss: 25831015.3796; val_gene_expr_recon_loss: 6411042.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32270479.9537; val_optim_loss: 32270479.9537

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 28813.3515; train_edge_recon_loss: 25732653.8004; train_gene_expr_recon_loss: 6354166.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32115633.1914; train_optim_loss: 32115633.1914; val_kl_reg_loss: 28403.0657; val_edge_recon_loss: 25838423.5278; val_gene_expr_recon_loss: 6408452.7546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32275279.3241; val_optim_loss: 32275279.3241
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 28838.6739; train_edge_recon_loss: 25737671.2191; train_gene_expr_recon_loss: 6353480.5283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119990.4239; train_optim_loss: 32119990.4239; val_kl_reg_loss: 28429.8676; val_edge_recon_loss: 25855761.2315; val_gene_expr_recon_loss: 6409385.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32293577.0093; val_optim_loss: 32293577.0093
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9700; val_best_f1_score: 0.9703; train_kl_reg_loss: 28889.3392; train_edge_recon_loss: 25732664.3930; train_gene_expr_recon_loss: 6356998.1847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32118551.9105; train_optim_loss: 32118551.9105; val_kl_reg_loss: 28466.8211; val_edge_recon_loss: 25849611.6574; val_gene_expr_recon_loss: 6407084.4468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32285163.0278; val_optim_loss: 32285163.0278
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 28921.0257; train_edge_recon_loss: 25734716.0504; train_gene_expr_recon_loss: 6352161.0520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32115798.1265; train_optim_loss: 32115798.1265; val_kl_reg_loss: 28453.4948; val_edge_recon_loss: 25844832.6019; val_gene_expr_recon_loss: 6405516.9190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32278803.0370; val_optim_loss: 32278803.0370

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 428 min 39 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9931
Val AUPRC score: 0.9913
Val best accuracy score: 0.9691
Val best F1 score: 0.9694
Val gene expr MSE score: 1.5432

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
