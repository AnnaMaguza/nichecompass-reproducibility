None
Run timestamp: 16072023_181405_1013.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1013']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9835; val_auprc_score: 0.9746; val_best_acc_score: 0.9547; val_best_f1_score: 0.9557; train_kl_reg_loss: 16246.7842; train_edge_recon_loss: 26936300.1630; train_gene_expr_recon_loss: 21077235.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48029782.3370; train_optim_loss: 48029782.3370; val_kl_reg_loss: 17154.3851; val_edge_recon_loss: 26014192.0976; val_gene_expr_recon_loss: 20174101.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46205448.6829; val_optim_loss: 46205448.6829
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9867; val_auprc_score: 0.9807; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 16876.8253; train_edge_recon_loss: 25853080.0870; train_gene_expr_recon_loss: 19873864.5163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45743821.3478; train_optim_loss: 45743821.3478; val_kl_reg_loss: 16263.1101; val_edge_recon_loss: 25912286.0488; val_gene_expr_recon_loss: 19577253.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45505803.0244; val_optim_loss: 45505803.0244
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9884; val_auprc_score: 0.9838; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 16909.3358; train_edge_recon_loss: 25760178.5761; train_gene_expr_recon_loss: 19359695.0761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45136783.0217; train_optim_loss: 45136783.0217; val_kl_reg_loss: 16940.9562; val_edge_recon_loss: 25837103.6098; val_gene_expr_recon_loss: 19135094.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44989138.7317; val_optim_loss: 44989138.7317
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9847; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 17203.3922; train_edge_recon_loss: 25725615.4457; train_gene_expr_recon_loss: 19002936.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44745754.9783; train_optim_loss: 44745754.9783; val_kl_reg_loss: 16794.2474; val_edge_recon_loss: 25847071.8049; val_gene_expr_recon_loss: 18821173.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44685039.0244; val_optim_loss: 44685039.0244
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9902; val_auprc_score: 0.9867; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 18254.1622; train_edge_recon_loss: 25706839.8207; train_gene_expr_recon_loss: 18680146.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44405240.0109; train_optim_loss: 44405240.0109; val_kl_reg_loss: 18632.1035; val_edge_recon_loss: 25828053.3659; val_gene_expr_recon_loss: 18573244.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44419929.7561; val_optim_loss: 44419929.7561
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9905; val_auprc_score: 0.9864; val_best_acc_score: 0.9687; val_best_f1_score: 0.9694; train_kl_reg_loss: 19174.8195; train_edge_recon_loss: 25682353.1413; train_gene_expr_recon_loss: 18448230.0380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44149758.0870; train_optim_loss: 44149758.0870; val_kl_reg_loss: 20117.3679; val_edge_recon_loss: 25777870.6829; val_gene_expr_recon_loss: 18324877.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44122865.6585; val_optim_loss: 44122865.6585
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9909; val_auprc_score: 0.9873; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 19017.5065; train_edge_recon_loss: 25670597.0380; train_gene_expr_recon_loss: 18195694.8696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43885309.4783; train_optim_loss: 43885309.4783; val_kl_reg_loss: 19579.8412; val_edge_recon_loss: 25785906.9756; val_gene_expr_recon_loss: 18115882.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43921369.7561; val_optim_loss: 43921369.7561
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9915; val_auprc_score: 0.9884; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 18671.2668; train_edge_recon_loss: 25662070.5543; train_gene_expr_recon_loss: 17964225.1413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43644966.9130; train_optim_loss: 43644966.9130; val_kl_reg_loss: 17016.2935; val_edge_recon_loss: 25743196.0976; val_gene_expr_recon_loss: 17973166.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43733379.5122; val_optim_loss: 43733379.5122
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9906; val_auprc_score: 0.9877; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 18293.1428; train_edge_recon_loss: 25656245.2337; train_gene_expr_recon_loss: 17802228.1440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43476766.5109; train_optim_loss: 43476766.5109; val_kl_reg_loss: 19197.3502; val_edge_recon_loss: 25822596.0000; val_gene_expr_recon_loss: 17855213.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43697006.2439; val_optim_loss: 43697006.2439
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9909; val_auprc_score: 0.9878; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 18502.0897; train_edge_recon_loss: 25642164.2989; train_gene_expr_recon_loss: 17642191.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43302857.7935; train_optim_loss: 43302857.7935; val_kl_reg_loss: 17954.2821; val_edge_recon_loss: 25797675.0732; val_gene_expr_recon_loss: 17767053.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43582683.4146; val_optim_loss: 43582683.4146
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 18434.4794; train_edge_recon_loss: 25641348.2663; train_gene_expr_recon_loss: 17506465.0380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43166247.7065; train_optim_loss: 43166247.7065; val_kl_reg_loss: 18414.8906; val_edge_recon_loss: 25773256.9756; val_gene_expr_recon_loss: 17669098.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43460770.4390; val_optim_loss: 43460770.4390
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9913; val_auprc_score: 0.9882; val_best_acc_score: 0.9706; val_best_f1_score: 0.9712; train_kl_reg_loss: 18473.6936; train_edge_recon_loss: 25644064.8696; train_gene_expr_recon_loss: 17402729.6359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43065268.1848; train_optim_loss: 43065268.1848; val_kl_reg_loss: 18610.3652; val_edge_recon_loss: 25746140.7317; val_gene_expr_recon_loss: 17555655.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43320406.9268; val_optim_loss: 43320406.9268
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9905; val_auprc_score: 0.9872; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 18484.6001; train_edge_recon_loss: 25620379.6902; train_gene_expr_recon_loss: 17300630.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42939494.5978; train_optim_loss: 42939494.5978; val_kl_reg_loss: 18508.3599; val_edge_recon_loss: 25771822.5366; val_gene_expr_recon_loss: 17516673.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43307004.2927; val_optim_loss: 43307004.2927
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9921; val_auprc_score: 0.9894; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 18501.0220; train_edge_recon_loss: 25622664.4891; train_gene_expr_recon_loss: 17223167.7092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42864333.3043; train_optim_loss: 42864333.3043; val_kl_reg_loss: 18308.0016; val_edge_recon_loss: 25720122.5366; val_gene_expr_recon_loss: 17493036.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43231466.9268; val_optim_loss: 43231466.9268
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9914; val_auprc_score: 0.9883; val_best_acc_score: 0.9717; val_best_f1_score: 0.9723; train_kl_reg_loss: 18622.4136; train_edge_recon_loss: 25620705.0109; train_gene_expr_recon_loss: 17157114.0978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42796441.5652; train_optim_loss: 42796441.5652; val_kl_reg_loss: 18665.8787; val_edge_recon_loss: 25708599.9512; val_gene_expr_recon_loss: 17450057.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43177323.5122; val_optim_loss: 43177323.5122
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9912; val_auprc_score: 0.9880; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 18670.8872; train_edge_recon_loss: 25611814.7011; train_gene_expr_recon_loss: 17090233.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42720719.2065; train_optim_loss: 42720719.2065; val_kl_reg_loss: 18334.0719; val_edge_recon_loss: 25750223.2195; val_gene_expr_recon_loss: 17388775.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43157333.4634; val_optim_loss: 43157333.4634
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 18726.1065; train_edge_recon_loss: 25611280.0489; train_gene_expr_recon_loss: 17040886.4402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42670892.5870; train_optim_loss: 42670892.5870; val_kl_reg_loss: 18685.6217; val_edge_recon_loss: 25736611.0244; val_gene_expr_recon_loss: 17340158.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43095455.7073; val_optim_loss: 43095455.7073
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 18789.9798; train_edge_recon_loss: 25607234.1196; train_gene_expr_recon_loss: 16992566.2473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42618590.3152; train_optim_loss: 42618590.3152; val_kl_reg_loss: 19043.6092; val_edge_recon_loss: 25721392.8293; val_gene_expr_recon_loss: 17348298.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43088735.1220; val_optim_loss: 43088735.1220
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9920; val_auprc_score: 0.9896; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 18818.1738; train_edge_recon_loss: 25610149.2011; train_gene_expr_recon_loss: 16970006.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42598974.0326; train_optim_loss: 42598974.0326; val_kl_reg_loss: 18308.1639; val_edge_recon_loss: 25735521.3659; val_gene_expr_recon_loss: 17415764.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43169594.2439; val_optim_loss: 43169594.2439
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9735; val_best_f1_score: 0.9740; train_kl_reg_loss: 18898.5542; train_edge_recon_loss: 25604323.5000; train_gene_expr_recon_loss: 16909701.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42532923.9022; train_optim_loss: 42532923.9022; val_kl_reg_loss: 18376.3482; val_edge_recon_loss: 25698838.3415; val_gene_expr_recon_loss: 17366627.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43083842.1463; val_optim_loss: 43083842.1463
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 18916.0678; train_edge_recon_loss: 25606614.1033; train_gene_expr_recon_loss: 16905832.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42531362.4348; train_optim_loss: 42531362.4348; val_kl_reg_loss: 18550.6750; val_edge_recon_loss: 25710211.8049; val_gene_expr_recon_loss: 17386592.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43115355.0244; val_optim_loss: 43115355.0244
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9914; val_auprc_score: 0.9882; val_best_acc_score: 0.9722; val_best_f1_score: 0.9728; train_kl_reg_loss: 18959.4350; train_edge_recon_loss: 25585738.4076; train_gene_expr_recon_loss: 16864015.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42468713.5217; train_optim_loss: 42468713.5217; val_kl_reg_loss: 18944.0144; val_edge_recon_loss: 25689568.2439; val_gene_expr_recon_loss: 17334822.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43043334.7317; val_optim_loss: 43043334.7317
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 18967.7567; train_edge_recon_loss: 25595606.4293; train_gene_expr_recon_loss: 16847683.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42462257.2609; train_optim_loss: 42462257.2609; val_kl_reg_loss: 18902.5763; val_edge_recon_loss: 25702445.1220; val_gene_expr_recon_loss: 17424763.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43146111.8049; val_optim_loss: 43146111.8049
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 19023.0393; train_edge_recon_loss: 25586767.1630; train_gene_expr_recon_loss: 16816688.0136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42422478.2609; train_optim_loss: 42422478.2609; val_kl_reg_loss: 18995.7897; val_edge_recon_loss: 25708071.5610; val_gene_expr_recon_loss: 17388695.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43115762.4390; val_optim_loss: 43115762.4390
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9927; val_auprc_score: 0.9904; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 19040.1769; train_edge_recon_loss: 25588887.6250; train_gene_expr_recon_loss: 16805932.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42413859.9891; train_optim_loss: 42413859.9891; val_kl_reg_loss: 18602.5158; val_edge_recon_loss: 25701453.3659; val_gene_expr_recon_loss: 17391411.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43111466.8293; val_optim_loss: 43111466.8293
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9924; val_auprc_score: 0.9898; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 19046.6503; train_edge_recon_loss: 25593677.6467; train_gene_expr_recon_loss: 16797667.8533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42410392.1413; train_optim_loss: 42410392.1413; val_kl_reg_loss: 18736.0500; val_edge_recon_loss: 25695596.6829; val_gene_expr_recon_loss: 17350989.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43065322.8293; val_optim_loss: 43065322.8293

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9919; val_auprc_score: 0.9887; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 19999.2297; train_edge_recon_loss: 25542972.5217; train_gene_expr_recon_loss: 16552775.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42115747.0761; train_optim_loss: 42115747.0761; val_kl_reg_loss: 19731.2000; val_edge_recon_loss: 25664862.8293; val_gene_expr_recon_loss: 17220986.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42905580.8780; val_optim_loss: 42905580.8780
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9919; val_auprc_score: 0.9891; val_best_acc_score: 0.9722; val_best_f1_score: 0.9728; train_kl_reg_loss: 19667.6250; train_edge_recon_loss: 25551436.8967; train_gene_expr_recon_loss: 16526019.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42097123.7500; train_optim_loss: 42097123.7500; val_kl_reg_loss: 19194.5985; val_edge_recon_loss: 25663836.0976; val_gene_expr_recon_loss: 17183312.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42866343.7073; val_optim_loss: 42866343.7073
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9920; val_auprc_score: 0.9890; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 19371.6554; train_edge_recon_loss: 25543940.9946; train_gene_expr_recon_loss: 16504976.3071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42068289.0000; train_optim_loss: 42068289.0000; val_kl_reg_loss: 19112.4301; val_edge_recon_loss: 25640849.2683; val_gene_expr_recon_loss: 17225612.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42885575.0244; val_optim_loss: 42885575.0244
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9916; val_auprc_score: 0.9886; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 19289.0013; train_edge_recon_loss: 25542253.6250; train_gene_expr_recon_loss: 16495113.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42056655.9565; train_optim_loss: 42056655.9565; val_kl_reg_loss: 19082.6491; val_edge_recon_loss: 25613874.4878; val_gene_expr_recon_loss: 17209550.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42842507.1220; val_optim_loss: 42842507.1220
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9920; val_auprc_score: 0.9891; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 19264.9530; train_edge_recon_loss: 25534959.9511; train_gene_expr_recon_loss: 16490219.5571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42044444.4565; train_optim_loss: 42044444.4565; val_kl_reg_loss: 19060.5683; val_edge_recon_loss: 25612293.2195; val_gene_expr_recon_loss: 17204167.2439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42835520.5854; val_optim_loss: 42835520.5854
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9923; val_auprc_score: 0.9897; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 19252.4898; train_edge_recon_loss: 25531559.2011; train_gene_expr_recon_loss: 16489178.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42039989.9239; train_optim_loss: 42039989.9239; val_kl_reg_loss: 18993.5155; val_edge_recon_loss: 25627112.5366; val_gene_expr_recon_loss: 17218340.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42864446.7317; val_optim_loss: 42864446.7317
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 19261.6265; train_edge_recon_loss: 25541080.3533; train_gene_expr_recon_loss: 16462534.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42022876.7065; train_optim_loss: 42022876.7065; val_kl_reg_loss: 19091.1297; val_edge_recon_loss: 25618618.4390; val_gene_expr_recon_loss: 17269803.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42907513.0732; val_optim_loss: 42907513.0732
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9913; val_auprc_score: 0.9882; val_best_acc_score: 0.9714; val_best_f1_score: 0.9720; train_kl_reg_loss: 19294.5764; train_edge_recon_loss: 25533262.4620; train_gene_expr_recon_loss: 16470907.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42023464.7391; train_optim_loss: 42023464.7391; val_kl_reg_loss: 19083.2279; val_edge_recon_loss: 25643334.5366; val_gene_expr_recon_loss: 17226317.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42888735.6098; val_optim_loss: 42888735.6098
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9915; val_auprc_score: 0.9885; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 19298.2454; train_edge_recon_loss: 25523466.5870; train_gene_expr_recon_loss: 16452552.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41995317.2826; train_optim_loss: 41995317.2826; val_kl_reg_loss: 19069.9636; val_edge_recon_loss: 25583615.6098; val_gene_expr_recon_loss: 17235406.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42838092.0000; val_optim_loss: 42838092.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9923; val_auprc_score: 0.9894; val_best_acc_score: 0.9738; val_best_f1_score: 0.9743; train_kl_reg_loss: 19405.2287; train_edge_recon_loss: 25530332.9620; train_gene_expr_recon_loss: 16425164.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41974902.2935; train_optim_loss: 41974902.2935; val_kl_reg_loss: 19192.7441; val_edge_recon_loss: 25590124.4878; val_gene_expr_recon_loss: 17237565.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42846882.9268; val_optim_loss: 42846882.9268
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 19479.1695; train_edge_recon_loss: 25527439.0489; train_gene_expr_recon_loss: 16416851.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41963769.6087; train_optim_loss: 41963769.6087; val_kl_reg_loss: 19228.9070; val_edge_recon_loss: 25613461.0732; val_gene_expr_recon_loss: 17248069.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42880759.2195; val_optim_loss: 42880759.2195
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9913; val_auprc_score: 0.9884; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 19497.4294; train_edge_recon_loss: 25531749.4293; train_gene_expr_recon_loss: 16410059.3397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41961306.2283; train_optim_loss: 41961306.2283; val_kl_reg_loss: 19232.0432; val_edge_recon_loss: 25635200.0488; val_gene_expr_recon_loss: 17238576.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42893008.8780; val_optim_loss: 42893008.8780
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9918; val_auprc_score: 0.9890; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 19498.6487; train_edge_recon_loss: 25530083.7391; train_gene_expr_recon_loss: 16419975.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41969558.2609; train_optim_loss: 41969558.2609; val_kl_reg_loss: 19232.9345; val_edge_recon_loss: 25604036.2927; val_gene_expr_recon_loss: 17219234.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42842504.0000; val_optim_loss: 42842504.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 121 min 35 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9919
Val AUPRC score: 0.9890
Val best accuracy score: 0.9721
Val best F1 score: 0.9726
Val gene expr MSE score: 0.4788

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
