None
Run timestamp: 29072023_000815_65.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_65']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9716; val_best_acc_score: 0.9200; val_best_f1_score: 0.9208; train_kl_reg_loss: 2068.6793; train_edge_recon_loss: 28109.9170; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30178.5963; train_optim_loss: 30178.5963; val_kl_reg_loss: 2195.3146; val_edge_recon_loss: 26533.3865; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28728.7011; val_optim_loss: 28728.7011
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9781; val_auprc_score: 0.9766; val_best_acc_score: 0.9279; val_best_f1_score: 0.9282; train_kl_reg_loss: 2246.4521; train_edge_recon_loss: 27403.8247; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29650.2768; train_optim_loss: 29650.2768; val_kl_reg_loss: 2098.6242; val_edge_recon_loss: 26521.5804; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28620.2046; val_optim_loss: 28620.2046
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9817; val_auprc_score: 0.9801; val_best_acc_score: 0.9349; val_best_f1_score: 0.9356; train_kl_reg_loss: 2260.2222; train_edge_recon_loss: 27333.0176; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29593.2398; train_optim_loss: 29593.2398; val_kl_reg_loss: 2111.5312; val_edge_recon_loss: 26438.9923; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28550.5235; val_optim_loss: 28550.5235
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9829; val_auprc_score: 0.9814; val_best_acc_score: 0.9363; val_best_f1_score: 0.9367; train_kl_reg_loss: 2269.7187; train_edge_recon_loss: 27287.0414; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29556.7602; train_optim_loss: 29556.7602; val_kl_reg_loss: 2182.3295; val_edge_recon_loss: 26439.9357; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28622.2652; val_optim_loss: 28622.2652
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9830; val_auprc_score: 0.9818; val_best_acc_score: 0.9370; val_best_f1_score: 0.9375; train_kl_reg_loss: 2276.3767; train_edge_recon_loss: 27258.9506; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29535.3273; train_optim_loss: 29535.3273; val_kl_reg_loss: 2238.8109; val_edge_recon_loss: 26387.6193; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28626.4302; val_optim_loss: 28626.4302
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9831; val_auprc_score: 0.9816; val_best_acc_score: 0.9367; val_best_f1_score: 0.9370; train_kl_reg_loss: 2278.5669; train_edge_recon_loss: 27243.2887; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29521.8556; train_optim_loss: 29521.8556; val_kl_reg_loss: 2187.8451; val_edge_recon_loss: 26445.9789; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28633.8240; val_optim_loss: 28633.8240
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9839; val_auprc_score: 0.9824; val_best_acc_score: 0.9393; val_best_f1_score: 0.9398; train_kl_reg_loss: 2282.9218; train_edge_recon_loss: 27218.3690; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29501.2908; train_optim_loss: 29501.2908; val_kl_reg_loss: 2274.1134; val_edge_recon_loss: 26360.8597; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28634.9732; val_optim_loss: 28634.9732
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9842; val_best_acc_score: 0.9427; val_best_f1_score: 0.9429; train_kl_reg_loss: 2282.6769; train_edge_recon_loss: 27217.0976; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29499.7745; train_optim_loss: 29499.7745; val_kl_reg_loss: 2173.4127; val_edge_recon_loss: 26345.0909; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28518.5036; val_optim_loss: 28518.5036
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9856; val_auprc_score: 0.9841; val_best_acc_score: 0.9437; val_best_f1_score: 0.9443; train_kl_reg_loss: 2284.4816; train_edge_recon_loss: 27202.0363; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29486.5179; train_optim_loss: 29486.5179; val_kl_reg_loss: 2269.0322; val_edge_recon_loss: 26345.7009; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28614.7330; val_optim_loss: 28614.7330
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9850; val_auprc_score: 0.9834; val_best_acc_score: 0.9425; val_best_f1_score: 0.9428; train_kl_reg_loss: 2285.9051; train_edge_recon_loss: 27187.1432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29473.0483; train_optim_loss: 29473.0483; val_kl_reg_loss: 2241.6829; val_edge_recon_loss: 26399.3856; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28641.0685; val_optim_loss: 28641.0685
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9869; val_auprc_score: 0.9853; val_best_acc_score: 0.9465; val_best_f1_score: 0.9469; train_kl_reg_loss: 2284.2734; train_edge_recon_loss: 27190.6465; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29474.9199; train_optim_loss: 29474.9199; val_kl_reg_loss: 2197.2182; val_edge_recon_loss: 26348.2025; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28545.4206; val_optim_loss: 28545.4206
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9873; val_auprc_score: 0.9859; val_best_acc_score: 0.9475; val_best_f1_score: 0.9478; train_kl_reg_loss: 2285.4209; train_edge_recon_loss: 27184.8245; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29470.2454; train_optim_loss: 29470.2454; val_kl_reg_loss: 2218.1075; val_edge_recon_loss: 26284.2006; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28502.3080; val_optim_loss: 28502.3080
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9871; val_auprc_score: 0.9859; val_best_acc_score: 0.9469; val_best_f1_score: 0.9472; train_kl_reg_loss: 2285.8520; train_edge_recon_loss: 27177.2843; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29463.1364; train_optim_loss: 29463.1364; val_kl_reg_loss: 2241.9449; val_edge_recon_loss: 26330.4410; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28572.3858; val_optim_loss: 28572.3858
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9881; val_auprc_score: 0.9868; val_best_acc_score: 0.9490; val_best_f1_score: 0.9493; train_kl_reg_loss: 2287.6493; train_edge_recon_loss: 27171.1546; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29458.8039; train_optim_loss: 29458.8039; val_kl_reg_loss: 2254.1295; val_edge_recon_loss: 26308.1936; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28562.3231; val_optim_loss: 28562.3231
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9876; val_auprc_score: 0.9860; val_best_acc_score: 0.9478; val_best_f1_score: 0.9483; train_kl_reg_loss: 2289.1166; train_edge_recon_loss: 27162.5736; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29451.6902; train_optim_loss: 29451.6902; val_kl_reg_loss: 2251.2639; val_edge_recon_loss: 26306.9012; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28558.1651; val_optim_loss: 28558.1651
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9885; val_auprc_score: 0.9873; val_best_acc_score: 0.9500; val_best_f1_score: 0.9503; train_kl_reg_loss: 2289.0583; train_edge_recon_loss: 27159.3942; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29448.4525; train_optim_loss: 29448.4525; val_kl_reg_loss: 2167.8349; val_edge_recon_loss: 26304.8322; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28472.6671; val_optim_loss: 28472.6671
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9885; val_auprc_score: 0.9870; val_best_acc_score: 0.9509; val_best_f1_score: 0.9514; train_kl_reg_loss: 2290.6872; train_edge_recon_loss: 27146.7535; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29437.4407; train_optim_loss: 29437.4407; val_kl_reg_loss: 2286.3354; val_edge_recon_loss: 26280.1514; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28566.4868; val_optim_loss: 28566.4868
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9875; val_auprc_score: 0.9861; val_best_acc_score: 0.9485; val_best_f1_score: 0.9486; train_kl_reg_loss: 2289.6711; train_edge_recon_loss: 27143.2525; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29432.9237; train_optim_loss: 29432.9237; val_kl_reg_loss: 2277.7462; val_edge_recon_loss: 26303.2515; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28580.9977; val_optim_loss: 28580.9977
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9887; val_auprc_score: 0.9873; val_best_acc_score: 0.9515; val_best_f1_score: 0.9518; train_kl_reg_loss: 2290.2815; train_edge_recon_loss: 27141.9152; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29432.1967; train_optim_loss: 29432.1967; val_kl_reg_loss: 2194.7499; val_edge_recon_loss: 26252.9734; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28447.7233; val_optim_loss: 28447.7233
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9866; val_best_acc_score: 0.9503; val_best_f1_score: 0.9508; train_kl_reg_loss: 2291.2065; train_edge_recon_loss: 27137.3945; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29428.6010; train_optim_loss: 29428.6010; val_kl_reg_loss: 2263.5511; val_edge_recon_loss: 26271.3740; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28534.9251; val_optim_loss: 28534.9251
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9883; val_auprc_score: 0.9871; val_best_acc_score: 0.9496; val_best_f1_score: 0.9499; train_kl_reg_loss: 2291.1727; train_edge_recon_loss: 27136.2461; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29427.4188; train_optim_loss: 29427.4188; val_kl_reg_loss: 2243.5512; val_edge_recon_loss: 26326.8784; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28570.4295; val_optim_loss: 28570.4295
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9865; val_best_acc_score: 0.9515; val_best_f1_score: 0.9519; train_kl_reg_loss: 2293.5499; train_edge_recon_loss: 27116.0768; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29409.6267; train_optim_loss: 29409.6267; val_kl_reg_loss: 2258.6404; val_edge_recon_loss: 26284.7056; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28543.3460; val_optim_loss: 28543.3460
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9888; val_auprc_score: 0.9873; val_best_acc_score: 0.9522; val_best_f1_score: 0.9525; train_kl_reg_loss: 2292.4323; train_edge_recon_loss: 27133.1668; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29425.5991; train_optim_loss: 29425.5991; val_kl_reg_loss: 2258.6599; val_edge_recon_loss: 26275.6611; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28534.3210; val_optim_loss: 28534.3210

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9899; val_auprc_score: 0.9886; val_best_acc_score: 0.9544; val_best_f1_score: 0.9547; train_kl_reg_loss: 2288.6877; train_edge_recon_loss: 27091.7294; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29380.4171; train_optim_loss: 29380.4171; val_kl_reg_loss: 2269.9654; val_edge_recon_loss: 26219.6219; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28489.5874; val_optim_loss: 28489.5874
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9902; val_auprc_score: 0.9890; val_best_acc_score: 0.9549; val_best_f1_score: 0.9550; train_kl_reg_loss: 2285.2687; train_edge_recon_loss: 27092.3854; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29377.6541; train_optim_loss: 29377.6541; val_kl_reg_loss: 2268.1914; val_edge_recon_loss: 26225.8543; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28494.0458; val_optim_loss: 28494.0458
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9894; val_auprc_score: 0.9879; val_best_acc_score: 0.9534; val_best_f1_score: 0.9537; train_kl_reg_loss: 2286.3461; train_edge_recon_loss: 27082.9409; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29369.2870; train_optim_loss: 29369.2870; val_kl_reg_loss: 2250.9877; val_edge_recon_loss: 26221.3303; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28472.3180; val_optim_loss: 28472.3180
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9888; val_best_acc_score: 0.9542; val_best_f1_score: 0.9547; train_kl_reg_loss: 2285.8396; train_edge_recon_loss: 27080.7428; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29366.5825; train_optim_loss: 29366.5825; val_kl_reg_loss: 2244.5629; val_edge_recon_loss: 26238.1166; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28482.6795; val_optim_loss: 28482.6795

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 56 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9889
val AUPRC score: 0.9874
val best accuracy score: 0.9517
val best F1 score: 0.9519
val target rna MSE score: 13.4453
val source rna MSE score: 8.3792

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
