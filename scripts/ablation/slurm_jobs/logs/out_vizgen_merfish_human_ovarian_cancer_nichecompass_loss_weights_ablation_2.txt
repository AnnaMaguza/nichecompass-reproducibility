None
Run timestamp: 14072023_140020_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9845; val_auprc_score: 0.9838; val_best_acc_score: 0.9373; val_best_f1_score: 0.9377; train_kl_reg_loss: 35853.6879; train_edge_recon_loss: 2718896.1221; train_gene_expr_recon_loss: 1406440.9226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4161190.7329; train_optim_loss: 4161190.7329; val_kl_reg_loss: 28857.3045; val_edge_recon_loss: 2653716.6045; val_gene_expr_recon_loss: 1319010.8721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4001584.7887; val_optim_loss: 4001584.7887
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9888; val_auprc_score: 0.9882; val_best_acc_score: 0.9473; val_best_f1_score: 0.9475; train_kl_reg_loss: 26197.7432; train_edge_recon_loss: 2624742.9376; train_gene_expr_recon_loss: 1292593.5361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3943534.2206; train_optim_loss: 3943534.2206; val_kl_reg_loss: 23231.0905; val_edge_recon_loss: 2637686.7160; val_gene_expr_recon_loss: 1278641.6784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3939559.4871; val_optim_loss: 3939559.4871
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9918; val_auprc_score: 0.9913; val_best_acc_score: 0.9563; val_best_f1_score: 0.9566; train_kl_reg_loss: 21771.5857; train_edge_recon_loss: 2613352.4712; train_gene_expr_recon_loss: 1269935.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3905059.0612; train_optim_loss: 3905059.0612; val_kl_reg_loss: 20251.1816; val_edge_recon_loss: 2626590.7981; val_gene_expr_recon_loss: 1266075.3785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3912917.3592; val_optim_loss: 3912917.3592
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9922; val_auprc_score: 0.9917; val_best_acc_score: 0.9576; val_best_f1_score: 0.9578; train_kl_reg_loss: 19634.9865; train_edge_recon_loss: 2605252.5943; train_gene_expr_recon_loss: 1259174.2991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3884061.8844; train_optim_loss: 3884061.8844; val_kl_reg_loss: 18552.6989; val_edge_recon_loss: 2625866.1467; val_gene_expr_recon_loss: 1260079.1948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3904498.0364; val_optim_loss: 3904498.0364
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9929; val_auprc_score: 0.9923; val_best_acc_score: 0.9602; val_best_f1_score: 0.9604; train_kl_reg_loss: 18582.3006; train_edge_recon_loss: 2600626.8450; train_gene_expr_recon_loss: 1252517.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3871726.8069; train_optim_loss: 3871726.8069; val_kl_reg_loss: 18391.4673; val_edge_recon_loss: 2617113.5235; val_gene_expr_recon_loss: 1253435.3885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3888940.3768; val_optim_loss: 3888940.3768
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9934; val_auprc_score: 0.9929; val_best_acc_score: 0.9617; val_best_f1_score: 0.9618; train_kl_reg_loss: 17807.6658; train_edge_recon_loss: 2597836.9802; train_gene_expr_recon_loss: 1248189.8775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3863834.5205; train_optim_loss: 3863834.5205; val_kl_reg_loss: 17243.2641; val_edge_recon_loss: 2617942.2300; val_gene_expr_recon_loss: 1250366.6702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3885552.1526; val_optim_loss: 3885552.1526
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9933; val_best_acc_score: 0.9629; val_best_f1_score: 0.9630; train_kl_reg_loss: 17278.5228; train_edge_recon_loss: 2595064.9689; train_gene_expr_recon_loss: 1244694.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3857037.9868; train_optim_loss: 3857037.9868; val_kl_reg_loss: 16546.5148; val_edge_recon_loss: 2615550.2864; val_gene_expr_recon_loss: 1247637.8369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3879734.6362; val_optim_loss: 3879734.6362
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9940; val_best_acc_score: 0.9648; val_best_f1_score: 0.9650; train_kl_reg_loss: 16848.3742; train_edge_recon_loss: 2593352.3586; train_gene_expr_recon_loss: 1241834.9823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3852035.7136; train_optim_loss: 3852035.7136; val_kl_reg_loss: 16582.9160; val_edge_recon_loss: 2611650.4167; val_gene_expr_recon_loss: 1246475.7606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3874709.0904; val_optim_loss: 3874709.0904
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9945; val_auprc_score: 0.9940; val_best_acc_score: 0.9658; val_best_f1_score: 0.9660; train_kl_reg_loss: 16604.5372; train_edge_recon_loss: 2591943.6040; train_gene_expr_recon_loss: 1238798.7554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3847346.8952; train_optim_loss: 3847346.8952; val_kl_reg_loss: 16002.9037; val_edge_recon_loss: 2611780.8873; val_gene_expr_recon_loss: 1244483.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3872267.5951; val_optim_loss: 3872267.5951
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9947; val_auprc_score: 0.9943; val_best_acc_score: 0.9667; val_best_f1_score: 0.9667; train_kl_reg_loss: 16364.2068; train_edge_recon_loss: 2590530.3883; train_gene_expr_recon_loss: 1238104.2790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3844998.8760; train_optim_loss: 3844998.8760; val_kl_reg_loss: 15901.6446; val_edge_recon_loss: 2609223.9085; val_gene_expr_recon_loss: 1242184.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3867310.2570; val_optim_loss: 3867310.2570
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9948; val_auprc_score: 0.9943; val_best_acc_score: 0.9678; val_best_f1_score: 0.9679; train_kl_reg_loss: 16217.8878; train_edge_recon_loss: 2589601.8749; train_gene_expr_recon_loss: 1236255.3654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3842075.1274; train_optim_loss: 3842075.1274; val_kl_reg_loss: 15905.3785; val_edge_recon_loss: 2610953.0188; val_gene_expr_recon_loss: 1241545.2758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3868403.6702; val_optim_loss: 3868403.6702
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9946; val_best_acc_score: 0.9680; val_best_f1_score: 0.9681; train_kl_reg_loss: 16107.1752; train_edge_recon_loss: 2588212.3335; train_gene_expr_recon_loss: 1234452.3184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3838771.8280; train_optim_loss: 3838771.8280; val_kl_reg_loss: 15868.9794; val_edge_recon_loss: 2610182.5869; val_gene_expr_recon_loss: 1241447.8198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3867499.3862; val_optim_loss: 3867499.3862
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9945; val_best_acc_score: 0.9679; val_best_f1_score: 0.9680; train_kl_reg_loss: 15973.4380; train_edge_recon_loss: 2587299.9180; train_gene_expr_recon_loss: 1233035.7838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3836309.1418; train_optim_loss: 3836309.1418; val_kl_reg_loss: 15911.7714; val_edge_recon_loss: 2606781.7430; val_gene_expr_recon_loss: 1238134.2606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3860827.7911; val_optim_loss: 3860827.7911
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9956; val_auprc_score: 0.9951; val_best_acc_score: 0.9698; val_best_f1_score: 0.9699; train_kl_reg_loss: 15883.1246; train_edge_recon_loss: 2586993.8112; train_gene_expr_recon_loss: 1232670.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3835547.0276; train_optim_loss: 3835547.0276; val_kl_reg_loss: 15389.2358; val_edge_recon_loss: 2605836.6831; val_gene_expr_recon_loss: 1241310.8187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3862536.7394; val_optim_loss: 3862536.7394
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9955; val_auprc_score: 0.9951; val_best_acc_score: 0.9698; val_best_f1_score: 0.9700; train_kl_reg_loss: 15795.4545; train_edge_recon_loss: 2586180.6395; train_gene_expr_recon_loss: 1230985.7709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3832961.8667; train_optim_loss: 3832961.8667; val_kl_reg_loss: 15564.6870; val_edge_recon_loss: 2606483.3803; val_gene_expr_recon_loss: 1238960.3697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3861008.4366; val_optim_loss: 3861008.4366
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9706; val_best_f1_score: 0.9708; train_kl_reg_loss: 15716.2224; train_edge_recon_loss: 2585945.9940; train_gene_expr_recon_loss: 1230902.0177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3832564.2300; train_optim_loss: 3832564.2300; val_kl_reg_loss: 15065.7404; val_edge_recon_loss: 2607072.0833; val_gene_expr_recon_loss: 1237731.9601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3859869.7840; val_optim_loss: 3859869.7840
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9954; val_auprc_score: 0.9949; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 15638.0332; train_edge_recon_loss: 2585631.7149; train_gene_expr_recon_loss: 1229834.4021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3831104.1470; train_optim_loss: 3831104.1470; val_kl_reg_loss: 15411.2670; val_edge_recon_loss: 2606644.4660; val_gene_expr_recon_loss: 1237846.9272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3859902.6596; val_optim_loss: 3859902.6596
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9954; val_auprc_score: 0.9949; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 15608.0152; train_edge_recon_loss: 2584852.7134; train_gene_expr_recon_loss: 1229329.7737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3829790.5052; train_optim_loss: 3829790.5052; val_kl_reg_loss: 15505.2209; val_edge_recon_loss: 2606224.5927; val_gene_expr_recon_loss: 1235491.6444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3857221.4531; val_optim_loss: 3857221.4531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9708; val_best_f1_score: 0.9710; train_kl_reg_loss: 15484.1477; train_edge_recon_loss: 2584161.8203; train_gene_expr_recon_loss: 1229219.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3828865.4008; train_optim_loss: 3828865.4008; val_kl_reg_loss: 15365.0180; val_edge_recon_loss: 2602791.4577; val_gene_expr_recon_loss: 1236783.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3854940.0669; val_optim_loss: 3854940.0669
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9954; val_auprc_score: 0.9949; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 15473.9170; train_edge_recon_loss: 2583978.2364; train_gene_expr_recon_loss: 1228538.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3827990.6201; train_optim_loss: 3827990.6201; val_kl_reg_loss: 15149.7860; val_edge_recon_loss: 2603682.2347; val_gene_expr_recon_loss: 1236419.1866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3855251.2007; val_optim_loss: 3855251.2007
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9950; val_best_acc_score: 0.9707; val_best_f1_score: 0.9708; train_kl_reg_loss: 15439.6302; train_edge_recon_loss: 2583722.1136; train_gene_expr_recon_loss: 1227728.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3826890.6412; train_optim_loss: 3826890.6412; val_kl_reg_loss: 15197.0076; val_edge_recon_loss: 2601709.9272; val_gene_expr_recon_loss: 1234675.4730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3851582.4085; val_optim_loss: 3851582.4085
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9956; val_auprc_score: 0.9951; val_best_acc_score: 0.9710; val_best_f1_score: 0.9711; train_kl_reg_loss: 15383.9812; train_edge_recon_loss: 2582586.8939; train_gene_expr_recon_loss: 1226977.4353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3824948.3120; train_optim_loss: 3824948.3120; val_kl_reg_loss: 14871.0016; val_edge_recon_loss: 2601967.1901; val_gene_expr_recon_loss: 1235777.4114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3852615.6115; val_optim_loss: 3852615.6115
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9956; val_auprc_score: 0.9952; val_best_acc_score: 0.9710; val_best_f1_score: 0.9711; train_kl_reg_loss: 15301.0441; train_edge_recon_loss: 2583253.0996; train_gene_expr_recon_loss: 1227157.1688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3825711.3095; train_optim_loss: 3825711.3095; val_kl_reg_loss: 15069.3613; val_edge_recon_loss: 2603827.9120; val_gene_expr_recon_loss: 1235540.8192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3854438.0857; val_optim_loss: 3854438.0857
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 15301.0036; train_edge_recon_loss: 2581960.9566; train_gene_expr_recon_loss: 1226462.7488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3823724.7108; train_optim_loss: 3823724.7108; val_kl_reg_loss: 15080.4321; val_edge_recon_loss: 2601832.3932; val_gene_expr_recon_loss: 1236301.1285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3853213.9484; val_optim_loss: 3853213.9484
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 15253.3707; train_edge_recon_loss: 2582509.4714; train_gene_expr_recon_loss: 1226504.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3824267.2530; train_optim_loss: 3824267.2530; val_kl_reg_loss: 15159.3338; val_edge_recon_loss: 2601549.1526; val_gene_expr_recon_loss: 1236406.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3853115.4061; val_optim_loss: 3853115.4061

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 15784.8849; train_edge_recon_loss: 2578593.2762; train_gene_expr_recon_loss: 1216098.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3810477.0952; train_optim_loss: 3810477.0952; val_kl_reg_loss: 15588.9456; val_edge_recon_loss: 2595684.2488; val_gene_expr_recon_loss: 1226581.6397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3837854.8239; val_optim_loss: 3837854.8239
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 15850.3601; train_edge_recon_loss: 2578666.9044; train_gene_expr_recon_loss: 1214559.0490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3809076.3149; train_optim_loss: 3809076.3149; val_kl_reg_loss: 15603.4772; val_edge_recon_loss: 2599000.4014; val_gene_expr_recon_loss: 1225491.2142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3840095.0845; val_optim_loss: 3840095.0845
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 15782.8163; train_edge_recon_loss: 2578575.6722; train_gene_expr_recon_loss: 1214529.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3808887.7518; train_optim_loss: 3808887.7518; val_kl_reg_loss: 15564.1609; val_edge_recon_loss: 2597079.4378; val_gene_expr_recon_loss: 1225106.6960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3837750.2829; val_optim_loss: 3837750.2829
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 15777.7272; train_edge_recon_loss: 2578064.1041; train_gene_expr_recon_loss: 1213690.8657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3807532.6953; train_optim_loss: 3807532.6953; val_kl_reg_loss: 15543.1644; val_edge_recon_loss: 2595823.7700; val_gene_expr_recon_loss: 1223571.4407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834938.3768; val_optim_loss: 3834938.3768
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 15744.4356; train_edge_recon_loss: 2578866.2422; train_gene_expr_recon_loss: 1213611.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3808222.0292; train_optim_loss: 3808222.0292; val_kl_reg_loss: 15520.5240; val_edge_recon_loss: 2597166.7523; val_gene_expr_recon_loss: 1224724.4454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3837411.7265; val_optim_loss: 3837411.7265
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 15719.6166; train_edge_recon_loss: 2578301.8995; train_gene_expr_recon_loss: 1213479.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3807501.2046; train_optim_loss: 3807501.2046; val_kl_reg_loss: 15420.0528; val_edge_recon_loss: 2597286.1890; val_gene_expr_recon_loss: 1223551.5511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3836257.8099; val_optim_loss: 3836257.8099
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 15677.3219; train_edge_recon_loss: 2577904.7200; train_gene_expr_recon_loss: 1212901.0951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3806483.1337; train_optim_loss: 3806483.1337; val_kl_reg_loss: 15468.4750; val_edge_recon_loss: 2597103.3087; val_gene_expr_recon_loss: 1224255.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3836827.6608; val_optim_loss: 3836827.6608
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 15654.4726; train_edge_recon_loss: 2578471.3692; train_gene_expr_recon_loss: 1212771.3126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3806897.1506; train_optim_loss: 3806897.1506; val_kl_reg_loss: 15420.9377; val_edge_recon_loss: 2596476.3592; val_gene_expr_recon_loss: 1223434.8116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3835332.1056; val_optim_loss: 3835332.1056

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9746; val_best_f1_score: 0.9748; train_kl_reg_loss: 15660.4950; train_edge_recon_loss: 2578096.3260; train_gene_expr_recon_loss: 1211064.8411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804821.6609; train_optim_loss: 3804821.6609; val_kl_reg_loss: 15439.2259; val_edge_recon_loss: 2596532.9460; val_gene_expr_recon_loss: 1222137.4143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834109.5786; val_optim_loss: 3834109.5786
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 15678.4265; train_edge_recon_loss: 2577341.3528; train_gene_expr_recon_loss: 1211442.8353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804462.6142; train_optim_loss: 3804462.6142; val_kl_reg_loss: 15423.1574; val_edge_recon_loss: 2596980.4566; val_gene_expr_recon_loss: 1222090.1268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834493.7300; val_optim_loss: 3834493.7300
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 15671.1970; train_edge_recon_loss: 2578062.8740; train_gene_expr_recon_loss: 1210995.5058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804729.5772; train_optim_loss: 3804729.5772; val_kl_reg_loss: 15414.6153; val_edge_recon_loss: 2596752.0164; val_gene_expr_recon_loss: 1221269.3451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3833435.9695; val_optim_loss: 3833435.9695
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 15680.3835; train_edge_recon_loss: 2577831.9277; train_gene_expr_recon_loss: 1210816.9813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804329.2891; train_optim_loss: 3804329.2891; val_kl_reg_loss: 15460.2788; val_edge_recon_loss: 2596278.0587; val_gene_expr_recon_loss: 1222020.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3833759.2160; val_optim_loss: 3833759.2160
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 15683.1002; train_edge_recon_loss: 2577556.3392; train_gene_expr_recon_loss: 1211121.1325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804360.5763; train_optim_loss: 3804360.5763; val_kl_reg_loss: 15452.4792; val_edge_recon_loss: 2597187.7230; val_gene_expr_recon_loss: 1221610.9360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834251.1514; val_optim_loss: 3834251.1514
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 15665.5306; train_edge_recon_loss: 2578142.6707; train_gene_expr_recon_loss: 1211205.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3805014.1583; train_optim_loss: 3805014.1583; val_kl_reg_loss: 15405.0146; val_edge_recon_loss: 2597612.0833; val_gene_expr_recon_loss: 1221387.9859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834405.0775; val_optim_loss: 3834405.0775
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 15642.1970; train_edge_recon_loss: 2578417.7805; train_gene_expr_recon_loss: 1210717.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804777.6329; train_optim_loss: 3804777.6329; val_kl_reg_loss: 15394.8170; val_edge_recon_loss: 2595406.1608; val_gene_expr_recon_loss: 1221651.7635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3832452.7441; val_optim_loss: 3832452.7441
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9743; val_best_f1_score: 0.9745; train_kl_reg_loss: 15638.4379; train_edge_recon_loss: 2578517.4651; train_gene_expr_recon_loss: 1210827.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804983.1134; train_optim_loss: 3804983.1134; val_kl_reg_loss: 15387.9624; val_edge_recon_loss: 2596618.7007; val_gene_expr_recon_loss: 1222905.1279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834911.7946; val_optim_loss: 3834911.7946
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 15647.3357; train_edge_recon_loss: 2577176.1241; train_gene_expr_recon_loss: 1210853.8515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3803677.3145; train_optim_loss: 3803677.3145; val_kl_reg_loss: 15442.2329; val_edge_recon_loss: 2596157.8592; val_gene_expr_recon_loss: 1222569.5194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834169.6115; val_optim_loss: 3834169.6115
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 15667.3461; train_edge_recon_loss: 2578444.0348; train_gene_expr_recon_loss: 1210759.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804870.5119; train_optim_loss: 3804870.5119; val_kl_reg_loss: 15405.0620; val_edge_recon_loss: 2597734.4941; val_gene_expr_recon_loss: 1221679.0381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834818.5833; val_optim_loss: 3834818.5833
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 15654.2830; train_edge_recon_loss: 2577820.4066; train_gene_expr_recon_loss: 1211392.3692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804867.0582; train_optim_loss: 3804867.0582; val_kl_reg_loss: 15406.3071; val_edge_recon_loss: 2595328.6350; val_gene_expr_recon_loss: 1222709.5147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3833444.4531; val_optim_loss: 3833444.4531

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 15644.8641; train_edge_recon_loss: 2578526.8799; train_gene_expr_recon_loss: 1210690.7718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804862.5161; train_optim_loss: 3804862.5161; val_kl_reg_loss: 15408.3268; val_edge_recon_loss: 2597536.8638; val_gene_expr_recon_loss: 1222053.3973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834998.5869; val_optim_loss: 3834998.5869
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 15647.3794; train_edge_recon_loss: 2577355.6784; train_gene_expr_recon_loss: 1210859.3055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3803862.3643; train_optim_loss: 3803862.3643; val_kl_reg_loss: 15408.2954; val_edge_recon_loss: 2597770.4883; val_gene_expr_recon_loss: 1222066.7336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3835245.5117; val_optim_loss: 3835245.5117
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 15650.0923; train_edge_recon_loss: 2577848.1894; train_gene_expr_recon_loss: 1210615.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804113.5748; train_optim_loss: 3804113.5748; val_kl_reg_loss: 15409.2196; val_edge_recon_loss: 2598915.0270; val_gene_expr_recon_loss: 1222498.3592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3836822.6045; val_optim_loss: 3836822.6045
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9963; val_auprc_score: 0.9958; val_best_acc_score: 0.9743; val_best_f1_score: 0.9744; train_kl_reg_loss: 15655.0480; train_edge_recon_loss: 2578404.7873; train_gene_expr_recon_loss: 1210379.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3804438.8987; train_optim_loss: 3804438.8987; val_kl_reg_loss: 15405.4869; val_edge_recon_loss: 2597890.0798; val_gene_expr_recon_loss: 1221679.2934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3834974.8545; val_optim_loss: 3834974.8545

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 394 min 43 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9964
Val AUPRC score: 0.9960
Val best accuracy score: 0.9744
Val best F1 score: 0.9744
Val gene expr MSE score: 8.3311

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
