None
Run timestamp: 28072023_122851_82.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_82']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9808; val_auprc_score: 0.9704; val_best_acc_score: 0.9511; val_best_f1_score: 0.9524; train_kl_reg_loss: 5937.3720; train_edge_recon_loss: 267582.0907; train_gene_expr_recon_loss: 23695.5373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 297214.9986; train_optim_loss: 297214.9986; val_kl_reg_loss: 5862.8607; val_edge_recon_loss: 259498.4432; val_gene_expr_recon_loss: 21656.0782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 287017.3849; val_optim_loss: 287017.3849
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9840; val_auprc_score: 0.9756; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 5820.1018; train_edge_recon_loss: 259010.8613; train_gene_expr_recon_loss: 20901.7380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 285732.7014; train_optim_loss: 285732.7014; val_kl_reg_loss: 5702.1187; val_edge_recon_loss: 258250.1593; val_gene_expr_recon_loss: 20378.5083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 284330.7828; val_optim_loss: 284330.7828
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9858; val_auprc_score: 0.9788; val_best_acc_score: 0.9605; val_best_f1_score: 0.9615; train_kl_reg_loss: 5781.1421; train_edge_recon_loss: 258040.3228; train_gene_expr_recon_loss: 19996.4027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 283817.8674; train_optim_loss: 283817.8674; val_kl_reg_loss: 5661.8952; val_edge_recon_loss: 257631.3830; val_gene_expr_recon_loss: 19615.4403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 282908.7149; val_optim_loss: 282908.7149
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9816; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 5762.6504; train_edge_recon_loss: 257838.3119; train_gene_expr_recon_loss: 19430.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 283031.5853; train_optim_loss: 283031.5853; val_kl_reg_loss: 5693.0472; val_edge_recon_loss: 256918.5972; val_gene_expr_recon_loss: 19220.0783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 281831.7210; val_optim_loss: 281831.7210
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9881; val_auprc_score: 0.9822; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 5767.2752; train_edge_recon_loss: 257376.3105; train_gene_expr_recon_loss: 19059.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 282202.5987; train_optim_loss: 282202.5987; val_kl_reg_loss: 5707.4214; val_edge_recon_loss: 256895.0229; val_gene_expr_recon_loss: 18852.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 281454.9581; val_optim_loss: 281454.9581
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9891; val_auprc_score: 0.9841; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 5767.4102; train_edge_recon_loss: 257103.1353; train_gene_expr_recon_loss: 18773.4089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 281643.9543; train_optim_loss: 281643.9543; val_kl_reg_loss: 5735.5709; val_edge_recon_loss: 256616.8921; val_gene_expr_recon_loss: 18646.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280999.3415; val_optim_loss: 280999.3415
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9861; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 5760.3602; train_edge_recon_loss: 256842.7776; train_gene_expr_recon_loss: 18547.3615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 281150.4994; train_optim_loss: 281150.4994; val_kl_reg_loss: 5610.1153; val_edge_recon_loss: 256297.7889; val_gene_expr_recon_loss: 18440.7896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280348.6951; val_optim_loss: 280348.6951
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9899; val_auprc_score: 0.9848; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 5754.6804; train_edge_recon_loss: 256864.3792; train_gene_expr_recon_loss: 18379.0413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280998.1015; train_optim_loss: 280998.1015; val_kl_reg_loss: 5673.4092; val_edge_recon_loss: 256185.5145; val_gene_expr_recon_loss: 18232.9937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280091.9184; val_optim_loss: 280091.9184
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9914; val_auprc_score: 0.9870; val_best_acc_score: 0.9735; val_best_f1_score: 0.9740; train_kl_reg_loss: 5753.1141; train_edge_recon_loss: 256718.8012; train_gene_expr_recon_loss: 18234.8240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280706.7382; train_optim_loss: 280706.7382; val_kl_reg_loss: 5812.6957; val_edge_recon_loss: 255782.7851; val_gene_expr_recon_loss: 18134.1338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279729.6143; val_optim_loss: 279729.6143
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9913; val_auprc_score: 0.9873; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 5757.5780; train_edge_recon_loss: 256590.4630; train_gene_expr_recon_loss: 18106.6957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280454.7369; train_optim_loss: 280454.7369; val_kl_reg_loss: 5683.8024; val_edge_recon_loss: 256019.4508; val_gene_expr_recon_loss: 18053.0608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279756.3148; val_optim_loss: 279756.3148
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9925; val_auprc_score: 0.9891; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 5755.9135; train_edge_recon_loss: 256404.5603; train_gene_expr_recon_loss: 18013.7838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280174.2578; train_optim_loss: 280174.2578; val_kl_reg_loss: 5690.9762; val_edge_recon_loss: 255498.3110; val_gene_expr_recon_loss: 17931.0133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279120.2995; val_optim_loss: 279120.2995
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9926; val_auprc_score: 0.9894; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 5754.3740; train_edge_recon_loss: 256380.6625; train_gene_expr_recon_loss: 17934.0159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280069.0521; train_optim_loss: 280069.0521; val_kl_reg_loss: 5624.6849; val_edge_recon_loss: 255736.4238; val_gene_expr_recon_loss: 17824.5951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279185.7035; val_optim_loss: 279185.7035
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9935; val_auprc_score: 0.9902; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 5760.2678; train_edge_recon_loss: 256268.3179; train_gene_expr_recon_loss: 17859.9723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279888.5581; train_optim_loss: 279888.5581; val_kl_reg_loss: 5638.3301; val_edge_recon_loss: 255082.8777; val_gene_expr_recon_loss: 17828.5371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278549.7454; val_optim_loss: 278549.7454
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 5761.8270; train_edge_recon_loss: 256180.4213; train_gene_expr_recon_loss: 17798.1368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279740.3858; train_optim_loss: 279740.3858; val_kl_reg_loss: 5664.1611; val_edge_recon_loss: 255375.5514; val_gene_expr_recon_loss: 17706.2762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278745.9893; val_optim_loss: 278745.9893
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9937; val_auprc_score: 0.9910; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 5754.4482; train_edge_recon_loss: 256213.0165; train_gene_expr_recon_loss: 17734.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279702.1345; train_optim_loss: 279702.1345; val_kl_reg_loss: 5687.7394; val_edge_recon_loss: 255561.4863; val_gene_expr_recon_loss: 17668.3430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278917.5678; val_optim_loss: 278917.5678
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9943; val_auprc_score: 0.9916; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 5754.6956; train_edge_recon_loss: 256150.4157; train_gene_expr_recon_loss: 17682.6213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279587.7328; train_optim_loss: 279587.7328; val_kl_reg_loss: 5753.1454; val_edge_recon_loss: 255572.0610; val_gene_expr_recon_loss: 17641.2748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278966.4809; val_optim_loss: 278966.4809
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9922; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 5758.1031; train_edge_recon_loss: 256082.1748; train_gene_expr_recon_loss: 17638.1067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279478.3849; train_optim_loss: 279478.3849; val_kl_reg_loss: 5654.1271; val_edge_recon_loss: 255308.0804; val_gene_expr_recon_loss: 17609.0897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278571.2980; val_optim_loss: 278571.2980

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9948; val_auprc_score: 0.9926; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 5748.8039; train_edge_recon_loss: 255817.8803; train_gene_expr_recon_loss: 17589.6329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279156.3175; train_optim_loss: 279156.3175; val_kl_reg_loss: 5684.9835; val_edge_recon_loss: 255285.1562; val_gene_expr_recon_loss: 17608.3827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278578.5191; val_optim_loss: 278578.5191
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9921; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5736.7742; train_edge_recon_loss: 255930.7250; train_gene_expr_recon_loss: 17579.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279247.1985; train_optim_loss: 279247.1985; val_kl_reg_loss: 5683.5554; val_edge_recon_loss: 255318.7073; val_gene_expr_recon_loss: 17539.1091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278541.3727; val_optim_loss: 278541.3727
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9923; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 5733.4859; train_edge_recon_loss: 255925.1315; train_gene_expr_recon_loss: 17566.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279225.0018; train_optim_loss: 279225.0018; val_kl_reg_loss: 5686.7203; val_edge_recon_loss: 255133.1589; val_gene_expr_recon_loss: 17514.9588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278334.8377; val_optim_loss: 278334.8377
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9922; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 5735.5344; train_edge_recon_loss: 255811.9572; train_gene_expr_recon_loss: 17573.2959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279120.7875; train_optim_loss: 279120.7875; val_kl_reg_loss: 5663.3346; val_edge_recon_loss: 255295.1231; val_gene_expr_recon_loss: 17533.9673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278492.4238; val_optim_loss: 278492.4238
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9952; val_auprc_score: 0.9931; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 5730.8595; train_edge_recon_loss: 255893.7064; train_gene_expr_recon_loss: 17553.2833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279177.8492; train_optim_loss: 279177.8492; val_kl_reg_loss: 5653.9294; val_edge_recon_loss: 254971.3338; val_gene_expr_recon_loss: 17542.6787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278167.9428; val_optim_loss: 278167.9428
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9950; val_auprc_score: 0.9927; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5730.5997; train_edge_recon_loss: 255833.2914; train_gene_expr_recon_loss: 17561.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279125.6388; train_optim_loss: 279125.6388; val_kl_reg_loss: 5671.8610; val_edge_recon_loss: 255082.4127; val_gene_expr_recon_loss: 17507.5218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278261.7934; val_optim_loss: 278261.7934
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9922; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5731.9377; train_edge_recon_loss: 255862.4472; train_gene_expr_recon_loss: 17539.3527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279133.7383; train_optim_loss: 279133.7383; val_kl_reg_loss: 5663.4623; val_edge_recon_loss: 254925.1258; val_gene_expr_recon_loss: 17508.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278097.1410; val_optim_loss: 278097.1410
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9948; val_auprc_score: 0.9921; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 5731.8988; train_edge_recon_loss: 255894.3852; train_gene_expr_recon_loss: 17542.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279168.3980; train_optim_loss: 279168.3980; val_kl_reg_loss: 5671.3850; val_edge_recon_loss: 255028.9665; val_gene_expr_recon_loss: 17517.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278218.3140; val_optim_loss: 278218.3140
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9950; val_auprc_score: 0.9928; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5729.9828; train_edge_recon_loss: 255787.6911; train_gene_expr_recon_loss: 17533.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279050.9374; train_optim_loss: 279050.9374; val_kl_reg_loss: 5664.3433; val_edge_recon_loss: 255065.6082; val_gene_expr_recon_loss: 17493.9294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278223.8811; val_optim_loss: 278223.8811
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9947; val_auprc_score: 0.9922; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 5726.6994; train_edge_recon_loss: 255864.3706; train_gene_expr_recon_loss: 17510.5238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279101.5938; train_optim_loss: 279101.5938; val_kl_reg_loss: 5659.4801; val_edge_recon_loss: 255211.3476; val_gene_expr_recon_loss: 17526.1911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278397.0198; val_optim_loss: 278397.0198
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9947; val_auprc_score: 0.9920; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5733.8283; train_edge_recon_loss: 255655.5539; train_gene_expr_recon_loss: 17524.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278914.0251; train_optim_loss: 278914.0251; val_kl_reg_loss: 5675.8136; val_edge_recon_loss: 255073.6818; val_gene_expr_recon_loss: 17457.1832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278206.6784; val_optim_loss: 278206.6784

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9954; val_auprc_score: 0.9934; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 5727.2786; train_edge_recon_loss: 255803.0349; train_gene_expr_recon_loss: 17507.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279037.8201; train_optim_loss: 279037.8201; val_kl_reg_loss: 5674.8199; val_edge_recon_loss: 255107.7637; val_gene_expr_recon_loss: 17489.3324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278271.9177; val_optim_loss: 278271.9177
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9934; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 5727.1953; train_edge_recon_loss: 255734.4670; train_gene_expr_recon_loss: 17516.2751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278977.9378; train_optim_loss: 278977.9378; val_kl_reg_loss: 5672.6856; val_edge_recon_loss: 254929.0747; val_gene_expr_recon_loss: 17489.5913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278091.3506; val_optim_loss: 278091.3506
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9946; val_auprc_score: 0.9920; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 5726.4768; train_edge_recon_loss: 255715.7592; train_gene_expr_recon_loss: 17513.2177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278955.4547; train_optim_loss: 278955.4547; val_kl_reg_loss: 5681.8617; val_edge_recon_loss: 255214.9432; val_gene_expr_recon_loss: 17484.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278380.8704; val_optim_loss: 278380.8704
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9950; val_auprc_score: 0.9928; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 5726.1807; train_edge_recon_loss: 255797.8803; train_gene_expr_recon_loss: 17505.7069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279029.7677; train_optim_loss: 279029.7677; val_kl_reg_loss: 5677.7708; val_edge_recon_loss: 254986.7069; val_gene_expr_recon_loss: 17477.8473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278142.3255; val_optim_loss: 278142.3255
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9946; val_auprc_score: 0.9919; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 5722.6889; train_edge_recon_loss: 255909.7763; train_gene_expr_recon_loss: 17512.5289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279144.9933; train_optim_loss: 279144.9933; val_kl_reg_loss: 5668.2205; val_edge_recon_loss: 255452.4874; val_gene_expr_recon_loss: 17471.4114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278592.1181; val_optim_loss: 278592.1181
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9951; val_auprc_score: 0.9928; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 5724.6574; train_edge_recon_loss: 255795.8910; train_gene_expr_recon_loss: 17517.0810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279037.6297; train_optim_loss: 279037.6297; val_kl_reg_loss: 5673.4914; val_edge_recon_loss: 254860.2793; val_gene_expr_recon_loss: 17518.2452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278052.0160; val_optim_loss: 278052.0160
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9922; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 5721.2010; train_edge_recon_loss: 255856.3964; train_gene_expr_recon_loss: 17496.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279074.2187; train_optim_loss: 279074.2187; val_kl_reg_loss: 5679.6328; val_edge_recon_loss: 255162.1231; val_gene_expr_recon_loss: 17451.4352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278293.1921; val_optim_loss: 278293.1921
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9951; val_auprc_score: 0.9922; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 5725.1711; train_edge_recon_loss: 255760.3794; train_gene_expr_recon_loss: 17501.8653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278987.4152; train_optim_loss: 278987.4152; val_kl_reg_loss: 5670.8393; val_edge_recon_loss: 254783.9428; val_gene_expr_recon_loss: 17505.9923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277960.7744; val_optim_loss: 277960.7744
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9946; val_auprc_score: 0.9919; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5724.7865; train_edge_recon_loss: 255785.6050; train_gene_expr_recon_loss: 17514.1784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279024.5695; train_optim_loss: 279024.5695; val_kl_reg_loss: 5670.6290; val_edge_recon_loss: 255179.5297; val_gene_expr_recon_loss: 17474.9169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278325.0716; val_optim_loss: 278325.0716
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9952; val_auprc_score: 0.9931; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 5722.9719; train_edge_recon_loss: 255785.1343; train_gene_expr_recon_loss: 17500.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279008.9390; train_optim_loss: 279008.9390; val_kl_reg_loss: 5676.5161; val_edge_recon_loss: 255051.3056; val_gene_expr_recon_loss: 17489.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278217.6258; val_optim_loss: 278217.6258
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9948; val_auprc_score: 0.9923; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 5725.3096; train_edge_recon_loss: 255753.5194; train_gene_expr_recon_loss: 17511.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278989.8404; train_optim_loss: 278989.8404; val_kl_reg_loss: 5676.0310; val_edge_recon_loss: 255293.6376; val_gene_expr_recon_loss: 17458.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278428.0427; val_optim_loss: 278428.0427
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9795; val_best_f1_score: 0.9798; train_kl_reg_loss: 5726.2960; train_edge_recon_loss: 255754.2342; train_gene_expr_recon_loss: 17499.1817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278979.7117; train_optim_loss: 278979.7117; val_kl_reg_loss: 5669.0714; val_edge_recon_loss: 255228.8479; val_gene_expr_recon_loss: 17498.0344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278395.9543; val_optim_loss: 278395.9543

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9951; val_auprc_score: 0.9929; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 5723.4108; train_edge_recon_loss: 255725.1589; train_gene_expr_recon_loss: 17510.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278958.7015; train_optim_loss: 278958.7015; val_kl_reg_loss: 5670.6220; val_edge_recon_loss: 254955.4970; val_gene_expr_recon_loss: 17513.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278140.0282; val_optim_loss: 278140.0282
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9948; val_auprc_score: 0.9925; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 5723.1189; train_edge_recon_loss: 255742.7342; train_gene_expr_recon_loss: 17505.8470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278971.7005; train_optim_loss: 278971.7005; val_kl_reg_loss: 5670.4703; val_edge_recon_loss: 255107.9276; val_gene_expr_recon_loss: 17498.0598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278276.4588; val_optim_loss: 278276.4588
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9953; val_auprc_score: 0.9930; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 5723.5702; train_edge_recon_loss: 255710.8405; train_gene_expr_recon_loss: 17510.4907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278944.9010; train_optim_loss: 278944.9010; val_kl_reg_loss: 5673.9606; val_edge_recon_loss: 254838.7317; val_gene_expr_recon_loss: 17464.8915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277977.5823; val_optim_loss: 277977.5823
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9947; val_auprc_score: 0.9923; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5725.3331; train_edge_recon_loss: 255708.3739; train_gene_expr_recon_loss: 17500.2492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278933.9564; train_optim_loss: 278933.9564; val_kl_reg_loss: 5673.4237; val_edge_recon_loss: 255391.2035; val_gene_expr_recon_loss: 17527.2319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278591.8598; val_optim_loss: 278591.8598

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 101 min 5 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9948
Val AUPRC score: 0.9925
Val best accuracy score: 0.9795
Val best F1 score: 0.9798
Val target rna MSE score: 0.6177
Val source rna MSE score: 0.0729

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
