None
Run timestamp: 15072023_010335_151.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_151']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9479; val_auprc_score: 0.9375; val_best_acc_score: 0.8799; val_best_f1_score: 0.8868; train_kl_reg_loss: 44574.9031; train_edge_recon_loss: 2817000.1368; train_gene_expr_recon_loss: 7202193.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10063768.6379; train_optim_loss: 10063768.6379; val_kl_reg_loss: 39177.5338; val_edge_recon_loss: 2714195.9259; val_gene_expr_recon_loss: 6773206.2199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9526579.6806; val_optim_loss: 9526579.6806
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9626; val_auprc_score: 0.9554; val_best_acc_score: 0.9019; val_best_f1_score: 0.9069; train_kl_reg_loss: 35828.3740; train_edge_recon_loss: 2685039.9735; train_gene_expr_recon_loss: 6651846.5985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9372714.9372; train_optim_loss: 9372714.9372; val_kl_reg_loss: 32572.4121; val_edge_recon_loss: 2687005.9861; val_gene_expr_recon_loss: 6579455.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9299033.9213; val_optim_loss: 9299033.9213
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9687; val_auprc_score: 0.9630; val_best_acc_score: 0.9114; val_best_f1_score: 0.9150; train_kl_reg_loss: 32083.9145; train_edge_recon_loss: 2665408.8421; train_gene_expr_recon_loss: 6529690.7124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9227183.4630; train_optim_loss: 9227183.4630; val_kl_reg_loss: 31059.1857; val_edge_recon_loss: 2673533.9873; val_gene_expr_recon_loss: 6494061.9977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9198655.1528; val_optim_loss: 9198655.1528
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9740; val_auprc_score: 0.9698; val_best_acc_score: 0.9199; val_best_f1_score: 0.9227; train_kl_reg_loss: 29892.0023; train_edge_recon_loss: 2657058.1269; train_gene_expr_recon_loss: 6472635.8765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9159586.0000; train_optim_loss: 9159586.0000; val_kl_reg_loss: 28029.2269; val_edge_recon_loss: 2667754.8866; val_gene_expr_recon_loss: 6465320.7245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9161104.8657; val_optim_loss: 9161104.8657
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9768; val_auprc_score: 0.9733; val_best_acc_score: 0.9244; val_best_f1_score: 0.9265; train_kl_reg_loss: 28293.2587; train_edge_recon_loss: 2650315.8419; train_gene_expr_recon_loss: 6445801.8927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9124410.9985; train_optim_loss: 9124410.9985; val_kl_reg_loss: 27169.8889; val_edge_recon_loss: 2664647.9525; val_gene_expr_recon_loss: 6444584.9606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9136402.7963; val_optim_loss: 9136402.7963
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9793; val_auprc_score: 0.9761; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 27293.0647; train_edge_recon_loss: 2644555.5781; train_gene_expr_recon_loss: 6423144.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9094992.7160; train_optim_loss: 9094992.7160; val_kl_reg_loss: 26379.7316; val_edge_recon_loss: 2657209.4606; val_gene_expr_recon_loss: 6442380.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9125969.5185; val_optim_loss: 9125969.5185
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9812; val_auprc_score: 0.9782; val_best_acc_score: 0.9326; val_best_f1_score: 0.9344; train_kl_reg_loss: 26541.6151; train_edge_recon_loss: 2640282.2046; train_gene_expr_recon_loss: 6406593.8825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9073417.6991; train_optim_loss: 9073417.6991; val_kl_reg_loss: 25578.5209; val_edge_recon_loss: 2650635.9861; val_gene_expr_recon_loss: 6427145.7361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9103360.2685; val_optim_loss: 9103360.2685
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9820; val_auprc_score: 0.9794; val_best_acc_score: 0.9345; val_best_f1_score: 0.9361; train_kl_reg_loss: 25908.7649; train_edge_recon_loss: 2636801.9550; train_gene_expr_recon_loss: 6400152.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9062863.0926; train_optim_loss: 9062863.0926; val_kl_reg_loss: 25390.5553; val_edge_recon_loss: 2652648.4433; val_gene_expr_recon_loss: 6414641.3426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9092680.3472; val_optim_loss: 9092680.3472
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9835; val_auprc_score: 0.9807; val_best_acc_score: 0.9388; val_best_f1_score: 0.9405; train_kl_reg_loss: 25543.2548; train_edge_recon_loss: 2633040.8449; train_gene_expr_recon_loss: 6392624.2611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9051208.3560; train_optim_loss: 9051208.3560; val_kl_reg_loss: 25419.4891; val_edge_recon_loss: 2641464.3194; val_gene_expr_recon_loss: 6405694.1505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9072577.9352; val_optim_loss: 9072577.9352
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9843; val_auprc_score: 0.9818; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 25194.0943; train_edge_recon_loss: 2630178.1202; train_gene_expr_recon_loss: 6384746.0149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9040118.2276; train_optim_loss: 9040118.2276; val_kl_reg_loss: 25131.2669; val_edge_recon_loss: 2644206.1192; val_gene_expr_recon_loss: 6404520.5046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9073857.8657; val_optim_loss: 9073857.8657
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9854; val_auprc_score: 0.9832; val_best_acc_score: 0.9429; val_best_f1_score: 0.9441; train_kl_reg_loss: 24911.1125; train_edge_recon_loss: 2628465.1442; train_gene_expr_recon_loss: 6381361.9177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9034738.1610; train_optim_loss: 9034738.1610; val_kl_reg_loss: 24768.6644; val_edge_recon_loss: 2640715.5544; val_gene_expr_recon_loss: 6406946.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9072430.8565; val_optim_loss: 9072430.8565
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9860; val_auprc_score: 0.9838; val_best_acc_score: 0.9443; val_best_f1_score: 0.9455; train_kl_reg_loss: 24586.8135; train_edge_recon_loss: 2626061.9456; train_gene_expr_recon_loss: 6374838.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9025487.3084; train_optim_loss: 9025487.3084; val_kl_reg_loss: 24320.0489; val_edge_recon_loss: 2638664.0012; val_gene_expr_recon_loss: 6409239.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9072223.0787; val_optim_loss: 9072223.0787
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9873; val_auprc_score: 0.9855; val_best_acc_score: 0.9471; val_best_f1_score: 0.9482; train_kl_reg_loss: 24358.6932; train_edge_recon_loss: 2624943.1067; train_gene_expr_recon_loss: 6370849.1415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9020150.9290; train_optim_loss: 9020150.9290; val_kl_reg_loss: 23851.5342; val_edge_recon_loss: 2636806.5139; val_gene_expr_recon_loss: 6408770.8079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9069428.8750; val_optim_loss: 9069428.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9873; val_auprc_score: 0.9854; val_best_acc_score: 0.9470; val_best_f1_score: 0.9480; train_kl_reg_loss: 24235.7094; train_edge_recon_loss: 2622181.8387; train_gene_expr_recon_loss: 6366453.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9012871.3534; train_optim_loss: 9012871.3534; val_kl_reg_loss: 23639.7571; val_edge_recon_loss: 2635432.3056; val_gene_expr_recon_loss: 6420280.1806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9079352.2361; val_optim_loss: 9079352.2361
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9877; val_auprc_score: 0.9856; val_best_acc_score: 0.9484; val_best_f1_score: 0.9494; train_kl_reg_loss: 24102.9048; train_edge_recon_loss: 2621947.1357; train_gene_expr_recon_loss: 6365457.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9011507.3951; train_optim_loss: 9011507.3951; val_kl_reg_loss: 23318.4403; val_edge_recon_loss: 2635140.5324; val_gene_expr_recon_loss: 6400154.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9058613.4491; val_optim_loss: 9058613.4491
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9880; val_auprc_score: 0.9862; val_best_acc_score: 0.9489; val_best_f1_score: 0.9500; train_kl_reg_loss: 23964.0620; train_edge_recon_loss: 2620528.7243; train_gene_expr_recon_loss: 6359042.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9003535.3310; train_optim_loss: 9003535.3310; val_kl_reg_loss: 23299.9714; val_edge_recon_loss: 2632573.2350; val_gene_expr_recon_loss: 6399888.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9055761.5787; val_optim_loss: 9055761.5787
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9880; val_auprc_score: 0.9860; val_best_acc_score: 0.9499; val_best_f1_score: 0.9509; train_kl_reg_loss: 23876.7667; train_edge_recon_loss: 2619767.1208; train_gene_expr_recon_loss: 6357781.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9001425.3189; train_optim_loss: 9001425.3189; val_kl_reg_loss: 23274.1850; val_edge_recon_loss: 2630115.4595; val_gene_expr_recon_loss: 6409590.9838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9062980.5926; val_optim_loss: 9062980.5926
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9887; val_auprc_score: 0.9870; val_best_acc_score: 0.9504; val_best_f1_score: 0.9512; train_kl_reg_loss: 23674.6858; train_edge_recon_loss: 2619169.1960; train_gene_expr_recon_loss: 6353243.9830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8996087.8614; train_optim_loss: 8996087.8614; val_kl_reg_loss: 23167.1505; val_edge_recon_loss: 2631653.8090; val_gene_expr_recon_loss: 6405804.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9060625.3009; val_optim_loss: 9060625.3009
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9510; val_best_f1_score: 0.9518; train_kl_reg_loss: 23595.0146; train_edge_recon_loss: 2618068.0390; train_gene_expr_recon_loss: 6354768.0057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8996431.0540; train_optim_loss: 8996431.0540; val_kl_reg_loss: 23466.7592; val_edge_recon_loss: 2631083.0718; val_gene_expr_recon_loss: 6403689.0579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9058238.8935; val_optim_loss: 9058238.8935
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9883; val_auprc_score: 0.9865; val_best_acc_score: 0.9500; val_best_f1_score: 0.9510; train_kl_reg_loss: 23563.8441; train_edge_recon_loss: 2617296.4905; train_gene_expr_recon_loss: 6351867.3601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8992727.6901; train_optim_loss: 8992727.6901; val_kl_reg_loss: 22690.5199; val_edge_recon_loss: 2633329.2419; val_gene_expr_recon_loss: 6401708.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9057728.0880; val_optim_loss: 9057728.0880

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9871; val_best_acc_score: 0.9515; val_best_f1_score: 0.9523; train_kl_reg_loss: 24572.0536; train_edge_recon_loss: 2615982.8273; train_gene_expr_recon_loss: 6305991.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8946545.8922; train_optim_loss: 8946545.8922; val_kl_reg_loss: 24419.9308; val_edge_recon_loss: 2629694.4606; val_gene_expr_recon_loss: 6363372.4838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9017486.8773; val_optim_loss: 9017486.8773
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9888; val_auprc_score: 0.9871; val_best_acc_score: 0.9513; val_best_f1_score: 0.9522; train_kl_reg_loss: 24941.0450; train_edge_recon_loss: 2615423.0845; train_gene_expr_recon_loss: 6305005.6939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8945369.8259; train_optim_loss: 8945369.8259; val_kl_reg_loss: 24669.1691; val_edge_recon_loss: 2627408.8877; val_gene_expr_recon_loss: 6362524.3009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9014602.3889; val_optim_loss: 9014602.3889
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9890; val_auprc_score: 0.9871; val_best_acc_score: 0.9518; val_best_f1_score: 0.9525; train_kl_reg_loss: 25095.8401; train_edge_recon_loss: 2614012.1950; train_gene_expr_recon_loss: 6297024.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8936132.0926; train_optim_loss: 8936132.0926; val_kl_reg_loss: 24788.5071; val_edge_recon_loss: 2627764.3414; val_gene_expr_recon_loss: 6362776.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9015329.7315; val_optim_loss: 9015329.7315
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9892; val_auprc_score: 0.9876; val_best_acc_score: 0.9516; val_best_f1_score: 0.9524; train_kl_reg_loss: 25124.2980; train_edge_recon_loss: 2614489.6067; train_gene_expr_recon_loss: 6299247.7935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8938861.6929; train_optim_loss: 8938861.6929; val_kl_reg_loss: 24805.8965; val_edge_recon_loss: 2627729.6273; val_gene_expr_recon_loss: 6351051.0093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9003586.5370; val_optim_loss: 9003586.5370
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9894; val_auprc_score: 0.9878; val_best_acc_score: 0.9525; val_best_f1_score: 0.9534; train_kl_reg_loss: 25080.6445; train_edge_recon_loss: 2614216.6962; train_gene_expr_recon_loss: 6298657.8686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8937955.2153; train_optim_loss: 8937955.2153; val_kl_reg_loss: 24638.4982; val_edge_recon_loss: 2627120.4144; val_gene_expr_recon_loss: 6361354.7454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9013113.6782; val_optim_loss: 9013113.6782
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9890; val_auprc_score: 0.9873; val_best_acc_score: 0.9518; val_best_f1_score: 0.9525; train_kl_reg_loss: 25109.6472; train_edge_recon_loss: 2614685.3412; train_gene_expr_recon_loss: 6296588.1955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8936383.1921; train_optim_loss: 8936383.1921; val_kl_reg_loss: 24692.4811; val_edge_recon_loss: 2631361.2060; val_gene_expr_recon_loss: 6365505.3426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9021559.0093; val_optim_loss: 9021559.0093
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9895; val_auprc_score: 0.9878; val_best_acc_score: 0.9531; val_best_f1_score: 0.9537; train_kl_reg_loss: 25041.6383; train_edge_recon_loss: 2613683.0778; train_gene_expr_recon_loss: 6297434.5622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8936159.2755; train_optim_loss: 8936159.2755; val_kl_reg_loss: 24570.2538; val_edge_recon_loss: 2629118.4549; val_gene_expr_recon_loss: 6361051.5370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9014740.2593; val_optim_loss: 9014740.2593
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9536; val_best_f1_score: 0.9542; train_kl_reg_loss: 25021.1861; train_edge_recon_loss: 2613130.4583; train_gene_expr_recon_loss: 6295588.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8933740.0288; train_optim_loss: 8933740.0288; val_kl_reg_loss: 24604.4266; val_edge_recon_loss: 2626628.7222; val_gene_expr_recon_loss: 6366598.8819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9017832.0139; val_optim_loss: 9017832.0139

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9899; val_auprc_score: 0.9884; val_best_acc_score: 0.9535; val_best_f1_score: 0.9541; train_kl_reg_loss: 25101.4041; train_edge_recon_loss: 2612823.3414; train_gene_expr_recon_loss: 6293148.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8931073.4910; train_optim_loss: 8931073.4910; val_kl_reg_loss: 24745.5748; val_edge_recon_loss: 2625985.8322; val_gene_expr_recon_loss: 6357735.4491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9008466.8611; val_optim_loss: 9008466.8611
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9894; val_auprc_score: 0.9879; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 25144.3460; train_edge_recon_loss: 2614167.2103; train_gene_expr_recon_loss: 6288082.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927394.4244; train_optim_loss: 8927394.4244; val_kl_reg_loss: 24748.7845; val_edge_recon_loss: 2627707.1551; val_gene_expr_recon_loss: 6355157.8796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9007613.8472; val_optim_loss: 9007613.8472
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9537; val_best_f1_score: 0.9544; train_kl_reg_loss: 25169.5689; train_edge_recon_loss: 2613457.6152; train_gene_expr_recon_loss: 6288606.2737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927233.4624; train_optim_loss: 8927233.4624; val_kl_reg_loss: 24773.9292; val_edge_recon_loss: 2624253.2847; val_gene_expr_recon_loss: 6350486.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8999514.1157; val_optim_loss: 8999514.1157
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9533; val_best_f1_score: 0.9541; train_kl_reg_loss: 25183.4489; train_edge_recon_loss: 2614353.5971; train_gene_expr_recon_loss: 6288451.8346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927988.8845; train_optim_loss: 8927988.8845; val_kl_reg_loss: 24762.0499; val_edge_recon_loss: 2626815.3692; val_gene_expr_recon_loss: 6350319.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9001896.6991; val_optim_loss: 9001896.6991
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9895; val_auprc_score: 0.9880; val_best_acc_score: 0.9532; val_best_f1_score: 0.9541; train_kl_reg_loss: 25164.9998; train_edge_recon_loss: 2612829.5907; train_gene_expr_recon_loss: 6289435.8773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927430.4707; train_optim_loss: 8927430.4707; val_kl_reg_loss: 24758.0402; val_edge_recon_loss: 2628164.3611; val_gene_expr_recon_loss: 6353308.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9006230.6713; val_optim_loss: 9006230.6713
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9895; val_auprc_score: 0.9877; val_best_acc_score: 0.9533; val_best_f1_score: 0.9539; train_kl_reg_loss: 25226.1428; train_edge_recon_loss: 2612962.7854; train_gene_expr_recon_loss: 6290209.5738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8928398.4979; train_optim_loss: 8928398.4979; val_kl_reg_loss: 24818.7291; val_edge_recon_loss: 2627067.3935; val_gene_expr_recon_loss: 6347083.0648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8998969.1944; val_optim_loss: 8998969.1944
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9896; val_auprc_score: 0.9878; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 25225.4273; train_edge_recon_loss: 2612711.8843; train_gene_expr_recon_loss: 6290019.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927956.7549; train_optim_loss: 8927956.7549; val_kl_reg_loss: 24843.5318; val_edge_recon_loss: 2625805.7546; val_gene_expr_recon_loss: 6352975.5718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9003624.8611; val_optim_loss: 9003624.8611
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9895; val_auprc_score: 0.9878; val_best_acc_score: 0.9535; val_best_f1_score: 0.9541; train_kl_reg_loss: 25232.4363; train_edge_recon_loss: 2612805.2766; train_gene_expr_recon_loss: 6291237.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8929274.7955; train_optim_loss: 8929274.7955; val_kl_reg_loss: 24804.1450; val_edge_recon_loss: 2625850.6146; val_gene_expr_recon_loss: 6349722.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9000377.2870; val_optim_loss: 9000377.2870
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9894; val_auprc_score: 0.9875; val_best_acc_score: 0.9537; val_best_f1_score: 0.9543; train_kl_reg_loss: 25223.1904; train_edge_recon_loss: 2613013.8731; train_gene_expr_recon_loss: 6288034.0486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8926271.1091; train_optim_loss: 8926271.1091; val_kl_reg_loss: 24772.7329; val_edge_recon_loss: 2625207.8588; val_gene_expr_recon_loss: 6353753.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9003734.2662; val_optim_loss: 9003734.2662
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9533; val_best_f1_score: 0.9540; train_kl_reg_loss: 25212.5043; train_edge_recon_loss: 2613162.9936; train_gene_expr_recon_loss: 6290175.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8928550.8570; train_optim_loss: 8928550.8570; val_kl_reg_loss: 24787.0285; val_edge_recon_loss: 2626400.1134; val_gene_expr_recon_loss: 6343995.0301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8995182.1528; val_optim_loss: 8995182.1528
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9895; val_auprc_score: 0.9879; val_best_acc_score: 0.9531; val_best_f1_score: 0.9541; train_kl_reg_loss: 25218.2859; train_edge_recon_loss: 2613757.3032; train_gene_expr_recon_loss: 6289395.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8928371.2803; train_optim_loss: 8928371.2803; val_kl_reg_loss: 24768.4321; val_edge_recon_loss: 2627201.8032; val_gene_expr_recon_loss: 6354834.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9006805.2130; val_optim_loss: 9006805.2130
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9894; val_auprc_score: 0.9876; val_best_acc_score: 0.9532; val_best_f1_score: 0.9540; train_kl_reg_loss: 25212.4059; train_edge_recon_loss: 2612820.1866; train_gene_expr_recon_loss: 6289728.3912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927760.9925; train_optim_loss: 8927760.9925; val_kl_reg_loss: 24808.3652; val_edge_recon_loss: 2627150.1782; val_gene_expr_recon_loss: 6359345.7361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9011304.3333; val_optim_loss: 9011304.3333
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9894; val_auprc_score: 0.9875; val_best_acc_score: 0.9533; val_best_f1_score: 0.9541; train_kl_reg_loss: 25217.8699; train_edge_recon_loss: 2613083.0095; train_gene_expr_recon_loss: 6288676.1656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8926977.0409; train_optim_loss: 8926977.0409; val_kl_reg_loss: 24793.5232; val_edge_recon_loss: 2626960.4734; val_gene_expr_recon_loss: 6355859.0185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9007613.0278; val_optim_loss: 9007613.0278
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9892; val_auprc_score: 0.9874; val_best_acc_score: 0.9524; val_best_f1_score: 0.9531; train_kl_reg_loss: 25210.0268; train_edge_recon_loss: 2612382.2622; train_gene_expr_recon_loss: 6287390.3832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8924982.6800; train_optim_loss: 8924982.6800; val_kl_reg_loss: 24836.8324; val_edge_recon_loss: 2627616.2419; val_gene_expr_recon_loss: 6357999.7847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9010452.8773; val_optim_loss: 9010452.8773

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9535; val_best_f1_score: 0.9541; train_kl_reg_loss: 25219.1857; train_edge_recon_loss: 2612085.1166; train_gene_expr_recon_loss: 6290625.6813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927929.9820; train_optim_loss: 8927929.9820; val_kl_reg_loss: 24806.4728; val_edge_recon_loss: 2628785.3125; val_gene_expr_recon_loss: 6349388.8681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9002980.6019; val_optim_loss: 9002980.6019
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9895; val_auprc_score: 0.9877; val_best_acc_score: 0.9529; val_best_f1_score: 0.9536; train_kl_reg_loss: 25223.3965; train_edge_recon_loss: 2613468.1480; train_gene_expr_recon_loss: 6288963.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927655.4668; train_optim_loss: 8927655.4668; val_kl_reg_loss: 24810.9086; val_edge_recon_loss: 2630199.3912; val_gene_expr_recon_loss: 6352768.7824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9007779.0741; val_optim_loss: 9007779.0741
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9532; val_best_f1_score: 0.9539; train_kl_reg_loss: 25220.2906; train_edge_recon_loss: 2614841.2171; train_gene_expr_recon_loss: 6289026.6659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8929088.1775; train_optim_loss: 8929088.1775; val_kl_reg_loss: 24793.6494; val_edge_recon_loss: 2628051.1146; val_gene_expr_recon_loss: 6354711.0023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9007555.7824; val_optim_loss: 9007555.7824
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9896; val_auprc_score: 0.9880; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 25225.4515; train_edge_recon_loss: 2613607.8032; train_gene_expr_recon_loss: 6288647.2948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8927480.5504; train_optim_loss: 8927480.5504; val_kl_reg_loss: 24812.0132; val_edge_recon_loss: 2627371.8495; val_gene_expr_recon_loss: 6345220.8079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8997404.6667; val_optim_loss: 8997404.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 370 min 16 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9896
Val AUPRC score: 0.9879
Val best accuracy score: 0.9536
Val best F1 score: 0.9542
Val gene expr MSE score: 1.5041

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
