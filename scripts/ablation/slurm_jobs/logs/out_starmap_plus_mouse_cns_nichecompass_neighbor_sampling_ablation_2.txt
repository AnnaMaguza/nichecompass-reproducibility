None
Run timestamp: 13072023_084440_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9820; val_auprc_score: 0.9753; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 7719.4614; train_edge_recon_loss: 269895.1730; train_gene_expr_recon_loss: 128123.9930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405738.6266; train_optim_loss: 405738.6266; val_kl_reg_loss: 7487.5773; val_edge_recon_loss: 262147.6745; val_gene_expr_recon_loss: 115339.3872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384974.6410; val_optim_loss: 384974.6410
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9858; val_auprc_score: 0.9807; val_best_acc_score: 0.9555; val_best_f1_score: 0.9567; train_kl_reg_loss: 7556.1659; train_edge_recon_loss: 261496.7288; train_gene_expr_recon_loss: 111610.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380663.7967; train_optim_loss: 380663.7967; val_kl_reg_loss: 7154.3911; val_edge_recon_loss: 261261.4569; val_gene_expr_recon_loss: 109596.9758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378012.8239; val_optim_loss: 378012.8239
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9879; val_auprc_score: 0.9834; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 7178.1834; train_edge_recon_loss: 260687.7202; train_gene_expr_recon_loss: 107240.3329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375106.2357; train_optim_loss: 375106.2357; val_kl_reg_loss: 6976.9971; val_edge_recon_loss: 260305.4421; val_gene_expr_recon_loss: 106182.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373464.5724; val_optim_loss: 373464.5724
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9895; val_auprc_score: 0.9857; val_best_acc_score: 0.9641; val_best_f1_score: 0.9648; train_kl_reg_loss: 7027.0242; train_edge_recon_loss: 260156.5926; train_gene_expr_recon_loss: 104432.0671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371615.6829; train_optim_loss: 371615.6829; val_kl_reg_loss: 6859.7354; val_edge_recon_loss: 259691.2024; val_gene_expr_recon_loss: 104153.0212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370703.9558; val_optim_loss: 370703.9558
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9900; val_auprc_score: 0.9864; val_best_acc_score: 0.9648; val_best_f1_score: 0.9656; train_kl_reg_loss: 6919.1725; train_edge_recon_loss: 259730.6828; train_gene_expr_recon_loss: 102376.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369026.6568; train_optim_loss: 369026.6568; val_kl_reg_loss: 6785.0881; val_edge_recon_loss: 259786.6543; val_gene_expr_recon_loss: 102086.0997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368657.8422; val_optim_loss: 368657.8422
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9909; val_auprc_score: 0.9880; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 6820.9293; train_edge_recon_loss: 259471.8007; train_gene_expr_recon_loss: 100868.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367161.7038; train_optim_loss: 367161.7038; val_kl_reg_loss: 6657.1039; val_edge_recon_loss: 259507.1406; val_gene_expr_recon_loss: 100818.9872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366983.2340; val_optim_loss: 366983.2340
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9910; val_auprc_score: 0.9879; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 6755.0273; train_edge_recon_loss: 259254.3244; train_gene_expr_recon_loss: 99631.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365641.0176; train_optim_loss: 365641.0176; val_kl_reg_loss: 6711.0931; val_edge_recon_loss: 259083.6208; val_gene_expr_recon_loss: 99994.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365789.4162; val_optim_loss: 365789.4162
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 6701.3020; train_edge_recon_loss: 259028.0631; train_gene_expr_recon_loss: 98711.0441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364440.4091; train_optim_loss: 364440.4091; val_kl_reg_loss: 6626.4926; val_edge_recon_loss: 258689.7214; val_gene_expr_recon_loss: 99244.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364561.0785; val_optim_loss: 364561.0785
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9893; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 6650.4386; train_edge_recon_loss: 258904.3114; train_gene_expr_recon_loss: 97843.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363398.4761; train_optim_loss: 363398.4761; val_kl_reg_loss: 6546.2083; val_edge_recon_loss: 258791.4714; val_gene_expr_recon_loss: 98497.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363835.4413; val_optim_loss: 363835.4413
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9905; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 6612.6383; train_edge_recon_loss: 258787.6259; train_gene_expr_recon_loss: 97233.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362633.4422; train_optim_loss: 362633.4422; val_kl_reg_loss: 6404.7784; val_edge_recon_loss: 258394.2999; val_gene_expr_recon_loss: 98282.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363081.4947; val_optim_loss: 363081.4947
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9928; val_auprc_score: 0.9903; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 6581.8905; train_edge_recon_loss: 258478.4313; train_gene_expr_recon_loss: 96621.5613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361681.8838; train_optim_loss: 361681.8838; val_kl_reg_loss: 6504.5161; val_edge_recon_loss: 258418.7409; val_gene_expr_recon_loss: 97936.7988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362860.0526; val_optim_loss: 362860.0526
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9929; val_auprc_score: 0.9904; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 6550.0812; train_edge_recon_loss: 258308.0229; train_gene_expr_recon_loss: 96142.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361000.8746; train_optim_loss: 361000.8746; val_kl_reg_loss: 6496.6236; val_edge_recon_loss: 258246.4455; val_gene_expr_recon_loss: 97138.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361881.6494; val_optim_loss: 361881.6494
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 6527.6790; train_edge_recon_loss: 258227.0707; train_gene_expr_recon_loss: 95772.9069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360527.6574; train_optim_loss: 360527.6574; val_kl_reg_loss: 6358.8944; val_edge_recon_loss: 258270.5480; val_gene_expr_recon_loss: 97196.4066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361825.8460; val_optim_loss: 361825.8460
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9939; val_auprc_score: 0.9921; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 6501.8181; train_edge_recon_loss: 258194.3514; train_gene_expr_recon_loss: 95397.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360093.3409; train_optim_loss: 360093.3409; val_kl_reg_loss: 6361.1478; val_edge_recon_loss: 257776.6757; val_gene_expr_recon_loss: 96997.0629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361134.8872; val_optim_loss: 361134.8872
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 6490.9884; train_edge_recon_loss: 257964.5377; train_gene_expr_recon_loss: 95082.2512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359537.7775; train_optim_loss: 359537.7775; val_kl_reg_loss: 6416.8330; val_edge_recon_loss: 258437.9139; val_gene_expr_recon_loss: 96926.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361781.1014; val_optim_loss: 361781.1014
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9766; val_best_f1_score: 0.9770; train_kl_reg_loss: 6468.8515; train_edge_recon_loss: 257952.2683; train_gene_expr_recon_loss: 94728.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359149.8300; train_optim_loss: 359149.8300; val_kl_reg_loss: 6347.2470; val_edge_recon_loss: 257775.3685; val_gene_expr_recon_loss: 96721.5696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360844.1822; val_optim_loss: 360844.1822
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9943; val_auprc_score: 0.9921; val_best_acc_score: 0.9763; val_best_f1_score: 0.9767; train_kl_reg_loss: 6459.2144; train_edge_recon_loss: 257803.2272; train_gene_expr_recon_loss: 94489.2970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358751.7385; train_optim_loss: 358751.7385; val_kl_reg_loss: 6346.9400; val_edge_recon_loss: 257659.6936; val_gene_expr_recon_loss: 96577.2988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360583.9367; val_optim_loss: 360583.9367
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 6452.5793; train_edge_recon_loss: 257727.6644; train_gene_expr_recon_loss: 94332.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358512.3284; train_optim_loss: 358512.3284; val_kl_reg_loss: 6354.8796; val_edge_recon_loss: 257494.9398; val_gene_expr_recon_loss: 96353.3548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360203.1761; val_optim_loss: 360203.1761
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 6450.2900; train_edge_recon_loss: 257640.3125; train_gene_expr_recon_loss: 94034.3946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358124.9966; train_optim_loss: 358124.9966; val_kl_reg_loss: 6359.4285; val_edge_recon_loss: 257460.8933; val_gene_expr_recon_loss: 96540.9285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360361.2485; val_optim_loss: 360361.2485
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 6444.5239; train_edge_recon_loss: 257519.9444; train_gene_expr_recon_loss: 93826.5832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357791.0509; train_optim_loss: 357791.0509; val_kl_reg_loss: 6320.3210; val_edge_recon_loss: 257431.5998; val_gene_expr_recon_loss: 96404.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360156.8697; val_optim_loss: 360156.8697
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9951; val_auprc_score: 0.9938; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 6441.3830; train_edge_recon_loss: 257467.9987; train_gene_expr_recon_loss: 93613.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357522.5743; train_optim_loss: 357522.5743; val_kl_reg_loss: 6349.9489; val_edge_recon_loss: 257356.2287; val_gene_expr_recon_loss: 96495.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360201.8963; val_optim_loss: 360201.8963
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 6442.9534; train_edge_recon_loss: 257401.7465; train_gene_expr_recon_loss: 93479.4971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357324.1978; train_optim_loss: 357324.1978; val_kl_reg_loss: 6364.9316; val_edge_recon_loss: 257120.2645; val_gene_expr_recon_loss: 96248.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359734.0099; val_optim_loss: 359734.0099
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 6445.5458; train_edge_recon_loss: 257277.2343; train_gene_expr_recon_loss: 93342.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357065.7625; train_optim_loss: 357065.7625; val_kl_reg_loss: 6298.4239; val_edge_recon_loss: 257099.7393; val_gene_expr_recon_loss: 96231.9289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359630.0953; val_optim_loss: 359630.0953
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6436.2817; train_edge_recon_loss: 257363.5558; train_gene_expr_recon_loss: 93152.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356952.1551; train_optim_loss: 356952.1551; val_kl_reg_loss: 6345.7914; val_edge_recon_loss: 257059.0709; val_gene_expr_recon_loss: 96075.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359480.6631; val_optim_loss: 359480.6631
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 6443.6575; train_edge_recon_loss: 257306.2064; train_gene_expr_recon_loss: 92959.3147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356709.1774; train_optim_loss: 356709.1774; val_kl_reg_loss: 6462.1406; val_edge_recon_loss: 257444.0785; val_gene_expr_recon_loss: 96182.9891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360089.2058; val_optim_loss: 360089.2058
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6449.6530; train_edge_recon_loss: 257193.9201; train_gene_expr_recon_loss: 92823.1030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356466.6760; train_optim_loss: 356466.6760; val_kl_reg_loss: 6399.8710; val_edge_recon_loss: 257062.7298; val_gene_expr_recon_loss: 96304.3746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359766.9771; val_optim_loss: 359766.9771
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6447.6243; train_edge_recon_loss: 257155.6600; train_gene_expr_recon_loss: 92623.7986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356227.0825; train_optim_loss: 356227.0825; val_kl_reg_loss: 6329.0229; val_edge_recon_loss: 257019.6925; val_gene_expr_recon_loss: 95954.2830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359302.9977; val_optim_loss: 359302.9977
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6453.5411; train_edge_recon_loss: 257036.6824; train_gene_expr_recon_loss: 92578.3207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356068.5442; train_optim_loss: 356068.5442; val_kl_reg_loss: 6359.8042; val_edge_recon_loss: 257306.6223; val_gene_expr_recon_loss: 96113.5198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359779.9497; val_optim_loss: 359779.9497
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 6459.7096; train_edge_recon_loss: 256946.8970; train_gene_expr_recon_loss: 92349.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355755.9559; train_optim_loss: 355755.9559; val_kl_reg_loss: 6499.1595; val_edge_recon_loss: 256917.4855; val_gene_expr_recon_loss: 96120.9072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359537.5473; val_optim_loss: 359537.5473
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6456.7540; train_edge_recon_loss: 257029.5218; train_gene_expr_recon_loss: 92231.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355717.6659; train_optim_loss: 355717.6659; val_kl_reg_loss: 6408.4946; val_edge_recon_loss: 257038.5655; val_gene_expr_recon_loss: 96171.3003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359618.3575; val_optim_loss: 359618.3575
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 6460.9857; train_edge_recon_loss: 256947.4432; train_gene_expr_recon_loss: 92136.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355544.5697; train_optim_loss: 355544.5697; val_kl_reg_loss: 6438.6439; val_edge_recon_loss: 257159.2393; val_gene_expr_recon_loss: 96108.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359706.8270; val_optim_loss: 359706.8270

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6467.2914; train_edge_recon_loss: 256756.8878; train_gene_expr_recon_loss: 91514.1306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354738.3094; train_optim_loss: 354738.3094; val_kl_reg_loss: 6371.8091; val_edge_recon_loss: 257008.0111; val_gene_expr_recon_loss: 95729.1269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359108.9489; val_optim_loss: 359108.9489
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9812; val_best_f1_score: 0.9813; train_kl_reg_loss: 6462.0886; train_edge_recon_loss: 256826.2441; train_gene_expr_recon_loss: 91453.1204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354741.4532; train_optim_loss: 354741.4532; val_kl_reg_loss: 6379.7853; val_edge_recon_loss: 256936.8620; val_gene_expr_recon_loss: 95829.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359146.1227; val_optim_loss: 359146.1227
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6460.9079; train_edge_recon_loss: 256728.0117; train_gene_expr_recon_loss: 91325.0620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354513.9819; train_optim_loss: 354513.9819; val_kl_reg_loss: 6385.1221; val_edge_recon_loss: 256715.8891; val_gene_expr_recon_loss: 96055.5753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359156.5861; val_optim_loss: 359156.5861
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 6456.9138; train_edge_recon_loss: 256801.3682; train_gene_expr_recon_loss: 91393.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354651.4137; train_optim_loss: 354651.4137; val_kl_reg_loss: 6387.5395; val_edge_recon_loss: 256810.7626; val_gene_expr_recon_loss: 95992.9482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359191.2523; val_optim_loss: 359191.2523
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6458.5555; train_edge_recon_loss: 256696.2884; train_gene_expr_recon_loss: 91330.7340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354485.5779; train_optim_loss: 354485.5779; val_kl_reg_loss: 6391.2992; val_edge_recon_loss: 257049.5118; val_gene_expr_recon_loss: 95829.8146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359270.6235; val_optim_loss: 359270.6235

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6455.3686; train_edge_recon_loss: 256768.8190; train_gene_expr_recon_loss: 91258.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354483.1068; train_optim_loss: 354483.1068; val_kl_reg_loss: 6380.1758; val_edge_recon_loss: 256921.5873; val_gene_expr_recon_loss: 95912.3956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359214.1608; val_optim_loss: 359214.1608
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6453.9381; train_edge_recon_loss: 256812.1935; train_gene_expr_recon_loss: 91168.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354434.3162; train_optim_loss: 354434.3162; val_kl_reg_loss: 6381.6373; val_edge_recon_loss: 256844.5175; val_gene_expr_recon_loss: 95982.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359208.1814; val_optim_loss: 359208.1814
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6455.5531; train_edge_recon_loss: 256674.8802; train_gene_expr_recon_loss: 91157.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354287.8078; train_optim_loss: 354287.8078; val_kl_reg_loss: 6381.9401; val_edge_recon_loss: 256810.1117; val_gene_expr_recon_loss: 95908.1334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359100.1845; val_optim_loss: 359100.1845
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6454.1070; train_edge_recon_loss: 256726.6888; train_gene_expr_recon_loss: 91163.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354343.8650; train_optim_loss: 354343.8650; val_kl_reg_loss: 6383.0228; val_edge_recon_loss: 256687.9726; val_gene_expr_recon_loss: 96110.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359181.0457; val_optim_loss: 359181.0457
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6454.5489; train_edge_recon_loss: 256733.9856; train_gene_expr_recon_loss: 91166.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354355.4914; train_optim_loss: 354355.4914; val_kl_reg_loss: 6381.0269; val_edge_recon_loss: 256807.5457; val_gene_expr_recon_loss: 96045.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359234.3011; val_optim_loss: 359234.3011
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 6454.0056; train_edge_recon_loss: 256738.0829; train_gene_expr_recon_loss: 91266.0492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354458.1379; train_optim_loss: 354458.1379; val_kl_reg_loss: 6377.9557; val_edge_recon_loss: 257101.2157; val_gene_expr_recon_loss: 95760.6606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359239.8316; val_optim_loss: 359239.8316
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6454.0502; train_edge_recon_loss: 256684.5286; train_gene_expr_recon_loss: 91102.0357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354240.6147; train_optim_loss: 354240.6147; val_kl_reg_loss: 6381.5021; val_edge_recon_loss: 256703.2275; val_gene_expr_recon_loss: 95973.6124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359058.3399; val_optim_loss: 359058.3399
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 6454.3439; train_edge_recon_loss: 256687.2944; train_gene_expr_recon_loss: 91161.0812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354302.7202; train_optim_loss: 354302.7202; val_kl_reg_loss: 6378.3693; val_edge_recon_loss: 257078.3270; val_gene_expr_recon_loss: 96120.9889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359577.6913; val_optim_loss: 359577.6913
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6453.0312; train_edge_recon_loss: 256713.8884; train_gene_expr_recon_loss: 91125.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354292.0109; train_optim_loss: 354292.0109; val_kl_reg_loss: 6372.8849; val_edge_recon_loss: 256871.5091; val_gene_expr_recon_loss: 95730.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358975.3186; val_optim_loss: 358975.3186
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6452.6607; train_edge_recon_loss: 256699.8079; train_gene_expr_recon_loss: 91165.2845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354317.7538; train_optim_loss: 354317.7538; val_kl_reg_loss: 6382.5210; val_edge_recon_loss: 256706.0747; val_gene_expr_recon_loss: 95957.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359045.6974; val_optim_loss: 359045.6974
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 6452.6753; train_edge_recon_loss: 256843.6233; train_gene_expr_recon_loss: 91181.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354477.7188; train_optim_loss: 354477.7188; val_kl_reg_loss: 6373.7495; val_edge_recon_loss: 256587.7481; val_gene_expr_recon_loss: 96000.9594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358962.4566; val_optim_loss: 358962.4566
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 6452.4051; train_edge_recon_loss: 256730.4059; train_gene_expr_recon_loss: 91242.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354425.3339; train_optim_loss: 354425.3339; val_kl_reg_loss: 6383.8545; val_edge_recon_loss: 256963.1147; val_gene_expr_recon_loss: 95910.0621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359257.0305; val_optim_loss: 359257.0305
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6453.2420; train_edge_recon_loss: 256722.8748; train_gene_expr_recon_loss: 91111.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354287.9542; train_optim_loss: 354287.9542; val_kl_reg_loss: 6374.1159; val_edge_recon_loss: 256967.1109; val_gene_expr_recon_loss: 96101.4274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359442.6562; val_optim_loss: 359442.6562
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6450.0811; train_edge_recon_loss: 256826.6994; train_gene_expr_recon_loss: 91145.0910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354421.8711; train_optim_loss: 354421.8711; val_kl_reg_loss: 6375.8579; val_edge_recon_loss: 256848.3620; val_gene_expr_recon_loss: 96103.1176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359327.3430; val_optim_loss: 359327.3430
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6448.9459; train_edge_recon_loss: 256773.7085; train_gene_expr_recon_loss: 91102.8896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354325.5437; train_optim_loss: 354325.5437; val_kl_reg_loss: 6383.5523; val_edge_recon_loss: 257089.4695; val_gene_expr_recon_loss: 96240.7889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359713.8102; val_optim_loss: 359713.8102

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6453.0971; train_edge_recon_loss: 256724.6552; train_gene_expr_recon_loss: 91170.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354348.1005; train_optim_loss: 354348.1005; val_kl_reg_loss: 6380.8279; val_edge_recon_loss: 256612.4718; val_gene_expr_recon_loss: 96069.8245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359063.1242; val_optim_loss: 359063.1242
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6451.7368; train_edge_recon_loss: 256717.0650; train_gene_expr_recon_loss: 91165.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354334.4553; train_optim_loss: 354334.4553; val_kl_reg_loss: 6374.5200; val_edge_recon_loss: 256801.2393; val_gene_expr_recon_loss: 95888.7178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359064.4748; val_optim_loss: 359064.4748
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6451.8539; train_edge_recon_loss: 256713.6592; train_gene_expr_recon_loss: 91109.0800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354274.5924; train_optim_loss: 354274.5924; val_kl_reg_loss: 6378.2279; val_edge_recon_loss: 256727.4005; val_gene_expr_recon_loss: 96030.9373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359136.5671; val_optim_loss: 359136.5671
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6451.6352; train_edge_recon_loss: 256793.6641; train_gene_expr_recon_loss: 91062.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354307.5409; train_optim_loss: 354307.5409; val_kl_reg_loss: 6376.4147; val_edge_recon_loss: 256684.5232; val_gene_expr_recon_loss: 95961.1292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359022.0671; val_optim_loss: 359022.0671

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 256 min 28 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9953
Val best accuracy score: 0.9809
Val best F1 score: 0.9811
Val gene expr MSE score: 0.6436

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
