None
Run timestamp: 15082023_090403_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9889; val_auprc_score: 0.9852; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 7291.6488; train_edge_recon_loss: 264166.1227; train_gene_expr_recon_loss: 198554.6053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470012.3761; train_optim_loss: 470012.3761; val_kl_reg_loss: 6968.9833; val_edge_recon_loss: 260529.7394; val_gene_expr_recon_loss: 182339.7926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449838.5147; val_optim_loss: 449838.5147
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9690; val_best_f1_score: 0.9695; train_kl_reg_loss: 6839.0562; train_edge_recon_loss: 259654.0478; train_gene_expr_recon_loss: 179185.3968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445678.5007; train_optim_loss: 445678.5007; val_kl_reg_loss: 6652.7501; val_edge_recon_loss: 258807.5318; val_gene_expr_recon_loss: 176772.2760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442232.5580; val_optim_loss: 442232.5580
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9911; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 6658.1474; train_edge_recon_loss: 258776.4674; train_gene_expr_recon_loss: 175248.1850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440682.8001; train_optim_loss: 440682.8001; val_kl_reg_loss: 6564.3773; val_edge_recon_loss: 257955.0526; val_gene_expr_recon_loss: 173955.9325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438475.3621; val_optim_loss: 438475.3621
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 6586.0402; train_edge_recon_loss: 258264.5290; train_gene_expr_recon_loss: 173354.9711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438205.5404; train_optim_loss: 438205.5404; val_kl_reg_loss: 6312.2013; val_edge_recon_loss: 257630.0199; val_gene_expr_recon_loss: 173079.7348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437021.9549; val_optim_loss: 437021.9549
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 6559.9156; train_edge_recon_loss: 257929.3012; train_gene_expr_recon_loss: 172599.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437088.7259; train_optim_loss: 437088.7259; val_kl_reg_loss: 6517.3410; val_edge_recon_loss: 257423.0278; val_gene_expr_recon_loss: 171936.1167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435876.4851; val_optim_loss: 435876.4851
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 6554.6419; train_edge_recon_loss: 257680.2520; train_gene_expr_recon_loss: 172044.0168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436278.9105; train_optim_loss: 436278.9105; val_kl_reg_loss: 6533.6822; val_edge_recon_loss: 257012.6568; val_gene_expr_recon_loss: 171673.6010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435219.9410; val_optim_loss: 435219.9410
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 6554.6825; train_edge_recon_loss: 257478.0066; train_gene_expr_recon_loss: 171628.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435660.9017; train_optim_loss: 435660.9017; val_kl_reg_loss: 6493.0445; val_edge_recon_loss: 257122.0843; val_gene_expr_recon_loss: 171377.4427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434992.5724; val_optim_loss: 434992.5724
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 6561.6276; train_edge_recon_loss: 257257.9596; train_gene_expr_recon_loss: 171423.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435243.3549; train_optim_loss: 435243.3549; val_kl_reg_loss: 6487.2631; val_edge_recon_loss: 257193.2404; val_gene_expr_recon_loss: 171274.9341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434955.4378; val_optim_loss: 434955.4378
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6566.3284; train_edge_recon_loss: 257165.2713; train_gene_expr_recon_loss: 171278.8824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435010.4821; train_optim_loss: 435010.4821; val_kl_reg_loss: 6408.5609; val_edge_recon_loss: 256753.9767; val_gene_expr_recon_loss: 171004.5800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434167.1185; val_optim_loss: 434167.1185
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6573.1331; train_edge_recon_loss: 257003.6144; train_gene_expr_recon_loss: 170815.9470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434392.6941; train_optim_loss: 434392.6941; val_kl_reg_loss: 6617.2065; val_edge_recon_loss: 256582.2771; val_gene_expr_recon_loss: 171362.3705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434561.8540; val_optim_loss: 434561.8540
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 6575.4633; train_edge_recon_loss: 256992.4354; train_gene_expr_recon_loss: 170856.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434423.9740; train_optim_loss: 434423.9740; val_kl_reg_loss: 6532.3710; val_edge_recon_loss: 256570.1131; val_gene_expr_recon_loss: 171119.2649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434221.7500; val_optim_loss: 434221.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 6582.3468; train_edge_recon_loss: 256895.3757; train_gene_expr_recon_loss: 170566.5449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434044.2672; train_optim_loss: 434044.2672; val_kl_reg_loss: 6534.9578; val_edge_recon_loss: 256282.9726; val_gene_expr_recon_loss: 171061.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433879.4365; val_optim_loss: 433879.4365
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6591.7869; train_edge_recon_loss: 256759.0203; train_gene_expr_recon_loss: 170474.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433825.1863; train_optim_loss: 433825.1863; val_kl_reg_loss: 6478.4484; val_edge_recon_loss: 256450.7756; val_gene_expr_recon_loss: 170852.2299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433781.4527; val_optim_loss: 433781.4527
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 6596.2314; train_edge_recon_loss: 256746.3940; train_gene_expr_recon_loss: 170453.4951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433796.1204; train_optim_loss: 433796.1204; val_kl_reg_loss: 6488.0884; val_edge_recon_loss: 256171.4129; val_gene_expr_recon_loss: 171016.7104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433676.2126; val_optim_loss: 433676.2126
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 6602.4978; train_edge_recon_loss: 256657.6798; train_gene_expr_recon_loss: 170347.4751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433607.6527; train_optim_loss: 433607.6527; val_kl_reg_loss: 6575.6537; val_edge_recon_loss: 256347.8150; val_gene_expr_recon_loss: 171208.4039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434131.8732; val_optim_loss: 434131.8732
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6609.3208; train_edge_recon_loss: 256540.0046; train_gene_expr_recon_loss: 170360.6566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433509.9823; train_optim_loss: 433509.9823; val_kl_reg_loss: 6564.8453; val_edge_recon_loss: 256398.6840; val_gene_expr_recon_loss: 170777.0956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433740.6244; val_optim_loss: 433740.6244
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6616.7923; train_edge_recon_loss: 256517.8380; train_gene_expr_recon_loss: 170310.0864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433444.7163; train_optim_loss: 433444.7163; val_kl_reg_loss: 6559.6273; val_edge_recon_loss: 256110.7947; val_gene_expr_recon_loss: 170775.9237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433446.3459; val_optim_loss: 433446.3459
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6623.5002; train_edge_recon_loss: 256495.1033; train_gene_expr_recon_loss: 170138.3224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433256.9258; train_optim_loss: 433256.9258; val_kl_reg_loss: 6557.4713; val_edge_recon_loss: 256162.4310; val_gene_expr_recon_loss: 170622.8376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433342.7394; val_optim_loss: 433342.7394
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6629.0143; train_edge_recon_loss: 256390.0771; train_gene_expr_recon_loss: 170020.1909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433039.2820; train_optim_loss: 433039.2820; val_kl_reg_loss: 6626.8715; val_edge_recon_loss: 256145.4229; val_gene_expr_recon_loss: 170474.4591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433246.7535; val_optim_loss: 433246.7535
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9961; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6635.8950; train_edge_recon_loss: 256325.0179; train_gene_expr_recon_loss: 169954.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432915.5639; train_optim_loss: 432915.5639; val_kl_reg_loss: 6582.2811; val_edge_recon_loss: 255899.7958; val_gene_expr_recon_loss: 170958.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433440.1971; val_optim_loss: 433440.1971
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6636.7678; train_edge_recon_loss: 256331.6818; train_gene_expr_recon_loss: 169896.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432864.7907; train_optim_loss: 432864.7907; val_kl_reg_loss: 6638.0611; val_edge_recon_loss: 256061.2985; val_gene_expr_recon_loss: 170583.7954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433283.1541; val_optim_loss: 433283.1541
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 6642.5848; train_edge_recon_loss: 256258.0917; train_gene_expr_recon_loss: 169897.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432798.1647; train_optim_loss: 432798.1647; val_kl_reg_loss: 6528.2087; val_edge_recon_loss: 255984.1222; val_gene_expr_recon_loss: 170674.1980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433186.5282; val_optim_loss: 433186.5282
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6650.2182; train_edge_recon_loss: 256282.7249; train_gene_expr_recon_loss: 169929.7355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432862.6789; train_optim_loss: 432862.6789; val_kl_reg_loss: 6645.3399; val_edge_recon_loss: 255724.9446; val_gene_expr_recon_loss: 170867.3961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433237.6818; val_optim_loss: 433237.6818
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6649.8818; train_edge_recon_loss: 256242.3224; train_gene_expr_recon_loss: 169853.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432746.0497; train_optim_loss: 432746.0497; val_kl_reg_loss: 6646.5427; val_edge_recon_loss: 255999.2871; val_gene_expr_recon_loss: 170919.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433565.7557; val_optim_loss: 433565.7557
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 6660.3820; train_edge_recon_loss: 256178.1633; train_gene_expr_recon_loss: 169807.1018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432645.6473; train_optim_loss: 432645.6473; val_kl_reg_loss: 6656.8959; val_edge_recon_loss: 255793.9806; val_gene_expr_recon_loss: 170492.1619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432943.0371; val_optim_loss: 432943.0371
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 1755.7598; train_edge_recon_loss: 257343.5831; train_gene_expr_recon_loss: 92877.3564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 351976.6990; train_optim_loss: 351976.6990; val_kl_reg_loss: 640.7004; val_edge_recon_loss: 257311.4451; val_gene_expr_recon_loss: 91439.9563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 349392.1029; val_optim_loss: 349392.1029
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9916; val_auprc_score: 0.9885; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 965.4208; train_edge_recon_loss: 256615.2330; train_gene_expr_recon_loss: 91137.4496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 348718.1031; train_optim_loss: 348718.1031; val_kl_reg_loss: 672.3499; val_edge_recon_loss: 256550.0952; val_gene_expr_recon_loss: 90747.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347970.3848; val_optim_loss: 347970.3848
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 823.0882; train_edge_recon_loss: 256279.4048; train_gene_expr_recon_loss: 90788.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347891.4239; train_optim_loss: 347891.4239; val_kl_reg_loss: 676.2910; val_edge_recon_loss: 256848.8540; val_gene_expr_recon_loss: 90523.4469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 348048.5922; val_optim_loss: 348048.5922
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9928; val_auprc_score: 0.9900; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 746.3014; train_edge_recon_loss: 255867.5164; train_gene_expr_recon_loss: 90609.8139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 347223.6318; train_optim_loss: 347223.6318; val_kl_reg_loss: 688.8276; val_edge_recon_loss: 256266.7548; val_gene_expr_recon_loss: 90538.0585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347493.6399; val_optim_loss: 347493.6399
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9760; val_best_f1_score: 0.9764; train_kl_reg_loss: 717.0808; train_edge_recon_loss: 255701.1616; train_gene_expr_recon_loss: 90565.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346983.2667; train_optim_loss: 346983.2667; val_kl_reg_loss: 696.6525; val_edge_recon_loss: 255857.7513; val_gene_expr_recon_loss: 90578.5838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347132.9866; val_optim_loss: 347132.9866
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 704.3363; train_edge_recon_loss: 255602.0725; train_gene_expr_recon_loss: 90473.1409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346779.5494; train_optim_loss: 346779.5494; val_kl_reg_loss: 708.3285; val_edge_recon_loss: 256041.9636; val_gene_expr_recon_loss: 90322.8192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 347073.1113; val_optim_loss: 347073.1113
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 696.0108; train_edge_recon_loss: 255443.7848; train_gene_expr_recon_loss: 90422.8930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346562.6886; train_optim_loss: 346562.6886; val_kl_reg_loss: 668.4073; val_edge_recon_loss: 255910.1335; val_gene_expr_recon_loss: 90269.7837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346848.3246; val_optim_loss: 346848.3246
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 692.5917; train_edge_recon_loss: 255437.5805; train_gene_expr_recon_loss: 90424.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346555.0423; train_optim_loss: 346555.0423; val_kl_reg_loss: 680.5093; val_edge_recon_loss: 255489.5553; val_gene_expr_recon_loss: 90259.9963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346430.0613; val_optim_loss: 346430.0613
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9946; val_auprc_score: 0.9925; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 679.9253; train_edge_recon_loss: 255386.6957; train_gene_expr_recon_loss: 90299.0688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346365.6899; train_optim_loss: 346365.6899; val_kl_reg_loss: 667.5494; val_edge_recon_loss: 255689.2521; val_gene_expr_recon_loss: 90182.1692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346538.9711; val_optim_loss: 346538.9711
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 670.5152; train_edge_recon_loss: 255303.9973; train_gene_expr_recon_loss: 90291.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346265.7736; train_optim_loss: 346265.7736; val_kl_reg_loss: 657.7942; val_edge_recon_loss: 255619.2184; val_gene_expr_recon_loss: 90097.4950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346374.5066; val_optim_loss: 346374.5066
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9945; val_auprc_score: 0.9924; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 665.2786; train_edge_recon_loss: 255226.9619; train_gene_expr_recon_loss: 90299.5850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346191.8255; train_optim_loss: 346191.8255; val_kl_reg_loss: 666.2140; val_edge_recon_loss: 255387.4086; val_gene_expr_recon_loss: 90148.2915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346201.9130; val_optim_loss: 346201.9130
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9944; val_auprc_score: 0.9924; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 661.3762; train_edge_recon_loss: 255158.0415; train_gene_expr_recon_loss: 90299.1869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346118.6047; train_optim_loss: 346118.6047; val_kl_reg_loss: 646.4622; val_edge_recon_loss: 255731.6279; val_gene_expr_recon_loss: 89913.6383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346291.7284; val_optim_loss: 346291.7284
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 655.7601; train_edge_recon_loss: 255107.6543; train_gene_expr_recon_loss: 90216.3981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345979.8133; train_optim_loss: 345979.8133; val_kl_reg_loss: 645.8408; val_edge_recon_loss: 255630.5313; val_gene_expr_recon_loss: 90175.2036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346451.5757; val_optim_loss: 346451.5757
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 652.1342; train_edge_recon_loss: 255216.2159; train_gene_expr_recon_loss: 90255.0360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346123.3859; train_optim_loss: 346123.3859; val_kl_reg_loss: 621.2820; val_edge_recon_loss: 255903.5759; val_gene_expr_recon_loss: 89978.3691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346503.2271; val_optim_loss: 346503.2271
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 650.2583; train_edge_recon_loss: 255578.0600; train_gene_expr_recon_loss: 90034.2728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346262.5909; train_optim_loss: 346262.5909; val_kl_reg_loss: 588.8789; val_edge_recon_loss: 255955.8448; val_gene_expr_recon_loss: 90118.1905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346662.9134; val_optim_loss: 346662.9134

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 639.5179; train_edge_recon_loss: 255402.3795; train_gene_expr_recon_loss: 89878.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345920.4383; train_optim_loss: 345920.4383; val_kl_reg_loss: 595.0982; val_edge_recon_loss: 255395.9196; val_gene_expr_recon_loss: 89698.3694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 345689.3873; val_optim_loss: 345689.3873
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9941; val_auprc_score: 0.9920; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 648.3271; train_edge_recon_loss: 255625.1721; train_gene_expr_recon_loss: 89769.3070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346042.8066; train_optim_loss: 346042.8066; val_kl_reg_loss: 570.2228; val_edge_recon_loss: 256182.1113; val_gene_expr_recon_loss: 89503.7925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346256.1275; val_optim_loss: 346256.1275
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9941; val_auprc_score: 0.9917; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 643.0206; train_edge_recon_loss: 255765.0472; train_gene_expr_recon_loss: 89720.4177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346128.4854; train_optim_loss: 346128.4854; val_kl_reg_loss: 565.7322; val_edge_recon_loss: 256386.0187; val_gene_expr_recon_loss: 89791.2679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346743.0187; val_optim_loss: 346743.0187
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 626.3674; train_edge_recon_loss: 255732.5849; train_gene_expr_recon_loss: 89686.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346045.1549; train_optim_loss: 346045.1549; val_kl_reg_loss: 563.0372; val_edge_recon_loss: 256086.4841; val_gene_expr_recon_loss: 89558.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346207.6206; val_optim_loss: 346207.6206
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 606.2153; train_edge_recon_loss: 255788.5102; train_gene_expr_recon_loss: 89780.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346175.6767; train_optim_loss: 346175.6767; val_kl_reg_loss: 562.4424; val_edge_recon_loss: 256014.1085; val_gene_expr_recon_loss: 89915.7739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346492.3255; val_optim_loss: 346492.3255

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9944; val_auprc_score: 0.9924; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 598.5512; train_edge_recon_loss: 255550.2926; train_gene_expr_recon_loss: 89652.2813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345801.1252; train_optim_loss: 345801.1252; val_kl_reg_loss: 566.1497; val_edge_recon_loss: 256076.5215; val_gene_expr_recon_loss: 89658.2067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346300.8784; val_optim_loss: 346300.8784
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 598.0959; train_edge_recon_loss: 255671.3712; train_gene_expr_recon_loss: 89667.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345936.7840; train_optim_loss: 345936.7840; val_kl_reg_loss: 567.4021; val_edge_recon_loss: 256094.3447; val_gene_expr_recon_loss: 89565.5100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346227.2581; val_optim_loss: 346227.2581
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9947; val_auprc_score: 0.9927; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 596.7059; train_edge_recon_loss: 255655.2510; train_gene_expr_recon_loss: 89673.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345925.0537; train_optim_loss: 345925.0537; val_kl_reg_loss: 567.2763; val_edge_recon_loss: 256356.4247; val_gene_expr_recon_loss: 89720.4154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346644.1158; val_optim_loss: 346644.1158
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 595.3198; train_edge_recon_loss: 255680.0175; train_gene_expr_recon_loss: 89735.0101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 346010.3471; train_optim_loss: 346010.3471; val_kl_reg_loss: 567.2903; val_edge_recon_loss: 256115.5951; val_gene_expr_recon_loss: 89753.7245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 346436.6095; val_optim_loss: 346436.6095

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 314 min 50 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9943
val AUPRC score: 0.9922
val best accuracy score: 0.9769
val best F1 score: 0.9772
val target rna MSE score: 0.9385
val source rna MSE score: 0.0632

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
