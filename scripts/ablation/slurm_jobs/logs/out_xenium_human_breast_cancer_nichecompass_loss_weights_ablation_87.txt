None
Run timestamp: 28072023_190756_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9829; val_auprc_score: 0.9794; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 6127.0821; train_edge_recon_loss: 267805.2353; train_gene_expr_recon_loss: 125239.4231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 399171.7403; train_optim_loss: 399171.7403; val_kl_reg_loss: 5886.0773; val_edge_recon_loss: 263607.6982; val_gene_expr_recon_loss: 114345.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 383838.9620; val_optim_loss: 383838.9620
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9887; val_auprc_score: 0.9866; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 5943.1072; train_edge_recon_loss: 262577.5327; train_gene_expr_recon_loss: 110943.6788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 379464.3195; train_optim_loss: 379464.3195; val_kl_reg_loss: 5885.5937; val_edge_recon_loss: 261992.2862; val_gene_expr_recon_loss: 108800.4942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376678.3724; val_optim_loss: 376678.3724
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9905; val_auprc_score: 0.9887; val_best_acc_score: 0.9577; val_best_f1_score: 0.9585; train_kl_reg_loss: 5891.9236; train_edge_recon_loss: 261631.5354; train_gene_expr_recon_loss: 107433.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374957.3978; train_optim_loss: 374957.3978; val_kl_reg_loss: 5722.9348; val_edge_recon_loss: 262050.6628; val_gene_expr_recon_loss: 106577.0311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374350.6283; val_optim_loss: 374350.6283
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9919; val_auprc_score: 0.9903; val_best_acc_score: 0.9621; val_best_f1_score: 0.9626; train_kl_reg_loss: 5875.1075; train_edge_recon_loss: 260912.1840; train_gene_expr_recon_loss: 106035.1942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372822.4852; train_optim_loss: 372822.4852; val_kl_reg_loss: 5830.3420; val_edge_recon_loss: 261063.2857; val_gene_expr_recon_loss: 105620.2996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372513.9253; val_optim_loss: 372513.9253
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 5865.0564; train_edge_recon_loss: 260540.8508; train_gene_expr_recon_loss: 105433.3286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371839.2359; train_optim_loss: 371839.2359; val_kl_reg_loss: 5782.7452; val_edge_recon_loss: 260576.7739; val_gene_expr_recon_loss: 105239.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371598.8721; val_optim_loss: 371598.8721
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9928; val_auprc_score: 0.9912; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 5868.7199; train_edge_recon_loss: 260198.7614; train_gene_expr_recon_loss: 105053.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371120.7301; train_optim_loss: 371120.7301; val_kl_reg_loss: 5793.3758; val_edge_recon_loss: 260539.9364; val_gene_expr_recon_loss: 104998.9317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371332.2423; val_optim_loss: 371332.2423
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 5871.2334; train_edge_recon_loss: 260039.8029; train_gene_expr_recon_loss: 104838.9052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370749.9418; train_optim_loss: 370749.9418; val_kl_reg_loss: 5868.2348; val_edge_recon_loss: 260283.1874; val_gene_expr_recon_loss: 104917.8584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371069.2807; val_optim_loss: 371069.2807
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9665; val_best_f1_score: 0.9668; train_kl_reg_loss: 5873.5180; train_edge_recon_loss: 259865.0654; train_gene_expr_recon_loss: 104707.3491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370445.9327; train_optim_loss: 370445.9327; val_kl_reg_loss: 5790.6101; val_edge_recon_loss: 260270.1499; val_gene_expr_recon_loss: 104885.9769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370946.7363; val_optim_loss: 370946.7363
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9933; val_auprc_score: 0.9918; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 5877.5171; train_edge_recon_loss: 259711.8511; train_gene_expr_recon_loss: 104648.9435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370238.3110; train_optim_loss: 370238.3110; val_kl_reg_loss: 5892.7315; val_edge_recon_loss: 259941.3314; val_gene_expr_recon_loss: 104786.2124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370620.2769; val_optim_loss: 370620.2769
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9912; val_best_acc_score: 0.9670; val_best_f1_score: 0.9674; train_kl_reg_loss: 5888.8481; train_edge_recon_loss: 259489.6261; train_gene_expr_recon_loss: 104542.4050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369920.8792; train_optim_loss: 369920.8792; val_kl_reg_loss: 5760.1751; val_edge_recon_loss: 259978.5284; val_gene_expr_recon_loss: 104826.0971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370564.8012; val_optim_loss: 370564.8012
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9677; val_best_f1_score: 0.9681; train_kl_reg_loss: 5887.6288; train_edge_recon_loss: 259485.8625; train_gene_expr_recon_loss: 104472.5107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369846.0019; train_optim_loss: 369846.0019; val_kl_reg_loss: 5787.0040; val_edge_recon_loss: 259892.2898; val_gene_expr_recon_loss: 104421.9099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370101.2034; val_optim_loss: 370101.2034
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 5895.7414; train_edge_recon_loss: 259353.0705; train_gene_expr_recon_loss: 104422.1854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369670.9973; train_optim_loss: 369670.9973; val_kl_reg_loss: 5821.7395; val_edge_recon_loss: 259371.7924; val_gene_expr_recon_loss: 104654.0871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369847.6172; val_optim_loss: 369847.6172
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9937; val_auprc_score: 0.9922; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5901.5792; train_edge_recon_loss: 259189.0795; train_gene_expr_recon_loss: 104358.3520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369449.0109; train_optim_loss: 369449.0109; val_kl_reg_loss: 5855.2564; val_edge_recon_loss: 259736.9094; val_gene_expr_recon_loss: 104523.2835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370115.4495; val_optim_loss: 370115.4495
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 5911.4630; train_edge_recon_loss: 259136.9971; train_gene_expr_recon_loss: 104333.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369381.6570; train_optim_loss: 369381.6570; val_kl_reg_loss: 5886.9037; val_edge_recon_loss: 259357.1557; val_gene_expr_recon_loss: 104448.3725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369692.4313; val_optim_loss: 369692.4313
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9943; val_auprc_score: 0.9930; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 5915.0186; train_edge_recon_loss: 259053.0428; train_gene_expr_recon_loss: 104296.1282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369264.1895; train_optim_loss: 369264.1895; val_kl_reg_loss: 5749.6364; val_edge_recon_loss: 259257.2282; val_gene_expr_recon_loss: 104493.4597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369500.3254; val_optim_loss: 369500.3254
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9940; val_auprc_score: 0.9928; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 5914.7682; train_edge_recon_loss: 259067.9275; train_gene_expr_recon_loss: 104255.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369238.0606; train_optim_loss: 369238.0606; val_kl_reg_loss: 5971.9119; val_edge_recon_loss: 259318.7509; val_gene_expr_recon_loss: 104576.3256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369866.9870; val_optim_loss: 369866.9870
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 5918.3757; train_edge_recon_loss: 259020.4107; train_gene_expr_recon_loss: 104246.5012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369185.2872; train_optim_loss: 369185.2872; val_kl_reg_loss: 5791.7131; val_edge_recon_loss: 259053.8031; val_gene_expr_recon_loss: 104515.6247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369361.1406; val_optim_loss: 369361.1406
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 5926.9517; train_edge_recon_loss: 258896.5105; train_gene_expr_recon_loss: 104229.8787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369053.3408; train_optim_loss: 369053.3408; val_kl_reg_loss: 5863.6692; val_edge_recon_loss: 258870.4358; val_gene_expr_recon_loss: 104402.8601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369136.9647; val_optim_loss: 369136.9647
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 5927.6617; train_edge_recon_loss: 258903.1732; train_gene_expr_recon_loss: 104229.5048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369060.3393; train_optim_loss: 369060.3393; val_kl_reg_loss: 5898.5076; val_edge_recon_loss: 259117.2022; val_gene_expr_recon_loss: 104386.9121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369402.6211; val_optim_loss: 369402.6211
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 5928.7101; train_edge_recon_loss: 258831.2005; train_gene_expr_recon_loss: 104229.9607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368989.8710; train_optim_loss: 368989.8710; val_kl_reg_loss: 5943.4080; val_edge_recon_loss: 258804.9094; val_gene_expr_recon_loss: 104437.0892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369185.4064; val_optim_loss: 369185.4064
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 5933.5057; train_edge_recon_loss: 258827.5320; train_gene_expr_recon_loss: 104147.1179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368908.1560; train_optim_loss: 368908.1560; val_kl_reg_loss: 5800.1028; val_edge_recon_loss: 258703.9264; val_gene_expr_recon_loss: 104461.5692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368965.5982; val_optim_loss: 368965.5982
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9731; val_best_f1_score: 0.9734; train_kl_reg_loss: 5936.6547; train_edge_recon_loss: 258723.6155; train_gene_expr_recon_loss: 104185.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368846.2447; train_optim_loss: 368846.2447; val_kl_reg_loss: 5874.6538; val_edge_recon_loss: 258633.0681; val_gene_expr_recon_loss: 104204.5396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368712.2623; val_optim_loss: 368712.2623
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 5939.2477; train_edge_recon_loss: 258686.2586; train_gene_expr_recon_loss: 104214.8433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368840.3489; train_optim_loss: 368840.3489; val_kl_reg_loss: 5949.0568; val_edge_recon_loss: 258794.9944; val_gene_expr_recon_loss: 104430.1599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369174.2121; val_optim_loss: 369174.2121
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5937.7884; train_edge_recon_loss: 258738.9888; train_gene_expr_recon_loss: 104182.4183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368859.1956; train_optim_loss: 368859.1956; val_kl_reg_loss: 5938.3807; val_edge_recon_loss: 258809.0764; val_gene_expr_recon_loss: 104444.0292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369191.4857; val_optim_loss: 369191.4857
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5944.5686; train_edge_recon_loss: 258590.9216; train_gene_expr_recon_loss: 104212.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368748.3613; train_optim_loss: 368748.3613; val_kl_reg_loss: 6018.4347; val_edge_recon_loss: 258806.7093; val_gene_expr_recon_loss: 104508.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369333.8621; val_optim_loss: 369333.8621
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 5948.0298; train_edge_recon_loss: 258637.3537; train_gene_expr_recon_loss: 104196.4237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368781.8069; train_optim_loss: 368781.8069; val_kl_reg_loss: 6009.9677; val_edge_recon_loss: 258657.9808; val_gene_expr_recon_loss: 104089.8697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368757.8192; val_optim_loss: 368757.8192

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 5975.3641; train_edge_recon_loss: 258350.5561; train_gene_expr_recon_loss: 103688.9995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368014.9201; train_optim_loss: 368014.9201; val_kl_reg_loss: 5927.5866; val_edge_recon_loss: 258488.3710; val_gene_expr_recon_loss: 104228.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368644.9117; val_optim_loss: 368644.9117
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 5963.4638; train_edge_recon_loss: 258321.6536; train_gene_expr_recon_loss: 103645.5091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367930.6265; train_optim_loss: 367930.6265; val_kl_reg_loss: 5931.4045; val_edge_recon_loss: 258593.2841; val_gene_expr_recon_loss: 103638.8316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368163.5205; val_optim_loss: 368163.5205
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 5962.5647; train_edge_recon_loss: 258302.8119; train_gene_expr_recon_loss: 103632.9747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367898.3515; train_optim_loss: 367898.3515; val_kl_reg_loss: 5915.0181; val_edge_recon_loss: 258431.4931; val_gene_expr_recon_loss: 103949.9977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368296.5091; val_optim_loss: 368296.5091
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5960.1502; train_edge_recon_loss: 258273.2925; train_gene_expr_recon_loss: 103591.2468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367824.6895; train_optim_loss: 367824.6895; val_kl_reg_loss: 5910.9789; val_edge_recon_loss: 258405.0924; val_gene_expr_recon_loss: 104028.3987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368344.4708; val_optim_loss: 368344.4708
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5960.7767; train_edge_recon_loss: 258219.2457; train_gene_expr_recon_loss: 103590.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367770.2654; train_optim_loss: 367770.2654; val_kl_reg_loss: 5880.0367; val_edge_recon_loss: 258273.6770; val_gene_expr_recon_loss: 103769.5544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367923.2684; val_optim_loss: 367923.2684
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9954; val_auprc_score: 0.9944; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 5956.7363; train_edge_recon_loss: 258284.9852; train_gene_expr_recon_loss: 103578.5531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367820.2745; train_optim_loss: 367820.2745; val_kl_reg_loss: 5932.2700; val_edge_recon_loss: 258440.8753; val_gene_expr_recon_loss: 103955.1600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368328.3050; val_optim_loss: 368328.3050
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5955.9739; train_edge_recon_loss: 258245.0989; train_gene_expr_recon_loss: 103608.4231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367809.4965; train_optim_loss: 367809.4965; val_kl_reg_loss: 5918.3283; val_edge_recon_loss: 258416.2226; val_gene_expr_recon_loss: 104683.8648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369018.4171; val_optim_loss: 369018.4171
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5956.0418; train_edge_recon_loss: 258235.8301; train_gene_expr_recon_loss: 103567.5017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367759.3734; train_optim_loss: 367759.3734; val_kl_reg_loss: 5930.2824; val_edge_recon_loss: 258322.5754; val_gene_expr_recon_loss: 103370.0985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367622.9559; val_optim_loss: 367622.9559
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5959.2413; train_edge_recon_loss: 258217.8435; train_gene_expr_recon_loss: 103618.3872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367795.4721; train_optim_loss: 367795.4721; val_kl_reg_loss: 5919.1795; val_edge_recon_loss: 258301.3588; val_gene_expr_recon_loss: 103298.2863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367518.8244; val_optim_loss: 367518.8244
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 5957.1844; train_edge_recon_loss: 258271.6082; train_gene_expr_recon_loss: 103578.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367807.2014; train_optim_loss: 367807.2014; val_kl_reg_loss: 5905.2388; val_edge_recon_loss: 258392.4602; val_gene_expr_recon_loss: 104257.4901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368555.1889; val_optim_loss: 368555.1889
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5953.6384; train_edge_recon_loss: 258234.6455; train_gene_expr_recon_loss: 103536.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367724.5719; train_optim_loss: 367724.5719; val_kl_reg_loss: 5937.0623; val_edge_recon_loss: 258411.0434; val_gene_expr_recon_loss: 103096.4684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367444.5731; val_optim_loss: 367444.5731
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5955.6411; train_edge_recon_loss: 258250.9805; train_gene_expr_recon_loss: 103572.3504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367778.9723; train_optim_loss: 367778.9723; val_kl_reg_loss: 5911.8043; val_edge_recon_loss: 258251.8411; val_gene_expr_recon_loss: 103780.0498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367943.6957; val_optim_loss: 367943.6957
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5955.5478; train_edge_recon_loss: 258183.6805; train_gene_expr_recon_loss: 103552.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367691.8272; train_optim_loss: 367691.8272; val_kl_reg_loss: 5913.7084; val_edge_recon_loss: 258245.8093; val_gene_expr_recon_loss: 102812.3162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366971.8328; val_optim_loss: 366971.8328
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5952.3332; train_edge_recon_loss: 258287.7316; train_gene_expr_recon_loss: 103548.0212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367788.0856; train_optim_loss: 367788.0856; val_kl_reg_loss: 5927.7745; val_edge_recon_loss: 258366.2499; val_gene_expr_recon_loss: 104011.3434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368305.3675; val_optim_loss: 368305.3675
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5951.9170; train_edge_recon_loss: 258277.8028; train_gene_expr_recon_loss: 103576.9579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367806.6777; train_optim_loss: 367806.6777; val_kl_reg_loss: 5928.6393; val_edge_recon_loss: 258233.4954; val_gene_expr_recon_loss: 102798.1121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366960.2473; val_optim_loss: 366960.2473
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5956.3374; train_edge_recon_loss: 258214.3507; train_gene_expr_recon_loss: 103552.5809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367723.2690; train_optim_loss: 367723.2690; val_kl_reg_loss: 5898.2004; val_edge_recon_loss: 258109.9058; val_gene_expr_recon_loss: 103931.7291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367939.8345; val_optim_loss: 367939.8345
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 5956.5035; train_edge_recon_loss: 258156.8356; train_gene_expr_recon_loss: 103618.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367732.3000; train_optim_loss: 367732.3000; val_kl_reg_loss: 5906.9433; val_edge_recon_loss: 258173.0810; val_gene_expr_recon_loss: 103272.4736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367352.4994; val_optim_loss: 367352.4994
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 5957.0879; train_edge_recon_loss: 258113.2045; train_gene_expr_recon_loss: 103516.4821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367586.7745; train_optim_loss: 367586.7745; val_kl_reg_loss: 5902.0727; val_edge_recon_loss: 258309.6019; val_gene_expr_recon_loss: 105317.8109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369529.4870; val_optim_loss: 369529.4870
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 5954.0145; train_edge_recon_loss: 258203.9800; train_gene_expr_recon_loss: 103534.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367692.6102; train_optim_loss: 367692.6102; val_kl_reg_loss: 5883.5198; val_edge_recon_loss: 258248.7092; val_gene_expr_recon_loss: 103858.8266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367991.0557; val_optim_loss: 367991.0557

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9954; val_auprc_score: 0.9942; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 5954.6314; train_edge_recon_loss: 258222.4315; train_gene_expr_recon_loss: 103513.7871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367690.8498; train_optim_loss: 367690.8498; val_kl_reg_loss: 5913.1853; val_edge_recon_loss: 258341.4562; val_gene_expr_recon_loss: 104143.0505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368397.6917; val_optim_loss: 368397.6917
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 5956.4983; train_edge_recon_loss: 258225.4265; train_gene_expr_recon_loss: 103279.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367461.7506; train_optim_loss: 367461.7506; val_kl_reg_loss: 5913.1749; val_edge_recon_loss: 258181.8959; val_gene_expr_recon_loss: 104239.4821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368334.5535; val_optim_loss: 368334.5535
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 5958.2619; train_edge_recon_loss: 258101.4832; train_gene_expr_recon_loss: 103406.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367466.6845; train_optim_loss: 367466.6845; val_kl_reg_loss: 5920.8733; val_edge_recon_loss: 258283.9102; val_gene_expr_recon_loss: 103943.7994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368148.5839; val_optim_loss: 368148.5839
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5956.8008; train_edge_recon_loss: 258102.2332; train_gene_expr_recon_loss: 103417.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367476.9429; train_optim_loss: 367476.9429; val_kl_reg_loss: 5908.6181; val_edge_recon_loss: 258415.9852; val_gene_expr_recon_loss: 103700.3597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368024.9634; val_optim_loss: 368024.9634

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 442 min 51 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9954
val AUPRC score: 0.9941
val best accuracy score: 0.9763
val best F1 score: 0.9766
val target rna MSE score: 1.4170
val source rna MSE score: 0.1295

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
