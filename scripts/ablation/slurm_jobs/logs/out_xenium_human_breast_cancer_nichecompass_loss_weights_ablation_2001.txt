None
Run timestamp: 16072023_050911_2001.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2001']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9608; val_auprc_score: 0.9515; val_best_acc_score: 0.9027; val_best_f1_score: 0.9074; train_kl_reg_loss: 17723.0600; train_edge_recon_loss: 2690529.3339; train_gene_expr_recon_loss: 764443.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3472696.0518; train_optim_loss: 3472696.0518; val_kl_reg_loss: 15609.8310; val_edge_recon_loss: 2656424.6661; val_gene_expr_recon_loss: 704133.1366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3376167.6336; val_optim_loss: 3376167.6336
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9767; val_auprc_score: 0.9719; val_best_acc_score: 0.9278; val_best_f1_score: 0.9300; train_kl_reg_loss: 14572.1534; train_edge_recon_loss: 2628911.7687; train_gene_expr_recon_loss: 689664.7564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3333148.6787; train_optim_loss: 3333148.6787; val_kl_reg_loss: 13668.7804; val_edge_recon_loss: 2641053.7123; val_gene_expr_recon_loss: 674553.9893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3329276.4829; val_optim_loss: 3329276.4829
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9769; val_best_acc_score: 0.9368; val_best_f1_score: 0.9385; train_kl_reg_loss: 13792.8535; train_edge_recon_loss: 2615814.6510; train_gene_expr_recon_loss: 668182.8512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3297790.3540; train_optim_loss: 3297790.3540; val_kl_reg_loss: 13177.7232; val_edge_recon_loss: 2632916.6781; val_gene_expr_recon_loss: 660130.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3306225.0531; val_optim_loss: 3306225.0531
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9810; val_auprc_score: 0.9763; val_best_acc_score: 0.9388; val_best_f1_score: 0.9403; train_kl_reg_loss: 13332.9432; train_edge_recon_loss: 2609583.1942; train_gene_expr_recon_loss: 657911.1829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3280827.3196; train_optim_loss: 3280827.3196; val_kl_reg_loss: 13174.5532; val_edge_recon_loss: 2630156.1250; val_gene_expr_recon_loss: 652588.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3295919.0753; val_optim_loss: 3295919.0753
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9854; val_auprc_score: 0.9824; val_best_acc_score: 0.9463; val_best_f1_score: 0.9474; train_kl_reg_loss: 12878.3126; train_edge_recon_loss: 2605064.7376; train_gene_expr_recon_loss: 651843.3931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3269786.4472; train_optim_loss: 3269786.4472; val_kl_reg_loss: 12500.2704; val_edge_recon_loss: 2623010.2363; val_gene_expr_recon_loss: 649997.8973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285508.4110; val_optim_loss: 3285508.4110
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9859; val_auprc_score: 0.9828; val_best_acc_score: 0.9474; val_best_f1_score: 0.9484; train_kl_reg_loss: 12658.0053; train_edge_recon_loss: 2602416.5885; train_gene_expr_recon_loss: 648247.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3263322.3330; train_optim_loss: 3263322.3330; val_kl_reg_loss: 12197.7781; val_edge_recon_loss: 2623507.4640; val_gene_expr_recon_loss: 645948.6263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3281653.8682; val_optim_loss: 3281653.8682
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9863; val_auprc_score: 0.9829; val_best_acc_score: 0.9492; val_best_f1_score: 0.9503; train_kl_reg_loss: 12407.2089; train_edge_recon_loss: 2599705.0149; train_gene_expr_recon_loss: 645737.5315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257849.7554; train_optim_loss: 3257849.7554; val_kl_reg_loss: 11950.2980; val_edge_recon_loss: 2621521.4127; val_gene_expr_recon_loss: 644474.1640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277945.8784; val_optim_loss: 3277945.8784
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9871; val_auprc_score: 0.9841; val_best_acc_score: 0.9510; val_best_f1_score: 0.9518; train_kl_reg_loss: 12262.5642; train_edge_recon_loss: 2597623.7523; train_gene_expr_recon_loss: 643683.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253569.6128; train_optim_loss: 3253569.6128; val_kl_reg_loss: 11926.6310; val_edge_recon_loss: 2621676.3750; val_gene_expr_recon_loss: 642160.6079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3275763.6096; val_optim_loss: 3275763.6096
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9878; val_auprc_score: 0.9848; val_best_acc_score: 0.9536; val_best_f1_score: 0.9545; train_kl_reg_loss: 12140.9654; train_edge_recon_loss: 2595693.7645; train_gene_expr_recon_loss: 642298.6682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250133.4004; train_optim_loss: 3250133.4004; val_kl_reg_loss: 11545.7164; val_edge_recon_loss: 2617336.9075; val_gene_expr_recon_loss: 641097.1327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269979.7586; val_optim_loss: 3269979.7586
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9878; val_auprc_score: 0.9853; val_best_acc_score: 0.9530; val_best_f1_score: 0.9539; train_kl_reg_loss: 12046.9065; train_edge_recon_loss: 2595046.3687; train_gene_expr_recon_loss: 640931.7323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248025.0067; train_optim_loss: 3248025.0067; val_kl_reg_loss: 11969.0023; val_edge_recon_loss: 2614550.6473; val_gene_expr_recon_loss: 641419.8202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267939.4709; val_optim_loss: 3267939.4709
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9876; val_auprc_score: 0.9847; val_best_acc_score: 0.9528; val_best_f1_score: 0.9537; train_kl_reg_loss: 12008.4588; train_edge_recon_loss: 2593588.0742; train_gene_expr_recon_loss: 639783.6393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3245380.1693; train_optim_loss: 3245380.1693; val_kl_reg_loss: 11739.3364; val_edge_recon_loss: 2617528.4332; val_gene_expr_recon_loss: 638058.5043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267326.2740; val_optim_loss: 3267326.2740
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9858; val_best_acc_score: 0.9555; val_best_f1_score: 0.9564; train_kl_reg_loss: 11959.1321; train_edge_recon_loss: 2592101.4920; train_gene_expr_recon_loss: 638550.8491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3242611.4765; train_optim_loss: 3242611.4765; val_kl_reg_loss: 11685.7226; val_edge_recon_loss: 2616208.0223; val_gene_expr_recon_loss: 638632.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266526.2312; val_optim_loss: 3266526.2312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9887; val_auprc_score: 0.9859; val_best_acc_score: 0.9558; val_best_f1_score: 0.9566; train_kl_reg_loss: 11928.7549; train_edge_recon_loss: 2590853.8085; train_gene_expr_recon_loss: 637554.7286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240337.2993; train_optim_loss: 3240337.2993; val_kl_reg_loss: 11517.9610; val_edge_recon_loss: 2613240.7021; val_gene_expr_recon_loss: 638913.2132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263671.8921; val_optim_loss: 3263671.8921
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9888; val_auprc_score: 0.9861; val_best_acc_score: 0.9557; val_best_f1_score: 0.9566; train_kl_reg_loss: 11849.4972; train_edge_recon_loss: 2591488.4794; train_gene_expr_recon_loss: 637038.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240376.6697; train_optim_loss: 3240376.6697; val_kl_reg_loss: 11726.3619; val_edge_recon_loss: 2611012.3596; val_gene_expr_recon_loss: 638141.9533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260880.6918; val_optim_loss: 3260880.6918
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9888; val_auprc_score: 0.9859; val_best_acc_score: 0.9563; val_best_f1_score: 0.9570; train_kl_reg_loss: 11826.6506; train_edge_recon_loss: 2590927.6684; train_gene_expr_recon_loss: 636321.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239075.7653; train_optim_loss: 3239075.7653; val_kl_reg_loss: 11600.1372; val_edge_recon_loss: 2611156.4212; val_gene_expr_recon_loss: 637639.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260396.5257; val_optim_loss: 3260396.5257
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9566; val_best_f1_score: 0.9574; train_kl_reg_loss: 11802.0714; train_edge_recon_loss: 2589649.9258; train_gene_expr_recon_loss: 635714.4558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237166.4574; train_optim_loss: 3237166.4574; val_kl_reg_loss: 11465.8608; val_edge_recon_loss: 2613998.1627; val_gene_expr_recon_loss: 637158.4508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262622.4726; val_optim_loss: 3262622.4726
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9890; val_auprc_score: 0.9864; val_best_acc_score: 0.9566; val_best_f1_score: 0.9573; train_kl_reg_loss: 11779.6262; train_edge_recon_loss: 2589323.2466; train_gene_expr_recon_loss: 635226.2543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236329.1277; train_optim_loss: 3236329.1277; val_kl_reg_loss: 11664.6749; val_edge_recon_loss: 2611308.4846; val_gene_expr_recon_loss: 635802.4632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258775.6267; val_optim_loss: 3258775.6267
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9893; val_auprc_score: 0.9864; val_best_acc_score: 0.9576; val_best_f1_score: 0.9585; train_kl_reg_loss: 11744.5733; train_edge_recon_loss: 2588361.9400; train_gene_expr_recon_loss: 634823.6122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234930.1223; train_optim_loss: 3234930.1223; val_kl_reg_loss: 11635.8151; val_edge_recon_loss: 2611147.4281; val_gene_expr_recon_loss: 636259.6122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259042.8596; val_optim_loss: 3259042.8596
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9900; val_auprc_score: 0.9877; val_best_acc_score: 0.9586; val_best_f1_score: 0.9592; train_kl_reg_loss: 11656.0172; train_edge_recon_loss: 2588212.3083; train_gene_expr_recon_loss: 634601.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234469.9169; train_optim_loss: 3234469.9169; val_kl_reg_loss: 11279.2144; val_edge_recon_loss: 2607261.7757; val_gene_expr_recon_loss: 636326.5064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3254867.4983; val_optim_loss: 3254867.4983
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9897; val_auprc_score: 0.9870; val_best_acc_score: 0.9591; val_best_f1_score: 0.9600; train_kl_reg_loss: 11686.8096; train_edge_recon_loss: 2587119.6361; train_gene_expr_recon_loss: 633603.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232410.4392; train_optim_loss: 3232410.4392; val_kl_reg_loss: 11380.4414; val_edge_recon_loss: 2606329.9760; val_gene_expr_recon_loss: 635454.9020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253165.3031; val_optim_loss: 3253165.3031
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9899; val_auprc_score: 0.9873; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 11671.9170; train_edge_recon_loss: 2586957.6067; train_gene_expr_recon_loss: 633497.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3232126.9880; train_optim_loss: 3232126.9880; val_kl_reg_loss: 11437.7034; val_edge_recon_loss: 2606537.3699; val_gene_expr_recon_loss: 635178.4705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253153.5497; val_optim_loss: 3253153.5497
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9584; val_best_f1_score: 0.9592; train_kl_reg_loss: 11607.4640; train_edge_recon_loss: 2586892.2349; train_gene_expr_recon_loss: 633459.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231959.0082; train_optim_loss: 3231959.0082; val_kl_reg_loss: 11293.2323; val_edge_recon_loss: 2606642.6318; val_gene_expr_recon_loss: 635934.9294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3253870.7928; val_optim_loss: 3253870.7928
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9898; val_auprc_score: 0.9873; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 11617.3818; train_edge_recon_loss: 2586328.1061; train_gene_expr_recon_loss: 633278.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231224.4423; train_optim_loss: 3231224.4423; val_kl_reg_loss: 11656.1259; val_edge_recon_loss: 2604190.5925; val_gene_expr_recon_loss: 634223.6323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250070.3408; val_optim_loss: 3250070.3408
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 11569.0415; train_edge_recon_loss: 2587136.2414; train_gene_expr_recon_loss: 632848.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3231553.8666; train_optim_loss: 3231553.8666; val_kl_reg_loss: 11319.8877; val_edge_recon_loss: 2606167.6267; val_gene_expr_recon_loss: 634062.0535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3251549.5771; val_optim_loss: 3251549.5771
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9871; val_best_acc_score: 0.9600; val_best_f1_score: 0.9608; train_kl_reg_loss: 11500.0251; train_edge_recon_loss: 2586728.5375; train_gene_expr_recon_loss: 632347.1665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230575.7274; train_optim_loss: 3230575.7274; val_kl_reg_loss: 11621.6923; val_edge_recon_loss: 2603709.7997; val_gene_expr_recon_loss: 633153.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248485.0616; val_optim_loss: 3248485.0616
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9896; val_auprc_score: 0.9866; val_best_acc_score: 0.9606; val_best_f1_score: 0.9614; train_kl_reg_loss: 11508.3403; train_edge_recon_loss: 2585491.0749; train_gene_expr_recon_loss: 632266.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3229266.1984; train_optim_loss: 3229266.1984; val_kl_reg_loss: 11356.7046; val_edge_recon_loss: 2600898.0171; val_gene_expr_recon_loss: 635341.0261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247595.7466; val_optim_loss: 3247595.7466
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9872; val_best_acc_score: 0.9600; val_best_f1_score: 0.9607; train_kl_reg_loss: 11517.2369; train_edge_recon_loss: 2583570.5619; train_gene_expr_recon_loss: 632571.9708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227659.7676; train_optim_loss: 3227659.7676; val_kl_reg_loss: 11413.6845; val_edge_recon_loss: 2605260.2740; val_gene_expr_recon_loss: 633921.8181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250595.7740; val_optim_loss: 3250595.7740
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9901; val_auprc_score: 0.9873; val_best_acc_score: 0.9608; val_best_f1_score: 0.9615; train_kl_reg_loss: 11465.1108; train_edge_recon_loss: 2585182.7091; train_gene_expr_recon_loss: 632082.7836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228730.6070; train_optim_loss: 3228730.6070; val_kl_reg_loss: 11389.2567; val_edge_recon_loss: 2603789.8390; val_gene_expr_recon_loss: 634481.5552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249660.6592; val_optim_loss: 3249660.6592
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9904; val_auprc_score: 0.9876; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 11464.3009; train_edge_recon_loss: 2584574.1785; train_gene_expr_recon_loss: 631633.4087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227671.8821; train_optim_loss: 3227671.8821; val_kl_reg_loss: 11398.8712; val_edge_recon_loss: 2602635.9366; val_gene_expr_recon_loss: 633037.3536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247072.1678; val_optim_loss: 3247072.1678
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9878; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 11501.8504; train_edge_recon_loss: 2584146.5164; train_gene_expr_recon_loss: 631584.7996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227233.1621; train_optim_loss: 3227233.1621; val_kl_reg_loss: 11332.2627; val_edge_recon_loss: 2603970.4075; val_gene_expr_recon_loss: 633323.9970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248626.6695; val_optim_loss: 3248626.6695
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9902; val_auprc_score: 0.9872; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 11452.8419; train_edge_recon_loss: 2583721.4490; train_gene_expr_recon_loss: 631576.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3226750.5407; train_optim_loss: 3226750.5407; val_kl_reg_loss: 11317.5290; val_edge_recon_loss: 2603958.8322; val_gene_expr_recon_loss: 633989.5445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249265.9144; val_optim_loss: 3249265.9144
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9619; val_best_f1_score: 0.9625; train_kl_reg_loss: 11438.8300; train_edge_recon_loss: 2583155.9012; train_gene_expr_recon_loss: 631084.6435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225679.3748; train_optim_loss: 3225679.3748; val_kl_reg_loss: 11293.8367; val_edge_recon_loss: 2602383.7997; val_gene_expr_recon_loss: 634795.8373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248473.4777; val_optim_loss: 3248473.4777
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9907; val_auprc_score: 0.9882; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 11413.7110; train_edge_recon_loss: 2583245.1340; train_gene_expr_recon_loss: 631069.4555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3225728.2984; train_optim_loss: 3225728.2984; val_kl_reg_loss: 11301.0274; val_edge_recon_loss: 2603197.4914; val_gene_expr_recon_loss: 633196.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247695.3271; val_optim_loss: 3247695.3271

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9911; val_auprc_score: 0.9887; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 11646.1966; train_edge_recon_loss: 2581751.2261; train_gene_expr_recon_loss: 625638.9106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219036.3345; train_optim_loss: 3219036.3345; val_kl_reg_loss: 11501.0202; val_edge_recon_loss: 2600590.9897; val_gene_expr_recon_loss: 628634.3155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240726.3288; val_optim_loss: 3240726.3288
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9908; val_auprc_score: 0.9883; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 11728.0552; train_edge_recon_loss: 2580189.5797; train_gene_expr_recon_loss: 625071.9069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216989.5403; train_optim_loss: 3216989.5403; val_kl_reg_loss: 11532.3640; val_edge_recon_loss: 2600434.0839; val_gene_expr_recon_loss: 628335.6640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240302.1164; val_optim_loss: 3240302.1164
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9910; val_auprc_score: 0.9887; val_best_acc_score: 0.9632; val_best_f1_score: 0.9637; train_kl_reg_loss: 11723.5342; train_edge_recon_loss: 2580453.4463; train_gene_expr_recon_loss: 624789.2631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216966.2431; train_optim_loss: 3216966.2431; val_kl_reg_loss: 11583.6353; val_edge_recon_loss: 2599062.5411; val_gene_expr_recon_loss: 627828.3283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238474.5103; val_optim_loss: 3238474.5103
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9912; val_auprc_score: 0.9891; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 11742.3947; train_edge_recon_loss: 2580927.0701; train_gene_expr_recon_loss: 624640.7452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217310.2133; train_optim_loss: 3217310.2133; val_kl_reg_loss: 11519.6721; val_edge_recon_loss: 2598772.8065; val_gene_expr_recon_loss: 628176.1468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238468.6130; val_optim_loss: 3238468.6130
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 11746.0190; train_edge_recon_loss: 2580463.2188; train_gene_expr_recon_loss: 624536.5490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216745.7836; train_optim_loss: 3216745.7836; val_kl_reg_loss: 11520.0440; val_edge_recon_loss: 2600759.0548; val_gene_expr_recon_loss: 629204.2384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241483.3339; val_optim_loss: 3241483.3339
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 11716.0282; train_edge_recon_loss: 2580324.4729; train_gene_expr_recon_loss: 624185.9690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216226.4729; train_optim_loss: 3216226.4729; val_kl_reg_loss: 11487.5883; val_edge_recon_loss: 2597344.7534; val_gene_expr_recon_loss: 626804.4127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3235636.7637; val_optim_loss: 3235636.7637
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9914; val_auprc_score: 0.9890; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 11729.6312; train_edge_recon_loss: 2579537.3779; train_gene_expr_recon_loss: 624291.2055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215558.2139; train_optim_loss: 3215558.2139; val_kl_reg_loss: 11522.8982; val_edge_recon_loss: 2599348.5548; val_gene_expr_recon_loss: 626944.1922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237815.6387; val_optim_loss: 3237815.6387
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 11720.7620; train_edge_recon_loss: 2581071.0547; train_gene_expr_recon_loss: 624082.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3216874.2943; train_optim_loss: 3216874.2943; val_kl_reg_loss: 11491.6871; val_edge_recon_loss: 2599060.1096; val_gene_expr_recon_loss: 626974.7547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237526.5548; val_optim_loss: 3237526.5548
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 11682.1682; train_edge_recon_loss: 2580013.8555; train_gene_expr_recon_loss: 624122.4386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215818.4620; train_optim_loss: 3215818.4620; val_kl_reg_loss: 11444.4130; val_edge_recon_loss: 2601673.0462; val_gene_expr_recon_loss: 627986.6293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3241104.1045; val_optim_loss: 3241104.1045
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9916; val_auprc_score: 0.9895; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 11687.9871; train_edge_recon_loss: 2580114.7712; train_gene_expr_recon_loss: 623909.7681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215712.5275; train_optim_loss: 3215712.5275; val_kl_reg_loss: 11488.3549; val_edge_recon_loss: 2601445.8082; val_gene_expr_recon_loss: 626379.6552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239313.8134; val_optim_loss: 3239313.8134

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9915; val_auprc_score: 0.9893; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 11691.6494; train_edge_recon_loss: 2580194.5948; train_gene_expr_recon_loss: 623214.4689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215100.7143; train_optim_loss: 3215100.7143; val_kl_reg_loss: 11507.4414; val_edge_recon_loss: 2596887.3014; val_gene_expr_recon_loss: 626384.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3234779.4195; val_optim_loss: 3234779.4195
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9639; val_best_f1_score: 0.9645; train_kl_reg_loss: 11706.0124; train_edge_recon_loss: 2580716.6156; train_gene_expr_recon_loss: 623172.3347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215594.9597; train_optim_loss: 3215594.9597; val_kl_reg_loss: 11509.4942; val_edge_recon_loss: 2602251.3219; val_gene_expr_recon_loss: 626768.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3240529.7791; val_optim_loss: 3240529.7791
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9912; val_auprc_score: 0.9888; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 11701.8090; train_edge_recon_loss: 2580298.4771; train_gene_expr_recon_loss: 623197.4947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215197.7781; train_optim_loss: 3215197.7781; val_kl_reg_loss: 11514.6386; val_edge_recon_loss: 2600986.1062; val_gene_expr_recon_loss: 626357.5420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238858.2860; val_optim_loss: 3238858.2860
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 11699.2878; train_edge_recon_loss: 2580167.0654; train_gene_expr_recon_loss: 623326.1744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3215192.5310; train_optim_loss: 3215192.5310; val_kl_reg_loss: 11507.0319; val_edge_recon_loss: 2599237.8733; val_gene_expr_recon_loss: 626506.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3237251.5771; val_optim_loss: 3237251.5771
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9913; val_auprc_score: 0.9889; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 11710.4077; train_edge_recon_loss: 2579593.3945; train_gene_expr_recon_loss: 623334.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214638.2758; train_optim_loss: 3214638.2758; val_kl_reg_loss: 11511.0441; val_edge_recon_loss: 2600177.3305; val_gene_expr_recon_loss: 627137.3844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238825.7620; val_optim_loss: 3238825.7620

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9911; val_auprc_score: 0.9887; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 11706.2608; train_edge_recon_loss: 2578617.3289; train_gene_expr_recon_loss: 622909.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3213233.2187; train_optim_loss: 3213233.2187; val_kl_reg_loss: 11515.1424; val_edge_recon_loss: 2600487.2123; val_gene_expr_recon_loss: 626593.6259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3238595.9658; val_optim_loss: 3238595.9658
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9912; val_auprc_score: 0.9886; val_best_acc_score: 0.9636; val_best_f1_score: 0.9642; train_kl_reg_loss: 11710.0377; train_edge_recon_loss: 2579214.4622; train_gene_expr_recon_loss: 623183.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214108.4071; train_optim_loss: 3214108.4071; val_kl_reg_loss: 11519.9450; val_edge_recon_loss: 2600532.8887; val_gene_expr_recon_loss: 627327.6207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3239380.4452; val_optim_loss: 3239380.4452
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 11713.9290; train_edge_recon_loss: 2579533.6370; train_gene_expr_recon_loss: 623228.5238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214476.0898; train_optim_loss: 3214476.0898; val_kl_reg_loss: 11523.8990; val_edge_recon_loss: 2598945.0548; val_gene_expr_recon_loss: 626510.5278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236979.4795; val_optim_loss: 3236979.4795
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 11713.4122; train_edge_recon_loss: 2580056.4467; train_gene_expr_recon_loss: 623179.9804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3214949.8416; train_optim_loss: 3214949.8416; val_kl_reg_loss: 11523.5008; val_edge_recon_loss: 2598697.4024; val_gene_expr_recon_loss: 626388.8168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3236609.7175; val_optim_loss: 3236609.7175

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 262 min 56 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9913
Val AUPRC score: 0.9889
Val best accuracy score: 0.9642
Val best F1 score: 0.9648
Val gene expr MSE score: 1.5018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
