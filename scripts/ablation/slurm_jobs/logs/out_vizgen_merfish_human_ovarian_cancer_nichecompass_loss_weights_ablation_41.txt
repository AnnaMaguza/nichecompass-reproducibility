None
Run timestamp: 17072023_202111_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9728; val_auprc_score: 0.9725; val_best_acc_score: 0.9146; val_best_f1_score: 0.9156; train_kl_reg_loss: 12294.0587; train_edge_recon_loss: 2771599.5486; train_gene_expr_recon_loss: 21370471.6843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24154365.2953; train_optim_loss: 24154365.2953; val_kl_reg_loss: 15061.7920; val_edge_recon_loss: 2741723.2568; val_gene_expr_recon_loss: 20362691.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23119476.3818; val_optim_loss: 23119476.3818
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9742; val_auprc_score: 0.9736; val_best_acc_score: 0.9178; val_best_f1_score: 0.9186; train_kl_reg_loss: 15164.9338; train_edge_recon_loss: 2667417.8358; train_gene_expr_recon_loss: 19842093.6843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22524676.4399; train_optim_loss: 22524676.4399; val_kl_reg_loss: 15948.7306; val_edge_recon_loss: 2744060.9250; val_gene_expr_recon_loss: 19468145.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22228154.9091; val_optim_loss: 22228154.9091
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9747; val_auprc_score: 0.9739; val_best_acc_score: 0.9191; val_best_f1_score: 0.9201; train_kl_reg_loss: 15447.5373; train_edge_recon_loss: 2658530.7169; train_gene_expr_recon_loss: 19203642.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21877620.9756; train_optim_loss: 21877620.9756; val_kl_reg_loss: 15286.1295; val_edge_recon_loss: 2725471.3182; val_gene_expr_recon_loss: 19133265.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21874022.7273; val_optim_loss: 21874022.7273
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9746; val_auprc_score: 0.9725; val_best_acc_score: 0.9186; val_best_f1_score: 0.9202; train_kl_reg_loss: 15528.1037; train_edge_recon_loss: 2653335.5929; train_gene_expr_recon_loss: 18898210.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21567073.9185; train_optim_loss: 21567073.9185; val_kl_reg_loss: 15829.7252; val_edge_recon_loss: 2728121.8955; val_gene_expr_recon_loss: 18865250.6545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21609202.4000; val_optim_loss: 21609202.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9728; val_auprc_score: 0.9712; val_best_acc_score: 0.9156; val_best_f1_score: 0.9172; train_kl_reg_loss: 15696.5071; train_edge_recon_loss: 2647196.2480; train_gene_expr_recon_loss: 18738874.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21401767.3788; train_optim_loss: 21401767.3788; val_kl_reg_loss: 15524.9454; val_edge_recon_loss: 2718572.0364; val_gene_expr_recon_loss: 18764668.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21498765.7818; val_optim_loss: 21498765.7818
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9745; val_auprc_score: 0.9731; val_best_acc_score: 0.9186; val_best_f1_score: 0.9200; train_kl_reg_loss: 15777.7724; train_edge_recon_loss: 2644071.0435; train_gene_expr_recon_loss: 18658045.6130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21317894.4358; train_optim_loss: 21317894.4358; val_kl_reg_loss: 15532.1210; val_edge_recon_loss: 2712533.4909; val_gene_expr_recon_loss: 18691887.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21419953.1818; val_optim_loss: 21419953.1818
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9748; val_auprc_score: 0.9730; val_best_acc_score: 0.9185; val_best_f1_score: 0.9201; train_kl_reg_loss: 15814.9581; train_edge_recon_loss: 2639974.4623; train_gene_expr_recon_loss: 18598988.5071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21254777.9348; train_optim_loss: 21254777.9348; val_kl_reg_loss: 15284.8268; val_edge_recon_loss: 2705495.6909; val_gene_expr_recon_loss: 18653092.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21373873.6000; val_optim_loss: 21373873.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9756; val_auprc_score: 0.9742; val_best_acc_score: 0.9205; val_best_f1_score: 0.9222; train_kl_reg_loss: 15839.0963; train_edge_recon_loss: 2637924.4717; train_gene_expr_recon_loss: 18566494.8615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21220258.4094; train_optim_loss: 21220258.4094; val_kl_reg_loss: 15485.8094; val_edge_recon_loss: 2702923.0841; val_gene_expr_recon_loss: 18645270.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21363679.4182; val_optim_loss: 21363679.4182
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9757; val_auprc_score: 0.9740; val_best_acc_score: 0.9209; val_best_f1_score: 0.9218; train_kl_reg_loss: 15869.7263; train_edge_recon_loss: 2635388.2322; train_gene_expr_recon_loss: 18545773.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21197031.1772; train_optim_loss: 21197031.1772; val_kl_reg_loss: 15383.3559; val_edge_recon_loss: 2705650.6205; val_gene_expr_recon_loss: 18645722.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21366755.9455; val_optim_loss: 21366755.9455
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9765; val_auprc_score: 0.9749; val_best_acc_score: 0.9229; val_best_f1_score: 0.9237; train_kl_reg_loss: 15847.2360; train_edge_recon_loss: 2635103.6713; train_gene_expr_recon_loss: 18526535.9857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21177486.8473; train_optim_loss: 21177486.8473; val_kl_reg_loss: 15631.4126; val_edge_recon_loss: 2700239.6682; val_gene_expr_recon_loss: 18619759.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21335630.5636; val_optim_loss: 21335630.5636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9766; val_auprc_score: 0.9748; val_best_acc_score: 0.9229; val_best_f1_score: 0.9239; train_kl_reg_loss: 15840.9497; train_edge_recon_loss: 2632928.5522; train_gene_expr_recon_loss: 18513061.7678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21161831.2505; train_optim_loss: 21161831.2505; val_kl_reg_loss: 15799.7005; val_edge_recon_loss: 2694121.0205; val_gene_expr_recon_loss: 18575143.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21285064.3091; val_optim_loss: 21285064.3091
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9763; val_auprc_score: 0.9745; val_best_acc_score: 0.9230; val_best_f1_score: 0.9240; train_kl_reg_loss: 15828.5233; train_edge_recon_loss: 2631655.0932; train_gene_expr_recon_loss: 18506551.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21154034.9715; train_optim_loss: 21154034.9715; val_kl_reg_loss: 15555.6169; val_edge_recon_loss: 2697488.0432; val_gene_expr_recon_loss: 18592989.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21306032.9273; val_optim_loss: 21306032.9273
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9759; val_auprc_score: 0.9738; val_best_acc_score: 0.9221; val_best_f1_score: 0.9232; train_kl_reg_loss: 15836.6159; train_edge_recon_loss: 2630918.1069; train_gene_expr_recon_loss: 18494452.0081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21141206.7475; train_optim_loss: 21141206.7475; val_kl_reg_loss: 15654.5254; val_edge_recon_loss: 2696693.9614; val_gene_expr_recon_loss: 18602485.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21314833.9636; val_optim_loss: 21314833.9636
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9774; val_auprc_score: 0.9758; val_best_acc_score: 0.9235; val_best_f1_score: 0.9245; train_kl_reg_loss: 15830.8099; train_edge_recon_loss: 2630341.3450; train_gene_expr_recon_loss: 18495075.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21141247.9776; train_optim_loss: 21141247.9776; val_kl_reg_loss: 15765.9323; val_edge_recon_loss: 2691542.2455; val_gene_expr_recon_loss: 18581445.3091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21288753.4909; val_optim_loss: 21288753.4909
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9769; val_auprc_score: 0.9749; val_best_acc_score: 0.9237; val_best_f1_score: 0.9245; train_kl_reg_loss: 15817.1254; train_edge_recon_loss: 2626964.0446; train_gene_expr_recon_loss: 18491208.4603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21133989.6212; train_optim_loss: 21133989.6212; val_kl_reg_loss: 15585.7436; val_edge_recon_loss: 2690120.6432; val_gene_expr_recon_loss: 18582000.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21287707.3091; val_optim_loss: 21287707.3091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9762; val_auprc_score: 0.9745; val_best_acc_score: 0.9226; val_best_f1_score: 0.9234; train_kl_reg_loss: 16160.1235; train_edge_recon_loss: 2618326.0458; train_gene_expr_recon_loss: 18319805.3422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20954291.5010; train_optim_loss: 20954291.5010; val_kl_reg_loss: 15240.8501; val_edge_recon_loss: 2685820.1886; val_gene_expr_recon_loss: 18426119.2545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21127180.3455; val_optim_loss: 21127180.3455
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9763; val_auprc_score: 0.9743; val_best_acc_score: 0.9223; val_best_f1_score: 0.9234; train_kl_reg_loss: 15421.7202; train_edge_recon_loss: 2616999.6454; train_gene_expr_recon_loss: 18296475.4969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20928896.8717; train_optim_loss: 20928896.8717; val_kl_reg_loss: 15100.1761; val_edge_recon_loss: 2676837.8545; val_gene_expr_recon_loss: 18414053.2909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21105991.3273; val_optim_loss: 21105991.3273
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9774; val_auprc_score: 0.9760; val_best_acc_score: 0.9239; val_best_f1_score: 0.9249; train_kl_reg_loss: 15358.1712; train_edge_recon_loss: 2616644.0285; train_gene_expr_recon_loss: 18292847.0183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20924849.2240; train_optim_loss: 20924849.2240; val_kl_reg_loss: 15094.2128; val_edge_recon_loss: 2675115.3114; val_gene_expr_recon_loss: 18420858.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21111068.2182; val_optim_loss: 21111068.2182
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9775; val_auprc_score: 0.9755; val_best_acc_score: 0.9245; val_best_f1_score: 0.9254; train_kl_reg_loss: 15338.6950; train_edge_recon_loss: 2613945.5682; train_gene_expr_recon_loss: 18288099.1487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20917383.4073; train_optim_loss: 20917383.4073; val_kl_reg_loss: 15072.4265; val_edge_recon_loss: 2669377.9841; val_gene_expr_recon_loss: 18392099.9455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21076550.3455; val_optim_loss: 21076550.3455
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9770; val_auprc_score: 0.9753; val_best_acc_score: 0.9234; val_best_f1_score: 0.9244; train_kl_reg_loss: 15336.8587; train_edge_recon_loss: 2614271.3360; train_gene_expr_recon_loss: 18282722.8493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20912331.0489; train_optim_loss: 20912331.0489; val_kl_reg_loss: 15065.5718; val_edge_recon_loss: 2676128.6886; val_gene_expr_recon_loss: 18424779.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21115973.5455; val_optim_loss: 21115973.5455
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9770; val_auprc_score: 0.9753; val_best_acc_score: 0.9243; val_best_f1_score: 0.9252; train_kl_reg_loss: 15348.1251; train_edge_recon_loss: 2614537.4638; train_gene_expr_recon_loss: 18287616.3666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20917501.9369; train_optim_loss: 20917501.9369; val_kl_reg_loss: 15091.8191; val_edge_recon_loss: 2674284.4295; val_gene_expr_recon_loss: 18412224.1636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21101600.3818; val_optim_loss: 21101600.3818
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9767; val_auprc_score: 0.9748; val_best_acc_score: 0.9232; val_best_f1_score: 0.9240; train_kl_reg_loss: 15352.9938; train_edge_recon_loss: 2613203.2161; train_gene_expr_recon_loss: 18279352.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20907909.1629; train_optim_loss: 20907909.1629; val_kl_reg_loss: 15046.3353; val_edge_recon_loss: 2677068.3114; val_gene_expr_recon_loss: 18420861.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21112975.8182; val_optim_loss: 21112975.8182
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9773; val_auprc_score: 0.9757; val_best_acc_score: 0.9236; val_best_f1_score: 0.9250; train_kl_reg_loss: 15353.3200; train_edge_recon_loss: 2611260.0418; train_gene_expr_recon_loss: 18283463.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20910077.0244; train_optim_loss: 20910077.0244; val_kl_reg_loss: 15081.5328; val_edge_recon_loss: 2670746.0023; val_gene_expr_recon_loss: 18413609.8909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21099437.4909; val_optim_loss: 21099437.4909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9771; val_auprc_score: 0.9749; val_best_acc_score: 0.9242; val_best_f1_score: 0.9252; train_kl_reg_loss: 15464.4289; train_edge_recon_loss: 2610367.0272; train_gene_expr_recon_loss: 18258296.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20884128.2138; train_optim_loss: 20884128.2138; val_kl_reg_loss: 15201.7580; val_edge_recon_loss: 2666982.2705; val_gene_expr_recon_loss: 18385726.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21067910.9818; val_optim_loss: 21067910.9818
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9773; val_auprc_score: 0.9756; val_best_acc_score: 0.9241; val_best_f1_score: 0.9251; train_kl_reg_loss: 15480.7167; train_edge_recon_loss: 2609370.1612; train_gene_expr_recon_loss: 18259861.2933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20884712.1711; train_optim_loss: 20884712.1711; val_kl_reg_loss: 15130.6540; val_edge_recon_loss: 2673180.8386; val_gene_expr_recon_loss: 18395985.2909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21084296.7818; val_optim_loss: 21084296.7818
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9773; val_auprc_score: 0.9757; val_best_acc_score: 0.9239; val_best_f1_score: 0.9249; train_kl_reg_loss: 15436.2191; train_edge_recon_loss: 2611450.7693; train_gene_expr_recon_loss: 18248899.4562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20875786.5010; train_optim_loss: 20875786.5010; val_kl_reg_loss: 15121.1322; val_edge_recon_loss: 2671374.7545; val_gene_expr_recon_loss: 18401615.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21088111.1273; val_optim_loss: 21088111.1273
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9775; val_auprc_score: 0.9756; val_best_acc_score: 0.9246; val_best_f1_score: 0.9256; train_kl_reg_loss: 15420.0386; train_edge_recon_loss: 2611403.3686; train_gene_expr_recon_loss: 18248883.1344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20875706.5275; train_optim_loss: 20875706.5275; val_kl_reg_loss: 15118.3102; val_edge_recon_loss: 2669534.2818; val_gene_expr_recon_loss: 18388341.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21072994.3455; val_optim_loss: 21072994.3455
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9774; val_auprc_score: 0.9759; val_best_acc_score: 0.9241; val_best_f1_score: 0.9250; train_kl_reg_loss: 15400.0608; train_edge_recon_loss: 2610798.8941; train_gene_expr_recon_loss: 18246436.1324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20872635.0387; train_optim_loss: 20872635.0387; val_kl_reg_loss: 15086.1230; val_edge_recon_loss: 2670278.6341; val_gene_expr_recon_loss: 18382841.3818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21068206.0545; val_optim_loss: 21068206.0545

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9771; val_auprc_score: 0.9751; val_best_acc_score: 0.9247; val_best_f1_score: 0.9254; train_kl_reg_loss: 15380.5708; train_edge_recon_loss: 2611936.8699; train_gene_expr_recon_loss: 18245018.5947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20872336.0081; train_optim_loss: 20872336.0081; val_kl_reg_loss: 15074.6811; val_edge_recon_loss: 2666572.4886; val_gene_expr_recon_loss: 18396219.1273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21077866.3455; val_optim_loss: 21077866.3455
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9775; val_auprc_score: 0.9759; val_best_acc_score: 0.9245; val_best_f1_score: 0.9251; train_kl_reg_loss: 15385.1584; train_edge_recon_loss: 2610942.2851; train_gene_expr_recon_loss: 18252858.8208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20879186.2648; train_optim_loss: 20879186.2648; val_kl_reg_loss: 15087.3680; val_edge_recon_loss: 2667683.8045; val_gene_expr_recon_loss: 18402941.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21085712.6000; val_optim_loss: 21085712.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9778; val_auprc_score: 0.9760; val_best_acc_score: 0.9253; val_best_f1_score: 0.9262; train_kl_reg_loss: 15387.8487; train_edge_recon_loss: 2609593.9679; train_gene_expr_recon_loss: 18247854.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20872836.4297; train_optim_loss: 20872836.4297; val_kl_reg_loss: 15082.9971; val_edge_recon_loss: 2663598.1318; val_gene_expr_recon_loss: 18399096.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21077778.0364; val_optim_loss: 21077778.0364
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9780; val_auprc_score: 0.9763; val_best_acc_score: 0.9252; val_best_f1_score: 0.9261; train_kl_reg_loss: 15387.1149; train_edge_recon_loss: 2610062.0720; train_gene_expr_recon_loss: 18243146.8941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20868596.0407; train_optim_loss: 20868596.0407; val_kl_reg_loss: 15078.8068; val_edge_recon_loss: 2662397.0659; val_gene_expr_recon_loss: 18370833.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21048309.2000; val_optim_loss: 21048309.2000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9775; val_auprc_score: 0.9756; val_best_acc_score: 0.9248; val_best_f1_score: 0.9256; train_kl_reg_loss: 15391.1874; train_edge_recon_loss: 2610801.7632; train_gene_expr_recon_loss: 18249773.1222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20875966.0652; train_optim_loss: 20875966.0652; val_kl_reg_loss: 15089.3914; val_edge_recon_loss: 2667580.6273; val_gene_expr_recon_loss: 18398993.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21081663.7273; val_optim_loss: 21081663.7273
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9773; val_auprc_score: 0.9756; val_best_acc_score: 0.9244; val_best_f1_score: 0.9250; train_kl_reg_loss: 15392.9448; train_edge_recon_loss: 2611063.3409; train_gene_expr_recon_loss: 18247284.1731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20873740.4420; train_optim_loss: 20873740.4420; val_kl_reg_loss: 15094.2880; val_edge_recon_loss: 2668966.7182; val_gene_expr_recon_loss: 18402198.7091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21086259.7455; val_optim_loss: 21086259.7455
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9771; val_auprc_score: 0.9751; val_best_acc_score: 0.9244; val_best_f1_score: 0.9252; train_kl_reg_loss: 15393.8635; train_edge_recon_loss: 2610225.0924; train_gene_expr_recon_loss: 18251793.4134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20877412.3747; train_optim_loss: 20877412.3747; val_kl_reg_loss: 15086.5680; val_edge_recon_loss: 2668918.5023; val_gene_expr_recon_loss: 18397574.2545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21081579.3455; val_optim_loss: 21081579.3455
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9774; val_auprc_score: 0.9754; val_best_acc_score: 0.9244; val_best_f1_score: 0.9252; train_kl_reg_loss: 15393.0794; train_edge_recon_loss: 2610869.8893; train_gene_expr_recon_loss: 18246200.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20872463.8147; train_optim_loss: 20872463.8147; val_kl_reg_loss: 15082.8439; val_edge_recon_loss: 2666471.5477; val_gene_expr_recon_loss: 18376737.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21058291.5091; val_optim_loss: 21058291.5091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9773; val_auprc_score: 0.9756; val_best_acc_score: 0.9242; val_best_f1_score: 0.9251; train_kl_reg_loss: 15392.6037; train_edge_recon_loss: 2610504.8854; train_gene_expr_recon_loss: 18249142.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20875039.7332; train_optim_loss: 20875039.7332; val_kl_reg_loss: 15084.9140; val_edge_recon_loss: 2669625.2295; val_gene_expr_recon_loss: 18378812.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21063522.3818; val_optim_loss: 21063522.3818
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9776; val_auprc_score: 0.9756; val_best_acc_score: 0.9253; val_best_f1_score: 0.9262; train_kl_reg_loss: 15393.6239; train_edge_recon_loss: 2612497.7480; train_gene_expr_recon_loss: 18250461.8595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20878353.2118; train_optim_loss: 20878353.2118; val_kl_reg_loss: 15089.4597; val_edge_recon_loss: 2668357.6386; val_gene_expr_recon_loss: 18389857.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21073304.4364; val_optim_loss: 21073304.4364
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9774; val_auprc_score: 0.9755; val_best_acc_score: 0.9240; val_best_f1_score: 0.9250; train_kl_reg_loss: 15394.5584; train_edge_recon_loss: 2609692.7350; train_gene_expr_recon_loss: 18246247.4582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20871334.7373; train_optim_loss: 20871334.7373; val_kl_reg_loss: 15082.9630; val_edge_recon_loss: 2667056.4159; val_gene_expr_recon_loss: 18398970.2909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21081109.6182; val_optim_loss: 21081109.6182
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9775; val_auprc_score: 0.9757; val_best_acc_score: 0.9249; val_best_f1_score: 0.9258; train_kl_reg_loss: 15393.2366; train_edge_recon_loss: 2611105.8821; train_gene_expr_recon_loss: 18253825.3096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20880324.4257; train_optim_loss: 20880324.4257; val_kl_reg_loss: 15082.0353; val_edge_recon_loss: 2667665.8977; val_gene_expr_recon_loss: 18376091.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21058839.1818; val_optim_loss: 21058839.1818

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 112 min 7 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9772
Val AUPRC score: 0.9753
Val best accuracy score: 0.9241
Val best F1 score: 0.9251
Val gene expr MSE score: 8.4589

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
