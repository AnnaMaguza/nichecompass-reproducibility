None
Run timestamp: 03082023_225054_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9945; val_auprc_score: 0.9941; val_best_acc_score: 0.9663; val_best_f1_score: 0.9666; train_kl_reg_loss: 7106.7120; train_edge_recon_loss: 266144.4296; train_gene_expr_recon_loss: 186170.2163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 459421.3577; train_optim_loss: 459421.3577; val_kl_reg_loss: 6705.6074; val_edge_recon_loss: 261675.4514; val_gene_expr_recon_loss: 172812.4833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441193.5421; val_optim_loss: 441193.5421
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9961; val_auprc_score: 0.9958; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 6761.4394; train_edge_recon_loss: 260415.5095; train_gene_expr_recon_loss: 169030.7752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436207.7240; train_optim_loss: 436207.7240; val_kl_reg_loss: 6980.9737; val_edge_recon_loss: 260134.4981; val_gene_expr_recon_loss: 166742.5575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433858.0295; val_optim_loss: 433858.0295
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 6897.7513; train_edge_recon_loss: 259384.2422; train_gene_expr_recon_loss: 164876.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431158.2543; train_optim_loss: 431158.2543; val_kl_reg_loss: 6859.9891; val_edge_recon_loss: 259750.5669; val_gene_expr_recon_loss: 163336.2301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 429946.7865; val_optim_loss: 429946.7865
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9780; val_best_f1_score: 0.9781; train_kl_reg_loss: 6999.2120; train_edge_recon_loss: 258884.2991; train_gene_expr_recon_loss: 162186.3626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428069.8737; train_optim_loss: 428069.8737; val_kl_reg_loss: 7173.7340; val_edge_recon_loss: 259070.8978; val_gene_expr_recon_loss: 161271.9080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427516.5392; val_optim_loss: 427516.5392
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 7070.1809; train_edge_recon_loss: 258634.6005; train_gene_expr_recon_loss: 160254.9263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 425959.7074; train_optim_loss: 425959.7074; val_kl_reg_loss: 7223.0157; val_edge_recon_loss: 258946.7913; val_gene_expr_recon_loss: 159568.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 425738.6450; val_optim_loss: 425738.6450
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 7108.3424; train_edge_recon_loss: 258495.6909; train_gene_expr_recon_loss: 158803.9904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 424408.0237; train_optim_loss: 424408.0237; val_kl_reg_loss: 6825.3064; val_edge_recon_loss: 259255.4136; val_gene_expr_recon_loss: 158381.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 424461.9927; val_optim_loss: 424461.9927
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 7133.8522; train_edge_recon_loss: 258243.7593; train_gene_expr_recon_loss: 157828.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 423206.2624; train_optim_loss: 423206.2624; val_kl_reg_loss: 7323.1232; val_edge_recon_loss: 258600.8182; val_gene_expr_recon_loss: 157891.6357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 423815.5772; val_optim_loss: 423815.5772
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 7153.1912; train_edge_recon_loss: 258151.5531; train_gene_expr_recon_loss: 157019.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 422324.0757; train_optim_loss: 422324.0757; val_kl_reg_loss: 7252.9129; val_edge_recon_loss: 258431.4491; val_gene_expr_recon_loss: 156536.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 422221.0024; val_optim_loss: 422221.0024
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9963; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 7170.6273; train_edge_recon_loss: 258043.7497; train_gene_expr_recon_loss: 156341.8226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 421556.1997; train_optim_loss: 421556.1997; val_kl_reg_loss: 7155.2503; val_edge_recon_loss: 258156.6507; val_gene_expr_recon_loss: 156242.4905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 421554.3917; val_optim_loss: 421554.3917
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 7180.8510; train_edge_recon_loss: 257899.9133; train_gene_expr_recon_loss: 155825.5829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 420906.3470; train_optim_loss: 420906.3470; val_kl_reg_loss: 7077.0040; val_edge_recon_loss: 258325.7999; val_gene_expr_recon_loss: 155928.2401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 421331.0439; val_optim_loss: 421331.0439
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 7190.2725; train_edge_recon_loss: 257850.0994; train_gene_expr_recon_loss: 155305.3849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 420345.7571; train_optim_loss: 420345.7571; val_kl_reg_loss: 7223.2018; val_edge_recon_loss: 258706.8791; val_gene_expr_recon_loss: 155069.6399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420999.7214; val_optim_loss: 420999.7214
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 7197.9635; train_edge_recon_loss: 257755.1842; train_gene_expr_recon_loss: 154923.6488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 419876.7965; train_optim_loss: 419876.7965; val_kl_reg_loss: 7058.7303; val_edge_recon_loss: 258322.0108; val_gene_expr_recon_loss: 154951.2881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420332.0287; val_optim_loss: 420332.0287
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 7199.4998; train_edge_recon_loss: 257709.7940; train_gene_expr_recon_loss: 154658.1455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 419567.4391; train_optim_loss: 419567.4391; val_kl_reg_loss: 7333.5766; val_edge_recon_loss: 257723.8383; val_gene_expr_recon_loss: 154770.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 419827.4480; val_optim_loss: 419827.4480
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 7205.5533; train_edge_recon_loss: 257581.2933; train_gene_expr_recon_loss: 154396.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 419183.7854; train_optim_loss: 419183.7854; val_kl_reg_loss: 7164.3249; val_edge_recon_loss: 258264.6366; val_gene_expr_recon_loss: 154357.3721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 419786.3337; val_optim_loss: 419786.3337
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 7212.1049; train_edge_recon_loss: 257553.5243; train_gene_expr_recon_loss: 154146.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 418911.7538; train_optim_loss: 418911.7538; val_kl_reg_loss: 6975.6351; val_edge_recon_loss: 257919.7575; val_gene_expr_recon_loss: 154193.6153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 419089.0086; val_optim_loss: 419089.0086
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 7210.7044; train_edge_recon_loss: 257483.8300; train_gene_expr_recon_loss: 153877.7429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 418572.2775; train_optim_loss: 418572.2775; val_kl_reg_loss: 7024.4687; val_edge_recon_loss: 257769.0657; val_gene_expr_recon_loss: 153861.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 418654.8303; val_optim_loss: 418654.8303
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 7210.7941; train_edge_recon_loss: 257434.4045; train_gene_expr_recon_loss: 153737.0099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 418382.2085; train_optim_loss: 418382.2085; val_kl_reg_loss: 7187.7279; val_edge_recon_loss: 257637.3618; val_gene_expr_recon_loss: 154368.7857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 419193.8758; val_optim_loss: 419193.8758
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 7214.1135; train_edge_recon_loss: 257371.1815; train_gene_expr_recon_loss: 153555.1844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 418140.4794; train_optim_loss: 418140.4794; val_kl_reg_loss: 7109.3633; val_edge_recon_loss: 257652.5063; val_gene_expr_recon_loss: 153596.7933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 418358.6621; val_optim_loss: 418358.6621
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 7215.6009; train_edge_recon_loss: 257346.4045; train_gene_expr_recon_loss: 153417.4745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 417979.4800; train_optim_loss: 417979.4800; val_kl_reg_loss: 7272.9189; val_edge_recon_loss: 257596.4704; val_gene_expr_recon_loss: 153702.8192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 418572.2087; val_optim_loss: 418572.2087
