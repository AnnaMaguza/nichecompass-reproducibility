None
Run timestamp: 04072023_092738_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9906; val_auprc_score: 0.9915; val_best_acc_score: 0.9534; val_best_f1_score: 0.9530; train_kl_reg_loss: 3004.4309; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 215850.3451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218854.7759; train_optim_loss: 218854.7759; val_kl_reg_loss: 3384.9650; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 205342.4559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208727.4208; val_optim_loss: 208727.4208
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9925; val_auprc_score: 0.9933; val_best_acc_score: 0.9593; val_best_f1_score: 0.9589; train_kl_reg_loss: 3387.7536; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 205189.2398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208576.9936; train_optim_loss: 208576.9936; val_kl_reg_loss: 3410.1620; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 202945.1106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206355.2721; val_optim_loss: 206355.2721
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9940; val_auprc_score: 0.9945; val_best_acc_score: 0.9638; val_best_f1_score: 0.9636; train_kl_reg_loss: 3380.6381; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 203685.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207066.3896; train_optim_loss: 207066.3896; val_kl_reg_loss: 3455.9473; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 201473.2818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204929.2294; val_optim_loss: 204929.2294
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9948; val_auprc_score: 0.9953; val_best_acc_score: 0.9672; val_best_f1_score: 0.9669; train_kl_reg_loss: 3347.2261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 202750.5864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206097.8127; train_optim_loss: 206097.8127; val_kl_reg_loss: 3287.3810; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 201283.8784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204571.2595; val_optim_loss: 204571.2595
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9949; val_auprc_score: 0.9954; val_best_acc_score: 0.9674; val_best_f1_score: 0.9670; train_kl_reg_loss: 3325.5570; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 194652.5231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197978.0800; train_optim_loss: 197978.0800; val_kl_reg_loss: 3276.1171; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 181830.0064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185106.1240; val_optim_loss: 185106.1240
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9954; val_auprc_score: 0.9958; val_best_acc_score: 0.9697; val_best_f1_score: 0.9695; train_kl_reg_loss: 3315.3476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 164464.5311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167779.8786; train_optim_loss: 167779.8786; val_kl_reg_loss: 3360.6201; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 153961.4933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157322.1132; val_optim_loss: 157322.1132
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9956; val_auprc_score: 0.9960; val_best_acc_score: 0.9703; val_best_f1_score: 0.9700; train_kl_reg_loss: 3308.8389; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 140866.7914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144175.6303; train_optim_loss: 144175.6303; val_kl_reg_loss: 3264.2489; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 138490.8037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141755.0528; val_optim_loss: 141755.0528
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9966; val_best_acc_score: 0.9738; val_best_f1_score: 0.9736; train_kl_reg_loss: 3304.4509; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 138599.5261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141903.9771; train_optim_loss: 141903.9771; val_kl_reg_loss: 3167.1744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 144562.7844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147729.9584; val_optim_loss: 147729.9584
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9966; val_best_acc_score: 0.9732; val_best_f1_score: 0.9731; train_kl_reg_loss: 3299.3518; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 137665.9578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140965.3094; train_optim_loss: 140965.3094; val_kl_reg_loss: 3419.3712; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 139215.9856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142635.3568; val_optim_loss: 142635.3568
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9967; val_best_acc_score: 0.9739; val_best_f1_score: 0.9737; train_kl_reg_loss: 3294.2180; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 137246.0873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140540.3054; train_optim_loss: 140540.3054; val_kl_reg_loss: 3148.3058; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 136593.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139741.5440; val_optim_loss: 139741.5440
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9968; val_best_acc_score: 0.9748; val_best_f1_score: 0.9746; train_kl_reg_loss: 3294.7261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136903.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140197.7663; train_optim_loss: 140197.7663; val_kl_reg_loss: 3175.2572; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135740.8313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138916.0880; val_optim_loss: 138916.0880
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9972; val_auprc_score: 0.9973; val_best_acc_score: 0.9779; val_best_f1_score: 0.9779; train_kl_reg_loss: 3291.2058; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136654.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139946.0093; train_optim_loss: 139946.0093; val_kl_reg_loss: 3445.7572; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 136864.1490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140309.9064; val_optim_loss: 140309.9064
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9974; val_best_acc_score: 0.9778; val_best_f1_score: 0.9778; train_kl_reg_loss: 3293.0044; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136518.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139811.9902; train_optim_loss: 139811.9902; val_kl_reg_loss: 3143.1507; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 134662.5585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137805.7093; val_optim_loss: 137805.7093
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9971; val_best_acc_score: 0.9764; val_best_f1_score: 0.9763; train_kl_reg_loss: 3286.2762; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136311.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139598.2329; train_optim_loss: 139598.2329; val_kl_reg_loss: 3485.1705; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 136766.2542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140251.4249; val_optim_loss: 140251.4249
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9974; val_best_acc_score: 0.9779; val_best_f1_score: 0.9778; train_kl_reg_loss: 3286.2139; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136199.2793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139485.4932; train_optim_loss: 139485.4932; val_kl_reg_loss: 3065.7696; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 134667.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137732.9531; val_optim_loss: 137732.9531
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9973; val_best_acc_score: 0.9777; val_best_f1_score: 0.9775; train_kl_reg_loss: 3281.7953; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136108.1730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139389.9682; train_optim_loss: 139389.9682; val_kl_reg_loss: 3342.5069; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 136327.2400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139669.7469; val_optim_loss: 139669.7469
