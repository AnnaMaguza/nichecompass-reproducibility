Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9989; val_auprc_score: 0.9990; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 935.6753; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134652.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135587.6784; train_optim_loss: 135587.6784; val_kl_reg_loss: 906.6189; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135201.7646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136108.3836; val_optim_loss: 136108.3836
None
Run timestamp: 04072023_223556_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9683; val_auprc_score: 0.9726; val_best_acc_score: 0.9025; val_best_f1_score: 0.9001; train_kl_reg_loss: 3160.3461; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 138504.0483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141664.3944; train_optim_loss: 141664.3944; val_kl_reg_loss: 2211.7250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130834.1479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133045.8730; val_optim_loss: 133045.8730
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9990; val_auprc_score: 0.9990; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 893.5138; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134590.9311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135484.4449; train_optim_loss: 135484.4449; val_kl_reg_loss: 880.3994; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135442.1478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136322.5473; val_optim_loss: 136322.5473
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9720; val_auprc_score: 0.9758; val_best_acc_score: 0.9123; val_best_f1_score: 0.9092; train_kl_reg_loss: 2121.7029; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 130378.3779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132500.0808; train_optim_loss: 132500.0808; val_kl_reg_loss: 1984.2912; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 129017.8606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131002.1518; val_optim_loss: 131002.1518
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9739; val_auprc_score: 0.9777; val_best_acc_score: 0.9127; val_best_f1_score: 0.9126; train_kl_reg_loss: 1983.0094; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 129344.9669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131327.9763; train_optim_loss: 131327.9763; val_kl_reg_loss: 1999.2629; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 128555.0238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130554.2869; val_optim_loss: 130554.2869
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 873.2643; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134552.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135425.6482; train_optim_loss: 135425.6482; val_kl_reg_loss: 864.8612; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135453.3155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136318.1771; val_optim_loss: 136318.1771
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9767; val_auprc_score: 0.9802; val_best_acc_score: 0.9225; val_best_f1_score: 0.9205; train_kl_reg_loss: 1932.4784; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128584.7445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130517.2230; train_optim_loss: 130517.2230; val_kl_reg_loss: 1896.7279; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130117.4314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132014.1593; val_optim_loss: 132014.1593
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9990; val_auprc_score: 0.9990; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 863.4833; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134521.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135384.7796; train_optim_loss: 135384.7796; val_kl_reg_loss: 855.2140; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135234.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136089.7385; val_optim_loss: 136089.7385
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9788; val_auprc_score: 0.9818; val_best_acc_score: 0.9250; val_best_f1_score: 0.9245; train_kl_reg_loss: 1905.5992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125536.5780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127442.1772; train_optim_loss: 127442.1772; val_kl_reg_loss: 1842.5614; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 121238.2285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123080.7897; val_optim_loss: 123080.7897
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9788; val_auprc_score: 0.9821; val_best_acc_score: 0.9272; val_best_f1_score: 0.9253; train_kl_reg_loss: 1887.3748; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116453.4136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118340.7884; train_optim_loss: 118340.7884; val_kl_reg_loss: 1834.6470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 114429.0652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116263.7123; val_optim_loss: 116263.7123
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 858.9667; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134498.1590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135357.1256; train_optim_loss: 135357.1256; val_kl_reg_loss: 852.3124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135067.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135919.7869; val_optim_loss: 135919.7869
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9806; val_auprc_score: 0.9836; val_best_acc_score: 0.9296; val_best_f1_score: 0.9287; train_kl_reg_loss: 1877.5501; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 109594.0452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 111471.5953; train_optim_loss: 111471.5953; val_kl_reg_loss: 1840.5091; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 108328.6156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 110169.1246; val_optim_loss: 110169.1246
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9991; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 855.5977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134477.3677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135332.9654; train_optim_loss: 135332.9654; val_kl_reg_loss: 849.4260; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 134805.9637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135655.3897; val_optim_loss: 135655.3897
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9819; val_auprc_score: 0.9846; val_best_acc_score: 0.9345; val_best_f1_score: 0.9327; train_kl_reg_loss: 1869.9568; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 108461.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 110331.8307; train_optim_loss: 110331.8307; val_kl_reg_loss: 1792.2385; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 108080.2505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109872.4890; val_optim_loss: 109872.4890
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9822; val_auprc_score: 0.9849; val_best_acc_score: 0.9339; val_best_f1_score: 0.9316; train_kl_reg_loss: 1862.9189; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 108117.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109980.8023; train_optim_loss: 109980.8023; val_kl_reg_loss: 1774.7775; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 108037.5169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109812.2944; val_optim_loss: 109812.2944
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9990; val_auprc_score: 0.9991; val_best_acc_score: 0.9896; val_best_f1_score: 0.9896; train_kl_reg_loss: 855.9954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134466.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135322.4010; train_optim_loss: 135322.4010; val_kl_reg_loss: 845.2602; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 134909.5282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135754.7886; val_optim_loss: 135754.7886
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9838; val_auprc_score: 0.9863; val_best_acc_score: 0.9368; val_best_f1_score: 0.9365; train_kl_reg_loss: 1857.8892; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 107989.5262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109847.4155; train_optim_loss: 109847.4155; val_kl_reg_loss: 1871.4967; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107973.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109844.8820; val_optim_loss: 109844.8820
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9990; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 855.9425; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134440.6854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135296.6279; train_optim_loss: 135296.6279; val_kl_reg_loss: 857.3348; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135511.9696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136369.3047; val_optim_loss: 136369.3047
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9835; val_auprc_score: 0.9861; val_best_acc_score: 0.9376; val_best_f1_score: 0.9365; train_kl_reg_loss: 1853.9026; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 107907.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109761.5693; train_optim_loss: 109761.5693; val_kl_reg_loss: 1832.7807; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107844.3908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109677.1715; val_optim_loss: 109677.1715
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9835; val_auprc_score: 0.9861; val_best_acc_score: 0.9383; val_best_f1_score: 0.9366; train_kl_reg_loss: 1850.4988; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 107829.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109680.4155; train_optim_loss: 109680.4155; val_kl_reg_loss: 1803.9254; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103314.7278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105118.6531; val_optim_loss: 105118.6531
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9990; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 853.6619; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134427.1624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135280.8243; train_optim_loss: 135280.8243; val_kl_reg_loss: 853.2068; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135261.2328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136114.4396; val_optim_loss: 136114.4396
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9855; val_auprc_score: 0.9877; val_best_acc_score: 0.9415; val_best_f1_score: 0.9404; train_kl_reg_loss: 1847.5717; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 107578.2926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109425.8643; train_optim_loss: 109425.8643; val_kl_reg_loss: 1861.7509; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107311.1461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109172.8968; val_optim_loss: 109172.8968
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9991; val_auprc_score: 0.9991; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 854.5768; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134414.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135268.6739; train_optim_loss: 135268.6739; val_kl_reg_loss: 853.0066; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135263.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136116.4372; val_optim_loss: 136116.4372
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9861; val_auprc_score: 0.9881; val_best_acc_score: 0.9441; val_best_f1_score: 0.9432; train_kl_reg_loss: 1843.7006; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 107123.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108967.0143; train_optim_loss: 108967.0143; val_kl_reg_loss: 1815.8667; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107921.1153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109736.9820; val_optim_loss: 109736.9820
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9855; val_auprc_score: 0.9878; val_best_acc_score: 0.9432; val_best_f1_score: 0.9421; train_kl_reg_loss: 1842.6922; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 106972.4780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108815.1701; train_optim_loss: 108815.1701; val_kl_reg_loss: 1846.7740; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 107093.3536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108940.1276; val_optim_loss: 108940.1276

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9991; val_auprc_score: 0.9991; val_best_acc_score: 0.9900; val_best_f1_score: 0.9900; train_kl_reg_loss: 832.5847; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134271.5772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135104.1619; train_optim_loss: 135104.1619; val_kl_reg_loss: 808.8484; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135144.1357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135952.9841; val_optim_loss: 135952.9841
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9863; val_auprc_score: 0.9884; val_best_acc_score: 0.9451; val_best_f1_score: 0.9439; train_kl_reg_loss: 1839.9389; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 106638.4443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108478.3831; train_optim_loss: 108478.3831; val_kl_reg_loss: 1830.2086; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106735.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108565.7332; val_optim_loss: 108565.7332
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9991; val_auprc_score: 0.9990; val_best_acc_score: 0.9902; val_best_f1_score: 0.9901; train_kl_reg_loss: 798.3321; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134207.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135005.7299; train_optim_loss: 135005.7299; val_kl_reg_loss: 784.3458; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135027.3428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135811.6887; val_optim_loss: 135811.6887

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9884; val_auprc_score: 0.9901; val_best_acc_score: 0.9508; val_best_f1_score: 0.9499; train_kl_reg_loss: 1788.5891; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105822.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107611.4332; train_optim_loss: 107611.4332; val_kl_reg_loss: 1761.6560; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106943.9046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108705.5605; val_optim_loss: 108705.5605
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9892; val_auprc_score: 0.9908; val_best_acc_score: 0.9521; val_best_f1_score: 0.9509; train_kl_reg_loss: 1765.6354; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105727.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107493.5036; train_optim_loss: 107493.5036; val_kl_reg_loss: 1746.2913; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106864.8748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108611.1662; val_optim_loss: 108611.1662
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9991; val_auprc_score: 0.9992; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 780.2476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134175.3026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134955.5504; train_optim_loss: 134955.5504; val_kl_reg_loss: 768.7413; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135022.8408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135791.5820; val_optim_loss: 135791.5820
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9907; val_best_acc_score: 0.9520; val_best_f1_score: 0.9507; train_kl_reg_loss: 1764.7896; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105596.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107361.7513; train_optim_loss: 107361.7513; val_kl_reg_loss: 1772.3169; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106435.7883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108208.1054; val_optim_loss: 108208.1054
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9990; val_auprc_score: 0.9989; val_best_acc_score: 0.9899; val_best_f1_score: 0.9898; train_kl_reg_loss: 769.3548; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 134134.6362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134903.9911; train_optim_loss: 134903.9911; val_kl_reg_loss: 762.0479; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 135301.0962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136063.1437; val_optim_loss: 136063.1437
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9900; val_auprc_score: 0.9916; val_best_acc_score: 0.9553; val_best_f1_score: 0.9548; train_kl_reg_loss: 1764.3731; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105583.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107348.0084; train_optim_loss: 107348.0084; val_kl_reg_loss: 1760.5550; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 105733.2301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107493.7851; val_optim_loss: 107493.7851

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 594 min 12 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9834
Val AUPRC score: 0.9859
Val best accuracy score: 0.9381
Val best F1 score: 0.9363
Val gene expr MSE score: 8.2071

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1372 min 13 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9991
Val AUPRC score: 0.9991
Val best accuracy score: 0.9899
Val best F1 score: 0.9898
Val gene expr MSE score: 8.0639

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
