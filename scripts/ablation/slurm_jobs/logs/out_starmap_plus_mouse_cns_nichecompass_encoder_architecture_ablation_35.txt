None
Run timestamp: 15082023_034822_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9864; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 7310.6224; train_edge_recon_loss: 264229.8036; train_gene_expr_recon_loss: 198868.8730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470409.2990; train_optim_loss: 470409.2990; val_kl_reg_loss: 6793.1869; val_edge_recon_loss: 259821.0667; val_gene_expr_recon_loss: 184235.4711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450849.7252; val_optim_loss: 450849.7252
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9920; val_auprc_score: 0.9897; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 6852.1101; train_edge_recon_loss: 259622.0690; train_gene_expr_recon_loss: 179185.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445659.6242; train_optim_loss: 445659.6242; val_kl_reg_loss: 6624.6903; val_edge_recon_loss: 258723.8276; val_gene_expr_recon_loss: 177211.5697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442560.0876; val_optim_loss: 442560.0876
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 6650.6630; train_edge_recon_loss: 258832.5922; train_gene_expr_recon_loss: 175037.2588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440520.5137; train_optim_loss: 440520.5137; val_kl_reg_loss: 6585.2699; val_edge_recon_loss: 257813.3561; val_gene_expr_recon_loss: 174742.6807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439141.3060; val_optim_loss: 439141.3060
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 6578.6503; train_edge_recon_loss: 258251.5993; train_gene_expr_recon_loss: 173369.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438199.4790; train_optim_loss: 438199.4790; val_kl_reg_loss: 6503.7812; val_edge_recon_loss: 257925.0980; val_gene_expr_recon_loss: 173976.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438405.4833; val_optim_loss: 438405.4833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 6547.6398; train_edge_recon_loss: 257885.7658; train_gene_expr_recon_loss: 172479.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436913.0995; train_optim_loss: 436913.0995; val_kl_reg_loss: 6561.0995; val_edge_recon_loss: 257607.4363; val_gene_expr_recon_loss: 172961.0720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437129.6086; val_optim_loss: 437129.6086
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 6540.9396; train_edge_recon_loss: 257685.9306; train_gene_expr_recon_loss: 172036.1854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436263.0556; train_optim_loss: 436263.0556; val_kl_reg_loss: 6418.9195; val_edge_recon_loss: 257246.8629; val_gene_expr_recon_loss: 172819.5379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436485.3214; val_optim_loss: 436485.3214
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 6542.4124; train_edge_recon_loss: 257495.3686; train_gene_expr_recon_loss: 171589.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435626.8231; train_optim_loss: 435626.8231; val_kl_reg_loss: 6416.0810; val_edge_recon_loss: 257164.9740; val_gene_expr_recon_loss: 172645.0907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436226.1445; val_optim_loss: 436226.1445
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 6549.6997; train_edge_recon_loss: 257287.1180; train_gene_expr_recon_loss: 171265.5641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435102.3818; train_optim_loss: 435102.3818; val_kl_reg_loss: 6443.7677; val_edge_recon_loss: 256849.0367; val_gene_expr_recon_loss: 172119.0746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435411.8789; val_optim_loss: 435411.8789
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6556.8330; train_edge_recon_loss: 257075.2450; train_gene_expr_recon_loss: 170999.0245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434631.1025; train_optim_loss: 434631.1025; val_kl_reg_loss: 6495.7339; val_edge_recon_loss: 256479.7295; val_gene_expr_recon_loss: 171945.1654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434920.6298; val_optim_loss: 434920.6298
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 6557.8425; train_edge_recon_loss: 257067.4576; train_gene_expr_recon_loss: 170905.0713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434530.3711; train_optim_loss: 434530.3711; val_kl_reg_loss: 6559.6614; val_edge_recon_loss: 256744.7523; val_gene_expr_recon_loss: 172163.7655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435468.1790; val_optim_loss: 435468.1790
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6567.1660; train_edge_recon_loss: 256859.5402; train_gene_expr_recon_loss: 170846.8323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434273.5386; train_optim_loss: 434273.5386; val_kl_reg_loss: 6460.7362; val_edge_recon_loss: 256188.0810; val_gene_expr_recon_loss: 171842.6814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434491.4986; val_optim_loss: 434491.4986
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6574.4883; train_edge_recon_loss: 256788.3573; train_gene_expr_recon_loss: 170605.5777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433968.4229; train_optim_loss: 433968.4229; val_kl_reg_loss: 6538.6166; val_edge_recon_loss: 256436.5910; val_gene_expr_recon_loss: 172433.3543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435408.5602; val_optim_loss: 435408.5602
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 6579.8523; train_edge_recon_loss: 256779.0316; train_gene_expr_recon_loss: 170503.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433862.7117; train_optim_loss: 433862.7117; val_kl_reg_loss: 6497.6823; val_edge_recon_loss: 256052.2578; val_gene_expr_recon_loss: 171886.4857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434436.4270; val_optim_loss: 434436.4270
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 6586.4495; train_edge_recon_loss: 256719.2120; train_gene_expr_recon_loss: 170303.2485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433608.9101; train_optim_loss: 433608.9101; val_kl_reg_loss: 6575.9035; val_edge_recon_loss: 256206.9790; val_gene_expr_recon_loss: 172242.6202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435025.5010; val_optim_loss: 435025.5010
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 6594.2656; train_edge_recon_loss: 256572.0339; train_gene_expr_recon_loss: 170290.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433457.2915; train_optim_loss: 433457.2915; val_kl_reg_loss: 6559.3816; val_edge_recon_loss: 256319.3139; val_gene_expr_recon_loss: 171535.9448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434414.6391; val_optim_loss: 434414.6391
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6605.6497; train_edge_recon_loss: 256506.2793; train_gene_expr_recon_loss: 170187.0023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433298.9313; train_optim_loss: 433298.9313; val_kl_reg_loss: 6566.3124; val_edge_recon_loss: 255832.1892; val_gene_expr_recon_loss: 171662.8622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434061.3645; val_optim_loss: 434061.3645
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 6610.3449; train_edge_recon_loss: 256455.6559; train_gene_expr_recon_loss: 170030.8442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433096.8453; train_optim_loss: 433096.8453; val_kl_reg_loss: 6586.2012; val_edge_recon_loss: 256188.9530; val_gene_expr_recon_loss: 172070.4611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434845.6139; val_optim_loss: 434845.6139
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 6616.5027; train_edge_recon_loss: 256415.2824; train_gene_expr_recon_loss: 169884.8024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432916.5873; train_optim_loss: 432916.5873; val_kl_reg_loss: 6599.9558; val_edge_recon_loss: 255976.3644; val_gene_expr_recon_loss: 171104.3213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433680.6408; val_optim_loss: 433680.6408
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 6625.3031; train_edge_recon_loss: 256358.1798; train_gene_expr_recon_loss: 170010.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432994.0930; train_optim_loss: 432994.0930; val_kl_reg_loss: 6581.4970; val_edge_recon_loss: 256016.0456; val_gene_expr_recon_loss: 172035.7583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434633.3011; val_optim_loss: 434633.3011
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6629.3004; train_edge_recon_loss: 256266.0142; train_gene_expr_recon_loss: 169973.3135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432868.6280; train_optim_loss: 432868.6280; val_kl_reg_loss: 6558.2714; val_edge_recon_loss: 255894.4268; val_gene_expr_recon_loss: 171825.7650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434278.4622; val_optim_loss: 434278.4622
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 6634.6588; train_edge_recon_loss: 256366.8876; train_gene_expr_recon_loss: 169760.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432761.9517; train_optim_loss: 432761.9517; val_kl_reg_loss: 6653.8926; val_edge_recon_loss: 255760.1259; val_gene_expr_recon_loss: 171693.1814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434107.1977; val_optim_loss: 434107.1977
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6639.1739; train_edge_recon_loss: 256288.7305; train_gene_expr_recon_loss: 169770.2716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432698.1762; train_optim_loss: 432698.1762; val_kl_reg_loss: 6574.7968; val_edge_recon_loss: 255904.0746; val_gene_expr_recon_loss: 171779.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434258.6898; val_optim_loss: 434258.6898

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 6664.5839; train_edge_recon_loss: 256098.7000; train_gene_expr_recon_loss: 168734.1631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431497.4467; train_optim_loss: 431497.4467; val_kl_reg_loss: 6620.6736; val_edge_recon_loss: 255649.8340; val_gene_expr_recon_loss: 170912.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433183.3567; val_optim_loss: 433183.3567
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6659.3391; train_edge_recon_loss: 256105.2680; train_gene_expr_recon_loss: 168635.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431399.7032; train_optim_loss: 431399.7032; val_kl_reg_loss: 6635.9565; val_edge_recon_loss: 255856.6069; val_gene_expr_recon_loss: 170795.1030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433287.6655; val_optim_loss: 433287.6655
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6658.2485; train_edge_recon_loss: 256021.2929; train_gene_expr_recon_loss: 168432.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431111.8264; train_optim_loss: 431111.8264; val_kl_reg_loss: 6647.3114; val_edge_recon_loss: 255525.9410; val_gene_expr_recon_loss: 170913.3846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433086.6373; val_optim_loss: 433086.6373
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 3510.4095; train_edge_recon_loss: 258251.6136; train_gene_expr_recon_loss: 141429.0796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 403191.1030; train_optim_loss: 403191.1030; val_kl_reg_loss: 1072.6528; val_edge_recon_loss: 258324.0631; val_gene_expr_recon_loss: 140387.3838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 399784.0999; val_optim_loss: 399784.0999
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9943; val_auprc_score: 0.9923; val_best_acc_score: 0.9759; val_best_f1_score: 0.9761; train_kl_reg_loss: 2733.4860; train_edge_recon_loss: 257868.3023; train_gene_expr_recon_loss: 138211.5893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 398813.3776; train_optim_loss: 398813.3776; val_kl_reg_loss: 1024.3860; val_edge_recon_loss: 257925.3051; val_gene_expr_recon_loss: 138140.1241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 397089.8151; val_optim_loss: 397089.8151
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 2075.3760; train_edge_recon_loss: 257314.7929; train_gene_expr_recon_loss: 136925.5265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 396315.6957; train_optim_loss: 396315.6957; val_kl_reg_loss: 1070.2368; val_edge_recon_loss: 257580.0447; val_gene_expr_recon_loss: 137564.2269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 396214.5081; val_optim_loss: 396214.5081
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 1626.6884; train_edge_recon_loss: 256744.9406; train_gene_expr_recon_loss: 136183.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 394555.3881; train_optim_loss: 394555.3881; val_kl_reg_loss: 1125.4191; val_edge_recon_loss: 256976.1581; val_gene_expr_recon_loss: 136670.6902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 394772.2670; val_optim_loss: 394772.2670
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 1432.8864; train_edge_recon_loss: 256495.6031; train_gene_expr_recon_loss: 135710.7780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 393639.2674; train_optim_loss: 393639.2674; val_kl_reg_loss: 1177.7151; val_edge_recon_loss: 256721.8193; val_gene_expr_recon_loss: 136490.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 394389.7638; val_optim_loss: 394389.7638
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 1347.7574; train_edge_recon_loss: 256260.2367; train_gene_expr_recon_loss: 135480.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 393088.7690; train_optim_loss: 393088.7690; val_kl_reg_loss: 1195.3007; val_edge_recon_loss: 256804.9528; val_gene_expr_recon_loss: 136355.6235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 394355.8778; val_optim_loss: 394355.8778
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9949; val_auprc_score: 0.9930; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 1327.4067; train_edge_recon_loss: 256170.9488; train_gene_expr_recon_loss: 135188.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392686.6394; train_optim_loss: 392686.6394; val_kl_reg_loss: 1191.5853; val_edge_recon_loss: 256630.5058; val_gene_expr_recon_loss: 135818.2763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393640.3678; val_optim_loss: 393640.3678
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 1318.0655; train_edge_recon_loss: 256185.4661; train_gene_expr_recon_loss: 134946.4839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392450.0157; train_optim_loss: 392450.0157; val_kl_reg_loss: 1170.6807; val_edge_recon_loss: 256982.0898; val_gene_expr_recon_loss: 135749.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393902.2240; val_optim_loss: 393902.2240
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 1334.2961; train_edge_recon_loss: 256389.1647; train_gene_expr_recon_loss: 134813.6245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392537.0849; train_optim_loss: 392537.0849; val_kl_reg_loss: 1157.1144; val_edge_recon_loss: 256674.1729; val_gene_expr_recon_loss: 135469.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393301.0816; val_optim_loss: 393301.0816
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9951; val_auprc_score: 0.9933; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 1324.3911; train_edge_recon_loss: 256228.5755; train_gene_expr_recon_loss: 134672.6774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392225.6439; train_optim_loss: 392225.6439; val_kl_reg_loss: 1161.0607; val_edge_recon_loss: 256721.1397; val_gene_expr_recon_loss: 135374.7561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 393256.9569; val_optim_loss: 393256.9569
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 1295.1044; train_edge_recon_loss: 256086.8069; train_gene_expr_recon_loss: 134499.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391881.0340; train_optim_loss: 391881.0340; val_kl_reg_loss: 1179.1863; val_edge_recon_loss: 256680.2235; val_gene_expr_recon_loss: 134908.2024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392767.6127; val_optim_loss: 392767.6127
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 1257.2206; train_edge_recon_loss: 256068.4351; train_gene_expr_recon_loss: 133892.0200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391217.6754; train_optim_loss: 391217.6754; val_kl_reg_loss: 1186.0447; val_edge_recon_loss: 256178.7254; val_gene_expr_recon_loss: 134624.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 391989.0972; val_optim_loss: 391989.0972
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 1238.3919; train_edge_recon_loss: 255829.4585; train_gene_expr_recon_loss: 133888.7696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390956.6200; train_optim_loss: 390956.6200; val_kl_reg_loss: 1198.5733; val_edge_recon_loss: 256532.7757; val_gene_expr_recon_loss: 134377.1190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392108.4690; val_optim_loss: 392108.4690
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 1229.3634; train_edge_recon_loss: 255845.0341; train_gene_expr_recon_loss: 133722.5751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390796.9724; train_optim_loss: 390796.9724; val_kl_reg_loss: 1204.0321; val_edge_recon_loss: 256147.3789; val_gene_expr_recon_loss: 134732.9320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392084.3414; val_optim_loss: 392084.3414
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 1230.9196; train_edge_recon_loss: 255861.3868; train_gene_expr_recon_loss: 133644.0439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390736.3507; train_optim_loss: 390736.3507; val_kl_reg_loss: 1169.0823; val_edge_recon_loss: 256202.9503; val_gene_expr_recon_loss: 134134.2446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 391506.2767; val_optim_loss: 391506.2767
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 1245.2553; train_edge_recon_loss: 255964.1686; train_gene_expr_recon_loss: 133601.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390811.0029; train_optim_loss: 390811.0029; val_kl_reg_loss: 1071.5688; val_edge_recon_loss: 257160.0032; val_gene_expr_recon_loss: 134436.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392668.2518; val_optim_loss: 392668.2518
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 1317.4836; train_edge_recon_loss: 256762.7937; train_gene_expr_recon_loss: 133537.3135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391617.5911; train_optim_loss: 391617.5911; val_kl_reg_loss: 1066.2765; val_edge_recon_loss: 257107.9375; val_gene_expr_recon_loss: 134474.2207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392648.4339; val_optim_loss: 392648.4339
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 1314.6870; train_edge_recon_loss: 256556.0663; train_gene_expr_recon_loss: 133625.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391496.1890; train_optim_loss: 391496.1890; val_kl_reg_loss: 1058.2578; val_edge_recon_loss: 256797.9930; val_gene_expr_recon_loss: 134430.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392286.5168; val_optim_loss: 392286.5168
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 1274.9569; train_edge_recon_loss: 256470.7747; train_gene_expr_recon_loss: 133533.2263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391278.9580; train_optim_loss: 391278.9580; val_kl_reg_loss: 1078.0492; val_edge_recon_loss: 257063.6190; val_gene_expr_recon_loss: 134574.9971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392716.6635; val_optim_loss: 392716.6635

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 1248.9134; train_edge_recon_loss: 256256.0723; train_gene_expr_recon_loss: 133491.6421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390996.6281; train_optim_loss: 390996.6281; val_kl_reg_loss: 1083.6627; val_edge_recon_loss: 256811.7218; val_gene_expr_recon_loss: 134591.9150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392487.2989; val_optim_loss: 392487.2989
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 1241.7368; train_edge_recon_loss: 256376.5323; train_gene_expr_recon_loss: 133423.7858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391042.0550; train_optim_loss: 391042.0550; val_kl_reg_loss: 1085.5754; val_edge_recon_loss: 256856.6717; val_gene_expr_recon_loss: 134485.9683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392428.2163; val_optim_loss: 392428.2163
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9950; val_auprc_score: 0.9931; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 1231.9289; train_edge_recon_loss: 256254.8028; train_gene_expr_recon_loss: 133537.7681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391024.4995; train_optim_loss: 391024.4995; val_kl_reg_loss: 1087.2924; val_edge_recon_loss: 256812.3819; val_gene_expr_recon_loss: 134331.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392231.5953; val_optim_loss: 392231.5953
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 1222.0468; train_edge_recon_loss: 256276.4821; train_gene_expr_recon_loss: 133491.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390990.2118; train_optim_loss: 390990.2118; val_kl_reg_loss: 1091.2310; val_edge_recon_loss: 256605.7224; val_gene_expr_recon_loss: 134425.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 392122.2376; val_optim_loss: 392122.2376

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 314 min 59 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9955
val AUPRC score: 0.9942
val best accuracy score: 0.9792
val best F1 score: 0.9794
val target rna MSE score: 0.9298
val source rna MSE score: 0.0636

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
