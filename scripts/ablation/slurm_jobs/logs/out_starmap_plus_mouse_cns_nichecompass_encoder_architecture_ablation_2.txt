None
Run timestamp: 26072023_054940_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '30.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9779; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 6002.1705; train_edge_recon_loss: 261970.2875; train_gene_expr_recon_loss: 13350.2359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281322.6935; train_optim_loss: 281322.6935; val_kl_reg_loss: 5834.6514; val_edge_recon_loss: 257698.3310; val_gene_expr_recon_loss: 12285.7548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275818.7363; val_optim_loss: 275818.7363
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9864; val_auprc_score: 0.9798; val_best_acc_score: 0.9637; val_best_f1_score: 0.9644; train_kl_reg_loss: 5916.7213; train_edge_recon_loss: 257928.0912; train_gene_expr_recon_loss: 11857.3313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275702.1433; train_optim_loss: 275702.1433; val_kl_reg_loss: 5675.4013; val_edge_recon_loss: 256700.9231; val_gene_expr_recon_loss: 11612.3142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273988.6383; val_optim_loss: 273988.6383
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9875; val_auprc_score: 0.9813; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 5888.1853; train_edge_recon_loss: 257081.6570; train_gene_expr_recon_loss: 11428.6481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274398.4909; train_optim_loss: 274398.4909; val_kl_reg_loss: 5647.8719; val_edge_recon_loss: 256836.5174; val_gene_expr_recon_loss: 11321.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273805.5846; val_optim_loss: 273805.5846
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9890; val_auprc_score: 0.9841; val_best_acc_score: 0.9680; val_best_f1_score: 0.9687; train_kl_reg_loss: 5859.7280; train_edge_recon_loss: 256969.4473; train_gene_expr_recon_loss: 11189.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274018.9354; train_optim_loss: 274018.9354; val_kl_reg_loss: 5791.7059; val_edge_recon_loss: 256258.4115; val_gene_expr_recon_loss: 11120.6870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273170.8037; val_optim_loss: 273170.8037
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9896; val_auprc_score: 0.9842; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 5844.0498; train_edge_recon_loss: 256853.5738; train_gene_expr_recon_loss: 11032.5853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273730.2084; train_optim_loss: 273730.2084; val_kl_reg_loss: 5630.0766; val_edge_recon_loss: 256051.1158; val_gene_expr_recon_loss: 11004.3038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272685.4964; val_optim_loss: 272685.4964
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9907; val_auprc_score: 0.9861; val_best_acc_score: 0.9725; val_best_f1_score: 0.9730; train_kl_reg_loss: 5833.8195; train_edge_recon_loss: 256630.5253; train_gene_expr_recon_loss: 10917.6423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273381.9873; train_optim_loss: 273381.9873; val_kl_reg_loss: 5985.2729; val_edge_recon_loss: 256233.9682; val_gene_expr_recon_loss: 10861.9810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273081.2203; val_optim_loss: 273081.2203
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9858; val_best_acc_score: 0.9730; val_best_f1_score: 0.9735; train_kl_reg_loss: 5827.8295; train_edge_recon_loss: 256420.0485; train_gene_expr_recon_loss: 10810.8029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273058.6809; train_optim_loss: 273058.6809; val_kl_reg_loss: 5812.4369; val_edge_recon_loss: 255726.6315; val_gene_expr_recon_loss: 10788.5601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272327.6301; val_optim_loss: 272327.6301
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9922; val_auprc_score: 0.9889; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5820.3772; train_edge_recon_loss: 256380.3828; train_gene_expr_recon_loss: 10739.6005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272940.3611; train_optim_loss: 272940.3611; val_kl_reg_loss: 5831.1768; val_edge_recon_loss: 255700.4302; val_gene_expr_recon_loss: 10721.1474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272252.7561; val_optim_loss: 272252.7561
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9892; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 5812.1309; train_edge_recon_loss: 256416.0082; train_gene_expr_recon_loss: 10672.2625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272900.4020; train_optim_loss: 272900.4020; val_kl_reg_loss: 5658.9510; val_edge_recon_loss: 255670.1274; val_gene_expr_recon_loss: 10658.8735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271987.9512; val_optim_loss: 271987.9512
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9892; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 5811.2381; train_edge_recon_loss: 256217.8525; train_gene_expr_recon_loss: 10621.2392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272650.3302; train_optim_loss: 272650.3302; val_kl_reg_loss: 5701.1654; val_edge_recon_loss: 255661.3456; val_gene_expr_recon_loss: 10623.0396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271985.5518; val_optim_loss: 271985.5518
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9925; val_auprc_score: 0.9882; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 5806.0921; train_edge_recon_loss: 256175.4530; train_gene_expr_recon_loss: 10581.3278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272562.8731; train_optim_loss: 272562.8731; val_kl_reg_loss: 5711.9485; val_edge_recon_loss: 255522.9239; val_gene_expr_recon_loss: 10577.1405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271812.0116; val_optim_loss: 271812.0116
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9929; val_auprc_score: 0.9897; val_best_acc_score: 0.9766; val_best_f1_score: 0.9770; train_kl_reg_loss: 5804.2610; train_edge_recon_loss: 256040.5254; train_gene_expr_recon_loss: 10559.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272404.5654; train_optim_loss: 272404.5654; val_kl_reg_loss: 5736.9534; val_edge_recon_loss: 255460.0779; val_gene_expr_recon_loss: 10568.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271765.5339; val_optim_loss: 271765.5339
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9770; val_best_f1_score: 0.9774; train_kl_reg_loss: 5793.9969; train_edge_recon_loss: 256110.9710; train_gene_expr_recon_loss: 10522.1904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272427.1584; train_optim_loss: 272427.1584; val_kl_reg_loss: 5767.1948; val_edge_recon_loss: 255430.6848; val_gene_expr_recon_loss: 10552.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271750.1574; val_optim_loss: 271750.1574
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9938; val_auprc_score: 0.9908; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 5800.2504; train_edge_recon_loss: 255996.1201; train_gene_expr_recon_loss: 10506.8180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272303.1887; train_optim_loss: 272303.1887; val_kl_reg_loss: 5763.5631; val_edge_recon_loss: 255248.4758; val_gene_expr_recon_loss: 10518.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271530.5596; val_optim_loss: 271530.5596
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9943; val_auprc_score: 0.9917; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 5798.7472; train_edge_recon_loss: 255855.6009; train_gene_expr_recon_loss: 10487.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272141.6062; train_optim_loss: 272141.6062; val_kl_reg_loss: 5807.7658; val_edge_recon_loss: 255387.7994; val_gene_expr_recon_loss: 10482.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271677.8779; val_optim_loss: 271677.8779
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9913; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5798.9505; train_edge_recon_loss: 255900.1702; train_gene_expr_recon_loss: 10464.8322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272163.9530; train_optim_loss: 272163.9530; val_kl_reg_loss: 5693.2263; val_edge_recon_loss: 255457.6871; val_gene_expr_recon_loss: 10492.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271643.7976; val_optim_loss: 271643.7976
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9943; val_auprc_score: 0.9915; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 5795.7127; train_edge_recon_loss: 255817.1782; train_gene_expr_recon_loss: 10444.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272057.5260; train_optim_loss: 272057.5260; val_kl_reg_loss: 5858.7978; val_edge_recon_loss: 255143.6564; val_gene_expr_recon_loss: 10458.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271460.7113; val_optim_loss: 271460.7113
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9914; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5791.7967; train_edge_recon_loss: 255782.1376; train_gene_expr_recon_loss: 10441.1854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272015.1198; train_optim_loss: 272015.1198; val_kl_reg_loss: 5721.0434; val_edge_recon_loss: 255000.8756; val_gene_expr_recon_loss: 10461.3121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271183.2327; val_optim_loss: 271183.2327
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9944; val_auprc_score: 0.9918; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 5792.2396; train_edge_recon_loss: 255661.3625; train_gene_expr_recon_loss: 10424.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271877.7621; train_optim_loss: 271877.7621; val_kl_reg_loss: 5926.4099; val_edge_recon_loss: 254918.6218; val_gene_expr_recon_loss: 10421.3234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271266.3559; val_optim_loss: 271266.3559
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9949; val_auprc_score: 0.9927; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5790.9649; train_edge_recon_loss: 255622.0702; train_gene_expr_recon_loss: 10424.5805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271837.6161; train_optim_loss: 271837.6161; val_kl_reg_loss: 5765.3669; val_edge_recon_loss: 254918.0800; val_gene_expr_recon_loss: 10443.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271126.6804; val_optim_loss: 271126.6804
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9912; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 5790.0747; train_edge_recon_loss: 255570.4312; train_gene_expr_recon_loss: 10414.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271774.5740; train_optim_loss: 271774.5740; val_kl_reg_loss: 5774.8358; val_edge_recon_loss: 254630.0140; val_gene_expr_recon_loss: 10432.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270837.2990; val_optim_loss: 270837.2990
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9921; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5789.6339; train_edge_recon_loss: 255606.0893; train_gene_expr_recon_loss: 10399.4872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271795.2103; train_optim_loss: 271795.2103; val_kl_reg_loss: 5666.2239; val_edge_recon_loss: 254683.4691; val_gene_expr_recon_loss: 10413.4455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270763.1401; val_optim_loss: 270763.1401
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9921; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5790.5768; train_edge_recon_loss: 255530.4659; train_gene_expr_recon_loss: 10400.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271721.5036; train_optim_loss: 271721.5036; val_kl_reg_loss: 5812.7147; val_edge_recon_loss: 254754.8077; val_gene_expr_recon_loss: 10409.5317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270977.0543; val_optim_loss: 270977.0543
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9919; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5791.7936; train_edge_recon_loss: 255531.3305; train_gene_expr_recon_loss: 10393.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271716.6797; train_optim_loss: 271716.6797; val_kl_reg_loss: 5766.8291; val_edge_recon_loss: 254646.4579; val_gene_expr_recon_loss: 10423.0674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270836.3540; val_optim_loss: 270836.3540
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9949; val_auprc_score: 0.9922; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5785.4797; train_edge_recon_loss: 255456.9727; train_gene_expr_recon_loss: 10379.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271622.2479; train_optim_loss: 271622.2479; val_kl_reg_loss: 5731.5907; val_edge_recon_loss: 254649.8764; val_gene_expr_recon_loss: 10401.5886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270783.0572; val_optim_loss: 270783.0572
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9942; val_auprc_score: 0.9913; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5789.9873; train_edge_recon_loss: 255424.3921; train_gene_expr_recon_loss: 10373.9370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271588.3166; train_optim_loss: 271588.3166; val_kl_reg_loss: 5712.0993; val_edge_recon_loss: 254942.9190; val_gene_expr_recon_loss: 10380.1485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271035.1673; val_optim_loss: 271035.1673

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9952; val_auprc_score: 0.9929; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 5776.5991; train_edge_recon_loss: 255328.7246; train_gene_expr_recon_loss: 10330.7724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271436.0956; train_optim_loss: 271436.0956; val_kl_reg_loss: 5759.1343; val_edge_recon_loss: 254417.8264; val_gene_expr_recon_loss: 10362.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270539.6237; val_optim_loss: 270539.6237
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9950; val_auprc_score: 0.9925; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5771.9091; train_edge_recon_loss: 255316.6314; train_gene_expr_recon_loss: 10329.3780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271417.9184; train_optim_loss: 271417.9184; val_kl_reg_loss: 5750.1355; val_edge_recon_loss: 254451.9388; val_gene_expr_recon_loss: 10363.6002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270565.6745; val_optim_loss: 270565.6745
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9953; val_auprc_score: 0.9931; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 5769.1773; train_edge_recon_loss: 255315.5352; train_gene_expr_recon_loss: 10320.3544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271405.0670; train_optim_loss: 271405.0670; val_kl_reg_loss: 5758.0082; val_edge_recon_loss: 254480.6538; val_gene_expr_recon_loss: 10326.5178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270565.1804; val_optim_loss: 270565.1804
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9929; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5763.6835; train_edge_recon_loss: 255216.8549; train_gene_expr_recon_loss: 10317.4958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271298.0339; train_optim_loss: 271298.0339; val_kl_reg_loss: 5752.4595; val_edge_recon_loss: 254470.2668; val_gene_expr_recon_loss: 10324.8934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270547.6197; val_optim_loss: 270547.6197
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9955; val_auprc_score: 0.9927; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 5763.7701; train_edge_recon_loss: 255226.1832; train_gene_expr_recon_loss: 10318.4515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271308.4048; train_optim_loss: 271308.4048; val_kl_reg_loss: 5764.0299; val_edge_recon_loss: 254154.5127; val_gene_expr_recon_loss: 10328.5518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270247.0941; val_optim_loss: 270247.0941
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9951; val_auprc_score: 0.9924; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 5760.4847; train_edge_recon_loss: 255172.9179; train_gene_expr_recon_loss: 10305.4319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271238.8344; train_optim_loss: 271238.8344; val_kl_reg_loss: 5737.8307; val_edge_recon_loss: 254344.5577; val_gene_expr_recon_loss: 10338.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270421.2245; val_optim_loss: 270421.2245
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9954; val_auprc_score: 0.9930; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 5757.2554; train_edge_recon_loss: 255266.7105; train_gene_expr_recon_loss: 10310.1352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271334.1009; train_optim_loss: 271334.1009; val_kl_reg_loss: 5720.1363; val_edge_recon_loss: 254361.8845; val_gene_expr_recon_loss: 10313.6283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270395.6502; val_optim_loss: 270395.6502
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9954; val_auprc_score: 0.9934; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 5759.0522; train_edge_recon_loss: 255075.6566; train_gene_expr_recon_loss: 10305.6283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271140.3371; train_optim_loss: 271140.3371; val_kl_reg_loss: 5768.3815; val_edge_recon_loss: 254577.4644; val_gene_expr_recon_loss: 10317.8320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270663.6768; val_optim_loss: 270663.6768
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9955; val_auprc_score: 0.9930; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 5756.5495; train_edge_recon_loss: 255123.5360; train_gene_expr_recon_loss: 10300.3486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271180.4344; train_optim_loss: 271180.4344; val_kl_reg_loss: 5753.3357; val_edge_recon_loss: 254446.1390; val_gene_expr_recon_loss: 10352.5297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270552.0046; val_optim_loss: 270552.0046

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9954; val_auprc_score: 0.9929; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 5754.2857; train_edge_recon_loss: 255129.7779; train_gene_expr_recon_loss: 10290.2169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271174.2808; train_optim_loss: 271174.2808; val_kl_reg_loss: 5749.1074; val_edge_recon_loss: 254304.4873; val_gene_expr_recon_loss: 10319.9816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270373.5766; val_optim_loss: 270373.5766
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9953; val_auprc_score: 0.9926; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 5758.1730; train_edge_recon_loss: 255082.3338; train_gene_expr_recon_loss: 10304.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271144.8758; train_optim_loss: 271144.8758; val_kl_reg_loss: 5751.6067; val_edge_recon_loss: 254277.4338; val_gene_expr_recon_loss: 10335.7802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270364.8209; val_optim_loss: 270364.8209
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9953; val_auprc_score: 0.9930; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 5755.9057; train_edge_recon_loss: 255184.0763; train_gene_expr_recon_loss: 10298.2493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271238.2315; train_optim_loss: 271238.2315; val_kl_reg_loss: 5743.7994; val_edge_recon_loss: 254415.5967; val_gene_expr_recon_loss: 10345.1790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270504.5747; val_optim_loss: 270504.5747
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9952; val_auprc_score: 0.9927; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 5756.1145; train_edge_recon_loss: 255105.6168; train_gene_expr_recon_loss: 10290.2280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271151.9592; train_optim_loss: 271151.9592; val_kl_reg_loss: 5752.6186; val_edge_recon_loss: 254579.6080; val_gene_expr_recon_loss: 10324.4004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270656.6267; val_optim_loss: 270656.6267

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 120 min 49 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9953
Val AUPRC score: 0.9930
Val best accuracy score: 0.9832
Val best F1 score: 0.9833
Val gene expr MSE score: 0.7000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
