None
Run timestamp: 02082023_190333_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9868; val_auprc_score: 0.9821; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 7440.0900; train_edge_recon_loss: 266160.9475; train_gene_expr_recon_loss: 203055.6254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 476656.6625; train_optim_loss: 476656.6625; val_kl_reg_loss: 7054.0433; val_edge_recon_loss: 261417.6156; val_gene_expr_recon_loss: 186811.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 455282.8996; val_optim_loss: 455282.8996
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9892; val_auprc_score: 0.9857; val_best_acc_score: 0.9630; val_best_f1_score: 0.9636; train_kl_reg_loss: 7047.0819; train_edge_recon_loss: 260449.2703; train_gene_expr_recon_loss: 181594.7832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449091.1356; train_optim_loss: 449091.1356; val_kl_reg_loss: 6661.0712; val_edge_recon_loss: 260150.0311; val_gene_expr_recon_loss: 178236.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445047.6589; val_optim_loss: 445047.6589
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9901; val_auprc_score: 0.9872; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 6842.8352; train_edge_recon_loss: 259523.9054; train_gene_expr_recon_loss: 176390.7519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442757.4922; train_optim_loss: 442757.4922; val_kl_reg_loss: 6655.1132; val_edge_recon_loss: 259318.7328; val_gene_expr_recon_loss: 175073.4695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441047.3142; val_optim_loss: 441047.3142
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9919; val_auprc_score: 0.9896; val_best_acc_score: 0.9690; val_best_f1_score: 0.9696; train_kl_reg_loss: 6741.5194; train_edge_recon_loss: 258933.0662; train_gene_expr_recon_loss: 173688.8725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439363.4579; train_optim_loss: 439363.4579; val_kl_reg_loss: 6674.3368; val_edge_recon_loss: 258749.1366; val_gene_expr_recon_loss: 173441.8848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438865.3577; val_optim_loss: 438865.3577
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9917; val_auprc_score: 0.9890; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 6697.2485; train_edge_recon_loss: 258604.2063; train_gene_expr_recon_loss: 172272.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437573.9876; train_optim_loss: 437573.9876; val_kl_reg_loss: 6575.3070; val_edge_recon_loss: 258859.1091; val_gene_expr_recon_loss: 172154.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437588.7828; val_optim_loss: 437588.7828
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 6668.7236; train_edge_recon_loss: 258330.8034; train_gene_expr_recon_loss: 171467.4068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436466.9336; train_optim_loss: 436466.9336; val_kl_reg_loss: 6563.5007; val_edge_recon_loss: 258285.8729; val_gene_expr_recon_loss: 171765.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436614.9150; val_optim_loss: 436614.9150
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9932; val_auprc_score: 0.9909; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 6663.0234; train_edge_recon_loss: 258226.3661; train_gene_expr_recon_loss: 170813.6636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435703.0526; train_optim_loss: 435703.0526; val_kl_reg_loss: 6662.4308; val_edge_recon_loss: 258248.9589; val_gene_expr_recon_loss: 171793.9880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436705.3763; val_optim_loss: 436705.3763
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 6671.6552; train_edge_recon_loss: 257809.5232; train_gene_expr_recon_loss: 170355.1330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434836.3111; train_optim_loss: 434836.3111; val_kl_reg_loss: 6630.1079; val_edge_recon_loss: 257757.1113; val_gene_expr_recon_loss: 171008.7268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435395.9468; val_optim_loss: 435395.9468
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 6671.3547; train_edge_recon_loss: 257791.8829; train_gene_expr_recon_loss: 170000.0737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434463.3112; train_optim_loss: 434463.3112; val_kl_reg_loss: 6529.7386; val_edge_recon_loss: 257455.1119; val_gene_expr_recon_loss: 170764.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434749.1656; val_optim_loss: 434749.1656
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 6679.7045; train_edge_recon_loss: 257658.5230; train_gene_expr_recon_loss: 169705.3685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434043.5958; train_optim_loss: 434043.5958; val_kl_reg_loss: 6678.7787; val_edge_recon_loss: 257379.6059; val_gene_expr_recon_loss: 170995.9578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435054.3441; val_optim_loss: 435054.3441
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 6677.6523; train_edge_recon_loss: 257648.2100; train_gene_expr_recon_loss: 169533.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433859.7118; train_optim_loss: 433859.7118; val_kl_reg_loss: 6596.8858; val_edge_recon_loss: 257795.1762; val_gene_expr_recon_loss: 170389.4663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434781.5299; val_optim_loss: 434781.5299
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 6691.7703; train_edge_recon_loss: 257455.1525; train_gene_expr_recon_loss: 169146.8374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433293.7608; train_optim_loss: 433293.7608; val_kl_reg_loss: 6719.7922; val_edge_recon_loss: 257456.0370; val_gene_expr_recon_loss: 169951.1768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434127.0076; val_optim_loss: 434127.0076
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 6701.1089; train_edge_recon_loss: 257302.5645; train_gene_expr_recon_loss: 169004.3697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433008.0431; train_optim_loss: 433008.0431; val_kl_reg_loss: 6709.3369; val_edge_recon_loss: 257401.6733; val_gene_expr_recon_loss: 170060.2493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434171.2611; val_optim_loss: 434171.2611
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 6705.1787; train_edge_recon_loss: 257255.6615; train_gene_expr_recon_loss: 168875.5240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432836.3642; train_optim_loss: 432836.3642; val_kl_reg_loss: 6657.7848; val_edge_recon_loss: 257241.8209; val_gene_expr_recon_loss: 170482.2797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434381.8841; val_optim_loss: 434381.8841
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9940; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 6709.4881; train_edge_recon_loss: 257206.9812; train_gene_expr_recon_loss: 168640.8481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432557.3177; train_optim_loss: 432557.3177; val_kl_reg_loss: 6655.2154; val_edge_recon_loss: 257133.2577; val_gene_expr_recon_loss: 170457.1730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434245.6467; val_optim_loss: 434245.6467
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 6718.7560; train_edge_recon_loss: 257195.2553; train_gene_expr_recon_loss: 168685.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432599.1104; train_optim_loss: 432599.1104; val_kl_reg_loss: 6624.7172; val_edge_recon_loss: 257370.9013; val_gene_expr_recon_loss: 170584.4698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434580.0886; val_optim_loss: 434580.0886

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6742.0259; train_edge_recon_loss: 256868.4739; train_gene_expr_recon_loss: 167497.9546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431108.4547; train_optim_loss: 431108.4547; val_kl_reg_loss: 6661.1694; val_edge_recon_loss: 256759.3984; val_gene_expr_recon_loss: 169582.4052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433002.9735; val_optim_loss: 433002.9735
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6732.7811; train_edge_recon_loss: 256917.4771; train_gene_expr_recon_loss: 167383.6452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431033.9040; train_optim_loss: 431033.9040; val_kl_reg_loss: 6685.7027; val_edge_recon_loss: 257071.2094; val_gene_expr_recon_loss: 169196.7084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432953.6218; val_optim_loss: 432953.6218
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 6730.3808; train_edge_recon_loss: 256895.1122; train_gene_expr_recon_loss: 167456.6086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431082.1015; train_optim_loss: 431082.1015; val_kl_reg_loss: 6667.9936; val_edge_recon_loss: 257133.4304; val_gene_expr_recon_loss: 169210.2270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433011.6515; val_optim_loss: 433011.6515
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 6734.1632; train_edge_recon_loss: 256761.6427; train_gene_expr_recon_loss: 167175.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430671.6457; train_optim_loss: 430671.6457; val_kl_reg_loss: 6657.5349; val_edge_recon_loss: 256949.3256; val_gene_expr_recon_loss: 169501.4603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433108.3190; val_optim_loss: 433108.3190
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 6728.8975; train_edge_recon_loss: 256847.5752; train_gene_expr_recon_loss: 167005.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430582.4355; train_optim_loss: 430582.4355; val_kl_reg_loss: 6652.9051; val_edge_recon_loss: 257219.9334; val_gene_expr_recon_loss: 169269.8237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433142.6608; val_optim_loss: 433142.6608
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 6729.0461; train_edge_recon_loss: 256828.3445; train_gene_expr_recon_loss: 167086.6842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430644.0747; train_optim_loss: 430644.0747; val_kl_reg_loss: 6690.7341; val_edge_recon_loss: 257071.4595; val_gene_expr_recon_loss: 169139.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432901.7123; val_optim_loss: 432901.7123
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6728.3251; train_edge_recon_loss: 256834.6484; train_gene_expr_recon_loss: 166834.0888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430397.0621; train_optim_loss: 430397.0621; val_kl_reg_loss: 6685.1964; val_edge_recon_loss: 256998.3279; val_gene_expr_recon_loss: 168949.6139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432633.1385; val_optim_loss: 432633.1385
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6729.2736; train_edge_recon_loss: 256859.3128; train_gene_expr_recon_loss: 167062.0093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430650.5958; train_optim_loss: 430650.5958; val_kl_reg_loss: 6682.6962; val_edge_recon_loss: 256903.6401; val_gene_expr_recon_loss: 169115.2265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432701.5644; val_optim_loss: 432701.5644
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6727.9079; train_edge_recon_loss: 256776.6344; train_gene_expr_recon_loss: 166882.4481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430386.9906; train_optim_loss: 430386.9906; val_kl_reg_loss: 6690.1961; val_edge_recon_loss: 256983.2971; val_gene_expr_recon_loss: 169362.8157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433036.3081; val_optim_loss: 433036.3081
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 6725.9647; train_edge_recon_loss: 256789.3287; train_gene_expr_recon_loss: 166839.2032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430354.4966; train_optim_loss: 430354.4966; val_kl_reg_loss: 6683.4159; val_edge_recon_loss: 256952.0895; val_gene_expr_recon_loss: 168869.1092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432504.6153; val_optim_loss: 432504.6153
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9812; val_best_f1_score: 0.9815; train_kl_reg_loss: 6723.7009; train_edge_recon_loss: 256835.4867; train_gene_expr_recon_loss: 166793.6088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430352.7970; train_optim_loss: 430352.7970; val_kl_reg_loss: 6675.5901; val_edge_recon_loss: 256856.6946; val_gene_expr_recon_loss: 168743.6104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432275.8948; val_optim_loss: 432275.8948
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 6723.5846; train_edge_recon_loss: 256806.3658; train_gene_expr_recon_loss: 166767.9314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430297.8814; train_optim_loss: 430297.8814; val_kl_reg_loss: 6680.0423; val_edge_recon_loss: 256767.0755; val_gene_expr_recon_loss: 168942.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432389.9455; val_optim_loss: 432389.9455
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 6723.8404; train_edge_recon_loss: 256750.6896; train_gene_expr_recon_loss: 166798.5143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430273.0446; train_optim_loss: 430273.0446; val_kl_reg_loss: 6681.7250; val_edge_recon_loss: 256579.7086; val_gene_expr_recon_loss: 168813.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432075.2054; val_optim_loss: 432075.2054
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6724.6108; train_edge_recon_loss: 256623.1202; train_gene_expr_recon_loss: 166634.7542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429982.4854; train_optim_loss: 429982.4854; val_kl_reg_loss: 6689.9343; val_edge_recon_loss: 257046.9981; val_gene_expr_recon_loss: 168955.4137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432692.3455; val_optim_loss: 432692.3455
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 6724.9551; train_edge_recon_loss: 256703.0353; train_gene_expr_recon_loss: 166640.9255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430068.9153; train_optim_loss: 430068.9153; val_kl_reg_loss: 6699.2325; val_edge_recon_loss: 256962.5330; val_gene_expr_recon_loss: 168809.2513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432471.0158; val_optim_loss: 432471.0158
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 6722.7863; train_edge_recon_loss: 256737.3607; train_gene_expr_recon_loss: 166582.4442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430042.5915; train_optim_loss: 430042.5915; val_kl_reg_loss: 6666.5918; val_edge_recon_loss: 256777.4689; val_gene_expr_recon_loss: 168946.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432390.7416; val_optim_loss: 432390.7416
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 6726.6078; train_edge_recon_loss: 256657.9838; train_gene_expr_recon_loss: 166630.1754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430014.7670; train_optim_loss: 430014.7670; val_kl_reg_loss: 6696.4446; val_edge_recon_loss: 257158.5877; val_gene_expr_recon_loss: 169196.2749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433051.3077; val_optim_loss: 433051.3077

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6727.5839; train_edge_recon_loss: 256702.5543; train_gene_expr_recon_loss: 166510.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429940.6359; train_optim_loss: 429940.6359; val_kl_reg_loss: 6671.4317; val_edge_recon_loss: 256898.5571; val_gene_expr_recon_loss: 169104.0213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432674.0107; val_optim_loss: 432674.0107
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6719.1649; train_edge_recon_loss: 256709.0549; train_gene_expr_recon_loss: 166508.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429937.1249; train_optim_loss: 429937.1249; val_kl_reg_loss: 6667.1222; val_edge_recon_loss: 256711.4816; val_gene_expr_recon_loss: 168955.3940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432333.9977; val_optim_loss: 432333.9977
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 6720.4982; train_edge_recon_loss: 256639.6944; train_gene_expr_recon_loss: 166419.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429779.5808; train_optim_loss: 429779.5808; val_kl_reg_loss: 6670.8728; val_edge_recon_loss: 256843.7665; val_gene_expr_recon_loss: 168994.4759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432509.1153; val_optim_loss: 432509.1153
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 6723.3873; train_edge_recon_loss: 256582.0042; train_gene_expr_recon_loss: 166601.7642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429907.1557; train_optim_loss: 429907.1557; val_kl_reg_loss: 6678.8639; val_edge_recon_loss: 256933.8191; val_gene_expr_recon_loss: 168763.3987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432376.0808; val_optim_loss: 432376.0808

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 152 min 48 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9964
val AUPRC score: 0.9955
val best accuracy score: 0.9813
val best F1 score: 0.9815
val target rna MSE score: 0.5851
val source rna MSE score: 0.0791

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
