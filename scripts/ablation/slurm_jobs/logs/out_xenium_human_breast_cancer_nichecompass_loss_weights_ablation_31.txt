None
Run timestamp: 01072023_235120_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9824; val_auprc_score: 0.9787; val_best_acc_score: 0.9392; val_best_f1_score: 0.9407; train_kl_reg_loss: 5095.0786; train_edge_recon_loss: 265071.5998; train_gene_expr_recon_loss: 8683.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278850.1329; train_optim_loss: 278850.1329; val_kl_reg_loss: 5054.3488; val_edge_recon_loss: 262171.4951; val_gene_expr_recon_loss: 7969.3175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275195.1612; val_optim_loss: 275195.1612
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9866; val_auprc_score: 0.9840; val_best_acc_score: 0.9491; val_best_f1_score: 0.9501; train_kl_reg_loss: 5138.0865; train_edge_recon_loss: 260973.1780; train_gene_expr_recon_loss: 7732.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273843.6594; train_optim_loss: 273843.6594; val_kl_reg_loss: 4942.1947; val_edge_recon_loss: 260550.5997; val_gene_expr_recon_loss: 7572.3448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273065.1393; val_optim_loss: 273065.1393
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9890; val_auprc_score: 0.9865; val_best_acc_score: 0.9558; val_best_f1_score: 0.9566; train_kl_reg_loss: 5154.5862; train_edge_recon_loss: 260140.1091; train_gene_expr_recon_loss: 7459.5183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272754.2132; train_optim_loss: 272754.2132; val_kl_reg_loss: 5095.4182; val_edge_recon_loss: 260038.0779; val_gene_expr_recon_loss: 7332.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272466.4368; val_optim_loss: 272466.4368
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9907; val_auprc_score: 0.9884; val_best_acc_score: 0.9605; val_best_f1_score: 0.9612; train_kl_reg_loss: 5168.1893; train_edge_recon_loss: 259736.4963; train_gene_expr_recon_loss: 7321.0249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272225.7106; train_optim_loss: 272225.7106; val_kl_reg_loss: 5159.2163; val_edge_recon_loss: 259616.1117; val_gene_expr_recon_loss: 7180.7063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271956.0331; val_optim_loss: 271956.0331
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9621; val_best_f1_score: 0.9626; train_kl_reg_loss: 5184.4762; train_edge_recon_loss: 259375.8195; train_gene_expr_recon_loss: 7226.8680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271787.1641; train_optim_loss: 271787.1641; val_kl_reg_loss: 5329.8446; val_edge_recon_loss: 259214.7235; val_gene_expr_recon_loss: 7130.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271674.8232; val_optim_loss: 271674.8232
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9893; val_best_acc_score: 0.9626; val_best_f1_score: 0.9633; train_kl_reg_loss: 5201.3993; train_edge_recon_loss: 259193.4593; train_gene_expr_recon_loss: 7170.9046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271565.7629; train_optim_loss: 271565.7629; val_kl_reg_loss: 5159.0300; val_edge_recon_loss: 259069.8422; val_gene_expr_recon_loss: 7074.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271303.7852; val_optim_loss: 271303.7852
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5210.3172; train_edge_recon_loss: 259067.9495; train_gene_expr_recon_loss: 7127.5570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271405.8238; train_optim_loss: 271405.8238; val_kl_reg_loss: 5179.7170; val_edge_recon_loss: 259023.6994; val_gene_expr_recon_loss: 7046.6830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271250.0979; val_optim_loss: 271250.0979
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9664; val_best_f1_score: 0.9668; train_kl_reg_loss: 5223.2953; train_edge_recon_loss: 258815.4013; train_gene_expr_recon_loss: 7091.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271130.0204; train_optim_loss: 271130.0204; val_kl_reg_loss: 5236.1005; val_edge_recon_loss: 258776.0528; val_gene_expr_recon_loss: 7044.0143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271056.1670; val_optim_loss: 271056.1670
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9927; val_auprc_score: 0.9908; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 5233.2418; train_edge_recon_loss: 258656.3934; train_gene_expr_recon_loss: 7045.3169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270934.9524; train_optim_loss: 270934.9524; val_kl_reg_loss: 5250.6076; val_edge_recon_loss: 258733.7641; val_gene_expr_recon_loss: 6830.0559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270814.4265; val_optim_loss: 270814.4265
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9687; val_best_f1_score: 0.9691; train_kl_reg_loss: 5239.9470; train_edge_recon_loss: 258624.1550; train_gene_expr_recon_loss: 7035.7776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270899.8796; train_optim_loss: 270899.8796; val_kl_reg_loss: 5166.3421; val_edge_recon_loss: 258563.8152; val_gene_expr_recon_loss: 6793.3991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270523.5579; val_optim_loss: 270523.5579
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 5245.0134; train_edge_recon_loss: 258538.4846; train_gene_expr_recon_loss: 7050.4695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270833.9678; train_optim_loss: 270833.9678; val_kl_reg_loss: 5255.5585; val_edge_recon_loss: 258387.8555; val_gene_expr_recon_loss: 7293.8967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270937.3109; val_optim_loss: 270937.3109
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 5251.3532; train_edge_recon_loss: 258414.0535; train_gene_expr_recon_loss: 6650.4748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270315.8812; train_optim_loss: 270315.8812; val_kl_reg_loss: 5162.1238; val_edge_recon_loss: 258494.5909; val_gene_expr_recon_loss: 6332.3705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269989.0852; val_optim_loss: 269989.0852
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9711; val_best_f1_score: 0.9714; train_kl_reg_loss: 5260.4748; train_edge_recon_loss: 258246.0936; train_gene_expr_recon_loss: 6278.5275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269785.0959; train_optim_loss: 269785.0959; val_kl_reg_loss: 5318.4437; val_edge_recon_loss: 258069.0598; val_gene_expr_recon_loss: 5722.6322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269110.1369; val_optim_loss: 269110.1369
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9725; val_best_f1_score: 0.9728; train_kl_reg_loss: 5263.5859; train_edge_recon_loss: 258191.2920; train_gene_expr_recon_loss: 6062.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269516.9930; train_optim_loss: 269516.9930; val_kl_reg_loss: 5266.6209; val_edge_recon_loss: 258256.9083; val_gene_expr_recon_loss: 5921.2098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269444.7380; val_optim_loss: 269444.7380
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 5267.4647; train_edge_recon_loss: 258085.7892; train_gene_expr_recon_loss: 6026.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269379.7742; train_optim_loss: 269379.7742; val_kl_reg_loss: 5109.0303; val_edge_recon_loss: 257768.5192; val_gene_expr_recon_loss: 5955.9172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268833.4661; val_optim_loss: 268833.4661
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 5273.5236; train_edge_recon_loss: 258060.0513; train_gene_expr_recon_loss: 6013.6292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269347.2042; train_optim_loss: 269347.2042; val_kl_reg_loss: 5193.5634; val_edge_recon_loss: 257907.9619; val_gene_expr_recon_loss: 5775.6718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268877.1972; val_optim_loss: 268877.1972
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 5277.8835; train_edge_recon_loss: 257956.9409; train_gene_expr_recon_loss: 6001.3147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269236.1389; train_optim_loss: 269236.1389; val_kl_reg_loss: 5390.1601; val_edge_recon_loss: 258143.8243; val_gene_expr_recon_loss: 6021.5537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269555.5380; val_optim_loss: 269555.5380
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9925; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 5281.2961; train_edge_recon_loss: 257913.8278; train_gene_expr_recon_loss: 5979.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269174.7460; train_optim_loss: 269174.7460; val_kl_reg_loss: 5313.7677; val_edge_recon_loss: 257879.7947; val_gene_expr_recon_loss: 5970.4001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269163.9630; val_optim_loss: 269163.9630
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 5285.2995; train_edge_recon_loss: 257958.2807; train_gene_expr_recon_loss: 5952.4161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269195.9961; train_optim_loss: 269195.9961; val_kl_reg_loss: 5284.5095; val_edge_recon_loss: 257579.9941; val_gene_expr_recon_loss: 5862.0345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268726.5379; val_optim_loss: 268726.5379
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 5289.7708; train_edge_recon_loss: 257784.7224; train_gene_expr_recon_loss: 5945.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269020.0270; train_optim_loss: 269020.0270; val_kl_reg_loss: 5227.9241; val_edge_recon_loss: 257603.4992; val_gene_expr_recon_loss: 5878.8584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268710.2811; val_optim_loss: 268710.2811
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 5288.6354; train_edge_recon_loss: 257792.2447; train_gene_expr_recon_loss: 5940.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269021.3203; train_optim_loss: 269021.3203; val_kl_reg_loss: 5259.7776; val_edge_recon_loss: 257559.7470; val_gene_expr_recon_loss: 5912.6772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268732.2018; val_optim_loss: 268732.2018
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 5294.0323; train_edge_recon_loss: 257781.1311; train_gene_expr_recon_loss: 5931.6251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269006.7889; train_optim_loss: 269006.7889; val_kl_reg_loss: 5113.1880; val_edge_recon_loss: 257510.6361; val_gene_expr_recon_loss: 5845.1322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268468.9580; val_optim_loss: 268468.9580
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 5296.4393; train_edge_recon_loss: 257723.7996; train_gene_expr_recon_loss: 5912.0070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268932.2460; train_optim_loss: 268932.2460; val_kl_reg_loss: 5223.5458; val_edge_recon_loss: 257578.9384; val_gene_expr_recon_loss: 5839.4490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268641.9319; val_optim_loss: 268641.9319
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5299.0952; train_edge_recon_loss: 257645.0911; train_gene_expr_recon_loss: 5902.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268846.9129; train_optim_loss: 268846.9129; val_kl_reg_loss: 5322.7536; val_edge_recon_loss: 257473.1787; val_gene_expr_recon_loss: 5808.3230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268604.2555; val_optim_loss: 268604.2555
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 5301.2553; train_edge_recon_loss: 257627.2412; train_gene_expr_recon_loss: 5903.3097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268831.8059; train_optim_loss: 268831.8059; val_kl_reg_loss: 5400.4553; val_edge_recon_loss: 257528.0164; val_gene_expr_recon_loss: 5943.0154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268871.4870; val_optim_loss: 268871.4870
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 5307.0179; train_edge_recon_loss: 257552.1031; train_gene_expr_recon_loss: 5888.5241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268747.6456; train_optim_loss: 268747.6456; val_kl_reg_loss: 5286.3757; val_edge_recon_loss: 257411.3651; val_gene_expr_recon_loss: 4702.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267400.5029; val_optim_loss: 267400.5029
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 5308.6929; train_edge_recon_loss: 257584.1471; train_gene_expr_recon_loss: 5871.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268764.1542; train_optim_loss: 268764.1542; val_kl_reg_loss: 5258.7058; val_edge_recon_loss: 257265.6656; val_gene_expr_recon_loss: 5812.4380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268336.8096; val_optim_loss: 268336.8096
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 5308.4637; train_edge_recon_loss: 257573.6786; train_gene_expr_recon_loss: 5880.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268762.4275; train_optim_loss: 268762.4275; val_kl_reg_loss: 5290.1735; val_edge_recon_loss: 257224.0087; val_gene_expr_recon_loss: 5770.4833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268284.6671; val_optim_loss: 268284.6671
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 5313.0734; train_edge_recon_loss: 257506.3492; train_gene_expr_recon_loss: 5871.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268691.0351; train_optim_loss: 268691.0351; val_kl_reg_loss: 5274.7364; val_edge_recon_loss: 257185.5357; val_gene_expr_recon_loss: 5906.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268366.7577; val_optim_loss: 268366.7577
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5313.2072; train_edge_recon_loss: 257475.6107; train_gene_expr_recon_loss: 5885.0340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268673.8521; train_optim_loss: 268673.8521; val_kl_reg_loss: 5367.7305; val_edge_recon_loss: 257149.5621; val_gene_expr_recon_loss: 5387.7020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267904.9948; val_optim_loss: 267904.9948

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 5303.7167; train_edge_recon_loss: 257283.9838; train_gene_expr_recon_loss: 5866.5175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268454.2176; train_optim_loss: 268454.2176; val_kl_reg_loss: 5251.2030; val_edge_recon_loss: 257013.3894; val_gene_expr_recon_loss: 6243.3380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268507.9308; val_optim_loss: 268507.9308
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 5299.4908; train_edge_recon_loss: 257215.6373; train_gene_expr_recon_loss: 5861.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268376.3118; train_optim_loss: 268376.3118; val_kl_reg_loss: 5289.8222; val_edge_recon_loss: 257034.7300; val_gene_expr_recon_loss: 5307.9937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267632.5460; val_optim_loss: 267632.5460
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 5294.5025; train_edge_recon_loss: 257278.3707; train_gene_expr_recon_loss: 5857.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268430.7270; train_optim_loss: 268430.7270; val_kl_reg_loss: 5267.5192; val_edge_recon_loss: 256944.2552; val_gene_expr_recon_loss: 5807.6072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268019.3808; val_optim_loss: 268019.3808
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5296.8685; train_edge_recon_loss: 257172.3768; train_gene_expr_recon_loss: 5863.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268332.8309; train_optim_loss: 268332.8309; val_kl_reg_loss: 5289.0257; val_edge_recon_loss: 256784.4905; val_gene_expr_recon_loss: 5807.4581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267880.9737; val_optim_loss: 267880.9737

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 336 min 11 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9947
Val AUPRC score: 0.9930
Val best accuracy score: 0.9762
Val best F1 score: 0.9764
Val gene expr MSE score: 1.9185

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
