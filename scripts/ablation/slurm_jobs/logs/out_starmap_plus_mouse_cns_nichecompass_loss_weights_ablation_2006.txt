None
Run timestamp: 03072023_125310_2006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9843; val_auprc_score: 0.9777; val_best_acc_score: 0.9534; val_best_f1_score: 0.9545; train_kl_reg_loss: 5786.2997; train_edge_recon_loss: 264629.1531; train_gene_expr_recon_loss: 14188.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 284604.0327; train_optim_loss: 284604.0327; val_kl_reg_loss: 5637.9792; val_edge_recon_loss: 257584.9255; val_gene_expr_recon_loss: 12732.9857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275955.8924; val_optim_loss: 275955.8924
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9822; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 5696.1557; train_edge_recon_loss: 258250.4343; train_gene_expr_recon_loss: 12481.9747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276428.5647; train_optim_loss: 276428.5647; val_kl_reg_loss: 5583.6053; val_edge_recon_loss: 257057.0195; val_gene_expr_recon_loss: 12011.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274652.5620; val_optim_loss: 274652.5620
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9900; val_auprc_score: 0.9854; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 5707.6238; train_edge_recon_loss: 257538.4617; train_gene_expr_recon_loss: 11924.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 275170.2083; train_optim_loss: 275170.2083; val_kl_reg_loss: 5720.9577; val_edge_recon_loss: 256103.1570; val_gene_expr_recon_loss: 11586.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273410.3227; val_optim_loss: 273410.3227
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9908; val_auprc_score: 0.9864; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 5712.8509; train_edge_recon_loss: 256991.9786; train_gene_expr_recon_loss: 11615.7618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274320.5916; train_optim_loss: 274320.5916; val_kl_reg_loss: 5658.0732; val_edge_recon_loss: 255805.1043; val_gene_expr_recon_loss: 11347.2642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272810.4401; val_optim_loss: 272810.4401
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9923; val_auprc_score: 0.9890; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 5710.4757; train_edge_recon_loss: 256732.4332; train_gene_expr_recon_loss: 11387.3904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273830.2987; train_optim_loss: 273830.2987; val_kl_reg_loss: 5720.7831; val_edge_recon_loss: 255584.1598; val_gene_expr_recon_loss: 11164.9489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272469.8909; val_optim_loss: 272469.8909
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9895; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 5705.4004; train_edge_recon_loss: 256618.9800; train_gene_expr_recon_loss: 11230.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273555.2520; train_optim_loss: 273555.2520; val_kl_reg_loss: 5652.1991; val_edge_recon_loss: 255583.1883; val_gene_expr_recon_loss: 11009.8323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272245.2172; val_optim_loss: 272245.2172
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9908; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 5706.0400; train_edge_recon_loss: 256411.5544; train_gene_expr_recon_loss: 11098.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273215.9973; train_optim_loss: 273215.9973; val_kl_reg_loss: 5576.9492; val_edge_recon_loss: 255397.9667; val_gene_expr_recon_loss: 10915.1977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271890.1127; val_optim_loss: 271890.1127
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9910; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 5699.7577; train_edge_recon_loss: 256416.5329; train_gene_expr_recon_loss: 10996.9958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273113.2862; train_optim_loss: 273113.2862; val_kl_reg_loss: 5611.3770; val_edge_recon_loss: 255231.4344; val_gene_expr_recon_loss: 10834.3809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271677.1921; val_optim_loss: 271677.1921
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9924; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 5699.4203; train_edge_recon_loss: 256190.5109; train_gene_expr_recon_loss: 10910.6728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272800.6037; train_optim_loss: 272800.6037; val_kl_reg_loss: 5639.2314; val_edge_recon_loss: 255159.4606; val_gene_expr_recon_loss: 10748.8847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271547.5768; val_optim_loss: 271547.5768
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9950; val_auprc_score: 0.9927; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 5700.8008; train_edge_recon_loss: 256111.6185; train_gene_expr_recon_loss: 10832.7463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272645.1657; train_optim_loss: 272645.1657; val_kl_reg_loss: 5688.5483; val_edge_recon_loss: 255225.6788; val_gene_expr_recon_loss: 10630.3835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271544.6101; val_optim_loss: 271544.6101
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9951; val_auprc_score: 0.9926; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 5705.3111; train_edge_recon_loss: 255949.1948; train_gene_expr_recon_loss: 10764.4368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272418.9431; train_optim_loss: 272418.9431; val_kl_reg_loss: 5634.2261; val_edge_recon_loss: 254984.0359; val_gene_expr_recon_loss: 10567.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271186.1501; val_optim_loss: 271186.1501
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9953; val_auprc_score: 0.9928; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 5704.9181; train_edge_recon_loss: 255969.6854; train_gene_expr_recon_loss: 10708.8824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272383.4858; train_optim_loss: 272383.4858; val_kl_reg_loss: 5647.9653; val_edge_recon_loss: 254804.1440; val_gene_expr_recon_loss: 10569.7658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271021.8760; val_optim_loss: 271021.8760
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9958; val_auprc_score: 0.9938; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 5703.4197; train_edge_recon_loss: 255803.9555; train_gene_expr_recon_loss: 10662.1889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272169.5640; train_optim_loss: 272169.5640; val_kl_reg_loss: 5633.4521; val_edge_recon_loss: 254724.9805; val_gene_expr_recon_loss: 10490.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270849.2198; val_optim_loss: 270849.2198
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 5701.9311; train_edge_recon_loss: 255761.2426; train_gene_expr_recon_loss: 10620.1822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272083.3558; train_optim_loss: 272083.3558; val_kl_reg_loss: 5736.5026; val_edge_recon_loss: 254622.2825; val_gene_expr_recon_loss: 10456.4092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270815.1957; val_optim_loss: 270815.1957
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9961; val_auprc_score: 0.9942; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 5700.7533; train_edge_recon_loss: 255678.4894; train_gene_expr_recon_loss: 10580.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271959.6752; train_optim_loss: 271959.6752; val_kl_reg_loss: 5727.7683; val_edge_recon_loss: 254498.4585; val_gene_expr_recon_loss: 10415.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270641.6055; val_optim_loss: 270641.6055
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 5701.7440; train_edge_recon_loss: 255526.2120; train_gene_expr_recon_loss: 10527.8701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271755.8257; train_optim_loss: 271755.8257; val_kl_reg_loss: 5635.0361; val_edge_recon_loss: 254629.8445; val_gene_expr_recon_loss: 10406.3691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270671.2495; val_optim_loss: 270671.2495
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9947; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 5700.1103; train_edge_recon_loss: 255554.0209; train_gene_expr_recon_loss: 10512.1346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271766.2658; train_optim_loss: 271766.2658; val_kl_reg_loss: 5700.3941; val_edge_recon_loss: 254616.2195; val_gene_expr_recon_loss: 10355.6627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270672.2772; val_optim_loss: 270672.2772
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9947; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 5699.8319; train_edge_recon_loss: 255520.3166; train_gene_expr_recon_loss: 10468.0886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271688.2369; train_optim_loss: 271688.2369; val_kl_reg_loss: 5611.0687; val_edge_recon_loss: 254253.3266; val_gene_expr_recon_loss: 10346.1489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270210.5425; val_optim_loss: 270210.5425
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9946; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 5701.6368; train_edge_recon_loss: 255412.5263; train_gene_expr_recon_loss: 10453.6282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271567.7910; train_optim_loss: 271567.7910; val_kl_reg_loss: 5693.2973; val_edge_recon_loss: 254495.3220; val_gene_expr_recon_loss: 10314.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270503.0051; val_optim_loss: 270503.0051
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9967; val_auprc_score: 0.9951; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 5699.3282; train_edge_recon_loss: 255460.8979; train_gene_expr_recon_loss: 10430.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271591.1212; train_optim_loss: 271591.1212; val_kl_reg_loss: 5765.7924; val_edge_recon_loss: 254348.3952; val_gene_expr_recon_loss: 10264.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270378.7736; val_optim_loss: 270378.7736
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9953; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 5702.0912; train_edge_recon_loss: 255359.1605; train_gene_expr_recon_loss: 10408.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271470.0871; train_optim_loss: 271470.0871; val_kl_reg_loss: 5577.2368; val_edge_recon_loss: 254356.2743; val_gene_expr_recon_loss: 10245.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270179.0231; val_optim_loss: 270179.0231
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9969; val_auprc_score: 0.9954; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 5701.5881; train_edge_recon_loss: 255324.3055; train_gene_expr_recon_loss: 10385.9098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271411.8031; train_optim_loss: 271411.8031; val_kl_reg_loss: 5671.8030; val_edge_recon_loss: 254023.8227; val_gene_expr_recon_loss: 10233.1581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269928.7848; val_optim_loss: 269928.7848
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9953; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 5699.3311; train_edge_recon_loss: 255230.5882; train_gene_expr_recon_loss: 10365.8575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271295.7765; train_optim_loss: 271295.7765; val_kl_reg_loss: 5695.7089; val_edge_recon_loss: 254174.9588; val_gene_expr_recon_loss: 10240.0510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270110.7188; val_optim_loss: 270110.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9966; val_auprc_score: 0.9949; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 5702.5759; train_edge_recon_loss: 255183.6330; train_gene_expr_recon_loss: 10353.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271239.3246; train_optim_loss: 271239.3246; val_kl_reg_loss: 5633.0325; val_edge_recon_loss: 254351.0238; val_gene_expr_recon_loss: 10228.5464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270212.6055; val_optim_loss: 270212.6055
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9954; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 5699.6405; train_edge_recon_loss: 255296.8560; train_gene_expr_recon_loss: 10337.9959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271334.4918; train_optim_loss: 271334.4918; val_kl_reg_loss: 5726.7247; val_edge_recon_loss: 254060.5530; val_gene_expr_recon_loss: 10191.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269979.2223; val_optim_loss: 269979.2223
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9971; val_auprc_score: 0.9956; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 5702.7437; train_edge_recon_loss: 255168.2625; train_gene_expr_recon_loss: 10319.9738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271190.9808; train_optim_loss: 271190.9808; val_kl_reg_loss: 5679.6636; val_edge_recon_loss: 254079.1834; val_gene_expr_recon_loss: 10202.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269961.3110; val_optim_loss: 269961.3110

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 5689.0579; train_edge_recon_loss: 255042.2779; train_gene_expr_recon_loss: 10291.4159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271022.7521; train_optim_loss: 271022.7521; val_kl_reg_loss: 5670.9678; val_edge_recon_loss: 253787.7011; val_gene_expr_recon_loss: 10144.8641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269603.5323; val_optim_loss: 269603.5323
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9956; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 5682.7648; train_edge_recon_loss: 255083.5002; train_gene_expr_recon_loss: 10281.5812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271047.8462; train_optim_loss: 271047.8462; val_kl_reg_loss: 5665.1166; val_edge_recon_loss: 253870.5899; val_gene_expr_recon_loss: 10181.3536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269717.0599; val_optim_loss: 269717.0599
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 5684.1241; train_edge_recon_loss: 254966.4663; train_gene_expr_recon_loss: 10273.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270924.2237; train_optim_loss: 270924.2237; val_kl_reg_loss: 5654.1127; val_edge_recon_loss: 253577.6025; val_gene_expr_recon_loss: 10161.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269393.1327; val_optim_loss: 269393.1327
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 5680.9524; train_edge_recon_loss: 254981.4758; train_gene_expr_recon_loss: 10269.9026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270932.3298; train_optim_loss: 270932.3298; val_kl_reg_loss: 5652.8322; val_edge_recon_loss: 253848.6760; val_gene_expr_recon_loss: 10170.5793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269672.0856; val_optim_loss: 269672.0856
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9972; val_auprc_score: 0.9956; val_best_acc_score: 0.9880; val_best_f1_score: 0.9880; train_kl_reg_loss: 5681.3759; train_edge_recon_loss: 255050.0732; train_gene_expr_recon_loss: 10261.7189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270993.1676; train_optim_loss: 270993.1676; val_kl_reg_loss: 5648.3872; val_edge_recon_loss: 253999.6219; val_gene_expr_recon_loss: 10152.6886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269800.6983; val_optim_loss: 269800.6983
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 5679.9741; train_edge_recon_loss: 255000.7844; train_gene_expr_recon_loss: 10266.6187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270947.3764; train_optim_loss: 270947.3764; val_kl_reg_loss: 5642.4862; val_edge_recon_loss: 253698.4698; val_gene_expr_recon_loss: 10152.5452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269493.5015; val_optim_loss: 269493.5015
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 5681.0905; train_edge_recon_loss: 254933.1952; train_gene_expr_recon_loss: 10265.0050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270879.2904; train_optim_loss: 270879.2904; val_kl_reg_loss: 5670.3763; val_edge_recon_loss: 254165.7024; val_gene_expr_recon_loss: 10129.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269965.5328; val_optim_loss: 269965.5328

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9972; val_auprc_score: 0.9958; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 5677.5015; train_edge_recon_loss: 255048.1695; train_gene_expr_recon_loss: 10264.5407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270990.2120; train_optim_loss: 270990.2120; val_kl_reg_loss: 5655.2132; val_edge_recon_loss: 253915.1819; val_gene_expr_recon_loss: 10157.2179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269727.6107; val_optim_loss: 269727.6107
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9972; val_auprc_score: 0.9958; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 5679.2667; train_edge_recon_loss: 254968.8450; train_gene_expr_recon_loss: 10258.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270906.5511; train_optim_loss: 270906.5511; val_kl_reg_loss: 5654.4815; val_edge_recon_loss: 253939.6757; val_gene_expr_recon_loss: 10143.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269737.2618; val_optim_loss: 269737.2618
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 5677.0305; train_edge_recon_loss: 255029.1679; train_gene_expr_recon_loss: 10262.6555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270968.8547; train_optim_loss: 270968.8547; val_kl_reg_loss: 5653.3080; val_edge_recon_loss: 253746.4395; val_gene_expr_recon_loss: 10153.7437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269553.4887; val_optim_loss: 269553.4887
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9961; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 5678.5613; train_edge_recon_loss: 254900.1657; train_gene_expr_recon_loss: 10253.0974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270831.8237; train_optim_loss: 270831.8237; val_kl_reg_loss: 5659.2182; val_edge_recon_loss: 253841.2341; val_gene_expr_recon_loss: 10139.1388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269639.5912; val_optim_loss: 269639.5912

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 217 min 2 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9953
Val best accuracy score: 0.9879
Val best F1 score: 0.9880
Val gene expr MSE score: 0.6368

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
