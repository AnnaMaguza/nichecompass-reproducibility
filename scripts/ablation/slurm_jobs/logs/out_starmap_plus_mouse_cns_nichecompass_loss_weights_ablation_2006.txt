None
Run timestamp: 16072023_213115_2006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9332; val_best_f1_score: 0.9348; train_kl_reg_loss: 108161.3509; train_edge_recon_loss: 3032459.6645; train_gene_expr_recon_loss: 11157071.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14297692.7647; train_optim_loss: 14297692.7647; val_kl_reg_loss: 97258.9322; val_edge_recon_loss: 2755845.4426; val_gene_expr_recon_loss: 10451116.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13304221.0492; val_optim_loss: 13304221.0492
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9863; val_auprc_score: 0.9819; val_best_acc_score: 0.9529; val_best_f1_score: 0.9539; train_kl_reg_loss: 91913.6410; train_edge_recon_loss: 2709511.6356; train_gene_expr_recon_loss: 10252899.8658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13054325.1324; train_optim_loss: 13054325.1324; val_kl_reg_loss: 82838.6238; val_edge_recon_loss: 2696366.4098; val_gene_expr_recon_loss: 10121466.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12900671.9180; val_optim_loss: 12900671.9180
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9848; val_best_acc_score: 0.9566; val_best_f1_score: 0.9575; train_kl_reg_loss: 77974.9194; train_edge_recon_loss: 2677111.0046; train_gene_expr_recon_loss: 10003076.8713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12758162.7831; train_optim_loss: 12758162.7831; val_kl_reg_loss: 73474.3341; val_edge_recon_loss: 2673611.0369; val_gene_expr_recon_loss: 9936544.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12683629.5246; val_optim_loss: 12683629.5246
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9890; val_auprc_score: 0.9856; val_best_acc_score: 0.9590; val_best_f1_score: 0.9598; train_kl_reg_loss: 69299.1325; train_edge_recon_loss: 2660004.0188; train_gene_expr_recon_loss: 9837589.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12566893.0901; train_optim_loss: 12566893.0901; val_kl_reg_loss: 65005.8519; val_edge_recon_loss: 2662836.4180; val_gene_expr_recon_loss: 9827511.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12555353.4098; val_optim_loss: 12555353.4098
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9900; val_auprc_score: 0.9874; val_best_acc_score: 0.9601; val_best_f1_score: 0.9609; train_kl_reg_loss: 63034.2498; train_edge_recon_loss: 2651017.0496; train_gene_expr_recon_loss: 9708701.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12422752.8180; train_optim_loss: 12422752.8180; val_kl_reg_loss: 60048.4902; val_edge_recon_loss: 2652766.1148; val_gene_expr_recon_loss: 9713612.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12426427.0000; val_optim_loss: 12426427.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9907; val_auprc_score: 0.9883; val_best_acc_score: 0.9616; val_best_f1_score: 0.9623; train_kl_reg_loss: 58611.3039; train_edge_recon_loss: 2642698.4894; train_gene_expr_recon_loss: 9621560.2040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12322869.9982; train_optim_loss: 12322869.9982; val_kl_reg_loss: 55565.3201; val_edge_recon_loss: 2643139.9426; val_gene_expr_recon_loss: 9660968.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12359673.9508; val_optim_loss: 12359673.9508
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9908; val_auprc_score: 0.9888; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 55240.8455; train_edge_recon_loss: 2636205.4361; train_gene_expr_recon_loss: 9541163.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12232609.3199; train_optim_loss: 12232609.3199; val_kl_reg_loss: 52836.3943; val_edge_recon_loss: 2642206.8074; val_gene_expr_recon_loss: 9581023.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12276066.7869; val_optim_loss: 12276066.7869
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 52554.6391; train_edge_recon_loss: 2631007.0032; train_gene_expr_recon_loss: 9493582.0570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12177143.6930; train_optim_loss: 12177143.6930; val_kl_reg_loss: 51080.4302; val_edge_recon_loss: 2634975.3934; val_gene_expr_recon_loss: 9568914.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12254969.8361; val_optim_loss: 12254969.8361
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9911; val_auprc_score: 0.9893; val_best_acc_score: 0.9615; val_best_f1_score: 0.9621; train_kl_reg_loss: 50616.0014; train_edge_recon_loss: 2626643.2004; train_gene_expr_recon_loss: 9434865.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12112124.2665; train_optim_loss: 12112124.2665; val_kl_reg_loss: 49117.2097; val_edge_recon_loss: 2633507.5410; val_gene_expr_recon_loss: 9548643.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12231268.2131; val_optim_loss: 12231268.2131
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9915; val_auprc_score: 0.9898; val_best_acc_score: 0.9621; val_best_f1_score: 0.9630; train_kl_reg_loss: 49028.7129; train_edge_recon_loss: 2622624.1305; train_gene_expr_recon_loss: 9389755.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12061408.1875; train_optim_loss: 12061408.1875; val_kl_reg_loss: 47838.4759; val_edge_recon_loss: 2627444.3730; val_gene_expr_recon_loss: 9539482.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12214765.8525; val_optim_loss: 12214765.8525
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 47452.1995; train_edge_recon_loss: 2621821.2073; train_gene_expr_recon_loss: 9354190.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12023464.2022; train_optim_loss: 12023464.2022; val_kl_reg_loss: 46723.0643; val_edge_recon_loss: 2626946.8975; val_gene_expr_recon_loss: 9526811.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12200481.0492; val_optim_loss: 12200481.0492
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 46292.0270; train_edge_recon_loss: 2619358.4733; train_gene_expr_recon_loss: 9316023.0588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11981673.5423; train_optim_loss: 11981673.5423; val_kl_reg_loss: 44533.7632; val_edge_recon_loss: 2625305.2459; val_gene_expr_recon_loss: 9525029.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12194868.2623; val_optim_loss: 12194868.2623
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9916; val_auprc_score: 0.9897; val_best_acc_score: 0.9640; val_best_f1_score: 0.9647; train_kl_reg_loss: 45288.2485; train_edge_recon_loss: 2616879.1098; train_gene_expr_recon_loss: 9287186.1324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11949353.4890; train_optim_loss: 11949353.4890; val_kl_reg_loss: 44468.3804; val_edge_recon_loss: 2622225.6885; val_gene_expr_recon_loss: 9525952.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12192646.9344; val_optim_loss: 12192646.9344
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 44547.0699; train_edge_recon_loss: 2615090.0993; train_gene_expr_recon_loss: 9255545.8502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11915183.0074; train_optim_loss: 11915183.0074; val_kl_reg_loss: 43747.6943; val_edge_recon_loss: 2620439.1598; val_gene_expr_recon_loss: 9520130.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12184317.2623; val_optim_loss: 12184317.2623
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9923; val_auprc_score: 0.9907; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 43694.6886; train_edge_recon_loss: 2613278.8359; train_gene_expr_recon_loss: 9235435.2987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11892408.8070; train_optim_loss: 11892408.8070; val_kl_reg_loss: 42845.1881; val_edge_recon_loss: 2620107.9016; val_gene_expr_recon_loss: 9497665.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12160618.3770; val_optim_loss: 12160618.3770
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9660; val_best_f1_score: 0.9666; train_kl_reg_loss: 42952.3250; train_edge_recon_loss: 2613053.1861; train_gene_expr_recon_loss: 9211789.2261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11867794.7151; train_optim_loss: 11867794.7151; val_kl_reg_loss: 42638.4126; val_edge_recon_loss: 2615956.1066; val_gene_expr_recon_loss: 9534614.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12193208.7377; val_optim_loss: 12193208.7377
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9920; val_auprc_score: 0.9904; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 42482.2707; train_edge_recon_loss: 2610945.8373; train_gene_expr_recon_loss: 9194087.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11847515.3934; train_optim_loss: 11847515.3934; val_kl_reg_loss: 42072.2875; val_edge_recon_loss: 2617989.8402; val_gene_expr_recon_loss: 9543030.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12203092.8197; val_optim_loss: 12203092.8197
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9921; val_auprc_score: 0.9903; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 41990.2280; train_edge_recon_loss: 2609259.4522; train_gene_expr_recon_loss: 9174293.3851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11825543.0772; train_optim_loss: 11825543.0772; val_kl_reg_loss: 41380.2464; val_edge_recon_loss: 2618462.5164; val_gene_expr_recon_loss: 9516858.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12176701.0164; val_optim_loss: 12176701.0164
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9923; val_auprc_score: 0.9907; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 41518.6464; train_edge_recon_loss: 2609298.9150; train_gene_expr_recon_loss: 9163276.2978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11814093.8603; train_optim_loss: 11814093.8603; val_kl_reg_loss: 41080.9802; val_edge_recon_loss: 2618986.4754; val_gene_expr_recon_loss: 9517726.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12177793.6557; val_optim_loss: 12177793.6557

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9926; val_auprc_score: 0.9912; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 42446.5498; train_edge_recon_loss: 2606700.9499; train_gene_expr_recon_loss: 9077500.8419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11726648.3474; train_optim_loss: 11726648.3474; val_kl_reg_loss: 42101.4035; val_edge_recon_loss: 2610086.7582; val_gene_expr_recon_loss: 9497891.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12150079.5410; val_optim_loss: 12150079.5410
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9930; val_auprc_score: 0.9913; val_best_acc_score: 0.9670; val_best_f1_score: 0.9676; train_kl_reg_loss: 42636.8290; train_edge_recon_loss: 2605033.7808; train_gene_expr_recon_loss: 9071401.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11719071.8529; train_optim_loss: 11719071.8529; val_kl_reg_loss: 42007.5416; val_edge_recon_loss: 2609840.6680; val_gene_expr_recon_loss: 9494729.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12146577.4918; val_optim_loss: 12146577.4918
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9926; val_auprc_score: 0.9906; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 42653.5894; train_edge_recon_loss: 2605232.8906; train_gene_expr_recon_loss: 9064409.3603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11712295.8309; train_optim_loss: 11712295.8309; val_kl_reg_loss: 42189.4376; val_edge_recon_loss: 2613198.0902; val_gene_expr_recon_loss: 9502826.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12158213.9508; val_optim_loss: 12158213.9508
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 42632.7159; train_edge_recon_loss: 2605960.1585; train_gene_expr_recon_loss: 9061057.2546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11709650.1305; train_optim_loss: 11709650.1305; val_kl_reg_loss: 42052.9529; val_edge_recon_loss: 2614445.9713; val_gene_expr_recon_loss: 9505044.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12161543.3443; val_optim_loss: 12161543.3443
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 42563.3676; train_edge_recon_loss: 2605144.1930; train_gene_expr_recon_loss: 9063160.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11710867.9596; train_optim_loss: 11710867.9596; val_kl_reg_loss: 42070.7791; val_edge_recon_loss: 2611130.4795; val_gene_expr_recon_loss: 9468117.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12121319.1967; val_optim_loss: 12121319.1967
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9926; val_auprc_score: 0.9912; val_best_acc_score: 0.9660; val_best_f1_score: 0.9666; train_kl_reg_loss: 42543.4298; train_edge_recon_loss: 2605925.0248; train_gene_expr_recon_loss: 9053376.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11701844.9191; train_optim_loss: 11701844.9191; val_kl_reg_loss: 41902.6974; val_edge_recon_loss: 2613113.3402; val_gene_expr_recon_loss: 9507868.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12162884.2787; val_optim_loss: 12162884.2787
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9665; val_best_f1_score: 0.9671; train_kl_reg_loss: 42442.5429; train_edge_recon_loss: 2604430.4550; train_gene_expr_recon_loss: 9059037.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11705910.8364; train_optim_loss: 11705910.8364; val_kl_reg_loss: 41874.5205; val_edge_recon_loss: 2611018.7008; val_gene_expr_recon_loss: 9513482.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12166376.1148; val_optim_loss: 12166376.1148
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 42379.7226; train_edge_recon_loss: 2604875.9067; train_gene_expr_recon_loss: 9046104.0919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11693359.7022; train_optim_loss: 11693359.7022; val_kl_reg_loss: 41831.7605; val_edge_recon_loss: 2614590.6311; val_gene_expr_recon_loss: 9497385.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12153807.3770; val_optim_loss: 12153807.3770
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9926; val_auprc_score: 0.9910; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 42317.8045; train_edge_recon_loss: 2602937.8369; train_gene_expr_recon_loss: 9043429.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11688684.6930; train_optim_loss: 11688684.6930; val_kl_reg_loss: 41780.0464; val_edge_recon_loss: 2610425.1967; val_gene_expr_recon_loss: 9487464.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12139669.3279; val_optim_loss: 12139669.3279

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9928; val_auprc_score: 0.9915; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 42356.2805; train_edge_recon_loss: 2603506.1581; train_gene_expr_recon_loss: 9042164.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11688027.1140; train_optim_loss: 11688027.1140; val_kl_reg_loss: 41803.5674; val_edge_recon_loss: 2609461.2500; val_gene_expr_recon_loss: 9521222.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12172487.3934; val_optim_loss: 12172487.3934
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9928; val_auprc_score: 0.9913; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 42383.4018; train_edge_recon_loss: 2603791.9044; train_gene_expr_recon_loss: 9034211.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11680386.9062; train_optim_loss: 11680386.9062; val_kl_reg_loss: 41873.4274; val_edge_recon_loss: 2610569.6025; val_gene_expr_recon_loss: 9524774.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12177217.7541; val_optim_loss: 12177217.7541
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 42380.8156; train_edge_recon_loss: 2603449.2197; train_gene_expr_recon_loss: 9037145.2381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11682975.2555; train_optim_loss: 11682975.2555; val_kl_reg_loss: 41850.3183; val_edge_recon_loss: 2611038.5410; val_gene_expr_recon_loss: 9491020.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12143909.7869; val_optim_loss: 12143909.7869
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9928; val_auprc_score: 0.9914; val_best_acc_score: 0.9670; val_best_f1_score: 0.9676; train_kl_reg_loss: 42386.9997; train_edge_recon_loss: 2603515.4141; train_gene_expr_recon_loss: 9038656.3051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11684558.7169; train_optim_loss: 11684558.7169; val_kl_reg_loss: 41805.2486; val_edge_recon_loss: 2610153.2705; val_gene_expr_recon_loss: 9498472.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12150431.3934; val_optim_loss: 12150431.3934

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 175 min 36 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9929
Val AUPRC score: 0.9917
Val best accuracy score: 0.9667
Val best F1 score: 0.9673
Val gene expr MSE score: 0.5925

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
