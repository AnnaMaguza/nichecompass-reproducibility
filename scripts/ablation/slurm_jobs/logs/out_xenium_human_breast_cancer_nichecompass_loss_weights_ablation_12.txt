None
Run timestamp: 28062023_164600_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9756; val_auprc_score: 0.9728; val_best_acc_score: 0.9237; val_best_f1_score: 0.9248; train_kl_reg_loss: 1733.4612; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 133032.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134766.4290; train_optim_loss: 134766.4290; val_kl_reg_loss: 1862.4916; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126395.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128257.9559; val_optim_loss: 128257.9559
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9818; val_auprc_score: 0.9804; val_best_acc_score: 0.9330; val_best_f1_score: 0.9340; train_kl_reg_loss: 1900.5487; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124932.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126832.7536; train_optim_loss: 126832.7536; val_kl_reg_loss: 1895.6075; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 122314.4097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 124210.0173; val_optim_loss: 124210.0173
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9873; val_auprc_score: 0.9868; val_best_acc_score: 0.9432; val_best_f1_score: 0.9435; train_kl_reg_loss: 1928.7340; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122001.2387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123929.9727; train_optim_loss: 123929.9727; val_kl_reg_loss: 1909.5402; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 120172.5501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122082.0903; val_optim_loss: 122082.0903
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9882; val_auprc_score: 0.9879; val_best_acc_score: 0.9442; val_best_f1_score: 0.9444; train_kl_reg_loss: 1936.3537; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 120567.9070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 122504.2607; train_optim_loss: 122504.2607; val_kl_reg_loss: 1920.1672; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 119286.8191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 121206.9865; val_optim_loss: 121206.9865
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9888; val_auprc_score: 0.9885; val_best_acc_score: 0.9467; val_best_f1_score: 0.9471; train_kl_reg_loss: 1933.7710; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119682.4331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121616.2040; train_optim_loss: 121616.2040; val_kl_reg_loss: 1904.7025; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118706.3457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120611.0485; val_optim_loss: 120611.0485
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9889; val_auprc_score: 0.9886; val_best_acc_score: 0.9463; val_best_f1_score: 0.9469; train_kl_reg_loss: 1915.5866; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 119135.2952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121050.8818; train_optim_loss: 121050.8818; val_kl_reg_loss: 1885.7369; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118141.9229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120027.6596; val_optim_loss: 120027.6596
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9876; val_auprc_score: 0.9871; val_best_acc_score: 0.9425; val_best_f1_score: 0.9432; train_kl_reg_loss: 1906.2293; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118816.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120723.0101; train_optim_loss: 120723.0101; val_kl_reg_loss: 1847.6833; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 118186.6771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120034.3603; val_optim_loss: 120034.3603
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9882; val_auprc_score: 0.9879; val_best_acc_score: 0.9442; val_best_f1_score: 0.9449; train_kl_reg_loss: 1893.3805; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118623.2699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120516.6504; train_optim_loss: 120516.6504; val_kl_reg_loss: 1849.4990; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117871.0399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119720.5390; val_optim_loss: 119720.5390
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9890; val_auprc_score: 0.9886; val_best_acc_score: 0.9468; val_best_f1_score: 0.9473; train_kl_reg_loss: 1884.9249; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118427.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120312.6692; train_optim_loss: 120312.6692; val_kl_reg_loss: 1840.5776; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117721.8487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119562.4264; val_optim_loss: 119562.4264
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9887; val_best_acc_score: 0.9466; val_best_f1_score: 0.9470; train_kl_reg_loss: 1882.0818; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118313.6224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120195.7042; train_optim_loss: 120195.7042; val_kl_reg_loss: 1872.1242; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117576.5290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119448.6530; val_optim_loss: 119448.6530
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9894; val_auprc_score: 0.9891; val_best_acc_score: 0.9480; val_best_f1_score: 0.9483; train_kl_reg_loss: 1874.8942; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118179.2191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120054.1132; train_optim_loss: 120054.1132; val_kl_reg_loss: 1832.1179; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117681.6087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119513.7268; val_optim_loss: 119513.7268
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9903; val_auprc_score: 0.9902; val_best_acc_score: 0.9505; val_best_f1_score: 0.9507; train_kl_reg_loss: 1871.2203; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118154.3498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 120025.5702; train_optim_loss: 120025.5702; val_kl_reg_loss: 1881.8156; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117496.3388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119378.1548; val_optim_loss: 119378.1548
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9899; val_auprc_score: 0.9898; val_best_acc_score: 0.9490; val_best_f1_score: 0.9492; train_kl_reg_loss: 1868.3519; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118081.4921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119949.8440; train_optim_loss: 119949.8440; val_kl_reg_loss: 1822.9327; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117398.2303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119221.1632; val_optim_loss: 119221.1632
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9490; val_best_f1_score: 0.9494; train_kl_reg_loss: 1862.6926; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 118014.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119876.7382; train_optim_loss: 119876.7382; val_kl_reg_loss: 1836.4785; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117534.9532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119371.4315; val_optim_loss: 119371.4315
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9906; val_auprc_score: 0.9904; val_best_acc_score: 0.9510; val_best_f1_score: 0.9514; train_kl_reg_loss: 1861.9496; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117950.7088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119812.6584; train_optim_loss: 119812.6584; val_kl_reg_loss: 1835.0556; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117308.9605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119144.0162; val_optim_loss: 119144.0162
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9900; val_auprc_score: 0.9898; val_best_acc_score: 0.9494; val_best_f1_score: 0.9494; train_kl_reg_loss: 1860.7089; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117929.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119790.5663; train_optim_loss: 119790.5663; val_kl_reg_loss: 1867.0388; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117350.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119217.6896; val_optim_loss: 119217.6896
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9908; val_auprc_score: 0.9905; val_best_acc_score: 0.9519; val_best_f1_score: 0.9521; train_kl_reg_loss: 1855.2307; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117856.4806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119711.7112; train_optim_loss: 119711.7112; val_kl_reg_loss: 1835.9684; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117256.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119092.3262; val_optim_loss: 119092.3262
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9908; val_auprc_score: 0.9905; val_best_acc_score: 0.9519; val_best_f1_score: 0.9522; train_kl_reg_loss: 1854.5485; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117843.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119697.6146; train_optim_loss: 119697.6146; val_kl_reg_loss: 1821.0270; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117176.1889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118997.2158; val_optim_loss: 118997.2158
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9911; val_auprc_score: 0.9909; val_best_acc_score: 0.9531; val_best_f1_score: 0.9533; train_kl_reg_loss: 1852.4577; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117847.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119700.3601; train_optim_loss: 119700.3601; val_kl_reg_loss: 1802.5492; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117269.0866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119071.6358; val_optim_loss: 119071.6358
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9897; val_auprc_score: 0.9894; val_best_acc_score: 0.9492; val_best_f1_score: 0.9497; train_kl_reg_loss: 1854.3118; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117819.0913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119673.4032; train_optim_loss: 119673.4032; val_kl_reg_loss: 1818.2637; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117271.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119089.6342; val_optim_loss: 119089.6342
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9911; val_auprc_score: 0.9910; val_best_acc_score: 0.9527; val_best_f1_score: 0.9527; train_kl_reg_loss: 1848.7261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117773.7549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119622.4809; train_optim_loss: 119622.4809; val_kl_reg_loss: 1799.1768; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117190.1358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118989.3128; val_optim_loss: 118989.3128
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9921; val_auprc_score: 0.9919; val_best_acc_score: 0.9558; val_best_f1_score: 0.9559; train_kl_reg_loss: 1847.2648; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117723.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119570.6628; train_optim_loss: 119570.6628; val_kl_reg_loss: 1819.3992; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117136.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118956.1940; val_optim_loss: 118956.1940
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9914; val_best_acc_score: 0.9548; val_best_f1_score: 0.9551; train_kl_reg_loss: 1845.1962; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117720.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119566.0994; train_optim_loss: 119566.0994; val_kl_reg_loss: 1863.7789; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117228.0429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119091.8216; val_optim_loss: 119091.8216
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9920; val_auprc_score: 0.9918; val_best_acc_score: 0.9556; val_best_f1_score: 0.9556; train_kl_reg_loss: 1846.3074; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117698.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119545.1682; train_optim_loss: 119545.1682; val_kl_reg_loss: 1805.7900; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117163.6024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118969.3923; val_optim_loss: 118969.3923
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9922; val_auprc_score: 0.9921; val_best_acc_score: 0.9561; val_best_f1_score: 0.9560; train_kl_reg_loss: 1842.3527; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117654.5314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119496.8841; train_optim_loss: 119496.8841; val_kl_reg_loss: 1808.2812; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117379.7461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119188.0272; val_optim_loss: 119188.0272
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9924; val_auprc_score: 0.9924; val_best_acc_score: 0.9567; val_best_f1_score: 0.9570; train_kl_reg_loss: 1839.3387; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 117655.1375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119494.4761; train_optim_loss: 119494.4761; val_kl_reg_loss: 1814.6503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 117272.1690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119086.8192; val_optim_loss: 119086.8192

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9932; val_auprc_score: 0.9927; val_best_acc_score: 0.9596; val_best_f1_score: 0.9598; train_kl_reg_loss: 1453.5152; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116877.6238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 118331.1390; train_optim_loss: 118331.1390; val_kl_reg_loss: 1178.6240; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116552.0296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117730.6539; val_optim_loss: 117730.6539
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9932; val_auprc_score: 0.9931; val_best_acc_score: 0.9593; val_best_f1_score: 0.9595; train_kl_reg_loss: 1089.4479; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116476.6403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117566.0882; train_optim_loss: 117566.0882; val_kl_reg_loss: 1011.3523; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116569.9109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117581.2631; val_optim_loss: 117581.2631
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9935; val_auprc_score: 0.9935; val_best_acc_score: 0.9603; val_best_f1_score: 0.9603; train_kl_reg_loss: 984.5192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116356.6689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117341.1882; train_optim_loss: 117341.1882; val_kl_reg_loss: 946.9004; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116508.1171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117455.0177; val_optim_loss: 117455.0177
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9939; val_auprc_score: 0.9939; val_best_acc_score: 0.9618; val_best_f1_score: 0.9619; train_kl_reg_loss: 944.7701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116245.6644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117190.4345; train_optim_loss: 117190.4345; val_kl_reg_loss: 923.4579; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116517.6007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117441.0586; val_optim_loss: 117441.0586
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9937; val_auprc_score: 0.9938; val_best_acc_score: 0.9610; val_best_f1_score: 0.9609; train_kl_reg_loss: 925.2931; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116209.2732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117134.5664; train_optim_loss: 117134.5664; val_kl_reg_loss: 908.1477; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116512.2118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117420.3592; val_optim_loss: 117420.3592
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9938; val_auprc_score: 0.9937; val_best_acc_score: 0.9611; val_best_f1_score: 0.9612; train_kl_reg_loss: 914.0976; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116156.1868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117070.2844; train_optim_loss: 117070.2844; val_kl_reg_loss: 896.0094; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116620.2498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117516.2592; val_optim_loss: 117516.2592
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9939; val_auprc_score: 0.9937; val_best_acc_score: 0.9619; val_best_f1_score: 0.9621; train_kl_reg_loss: 906.8297; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116167.2009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117074.0307; train_optim_loss: 117074.0307; val_kl_reg_loss: 891.6671; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116636.0942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117527.7615; val_optim_loss: 117527.7615
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9939; val_auprc_score: 0.9941; val_best_acc_score: 0.9618; val_best_f1_score: 0.9620; train_kl_reg_loss: 902.3122; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116137.0953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117039.4074; train_optim_loss: 117039.4074; val_kl_reg_loss: 897.3575; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116708.7936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117606.1510; val_optim_loss: 117606.1510
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9937; val_auprc_score: 0.9937; val_best_acc_score: 0.9611; val_best_f1_score: 0.9612; train_kl_reg_loss: 898.9406; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116121.0310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117019.9717; train_optim_loss: 117019.9717; val_kl_reg_loss: 884.1940; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116575.8951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117460.0895; val_optim_loss: 117460.0895

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9940; val_auprc_score: 0.9941; val_best_acc_score: 0.9623; val_best_f1_score: 0.9623; train_kl_reg_loss: 889.1765; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 116007.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116897.0137; train_optim_loss: 116897.0137; val_kl_reg_loss: 875.8739; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116426.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117302.1567; val_optim_loss: 117302.1567
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9939; val_auprc_score: 0.9941; val_best_acc_score: 0.9621; val_best_f1_score: 0.9621; train_kl_reg_loss: 882.4467; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115929.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116812.3872; train_optim_loss: 116812.3872; val_kl_reg_loss: 871.3378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116426.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117297.3597; val_optim_loss: 117297.3597
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9938; val_auprc_score: 0.9937; val_best_acc_score: 0.9620; val_best_f1_score: 0.9620; train_kl_reg_loss: 878.3155; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115934.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116812.7760; train_optim_loss: 116812.7760; val_kl_reg_loss: 866.1547; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116404.0083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117270.1629; val_optim_loss: 117270.1629
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9940; val_auprc_score: 0.9941; val_best_acc_score: 0.9622; val_best_f1_score: 0.9621; train_kl_reg_loss: 876.1065; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115951.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116827.1398; train_optim_loss: 116827.1398; val_kl_reg_loss: 865.1619; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116353.0457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117218.2078; val_optim_loss: 117218.2078
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9940; val_auprc_score: 0.9939; val_best_acc_score: 0.9625; val_best_f1_score: 0.9624; train_kl_reg_loss: 873.7509; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115934.3111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116808.0621; train_optim_loss: 116808.0621; val_kl_reg_loss: 864.2138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116551.1630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117415.3766; val_optim_loss: 117415.3766
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9939; val_auprc_score: 0.9939; val_best_acc_score: 0.9621; val_best_f1_score: 0.9621; train_kl_reg_loss: 871.5870; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115881.4836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116753.0706; train_optim_loss: 116753.0706; val_kl_reg_loss: 861.3109; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116394.4164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117255.7273; val_optim_loss: 117255.7273
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9938; val_auprc_score: 0.9938; val_best_acc_score: 0.9620; val_best_f1_score: 0.9618; train_kl_reg_loss: 870.8195; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115889.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116760.5411; train_optim_loss: 116760.5411; val_kl_reg_loss: 861.1740; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116495.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117356.7273; val_optim_loss: 117356.7273
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9939; val_auprc_score: 0.9940; val_best_acc_score: 0.9618; val_best_f1_score: 0.9617; train_kl_reg_loss: 869.6273; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115855.0863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116724.7137; train_optim_loss: 116724.7137; val_kl_reg_loss: 858.6890; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116405.5063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117264.1951; val_optim_loss: 117264.1951

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9939; val_auprc_score: 0.9941; val_best_acc_score: 0.9624; val_best_f1_score: 0.9625; train_kl_reg_loss: 868.0896; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115910.6286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116778.7183; train_optim_loss: 116778.7183; val_kl_reg_loss: 858.7482; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116463.7392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117322.4874; val_optim_loss: 117322.4874
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9939; val_auprc_score: 0.9940; val_best_acc_score: 0.9622; val_best_f1_score: 0.9623; train_kl_reg_loss: 868.4624; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115909.6347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116778.0971; train_optim_loss: 116778.0971; val_kl_reg_loss: 858.7855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116474.1385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117332.9240; val_optim_loss: 117332.9240
heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9939; val_auprc_score: 0.9940; val_best_acc_score: 0.9620; val_best_f1_score: 0.9621; train_kl_reg_loss: 868.4609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115879.0133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116747.4743; train_optim_loss: 116747.4743; val_kl_reg_loss: 859.3974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116436.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117295.7392; val_optim_loss: 117295.7392
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9938; val_auprc_score: 0.9938; val_best_acc_score: 0.9618; val_best_f1_score: 0.9617; train_kl_reg_loss: 868.6233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115890.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116759.5732; train_optim_loss: 116759.5732; val_kl_reg_loss: 859.0013; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116328.9785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117187.9795; val_optim_loss: 117187.9795
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9939; val_auprc_score: 0.9941; val_best_acc_score: 0.9622; val_best_f1_score: 0.9625; train_kl_reg_loss: 868.4210; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115877.7744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116746.1954; train_optim_loss: 116746.1954; val_kl_reg_loss: 858.9956; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116370.2001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117229.1954; val_optim_loss: 117229.1954
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9940; val_auprc_score: 0.9941; val_best_acc_score: 0.9621; val_best_f1_score: 0.9624; train_kl_reg_loss: 868.3916; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115877.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116745.8096; train_optim_loss: 116745.8096; val_kl_reg_loss: 858.9758; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116418.5551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117277.5307; val_optim_loss: 117277.5307
heaps
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9939; val_auprc_score: 0.9941; val_best_acc_score: 0.9623; val_best_f1_score: 0.9621; train_kl_reg_loss: 868.4721; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115898.2816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116766.7537; train_optim_loss: 116766.7537; val_kl_reg_loss: 858.9556; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116597.7762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117456.7316; val_optim_loss: 117456.7316
heaps
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9938; val_auprc_score: 0.9938; val_best_acc_score: 0.9620; val_best_f1_score: 0.9620; train_kl_reg_loss: 868.1736; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115896.8436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116765.0172; train_optim_loss: 116765.0172; val_kl_reg_loss: 859.1086; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116542.2562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117401.3645; val_optim_loss: 117401.3645

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

heaps
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9939; val_auprc_score: 0.9938; val_best_acc_score: 0.9620; val_best_f1_score: 0.9623; train_kl_reg_loss: 868.2816; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115862.8625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116731.1441; train_optim_loss: 116731.1441; val_kl_reg_loss: 858.9904; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116471.3078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117330.2983; val_optim_loss: 117330.2983
heaps
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9937; val_auprc_score: 0.9936; val_best_acc_score: 0.9618; val_best_f1_score: 0.9617; train_kl_reg_loss: 868.1766; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115863.3260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116731.5027; train_optim_loss: 116731.5027; val_kl_reg_loss: 859.0914; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116468.2139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117327.3054; val_optim_loss: 117327.3054
heaps
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9939; val_auprc_score: 0.9938; val_best_acc_score: 0.9620; val_best_f1_score: 0.9620; train_kl_reg_loss: 868.2251; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115856.1993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116724.4244; train_optim_loss: 116724.4244; val_kl_reg_loss: 858.8786; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116525.4137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117384.2924; val_optim_loss: 117384.2924
heaps
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9940; val_auprc_score: 0.9940; val_best_acc_score: 0.9630; val_best_f1_score: 0.9632; train_kl_reg_loss: 868.3194; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 115916.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116784.4254; train_optim_loss: 116784.4254; val_kl_reg_loss: 858.7071; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 116433.4919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117292.1987; val_optim_loss: 117292.1987

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 231 min 53 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9940
Val AUPRC score: 0.9941
Val best accuracy score: 0.9622
Val best F1 score: 0.9623
Val gene expr MSE score: 2.6566

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
