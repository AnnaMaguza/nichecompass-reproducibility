Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9891; val_auprc_score: 0.9896; val_best_acc_score: 0.9458; val_best_f1_score: 0.9461; train_kl_reg_loss: 1223.2192; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64176.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65399.4665; train_optim_loss: 65399.4665; val_kl_reg_loss: 1213.7805; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64965.3254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66179.1060; val_optim_loss: 66179.1060
None
Run timestamp: 01072023_063226_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9699; val_auprc_score: 0.9694; val_best_acc_score: 0.9074; val_best_f1_score: 0.9078; train_kl_reg_loss: 2199.7295; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 72076.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 74276.1417; train_optim_loss: 74276.1417; val_kl_reg_loss: 1627.4290; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 67441.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 69068.5406; val_optim_loss: 69068.5406
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9892; val_auprc_score: 0.9899; val_best_acc_score: 0.9463; val_best_f1_score: 0.9466; train_kl_reg_loss: 1223.0633; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64162.6900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65385.7533; train_optim_loss: 65385.7533; val_kl_reg_loss: 1213.7651; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64856.9410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66070.7061; val_optim_loss: 66070.7061
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9765; val_auprc_score: 0.9763; val_best_acc_score: 0.9185; val_best_f1_score: 0.9197; train_kl_reg_loss: 1525.1457; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 66947.0198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 68472.1655; train_optim_loss: 68472.1655; val_kl_reg_loss: 1400.3617; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 66071.9755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 67472.3374; val_optim_loss: 67472.3374

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9892; val_auprc_score: 0.9897; val_best_acc_score: 0.9467; val_best_f1_score: 0.9469; train_kl_reg_loss: 1223.4221; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64164.0855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65387.5075; train_optim_loss: 65387.5075; val_kl_reg_loss: 1213.5785; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64829.2029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66042.7815; val_optim_loss: 66042.7815
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9794; val_auprc_score: 0.9797; val_best_acc_score: 0.9232; val_best_f1_score: 0.9243; train_kl_reg_loss: 1403.5652; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 66131.7245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 67535.2897; train_optim_loss: 67535.2897; val_kl_reg_loss: 1357.0426; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65647.5421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 67004.5848; val_optim_loss: 67004.5848
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9891; val_auprc_score: 0.9897; val_best_acc_score: 0.9459; val_best_f1_score: 0.9461; train_kl_reg_loss: 1223.3110; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64157.9354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65381.2464; train_optim_loss: 65381.2464; val_kl_reg_loss: 1213.6972; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64883.9486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66097.6458; val_optim_loss: 66097.6458
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9810; val_auprc_score: 0.9810; val_best_acc_score: 0.9274; val_best_f1_score: 0.9277; train_kl_reg_loss: 1356.3480; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65789.9846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 67146.3325; train_optim_loss: 67146.3325; val_kl_reg_loss: 1314.2263; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65434.3779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66748.6041; val_optim_loss: 66748.6041
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9817; val_auprc_score: 0.9820; val_best_acc_score: 0.9291; val_best_f1_score: 0.9286; train_kl_reg_loss: 1328.6234; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65570.8781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66899.5015; train_optim_loss: 66899.5015; val_kl_reg_loss: 1262.1862; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65368.6732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66630.8595; val_optim_loss: 66630.8595
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9891; val_auprc_score: 0.9897; val_best_acc_score: 0.9463; val_best_f1_score: 0.9466; train_kl_reg_loss: 1223.2016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64174.4497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65397.6513; train_optim_loss: 65397.6513; val_kl_reg_loss: 1214.0002; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64996.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66210.5572; val_optim_loss: 66210.5572
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9823; val_auprc_score: 0.9826; val_best_acc_score: 0.9295; val_best_f1_score: 0.9297; train_kl_reg_loss: 1308.9296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65501.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66810.2509; train_optim_loss: 66810.2509; val_kl_reg_loss: 1271.7623; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65187.3506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66459.1132; val_optim_loss: 66459.1132
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9890; val_auprc_score: 0.9895; val_best_acc_score: 0.9457; val_best_f1_score: 0.9460; train_kl_reg_loss: 1223.2054; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64185.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65409.0914; train_optim_loss: 65409.0914; val_kl_reg_loss: 1213.3164; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64850.8397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66064.1562; val_optim_loss: 66064.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9832; val_auprc_score: 0.9839; val_best_acc_score: 0.9322; val_best_f1_score: 0.9317; train_kl_reg_loss: 1296.9531; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65349.6866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66646.6397; train_optim_loss: 66646.6397; val_kl_reg_loss: 1271.2959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65248.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66520.2638; val_optim_loss: 66520.2638

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1034 min 55 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9890
Val AUPRC score: 0.9896
Val best accuracy score: 0.9461
Val best F1 score: 0.9463
Val gene expr MSE score: 1.5873

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9840; val_auprc_score: 0.9847; val_best_acc_score: 0.9333; val_best_f1_score: 0.9337; train_kl_reg_loss: 1286.9094; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65284.0733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66570.9826; train_optim_loss: 66570.9826; val_kl_reg_loss: 1278.7196; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65134.8069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66413.5264; val_optim_loss: 66413.5264
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9844; val_auprc_score: 0.9848; val_best_acc_score: 0.9347; val_best_f1_score: 0.9348; train_kl_reg_loss: 1279.6596; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65213.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66492.7259; train_optim_loss: 66492.7259; val_kl_reg_loss: 1280.9437; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65156.7285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66437.6721; val_optim_loss: 66437.6721
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9836; val_auprc_score: 0.9842; val_best_acc_score: 0.9341; val_best_f1_score: 0.9336; train_kl_reg_loss: 1272.6300; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65181.8459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66454.4759; train_optim_loss: 66454.4759; val_kl_reg_loss: 1288.1677; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65061.9502; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66350.1180; val_optim_loss: 66350.1180
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9851; val_auprc_score: 0.9857; val_best_acc_score: 0.9363; val_best_f1_score: 0.9357; train_kl_reg_loss: 1269.7095; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65101.2563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66370.9659; train_optim_loss: 66370.9659; val_kl_reg_loss: 1281.0293; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65016.2518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66297.2811; val_optim_loss: 66297.2811
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9853; val_auprc_score: 0.9859; val_best_acc_score: 0.9364; val_best_f1_score: 0.9369; train_kl_reg_loss: 1265.6386; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65069.8796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66335.5182; train_optim_loss: 66335.5182; val_kl_reg_loss: 1234.3863; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65077.1560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66311.5424; val_optim_loss: 66311.5424
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9859; val_auprc_score: 0.9864; val_best_acc_score: 0.9384; val_best_f1_score: 0.9388; train_kl_reg_loss: 1262.3472; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65047.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66309.9049; train_optim_loss: 66309.9049; val_kl_reg_loss: 1267.4805; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65046.5777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66314.0583; val_optim_loss: 66314.0583
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9862; val_auprc_score: 0.9869; val_best_acc_score: 0.9397; val_best_f1_score: 0.9395; train_kl_reg_loss: 1259.7193; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65011.1768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66270.8962; train_optim_loss: 66270.8962; val_kl_reg_loss: 1242.1684; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64909.2848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66151.4533; val_optim_loss: 66151.4533
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9864; val_best_acc_score: 0.9398; val_best_f1_score: 0.9393; train_kl_reg_loss: 1258.5454; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65000.6624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66259.2078; train_optim_loss: 66259.2078; val_kl_reg_loss: 1233.7640; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65096.1045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66329.8685; val_optim_loss: 66329.8685
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9861; val_auprc_score: 0.9866; val_best_acc_score: 0.9394; val_best_f1_score: 0.9390; train_kl_reg_loss: 1254.7055; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64964.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66219.1938; train_optim_loss: 66219.1938; val_kl_reg_loss: 1282.6575; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65108.4787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66391.1362; val_optim_loss: 66391.1362
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9869; val_auprc_score: 0.9874; val_best_acc_score: 0.9407; val_best_f1_score: 0.9410; train_kl_reg_loss: 1253.0713; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64940.5991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66193.6705; train_optim_loss: 66193.6705; val_kl_reg_loss: 1230.6855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65112.1356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66342.8211; val_optim_loss: 66342.8211
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9869; val_auprc_score: 0.9874; val_best_acc_score: 0.9404; val_best_f1_score: 0.9407; train_kl_reg_loss: 1250.3909; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64898.0359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66148.4268; train_optim_loss: 66148.4268; val_kl_reg_loss: 1225.4449; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65129.3538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66354.7985; val_optim_loss: 66354.7985

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9884; val_auprc_score: 0.9889; val_best_acc_score: 0.9444; val_best_f1_score: 0.9444; train_kl_reg_loss: 1242.6461; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64455.7309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65698.3770; train_optim_loss: 65698.3770; val_kl_reg_loss: 1221.5391; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64747.8858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65969.4247; val_optim_loss: 65969.4247
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9885; val_best_acc_score: 0.9444; val_best_f1_score: 0.9441; train_kl_reg_loss: 1235.4479; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64412.8791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65648.3270; train_optim_loss: 65648.3270; val_kl_reg_loss: 1223.9266; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64772.2049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65996.1314; val_optim_loss: 65996.1314
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9888; val_auprc_score: 0.9893; val_best_acc_score: 0.9459; val_best_f1_score: 0.9455; train_kl_reg_loss: 1234.1004; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64362.6106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65596.7110; train_optim_loss: 65596.7110; val_kl_reg_loss: 1219.9306; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64710.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65930.8690; val_optim_loss: 65930.8690
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9888; val_auprc_score: 0.9894; val_best_acc_score: 0.9460; val_best_f1_score: 0.9456; train_kl_reg_loss: 1232.2326; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64355.3425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65587.5751; train_optim_loss: 65587.5751; val_kl_reg_loss: 1219.6291; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64796.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66016.5907; val_optim_loss: 66016.5907
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9891; val_auprc_score: 0.9897; val_best_acc_score: 0.9464; val_best_f1_score: 0.9459; train_kl_reg_loss: 1231.6754; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64338.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65569.8511; train_optim_loss: 65569.8511; val_kl_reg_loss: 1219.0478; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64688.9610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65908.0088; val_optim_loss: 65908.0088
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9889; val_auprc_score: 0.9894; val_best_acc_score: 0.9462; val_best_f1_score: 0.9456; train_kl_reg_loss: 1230.8914; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64341.9024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65572.7937; train_optim_loss: 65572.7937; val_kl_reg_loss: 1223.0453; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64817.0722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66040.1175; val_optim_loss: 66040.1175
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9887; val_auprc_score: 0.9894; val_best_acc_score: 0.9451; val_best_f1_score: 0.9444; train_kl_reg_loss: 1230.8144; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64344.5504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65575.3648; train_optim_loss: 65575.3648; val_kl_reg_loss: 1220.9298; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64720.4247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65941.3545; val_optim_loss: 65941.3545
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9891; val_auprc_score: 0.9896; val_best_acc_score: 0.9467; val_best_f1_score: 0.9460; train_kl_reg_loss: 1230.4900; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64335.2926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65565.7827; train_optim_loss: 65565.7827; val_kl_reg_loss: 1220.8860; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64783.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66004.3423; val_optim_loss: 66004.3423
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9887; val_auprc_score: 0.9893; val_best_acc_score: 0.9454; val_best_f1_score: 0.9445; train_kl_reg_loss: 1230.0664; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64333.7389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65563.8053; train_optim_loss: 65563.8053; val_kl_reg_loss: 1219.6174; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64768.3006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65987.9181; val_optim_loss: 65987.9181

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9891; val_auprc_score: 0.9897; val_best_acc_score: 0.9460; val_best_f1_score: 0.9456; train_kl_reg_loss: 1230.4879; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64248.6917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65479.1796; train_optim_loss: 65479.1796; val_kl_reg_loss: 1216.6074; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64704.6640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65921.2715; val_optim_loss: 65921.2715
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9891; val_auprc_score: 0.9896; val_best_acc_score: 0.9461; val_best_f1_score: 0.9453; train_kl_reg_loss: 1230.5049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64276.9529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65507.4578; train_optim_loss: 65507.4578; val_kl_reg_loss: 1218.6424; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64678.5937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65897.2360; val_optim_loss: 65897.2360
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9891; val_auprc_score: 0.9897; val_best_acc_score: 0.9463; val_best_f1_score: 0.9456; train_kl_reg_loss: 1230.5288; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64249.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65479.5417; train_optim_loss: 65479.5417; val_kl_reg_loss: 1217.8868; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64746.9257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65964.8124; val_optim_loss: 65964.8124
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9894; val_auprc_score: 0.9898; val_best_acc_score: 0.9468; val_best_f1_score: 0.9460; train_kl_reg_loss: 1230.1103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64250.6331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65480.7434; train_optim_loss: 65480.7434; val_kl_reg_loss: 1220.0413; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64769.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65989.1378; val_optim_loss: 65989.1378
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9893; val_auprc_score: 0.9898; val_best_acc_score: 0.9465; val_best_f1_score: 0.9458; train_kl_reg_loss: 1230.1248; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64227.9457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65458.0705; train_optim_loss: 65458.0705; val_kl_reg_loss: 1218.0460; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64699.4638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65917.5096; val_optim_loss: 65917.5096
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9892; val_auprc_score: 0.9898; val_best_acc_score: 0.9464; val_best_f1_score: 0.9460; train_kl_reg_loss: 1229.8209; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64246.0595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65475.8805; train_optim_loss: 65475.8805; val_kl_reg_loss: 1219.9481; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64814.6864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66034.6347; val_optim_loss: 66034.6347

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9891; val_auprc_score: 0.9895; val_best_acc_score: 0.9462; val_best_f1_score: 0.9456; train_kl_reg_loss: 1229.7289; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64247.3463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65477.0752; train_optim_loss: 65477.0752; val_kl_reg_loss: 1219.2744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64822.8382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66042.1126; val_optim_loss: 66042.1126
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9892; val_auprc_score: 0.9898; val_best_acc_score: 0.9465; val_best_f1_score: 0.9461; train_kl_reg_loss: 1229.6247; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64229.9604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65459.5851; train_optim_loss: 65459.5851; val_kl_reg_loss: 1218.5951; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64740.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65958.8771; val_optim_loss: 65958.8771
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9893; val_auprc_score: 0.9898; val_best_acc_score: 0.9465; val_best_f1_score: 0.9460; train_kl_reg_loss: 1229.6959; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64231.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65461.5420; train_optim_loss: 65461.5420; val_kl_reg_loss: 1219.3579; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64765.6413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65984.9994; val_optim_loss: 65984.9994
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9893; val_auprc_score: 0.9898; val_best_acc_score: 0.9466; val_best_f1_score: 0.9462; train_kl_reg_loss: 1229.4053; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64237.1958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65466.6010; train_optim_loss: 65466.6010; val_kl_reg_loss: 1218.3112; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64756.9919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65975.3030; val_optim_loss: 65975.3030
