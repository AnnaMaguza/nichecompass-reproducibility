None
Run timestamp: 01072023_184922_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9693; val_auprc_score: 0.9686; val_best_acc_score: 0.9064; val_best_f1_score: 0.9072; train_kl_reg_loss: 2269.7969; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 71498.7873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 73768.5843; train_optim_loss: 73768.5843; val_kl_reg_loss: 1668.8275; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 67023.5627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 68692.3902; val_optim_loss: 68692.3902
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9751; val_auprc_score: 0.9753; val_best_acc_score: 0.9164; val_best_f1_score: 0.9159; train_kl_reg_loss: 1549.2436; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 66271.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 67821.2103; train_optim_loss: 67821.2103; val_kl_reg_loss: 1444.3206; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65541.4222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66985.7427; val_optim_loss: 66985.7427
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9789; val_auprc_score: 0.9790; val_best_acc_score: 0.9232; val_best_f1_score: 0.9235; train_kl_reg_loss: 1424.8205; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65428.1051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66852.9256; train_optim_loss: 66852.9256; val_kl_reg_loss: 1390.3332; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 65261.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66651.5561; val_optim_loss: 66651.5561
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9798; val_auprc_score: 0.9801; val_best_acc_score: 0.9256; val_best_f1_score: 0.9261; train_kl_reg_loss: 1370.2311; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 65096.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66466.9937; train_optim_loss: 66466.9937; val_kl_reg_loss: 1340.6296; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64869.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66210.2803; val_optim_loss: 66210.2803
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9791; val_auprc_score: 0.9795; val_best_acc_score: 0.9240; val_best_f1_score: 0.9239; train_kl_reg_loss: 1342.1436; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64876.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66218.5129; train_optim_loss: 66218.5129; val_kl_reg_loss: 1288.8221; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64928.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66217.0267; val_optim_loss: 66217.0267
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9816; val_auprc_score: 0.9817; val_best_acc_score: 0.9301; val_best_f1_score: 0.9299; train_kl_reg_loss: 1326.3126; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64770.9252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66097.2378; train_optim_loss: 66097.2378; val_kl_reg_loss: 1327.9142; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64861.6142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66189.5285; val_optim_loss: 66189.5285
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9823; val_auprc_score: 0.9826; val_best_acc_score: 0.9301; val_best_f1_score: 0.9301; train_kl_reg_loss: 1313.7470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64628.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65942.2354; train_optim_loss: 65942.2354; val_kl_reg_loss: 1305.4670; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64709.2112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66014.6783; val_optim_loss: 66014.6783
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9824; val_auprc_score: 0.9831; val_best_acc_score: 0.9299; val_best_f1_score: 0.9305; train_kl_reg_loss: 1304.5056; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64591.0913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65895.5969; train_optim_loss: 65895.5969; val_kl_reg_loss: 1314.5336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64688.8244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66003.3580; val_optim_loss: 66003.3580
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9827; val_auprc_score: 0.9831; val_best_acc_score: 0.9319; val_best_f1_score: 0.9322; train_kl_reg_loss: 1295.9846; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64508.0196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65804.0042; train_optim_loss: 65804.0042; val_kl_reg_loss: 1278.7326; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64806.7757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66085.5083; val_optim_loss: 66085.5083
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9834; val_auprc_score: 0.9839; val_best_acc_score: 0.9337; val_best_f1_score: 0.9332; train_kl_reg_loss: 1290.5465; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64442.9568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65733.5033; train_optim_loss: 65733.5033; val_kl_reg_loss: 1290.9323; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64651.9046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65942.8367; val_optim_loss: 65942.8367
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9841; val_auprc_score: 0.9847; val_best_acc_score: 0.9348; val_best_f1_score: 0.9343; train_kl_reg_loss: 1286.0653; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64419.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65705.3254; train_optim_loss: 65705.3254; val_kl_reg_loss: 1295.2490; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64735.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66030.4621; val_optim_loss: 66030.4621
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9847; val_auprc_score: 0.9852; val_best_acc_score: 0.9361; val_best_f1_score: 0.9352; train_kl_reg_loss: 1280.5084; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64364.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65644.6306; train_optim_loss: 65644.6306; val_kl_reg_loss: 1262.5871; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64655.1648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65917.7521; val_optim_loss: 65917.7521
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9851; val_auprc_score: 0.9855; val_best_acc_score: 0.9376; val_best_f1_score: 0.9381; train_kl_reg_loss: 1277.4894; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64342.0056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65619.4949; train_optim_loss: 65619.4949; val_kl_reg_loss: 1259.1637; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64699.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65958.5920; val_optim_loss: 65958.5920
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9860; val_auprc_score: 0.9864; val_best_acc_score: 0.9388; val_best_f1_score: 0.9391; train_kl_reg_loss: 1274.1650; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64319.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65594.0115; train_optim_loss: 65594.0115; val_kl_reg_loss: 1274.5563; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64711.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65985.9293; val_optim_loss: 65985.9293
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9857; val_auprc_score: 0.9861; val_best_acc_score: 0.9386; val_best_f1_score: 0.9385; train_kl_reg_loss: 1271.5147; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64270.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65541.7483; train_optim_loss: 65541.7483; val_kl_reg_loss: 1266.2220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64612.0569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65878.2790; val_optim_loss: 65878.2790
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9867; val_auprc_score: 0.9871; val_best_acc_score: 0.9411; val_best_f1_score: 0.9408; train_kl_reg_loss: 1269.4974; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64266.0567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65535.5541; train_optim_loss: 65535.5541; val_kl_reg_loss: 1267.7766; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64668.4303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65936.2068; val_optim_loss: 65936.2068
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9858; val_auprc_score: 0.9862; val_best_acc_score: 0.9390; val_best_f1_score: 0.9384; train_kl_reg_loss: 1266.2772; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64234.3035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65500.5807; train_optim_loss: 65500.5807; val_kl_reg_loss: 1268.0906; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64528.8812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65796.9718; val_optim_loss: 65796.9718
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9861; val_auprc_score: 0.9865; val_best_acc_score: 0.9397; val_best_f1_score: 0.9392; train_kl_reg_loss: 1265.0135; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64235.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65500.5270; train_optim_loss: 65500.5270; val_kl_reg_loss: 1295.4945; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64570.0780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65865.5726; val_optim_loss: 65865.5726
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9872; val_auprc_score: 0.9875; val_best_acc_score: 0.9417; val_best_f1_score: 0.9419; train_kl_reg_loss: 1262.3347; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64209.3408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65471.6754; train_optim_loss: 65471.6754; val_kl_reg_loss: 1221.4633; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64673.7106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65895.1740; val_optim_loss: 65895.1740
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9867; val_auprc_score: 0.9871; val_best_acc_score: 0.9409; val_best_f1_score: 0.9412; train_kl_reg_loss: 1260.4955; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64151.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65411.5170; train_optim_loss: 65411.5170; val_kl_reg_loss: 1265.8223; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64653.3277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65919.1501; val_optim_loss: 65919.1501
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9865; val_auprc_score: 0.9870; val_best_acc_score: 0.9394; val_best_f1_score: 0.9399; train_kl_reg_loss: 1259.1184; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64157.9148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65417.0332; train_optim_loss: 65417.0332; val_kl_reg_loss: 1271.2566; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64539.0865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65810.3433; val_optim_loss: 65810.3433

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9870; val_auprc_score: 0.9876; val_best_acc_score: 0.9425; val_best_f1_score: 0.9421; train_kl_reg_loss: 1258.6325; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63766.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65025.3882; train_optim_loss: 65025.3882; val_kl_reg_loss: 1251.6278; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64364.9473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65616.5752; val_optim_loss: 65616.5752
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9880; val_auprc_score: 0.9885; val_best_acc_score: 0.9439; val_best_f1_score: 0.9435; train_kl_reg_loss: 1254.9874; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63734.5636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64989.5510; train_optim_loss: 64989.5510; val_kl_reg_loss: 1248.4025; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64320.0952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65568.4977; val_optim_loss: 65568.4977
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9875; val_auprc_score: 0.9879; val_best_acc_score: 0.9426; val_best_f1_score: 0.9419; train_kl_reg_loss: 1253.5412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63739.3253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64992.8665; train_optim_loss: 64992.8665; val_kl_reg_loss: 1245.0127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64305.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65550.0324; val_optim_loss: 65550.0324
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9880; val_auprc_score: 0.9885; val_best_acc_score: 0.9441; val_best_f1_score: 0.9433; train_kl_reg_loss: 1254.0904; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63692.4864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64946.5768; train_optim_loss: 64946.5768; val_kl_reg_loss: 1243.8881; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64421.5900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65665.4781; val_optim_loss: 65665.4781
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9882; val_auprc_score: 0.9887; val_best_acc_score: 0.9442; val_best_f1_score: 0.9436; train_kl_reg_loss: 1253.5651; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63705.7412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64959.3063; train_optim_loss: 64959.3063; val_kl_reg_loss: 1246.4017; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64267.2687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65513.6704; val_optim_loss: 65513.6704
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9881; val_auprc_score: 0.9886; val_best_acc_score: 0.9437; val_best_f1_score: 0.9439; train_kl_reg_loss: 1252.8822; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63681.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64934.0670; train_optim_loss: 64934.0670; val_kl_reg_loss: 1241.0353; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64285.5089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65526.5442; val_optim_loss: 65526.5442
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9882; val_auprc_score: 0.9887; val_best_acc_score: 0.9439; val_best_f1_score: 0.9441; train_kl_reg_loss: 1252.7384; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63702.4338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64955.1722; train_optim_loss: 64955.1722; val_kl_reg_loss: 1236.7870; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64362.2013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65598.9884; val_optim_loss: 65598.9884
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9879; val_auprc_score: 0.9884; val_best_acc_score: 0.9430; val_best_f1_score: 0.9433; train_kl_reg_loss: 1251.9150; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63674.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64926.3960; train_optim_loss: 64926.3960; val_kl_reg_loss: 1243.5692; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64370.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65614.1753; val_optim_loss: 65614.1753
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9886; val_auprc_score: 0.9891; val_best_acc_score: 0.9449; val_best_f1_score: 0.9452; train_kl_reg_loss: 1252.1594; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63700.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64952.9233; train_optim_loss: 64952.9233; val_kl_reg_loss: 1242.3266; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64269.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65511.3938; val_optim_loss: 65511.3938
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9886; val_auprc_score: 0.9891; val_best_acc_score: 0.9446; val_best_f1_score: 0.9450; train_kl_reg_loss: 1252.1161; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63661.2693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64913.3854; train_optim_loss: 64913.3854; val_kl_reg_loss: 1243.1819; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64236.8446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65480.0266; val_optim_loss: 65480.0266
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9882; val_auprc_score: 0.9887; val_best_acc_score: 0.9442; val_best_f1_score: 0.9444; train_kl_reg_loss: 1250.8333; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63660.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64911.7036; train_optim_loss: 64911.7036; val_kl_reg_loss: 1242.3815; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64296.0778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65538.4593; val_optim_loss: 65538.4593
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9886; val_auprc_score: 0.9891; val_best_acc_score: 0.9450; val_best_f1_score: 0.9452; train_kl_reg_loss: 1250.0034; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63627.8830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64877.8865; train_optim_loss: 64877.8865; val_kl_reg_loss: 1240.5259; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64306.4532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65546.9792; val_optim_loss: 65546.9792
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9885; val_auprc_score: 0.9889; val_best_acc_score: 0.9447; val_best_f1_score: 0.9448; train_kl_reg_loss: 1251.0738; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63670.8688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64921.9427; train_optim_loss: 64921.9427; val_kl_reg_loss: 1234.5571; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64373.4087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65607.9655; val_optim_loss: 65607.9655
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9884; val_auprc_score: 0.9888; val_best_acc_score: 0.9453; val_best_f1_score: 0.9453; train_kl_reg_loss: 1251.1517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63658.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64909.9858; train_optim_loss: 64909.9858; val_kl_reg_loss: 1237.1759; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64317.7960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65554.9718; val_optim_loss: 65554.9718

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9885; val_auprc_score: 0.9890; val_best_acc_score: 0.9455; val_best_f1_score: 0.9455; train_kl_reg_loss: 1251.6589; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63619.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64871.4438; train_optim_loss: 64871.4438; val_kl_reg_loss: 1241.9674; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64317.1493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65559.1166; val_optim_loss: 65559.1166
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9885; val_auprc_score: 0.9890; val_best_acc_score: 0.9453; val_best_f1_score: 0.9453; train_kl_reg_loss: 1251.0701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63596.0438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64847.1140; train_optim_loss: 64847.1140; val_kl_reg_loss: 1241.4965; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64343.0849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65584.5815; val_optim_loss: 65584.5815
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9887; val_auprc_score: 0.9892; val_best_acc_score: 0.9453; val_best_f1_score: 0.9454; train_kl_reg_loss: 1250.8477; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63588.9802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64839.8279; train_optim_loss: 64839.8279; val_kl_reg_loss: 1243.0184; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64364.5090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65607.5272; val_optim_loss: 65607.5272
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9886; val_auprc_score: 0.9892; val_best_acc_score: 0.9454; val_best_f1_score: 0.9454; train_kl_reg_loss: 1250.7492; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 63584.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64835.5652; train_optim_loss: 64835.5652; val_kl_reg_loss: 1243.0277; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64313.8908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 65556.9185; val_optim_loss: 65556.9185

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 754 min 42 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9889
Val AUPRC score: 0.9894
Val best accuracy score: 0.9455
Val best F1 score: 0.9458
Val gene expr MSE score: 1.5908

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
