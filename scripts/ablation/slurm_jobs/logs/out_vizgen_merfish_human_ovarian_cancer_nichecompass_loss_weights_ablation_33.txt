None
Run timestamp: 05072023_120816_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9726; val_auprc_score: 0.9709; val_best_acc_score: 0.9165; val_best_f1_score: 0.9173; train_kl_reg_loss: 8392.0558; train_edge_recon_loss: 275046.7991; train_gene_expr_recon_loss: 151212.8174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434651.6722; train_optim_loss: 434651.6722; val_kl_reg_loss: 7852.8594; val_edge_recon_loss: 271065.6443; val_gene_expr_recon_loss: 137400.4190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416318.9236; val_optim_loss: 416318.9236
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9795; val_auprc_score: 0.9786; val_best_acc_score: 0.9280; val_best_f1_score: 0.9286; train_kl_reg_loss: 7946.1934; train_edge_recon_loss: 265451.7271; train_gene_expr_recon_loss: 134476.8157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407874.7353; train_optim_loss: 407874.7353; val_kl_reg_loss: 7556.4340; val_edge_recon_loss: 269023.3554; val_gene_expr_recon_loss: 130350.3830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406930.1736; val_optim_loss: 406930.1736
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9823; val_auprc_score: 0.9812; val_best_acc_score: 0.9341; val_best_f1_score: 0.9347; train_kl_reg_loss: 7562.9177; train_edge_recon_loss: 264395.7543; train_gene_expr_recon_loss: 129593.8482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401552.5205; train_optim_loss: 401552.5205; val_kl_reg_loss: 7312.7795; val_edge_recon_loss: 268005.7219; val_gene_expr_recon_loss: 127210.5242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402529.0253; val_optim_loss: 402529.0253
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9833; val_auprc_score: 0.9823; val_best_acc_score: 0.9376; val_best_f1_score: 0.9380; train_kl_reg_loss: 7383.8643; train_edge_recon_loss: 263482.6696; train_gene_expr_recon_loss: 126942.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397808.8348; train_optim_loss: 397808.8348; val_kl_reg_loss: 7098.2036; val_edge_recon_loss: 267524.8746; val_gene_expr_recon_loss: 125223.9867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399847.0639; val_optim_loss: 399847.0639
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9845; val_auprc_score: 0.9834; val_best_acc_score: 0.9391; val_best_f1_score: 0.9396; train_kl_reg_loss: 7264.3712; train_edge_recon_loss: 262981.9779; train_gene_expr_recon_loss: 125243.3076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395489.6564; train_optim_loss: 395489.6564; val_kl_reg_loss: 7048.0679; val_edge_recon_loss: 267235.6514; val_gene_expr_recon_loss: 124070.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398353.8705; val_optim_loss: 398353.8705
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9852; val_auprc_score: 0.9842; val_best_acc_score: 0.9411; val_best_f1_score: 0.9418; train_kl_reg_loss: 7189.4638; train_edge_recon_loss: 262621.0006; train_gene_expr_recon_loss: 124150.5437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393961.0071; train_optim_loss: 393961.0071; val_kl_reg_loss: 6895.7282; val_edge_recon_loss: 267217.9639; val_gene_expr_recon_loss: 122985.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397099.1253; val_optim_loss: 397099.1253
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9854; val_auprc_score: 0.9842; val_best_acc_score: 0.9424; val_best_f1_score: 0.9428; train_kl_reg_loss: 7147.4060; train_edge_recon_loss: 262310.1129; train_gene_expr_recon_loss: 123311.0084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392768.5270; train_optim_loss: 392768.5270; val_kl_reg_loss: 6893.2971; val_edge_recon_loss: 267035.5389; val_gene_expr_recon_loss: 122165.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396094.7233; val_optim_loss: 396094.7233
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9860; val_auprc_score: 0.9853; val_best_acc_score: 0.9432; val_best_f1_score: 0.9438; train_kl_reg_loss: 7120.3139; train_edge_recon_loss: 262122.9920; train_gene_expr_recon_loss: 122586.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391830.0650; train_optim_loss: 391830.0650; val_kl_reg_loss: 6967.7671; val_edge_recon_loss: 266625.8849; val_gene_expr_recon_loss: 121647.5032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395241.1560; val_optim_loss: 395241.1560
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9857; val_auprc_score: 0.9849; val_best_acc_score: 0.9418; val_best_f1_score: 0.9423; train_kl_reg_loss: 7097.4760; train_edge_recon_loss: 261988.2875; train_gene_expr_recon_loss: 122084.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391170.3919; train_optim_loss: 391170.3919; val_kl_reg_loss: 6952.1265; val_edge_recon_loss: 266794.7364; val_gene_expr_recon_loss: 121241.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394988.7631; val_optim_loss: 394988.7631
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9863; val_auprc_score: 0.9851; val_best_acc_score: 0.9441; val_best_f1_score: 0.9445; train_kl_reg_loss: 7077.0210; train_edge_recon_loss: 261773.1624; train_gene_expr_recon_loss: 121679.2397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390529.4229; train_optim_loss: 390529.4229; val_kl_reg_loss: 6885.5132; val_edge_recon_loss: 266495.3852; val_gene_expr_recon_loss: 120813.2516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394194.1500; val_optim_loss: 394194.1500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9869; val_auprc_score: 0.9856; val_best_acc_score: 0.9460; val_best_f1_score: 0.9464; train_kl_reg_loss: 7066.3805; train_edge_recon_loss: 261688.4713; train_gene_expr_recon_loss: 121308.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390063.3243; train_optim_loss: 390063.3243; val_kl_reg_loss: 6882.7346; val_edge_recon_loss: 266397.9865; val_gene_expr_recon_loss: 120573.6555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393854.3776; val_optim_loss: 393854.3776
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9870; val_auprc_score: 0.9860; val_best_acc_score: 0.9459; val_best_f1_score: 0.9464; train_kl_reg_loss: 7059.4391; train_edge_recon_loss: 261433.6386; train_gene_expr_recon_loss: 121001.2075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389494.2854; train_optim_loss: 389494.2854; val_kl_reg_loss: 6867.6431; val_edge_recon_loss: 266354.6811; val_gene_expr_recon_loss: 120376.5337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393598.8580; val_optim_loss: 393598.8580
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9866; val_auprc_score: 0.9855; val_best_acc_score: 0.9458; val_best_f1_score: 0.9459; train_kl_reg_loss: 7052.6925; train_edge_recon_loss: 261412.4869; train_gene_expr_recon_loss: 120739.7952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389204.9751; train_optim_loss: 389204.9751; val_kl_reg_loss: 6999.9988; val_edge_recon_loss: 266394.8675; val_gene_expr_recon_loss: 120082.0222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393476.8878; val_optim_loss: 393476.8878
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9865; val_best_acc_score: 0.9475; val_best_f1_score: 0.9480; train_kl_reg_loss: 7042.5368; train_edge_recon_loss: 261281.2291; train_gene_expr_recon_loss: 120554.8501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388878.6158; train_optim_loss: 388878.6158; val_kl_reg_loss: 6942.3499; val_edge_recon_loss: 265839.1568; val_gene_expr_recon_loss: 120024.4550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392805.9608; val_optim_loss: 392805.9608
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9874; val_auprc_score: 0.9865; val_best_acc_score: 0.9470; val_best_f1_score: 0.9475; train_kl_reg_loss: 7038.2588; train_edge_recon_loss: 261327.5542; train_gene_expr_recon_loss: 120371.9526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388737.7662; train_optim_loss: 388737.7662; val_kl_reg_loss: 6926.5524; val_edge_recon_loss: 266201.5335; val_gene_expr_recon_loss: 119777.0662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392905.1517; val_optim_loss: 392905.1517
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9879; val_auprc_score: 0.9869; val_best_acc_score: 0.9481; val_best_f1_score: 0.9482; train_kl_reg_loss: 7035.4772; train_edge_recon_loss: 261086.5513; train_gene_expr_recon_loss: 120208.4105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388330.4388; train_optim_loss: 388330.4388; val_kl_reg_loss: 7019.8243; val_edge_recon_loss: 266040.3445; val_gene_expr_recon_loss: 119607.2435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392667.4119; val_optim_loss: 392667.4119
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9876; val_auprc_score: 0.9865; val_best_acc_score: 0.9477; val_best_f1_score: 0.9482; train_kl_reg_loss: 7034.1282; train_edge_recon_loss: 261034.5317; train_gene_expr_recon_loss: 120107.4338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388176.0939; train_optim_loss: 388176.0939; val_kl_reg_loss: 6939.0880; val_edge_recon_loss: 266073.6940; val_gene_expr_recon_loss: 119701.5665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392714.3497; val_optim_loss: 392714.3497
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9881; val_auprc_score: 0.9871; val_best_acc_score: 0.9492; val_best_f1_score: 0.9495; train_kl_reg_loss: 7022.9879; train_edge_recon_loss: 261198.2799; train_gene_expr_recon_loss: 119983.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388204.4423; train_optim_loss: 388204.4423; val_kl_reg_loss: 6894.8272; val_edge_recon_loss: 265889.8564; val_gene_expr_recon_loss: 119565.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392349.7065; val_optim_loss: 392349.7065
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9881; val_auprc_score: 0.9870; val_best_acc_score: 0.9493; val_best_f1_score: 0.9496; train_kl_reg_loss: 7017.0218; train_edge_recon_loss: 261154.6085; train_gene_expr_recon_loss: 119916.0004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388087.6311; train_optim_loss: 388087.6311; val_kl_reg_loss: 6899.6563; val_edge_recon_loss: 265828.8662; val_gene_expr_recon_loss: 119331.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392060.0418; val_optim_loss: 392060.0418
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9881; val_auprc_score: 0.9870; val_best_acc_score: 0.9490; val_best_f1_score: 0.9493; train_kl_reg_loss: 7019.2964; train_edge_recon_loss: 261023.3697; train_gene_expr_recon_loss: 119802.2480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387844.9132; train_optim_loss: 387844.9132; val_kl_reg_loss: 6901.2607; val_edge_recon_loss: 265720.6595; val_gene_expr_recon_loss: 119242.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391864.0239; val_optim_loss: 391864.0239
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9887; val_auprc_score: 0.9876; val_best_acc_score: 0.9505; val_best_f1_score: 0.9508; train_kl_reg_loss: 7024.9502; train_edge_recon_loss: 260852.5645; train_gene_expr_recon_loss: 119718.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387595.5713; train_optim_loss: 387595.5713; val_kl_reg_loss: 6716.5621; val_edge_recon_loss: 265424.8513; val_gene_expr_recon_loss: 119275.6896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391417.1043; val_optim_loss: 391417.1043
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9877; val_best_acc_score: 0.9512; val_best_f1_score: 0.9515; train_kl_reg_loss: 7015.9770; train_edge_recon_loss: 260916.8950; train_gene_expr_recon_loss: 119649.8327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387582.7047; train_optim_loss: 387582.7047; val_kl_reg_loss: 6814.4587; val_edge_recon_loss: 265749.4776; val_gene_expr_recon_loss: 119388.9313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391952.8651; val_optim_loss: 391952.8651
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9886; val_auprc_score: 0.9874; val_best_acc_score: 0.9513; val_best_f1_score: 0.9518; train_kl_reg_loss: 7027.3277; train_edge_recon_loss: 260737.9228; train_gene_expr_recon_loss: 119523.0592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387288.3098; train_optim_loss: 387288.3098; val_kl_reg_loss: 6878.2372; val_edge_recon_loss: 265599.0305; val_gene_expr_recon_loss: 119169.5569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391646.8259; val_optim_loss: 391646.8259
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9882; val_auprc_score: 0.9872; val_best_acc_score: 0.9498; val_best_f1_score: 0.9501; train_kl_reg_loss: 7025.8106; train_edge_recon_loss: 260774.9632; train_gene_expr_recon_loss: 119518.9558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387319.7297; train_optim_loss: 387319.7297; val_kl_reg_loss: 6826.0887; val_edge_recon_loss: 265469.3229; val_gene_expr_recon_loss: 119055.3675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391350.7784; val_optim_loss: 391350.7784
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9886; val_auprc_score: 0.9871; val_best_acc_score: 0.9509; val_best_f1_score: 0.9513; train_kl_reg_loss: 7017.5833; train_edge_recon_loss: 260777.7245; train_gene_expr_recon_loss: 119467.1011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387262.4097; train_optim_loss: 387262.4097; val_kl_reg_loss: 6848.8348; val_edge_recon_loss: 265209.9077; val_gene_expr_recon_loss: 118959.1898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391017.9330; val_optim_loss: 391017.9330
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9884; val_auprc_score: 0.9871; val_best_acc_score: 0.9506; val_best_f1_score: 0.9511; train_kl_reg_loss: 7025.0725; train_edge_recon_loss: 260637.0159; train_gene_expr_recon_loss: 119355.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387017.1675; train_optim_loss: 387017.1675; val_kl_reg_loss: 6928.5389; val_edge_recon_loss: 265599.9922; val_gene_expr_recon_loss: 119021.5308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391550.0631; val_optim_loss: 391550.0631
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9887; val_auprc_score: 0.9876; val_best_acc_score: 0.9506; val_best_f1_score: 0.9510; train_kl_reg_loss: 7021.5440; train_edge_recon_loss: 260602.9831; train_gene_expr_recon_loss: 119295.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386920.5190; train_optim_loss: 386920.5190; val_kl_reg_loss: 6860.8107; val_edge_recon_loss: 265432.6264; val_gene_expr_recon_loss: 118948.4848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391241.9205; val_optim_loss: 391241.9205
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9884; val_auprc_score: 0.9873; val_best_acc_score: 0.9498; val_best_f1_score: 0.9503; train_kl_reg_loss: 7018.0543; train_edge_recon_loss: 260609.4404; train_gene_expr_recon_loss: 119287.5585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386915.0535; train_optim_loss: 386915.0535; val_kl_reg_loss: 6852.5578; val_edge_recon_loss: 265548.3847; val_gene_expr_recon_loss: 119009.9659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391410.9085; val_optim_loss: 391410.9085
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9883; val_auprc_score: 0.9868; val_best_acc_score: 0.9512; val_best_f1_score: 0.9515; train_kl_reg_loss: 7020.8823; train_edge_recon_loss: 260551.9489; train_gene_expr_recon_loss: 119186.0128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386758.8443; train_optim_loss: 386758.8443; val_kl_reg_loss: 6973.3354; val_edge_recon_loss: 265461.4477; val_gene_expr_recon_loss: 119053.7001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391488.4855; val_optim_loss: 391488.4855

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9896; val_auprc_score: 0.9886; val_best_acc_score: 0.9525; val_best_f1_score: 0.9527; train_kl_reg_loss: 7020.7428; train_edge_recon_loss: 260177.4618; train_gene_expr_recon_loss: 118195.8389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385394.0432; train_optim_loss: 385394.0432; val_kl_reg_loss: 6910.4610; val_edge_recon_loss: 264726.0357; val_gene_expr_recon_loss: 117912.5244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389549.0205; val_optim_loss: 389549.0205
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9895; val_auprc_score: 0.9883; val_best_acc_score: 0.9532; val_best_f1_score: 0.9537; train_kl_reg_loss: 7016.6618; train_edge_recon_loss: 260225.7024; train_gene_expr_recon_loss: 118010.6491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385253.0133; train_optim_loss: 385253.0133; val_kl_reg_loss: 6887.7420; val_edge_recon_loss: 264893.5304; val_gene_expr_recon_loss: 117847.0913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389628.3653; val_optim_loss: 389628.3653
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9898; val_auprc_score: 0.9887; val_best_acc_score: 0.9540; val_best_f1_score: 0.9544; train_kl_reg_loss: 7013.2547; train_edge_recon_loss: 260151.6336; train_gene_expr_recon_loss: 117980.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385145.1797; train_optim_loss: 385145.1797; val_kl_reg_loss: 6875.2824; val_edge_recon_loss: 264924.7355; val_gene_expr_recon_loss: 117781.0925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389581.1102; val_optim_loss: 389581.1102
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9900; val_auprc_score: 0.9891; val_best_acc_score: 0.9538; val_best_f1_score: 0.9542; train_kl_reg_loss: 7009.7552; train_edge_recon_loss: 260160.2735; train_gene_expr_recon_loss: 117986.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385156.6933; train_optim_loss: 385156.6933; val_kl_reg_loss: 6849.7781; val_edge_recon_loss: 264641.1395; val_gene_expr_recon_loss: 117924.6756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389415.5920; val_optim_loss: 389415.5920
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 7004.6727; train_edge_recon_loss: 260120.3656; train_gene_expr_recon_loss: 117888.7957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385013.8339; train_optim_loss: 385013.8339; val_kl_reg_loss: 6877.4202; val_edge_recon_loss: 265185.0577; val_gene_expr_recon_loss: 117709.2711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389771.7483; val_optim_loss: 389771.7483
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9899; val_auprc_score: 0.9888; val_best_acc_score: 0.9540; val_best_f1_score: 0.9543; train_kl_reg_loss: 7000.9009; train_edge_recon_loss: 260174.2742; train_gene_expr_recon_loss: 117878.1565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385053.3320; train_optim_loss: 385053.3320; val_kl_reg_loss: 6841.8780; val_edge_recon_loss: 265156.8018; val_gene_expr_recon_loss: 117761.2637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389759.9426; val_optim_loss: 389759.9426
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9900; val_auprc_score: 0.9892; val_best_acc_score: 0.9537; val_best_f1_score: 0.9542; train_kl_reg_loss: 6993.2179; train_edge_recon_loss: 260138.3877; train_gene_expr_recon_loss: 117861.7722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384993.3776; train_optim_loss: 384993.3776; val_kl_reg_loss: 6851.5254; val_edge_recon_loss: 265044.0912; val_gene_expr_recon_loss: 117699.5955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389595.2114; val_optim_loss: 389595.2114
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9543; val_best_f1_score: 0.9545; train_kl_reg_loss: 6988.0048; train_edge_recon_loss: 260256.7467; train_gene_expr_recon_loss: 117848.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385093.4070; train_optim_loss: 385093.4070; val_kl_reg_loss: 6884.9242; val_edge_recon_loss: 264924.7027; val_gene_expr_recon_loss: 117719.7936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389529.4233; val_optim_loss: 389529.4233

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9898; val_auprc_score: 0.9886; val_best_acc_score: 0.9536; val_best_f1_score: 0.9539; train_kl_reg_loss: 6988.7914; train_edge_recon_loss: 259998.9773; train_gene_expr_recon_loss: 117692.9454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384680.7136; train_optim_loss: 384680.7136; val_kl_reg_loss: 6862.8672; val_edge_recon_loss: 265013.0112; val_gene_expr_recon_loss: 117617.3985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389493.2767; val_optim_loss: 389493.2767
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9546; val_best_f1_score: 0.9548; train_kl_reg_loss: 6988.8608; train_edge_recon_loss: 260029.7425; train_gene_expr_recon_loss: 117686.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384705.4625; train_optim_loss: 384705.4625; val_kl_reg_loss: 6859.4507; val_edge_recon_loss: 264723.3656; val_gene_expr_recon_loss: 117419.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389002.7230; val_optim_loss: 389002.7230
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9897; val_auprc_score: 0.9884; val_best_acc_score: 0.9540; val_best_f1_score: 0.9542; train_kl_reg_loss: 6988.8938; train_edge_recon_loss: 260132.2350; train_gene_expr_recon_loss: 117697.4363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384818.5649; train_optim_loss: 384818.5649; val_kl_reg_loss: 6856.8787; val_edge_recon_loss: 265034.0112; val_gene_expr_recon_loss: 117466.3513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389357.2423; val_optim_loss: 389357.2423
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9900; val_auprc_score: 0.9888; val_best_acc_score: 0.9546; val_best_f1_score: 0.9548; train_kl_reg_loss: 6988.0875; train_edge_recon_loss: 260149.8516; train_gene_expr_recon_loss: 117687.5411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384825.4810; train_optim_loss: 384825.4810; val_kl_reg_loss: 6868.3514; val_edge_recon_loss: 264590.5330; val_gene_expr_recon_loss: 117645.4581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389104.3401; val_optim_loss: 389104.3401
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9900; val_auprc_score: 0.9890; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 6987.7864; train_edge_recon_loss: 260107.8822; train_gene_expr_recon_loss: 117692.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384788.4027; train_optim_loss: 384788.4027; val_kl_reg_loss: 6855.8281; val_edge_recon_loss: 264550.5550; val_gene_expr_recon_loss: 117703.6446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389110.0281; val_optim_loss: 389110.0281
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9900; val_auprc_score: 0.9889; val_best_acc_score: 0.9543; val_best_f1_score: 0.9546; train_kl_reg_loss: 6986.5704; train_edge_recon_loss: 260127.7196; train_gene_expr_recon_loss: 117616.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384730.5081; train_optim_loss: 384730.5081; val_kl_reg_loss: 6868.5171; val_edge_recon_loss: 265070.4845; val_gene_expr_recon_loss: 117520.3892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389459.3912; val_optim_loss: 389459.3912

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9899; val_auprc_score: 0.9887; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 6986.4294; train_edge_recon_loss: 260140.7784; train_gene_expr_recon_loss: 117664.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384791.7207; train_optim_loss: 384791.7207; val_kl_reg_loss: 6858.5783; val_edge_recon_loss: 264954.7891; val_gene_expr_recon_loss: 117621.0336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389434.4000; val_optim_loss: 389434.4000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9902; val_auprc_score: 0.9892; val_best_acc_score: 0.9543; val_best_f1_score: 0.9545; train_kl_reg_loss: 6983.1677; train_edge_recon_loss: 260203.8630; train_gene_expr_recon_loss: 117653.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384840.6337; train_optim_loss: 384840.6337; val_kl_reg_loss: 6851.9019; val_edge_recon_loss: 264848.2832; val_gene_expr_recon_loss: 117436.5196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389136.7062; val_optim_loss: 389136.7062
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9902; val_auprc_score: 0.9893; val_best_acc_score: 0.9547; val_best_f1_score: 0.9550; train_kl_reg_loss: 6983.6007; train_edge_recon_loss: 260225.9028; train_gene_expr_recon_loss: 117652.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384862.0938; train_optim_loss: 384862.0938; val_kl_reg_loss: 6854.0114; val_edge_recon_loss: 264803.7362; val_gene_expr_recon_loss: 117380.0016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389037.7472; val_optim_loss: 389037.7472
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9902; val_auprc_score: 0.9894; val_best_acc_score: 0.9538; val_best_f1_score: 0.9541; train_kl_reg_loss: 6982.9445; train_edge_recon_loss: 260035.7570; train_gene_expr_recon_loss: 117622.6984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384641.4001; train_optim_loss: 384641.4001; val_kl_reg_loss: 6860.8001; val_edge_recon_loss: 265212.4014; val_gene_expr_recon_loss: 117521.0670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389594.2699; val_optim_loss: 389594.2699

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 126 min 32 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9899
Val AUPRC score: 0.9887
Val best accuracy score: 0.9541
Val best F1 score: 0.9543
Val gene expr MSE score: 8.4528

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
