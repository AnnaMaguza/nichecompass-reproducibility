None
Run timestamp: 19072023_023451_2000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 7879.1327; train_edge_recon_loss: 267652.3101; train_gene_expr_recon_loss: 125696.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401227.4545; train_optim_loss: 401227.4545; val_kl_reg_loss: 7847.4958; val_edge_recon_loss: 260739.2969; val_gene_expr_recon_loss: 113944.7331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382531.5241; val_optim_loss: 382531.5241
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9896; val_auprc_score: 0.9868; val_best_acc_score: 0.9616; val_best_f1_score: 0.9624; train_kl_reg_loss: 7484.4879; train_edge_recon_loss: 260843.3734; train_gene_expr_recon_loss: 110981.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379308.9744; train_optim_loss: 379308.9744; val_kl_reg_loss: 7283.1026; val_edge_recon_loss: 259978.5487; val_gene_expr_recon_loss: 108604.4745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375866.1230; val_optim_loss: 375866.1230
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 7194.8080; train_edge_recon_loss: 260022.4368; train_gene_expr_recon_loss: 106878.9077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374096.1532; train_optim_loss: 374096.1532; val_kl_reg_loss: 7052.4691; val_edge_recon_loss: 259325.5551; val_gene_expr_recon_loss: 105209.7258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371587.7510; val_optim_loss: 371587.7510
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9904; val_best_acc_score: 0.9698; val_best_f1_score: 0.9702; train_kl_reg_loss: 7030.4359; train_edge_recon_loss: 259543.1814; train_gene_expr_recon_loss: 104347.7687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370921.3857; train_optim_loss: 370921.3857; val_kl_reg_loss: 6880.4841; val_edge_recon_loss: 258923.3668; val_gene_expr_recon_loss: 103637.7939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369441.6475; val_optim_loss: 369441.6475
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9934; val_auprc_score: 0.9913; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 6916.2170; train_edge_recon_loss: 259115.5314; train_gene_expr_recon_loss: 102710.5075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368742.2562; train_optim_loss: 368742.2562; val_kl_reg_loss: 6897.9558; val_edge_recon_loss: 258383.5751; val_gene_expr_recon_loss: 102189.5467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367471.0763; val_optim_loss: 367471.0763
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 6822.5872; train_edge_recon_loss: 258915.9654; train_gene_expr_recon_loss: 101596.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367335.5480; train_optim_loss: 367335.5480; val_kl_reg_loss: 6727.2002; val_edge_recon_loss: 258296.3169; val_gene_expr_recon_loss: 101464.0483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366487.5645; val_optim_loss: 366487.5645
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9926; val_best_acc_score: 0.9756; val_best_f1_score: 0.9760; train_kl_reg_loss: 6758.2734; train_edge_recon_loss: 258544.5072; train_gene_expr_recon_loss: 100594.8725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365897.6531; train_optim_loss: 365897.6531; val_kl_reg_loss: 6710.8421; val_edge_recon_loss: 257766.1278; val_gene_expr_recon_loss: 100647.3074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365124.2766; val_optim_loss: 365124.2766
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 6702.8031; train_edge_recon_loss: 258399.7074; train_gene_expr_recon_loss: 99888.6377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364991.1484; train_optim_loss: 364991.1484; val_kl_reg_loss: 6631.4700; val_edge_recon_loss: 257837.4652; val_gene_expr_recon_loss: 100001.7701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364470.7080; val_optim_loss: 364470.7080
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 6662.9649; train_edge_recon_loss: 258092.0743; train_gene_expr_recon_loss: 99412.9420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364167.9812; train_optim_loss: 364167.9812; val_kl_reg_loss: 6646.6266; val_edge_recon_loss: 257513.7830; val_gene_expr_recon_loss: 99626.7850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363787.1926; val_optim_loss: 363787.1926
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9783; val_best_f1_score: 0.9787; train_kl_reg_loss: 6623.6212; train_edge_recon_loss: 257954.1565; train_gene_expr_recon_loss: 98975.2724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363553.0504; train_optim_loss: 363553.0504; val_kl_reg_loss: 6582.3263; val_edge_recon_loss: 257304.0643; val_gene_expr_recon_loss: 99407.6936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363294.0840; val_optim_loss: 363294.0840
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6594.3063; train_edge_recon_loss: 257767.8361; train_gene_expr_recon_loss: 98602.1945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362964.3382; train_optim_loss: 362964.3382; val_kl_reg_loss: 6636.0726; val_edge_recon_loss: 257026.6504; val_gene_expr_recon_loss: 99267.9643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362930.6860; val_optim_loss: 362930.6860
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 6576.6163; train_edge_recon_loss: 257578.3060; train_gene_expr_recon_loss: 98233.9635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362388.8855; train_optim_loss: 362388.8855; val_kl_reg_loss: 6548.8048; val_edge_recon_loss: 257314.6360; val_gene_expr_recon_loss: 99122.3741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362985.8151; val_optim_loss: 362985.8151
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6563.1033; train_edge_recon_loss: 257409.4240; train_gene_expr_recon_loss: 97919.9717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361892.4992; train_optim_loss: 361892.4992; val_kl_reg_loss: 6528.7741; val_edge_recon_loss: 256686.7956; val_gene_expr_recon_loss: 98889.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362105.0369; val_optim_loss: 362105.0369
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6554.8118; train_edge_recon_loss: 257301.4172; train_gene_expr_recon_loss: 97758.2466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361614.4754; train_optim_loss: 361614.4754; val_kl_reg_loss: 6515.3555; val_edge_recon_loss: 256757.2126; val_gene_expr_recon_loss: 99302.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362575.3950; val_optim_loss: 362575.3950
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 6542.3985; train_edge_recon_loss: 257188.4779; train_gene_expr_recon_loss: 97428.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361159.7947; train_optim_loss: 361159.7947; val_kl_reg_loss: 6358.8511; val_edge_recon_loss: 256535.2725; val_gene_expr_recon_loss: 98883.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361777.2690; val_optim_loss: 361777.2690
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 6539.8004; train_edge_recon_loss: 257097.9539; train_gene_expr_recon_loss: 97261.2706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360899.0263; train_optim_loss: 360899.0263; val_kl_reg_loss: 6450.1912; val_edge_recon_loss: 256320.6278; val_gene_expr_recon_loss: 98764.9087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361535.7300; val_optim_loss: 361535.7300
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6537.7357; train_edge_recon_loss: 256998.8737; train_gene_expr_recon_loss: 97079.0579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360615.6675; train_optim_loss: 360615.6675; val_kl_reg_loss: 6447.9212; val_edge_recon_loss: 256532.5218; val_gene_expr_recon_loss: 98721.9489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361702.3929; val_optim_loss: 361702.3929
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 6536.8128; train_edge_recon_loss: 256938.6438; train_gene_expr_recon_loss: 96890.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360365.5454; train_optim_loss: 360365.5454; val_kl_reg_loss: 6527.5934; val_edge_recon_loss: 256317.2528; val_gene_expr_recon_loss: 98578.7198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361423.5630; val_optim_loss: 361423.5630
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 6534.2951; train_edge_recon_loss: 256897.9066; train_gene_expr_recon_loss: 96747.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360179.4538; train_optim_loss: 360179.4538; val_kl_reg_loss: 6445.0215; val_edge_recon_loss: 256339.0174; val_gene_expr_recon_loss: 98638.1869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361422.2213; val_optim_loss: 361422.2213
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9965; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6534.7437; train_edge_recon_loss: 256878.6344; train_gene_expr_recon_loss: 96531.4305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359944.8084; train_optim_loss: 359944.8084; val_kl_reg_loss: 6468.6825; val_edge_recon_loss: 256207.2287; val_gene_expr_recon_loss: 98818.7428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361494.6552; val_optim_loss: 361494.6552
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6539.5753; train_edge_recon_loss: 256736.1219; train_gene_expr_recon_loss: 96443.7657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359719.4623; train_optim_loss: 359719.4623; val_kl_reg_loss: 6525.0074; val_edge_recon_loss: 255978.7572; val_gene_expr_recon_loss: 98726.4731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361230.2372; val_optim_loss: 361230.2372
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6544.7109; train_edge_recon_loss: 256637.2543; train_gene_expr_recon_loss: 96316.0184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359497.9831; train_optim_loss: 359497.9831; val_kl_reg_loss: 6453.1615; val_edge_recon_loss: 256056.1396; val_gene_expr_recon_loss: 98508.9440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361018.2459; val_optim_loss: 361018.2459
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6544.6945; train_edge_recon_loss: 256646.5291; train_gene_expr_recon_loss: 96183.2685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359374.4924; train_optim_loss: 359374.4924; val_kl_reg_loss: 6525.1344; val_edge_recon_loss: 256051.9229; val_gene_expr_recon_loss: 98731.2071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361308.2643; val_optim_loss: 361308.2643
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6547.3891; train_edge_recon_loss: 256597.4970; train_gene_expr_recon_loss: 96005.6225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359150.5072; train_optim_loss: 359150.5072; val_kl_reg_loss: 6464.1299; val_edge_recon_loss: 255853.7743; val_gene_expr_recon_loss: 98586.8887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360904.7900; val_optim_loss: 360904.7900
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 6558.4217; train_edge_recon_loss: 256478.6805; train_gene_expr_recon_loss: 95792.1115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358829.2148; train_optim_loss: 358829.2148; val_kl_reg_loss: 6578.1094; val_edge_recon_loss: 256223.6785; val_gene_expr_recon_loss: 98705.9298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361507.7162; val_optim_loss: 361507.7162
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 6559.2550; train_edge_recon_loss: 256538.6591; train_gene_expr_recon_loss: 95809.1606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358907.0753; train_optim_loss: 358907.0753; val_kl_reg_loss: 6526.5194; val_edge_recon_loss: 255734.4449; val_gene_expr_recon_loss: 98661.5434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360922.5067; val_optim_loss: 360922.5067
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6566.1176; train_edge_recon_loss: 256468.8164; train_gene_expr_recon_loss: 95681.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358716.8205; train_optim_loss: 358716.8205; val_kl_reg_loss: 6524.0392; val_edge_recon_loss: 256037.0789; val_gene_expr_recon_loss: 98732.7285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361293.8484; val_optim_loss: 361293.8484
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6571.0532; train_edge_recon_loss: 256443.7446; train_gene_expr_recon_loss: 95551.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358566.4493; train_optim_loss: 358566.4493; val_kl_reg_loss: 6473.4543; val_edge_recon_loss: 255906.6422; val_gene_expr_recon_loss: 98683.3837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361063.4831; val_optim_loss: 361063.4831

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9966; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6593.9093; train_edge_recon_loss: 256229.5138; train_gene_expr_recon_loss: 94902.7445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357726.1674; train_optim_loss: 357726.1674; val_kl_reg_loss: 6571.1034; val_edge_recon_loss: 255593.2405; val_gene_expr_recon_loss: 98584.1737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360748.5174; val_optim_loss: 360748.5174
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6593.1720; train_edge_recon_loss: 256258.2285; train_gene_expr_recon_loss: 94750.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357601.5302; train_optim_loss: 357601.5302; val_kl_reg_loss: 6543.2191; val_edge_recon_loss: 255837.6749; val_gene_expr_recon_loss: 98343.0309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360723.9262; val_optim_loss: 360723.9262
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6594.2815; train_edge_recon_loss: 256302.5184; train_gene_expr_recon_loss: 94750.4954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357647.2957; train_optim_loss: 357647.2957; val_kl_reg_loss: 6540.0957; val_edge_recon_loss: 255692.5412; val_gene_expr_recon_loss: 98621.3586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360853.9954; val_optim_loss: 360853.9954
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6587.8137; train_edge_recon_loss: 256348.2559; train_gene_expr_recon_loss: 94606.0688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357542.1392; train_optim_loss: 357542.1392; val_kl_reg_loss: 6545.3650; val_edge_recon_loss: 255787.1860; val_gene_expr_recon_loss: 98523.7494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360856.3007; val_optim_loss: 360856.3007
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6590.1276; train_edge_recon_loss: 256263.5370; train_gene_expr_recon_loss: 94587.1102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357440.7752; train_optim_loss: 357440.7752; val_kl_reg_loss: 6547.9388; val_edge_recon_loss: 255521.8858; val_gene_expr_recon_loss: 98456.2697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360526.0973; val_optim_loss: 360526.0973
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6591.1070; train_edge_recon_loss: 256283.7300; train_gene_expr_recon_loss: 94581.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357456.1762; train_optim_loss: 357456.1762; val_kl_reg_loss: 6566.4102; val_edge_recon_loss: 255568.6176; val_gene_expr_recon_loss: 98501.7820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360636.8110; val_optim_loss: 360636.8110
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9967; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6591.1698; train_edge_recon_loss: 256225.9171; train_gene_expr_recon_loss: 94548.1938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357365.2804; train_optim_loss: 357365.2804; val_kl_reg_loss: 6546.7580; val_edge_recon_loss: 255808.5095; val_gene_expr_recon_loss: 98460.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360816.1522; val_optim_loss: 360816.1522
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6589.1510; train_edge_recon_loss: 256246.1108; train_gene_expr_recon_loss: 94519.4344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357354.6955; train_optim_loss: 357354.6955; val_kl_reg_loss: 6554.5674; val_edge_recon_loss: 255644.2894; val_gene_expr_recon_loss: 98567.7780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360766.6363; val_optim_loss: 360766.6363
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6590.8926; train_edge_recon_loss: 256239.3938; train_gene_expr_recon_loss: 94456.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357286.7776; train_optim_loss: 357286.7776; val_kl_reg_loss: 6559.2312; val_edge_recon_loss: 255590.3445; val_gene_expr_recon_loss: 98340.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360490.0558; val_optim_loss: 360490.0558
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6594.7373; train_edge_recon_loss: 256129.1790; train_gene_expr_recon_loss: 94432.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357156.2345; train_optim_loss: 357156.2345; val_kl_reg_loss: 6554.1628; val_edge_recon_loss: 255668.4098; val_gene_expr_recon_loss: 98562.1666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360784.7408; val_optim_loss: 360784.7408
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6593.7137; train_edge_recon_loss: 256227.6318; train_gene_expr_recon_loss: 94424.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357245.5027; train_optim_loss: 357245.5027; val_kl_reg_loss: 6547.2959; val_edge_recon_loss: 255857.8227; val_gene_expr_recon_loss: 98461.4655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360866.5809; val_optim_loss: 360866.5809
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6592.1434; train_edge_recon_loss: 256207.3308; train_gene_expr_recon_loss: 94397.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357197.3181; train_optim_loss: 357197.3181; val_kl_reg_loss: 6561.0908; val_edge_recon_loss: 255810.9836; val_gene_expr_recon_loss: 98782.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361155.0215; val_optim_loss: 361155.0215
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6592.8842; train_edge_recon_loss: 256223.4773; train_gene_expr_recon_loss: 94348.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357165.0420; train_optim_loss: 357165.0420; val_kl_reg_loss: 6555.8102; val_edge_recon_loss: 255608.7582; val_gene_expr_recon_loss: 98453.9563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360618.5246; val_optim_loss: 360618.5246

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6594.7142; train_edge_recon_loss: 256200.1569; train_gene_expr_recon_loss: 94294.5484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357089.4191; train_optim_loss: 357089.4191; val_kl_reg_loss: 6555.9407; val_edge_recon_loss: 255601.9580; val_gene_expr_recon_loss: 98631.8622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360789.7608; val_optim_loss: 360789.7608
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6597.7124; train_edge_recon_loss: 256165.3616; train_gene_expr_recon_loss: 94284.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357047.2609; train_optim_loss: 357047.2609; val_kl_reg_loss: 6563.3951; val_edge_recon_loss: 255617.0505; val_gene_expr_recon_loss: 98710.6355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360891.0804; val_optim_loss: 360891.0804
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6596.8855; train_edge_recon_loss: 256286.9625; train_gene_expr_recon_loss: 94192.3931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357076.2409; train_optim_loss: 357076.2409; val_kl_reg_loss: 6556.8056; val_edge_recon_loss: 255878.7454; val_gene_expr_recon_loss: 98618.1361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361053.6855; val_optim_loss: 361053.6855
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6595.5839; train_edge_recon_loss: 256178.8138; train_gene_expr_recon_loss: 94223.9869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356998.3847; train_optim_loss: 356998.3847; val_kl_reg_loss: 6559.9323; val_edge_recon_loss: 255565.7018; val_gene_expr_recon_loss: 98486.6938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360612.3279; val_optim_loss: 360612.3279

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 351 min 41 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9979
Val AUPRC score: 0.9974
Val best accuracy score: 0.9863
Val best F1 score: 0.9864
Val gene expr MSE score: 0.6372

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
