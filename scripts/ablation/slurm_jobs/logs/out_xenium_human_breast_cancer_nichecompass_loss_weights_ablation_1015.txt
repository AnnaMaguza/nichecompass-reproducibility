None
Run timestamp: 16072023_033808_1015.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1015']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9909; val_auprc_score: 0.9895; val_best_acc_score: 0.9570; val_best_f1_score: 0.9577; train_kl_reg_loss: 15368.2424; train_edge_recon_loss: 26366088.7370; train_gene_expr_recon_loss: 13119564.4418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39501021.4694; train_optim_loss: 39501021.4694; val_kl_reg_loss: 16137.0382; val_edge_recon_loss: 26251078.4460; val_gene_expr_recon_loss: 12558255.2509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38825470.6899; val_optim_loss: 38825470.6899
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9937; val_auprc_score: 0.9927; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 16611.9662; train_edge_recon_loss: 25945198.3817; train_gene_expr_recon_loss: 12400881.6548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38362691.9721; train_optim_loss: 38362691.9721; val_kl_reg_loss: 17171.5299; val_edge_recon_loss: 26097491.5610; val_gene_expr_recon_loss: 12324457.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38439120.2787; val_optim_loss: 38439120.2787
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9899; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 17399.0737; train_edge_recon_loss: 25860960.5516; train_gene_expr_recon_loss: 12267833.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38146193.1109; train_optim_loss: 38146193.1109; val_kl_reg_loss: 17200.3971; val_edge_recon_loss: 26086436.7456; val_gene_expr_recon_loss: 12261221.5993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38364858.6760; val_optim_loss: 38364858.6760
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 17819.6118; train_edge_recon_loss: 25824630.0892; train_gene_expr_recon_loss: 12218565.5132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38061015.2133; train_optim_loss: 38061015.2133; val_kl_reg_loss: 17636.0459; val_edge_recon_loss: 25933809.6376; val_gene_expr_recon_loss: 12233105.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38184551.3868; val_optim_loss: 38184551.3868
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 18028.8167; train_edge_recon_loss: 25797412.8146; train_gene_expr_recon_loss: 12197386.4127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38012827.9736; train_optim_loss: 38012827.9736; val_kl_reg_loss: 18224.9022; val_edge_recon_loss: 25928446.8920; val_gene_expr_recon_loss: 12229227.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38175899.2892; val_optim_loss: 38175899.2892
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 18166.6766; train_edge_recon_loss: 25770740.5128; train_gene_expr_recon_loss: 12186267.2855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37975174.4469; train_optim_loss: 37975174.4469; val_kl_reg_loss: 18268.9485; val_edge_recon_loss: 25901237.9861; val_gene_expr_recon_loss: 12197885.1359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38117392.0279; val_optim_loss: 38117392.0279
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 18254.2476; train_edge_recon_loss: 25748703.1125; train_gene_expr_recon_loss: 12179155.2048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37946112.5570; train_optim_loss: 37946112.5570; val_kl_reg_loss: 18163.8070; val_edge_recon_loss: 25978558.5854; val_gene_expr_recon_loss: 12229184.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38225907.2892; val_optim_loss: 38225907.2892
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 18260.2612; train_edge_recon_loss: 25734407.6036; train_gene_expr_recon_loss: 12179795.4317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37932463.3157; train_optim_loss: 37932463.3157; val_kl_reg_loss: 18022.8086; val_edge_recon_loss: 25870467.0662; val_gene_expr_recon_loss: 12201040.0453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38089529.8537; val_optim_loss: 38089529.8537
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 18301.6884; train_edge_recon_loss: 25725652.2157; train_gene_expr_recon_loss: 12168435.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37912388.9123; train_optim_loss: 37912388.9123; val_kl_reg_loss: 18290.0783; val_edge_recon_loss: 25833769.7352; val_gene_expr_recon_loss: 12192761.2822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38044821.0592; val_optim_loss: 38044821.0592
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 18312.9863; train_edge_recon_loss: 25715354.8355; train_gene_expr_recon_loss: 12168366.8891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37902034.7122; train_optim_loss: 37902034.7122; val_kl_reg_loss: 18379.3351; val_edge_recon_loss: 25812838.5226; val_gene_expr_recon_loss: 12215279.7735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38046497.6725; val_optim_loss: 38046497.6725
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 18304.1643; train_edge_recon_loss: 25703997.6672; train_gene_expr_recon_loss: 12164629.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37886930.9263; train_optim_loss: 37886930.9263; val_kl_reg_loss: 18790.4048; val_edge_recon_loss: 25808114.5645; val_gene_expr_recon_loss: 12194092.8153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38020997.7003; val_optim_loss: 38020997.7003
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 18274.2206; train_edge_recon_loss: 25707248.9092; train_gene_expr_recon_loss: 12163009.6098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37888532.7742; train_optim_loss: 37888532.7742; val_kl_reg_loss: 17999.4093; val_edge_recon_loss: 25794694.6760; val_gene_expr_recon_loss: 12176080.4948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37988774.6760; val_optim_loss: 37988774.6760
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 18255.1844; train_edge_recon_loss: 25694556.5469; train_gene_expr_recon_loss: 12160532.0291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37873343.7533; train_optim_loss: 37873343.7533; val_kl_reg_loss: 17980.2782; val_edge_recon_loss: 25993413.4007; val_gene_expr_recon_loss: 12203160.6760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38214554.3136; val_optim_loss: 38214554.3136
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 18220.8272; train_edge_recon_loss: 25689974.8542; train_gene_expr_recon_loss: 12156786.3569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37864981.9969; train_optim_loss: 37864981.9969; val_kl_reg_loss: 18311.3780; val_edge_recon_loss: 25761274.4530; val_gene_expr_recon_loss: 12179376.1916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37958962.0348; val_optim_loss: 37958962.0348
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 18195.0707; train_edge_recon_loss: 25677620.4003; train_gene_expr_recon_loss: 12153797.2859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37849612.7680; train_optim_loss: 37849612.7680; val_kl_reg_loss: 17949.0548; val_edge_recon_loss: 25848771.7770; val_gene_expr_recon_loss: 12189806.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38056527.1777; val_optim_loss: 38056527.1777
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 18142.8315; train_edge_recon_loss: 25677387.5283; train_gene_expr_recon_loss: 12154633.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37850163.4399; train_optim_loss: 37850163.4399; val_kl_reg_loss: 17853.9262; val_edge_recon_loss: 25743884.7666; val_gene_expr_recon_loss: 12195554.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37957293.4216; val_optim_loss: 37957293.4216
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 18185.6741; train_edge_recon_loss: 25666838.5881; train_gene_expr_recon_loss: 12147743.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37832768.1645; train_optim_loss: 37832768.1645; val_kl_reg_loss: 17897.6348; val_edge_recon_loss: 25812208.1185; val_gene_expr_recon_loss: 12194429.1742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38024534.9129; val_optim_loss: 38024534.9129
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 18113.9532; train_edge_recon_loss: 25661824.1536; train_gene_expr_recon_loss: 12147382.9329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37827321.0659; train_optim_loss: 37827321.0659; val_kl_reg_loss: 18274.2745; val_edge_recon_loss: 25742887.0453; val_gene_expr_recon_loss: 12183522.0836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37944683.5401; val_optim_loss: 37944683.5401
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 18098.1355; train_edge_recon_loss: 25654944.4810; train_gene_expr_recon_loss: 12150792.3270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37823834.9310; train_optim_loss: 37823834.9310; val_kl_reg_loss: 18090.0360; val_edge_recon_loss: 25739401.6028; val_gene_expr_recon_loss: 12198349.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37955841.4077; val_optim_loss: 37955841.4077
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 18051.1945; train_edge_recon_loss: 25660021.2537; train_gene_expr_recon_loss: 12141500.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37819573.3095; train_optim_loss: 37819573.3095; val_kl_reg_loss: 17960.2715; val_edge_recon_loss: 25756269.3240; val_gene_expr_recon_loss: 12175107.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37949336.8223; val_optim_loss: 37949336.8223
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 18035.1848; train_edge_recon_loss: 25654586.6253; train_gene_expr_recon_loss: 12145176.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37817797.8371; train_optim_loss: 37817797.8371; val_kl_reg_loss: 17642.8063; val_edge_recon_loss: 25730219.9582; val_gene_expr_recon_loss: 12183316.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37931178.7875; val_optim_loss: 37931178.7875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 17983.6779; train_edge_recon_loss: 25648689.7370; train_gene_expr_recon_loss: 12147904.9503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37814578.3739; train_optim_loss: 37814578.3739; val_kl_reg_loss: 17734.3189; val_edge_recon_loss: 25769422.8293; val_gene_expr_recon_loss: 12174914.7003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37962071.9303; val_optim_loss: 37962071.9303
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 17972.4642; train_edge_recon_loss: 25650295.3002; train_gene_expr_recon_loss: 12143693.5888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37811961.3359; train_optim_loss: 37811961.3359; val_kl_reg_loss: 17792.3577; val_edge_recon_loss: 25735048.5017; val_gene_expr_recon_loss: 12191516.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37944356.7666; val_optim_loss: 37944356.7666
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 17927.7041; train_edge_recon_loss: 25638768.0884; train_gene_expr_recon_loss: 12146546.6594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37803242.4981; train_optim_loss: 37803242.4981; val_kl_reg_loss: 18031.3914; val_edge_recon_loss: 25713937.0592; val_gene_expr_recon_loss: 12214609.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37946578.2718; val_optim_loss: 37946578.2718
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 17919.7092; train_edge_recon_loss: 25641067.1179; train_gene_expr_recon_loss: 12137795.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37796781.9162; train_optim_loss: 37796781.9162; val_kl_reg_loss: 17653.7248; val_edge_recon_loss: 25730659.8606; val_gene_expr_recon_loss: 12185854.7456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37934168.3066; val_optim_loss: 37934168.3066

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9779; val_best_f1_score: 0.9781; train_kl_reg_loss: 19186.4794; train_edge_recon_loss: 25613892.4220; train_gene_expr_recon_loss: 12059190.2180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37692269.0846; train_optim_loss: 37692269.0846; val_kl_reg_loss: 19040.7753; val_edge_recon_loss: 25649122.9408; val_gene_expr_recon_loss: 12095560.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37763724.5436; val_optim_loss: 37763724.5436
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 18788.4980; train_edge_recon_loss: 25601681.0721; train_gene_expr_recon_loss: 12048645.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37669114.9077; train_optim_loss: 37669114.9077; val_kl_reg_loss: 18402.7707; val_edge_recon_loss: 25658565.8746; val_gene_expr_recon_loss: 12094425.9408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37771394.4948; val_optim_loss: 37771394.4948
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9781; val_best_f1_score: 0.9783; train_kl_reg_loss: 18343.5551; train_edge_recon_loss: 25605775.7168; train_gene_expr_recon_loss: 12045792.9624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37669912.2203; train_optim_loss: 37669912.2203; val_kl_reg_loss: 18151.9861; val_edge_recon_loss: 25653722.8920; val_gene_expr_recon_loss: 12105274.1150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37777149.0174; val_optim_loss: 37777149.0174
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 18101.7307; train_edge_recon_loss: 25601423.1202; train_gene_expr_recon_loss: 12046159.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37665684.7339; train_optim_loss: 37665684.7339; val_kl_reg_loss: 17739.4493; val_edge_recon_loss: 25658659.3380; val_gene_expr_recon_loss: 12091828.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37768227.2334; val_optim_loss: 37768227.2334
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 17937.1787; train_edge_recon_loss: 25599876.7246; train_gene_expr_recon_loss: 12043589.0943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37661403.0085; train_optim_loss: 37661403.0085; val_kl_reg_loss: 17776.7361; val_edge_recon_loss: 25664398.2021; val_gene_expr_recon_loss: 12098229.9373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37780404.9617; val_optim_loss: 37780404.9617

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 18008.9933; train_edge_recon_loss: 25597546.0194; train_gene_expr_recon_loss: 12030266.7308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37645821.7316; train_optim_loss: 37645821.7316; val_kl_reg_loss: 17961.6437; val_edge_recon_loss: 25659441.0383; val_gene_expr_recon_loss: 12082017.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37759420.1672; val_optim_loss: 37759420.1672
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 18069.1322; train_edge_recon_loss: 25595403.5353; train_gene_expr_recon_loss: 12028491.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37641964.4267; train_optim_loss: 37641964.4267; val_kl_reg_loss: 17948.5789; val_edge_recon_loss: 25662070.7735; val_gene_expr_recon_loss: 12083304.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37763324.0418; val_optim_loss: 37763324.0418
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 18064.7827; train_edge_recon_loss: 25599554.0450; train_gene_expr_recon_loss: 12025457.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37643075.8340; train_optim_loss: 37643075.8340; val_kl_reg_loss: 17951.4734; val_edge_recon_loss: 25650691.0314; val_gene_expr_recon_loss: 12080102.6899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37748745.1568; val_optim_loss: 37748745.1568
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 18052.0054; train_edge_recon_loss: 25596968.0326; train_gene_expr_recon_loss: 12027902.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37642922.3243; train_optim_loss: 37642922.3243; val_kl_reg_loss: 17951.2897; val_edge_recon_loss: 25646772.6760; val_gene_expr_recon_loss: 12079913.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37744637.3937; val_optim_loss: 37744637.3937
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 18020.4919; train_edge_recon_loss: 25601463.1009; train_gene_expr_recon_loss: 12027375.6819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37646859.2211; train_optim_loss: 37646859.2211; val_kl_reg_loss: 17909.7151; val_edge_recon_loss: 25644864.9268; val_gene_expr_recon_loss: 12093131.9861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37755906.6481; val_optim_loss: 37755906.6481
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 18012.4627; train_edge_recon_loss: 25596033.9612; train_gene_expr_recon_loss: 12024621.7521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37638668.2560; train_optim_loss: 37638668.2560; val_kl_reg_loss: 17937.9161; val_edge_recon_loss: 25656212.8293; val_gene_expr_recon_loss: 12093697.7003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37767848.4321; val_optim_loss: 37767848.4321
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 18005.8747; train_edge_recon_loss: 25586032.4585; train_gene_expr_recon_loss: 12022165.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37626203.7285; train_optim_loss: 37626203.7285; val_kl_reg_loss: 17906.9239; val_edge_recon_loss: 25673129.0523; val_gene_expr_recon_loss: 12084930.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37775966.5087; val_optim_loss: 37775966.5087
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9954; val_auprc_score: 0.9940; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 17981.1410; train_edge_recon_loss: 25592248.3173; train_gene_expr_recon_loss: 12022062.3844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37632291.8464; train_optim_loss: 37632291.8464; val_kl_reg_loss: 17877.2608; val_edge_recon_loss: 25656866.9477; val_gene_expr_recon_loss: 12082359.4774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37757103.8049; val_optim_loss: 37757103.8049

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17975.6049; train_edge_recon_loss: 25599176.7386; train_gene_expr_recon_loss: 12025269.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37642421.9410; train_optim_loss: 37642421.9410; val_kl_reg_loss: 17872.2314; val_edge_recon_loss: 25640364.8850; val_gene_expr_recon_loss: 12079520.4530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37737757.5610; val_optim_loss: 37737757.5610
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 17976.9353; train_edge_recon_loss: 25600715.0908; train_gene_expr_recon_loss: 12023823.2106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37642515.2273; train_optim_loss: 37642515.2273; val_kl_reg_loss: 17877.6689; val_edge_recon_loss: 25655238.0139; val_gene_expr_recon_loss: 12085170.4077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37758286.2160; val_optim_loss: 37758286.2160
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 17979.8710; train_edge_recon_loss: 25596754.6843; train_gene_expr_recon_loss: 12027453.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37642187.6012; train_optim_loss: 37642187.6012; val_kl_reg_loss: 17878.2311; val_edge_recon_loss: 25676515.2544; val_gene_expr_recon_loss: 12083653.3484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37778046.7178; val_optim_loss: 37778046.7178
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 17980.8009; train_edge_recon_loss: 25595470.9488; train_gene_expr_recon_loss: 12026772.9853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37640224.7556; train_optim_loss: 37640224.7556; val_kl_reg_loss: 17880.6946; val_edge_recon_loss: 25670870.4460; val_gene_expr_recon_loss: 12090358.9791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37779110.1882; val_optim_loss: 37779110.1882
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 17981.9309; train_edge_recon_loss: 25595224.2025; train_gene_expr_recon_loss: 12021384.9139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37634591.0504; train_optim_loss: 37634591.0504; val_kl_reg_loss: 17888.8516; val_edge_recon_loss: 25659840.9059; val_gene_expr_recon_loss: 12080604.6063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37758334.5645; val_optim_loss: 37758334.5645

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17989.0405; train_edge_recon_loss: 25593103.7719; train_gene_expr_recon_loss: 12022487.7886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37633580.5446; train_optim_loss: 37633580.5446; val_kl_reg_loss: 17888.1526; val_edge_recon_loss: 25657102.5436; val_gene_expr_recon_loss: 12093134.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37768125.3519; val_optim_loss: 37768125.3519
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9954; val_auprc_score: 0.9939; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 17987.2274; train_edge_recon_loss: 25602970.9713; train_gene_expr_recon_loss: 12023863.9950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37644822.1971; train_optim_loss: 37644822.1971; val_kl_reg_loss: 17884.6033; val_edge_recon_loss: 25646696.2578; val_gene_expr_recon_loss: 12087595.3624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37752176.3206; val_optim_loss: 37752176.3206
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 17986.9994; train_edge_recon_loss: 25597019.3445; train_gene_expr_recon_loss: 12024940.0613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37639946.4484; train_optim_loss: 37639946.4484; val_kl_reg_loss: 17881.1105; val_edge_recon_loss: 25649965.4774; val_gene_expr_recon_loss: 12084702.9338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37752549.4077; val_optim_loss: 37752549.4077
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 17986.9446; train_edge_recon_loss: 25594300.7711; train_gene_expr_recon_loss: 12019786.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37632074.1257; train_optim_loss: 37632074.1257; val_kl_reg_loss: 17885.7064; val_edge_recon_loss: 25668179.7491; val_gene_expr_recon_loss: 12087748.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37773813.8258; val_optim_loss: 37773813.8258

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1141 min 9 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9941
Val best accuracy score: 0.9786
Val best F1 score: 0.9788
Val gene expr MSE score: 2.6148

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
