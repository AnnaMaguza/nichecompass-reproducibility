None
Run timestamp: 01072023_222530_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9453; val_auprc_score: 0.9288; val_best_acc_score: 0.8852; val_best_f1_score: 0.8917; train_kl_reg_loss: 5113.9234; train_edge_recon_loss: 269330.1459; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274444.0688; train_optim_loss: 274444.0688; val_kl_reg_loss: 4854.8372; val_edge_recon_loss: 267359.3261; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272214.1632; val_optim_loss: 272214.1632
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9628; val_auprc_score: 0.9522; val_best_acc_score: 0.9088; val_best_f1_score: 0.9125; train_kl_reg_loss: 5102.3416; train_edge_recon_loss: 262777.6784; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267880.0205; train_optim_loss: 267880.0205; val_kl_reg_loss: 5036.4167; val_edge_recon_loss: 265895.4447; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270931.8618; val_optim_loss: 270931.8618
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9644; val_auprc_score: 0.9525; val_best_acc_score: 0.9143; val_best_f1_score: 0.9177; train_kl_reg_loss: 5101.4413; train_edge_recon_loss: 261858.7480; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266960.1898; train_optim_loss: 266960.1898; val_kl_reg_loss: 4872.2126; val_edge_recon_loss: 265775.2541; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270647.4679; val_optim_loss: 270647.4679
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9650; val_auprc_score: 0.9519; val_best_acc_score: 0.9160; val_best_f1_score: 0.9195; train_kl_reg_loss: 5092.0217; train_edge_recon_loss: 261472.1490; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266564.1701; train_optim_loss: 266564.1701; val_kl_reg_loss: 5066.1946; val_edge_recon_loss: 265057.8880; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270124.0831; val_optim_loss: 270124.0831
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9707; val_auprc_score: 0.9620; val_best_acc_score: 0.9212; val_best_f1_score: 0.9241; train_kl_reg_loss: 5088.9768; train_edge_recon_loss: 261122.8530; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266211.8301; train_optim_loss: 266211.8301; val_kl_reg_loss: 4965.0599; val_edge_recon_loss: 264702.0216; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269667.0814; val_optim_loss: 269667.0814
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9700; val_auprc_score: 0.9600; val_best_acc_score: 0.9233; val_best_f1_score: 0.9261; train_kl_reg_loss: 5077.1118; train_edge_recon_loss: 260923.1098; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266000.2210; train_optim_loss: 266000.2210; val_kl_reg_loss: 5069.8209; val_edge_recon_loss: 264194.9920; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269264.8133; val_optim_loss: 269264.8133
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9718; val_auprc_score: 0.9628; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 5073.4517; train_edge_recon_loss: 260858.2566; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265931.7078; train_optim_loss: 265931.7078; val_kl_reg_loss: 4998.1910; val_edge_recon_loss: 264453.3316; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269451.5234; val_optim_loss: 269451.5234
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9718; val_auprc_score: 0.9625; val_best_acc_score: 0.9261; val_best_f1_score: 0.9288; train_kl_reg_loss: 5068.4144; train_edge_recon_loss: 260866.7888; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265935.2032; train_optim_loss: 265935.2032; val_kl_reg_loss: 4804.6042; val_edge_recon_loss: 263965.5917; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268770.1949; val_optim_loss: 268770.1949
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9720; val_auprc_score: 0.9625; val_best_acc_score: 0.9266; val_best_f1_score: 0.9293; train_kl_reg_loss: 5066.9740; train_edge_recon_loss: 260654.5895; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265721.5637; train_optim_loss: 265721.5637; val_kl_reg_loss: 4818.8343; val_edge_recon_loss: 264423.5421; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269242.3762; val_optim_loss: 269242.3762
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9734; val_auprc_score: 0.9647; val_best_acc_score: 0.9287; val_best_f1_score: 0.9307; train_kl_reg_loss: 5065.0291; train_edge_recon_loss: 260536.7454; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265601.7739; train_optim_loss: 265601.7739; val_kl_reg_loss: 4934.8736; val_edge_recon_loss: 264027.9028; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268962.7755; val_optim_loss: 268962.7755
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9764; val_auprc_score: 0.9688; val_best_acc_score: 0.9309; val_best_f1_score: 0.9331; train_kl_reg_loss: 5069.6436; train_edge_recon_loss: 260473.1348; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265542.7786; train_optim_loss: 265542.7786; val_kl_reg_loss: 4988.4418; val_edge_recon_loss: 263877.0775; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268865.5214; val_optim_loss: 268865.5214
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9760; val_auprc_score: 0.9681; val_best_acc_score: 0.9318; val_best_f1_score: 0.9339; train_kl_reg_loss: 5076.1052; train_edge_recon_loss: 260348.2237; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265424.3291; train_optim_loss: 265424.3291; val_kl_reg_loss: 4919.3892; val_edge_recon_loss: 264046.5171; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268965.9058; val_optim_loss: 268965.9058

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9778; val_auprc_score: 0.9699; val_best_acc_score: 0.9357; val_best_f1_score: 0.9375; train_kl_reg_loss: 5054.4947; train_edge_recon_loss: 260043.0823; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265097.5762; train_optim_loss: 265097.5762; val_kl_reg_loss: 4941.1641; val_edge_recon_loss: 263494.5621; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268435.7253; val_optim_loss: 268435.7253
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9770; val_auprc_score: 0.9694; val_best_acc_score: 0.9348; val_best_f1_score: 0.9366; train_kl_reg_loss: 5055.1304; train_edge_recon_loss: 259859.9786; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264915.1090; train_optim_loss: 264915.1090; val_kl_reg_loss: 4940.5021; val_edge_recon_loss: 263655.8481; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268596.3499; val_optim_loss: 268596.3499
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9774; val_auprc_score: 0.9695; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 5056.0585; train_edge_recon_loss: 259859.5065; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264915.5645; train_optim_loss: 264915.5645; val_kl_reg_loss: 4924.7872; val_edge_recon_loss: 263821.8051; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268746.5929; val_optim_loss: 268746.5929
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9773; val_auprc_score: 0.9697; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 5050.6182; train_edge_recon_loss: 260005.9420; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265056.5603; train_optim_loss: 265056.5603; val_kl_reg_loss: 4930.8661; val_edge_recon_loss: 263797.7841; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268728.6511; val_optim_loss: 268728.6511
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9782; val_auprc_score: 0.9710; val_best_acc_score: 0.9362; val_best_f1_score: 0.9381; train_kl_reg_loss: 5044.7914; train_edge_recon_loss: 259963.3894; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265008.1811; train_optim_loss: 265008.1811; val_kl_reg_loss: 4940.1766; val_edge_recon_loss: 263665.7874; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268605.9663; val_optim_loss: 268605.9663

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9783; val_auprc_score: 0.9708; val_best_acc_score: 0.9366; val_best_f1_score: 0.9382; train_kl_reg_loss: 5048.2970; train_edge_recon_loss: 259758.4273; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264806.7249; train_optim_loss: 264806.7249; val_kl_reg_loss: 4950.8351; val_edge_recon_loss: 263366.3919; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268317.2278; val_optim_loss: 268317.2278
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9780; val_auprc_score: 0.9707; val_best_acc_score: 0.9365; val_best_f1_score: 0.9383; train_kl_reg_loss: 5045.9297; train_edge_recon_loss: 259885.0566; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264930.9857; train_optim_loss: 264930.9857; val_kl_reg_loss: 4924.9034; val_edge_recon_loss: 263742.1947; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268667.0983; val_optim_loss: 268667.0983
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9782; val_auprc_score: 0.9708; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 5046.6266; train_edge_recon_loss: 259848.6085; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264895.2353; train_optim_loss: 264895.2353; val_kl_reg_loss: 4939.4841; val_edge_recon_loss: 263210.6972; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268150.1826; val_optim_loss: 268150.1826
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9786; val_auprc_score: 0.9718; val_best_acc_score: 0.9369; val_best_f1_score: 0.9387; train_kl_reg_loss: 5044.9437; train_edge_recon_loss: 259925.7080; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264970.6520; train_optim_loss: 264970.6520; val_kl_reg_loss: 4941.5835; val_edge_recon_loss: 263714.7868; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268656.3684; val_optim_loss: 268656.3684
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9776; val_auprc_score: 0.9705; val_best_acc_score: 0.9360; val_best_f1_score: 0.9380; train_kl_reg_loss: 5043.3313; train_edge_recon_loss: 259836.9155; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264880.2466; train_optim_loss: 264880.2466; val_kl_reg_loss: 4953.1490; val_edge_recon_loss: 263841.0586; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268794.2076; val_optim_loss: 268794.2076
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9788; val_auprc_score: 0.9717; val_best_acc_score: 0.9381; val_best_f1_score: 0.9398; train_kl_reg_loss: 5044.2592; train_edge_recon_loss: 259780.1309; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264824.3896; train_optim_loss: 264824.3896; val_kl_reg_loss: 4939.5215; val_edge_recon_loss: 263101.0600; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268040.5810; val_optim_loss: 268040.5810
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9779; val_auprc_score: 0.9705; val_best_acc_score: 0.9354; val_best_f1_score: 0.9373; train_kl_reg_loss: 5043.5086; train_edge_recon_loss: 259806.9041; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264850.4124; train_optim_loss: 264850.4124; val_kl_reg_loss: 4934.1292; val_edge_recon_loss: 264146.8374; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269080.9675; val_optim_loss: 269080.9675
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9782; val_auprc_score: 0.9709; val_best_acc_score: 0.9367; val_best_f1_score: 0.9386; train_kl_reg_loss: 5043.6768; train_edge_recon_loss: 259879.5994; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264923.2766; train_optim_loss: 264923.2766; val_kl_reg_loss: 4945.4790; val_edge_recon_loss: 263310.2603; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268255.7389; val_optim_loss: 268255.7389
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9786; val_auprc_score: 0.9717; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 5043.5267; train_edge_recon_loss: 259834.6785; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264878.2051; train_optim_loss: 264878.2051; val_kl_reg_loss: 4927.5781; val_edge_recon_loss: 263437.4870; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268365.0650; val_optim_loss: 268365.0650
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9787; val_auprc_score: 0.9714; val_best_acc_score: 0.9381; val_best_f1_score: 0.9398; train_kl_reg_loss: 5041.0815; train_edge_recon_loss: 259960.5924; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265001.6740; train_optim_loss: 265001.6740; val_kl_reg_loss: 4935.6580; val_edge_recon_loss: 263192.8672; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268128.5247; val_optim_loss: 268128.5247

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9780; val_auprc_score: 0.9705; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 5040.7416; train_edge_recon_loss: 259809.1351; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264849.8767; train_optim_loss: 264849.8767; val_kl_reg_loss: 4944.8562; val_edge_recon_loss: 263450.6887; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268395.5428; val_optim_loss: 268395.5428
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9782; val_auprc_score: 0.9709; val_best_acc_score: 0.9371; val_best_f1_score: 0.9388; train_kl_reg_loss: 5046.6684; train_edge_recon_loss: 259710.1698; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264756.8383; train_optim_loss: 264756.8383; val_kl_reg_loss: 4948.2120; val_edge_recon_loss: 263499.2220; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268447.4350; val_optim_loss: 268447.4350
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9777; val_auprc_score: 0.9700; val_best_acc_score: 0.9362; val_best_f1_score: 0.9380; train_kl_reg_loss: 5046.2378; train_edge_recon_loss: 259781.4190; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264827.6565; train_optim_loss: 264827.6565; val_kl_reg_loss: 4948.5563; val_edge_recon_loss: 263845.3818; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268793.9383; val_optim_loss: 268793.9383
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9794; val_auprc_score: 0.9731; val_best_acc_score: 0.9382; val_best_f1_score: 0.9399; train_kl_reg_loss: 5047.9176; train_edge_recon_loss: 259742.2026; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264790.1202; train_optim_loss: 264790.1202; val_kl_reg_loss: 4949.2070; val_edge_recon_loss: 262928.8976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267878.1053; val_optim_loss: 267878.1053
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9784; val_auprc_score: 0.9718; val_best_acc_score: 0.9366; val_best_f1_score: 0.9384; train_kl_reg_loss: 5046.4824; train_edge_recon_loss: 259876.3393; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264922.8213; train_optim_loss: 264922.8213; val_kl_reg_loss: 4942.4851; val_edge_recon_loss: 263447.8947; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268390.3791; val_optim_loss: 268390.3791
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9784; val_auprc_score: 0.9710; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 5044.1714; train_edge_recon_loss: 259812.2026; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264856.3741; train_optim_loss: 264856.3741; val_kl_reg_loss: 4945.2423; val_edge_recon_loss: 263442.3760; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268387.6178; val_optim_loss: 268387.6178
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9777; val_auprc_score: 0.9702; val_best_acc_score: 0.9355; val_best_f1_score: 0.9374; train_kl_reg_loss: 5043.3955; train_edge_recon_loss: 259903.8624; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264947.2581; train_optim_loss: 264947.2581; val_kl_reg_loss: 4942.6177; val_edge_recon_loss: 263645.3935; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268588.0123; val_optim_loss: 268588.0123
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9787; val_auprc_score: 0.9719; val_best_acc_score: 0.9365; val_best_f1_score: 0.9384; train_kl_reg_loss: 5042.7849; train_edge_recon_loss: 259844.2071; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264886.9922; train_optim_loss: 264886.9922; val_kl_reg_loss: 4944.6588; val_edge_recon_loss: 263368.1172; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268312.7751; val_optim_loss: 268312.7751

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9785; val_auprc_score: 0.9715; val_best_acc_score: 0.9372; val_best_f1_score: 0.9390; train_kl_reg_loss: 5044.3918; train_edge_recon_loss: 259871.8224; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264916.2144; train_optim_loss: 264916.2144; val_kl_reg_loss: 4943.3265; val_edge_recon_loss: 263092.3787; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268035.7064; val_optim_loss: 268035.7064
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9784; val_auprc_score: 0.9710; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 5044.3157; train_edge_recon_loss: 259863.9534; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264908.2690; train_optim_loss: 264908.2690; val_kl_reg_loss: 4943.2057; val_edge_recon_loss: 263452.3910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268395.5987; val_optim_loss: 268395.5987
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9780; val_auprc_score: 0.9710; val_best_acc_score: 0.9361; val_best_f1_score: 0.9379; train_kl_reg_loss: 5044.3020; train_edge_recon_loss: 259997.5498; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265041.8512; train_optim_loss: 265041.8512; val_kl_reg_loss: 4944.8682; val_edge_recon_loss: 263619.8324; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268564.7007; val_optim_loss: 268564.7007
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9781; val_auprc_score: 0.9705; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 5044.3765; train_edge_recon_loss: 259804.2073; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264848.5837; train_optim_loss: 264848.5837; val_kl_reg_loss: 4942.5295; val_edge_recon_loss: 263621.1624; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268563.6916; val_optim_loss: 268563.6916

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 57 min 52 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9785
Val AUPRC score: 0.9710
Val best accuracy score: 0.9364
Val best F1 score: 0.9383
Val gene expr MSE score: 5.2256

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
