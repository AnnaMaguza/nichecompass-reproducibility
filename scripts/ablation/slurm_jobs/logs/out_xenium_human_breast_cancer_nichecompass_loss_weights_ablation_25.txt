None
Run timestamp: 01072023_091311_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9458; val_auprc_score: 0.9293; val_best_acc_score: 0.8852; val_best_f1_score: 0.8919; train_kl_reg_loss: 5275.6308; train_edge_recon_loss: 269067.2407; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274342.8713; train_optim_loss: 274342.8713; val_kl_reg_loss: 5170.7941; val_edge_recon_loss: 267435.8999; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272606.6961; val_optim_loss: 272606.6961
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9610; val_auprc_score: 0.9497; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 5249.4867; train_edge_recon_loss: 262834.0295; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268083.5165; train_optim_loss: 268083.5165; val_kl_reg_loss: 5052.2462; val_edge_recon_loss: 266258.2691; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271310.5164; val_optim_loss: 271310.5164
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9630; val_auprc_score: 0.9501; val_best_acc_score: 0.9116; val_best_f1_score: 0.9155; train_kl_reg_loss: 5243.0946; train_edge_recon_loss: 261989.7667; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267232.8610; train_optim_loss: 267232.8610; val_kl_reg_loss: 5023.6421; val_edge_recon_loss: 265253.2280; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270276.8701; val_optim_loss: 270276.8701
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9661; val_auprc_score: 0.9539; val_best_acc_score: 0.9170; val_best_f1_score: 0.9202; train_kl_reg_loss: 5241.8372; train_edge_recon_loss: 261482.5139; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266724.3513; train_optim_loss: 266724.3513; val_kl_reg_loss: 5040.3525; val_edge_recon_loss: 265392.2913; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270432.6447; val_optim_loss: 270432.6447
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9681; val_auprc_score: 0.9579; val_best_acc_score: 0.9198; val_best_f1_score: 0.9227; train_kl_reg_loss: 5240.1584; train_edge_recon_loss: 261360.2113; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266600.3694; train_optim_loss: 266600.3694; val_kl_reg_loss: 5270.7483; val_edge_recon_loss: 264866.0806; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270136.8294; val_optim_loss: 270136.8294
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9699; val_auprc_score: 0.9600; val_best_acc_score: 0.9235; val_best_f1_score: 0.9258; train_kl_reg_loss: 5226.2545; train_edge_recon_loss: 260945.2288; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266171.4837; train_optim_loss: 266171.4837; val_kl_reg_loss: 5218.1798; val_edge_recon_loss: 264520.5765; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269738.7570; val_optim_loss: 269738.7570
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9726; val_auprc_score: 0.9640; val_best_acc_score: 0.9266; val_best_f1_score: 0.9289; train_kl_reg_loss: 5222.4422; train_edge_recon_loss: 261049.6091; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266272.0515; train_optim_loss: 266272.0515; val_kl_reg_loss: 5093.0572; val_edge_recon_loss: 264297.8072; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269390.8651; val_optim_loss: 269390.8651
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9733; val_auprc_score: 0.9650; val_best_acc_score: 0.9277; val_best_f1_score: 0.9295; train_kl_reg_loss: 5221.3854; train_edge_recon_loss: 260705.2477; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265926.6330; train_optim_loss: 265926.6330; val_kl_reg_loss: 5087.0890; val_edge_recon_loss: 264864.6145; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269951.7044; val_optim_loss: 269951.7044
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9727; val_auprc_score: 0.9629; val_best_acc_score: 0.9270; val_best_f1_score: 0.9291; train_kl_reg_loss: 5219.1181; train_edge_recon_loss: 260675.2935; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265894.4119; train_optim_loss: 265894.4119; val_kl_reg_loss: 4946.4564; val_edge_recon_loss: 264158.5510; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269105.0074; val_optim_loss: 269105.0074
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9739; val_auprc_score: 0.9660; val_best_acc_score: 0.9289; val_best_f1_score: 0.9307; train_kl_reg_loss: 5214.4419; train_edge_recon_loss: 260585.5968; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265800.0392; train_optim_loss: 265800.0392; val_kl_reg_loss: 5128.0874; val_edge_recon_loss: 264800.1435; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269928.2290; val_optim_loss: 269928.2290
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9750; val_auprc_score: 0.9666; val_best_acc_score: 0.9320; val_best_f1_score: 0.9339; train_kl_reg_loss: 5219.6336; train_edge_recon_loss: 260399.7485; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265619.3828; train_optim_loss: 265619.3828; val_kl_reg_loss: 5193.8779; val_edge_recon_loss: 263391.5810; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268585.4593; val_optim_loss: 268585.4593
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9758; val_auprc_score: 0.9679; val_best_acc_score: 0.9318; val_best_f1_score: 0.9338; train_kl_reg_loss: 5216.3955; train_edge_recon_loss: 260389.6336; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265606.0297; train_optim_loss: 265606.0297; val_kl_reg_loss: 5029.6474; val_edge_recon_loss: 264145.4840; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269175.1324; val_optim_loss: 269175.1324
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9750; val_auprc_score: 0.9664; val_best_acc_score: 0.9304; val_best_f1_score: 0.9325; train_kl_reg_loss: 5220.2367; train_edge_recon_loss: 260209.7123; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265429.9493; train_optim_loss: 265429.9493; val_kl_reg_loss: 5055.4467; val_edge_recon_loss: 264316.7730; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269372.2216; val_optim_loss: 269372.2216
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9759; val_auprc_score: 0.9677; val_best_acc_score: 0.9336; val_best_f1_score: 0.9353; train_kl_reg_loss: 5221.7581; train_edge_recon_loss: 260293.1259; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265514.8844; train_optim_loss: 265514.8844; val_kl_reg_loss: 5246.9818; val_edge_recon_loss: 263464.5331; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268711.5164; val_optim_loss: 268711.5164
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9771; val_auprc_score: 0.9687; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 5225.9487; train_edge_recon_loss: 260036.0923; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265262.0414; train_optim_loss: 265262.0414; val_kl_reg_loss: 5017.4687; val_edge_recon_loss: 263935.2547; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268952.7229; val_optim_loss: 268952.7229

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9782; val_auprc_score: 0.9711; val_best_acc_score: 0.9376; val_best_f1_score: 0.9391; train_kl_reg_loss: 5202.5621; train_edge_recon_loss: 259938.6221; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265141.1841; train_optim_loss: 265141.1841; val_kl_reg_loss: 5109.7698; val_edge_recon_loss: 263354.2264; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268463.9938; val_optim_loss: 268463.9938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9789; val_auprc_score: 0.9719; val_best_acc_score: 0.9382; val_best_f1_score: 0.9398; train_kl_reg_loss: 5204.1527; train_edge_recon_loss: 259821.1680; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265025.3209; train_optim_loss: 265025.3209; val_kl_reg_loss: 5115.7397; val_edge_recon_loss: 263154.0983; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268269.8372; val_optim_loss: 268269.8372
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9782; val_auprc_score: 0.9701; val_best_acc_score: 0.9373; val_best_f1_score: 0.9388; train_kl_reg_loss: 5207.9324; train_edge_recon_loss: 259744.7263; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264952.6587; train_optim_loss: 264952.6587; val_kl_reg_loss: 5103.5005; val_edge_recon_loss: 263234.7262; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268338.2278; val_optim_loss: 268338.2278
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9790; val_auprc_score: 0.9718; val_best_acc_score: 0.9390; val_best_f1_score: 0.9403; train_kl_reg_loss: 5198.4280; train_edge_recon_loss: 259731.6344; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264930.0627; train_optim_loss: 264930.0627; val_kl_reg_loss: 5117.1366; val_edge_recon_loss: 263115.4322; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268232.5699; val_optim_loss: 268232.5699
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9786; val_auprc_score: 0.9708; val_best_acc_score: 0.9389; val_best_f1_score: 0.9405; train_kl_reg_loss: 5199.9979; train_edge_recon_loss: 259629.7889; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264829.7865; train_optim_loss: 264829.7865; val_kl_reg_loss: 5121.9796; val_edge_recon_loss: 263123.7430; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268245.7237; val_optim_loss: 268245.7237
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9787; val_auprc_score: 0.9711; val_best_acc_score: 0.9389; val_best_f1_score: 0.9406; train_kl_reg_loss: 5193.5977; train_edge_recon_loss: 259811.6326; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265005.2303; train_optim_loss: 265005.2303; val_kl_reg_loss: 5058.9391; val_edge_recon_loss: 263187.4019; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268246.3400; val_optim_loss: 268246.3400
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9792; val_auprc_score: 0.9715; val_best_acc_score: 0.9397; val_best_f1_score: 0.9411; train_kl_reg_loss: 5192.6655; train_edge_recon_loss: 259673.4217; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264866.0874; train_optim_loss: 264866.0874; val_kl_reg_loss: 5112.8993; val_edge_recon_loss: 263103.4309; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268216.3289; val_optim_loss: 268216.3289
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9791; val_auprc_score: 0.9719; val_best_acc_score: 0.9395; val_best_f1_score: 0.9408; train_kl_reg_loss: 5196.5981; train_edge_recon_loss: 259686.8591; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264883.4574; train_optim_loss: 264883.4574; val_kl_reg_loss: 5113.1359; val_edge_recon_loss: 262954.4437; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268067.5785; val_optim_loss: 268067.5785
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9790; val_auprc_score: 0.9716; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 5192.3316; train_edge_recon_loss: 259882.6565; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265074.9882; train_optim_loss: 265074.9882; val_kl_reg_loss: 5086.7374; val_edge_recon_loss: 263450.4988; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268537.2352; val_optim_loss: 268537.2352
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9792; val_auprc_score: 0.9720; val_best_acc_score: 0.9391; val_best_f1_score: 0.9406; train_kl_reg_loss: 5192.9781; train_edge_recon_loss: 259660.1983; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264853.1768; train_optim_loss: 264853.1768; val_kl_reg_loss: 5092.7125; val_edge_recon_loss: 263039.2936; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268132.0074; val_optim_loss: 268132.0074
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9798; val_auprc_score: 0.9728; val_best_acc_score: 0.9401; val_best_f1_score: 0.9415; train_kl_reg_loss: 5193.4761; train_edge_recon_loss: 259608.6340; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264802.1098; train_optim_loss: 264802.1098; val_kl_reg_loss: 5124.4083; val_edge_recon_loss: 262985.7819; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268110.1912; val_optim_loss: 268110.1912
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9798; val_auprc_score: 0.9730; val_best_acc_score: 0.9399; val_best_f1_score: 0.9413; train_kl_reg_loss: 5194.5261; train_edge_recon_loss: 259678.2111; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264872.7368; train_optim_loss: 264872.7368; val_kl_reg_loss: 5128.9078; val_edge_recon_loss: 263232.6957; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268361.6028; val_optim_loss: 268361.6028

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9793; val_auprc_score: 0.9726; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 5195.2689; train_edge_recon_loss: 259550.2143; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264745.4833; train_optim_loss: 264745.4833; val_kl_reg_loss: 5096.1342; val_edge_recon_loss: 263194.8571; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268290.9910; val_optim_loss: 268290.9910
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9798; val_auprc_score: 0.9724; val_best_acc_score: 0.9401; val_best_f1_score: 0.9416; train_kl_reg_loss: 5194.6726; train_edge_recon_loss: 259618.4693; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264813.1417; train_optim_loss: 264813.1417; val_kl_reg_loss: 5103.5329; val_edge_recon_loss: 262979.8483; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268083.3812; val_optim_loss: 268083.3812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9797; val_auprc_score: 0.9730; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 5193.3600; train_edge_recon_loss: 259647.3950; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264840.7551; train_optim_loss: 264840.7551; val_kl_reg_loss: 5102.0889; val_edge_recon_loss: 263107.4938; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268209.5843; val_optim_loss: 268209.5843
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9794; val_auprc_score: 0.9723; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 5193.7534; train_edge_recon_loss: 259510.3817; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264704.1356; train_optim_loss: 264704.1356; val_kl_reg_loss: 5109.9373; val_edge_recon_loss: 263279.3409; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 268389.2788; val_optim_loss: 268389.2788

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 2 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9791
Val AUPRC score: 0.9719
Val best accuracy score: 0.9392
Val best F1 score: 0.9409
Val gene expr MSE score: 5.1468

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
