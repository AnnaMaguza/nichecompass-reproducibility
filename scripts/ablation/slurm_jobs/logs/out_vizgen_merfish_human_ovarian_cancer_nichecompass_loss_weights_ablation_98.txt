None
Run timestamp: 18072023_062941_98.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_98']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9837; val_best_acc_score: 0.9382; val_best_f1_score: 0.9387; train_kl_reg_loss: 17476.1443; train_edge_recon_loss: 26417634.0963; train_gene_expr_recon_loss: 1665775.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28100885.3940; train_optim_loss: 28100885.3940; val_kl_reg_loss: 18783.0801; val_edge_recon_loss: 26273259.9906; val_gene_expr_recon_loss: 1492161.6972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27784204.6573; val_optim_loss: 27784204.6573
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9877; val_auprc_score: 0.9867; val_best_acc_score: 0.9458; val_best_f1_score: 0.9462; train_kl_reg_loss: 21065.9948; train_edge_recon_loss: 26022601.8671; train_gene_expr_recon_loss: 1434475.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27478143.6170; train_optim_loss: 27478143.6170; val_kl_reg_loss: 21610.4528; val_edge_recon_loss: 26195308.4601; val_gene_expr_recon_loss: 1393516.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27610435.0610; val_optim_loss: 27610435.0610
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9891; val_best_acc_score: 0.9540; val_best_f1_score: 0.9543; train_kl_reg_loss: 22054.3239; train_edge_recon_loss: 25931804.3998; train_gene_expr_recon_loss: 1375238.0515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27329096.7399; train_optim_loss: 27329096.7399; val_kl_reg_loss: 21174.3711; val_edge_recon_loss: 26094651.8873; val_gene_expr_recon_loss: 1357571.7758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27473397.9812; val_optim_loss: 27473397.9812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9911; val_auprc_score: 0.9896; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 22234.7123; train_edge_recon_loss: 25887706.3370; train_gene_expr_recon_loss: 1353480.1020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27263421.1240; train_optim_loss: 27263421.1240; val_kl_reg_loss: 22323.0643; val_edge_recon_loss: 26080076.8169; val_gene_expr_recon_loss: 1340825.8627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27443225.7559; val_optim_loss: 27443225.7559
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9919; val_auprc_score: 0.9908; val_best_acc_score: 0.9591; val_best_f1_score: 0.9593; train_kl_reg_loss: 22327.3357; train_edge_recon_loss: 25853537.4380; train_gene_expr_recon_loss: 1338400.1130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27214264.8969; train_optim_loss: 27214264.8969; val_kl_reg_loss: 20787.3989; val_edge_recon_loss: 26060509.6808; val_gene_expr_recon_loss: 1336114.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27417411.1174; val_optim_loss: 27417411.1174
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9929; val_auprc_score: 0.9918; val_best_acc_score: 0.9627; val_best_f1_score: 0.9630; train_kl_reg_loss: 21662.4514; train_edge_recon_loss: 25832207.5772; train_gene_expr_recon_loss: 1330201.0262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27184071.0644; train_optim_loss: 27184071.0644; val_kl_reg_loss: 21546.2577; val_edge_recon_loss: 26028722.9859; val_gene_expr_recon_loss: 1318127.6103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27368396.8263; val_optim_loss: 27368396.8263
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9933; val_auprc_score: 0.9924; val_best_acc_score: 0.9633; val_best_f1_score: 0.9635; train_kl_reg_loss: 21222.8851; train_edge_recon_loss: 25809160.1235; train_gene_expr_recon_loss: 1323964.2877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27154347.2883; train_optim_loss: 27154347.2883; val_kl_reg_loss: 21449.3454; val_edge_recon_loss: 25996335.5962; val_gene_expr_recon_loss: 1315907.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27333692.0563; val_optim_loss: 27333692.0563
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9940; val_auprc_score: 0.9932; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 21266.3547; train_edge_recon_loss: 25795778.0942; train_gene_expr_recon_loss: 1318235.8266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27135280.2972; train_optim_loss: 27135280.2972; val_kl_reg_loss: 20942.7313; val_edge_recon_loss: 25989117.7465; val_gene_expr_recon_loss: 1313091.8662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27323152.1878; val_optim_loss: 27323152.1878
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9941; val_auprc_score: 0.9929; val_best_acc_score: 0.9664; val_best_f1_score: 0.9667; train_kl_reg_loss: 21087.8942; train_edge_recon_loss: 25770015.3260; train_gene_expr_recon_loss: 1314296.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27105399.3208; train_optim_loss: 27105399.3208; val_kl_reg_loss: 20504.0746; val_edge_recon_loss: 25955695.2958; val_gene_expr_recon_loss: 1309416.4507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27285615.7277; val_optim_loss: 27285615.7277
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9935; val_best_acc_score: 0.9677; val_best_f1_score: 0.9678; train_kl_reg_loss: 21035.7456; train_edge_recon_loss: 25768064.9095; train_gene_expr_recon_loss: 1311037.8951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27100138.5097; train_optim_loss: 27100138.5097; val_kl_reg_loss: 21118.6433; val_edge_recon_loss: 25947673.9718; val_gene_expr_recon_loss: 1307810.2876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27276602.8357; val_optim_loss: 27276602.8357
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9950; val_auprc_score: 0.9943; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 20581.8882; train_edge_recon_loss: 25751581.9655; train_gene_expr_recon_loss: 1309961.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27082125.8168; train_optim_loss: 27082125.8168; val_kl_reg_loss: 19619.0926; val_edge_recon_loss: 25940924.1033; val_gene_expr_recon_loss: 1306649.1467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27267192.3850; val_optim_loss: 27267192.3850
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9697; val_best_f1_score: 0.9699; train_kl_reg_loss: 20512.4943; train_edge_recon_loss: 25747169.2695; train_gene_expr_recon_loss: 1307066.5381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27074748.2857; train_optim_loss: 27074748.2857; val_kl_reg_loss: 20781.8157; val_edge_recon_loss: 25950122.0845; val_gene_expr_recon_loss: 1302311.0082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27273214.8920; val_optim_loss: 27273214.8920
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9700; val_best_f1_score: 0.9702; train_kl_reg_loss: 20251.0293; train_edge_recon_loss: 25739403.3501; train_gene_expr_recon_loss: 1306474.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27066128.5034; train_optim_loss: 27066128.5034; val_kl_reg_loss: 19538.4961; val_edge_recon_loss: 25940397.4085; val_gene_expr_recon_loss: 1300300.1725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27260236.1408; val_optim_loss: 27260236.1408
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9705; val_best_f1_score: 0.9707; train_kl_reg_loss: 20265.0072; train_edge_recon_loss: 25733727.7164; train_gene_expr_recon_loss: 1303745.1092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27057737.8482; train_optim_loss: 27057737.8482; val_kl_reg_loss: 19920.3397; val_edge_recon_loss: 25916943.7840; val_gene_expr_recon_loss: 1297792.3844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27234656.5352; val_optim_loss: 27234656.5352
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9941; val_best_acc_score: 0.9700; val_best_f1_score: 0.9702; train_kl_reg_loss: 20150.0601; train_edge_recon_loss: 25726629.3093; train_gene_expr_recon_loss: 1303284.6084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27050064.0105; train_optim_loss: 27050064.0105; val_kl_reg_loss: 20484.0369; val_edge_recon_loss: 25913387.3239; val_gene_expr_recon_loss: 1297872.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27231743.4554; val_optim_loss: 27231743.4554
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 20052.1780; train_edge_recon_loss: 25711841.7886; train_gene_expr_recon_loss: 1301785.2570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27033679.2318; train_optim_loss: 27033679.2318; val_kl_reg_loss: 19602.5511; val_edge_recon_loss: 25891383.4742; val_gene_expr_recon_loss: 1299095.6749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27210081.6901; val_optim_loss: 27210081.6901
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 19979.9820; train_edge_recon_loss: 25711551.4778; train_gene_expr_recon_loss: 1300564.3579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27032095.7855; train_optim_loss: 27032095.7855; val_kl_reg_loss: 19004.8710; val_edge_recon_loss: 25895572.5728; val_gene_expr_recon_loss: 1298332.1854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27212909.6056; val_optim_loss: 27212909.6056
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9956; val_auprc_score: 0.9948; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 19743.8041; train_edge_recon_loss: 25709565.4233; train_gene_expr_recon_loss: 1299943.0225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27029252.2585; train_optim_loss: 27029252.2585; val_kl_reg_loss: 18811.3548; val_edge_recon_loss: 25910444.5446; val_gene_expr_recon_loss: 1299117.9096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27228373.8216; val_optim_loss: 27228373.8216
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9736; val_best_f1_score: 0.9738; train_kl_reg_loss: 19513.8096; train_edge_recon_loss: 25703310.5003; train_gene_expr_recon_loss: 1299906.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27022731.0005; train_optim_loss: 27022731.0005; val_kl_reg_loss: 19331.8277; val_edge_recon_loss: 25861038.4789; val_gene_expr_recon_loss: 1296626.2588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27176996.5258; val_optim_loss: 27176996.5258
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9957; val_auprc_score: 0.9948; val_best_acc_score: 0.9725; val_best_f1_score: 0.9726; train_kl_reg_loss: 19592.1310; train_edge_recon_loss: 25700245.6201; train_gene_expr_recon_loss: 1298019.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27017856.8749; train_optim_loss: 27017856.8749; val_kl_reg_loss: 18797.2837; val_edge_recon_loss: 25868986.0563; val_gene_expr_recon_loss: 1294859.1643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27182642.5915; val_optim_loss: 27182642.5915
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 19499.4955; train_edge_recon_loss: 25695981.0947; train_gene_expr_recon_loss: 1298346.4704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27013827.0518; train_optim_loss: 27013827.0518; val_kl_reg_loss: 19247.6128; val_edge_recon_loss: 25863026.5258; val_gene_expr_recon_loss: 1294860.7148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27177134.8357; val_optim_loss: 27177134.8357
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 19363.9670; train_edge_recon_loss: 25687280.2732; train_gene_expr_recon_loss: 1297317.4260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27003961.6620; train_optim_loss: 27003961.6620; val_kl_reg_loss: 19068.0791; val_edge_recon_loss: 25863028.2535; val_gene_expr_recon_loss: 1294063.9783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27176160.2629; val_optim_loss: 27176160.2629
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 19203.8740; train_edge_recon_loss: 25680729.7059; train_gene_expr_recon_loss: 1297592.7486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26997526.3391; train_optim_loss: 26997526.3391; val_kl_reg_loss: 18527.5405; val_edge_recon_loss: 25878094.8169; val_gene_expr_recon_loss: 1293707.1168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27190329.4366; val_optim_loss: 27190329.4366
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 19218.6875; train_edge_recon_loss: 25679986.6970; train_gene_expr_recon_loss: 1296915.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26996121.2088; train_optim_loss: 26996121.2088; val_kl_reg_loss: 18340.4690; val_edge_recon_loss: 25860614.1972; val_gene_expr_recon_loss: 1292646.5622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27171601.2207; val_optim_loss: 27171601.2207
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 18870.3624; train_edge_recon_loss: 25678965.3616; train_gene_expr_recon_loss: 1296896.7817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26994732.4731; train_optim_loss: 26994732.4731; val_kl_reg_loss: 18804.7461; val_edge_recon_loss: 25829539.2019; val_gene_expr_recon_loss: 1293803.3128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27142147.2770; val_optim_loss: 27142147.2770
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 19049.1679; train_edge_recon_loss: 25672947.7509; train_gene_expr_recon_loss: 1296145.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26988141.9341; train_optim_loss: 26988141.9341; val_kl_reg_loss: 18993.6888; val_edge_recon_loss: 25844982.6291; val_gene_expr_recon_loss: 1293394.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27157370.7512; val_optim_loss: 27157370.7512
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9753; val_best_f1_score: 0.9754; train_kl_reg_loss: 18735.7643; train_edge_recon_loss: 25670434.9053; train_gene_expr_recon_loss: 1297566.3548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26986737.0277; train_optim_loss: 26986737.0277; val_kl_reg_loss: 18885.5063; val_edge_recon_loss: 25813488.5634; val_gene_expr_recon_loss: 1293733.7212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27126107.7089; val_optim_loss: 27126107.7089
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 18716.6237; train_edge_recon_loss: 25661733.3365; train_gene_expr_recon_loss: 1296051.6624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26976501.6243; train_optim_loss: 26976501.6243; val_kl_reg_loss: 18579.0484; val_edge_recon_loss: 25853810.8638; val_gene_expr_recon_loss: 1292341.9982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27164731.8310; val_optim_loss: 27164731.8310
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9756; val_best_f1_score: 0.9758; train_kl_reg_loss: 18711.3639; train_edge_recon_loss: 25665764.7807; train_gene_expr_recon_loss: 1295414.8133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26979890.9576; train_optim_loss: 26979890.9576; val_kl_reg_loss: 18596.2253; val_edge_recon_loss: 25825024.4789; val_gene_expr_recon_loss: 1292635.9888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27136256.7418; val_optim_loss: 27136256.7418
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 18817.0921; train_edge_recon_loss: 25653485.1240; train_gene_expr_recon_loss: 1295709.8180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26968012.0272; train_optim_loss: 26968012.0272; val_kl_reg_loss: 18428.5173; val_edge_recon_loss: 25833819.2300; val_gene_expr_recon_loss: 1292573.0053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27144820.7136; val_optim_loss: 27144820.7136
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 18711.6631; train_edge_recon_loss: 25658697.1272; train_gene_expr_recon_loss: 1294746.6688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26972155.4453; train_optim_loss: 26972155.4453; val_kl_reg_loss: 18059.8877; val_edge_recon_loss: 25817373.6244; val_gene_expr_recon_loss: 1294109.0041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27129542.5915; val_optim_loss: 27129542.5915

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 19102.7929; train_edge_recon_loss: 25631014.1518; train_gene_expr_recon_loss: 1281932.0457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26932048.9859; train_optim_loss: 26932048.9859; val_kl_reg_loss: 19119.4563; val_edge_recon_loss: 25785858.4413; val_gene_expr_recon_loss: 1278608.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27083586.4038; val_optim_loss: 27083586.4038
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 19560.0784; train_edge_recon_loss: 25621253.7384; train_gene_expr_recon_loss: 1280146.9484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26920960.7588; train_optim_loss: 26920960.7588; val_kl_reg_loss: 19078.4841; val_edge_recon_loss: 25797221.2864; val_gene_expr_recon_loss: 1279582.8322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27095882.5822; val_optim_loss: 27095882.5822
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 19449.8586; train_edge_recon_loss: 25622860.3684; train_gene_expr_recon_loss: 1279325.6304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26921635.8200; train_optim_loss: 26921635.8200; val_kl_reg_loss: 19320.7343; val_edge_recon_loss: 25773985.8498; val_gene_expr_recon_loss: 1278088.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27071394.5070; val_optim_loss: 27071394.5070
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 19590.5547; train_edge_recon_loss: 25614428.9021; train_gene_expr_recon_loss: 1279426.0009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26913445.4851; train_optim_loss: 26913445.4851; val_kl_reg_loss: 19307.1253; val_edge_recon_loss: 25775111.1268; val_gene_expr_recon_loss: 1277523.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27071941.5493; val_optim_loss: 27071941.5493
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9793; val_best_f1_score: 0.9793; train_kl_reg_loss: 19574.2551; train_edge_recon_loss: 25612879.4621; train_gene_expr_recon_loss: 1279033.6756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26911487.4076; train_optim_loss: 26911487.4076; val_kl_reg_loss: 19004.7364; val_edge_recon_loss: 25768882.2441; val_gene_expr_recon_loss: 1277965.9888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27065852.9577; val_optim_loss: 27065852.9577
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 19374.0830; train_edge_recon_loss: 25614784.0251; train_gene_expr_recon_loss: 1278511.9006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26912670.0042; train_optim_loss: 26912670.0042; val_kl_reg_loss: 19107.4053; val_edge_recon_loss: 25776588.6009; val_gene_expr_recon_loss: 1277227.0464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27072923.0423; val_optim_loss: 27072923.0423
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 19375.3176; train_edge_recon_loss: 25614581.2475; train_gene_expr_recon_loss: 1278837.6809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26912794.2187; train_optim_loss: 26912794.2187; val_kl_reg_loss: 19122.9898; val_edge_recon_loss: 25766460.8075; val_gene_expr_recon_loss: 1276696.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27062280.6573; val_optim_loss: 27062280.6573
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 19323.0474; train_edge_recon_loss: 25612521.3888; train_gene_expr_recon_loss: 1278773.5096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26910617.9383; train_optim_loss: 26910617.9383; val_kl_reg_loss: 19064.4754; val_edge_recon_loss: 25760668.9953; val_gene_expr_recon_loss: 1275759.3967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27055492.8732; val_optim_loss: 27055492.8732
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 19236.6411; train_edge_recon_loss: 25616188.0230; train_gene_expr_recon_loss: 1279065.1057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26914489.7708; train_optim_loss: 26914489.7708; val_kl_reg_loss: 18993.7571; val_edge_recon_loss: 25745657.5775; val_gene_expr_recon_loss: 1277048.6766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27041699.9906; val_optim_loss: 27041699.9906
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 19223.4335; train_edge_recon_loss: 25612065.2716; train_gene_expr_recon_loss: 1278466.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26909754.9492; train_optim_loss: 26909754.9492; val_kl_reg_loss: 18936.3727; val_edge_recon_loss: 25751684.1033; val_gene_expr_recon_loss: 1276537.9243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27047158.4319; val_optim_loss: 27047158.4319
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 19183.0222; train_edge_recon_loss: 25615407.3072; train_gene_expr_recon_loss: 1278504.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26913094.7347; train_optim_loss: 26913094.7347; val_kl_reg_loss: 18846.8962; val_edge_recon_loss: 25771871.5399; val_gene_expr_recon_loss: 1276494.3955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27067212.7606; val_optim_loss: 27067212.7606
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 19158.2826; train_edge_recon_loss: 25611261.2465; train_gene_expr_recon_loss: 1278120.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26908539.5447; train_optim_loss: 26908539.5447; val_kl_reg_loss: 18916.7189; val_edge_recon_loss: 25772838.7981; val_gene_expr_recon_loss: 1276383.2488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27068138.7793; val_optim_loss: 27068138.7793
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9972; val_auprc_score: 0.9967; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 19167.7368; train_edge_recon_loss: 25608967.9759; train_gene_expr_recon_loss: 1277964.2938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26906099.9780; train_optim_loss: 26906099.9780; val_kl_reg_loss: 18749.8480; val_edge_recon_loss: 25763667.9812; val_gene_expr_recon_loss: 1276751.6039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27059169.5023; val_optim_loss: 27059169.5023

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9802; val_best_f1_score: 0.9802; train_kl_reg_loss: 19098.6703; train_edge_recon_loss: 25607673.2496; train_gene_expr_recon_loss: 1276631.2675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26903403.1763; train_optim_loss: 26903403.1763; val_kl_reg_loss: 18875.3779; val_edge_recon_loss: 25757899.3991; val_gene_expr_recon_loss: 1274555.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27051330.0563; val_optim_loss: 27051330.0563
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9800; val_best_f1_score: 0.9801; train_kl_reg_loss: 19180.5320; train_edge_recon_loss: 25608483.8974; train_gene_expr_recon_loss: 1276887.1200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26904551.5772; train_optim_loss: 26904551.5772; val_kl_reg_loss: 18909.9485; val_edge_recon_loss: 25765270.4225; val_gene_expr_recon_loss: 1276827.6743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27061008.0376; val_optim_loss: 27061008.0376
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 19144.4596; train_edge_recon_loss: 25610711.0581; train_gene_expr_recon_loss: 1276026.1315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26905881.6484; train_optim_loss: 26905881.6484; val_kl_reg_loss: 18928.7553; val_edge_recon_loss: 25760681.0986; val_gene_expr_recon_loss: 1273928.7418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27053538.5164; val_optim_loss: 27053538.5164
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 19154.8772; train_edge_recon_loss: 25607523.9885; train_gene_expr_recon_loss: 1275834.1722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26902513.0476; train_optim_loss: 26902513.0476; val_kl_reg_loss: 18866.0638; val_edge_recon_loss: 25761000.2817; val_gene_expr_recon_loss: 1274968.4396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27054834.8545; val_optim_loss: 27054834.8545

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 388 min 4 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9972
Val AUPRC score: 0.9966
Val best accuracy score: 0.9797
Val best F1 score: 0.9798
Val gene expr MSE score: 8.7166

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
