None
Run timestamp: 28072023_112702_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9863; val_auprc_score: 0.9822; val_best_acc_score: 0.9535; val_best_f1_score: 0.9543; train_kl_reg_loss: 4406.0648; train_edge_recon_loss: 31029.0440; train_gene_expr_recon_loss: 204043.6805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 239478.7897; train_optim_loss: 239478.7897; val_kl_reg_loss: 4019.0991; val_edge_recon_loss: 29331.5248; val_gene_expr_recon_loss: 188076.7013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 221427.3251; val_optim_loss: 221427.3251
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9895; val_auprc_score: 0.9864; val_best_acc_score: 0.9605; val_best_f1_score: 0.9611; train_kl_reg_loss: 3905.7557; train_edge_recon_loss: 29217.9201; train_gene_expr_recon_loss: 183928.0937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 217051.7691; train_optim_loss: 217051.7691; val_kl_reg_loss: 3695.4768; val_edge_recon_loss: 28459.1774; val_gene_expr_recon_loss: 179645.2316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 211799.8868; val_optim_loss: 211799.8868
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9895; val_best_acc_score: 0.9641; val_best_f1_score: 0.9647; train_kl_reg_loss: 3691.9147; train_edge_recon_loss: 28673.2185; train_gene_expr_recon_loss: 177791.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 210156.6189; train_optim_loss: 210156.6189; val_kl_reg_loss: 3556.1735; val_edge_recon_loss: 27960.8563; val_gene_expr_recon_loss: 175433.2259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 206950.2551; val_optim_loss: 206950.2551
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9927; val_auprc_score: 0.9912; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 3594.8126; train_edge_recon_loss: 28359.2762; train_gene_expr_recon_loss: 173941.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 205895.9108; train_optim_loss: 205895.9108; val_kl_reg_loss: 3497.1708; val_edge_recon_loss: 27679.1103; val_gene_expr_recon_loss: 172637.7533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203814.0341; val_optim_loss: 203814.0341
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 3546.8719; train_edge_recon_loss: 28148.9452; train_gene_expr_recon_loss: 171381.9114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 203077.7286; train_optim_loss: 203077.7286; val_kl_reg_loss: 3485.2355; val_edge_recon_loss: 27505.8405; val_gene_expr_recon_loss: 170347.6724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201338.7482; val_optim_loss: 201338.7482
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9698; val_best_f1_score: 0.9702; train_kl_reg_loss: 3537.5260; train_edge_recon_loss: 27991.0917; train_gene_expr_recon_loss: 169642.1423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201170.7599; train_optim_loss: 201170.7599; val_kl_reg_loss: 3526.3367; val_edge_recon_loss: 27368.2954; val_gene_expr_recon_loss: 169136.4731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 200031.1063; val_optim_loss: 200031.1063
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 3538.8912; train_edge_recon_loss: 27876.8822; train_gene_expr_recon_loss: 168122.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 199538.7672; train_optim_loss: 199538.7672; val_kl_reg_loss: 3484.4510; val_edge_recon_loss: 27271.5857; val_gene_expr_recon_loss: 168093.0525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198849.0891; val_optim_loss: 198849.0891
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9935; val_best_acc_score: 0.9702; val_best_f1_score: 0.9705; train_kl_reg_loss: 3549.7642; train_edge_recon_loss: 27779.4935; train_gene_expr_recon_loss: 167110.3696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 198439.6274; train_optim_loss: 198439.6274; val_kl_reg_loss: 3553.0753; val_edge_recon_loss: 27208.1469; val_gene_expr_recon_loss: 167105.7034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197866.9255; val_optim_loss: 197866.9255
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9945; val_best_acc_score: 0.9718; val_best_f1_score: 0.9721; train_kl_reg_loss: 3566.9104; train_edge_recon_loss: 27708.7164; train_gene_expr_recon_loss: 166392.1894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 197667.8163; train_optim_loss: 197667.8163; val_kl_reg_loss: 3557.3101; val_edge_recon_loss: 27099.0397; val_gene_expr_recon_loss: 166593.4101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197249.7597; val_optim_loss: 197249.7597
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 3585.9970; train_edge_recon_loss: 27646.2898; train_gene_expr_recon_loss: 165523.9960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 196756.2828; train_optim_loss: 196756.2828; val_kl_reg_loss: 3581.2632; val_edge_recon_loss: 27134.0203; val_gene_expr_recon_loss: 166402.2003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197117.4839; val_optim_loss: 197117.4839
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9727; val_best_f1_score: 0.9729; train_kl_reg_loss: 3607.9846; train_edge_recon_loss: 27597.3031; train_gene_expr_recon_loss: 165061.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 196266.3112; train_optim_loss: 196266.3112; val_kl_reg_loss: 3573.1186; val_edge_recon_loss: 27024.2568; val_gene_expr_recon_loss: 165651.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196248.6342; val_optim_loss: 196248.6342
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9949; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 3630.7535; train_edge_recon_loss: 27553.8063; train_gene_expr_recon_loss: 164637.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 195822.4076; train_optim_loss: 195822.4076; val_kl_reg_loss: 3624.7924; val_edge_recon_loss: 27014.6078; val_gene_expr_recon_loss: 165870.9142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196510.3135; val_optim_loss: 196510.3135
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 3656.3718; train_edge_recon_loss: 27498.4622; train_gene_expr_recon_loss: 164151.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 195306.6818; train_optim_loss: 195306.6818; val_kl_reg_loss: 3627.4578; val_edge_recon_loss: 27039.0964; val_gene_expr_recon_loss: 165531.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196197.7718; val_optim_loss: 196197.7718
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 3676.3340; train_edge_recon_loss: 27481.0872; train_gene_expr_recon_loss: 163783.7199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194941.1411; train_optim_loss: 194941.1411; val_kl_reg_loss: 3653.4457; val_edge_recon_loss: 26962.2036; val_gene_expr_recon_loss: 165677.5674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196293.2167; val_optim_loss: 196293.2167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 3698.4952; train_edge_recon_loss: 27450.3158; train_gene_expr_recon_loss: 163535.4354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194684.2464; train_optim_loss: 194684.2464; val_kl_reg_loss: 3659.8339; val_edge_recon_loss: 26975.4814; val_gene_expr_recon_loss: 165561.6711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196196.9869; val_optim_loss: 196196.9869
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 3716.9479; train_edge_recon_loss: 27432.1471; train_gene_expr_recon_loss: 163164.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194313.7281; train_optim_loss: 194313.7281; val_kl_reg_loss: 3687.4395; val_edge_recon_loss: 26966.1665; val_gene_expr_recon_loss: 165251.6688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195905.2746; val_optim_loss: 195905.2746
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 3739.8440; train_edge_recon_loss: 27408.4387; train_gene_expr_recon_loss: 162967.2415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194115.5242; train_optim_loss: 194115.5242; val_kl_reg_loss: 3727.2239; val_edge_recon_loss: 26961.4824; val_gene_expr_recon_loss: 165564.9862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196253.6924; val_optim_loss: 196253.6924
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 3761.5614; train_edge_recon_loss: 27382.9249; train_gene_expr_recon_loss: 162932.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 194077.4478; train_optim_loss: 194077.4478; val_kl_reg_loss: 3695.6801; val_edge_recon_loss: 26928.1110; val_gene_expr_recon_loss: 165256.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195880.1516; val_optim_loss: 195880.1516
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 3783.1243; train_edge_recon_loss: 27354.4329; train_gene_expr_recon_loss: 162663.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193800.7010; train_optim_loss: 193800.7010; val_kl_reg_loss: 3773.9995; val_edge_recon_loss: 26926.9002; val_gene_expr_recon_loss: 165065.6365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195766.5356; val_optim_loss: 195766.5356
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 3797.1233; train_edge_recon_loss: 27358.1748; train_gene_expr_recon_loss: 162575.2767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193730.5746; train_optim_loss: 193730.5746; val_kl_reg_loss: 3818.5585; val_edge_recon_loss: 26985.4441; val_gene_expr_recon_loss: 165008.2249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195812.2269; val_optim_loss: 195812.2269
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 3815.0918; train_edge_recon_loss: 27339.4478; train_gene_expr_recon_loss: 162414.3850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193568.9246; train_optim_loss: 193568.9246; val_kl_reg_loss: 3785.7851; val_edge_recon_loss: 26910.2492; val_gene_expr_recon_loss: 165347.5120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196043.5461; val_optim_loss: 196043.5461
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9954; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 3829.4089; train_edge_recon_loss: 27334.6280; train_gene_expr_recon_loss: 162256.8562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193420.8930; train_optim_loss: 193420.8930; val_kl_reg_loss: 3781.5909; val_edge_recon_loss: 26921.4681; val_gene_expr_recon_loss: 165480.9910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196184.0510; val_optim_loss: 196184.0510
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 3842.4096; train_edge_recon_loss: 27329.4232; train_gene_expr_recon_loss: 162155.4166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 193327.2498; train_optim_loss: 193327.2498; val_kl_reg_loss: 3812.0809; val_edge_recon_loss: 26911.8487; val_gene_expr_recon_loss: 165681.4098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196405.3399; val_optim_loss: 196405.3399

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 3836.1983; train_edge_recon_loss: 27256.4993; train_gene_expr_recon_loss: 161245.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192337.9314; train_optim_loss: 192337.9314; val_kl_reg_loss: 3801.8617; val_edge_recon_loss: 26877.9523; val_gene_expr_recon_loss: 164917.4798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195597.2925; val_optim_loss: 195597.2925
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 3830.3838; train_edge_recon_loss: 27273.3863; train_gene_expr_recon_loss: 161200.8930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192304.6631; train_optim_loss: 192304.6631; val_kl_reg_loss: 3777.3660; val_edge_recon_loss: 26888.2366; val_gene_expr_recon_loss: 164860.5392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195526.1424; val_optim_loss: 195526.1424
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 3832.2049; train_edge_recon_loss: 27266.0048; train_gene_expr_recon_loss: 161170.3031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192268.5125; train_optim_loss: 192268.5125; val_kl_reg_loss: 3796.6242; val_edge_recon_loss: 26882.7033; val_gene_expr_recon_loss: 165095.4718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195774.7994; val_optim_loss: 195774.7994
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 3832.6735; train_edge_recon_loss: 27263.7148; train_gene_expr_recon_loss: 161278.0471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192374.4352; train_optim_loss: 192374.4352; val_kl_reg_loss: 3800.6253; val_edge_recon_loss: 26910.7187; val_gene_expr_recon_loss: 164915.5425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195626.8868; val_optim_loss: 195626.8868
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 3835.2222; train_edge_recon_loss: 27267.0083; train_gene_expr_recon_loss: 161068.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192170.2585; train_optim_loss: 192170.2585; val_kl_reg_loss: 3798.0932; val_edge_recon_loss: 26912.5524; val_gene_expr_recon_loss: 165457.1491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196167.7943; val_optim_loss: 196167.7943
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 3835.6146; train_edge_recon_loss: 27268.1500; train_gene_expr_recon_loss: 161176.4729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192280.2374; train_optim_loss: 192280.2374; val_kl_reg_loss: 3793.6435; val_edge_recon_loss: 26898.1620; val_gene_expr_recon_loss: 165170.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195862.2523; val_optim_loss: 195862.2523

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 3839.8970; train_edge_recon_loss: 27250.2589; train_gene_expr_recon_loss: 161058.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192149.0044; train_optim_loss: 192149.0044; val_kl_reg_loss: 3801.6872; val_edge_recon_loss: 26877.1291; val_gene_expr_recon_loss: 165500.9659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196179.7820; val_optim_loss: 196179.7820
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9756; val_best_f1_score: 0.9758; train_kl_reg_loss: 3838.1523; train_edge_recon_loss: 27260.6874; train_gene_expr_recon_loss: 160984.5579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192083.3974; train_optim_loss: 192083.3974; val_kl_reg_loss: 3793.9332; val_edge_recon_loss: 26906.3121; val_gene_expr_recon_loss: 165032.7587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195733.0041; val_optim_loss: 195733.0041
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 3835.8522; train_edge_recon_loss: 27254.2373; train_gene_expr_recon_loss: 160981.5620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192071.6511; train_optim_loss: 192071.6511; val_kl_reg_loss: 3796.5971; val_edge_recon_loss: 26897.9217; val_gene_expr_recon_loss: 165222.3107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195916.8289; val_optim_loss: 195916.8289
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 3836.3222; train_edge_recon_loss: 27256.2154; train_gene_expr_recon_loss: 161063.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192155.9744; train_optim_loss: 192155.9744; val_kl_reg_loss: 3797.2472; val_edge_recon_loss: 26905.8665; val_gene_expr_recon_loss: 165050.4516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 195753.5651; val_optim_loss: 195753.5651

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 119 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9966
Val AUPRC score: 0.9959
Val best accuracy score: 0.9761
Val best F1 score: 0.9763
Val target rna MSE score: 0.5838
Val source rna MSE score: 0.0354

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
