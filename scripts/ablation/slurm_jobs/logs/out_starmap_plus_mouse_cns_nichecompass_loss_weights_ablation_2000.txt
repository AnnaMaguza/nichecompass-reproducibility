None
Run timestamp: 16072023_191821_2000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9537; val_auprc_score: 0.9396; val_best_acc_score: 0.8946; val_best_f1_score: 0.8996; train_kl_reg_loss: 28043.1695; train_edge_recon_loss: 2798475.9896; train_gene_expr_recon_loss: 1298717.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4125236.5677; train_optim_loss: 4125236.5677; val_kl_reg_loss: 28421.9011; val_edge_recon_loss: 2675723.6818; val_gene_expr_recon_loss: 1173458.0057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3877603.5909; val_optim_loss: 3877603.5909
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9736; val_auprc_score: 0.9634; val_best_acc_score: 0.9307; val_best_f1_score: 0.9330; train_kl_reg_loss: 28975.2156; train_edge_recon_loss: 2628175.9714; train_gene_expr_recon_loss: 1128794.8418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3785946.0312; train_optim_loss: 3785946.0312; val_kl_reg_loss: 27159.5439; val_edge_recon_loss: 2639327.0568; val_gene_expr_recon_loss: 1107381.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3773868.4773; val_optim_loss: 3773868.4773
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9742; val_auprc_score: 0.9640; val_best_acc_score: 0.9369; val_best_f1_score: 0.9390; train_kl_reg_loss: 27265.4622; train_edge_recon_loss: 2611991.0273; train_gene_expr_recon_loss: 1085242.6540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3724499.1380; train_optim_loss: 3724499.1380; val_kl_reg_loss: 26570.6895; val_edge_recon_loss: 2633544.1591; val_gene_expr_recon_loss: 1078597.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3738712.8295; val_optim_loss: 3738712.8295
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9755; val_auprc_score: 0.9648; val_best_acc_score: 0.9383; val_best_f1_score: 0.9403; train_kl_reg_loss: 25736.1879; train_edge_recon_loss: 2604428.7487; train_gene_expr_recon_loss: 1058895.2259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3689060.1641; train_optim_loss: 3689060.1641; val_kl_reg_loss: 24881.3308; val_edge_recon_loss: 2632575.3182; val_gene_expr_recon_loss: 1052873.5170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3710330.1477; val_optim_loss: 3710330.1477
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9770; val_auprc_score: 0.9675; val_best_acc_score: 0.9431; val_best_f1_score: 0.9446; train_kl_reg_loss: 24489.1588; train_edge_recon_loss: 2601970.7513; train_gene_expr_recon_loss: 1037217.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3663677.2135; train_optim_loss: 3663677.2135; val_kl_reg_loss: 23477.8945; val_edge_recon_loss: 2633156.1591; val_gene_expr_recon_loss: 1036854.2528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3693488.3182; val_optim_loss: 3693488.3182
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9780; val_auprc_score: 0.9683; val_best_acc_score: 0.9463; val_best_f1_score: 0.9479; train_kl_reg_loss: 23994.5579; train_edge_recon_loss: 2595309.7240; train_gene_expr_recon_loss: 1020927.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3640232.1367; train_optim_loss: 3640232.1367; val_kl_reg_loss: 23455.6009; val_edge_recon_loss: 2626190.6705; val_gene_expr_recon_loss: 1020126.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3669772.3523; val_optim_loss: 3669772.3523
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9790; val_auprc_score: 0.9699; val_best_acc_score: 0.9479; val_best_f1_score: 0.9495; train_kl_reg_loss: 23592.8057; train_edge_recon_loss: 2593251.1758; train_gene_expr_recon_loss: 1008033.2354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3624877.2122; train_optim_loss: 3624877.2122; val_kl_reg_loss: 22630.7476; val_edge_recon_loss: 2619624.4091; val_gene_expr_recon_loss: 1009215.7869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3651470.9318; val_optim_loss: 3651470.9318
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9789; val_auprc_score: 0.9701; val_best_acc_score: 0.9491; val_best_f1_score: 0.9505; train_kl_reg_loss: 23083.3133; train_edge_recon_loss: 2589716.7461; train_gene_expr_recon_loss: 994639.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3607439.4766; train_optim_loss: 3607439.4766; val_kl_reg_loss: 22596.3552; val_edge_recon_loss: 2622454.5909; val_gene_expr_recon_loss: 998814.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3643865.8864; val_optim_loss: 3643865.8864
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9795; val_auprc_score: 0.9703; val_best_acc_score: 0.9488; val_best_f1_score: 0.9503; train_kl_reg_loss: 22631.1519; train_edge_recon_loss: 2589599.8333; train_gene_expr_recon_loss: 984306.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3596537.9570; train_optim_loss: 3596537.9570; val_kl_reg_loss: 21980.4756; val_edge_recon_loss: 2618675.8182; val_gene_expr_recon_loss: 991825.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3632482.3068; val_optim_loss: 3632482.3068
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9806; val_auprc_score: 0.9723; val_best_acc_score: 0.9509; val_best_f1_score: 0.9523; train_kl_reg_loss: 22278.5353; train_edge_recon_loss: 2585645.5482; train_gene_expr_recon_loss: 975552.5277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3583476.6016; train_optim_loss: 3583476.6016; val_kl_reg_loss: 21682.6985; val_edge_recon_loss: 2615325.1023; val_gene_expr_recon_loss: 983472.5767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3620480.3636; val_optim_loss: 3620480.3636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9814; val_auprc_score: 0.9736; val_best_acc_score: 0.9524; val_best_f1_score: 0.9538; train_kl_reg_loss: 21872.8393; train_edge_recon_loss: 2584908.7643; train_gene_expr_recon_loss: 965911.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3572692.9518; train_optim_loss: 3572692.9518; val_kl_reg_loss: 20827.1355; val_edge_recon_loss: 2613335.3523; val_gene_expr_recon_loss: 977583.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3611746.1932; val_optim_loss: 3611746.1932
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9811; val_auprc_score: 0.9730; val_best_acc_score: 0.9516; val_best_f1_score: 0.9528; train_kl_reg_loss: 21491.8115; train_edge_recon_loss: 2584633.4232; train_gene_expr_recon_loss: 959534.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3565660.1810; train_optim_loss: 3565660.1810; val_kl_reg_loss: 20670.4968; val_edge_recon_loss: 2613142.0341; val_gene_expr_recon_loss: 971469.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3605282.0909; val_optim_loss: 3605282.0909
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9817; val_auprc_score: 0.9738; val_best_acc_score: 0.9540; val_best_f1_score: 0.9552; train_kl_reg_loss: 21233.7403; train_edge_recon_loss: 2581571.8112; train_gene_expr_recon_loss: 953028.7165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3555834.2760; train_optim_loss: 3555834.2760; val_kl_reg_loss: 20368.5431; val_edge_recon_loss: 2605609.4659; val_gene_expr_recon_loss: 965311.3210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3591289.3295; val_optim_loss: 3591289.3295
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9817; val_auprc_score: 0.9734; val_best_acc_score: 0.9541; val_best_f1_score: 0.9553; train_kl_reg_loss: 20925.9908; train_edge_recon_loss: 2580317.2708; train_gene_expr_recon_loss: 946330.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3547573.4661; train_optim_loss: 3547573.4661; val_kl_reg_loss: 19992.7824; val_edge_recon_loss: 2610198.4205; val_gene_expr_recon_loss: 958351.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3588543.0455; val_optim_loss: 3588543.0455
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9828; val_auprc_score: 0.9753; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 20589.6157; train_edge_recon_loss: 2580419.1042; train_gene_expr_recon_loss: 942285.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3543293.7839; train_optim_loss: 3543293.7839; val_kl_reg_loss: 19829.8833; val_edge_recon_loss: 2604637.8750; val_gene_expr_recon_loss: 954375.4290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3578843.1818; val_optim_loss: 3578843.1818
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9827; val_auprc_score: 0.9751; val_best_acc_score: 0.9552; val_best_f1_score: 0.9563; train_kl_reg_loss: 20436.3577; train_edge_recon_loss: 2578461.6107; train_gene_expr_recon_loss: 937173.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3536071.8516; train_optim_loss: 3536071.8516; val_kl_reg_loss: 19947.5193; val_edge_recon_loss: 2607017.9205; val_gene_expr_recon_loss: 950356.7045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3577322.1250; val_optim_loss: 3577322.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9837; val_auprc_score: 0.9771; val_best_acc_score: 0.9566; val_best_f1_score: 0.9578; train_kl_reg_loss: 20283.5243; train_edge_recon_loss: 2576864.2500; train_gene_expr_recon_loss: 931965.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3529112.7891; train_optim_loss: 3529112.7891; val_kl_reg_loss: 19805.2699; val_edge_recon_loss: 2600224.8182; val_gene_expr_recon_loss: 949956.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3569987.0227; val_optim_loss: 3569987.0227
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9822; val_auprc_score: 0.9743; val_best_acc_score: 0.9558; val_best_f1_score: 0.9571; train_kl_reg_loss: 20049.5298; train_edge_recon_loss: 2577611.0612; train_gene_expr_recon_loss: 927968.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3525628.7018; train_optim_loss: 3525628.7018; val_kl_reg_loss: 19734.7216; val_edge_recon_loss: 2603699.5909; val_gene_expr_recon_loss: 949401.7898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3572836.0909; val_optim_loss: 3572836.0909
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9836; val_auprc_score: 0.9771; val_best_acc_score: 0.9565; val_best_f1_score: 0.9577; train_kl_reg_loss: 19817.3981; train_edge_recon_loss: 2576004.6328; train_gene_expr_recon_loss: 924243.0492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3520065.0794; train_optim_loss: 3520065.0794; val_kl_reg_loss: 19198.8894; val_edge_recon_loss: 2602043.2386; val_gene_expr_recon_loss: 944920.4006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566162.4773; val_optim_loss: 3566162.4773
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9841; val_auprc_score: 0.9781; val_best_acc_score: 0.9569; val_best_f1_score: 0.9581; train_kl_reg_loss: 19704.4176; train_edge_recon_loss: 2575516.9453; train_gene_expr_recon_loss: 919908.6546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3515130.0286; train_optim_loss: 3515130.0286; val_kl_reg_loss: 19321.7525; val_edge_recon_loss: 2601160.3068; val_gene_expr_recon_loss: 943714.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3564196.9545; val_optim_loss: 3564196.9545
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9840; val_auprc_score: 0.9776; val_best_acc_score: 0.9567; val_best_f1_score: 0.9578; train_kl_reg_loss: 19504.4535; train_edge_recon_loss: 2575844.7500; train_gene_expr_recon_loss: 917621.9932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3512971.2044; train_optim_loss: 3512971.2044; val_kl_reg_loss: 18923.1796; val_edge_recon_loss: 2604132.5227; val_gene_expr_recon_loss: 939791.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3562846.9886; val_optim_loss: 3562846.9886
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9842; val_auprc_score: 0.9775; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 19345.2382; train_edge_recon_loss: 2572711.3542; train_gene_expr_recon_loss: 913455.7650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3505512.3672; train_optim_loss: 3505512.3672; val_kl_reg_loss: 18910.6249; val_edge_recon_loss: 2601471.3182; val_gene_expr_recon_loss: 940348.1392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3560730.0909; val_optim_loss: 3560730.0909
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9842; val_auprc_score: 0.9772; val_best_acc_score: 0.9600; val_best_f1_score: 0.9608; train_kl_reg_loss: 19221.6488; train_edge_recon_loss: 2573842.2227; train_gene_expr_recon_loss: 909929.1533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3502993.0339; train_optim_loss: 3502993.0339; val_kl_reg_loss: 18875.2170; val_edge_recon_loss: 2597167.3182; val_gene_expr_recon_loss: 937949.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3553991.9659; val_optim_loss: 3553991.9659
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9789; val_best_acc_score: 0.9586; val_best_f1_score: 0.9596; train_kl_reg_loss: 19157.0040; train_edge_recon_loss: 2572954.7161; train_gene_expr_recon_loss: 908388.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3500499.9948; train_optim_loss: 3500499.9948; val_kl_reg_loss: 18543.6893; val_edge_recon_loss: 2598468.4205; val_gene_expr_recon_loss: 935087.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3552099.2614; val_optim_loss: 3552099.2614
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9858; val_auprc_score: 0.9803; val_best_acc_score: 0.9606; val_best_f1_score: 0.9615; train_kl_reg_loss: 18881.6651; train_edge_recon_loss: 2573757.6745; train_gene_expr_recon_loss: 906300.5996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3498939.9531; train_optim_loss: 3498939.9531; val_kl_reg_loss: 18463.4214; val_edge_recon_loss: 2593882.2045; val_gene_expr_recon_loss: 932625.9006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544971.5114; val_optim_loss: 3544971.5114
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9840; val_auprc_score: 0.9772; val_best_acc_score: 0.9586; val_best_f1_score: 0.9597; train_kl_reg_loss: 18874.3786; train_edge_recon_loss: 2571224.8307; train_gene_expr_recon_loss: 903172.0785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3493271.2852; train_optim_loss: 3493271.2852; val_kl_reg_loss: 18306.0460; val_edge_recon_loss: 2601121.6591; val_gene_expr_recon_loss: 936421.2898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3555849.0114; val_optim_loss: 3555849.0114
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9843; val_auprc_score: 0.9780; val_best_acc_score: 0.9582; val_best_f1_score: 0.9593; train_kl_reg_loss: 18761.5974; train_edge_recon_loss: 2572650.3411; train_gene_expr_recon_loss: 900783.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3492195.4323; train_optim_loss: 3492195.4323; val_kl_reg_loss: 18378.7469; val_edge_recon_loss: 2601512.8977; val_gene_expr_recon_loss: 931257.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3551149.1591; val_optim_loss: 3551149.1591
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9849; val_auprc_score: 0.9781; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 18710.1059; train_edge_recon_loss: 2571430.7135; train_gene_expr_recon_loss: 898726.9762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3488867.8125; train_optim_loss: 3488867.8125; val_kl_reg_loss: 18207.8121; val_edge_recon_loss: 2597346.6023; val_gene_expr_recon_loss: 931771.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3547325.4318; val_optim_loss: 3547325.4318
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9851; val_auprc_score: 0.9792; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 18570.6319; train_edge_recon_loss: 2569238.6250; train_gene_expr_recon_loss: 896371.0394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484180.2943; train_optim_loss: 3484180.2943; val_kl_reg_loss: 18078.3986; val_edge_recon_loss: 2594910.3523; val_gene_expr_recon_loss: 928775.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541764.6023; val_optim_loss: 3541764.6023
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9855; val_auprc_score: 0.9800; val_best_acc_score: 0.9603; val_best_f1_score: 0.9611; train_kl_reg_loss: 18488.0176; train_edge_recon_loss: 2571587.0807; train_gene_expr_recon_loss: 894291.6221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3484366.7018; train_optim_loss: 3484366.7018; val_kl_reg_loss: 17952.5762; val_edge_recon_loss: 2599309.2841; val_gene_expr_recon_loss: 930037.8153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3547299.6591; val_optim_loss: 3547299.6591
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9856; val_auprc_score: 0.9794; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 18472.8750; train_edge_recon_loss: 2570200.2161; train_gene_expr_recon_loss: 891917.6240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3480590.6940; train_optim_loss: 3480590.6940; val_kl_reg_loss: 18239.2569; val_edge_recon_loss: 2592323.6364; val_gene_expr_recon_loss: 929023.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539586.7500; val_optim_loss: 3539586.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9852; val_auprc_score: 0.9794; val_best_acc_score: 0.9606; val_best_f1_score: 0.9616; train_kl_reg_loss: 18384.3874; train_edge_recon_loss: 2571297.6302; train_gene_expr_recon_loss: 890417.8685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3480099.8724; train_optim_loss: 3480099.8724; val_kl_reg_loss: 18184.0565; val_edge_recon_loss: 2595506.4886; val_gene_expr_recon_loss: 929980.5710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543671.1364; val_optim_loss: 3543671.1364
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9849; val_auprc_score: 0.9783; val_best_acc_score: 0.9607; val_best_f1_score: 0.9616; train_kl_reg_loss: 18318.7455; train_edge_recon_loss: 2569244.9740; train_gene_expr_recon_loss: 888517.6579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3476081.3763; train_optim_loss: 3476081.3763; val_kl_reg_loss: 17994.7042; val_edge_recon_loss: 2594386.3182; val_gene_expr_recon_loss: 929614.4915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3541995.5114; val_optim_loss: 3541995.5114
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9868; val_auprc_score: 0.9823; val_best_acc_score: 0.9617; val_best_f1_score: 0.9626; train_kl_reg_loss: 18246.4818; train_edge_recon_loss: 2569342.2812; train_gene_expr_recon_loss: 887955.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3475544.1602; train_optim_loss: 3475544.1602; val_kl_reg_loss: 17823.2253; val_edge_recon_loss: 2595942.5455; val_gene_expr_recon_loss: 930153.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543918.9886; val_optim_loss: 3543918.9886
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9840; val_auprc_score: 0.9768; val_best_acc_score: 0.9595; val_best_f1_score: 0.9605; train_kl_reg_loss: 18277.7327; train_edge_recon_loss: 2567717.7383; train_gene_expr_recon_loss: 885670.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3471666.4583; train_optim_loss: 3471666.4583; val_kl_reg_loss: 18062.2627; val_edge_recon_loss: 2601277.3864; val_gene_expr_recon_loss: 929507.7330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3548847.4318; val_optim_loss: 3548847.4318

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9856; val_auprc_score: 0.9795; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 18335.2007; train_edge_recon_loss: 2567488.8854; train_gene_expr_recon_loss: 877712.5944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3463536.6836; train_optim_loss: 3463536.6836; val_kl_reg_loss: 17914.3762; val_edge_recon_loss: 2597358.7045; val_gene_expr_recon_loss: 924027.3267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3539300.3977; val_optim_loss: 3539300.3977
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9873; val_auprc_score: 0.9826; val_best_acc_score: 0.9644; val_best_f1_score: 0.9652; train_kl_reg_loss: 18293.3656; train_edge_recon_loss: 2565040.5820; train_gene_expr_recon_loss: 877700.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3461034.3932; train_optim_loss: 3461034.3932; val_kl_reg_loss: 17800.8799; val_edge_recon_loss: 2589731.1250; val_gene_expr_recon_loss: 921666.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529198.5341; val_optim_loss: 3529198.5341
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9869; val_auprc_score: 0.9819; val_best_acc_score: 0.9631; val_best_f1_score: 0.9640; train_kl_reg_loss: 18270.1779; train_edge_recon_loss: 2566700.9492; train_gene_expr_recon_loss: 876458.5713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3461429.7005; train_optim_loss: 3461429.7005; val_kl_reg_loss: 17883.8905; val_edge_recon_loss: 2588929.5682; val_gene_expr_recon_loss: 922302.1960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3529115.6477; val_optim_loss: 3529115.6477
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9845; val_auprc_score: 0.9781; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 18256.6914; train_edge_recon_loss: 2566580.5755; train_gene_expr_recon_loss: 876655.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3461492.7539; train_optim_loss: 3461492.7539; val_kl_reg_loss: 17852.8168; val_edge_recon_loss: 2599283.7273; val_gene_expr_recon_loss: 925589.5142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542726.0227; val_optim_loss: 3542726.0227
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9863; val_auprc_score: 0.9811; val_best_acc_score: 0.9631; val_best_f1_score: 0.9639; train_kl_reg_loss: 18254.9347; train_edge_recon_loss: 2567509.1953; train_gene_expr_recon_loss: 875393.9606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3461158.0846; train_optim_loss: 3461158.0846; val_kl_reg_loss: 17888.3798; val_edge_recon_loss: 2593997.0455; val_gene_expr_recon_loss: 926209.3665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538094.7841; val_optim_loss: 3538094.7841
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9861; val_auprc_score: 0.9805; val_best_acc_score: 0.9628; val_best_f1_score: 0.9637; train_kl_reg_loss: 18229.1446; train_edge_recon_loss: 2568083.4635; train_gene_expr_recon_loss: 875883.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3462196.1953; train_optim_loss: 3462196.1953; val_kl_reg_loss: 17843.5334; val_edge_recon_loss: 2594429.7841; val_gene_expr_recon_loss: 924615.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536889.1705; val_optim_loss: 3536889.1705
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9866; val_auprc_score: 0.9819; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 18219.7008; train_edge_recon_loss: 2566236.5990; train_gene_expr_recon_loss: 875100.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3459556.3620; train_optim_loss: 3459556.3620; val_kl_reg_loss: 17803.8002; val_edge_recon_loss: 2595255.6705; val_gene_expr_recon_loss: 925008.9858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538068.4432; val_optim_loss: 3538068.4432

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9866; val_auprc_score: 0.9819; val_best_acc_score: 0.9624; val_best_f1_score: 0.9633; train_kl_reg_loss: 18229.9436; train_edge_recon_loss: 2567621.9766; train_gene_expr_recon_loss: 874745.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3460597.6940; train_optim_loss: 3460597.6940; val_kl_reg_loss: 17866.6749; val_edge_recon_loss: 2597014.1023; val_gene_expr_recon_loss: 924033.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538914.5114; val_optim_loss: 3538914.5114
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9868; val_auprc_score: 0.9814; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 18236.3663; train_edge_recon_loss: 2565378.2552; train_gene_expr_recon_loss: 874649.7477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3458264.3711; train_optim_loss: 3458264.3711; val_kl_reg_loss: 17842.8321; val_edge_recon_loss: 2589174.1591; val_gene_expr_recon_loss: 923458.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530475.8636; val_optim_loss: 3530475.8636
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9853; val_auprc_score: 0.9790; val_best_acc_score: 0.9619; val_best_f1_score: 0.9629; train_kl_reg_loss: 18230.5398; train_edge_recon_loss: 2566248.5469; train_gene_expr_recon_loss: 874469.5534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3458948.6393; train_optim_loss: 3458948.6393; val_kl_reg_loss: 17838.3798; val_edge_recon_loss: 2596697.2045; val_gene_expr_recon_loss: 922240.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536775.9659; val_optim_loss: 3536775.9659
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9861; val_auprc_score: 0.9807; val_best_acc_score: 0.9624; val_best_f1_score: 0.9633; train_kl_reg_loss: 18249.9198; train_edge_recon_loss: 2566082.8255; train_gene_expr_recon_loss: 874047.8115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3458380.5599; train_optim_loss: 3458380.5599; val_kl_reg_loss: 17862.1221; val_edge_recon_loss: 2590890.7273; val_gene_expr_recon_loss: 922074.9972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3530827.8636; val_optim_loss: 3530827.8636

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 45 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9874
Val AUPRC score: 0.9826
Val best accuracy score: 0.9645
Val best F1 score: 0.9653
Val gene expr MSE score: 0.6923

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
