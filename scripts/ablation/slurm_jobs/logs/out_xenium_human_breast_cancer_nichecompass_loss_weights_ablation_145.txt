None
Run timestamp: 14072023_224431_145.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_145']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9356; val_auprc_score: 0.9153; val_best_acc_score: 0.8747; val_best_f1_score: 0.8833; train_kl_reg_loss: 20396.2550; train_edge_recon_loss: 2731411.3930; train_gene_expr_recon_loss: 790150.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3541958.2790; train_optim_loss: 3541958.2790; val_kl_reg_loss: 17873.9953; val_edge_recon_loss: 2698596.9375; val_gene_expr_recon_loss: 718724.5576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3435195.4737; val_optim_loss: 3435195.4737
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9493; val_auprc_score: 0.9351; val_best_acc_score: 0.8901; val_best_f1_score: 0.8964; train_kl_reg_loss: 17042.6175; train_edge_recon_loss: 2641756.9415; train_gene_expr_recon_loss: 699735.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3358534.8415; train_optim_loss: 3358534.8415; val_kl_reg_loss: 15300.9514; val_edge_recon_loss: 2687404.0066; val_gene_expr_recon_loss: 683212.5082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3385917.4638; val_optim_loss: 3385917.4638
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9608; val_auprc_score: 0.9512; val_best_acc_score: 0.9034; val_best_f1_score: 0.9071; train_kl_reg_loss: 15415.2958; train_edge_recon_loss: 2627819.9765; train_gene_expr_recon_loss: 673055.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3316290.3360; train_optim_loss: 3316290.3360; val_kl_reg_loss: 14784.6789; val_edge_recon_loss: 2678834.9375; val_gene_expr_recon_loss: 664597.2574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3358216.8454; val_optim_loss: 3358216.8454
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9661; val_auprc_score: 0.9579; val_best_acc_score: 0.9117; val_best_f1_score: 0.9158; train_kl_reg_loss: 14810.4669; train_edge_recon_loss: 2623037.4551; train_gene_expr_recon_loss: 655970.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3293818.1048; train_optim_loss: 3293818.1048; val_kl_reg_loss: 14048.7788; val_edge_recon_loss: 2673543.2138; val_gene_expr_recon_loss: 648848.8873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3336440.8684; val_optim_loss: 3336440.8684
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9673; val_auprc_score: 0.9593; val_best_acc_score: 0.9139; val_best_f1_score: 0.9170; train_kl_reg_loss: 14515.3026; train_edge_recon_loss: 2617618.5636; train_gene_expr_recon_loss: 644412.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3276546.1522; train_optim_loss: 3276546.1522; val_kl_reg_loss: 13557.7221; val_edge_recon_loss: 2670961.1151; val_gene_expr_recon_loss: 641143.0222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3325661.8586; val_optim_loss: 3325661.8586
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9687; val_auprc_score: 0.9603; val_best_acc_score: 0.9179; val_best_f1_score: 0.9207; train_kl_reg_loss: 14207.2659; train_edge_recon_loss: 2617073.5739; train_gene_expr_recon_loss: 636003.2546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3267284.0956; train_optim_loss: 3267284.0956; val_kl_reg_loss: 13703.9206; val_edge_recon_loss: 2662675.7928; val_gene_expr_recon_loss: 633123.9548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3309503.6480; val_optim_loss: 3309503.6480
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9682; val_auprc_score: 0.9587; val_best_acc_score: 0.9180; val_best_f1_score: 0.9206; train_kl_reg_loss: 13980.0411; train_edge_recon_loss: 2614393.0063; train_gene_expr_recon_loss: 629706.8903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3258079.9397; train_optim_loss: 3258079.9397; val_kl_reg_loss: 13873.9761; val_edge_recon_loss: 2663786.2566; val_gene_expr_recon_loss: 628117.7664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3305777.9967; val_optim_loss: 3305777.9967
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9708; val_auprc_score: 0.9633; val_best_acc_score: 0.9213; val_best_f1_score: 0.9239; train_kl_reg_loss: 13857.2623; train_edge_recon_loss: 2610902.7860; train_gene_expr_recon_loss: 625689.8612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250449.9158; train_optim_loss: 3250449.9158; val_kl_reg_loss: 13470.3573; val_edge_recon_loss: 2662375.0822; val_gene_expr_recon_loss: 625271.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3301117.3355; val_optim_loss: 3301117.3355
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9709; val_auprc_score: 0.9619; val_best_acc_score: 0.9234; val_best_f1_score: 0.9261; train_kl_reg_loss: 13675.0032; train_edge_recon_loss: 2609593.2335; train_gene_expr_recon_loss: 622108.1479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3245376.3816; train_optim_loss: 3245376.3816; val_kl_reg_loss: 13229.8948; val_edge_recon_loss: 2659637.6447; val_gene_expr_recon_loss: 620340.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3293207.9079; val_optim_loss: 3293207.9079
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9713; val_auprc_score: 0.9626; val_best_acc_score: 0.9248; val_best_f1_score: 0.9271; train_kl_reg_loss: 13545.3360; train_edge_recon_loss: 2606870.2301; train_gene_expr_recon_loss: 619291.7593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3239707.3243; train_optim_loss: 3239707.3243; val_kl_reg_loss: 13090.9694; val_edge_recon_loss: 2660911.3421; val_gene_expr_recon_loss: 619356.8150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3293359.1151; val_optim_loss: 3293359.1151
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9738; val_auprc_score: 0.9670; val_best_acc_score: 0.9267; val_best_f1_score: 0.9291; train_kl_reg_loss: 13298.6406; train_edge_recon_loss: 2608269.2239; train_gene_expr_recon_loss: 617076.3037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238644.1717; train_optim_loss: 3238644.1717; val_kl_reg_loss: 12850.5699; val_edge_recon_loss: 2659726.9507; val_gene_expr_recon_loss: 616199.0304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3288776.5428; val_optim_loss: 3288776.5428
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9727; val_auprc_score: 0.9646; val_best_acc_score: 0.9268; val_best_f1_score: 0.9293; train_kl_reg_loss: 13274.4671; train_edge_recon_loss: 2605976.8051; train_gene_expr_recon_loss: 615338.2615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3234589.5331; train_optim_loss: 3234589.5331; val_kl_reg_loss: 13042.8398; val_edge_recon_loss: 2652155.4539; val_gene_expr_recon_loss: 614754.9260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279953.2171; val_optim_loss: 3279953.2171
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9731; val_auprc_score: 0.9651; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 13141.3497; train_edge_recon_loss: 2605896.0721; train_gene_expr_recon_loss: 614150.3774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3233187.7938; train_optim_loss: 3233187.7938; val_kl_reg_loss: 12596.7288; val_edge_recon_loss: 2658785.8191; val_gene_expr_recon_loss: 614715.9712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3286098.5164; val_optim_loss: 3286098.5164
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9745; val_auprc_score: 0.9676; val_best_acc_score: 0.9283; val_best_f1_score: 0.9306; train_kl_reg_loss: 13097.8402; train_edge_recon_loss: 2604905.5276; train_gene_expr_recon_loss: 612460.0942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3230463.4673; train_optim_loss: 3230463.4673; val_kl_reg_loss: 12648.2653; val_edge_recon_loss: 2653699.8586; val_gene_expr_recon_loss: 614031.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3280380.0230; val_optim_loss: 3280380.0230
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9735; val_auprc_score: 0.9663; val_best_acc_score: 0.9275; val_best_f1_score: 0.9298; train_kl_reg_loss: 13030.3817; train_edge_recon_loss: 2604171.0522; train_gene_expr_recon_loss: 611597.0986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3228798.5305; train_optim_loss: 3228798.5305; val_kl_reg_loss: 12740.4651; val_edge_recon_loss: 2658553.7895; val_gene_expr_recon_loss: 614270.5378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3285564.8059; val_optim_loss: 3285564.8059
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9752; val_auprc_score: 0.9680; val_best_acc_score: 0.9300; val_best_f1_score: 0.9322; train_kl_reg_loss: 12955.4753; train_edge_recon_loss: 2604035.4680; train_gene_expr_recon_loss: 610451.3928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3227442.3401; train_optim_loss: 3227442.3401; val_kl_reg_loss: 12546.1286; val_edge_recon_loss: 2653386.4572; val_gene_expr_recon_loss: 612472.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3278405.2961; val_optim_loss: 3278405.2961
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9755; val_auprc_score: 0.9689; val_best_acc_score: 0.9296; val_best_f1_score: 0.9317; train_kl_reg_loss: 12943.9830; train_edge_recon_loss: 2601928.1283; train_gene_expr_recon_loss: 609597.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3224469.4460; train_optim_loss: 3224469.4460; val_kl_reg_loss: 12489.8107; val_edge_recon_loss: 2653254.0757; val_gene_expr_recon_loss: 613320.9613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279064.8553; val_optim_loss: 3279064.8553
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9748; val_auprc_score: 0.9680; val_best_acc_score: 0.9289; val_best_f1_score: 0.9312; train_kl_reg_loss: 12875.1964; train_edge_recon_loss: 2601827.2320; train_gene_expr_recon_loss: 608996.8600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3223699.2831; train_optim_loss: 3223699.2831; val_kl_reg_loss: 12558.0623; val_edge_recon_loss: 2652980.1250; val_gene_expr_recon_loss: 610538.2426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276076.4309; val_optim_loss: 3276076.4309
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9757; val_auprc_score: 0.9690; val_best_acc_score: 0.9303; val_best_f1_score: 0.9321; train_kl_reg_loss: 12814.4079; train_edge_recon_loss: 2600514.7930; train_gene_expr_recon_loss: 608342.7672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3221671.9592; train_optim_loss: 3221671.9592; val_kl_reg_loss: 12438.2785; val_edge_recon_loss: 2654351.0954; val_gene_expr_recon_loss: 609676.0674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276465.4375; val_optim_loss: 3276465.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9756; val_auprc_score: 0.9679; val_best_acc_score: 0.9315; val_best_f1_score: 0.9340; train_kl_reg_loss: 12798.0571; train_edge_recon_loss: 2599186.7846; train_gene_expr_recon_loss: 607904.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219888.8772; train_optim_loss: 3219888.8772; val_kl_reg_loss: 12343.7215; val_edge_recon_loss: 2649012.5263; val_gene_expr_recon_loss: 609606.2360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3270962.4868; val_optim_loss: 3270962.4868
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9752; val_auprc_score: 0.9677; val_best_acc_score: 0.9304; val_best_f1_score: 0.9327; train_kl_reg_loss: 12752.1904; train_edge_recon_loss: 2600082.4408; train_gene_expr_recon_loss: 606940.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219775.5941; train_optim_loss: 3219775.5941; val_kl_reg_loss: 12577.6579; val_edge_recon_loss: 2652150.1875; val_gene_expr_recon_loss: 608101.5337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3272829.3849; val_optim_loss: 3272829.3849
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9755; val_auprc_score: 0.9682; val_best_acc_score: 0.9311; val_best_f1_score: 0.9332; train_kl_reg_loss: 12685.0241; train_edge_recon_loss: 2599710.3070; train_gene_expr_recon_loss: 606791.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3219186.4320; train_optim_loss: 3219186.4320; val_kl_reg_loss: 12435.9922; val_edge_recon_loss: 2653434.6283; val_gene_expr_recon_loss: 608177.7146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3274048.3454; val_optim_loss: 3274048.3454
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9758; val_auprc_score: 0.9688; val_best_acc_score: 0.9303; val_best_f1_score: 0.9325; train_kl_reg_loss: 12712.3819; train_edge_recon_loss: 2599321.7577; train_gene_expr_recon_loss: 606282.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3218316.1441; train_optim_loss: 3218316.1441; val_kl_reg_loss: 12375.7166; val_edge_recon_loss: 2658106.8980; val_gene_expr_recon_loss: 608456.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3278938.7829; val_optim_loss: 3278938.7829
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9770; val_auprc_score: 0.9704; val_best_acc_score: 0.9323; val_best_f1_score: 0.9343; train_kl_reg_loss: 12701.2918; train_edge_recon_loss: 2599213.5022; train_gene_expr_recon_loss: 605185.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3217099.9676; train_optim_loss: 3217099.9676; val_kl_reg_loss: 11930.5113; val_edge_recon_loss: 2656732.1974; val_gene_expr_recon_loss: 608778.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3277441.3618; val_optim_loss: 3277441.3618

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9763; val_auprc_score: 0.9687; val_best_acc_score: 0.9319; val_best_f1_score: 0.9341; train_kl_reg_loss: 12628.3781; train_edge_recon_loss: 2597850.3621; train_gene_expr_recon_loss: 600691.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3211170.0621; train_optim_loss: 3211170.0621; val_kl_reg_loss: 12424.9981; val_edge_recon_loss: 2652649.4441; val_gene_expr_recon_loss: 602580.4359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267654.8651; val_optim_loss: 3267654.8651
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9772; val_auprc_score: 0.9707; val_best_acc_score: 0.9335; val_best_f1_score: 0.9353; train_kl_reg_loss: 12797.2097; train_edge_recon_loss: 2597410.6136; train_gene_expr_recon_loss: 600141.9898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210349.8096; train_optim_loss: 3210349.8096; val_kl_reg_loss: 12376.8751; val_edge_recon_loss: 2648951.3816; val_gene_expr_recon_loss: 603144.5304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264472.7697; val_optim_loss: 3264472.7697
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9776; val_auprc_score: 0.9713; val_best_acc_score: 0.9334; val_best_f1_score: 0.9350; train_kl_reg_loss: 12803.1957; train_edge_recon_loss: 2596057.4901; train_gene_expr_recon_loss: 600236.8870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209097.5776; train_optim_loss: 3209097.5776; val_kl_reg_loss: 12458.9024; val_edge_recon_loss: 2650015.9967; val_gene_expr_recon_loss: 603593.5863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266068.4934; val_optim_loss: 3266068.4934
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9769; val_auprc_score: 0.9705; val_best_acc_score: 0.9328; val_best_f1_score: 0.9347; train_kl_reg_loss: 12829.1695; train_edge_recon_loss: 2596454.7276; train_gene_expr_recon_loss: 599651.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208935.6871; train_optim_loss: 3208935.6871; val_kl_reg_loss: 12533.0133; val_edge_recon_loss: 2651833.8816; val_gene_expr_recon_loss: 602025.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266392.1776; val_optim_loss: 3266392.1776
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9769; val_auprc_score: 0.9706; val_best_acc_score: 0.9327; val_best_f1_score: 0.9347; train_kl_reg_loss: 12800.4812; train_edge_recon_loss: 2597997.5463; train_gene_expr_recon_loss: 599484.6438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3210282.6772; train_optim_loss: 3210282.6772; val_kl_reg_loss: 12529.4280; val_edge_recon_loss: 2651935.8849; val_gene_expr_recon_loss: 601093.9326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265559.2533; val_optim_loss: 3265559.2533
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9769; val_auprc_score: 0.9701; val_best_acc_score: 0.9333; val_best_f1_score: 0.9353; train_kl_reg_loss: 12792.3776; train_edge_recon_loss: 2596952.8493; train_gene_expr_recon_loss: 599789.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209534.5040; train_optim_loss: 3209534.5040; val_kl_reg_loss: 12447.3226; val_edge_recon_loss: 2649807.7862; val_gene_expr_recon_loss: 602707.6587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264962.7763; val_optim_loss: 3264962.7763

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9760; val_auprc_score: 0.9688; val_best_acc_score: 0.9323; val_best_f1_score: 0.9344; train_kl_reg_loss: 12778.4159; train_edge_recon_loss: 2596686.8206; train_gene_expr_recon_loss: 599087.6281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208552.8651; train_optim_loss: 3208552.8651; val_kl_reg_loss: 12444.4490; val_edge_recon_loss: 2651781.8322; val_gene_expr_recon_loss: 601859.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3266085.6184; val_optim_loss: 3266085.6184
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9770; val_auprc_score: 0.9707; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 12768.8174; train_edge_recon_loss: 2596170.6324; train_gene_expr_recon_loss: 599091.2612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208030.7081; train_optim_loss: 3208030.7081; val_kl_reg_loss: 12454.1179; val_edge_recon_loss: 2650133.2961; val_gene_expr_recon_loss: 602335.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264922.5559; val_optim_loss: 3264922.5559
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9775; val_auprc_score: 0.9709; val_best_acc_score: 0.9344; val_best_f1_score: 0.9361; train_kl_reg_loss: 12773.1898; train_edge_recon_loss: 2595556.2563; train_gene_expr_recon_loss: 598611.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206941.4077; train_optim_loss: 3206941.4077; val_kl_reg_loss: 12458.6185; val_edge_recon_loss: 2649112.6974; val_gene_expr_recon_loss: 601221.7212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262793.0362; val_optim_loss: 3262793.0362
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9770; val_auprc_score: 0.9704; val_best_acc_score: 0.9331; val_best_f1_score: 0.9351; train_kl_reg_loss: 12780.0639; train_edge_recon_loss: 2596214.2647; train_gene_expr_recon_loss: 598749.4780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207743.8132; train_optim_loss: 3207743.8132; val_kl_reg_loss: 12490.5726; val_edge_recon_loss: 2649302.7862; val_gene_expr_recon_loss: 602504.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264297.9276; val_optim_loss: 3264297.9276
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9770; val_auprc_score: 0.9703; val_best_acc_score: 0.9338; val_best_f1_score: 0.9355; train_kl_reg_loss: 12788.0399; train_edge_recon_loss: 2594162.8129; train_gene_expr_recon_loss: 599102.6106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206053.4691; train_optim_loss: 3206053.4691; val_kl_reg_loss: 12474.6046; val_edge_recon_loss: 2648311.9375; val_gene_expr_recon_loss: 601605.9260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3262392.4638; val_optim_loss: 3262392.4638
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9771; val_auprc_score: 0.9704; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 12776.7877; train_edge_recon_loss: 2594865.7287; train_gene_expr_recon_loss: 598813.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206456.4246; train_optim_loss: 3206456.4246; val_kl_reg_loss: 12455.4486; val_edge_recon_loss: 2645590.1908; val_gene_expr_recon_loss: 601076.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259121.9803; val_optim_loss: 3259121.9803
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9769; val_auprc_score: 0.9703; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 12775.5483; train_edge_recon_loss: 2596155.7743; train_gene_expr_recon_loss: 598624.0494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207555.3757; train_optim_loss: 3207555.3757; val_kl_reg_loss: 12432.7536; val_edge_recon_loss: 2650381.4145; val_gene_expr_recon_loss: 601482.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3264296.2862; val_optim_loss: 3264296.2862
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9330; val_best_f1_score: 0.9349; train_kl_reg_loss: 12752.2762; train_edge_recon_loss: 2597043.6989; train_gene_expr_recon_loss: 598874.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208670.5066; train_optim_loss: 3208670.5066; val_kl_reg_loss: 12423.2259; val_edge_recon_loss: 2654308.4803; val_gene_expr_recon_loss: 601602.9104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268334.6184; val_optim_loss: 3268334.6184
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9777; val_auprc_score: 0.9715; val_best_acc_score: 0.9351; val_best_f1_score: 0.9368; train_kl_reg_loss: 12752.1701; train_edge_recon_loss: 2595501.1783; train_gene_expr_recon_loss: 598740.1021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206993.4449; train_optim_loss: 3206993.4449; val_kl_reg_loss: 12464.4209; val_edge_recon_loss: 2647085.1678; val_gene_expr_recon_loss: 601333.8660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3260883.4539; val_optim_loss: 3260883.4539
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9774; val_auprc_score: 0.9707; val_best_acc_score: 0.9338; val_best_f1_score: 0.9358; train_kl_reg_loss: 12776.6622; train_edge_recon_loss: 2596647.2066; train_gene_expr_recon_loss: 598785.0541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208208.9279; train_optim_loss: 3208208.9279; val_kl_reg_loss: 12447.2476; val_edge_recon_loss: 2649647.4408; val_gene_expr_recon_loss: 603361.3405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265456.0197; val_optim_loss: 3265456.0197

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9774; val_auprc_score: 0.9708; val_best_acc_score: 0.9343; val_best_f1_score: 0.9362; train_kl_reg_loss: 12770.1647; train_edge_recon_loss: 2596907.6581; train_gene_expr_recon_loss: 598692.5626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3208370.3824; train_optim_loss: 3208370.3824; val_kl_reg_loss: 12449.8753; val_edge_recon_loss: 2645707.5658; val_gene_expr_recon_loss: 600957.6604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259115.1020; val_optim_loss: 3259115.1020
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9774; val_auprc_score: 0.9708; val_best_acc_score: 0.9339; val_best_f1_score: 0.9361; train_kl_reg_loss: 12770.6732; train_edge_recon_loss: 2596403.6081; train_gene_expr_recon_loss: 598331.8622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207506.1460; train_optim_loss: 3207506.1460; val_kl_reg_loss: 12455.6872; val_edge_recon_loss: 2649322.4934; val_gene_expr_recon_loss: 601372.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263150.5230; val_optim_loss: 3263150.5230
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9779; val_auprc_score: 0.9721; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 12770.8486; train_edge_recon_loss: 2595829.8022; train_gene_expr_recon_loss: 598567.4464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207168.0857; train_optim_loss: 3207168.0857; val_kl_reg_loss: 12447.7683; val_edge_recon_loss: 2649003.9441; val_gene_expr_recon_loss: 601709.7171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263161.4375; val_optim_loss: 3263161.4375
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9772; val_auprc_score: 0.9704; val_best_acc_score: 0.9332; val_best_f1_score: 0.9351; train_kl_reg_loss: 12765.9520; train_edge_recon_loss: 2596220.6816; train_gene_expr_recon_loss: 598458.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207444.8415; train_optim_loss: 3207444.8415; val_kl_reg_loss: 12441.7609; val_edge_recon_loss: 2647965.3684; val_gene_expr_recon_loss: 601098.3035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261505.4342; val_optim_loss: 3261505.4342
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9781; val_auprc_score: 0.9720; val_best_acc_score: 0.9351; val_best_f1_score: 0.9368; train_kl_reg_loss: 12770.6822; train_edge_recon_loss: 2595919.9673; train_gene_expr_recon_loss: 598689.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3207380.2191; train_optim_loss: 3207380.2191; val_kl_reg_loss: 12463.8979; val_edge_recon_loss: 2645520.9342; val_gene_expr_recon_loss: 603335.7253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261320.5592; val_optim_loss: 3261320.5592

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9768; val_auprc_score: 0.9708; val_best_acc_score: 0.9328; val_best_f1_score: 0.9347; train_kl_reg_loss: 12774.0404; train_edge_recon_loss: 2597678.2493; train_gene_expr_recon_loss: 599024.4543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209476.7434; train_optim_loss: 3209476.7434; val_kl_reg_loss: 12457.3758; val_edge_recon_loss: 2651296.4671; val_gene_expr_recon_loss: 602219.3355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265973.1678; val_optim_loss: 3265973.1678
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9768; val_auprc_score: 0.9703; val_best_acc_score: 0.9328; val_best_f1_score: 0.9347; train_kl_reg_loss: 12772.0359; train_edge_recon_loss: 2595368.5938; train_gene_expr_recon_loss: 598683.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3206823.6625; train_optim_loss: 3206823.6625; val_kl_reg_loss: 12447.5935; val_edge_recon_loss: 2651137.5658; val_gene_expr_recon_loss: 602107.2484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265692.4013; val_optim_loss: 3265692.4013
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9776; val_auprc_score: 0.9714; val_best_acc_score: 0.9343; val_best_f1_score: 0.9359; train_kl_reg_loss: 12771.0358; train_edge_recon_loss: 2597619.9963; train_gene_expr_recon_loss: 598698.8962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209089.9283; train_optim_loss: 3209089.9283; val_kl_reg_loss: 12443.5001; val_edge_recon_loss: 2647147.2007; val_gene_expr_recon_loss: 601483.8331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261074.5428; val_optim_loss: 3261074.5428
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9766; val_auprc_score: 0.9698; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 12771.3400; train_edge_recon_loss: 2597830.7588; train_gene_expr_recon_loss: 599001.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3209603.1298; train_optim_loss: 3209603.1298; val_kl_reg_loss: 12451.5499; val_edge_recon_loss: 2653211.3289; val_gene_expr_recon_loss: 602418.0452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3268080.9145; val_optim_loss: 3268080.9145

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 86 min 41 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9772
Val AUPRC score: 0.9703
Val best accuracy score: 0.9334
Val best F1 score: 0.9353
Val gene expr MSE score: 1.4188

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
