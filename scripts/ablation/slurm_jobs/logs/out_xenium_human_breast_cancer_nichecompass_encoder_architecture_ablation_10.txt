None
Run timestamp: 10072023_172103_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9873; val_auprc_score: 0.9852; val_best_acc_score: 0.9478; val_best_f1_score: 0.9488; train_kl_reg_loss: 6491.3969; train_edge_recon_loss: 267008.2424; train_gene_expr_recon_loss: 78225.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351725.4826; train_optim_loss: 351725.4826; val_kl_reg_loss: 5991.8911; val_edge_recon_loss: 262794.9049; val_gene_expr_recon_loss: 71565.7012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340352.4981; val_optim_loss: 340352.4981
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9927; val_auprc_score: 0.9917; val_best_acc_score: 0.9623; val_best_f1_score: 0.9627; train_kl_reg_loss: 6071.1071; train_edge_recon_loss: 261132.6937; train_gene_expr_recon_loss: 69995.6614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337199.4619; train_optim_loss: 337199.4619; val_kl_reg_loss: 6020.4544; val_edge_recon_loss: 261288.7115; val_gene_expr_recon_loss: 68414.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335723.9857; val_optim_loss: 335723.9857
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9944; val_auprc_score: 0.9933; val_best_acc_score: 0.9686; val_best_f1_score: 0.9689; train_kl_reg_loss: 5934.4320; train_edge_recon_loss: 260027.7282; train_gene_expr_recon_loss: 67767.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333729.3584; train_optim_loss: 333729.3584; val_kl_reg_loss: 5897.9769; val_edge_recon_loss: 259968.7461; val_gene_expr_recon_loss: 66735.5070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332602.2269; val_optim_loss: 332602.2269
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9933; val_best_acc_score: 0.9689; val_best_f1_score: 0.9692; train_kl_reg_loss: 5860.6732; train_edge_recon_loss: 259334.3834; train_gene_expr_recon_loss: 66617.0095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331812.0662; train_optim_loss: 331812.0662; val_kl_reg_loss: 5742.3594; val_edge_recon_loss: 259486.0891; val_gene_expr_recon_loss: 66032.8390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331261.2892; val_optim_loss: 331261.2892
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9955; val_auprc_score: 0.9948; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 5811.2730; train_edge_recon_loss: 258814.7337; train_gene_expr_recon_loss: 65992.8121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330618.8186; train_optim_loss: 330618.8186; val_kl_reg_loss: 5688.2256; val_edge_recon_loss: 259293.9487; val_gene_expr_recon_loss: 65359.4504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330341.6237; val_optim_loss: 330341.6237
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9741; val_best_f1_score: 0.9743; train_kl_reg_loss: 5771.7323; train_edge_recon_loss: 258529.1386; train_gene_expr_recon_loss: 65483.7352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329784.6072; train_optim_loss: 329784.6072; val_kl_reg_loss: 5746.9359; val_edge_recon_loss: 258786.8622; val_gene_expr_recon_loss: 65107.8604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329641.6588; val_optim_loss: 329641.6588
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9753; val_best_f1_score: 0.9755; train_kl_reg_loss: 5746.7894; train_edge_recon_loss: 258183.4869; train_gene_expr_recon_loss: 65220.0232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329150.2996; train_optim_loss: 329150.2996; val_kl_reg_loss: 5775.1475; val_edge_recon_loss: 258563.2750; val_gene_expr_recon_loss: 64747.5700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329085.9904; val_optim_loss: 329085.9904
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 5724.4042; train_edge_recon_loss: 257955.3362; train_gene_expr_recon_loss: 64954.5364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328634.2775; train_optim_loss: 328634.2775; val_kl_reg_loss: 5719.0986; val_edge_recon_loss: 257985.7535; val_gene_expr_recon_loss: 64728.2003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328433.0535; val_optim_loss: 328433.0535
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 5709.0013; train_edge_recon_loss: 257721.6688; train_gene_expr_recon_loss: 64803.8919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328234.5615; train_optim_loss: 328234.5615; val_kl_reg_loss: 5657.7360; val_edge_recon_loss: 258303.7130; val_gene_expr_recon_loss: 64492.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328454.1672; val_optim_loss: 328454.1672
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 5696.2571; train_edge_recon_loss: 257530.3838; train_gene_expr_recon_loss: 64621.4116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327848.0527; train_optim_loss: 327848.0527; val_kl_reg_loss: 5588.9062; val_edge_recon_loss: 257474.8007; val_gene_expr_recon_loss: 64377.2369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327440.9443; val_optim_loss: 327440.9443
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 5679.5777; train_edge_recon_loss: 257381.6201; train_gene_expr_recon_loss: 64480.1550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327541.3530; train_optim_loss: 327541.3530; val_kl_reg_loss: 5623.6690; val_edge_recon_loss: 257350.4143; val_gene_expr_recon_loss: 64180.2907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327154.3737; val_optim_loss: 327154.3737
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 5669.8982; train_edge_recon_loss: 257190.3151; train_gene_expr_recon_loss: 64374.5930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327234.8060; train_optim_loss: 327234.8060; val_kl_reg_loss: 5609.1219; val_edge_recon_loss: 257601.9308; val_gene_expr_recon_loss: 64047.4185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327258.4715; val_optim_loss: 327258.4715
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5656.0468; train_edge_recon_loss: 257047.9278; train_gene_expr_recon_loss: 64273.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326977.8566; train_optim_loss: 326977.8566; val_kl_reg_loss: 5757.2333; val_edge_recon_loss: 257185.4500; val_gene_expr_recon_loss: 63988.4366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326931.1194; val_optim_loss: 326931.1194
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 5638.6983; train_edge_recon_loss: 256991.6792; train_gene_expr_recon_loss: 64154.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326784.5367; train_optim_loss: 326784.5367; val_kl_reg_loss: 5495.5133; val_edge_recon_loss: 257257.8628; val_gene_expr_recon_loss: 63988.6273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326742.0034; val_optim_loss: 326742.0034
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5628.0823; train_edge_recon_loss: 256902.9426; train_gene_expr_recon_loss: 64103.1075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326634.1327; train_optim_loss: 326634.1327; val_kl_reg_loss: 5636.4953; val_edge_recon_loss: 257054.0409; val_gene_expr_recon_loss: 63926.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326617.0088; val_optim_loss: 326617.0088
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5619.3445; train_edge_recon_loss: 256766.0366; train_gene_expr_recon_loss: 64025.7472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326411.1283; train_optim_loss: 326411.1283; val_kl_reg_loss: 5473.4619; val_edge_recon_loss: 256766.3850; val_gene_expr_recon_loss: 63789.4226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326029.2697; val_optim_loss: 326029.2697
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5604.3406; train_edge_recon_loss: 256682.8446; train_gene_expr_recon_loss: 63934.4910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326221.6760; train_optim_loss: 326221.6760; val_kl_reg_loss: 5657.1097; val_edge_recon_loss: 256496.7322; val_gene_expr_recon_loss: 63710.7942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325864.6359; val_optim_loss: 325864.6359
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5588.3909; train_edge_recon_loss: 256590.2043; train_gene_expr_recon_loss: 63907.8552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326086.4498; train_optim_loss: 326086.4498; val_kl_reg_loss: 5526.5852; val_edge_recon_loss: 256586.4415; val_gene_expr_recon_loss: 63772.6915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325885.7185; val_optim_loss: 325885.7185
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 5573.5859; train_edge_recon_loss: 256508.0215; train_gene_expr_recon_loss: 63826.6660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325908.2732; train_optim_loss: 325908.2732; val_kl_reg_loss: 5577.0234; val_edge_recon_loss: 256466.2204; val_gene_expr_recon_loss: 63657.5529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325700.7977; val_optim_loss: 325700.7977
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5557.7763; train_edge_recon_loss: 256403.1331; train_gene_expr_recon_loss: 63796.5425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325757.4522; train_optim_loss: 325757.4522; val_kl_reg_loss: 5515.1837; val_edge_recon_loss: 256482.5438; val_gene_expr_recon_loss: 63604.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325602.4381; val_optim_loss: 325602.4381
