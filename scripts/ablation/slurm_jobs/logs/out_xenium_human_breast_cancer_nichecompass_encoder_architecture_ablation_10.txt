None
Run timestamp: 19072023_201355_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9725; val_auprc_score: 0.9678; val_best_acc_score: 0.9179; val_best_f1_score: 0.9208; train_kl_reg_loss: 76396.8088; train_edge_recon_loss: 26762831.5703; train_gene_expr_recon_loss: 7634309.4331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34473537.7920; train_optim_loss: 34473537.7920; val_kl_reg_loss: 66033.7775; val_edge_recon_loss: 26392481.2192; val_gene_expr_recon_loss: 7099663.5240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33558178.5068; val_optim_loss: 33558178.5068
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9835; val_auprc_score: 0.9811; val_best_acc_score: 0.9382; val_best_f1_score: 0.9394; train_kl_reg_loss: 59908.6723; train_edge_recon_loss: 26103733.5046; train_gene_expr_recon_loss: 6924958.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33088601.1147; train_optim_loss: 33088601.1147; val_kl_reg_loss: 52358.2859; val_edge_recon_loss: 26204171.8493; val_gene_expr_recon_loss: 6810380.2226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33066910.3699; val_optim_loss: 33066910.3699
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9893; val_auprc_score: 0.9875; val_best_acc_score: 0.9532; val_best_f1_score: 0.9540; train_kl_reg_loss: 49864.1043; train_edge_recon_loss: 25935643.4404; train_gene_expr_recon_loss: 6735733.3020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32721240.8578; train_optim_loss: 32721240.8578; val_kl_reg_loss: 45266.6648; val_edge_recon_loss: 26084912.8493; val_gene_expr_recon_loss: 6700367.9966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32830547.6301; val_optim_loss: 32830547.6301
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9914; val_auprc_score: 0.9900; val_best_acc_score: 0.9590; val_best_f1_score: 0.9595; train_kl_reg_loss: 44124.0825; train_edge_recon_loss: 25863289.2049; train_gene_expr_recon_loss: 6644114.7290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32551527.9602; train_optim_loss: 32551527.9602; val_kl_reg_loss: 40955.6472; val_edge_recon_loss: 26030619.9589; val_gene_expr_recon_loss: 6611795.4349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32683370.9315; val_optim_loss: 32683370.9315
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9927; val_auprc_score: 0.9915; val_best_acc_score: 0.9619; val_best_f1_score: 0.9623; train_kl_reg_loss: 40082.3025; train_edge_recon_loss: 25795420.5933; train_gene_expr_recon_loss: 6580508.9125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32416011.8287; train_optim_loss: 32416011.8287; val_kl_reg_loss: 37356.7442; val_edge_recon_loss: 25952332.4795; val_gene_expr_recon_loss: 6568265.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32557954.5205; val_optim_loss: 32557954.5205
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9930; val_auprc_score: 0.9917; val_best_acc_score: 0.9645; val_best_f1_score: 0.9650; train_kl_reg_loss: 37398.3842; train_edge_recon_loss: 25770152.6453; train_gene_expr_recon_loss: 6535985.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32343536.1284; train_optim_loss: 32343536.1284; val_kl_reg_loss: 34956.8069; val_edge_recon_loss: 25943144.1370; val_gene_expr_recon_loss: 6534250.9692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32512351.7945; val_optim_loss: 32512351.7945
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9929; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 35947.6152; train_edge_recon_loss: 25735825.2156; train_gene_expr_recon_loss: 6501502.7202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32273275.5229; train_optim_loss: 32273275.5229; val_kl_reg_loss: 34878.9058; val_edge_recon_loss: 25895192.2192; val_gene_expr_recon_loss: 6493610.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32423681.2055; val_optim_loss: 32423681.2055
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9941; val_auprc_score: 0.9931; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 34854.9544; train_edge_recon_loss: 25709655.4771; train_gene_expr_recon_loss: 6470638.9725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215149.3685; train_optim_loss: 32215149.3685; val_kl_reg_loss: 33964.6137; val_edge_recon_loss: 25871666.1370; val_gene_expr_recon_loss: 6469035.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32374666.0137; val_optim_loss: 32374666.0137
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9941; val_auprc_score: 0.9932; val_best_acc_score: 0.9673; val_best_f1_score: 0.9675; train_kl_reg_loss: 33954.8785; train_edge_recon_loss: 25698688.6086; train_gene_expr_recon_loss: 6450298.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32182942.2263; train_optim_loss: 32182942.2263; val_kl_reg_loss: 33684.8567; val_edge_recon_loss: 25874885.4110; val_gene_expr_recon_loss: 6452473.5068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32361043.8219; val_optim_loss: 32361043.8219
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9935; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 33303.0503; train_edge_recon_loss: 25680124.2829; train_gene_expr_recon_loss: 6430132.7412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32143560.0872; train_optim_loss: 32143560.0872; val_kl_reg_loss: 32477.4016; val_edge_recon_loss: 25837435.9452; val_gene_expr_recon_loss: 6443302.6062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32313215.9178; val_optim_loss: 32313215.9178
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9940; val_auprc_score: 0.9932; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 32646.2126; train_edge_recon_loss: 25672783.6040; train_gene_expr_recon_loss: 6413817.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119247.6636; train_optim_loss: 32119247.6636; val_kl_reg_loss: 32198.4452; val_edge_recon_loss: 25861744.1918; val_gene_expr_recon_loss: 6424920.6712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32318863.3562; val_optim_loss: 32318863.3562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9938; val_best_acc_score: 0.9701; val_best_f1_score: 0.9704; train_kl_reg_loss: 32383.3427; train_edge_recon_loss: 25660856.1529; train_gene_expr_recon_loss: 6399056.2641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32092295.7416; train_optim_loss: 32092295.7416; val_kl_reg_loss: 32704.1997; val_edge_recon_loss: 25818018.5616; val_gene_expr_recon_loss: 6416266.9932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32266989.7260; val_optim_loss: 32266989.7260
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9941; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 31570.0542; train_edge_recon_loss: 25657911.0015; train_gene_expr_recon_loss: 6387660.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32077141.5566; train_optim_loss: 32077141.5566; val_kl_reg_loss: 31610.8621; val_edge_recon_loss: 25765951.5479; val_gene_expr_recon_loss: 6406794.3733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32204356.6986; val_optim_loss: 32204356.6986
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9934; val_best_acc_score: 0.9694; val_best_f1_score: 0.9698; train_kl_reg_loss: 31565.9552; train_edge_recon_loss: 25642641.0275; train_gene_expr_recon_loss: 6375633.2477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32049840.2141; train_optim_loss: 32049840.2141; val_kl_reg_loss: 30736.6183; val_edge_recon_loss: 25782624.9863; val_gene_expr_recon_loss: 6387722.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32201083.8219; val_optim_loss: 32201083.8219
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9948; val_auprc_score: 0.9939; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 31163.2567; train_edge_recon_loss: 25638576.9098; train_gene_expr_recon_loss: 6363281.5015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32033021.6590; train_optim_loss: 32033021.6590; val_kl_reg_loss: 29861.5572; val_edge_recon_loss: 25828965.7671; val_gene_expr_recon_loss: 6384595.6473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32243422.8904; val_optim_loss: 32243422.8904
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 31036.8716; train_edge_recon_loss: 25622134.2141; train_gene_expr_recon_loss: 6352657.1735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32005828.2508; train_optim_loss: 32005828.2508; val_kl_reg_loss: 30928.6840; val_edge_recon_loss: 25766544.8082; val_gene_expr_recon_loss: 6359918.7123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32157392.1918; val_optim_loss: 32157392.1918
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9941; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 30748.9008; train_edge_recon_loss: 25627859.6758; train_gene_expr_recon_loss: 6345034.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32003643.3394; train_optim_loss: 32003643.3394; val_kl_reg_loss: 31079.6647; val_edge_recon_loss: 25775236.3425; val_gene_expr_recon_loss: 6358796.1747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32165112.1507; val_optim_loss: 32165112.1507
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9943; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 30643.2933; train_edge_recon_loss: 25611331.7722; train_gene_expr_recon_loss: 6337443.1747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31979418.2385; train_optim_loss: 31979418.2385; val_kl_reg_loss: 30779.4244; val_edge_recon_loss: 25774699.9315; val_gene_expr_recon_loss: 6362066.6473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32167546.0548; val_optim_loss: 32167546.0548
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 30389.6982; train_edge_recon_loss: 25619151.8073; train_gene_expr_recon_loss: 6330694.5596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31980236.0657; train_optim_loss: 31980236.0657; val_kl_reg_loss: 29554.7183; val_edge_recon_loss: 25737210.1644; val_gene_expr_recon_loss: 6355109.9281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32121874.8082; val_optim_loss: 32121874.8082
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9953; val_auprc_score: 0.9944; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 30218.7969; train_edge_recon_loss: 25603586.3471; train_gene_expr_recon_loss: 6325573.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31959378.3410; train_optim_loss: 31959378.3410; val_kl_reg_loss: 29935.7788; val_edge_recon_loss: 25776619.4110; val_gene_expr_recon_loss: 6337225.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32143780.6849; val_optim_loss: 32143780.6849
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9955; val_auprc_score: 0.9948; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 30096.9746; train_edge_recon_loss: 25591670.3654; train_gene_expr_recon_loss: 6315790.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31937557.7706; train_optim_loss: 31937557.7706; val_kl_reg_loss: 29804.9922; val_edge_recon_loss: 25739230.0274; val_gene_expr_recon_loss: 6343177.1952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32112212.1507; val_optim_loss: 32112212.1507
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 30250.7358; train_edge_recon_loss: 25592748.6468; train_gene_expr_recon_loss: 6310608.5803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31933607.9740; train_optim_loss: 31933607.9740; val_kl_reg_loss: 30771.0350; val_edge_recon_loss: 25783566.3699; val_gene_expr_recon_loss: 6337681.2740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32152018.6575; val_optim_loss: 32152018.6575
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 29921.6630; train_edge_recon_loss: 25592652.7187; train_gene_expr_recon_loss: 6305820.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31928394.9924; train_optim_loss: 31928394.9924; val_kl_reg_loss: 29828.2411; val_edge_recon_loss: 25734401.6438; val_gene_expr_recon_loss: 6332152.2226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32096382.0274; val_optim_loss: 32096382.0274
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9943; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 29818.2775; train_edge_recon_loss: 25573257.8425; train_gene_expr_recon_loss: 6302398.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31905474.2217; train_optim_loss: 31905474.2217; val_kl_reg_loss: 28906.7987; val_edge_recon_loss: 25734644.2877; val_gene_expr_recon_loss: 6322190.6301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32085741.7397; val_optim_loss: 32085741.7397
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9751; val_best_f1_score: 0.9753; train_kl_reg_loss: 29866.0357; train_edge_recon_loss: 25582026.2232; train_gene_expr_recon_loss: 6292913.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31904805.7768; train_optim_loss: 31904805.7768; val_kl_reg_loss: 28733.0378; val_edge_recon_loss: 25720974.0274; val_gene_expr_recon_loss: 6333932.0034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32083639.1233; val_optim_loss: 32083639.1233
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9956; val_auprc_score: 0.9948; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 29769.5898; train_edge_recon_loss: 25572231.9251; train_gene_expr_recon_loss: 6290914.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31892915.7920; train_optim_loss: 31892915.7920; val_kl_reg_loss: 29140.2095; val_edge_recon_loss: 25724629.2740; val_gene_expr_recon_loss: 6308640.9829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32062410.4658; val_optim_loss: 32062410.4658
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 29750.9839; train_edge_recon_loss: 25566772.9939; train_gene_expr_recon_loss: 6287379.8337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31883903.8058; train_optim_loss: 31883903.8058; val_kl_reg_loss: 30026.6017; val_edge_recon_loss: 25697665.9589; val_gene_expr_recon_loss: 6305551.2021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32033243.7123; val_optim_loss: 32033243.7123
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9950; val_auprc_score: 0.9941; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 29781.9193; train_edge_recon_loss: 25566959.3899; train_gene_expr_recon_loss: 6281250.5141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31877991.8135; train_optim_loss: 31877991.8135; val_kl_reg_loss: 27966.8647; val_edge_recon_loss: 25703328.4247; val_gene_expr_recon_loss: 6322872.4966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32054167.7534; val_optim_loss: 32054167.7534
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9950; val_auprc_score: 0.9940; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 29347.3853; train_edge_recon_loss: 25569272.9526; train_gene_expr_recon_loss: 6279019.4782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31877639.7875; train_optim_loss: 31877639.7875; val_kl_reg_loss: 29931.7343; val_edge_recon_loss: 25723081.1507; val_gene_expr_recon_loss: 6301763.8288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32054776.6849; val_optim_loss: 32054776.6849
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 29487.2576; train_edge_recon_loss: 25564731.1667; train_gene_expr_recon_loss: 6275052.3956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31869270.8486; train_optim_loss: 31869270.8486; val_kl_reg_loss: 27409.0456; val_edge_recon_loss: 25707662.0959; val_gene_expr_recon_loss: 6290415.1096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32025486.1096; val_optim_loss: 32025486.1096
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 29270.3701; train_edge_recon_loss: 25559244.4602; train_gene_expr_recon_loss: 6270754.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31859268.9450; train_optim_loss: 31859268.9450; val_kl_reg_loss: 30738.1659; val_edge_recon_loss: 25709586.8356; val_gene_expr_recon_loss: 6296062.7774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32036387.9315; val_optim_loss: 32036387.9315
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9954; val_auprc_score: 0.9945; val_best_acc_score: 0.9754; val_best_f1_score: 0.9756; train_kl_reg_loss: 29104.1421; train_edge_recon_loss: 25560661.5688; train_gene_expr_recon_loss: 6267332.4966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31857098.1972; train_optim_loss: 31857098.1972; val_kl_reg_loss: 28626.9665; val_edge_recon_loss: 25669652.6712; val_gene_expr_recon_loss: 6296830.4075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31995109.9726; val_optim_loss: 31995109.9726
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 29332.0205; train_edge_recon_loss: 25547026.1544; train_gene_expr_recon_loss: 6262946.3601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31839304.5076; train_optim_loss: 31839304.5076; val_kl_reg_loss: 28891.3019; val_edge_recon_loss: 25694289.4247; val_gene_expr_recon_loss: 6288138.6473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32011319.3836; val_optim_loss: 32011319.3836
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9958; val_auprc_score: 0.9948; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 29255.8466; train_edge_recon_loss: 25552465.8823; train_gene_expr_recon_loss: 6259836.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31841558.6820; train_optim_loss: 31841558.6820; val_kl_reg_loss: 28803.8986; val_edge_recon_loss: 25700467.5753; val_gene_expr_recon_loss: 6282388.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32011660.1507; val_optim_loss: 32011660.1507
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 29338.5373; train_edge_recon_loss: 25543890.4159; train_gene_expr_recon_loss: 6256612.4006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31829841.3884; train_optim_loss: 31829841.3884; val_kl_reg_loss: 29387.6219; val_edge_recon_loss: 25650544.0959; val_gene_expr_recon_loss: 6278562.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31958494.4110; val_optim_loss: 31958494.4110
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 29347.7757; train_edge_recon_loss: 25546084.2966; train_gene_expr_recon_loss: 6249251.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31824683.7141; train_optim_loss: 31824683.7141; val_kl_reg_loss: 29287.0961; val_edge_recon_loss: 25639460.0548; val_gene_expr_recon_loss: 6297230.2158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31965977.4658; val_optim_loss: 31965977.4658
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9956; val_auprc_score: 0.9947; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 29142.8293; train_edge_recon_loss: 25539280.9281; train_gene_expr_recon_loss: 6248202.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31816626.6606; train_optim_loss: 31816626.6606; val_kl_reg_loss: 29426.2184; val_edge_recon_loss: 25687981.8904; val_gene_expr_recon_loss: 6272142.2123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31989550.3562; val_optim_loss: 31989550.3562
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 29344.5352; train_edge_recon_loss: 25533526.9006; train_gene_expr_recon_loss: 6246451.7699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31809323.2324; train_optim_loss: 31809323.2324; val_kl_reg_loss: 28784.5451; val_edge_recon_loss: 25708580.2466; val_gene_expr_recon_loss: 6298531.6541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32035896.4795; val_optim_loss: 32035896.4795
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 29129.8682; train_edge_recon_loss: 25528983.4878; train_gene_expr_recon_loss: 6240686.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31798799.7171; train_optim_loss: 31798799.7171; val_kl_reg_loss: 28479.7933; val_edge_recon_loss: 25693264.3562; val_gene_expr_recon_loss: 6268387.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31990131.8630; val_optim_loss: 31990131.8630

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9960; val_auprc_score: 0.9952; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 31707.7925; train_edge_recon_loss: 25511141.0550; train_gene_expr_recon_loss: 6171869.0375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31714717.9052; train_optim_loss: 31714717.9052; val_kl_reg_loss: 32472.9682; val_edge_recon_loss: 25665351.9863; val_gene_expr_recon_loss: 6201989.8630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31899814.7945; val_optim_loss: 31899814.7945
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 33273.8983; train_edge_recon_loss: 25504738.8073; train_gene_expr_recon_loss: 6158375.4247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31696388.1269; train_optim_loss: 31696388.1269; val_kl_reg_loss: 32646.4464; val_edge_recon_loss: 25636876.0411; val_gene_expr_recon_loss: 6201893.7158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31871416.1918; val_optim_loss: 31871416.1918
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 34183.9534; train_edge_recon_loss: 25500525.4465; train_gene_expr_recon_loss: 6155394.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31690103.9159; train_optim_loss: 31690103.9159; val_kl_reg_loss: 33841.4022; val_edge_recon_loss: 25623370.0822; val_gene_expr_recon_loss: 6201452.1678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31858663.7671; val_optim_loss: 31858663.7671
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 34299.8551; train_edge_recon_loss: 25504549.6009; train_gene_expr_recon_loss: 6151961.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31690811.2966; train_optim_loss: 31690811.2966; val_kl_reg_loss: 33295.3360; val_edge_recon_loss: 25623886.0548; val_gene_expr_recon_loss: 6191502.2945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31848683.5616; val_optim_loss: 31848683.5616
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 34093.5622; train_edge_recon_loss: 25498918.1391; train_gene_expr_recon_loss: 6150039.6323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31683051.2844; train_optim_loss: 31683051.2844; val_kl_reg_loss: 34602.5993; val_edge_recon_loss: 25620485.7808; val_gene_expr_recon_loss: 6173171.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31828259.5890; val_optim_loss: 31828259.5890
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 34258.6944; train_edge_recon_loss: 25492715.4205; train_gene_expr_recon_loss: 6149204.7504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31676178.8364; train_optim_loss: 31676178.8364; val_kl_reg_loss: 34056.4124; val_edge_recon_loss: 25615129.6849; val_gene_expr_recon_loss: 6187857.0377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31837043.0137; val_optim_loss: 31837043.0137
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 34407.0906; train_edge_recon_loss: 25500274.7217; train_gene_expr_recon_loss: 6145847.1097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31680528.9358; train_optim_loss: 31680528.9358; val_kl_reg_loss: 33986.2258; val_edge_recon_loss: 25607537.7534; val_gene_expr_recon_loss: 6185327.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31826851.2740; val_optim_loss: 31826851.2740
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 34439.6429; train_edge_recon_loss: 25492710.5841; train_gene_expr_recon_loss: 6146305.9786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31673456.2278; train_optim_loss: 31673456.2278; val_kl_reg_loss: 33955.5991; val_edge_recon_loss: 25623239.4384; val_gene_expr_recon_loss: 6192255.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31849450.0959; val_optim_loss: 31849450.0959
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 34436.1919; train_edge_recon_loss: 25497331.8807; train_gene_expr_recon_loss: 6143171.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31674939.3058; train_optim_loss: 31674939.3058; val_kl_reg_loss: 34399.1703; val_edge_recon_loss: 25612841.0685; val_gene_expr_recon_loss: 6179673.1130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31826913.3014; val_optim_loss: 31826913.3014
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 34330.6794; train_edge_recon_loss: 25488991.4862; train_gene_expr_recon_loss: 6140997.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31664320.1070; train_optim_loss: 31664320.1070; val_kl_reg_loss: 33403.8402; val_edge_recon_loss: 25609274.0137; val_gene_expr_recon_loss: 6170344.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31813022.2603; val_optim_loss: 31813022.2603
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 34271.2029; train_edge_recon_loss: 25494608.9021; train_gene_expr_recon_loss: 6138513.4174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31667393.5061; train_optim_loss: 31667393.5061; val_kl_reg_loss: 33502.5420; val_edge_recon_loss: 25621327.4247; val_gene_expr_recon_loss: 6184754.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31839584.8767; val_optim_loss: 31839584.8767
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 34423.3155; train_edge_recon_loss: 25495634.0550; train_gene_expr_recon_loss: 6142291.1024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31672348.4862; train_optim_loss: 31672348.4862; val_kl_reg_loss: 34208.2590; val_edge_recon_loss: 25615235.9178; val_gene_expr_recon_loss: 6180924.7603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31830368.8493; val_optim_loss: 31830368.8493
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 34435.2711; train_edge_recon_loss: 25493926.6621; train_gene_expr_recon_loss: 6140353.4969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31668715.4618; train_optim_loss: 31668715.4618; val_kl_reg_loss: 33868.8607; val_edge_recon_loss: 25629412.5479; val_gene_expr_recon_loss: 6174816.9966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31838098.3425; val_optim_loss: 31838098.3425
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 34377.2941; train_edge_recon_loss: 25495153.0596; train_gene_expr_recon_loss: 6137223.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31666753.3563; train_optim_loss: 31666753.3563; val_kl_reg_loss: 33779.9519; val_edge_recon_loss: 25598207.7945; val_gene_expr_recon_loss: 6183926.1747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31815914.0685; val_optim_loss: 31815914.0685

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 34480.7193; train_edge_recon_loss: 25496409.6024; train_gene_expr_recon_loss: 6127056.7649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31657947.0245; train_optim_loss: 31657947.0245; val_kl_reg_loss: 34135.6146; val_edge_recon_loss: 25608934.4384; val_gene_expr_recon_loss: 6164638.7842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31807708.8767; val_optim_loss: 31807708.8767
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 34516.3995; train_edge_recon_loss: 25493015.0153; train_gene_expr_recon_loss: 6124300.6139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31651832.0061; train_optim_loss: 31651832.0061; val_kl_reg_loss: 33966.2751; val_edge_recon_loss: 25609460.3836; val_gene_expr_recon_loss: 6176235.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31819662.4795; val_optim_loss: 31819662.4795
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 34611.7931; train_edge_recon_loss: 25492585.1498; train_gene_expr_recon_loss: 6126471.1338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31653668.0229; train_optim_loss: 31653668.0229; val_kl_reg_loss: 33914.0608; val_edge_recon_loss: 25643503.5205; val_gene_expr_recon_loss: 6166496.2911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31843913.8767; val_optim_loss: 31843913.8767
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 34683.3561; train_edge_recon_loss: 25489919.4266; train_gene_expr_recon_loss: 6126971.9912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31651574.7936; train_optim_loss: 31651574.7936; val_kl_reg_loss: 34211.5688; val_edge_recon_loss: 25609059.7534; val_gene_expr_recon_loss: 6166414.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31809685.6438; val_optim_loss: 31809685.6438
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 34738.8209; train_edge_recon_loss: 25488802.3853; train_gene_expr_recon_loss: 6126501.2898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31650042.4893; train_optim_loss: 31650042.4893; val_kl_reg_loss: 34167.2226; val_edge_recon_loss: 25627010.5205; val_gene_expr_recon_loss: 6164676.3870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31825854.1370; val_optim_loss: 31825854.1370

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 34705.9353; train_edge_recon_loss: 25491149.6101; train_gene_expr_recon_loss: 6124318.0096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31650173.5841; train_optim_loss: 31650173.5841; val_kl_reg_loss: 34143.9495; val_edge_recon_loss: 25618920.3151; val_gene_expr_recon_loss: 6158208.1096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31811272.3425; val_optim_loss: 31811272.3425
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 34675.8659; train_edge_recon_loss: 25492323.0275; train_gene_expr_recon_loss: 6122479.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31649478.6254; train_optim_loss: 31649478.6254; val_kl_reg_loss: 34106.3949; val_edge_recon_loss: 25617479.1096; val_gene_expr_recon_loss: 6164742.2055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31816327.6164; val_optim_loss: 31816327.6164
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 34694.3443; train_edge_recon_loss: 25490138.0245; train_gene_expr_recon_loss: 6125083.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31649916.1713; train_optim_loss: 31649916.1713; val_kl_reg_loss: 34114.9851; val_edge_recon_loss: 25605790.3836; val_gene_expr_recon_loss: 6166218.2466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31806123.7671; val_optim_loss: 31806123.7671
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 34636.4432; train_edge_recon_loss: 25489182.0841; train_gene_expr_recon_loss: 6123744.2794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31647562.7997; train_optim_loss: 31647562.7997; val_kl_reg_loss: 34132.5731; val_edge_recon_loss: 25642142.0548; val_gene_expr_recon_loss: 6163232.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31839507.3151; val_optim_loss: 31839507.3151
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 34680.4875; train_edge_recon_loss: 25488383.4878; train_gene_expr_recon_loss: 6125490.8567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31648554.7691; train_optim_loss: 31648554.7691; val_kl_reg_loss: 34151.9058; val_edge_recon_loss: 25631176.5890; val_gene_expr_recon_loss: 6169978.4110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31835306.8630; val_optim_loss: 31835306.8630
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9964; val_auprc_score: 0.9956; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 34674.6437; train_edge_recon_loss: 25479168.9190; train_gene_expr_recon_loss: 6126232.1961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31640075.7370; train_optim_loss: 31640075.7370; val_kl_reg_loss: 34208.0593; val_edge_recon_loss: 25610075.5890; val_gene_expr_recon_loss: 6169205.5890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31813489.2192; val_optim_loss: 31813489.2192
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 34740.0877; train_edge_recon_loss: 25491357.9526; train_gene_expr_recon_loss: 6126364.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31652462.9052; train_optim_loss: 31652462.9052; val_kl_reg_loss: 34233.0542; val_edge_recon_loss: 25639765.2603; val_gene_expr_recon_loss: 6168947.5788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31842945.8082; val_optim_loss: 31842945.8082

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 34745.7936; train_edge_recon_loss: 25485348.4419; train_gene_expr_recon_loss: 6126015.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31646109.9419; train_optim_loss: 31646109.9419; val_kl_reg_loss: 34249.9640; val_edge_recon_loss: 25597736.3973; val_gene_expr_recon_loss: 6168901.2808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31800887.6301; val_optim_loss: 31800887.6301
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 34711.5473; train_edge_recon_loss: 25488660.3639; train_gene_expr_recon_loss: 6124912.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31648284.2844; train_optim_loss: 31648284.2844; val_kl_reg_loss: 34243.1102; val_edge_recon_loss: 25620688.6027; val_gene_expr_recon_loss: 6162509.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31817441.3288; val_optim_loss: 31817441.3288
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 34758.3476; train_edge_recon_loss: 25488869.5275; train_gene_expr_recon_loss: 6121723.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31645350.9220; train_optim_loss: 31645350.9220; val_kl_reg_loss: 34211.3097; val_edge_recon_loss: 25613845.2740; val_gene_expr_recon_loss: 6173782.5685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31821839.2877; val_optim_loss: 31821839.2877
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 34726.7058; train_edge_recon_loss: 25491406.4862; train_gene_expr_recon_loss: 6124268.0130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31650401.1988; train_optim_loss: 31650401.1988; val_kl_reg_loss: 34206.6418; val_edge_recon_loss: 25589725.8356; val_gene_expr_recon_loss: 6171350.6575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31795283.2192; val_optim_loss: 31795283.2192
Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 34738.3512; train_edge_recon_loss: 25493054.6621; train_gene_expr_recon_loss: 6123088.1613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31650881.1713; train_optim_loss: 31650881.1713; val_kl_reg_loss: 34160.4101; val_edge_recon_loss: 25605914.3973; val_gene_expr_recon_loss: 6160078.1336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31800152.8767; val_optim_loss: 31800152.8767
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 34756.1576; train_edge_recon_loss: 25491791.8807; train_gene_expr_recon_loss: 6124778.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31651326.1131; train_optim_loss: 31651326.1131; val_kl_reg_loss: 34195.7634; val_edge_recon_loss: 25605703.7945; val_gene_expr_recon_loss: 6150539.5240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31790439.2192; val_optim_loss: 31790439.2192
Epoch 72/100 |██████████████------| 72.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 34744.2022; train_edge_recon_loss: 25494227.7523; train_gene_expr_recon_loss: 6123883.2385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31652855.1820; train_optim_loss: 31652855.1820; val_kl_reg_loss: 34221.8229; val_edge_recon_loss: 25620487.8904; val_gene_expr_recon_loss: 6166274.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31820984.4384; val_optim_loss: 31820984.4384
Epoch 73/100 |██████████████------| 73.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 34745.7446; train_edge_recon_loss: 25486913.7538; train_gene_expr_recon_loss: 6124481.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31646140.9709; train_optim_loss: 31646140.9709; val_kl_reg_loss: 34210.6148; val_edge_recon_loss: 25615763.8630; val_gene_expr_recon_loss: 6169957.3870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31819931.9452; val_optim_loss: 31819931.9452
Epoch 74/100 |██████████████------| 74.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 34737.7336; train_edge_recon_loss: 25491706.7523; train_gene_expr_recon_loss: 6123353.3654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31649797.8685; train_optim_loss: 31649797.8685; val_kl_reg_loss: 34197.5640; val_edge_recon_loss: 25631057.0000; val_gene_expr_recon_loss: 6169626.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31834880.9178; val_optim_loss: 31834880.9178
Epoch 75/100 |███████████████-----| 75.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 34751.2810; train_edge_recon_loss: 25487776.0138; train_gene_expr_recon_loss: 6122891.9125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31645419.2080; train_optim_loss: 31645419.2080; val_kl_reg_loss: 34206.6879; val_edge_recon_loss: 25608342.2055; val_gene_expr_recon_loss: 6161924.5137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31804473.3562; val_optim_loss: 31804473.3562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 76/100 |███████████████-----| 76.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 34751.4256; train_edge_recon_loss: 25482819.0596; train_gene_expr_recon_loss: 6122033.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31639604.2859; train_optim_loss: 31639604.2859; val_kl_reg_loss: 34215.5154; val_edge_recon_loss: 25611675.5890; val_gene_expr_recon_loss: 6159245.9829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31805137.0548; val_optim_loss: 31805137.0548
Epoch 77/100 |███████████████-----| 77.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 34736.8139; train_edge_recon_loss: 25486049.8502; train_gene_expr_recon_loss: 6123135.2894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31643921.9679; train_optim_loss: 31643921.9679; val_kl_reg_loss: 34176.0691; val_edge_recon_loss: 25604670.5479; val_gene_expr_recon_loss: 6159999.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31798846.2877; val_optim_loss: 31798846.2877
Epoch 78/100 |███████████████-----| 78.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 34757.1265; train_edge_recon_loss: 25482229.0092; train_gene_expr_recon_loss: 6126232.6112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31643218.7462; train_optim_loss: 31643218.7462; val_kl_reg_loss: 34275.4513; val_edge_recon_loss: 25631157.6027; val_gene_expr_recon_loss: 6167651.8253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31833084.9315; val_optim_loss: 31833084.9315
Epoch 79/100 |███████████████-----| 79.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 34754.3574; train_edge_recon_loss: 25483752.5260; train_gene_expr_recon_loss: 6124241.1938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31642748.1070; train_optim_loss: 31642748.1070; val_kl_reg_loss: 34227.1976; val_edge_recon_loss: 25613756.1370; val_gene_expr_recon_loss: 6159412.6130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31807395.8493; val_optim_loss: 31807395.8493

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 414 min 4 sec.
Using best model state, which was in epoch 71.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9956
Val best accuracy score: 0.9787
Val best F1 score: 0.9789
Val gene expr MSE score: 1.4709

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
