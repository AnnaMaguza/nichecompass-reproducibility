None
Run timestamp: 26072023_043056_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 2, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9814; val_auprc_score: 0.9764; val_best_acc_score: 0.9407; val_best_f1_score: 0.9421; train_kl_reg_loss: 21520.2316; train_edge_recon_loss: 26134034.7826; train_gene_expr_recon_loss: 814073.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26969628.2520; train_optim_loss: 26969628.2520; val_kl_reg_loss: 20595.8215; val_edge_recon_loss: 26004253.0103; val_gene_expr_recon_loss: 749773.5853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26774622.3883; val_optim_loss: 26774622.3883
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9880; val_auprc_score: 0.9852; val_best_acc_score: 0.9534; val_best_f1_score: 0.9541; train_kl_reg_loss: 18719.0288; train_edge_recon_loss: 25764871.5435; train_gene_expr_recon_loss: 746919.1123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530509.6834; train_optim_loss: 26530509.6834; val_kl_reg_loss: 18508.0429; val_edge_recon_loss: 25917744.5876; val_gene_expr_recon_loss: 728794.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26665046.8419; val_optim_loss: 26665046.8419
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 18282.8320; train_edge_recon_loss: 25684422.9704; train_gene_expr_recon_loss: 728545.5597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26431251.3676; train_optim_loss: 26431251.3676; val_kl_reg_loss: 18399.2119; val_edge_recon_loss: 25895141.8935; val_gene_expr_recon_loss: 711553.1300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26625094.2646; val_optim_loss: 26625094.2646
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9924; val_auprc_score: 0.9906; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 17947.7208; train_edge_recon_loss: 25643012.5288; train_gene_expr_recon_loss: 716948.3748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26377908.6343; train_optim_loss: 26377908.6343; val_kl_reg_loss: 17019.4985; val_edge_recon_loss: 25822188.6392; val_gene_expr_recon_loss: 704064.7831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26543272.9725; val_optim_loss: 26543272.9725
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 17681.3212; train_edge_recon_loss: 25614437.8968; train_gene_expr_recon_loss: 710953.1512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26343072.3670; train_optim_loss: 26343072.3670; val_kl_reg_loss: 17597.8408; val_edge_recon_loss: 25783514.7766; val_gene_expr_recon_loss: 703348.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26504461.4158; val_optim_loss: 26504461.4158
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 17185.3907; train_edge_recon_loss: 25600175.7136; train_gene_expr_recon_loss: 706210.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26323571.9209; train_optim_loss: 26323571.9209; val_kl_reg_loss: 17087.0886; val_edge_recon_loss: 25738275.5670; val_gene_expr_recon_loss: 699208.8853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26454571.5052; val_optim_loss: 26454571.5052
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 17133.4722; train_edge_recon_loss: 25575214.9092; train_gene_expr_recon_loss: 702324.4506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26294672.8350; train_optim_loss: 26294672.8350; val_kl_reg_loss: 15984.9426; val_edge_recon_loss: 25745277.5086; val_gene_expr_recon_loss: 703549.8994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26464812.3677; val_optim_loss: 26464812.3677
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9690; val_best_f1_score: 0.9694; train_kl_reg_loss: 16963.3805; train_edge_recon_loss: 25559346.7486; train_gene_expr_recon_loss: 701004.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26277314.6813; train_optim_loss: 26277314.6813; val_kl_reg_loss: 17141.5180; val_edge_recon_loss: 25744583.9759; val_gene_expr_recon_loss: 692339.8541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26454065.3986; val_optim_loss: 26454065.3986
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 17039.8851; train_edge_recon_loss: 25546149.0403; train_gene_expr_recon_loss: 698440.3463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26261629.2594; train_optim_loss: 26261629.2594; val_kl_reg_loss: 16538.3292; val_edge_recon_loss: 25693590.9485; val_gene_expr_recon_loss: 688964.5475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26399093.7732; val_optim_loss: 26399093.7732
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 16617.3313; train_edge_recon_loss: 25528682.0948; train_gene_expr_recon_loss: 697024.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26242324.0761; train_optim_loss: 26242324.0761; val_kl_reg_loss: 16111.9641; val_edge_recon_loss: 25688362.3780; val_gene_expr_recon_loss: 694606.2864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26399080.6357; val_optim_loss: 26399080.6357
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 16912.0050; train_edge_recon_loss: 25516218.9264; train_gene_expr_recon_loss: 694506.1963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26227637.1340; train_optim_loss: 26227637.1340; val_kl_reg_loss: 17659.4764; val_edge_recon_loss: 25678523.2199; val_gene_expr_recon_loss: 687988.4260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26384171.1168; val_optim_loss: 26384171.1168
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 16690.2117; train_edge_recon_loss: 25516177.3573; train_gene_expr_recon_loss: 693683.3598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26226550.8935; train_optim_loss: 26226550.8935; val_kl_reg_loss: 16243.4783; val_edge_recon_loss: 25651106.3883; val_gene_expr_recon_loss: 684896.7586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26352246.6323; val_optim_loss: 26352246.6323
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 16592.1379; train_edge_recon_loss: 25509975.3921; train_gene_expr_recon_loss: 691860.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26218428.2107; train_optim_loss: 26218428.2107; val_kl_reg_loss: 15968.8272; val_edge_recon_loss: 25631531.6735; val_gene_expr_recon_loss: 685366.1473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26332866.6460; val_optim_loss: 26332866.6460
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9929; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 16505.5915; train_edge_recon_loss: 25498001.1715; train_gene_expr_recon_loss: 691622.7946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26206129.5569; train_optim_loss: 26206129.5569; val_kl_reg_loss: 15972.6196; val_edge_recon_loss: 25597470.0962; val_gene_expr_recon_loss: 684875.4255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26298318.1237; val_optim_loss: 26298318.1237
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 16553.9981; train_edge_recon_loss: 25483519.4980; train_gene_expr_recon_loss: 690223.2440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26190296.7222; train_optim_loss: 26190296.7222; val_kl_reg_loss: 15692.4480; val_edge_recon_loss: 25631961.7491; val_gene_expr_recon_loss: 685573.6893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26333227.8797; val_optim_loss: 26333227.8797
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9762; val_best_f1_score: 0.9764; train_kl_reg_loss: 16177.9298; train_edge_recon_loss: 25487017.2181; train_gene_expr_recon_loss: 690696.2941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26193891.4353; train_optim_loss: 26193891.4353; val_kl_reg_loss: 16369.7772; val_edge_recon_loss: 25615268.7869; val_gene_expr_recon_loss: 683013.8911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26314652.4605; val_optim_loss: 26314652.4605
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 16129.4175; train_edge_recon_loss: 25477145.8635; train_gene_expr_recon_loss: 691589.2017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26184864.4710; train_optim_loss: 26184864.4710; val_kl_reg_loss: 15549.9747; val_edge_recon_loss: 25585755.9794; val_gene_expr_recon_loss: 683787.1152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26285093.0447; val_optim_loss: 26285093.0447
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 16180.9229; train_edge_recon_loss: 25481796.3131; train_gene_expr_recon_loss: 688370.0595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26186347.3057; train_optim_loss: 26186347.3057; val_kl_reg_loss: 15476.6332; val_edge_recon_loss: 25600464.8522; val_gene_expr_recon_loss: 702504.2596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26318445.7320; val_optim_loss: 26318445.7320
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9774; val_best_f1_score: 0.9776; train_kl_reg_loss: 16068.5687; train_edge_recon_loss: 25466499.7660; train_gene_expr_recon_loss: 688317.1509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26170885.4827; train_optim_loss: 26170885.4827; val_kl_reg_loss: 16023.1840; val_edge_recon_loss: 25572117.2509; val_gene_expr_recon_loss: 680621.1019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26268761.5189; val_optim_loss: 26268761.5189
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9766; val_best_f1_score: 0.9768; train_kl_reg_loss: 16063.8657; train_edge_recon_loss: 25463447.1007; train_gene_expr_recon_loss: 688569.3102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26168080.2520; train_optim_loss: 26168080.2520; val_kl_reg_loss: 15221.5722; val_edge_recon_loss: 25592786.2234; val_gene_expr_recon_loss: 685382.6164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26293390.3814; val_optim_loss: 26293390.3814
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 16125.4852; train_edge_recon_loss: 25460482.4114; train_gene_expr_recon_loss: 686435.2261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163043.1512; train_optim_loss: 26163043.1512; val_kl_reg_loss: 15700.2651; val_edge_recon_loss: 25582463.8935; val_gene_expr_recon_loss: 681667.4186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26279831.5636; val_optim_loss: 26279831.5636
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 15953.4112; train_edge_recon_loss: 25461257.3695; train_gene_expr_recon_loss: 686430.4343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26163641.2028; train_optim_loss: 26163641.2028; val_kl_reg_loss: 16339.4290; val_edge_recon_loss: 25594060.5052; val_gene_expr_recon_loss: 679695.7284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26290095.6460; val_optim_loss: 26290095.6460
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9952; val_auprc_score: 0.9939; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 16117.1010; train_edge_recon_loss: 25454084.3261; train_gene_expr_recon_loss: 686288.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26156490.3670; train_optim_loss: 26156490.3670; val_kl_reg_loss: 15912.4017; val_edge_recon_loss: 25546119.5567; val_gene_expr_recon_loss: 679811.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26241842.9381; val_optim_loss: 26241842.9381
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9778; val_best_f1_score: 0.9780; train_kl_reg_loss: 15965.7512; train_edge_recon_loss: 25441044.0719; train_gene_expr_recon_loss: 686419.3287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26143429.1474; train_optim_loss: 26143429.1474; val_kl_reg_loss: 16293.4100; val_edge_recon_loss: 25538664.4742; val_gene_expr_recon_loss: 762667.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26317625.7182; val_optim_loss: 26317625.7182
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 16017.0470; train_edge_recon_loss: 25441904.0436; train_gene_expr_recon_loss: 685696.0966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26143617.1875; train_optim_loss: 26143617.1875; val_kl_reg_loss: 15646.9097; val_edge_recon_loss: 25554645.5979; val_gene_expr_recon_loss: 679105.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26249398.4158; val_optim_loss: 26249398.4158
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 16034.8074; train_edge_recon_loss: 25435374.8935; train_gene_expr_recon_loss: 685238.4525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26136648.1376; train_optim_loss: 26136648.1376; val_kl_reg_loss: 16252.2291; val_edge_recon_loss: 25551690.3540; val_gene_expr_recon_loss: 679577.2854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26247519.8385; val_optim_loss: 26247519.8385
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 15936.3365; train_edge_recon_loss: 25435848.8905; train_gene_expr_recon_loss: 685477.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26137262.7379; train_optim_loss: 26137262.7379; val_kl_reg_loss: 15766.9529; val_edge_recon_loss: 25548544.7045; val_gene_expr_recon_loss: 679627.8142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26243939.4777; val_optim_loss: 26243939.4777

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 16216.2694; train_edge_recon_loss: 25403808.6320; train_gene_expr_recon_loss: 673850.0838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26093874.9681; train_optim_loss: 26093874.9681; val_kl_reg_loss: 16236.9773; val_edge_recon_loss: 25500776.0859; val_gene_expr_recon_loss: 668419.0358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26185432.1134; val_optim_loss: 26185432.1134
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 16479.6279; train_edge_recon_loss: 25395579.0637; train_gene_expr_recon_loss: 671780.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26083838.9142; train_optim_loss: 26083838.9142; val_kl_reg_loss: 16482.3796; val_edge_recon_loss: 25487018.5876; val_gene_expr_recon_loss: 666528.1179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26170029.0584; val_optim_loss: 26170029.0584
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 16602.0586; train_edge_recon_loss: 25397040.2206; train_gene_expr_recon_loss: 671219.0446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26084861.3030; train_optim_loss: 26084861.3030; val_kl_reg_loss: 16450.0878; val_edge_recon_loss: 25500867.8488; val_gene_expr_recon_loss: 667216.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26184534.2096; val_optim_loss: 26184534.2096
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 16683.1771; train_edge_recon_loss: 25393422.0260; train_gene_expr_recon_loss: 670464.4241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26080569.6165; train_optim_loss: 26080569.6165; val_kl_reg_loss: 16495.6476; val_edge_recon_loss: 25485244.7973; val_gene_expr_recon_loss: 667344.3088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26169084.7698; val_optim_loss: 26169084.7698
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 16620.7588; train_edge_recon_loss: 25397028.3212; train_gene_expr_recon_loss: 670267.3119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26083916.3881; train_optim_loss: 26083916.3881; val_kl_reg_loss: 16323.0040; val_edge_recon_loss: 25493615.2715; val_gene_expr_recon_loss: 665341.1609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26175279.4124; val_optim_loss: 26175279.4124
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 16562.8441; train_edge_recon_loss: 25397213.1619; train_gene_expr_recon_loss: 670516.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26084292.8518; train_optim_loss: 26084292.8518; val_kl_reg_loss: 16374.7382; val_edge_recon_loss: 25485356.7698; val_gene_expr_recon_loss: 665468.7397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26167200.2337; val_optim_loss: 26167200.2337
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 16563.3142; train_edge_recon_loss: 25393396.7219; train_gene_expr_recon_loss: 669852.6486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26079812.6702; train_optim_loss: 26079812.6702; val_kl_reg_loss: 16317.0123; val_edge_recon_loss: 25484561.1271; val_gene_expr_recon_loss: 665433.6702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26166311.7801; val_optim_loss: 26166311.7801
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 16423.1612; train_edge_recon_loss: 25396725.9606; train_gene_expr_recon_loss: 669578.8097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26082727.9438; train_optim_loss: 26082727.9438; val_kl_reg_loss: 16303.2518; val_edge_recon_loss: 25456056.4364; val_gene_expr_recon_loss: 665838.3261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26138198.0309; val_optim_loss: 26138198.0309
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 16537.1862; train_edge_recon_loss: 25389706.7429; train_gene_expr_recon_loss: 669546.1761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26075790.0887; train_optim_loss: 26075790.0887; val_kl_reg_loss: 16236.3093; val_edge_recon_loss: 25474921.6082; val_gene_expr_recon_loss: 665567.8475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26156725.7766; val_optim_loss: 26156725.7766
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 16443.6432; train_edge_recon_loss: 25380098.6003; train_gene_expr_recon_loss: 668978.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26065520.6056; train_optim_loss: 26065520.6056; val_kl_reg_loss: 16393.0237; val_edge_recon_loss: 25453290.8763; val_gene_expr_recon_loss: 664176.6240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26133860.5155; val_optim_loss: 26133860.5155
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 16446.4863; train_edge_recon_loss: 25380008.3009; train_gene_expr_recon_loss: 669152.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26065607.0032; train_optim_loss: 26065607.0032; val_kl_reg_loss: 16265.8445; val_edge_recon_loss: 25473204.6564; val_gene_expr_recon_loss: 665086.8730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26154557.3643; val_optim_loss: 26154557.3643
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9951; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 16421.9423; train_edge_recon_loss: 25387596.5005; train_gene_expr_recon_loss: 668926.0830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26072944.5035; train_optim_loss: 26072944.5035; val_kl_reg_loss: 16317.8077; val_edge_recon_loss: 25473623.8007; val_gene_expr_recon_loss: 664832.6057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26154774.1890; val_optim_loss: 26154774.1890
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 16281.0041; train_edge_recon_loss: 25390537.6861; train_gene_expr_recon_loss: 669101.7455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26075920.4332; train_optim_loss: 26075920.4332; val_kl_reg_loss: 16124.9917; val_edge_recon_loss: 25483546.8935; val_gene_expr_recon_loss: 665425.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26165097.8591; val_optim_loss: 26165097.8591
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 16327.8888; train_edge_recon_loss: 25388403.2403; train_gene_expr_recon_loss: 668787.3522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26073518.4653; train_optim_loss: 26073518.4653; val_kl_reg_loss: 16133.5898; val_edge_recon_loss: 25457604.5601; val_gene_expr_recon_loss: 664477.8433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26138215.9244; val_optim_loss: 26138215.9244

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 16313.0398; train_edge_recon_loss: 25388281.8474; train_gene_expr_recon_loss: 667934.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26072529.8528; train_optim_loss: 26072529.8528; val_kl_reg_loss: 16153.2396; val_edge_recon_loss: 25471413.0412; val_gene_expr_recon_loss: 664109.4915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26151675.8041; val_optim_loss: 26151675.8041
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 16316.2308; train_edge_recon_loss: 25382981.4326; train_gene_expr_recon_loss: 668009.7903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26067307.4498; train_optim_loss: 26067307.4498; val_kl_reg_loss: 16176.0209; val_edge_recon_loss: 25462598.0756; val_gene_expr_recon_loss: 662663.7807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26141437.8729; val_optim_loss: 26141437.8729
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 16331.7525; train_edge_recon_loss: 25383772.5334; train_gene_expr_recon_loss: 667401.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26067506.0933; train_optim_loss: 26067506.0933; val_kl_reg_loss: 16145.7760; val_edge_recon_loss: 25472222.5808; val_gene_expr_recon_loss: 663423.8414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26151792.1340; val_optim_loss: 26151792.1340
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 16333.6107; train_edge_recon_loss: 25379833.9369; train_gene_expr_recon_loss: 667648.5928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26063816.1342; train_optim_loss: 26063816.1342; val_kl_reg_loss: 16190.7642; val_edge_recon_loss: 25486852.1684; val_gene_expr_recon_loss: 663578.1401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26166621.0756; val_optim_loss: 26166621.0756

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 418 min 14 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9948
Val best accuracy score: 0.9813
Val best F1 score: 0.9815
Val gene expr MSE score: 1.6823

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
