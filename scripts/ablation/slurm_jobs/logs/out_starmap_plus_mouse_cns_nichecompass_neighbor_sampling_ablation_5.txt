None
Run timestamp: 19072023_150822_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9755; val_auprc_score: 0.9680; val_best_acc_score: 0.9292; val_best_f1_score: 0.9311; train_kl_reg_loss: 84323.5450; train_edge_recon_loss: 27338285.9185; train_gene_expr_recon_loss: 12281927.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39704537.0652; train_optim_loss: 39704537.0652; val_kl_reg_loss: 96336.5088; val_edge_recon_loss: 26390233.3171; val_gene_expr_recon_loss: 11178662.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37665232.2927; val_optim_loss: 37665232.2927
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9810; val_auprc_score: 0.9734; val_best_acc_score: 0.9444; val_best_f1_score: 0.9459; train_kl_reg_loss: 104967.3682; train_edge_recon_loss: 26134694.4239; train_gene_expr_recon_loss: 10871555.5924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37111217.3913; train_optim_loss: 37111217.3913; val_kl_reg_loss: 106434.1603; val_edge_recon_loss: 26127565.4634; val_gene_expr_recon_loss: 10701134.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36935133.6585; val_optim_loss: 36935133.6585
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9814; val_auprc_score: 0.9745; val_best_acc_score: 0.9448; val_best_f1_score: 0.9461; train_kl_reg_loss: 104165.8761; train_edge_recon_loss: 26016681.8967; train_gene_expr_recon_loss: 10527189.5598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36648037.2174; train_optim_loss: 36648037.2174; val_kl_reg_loss: 99379.7294; val_edge_recon_loss: 26122834.2439; val_gene_expr_recon_loss: 10457942.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36680156.0976; val_optim_loss: 36680156.0976
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9838; val_auprc_score: 0.9785; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 96477.0656; train_edge_recon_loss: 25959471.3750; train_gene_expr_recon_loss: 10298488.0652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36354436.4783; train_optim_loss: 36354436.4783; val_kl_reg_loss: 91422.6839; val_edge_recon_loss: 26070281.4634; val_gene_expr_recon_loss: 10244127.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36405832.0976; val_optim_loss: 36405832.0976
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9851; val_auprc_score: 0.9806; val_best_acc_score: 0.9525; val_best_f1_score: 0.9538; train_kl_reg_loss: 88758.2237; train_edge_recon_loss: 25909792.4457; train_gene_expr_recon_loss: 10137824.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36136374.6957; train_optim_loss: 36136374.6957; val_kl_reg_loss: 84472.4790; val_edge_recon_loss: 26000314.0488; val_gene_expr_recon_loss: 10103382.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36188169.3659; val_optim_loss: 36188169.3659
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9816; val_best_acc_score: 0.9549; val_best_f1_score: 0.9561; train_kl_reg_loss: 83929.8597; train_edge_recon_loss: 25844373.4022; train_gene_expr_recon_loss: 10015811.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35944114.9674; train_optim_loss: 35944114.9674; val_kl_reg_loss: 82129.6025; val_edge_recon_loss: 25893927.5122; val_gene_expr_recon_loss: 10033219.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36009276.9756; val_optim_loss: 36009276.9756
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9871; val_auprc_score: 0.9825; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 81522.7203; train_edge_recon_loss: 25815908.8641; train_gene_expr_recon_loss: 9902236.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35799668.0435; train_optim_loss: 35799668.0435; val_kl_reg_loss: 78750.4718; val_edge_recon_loss: 25889009.4146; val_gene_expr_recon_loss: 9920530.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35888290.0488; val_optim_loss: 35888290.0488
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9870; val_auprc_score: 0.9828; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 79245.1562; train_edge_recon_loss: 25767150.5435; train_gene_expr_recon_loss: 9838429.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35684825.0217; train_optim_loss: 35684825.0217; val_kl_reg_loss: 75952.5131; val_edge_recon_loss: 25893021.3171; val_gene_expr_recon_loss: 9872303.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35841276.8780; val_optim_loss: 35841276.8780
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9875; val_auprc_score: 0.9833; val_best_acc_score: 0.9601; val_best_f1_score: 0.9609; train_kl_reg_loss: 76631.6748; train_edge_recon_loss: 25764511.0924; train_gene_expr_recon_loss: 9761282.8370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35602425.5217; train_optim_loss: 35602425.5217; val_kl_reg_loss: 74702.6736; val_edge_recon_loss: 25835975.1220; val_gene_expr_recon_loss: 9826720.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35737397.8537; val_optim_loss: 35737397.8537
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9875; val_auprc_score: 0.9833; val_best_acc_score: 0.9600; val_best_f1_score: 0.9610; train_kl_reg_loss: 73959.3132; train_edge_recon_loss: 25763638.5272; train_gene_expr_recon_loss: 9698774.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35536372.1522; train_optim_loss: 35536372.1522; val_kl_reg_loss: 71804.0741; val_edge_recon_loss: 25821715.8537; val_gene_expr_recon_loss: 9763916.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35657436.3902; val_optim_loss: 35657436.3902
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9876; val_auprc_score: 0.9835; val_best_acc_score: 0.9611; val_best_f1_score: 0.9621; train_kl_reg_loss: 71778.6072; train_edge_recon_loss: 25710198.4022; train_gene_expr_recon_loss: 9656304.2880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35438281.2717; train_optim_loss: 35438281.2717; val_kl_reg_loss: 69234.6155; val_edge_recon_loss: 25836459.3171; val_gene_expr_recon_loss: 9738999.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35644693.0732; val_optim_loss: 35644693.0732
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9887; val_auprc_score: 0.9851; val_best_acc_score: 0.9625; val_best_f1_score: 0.9633; train_kl_reg_loss: 70252.1141; train_edge_recon_loss: 25713847.1902; train_gene_expr_recon_loss: 9614687.6766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35398787.0000; train_optim_loss: 35398787.0000; val_kl_reg_loss: 68310.9884; val_edge_recon_loss: 25816720.9268; val_gene_expr_recon_loss: 9677335.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35562368.3902; val_optim_loss: 35562368.3902
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9860; val_best_acc_score: 0.9632; val_best_f1_score: 0.9640; train_kl_reg_loss: 69016.4084; train_edge_recon_loss: 25680250.3750; train_gene_expr_recon_loss: 9564623.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35313890.5326; train_optim_loss: 35313890.5326; val_kl_reg_loss: 67671.8211; val_edge_recon_loss: 25794436.7805; val_gene_expr_recon_loss: 9677087.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35539196.1951; val_optim_loss: 35539196.1951
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9860; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 67976.8066; train_edge_recon_loss: 25687679.4511; train_gene_expr_recon_loss: 9536381.7255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35292038.0217; train_optim_loss: 35292038.0217; val_kl_reg_loss: 66021.4250; val_edge_recon_loss: 25757434.2927; val_gene_expr_recon_loss: 9621263.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35444719.1220; val_optim_loss: 35444719.1220
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9887; val_auprc_score: 0.9848; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 66561.4203; train_edge_recon_loss: 25676460.0489; train_gene_expr_recon_loss: 9495103.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35238124.8913; train_optim_loss: 35238124.8913; val_kl_reg_loss: 64439.7654; val_edge_recon_loss: 25811381.1220; val_gene_expr_recon_loss: 9611542.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35487363.6098; val_optim_loss: 35487363.6098
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9893; val_auprc_score: 0.9857; val_best_acc_score: 0.9640; val_best_f1_score: 0.9648; train_kl_reg_loss: 65238.2609; train_edge_recon_loss: 25667852.2989; train_gene_expr_recon_loss: 9471213.7908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35204304.3043; train_optim_loss: 35204304.3043; val_kl_reg_loss: 63864.6760; val_edge_recon_loss: 25764421.8049; val_gene_expr_recon_loss: 9586592.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35414878.8293; val_optim_loss: 35414878.8293
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9899; val_auprc_score: 0.9868; val_best_acc_score: 0.9657; val_best_f1_score: 0.9665; train_kl_reg_loss: 64321.9764; train_edge_recon_loss: 25654659.0217; train_gene_expr_recon_loss: 9442405.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35161386.6739; train_optim_loss: 35161386.6739; val_kl_reg_loss: 64414.1123; val_edge_recon_loss: 25726984.0488; val_gene_expr_recon_loss: 9571605.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35363003.5122; val_optim_loss: 35363003.5122
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 64138.5789; train_edge_recon_loss: 25647519.8913; train_gene_expr_recon_loss: 9405266.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35116924.4783; train_optim_loss: 35116924.4783; val_kl_reg_loss: 63378.4605; val_edge_recon_loss: 25779225.0244; val_gene_expr_recon_loss: 9585353.6098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35427957.3659; val_optim_loss: 35427957.3659
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 63470.3186; train_edge_recon_loss: 25644317.1087; train_gene_expr_recon_loss: 9385161.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35092949.2609; train_optim_loss: 35092949.2609; val_kl_reg_loss: 64142.3740; val_edge_recon_loss: 25696653.4146; val_gene_expr_recon_loss: 9536534.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297330.3415; val_optim_loss: 35297330.3415
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9899; val_auprc_score: 0.9865; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 62610.4393; train_edge_recon_loss: 25650021.0870; train_gene_expr_recon_loss: 9369018.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35081650.4022; train_optim_loss: 35081650.4022; val_kl_reg_loss: 61189.3998; val_edge_recon_loss: 25730617.4146; val_gene_expr_recon_loss: 9554647.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35346454.2439; val_optim_loss: 35346454.2439
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9903; val_auprc_score: 0.9865; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 61965.6076; train_edge_recon_loss: 25636187.8043; train_gene_expr_recon_loss: 9343522.7364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35041676.0652; train_optim_loss: 35041676.0652; val_kl_reg_loss: 60064.9718; val_edge_recon_loss: 25725976.4878; val_gene_expr_recon_loss: 9527940.3415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35313981.8537; val_optim_loss: 35313981.8537
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9912; val_auprc_score: 0.9887; val_best_acc_score: 0.9682; val_best_f1_score: 0.9689; train_kl_reg_loss: 61075.0377; train_edge_recon_loss: 25631295.3370; train_gene_expr_recon_loss: 9325007.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35017378.2935; train_optim_loss: 35017378.2935; val_kl_reg_loss: 59485.5659; val_edge_recon_loss: 25696784.7317; val_gene_expr_recon_loss: 9546164.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302434.7317; val_optim_loss: 35302434.7317
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9907; val_auprc_score: 0.9875; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 61083.9913; train_edge_recon_loss: 25627755.3750; train_gene_expr_recon_loss: 9307974.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34996813.4783; train_optim_loss: 34996813.4783; val_kl_reg_loss: 60216.2643; val_edge_recon_loss: 25716316.1463; val_gene_expr_recon_loss: 9509842.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35286374.9268; val_optim_loss: 35286374.9268
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9907; val_auprc_score: 0.9877; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 60769.2751; train_edge_recon_loss: 25617930.7663; train_gene_expr_recon_loss: 9282578.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34961278.6848; train_optim_loss: 34961278.6848; val_kl_reg_loss: 59364.3214; val_edge_recon_loss: 25730788.6341; val_gene_expr_recon_loss: 9505982.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35296135.9024; val_optim_loss: 35296135.9024
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9910; val_auprc_score: 0.9883; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 60066.4165; train_edge_recon_loss: 25615482.3587; train_gene_expr_recon_loss: 9263502.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34939051.5761; train_optim_loss: 34939051.5761; val_kl_reg_loss: 59756.0604; val_edge_recon_loss: 25712411.3171; val_gene_expr_recon_loss: 9510124.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35282292.4878; val_optim_loss: 35282292.4878
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 59927.7483; train_edge_recon_loss: 25619610.1359; train_gene_expr_recon_loss: 9255234.3587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34934772.2935; train_optim_loss: 34934772.2935; val_kl_reg_loss: 59143.0771; val_edge_recon_loss: 25705887.9512; val_gene_expr_recon_loss: 9500701.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35265732.6829; val_optim_loss: 35265732.6829
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 59455.6432; train_edge_recon_loss: 25605912.4620; train_gene_expr_recon_loss: 9241731.4293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34907099.5435; train_optim_loss: 34907099.5435; val_kl_reg_loss: 58401.3748; val_edge_recon_loss: 25696107.5122; val_gene_expr_recon_loss: 9475566.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35230075.5122; val_optim_loss: 35230075.5122
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9878; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 58949.8349; train_edge_recon_loss: 25604626.6685; train_gene_expr_recon_loss: 9219250.7799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34882827.2283; train_optim_loss: 34882827.2283; val_kl_reg_loss: 58080.5280; val_edge_recon_loss: 25693043.7561; val_gene_expr_recon_loss: 9451877.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35203002.2439; val_optim_loss: 35203002.2439
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9914; val_auprc_score: 0.9886; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 58661.8347; train_edge_recon_loss: 25597583.8913; train_gene_expr_recon_loss: 9203937.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34860183.4348; train_optim_loss: 34860183.4348; val_kl_reg_loss: 57604.9204; val_edge_recon_loss: 25694595.1707; val_gene_expr_recon_loss: 9487237.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35239437.4634; val_optim_loss: 35239437.4634
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9914; val_auprc_score: 0.9884; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 58816.1030; train_edge_recon_loss: 25605003.8967; train_gene_expr_recon_loss: 9195390.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34859210.3696; train_optim_loss: 34859210.3696; val_kl_reg_loss: 57738.6461; val_edge_recon_loss: 25687423.0732; val_gene_expr_recon_loss: 9486447.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231608.7805; val_optim_loss: 35231608.7805
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 56936.6827; train_edge_recon_loss: 25615579.6630; train_gene_expr_recon_loss: 9216330.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34888846.4674; train_optim_loss: 34888846.4674; val_kl_reg_loss: 55945.3209; val_edge_recon_loss: 25728858.0976; val_gene_expr_recon_loss: 9481514.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35266317.5610; val_optim_loss: 35266317.5610
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9913; val_auprc_score: 0.9881; val_best_acc_score: 0.9696; val_best_f1_score: 0.9702; train_kl_reg_loss: 58007.4315; train_edge_recon_loss: 25601939.9511; train_gene_expr_recon_loss: 9173496.6739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34833443.9674; train_optim_loss: 34833443.9674; val_kl_reg_loss: 57537.6137; val_edge_recon_loss: 25679660.0000; val_gene_expr_recon_loss: 9494704.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231902.3415; val_optim_loss: 35231902.3415

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9918; val_auprc_score: 0.9892; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 59528.2460; train_edge_recon_loss: 25584168.8424; train_gene_expr_recon_loss: 9101561.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34745258.0761; train_optim_loss: 34745258.0761; val_kl_reg_loss: 59621.5395; val_edge_recon_loss: 25667570.6829; val_gene_expr_recon_loss: 9427438.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35154630.2439; val_optim_loss: 35154630.2439
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9918; val_auprc_score: 0.9894; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 61039.3534; train_edge_recon_loss: 25575431.7228; train_gene_expr_recon_loss: 9088787.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34725258.5109; train_optim_loss: 34725258.5109; val_kl_reg_loss: 60122.4991; val_edge_recon_loss: 25650992.3415; val_gene_expr_recon_loss: 9422674.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35133789.2683; val_optim_loss: 35133789.2683
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 61771.2427; train_edge_recon_loss: 25569711.0652; train_gene_expr_recon_loss: 9081167.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34712649.9674; train_optim_loss: 34712649.9674; val_kl_reg_loss: 60774.8244; val_edge_recon_loss: 25678271.7561; val_gene_expr_recon_loss: 9402720.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35141767.3171; val_optim_loss: 35141767.3171
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 62208.7211; train_edge_recon_loss: 25564039.3641; train_gene_expr_recon_loss: 9078581.0516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34704829.2174; train_optim_loss: 34704829.2174; val_kl_reg_loss: 61132.4890; val_edge_recon_loss: 25670177.6585; val_gene_expr_recon_loss: 9410243.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35141554.0488; val_optim_loss: 35141554.0488
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 62458.0713; train_edge_recon_loss: 25570081.9728; train_gene_expr_recon_loss: 9073977.1957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34706517.2609; train_optim_loss: 34706517.2609; val_kl_reg_loss: 61561.7676; val_edge_recon_loss: 25645559.2195; val_gene_expr_recon_loss: 9442820.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35149941.6585; val_optim_loss: 35149941.6585
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9920; val_auprc_score: 0.9891; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 62574.7914; train_edge_recon_loss: 25577623.0272; train_gene_expr_recon_loss: 9076309.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34716507.6196; train_optim_loss: 34716507.6196; val_kl_reg_loss: 61445.0389; val_edge_recon_loss: 25647306.5854; val_gene_expr_recon_loss: 9402205.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35110956.8780; val_optim_loss: 35110956.8780
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9916; val_auprc_score: 0.9887; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 62724.2688; train_edge_recon_loss: 25561997.1250; train_gene_expr_recon_loss: 9063288.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34688009.9674; train_optim_loss: 34688009.9674; val_kl_reg_loss: 61770.7532; val_edge_recon_loss: 25698638.2439; val_gene_expr_recon_loss: 9438712.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35199121.2683; val_optim_loss: 35199121.2683
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 62771.0812; train_edge_recon_loss: 25565443.2989; train_gene_expr_recon_loss: 9064588.9130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34692803.3043; train_optim_loss: 34692803.3043; val_kl_reg_loss: 61646.8302; val_edge_recon_loss: 25680306.4878; val_gene_expr_recon_loss: 9400358.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35142312.0000; val_optim_loss: 35142312.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 62759.1639; train_edge_recon_loss: 25573150.7228; train_gene_expr_recon_loss: 9062214.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34698124.5000; train_optim_loss: 34698124.5000; val_kl_reg_loss: 61925.7343; val_edge_recon_loss: 25692406.9756; val_gene_expr_recon_loss: 9417944.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35172276.9756; val_optim_loss: 35172276.9756
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 63012.4401; train_edge_recon_loss: 25584477.8804; train_gene_expr_recon_loss: 9057055.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34704545.7500; train_optim_loss: 34704545.7500; val_kl_reg_loss: 61859.1200; val_edge_recon_loss: 25645543.4146; val_gene_expr_recon_loss: 9405007.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35112409.7561; val_optim_loss: 35112409.7561

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9701; val_best_f1_score: 0.9707; train_kl_reg_loss: 62947.8971; train_edge_recon_loss: 25579311.8370; train_gene_expr_recon_loss: 9059074.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34701334.5326; train_optim_loss: 34701334.5326; val_kl_reg_loss: 61694.8511; val_edge_recon_loss: 25691169.8049; val_gene_expr_recon_loss: 9401774.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35154639.5122; val_optim_loss: 35154639.5122
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9920; val_auprc_score: 0.9896; val_best_acc_score: 0.9709; val_best_f1_score: 0.9715; train_kl_reg_loss: 62966.5763; train_edge_recon_loss: 25568512.0489; train_gene_expr_recon_loss: 9046615.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34678093.7283; train_optim_loss: 34678093.7283; val_kl_reg_loss: 61996.6956; val_edge_recon_loss: 25653088.9268; val_gene_expr_recon_loss: 9415946.9024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35131032.7805; val_optim_loss: 35131032.7805
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9920; val_auprc_score: 0.9897; val_best_acc_score: 0.9700; val_best_f1_score: 0.9706; train_kl_reg_loss: 63035.3725; train_edge_recon_loss: 25568598.3207; train_gene_expr_recon_loss: 9042251.2052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34673884.9348; train_optim_loss: 34673884.9348; val_kl_reg_loss: 61926.0853; val_edge_recon_loss: 25693781.7561; val_gene_expr_recon_loss: 9403002.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35158710.3415; val_optim_loss: 35158710.3415
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 63089.0547; train_edge_recon_loss: 25576248.2337; train_gene_expr_recon_loss: 9057957.3098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34697294.5761; train_optim_loss: 34697294.5761; val_kl_reg_loss: 62032.6026; val_edge_recon_loss: 25681658.0000; val_gene_expr_recon_loss: 9416086.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35159776.5854; val_optim_loss: 35159776.5854

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 113 min 44 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9920
Val AUPRC score: 0.9895
Val best accuracy score: 0.9706
Val best F1 score: 0.9710
Val gene expr MSE score: 0.6932

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
