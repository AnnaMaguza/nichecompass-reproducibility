None
Run timestamp: 12072023_130422_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9893; val_auprc_score: 0.9861; val_best_acc_score: 0.9593; val_best_f1_score: 0.9602; train_kl_reg_loss: 7597.1737; train_edge_recon_loss: 265112.9647; train_gene_expr_recon_loss: 120534.7712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393244.9099; train_optim_loss: 393244.9099; val_kl_reg_loss: 7174.9120; val_edge_recon_loss: 260411.8381; val_gene_expr_recon_loss: 109616.0854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377202.8347; val_optim_loss: 377202.8347
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 7085.3468; train_edge_recon_loss: 260422.9121; train_gene_expr_recon_loss: 107306.2189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374814.4782; train_optim_loss: 374814.4782; val_kl_reg_loss: 6794.3438; val_edge_recon_loss: 259037.8917; val_gene_expr_recon_loss: 104245.6566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370077.8928; val_optim_loss: 370077.8928
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 6847.6971; train_edge_recon_loss: 259461.8921; train_gene_expr_recon_loss: 103359.2689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369668.8581; train_optim_loss: 369668.8581; val_kl_reg_loss: 6664.1299; val_edge_recon_loss: 258597.7692; val_gene_expr_recon_loss: 101266.0946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366527.9931; val_optim_loss: 366527.9931
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 6683.7657; train_edge_recon_loss: 258983.9530; train_gene_expr_recon_loss: 101276.5169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366944.2362; train_optim_loss: 366944.2362; val_kl_reg_loss: 6595.4032; val_edge_recon_loss: 257969.4758; val_gene_expr_recon_loss: 100156.0773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364720.9537; val_optim_loss: 364720.9537
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 6577.7749; train_edge_recon_loss: 258560.3330; train_gene_expr_recon_loss: 99916.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365054.7762; train_optim_loss: 365054.7762; val_kl_reg_loss: 6565.7721; val_edge_recon_loss: 257551.3037; val_gene_expr_recon_loss: 99086.9573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363204.0331; val_optim_loss: 363204.0331
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 6503.8824; train_edge_recon_loss: 258160.4653; train_gene_expr_recon_loss: 99063.0627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363727.4103; train_optim_loss: 363727.4103; val_kl_reg_loss: 6479.5017; val_edge_recon_loss: 257601.2222; val_gene_expr_recon_loss: 98384.9220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362465.6434; val_optim_loss: 362465.6434
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 6451.7601; train_edge_recon_loss: 257910.8226; train_gene_expr_recon_loss: 98421.7199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362784.3027; train_optim_loss: 362784.3027; val_kl_reg_loss: 6252.3222; val_edge_recon_loss: 257017.3552; val_gene_expr_recon_loss: 97826.5343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361096.2103; val_optim_loss: 361096.2103
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 6419.0266; train_edge_recon_loss: 257705.0233; train_gene_expr_recon_loss: 98044.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362168.6444; train_optim_loss: 362168.6444; val_kl_reg_loss: 6403.1958; val_edge_recon_loss: 257185.7873; val_gene_expr_recon_loss: 97648.7555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361237.7375; val_optim_loss: 361237.7375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 6388.7628; train_edge_recon_loss: 257475.9672; train_gene_expr_recon_loss: 97529.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361394.0818; train_optim_loss: 361394.0818; val_kl_reg_loss: 6324.2672; val_edge_recon_loss: 256773.6847; val_gene_expr_recon_loss: 97175.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360273.7775; val_optim_loss: 360273.7775
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 6376.4755; train_edge_recon_loss: 257262.4522; train_gene_expr_recon_loss: 97238.0567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360876.9847; train_optim_loss: 360876.9847; val_kl_reg_loss: 6276.5547; val_edge_recon_loss: 256612.7339; val_gene_expr_recon_loss: 96843.0817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359732.3700; val_optim_loss: 359732.3700
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 6363.6693; train_edge_recon_loss: 257128.6740; train_gene_expr_recon_loss: 97096.3602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360588.7041; train_optim_loss: 360588.7041; val_kl_reg_loss: 6421.5061; val_edge_recon_loss: 256605.4814; val_gene_expr_recon_loss: 97130.0408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360157.0262; val_optim_loss: 360157.0262
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6349.0862; train_edge_recon_loss: 256967.3683; train_gene_expr_recon_loss: 96771.1640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360087.6185; train_optim_loss: 360087.6185; val_kl_reg_loss: 6412.1154; val_edge_recon_loss: 256317.1248; val_gene_expr_recon_loss: 96642.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359372.1241; val_optim_loss: 359372.1241
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6347.7562; train_edge_recon_loss: 256905.5750; train_gene_expr_recon_loss: 96629.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359882.9259; train_optim_loss: 359882.9259; val_kl_reg_loss: 6313.2672; val_edge_recon_loss: 256007.8530; val_gene_expr_recon_loss: 96699.5958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359020.7159; val_optim_loss: 359020.7159
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 6341.5809; train_edge_recon_loss: 256763.3922; train_gene_expr_recon_loss: 96418.1825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359523.1559; train_optim_loss: 359523.1559; val_kl_reg_loss: 6378.7183; val_edge_recon_loss: 256181.7897; val_gene_expr_recon_loss: 96513.2132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359073.7197; val_optim_loss: 359073.7197
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6340.3096; train_edge_recon_loss: 256708.6407; train_gene_expr_recon_loss: 96251.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359300.3290; train_optim_loss: 359300.3290; val_kl_reg_loss: 6296.0442; val_edge_recon_loss: 256042.2520; val_gene_expr_recon_loss: 96259.9183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358598.2112; val_optim_loss: 358598.2112
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6340.7344; train_edge_recon_loss: 256645.1582; train_gene_expr_recon_loss: 96051.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359037.8409; train_optim_loss: 359037.8409; val_kl_reg_loss: 6401.2443; val_edge_recon_loss: 255992.9989; val_gene_expr_recon_loss: 95884.6498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358278.8947; val_optim_loss: 358278.8947
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6338.7743; train_edge_recon_loss: 256565.8989; train_gene_expr_recon_loss: 95941.7960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358846.4696; train_optim_loss: 358846.4696; val_kl_reg_loss: 6282.1821; val_edge_recon_loss: 255990.0591; val_gene_expr_recon_loss: 96145.2677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358417.5072; val_optim_loss: 358417.5072
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6338.4647; train_edge_recon_loss: 256526.4183; train_gene_expr_recon_loss: 95872.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358737.5186; train_optim_loss: 358737.5186; val_kl_reg_loss: 6312.9889; val_edge_recon_loss: 255819.7122; val_gene_expr_recon_loss: 96040.3366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358173.0388; val_optim_loss: 358173.0388
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6339.8143; train_edge_recon_loss: 256451.8062; train_gene_expr_recon_loss: 95771.6812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358563.3012; train_optim_loss: 358563.3012; val_kl_reg_loss: 6374.3744; val_edge_recon_loss: 255715.7048; val_gene_expr_recon_loss: 96250.0412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358340.1206; val_optim_loss: 358340.1206
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6343.3207; train_edge_recon_loss: 256384.9502; train_gene_expr_recon_loss: 95640.9299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358369.2010; train_optim_loss: 358369.2010; val_kl_reg_loss: 6269.3751; val_edge_recon_loss: 255630.1950; val_gene_expr_recon_loss: 95730.7435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357630.3125; val_optim_loss: 357630.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6343.4307; train_edge_recon_loss: 256377.7276; train_gene_expr_recon_loss: 95590.9611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358312.1199; train_optim_loss: 358312.1199; val_kl_reg_loss: 6264.7112; val_edge_recon_loss: 255591.4450; val_gene_expr_recon_loss: 96126.0044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357982.1594; val_optim_loss: 357982.1594
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6342.6830; train_edge_recon_loss: 256286.4888; train_gene_expr_recon_loss: 95450.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358080.0503; train_optim_loss: 358080.0503; val_kl_reg_loss: 6356.7807; val_edge_recon_loss: 255777.8853; val_gene_expr_recon_loss: 95546.8057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357681.4731; val_optim_loss: 357681.4731
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9969; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6346.0171; train_edge_recon_loss: 256261.1467; train_gene_expr_recon_loss: 95366.5245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357973.6882; train_optim_loss: 357973.6882; val_kl_reg_loss: 6409.8414; val_edge_recon_loss: 255793.1239; val_gene_expr_recon_loss: 95675.0668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357878.0325; val_optim_loss: 357878.0325
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6346.0999; train_edge_recon_loss: 256253.8450; train_gene_expr_recon_loss: 95312.5223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357912.4669; train_optim_loss: 357912.4669; val_kl_reg_loss: 6356.9976; val_edge_recon_loss: 255448.8803; val_gene_expr_recon_loss: 95536.4589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357342.3362; val_optim_loss: 357342.3362
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6347.7785; train_edge_recon_loss: 256168.5627; train_gene_expr_recon_loss: 95222.1058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357738.4468; train_optim_loss: 357738.4468; val_kl_reg_loss: 6293.2671; val_edge_recon_loss: 255324.9572; val_gene_expr_recon_loss: 95845.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357463.6184; val_optim_loss: 357463.6184
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6350.1242; train_edge_recon_loss: 256150.7181; train_gene_expr_recon_loss: 95110.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357611.8398; train_optim_loss: 357611.8398; val_kl_reg_loss: 6310.0324; val_edge_recon_loss: 255600.3700; val_gene_expr_recon_loss: 95420.1086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357330.5084; val_optim_loss: 357330.5084
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6348.2924; train_edge_recon_loss: 256112.7372; train_gene_expr_recon_loss: 95080.9151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357541.9447; train_optim_loss: 357541.9447; val_kl_reg_loss: 6227.9369; val_edge_recon_loss: 255403.7602; val_gene_expr_recon_loss: 95544.8262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357176.5241; val_optim_loss: 357176.5241
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 6347.0175; train_edge_recon_loss: 256115.5365; train_gene_expr_recon_loss: 95099.0178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357561.5721; train_optim_loss: 357561.5721; val_kl_reg_loss: 6251.9050; val_edge_recon_loss: 255489.7931; val_gene_expr_recon_loss: 95800.4784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357542.1788; val_optim_loss: 357542.1788
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 6354.2866; train_edge_recon_loss: 256034.5356; train_gene_expr_recon_loss: 95027.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357416.6650; train_optim_loss: 357416.6650; val_kl_reg_loss: 6328.0494; val_edge_recon_loss: 255283.3686; val_gene_expr_recon_loss: 95732.9860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357344.4056; val_optim_loss: 357344.4056
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6354.4557; train_edge_recon_loss: 256000.6085; train_gene_expr_recon_loss: 94946.3679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357301.4323; train_optim_loss: 357301.4323; val_kl_reg_loss: 6312.5540; val_edge_recon_loss: 255347.0108; val_gene_expr_recon_loss: 95569.2291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357228.7934; val_optim_loss: 357228.7934
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6355.7332; train_edge_recon_loss: 255899.1514; train_gene_expr_recon_loss: 94914.2624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357169.1473; train_optim_loss: 357169.1473; val_kl_reg_loss: 6405.4750; val_edge_recon_loss: 255482.2986; val_gene_expr_recon_loss: 95442.8640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357330.6366; val_optim_loss: 357330.6366

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 6356.8575; train_edge_recon_loss: 255885.1460; train_gene_expr_recon_loss: 94290.3880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356532.3909; train_optim_loss: 356532.3909; val_kl_reg_loss: 6349.1544; val_edge_recon_loss: 255295.8870; val_gene_expr_recon_loss: 95021.0459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356666.0875; val_optim_loss: 356666.0875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 6351.6964; train_edge_recon_loss: 255840.1951; train_gene_expr_recon_loss: 94106.2952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356298.1863; train_optim_loss: 356298.1863; val_kl_reg_loss: 6327.3134; val_edge_recon_loss: 255163.1837; val_gene_expr_recon_loss: 95090.7627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356581.2616; val_optim_loss: 356581.2616
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6349.6342; train_edge_recon_loss: 255817.5901; train_gene_expr_recon_loss: 94105.3121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356272.5360; train_optim_loss: 356272.5360; val_kl_reg_loss: 6320.7110; val_edge_recon_loss: 255245.5580; val_gene_expr_recon_loss: 94738.3843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356304.6544; val_optim_loss: 356304.6544
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 6348.6966; train_edge_recon_loss: 255836.0530; train_gene_expr_recon_loss: 94032.4443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356217.1933; train_optim_loss: 356217.1933; val_kl_reg_loss: 6329.4406; val_edge_recon_loss: 255089.3877; val_gene_expr_recon_loss: 94855.1128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356273.9419; val_optim_loss: 356273.9419
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9893; val_best_f1_score: 0.9893; train_kl_reg_loss: 6349.3498; train_edge_recon_loss: 255877.8245; train_gene_expr_recon_loss: 93998.3967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356225.5713; train_optim_loss: 356225.5713; val_kl_reg_loss: 6327.8489; val_edge_recon_loss: 255183.4666; val_gene_expr_recon_loss: 94617.5712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356128.8875; val_optim_loss: 356128.8875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6346.2797; train_edge_recon_loss: 255846.3951; train_gene_expr_recon_loss: 94014.4117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356207.0867; train_optim_loss: 356207.0867; val_kl_reg_loss: 6310.6013; val_edge_recon_loss: 255083.7972; val_gene_expr_recon_loss: 94628.1592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356022.5572; val_optim_loss: 356022.5572
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6347.7771; train_edge_recon_loss: 255763.8373; train_gene_expr_recon_loss: 93900.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356011.8341; train_optim_loss: 356011.8341; val_kl_reg_loss: 6322.7410; val_edge_recon_loss: 255149.6869; val_gene_expr_recon_loss: 94672.9584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356145.3875; val_optim_loss: 356145.3875
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 6347.8975; train_edge_recon_loss: 255813.2413; train_gene_expr_recon_loss: 93914.3240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356075.4626; train_optim_loss: 356075.4626; val_kl_reg_loss: 6313.9632; val_edge_recon_loss: 255061.9989; val_gene_expr_recon_loss: 94877.4445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356253.4072; val_optim_loss: 356253.4072
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 6347.2756; train_edge_recon_loss: 255788.5922; train_gene_expr_recon_loss: 93833.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355968.9409; train_optim_loss: 355968.9409; val_kl_reg_loss: 6358.6142; val_edge_recon_loss: 255074.4556; val_gene_expr_recon_loss: 94665.1816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356098.2503; val_optim_loss: 356098.2503
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6347.9259; train_edge_recon_loss: 255809.8562; train_gene_expr_recon_loss: 93872.0622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356029.8435; train_optim_loss: 356029.8435; val_kl_reg_loss: 6313.4614; val_edge_recon_loss: 255227.7695; val_gene_expr_recon_loss: 94811.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356353.2275; val_optim_loss: 356353.2275

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 6346.5904; train_edge_recon_loss: 255787.1749; train_gene_expr_recon_loss: 93762.3384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355896.1036; train_optim_loss: 355896.1036; val_kl_reg_loss: 6331.8497; val_edge_recon_loss: 255033.4297; val_gene_expr_recon_loss: 94384.6263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355749.9066; val_optim_loss: 355749.9066
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6349.8338; train_edge_recon_loss: 255773.7599; train_gene_expr_recon_loss: 93776.4597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355900.0532; train_optim_loss: 355900.0532; val_kl_reg_loss: 6326.6749; val_edge_recon_loss: 255021.2734; val_gene_expr_recon_loss: 94598.5995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355946.5484; val_optim_loss: 355946.5484
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6346.3828; train_edge_recon_loss: 255792.0728; train_gene_expr_recon_loss: 93730.2911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355868.7465; train_optim_loss: 355868.7465; val_kl_reg_loss: 6333.0053; val_edge_recon_loss: 255189.5097; val_gene_expr_recon_loss: 94511.3052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356033.8200; val_optim_loss: 356033.8200
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6347.5321; train_edge_recon_loss: 255789.0790; train_gene_expr_recon_loss: 93874.5073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356011.1191; train_optim_loss: 356011.1191; val_kl_reg_loss: 6321.6329; val_edge_recon_loss: 255069.8445; val_gene_expr_recon_loss: 94454.9523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355846.4300; val_optim_loss: 355846.4300
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9896; val_best_f1_score: 0.9896; train_kl_reg_loss: 6347.1428; train_edge_recon_loss: 255813.0088; train_gene_expr_recon_loss: 93784.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355944.3307; train_optim_loss: 355944.3307; val_kl_reg_loss: 6328.4810; val_edge_recon_loss: 254924.6898; val_gene_expr_recon_loss: 94513.8173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355766.9894; val_optim_loss: 355766.9894

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 6346.0981; train_edge_recon_loss: 255750.5249; train_gene_expr_recon_loss: 93732.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355829.4598; train_optim_loss: 355829.4598; val_kl_reg_loss: 6331.2273; val_edge_recon_loss: 255310.2331; val_gene_expr_recon_loss: 94554.0652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356195.5247; val_optim_loss: 356195.5247
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9893; val_best_f1_score: 0.9893; train_kl_reg_loss: 6345.7942; train_edge_recon_loss: 255828.3457; train_gene_expr_recon_loss: 93714.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355889.0930; train_optim_loss: 355889.0930; val_kl_reg_loss: 6327.0095; val_edge_recon_loss: 255039.5400; val_gene_expr_recon_loss: 94534.8768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355901.4266; val_optim_loss: 355901.4266
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 6346.5809; train_edge_recon_loss: 255745.7406; train_gene_expr_recon_loss: 93771.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355864.0234; train_optim_loss: 355864.0234; val_kl_reg_loss: 6334.1589; val_edge_recon_loss: 255251.1341; val_gene_expr_recon_loss: 94671.2755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356256.5694; val_optim_loss: 356256.5694
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9897; val_best_f1_score: 0.9897; train_kl_reg_loss: 6344.8779; train_edge_recon_loss: 255763.2582; train_gene_expr_recon_loss: 93751.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355859.9335; train_optim_loss: 355859.9335; val_kl_reg_loss: 6325.8096; val_edge_recon_loss: 254909.4669; val_gene_expr_recon_loss: 94812.5689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356047.8447; val_optim_loss: 356047.8447

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 392 min 54 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9980
Val best accuracy score: 0.9892
Val best F1 score: 0.9892
Val gene expr MSE score: 0.6236

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
