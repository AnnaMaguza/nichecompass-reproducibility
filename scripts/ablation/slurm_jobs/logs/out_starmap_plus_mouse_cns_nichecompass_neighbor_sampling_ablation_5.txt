None
Run timestamp: 24072023_201313_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9731; val_auprc_score: 0.9659; val_best_acc_score: 0.9237; val_best_f1_score: 0.9266; train_kl_reg_loss: 93378.5779; train_edge_recon_loss: 27429465.2609; train_gene_expr_recon_loss: 12242017.3152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39764861.0870; train_optim_loss: 39764861.0870; val_kl_reg_loss: 106775.3409; val_edge_recon_loss: 26445648.7317; val_gene_expr_recon_loss: 11045377.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37597801.0732; val_optim_loss: 37597801.0732
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9800; val_auprc_score: 0.9731; val_best_acc_score: 0.9425; val_best_f1_score: 0.9443; train_kl_reg_loss: 116637.6439; train_edge_recon_loss: 26153801.7120; train_gene_expr_recon_loss: 10795076.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37065516.0217; train_optim_loss: 37065516.0217; val_kl_reg_loss: 114864.6991; val_edge_recon_loss: 26161897.6585; val_gene_expr_recon_loss: 10538515.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36815278.4390; val_optim_loss: 36815278.4390
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9819; val_auprc_score: 0.9759; val_best_acc_score: 0.9451; val_best_f1_score: 0.9464; train_kl_reg_loss: 113806.9143; train_edge_recon_loss: 26022123.7609; train_gene_expr_recon_loss: 10438481.3995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36574412.0435; train_optim_loss: 36574412.0435; val_kl_reg_loss: 107535.0711; val_edge_recon_loss: 26006962.4390; val_gene_expr_recon_loss: 10307158.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36421656.0976; val_optim_loss: 36421656.0976
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9832; val_auprc_score: 0.9780; val_best_acc_score: 0.9465; val_best_f1_score: 0.9480; train_kl_reg_loss: 105180.4230; train_edge_recon_loss: 25947258.3859; train_gene_expr_recon_loss: 10219835.7527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36272274.4891; train_optim_loss: 36272274.4891; val_kl_reg_loss: 97664.7599; val_edge_recon_loss: 26056392.3902; val_gene_expr_recon_loss: 10133887.3171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36287944.3902; val_optim_loss: 36287944.3902
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9848; val_auprc_score: 0.9796; val_best_acc_score: 0.9523; val_best_f1_score: 0.9535; train_kl_reg_loss: 95469.9961; train_edge_recon_loss: 25919185.1630; train_gene_expr_recon_loss: 10084476.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36099131.6304; train_optim_loss: 36099131.6304; val_kl_reg_loss: 91238.7824; val_edge_recon_loss: 25977670.9268; val_gene_expr_recon_loss: 10052994.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36121904.1951; val_optim_loss: 36121904.1951
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9857; val_auprc_score: 0.9809; val_best_acc_score: 0.9543; val_best_f1_score: 0.9555; train_kl_reg_loss: 89232.1742; train_edge_recon_loss: 25870315.8750; train_gene_expr_recon_loss: 9979283.1658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35938831.2935; train_optim_loss: 35938831.2935; val_kl_reg_loss: 84631.1271; val_edge_recon_loss: 25921080.9756; val_gene_expr_recon_loss: 9964211.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35969924.0976; val_optim_loss: 35969924.0976
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9870; val_auprc_score: 0.9828; val_best_acc_score: 0.9583; val_best_f1_score: 0.9593; train_kl_reg_loss: 85063.9117; train_edge_recon_loss: 25814154.0109; train_gene_expr_recon_loss: 9891323.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35790541.8696; train_optim_loss: 35790541.8696; val_kl_reg_loss: 81309.2866; val_edge_recon_loss: 25853520.7805; val_gene_expr_recon_loss: 9885450.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35820280.5854; val_optim_loss: 35820280.5854
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9873; val_auprc_score: 0.9830; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 82693.8373; train_edge_recon_loss: 25769616.7500; train_gene_expr_recon_loss: 9806732.4620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35659042.9239; train_optim_loss: 35659042.9239; val_kl_reg_loss: 79256.2736; val_edge_recon_loss: 25812000.3415; val_gene_expr_recon_loss: 9786944.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35678201.1707; val_optim_loss: 35678201.1707
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9875; val_auprc_score: 0.9834; val_best_acc_score: 0.9603; val_best_f1_score: 0.9613; train_kl_reg_loss: 78385.9707; train_edge_recon_loss: 25749524.5978; train_gene_expr_recon_loss: 9750108.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35578018.7826; train_optim_loss: 35578018.7826; val_kl_reg_loss: 75275.4103; val_edge_recon_loss: 25825782.4878; val_gene_expr_recon_loss: 9751572.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35652630.5366; val_optim_loss: 35652630.5366
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9877; val_auprc_score: 0.9838; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 77532.8081; train_edge_recon_loss: 25732728.7554; train_gene_expr_recon_loss: 9689111.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35499373.0326; train_optim_loss: 35499373.0326; val_kl_reg_loss: 74866.5800; val_edge_recon_loss: 25812892.9268; val_gene_expr_recon_loss: 9697672.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35585431.7073; val_optim_loss: 35585431.7073
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9883; val_auprc_score: 0.9847; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 74672.0099; train_edge_recon_loss: 25725942.8098; train_gene_expr_recon_loss: 9640992.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35441607.4239; train_optim_loss: 35441607.4239; val_kl_reg_loss: 72437.6926; val_edge_recon_loss: 25795036.0488; val_gene_expr_recon_loss: 9669909.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35537383.3171; val_optim_loss: 35537383.3171
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9882; val_auprc_score: 0.9843; val_best_acc_score: 0.9617; val_best_f1_score: 0.9625; train_kl_reg_loss: 73488.3606; train_edge_recon_loss: 25697334.2120; train_gene_expr_recon_loss: 9603356.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35374179.0217; train_optim_loss: 35374179.0217; val_kl_reg_loss: 71183.3956; val_edge_recon_loss: 25809269.5122; val_gene_expr_recon_loss: 9637137.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35517590.1463; val_optim_loss: 35517590.1463
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9840; val_best_acc_score: 0.9623; val_best_f1_score: 0.9632; train_kl_reg_loss: 70944.0994; train_edge_recon_loss: 25691499.0217; train_gene_expr_recon_loss: 9569255.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35331698.7065; train_optim_loss: 35331698.7065; val_kl_reg_loss: 67717.7737; val_edge_recon_loss: 25800452.4390; val_gene_expr_recon_loss: 9636387.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35504558.0488; val_optim_loss: 35504558.0488
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9891; val_auprc_score: 0.9860; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 69344.4262; train_edge_recon_loss: 25680336.0489; train_gene_expr_recon_loss: 9533228.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35282909.3152; train_optim_loss: 35282909.3152; val_kl_reg_loss: 65757.3592; val_edge_recon_loss: 25805570.0976; val_gene_expr_recon_loss: 9594535.7805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35465863.1220; val_optim_loss: 35465863.1220
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9889; val_auprc_score: 0.9854; val_best_acc_score: 0.9636; val_best_f1_score: 0.9643; train_kl_reg_loss: 68693.2770; train_edge_recon_loss: 25673559.7065; train_gene_expr_recon_loss: 9492487.9185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35234741.0435; train_optim_loss: 35234741.0435; val_kl_reg_loss: 65759.7894; val_edge_recon_loss: 25788402.8293; val_gene_expr_recon_loss: 9594982.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35449145.4634; val_optim_loss: 35449145.4634
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9872; val_auprc_score: 0.9821; val_best_acc_score: 0.9626; val_best_f1_score: 0.9636; train_kl_reg_loss: 67392.7897; train_edge_recon_loss: 25706062.2554; train_gene_expr_recon_loss: 9493345.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35266800.6196; train_optim_loss: 35266800.6196; val_kl_reg_loss: 69225.0673; val_edge_recon_loss: 25819125.7561; val_gene_expr_recon_loss: 9692430.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35580781.2683; val_optim_loss: 35580781.2683
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9894; val_auprc_score: 0.9860; val_best_acc_score: 0.9650; val_best_f1_score: 0.9656; train_kl_reg_loss: 67242.7025; train_edge_recon_loss: 25670842.5543; train_gene_expr_recon_loss: 9473626.7283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35211711.9674; train_optim_loss: 35211711.9674; val_kl_reg_loss: 64647.7358; val_edge_recon_loss: 25750795.4634; val_gene_expr_recon_loss: 9562361.2195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35377804.2927; val_optim_loss: 35377804.2927
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9894; val_auprc_score: 0.9855; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 65817.2323; train_edge_recon_loss: 25644471.4457; train_gene_expr_recon_loss: 9430927.8315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35141216.4674; train_optim_loss: 35141216.4674; val_kl_reg_loss: 63742.3790; val_edge_recon_loss: 25740138.2439; val_gene_expr_recon_loss: 9560856.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35364736.9756; val_optim_loss: 35364736.9756
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9895; val_auprc_score: 0.9860; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 64638.2418; train_edge_recon_loss: 25651783.7717; train_gene_expr_recon_loss: 9393245.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35109667.5543; train_optim_loss: 35109667.5543; val_kl_reg_loss: 63257.3109; val_edge_recon_loss: 25727208.5366; val_gene_expr_recon_loss: 9549226.8293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35339692.6829; val_optim_loss: 35339692.6829
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9899; val_auprc_score: 0.9868; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 63934.0076; train_edge_recon_loss: 25633800.8967; train_gene_expr_recon_loss: 9372957.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35070692.3804; train_optim_loss: 35070692.3804; val_kl_reg_loss: 61111.5817; val_edge_recon_loss: 25716238.7317; val_gene_expr_recon_loss: 9531463.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35308814.0488; val_optim_loss: 35308814.0488
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9900; val_auprc_score: 0.9868; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 63539.3162; train_edge_recon_loss: 25625688.6087; train_gene_expr_recon_loss: 9362691.3370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35051919.3152; train_optim_loss: 35051919.3152; val_kl_reg_loss: 61242.3345; val_edge_recon_loss: 25734456.4878; val_gene_expr_recon_loss: 9519982.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35315681.2683; val_optim_loss: 35315681.2683
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9664; val_best_f1_score: 0.9671; train_kl_reg_loss: 62246.4613; train_edge_recon_loss: 25640975.1033; train_gene_expr_recon_loss: 9346580.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35049802.5870; train_optim_loss: 35049802.5870; val_kl_reg_loss: 61234.1670; val_edge_recon_loss: 25738457.7561; val_gene_expr_recon_loss: 9522580.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35322272.2927; val_optim_loss: 35322272.2927
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9901; val_auprc_score: 0.9870; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 62122.2922; train_edge_recon_loss: 25633902.6522; train_gene_expr_recon_loss: 9322066.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018091.2826; train_optim_loss: 35018091.2826; val_kl_reg_loss: 60584.8138; val_edge_recon_loss: 25718896.0000; val_gene_expr_recon_loss: 9499522.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35279003.5122; val_optim_loss: 35279003.5122
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9911; val_auprc_score: 0.9883; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 61289.4922; train_edge_recon_loss: 25612285.5978; train_gene_expr_recon_loss: 9310014.2473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34983589.2609; train_optim_loss: 34983589.2609; val_kl_reg_loss: 59165.8465; val_edge_recon_loss: 25707931.6098; val_gene_expr_recon_loss: 9492076.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35259174.2439; val_optim_loss: 35259174.2439
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9906; val_auprc_score: 0.9875; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 60785.8078; train_edge_recon_loss: 25625864.1685; train_gene_expr_recon_loss: 9290027.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34976677.8913; train_optim_loss: 34976677.8913; val_kl_reg_loss: 59820.9011; val_edge_recon_loss: 25705430.7317; val_gene_expr_recon_loss: 9466092.2927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35231343.6098; val_optim_loss: 35231343.6098
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9908; val_auprc_score: 0.9881; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 60270.9940; train_edge_recon_loss: 25612273.1793; train_gene_expr_recon_loss: 9277791.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34950335.8043; train_optim_loss: 34950335.8043; val_kl_reg_loss: 58809.6953; val_edge_recon_loss: 25692632.2927; val_gene_expr_recon_loss: 9455059.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35206501.8537; val_optim_loss: 35206501.8537
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9908; val_auprc_score: 0.9879; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 60205.4737; train_edge_recon_loss: 25606443.6467; train_gene_expr_recon_loss: 9254846.0082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34921495.1087; train_optim_loss: 34921495.1087; val_kl_reg_loss: 58043.7151; val_edge_recon_loss: 25714935.5122; val_gene_expr_recon_loss: 9457878.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35230857.8537; val_optim_loss: 35230857.8537
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9908; val_auprc_score: 0.9878; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 60764.2611; train_edge_recon_loss: 25659534.7935; train_gene_expr_recon_loss: 9287111.5734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35007410.6739; train_optim_loss: 35007410.6739; val_kl_reg_loss: 60276.0262; val_edge_recon_loss: 25678325.6098; val_gene_expr_recon_loss: 9509602.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35248204.0976; val_optim_loss: 35248204.0976
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 60605.4995; train_edge_recon_loss: 25601637.6250; train_gene_expr_recon_loss: 9244305.5163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34906548.5217; train_optim_loss: 34906548.5217; val_kl_reg_loss: 59079.5203; val_edge_recon_loss: 25703642.2439; val_gene_expr_recon_loss: 9464775.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35227497.4634; val_optim_loss: 35227497.4634
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9880; val_best_acc_score: 0.9685; val_best_f1_score: 0.9692; train_kl_reg_loss: 60587.3519; train_edge_recon_loss: 25601507.1739; train_gene_expr_recon_loss: 9228235.0543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34890329.6522; train_optim_loss: 34890329.6522; val_kl_reg_loss: 58484.6757; val_edge_recon_loss: 25702256.8293; val_gene_expr_recon_loss: 9443425.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35204166.7317; val_optim_loss: 35204166.7317
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9908; val_auprc_score: 0.9881; val_best_acc_score: 0.9688; val_best_f1_score: 0.9695; train_kl_reg_loss: 59778.9076; train_edge_recon_loss: 25582435.8967; train_gene_expr_recon_loss: 9215104.7527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34857319.6413; train_optim_loss: 34857319.6413; val_kl_reg_loss: 58565.5655; val_edge_recon_loss: 25718537.6098; val_gene_expr_recon_loss: 9453085.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35230188.8780; val_optim_loss: 35230188.8780
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9910; val_auprc_score: 0.9882; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 59615.8504; train_edge_recon_loss: 25595827.1902; train_gene_expr_recon_loss: 9205252.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34860695.5000; train_optim_loss: 34860695.5000; val_kl_reg_loss: 58485.6195; val_edge_recon_loss: 25678941.5610; val_gene_expr_recon_loss: 9468835.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35206262.6341; val_optim_loss: 35206262.6341
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9915; val_auprc_score: 0.9890; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 59149.6469; train_edge_recon_loss: 25573442.8696; train_gene_expr_recon_loss: 9186634.9701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34819227.5000; train_optim_loss: 34819227.5000; val_kl_reg_loss: 58088.9424; val_edge_recon_loss: 25676885.8049; val_gene_expr_recon_loss: 9447588.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35182563.7073; val_optim_loss: 35182563.7073
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9917; val_auprc_score: 0.9891; val_best_acc_score: 0.9701; val_best_f1_score: 0.9707; train_kl_reg_loss: 58285.1345; train_edge_recon_loss: 25600799.3478; train_gene_expr_recon_loss: 9181934.9090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34841019.3696; train_optim_loss: 34841019.3696; val_kl_reg_loss: 57458.7463; val_edge_recon_loss: 25669770.9756; val_gene_expr_recon_loss: 9419083.4878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35146313.1707; val_optim_loss: 35146313.1707
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9913; val_auprc_score: 0.9886; val_best_acc_score: 0.9702; val_best_f1_score: 0.9708; train_kl_reg_loss: 57882.2985; train_edge_recon_loss: 25580409.3750; train_gene_expr_recon_loss: 9180558.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34818849.9457; train_optim_loss: 34818849.9457; val_kl_reg_loss: 57565.8923; val_edge_recon_loss: 25694545.4146; val_gene_expr_recon_loss: 9439074.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35191185.4634; val_optim_loss: 35191185.4634
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 58303.6473; train_edge_recon_loss: 25577037.4239; train_gene_expr_recon_loss: 9159421.1087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34794762.1522; train_optim_loss: 34794762.1522; val_kl_reg_loss: 57147.5478; val_edge_recon_loss: 25668358.3415; val_gene_expr_recon_loss: 9450758.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35176263.9024; val_optim_loss: 35176263.9024
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9924; val_auprc_score: 0.9903; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 58016.6643; train_edge_recon_loss: 25578045.7554; train_gene_expr_recon_loss: 9161912.9538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34797975.3696; train_optim_loss: 34797975.3696; val_kl_reg_loss: 56078.8983; val_edge_recon_loss: 25638449.4634; val_gene_expr_recon_loss: 9435644.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130173.2683; val_optim_loss: 35130173.2683
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 57833.7920; train_edge_recon_loss: 25567027.7065; train_gene_expr_recon_loss: 9139868.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34764729.8261; train_optim_loss: 34764729.8261; val_kl_reg_loss: 56593.5110; val_edge_recon_loss: 25632596.1463; val_gene_expr_recon_loss: 9442933.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35132122.9268; val_optim_loss: 35132122.9268
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9917; val_auprc_score: 0.9887; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 57368.1456; train_edge_recon_loss: 25580114.2500; train_gene_expr_recon_loss: 9133223.7092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34770705.9783; train_optim_loss: 34770705.9783; val_kl_reg_loss: 56454.6464; val_edge_recon_loss: 25668818.5366; val_gene_expr_recon_loss: 9451821.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35177094.8293; val_optim_loss: 35177094.8293
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9918; val_auprc_score: 0.9890; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 57393.1488; train_edge_recon_loss: 25567932.6522; train_gene_expr_recon_loss: 9117079.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34742405.1304; train_optim_loss: 34742405.1304; val_kl_reg_loss: 55828.5963; val_edge_recon_loss: 25656470.2439; val_gene_expr_recon_loss: 9464397.5366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35176696.4878; val_optim_loss: 35176696.4878
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9916; val_auprc_score: 0.9891; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 57563.5587; train_edge_recon_loss: 25572654.8967; train_gene_expr_recon_loss: 9114685.3152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34744903.6413; train_optim_loss: 34744903.6413; val_kl_reg_loss: 56068.3033; val_edge_recon_loss: 25666697.0244; val_gene_expr_recon_loss: 9417684.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35140449.8537; val_optim_loss: 35140449.8537

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9921; val_auprc_score: 0.9896; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 58430.9596; train_edge_recon_loss: 25576688.0326; train_gene_expr_recon_loss: 9042508.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34677627.2391; train_optim_loss: 34677627.2391; val_kl_reg_loss: 57919.2109; val_edge_recon_loss: 25626933.3659; val_gene_expr_recon_loss: 9388654.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35073507.6098; val_optim_loss: 35073507.6098
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 59782.2525; train_edge_recon_loss: 25565115.7772; train_gene_expr_recon_loss: 9027349.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34652247.8152; train_optim_loss: 34652247.8152; val_kl_reg_loss: 58729.4667; val_edge_recon_loss: 25637859.3171; val_gene_expr_recon_loss: 9386738.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35083327.7073; val_optim_loss: 35083327.7073
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9921; val_auprc_score: 0.9892; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 60407.0403; train_edge_recon_loss: 25571819.0380; train_gene_expr_recon_loss: 9022041.5734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34654267.6196; train_optim_loss: 34654267.6196; val_kl_reg_loss: 59099.8603; val_edge_recon_loss: 25631962.3415; val_gene_expr_recon_loss: 9382725.1951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35073787.3171; val_optim_loss: 35073787.3171
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 60820.0195; train_edge_recon_loss: 25566979.1359; train_gene_expr_recon_loss: 9024208.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34652007.8587; train_optim_loss: 34652007.8587; val_kl_reg_loss: 59670.5452; val_edge_recon_loss: 25642187.7073; val_gene_expr_recon_loss: 9378419.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35080278.0488; val_optim_loss: 35080278.0488
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 61139.0083; train_edge_recon_loss: 25565265.2554; train_gene_expr_recon_loss: 9026433.0829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34652837.2826; train_optim_loss: 34652837.2826; val_kl_reg_loss: 59876.4472; val_edge_recon_loss: 25674583.7073; val_gene_expr_recon_loss: 9380509.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35114969.5610; val_optim_loss: 35114969.5610

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9921; val_auprc_score: 0.9893; val_best_acc_score: 0.9719; val_best_f1_score: 0.9724; train_kl_reg_loss: 61243.1716; train_edge_recon_loss: 25563395.6685; train_gene_expr_recon_loss: 9007502.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34632141.2391; train_optim_loss: 34632141.2391; val_kl_reg_loss: 59908.0095; val_edge_recon_loss: 25646342.3902; val_gene_expr_recon_loss: 9377213.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35083463.4146; val_optim_loss: 35083463.4146
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 61354.4708; train_edge_recon_loss: 25551462.5272; train_gene_expr_recon_loss: 9008472.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34621289.5435; train_optim_loss: 34621289.5435; val_kl_reg_loss: 59807.1408; val_edge_recon_loss: 25649430.9268; val_gene_expr_recon_loss: 9387064.7317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35096302.6341; val_optim_loss: 35096302.6341
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9925; val_auprc_score: 0.9902; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 61425.3852; train_edge_recon_loss: 25555642.5707; train_gene_expr_recon_loss: 9009468.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34626536.0000; train_optim_loss: 34626536.0000; val_kl_reg_loss: 60038.7564; val_edge_recon_loss: 25626472.1951; val_gene_expr_recon_loss: 9388436.7073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35074948.3902; val_optim_loss: 35074948.3902
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9716; val_best_f1_score: 0.9722; train_kl_reg_loss: 61442.3747; train_edge_recon_loss: 25562262.4674; train_gene_expr_recon_loss: 9011838.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34635542.8370; train_optim_loss: 34635542.8370; val_kl_reg_loss: 59941.3319; val_edge_recon_loss: 25664054.1951; val_gene_expr_recon_loss: 9377449.1463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35101444.9756; val_optim_loss: 35101444.9756

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 98 min 14 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9924
Val AUPRC score: 0.9898
Val best accuracy score: 0.9728
Val best F1 score: 0.9732
Val gene expr MSE score: 0.6475

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
