None
Run timestamp: 13072023_111055_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9897; val_auprc_score: 0.9866; val_best_acc_score: 0.9623; val_best_f1_score: 0.9630; train_kl_reg_loss: 7963.0616; train_edge_recon_loss: 265404.5007; train_gene_expr_recon_loss: 121562.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394930.5190; train_optim_loss: 394930.5190; val_kl_reg_loss: 7223.9660; val_edge_recon_loss: 260582.9541; val_gene_expr_recon_loss: 111561.5491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379368.4697; val_optim_loss: 379368.4697
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9925; val_auprc_score: 0.9902; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 7273.9016; train_edge_recon_loss: 260488.1524; train_gene_expr_recon_loss: 107666.5533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375428.6074; train_optim_loss: 375428.6074; val_kl_reg_loss: 7087.1399; val_edge_recon_loss: 258827.6091; val_gene_expr_recon_loss: 105830.8586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371745.6063; val_optim_loss: 371745.6063
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 6950.7466; train_edge_recon_loss: 259526.6130; train_gene_expr_recon_loss: 103650.1225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370127.4824; train_optim_loss: 370127.4824; val_kl_reg_loss: 6891.8788; val_edge_recon_loss: 258161.6659; val_gene_expr_recon_loss: 103167.5345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368221.0781; val_optim_loss: 368221.0781
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9758; val_best_f1_score: 0.9762; train_kl_reg_loss: 6744.0680; train_edge_recon_loss: 258890.3089; train_gene_expr_recon_loss: 101512.6827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367147.0594; train_optim_loss: 367147.0594; val_kl_reg_loss: 6694.7682; val_edge_recon_loss: 257846.5000; val_gene_expr_recon_loss: 101609.9684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366151.2375; val_optim_loss: 366151.2375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 6606.7258; train_edge_recon_loss: 258408.7736; train_gene_expr_recon_loss: 100274.1085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365289.6080; train_optim_loss: 365289.6080; val_kl_reg_loss: 6514.2987; val_edge_recon_loss: 257313.0359; val_gene_expr_recon_loss: 100832.5481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364659.8828; val_optim_loss: 364659.8828
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 6507.3916; train_edge_recon_loss: 257992.0751; train_gene_expr_recon_loss: 99429.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363929.3349; train_optim_loss: 363929.3349; val_kl_reg_loss: 6387.7148; val_edge_recon_loss: 256978.6663; val_gene_expr_recon_loss: 100103.6373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363470.0197; val_optim_loss: 363470.0197
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 6435.4074; train_edge_recon_loss: 257630.2245; train_gene_expr_recon_loss: 98849.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362914.9443; train_optim_loss: 362914.9443; val_kl_reg_loss: 6334.6310; val_edge_recon_loss: 256584.0058; val_gene_expr_recon_loss: 99667.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362585.7319; val_optim_loss: 362585.7319
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 6381.4581; train_edge_recon_loss: 257369.0925; train_gene_expr_recon_loss: 98475.3668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362225.9172; train_optim_loss: 362225.9172; val_kl_reg_loss: 6248.6860; val_edge_recon_loss: 256227.3703; val_gene_expr_recon_loss: 99571.9461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362048.0009; val_optim_loss: 362048.0009
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6336.0257; train_edge_recon_loss: 257211.7875; train_gene_expr_recon_loss: 98074.2044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361622.0182; train_optim_loss: 361622.0182; val_kl_reg_loss: 6367.2008; val_edge_recon_loss: 256090.8728; val_gene_expr_recon_loss: 99175.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361634.0353; val_optim_loss: 361634.0353
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 6309.8656; train_edge_recon_loss: 256968.3491; train_gene_expr_recon_loss: 97750.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361028.2782; train_optim_loss: 361028.2782; val_kl_reg_loss: 6245.1572; val_edge_recon_loss: 255990.4800; val_gene_expr_recon_loss: 98824.4274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361060.0641; val_optim_loss: 361060.0641
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6290.9768; train_edge_recon_loss: 256731.1950; train_gene_expr_recon_loss: 97524.2886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360546.4603; train_optim_loss: 360546.4603; val_kl_reg_loss: 6224.4398; val_edge_recon_loss: 255628.7403; val_gene_expr_recon_loss: 98962.0926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360815.2728; val_optim_loss: 360815.2728
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9858; val_best_f1_score: 0.9860; train_kl_reg_loss: 6276.2300; train_edge_recon_loss: 256602.2065; train_gene_expr_recon_loss: 97368.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360246.5611; train_optim_loss: 360246.5611; val_kl_reg_loss: 6342.0743; val_edge_recon_loss: 256003.1805; val_gene_expr_recon_loss: 98963.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361309.1097; val_optim_loss: 361309.1097
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 6263.8666; train_edge_recon_loss: 256512.3060; train_gene_expr_recon_loss: 97100.4768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359876.6493; train_optim_loss: 359876.6493; val_kl_reg_loss: 6352.3047; val_edge_recon_loss: 255845.9047; val_gene_expr_recon_loss: 98957.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361155.3741; val_optim_loss: 361155.3741
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6255.2182; train_edge_recon_loss: 256423.4143; train_gene_expr_recon_loss: 96975.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359654.4653; train_optim_loss: 359654.4653; val_kl_reg_loss: 6173.0574; val_edge_recon_loss: 255350.9114; val_gene_expr_recon_loss: 98824.6320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360348.6022; val_optim_loss: 360348.6022
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6241.6449; train_edge_recon_loss: 256430.3059; train_gene_expr_recon_loss: 96795.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359467.0939; train_optim_loss: 359467.0939; val_kl_reg_loss: 6250.5061; val_edge_recon_loss: 255611.5725; val_gene_expr_recon_loss: 98526.0187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360388.0975; val_optim_loss: 360388.0975
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6240.9297; train_edge_recon_loss: 256262.8518; train_gene_expr_recon_loss: 96672.9882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359176.7702; train_optim_loss: 359176.7702; val_kl_reg_loss: 6272.0384; val_edge_recon_loss: 255374.2861; val_gene_expr_recon_loss: 98403.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360050.2781; val_optim_loss: 360050.2781
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6236.1721; train_edge_recon_loss: 256223.9340; train_gene_expr_recon_loss: 96540.3762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359000.4821; train_optim_loss: 359000.4821; val_kl_reg_loss: 6323.0470; val_edge_recon_loss: 255521.0600; val_gene_expr_recon_loss: 98407.8106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360251.9147; val_optim_loss: 360251.9147
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9981; val_auprc_score: 0.9972; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6238.3238; train_edge_recon_loss: 256134.6290; train_gene_expr_recon_loss: 96443.8007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358816.7540; train_optim_loss: 358816.7540; val_kl_reg_loss: 6255.2412; val_edge_recon_loss: 255319.3861; val_gene_expr_recon_loss: 98521.7238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360096.3519; val_optim_loss: 360096.3519
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 6234.7598; train_edge_recon_loss: 256095.9976; train_gene_expr_recon_loss: 96323.9586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358654.7164; train_optim_loss: 358654.7164; val_kl_reg_loss: 6215.0879; val_edge_recon_loss: 255315.3075; val_gene_expr_recon_loss: 99158.2391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360688.6344; val_optim_loss: 360688.6344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9983; val_auprc_score: 0.9975; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6233.7245; train_edge_recon_loss: 256069.0876; train_gene_expr_recon_loss: 96216.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358519.7447; train_optim_loss: 358519.7447; val_kl_reg_loss: 6173.7292; val_edge_recon_loss: 255185.9880; val_gene_expr_recon_loss: 98467.1834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359826.8987; val_optim_loss: 359826.8987
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 6233.2160; train_edge_recon_loss: 256012.6989; train_gene_expr_recon_loss: 96118.3810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358364.2959; train_optim_loss: 358364.2959; val_kl_reg_loss: 6184.0594; val_edge_recon_loss: 254958.1386; val_gene_expr_recon_loss: 98587.9865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359730.1828; val_optim_loss: 359730.1828
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6231.1790; train_edge_recon_loss: 255976.1079; train_gene_expr_recon_loss: 95944.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358151.6265; train_optim_loss: 358151.6265; val_kl_reg_loss: 6184.3151; val_edge_recon_loss: 255185.4970; val_gene_expr_recon_loss: 98475.5707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359845.3850; val_optim_loss: 359845.3850
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6237.0208; train_edge_recon_loss: 255963.2479; train_gene_expr_recon_loss: 95909.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358109.8315; train_optim_loss: 358109.8315; val_kl_reg_loss: 6293.1970; val_edge_recon_loss: 255238.9855; val_gene_expr_recon_loss: 98488.4867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360020.6706; val_optim_loss: 360020.6706
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 6235.8357; train_edge_recon_loss: 255876.3082; train_gene_expr_recon_loss: 95830.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357943.0228; train_optim_loss: 357943.0228; val_kl_reg_loss: 6286.9645; val_edge_recon_loss: 255137.4320; val_gene_expr_recon_loss: 98613.9554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360038.3509; val_optim_loss: 360038.3509
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9983; val_auprc_score: 0.9974; val_best_acc_score: 0.9898; val_best_f1_score: 0.9898; train_kl_reg_loss: 6239.5921; train_edge_recon_loss: 255834.3143; train_gene_expr_recon_loss: 95702.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357776.0637; train_optim_loss: 357776.0637; val_kl_reg_loss: 6234.5069; val_edge_recon_loss: 255146.6469; val_gene_expr_recon_loss: 98206.8670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359588.0212; val_optim_loss: 359588.0212
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9983; val_auprc_score: 0.9975; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 6239.5621; train_edge_recon_loss: 255747.6960; train_gene_expr_recon_loss: 95716.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357703.4452; train_optim_loss: 357703.4452; val_kl_reg_loss: 6199.4788; val_edge_recon_loss: 255193.7622; val_gene_expr_recon_loss: 98535.4325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359928.6744; val_optim_loss: 359928.6744
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 6242.3970; train_edge_recon_loss: 255777.9716; train_gene_expr_recon_loss: 95622.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357643.0486; train_optim_loss: 357643.0486; val_kl_reg_loss: 6191.2826; val_edge_recon_loss: 254936.4069; val_gene_expr_recon_loss: 98674.8584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359802.5475; val_optim_loss: 359802.5475
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9899; val_best_f1_score: 0.9899; train_kl_reg_loss: 6245.3727; train_edge_recon_loss: 255731.2188; train_gene_expr_recon_loss: 95556.4523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357533.0434; train_optim_loss: 357533.0434; val_kl_reg_loss: 6283.3930; val_edge_recon_loss: 255077.8270; val_gene_expr_recon_loss: 98485.1779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359846.3962; val_optim_loss: 359846.3962
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9901; val_best_f1_score: 0.9902; train_kl_reg_loss: 6245.8501; train_edge_recon_loss: 255797.6604; train_gene_expr_recon_loss: 95514.8162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357558.3259; train_optim_loss: 357558.3259; val_kl_reg_loss: 6245.3891; val_edge_recon_loss: 255029.2270; val_gene_expr_recon_loss: 98887.8279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360162.4428; val_optim_loss: 360162.4428

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 6256.0559; train_edge_recon_loss: 255599.7488; train_gene_expr_recon_loss: 94874.4918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356730.2964; train_optim_loss: 356730.2964; val_kl_reg_loss: 6258.2440; val_edge_recon_loss: 254773.6555; val_gene_expr_recon_loss: 97937.8820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358969.7803; val_optim_loss: 358969.7803
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9904; val_best_f1_score: 0.9905; train_kl_reg_loss: 6257.1860; train_edge_recon_loss: 255595.9460; train_gene_expr_recon_loss: 94666.4068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356519.5397; train_optim_loss: 356519.5397; val_kl_reg_loss: 6254.1242; val_edge_recon_loss: 254928.8642; val_gene_expr_recon_loss: 98256.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359439.3494; val_optim_loss: 359439.3494
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 6255.5678; train_edge_recon_loss: 255598.3360; train_gene_expr_recon_loss: 94669.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356523.2832; train_optim_loss: 356523.2832; val_kl_reg_loss: 6245.3616; val_edge_recon_loss: 254588.7838; val_gene_expr_recon_loss: 98049.3541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358883.4984; val_optim_loss: 358883.4984
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9903; val_best_f1_score: 0.9904; train_kl_reg_loss: 6256.8877; train_edge_recon_loss: 255559.3221; train_gene_expr_recon_loss: 94656.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356472.4453; train_optim_loss: 356472.4453; val_kl_reg_loss: 6247.9005; val_edge_recon_loss: 254859.2727; val_gene_expr_recon_loss: 97980.9387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359088.1116; val_optim_loss: 359088.1116
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9906; val_best_f1_score: 0.9907; train_kl_reg_loss: 6257.1629; train_edge_recon_loss: 255563.0838; train_gene_expr_recon_loss: 94623.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356443.7172; train_optim_loss: 356443.7172; val_kl_reg_loss: 6272.9548; val_edge_recon_loss: 254770.2320; val_gene_expr_recon_loss: 98197.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359240.2913; val_optim_loss: 359240.2913
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 6255.1987; train_edge_recon_loss: 255570.3198; train_gene_expr_recon_loss: 94543.3653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356368.8841; train_optim_loss: 356368.8841; val_kl_reg_loss: 6263.5822; val_edge_recon_loss: 254770.9738; val_gene_expr_recon_loss: 98138.0933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359172.6487; val_optim_loss: 359172.6487
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9986; val_auprc_score: 0.9979; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 6256.4094; train_edge_recon_loss: 255553.0463; train_gene_expr_recon_loss: 94597.5850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356407.0404; train_optim_loss: 356407.0404; val_kl_reg_loss: 6276.9827; val_edge_recon_loss: 255019.9053; val_gene_expr_recon_loss: 98007.1821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359304.0703; val_optim_loss: 359304.0703

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9988; val_auprc_score: 0.9983; val_best_acc_score: 0.9905; val_best_f1_score: 0.9906; train_kl_reg_loss: 6257.3267; train_edge_recon_loss: 255534.2480; train_gene_expr_recon_loss: 94475.0183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356266.5922; train_optim_loss: 356266.5922; val_kl_reg_loss: 6257.4703; val_edge_recon_loss: 254668.8948; val_gene_expr_recon_loss: 98305.0597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359231.4259; val_optim_loss: 359231.4259
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9906; val_best_f1_score: 0.9906; train_kl_reg_loss: 6256.0083; train_edge_recon_loss: 255490.5527; train_gene_expr_recon_loss: 94427.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356173.9297; train_optim_loss: 356173.9297; val_kl_reg_loss: 6258.8449; val_edge_recon_loss: 254740.1003; val_gene_expr_recon_loss: 98196.8810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359195.8272; val_optim_loss: 359195.8272
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9906; val_best_f1_score: 0.9907; train_kl_reg_loss: 6257.4769; train_edge_recon_loss: 255516.9421; train_gene_expr_recon_loss: 94465.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356239.6910; train_optim_loss: 356239.6910; val_kl_reg_loss: 6256.6267; val_edge_recon_loss: 254680.1866; val_gene_expr_recon_loss: 98218.3401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359155.1519; val_optim_loss: 359155.1519
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9987; val_auprc_score: 0.9982; val_best_acc_score: 0.9903; val_best_f1_score: 0.9903; train_kl_reg_loss: 6256.8787; train_edge_recon_loss: 255552.8552; train_gene_expr_recon_loss: 94474.8339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356284.5682; train_optim_loss: 356284.5682; val_kl_reg_loss: 6260.0307; val_edge_recon_loss: 254831.6633; val_gene_expr_recon_loss: 98244.3953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359336.0881; val_optim_loss: 359336.0881

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 596 min 1 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9986
Val AUPRC score: 0.9979
Val best accuracy score: 0.9906
Val best F1 score: 0.9906
Val gene expr MSE score: 0.6696

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
