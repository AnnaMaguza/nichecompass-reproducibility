None
Run timestamp: 16072023_222148_2010.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2010']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9816; val_auprc_score: 0.9745; val_best_acc_score: 0.9473; val_best_f1_score: 0.9485; train_kl_reg_loss: 24408.9193; train_edge_recon_loss: 26463328.6360; train_gene_expr_recon_loss: 1367430.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27855168.3566; train_optim_loss: 27855168.3566; val_kl_reg_loss: 22450.5825; val_edge_recon_loss: 25925986.0984; val_gene_expr_recon_loss: 1234033.4734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27182469.9016; val_optim_loss: 27182469.9016
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9854; val_auprc_score: 0.9789; val_best_acc_score: 0.9564; val_best_f1_score: 0.9574; train_kl_reg_loss: 22021.6975; train_edge_recon_loss: 25781085.0110; train_gene_expr_recon_loss: 1187875.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26990982.3824; train_optim_loss: 26990982.3824; val_kl_reg_loss: 22052.0791; val_edge_recon_loss: 25746101.4754; val_gene_expr_recon_loss: 1158039.0615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26926192.5902; val_optim_loss: 26926192.5902
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9873; val_auprc_score: 0.9815; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 21245.9096; train_edge_recon_loss: 25686340.5331; train_gene_expr_recon_loss: 1138276.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26845863.3015; train_optim_loss: 26845863.3015; val_kl_reg_loss: 20783.0634; val_edge_recon_loss: 25671498.0656; val_gene_expr_recon_loss: 1127318.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26819599.9344; val_optim_loss: 26819599.9344
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9888; val_auprc_score: 0.9840; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 20464.1301; train_edge_recon_loss: 25616832.4412; train_gene_expr_recon_loss: 1109728.5631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26747025.0809; train_optim_loss: 26747025.0809; val_kl_reg_loss: 19949.8843; val_edge_recon_loss: 25600577.9344; val_gene_expr_recon_loss: 1104119.8412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26724647.7705; val_optim_loss: 26724647.7705
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9901; val_auprc_score: 0.9851; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 20266.1221; train_edge_recon_loss: 25576763.7941; train_gene_expr_recon_loss: 1090407.6737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26687437.5882; train_optim_loss: 26687437.5882; val_kl_reg_loss: 20093.6279; val_edge_recon_loss: 25594650.6557; val_gene_expr_recon_loss: 1084780.4682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26699524.8852; val_optim_loss: 26699524.8852
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9870; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 20093.4427; train_edge_recon_loss: 25559407.3824; train_gene_expr_recon_loss: 1077024.2764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26656525.1029; train_optim_loss: 26656525.1029; val_kl_reg_loss: 19867.3893; val_edge_recon_loss: 25592837.0492; val_gene_expr_recon_loss: 1074024.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26686729.1803; val_optim_loss: 26686729.1803
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9872; val_best_acc_score: 0.9713; val_best_f1_score: 0.9718; train_kl_reg_loss: 19760.7790; train_edge_recon_loss: 25536940.1434; train_gene_expr_recon_loss: 1068026.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26624727.0882; train_optim_loss: 26624727.0882; val_kl_reg_loss: 19600.7666; val_edge_recon_loss: 25566105.1803; val_gene_expr_recon_loss: 1062634.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26648340.0984; val_optim_loss: 26648340.0984
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9927; val_auprc_score: 0.9893; val_best_acc_score: 0.9740; val_best_f1_score: 0.9745; train_kl_reg_loss: 19747.6815; train_edge_recon_loss: 25520085.0662; train_gene_expr_recon_loss: 1059740.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26599573.3971; train_optim_loss: 26599573.3971; val_kl_reg_loss: 19131.8503; val_edge_recon_loss: 25549257.3443; val_gene_expr_recon_loss: 1059405.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26627795.1803; val_optim_loss: 26627795.1803
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9931; val_auprc_score: 0.9900; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 19514.6622; train_edge_recon_loss: 25503325.6250; train_gene_expr_recon_loss: 1052977.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26575817.5919; train_optim_loss: 26575817.5919; val_kl_reg_loss: 19054.6785; val_edge_recon_loss: 25555041.6066; val_gene_expr_recon_loss: 1056619.7223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26630716.0000; val_optim_loss: 26630716.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9929; val_auprc_score: 0.9891; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 19208.5856; train_edge_recon_loss: 25494774.5551; train_gene_expr_recon_loss: 1048393.9801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26562377.1213; train_optim_loss: 26562377.1213; val_kl_reg_loss: 18695.5826; val_edge_recon_loss: 25511516.0328; val_gene_expr_recon_loss: 1048413.8432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26578625.4098; val_optim_loss: 26578625.4098
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9940; val_auprc_score: 0.9911; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 19050.6111; train_edge_recon_loss: 25481266.8235; train_gene_expr_recon_loss: 1043733.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26544051.3676; train_optim_loss: 26544051.3676; val_kl_reg_loss: 18751.9098; val_edge_recon_loss: 25523865.0492; val_gene_expr_recon_loss: 1045998.9109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26588615.9672; val_optim_loss: 26588615.9672
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9940; val_auprc_score: 0.9911; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 18864.9956; train_edge_recon_loss: 25471148.3603; train_gene_expr_recon_loss: 1040215.1582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26530228.5110; train_optim_loss: 26530228.5110; val_kl_reg_loss: 18084.6361; val_edge_recon_loss: 25522035.5410; val_gene_expr_recon_loss: 1043815.1291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26583934.9180; val_optim_loss: 26583934.9180
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9924; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 18842.0203; train_edge_recon_loss: 25461486.9632; train_gene_expr_recon_loss: 1035960.5777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26516289.5919; train_optim_loss: 26516289.5919; val_kl_reg_loss: 18532.6147; val_edge_recon_loss: 25499027.8033; val_gene_expr_recon_loss: 1041820.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26559380.8852; val_optim_loss: 26559380.8852
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9947; val_auprc_score: 0.9919; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 18799.8095; train_edge_recon_loss: 25452225.3382; train_gene_expr_recon_loss: 1033557.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26504582.9265; train_optim_loss: 26504582.9265; val_kl_reg_loss: 18568.7221; val_edge_recon_loss: 25459931.1803; val_gene_expr_recon_loss: 1036740.8268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26515240.8197; val_optim_loss: 26515240.8197
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9918; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 18654.2772; train_edge_recon_loss: 25444478.2757; train_gene_expr_recon_loss: 1031318.8944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26494451.4449; train_optim_loss: 26494451.4449; val_kl_reg_loss: 17276.2080; val_edge_recon_loss: 25468903.7377; val_gene_expr_recon_loss: 1037260.7408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26523440.6557; val_optim_loss: 26523440.6557
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9921; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 18329.5297; train_edge_recon_loss: 25432137.5257; train_gene_expr_recon_loss: 1028239.6579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26478706.7426; train_optim_loss: 26478706.7426; val_kl_reg_loss: 17935.0307; val_edge_recon_loss: 25469202.4590; val_gene_expr_recon_loss: 1033228.1004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26520365.5410; val_optim_loss: 26520365.5410
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9929; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 18467.1338; train_edge_recon_loss: 25428818.9228; train_gene_expr_recon_loss: 1024587.6494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26471873.6581; train_optim_loss: 26471873.6581; val_kl_reg_loss: 17759.6478; val_edge_recon_loss: 25456752.4590; val_gene_expr_recon_loss: 1032886.2387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26507398.3279; val_optim_loss: 26507398.3279
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9953; val_auprc_score: 0.9928; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 18200.7743; train_edge_recon_loss: 25426057.1544; train_gene_expr_recon_loss: 1022227.0593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26466484.9926; train_optim_loss: 26466484.9926; val_kl_reg_loss: 17962.7875; val_edge_recon_loss: 25465291.9344; val_gene_expr_recon_loss: 1028705.3473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26511960.0000; val_optim_loss: 26511960.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9930; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 18159.7580; train_edge_recon_loss: 25419779.4044; train_gene_expr_recon_loss: 1020333.9530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26458273.1397; train_optim_loss: 26458273.1397; val_kl_reg_loss: 18074.7562; val_edge_recon_loss: 25427178.5902; val_gene_expr_recon_loss: 1025630.2357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26470883.7377; val_optim_loss: 26470883.7377
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9955; val_auprc_score: 0.9927; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 18269.9888; train_edge_recon_loss: 25412729.8897; train_gene_expr_recon_loss: 1018138.7564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26449138.6654; train_optim_loss: 26449138.6654; val_kl_reg_loss: 17607.9225; val_edge_recon_loss: 25416794.1311; val_gene_expr_recon_loss: 1023094.8986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26457497.0164; val_optim_loss: 26457497.0164
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9937; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 17986.4865; train_edge_recon_loss: 25405371.6360; train_gene_expr_recon_loss: 1014087.4600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26437445.5735; train_optim_loss: 26437445.5735; val_kl_reg_loss: 17811.3722; val_edge_recon_loss: 25443956.1311; val_gene_expr_recon_loss: 1020082.6977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26481850.0984; val_optim_loss: 26481850.0984
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9940; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 17913.1650; train_edge_recon_loss: 25408675.0699; train_gene_expr_recon_loss: 1011442.3193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26438030.5331; train_optim_loss: 26438030.5331; val_kl_reg_loss: 17784.0169; val_edge_recon_loss: 25441552.9180; val_gene_expr_recon_loss: 1015537.7387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26474874.6885; val_optim_loss: 26474874.6885
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9956; val_auprc_score: 0.9928; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 17911.1879; train_edge_recon_loss: 25398935.0257; train_gene_expr_recon_loss: 1009459.7202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26426306.0184; train_optim_loss: 26426306.0184; val_kl_reg_loss: 17557.7256; val_edge_recon_loss: 25432386.6230; val_gene_expr_recon_loss: 1026717.5584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26476662.0656; val_optim_loss: 26476662.0656
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9960; val_auprc_score: 0.9941; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 17866.9362; train_edge_recon_loss: 25386780.9743; train_gene_expr_recon_loss: 1005062.5813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26409710.4522; train_optim_loss: 26409710.4522; val_kl_reg_loss: 17371.0114; val_edge_recon_loss: 25431370.9508; val_gene_expr_recon_loss: 1008896.5584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26457638.4918; val_optim_loss: 26457638.4918

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9948; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 17762.1560; train_edge_recon_loss: 25391804.4154; train_gene_expr_recon_loss: 998208.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26407775.0588; train_optim_loss: 26407775.0588; val_kl_reg_loss: 17581.3893; val_edge_recon_loss: 25390625.0164; val_gene_expr_recon_loss: 1007983.2480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26416189.7705; val_optim_loss: 26416189.7705
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 17925.9764; train_edge_recon_loss: 25396231.6066; train_gene_expr_recon_loss: 997986.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26412143.9779; train_optim_loss: 26412143.9779; val_kl_reg_loss: 17724.1810; val_edge_recon_loss: 25414421.5738; val_gene_expr_recon_loss: 982230.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26414376.8197; val_optim_loss: 26414376.8197
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 18013.7079; train_edge_recon_loss: 25378514.1838; train_gene_expr_recon_loss: 993929.2771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26390457.1581; train_optim_loss: 26390457.1581; val_kl_reg_loss: 17839.1722; val_edge_recon_loss: 25405543.2459; val_gene_expr_recon_loss: 1022000.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26445382.6557; val_optim_loss: 26445382.6557
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9961; val_auprc_score: 0.9942; val_best_acc_score: 0.9858; val_best_f1_score: 0.9860; train_kl_reg_loss: 18041.0529; train_edge_recon_loss: 25381209.5294; train_gene_expr_recon_loss: 994918.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26394169.1765; train_optim_loss: 26394169.1765; val_kl_reg_loss: 17869.2945; val_edge_recon_loss: 25425810.8197; val_gene_expr_recon_loss: 1009832.4734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26453512.6557; val_optim_loss: 26453512.6557
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9959; val_auprc_score: 0.9938; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 18120.6223; train_edge_recon_loss: 25372970.1029; train_gene_expr_recon_loss: 992572.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26383663.5404; train_optim_loss: 26383663.5404; val_kl_reg_loss: 17866.2872; val_edge_recon_loss: 25413611.8689; val_gene_expr_recon_loss: 986541.3791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26418019.4426; val_optim_loss: 26418019.4426
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 17993.3356; train_edge_recon_loss: 25380879.5882; train_gene_expr_recon_loss: 994344.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26393217.8640; train_optim_loss: 26393217.8640; val_kl_reg_loss: 17876.7736; val_edge_recon_loss: 25414618.0328; val_gene_expr_recon_loss: 999334.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26431829.8361; val_optim_loss: 26431829.8361

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 18045.5739; train_edge_recon_loss: 25375325.4706; train_gene_expr_recon_loss: 993821.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26387192.0735; train_optim_loss: 26387192.0735; val_kl_reg_loss: 17806.8764; val_edge_recon_loss: 25424261.5410; val_gene_expr_recon_loss: 1013400.2684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26455468.6885; val_optim_loss: 26455468.6885
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 18012.5405; train_edge_recon_loss: 25378518.7243; train_gene_expr_recon_loss: 992287.1105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26388818.4412; train_optim_loss: 26388818.4412; val_kl_reg_loss: 17797.6644; val_edge_recon_loss: 25380497.4754; val_gene_expr_recon_loss: 1002537.9488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26400833.0820; val_optim_loss: 26400833.0820
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9938; val_best_acc_score: 0.9862; val_best_f1_score: 0.9864; train_kl_reg_loss: 18028.7038; train_edge_recon_loss: 25378224.9779; train_gene_expr_recon_loss: 993481.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26389734.8015; train_optim_loss: 26389734.8015; val_kl_reg_loss: 17833.2972; val_edge_recon_loss: 25405545.7049; val_gene_expr_recon_loss: 1029036.2449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26452415.2131; val_optim_loss: 26452415.2131
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9937; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 18032.5759; train_edge_recon_loss: 25386980.7169; train_gene_expr_recon_loss: 993332.5340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26398345.8088; train_optim_loss: 26398345.8088; val_kl_reg_loss: 17818.3173; val_edge_recon_loss: 25407433.3115; val_gene_expr_recon_loss: 997773.9488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26423025.4426; val_optim_loss: 26423025.4426
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9943; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 18010.2066; train_edge_recon_loss: 25374106.2132; train_gene_expr_recon_loss: 993103.2412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26385219.6654; train_optim_loss: 26385219.6654; val_kl_reg_loss: 17810.9882; val_edge_recon_loss: 25385015.2787; val_gene_expr_recon_loss: 1003031.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26405857.7049; val_optim_loss: 26405857.7049
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9963; val_auprc_score: 0.9944; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 18016.2862; train_edge_recon_loss: 25371975.1985; train_gene_expr_recon_loss: 991462.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26381454.3162; train_optim_loss: 26381454.3162; val_kl_reg_loss: 17807.9038; val_edge_recon_loss: 25400108.4918; val_gene_expr_recon_loss: 995341.2746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26413257.5410; val_optim_loss: 26413257.5410

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 18022.8502; train_edge_recon_loss: 25379577.7610; train_gene_expr_recon_loss: 997945.2086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26395545.8603; train_optim_loss: 26395545.8603; val_kl_reg_loss: 17804.1574; val_edge_recon_loss: 25388437.1803; val_gene_expr_recon_loss: 1008648.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26414890.1639; val_optim_loss: 26414890.1639
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9943; val_best_acc_score: 0.9863; val_best_f1_score: 0.9865; train_kl_reg_loss: 18018.1270; train_edge_recon_loss: 25366504.3529; train_gene_expr_recon_loss: 994808.2536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26379330.7831; train_optim_loss: 26379330.7831; val_kl_reg_loss: 17795.1594; val_edge_recon_loss: 25403689.2131; val_gene_expr_recon_loss: 1003836.7449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26425321.0492; val_optim_loss: 26425321.0492
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9960; val_auprc_score: 0.9937; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 18010.0724; train_edge_recon_loss: 25373886.4559; train_gene_expr_recon_loss: 991289.2030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26383185.7757; train_optim_loss: 26383185.7757; val_kl_reg_loss: 17785.7246; val_edge_recon_loss: 25420929.6393; val_gene_expr_recon_loss: 1001098.8914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26439814.2295; val_optim_loss: 26439814.2295
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9967; val_auprc_score: 0.9949; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 18011.6602; train_edge_recon_loss: 25370349.6176; train_gene_expr_recon_loss: 995351.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26383713.0478; train_optim_loss: 26383713.0478; val_kl_reg_loss: 17789.5930; val_edge_recon_loss: 25384206.8525; val_gene_expr_recon_loss: 1010279.6322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26412276.0984; val_optim_loss: 26412276.0984

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 221 min 34 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9942
Val best accuracy score: 0.9861
Val best F1 score: 0.9862
Val gene expr MSE score: 0.6600

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
