None
Run timestamp: 05072023_085746_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9733; val_auprc_score: 0.9714; val_best_acc_score: 0.9189; val_best_f1_score: 0.9197; train_kl_reg_loss: 5604.6198; train_edge_recon_loss: 267252.6251; train_gene_expr_recon_loss: 17941.6819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 290798.9265; train_optim_loss: 290798.9265; val_kl_reg_loss: 5604.6107; val_edge_recon_loss: 265957.7118; val_gene_expr_recon_loss: 15989.5814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 287551.9026; val_optim_loss: 287551.9026
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9789; val_auprc_score: 0.9770; val_best_acc_score: 0.9299; val_best_f1_score: 0.9301; train_kl_reg_loss: 5739.2780; train_edge_recon_loss: 261797.9095; train_gene_expr_recon_loss: 15552.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283089.6552; train_optim_loss: 283089.6552; val_kl_reg_loss: 5620.3251; val_edge_recon_loss: 265191.3719; val_gene_expr_recon_loss: 15033.1183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285844.8162; val_optim_loss: 285844.8162
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9822; val_auprc_score: 0.9802; val_best_acc_score: 0.9370; val_best_f1_score: 0.9374; train_kl_reg_loss: 5728.2491; train_edge_recon_loss: 261169.6876; train_gene_expr_recon_loss: 14833.7108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281731.6484; train_optim_loss: 281731.6484; val_kl_reg_loss: 5500.9934; val_edge_recon_loss: 263798.7111; val_gene_expr_recon_loss: 14482.3178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283782.0233; val_optim_loss: 283782.0233
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9836; val_auprc_score: 0.9821; val_best_acc_score: 0.9380; val_best_f1_score: 0.9385; train_kl_reg_loss: 5732.8269; train_edge_recon_loss: 260708.6912; train_gene_expr_recon_loss: 14397.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280838.9062; train_optim_loss: 280838.9062; val_kl_reg_loss: 5634.3088; val_edge_recon_loss: 264365.7570; val_gene_expr_recon_loss: 14078.0276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284078.0957; val_optim_loss: 284078.0957
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9852; val_auprc_score: 0.9838; val_best_acc_score: 0.9421; val_best_f1_score: 0.9424; train_kl_reg_loss: 5735.3305; train_edge_recon_loss: 260571.8560; train_gene_expr_recon_loss: 14123.2397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280430.4263; train_optim_loss: 280430.4263; val_kl_reg_loss: 5529.7690; val_edge_recon_loss: 263956.9241; val_gene_expr_recon_loss: 13889.8474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283376.5395; val_optim_loss: 283376.5395
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9858; val_auprc_score: 0.9845; val_best_acc_score: 0.9432; val_best_f1_score: 0.9436; train_kl_reg_loss: 5748.4799; train_edge_recon_loss: 260268.0768; train_gene_expr_recon_loss: 13919.0096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279935.5648; train_optim_loss: 279935.5648; val_kl_reg_loss: 5613.8411; val_edge_recon_loss: 263845.3249; val_gene_expr_recon_loss: 13736.4330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283195.5997; val_optim_loss: 283195.5997
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9863; val_auprc_score: 0.9848; val_best_acc_score: 0.9454; val_best_f1_score: 0.9458; train_kl_reg_loss: 5772.7493; train_edge_recon_loss: 260215.5410; train_gene_expr_recon_loss: 13765.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279754.1915; train_optim_loss: 279754.1915; val_kl_reg_loss: 5617.9585; val_edge_recon_loss: 263727.9849; val_gene_expr_recon_loss: 13614.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282960.5614; val_optim_loss: 282960.5614
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9872; val_auprc_score: 0.9858; val_best_acc_score: 0.9473; val_best_f1_score: 0.9477; train_kl_reg_loss: 5779.5436; train_edge_recon_loss: 260095.1784; train_gene_expr_recon_loss: 13648.1427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279522.8644; train_optim_loss: 279522.8644; val_kl_reg_loss: 5788.3944; val_edge_recon_loss: 263549.6786; val_gene_expr_recon_loss: 13476.8219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282814.8960; val_optim_loss: 282814.8960
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9873; val_auprc_score: 0.9853; val_best_acc_score: 0.9478; val_best_f1_score: 0.9481; train_kl_reg_loss: 5794.2752; train_edge_recon_loss: 259868.5671; train_gene_expr_recon_loss: 13552.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279215.4051; train_optim_loss: 279215.4051; val_kl_reg_loss: 5474.7049; val_edge_recon_loss: 263596.0609; val_gene_expr_recon_loss: 13450.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282520.8145; val_optim_loss: 282520.8145
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9877; val_auprc_score: 0.9861; val_best_acc_score: 0.9490; val_best_f1_score: 0.9494; train_kl_reg_loss: 5799.6293; train_edge_recon_loss: 259755.9034; train_gene_expr_recon_loss: 13484.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279039.6623; train_optim_loss: 279039.6623; val_kl_reg_loss: 5687.0630; val_edge_recon_loss: 263280.4067; val_gene_expr_recon_loss: 13338.3260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282305.7929; val_optim_loss: 282305.7929
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9878; val_auprc_score: 0.9861; val_best_acc_score: 0.9486; val_best_f1_score: 0.9492; train_kl_reg_loss: 5811.3072; train_edge_recon_loss: 259687.5995; train_gene_expr_recon_loss: 13424.2712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278923.1778; train_optim_loss: 278923.1778; val_kl_reg_loss: 5521.3465; val_edge_recon_loss: 263408.5558; val_gene_expr_recon_loss: 13292.0599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282221.9616; val_optim_loss: 282221.9616
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9883; val_auprc_score: 0.9869; val_best_acc_score: 0.9507; val_best_f1_score: 0.9508; train_kl_reg_loss: 5819.0778; train_edge_recon_loss: 259615.5890; train_gene_expr_recon_loss: 13374.3630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278809.0309; train_optim_loss: 278809.0309; val_kl_reg_loss: 5707.0803; val_edge_recon_loss: 263219.4460; val_gene_expr_recon_loss: 13264.1609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282190.6884; val_optim_loss: 282190.6884
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9879; val_best_acc_score: 0.9523; val_best_f1_score: 0.9525; train_kl_reg_loss: 5824.8974; train_edge_recon_loss: 259546.8037; train_gene_expr_recon_loss: 13334.1357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278705.8372; train_optim_loss: 278705.8372; val_kl_reg_loss: 5996.4880; val_edge_recon_loss: 263056.5642; val_gene_expr_recon_loss: 13204.8764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282257.9276; val_optim_loss: 282257.9276
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9890; val_auprc_score: 0.9874; val_best_acc_score: 0.9526; val_best_f1_score: 0.9531; train_kl_reg_loss: 5829.1513; train_edge_recon_loss: 259503.5339; train_gene_expr_recon_loss: 13303.0330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278635.7176; train_optim_loss: 278635.7176; val_kl_reg_loss: 5769.9292; val_edge_recon_loss: 263336.8071; val_gene_expr_recon_loss: 13196.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282303.5108; val_optim_loss: 282303.5108
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9547; val_best_f1_score: 0.9550; train_kl_reg_loss: 5835.5799; train_edge_recon_loss: 259449.4931; train_gene_expr_recon_loss: 13275.6158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278560.6891; train_optim_loss: 278560.6891; val_kl_reg_loss: 5859.4270; val_edge_recon_loss: 263150.9700; val_gene_expr_recon_loss: 13162.3046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282172.7028; val_optim_loss: 282172.7028
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9887; val_auprc_score: 0.9874; val_best_acc_score: 0.9519; val_best_f1_score: 0.9523; train_kl_reg_loss: 5837.8144; train_edge_recon_loss: 259371.5062; train_gene_expr_recon_loss: 13250.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278459.6257; train_optim_loss: 278459.6257; val_kl_reg_loss: 5854.6685; val_edge_recon_loss: 263022.0923; val_gene_expr_recon_loss: 13131.5915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282008.3526; val_optim_loss: 282008.3526
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9900; val_auprc_score: 0.9886; val_best_acc_score: 0.9545; val_best_f1_score: 0.9548; train_kl_reg_loss: 5843.0794; train_edge_recon_loss: 259320.0501; train_gene_expr_recon_loss: 13237.5166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278400.6464; train_optim_loss: 278400.6464; val_kl_reg_loss: 5854.1881; val_edge_recon_loss: 262847.4838; val_gene_expr_recon_loss: 13121.6709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281823.3443; val_optim_loss: 281823.3443
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9545; val_best_f1_score: 0.9546; train_kl_reg_loss: 5843.3191; train_edge_recon_loss: 259323.4398; train_gene_expr_recon_loss: 13213.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278380.7016; train_optim_loss: 278380.7016; val_kl_reg_loss: 5784.1858; val_edge_recon_loss: 263018.4959; val_gene_expr_recon_loss: 13111.3304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281914.0119; val_optim_loss: 281914.0119
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9906; val_auprc_score: 0.9892; val_best_acc_score: 0.9556; val_best_f1_score: 0.9560; train_kl_reg_loss: 5850.3400; train_edge_recon_loss: 259363.6704; train_gene_expr_recon_loss: 13199.0368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278413.0468; train_optim_loss: 278413.0468; val_kl_reg_loss: 5740.6478; val_edge_recon_loss: 262517.1584; val_gene_expr_recon_loss: 13096.0741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281353.8815; val_optim_loss: 281353.8815
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9902; val_auprc_score: 0.9890; val_best_acc_score: 0.9554; val_best_f1_score: 0.9557; train_kl_reg_loss: 5852.0042; train_edge_recon_loss: 259189.8950; train_gene_expr_recon_loss: 13177.6713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278219.5704; train_optim_loss: 278219.5704; val_kl_reg_loss: 5698.1557; val_edge_recon_loss: 262872.8699; val_gene_expr_recon_loss: 13057.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281628.7125; val_optim_loss: 281628.7125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9901; val_auprc_score: 0.9886; val_best_acc_score: 0.9552; val_best_f1_score: 0.9556; train_kl_reg_loss: 5855.6752; train_edge_recon_loss: 259196.5027; train_gene_expr_recon_loss: 13163.9832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278216.1616; train_optim_loss: 278216.1616; val_kl_reg_loss: 5783.7475; val_edge_recon_loss: 263019.8003; val_gene_expr_recon_loss: 13052.9617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281856.5114; val_optim_loss: 281856.5114
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9906; val_auprc_score: 0.9892; val_best_acc_score: 0.9564; val_best_f1_score: 0.9568; train_kl_reg_loss: 5857.3809; train_edge_recon_loss: 259193.7343; train_gene_expr_recon_loss: 13158.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278209.3271; train_optim_loss: 278209.3271; val_kl_reg_loss: 5947.0985; val_edge_recon_loss: 262922.0455; val_gene_expr_recon_loss: 13055.0288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281924.1727; val_optim_loss: 281924.1727
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9903; val_auprc_score: 0.9893; val_best_acc_score: 0.9560; val_best_f1_score: 0.9562; train_kl_reg_loss: 5858.9604; train_edge_recon_loss: 259108.5770; train_gene_expr_recon_loss: 13136.9838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278104.5214; train_optim_loss: 278104.5214; val_kl_reg_loss: 5761.6013; val_edge_recon_loss: 262604.2357; val_gene_expr_recon_loss: 13029.9434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281395.7807; val_optim_loss: 281395.7807

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9912; val_auprc_score: 0.9897; val_best_acc_score: 0.9581; val_best_f1_score: 0.9584; train_kl_reg_loss: 5849.8274; train_edge_recon_loss: 258805.4576; train_gene_expr_recon_loss: 13059.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277715.1279; train_optim_loss: 277715.1279; val_kl_reg_loss: 5782.8283; val_edge_recon_loss: 262447.4878; val_gene_expr_recon_loss: 12954.9326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281185.2500; val_optim_loss: 281185.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9903; val_best_acc_score: 0.9594; val_best_f1_score: 0.9598; train_kl_reg_loss: 5843.0481; train_edge_recon_loss: 258705.8384; train_gene_expr_recon_loss: 13042.3507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277591.2377; train_optim_loss: 277591.2377; val_kl_reg_loss: 5748.4623; val_edge_recon_loss: 262179.9359; val_gene_expr_recon_loss: 12949.3637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280877.7619; val_optim_loss: 280877.7619
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9918; val_auprc_score: 0.9904; val_best_acc_score: 0.9598; val_best_f1_score: 0.9601; train_kl_reg_loss: 5840.8591; train_edge_recon_loss: 258716.7387; train_gene_expr_recon_loss: 13028.8623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277586.4600; train_optim_loss: 277586.4600; val_kl_reg_loss: 5758.1743; val_edge_recon_loss: 262207.1713; val_gene_expr_recon_loss: 12943.4624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280908.8068; val_optim_loss: 280908.8068
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9919; val_auprc_score: 0.9909; val_best_acc_score: 0.9602; val_best_f1_score: 0.9604; train_kl_reg_loss: 5839.0786; train_edge_recon_loss: 258736.5341; train_gene_expr_recon_loss: 13032.0994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277607.7119; train_optim_loss: 277607.7119; val_kl_reg_loss: 5793.4864; val_edge_recon_loss: 261982.4614; val_gene_expr_recon_loss: 12916.3775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280692.3261; val_optim_loss: 280692.3261
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9917; val_auprc_score: 0.9902; val_best_acc_score: 0.9601; val_best_f1_score: 0.9605; train_kl_reg_loss: 5834.7477; train_edge_recon_loss: 258708.4489; train_gene_expr_recon_loss: 13026.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277569.9460; train_optim_loss: 277569.9460; val_kl_reg_loss: 5738.8579; val_edge_recon_loss: 262115.0898; val_gene_expr_recon_loss: 12930.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280784.6503; val_optim_loss: 280784.6503
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9919; val_auprc_score: 0.9910; val_best_acc_score: 0.9598; val_best_f1_score: 0.9600; train_kl_reg_loss: 5833.3068; train_edge_recon_loss: 258653.6398; train_gene_expr_recon_loss: 13023.3355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277510.2828; train_optim_loss: 277510.2828; val_kl_reg_loss: 5737.5147; val_edge_recon_loss: 262278.7848; val_gene_expr_recon_loss: 12945.7360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280962.0349; val_optim_loss: 280962.0349
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9917; val_auprc_score: 0.9903; val_best_acc_score: 0.9594; val_best_f1_score: 0.9596; train_kl_reg_loss: 5828.5354; train_edge_recon_loss: 258658.7597; train_gene_expr_recon_loss: 13014.7573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277502.0518; train_optim_loss: 277502.0518; val_kl_reg_loss: 5759.7934; val_edge_recon_loss: 262335.7393; val_gene_expr_recon_loss: 12927.9270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281023.4597; val_optim_loss: 281023.4597
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9917; val_auprc_score: 0.9904; val_best_acc_score: 0.9590; val_best_f1_score: 0.9592; train_kl_reg_loss: 5829.2182; train_edge_recon_loss: 258631.3500; train_gene_expr_recon_loss: 13015.1540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277475.7222; train_optim_loss: 277475.7222; val_kl_reg_loss: 5733.0529; val_edge_recon_loss: 262185.9074; val_gene_expr_recon_loss: 12916.0829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280835.0429; val_optim_loss: 280835.0429

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9920; val_auprc_score: 0.9910; val_best_acc_score: 0.9605; val_best_f1_score: 0.9607; train_kl_reg_loss: 5827.3881; train_edge_recon_loss: 258688.6450; train_gene_expr_recon_loss: 13002.7105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277518.7440; train_optim_loss: 277518.7440; val_kl_reg_loss: 5749.6866; val_edge_recon_loss: 262159.3896; val_gene_expr_recon_loss: 12903.6017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280812.6767; val_optim_loss: 280812.6767
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9922; val_auprc_score: 0.9911; val_best_acc_score: 0.9611; val_best_f1_score: 0.9613; train_kl_reg_loss: 5825.9215; train_edge_recon_loss: 258636.0090; train_gene_expr_recon_loss: 12998.2588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277460.1885; train_optim_loss: 277460.1885; val_kl_reg_loss: 5757.4841; val_edge_recon_loss: 261856.6723; val_gene_expr_recon_loss: 12908.5065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280522.6631; val_optim_loss: 280522.6631
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9921; val_auprc_score: 0.9907; val_best_acc_score: 0.9610; val_best_f1_score: 0.9613; train_kl_reg_loss: 5825.6629; train_edge_recon_loss: 258609.9833; train_gene_expr_recon_loss: 13000.7281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277436.3743; train_optim_loss: 277436.3743; val_kl_reg_loss: 5750.7416; val_edge_recon_loss: 261913.0841; val_gene_expr_recon_loss: 12922.8271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280586.6537; val_optim_loss: 280586.6537
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9911; val_best_acc_score: 0.9608; val_best_f1_score: 0.9612; train_kl_reg_loss: 5828.1435; train_edge_recon_loss: 258519.3627; train_gene_expr_recon_loss: 13003.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277350.5097; train_optim_loss: 277350.5097; val_kl_reg_loss: 5747.9309; val_edge_recon_loss: 261859.7707; val_gene_expr_recon_loss: 12899.2888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280506.9909; val_optim_loss: 280506.9909
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9920; val_auprc_score: 0.9907; val_best_acc_score: 0.9609; val_best_f1_score: 0.9611; train_kl_reg_loss: 5827.5559; train_edge_recon_loss: 258531.7227; train_gene_expr_recon_loss: 12997.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277356.3054; train_optim_loss: 277356.3054; val_kl_reg_loss: 5754.4380; val_edge_recon_loss: 262059.7749; val_gene_expr_recon_loss: 12901.8987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280716.1111; val_optim_loss: 280716.1111
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9918; val_auprc_score: 0.9903; val_best_acc_score: 0.9607; val_best_f1_score: 0.9610; train_kl_reg_loss: 5826.4278; train_edge_recon_loss: 258572.6542; train_gene_expr_recon_loss: 12998.9144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277397.9964; train_optim_loss: 277397.9964; val_kl_reg_loss: 5753.6341; val_edge_recon_loss: 262214.2419; val_gene_expr_recon_loss: 12914.2610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280882.1364; val_optim_loss: 280882.1364
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9922; val_auprc_score: 0.9912; val_best_acc_score: 0.9610; val_best_f1_score: 0.9612; train_kl_reg_loss: 5828.0770; train_edge_recon_loss: 258526.7429; train_gene_expr_recon_loss: 12997.3392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277352.1589; train_optim_loss: 277352.1589; val_kl_reg_loss: 5759.9433; val_edge_recon_loss: 262085.1268; val_gene_expr_recon_loss: 12918.6784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280763.7477; val_optim_loss: 280763.7477
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9923; val_auprc_score: 0.9912; val_best_acc_score: 0.9613; val_best_f1_score: 0.9615; train_kl_reg_loss: 5827.5474; train_edge_recon_loss: 258537.1036; train_gene_expr_recon_loss: 13001.9371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277366.5877; train_optim_loss: 277366.5877; val_kl_reg_loss: 5737.4763; val_edge_recon_loss: 261900.7089; val_gene_expr_recon_loss: 12897.4528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280535.6384; val_optim_loss: 280535.6384

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9924; val_auprc_score: 0.9914; val_best_acc_score: 0.9614; val_best_f1_score: 0.9617; train_kl_reg_loss: 5826.3818; train_edge_recon_loss: 258496.9867; train_gene_expr_recon_loss: 12993.8187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277317.1869; train_optim_loss: 277317.1869; val_kl_reg_loss: 5752.1867; val_edge_recon_loss: 261899.8983; val_gene_expr_recon_loss: 12906.7173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280558.8006; val_optim_loss: 280558.8006
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9922; val_auprc_score: 0.9912; val_best_acc_score: 0.9611; val_best_f1_score: 0.9612; train_kl_reg_loss: 5826.1516; train_edge_recon_loss: 258585.1949; train_gene_expr_recon_loss: 12997.7421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277409.0890; train_optim_loss: 277409.0890; val_kl_reg_loss: 5748.5298; val_edge_recon_loss: 262109.5706; val_gene_expr_recon_loss: 12889.9521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280748.0514; val_optim_loss: 280748.0514
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9921; val_auprc_score: 0.9906; val_best_acc_score: 0.9609; val_best_f1_score: 0.9611; train_kl_reg_loss: 5827.6134; train_edge_recon_loss: 258561.0017; train_gene_expr_recon_loss: 12995.6451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277384.2598; train_optim_loss: 277384.2598; val_kl_reg_loss: 5747.3285; val_edge_recon_loss: 262134.3690; val_gene_expr_recon_loss: 12912.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280794.6026; val_optim_loss: 280794.6026
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9921; val_auprc_score: 0.9909; val_best_acc_score: 0.9608; val_best_f1_score: 0.9608; train_kl_reg_loss: 5825.3755; train_edge_recon_loss: 258709.9633; train_gene_expr_recon_loss: 12997.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277533.1864; train_optim_loss: 277533.1864; val_kl_reg_loss: 5748.8206; val_edge_recon_loss: 262082.2112; val_gene_expr_recon_loss: 12904.9051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280735.9361; val_optim_loss: 280735.9361

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 109 min 31 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9922
Val AUPRC score: 0.9910
Val best accuracy score: 0.9611
Val best F1 score: 0.9614
Val gene expr MSE score: 9.3899

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
