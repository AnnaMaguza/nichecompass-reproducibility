None
Run timestamp: 01072023_004851_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9684; val_auprc_score: 0.9653; val_best_acc_score: 0.9103; val_best_f1_score: 0.9120; train_kl_reg_loss: 5554.0968; train_edge_recon_loss: 270128.3744; train_gene_expr_recon_loss: 19394.2313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295076.7025; train_optim_loss: 295076.7025; val_kl_reg_loss: 5583.2956; val_edge_recon_loss: 266536.5744; val_gene_expr_recon_loss: 17167.0296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 289286.8966; val_optim_loss: 289286.8966
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9753; val_auprc_score: 0.9729; val_best_acc_score: 0.9221; val_best_f1_score: 0.9230; train_kl_reg_loss: 5735.2870; train_edge_recon_loss: 262318.1312; train_gene_expr_recon_loss: 16568.2123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 284621.6315; train_optim_loss: 284621.6315; val_kl_reg_loss: 5574.4996; val_edge_recon_loss: 265589.1815; val_gene_expr_recon_loss: 15993.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 287157.4659; val_optim_loss: 287157.4659
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9787; val_auprc_score: 0.9765; val_best_acc_score: 0.9285; val_best_f1_score: 0.9292; train_kl_reg_loss: 5701.1154; train_edge_recon_loss: 261449.3148; train_gene_expr_recon_loss: 15719.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282869.9938; train_optim_loss: 282869.9938; val_kl_reg_loss: 5526.1595; val_edge_recon_loss: 265008.9062; val_gene_expr_recon_loss: 15304.4993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285839.5636; val_optim_loss: 285839.5636
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9820; val_auprc_score: 0.9799; val_best_acc_score: 0.9350; val_best_f1_score: 0.9355; train_kl_reg_loss: 5693.4519; train_edge_recon_loss: 261074.8808; train_gene_expr_recon_loss: 15197.7039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281966.0376; train_optim_loss: 281966.0376; val_kl_reg_loss: 5556.0218; val_edge_recon_loss: 264383.4006; val_gene_expr_recon_loss: 14994.2158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284933.6398; val_optim_loss: 284933.6398
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9834; val_auprc_score: 0.9820; val_best_acc_score: 0.9372; val_best_f1_score: 0.9377; train_kl_reg_loss: 5684.9224; train_edge_recon_loss: 260962.4107; train_gene_expr_recon_loss: 14820.9568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281468.2889; train_optim_loss: 281468.2889; val_kl_reg_loss: 5474.8283; val_edge_recon_loss: 264360.0511; val_gene_expr_recon_loss: 14543.4129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284378.2932; val_optim_loss: 284378.2932
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9845; val_auprc_score: 0.9830; val_best_acc_score: 0.9403; val_best_f1_score: 0.9410; train_kl_reg_loss: 5697.6859; train_edge_recon_loss: 260496.2062; train_gene_expr_recon_loss: 14536.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280730.4604; train_optim_loss: 280730.4604; val_kl_reg_loss: 5493.9138; val_edge_recon_loss: 264150.8991; val_gene_expr_recon_loss: 14224.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283869.1199; val_optim_loss: 283869.1199
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9848; val_auprc_score: 0.9835; val_best_acc_score: 0.9406; val_best_f1_score: 0.9411; train_kl_reg_loss: 5709.2796; train_edge_recon_loss: 260398.7488; train_gene_expr_recon_loss: 14314.6557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280422.6839; train_optim_loss: 280422.6839; val_kl_reg_loss: 5719.9011; val_edge_recon_loss: 264070.5315; val_gene_expr_recon_loss: 14132.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283922.6216; val_optim_loss: 283922.6216
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9841; val_best_acc_score: 0.9428; val_best_f1_score: 0.9433; train_kl_reg_loss: 5710.5195; train_edge_recon_loss: 260462.0310; train_gene_expr_recon_loss: 14143.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280316.4642; train_optim_loss: 280316.4642; val_kl_reg_loss: 5580.7134; val_edge_recon_loss: 263884.2659; val_gene_expr_recon_loss: 13926.2243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283391.2017; val_optim_loss: 283391.2017
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9859; val_auprc_score: 0.9844; val_best_acc_score: 0.9432; val_best_f1_score: 0.9439; train_kl_reg_loss: 5722.5042; train_edge_recon_loss: 260230.9573; train_gene_expr_recon_loss: 14005.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279958.8508; train_optim_loss: 279958.8508; val_kl_reg_loss: 5517.3176; val_edge_recon_loss: 264056.2017; val_gene_expr_recon_loss: 13780.8086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283354.3295; val_optim_loss: 283354.3295
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9860; val_auprc_score: 0.9843; val_best_acc_score: 0.9444; val_best_f1_score: 0.9449; train_kl_reg_loss: 5730.8975; train_edge_recon_loss: 259991.6438; train_gene_expr_recon_loss: 13892.8213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279615.3619; train_optim_loss: 279615.3619; val_kl_reg_loss: 5545.5150; val_edge_recon_loss: 263941.5247; val_gene_expr_recon_loss: 13715.6097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283202.6483; val_optim_loss: 283202.6483
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9877; val_auprc_score: 0.9865; val_best_acc_score: 0.9473; val_best_f1_score: 0.9478; train_kl_reg_loss: 5736.6095; train_edge_recon_loss: 259975.7662; train_gene_expr_recon_loss: 13806.0624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279518.4388; train_optim_loss: 279518.4388; val_kl_reg_loss: 5649.6116; val_edge_recon_loss: 263317.6168; val_gene_expr_recon_loss: 13659.4940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282626.7227; val_optim_loss: 282626.7227
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9877; val_auprc_score: 0.9864; val_best_acc_score: 0.9473; val_best_f1_score: 0.9478; train_kl_reg_loss: 5747.8492; train_edge_recon_loss: 259928.9056; train_gene_expr_recon_loss: 13720.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279397.3810; train_optim_loss: 279397.3810; val_kl_reg_loss: 5663.4844; val_edge_recon_loss: 263254.8366; val_gene_expr_recon_loss: 13551.7559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282470.0790; val_optim_loss: 282470.0790
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9875; val_auprc_score: 0.9862; val_best_acc_score: 0.9483; val_best_f1_score: 0.9487; train_kl_reg_loss: 5758.9571; train_edge_recon_loss: 259804.0541; train_gene_expr_recon_loss: 13649.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279212.4169; train_optim_loss: 279212.4169; val_kl_reg_loss: 5681.2561; val_edge_recon_loss: 263575.2966; val_gene_expr_recon_loss: 13514.7127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282771.2665; val_optim_loss: 282771.2665
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9870; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 5764.9696; train_edge_recon_loss: 259712.2513; train_gene_expr_recon_loss: 13582.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279059.3185; train_optim_loss: 279059.3185; val_kl_reg_loss: 5696.6211; val_edge_recon_loss: 263325.3432; val_gene_expr_recon_loss: 13418.8748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282440.8403; val_optim_loss: 282440.8403
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9880; val_auprc_score: 0.9866; val_best_acc_score: 0.9486; val_best_f1_score: 0.9490; train_kl_reg_loss: 5774.0823; train_edge_recon_loss: 259674.0382; train_gene_expr_recon_loss: 13522.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278970.2524; train_optim_loss: 278970.2524; val_kl_reg_loss: 5664.5574; val_edge_recon_loss: 263144.9787; val_gene_expr_recon_loss: 13370.2376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282179.7722; val_optim_loss: 282179.7722
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9883; val_auprc_score: 0.9871; val_best_acc_score: 0.9495; val_best_f1_score: 0.9499; train_kl_reg_loss: 5780.3067; train_edge_recon_loss: 259587.8935; train_gene_expr_recon_loss: 13479.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278847.5292; train_optim_loss: 278847.5292; val_kl_reg_loss: 5731.6554; val_edge_recon_loss: 263387.2179; val_gene_expr_recon_loss: 13311.2789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282430.1534; val_optim_loss: 282430.1534
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9884; val_auprc_score: 0.9869; val_best_acc_score: 0.9505; val_best_f1_score: 0.9508; train_kl_reg_loss: 5788.1634; train_edge_recon_loss: 259563.4090; train_gene_expr_recon_loss: 13421.8377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278773.4107; train_optim_loss: 278773.4107; val_kl_reg_loss: 5783.6329; val_edge_recon_loss: 263560.5293; val_gene_expr_recon_loss: 13285.3184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282629.4835; val_optim_loss: 282629.4835
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9528; val_best_f1_score: 0.9531; train_kl_reg_loss: 5785.8977; train_edge_recon_loss: 259586.1609; train_gene_expr_recon_loss: 13390.7936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278762.8518; train_optim_loss: 278762.8518; val_kl_reg_loss: 5702.1870; val_edge_recon_loss: 262812.7355; val_gene_expr_recon_loss: 13239.8706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281754.7949; val_optim_loss: 281754.7949
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9889; val_auprc_score: 0.9877; val_best_acc_score: 0.9516; val_best_f1_score: 0.9520; train_kl_reg_loss: 5799.6465; train_edge_recon_loss: 259555.2433; train_gene_expr_recon_loss: 13349.9012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278704.7911; train_optim_loss: 278704.7911; val_kl_reg_loss: 5695.4293; val_edge_recon_loss: 263286.5943; val_gene_expr_recon_loss: 13206.6993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282188.7244; val_optim_loss: 282188.7244
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9892; val_auprc_score: 0.9878; val_best_acc_score: 0.9529; val_best_f1_score: 0.9534; train_kl_reg_loss: 5802.2963; train_edge_recon_loss: 259395.0760; train_gene_expr_recon_loss: 13311.8502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278509.2224; train_optim_loss: 278509.2224; val_kl_reg_loss: 5837.5932; val_edge_recon_loss: 263375.6588; val_gene_expr_recon_loss: 13153.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282366.3199; val_optim_loss: 282366.3199
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9899; val_auprc_score: 0.9885; val_best_acc_score: 0.9551; val_best_f1_score: 0.9554; train_kl_reg_loss: 5802.6720; train_edge_recon_loss: 259358.5098; train_gene_expr_recon_loss: 13284.4553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278445.6371; train_optim_loss: 278445.6371; val_kl_reg_loss: 5570.7016; val_edge_recon_loss: 262994.5364; val_gene_expr_recon_loss: 13141.7205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281706.9585; val_optim_loss: 281706.9585
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9896; val_auprc_score: 0.9880; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 5810.3826; train_edge_recon_loss: 259406.4930; train_gene_expr_recon_loss: 13256.5338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278473.4094; train_optim_loss: 278473.4094; val_kl_reg_loss: 5549.7985; val_edge_recon_loss: 263095.1173; val_gene_expr_recon_loss: 13133.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281777.9767; val_optim_loss: 281777.9767
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9898; val_auprc_score: 0.9887; val_best_acc_score: 0.9542; val_best_f1_score: 0.9544; train_kl_reg_loss: 5816.0244; train_edge_recon_loss: 259284.3515; train_gene_expr_recon_loss: 13235.2853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278335.6613; train_optim_loss: 278335.6613; val_kl_reg_loss: 5755.8273; val_edge_recon_loss: 263212.1469; val_gene_expr_recon_loss: 13092.7574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282060.7301; val_optim_loss: 282060.7301
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9903; val_auprc_score: 0.9889; val_best_acc_score: 0.9552; val_best_f1_score: 0.9553; train_kl_reg_loss: 5816.8375; train_edge_recon_loss: 259231.5920; train_gene_expr_recon_loss: 13209.7881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278258.2172; train_optim_loss: 278258.2172; val_kl_reg_loss: 5633.2111; val_edge_recon_loss: 262855.6128; val_gene_expr_recon_loss: 13099.7964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281588.6176; val_optim_loss: 281588.6176
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9559; val_best_f1_score: 0.9562; train_kl_reg_loss: 5824.2068; train_edge_recon_loss: 259234.1993; train_gene_expr_recon_loss: 13195.6232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278254.0288; train_optim_loss: 278254.0288; val_kl_reg_loss: 5680.8640; val_edge_recon_loss: 262996.7938; val_gene_expr_recon_loss: 13072.9334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281750.5920; val_optim_loss: 281750.5920
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9538; val_best_f1_score: 0.9539; train_kl_reg_loss: 5826.3804; train_edge_recon_loss: 259199.3971; train_gene_expr_recon_loss: 13173.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278198.8544; train_optim_loss: 278198.8544; val_kl_reg_loss: 5822.3199; val_edge_recon_loss: 262888.1696; val_gene_expr_recon_loss: 13028.8755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281739.3636; val_optim_loss: 281739.3636
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9906; val_auprc_score: 0.9894; val_best_acc_score: 0.9571; val_best_f1_score: 0.9574; train_kl_reg_loss: 5826.1407; train_edge_recon_loss: 259206.9266; train_gene_expr_recon_loss: 13157.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278190.3066; train_optim_loss: 278190.3066; val_kl_reg_loss: 5696.7279; val_edge_recon_loss: 262600.3574; val_gene_expr_recon_loss: 13015.6728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281312.7597; val_optim_loss: 281312.7597
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9900; val_auprc_score: 0.9886; val_best_acc_score: 0.9555; val_best_f1_score: 0.9557; train_kl_reg_loss: 5832.1848; train_edge_recon_loss: 259188.9290; train_gene_expr_recon_loss: 13140.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278161.5174; train_optim_loss: 278161.5174; val_kl_reg_loss: 5815.9456; val_edge_recon_loss: 262980.3401; val_gene_expr_recon_loss: 13010.2200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281806.5062; val_optim_loss: 281806.5062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9907; val_auprc_score: 0.9897; val_best_acc_score: 0.9566; val_best_f1_score: 0.9568; train_kl_reg_loss: 5834.9584; train_edge_recon_loss: 259035.0330; train_gene_expr_recon_loss: 13131.8959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278001.8868; train_optim_loss: 278001.8868; val_kl_reg_loss: 5688.9384; val_edge_recon_loss: 262753.4943; val_gene_expr_recon_loss: 12986.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281429.0273; val_optim_loss: 281429.0273
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9907; val_auprc_score: 0.9896; val_best_acc_score: 0.9561; val_best_f1_score: 0.9564; train_kl_reg_loss: 5837.5431; train_edge_recon_loss: 259106.0939; train_gene_expr_recon_loss: 13114.4717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278058.1085; train_optim_loss: 278058.1085; val_kl_reg_loss: 5686.0565; val_edge_recon_loss: 262731.0000; val_gene_expr_recon_loss: 12970.9705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281388.0273; val_optim_loss: 281388.0273
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9907; val_auprc_score: 0.9895; val_best_acc_score: 0.9567; val_best_f1_score: 0.9569; train_kl_reg_loss: 5841.0214; train_edge_recon_loss: 258989.4709; train_gene_expr_recon_loss: 13105.6682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277936.1603; train_optim_loss: 277936.1603; val_kl_reg_loss: 5778.6602; val_edge_recon_loss: 262825.0523; val_gene_expr_recon_loss: 12957.5224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281561.2352; val_optim_loss: 281561.2352

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9915; val_auprc_score: 0.9905; val_best_acc_score: 0.9587; val_best_f1_score: 0.9590; train_kl_reg_loss: 5836.6090; train_edge_recon_loss: 258779.5694; train_gene_expr_recon_loss: 13037.2884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277653.4667; train_optim_loss: 277653.4667; val_kl_reg_loss: 5687.9955; val_edge_recon_loss: 262384.6028; val_gene_expr_recon_loss: 12912.7205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280985.3199; val_optim_loss: 280985.3199
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9915; val_auprc_score: 0.9903; val_best_acc_score: 0.9582; val_best_f1_score: 0.9584; train_kl_reg_loss: 5828.8587; train_edge_recon_loss: 258798.4581; train_gene_expr_recon_loss: 13021.8522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277649.1691; train_optim_loss: 277649.1691; val_kl_reg_loss: 5753.5449; val_edge_recon_loss: 262369.0875; val_gene_expr_recon_loss: 12889.7444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281012.3744; val_optim_loss: 281012.3744
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9916; val_auprc_score: 0.9905; val_best_acc_score: 0.9591; val_best_f1_score: 0.9594; train_kl_reg_loss: 5826.6865; train_edge_recon_loss: 258768.6926; train_gene_expr_recon_loss: 13016.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277611.5503; train_optim_loss: 277611.5503; val_kl_reg_loss: 5772.7167; val_edge_recon_loss: 262215.3108; val_gene_expr_recon_loss: 12889.2145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280877.2415; val_optim_loss: 280877.2415
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9915; val_auprc_score: 0.9904; val_best_acc_score: 0.9589; val_best_f1_score: 0.9592; train_kl_reg_loss: 5826.2432; train_edge_recon_loss: 258625.7817; train_gene_expr_recon_loss: 13004.9489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277456.9738; train_optim_loss: 277456.9738; val_kl_reg_loss: 5728.9231; val_edge_recon_loss: 262352.8259; val_gene_expr_recon_loss: 12883.5236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280965.2722; val_optim_loss: 280965.2722
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9918; val_auprc_score: 0.9906; val_best_acc_score: 0.9596; val_best_f1_score: 0.9600; train_kl_reg_loss: 5821.0843; train_edge_recon_loss: 258673.8620; train_gene_expr_recon_loss: 13008.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277503.2864; train_optim_loss: 277503.2864; val_kl_reg_loss: 5706.0487; val_edge_recon_loss: 262348.5065; val_gene_expr_recon_loss: 12879.6547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280934.2091; val_optim_loss: 280934.2091
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9917; val_auprc_score: 0.9906; val_best_acc_score: 0.9596; val_best_f1_score: 0.9598; train_kl_reg_loss: 5824.0198; train_edge_recon_loss: 258613.2025; train_gene_expr_recon_loss: 12997.5896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277434.8112; train_optim_loss: 277434.8112; val_kl_reg_loss: 5713.6891; val_edge_recon_loss: 262082.8937; val_gene_expr_recon_loss: 12875.7019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280672.2847; val_optim_loss: 280672.2847
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9918; val_auprc_score: 0.9906; val_best_acc_score: 0.9597; val_best_f1_score: 0.9599; train_kl_reg_loss: 5818.9819; train_edge_recon_loss: 258665.7046; train_gene_expr_recon_loss: 12996.1923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277480.8792; train_optim_loss: 277480.8792; val_kl_reg_loss: 5729.4248; val_edge_recon_loss: 262114.4497; val_gene_expr_recon_loss: 12876.4709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280720.3455; val_optim_loss: 280720.3455
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9914; val_auprc_score: 0.9902; val_best_acc_score: 0.9592; val_best_f1_score: 0.9595; train_kl_reg_loss: 5817.9007; train_edge_recon_loss: 258712.5262; train_gene_expr_recon_loss: 12992.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277523.4096; train_optim_loss: 277523.4096; val_kl_reg_loss: 5702.5402; val_edge_recon_loss: 262356.8412; val_gene_expr_recon_loss: 12867.3498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280926.7295; val_optim_loss: 280926.7295
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9919; val_auprc_score: 0.9909; val_best_acc_score: 0.9596; val_best_f1_score: 0.9598; train_kl_reg_loss: 5818.1462; train_edge_recon_loss: 258622.1442; train_gene_expr_recon_loss: 12988.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277428.2958; train_optim_loss: 277428.2958; val_kl_reg_loss: 5757.6211; val_edge_recon_loss: 262339.2898; val_gene_expr_recon_loss: 12868.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280965.6875; val_optim_loss: 280965.6875
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9918; val_auprc_score: 0.9906; val_best_acc_score: 0.9598; val_best_f1_score: 0.9600; train_kl_reg_loss: 5815.7447; train_edge_recon_loss: 258665.0055; train_gene_expr_recon_loss: 12982.9360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277463.6867; train_optim_loss: 277463.6867; val_kl_reg_loss: 5757.4027; val_edge_recon_loss: 262226.2750; val_gene_expr_recon_loss: 12875.3383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280859.0142; val_optim_loss: 280859.0142

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9919; val_auprc_score: 0.9908; val_best_acc_score: 0.9607; val_best_f1_score: 0.9610; train_kl_reg_loss: 5817.0417; train_edge_recon_loss: 258671.4319; train_gene_expr_recon_loss: 12977.4726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277465.9455; train_optim_loss: 277465.9455; val_kl_reg_loss: 5733.1343; val_edge_recon_loss: 261977.4639; val_gene_expr_recon_loss: 12860.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280571.5540; val_optim_loss: 280571.5540
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9922; val_auprc_score: 0.9912; val_best_acc_score: 0.9607; val_best_f1_score: 0.9611; train_kl_reg_loss: 5811.4902; train_edge_recon_loss: 258691.0496; train_gene_expr_recon_loss: 12976.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277479.1400; train_optim_loss: 277479.1400; val_kl_reg_loss: 5737.8052; val_edge_recon_loss: 261917.8722; val_gene_expr_recon_loss: 12859.6012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280515.2778; val_optim_loss: 280515.2778
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9915; val_auprc_score: 0.9903; val_best_acc_score: 0.9599; val_best_f1_score: 0.9601; train_kl_reg_loss: 5810.9357; train_edge_recon_loss: 258716.1133; train_gene_expr_recon_loss: 12976.5524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277503.6013; train_optim_loss: 277503.6013; val_kl_reg_loss: 5722.8109; val_edge_recon_loss: 262235.8497; val_gene_expr_recon_loss: 12856.3235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280814.9864; val_optim_loss: 280814.9864
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9920; val_auprc_score: 0.9909; val_best_acc_score: 0.9599; val_best_f1_score: 0.9602; train_kl_reg_loss: 5813.8646; train_edge_recon_loss: 258616.7714; train_gene_expr_recon_loss: 12981.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277411.7297; train_optim_loss: 277411.7297; val_kl_reg_loss: 5733.7814; val_edge_recon_loss: 262401.9179; val_gene_expr_recon_loss: 12856.4459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280992.1460; val_optim_loss: 280992.1460
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9921; val_auprc_score: 0.9912; val_best_acc_score: 0.9603; val_best_f1_score: 0.9605; train_kl_reg_loss: 5814.0448; train_edge_recon_loss: 258547.8196; train_gene_expr_recon_loss: 12973.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277334.9302; train_optim_loss: 277334.9302; val_kl_reg_loss: 5730.4408; val_edge_recon_loss: 262006.1707; val_gene_expr_recon_loss: 12859.6602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280596.2710; val_optim_loss: 280596.2710
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9916; val_auprc_score: 0.9904; val_best_acc_score: 0.9591; val_best_f1_score: 0.9595; train_kl_reg_loss: 5811.6670; train_edge_recon_loss: 258663.0011; train_gene_expr_recon_loss: 12974.1454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277448.8135; train_optim_loss: 277448.8135; val_kl_reg_loss: 5723.6708; val_edge_recon_loss: 262432.8815; val_gene_expr_recon_loss: 12848.3764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281004.9284; val_optim_loss: 281004.9284

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9916; val_auprc_score: 0.9904; val_best_acc_score: 0.9603; val_best_f1_score: 0.9605; train_kl_reg_loss: 5808.4673; train_edge_recon_loss: 258661.5102; train_gene_expr_recon_loss: 12978.0927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277448.0698; train_optim_loss: 277448.0698; val_kl_reg_loss: 5724.4382; val_edge_recon_loss: 262250.3940; val_gene_expr_recon_loss: 12860.5355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280835.3710; val_optim_loss: 280835.3710
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9919; val_auprc_score: 0.9910; val_best_acc_score: 0.9599; val_best_f1_score: 0.9601; train_kl_reg_loss: 5809.9362; train_edge_recon_loss: 258581.8737; train_gene_expr_recon_loss: 12977.4118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277369.2217; train_optim_loss: 277369.2217; val_kl_reg_loss: 5724.7886; val_edge_recon_loss: 262169.1713; val_gene_expr_recon_loss: 12838.7398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280732.6994; val_optim_loss: 280732.6994
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9917; val_auprc_score: 0.9905; val_best_acc_score: 0.9600; val_best_f1_score: 0.9603; train_kl_reg_loss: 5812.8273; train_edge_recon_loss: 258580.9687; train_gene_expr_recon_loss: 12977.8450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277371.6420; train_optim_loss: 277371.6420; val_kl_reg_loss: 5726.9101; val_edge_recon_loss: 262258.1574; val_gene_expr_recon_loss: 12859.9313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280844.9972; val_optim_loss: 280844.9972
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9922; val_auprc_score: 0.9910; val_best_acc_score: 0.9606; val_best_f1_score: 0.9608; train_kl_reg_loss: 5812.8863; train_edge_recon_loss: 258611.9951; train_gene_expr_recon_loss: 12976.3026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277401.1837; train_optim_loss: 277401.1837; val_kl_reg_loss: 5724.2575; val_edge_recon_loss: 262258.1148; val_gene_expr_recon_loss: 12850.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280832.5716; val_optim_loss: 280832.5716

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 105 min 12 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9920
Val AUPRC score: 0.9910
Val best accuracy score: 0.9603
Val best F1 score: 0.9605
Val gene expr MSE score: 9.2954

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
