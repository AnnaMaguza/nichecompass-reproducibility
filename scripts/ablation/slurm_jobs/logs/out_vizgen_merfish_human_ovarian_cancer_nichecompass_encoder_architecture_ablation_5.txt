None
Run timestamp: 05082023_081533_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '2', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--n_sampled_neighbors', '4', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 2, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9805; val_auprc_score: 0.9792; val_best_acc_score: 0.9314; val_best_f1_score: 0.9321; train_kl_reg_loss: 7872.6077; train_edge_recon_loss: 266438.0986; train_gene_expr_recon_loss: 194821.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 469132.5095; train_optim_loss: 469132.5095; val_kl_reg_loss: 7215.5275; val_edge_recon_loss: 267766.7094; val_gene_expr_recon_loss: 179922.9861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454905.2236; val_optim_loss: 454905.2236
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9837; val_auprc_score: 0.9826; val_best_acc_score: 0.9370; val_best_f1_score: 0.9375; train_kl_reg_loss: 7010.2025; train_edge_recon_loss: 262564.6991; train_gene_expr_recon_loss: 177376.6413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446951.5428; train_optim_loss: 446951.5428; val_kl_reg_loss: 6876.5811; val_edge_recon_loss: 266430.5526; val_gene_expr_recon_loss: 175780.7799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449087.9142; val_optim_loss: 449087.9142
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9843; val_auprc_score: 0.9829; val_best_acc_score: 0.9386; val_best_f1_score: 0.9393; train_kl_reg_loss: 6815.8825; train_edge_recon_loss: 261678.4786; train_gene_expr_recon_loss: 174652.5237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443146.8847; train_optim_loss: 443146.8847; val_kl_reg_loss: 6798.7123; val_edge_recon_loss: 265890.0313; val_gene_expr_recon_loss: 173882.9132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446571.6565; val_optim_loss: 446571.6565
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9852; val_auprc_score: 0.9836; val_best_acc_score: 0.9415; val_best_f1_score: 0.9424; train_kl_reg_loss: 6720.1267; train_edge_recon_loss: 261007.6744; train_gene_expr_recon_loss: 173599.7364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441327.5374; train_optim_loss: 441327.5374; val_kl_reg_loss: 6632.2458; val_edge_recon_loss: 265549.4587; val_gene_expr_recon_loss: 173369.1002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445550.8055; val_optim_loss: 445550.8055
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9864; val_auprc_score: 0.9851; val_best_acc_score: 0.9446; val_best_f1_score: 0.9449; train_kl_reg_loss: 6617.2382; train_edge_recon_loss: 260788.8176; train_gene_expr_recon_loss: 172859.2145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440265.2705; train_optim_loss: 440265.2705; val_kl_reg_loss: 6640.6557; val_edge_recon_loss: 265085.9026; val_gene_expr_recon_loss: 173251.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444977.6168; val_optim_loss: 444977.6168
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9865; val_auprc_score: 0.9849; val_best_acc_score: 0.9446; val_best_f1_score: 0.9451; train_kl_reg_loss: 6493.9361; train_edge_recon_loss: 260469.1691; train_gene_expr_recon_loss: 172518.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439481.4190; train_optim_loss: 439481.4190; val_kl_reg_loss: 6673.3981; val_edge_recon_loss: 264838.6738; val_gene_expr_recon_loss: 173397.3760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444909.4486; val_optim_loss: 444909.4486
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9868; val_auprc_score: 0.9852; val_best_acc_score: 0.9456; val_best_f1_score: 0.9462; train_kl_reg_loss: 6345.2552; train_edge_recon_loss: 260153.5113; train_gene_expr_recon_loss: 172159.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438658.0380; train_optim_loss: 438658.0380; val_kl_reg_loss: 7001.4117; val_edge_recon_loss: 264542.8519; val_gene_expr_recon_loss: 173033.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444577.8977; val_optim_loss: 444577.8977
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9880; val_auprc_score: 0.9867; val_best_acc_score: 0.9482; val_best_f1_score: 0.9487; train_kl_reg_loss: 6233.9492; train_edge_recon_loss: 259934.9837; train_gene_expr_recon_loss: 171877.5058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438046.4387; train_optim_loss: 438046.4387; val_kl_reg_loss: 6819.8657; val_edge_recon_loss: 264227.8071; val_gene_expr_recon_loss: 172519.4315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443567.1046; val_optim_loss: 443567.1046
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9880; val_auprc_score: 0.9865; val_best_acc_score: 0.9488; val_best_f1_score: 0.9494; train_kl_reg_loss: 6183.3837; train_edge_recon_loss: 259917.2786; train_gene_expr_recon_loss: 171690.0771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437790.7394; train_optim_loss: 437790.7394; val_kl_reg_loss: 6682.4641; val_edge_recon_loss: 264163.1228; val_gene_expr_recon_loss: 172325.5189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443171.1073; val_optim_loss: 443171.1073
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9881; val_auprc_score: 0.9868; val_best_acc_score: 0.9496; val_best_f1_score: 0.9500; train_kl_reg_loss: 6143.1279; train_edge_recon_loss: 259690.3559; train_gene_expr_recon_loss: 171519.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437353.2008; train_optim_loss: 437353.2008; val_kl_reg_loss: 6884.7447; val_edge_recon_loss: 264042.8848; val_gene_expr_recon_loss: 172123.7791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443051.4091; val_optim_loss: 443051.4091
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9883; val_auprc_score: 0.9868; val_best_acc_score: 0.9493; val_best_f1_score: 0.9497; train_kl_reg_loss: 6130.1969; train_edge_recon_loss: 259584.4535; train_gene_expr_recon_loss: 171334.2495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437048.8998; train_optim_loss: 437048.8998; val_kl_reg_loss: 6581.3901; val_edge_recon_loss: 263810.8847; val_gene_expr_recon_loss: 172176.8431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442569.1174; val_optim_loss: 442569.1174
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9883; val_auprc_score: 0.9869; val_best_acc_score: 0.9494; val_best_f1_score: 0.9498; train_kl_reg_loss: 6116.3159; train_edge_recon_loss: 259620.3180; train_gene_expr_recon_loss: 171121.9751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436858.6092; train_optim_loss: 436858.6092; val_kl_reg_loss: 6617.4706; val_edge_recon_loss: 263800.3363; val_gene_expr_recon_loss: 171837.3260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442255.1323; val_optim_loss: 442255.1323
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9883; val_auprc_score: 0.9870; val_best_acc_score: 0.9498; val_best_f1_score: 0.9501; train_kl_reg_loss: 6108.8328; train_edge_recon_loss: 259401.1102; train_gene_expr_recon_loss: 170995.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436505.1284; train_optim_loss: 436505.1284; val_kl_reg_loss: 6957.2164; val_edge_recon_loss: 264164.6674; val_gene_expr_recon_loss: 171915.2392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443037.1223; val_optim_loss: 443037.1223
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9888; val_auprc_score: 0.9875; val_best_acc_score: 0.9517; val_best_f1_score: 0.9521; train_kl_reg_loss: 6067.6713; train_edge_recon_loss: 259454.9365; train_gene_expr_recon_loss: 170899.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436422.4459; train_optim_loss: 436422.4459; val_kl_reg_loss: 6634.8325; val_edge_recon_loss: 263443.6731; val_gene_expr_recon_loss: 172014.1151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442092.6201; val_optim_loss: 442092.6201
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9886; val_auprc_score: 0.9868; val_best_acc_score: 0.9513; val_best_f1_score: 0.9518; train_kl_reg_loss: 6069.5797; train_edge_recon_loss: 259283.3911; train_gene_expr_recon_loss: 170812.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436165.5055; train_optim_loss: 436165.5055; val_kl_reg_loss: 11403735539219452.0000; val_edge_recon_loss: 263308.0537; val_gene_expr_recon_loss: 174207.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11403735539651146.0000; val_optim_loss: 11403735539651146.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9884; val_auprc_score: 0.9871; val_best_acc_score: 0.9500; val_best_f1_score: 0.9503; train_kl_reg_loss: 6069.6450; train_edge_recon_loss: 259088.8575; train_gene_expr_recon_loss: 170695.8589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435854.3615; train_optim_loss: 435854.3615; val_kl_reg_loss: 6528.6979; val_edge_recon_loss: 263936.2133; val_gene_expr_recon_loss: 172921.0163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443385.9276; val_optim_loss: 443385.9276
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9892; val_auprc_score: 0.9874; val_best_acc_score: 0.9519; val_best_f1_score: 0.9523; train_kl_reg_loss: 6152.0396; train_edge_recon_loss: 259250.3098; train_gene_expr_recon_loss: 170679.7457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436082.0951; train_optim_loss: 436082.0951; val_kl_reg_loss: 6482.9092; val_edge_recon_loss: 263440.2596; val_gene_expr_recon_loss: 171834.9745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441758.1431; val_optim_loss: 441758.1431
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9886; val_auprc_score: 0.9869; val_best_acc_score: 0.9518; val_best_f1_score: 0.9522; train_kl_reg_loss: 6056.4537; train_edge_recon_loss: 259122.3944; train_gene_expr_recon_loss: 170574.0296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435752.8777; train_optim_loss: 435752.8777; val_kl_reg_loss: 6869.1827; val_edge_recon_loss: 263425.1266; val_gene_expr_recon_loss: 173658.5049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443952.8139; val_optim_loss: 443952.8139
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9889; val_auprc_score: 0.9873; val_best_acc_score: 0.9520; val_best_f1_score: 0.9523; train_kl_reg_loss: 6041.7985; train_edge_recon_loss: 259044.5099; train_gene_expr_recon_loss: 170507.1385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435593.4470; train_optim_loss: 435593.4470; val_kl_reg_loss: 6761.8804; val_edge_recon_loss: 263369.0393; val_gene_expr_recon_loss: 173483.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443614.1298; val_optim_loss: 443614.1298
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9892; val_auprc_score: 0.9881; val_best_acc_score: 0.9520; val_best_f1_score: 0.9526; train_kl_reg_loss: 6048.3156; train_edge_recon_loss: 259107.1133; train_gene_expr_recon_loss: 170450.9518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435606.3807; train_optim_loss: 435606.3807; val_kl_reg_loss: 6752.7732; val_edge_recon_loss: 263163.6680; val_gene_expr_recon_loss: 174713.2537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444629.6947; val_optim_loss: 444629.6947
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9896; val_auprc_score: 0.9881; val_best_acc_score: 0.9543; val_best_f1_score: 0.9546; train_kl_reg_loss: 6057.2743; train_edge_recon_loss: 259098.3072; train_gene_expr_recon_loss: 170394.5563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435550.1378; train_optim_loss: 435550.1378; val_kl_reg_loss: 6480.6660; val_edge_recon_loss: 263072.0814; val_gene_expr_recon_loss: 172186.1748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441738.9221; val_optim_loss: 441738.9221
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9890; val_auprc_score: 0.9874; val_best_acc_score: 0.9529; val_best_f1_score: 0.9532; train_kl_reg_loss: 6046.2729; train_edge_recon_loss: 259044.0820; train_gene_expr_recon_loss: 170343.2421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435433.5971; train_optim_loss: 435433.5971; val_kl_reg_loss: 6822.3942; val_edge_recon_loss: 263365.3726; val_gene_expr_recon_loss: 174042.8754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444230.6422; val_optim_loss: 444230.6422
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9895; val_auprc_score: 0.9881; val_best_acc_score: 0.9538; val_best_f1_score: 0.9541; train_kl_reg_loss: 6034.1924; train_edge_recon_loss: 258924.6002; train_gene_expr_recon_loss: 170293.1439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435251.9368; train_optim_loss: 435251.9368; val_kl_reg_loss: 6941.5052; val_edge_recon_loss: 263008.9829; val_gene_expr_recon_loss: 175754.4325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445704.9201; val_optim_loss: 445704.9201
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9893; val_auprc_score: 0.9876; val_best_acc_score: 0.9537; val_best_f1_score: 0.9539; train_kl_reg_loss: 6029.2977; train_edge_recon_loss: 258963.4003; train_gene_expr_recon_loss: 170242.0515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435234.7498; train_optim_loss: 435234.7498; val_kl_reg_loss: 6440.2722; val_edge_recon_loss: 263148.0149; val_gene_expr_recon_loss: 171863.2149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441451.5015; val_optim_loss: 441451.5015
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9900; val_auprc_score: 0.9887; val_best_acc_score: 0.9550; val_best_f1_score: 0.9552; train_kl_reg_loss: 6036.4210; train_edge_recon_loss: 258874.4609; train_gene_expr_recon_loss: 170156.5755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435067.4575; train_optim_loss: 435067.4575; val_kl_reg_loss: 3484381393968.3530; val_edge_recon_loss: 262746.5545; val_gene_expr_recon_loss: 172368.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3484381826225.1914; val_optim_loss: 3484381826225.1914
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9897; val_auprc_score: 0.9885; val_best_acc_score: 0.9537; val_best_f1_score: 0.9541; train_kl_reg_loss: 6044.4450; train_edge_recon_loss: 258828.9300; train_gene_expr_recon_loss: 170161.4075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435034.7825; train_optim_loss: 435034.7825; val_kl_reg_loss: 6716.9466; val_edge_recon_loss: 262888.4606; val_gene_expr_recon_loss: 174169.9927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443775.4003; val_optim_loss: 443775.4003
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9895; val_auprc_score: 0.9881; val_best_acc_score: 0.9532; val_best_f1_score: 0.9536; train_kl_reg_loss: 6058.7171; train_edge_recon_loss: 258875.6963; train_gene_expr_recon_loss: 170077.2551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435011.6684; train_optim_loss: 435011.6684; val_kl_reg_loss: 6731.0560; val_edge_recon_loss: 262770.5209; val_gene_expr_recon_loss: 172842.1330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442343.7102; val_optim_loss: 442343.7102
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9885; val_best_acc_score: 0.9550; val_best_f1_score: 0.9551; train_kl_reg_loss: 6041.1192; train_edge_recon_loss: 258813.8821; train_gene_expr_recon_loss: 170114.0261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434969.0277; train_optim_loss: 434969.0277; val_kl_reg_loss: 6647.6242; val_edge_recon_loss: 262783.8494; val_gene_expr_recon_loss: 172246.6939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441678.1670; val_optim_loss: 441678.1670

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9904; val_auprc_score: 0.9889; val_best_acc_score: 0.9565; val_best_f1_score: 0.9567; train_kl_reg_loss: 5986.8345; train_edge_recon_loss: 258594.4643; train_gene_expr_recon_loss: 169127.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433708.9617; train_optim_loss: 433708.9617; val_kl_reg_loss: 11754024898.3047; val_edge_recon_loss: 262570.9698; val_gene_expr_recon_loss: 173608.8647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11754461089.1718; val_optim_loss: 11754461089.1718
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9894; val_best_acc_score: 0.9568; val_best_f1_score: 0.9570; train_kl_reg_loss: 5941.5530; train_edge_recon_loss: 258491.5124; train_gene_expr_recon_loss: 168986.3263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433419.3917; train_optim_loss: 433419.3917; val_kl_reg_loss: 868687844.6141; val_edge_recon_loss: 262287.5567; val_gene_expr_recon_loss: 173330.4842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 869123479.6392; val_optim_loss: 869123479.6392
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.9555; val_best_f1_score: 0.9559; train_kl_reg_loss: 5910.3110; train_edge_recon_loss: 258514.1579; train_gene_expr_recon_loss: 168919.3629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433343.8319; train_optim_loss: 433343.8319; val_kl_reg_loss: 5854680382.1825; val_edge_recon_loss: 262689.3105; val_gene_expr_recon_loss: 173773.2129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855116945.8328; val_optim_loss: 5855116945.8328
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9573; val_best_f1_score: 0.9577; train_kl_reg_loss: 5898.1826; train_edge_recon_loss: 258499.8561; train_gene_expr_recon_loss: 168871.0950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433269.1336; train_optim_loss: 433269.1336; val_kl_reg_loss: 6743.5634; val_edge_recon_loss: 262631.8288; val_gene_expr_recon_loss: 172391.3587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441766.7514; val_optim_loss: 441766.7514

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 167 min 11 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9895
val AUPRC score: 0.9880
val best accuracy score: 0.9535
val best F1 score: 0.9539
val target rna MSE score: 4.1383
val source rna MSE score: 1.0204

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
