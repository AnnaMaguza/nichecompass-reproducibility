None
Run timestamp: 03072023_071446_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9680; val_auprc_score: 0.9675; val_best_acc_score: 0.9106; val_best_f1_score: 0.9109; train_kl_reg_loss: 2286.4499; train_edge_recon_loss: 28896.6752; train_gene_expr_recon_loss: 16611.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47794.2646; train_optim_loss: 47794.2646; val_kl_reg_loss: 2427.7062; val_edge_recon_loss: 27550.5422; val_gene_expr_recon_loss: 14788.1431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44766.3915; val_optim_loss: 44766.3915
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9774; val_auprc_score: 0.9771; val_best_acc_score: 0.9240; val_best_f1_score: 0.9241; train_kl_reg_loss: 2534.9288; train_edge_recon_loss: 27911.8252; train_gene_expr_recon_loss: 14424.2208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44870.9749; train_optim_loss: 44870.9749; val_kl_reg_loss: 2488.4612; val_edge_recon_loss: 27340.8282; val_gene_expr_recon_loss: 13924.3328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43753.6222; val_optim_loss: 43753.6222
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9809; val_auprc_score: 0.9808; val_best_acc_score: 0.9302; val_best_f1_score: 0.9302; train_kl_reg_loss: 2564.8891; train_edge_recon_loss: 27744.3333; train_gene_expr_recon_loss: 13818.1912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44127.4136; train_optim_loss: 44127.4136; val_kl_reg_loss: 2462.1604; val_edge_recon_loss: 27220.8222; val_gene_expr_recon_loss: 13532.6558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43215.6384; val_optim_loss: 43215.6384
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9830; val_auprc_score: 0.9827; val_best_acc_score: 0.9345; val_best_f1_score: 0.9348; train_kl_reg_loss: 2592.2218; train_edge_recon_loss: 27640.5333; train_gene_expr_recon_loss: 13462.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43695.5313; train_optim_loss: 43695.5313; val_kl_reg_loss: 2510.6700; val_edge_recon_loss: 27142.1342; val_gene_expr_recon_loss: 13221.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42873.8205; val_optim_loss: 42873.8205
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9845; val_auprc_score: 0.9839; val_best_acc_score: 0.9381; val_best_f1_score: 0.9383; train_kl_reg_loss: 2612.7520; train_edge_recon_loss: 27573.7064; train_gene_expr_recon_loss: 13218.2775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43404.7358; train_optim_loss: 43404.7358; val_kl_reg_loss: 2570.2440; val_edge_recon_loss: 27095.2942; val_gene_expr_recon_loss: 12991.1212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42656.6596; val_optim_loss: 42656.6596
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9857; val_best_acc_score: 0.9413; val_best_f1_score: 0.9413; train_kl_reg_loss: 2629.6471; train_edge_recon_loss: 27524.3897; train_gene_expr_recon_loss: 13037.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43191.5713; train_optim_loss: 43191.5713; val_kl_reg_loss: 2638.5233; val_edge_recon_loss: 27041.5257; val_gene_expr_recon_loss: 12832.7198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42512.7688; val_optim_loss: 42512.7688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9871; val_auprc_score: 0.9866; val_best_acc_score: 0.9430; val_best_f1_score: 0.9433; train_kl_reg_loss: 2641.6204; train_edge_recon_loss: 27492.5276; train_gene_expr_recon_loss: 12904.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43039.1002; train_optim_loss: 43039.1002; val_kl_reg_loss: 2588.4391; val_edge_recon_loss: 26985.2366; val_gene_expr_recon_loss: 12757.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42331.1804; val_optim_loss: 42331.1804
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9868; val_auprc_score: 0.9861; val_best_acc_score: 0.9445; val_best_f1_score: 0.9449; train_kl_reg_loss: 2651.4841; train_edge_recon_loss: 27458.6817; train_gene_expr_recon_loss: 12804.7501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42914.9159; train_optim_loss: 42914.9159; val_kl_reg_loss: 2651.8550; val_edge_recon_loss: 26988.3224; val_gene_expr_recon_loss: 12659.8643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42300.0416; val_optim_loss: 42300.0416
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9878; val_auprc_score: 0.9874; val_best_acc_score: 0.9462; val_best_f1_score: 0.9464; train_kl_reg_loss: 2663.0744; train_edge_recon_loss: 27424.6224; train_gene_expr_recon_loss: 12727.3054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42815.0023; train_optim_loss: 42815.0023; val_kl_reg_loss: 2606.0478; val_edge_recon_loss: 26988.0754; val_gene_expr_recon_loss: 12557.7615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42151.8847; val_optim_loss: 42151.8847
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9874; val_auprc_score: 0.9869; val_best_acc_score: 0.9446; val_best_f1_score: 0.9449; train_kl_reg_loss: 2675.0569; train_edge_recon_loss: 27383.1354; train_gene_expr_recon_loss: 12660.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42718.7255; train_optim_loss: 42718.7255; val_kl_reg_loss: 2575.1691; val_edge_recon_loss: 26953.8500; val_gene_expr_recon_loss: 12532.2696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42061.2885; val_optim_loss: 42061.2885
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9878; val_auprc_score: 0.9872; val_best_acc_score: 0.9460; val_best_f1_score: 0.9462; train_kl_reg_loss: 2678.9932; train_edge_recon_loss: 27382.5134; train_gene_expr_recon_loss: 12602.7614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42664.2680; train_optim_loss: 42664.2680; val_kl_reg_loss: 2564.0519; val_edge_recon_loss: 26976.1485; val_gene_expr_recon_loss: 12468.0059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42008.2063; val_optim_loss: 42008.2063
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9882; val_auprc_score: 0.9878; val_best_acc_score: 0.9469; val_best_f1_score: 0.9471; train_kl_reg_loss: 2688.0533; train_edge_recon_loss: 27349.6244; train_gene_expr_recon_loss: 12556.3287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42594.0064; train_optim_loss: 42594.0064; val_kl_reg_loss: 2632.7106; val_edge_recon_loss: 26897.8243; val_gene_expr_recon_loss: 12456.6989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41987.2339; val_optim_loss: 41987.2339
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9883; val_auprc_score: 0.9882; val_best_acc_score: 0.9461; val_best_f1_score: 0.9460; train_kl_reg_loss: 2690.9923; train_edge_recon_loss: 27357.5358; train_gene_expr_recon_loss: 12518.0593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42566.5874; train_optim_loss: 42566.5874; val_kl_reg_loss: 2669.2742; val_edge_recon_loss: 26897.2110; val_gene_expr_recon_loss: 12408.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41974.6582; val_optim_loss: 41974.6582
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9887; val_auprc_score: 0.9882; val_best_acc_score: 0.9482; val_best_f1_score: 0.9484; train_kl_reg_loss: 2699.2986; train_edge_recon_loss: 27331.8945; train_gene_expr_recon_loss: 12478.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42509.7374; train_optim_loss: 42509.7374; val_kl_reg_loss: 2640.9367; val_edge_recon_loss: 26862.7343; val_gene_expr_recon_loss: 12376.8666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41880.5373; val_optim_loss: 41880.5373
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9885; val_auprc_score: 0.9878; val_best_acc_score: 0.9472; val_best_f1_score: 0.9474; train_kl_reg_loss: 2706.3658; train_edge_recon_loss: 27311.3265; train_gene_expr_recon_loss: 12456.2661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42473.9584; train_optim_loss: 42473.9584; val_kl_reg_loss: 2664.3177; val_edge_recon_loss: 26879.2166; val_gene_expr_recon_loss: 12329.4852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41873.0193; val_optim_loss: 41873.0193
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9886; val_auprc_score: 0.9883; val_best_acc_score: 0.9478; val_best_f1_score: 0.9480; train_kl_reg_loss: 2709.9301; train_edge_recon_loss: 27303.3650; train_gene_expr_recon_loss: 12424.9749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42438.2701; train_optim_loss: 42438.2701; val_kl_reg_loss: 2649.6322; val_edge_recon_loss: 26859.6229; val_gene_expr_recon_loss: 12313.4729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41822.7278; val_optim_loss: 41822.7278
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9883; val_auprc_score: 0.9880; val_best_acc_score: 0.9473; val_best_f1_score: 0.9474; train_kl_reg_loss: 2715.3827; train_edge_recon_loss: 27296.3784; train_gene_expr_recon_loss: 12405.7436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42417.5047; train_optim_loss: 42417.5047; val_kl_reg_loss: 2649.7694; val_edge_recon_loss: 26874.8275; val_gene_expr_recon_loss: 12278.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41803.1706; val_optim_loss: 41803.1706
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9884; val_best_acc_score: 0.9491; val_best_f1_score: 0.9494; train_kl_reg_loss: 2718.7855; train_edge_recon_loss: 27287.8724; train_gene_expr_recon_loss: 12378.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42385.3838; train_optim_loss: 42385.3838; val_kl_reg_loss: 2633.9617; val_edge_recon_loss: 26835.9872; val_gene_expr_recon_loss: 12276.0473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41745.9960; val_optim_loss: 41745.9960
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9886; val_best_acc_score: 0.9490; val_best_f1_score: 0.9491; train_kl_reg_loss: 2723.8185; train_edge_recon_loss: 27274.0487; train_gene_expr_recon_loss: 12355.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42353.5397; train_optim_loss: 42353.5397; val_kl_reg_loss: 2674.2968; val_edge_recon_loss: 26834.3395; val_gene_expr_recon_loss: 12235.0100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41743.6463; val_optim_loss: 41743.6463
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9895; val_auprc_score: 0.9890; val_best_acc_score: 0.9500; val_best_f1_score: 0.9504; train_kl_reg_loss: 2728.0529; train_edge_recon_loss: 27267.4853; train_gene_expr_recon_loss: 12340.6996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42336.2378; train_optim_loss: 42336.2378; val_kl_reg_loss: 2647.2003; val_edge_recon_loss: 26812.8704; val_gene_expr_recon_loss: 12257.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41717.6679; val_optim_loss: 41717.6679
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9883; val_best_acc_score: 0.9503; val_best_f1_score: 0.9503; train_kl_reg_loss: 2731.3282; train_edge_recon_loss: 27260.4119; train_gene_expr_recon_loss: 12326.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42318.3111; train_optim_loss: 42318.3111; val_kl_reg_loss: 2632.3462; val_edge_recon_loss: 26835.4206; val_gene_expr_recon_loss: 12224.2650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41692.0321; val_optim_loss: 41692.0321
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9886; val_best_acc_score: 0.9494; val_best_f1_score: 0.9498; train_kl_reg_loss: 2735.7357; train_edge_recon_loss: 27251.2492; train_gene_expr_recon_loss: 12309.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42296.7038; train_optim_loss: 42296.7038; val_kl_reg_loss: 2703.4057; val_edge_recon_loss: 26840.4147; val_gene_expr_recon_loss: 12213.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41757.4727; val_optim_loss: 41757.4727
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9892; val_auprc_score: 0.9886; val_best_acc_score: 0.9503; val_best_f1_score: 0.9502; train_kl_reg_loss: 2737.8331; train_edge_recon_loss: 27254.6037; train_gene_expr_recon_loss: 12299.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42292.3410; train_optim_loss: 42292.3410; val_kl_reg_loss: 2670.9385; val_edge_recon_loss: 26833.9774; val_gene_expr_recon_loss: 12183.0490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41687.9648; val_optim_loss: 41687.9648
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9891; val_auprc_score: 0.9885; val_best_acc_score: 0.9492; val_best_f1_score: 0.9495; train_kl_reg_loss: 2740.2602; train_edge_recon_loss: 27253.1746; train_gene_expr_recon_loss: 12290.6743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42284.1091; train_optim_loss: 42284.1091; val_kl_reg_loss: 2697.1197; val_edge_recon_loss: 26850.7547; val_gene_expr_recon_loss: 12184.0784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41731.9526; val_optim_loss: 41731.9526
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9895; val_best_acc_score: 0.9507; val_best_f1_score: 0.9507; train_kl_reg_loss: 2746.1488; train_edge_recon_loss: 27233.5795; train_gene_expr_recon_loss: 12276.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42255.7857; train_optim_loss: 42255.7857; val_kl_reg_loss: 2684.7359; val_edge_recon_loss: 26829.0675; val_gene_expr_recon_loss: 12167.7475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41681.5510; val_optim_loss: 41681.5510
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9899; val_auprc_score: 0.9894; val_best_acc_score: 0.9518; val_best_f1_score: 0.9521; train_kl_reg_loss: 2746.7950; train_edge_recon_loss: 27242.2865; train_gene_expr_recon_loss: 12263.7596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42252.8411; train_optim_loss: 42252.8411; val_kl_reg_loss: 2663.8394; val_edge_recon_loss: 26827.5667; val_gene_expr_recon_loss: 12172.9225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41664.3288; val_optim_loss: 41664.3288
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9890; val_best_acc_score: 0.9496; val_best_f1_score: 0.9498; train_kl_reg_loss: 2752.3017; train_edge_recon_loss: 27218.9994; train_gene_expr_recon_loss: 12260.4537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42231.7546; train_optim_loss: 42231.7546; val_kl_reg_loss: 2686.3179; val_edge_recon_loss: 26808.2104; val_gene_expr_recon_loss: 12155.0691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41649.5972; val_optim_loss: 41649.5972
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9888; val_best_acc_score: 0.9503; val_best_f1_score: 0.9505; train_kl_reg_loss: 2752.8337; train_edge_recon_loss: 27224.2959; train_gene_expr_recon_loss: 12247.3780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42224.5077; train_optim_loss: 42224.5077; val_kl_reg_loss: 2772.2788; val_edge_recon_loss: 26795.5953; val_gene_expr_recon_loss: 12153.8353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41721.7092; val_optim_loss: 41721.7092
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9899; val_auprc_score: 0.9893; val_best_acc_score: 0.9512; val_best_f1_score: 0.9514; train_kl_reg_loss: 2754.5782; train_edge_recon_loss: 27224.5239; train_gene_expr_recon_loss: 12238.7851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42217.8871; train_optim_loss: 42217.8871; val_kl_reg_loss: 2694.2906; val_edge_recon_loss: 26822.5642; val_gene_expr_recon_loss: 12146.8449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41663.6999; val_optim_loss: 41663.6999
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9899; val_auprc_score: 0.9895; val_best_acc_score: 0.9510; val_best_f1_score: 0.9511; train_kl_reg_loss: 2757.6000; train_edge_recon_loss: 27218.8274; train_gene_expr_recon_loss: 12231.7042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42208.1316; train_optim_loss: 42208.1316; val_kl_reg_loss: 2717.7144; val_edge_recon_loss: 26812.5494; val_gene_expr_recon_loss: 12112.0121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41642.2760; val_optim_loss: 41642.2760
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9893; val_auprc_score: 0.9886; val_best_acc_score: 0.9505; val_best_f1_score: 0.9507; train_kl_reg_loss: 2759.5533; train_edge_recon_loss: 27216.7721; train_gene_expr_recon_loss: 12225.5583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42201.8838; train_optim_loss: 42201.8838; val_kl_reg_loss: 2652.5553; val_edge_recon_loss: 26832.0597; val_gene_expr_recon_loss: 12119.0927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41603.7075; val_optim_loss: 41603.7075
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9897; val_auprc_score: 0.9891; val_best_acc_score: 0.9510; val_best_f1_score: 0.9512; train_kl_reg_loss: 2760.8652; train_edge_recon_loss: 27218.2201; train_gene_expr_recon_loss: 12220.2597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42199.3449; train_optim_loss: 42199.3449; val_kl_reg_loss: 2654.7634; val_edge_recon_loss: 26807.7975; val_gene_expr_recon_loss: 12109.5885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41572.1492; val_optim_loss: 41572.1492
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9898; val_auprc_score: 0.9894; val_best_acc_score: 0.9508; val_best_f1_score: 0.9511; train_kl_reg_loss: 2763.0336; train_edge_recon_loss: 27215.6362; train_gene_expr_recon_loss: 12210.3175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42188.9874; train_optim_loss: 42188.9874; val_kl_reg_loss: 2755.0560; val_edge_recon_loss: 26797.8911; val_gene_expr_recon_loss: 12110.9759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41663.9233; val_optim_loss: 41663.9233
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9905; val_auprc_score: 0.9901; val_best_acc_score: 0.9527; val_best_f1_score: 0.9530; train_kl_reg_loss: 2765.9271; train_edge_recon_loss: 27210.5714; train_gene_expr_recon_loss: 12208.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42184.9167; train_optim_loss: 42184.9167; val_kl_reg_loss: 2692.1046; val_edge_recon_loss: 26794.8588; val_gene_expr_recon_loss: 12115.8671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41602.8305; val_optim_loss: 41602.8305
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9903; val_auprc_score: 0.9897; val_best_acc_score: 0.9527; val_best_f1_score: 0.9528; train_kl_reg_loss: 2767.2675; train_edge_recon_loss: 27210.6402; train_gene_expr_recon_loss: 12193.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42171.7039; train_optim_loss: 42171.7039; val_kl_reg_loss: 2698.2032; val_edge_recon_loss: 26797.9708; val_gene_expr_recon_loss: 12104.4559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41600.6298; val_optim_loss: 41600.6298
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9900; val_auprc_score: 0.9895; val_best_acc_score: 0.9510; val_best_f1_score: 0.9511; train_kl_reg_loss: 2769.8379; train_edge_recon_loss: 27205.6611; train_gene_expr_recon_loss: 12195.1103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42170.6093; train_optim_loss: 42170.6093; val_kl_reg_loss: 2727.5968; val_edge_recon_loss: 26801.1048; val_gene_expr_recon_loss: 12088.2634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41616.9654; val_optim_loss: 41616.9654

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9905; val_auprc_score: 0.9900; val_best_acc_score: 0.9529; val_best_f1_score: 0.9531; train_kl_reg_loss: 2769.2282; train_edge_recon_loss: 27161.8384; train_gene_expr_recon_loss: 12141.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42072.4745; train_optim_loss: 42072.4745; val_kl_reg_loss: 2732.1332; val_edge_recon_loss: 26781.1646; val_gene_expr_recon_loss: 12045.2148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41558.5126; val_optim_loss: 41558.5126
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9908; val_auprc_score: 0.9904; val_best_acc_score: 0.9535; val_best_f1_score: 0.9536; train_kl_reg_loss: 2766.2062; train_edge_recon_loss: 27171.2494; train_gene_expr_recon_loss: 12135.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42073.1882; train_optim_loss: 42073.1882; val_kl_reg_loss: 2706.4979; val_edge_recon_loss: 26806.7589; val_gene_expr_recon_loss: 12041.9363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41555.1928; val_optim_loss: 41555.1928
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9908; val_auprc_score: 0.9901; val_best_acc_score: 0.9532; val_best_f1_score: 0.9533; train_kl_reg_loss: 2763.6082; train_edge_recon_loss: 27181.1169; train_gene_expr_recon_loss: 12130.1716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42074.8966; train_optim_loss: 42074.8966; val_kl_reg_loss: 2740.4677; val_edge_recon_loss: 26791.1758; val_gene_expr_recon_loss: 12055.3759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41587.0192; val_optim_loss: 41587.0192
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9906; val_auprc_score: 0.9900; val_best_acc_score: 0.9525; val_best_f1_score: 0.9526; train_kl_reg_loss: 2765.8029; train_edge_recon_loss: 27169.3966; train_gene_expr_recon_loss: 12129.6915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42064.8911; train_optim_loss: 42064.8911; val_kl_reg_loss: 2720.6241; val_edge_recon_loss: 26809.1864; val_gene_expr_recon_loss: 12059.6205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41589.4312; val_optim_loss: 41589.4312
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9906; val_auprc_score: 0.9901; val_best_acc_score: 0.9531; val_best_f1_score: 0.9532; train_kl_reg_loss: 2766.1675; train_edge_recon_loss: 27168.1560; train_gene_expr_recon_loss: 12123.2481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42057.5716; train_optim_loss: 42057.5716; val_kl_reg_loss: 2713.6762; val_edge_recon_loss: 26776.3872; val_gene_expr_recon_loss: 12055.1424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41545.2057; val_optim_loss: 41545.2057
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9905; val_auprc_score: 0.9900; val_best_acc_score: 0.9533; val_best_f1_score: 0.9535; train_kl_reg_loss: 2764.8975; train_edge_recon_loss: 27176.1832; train_gene_expr_recon_loss: 12123.7409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42064.8217; train_optim_loss: 42064.8217; val_kl_reg_loss: 2692.7948; val_edge_recon_loss: 26772.6164; val_gene_expr_recon_loss: 12044.4305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41509.8418; val_optim_loss: 41509.8418
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9904; val_auprc_score: 0.9898; val_best_acc_score: 0.9525; val_best_f1_score: 0.9526; train_kl_reg_loss: 2764.8233; train_edge_recon_loss: 27171.3662; train_gene_expr_recon_loss: 12124.3807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42060.5701; train_optim_loss: 42060.5701; val_kl_reg_loss: 2695.9962; val_edge_recon_loss: 26825.7629; val_gene_expr_recon_loss: 12046.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41568.4766; val_optim_loss: 41568.4766
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9907; val_auprc_score: 0.9902; val_best_acc_score: 0.9531; val_best_f1_score: 0.9533; train_kl_reg_loss: 2763.7100; train_edge_recon_loss: 27179.1967; train_gene_expr_recon_loss: 12121.6421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42064.5487; train_optim_loss: 42064.5487; val_kl_reg_loss: 2730.4550; val_edge_recon_loss: 26771.0683; val_gene_expr_recon_loss: 12018.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41520.3460; val_optim_loss: 41520.3460
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9904; val_auprc_score: 0.9898; val_best_acc_score: 0.9533; val_best_f1_score: 0.9537; train_kl_reg_loss: 2764.9074; train_edge_recon_loss: 27170.3110; train_gene_expr_recon_loss: 12118.6134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42053.8318; train_optim_loss: 42053.8318; val_kl_reg_loss: 2711.8969; val_edge_recon_loss: 26809.9535; val_gene_expr_recon_loss: 12034.5961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41556.4466; val_optim_loss: 41556.4466
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9908; val_auprc_score: 0.9902; val_best_acc_score: 0.9540; val_best_f1_score: 0.9542; train_kl_reg_loss: 2764.0827; train_edge_recon_loss: 27179.2614; train_gene_expr_recon_loss: 12116.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42060.0247; train_optim_loss: 42060.0247; val_kl_reg_loss: 2721.4872; val_edge_recon_loss: 26776.6052; val_gene_expr_recon_loss: 12053.0639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41551.1563; val_optim_loss: 41551.1563

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9907; val_auprc_score: 0.9903; val_best_acc_score: 0.9534; val_best_f1_score: 0.9538; train_kl_reg_loss: 2764.9224; train_edge_recon_loss: 27165.1176; train_gene_expr_recon_loss: 12113.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42043.5986; train_optim_loss: 42043.5986; val_kl_reg_loss: 2722.4881; val_edge_recon_loss: 26795.8585; val_gene_expr_recon_loss: 12024.2177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41542.5644; val_optim_loss: 41542.5644
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9908; val_auprc_score: 0.9904; val_best_acc_score: 0.9536; val_best_f1_score: 0.9537; train_kl_reg_loss: 2764.2698; train_edge_recon_loss: 27166.5991; train_gene_expr_recon_loss: 12106.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42037.5153; train_optim_loss: 42037.5153; val_kl_reg_loss: 2727.1485; val_edge_recon_loss: 26773.2143; val_gene_expr_recon_loss: 12025.8795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41526.2424; val_optim_loss: 41526.2424
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9906; val_auprc_score: 0.9899; val_best_acc_score: 0.9536; val_best_f1_score: 0.9540; train_kl_reg_loss: 2764.0662; train_edge_recon_loss: 27173.4893; train_gene_expr_recon_loss: 12107.5063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42045.0618; train_optim_loss: 42045.0618; val_kl_reg_loss: 2726.4928; val_edge_recon_loss: 26767.4146; val_gene_expr_recon_loss: 12030.6376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41524.5450; val_optim_loss: 41524.5450
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9908; val_auprc_score: 0.9904; val_best_acc_score: 0.9536; val_best_f1_score: 0.9538; train_kl_reg_loss: 2764.9365; train_edge_recon_loss: 27164.0416; train_gene_expr_recon_loss: 12104.9517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42033.9298; train_optim_loss: 42033.9298; val_kl_reg_loss: 2721.5366; val_edge_recon_loss: 26790.1659; val_gene_expr_recon_loss: 12044.3903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41556.0929; val_optim_loss: 41556.0929

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 103 min 24 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9903
Val AUPRC score: 0.9898
Val best accuracy score: 0.9525
Val best F1 score: 0.9527
Val gene expr MSE score: 9.0511

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
