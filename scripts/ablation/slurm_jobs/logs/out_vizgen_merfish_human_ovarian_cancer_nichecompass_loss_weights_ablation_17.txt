None
Run timestamp: 04072023_092735_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9747; val_auprc_score: 0.9740; val_best_acc_score: 0.9206; val_best_f1_score: 0.9216; train_kl_reg_loss: 2442.8409; train_edge_recon_loss: 28355.5164; train_gene_expr_recon_loss: 21907.5895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 52705.9468; train_optim_loss: 52705.9468; val_kl_reg_loss: 2667.8856; val_edge_recon_loss: 26760.3977; val_gene_expr_recon_loss: 20826.9540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 50255.2371; val_optim_loss: 50255.2371
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9814; val_auprc_score: 0.9810; val_best_acc_score: 0.9328; val_best_f1_score: 0.9332; train_kl_reg_loss: 2672.2916; train_edge_recon_loss: 27599.7827; train_gene_expr_recon_loss: 20667.1408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50939.2151; train_optim_loss: 50939.2151; val_kl_reg_loss: 2629.5288; val_edge_recon_loss: 26706.6244; val_gene_expr_recon_loss: 20174.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49510.6185; val_optim_loss: 49510.6185
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9840; val_auprc_score: 0.9836; val_best_acc_score: 0.9370; val_best_f1_score: 0.9375; train_kl_reg_loss: 2683.8935; train_edge_recon_loss: 27525.6258; train_gene_expr_recon_loss: 20139.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50348.7642; train_optim_loss: 50348.7642; val_kl_reg_loss: 2700.8270; val_edge_recon_loss: 26736.6670; val_gene_expr_recon_loss: 19782.4259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49219.9202; val_optim_loss: 49219.9202
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9850; val_auprc_score: 0.9850; val_best_acc_score: 0.9392; val_best_f1_score: 0.9395; train_kl_reg_loss: 2709.4927; train_edge_recon_loss: 27480.6287; train_gene_expr_recon_loss: 19818.4637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50008.5852; train_optim_loss: 50008.5852; val_kl_reg_loss: 2708.1984; val_edge_recon_loss: 26730.9135; val_gene_expr_recon_loss: 19518.2987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48957.4105; val_optim_loss: 48957.4105
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9856; val_auprc_score: 0.9852; val_best_acc_score: 0.9408; val_best_f1_score: 0.9411; train_kl_reg_loss: 2736.7532; train_edge_recon_loss: 27464.1512; train_gene_expr_recon_loss: 19621.4350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49822.3395; train_optim_loss: 49822.3395; val_kl_reg_loss: 2763.9185; val_edge_recon_loss: 26762.3616; val_gene_expr_recon_loss: 19351.0236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48877.3035; val_optim_loss: 48877.3035
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9862; val_auprc_score: 0.9857; val_best_acc_score: 0.9417; val_best_f1_score: 0.9419; train_kl_reg_loss: 2758.8605; train_edge_recon_loss: 27451.3770; train_gene_expr_recon_loss: 19496.7459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49706.9833; train_optim_loss: 49706.9833; val_kl_reg_loss: 2765.4317; val_edge_recon_loss: 26842.4040; val_gene_expr_recon_loss: 19235.6205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48843.4562; val_optim_loss: 48843.4562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9863; val_auprc_score: 0.9859; val_best_acc_score: 0.9424; val_best_f1_score: 0.9427; train_kl_reg_loss: 2779.2525; train_edge_recon_loss: 27430.9489; train_gene_expr_recon_loss: 19398.4165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49608.6180; train_optim_loss: 49608.6180; val_kl_reg_loss: 2803.6650; val_edge_recon_loss: 26837.5373; val_gene_expr_recon_loss: 19131.4793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48772.6817; val_optim_loss: 48772.6817
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9864; val_auprc_score: 0.9858; val_best_acc_score: 0.9422; val_best_f1_score: 0.9424; train_kl_reg_loss: 2790.6520; train_edge_recon_loss: 27423.9080; train_gene_expr_recon_loss: 19333.6037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49548.1637; train_optim_loss: 49548.1637; val_kl_reg_loss: 2769.7253; val_edge_recon_loss: 26847.8314; val_gene_expr_recon_loss: 19094.9801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48712.5368; val_optim_loss: 48712.5368
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9863; val_best_acc_score: 0.9429; val_best_f1_score: 0.9431; train_kl_reg_loss: 2801.1844; train_edge_recon_loss: 27422.1037; train_gene_expr_recon_loss: 19280.5876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49503.8756; train_optim_loss: 49503.8756; val_kl_reg_loss: 2816.8734; val_edge_recon_loss: 26878.5208; val_gene_expr_recon_loss: 19038.9840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48734.3781; val_optim_loss: 48734.3781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9866; val_auprc_score: 0.9859; val_best_acc_score: 0.9434; val_best_f1_score: 0.9438; train_kl_reg_loss: 2810.2745; train_edge_recon_loss: 27412.7462; train_gene_expr_recon_loss: 19250.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49473.0878; train_optim_loss: 49473.0878; val_kl_reg_loss: 2723.9281; val_edge_recon_loss: 26859.0154; val_gene_expr_recon_loss: 18982.1142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48565.0575; val_optim_loss: 48565.0575
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9869; val_auprc_score: 0.9863; val_best_acc_score: 0.9434; val_best_f1_score: 0.9436; train_kl_reg_loss: 2817.2149; train_edge_recon_loss: 27405.2940; train_gene_expr_recon_loss: 19211.9005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49434.4095; train_optim_loss: 49434.4095; val_kl_reg_loss: 2731.1662; val_edge_recon_loss: 26883.4404; val_gene_expr_recon_loss: 18957.6824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48572.2891; val_optim_loss: 48572.2891
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9867; val_auprc_score: 0.9862; val_best_acc_score: 0.9438; val_best_f1_score: 0.9438; train_kl_reg_loss: 2822.0935; train_edge_recon_loss: 27405.6243; train_gene_expr_recon_loss: 19183.7702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49411.4880; train_optim_loss: 49411.4880; val_kl_reg_loss: 2760.4133; val_edge_recon_loss: 26870.1624; val_gene_expr_recon_loss: 18942.6403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48573.2163; val_optim_loss: 48573.2163
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9867; val_auprc_score: 0.9862; val_best_acc_score: 0.9436; val_best_f1_score: 0.9439; train_kl_reg_loss: 2828.9292; train_edge_recon_loss: 27393.5930; train_gene_expr_recon_loss: 19161.6738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49384.1959; train_optim_loss: 49384.1959; val_kl_reg_loss: 2807.2427; val_edge_recon_loss: 26885.4654; val_gene_expr_recon_loss: 18929.6816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48622.3898; val_optim_loss: 48622.3898
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9872; val_auprc_score: 0.9868; val_best_acc_score: 0.9448; val_best_f1_score: 0.9450; train_kl_reg_loss: 2833.7921; train_edge_recon_loss: 27388.0000; train_gene_expr_recon_loss: 19146.4663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49368.2583; train_optim_loss: 49368.2583; val_kl_reg_loss: 2688.8320; val_edge_recon_loss: 26883.2714; val_gene_expr_recon_loss: 18924.0472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48496.1506; val_optim_loss: 48496.1506
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9882; val_auprc_score: 0.9875; val_best_acc_score: 0.9468; val_best_f1_score: 0.9472; train_kl_reg_loss: 2835.4536; train_edge_recon_loss: 27395.5801; train_gene_expr_recon_loss: 19134.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49365.0499; train_optim_loss: 49365.0499; val_kl_reg_loss: 2783.9616; val_edge_recon_loss: 26878.4412; val_gene_expr_recon_loss: 18912.1793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48574.5822; val_optim_loss: 48574.5822
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9872; val_auprc_score: 0.9867; val_best_acc_score: 0.9447; val_best_f1_score: 0.9450; train_kl_reg_loss: 2840.6478; train_edge_recon_loss: 27382.7698; train_gene_expr_recon_loss: 19112.4561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49335.8736; train_optim_loss: 49335.8736; val_kl_reg_loss: 2818.8788; val_edge_recon_loss: 26893.7332; val_gene_expr_recon_loss: 18879.1002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48591.7123; val_optim_loss: 48591.7123
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9876; val_auprc_score: 0.9872; val_best_acc_score: 0.9455; val_best_f1_score: 0.9457; train_kl_reg_loss: 2843.3970; train_edge_recon_loss: 27377.2455; train_gene_expr_recon_loss: 19104.3303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49324.9728; train_optim_loss: 49324.9728; val_kl_reg_loss: 2749.0955; val_edge_recon_loss: 26877.7288; val_gene_expr_recon_loss: 18915.3214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48542.1458; val_optim_loss: 48542.1458
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9875; val_auprc_score: 0.9870; val_best_acc_score: 0.9453; val_best_f1_score: 0.9454; train_kl_reg_loss: 2846.8319; train_edge_recon_loss: 27373.8606; train_gene_expr_recon_loss: 19096.1438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49316.8363; train_optim_loss: 49316.8363; val_kl_reg_loss: 2798.9548; val_edge_recon_loss: 26868.0785; val_gene_expr_recon_loss: 18868.1870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48535.2202; val_optim_loss: 48535.2202

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9882; val_auprc_score: 0.9876; val_best_acc_score: 0.9475; val_best_f1_score: 0.9479; train_kl_reg_loss: 2819.4432; train_edge_recon_loss: 27336.9395; train_gene_expr_recon_loss: 18907.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49063.8321; train_optim_loss: 49063.8321; val_kl_reg_loss: 2753.4528; val_edge_recon_loss: 26852.6874; val_gene_expr_recon_loss: 18710.2831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48316.4231; val_optim_loss: 48316.4231
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9890; val_auprc_score: 0.9887; val_best_acc_score: 0.9490; val_best_f1_score: 0.9490; train_kl_reg_loss: 2786.3227; train_edge_recon_loss: 27374.4183; train_gene_expr_recon_loss: 18854.7115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49015.4524; train_optim_loss: 49015.4524; val_kl_reg_loss: 2731.0492; val_edge_recon_loss: 26866.1475; val_gene_expr_recon_loss: 18695.2507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48292.4476; val_optim_loss: 48292.4476
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9878; val_best_acc_score: 0.9474; val_best_f1_score: 0.9477; train_kl_reg_loss: 2777.0336; train_edge_recon_loss: 27376.6865; train_gene_expr_recon_loss: 18834.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48988.3531; train_optim_loss: 48988.3531; val_kl_reg_loss: 2710.4707; val_edge_recon_loss: 26901.1350; val_gene_expr_recon_loss: 18693.4748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48305.0804; val_optim_loss: 48305.0804
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9884; val_best_acc_score: 0.9482; val_best_f1_score: 0.9486; train_kl_reg_loss: 2768.2151; train_edge_recon_loss: 27389.0878; train_gene_expr_recon_loss: 18827.7081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48985.0109; train_optim_loss: 48985.0109; val_kl_reg_loss: 2720.1231; val_edge_recon_loss: 26908.2376; val_gene_expr_recon_loss: 18687.3330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48315.6936; val_optim_loss: 48315.6936
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9885; val_auprc_score: 0.9880; val_best_acc_score: 0.9481; val_best_f1_score: 0.9485; train_kl_reg_loss: 2765.4700; train_edge_recon_loss: 27389.6826; train_gene_expr_recon_loss: 18818.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48973.2545; train_optim_loss: 48973.2545; val_kl_reg_loss: 2733.4409; val_edge_recon_loss: 26885.2836; val_gene_expr_recon_loss: 18677.9815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48296.7059; val_optim_loss: 48296.7059
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9887; val_auprc_score: 0.9884; val_best_acc_score: 0.9480; val_best_f1_score: 0.9480; train_kl_reg_loss: 2759.1734; train_edge_recon_loss: 27404.3127; train_gene_expr_recon_loss: 18815.4658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48978.9519; train_optim_loss: 48978.9519; val_kl_reg_loss: 2727.4358; val_edge_recon_loss: 26898.3728; val_gene_expr_recon_loss: 18667.1231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48292.9316; val_optim_loss: 48292.9316

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9885; val_auprc_score: 0.9880; val_best_acc_score: 0.9475; val_best_f1_score: 0.9479; train_kl_reg_loss: 2760.6396; train_edge_recon_loss: 27390.8877; train_gene_expr_recon_loss: 18792.3459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48943.8732; train_optim_loss: 48943.8732; val_kl_reg_loss: 2711.2664; val_edge_recon_loss: 26915.8377; val_gene_expr_recon_loss: 18650.7372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48277.8413; val_optim_loss: 48277.8413
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9885; val_auprc_score: 0.9879; val_best_acc_score: 0.9476; val_best_f1_score: 0.9479; train_kl_reg_loss: 2758.1895; train_edge_recon_loss: 27396.1426; train_gene_expr_recon_loss: 18786.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48940.8055; train_optim_loss: 48940.8055; val_kl_reg_loss: 2699.6506; val_edge_recon_loss: 26923.6802; val_gene_expr_recon_loss: 18659.4015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48282.7322; val_optim_loss: 48282.7322
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9890; val_auprc_score: 0.9884; val_best_acc_score: 0.9492; val_best_f1_score: 0.9495; train_kl_reg_loss: 2755.0143; train_edge_recon_loss: 27400.7199; train_gene_expr_recon_loss: 18783.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48939.0375; train_optim_loss: 48939.0375; val_kl_reg_loss: 2712.1258; val_edge_recon_loss: 26919.3919; val_gene_expr_recon_loss: 18674.2721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48305.7898; val_optim_loss: 48305.7898
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9888; val_auprc_score: 0.9884; val_best_acc_score: 0.9483; val_best_f1_score: 0.9487; train_kl_reg_loss: 2759.3929; train_edge_recon_loss: 27381.5029; train_gene_expr_recon_loss: 18785.7473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48926.6430; train_optim_loss: 48926.6430; val_kl_reg_loss: 2716.4336; val_edge_recon_loss: 26898.8027; val_gene_expr_recon_loss: 18645.7218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48260.9581; val_optim_loss: 48260.9581
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9889; val_auprc_score: 0.9885; val_best_acc_score: 0.9492; val_best_f1_score: 0.9492; train_kl_reg_loss: 2757.4190; train_edge_recon_loss: 27391.2578; train_gene_expr_recon_loss: 18778.7167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48927.3934; train_optim_loss: 48927.3934; val_kl_reg_loss: 2718.9514; val_edge_recon_loss: 26907.7973; val_gene_expr_recon_loss: 18662.8400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48289.5887; val_optim_loss: 48289.5887
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9886; val_auprc_score: 0.9882; val_best_acc_score: 0.9477; val_best_f1_score: 0.9479; train_kl_reg_loss: 2756.9717; train_edge_recon_loss: 27388.9982; train_gene_expr_recon_loss: 18782.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48928.5355; train_optim_loss: 48928.5355; val_kl_reg_loss: 2709.6206; val_edge_recon_loss: 26911.3385; val_gene_expr_recon_loss: 18639.3217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48260.2809; val_optim_loss: 48260.2809
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9887; val_auprc_score: 0.9882; val_best_acc_score: 0.9485; val_best_f1_score: 0.9485; train_kl_reg_loss: 2756.1939; train_edge_recon_loss: 27393.9197; train_gene_expr_recon_loss: 18777.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48928.0984; train_optim_loss: 48928.0984; val_kl_reg_loss: 2716.9211; val_edge_recon_loss: 26930.3658; val_gene_expr_recon_loss: 18648.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48296.0446; val_optim_loss: 48296.0446
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9889; val_auprc_score: 0.9883; val_best_acc_score: 0.9487; val_best_f1_score: 0.9487; train_kl_reg_loss: 2754.7858; train_edge_recon_loss: 27395.7365; train_gene_expr_recon_loss: 18781.1808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48931.7031; train_optim_loss: 48931.7031; val_kl_reg_loss: 2718.7833; val_edge_recon_loss: 26895.4551; val_gene_expr_recon_loss: 18667.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48282.1657; val_optim_loss: 48282.1657
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9887; val_auprc_score: 0.9883; val_best_acc_score: 0.9478; val_best_f1_score: 0.9480; train_kl_reg_loss: 2755.9312; train_edge_recon_loss: 27388.5571; train_gene_expr_recon_loss: 18776.8026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48921.2910; train_optim_loss: 48921.2910; val_kl_reg_loss: 2693.6696; val_edge_recon_loss: 26915.6099; val_gene_expr_recon_loss: 18664.0096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48273.2892; val_optim_loss: 48273.2892
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9889; val_auprc_score: 0.9883; val_best_acc_score: 0.9489; val_best_f1_score: 0.9492; train_kl_reg_loss: 2754.9834; train_edge_recon_loss: 27390.3252; train_gene_expr_recon_loss: 18780.7248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48926.0334; train_optim_loss: 48926.0334; val_kl_reg_loss: 2694.9604; val_edge_recon_loss: 26884.8953; val_gene_expr_recon_loss: 18657.6140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48237.4697; val_optim_loss: 48237.4697
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9889; val_auprc_score: 0.9884; val_best_acc_score: 0.9487; val_best_f1_score: 0.9493; train_kl_reg_loss: 2751.3814; train_edge_recon_loss: 27408.5477; train_gene_expr_recon_loss: 18776.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48936.9104; train_optim_loss: 48936.9104; val_kl_reg_loss: 2692.8246; val_edge_recon_loss: 26899.5407; val_gene_expr_recon_loss: 18656.8742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48249.2393; val_optim_loss: 48249.2393
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9890; val_auprc_score: 0.9885; val_best_acc_score: 0.9491; val_best_f1_score: 0.9491; train_kl_reg_loss: 2752.7789; train_edge_recon_loss: 27396.3287; train_gene_expr_recon_loss: 18770.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48920.0520; train_optim_loss: 48920.0520; val_kl_reg_loss: 2711.7766; val_edge_recon_loss: 26912.6149; val_gene_expr_recon_loss: 18651.4777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48275.8692; val_optim_loss: 48275.8692
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9890; val_auprc_score: 0.9886; val_best_acc_score: 0.9488; val_best_f1_score: 0.9491; train_kl_reg_loss: 2753.0314; train_edge_recon_loss: 27396.4550; train_gene_expr_recon_loss: 18772.8891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48922.3755; train_optim_loss: 48922.3755; val_kl_reg_loss: 2699.6873; val_edge_recon_loss: 26902.7028; val_gene_expr_recon_loss: 18655.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48258.0282; val_optim_loss: 48258.0282
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9888; val_auprc_score: 0.9884; val_best_acc_score: 0.9486; val_best_f1_score: 0.9487; train_kl_reg_loss: 2753.1672; train_edge_recon_loss: 27393.6757; train_gene_expr_recon_loss: 18775.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48922.6321; train_optim_loss: 48922.6321; val_kl_reg_loss: 2717.4373; val_edge_recon_loss: 26916.8500; val_gene_expr_recon_loss: 18644.1377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48278.4251; val_optim_loss: 48278.4251

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9888; val_auprc_score: 0.9883; val_best_acc_score: 0.9484; val_best_f1_score: 0.9487; train_kl_reg_loss: 2756.3760; train_edge_recon_loss: 27384.7682; train_gene_expr_recon_loss: 18772.8520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48913.9962; train_optim_loss: 48913.9962; val_kl_reg_loss: 2705.5568; val_edge_recon_loss: 26908.5762; val_gene_expr_recon_loss: 18662.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48276.1513; val_optim_loss: 48276.1513
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9888; val_auprc_score: 0.9882; val_best_acc_score: 0.9483; val_best_f1_score: 0.9484; train_kl_reg_loss: 2752.6645; train_edge_recon_loss: 27396.8016; train_gene_expr_recon_loss: 18772.9105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48922.3766; train_optim_loss: 48922.3766; val_kl_reg_loss: 2706.9932; val_edge_recon_loss: 26919.2038; val_gene_expr_recon_loss: 18639.7823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48265.9794; val_optim_loss: 48265.9794
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9887; val_auprc_score: 0.9882; val_best_acc_score: 0.9478; val_best_f1_score: 0.9480; train_kl_reg_loss: 2753.4257; train_edge_recon_loss: 27394.0874; train_gene_expr_recon_loss: 18773.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48921.2339; train_optim_loss: 48921.2339; val_kl_reg_loss: 2705.4817; val_edge_recon_loss: 26942.4201; val_gene_expr_recon_loss: 18667.2035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48315.1053; val_optim_loss: 48315.1053
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9887; val_auprc_score: 0.9882; val_best_acc_score: 0.9482; val_best_f1_score: 0.9485; train_kl_reg_loss: 2753.1067; train_edge_recon_loss: 27391.2752; train_gene_expr_recon_loss: 18771.1726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48915.5545; train_optim_loss: 48915.5545; val_kl_reg_loss: 2705.2533; val_edge_recon_loss: 26923.8062; val_gene_expr_recon_loss: 18634.4795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48263.5391; val_optim_loss: 48263.5391

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 121 min 28 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9889
Val AUPRC score: 0.9885
Val best accuracy score: 0.9481
Val best F1 score: 0.9484
Val gene expr MSE score: 8.3896

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
