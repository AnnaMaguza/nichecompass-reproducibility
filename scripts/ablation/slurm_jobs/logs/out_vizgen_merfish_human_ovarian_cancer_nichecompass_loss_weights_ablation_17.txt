None
Run timestamp: 05072023_022343_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9742; val_auprc_score: 0.9732; val_best_acc_score: 0.9191; val_best_f1_score: 0.9198; train_kl_reg_loss: 2408.4962; train_edge_recon_loss: 28478.9216; train_gene_expr_recon_loss: 15809.2625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46696.6802; train_optim_loss: 46696.6802; val_kl_reg_loss: 2496.9758; val_edge_recon_loss: 27456.3259; val_gene_expr_recon_loss: 14113.5372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44066.8391; val_optim_loss: 44066.8391
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9821; val_auprc_score: 0.9815; val_best_acc_score: 0.9337; val_best_f1_score: 0.9342; train_kl_reg_loss: 2574.4080; train_edge_recon_loss: 27761.4957; train_gene_expr_recon_loss: 13887.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44223.7379; train_optim_loss: 44223.7379; val_kl_reg_loss: 2574.8351; val_edge_recon_loss: 27157.5680; val_gene_expr_recon_loss: 13378.3792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43110.7824; val_optim_loss: 43110.7824
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9848; val_auprc_score: 0.9839; val_best_acc_score: 0.9399; val_best_f1_score: 0.9404; train_kl_reg_loss: 2617.8345; train_edge_recon_loss: 27609.7804; train_gene_expr_recon_loss: 13372.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43599.6713; train_optim_loss: 43599.6713; val_kl_reg_loss: 2518.4422; val_edge_recon_loss: 27109.1413; val_gene_expr_recon_loss: 12975.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42603.0066; val_optim_loss: 42603.0066
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9860; val_auprc_score: 0.9853; val_best_acc_score: 0.9422; val_best_f1_score: 0.9427; train_kl_reg_loss: 2649.9816; train_edge_recon_loss: 27506.3171; train_gene_expr_recon_loss: 13089.1323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43245.4310; train_optim_loss: 43245.4310; val_kl_reg_loss: 2615.5184; val_edge_recon_loss: 27060.7389; val_gene_expr_recon_loss: 12763.4547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42439.7121; val_optim_loss: 42439.7121
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9868; val_auprc_score: 0.9860; val_best_acc_score: 0.9446; val_best_f1_score: 0.9448; train_kl_reg_loss: 2668.0913; train_edge_recon_loss: 27457.3380; train_gene_expr_recon_loss: 12921.3205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43046.7498; train_optim_loss: 43046.7498; val_kl_reg_loss: 2628.6992; val_edge_recon_loss: 26978.0816; val_gene_expr_recon_loss: 12663.8843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42270.6651; val_optim_loss: 42270.6651
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9871; val_auprc_score: 0.9865; val_best_acc_score: 0.9448; val_best_f1_score: 0.9451; train_kl_reg_loss: 2684.2981; train_edge_recon_loss: 27412.5346; train_gene_expr_recon_loss: 12809.1962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42906.0289; train_optim_loss: 42906.0289; val_kl_reg_loss: 2606.6846; val_edge_recon_loss: 26929.6540; val_gene_expr_recon_loss: 12568.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42105.2466; val_optim_loss: 42105.2466
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9885; val_auprc_score: 0.9880; val_best_acc_score: 0.9470; val_best_f1_score: 0.9473; train_kl_reg_loss: 2698.7112; train_edge_recon_loss: 27377.7259; train_gene_expr_recon_loss: 12726.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42803.1777; train_optim_loss: 42803.1777; val_kl_reg_loss: 2607.9573; val_edge_recon_loss: 26884.7539; val_gene_expr_recon_loss: 12536.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42029.0737; val_optim_loss: 42029.0737
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9877; val_auprc_score: 0.9871; val_best_acc_score: 0.9464; val_best_f1_score: 0.9467; train_kl_reg_loss: 2709.4401; train_edge_recon_loss: 27360.0634; train_gene_expr_recon_loss: 12665.5915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42735.0949; train_optim_loss: 42735.0949; val_kl_reg_loss: 2568.8587; val_edge_recon_loss: 26874.0895; val_gene_expr_recon_loss: 12476.3341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41919.2822; val_optim_loss: 41919.2822
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9886; val_auprc_score: 0.9878; val_best_acc_score: 0.9487; val_best_f1_score: 0.9489; train_kl_reg_loss: 2719.9598; train_edge_recon_loss: 27330.3690; train_gene_expr_recon_loss: 12620.2237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42670.5525; train_optim_loss: 42670.5525; val_kl_reg_loss: 2625.3154; val_edge_recon_loss: 26857.7956; val_gene_expr_recon_loss: 12429.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41912.5779; val_optim_loss: 41912.5779
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9884; val_auprc_score: 0.9878; val_best_acc_score: 0.9487; val_best_f1_score: 0.9490; train_kl_reg_loss: 2727.6035; train_edge_recon_loss: 27322.6044; train_gene_expr_recon_loss: 12578.1841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42628.3920; train_optim_loss: 42628.3920; val_kl_reg_loss: 2749.9842; val_edge_recon_loss: 26871.8985; val_gene_expr_recon_loss: 12403.5525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42025.4351; val_optim_loss: 42025.4351
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9896; val_auprc_score: 0.9890; val_best_acc_score: 0.9509; val_best_f1_score: 0.9512; train_kl_reg_loss: 2734.1639; train_edge_recon_loss: 27311.2199; train_gene_expr_recon_loss: 12542.7351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42588.1189; train_optim_loss: 42588.1189; val_kl_reg_loss: 2746.3850; val_edge_recon_loss: 26852.6201; val_gene_expr_recon_loss: 12366.4589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41965.4641; val_optim_loss: 41965.4641
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9891; val_auprc_score: 0.9881; val_best_acc_score: 0.9500; val_best_f1_score: 0.9503; train_kl_reg_loss: 2742.4134; train_edge_recon_loss: 27288.0605; train_gene_expr_recon_loss: 12518.0426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42548.5166; train_optim_loss: 42548.5166; val_kl_reg_loss: 2715.1082; val_edge_recon_loss: 26815.2601; val_gene_expr_recon_loss: 12320.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41850.8354; val_optim_loss: 41850.8354
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9886; val_auprc_score: 0.9876; val_best_acc_score: 0.9485; val_best_f1_score: 0.9487; train_kl_reg_loss: 2747.6700; train_edge_recon_loss: 27276.7899; train_gene_expr_recon_loss: 12492.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42517.3575; train_optim_loss: 42517.3575; val_kl_reg_loss: 2754.7631; val_edge_recon_loss: 26879.4382; val_gene_expr_recon_loss: 12296.6335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41930.8348; val_optim_loss: 41930.8348
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9892; val_auprc_score: 0.9886; val_best_acc_score: 0.9498; val_best_f1_score: 0.9501; train_kl_reg_loss: 2753.3423; train_edge_recon_loss: 27267.8020; train_gene_expr_recon_loss: 12479.7359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42500.8801; train_optim_loss: 42500.8801; val_kl_reg_loss: 2684.5355; val_edge_recon_loss: 26852.4755; val_gene_expr_recon_loss: 12287.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41824.8337; val_optim_loss: 41824.8337
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9886; val_auprc_score: 0.9880; val_best_acc_score: 0.9490; val_best_f1_score: 0.9490; train_kl_reg_loss: 2759.2170; train_edge_recon_loss: 27253.4024; train_gene_expr_recon_loss: 12456.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42469.3628; train_optim_loss: 42469.3628; val_kl_reg_loss: 2750.3106; val_edge_recon_loss: 26828.9650; val_gene_expr_recon_loss: 12282.8381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41862.1136; val_optim_loss: 41862.1136
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9899; val_auprc_score: 0.9892; val_best_acc_score: 0.9518; val_best_f1_score: 0.9520; train_kl_reg_loss: 2761.3377; train_edge_recon_loss: 27265.4668; train_gene_expr_recon_loss: 12442.8639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42469.6684; train_optim_loss: 42469.6684; val_kl_reg_loss: 2814.0881; val_edge_recon_loss: 26765.9813; val_gene_expr_recon_loss: 12256.7726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41836.8420; val_optim_loss: 41836.8420
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9896; val_auprc_score: 0.9892; val_best_acc_score: 0.9510; val_best_f1_score: 0.9513; train_kl_reg_loss: 2764.7342; train_edge_recon_loss: 27257.8529; train_gene_expr_recon_loss: 12424.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42446.8929; train_optim_loss: 42446.8929; val_kl_reg_loss: 2697.9363; val_edge_recon_loss: 26816.5695; val_gene_expr_recon_loss: 12247.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41762.1011; val_optim_loss: 41762.1011
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9898; val_auprc_score: 0.9893; val_best_acc_score: 0.9511; val_best_f1_score: 0.9514; train_kl_reg_loss: 2769.2573; train_edge_recon_loss: 27247.9455; train_gene_expr_recon_loss: 12411.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42429.1481; train_optim_loss: 42429.1481; val_kl_reg_loss: 2782.6254; val_edge_recon_loss: 26867.7203; val_gene_expr_recon_loss: 12222.4550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41872.8008; val_optim_loss: 41872.8008
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9902; val_auprc_score: 0.9896; val_best_acc_score: 0.9530; val_best_f1_score: 0.9532; train_kl_reg_loss: 2771.0758; train_edge_recon_loss: 27249.3974; train_gene_expr_recon_loss: 12402.8188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42423.2920; train_optim_loss: 42423.2920; val_kl_reg_loss: 2754.0217; val_edge_recon_loss: 26791.3090; val_gene_expr_recon_loss: 12231.0086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41776.3391; val_optim_loss: 41776.3391
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9895; val_auprc_score: 0.9890; val_best_acc_score: 0.9511; val_best_f1_score: 0.9511; train_kl_reg_loss: 2774.3246; train_edge_recon_loss: 27239.8555; train_gene_expr_recon_loss: 12393.0240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42407.2040; train_optim_loss: 42407.2040; val_kl_reg_loss: 2726.6234; val_edge_recon_loss: 26845.5696; val_gene_expr_recon_loss: 12225.9880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41798.1810; val_optim_loss: 41798.1810
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9895; val_auprc_score: 0.9886; val_best_acc_score: 0.9520; val_best_f1_score: 0.9522; train_kl_reg_loss: 2776.0998; train_edge_recon_loss: 27236.1293; train_gene_expr_recon_loss: 12384.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42396.6886; train_optim_loss: 42396.6886; val_kl_reg_loss: 2775.2781; val_edge_recon_loss: 26817.8888; val_gene_expr_recon_loss: 12197.3181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41790.4851; val_optim_loss: 41790.4851

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9905; val_auprc_score: 0.9900; val_best_acc_score: 0.9532; val_best_f1_score: 0.9534; train_kl_reg_loss: 2770.9168; train_edge_recon_loss: 27202.2185; train_gene_expr_recon_loss: 12304.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42278.0717; train_optim_loss: 42278.0717; val_kl_reg_loss: 2738.3831; val_edge_recon_loss: 26799.8927; val_gene_expr_recon_loss: 12144.5633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41682.8392; val_optim_loss: 41682.8392
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9904; val_auprc_score: 0.9898; val_best_acc_score: 0.9534; val_best_f1_score: 0.9538; train_kl_reg_loss: 2772.5196; train_edge_recon_loss: 27189.7649; train_gene_expr_recon_loss: 12289.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42252.1077; train_optim_loss: 42252.1077; val_kl_reg_loss: 2726.6883; val_edge_recon_loss: 26789.7128; val_gene_expr_recon_loss: 12136.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41652.6101; val_optim_loss: 41652.6101
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9905; val_auprc_score: 0.9898; val_best_acc_score: 0.9538; val_best_f1_score: 0.9540; train_kl_reg_loss: 2770.5967; train_edge_recon_loss: 27191.6396; train_gene_expr_recon_loss: 12284.1659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42246.4022; train_optim_loss: 42246.4022; val_kl_reg_loss: 2741.8042; val_edge_recon_loss: 26797.6593; val_gene_expr_recon_loss: 12133.7501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41673.2137; val_optim_loss: 41673.2137
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9907; val_auprc_score: 0.9902; val_best_acc_score: 0.9550; val_best_f1_score: 0.9551; train_kl_reg_loss: 2769.7586; train_edge_recon_loss: 27194.0233; train_gene_expr_recon_loss: 12279.7780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42243.5599; train_optim_loss: 42243.5599; val_kl_reg_loss: 2720.1743; val_edge_recon_loss: 26793.4199; val_gene_expr_recon_loss: 12126.0259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41639.6201; val_optim_loss: 41639.6201
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9906; val_auprc_score: 0.9900; val_best_acc_score: 0.9550; val_best_f1_score: 0.9551; train_kl_reg_loss: 2770.2597; train_edge_recon_loss: 27194.0635; train_gene_expr_recon_loss: 12277.1749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42241.4981; train_optim_loss: 42241.4981; val_kl_reg_loss: 2722.0065; val_edge_recon_loss: 26799.3079; val_gene_expr_recon_loss: 12102.3798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41623.6943; val_optim_loss: 41623.6943
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9908; val_auprc_score: 0.9902; val_best_acc_score: 0.9552; val_best_f1_score: 0.9553; train_kl_reg_loss: 2770.0427; train_edge_recon_loss: 27189.8550; train_gene_expr_recon_loss: 12271.7637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42231.6614; train_optim_loss: 42231.6614; val_kl_reg_loss: 2721.3298; val_edge_recon_loss: 26795.0564; val_gene_expr_recon_loss: 12108.3139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41624.7002; val_optim_loss: 41624.7002
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9904; val_auprc_score: 0.9897; val_best_acc_score: 0.9537; val_best_f1_score: 0.9538; train_kl_reg_loss: 2770.3831; train_edge_recon_loss: 27189.3106; train_gene_expr_recon_loss: 12269.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42228.7671; train_optim_loss: 42228.7671; val_kl_reg_loss: 2733.6661; val_edge_recon_loss: 26808.2505; val_gene_expr_recon_loss: 12109.2781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41651.1948; val_optim_loss: 41651.1948
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9905; val_auprc_score: 0.9898; val_best_acc_score: 0.9551; val_best_f1_score: 0.9552; train_kl_reg_loss: 2769.2735; train_edge_recon_loss: 27194.8331; train_gene_expr_recon_loss: 12266.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42230.2941; train_optim_loss: 42230.2941; val_kl_reg_loss: 2686.5842; val_edge_recon_loss: 26790.5037; val_gene_expr_recon_loss: 12100.2449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41577.3330; val_optim_loss: 41577.3330
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9903; val_best_acc_score: 0.9541; val_best_f1_score: 0.9543; train_kl_reg_loss: 2770.2380; train_edge_recon_loss: 27191.7893; train_gene_expr_recon_loss: 12262.2479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42224.2751; train_optim_loss: 42224.2751; val_kl_reg_loss: 2731.9687; val_edge_recon_loss: 26787.2966; val_gene_expr_recon_loss: 12099.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41618.5967; val_optim_loss: 41618.5967
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9909; val_auprc_score: 0.9903; val_best_acc_score: 0.9555; val_best_f1_score: 0.9556; train_kl_reg_loss: 2772.0287; train_edge_recon_loss: 27181.8580; train_gene_expr_recon_loss: 12261.7934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42215.6800; train_optim_loss: 42215.6800; val_kl_reg_loss: 2734.6325; val_edge_recon_loss: 26776.9955; val_gene_expr_recon_loss: 12091.3288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41602.9566; val_optim_loss: 41602.9566
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9905; val_auprc_score: 0.9898; val_best_acc_score: 0.9543; val_best_f1_score: 0.9544; train_kl_reg_loss: 2771.1307; train_edge_recon_loss: 27191.8701; train_gene_expr_recon_loss: 12258.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42221.7659; train_optim_loss: 42221.7659; val_kl_reg_loss: 2732.9504; val_edge_recon_loss: 26781.3520; val_gene_expr_recon_loss: 12100.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41614.7157; val_optim_loss: 41614.7157
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9907; val_auprc_score: 0.9900; val_best_acc_score: 0.9543; val_best_f1_score: 0.9545; train_kl_reg_loss: 2773.3536; train_edge_recon_loss: 27183.6092; train_gene_expr_recon_loss: 12262.4473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42219.4102; train_optim_loss: 42219.4102; val_kl_reg_loss: 2721.6787; val_edge_recon_loss: 26798.8571; val_gene_expr_recon_loss: 12086.0956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41606.6312; val_optim_loss: 41606.6312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9907; val_auprc_score: 0.9901; val_best_acc_score: 0.9546; val_best_f1_score: 0.9548; train_kl_reg_loss: 2772.5212; train_edge_recon_loss: 27176.4097; train_gene_expr_recon_loss: 12246.1387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42195.0696; train_optim_loss: 42195.0696; val_kl_reg_loss: 2725.7300; val_edge_recon_loss: 26769.8239; val_gene_expr_recon_loss: 12098.5084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41594.0622; val_optim_loss: 41594.0622
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9908; val_auprc_score: 0.9901; val_best_acc_score: 0.9549; val_best_f1_score: 0.9550; train_kl_reg_loss: 2772.2548; train_edge_recon_loss: 27177.9893; train_gene_expr_recon_loss: 12245.6675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42195.9116; train_optim_loss: 42195.9116; val_kl_reg_loss: 2727.5375; val_edge_recon_loss: 26757.6817; val_gene_expr_recon_loss: 12080.4237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41565.6430; val_optim_loss: 41565.6430
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9909; val_auprc_score: 0.9905; val_best_acc_score: 0.9552; val_best_f1_score: 0.9553; train_kl_reg_loss: 2772.0034; train_edge_recon_loss: 27176.6429; train_gene_expr_recon_loss: 12247.3375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42195.9839; train_optim_loss: 42195.9839; val_kl_reg_loss: 2727.1590; val_edge_recon_loss: 26778.9081; val_gene_expr_recon_loss: 12095.5851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41601.6522; val_optim_loss: 41601.6522
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9910; val_auprc_score: 0.9904; val_best_acc_score: 0.9545; val_best_f1_score: 0.9548; train_kl_reg_loss: 2771.1572; train_edge_recon_loss: 27182.3876; train_gene_expr_recon_loss: 12247.9667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42201.5115; train_optim_loss: 42201.5115; val_kl_reg_loss: 2718.1961; val_edge_recon_loss: 26786.8089; val_gene_expr_recon_loss: 12087.7799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41592.7848; val_optim_loss: 41592.7848
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9909; val_auprc_score: 0.9904; val_best_acc_score: 0.9551; val_best_f1_score: 0.9553; train_kl_reg_loss: 2772.1357; train_edge_recon_loss: 27174.9597; train_gene_expr_recon_loss: 12244.7889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42191.8842; train_optim_loss: 42191.8842; val_kl_reg_loss: 2714.9540; val_edge_recon_loss: 26783.0820; val_gene_expr_recon_loss: 12094.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41592.3977; val_optim_loss: 41592.3977
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9909; val_auprc_score: 0.9901; val_best_acc_score: 0.9553; val_best_f1_score: 0.9554; train_kl_reg_loss: 2770.6732; train_edge_recon_loss: 27182.6662; train_gene_expr_recon_loss: 12246.4998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42199.8392; train_optim_loss: 42199.8392; val_kl_reg_loss: 2725.3810; val_edge_recon_loss: 26782.3643; val_gene_expr_recon_loss: 12090.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41597.8703; val_optim_loss: 41597.8703

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9909; val_auprc_score: 0.9904; val_best_acc_score: 0.9551; val_best_f1_score: 0.9552; train_kl_reg_loss: 2770.1584; train_edge_recon_loss: 27178.7413; train_gene_expr_recon_loss: 12245.4221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42194.3218; train_optim_loss: 42194.3218; val_kl_reg_loss: 2723.3104; val_edge_recon_loss: 26783.1588; val_gene_expr_recon_loss: 12087.4147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41593.8838; val_optim_loss: 41593.8838
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9908; val_auprc_score: 0.9901; val_best_acc_score: 0.9551; val_best_f1_score: 0.9552; train_kl_reg_loss: 2772.4286; train_edge_recon_loss: 27169.6281; train_gene_expr_recon_loss: 12242.1433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42184.2000; train_optim_loss: 42184.2000; val_kl_reg_loss: 2726.9680; val_edge_recon_loss: 26798.5592; val_gene_expr_recon_loss: 12091.8116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41617.3387; val_optim_loss: 41617.3387
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9909; val_auprc_score: 0.9903; val_best_acc_score: 0.9555; val_best_f1_score: 0.9556; train_kl_reg_loss: 2771.1020; train_edge_recon_loss: 27180.1300; train_gene_expr_recon_loss: 12245.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42196.4855; train_optim_loss: 42196.4855; val_kl_reg_loss: 2726.5414; val_edge_recon_loss: 26788.1839; val_gene_expr_recon_loss: 12091.6990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41606.4241; val_optim_loss: 41606.4241
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9912; val_auprc_score: 0.9908; val_best_acc_score: 0.9559; val_best_f1_score: 0.9560; train_kl_reg_loss: 2771.3052; train_edge_recon_loss: 27181.0903; train_gene_expr_recon_loss: 12245.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42197.7411; train_optim_loss: 42197.7411; val_kl_reg_loss: 2723.9468; val_edge_recon_loss: 26769.4159; val_gene_expr_recon_loss: 12091.9871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41585.3498; val_optim_loss: 41585.3498

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 111 min 40 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9909
Val AUPRC score: 0.9905
Val best accuracy score: 0.9548
Val best F1 score: 0.9550
Val gene expr MSE score: 8.8644

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
