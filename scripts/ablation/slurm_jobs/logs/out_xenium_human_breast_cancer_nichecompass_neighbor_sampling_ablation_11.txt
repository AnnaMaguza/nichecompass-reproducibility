None
Run timestamp: 01082023_133252_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9897; val_auprc_score: 0.9880; val_best_acc_score: 0.9546; val_best_f1_score: 0.9553; train_kl_reg_loss: 5986.0444; train_edge_recon_loss: 263965.0440; train_gene_expr_recon_loss: 115621.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 385572.8070; train_optim_loss: 385572.8070; val_kl_reg_loss: 5920.8707; val_edge_recon_loss: 261661.2569; val_gene_expr_recon_loss: 109559.0199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377141.1478; val_optim_loss: 377141.1478
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9608; val_best_f1_score: 0.9613; train_kl_reg_loss: 5895.5970; train_edge_recon_loss: 260905.1231; train_gene_expr_recon_loss: 108845.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375646.5687; train_optim_loss: 375646.5687; val_kl_reg_loss: 5901.7810; val_edge_recon_loss: 260840.9649; val_gene_expr_recon_loss: 108637.2059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375379.9515; val_optim_loss: 375379.9515
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9909; val_best_acc_score: 0.9622; val_best_f1_score: 0.9628; train_kl_reg_loss: 5895.9725; train_edge_recon_loss: 260305.0787; train_gene_expr_recon_loss: 108255.4587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374456.5100; train_optim_loss: 374456.5100; val_kl_reg_loss: 5802.7395; val_edge_recon_loss: 260438.2499; val_gene_expr_recon_loss: 108280.9954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374521.9852; val_optim_loss: 374521.9852
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9938; val_auprc_score: 0.9926; val_best_acc_score: 0.9673; val_best_f1_score: 0.9677; train_kl_reg_loss: 5899.3473; train_edge_recon_loss: 259823.6291; train_gene_expr_recon_loss: 108144.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373867.3558; train_optim_loss: 373867.3558; val_kl_reg_loss: 5797.6000; val_edge_recon_loss: 260097.8322; val_gene_expr_recon_loss: 108470.5359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374365.9683; val_optim_loss: 374365.9683
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9937; val_auprc_score: 0.9925; val_best_acc_score: 0.9665; val_best_f1_score: 0.9669; train_kl_reg_loss: 5901.7294; train_edge_recon_loss: 259624.6688; train_gene_expr_recon_loss: 108074.0810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373600.4791; train_optim_loss: 373600.4791; val_kl_reg_loss: 5853.4065; val_edge_recon_loss: 259599.7708; val_gene_expr_recon_loss: 108332.9404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373786.1174; val_optim_loss: 373786.1174
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9922; val_best_acc_score: 0.9686; val_best_f1_score: 0.9689; train_kl_reg_loss: 5906.6066; train_edge_recon_loss: 259407.9360; train_gene_expr_recon_loss: 107929.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373244.3081; train_optim_loss: 373244.3081; val_kl_reg_loss: 5905.2333; val_edge_recon_loss: 259642.3705; val_gene_expr_recon_loss: 108304.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373851.6989; val_optim_loss: 373851.6989
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5913.3773; train_edge_recon_loss: 259218.9738; train_gene_expr_recon_loss: 107933.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373065.4629; train_optim_loss: 373065.4629; val_kl_reg_loss: 5846.2155; val_edge_recon_loss: 259218.2621; val_gene_expr_recon_loss: 108103.4634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373167.9413; val_optim_loss: 373167.9413
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 5917.4721; train_edge_recon_loss: 259106.6957; train_gene_expr_recon_loss: 107867.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372892.0261; train_optim_loss: 372892.0261; val_kl_reg_loss: 5915.2940; val_edge_recon_loss: 259434.6455; val_gene_expr_recon_loss: 108176.5326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373526.4716; val_optim_loss: 373526.4716
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9924; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 5920.7960; train_edge_recon_loss: 258976.9747; train_gene_expr_recon_loss: 107908.3350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372806.1058; train_optim_loss: 372806.1058; val_kl_reg_loss: 5851.4740; val_edge_recon_loss: 259112.3889; val_gene_expr_recon_loss: 108102.5477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373066.4112; val_optim_loss: 373066.4112
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9932; val_best_acc_score: 0.9706; val_best_f1_score: 0.9709; train_kl_reg_loss: 5922.9027; train_edge_recon_loss: 258884.8335; train_gene_expr_recon_loss: 107869.2981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372677.0343; train_optim_loss: 372677.0343; val_kl_reg_loss: 5905.6465; val_edge_recon_loss: 259247.5368; val_gene_expr_recon_loss: 108039.9832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373193.1663; val_optim_loss: 373193.1663
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9935; val_best_acc_score: 0.9708; val_best_f1_score: 0.9711; train_kl_reg_loss: 5929.9289; train_edge_recon_loss: 258854.9827; train_gene_expr_recon_loss: 107880.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372665.4048; train_optim_loss: 372665.4048; val_kl_reg_loss: 5944.0254; val_edge_recon_loss: 258988.9848; val_gene_expr_recon_loss: 108226.5571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373159.5672; val_optim_loss: 373159.5672
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9945; val_auprc_score: 0.9933; val_best_acc_score: 0.9706; val_best_f1_score: 0.9709; train_kl_reg_loss: 5932.8526; train_edge_recon_loss: 258772.7110; train_gene_expr_recon_loss: 107844.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372550.4177; train_optim_loss: 372550.4177; val_kl_reg_loss: 5942.8219; val_edge_recon_loss: 258869.2387; val_gene_expr_recon_loss: 108145.3041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372957.3642; val_optim_loss: 372957.3642
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9707; val_best_f1_score: 0.9711; train_kl_reg_loss: 5934.5830; train_edge_recon_loss: 258692.4459; train_gene_expr_recon_loss: 107844.0644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372471.0935; train_optim_loss: 372471.0935; val_kl_reg_loss: 5982.6531; val_edge_recon_loss: 258671.0258; val_gene_expr_recon_loss: 108026.7056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372680.3845; val_optim_loss: 372680.3845
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9928; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5939.3939; train_edge_recon_loss: 258590.6442; train_gene_expr_recon_loss: 107762.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372293.0102; train_optim_loss: 372293.0102; val_kl_reg_loss: 5957.4489; val_edge_recon_loss: 258984.8030; val_gene_expr_recon_loss: 108206.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373149.1466; val_optim_loss: 373149.1466
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 5936.8431; train_edge_recon_loss: 258578.4678; train_gene_expr_recon_loss: 107835.8791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372351.1900; train_optim_loss: 372351.1900; val_kl_reg_loss: 5885.6704; val_edge_recon_loss: 258692.9693; val_gene_expr_recon_loss: 108224.8345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372803.4743; val_optim_loss: 372803.4743
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9946; val_auprc_score: 0.9935; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 5942.7213; train_edge_recon_loss: 258543.0622; train_gene_expr_recon_loss: 107852.0774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372337.8611; train_optim_loss: 372337.8611; val_kl_reg_loss: 5952.8738; val_edge_recon_loss: 258802.1776; val_gene_expr_recon_loss: 107962.9163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372717.9675; val_optim_loss: 372717.9675
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9716; val_best_f1_score: 0.9719; train_kl_reg_loss: 5943.3121; train_edge_recon_loss: 258507.1246; train_gene_expr_recon_loss: 107730.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372180.7976; train_optim_loss: 372180.7976; val_kl_reg_loss: 5972.9897; val_edge_recon_loss: 258635.0524; val_gene_expr_recon_loss: 107972.9849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372581.0267; val_optim_loss: 372581.0267
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9722; val_best_f1_score: 0.9725; train_kl_reg_loss: 5945.6021; train_edge_recon_loss: 258461.2788; train_gene_expr_recon_loss: 107817.8188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372224.6997; train_optim_loss: 372224.6997; val_kl_reg_loss: 6006.4863; val_edge_recon_loss: 258659.2943; val_gene_expr_recon_loss: 108142.8223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372808.6029; val_optim_loss: 372808.6029
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9727; val_best_f1_score: 0.9731; train_kl_reg_loss: 5947.7987; train_edge_recon_loss: 258368.3409; train_gene_expr_recon_loss: 107796.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372112.7790; train_optim_loss: 372112.7790; val_kl_reg_loss: 5950.3834; val_edge_recon_loss: 258271.7388; val_gene_expr_recon_loss: 108220.2454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372442.3680; val_optim_loss: 372442.3680
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 5950.2460; train_edge_recon_loss: 258336.8156; train_gene_expr_recon_loss: 107789.5378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372076.5995; train_optim_loss: 372076.5995; val_kl_reg_loss: 5929.6003; val_edge_recon_loss: 258519.0244; val_gene_expr_recon_loss: 108021.9456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372470.5699; val_optim_loss: 372470.5699
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 5950.8724; train_edge_recon_loss: 258345.8893; train_gene_expr_recon_loss: 107769.2138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372065.9755; train_optim_loss: 372065.9755; val_kl_reg_loss: 5986.7235; val_edge_recon_loss: 258182.9486; val_gene_expr_recon_loss: 107993.2675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372162.9402; val_optim_loss: 372162.9402
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 5952.9839; train_edge_recon_loss: 258325.7534; train_gene_expr_recon_loss: 107785.3696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372064.1069; train_optim_loss: 372064.1069; val_kl_reg_loss: 5965.8108; val_edge_recon_loss: 258364.5867; val_gene_expr_recon_loss: 108169.7430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372500.1410; val_optim_loss: 372500.1410
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 5956.7458; train_edge_recon_loss: 258290.5191; train_gene_expr_recon_loss: 107736.1100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371983.3748; train_optim_loss: 371983.3748; val_kl_reg_loss: 5934.7787; val_edge_recon_loss: 258159.6709; val_gene_expr_recon_loss: 107954.6886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372049.1391; val_optim_loss: 372049.1391
