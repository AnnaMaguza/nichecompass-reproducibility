None
Run timestamp: 09082023_000330_104.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_104']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9830; val_auprc_score: 0.9769; val_best_acc_score: 0.9481; val_best_f1_score: 0.9492; train_kl_reg_loss: 77909.5764; train_edge_recon_loss: 26945741.3352; train_gene_expr_recon_loss: 20455879.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47479530.8095; train_optim_loss: 47479530.8095; val_kl_reg_loss: 93445.2200; val_edge_recon_loss: 26084254.4000; val_gene_expr_recon_loss: 18928204.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45105903.5500; val_optim_loss: 45105903.5500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9869; val_auprc_score: 0.9831; val_best_acc_score: 0.9553; val_best_f1_score: 0.9564; train_kl_reg_loss: 86714.8368; train_edge_recon_loss: 25967278.2142; train_gene_expr_recon_loss: 18350261.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44404254.3143; train_optim_loss: 44404254.3143; val_kl_reg_loss: 76968.9552; val_edge_recon_loss: 25942874.5500; val_gene_expr_recon_loss: 18029927.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44049771.2000; val_optim_loss: 44049771.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9883; val_auprc_score: 0.9843; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 72374.6004; train_edge_recon_loss: 25847355.0709; train_gene_expr_recon_loss: 17698054.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43617784.0111; train_optim_loss: 43617784.0111; val_kl_reg_loss: 67499.4021; val_edge_recon_loss: 25826214.0750; val_gene_expr_recon_loss: 17506758.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43400471.9500; val_optim_loss: 43400471.9500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9894; val_auprc_score: 0.9858; val_best_acc_score: 0.9644; val_best_f1_score: 0.9652; train_kl_reg_loss: 66312.1100; train_edge_recon_loss: 25760420.5090; train_gene_expr_recon_loss: 17314654.1794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43141386.7149; train_optim_loss: 43141386.7149; val_kl_reg_loss: 63538.1006; val_edge_recon_loss: 25760010.3750; val_gene_expr_recon_loss: 17296983.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43120532.3500; val_optim_loss: 43120532.3500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9903; val_auprc_score: 0.9872; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 60937.0470; train_edge_recon_loss: 25709737.8470; train_gene_expr_recon_loss: 17086459.7775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42857134.7093; train_optim_loss: 42857134.7093; val_kl_reg_loss: 58440.9130; val_edge_recon_loss: 25743635.5750; val_gene_expr_recon_loss: 17086070.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42888146.9000; val_optim_loss: 42888146.9000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 56660.8034; train_edge_recon_loss: 25660669.9026; train_gene_expr_recon_loss: 16946869.9736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42664200.6676; train_optim_loss: 42664200.6676; val_kl_reg_loss: 53170.4976; val_edge_recon_loss: 25700447.0500; val_gene_expr_recon_loss: 17000450.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42754067.7500; val_optim_loss: 42754067.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9922; val_auprc_score: 0.9898; val_best_acc_score: 0.9704; val_best_f1_score: 0.9710; train_kl_reg_loss: 52714.3610; train_edge_recon_loss: 25656293.9082; train_gene_expr_recon_loss: 16858775.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42567784.2003; train_optim_loss: 42567784.2003; val_kl_reg_loss: 50469.1530; val_edge_recon_loss: 25668159.6500; val_gene_expr_recon_loss: 16894744.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42613373.9000; val_optim_loss: 42613373.9000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9927; val_auprc_score: 0.9905; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 49738.8651; train_edge_recon_loss: 25638518.5702; train_gene_expr_recon_loss: 16777636.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42465893.9861; train_optim_loss: 42465893.9861; val_kl_reg_loss: 48228.6916; val_edge_recon_loss: 25639576.3500; val_gene_expr_recon_loss: 16824641.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42512447.0000; val_optim_loss: 42512447.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 47157.3532; train_edge_recon_loss: 25606260.3950; train_gene_expr_recon_loss: 16724150.4687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42377568.3394; train_optim_loss: 42377568.3394; val_kl_reg_loss: 45262.1032; val_edge_recon_loss: 25646793.1000; val_gene_expr_recon_loss: 16811405.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42503460.3000; val_optim_loss: 42503460.3000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9937; val_auprc_score: 0.9914; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 45227.9112; train_edge_recon_loss: 25588982.8401; train_gene_expr_recon_loss: 16685501.2907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42319712.0111; train_optim_loss: 42319712.0111; val_kl_reg_loss: 43893.9257; val_edge_recon_loss: 25622797.8000; val_gene_expr_recon_loss: 16803345.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42470036.8500; val_optim_loss: 42470036.8500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 43830.3223; train_edge_recon_loss: 25580995.7330; train_gene_expr_recon_loss: 16636171.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42260997.4242; train_optim_loss: 42260997.4242; val_kl_reg_loss: 42749.3305; val_edge_recon_loss: 25614070.8250; val_gene_expr_recon_loss: 16768126.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42424946.7000; val_optim_loss: 42424946.7000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 42696.4391; train_edge_recon_loss: 25570067.9722; train_gene_expr_recon_loss: 16600132.5229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42212896.8679; train_optim_loss: 42212896.8679; val_kl_reg_loss: 41674.6308; val_edge_recon_loss: 25591344.5750; val_gene_expr_recon_loss: 16762461.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42395480.4500; val_optim_loss: 42395480.4500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 41245.5088; train_edge_recon_loss: 25558514.5035; train_gene_expr_recon_loss: 16575545.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42175305.0904; train_optim_loss: 42175305.0904; val_kl_reg_loss: 40683.1156; val_edge_recon_loss: 25604402.1250; val_gene_expr_recon_loss: 16707003.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42352089.0000; val_optim_loss: 42352089.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 40503.1268; train_edge_recon_loss: 25547239.6245; train_gene_expr_recon_loss: 16541036.7469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42128779.4882; train_optim_loss: 42128779.4882; val_kl_reg_loss: 39991.7196; val_edge_recon_loss: 25581543.7750; val_gene_expr_recon_loss: 16697420.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42318955.8000; val_optim_loss: 42318955.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 39423.5016; train_edge_recon_loss: 25539489.8887; train_gene_expr_recon_loss: 16531019.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42109932.9013; train_optim_loss: 42109932.9013; val_kl_reg_loss: 38527.7694; val_edge_recon_loss: 25577998.2500; val_gene_expr_recon_loss: 16680218.4125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42296744.5500; val_optim_loss: 42296744.5500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 39199.7674; train_edge_recon_loss: 25530412.2503; train_gene_expr_recon_loss: 16518500.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42088112.1168; train_optim_loss: 42088112.1168; val_kl_reg_loss: 38748.0319; val_edge_recon_loss: 25572270.1250; val_gene_expr_recon_loss: 16741546.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42352564.6000; val_optim_loss: 42352564.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9956; val_auprc_score: 0.9942; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 38288.4538; train_edge_recon_loss: 25526288.2086; train_gene_expr_recon_loss: 16491344.6022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42055921.2573; train_optim_loss: 42055921.2573; val_kl_reg_loss: 37836.8694; val_edge_recon_loss: 25557908.9250; val_gene_expr_recon_loss: 16678893.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42274639.2000; val_optim_loss: 42274639.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 37649.2606; train_edge_recon_loss: 25532726.9847; train_gene_expr_recon_loss: 16470832.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42041208.5563; train_optim_loss: 42041208.5563; val_kl_reg_loss: 37294.7850; val_edge_recon_loss: 25562348.3250; val_gene_expr_recon_loss: 16706481.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42306124.6500; val_optim_loss: 42306124.6500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 37280.7979; train_edge_recon_loss: 25516643.2239; train_gene_expr_recon_loss: 16456359.0125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42010283.1043; train_optim_loss: 42010283.1043; val_kl_reg_loss: 36680.4602; val_edge_recon_loss: 25542717.9000; val_gene_expr_recon_loss: 16704055.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42283453.6500; val_optim_loss: 42283453.6500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 36767.2198; train_edge_recon_loss: 25519381.2267; train_gene_expr_recon_loss: 16439314.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41995462.8762; train_optim_loss: 41995462.8762; val_kl_reg_loss: 36880.4853; val_edge_recon_loss: 25518646.0250; val_gene_expr_recon_loss: 16753207.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42308733.6000; val_optim_loss: 42308733.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 36627.6580; train_edge_recon_loss: 25510967.6273; train_gene_expr_recon_loss: 16431826.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41979421.4465; train_optim_loss: 41979421.4465; val_kl_reg_loss: 36035.8666; val_edge_recon_loss: 25544845.4750; val_gene_expr_recon_loss: 16704545.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42285426.9500; val_optim_loss: 42285426.9500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 38660.7484; train_edge_recon_loss: 25503863.0821; train_gene_expr_recon_loss: 16345510.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41888034.3755; train_optim_loss: 41888034.3755; val_kl_reg_loss: 39244.0599; val_edge_recon_loss: 25538246.0250; val_gene_expr_recon_loss: 16688256.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42265746.5500; val_optim_loss: 42265746.5500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 40125.3472; train_edge_recon_loss: 25492538.3588; train_gene_expr_recon_loss: 16332315.4812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41864979.2100; train_optim_loss: 41864979.2100; val_kl_reg_loss: 40039.0939; val_edge_recon_loss: 25532973.9500; val_gene_expr_recon_loss: 16687376.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42260389.1000; val_optim_loss: 42260389.1000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 40426.7433; train_edge_recon_loss: 25497335.5076; train_gene_expr_recon_loss: 16341094.4993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41878856.7344; train_optim_loss: 41878856.7344; val_kl_reg_loss: 40110.8882; val_edge_recon_loss: 25516551.4750; val_gene_expr_recon_loss: 16648165.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42204827.9000; val_optim_loss: 42204827.9000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 40901.6938; train_edge_recon_loss: 25495409.0070; train_gene_expr_recon_loss: 16329605.7302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41865916.4618; train_optim_loss: 41865916.4618; val_kl_reg_loss: 40541.5041; val_edge_recon_loss: 25521732.9750; val_gene_expr_recon_loss: 16740536.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42302811.2000; val_optim_loss: 42302811.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 41105.8620; train_edge_recon_loss: 25484485.2796; train_gene_expr_recon_loss: 16322559.4924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41848150.6926; train_optim_loss: 41848150.6926; val_kl_reg_loss: 40943.5596; val_edge_recon_loss: 25533220.3250; val_gene_expr_recon_loss: 16687664.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42261828.3000; val_optim_loss: 42261828.3000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 41257.9387; train_edge_recon_loss: 25495326.0056; train_gene_expr_recon_loss: 16335539.8303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41872123.8609; train_optim_loss: 41872123.8609; val_kl_reg_loss: 40759.8005; val_edge_recon_loss: 25538491.2500; val_gene_expr_recon_loss: 16683188.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42262439.2500; val_optim_loss: 42262439.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 41235.8054; train_edge_recon_loss: 25488056.5953; train_gene_expr_recon_loss: 16328064.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41857357.2851; train_optim_loss: 41857357.2851; val_kl_reg_loss: 40621.1777; val_edge_recon_loss: 25496147.5000; val_gene_expr_recon_loss: 16682559.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42219328.1500; val_optim_loss: 42219328.1500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 41243.5561; train_edge_recon_loss: 25486375.9750; train_gene_expr_recon_loss: 16310170.3491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41837789.9583; train_optim_loss: 41837789.9583; val_kl_reg_loss: 40893.8533; val_edge_recon_loss: 25508631.2250; val_gene_expr_recon_loss: 16641195.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42190720.5000; val_optim_loss: 42190720.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 41396.1912; train_edge_recon_loss: 25489567.1544; train_gene_expr_recon_loss: 16319764.3296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41850727.6829; train_optim_loss: 41850727.6829; val_kl_reg_loss: 40964.1436; val_edge_recon_loss: 25523704.4500; val_gene_expr_recon_loss: 16666062.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42230730.5500; val_optim_loss: 42230730.5500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 41497.4371; train_edge_recon_loss: 25488673.5688; train_gene_expr_recon_loss: 16301168.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41831339.9221; train_optim_loss: 41831339.9221; val_kl_reg_loss: 41083.0369; val_edge_recon_loss: 25518127.1750; val_gene_expr_recon_loss: 16699112.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42258322.4000; val_optim_loss: 42258322.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 41557.4964; train_edge_recon_loss: 25489219.6773; train_gene_expr_recon_loss: 16301248.2239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41832025.3630; train_optim_loss: 41832025.3630; val_kl_reg_loss: 41124.5441; val_edge_recon_loss: 25516663.7750; val_gene_expr_recon_loss: 16655308.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42213096.9500; val_optim_loss: 42213096.9500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 41598.4813; train_edge_recon_loss: 25486413.9444; train_gene_expr_recon_loss: 16303196.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41831209.1071; train_optim_loss: 41831209.1071; val_kl_reg_loss: 41166.7625; val_edge_recon_loss: 25489626.6500; val_gene_expr_recon_loss: 16648796.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42179590.0000; val_optim_loss: 42179590.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 41634.8706; train_edge_recon_loss: 25489791.9722; train_gene_expr_recon_loss: 16303904.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41835331.0097; train_optim_loss: 41835331.0097; val_kl_reg_loss: 41201.4267; val_edge_recon_loss: 25517114.9000; val_gene_expr_recon_loss: 16646294.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42204610.3500; val_optim_loss: 42204610.3500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 41701.6523; train_edge_recon_loss: 25481520.6147; train_gene_expr_recon_loss: 16309431.4910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41832653.6523; train_optim_loss: 41832653.6523; val_kl_reg_loss: 41227.0653; val_edge_recon_loss: 25501692.1500; val_gene_expr_recon_loss: 16674010.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42216929.9000; val_optim_loss: 42216929.9000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 41757.8981; train_edge_recon_loss: 25484019.5772; train_gene_expr_recon_loss: 16312988.3964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41838765.8693; train_optim_loss: 41838765.8693; val_kl_reg_loss: 41360.8346; val_edge_recon_loss: 25511013.2500; val_gene_expr_recon_loss: 16678373.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42230746.8000; val_optim_loss: 42230746.8000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 41782.5222; train_edge_recon_loss: 25484475.3463; train_gene_expr_recon_loss: 16301533.3115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41827791.1878; train_optim_loss: 41827791.1878; val_kl_reg_loss: 41429.8550; val_edge_recon_loss: 25532501.5500; val_gene_expr_recon_loss: 16713021.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42286952.1500; val_optim_loss: 42286952.1500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 41785.5647; train_edge_recon_loss: 25487928.3505; train_gene_expr_recon_loss: 16302053.2601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41831767.1488; train_optim_loss: 41831767.1488; val_kl_reg_loss: 41380.5259; val_edge_recon_loss: 25513939.5250; val_gene_expr_recon_loss: 16676900.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42232220.4500; val_optim_loss: 42232220.4500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 41820.4094; train_edge_recon_loss: 25489350.4534; train_gene_expr_recon_loss: 16306809.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41837980.2170; train_optim_loss: 41837980.2170; val_kl_reg_loss: 41336.0757; val_edge_recon_loss: 25507860.5500; val_gene_expr_recon_loss: 16676347.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42225544.3000; val_optim_loss: 42225544.3000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 41823.1825; train_edge_recon_loss: 25478200.2337; train_gene_expr_recon_loss: 16308352.7803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41828376.2615; train_optim_loss: 41828376.2615; val_kl_reg_loss: 41340.4557; val_edge_recon_loss: 25521464.5250; val_gene_expr_recon_loss: 16676077.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42238882.1000; val_optim_loss: 42238882.1000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 41809.0930; train_edge_recon_loss: 25488866.0918; train_gene_expr_recon_loss: 16305369.3129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41836044.4951; train_optim_loss: 41836044.4951; val_kl_reg_loss: 41347.9132; val_edge_recon_loss: 25514468.9750; val_gene_expr_recon_loss: 16663775.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42219592.2000; val_optim_loss: 42219592.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 325 min 4 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9962
val AUPRC score: 0.9947
val best accuracy score: 0.9823
val best F1 score: 0.9824
val target rna MSE score: 0.6075
val source rna MSE score: 0.0271

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
