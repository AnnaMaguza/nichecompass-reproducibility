None
Run timestamp: 28072023_212313_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9543; val_auprc_score: 0.9609; val_best_acc_score: 0.8835; val_best_f1_score: 0.8822; train_kl_reg_loss: 826.3078; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20549.6457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 21375.9535; train_optim_loss: 21375.9535; val_kl_reg_loss: 718.4925; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18571.2199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19289.7123; val_optim_loss: 19289.7123
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9622; val_auprc_score: 0.9679; val_best_acc_score: 0.8967; val_best_f1_score: 0.8950; train_kl_reg_loss: 714.3497; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18312.9164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19027.2660; train_optim_loss: 19027.2660; val_kl_reg_loss: 679.1052; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17696.2916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18375.3968; val_optim_loss: 18375.3968
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9639; val_auprc_score: 0.9697; val_best_acc_score: 0.9001; val_best_f1_score: 0.8982; train_kl_reg_loss: 687.5442; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17784.0319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18471.5761; train_optim_loss: 18471.5761; val_kl_reg_loss: 663.0237; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17426.3494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18089.3732; val_optim_loss: 18089.3732
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9662; val_auprc_score: 0.9715; val_best_acc_score: 0.9059; val_best_f1_score: 0.9028; train_kl_reg_loss: 677.4451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17576.9908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18254.4360; train_optim_loss: 18254.4360; val_kl_reg_loss: 677.9044; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17286.7407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17964.6451; val_optim_loss: 17964.6451
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9676; val_auprc_score: 0.9727; val_best_acc_score: 0.9073; val_best_f1_score: 0.9056; train_kl_reg_loss: 673.8450; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17480.7794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18154.6244; train_optim_loss: 18154.6244; val_kl_reg_loss: 660.8456; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17234.2893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17895.1349; val_optim_loss: 17895.1349
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9670; val_auprc_score: 0.9723; val_best_acc_score: 0.9067; val_best_f1_score: 0.9040; train_kl_reg_loss: 672.0391; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17434.9317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18106.9707; train_optim_loss: 18106.9707; val_kl_reg_loss: 676.5128; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17240.0950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17916.6078; val_optim_loss: 17916.6078
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9685; val_auprc_score: 0.9735; val_best_acc_score: 0.9088; val_best_f1_score: 0.9068; train_kl_reg_loss: 671.2993; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17403.8624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18075.1618; train_optim_loss: 18075.1618; val_kl_reg_loss: 662.1911; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17186.8591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17849.0502; val_optim_loss: 17849.0502
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9689; val_auprc_score: 0.9738; val_best_acc_score: 0.9098; val_best_f1_score: 0.9081; train_kl_reg_loss: 670.7536; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17379.4008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18050.1544; train_optim_loss: 18050.1544; val_kl_reg_loss: 663.4230; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17157.2515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17820.6745; val_optim_loss: 17820.6745
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9745; val_best_acc_score: 0.9116; val_best_f1_score: 0.9089; train_kl_reg_loss: 670.5163; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17370.3108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18040.8270; train_optim_loss: 18040.8270; val_kl_reg_loss: 662.2190; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17146.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17808.9638; val_optim_loss: 17808.9638
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9695; val_auprc_score: 0.9743; val_best_acc_score: 0.9105; val_best_f1_score: 0.9086; train_kl_reg_loss: 670.4939; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17358.7820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18029.2759; train_optim_loss: 18029.2759; val_kl_reg_loss: 671.5774; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17146.7880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17818.3654; val_optim_loss: 17818.3654
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9706; val_auprc_score: 0.9753; val_best_acc_score: 0.9127; val_best_f1_score: 0.9105; train_kl_reg_loss: 670.5685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17341.8966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18012.4651; train_optim_loss: 18012.4651; val_kl_reg_loss: 668.2696; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17157.3777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17825.6473; val_optim_loss: 17825.6473
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9750; val_best_acc_score: 0.9119; val_best_f1_score: 0.9093; train_kl_reg_loss: 670.1881; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17338.2046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18008.3927; train_optim_loss: 18008.3927; val_kl_reg_loss: 662.8495; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17143.7581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17806.6076; val_optim_loss: 17806.6076
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9702; val_auprc_score: 0.9750; val_best_acc_score: 0.9121; val_best_f1_score: 0.9104; train_kl_reg_loss: 670.3462; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17331.5184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18001.8646; train_optim_loss: 18001.8646; val_kl_reg_loss: 658.7965; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17144.6221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17803.4186; val_optim_loss: 17803.4186
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9713; val_auprc_score: 0.9759; val_best_acc_score: 0.9135; val_best_f1_score: 0.9118; train_kl_reg_loss: 670.1009; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17331.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18001.4194; train_optim_loss: 18001.4194; val_kl_reg_loss: 671.9210; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17126.2871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17798.2081; val_optim_loss: 17798.2081
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9712; val_auprc_score: 0.9757; val_best_acc_score: 0.9145; val_best_f1_score: 0.9118; train_kl_reg_loss: 669.8584; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17325.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17995.4927; train_optim_loss: 17995.4927; val_kl_reg_loss: 660.6773; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17136.2122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17796.8894; val_optim_loss: 17796.8894
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9714; val_auprc_score: 0.9758; val_best_acc_score: 0.9144; val_best_f1_score: 0.9118; train_kl_reg_loss: 669.7638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17323.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17993.2448; train_optim_loss: 17993.2448; val_kl_reg_loss: 664.9244; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17132.9699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17797.8943; val_optim_loss: 17797.8943
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9707; val_auprc_score: 0.9753; val_best_acc_score: 0.9135; val_best_f1_score: 0.9109; train_kl_reg_loss: 669.4634; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17314.6735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17984.1369; train_optim_loss: 17984.1369; val_kl_reg_loss: 659.5799; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17125.7406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17785.3205; val_optim_loss: 17785.3205
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9721; val_auprc_score: 0.9764; val_best_acc_score: 0.9154; val_best_f1_score: 0.9126; train_kl_reg_loss: 668.8085; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17311.0004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17979.8089; train_optim_loss: 17979.8089; val_kl_reg_loss: 659.7061; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17139.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17799.1242; val_optim_loss: 17799.1242
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9707; val_auprc_score: 0.9753; val_best_acc_score: 0.9126; val_best_f1_score: 0.9094; train_kl_reg_loss: 668.3815; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17313.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17981.9336; train_optim_loss: 17981.9336; val_kl_reg_loss: 669.4455; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17139.5429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17808.9884; val_optim_loss: 17808.9884
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9714; val_auprc_score: 0.9758; val_best_acc_score: 0.9132; val_best_f1_score: 0.9117; train_kl_reg_loss: 666.9912; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17307.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17974.8013; train_optim_loss: 17974.8013; val_kl_reg_loss: 665.6035; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17122.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17788.3631; val_optim_loss: 17788.3631
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9726; val_auprc_score: 0.9770; val_best_acc_score: 0.9162; val_best_f1_score: 0.9147; train_kl_reg_loss: 665.0303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17303.9807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17969.0111; train_optim_loss: 17969.0111; val_kl_reg_loss: 667.4999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17121.1844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17788.6844; val_optim_loss: 17788.6844

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9738; val_auprc_score: 0.9780; val_best_acc_score: 0.9183; val_best_f1_score: 0.9165; train_kl_reg_loss: 661.7373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17222.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17884.4191; train_optim_loss: 17884.4191; val_kl_reg_loss: 655.9495; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17063.2417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17719.1912; val_optim_loss: 17719.1912
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9738; val_auprc_score: 0.9777; val_best_acc_score: 0.9183; val_best_f1_score: 0.9167; train_kl_reg_loss: 662.8042; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17210.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17873.7684; train_optim_loss: 17873.7684; val_kl_reg_loss: 658.1908; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17059.9713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17718.1621; val_optim_loss: 17718.1621
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9736; val_auprc_score: 0.9775; val_best_acc_score: 0.9179; val_best_f1_score: 0.9166; train_kl_reg_loss: 663.3286; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17202.5506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17865.8793; train_optim_loss: 17865.8793; val_kl_reg_loss: 659.1378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17062.4856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17721.6234; val_optim_loss: 17721.6234
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9743; val_auprc_score: 0.9783; val_best_acc_score: 0.9190; val_best_f1_score: 0.9179; train_kl_reg_loss: 663.9635; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17201.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17865.1183; train_optim_loss: 17865.1183; val_kl_reg_loss: 658.2129; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17072.9968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17731.2097; val_optim_loss: 17731.2097
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9746; val_auprc_score: 0.9785; val_best_acc_score: 0.9191; val_best_f1_score: 0.9181; train_kl_reg_loss: 664.1836; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17193.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17857.3667; train_optim_loss: 17857.3667; val_kl_reg_loss: 658.5305; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17085.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17743.5742; val_optim_loss: 17743.5742
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9743; val_auprc_score: 0.9784; val_best_acc_score: 0.9190; val_best_f1_score: 0.9179; train_kl_reg_loss: 664.5248; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17190.3615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17854.8862; train_optim_loss: 17854.8862; val_kl_reg_loss: 661.3060; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17076.2243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17737.5303; val_optim_loss: 17737.5303

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9744; val_auprc_score: 0.9783; val_best_acc_score: 0.9197; val_best_f1_score: 0.9184; train_kl_reg_loss: 664.3195; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17182.1569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17846.4764; train_optim_loss: 17846.4764; val_kl_reg_loss: 659.0171; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17053.2354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17712.2525; val_optim_loss: 17712.2525
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9744; val_auprc_score: 0.9785; val_best_acc_score: 0.9197; val_best_f1_score: 0.9183; train_kl_reg_loss: 664.4711; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17182.1466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17846.6177; train_optim_loss: 17846.6177; val_kl_reg_loss: 658.6474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17036.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17695.3697; val_optim_loss: 17695.3697
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9748; val_auprc_score: 0.9788; val_best_acc_score: 0.9203; val_best_f1_score: 0.9189; train_kl_reg_loss: 664.7056; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17186.7357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17851.4413; train_optim_loss: 17851.4413; val_kl_reg_loss: 660.0127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17030.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17690.0716; val_optim_loss: 17690.0716
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9748; val_auprc_score: 0.9788; val_best_acc_score: 0.9205; val_best_f1_score: 0.9190; train_kl_reg_loss: 664.8667; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17187.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17851.9308; train_optim_loss: 17851.9308; val_kl_reg_loss: 659.8777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17056.8718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17716.7495; val_optim_loss: 17716.7495
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9747; val_auprc_score: 0.9786; val_best_acc_score: 0.9200; val_best_f1_score: 0.9186; train_kl_reg_loss: 664.7186; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17176.2173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17840.9358; train_optim_loss: 17840.9358; val_kl_reg_loss: 660.2727; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17066.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17727.2028; val_optim_loss: 17727.2028
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9747; val_auprc_score: 0.9786; val_best_acc_score: 0.9202; val_best_f1_score: 0.9187; train_kl_reg_loss: 664.6310; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17180.7454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17845.3764; train_optim_loss: 17845.3764; val_kl_reg_loss: 660.1370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17049.4812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17709.6181; val_optim_loss: 17709.6181
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9747; val_auprc_score: 0.9787; val_best_acc_score: 0.9202; val_best_f1_score: 0.9188; train_kl_reg_loss: 664.9513; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17185.6369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17850.5882; train_optim_loss: 17850.5882; val_kl_reg_loss: 660.4813; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17061.8350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17722.3163; val_optim_loss: 17722.3163

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9746; val_auprc_score: 0.9786; val_best_acc_score: 0.9199; val_best_f1_score: 0.9185; train_kl_reg_loss: 665.1734; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17182.3366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17847.5101; train_optim_loss: 17847.5101; val_kl_reg_loss: 660.1961; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17048.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17708.5347; val_optim_loss: 17708.5347
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9745; val_auprc_score: 0.9783; val_best_acc_score: 0.9198; val_best_f1_score: 0.9184; train_kl_reg_loss: 664.9355; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17178.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17843.3390; train_optim_loss: 17843.3390; val_kl_reg_loss: 660.1984; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17048.1753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17708.3737; val_optim_loss: 17708.3737
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9745; val_auprc_score: 0.9785; val_best_acc_score: 0.9197; val_best_f1_score: 0.9183; train_kl_reg_loss: 664.8229; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17181.0306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17845.8535; train_optim_loss: 17845.8535; val_kl_reg_loss: 660.0274; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17059.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17719.7753; val_optim_loss: 17719.7753
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9745; val_auprc_score: 0.9783; val_best_acc_score: 0.9197; val_best_f1_score: 0.9183; train_kl_reg_loss: 664.8677; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17184.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17849.4492; train_optim_loss: 17849.4492; val_kl_reg_loss: 660.3225; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17057.6733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17717.9958; val_optim_loss: 17717.9958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 313 min 59 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9745
val AUPRC score: 0.9784
val best accuracy score: 0.9200
val best F1 score: 0.9186
val target rna MSE score: 3.4946
val source rna MSE score: 0.3560

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
