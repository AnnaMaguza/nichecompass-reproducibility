None
Run timestamp: 16072023_231010_2015.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2015']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9824; val_auprc_score: 0.9760; val_best_acc_score: 0.9460; val_best_f1_score: 0.9475; train_kl_reg_loss: 93770.7674; train_edge_recon_loss: 26858531.7274; train_gene_expr_recon_loss: 11597579.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38549882.3588; train_optim_loss: 38549882.3588; val_kl_reg_loss: 109655.7855; val_edge_recon_loss: 26128422.3750; val_gene_expr_recon_loss: 10676310.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36914388.6000; val_optim_loss: 36914388.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9845; val_auprc_score: 0.9797; val_best_acc_score: 0.9486; val_best_f1_score: 0.9499; train_kl_reg_loss: 106094.0434; train_edge_recon_loss: 25988464.0362; train_gene_expr_recon_loss: 10427090.6078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36521648.6898; train_optim_loss: 36521648.6898; val_kl_reg_loss: 96904.0792; val_edge_recon_loss: 26015970.4000; val_gene_expr_recon_loss: 10302373.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36415247.9000; val_optim_loss: 36415247.9000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9880; val_auprc_score: 0.9842; val_best_acc_score: 0.9594; val_best_f1_score: 0.9604; train_kl_reg_loss: 90937.8246; train_edge_recon_loss: 25907397.7441; train_gene_expr_recon_loss: 10139262.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36137598.2253; train_optim_loss: 36137598.2253; val_kl_reg_loss: 82404.7218; val_edge_recon_loss: 25882350.5000; val_gene_expr_recon_loss: 10054249.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36019004.7500; val_optim_loss: 36019004.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9865; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 81167.0268; train_edge_recon_loss: 25808131.1182; train_gene_expr_recon_loss: 9989141.8484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35878439.9944; train_optim_loss: 35878439.9944; val_kl_reg_loss: 77941.7717; val_edge_recon_loss: 25806429.0250; val_gene_expr_recon_loss: 9969292.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35853663.4000; val_optim_loss: 35853663.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9884; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 75834.7539; train_edge_recon_loss: 25753201.4798; train_gene_expr_recon_loss: 9895704.0765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35724740.4451; train_optim_loss: 35724740.4451; val_kl_reg_loss: 70479.0318; val_edge_recon_loss: 25755019.4000; val_gene_expr_recon_loss: 9929860.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35755359.0500; val_optim_loss: 35755359.0500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9886; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 70075.5410; train_edge_recon_loss: 25704763.4520; train_gene_expr_recon_loss: 9829668.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35604507.5994; train_optim_loss: 35604507.5994; val_kl_reg_loss: 68314.5232; val_edge_recon_loss: 25710398.3500; val_gene_expr_recon_loss: 9847000.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35625713.9500; val_optim_loss: 35625713.9500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9921; val_auprc_score: 0.9894; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 65808.0216; train_edge_recon_loss: 25677567.8136; train_gene_expr_recon_loss: 9780774.6634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35524150.4812; train_optim_loss: 35524150.4812; val_kl_reg_loss: 63392.8076; val_edge_recon_loss: 25680852.3250; val_gene_expr_recon_loss: 9796341.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35540587.2000; val_optim_loss: 35540587.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9928; val_auprc_score: 0.9906; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 62461.2324; train_edge_recon_loss: 25657024.5035; train_gene_expr_recon_loss: 9735331.0376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35454816.8456; train_optim_loss: 35454816.8456; val_kl_reg_loss: 59727.9357; val_edge_recon_loss: 25669134.2500; val_gene_expr_recon_loss: 9784346.0125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35513208.1000; val_optim_loss: 35513208.1000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 59491.4300; train_edge_recon_loss: 25629690.6453; train_gene_expr_recon_loss: 9708421.2211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35397603.2601; train_optim_loss: 35397603.2601; val_kl_reg_loss: 58337.1623; val_edge_recon_loss: 25675091.1250; val_gene_expr_recon_loss: 9779669.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35513097.9000; val_optim_loss: 35513097.9000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9921; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 57339.5274; train_edge_recon_loss: 25615083.4186; train_gene_expr_recon_loss: 9679550.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35351973.2907; train_optim_loss: 35351973.2907; val_kl_reg_loss: 55529.0535; val_edge_recon_loss: 25631545.3000; val_gene_expr_recon_loss: 9767541.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35454616.4500; val_optim_loss: 35454616.4500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9937; val_auprc_score: 0.9917; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 55330.4243; train_edge_recon_loss: 25586175.8832; train_gene_expr_recon_loss: 9652340.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35293847.1210; train_optim_loss: 35293847.1210; val_kl_reg_loss: 54590.8832; val_edge_recon_loss: 25650830.4250; val_gene_expr_recon_loss: 9739200.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35444622.4000; val_optim_loss: 35444622.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 53745.1013; train_edge_recon_loss: 25585379.3213; train_gene_expr_recon_loss: 9630562.4409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35269686.8317; train_optim_loss: 35269686.8317; val_kl_reg_loss: 52933.1200; val_edge_recon_loss: 25582067.1750; val_gene_expr_recon_loss: 9747578.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35382579.0500; val_optim_loss: 35382579.0500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 52111.8012; train_edge_recon_loss: 25565138.1975; train_gene_expr_recon_loss: 9601145.7608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35218395.6885; train_optim_loss: 35218395.6885; val_kl_reg_loss: 50733.0945; val_edge_recon_loss: 25600578.5250; val_gene_expr_recon_loss: 9730945.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35382257.6000; val_optim_loss: 35382257.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 51021.6384; train_edge_recon_loss: 25564892.9291; train_gene_expr_recon_loss: 9583098.1488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35199012.7344; train_optim_loss: 35199012.7344; val_kl_reg_loss: 50139.3899; val_edge_recon_loss: 25590575.5750; val_gene_expr_recon_loss: 9711220.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35351935.7000; val_optim_loss: 35351935.7000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 49677.2585; train_edge_recon_loss: 25556475.5382; train_gene_expr_recon_loss: 9554294.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35160447.8164; train_optim_loss: 35160447.8164; val_kl_reg_loss: 50019.2762; val_edge_recon_loss: 25582713.7500; val_gene_expr_recon_loss: 9760557.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35393290.9000; val_optim_loss: 35393290.9000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 48891.3647; train_edge_recon_loss: 25553864.0974; train_gene_expr_recon_loss: 9542225.4451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35144980.8957; train_optim_loss: 35144980.8957; val_kl_reg_loss: 48012.3346; val_edge_recon_loss: 25567597.6250; val_gene_expr_recon_loss: 9717667.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35333277.1500; val_optim_loss: 35333277.1500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 48103.7005; train_edge_recon_loss: 25544032.2086; train_gene_expr_recon_loss: 9520787.9159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35112923.7886; train_optim_loss: 35112923.7886; val_kl_reg_loss: 48432.4604; val_edge_recon_loss: 25556482.3750; val_gene_expr_recon_loss: 9745874.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35350789.4000; val_optim_loss: 35350789.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9953; val_auprc_score: 0.9937; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 47380.7886; train_edge_recon_loss: 25540729.5132; train_gene_expr_recon_loss: 9511124.9875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35099235.3324; train_optim_loss: 35099235.3324; val_kl_reg_loss: 47106.8841; val_edge_recon_loss: 25585432.8250; val_gene_expr_recon_loss: 9730305.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35362845.8000; val_optim_loss: 35362845.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 46729.2282; train_edge_recon_loss: 25541051.5271; train_gene_expr_recon_loss: 9493821.2782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35081602.1307; train_optim_loss: 35081602.1307; val_kl_reg_loss: 46019.1217; val_edge_recon_loss: 25542836.5250; val_gene_expr_recon_loss: 9716978.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35305834.2500; val_optim_loss: 35305834.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 46161.3038; train_edge_recon_loss: 25531955.0348; train_gene_expr_recon_loss: 9473199.5981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35051315.8776; train_optim_loss: 35051315.8776; val_kl_reg_loss: 46355.6273; val_edge_recon_loss: 25545507.5250; val_gene_expr_recon_loss: 9744953.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35336816.9000; val_optim_loss: 35336816.9000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 45808.0984; train_edge_recon_loss: 25528615.3241; train_gene_expr_recon_loss: 9454982.9346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35029406.3310; train_optim_loss: 35029406.3310; val_kl_reg_loss: 44896.6138; val_edge_recon_loss: 25575766.0000; val_gene_expr_recon_loss: 9742053.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35362716.3000; val_optim_loss: 35362716.3000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9949; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 45197.8184; train_edge_recon_loss: 25522047.5911; train_gene_expr_recon_loss: 9444462.9548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35011708.3783; train_optim_loss: 35011708.3783; val_kl_reg_loss: 44373.9687; val_edge_recon_loss: 25523301.7250; val_gene_expr_recon_loss: 9732855.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35300531.2000; val_optim_loss: 35300531.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 44575.6681; train_edge_recon_loss: 25522171.4798; train_gene_expr_recon_loss: 9425740.4256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34992487.5883; train_optim_loss: 34992487.5883; val_kl_reg_loss: 44904.7168; val_edge_recon_loss: 25525676.1000; val_gene_expr_recon_loss: 9722903.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35293484.3000; val_optim_loss: 35293484.3000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 44515.8590; train_edge_recon_loss: 25521641.0542; train_gene_expr_recon_loss: 9410196.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34976353.5577; train_optim_loss: 34976353.5577; val_kl_reg_loss: 43451.2977; val_edge_recon_loss: 25557253.1750; val_gene_expr_recon_loss: 9751569.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35352273.6000; val_optim_loss: 35352273.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 43943.9076; train_edge_recon_loss: 25507029.0014; train_gene_expr_recon_loss: 9401827.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34952800.1057; train_optim_loss: 34952800.1057; val_kl_reg_loss: 44119.4112; val_edge_recon_loss: 25545090.4250; val_gene_expr_recon_loss: 9764286.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35353496.7500; val_optim_loss: 35353496.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 43592.9807; train_edge_recon_loss: 25502154.9263; train_gene_expr_recon_loss: 9388874.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34934622.1196; train_optim_loss: 34934622.1196; val_kl_reg_loss: 43585.3323; val_edge_recon_loss: 25525260.6500; val_gene_expr_recon_loss: 9751815.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35320661.8500; val_optim_loss: 35320661.8500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 43478.2616; train_edge_recon_loss: 25504725.5494; train_gene_expr_recon_loss: 9380149.4159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34928353.1905; train_optim_loss: 34928353.1905; val_kl_reg_loss: 42869.4688; val_edge_recon_loss: 25515568.6500; val_gene_expr_recon_loss: 9775939.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35334377.3500; val_optim_loss: 35334377.3500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9961; val_auprc_score: 0.9944; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 46221.7965; train_edge_recon_loss: 25496311.9917; train_gene_expr_recon_loss: 9286407.0487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34828940.8122; train_optim_loss: 34828940.8122; val_kl_reg_loss: 47417.6207; val_edge_recon_loss: 25528738.0000; val_gene_expr_recon_loss: 9714796.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35290951.5500; val_optim_loss: 35290951.5500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 48226.9299; train_edge_recon_loss: 25490582.1752; train_gene_expr_recon_loss: 9277438.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34816247.3880; train_optim_loss: 34816247.3880; val_kl_reg_loss: 48279.2268; val_edge_recon_loss: 25539670.3500; val_gene_expr_recon_loss: 9750235.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35338185.1500; val_optim_loss: 35338185.1500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 48772.0205; train_edge_recon_loss: 25481910.9207; train_gene_expr_recon_loss: 9274421.8095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34805104.7121; train_optim_loss: 34805104.7121; val_kl_reg_loss: 48299.2116; val_edge_recon_loss: 25517828.0000; val_gene_expr_recon_loss: 9709931.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35276058.4000; val_optim_loss: 35276058.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 49032.5024; train_edge_recon_loss: 25488968.9318; train_gene_expr_recon_loss: 9271161.3804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34809162.7761; train_optim_loss: 34809162.7761; val_kl_reg_loss: 48675.2893; val_edge_recon_loss: 25507375.7250; val_gene_expr_recon_loss: 9724285.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280337.0000; val_optim_loss: 35280337.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 49449.7230; train_edge_recon_loss: 25491441.4159; train_gene_expr_recon_loss: 9262978.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34803869.9360; train_optim_loss: 34803869.9360; val_kl_reg_loss: 49105.9524; val_edge_recon_loss: 25513681.5000; val_gene_expr_recon_loss: 9729576.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35292364.4000; val_optim_loss: 35292364.4000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 49605.2830; train_edge_recon_loss: 25481553.4743; train_gene_expr_recon_loss: 9261386.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34792545.3964; train_optim_loss: 34792545.3964; val_kl_reg_loss: 49141.8726; val_edge_recon_loss: 25507205.6750; val_gene_expr_recon_loss: 9725374.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281721.8500; val_optim_loss: 35281721.8500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9948; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 49620.2014; train_edge_recon_loss: 25487560.0389; train_gene_expr_recon_loss: 9256828.7357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34794009.0515; train_optim_loss: 34794009.0515; val_kl_reg_loss: 49221.1998; val_edge_recon_loss: 25527279.9000; val_gene_expr_recon_loss: 9769210.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35345711.8500; val_optim_loss: 35345711.8500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 49762.9262; train_edge_recon_loss: 25486946.8150; train_gene_expr_recon_loss: 9246382.6850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34783092.3950; train_optim_loss: 34783092.3950; val_kl_reg_loss: 49336.6575; val_edge_recon_loss: 25529355.4250; val_gene_expr_recon_loss: 9724164.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302856.4500; val_optim_loss: 35302856.4500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 49916.3471; train_edge_recon_loss: 25478413.7107; train_gene_expr_recon_loss: 9254922.5271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34783252.5953; train_optim_loss: 34783252.5953; val_kl_reg_loss: 49472.0187; val_edge_recon_loss: 25489211.5500; val_gene_expr_recon_loss: 9742629.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35281312.5500; val_optim_loss: 35281312.5500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 49979.5945; train_edge_recon_loss: 25481743.0682; train_gene_expr_recon_loss: 9250054.4645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34781776.9958; train_optim_loss: 34781776.9958; val_kl_reg_loss: 49514.4815; val_edge_recon_loss: 25521090.4500; val_gene_expr_recon_loss: 9738662.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35309267.5500; val_optim_loss: 35309267.5500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 50046.6374; train_edge_recon_loss: 25490892.1530; train_gene_expr_recon_loss: 9241756.6676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34782695.4659; train_optim_loss: 34782695.4659; val_kl_reg_loss: 49617.9292; val_edge_recon_loss: 25511377.6500; val_gene_expr_recon_loss: 9745317.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35306312.6500; val_optim_loss: 35306312.6500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 351 min 1 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9949
Val best accuracy score: 0.9825
Val best F1 score: 0.9826
Val gene expr MSE score: 0.6119

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
