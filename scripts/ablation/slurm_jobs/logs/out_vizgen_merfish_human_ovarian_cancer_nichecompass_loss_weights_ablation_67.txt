None
Run timestamp: 29072023_013341_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9936; val_auprc_score: 0.9931; val_best_acc_score: 0.9623; val_best_f1_score: 0.9624; train_kl_reg_loss: 2180.2679; train_edge_recon_loss: 27650.3936; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29830.6614; train_optim_loss: 29830.6614; val_kl_reg_loss: 2230.0171; val_edge_recon_loss: 26070.0624; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28300.0794; val_optim_loss: 28300.0794
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9672; val_best_f1_score: 0.9673; train_kl_reg_loss: 2274.0027; train_edge_recon_loss: 27238.3621; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29512.3648; train_optim_loss: 29512.3648; val_kl_reg_loss: 2253.7616; val_edge_recon_loss: 25984.9516; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28238.7132; val_optim_loss: 28238.7132
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9960; val_auprc_score: 0.9956; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 2286.5172; train_edge_recon_loss: 27172.9519; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29459.4691; train_optim_loss: 29459.4691; val_kl_reg_loss: 2221.1472; val_edge_recon_loss: 25951.6976; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28172.8448; val_optim_loss: 28172.8448
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9963; val_auprc_score: 0.9957; val_best_acc_score: 0.9735; val_best_f1_score: 0.9735; train_kl_reg_loss: 2293.6768; train_edge_recon_loss: 27130.1281; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29423.8049; train_optim_loss: 29423.8049; val_kl_reg_loss: 2218.1528; val_edge_recon_loss: 25911.5121; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28129.6649; val_optim_loss: 28129.6649
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 2297.8320; train_edge_recon_loss: 27107.6326; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29405.4646; train_optim_loss: 29405.4646; val_kl_reg_loss: 2231.6467; val_edge_recon_loss: 25920.3510; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28151.9977; val_optim_loss: 28151.9977
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 2299.1707; train_edge_recon_loss: 27085.3837; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29384.5544; train_optim_loss: 29384.5544; val_kl_reg_loss: 2251.3785; val_edge_recon_loss: 25888.6811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28140.0596; val_optim_loss: 28140.0596
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 2300.5347; train_edge_recon_loss: 27074.7477; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29375.2824; train_optim_loss: 29375.2824; val_kl_reg_loss: 2262.1051; val_edge_recon_loss: 25884.1282; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28146.2333; val_optim_loss: 28146.2333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 2301.1512; train_edge_recon_loss: 27063.5530; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29364.7041; train_optim_loss: 29364.7041; val_kl_reg_loss: 2289.3219; val_edge_recon_loss: 25853.7410; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28143.0629; val_optim_loss: 28143.0629

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9809; val_best_f1_score: 0.9809; train_kl_reg_loss: 2299.1126; train_edge_recon_loss: 27006.9063; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29306.0190; train_optim_loss: 29306.0190; val_kl_reg_loss: 2318.3327; val_edge_recon_loss: 25808.9982; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28127.3309; val_optim_loss: 28127.3309
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 2298.9394; train_edge_recon_loss: 26998.4650; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29297.4044; train_optim_loss: 29297.4044; val_kl_reg_loss: 2274.1892; val_edge_recon_loss: 25794.8115; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28069.0007; val_optim_loss: 28069.0007
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9811; val_best_f1_score: 0.9811; train_kl_reg_loss: 2296.9754; train_edge_recon_loss: 26998.6722; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29295.6476; train_optim_loss: 29295.6476; val_kl_reg_loss: 2289.5695; val_edge_recon_loss: 25804.7580; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28094.3276; val_optim_loss: 28094.3276
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 2297.0782; train_edge_recon_loss: 26994.5641; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29291.6423; train_optim_loss: 29291.6423; val_kl_reg_loss: 2273.9502; val_edge_recon_loss: 25804.4973; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28078.4475; val_optim_loss: 28078.4475
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 2295.7695; train_edge_recon_loss: 26995.8802; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29291.6497; train_optim_loss: 29291.6497; val_kl_reg_loss: 2282.1898; val_edge_recon_loss: 25798.8784; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28081.0683; val_optim_loss: 28081.0683
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9817; val_best_f1_score: 0.9817; train_kl_reg_loss: 2295.4551; train_edge_recon_loss: 26994.9478; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29290.4029; train_optim_loss: 29290.4029; val_kl_reg_loss: 2274.7750; val_edge_recon_loss: 25804.0021; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28078.7771; val_optim_loss: 28078.7771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9822; train_kl_reg_loss: 2294.5480; train_edge_recon_loss: 26988.5706; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29283.1186; train_optim_loss: 29283.1186; val_kl_reg_loss: 2283.3501; val_edge_recon_loss: 25780.6889; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28064.0390; val_optim_loss: 28064.0390
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 2295.7753; train_edge_recon_loss: 26986.1903; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29281.9656; train_optim_loss: 29281.9656; val_kl_reg_loss: 2277.7899; val_edge_recon_loss: 25768.9058; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28046.6958; val_optim_loss: 28046.6958
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 2294.9909; train_edge_recon_loss: 26984.6444; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29279.6353; train_optim_loss: 29279.6353; val_kl_reg_loss: 2278.3568; val_edge_recon_loss: 25780.7325; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28059.0893; val_optim_loss: 28059.0893
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 2294.7117; train_edge_recon_loss: 26984.7986; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29279.5102; train_optim_loss: 29279.5102; val_kl_reg_loss: 2284.5205; val_edge_recon_loss: 25791.6266; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28076.1472; val_optim_loss: 28076.1472
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9821; val_best_f1_score: 0.9822; train_kl_reg_loss: 2294.8451; train_edge_recon_loss: 26984.8251; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29279.6702; train_optim_loss: 29279.6702; val_kl_reg_loss: 2283.9129; val_edge_recon_loss: 25793.3191; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28077.2319; val_optim_loss: 28077.2319
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9823; val_best_f1_score: 0.9823; train_kl_reg_loss: 2295.2333; train_edge_recon_loss: 26981.6015; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29276.8348; train_optim_loss: 29276.8348; val_kl_reg_loss: 2287.4681; val_edge_recon_loss: 25765.8220; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28053.2901; val_optim_loss: 28053.2901

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 2296.4869; train_edge_recon_loss: 26979.4759; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29275.9628; train_optim_loss: 29275.9628; val_kl_reg_loss: 2286.9381; val_edge_recon_loss: 25769.1794; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28056.1176; val_optim_loss: 28056.1176
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9823; val_best_f1_score: 0.9823; train_kl_reg_loss: 2294.5738; train_edge_recon_loss: 26985.3982; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29279.9720; train_optim_loss: 29279.9720; val_kl_reg_loss: 2286.0224; val_edge_recon_loss: 25775.2425; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28061.2648; val_optim_loss: 28061.2648
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 2295.3747; train_edge_recon_loss: 26982.7976; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29278.1724; train_optim_loss: 29278.1724; val_kl_reg_loss: 2288.0123; val_edge_recon_loss: 25780.7083; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28068.7206; val_optim_loss: 28068.7206
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 2295.9077; train_edge_recon_loss: 26981.0183; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29276.9260; train_optim_loss: 29276.9260; val_kl_reg_loss: 2286.8512; val_edge_recon_loss: 25772.2919; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28059.1431; val_optim_loss: 28059.1431

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 309 min 22 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9979
val AUPRC score: 0.9976
val best accuracy score: 0.9819
val best F1 score: 0.9820
val target rna MSE score: 13.4177
val source rna MSE score: 6.9557

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
