None
Run timestamp: 29072023_040733_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9897; val_auprc_score: 0.9899; val_best_acc_score: 0.9466; val_best_f1_score: 0.9468; train_kl_reg_loss: 4224.1655; train_edge_recon_loss: 30313.9693; train_gene_expr_recon_loss: 195772.1358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 230310.2707; train_optim_loss: 230310.2707; val_kl_reg_loss: 3619.7025; val_edge_recon_loss: 28346.5747; val_gene_expr_recon_loss: 180678.0712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 212644.3485; val_optim_loss: 212644.3485
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9931; val_auprc_score: 0.9932; val_best_acc_score: 0.9575; val_best_f1_score: 0.9576; train_kl_reg_loss: 3723.0500; train_edge_recon_loss: 28368.2732; train_gene_expr_recon_loss: 176979.6244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 209070.9476; train_optim_loss: 209070.9476; val_kl_reg_loss: 3646.7566; val_edge_recon_loss: 27610.7702; val_gene_expr_recon_loss: 174587.4585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 205844.9854; val_optim_loss: 205844.9854
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9941; val_auprc_score: 0.9941; val_best_acc_score: 0.9608; val_best_f1_score: 0.9608; train_kl_reg_loss: 3703.0145; train_edge_recon_loss: 27907.2715; train_gene_expr_recon_loss: 173609.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 205219.9714; train_optim_loss: 205219.9714; val_kl_reg_loss: 3636.2328; val_edge_recon_loss: 27301.4524; val_gene_expr_recon_loss: 172688.1691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203625.8540; val_optim_loss: 203625.8540
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9949; val_auprc_score: 0.9948; val_best_acc_score: 0.9638; val_best_f1_score: 0.9638; train_kl_reg_loss: 3724.3474; train_edge_recon_loss: 27704.0187; train_gene_expr_recon_loss: 172418.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 203847.2100; train_optim_loss: 203847.2100; val_kl_reg_loss: 3709.3412; val_edge_recon_loss: 27159.8893; val_gene_expr_recon_loss: 171894.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202763.9735; val_optim_loss: 202763.9735
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9957; val_auprc_score: 0.9956; val_best_acc_score: 0.9673; val_best_f1_score: 0.9674; train_kl_reg_loss: 3742.3898; train_edge_recon_loss: 27593.9640; train_gene_expr_recon_loss: 171772.7677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 203109.1217; train_optim_loss: 203109.1217; val_kl_reg_loss: 3713.8664; val_edge_recon_loss: 27072.9912; val_gene_expr_recon_loss: 171670.6339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202457.4916; val_optim_loss: 202457.4916
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9958; val_auprc_score: 0.9957; val_best_acc_score: 0.9675; val_best_f1_score: 0.9675; train_kl_reg_loss: 3758.5797; train_edge_recon_loss: 27529.5844; train_gene_expr_recon_loss: 171474.8764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202763.0404; train_optim_loss: 202763.0404; val_kl_reg_loss: 3626.2118; val_edge_recon_loss: 27036.9214; val_gene_expr_recon_loss: 171710.3717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202373.5051; val_optim_loss: 202373.5051
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9962; val_auprc_score: 0.9962; val_best_acc_score: 0.9694; val_best_f1_score: 0.9694; train_kl_reg_loss: 3774.5010; train_edge_recon_loss: 27481.7800; train_gene_expr_recon_loss: 171287.6036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202543.8847; train_optim_loss: 202543.8847; val_kl_reg_loss: 3713.3864; val_edge_recon_loss: 27003.4661; val_gene_expr_recon_loss: 171347.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202064.2446; val_optim_loss: 202064.2446
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9962; val_auprc_score: 0.9961; val_best_acc_score: 0.9694; val_best_f1_score: 0.9694; train_kl_reg_loss: 3784.2048; train_edge_recon_loss: 27452.5582; train_gene_expr_recon_loss: 171082.1190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202318.8819; train_optim_loss: 202318.8819; val_kl_reg_loss: 3718.2889; val_edge_recon_loss: 27008.6134; val_gene_expr_recon_loss: 171272.8152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201999.7173; val_optim_loss: 201999.7173
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9965; val_auprc_score: 0.9965; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 3796.1058; train_edge_recon_loss: 27423.1599; train_gene_expr_recon_loss: 170980.4806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202199.7463; train_optim_loss: 202199.7463; val_kl_reg_loss: 3792.5265; val_edge_recon_loss: 26926.3242; val_gene_expr_recon_loss: 171065.3757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201784.2266; val_optim_loss: 201784.2266
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9714; val_best_f1_score: 0.9714; train_kl_reg_loss: 3802.6959; train_edge_recon_loss: 27410.3133; train_gene_expr_recon_loss: 170845.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202058.1069; train_optim_loss: 202058.1069; val_kl_reg_loss: 3730.9137; val_edge_recon_loss: 26967.5437; val_gene_expr_recon_loss: 171080.4486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201778.9063; val_optim_loss: 201778.9063
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9966; val_best_acc_score: 0.9716; val_best_f1_score: 0.9717; train_kl_reg_loss: 3808.9914; train_edge_recon_loss: 27397.1778; train_gene_expr_recon_loss: 170779.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201985.3938; train_optim_loss: 201985.3938; val_kl_reg_loss: 3779.9969; val_edge_recon_loss: 26930.0073; val_gene_expr_recon_loss: 171048.6343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201758.6385; val_optim_loss: 201758.6385
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9713; val_best_f1_score: 0.9713; train_kl_reg_loss: 3812.3289; train_edge_recon_loss: 27381.9907; train_gene_expr_recon_loss: 170680.6894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201875.0090; train_optim_loss: 201875.0090; val_kl_reg_loss: 3848.3232; val_edge_recon_loss: 26880.1057; val_gene_expr_recon_loss: 170934.8291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201663.2576; val_optim_loss: 201663.2576
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9721; val_best_f1_score: 0.9721; train_kl_reg_loss: 3816.8592; train_edge_recon_loss: 27372.5703; train_gene_expr_recon_loss: 170657.9101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201847.3397; train_optim_loss: 201847.3397; val_kl_reg_loss: 3789.3035; val_edge_recon_loss: 26912.0202; val_gene_expr_recon_loss: 171175.2254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201876.5487; val_optim_loss: 201876.5487
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9967; val_auprc_score: 0.9967; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 3820.1937; train_edge_recon_loss: 27368.1610; train_gene_expr_recon_loss: 170627.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201815.7877; train_optim_loss: 201815.7877; val_kl_reg_loss: 3782.4224; val_edge_recon_loss: 26907.5100; val_gene_expr_recon_loss: 170833.8186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201523.7509; val_optim_loss: 201523.7509
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9967; val_auprc_score: 0.9967; val_best_acc_score: 0.9716; val_best_f1_score: 0.9716; train_kl_reg_loss: 3821.5629; train_edge_recon_loss: 27363.7440; train_gene_expr_recon_loss: 170669.1461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201854.4529; train_optim_loss: 201854.4529; val_kl_reg_loss: 3777.9068; val_edge_recon_loss: 26923.4135; val_gene_expr_recon_loss: 171030.4740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201731.7941; val_optim_loss: 201731.7941
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9724; val_best_f1_score: 0.9725; train_kl_reg_loss: 3824.1262; train_edge_recon_loss: 27359.5332; train_gene_expr_recon_loss: 170862.5381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202046.1976; train_optim_loss: 202046.1976; val_kl_reg_loss: 3771.1691; val_edge_recon_loss: 26925.4113; val_gene_expr_recon_loss: 171663.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202360.1649; val_optim_loss: 202360.1649
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9968; val_best_acc_score: 0.9724; val_best_f1_score: 0.9724; train_kl_reg_loss: 3823.3565; train_edge_recon_loss: 27361.5192; train_gene_expr_recon_loss: 171264.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202449.4782; train_optim_loss: 202449.4782; val_kl_reg_loss: 3773.0623; val_edge_recon_loss: 26902.7757; val_gene_expr_recon_loss: 172398.0812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203073.9191; val_optim_loss: 203073.9191
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 3826.1578; train_edge_recon_loss: 27352.4766; train_gene_expr_recon_loss: 171629.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202807.8039; train_optim_loss: 202807.8039; val_kl_reg_loss: 3819.0245; val_edge_recon_loss: 26910.2097; val_gene_expr_recon_loss: 183044.5223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 213773.7566; val_optim_loss: 213773.7566

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 3791.9502; train_edge_recon_loss: 27301.4248; train_gene_expr_recon_loss: 170682.7986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201776.1737; train_optim_loss: 201776.1737; val_kl_reg_loss: 3723.3909; val_edge_recon_loss: 26860.0513; val_gene_expr_recon_loss: 172345.7591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202929.2017; val_optim_loss: 202929.2017
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9747; val_best_f1_score: 0.9747; train_kl_reg_loss: 3756.5935; train_edge_recon_loss: 27329.8813; train_gene_expr_recon_loss: 170669.1263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201755.6010; train_optim_loss: 201755.6010; val_kl_reg_loss: 3703.6630; val_edge_recon_loss: 26857.7588; val_gene_expr_recon_loss: 166886.8597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 197448.2813; val_optim_loss: 197448.2813
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9973; val_auprc_score: 0.9973; val_best_acc_score: 0.9748; val_best_f1_score: 0.9748; train_kl_reg_loss: 3746.4461; train_edge_recon_loss: 27343.3784; train_gene_expr_recon_loss: 170609.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201699.1335; train_optim_loss: 201699.1335; val_kl_reg_loss: 3715.5837; val_edge_recon_loss: 26859.4588; val_gene_expr_recon_loss: 181229.4837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 211804.5266; val_optim_loss: 211804.5266
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9754; val_best_f1_score: 0.9754; train_kl_reg_loss: 3743.7977; train_edge_recon_loss: 27341.1810; train_gene_expr_recon_loss: 170665.4867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201750.4655; train_optim_loss: 201750.4655; val_kl_reg_loss: 3707.2930; val_edge_recon_loss: 26874.2507; val_gene_expr_recon_loss: 173249.6504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203831.1940; val_optim_loss: 203831.1940
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 3740.1004; train_edge_recon_loss: 27347.4658; train_gene_expr_recon_loss: 170822.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201910.0693; train_optim_loss: 201910.0693; val_kl_reg_loss: 3707.7466; val_edge_recon_loss: 26864.9707; val_gene_expr_recon_loss: 170800.3609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201373.0780; val_optim_loss: 201373.0780
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9975; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 3739.3029; train_edge_recon_loss: 27348.1836; train_gene_expr_recon_loss: 170737.4985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 201824.9848; train_optim_loss: 201824.9848; val_kl_reg_loss: 3711.3609; val_edge_recon_loss: 26853.0815; val_gene_expr_recon_loss: 168286.6472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 198851.0894; val_optim_loss: 198851.0894

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9755; val_best_f1_score: 0.9755; train_kl_reg_loss: 3739.5169; train_edge_recon_loss: 27336.6582; train_gene_expr_recon_loss: 169224.4075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 200300.5827; train_optim_loss: 200300.5827; val_kl_reg_loss: 3705.6908; val_edge_recon_loss: 26856.4749; val_gene_expr_recon_loss: 172171.9897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 202734.1551; val_optim_loss: 202734.1551
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 3738.8785; train_edge_recon_loss: 27335.8021; train_gene_expr_recon_loss: 169125.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 200200.2496; train_optim_loss: 200200.2496; val_kl_reg_loss: 3705.1791; val_edge_recon_loss: 26855.1732; val_gene_expr_recon_loss: 165596.4874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 196156.8396; val_optim_loss: 196156.8396
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9755; val_best_f1_score: 0.9755; train_kl_reg_loss: 3737.2072; train_edge_recon_loss: 27333.5952; train_gene_expr_recon_loss: 167325.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 198395.9626; train_optim_loss: 198395.9626; val_kl_reg_loss: 3701.7384; val_edge_recon_loss: 26855.6598; val_gene_expr_recon_loss: 168655.8703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 199213.2684; val_optim_loss: 199213.2684
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 3735.5130; train_edge_recon_loss: 27338.8420; train_gene_expr_recon_loss: 168794.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 199868.7110; train_optim_loss: 199868.7110; val_kl_reg_loss: 3701.0689; val_edge_recon_loss: 26864.9460; val_gene_expr_recon_loss: 170911.3110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201477.3261; val_optim_loss: 201477.3261
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 3733.8242; train_edge_recon_loss: 27343.8243; train_gene_expr_recon_loss: 171764.2140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 202841.8625; train_optim_loss: 202841.8625; val_kl_reg_loss: 3699.5313; val_edge_recon_loss: 26878.1524; val_gene_expr_recon_loss: 181465.2416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 212042.9249; val_optim_loss: 212042.9249
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9755; val_best_f1_score: 0.9755; train_kl_reg_loss: 3732.5179; train_edge_recon_loss: 27346.3673; train_gene_expr_recon_loss: 172363.5268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 203442.4122; train_optim_loss: 203442.4122; val_kl_reg_loss: 3698.8208; val_edge_recon_loss: 26865.3582; val_gene_expr_recon_loss: 171228.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 201792.7663; val_optim_loss: 201792.7663

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 3733.0231; train_edge_recon_loss: 27342.9453; train_gene_expr_recon_loss: 178083.5369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 209159.5051; train_optim_loss: 209159.5051; val_kl_reg_loss: 3698.6665; val_edge_recon_loss: 26871.0531; val_gene_expr_recon_loss: 176154.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 206724.2013; val_optim_loss: 206724.2013
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9974; val_best_acc_score: 0.9755; val_best_f1_score: 0.9755; train_kl_reg_loss: 3732.6957; train_edge_recon_loss: 27342.9199; train_gene_expr_recon_loss: 174873.8575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 205949.4732; train_optim_loss: 205949.4732; val_kl_reg_loss: 3700.0134; val_edge_recon_loss: 26865.9622; val_gene_expr_recon_loss: 177385.8327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 207951.8083; val_optim_loss: 207951.8083
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 3732.9137; train_edge_recon_loss: 27345.3119; train_gene_expr_recon_loss: 174804.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 205883.1074; train_optim_loss: 205883.1074; val_kl_reg_loss: 3699.7768; val_edge_recon_loss: 26853.4783; val_gene_expr_recon_loss: 172768.3428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 203321.5981; val_optim_loss: 203321.5981
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9759; val_best_f1_score: 0.9759; train_kl_reg_loss: 3732.5793; train_edge_recon_loss: 27343.3733; train_gene_expr_recon_loss: 174345.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 205421.2394; train_optim_loss: 205421.2394; val_kl_reg_loss: 3697.9680; val_edge_recon_loss: 26861.0266; val_gene_expr_recon_loss: 175200.5863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 205759.5809; val_optim_loss: 205759.5809

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 451 min 36 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9975
val AUPRC score: 0.9974
val best accuracy score: 0.9759
val best F1 score: 0.9760
val target rna MSE score: 3.7445
val source rna MSE score: 0.2488

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
