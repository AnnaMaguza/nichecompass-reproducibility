None
Run timestamp: 29072023_052835_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9736; val_auprc_score: 0.9703; val_best_acc_score: 0.9192; val_best_f1_score: 0.9206; train_kl_reg_loss: 5608.0557; train_edge_recon_loss: 266713.8599; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 272321.9154; train_optim_loss: 272321.9154; val_kl_reg_loss: 5664.5890; val_edge_recon_loss: 264756.3514; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 270420.9406; val_optim_loss: 270420.9406
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9769; val_auprc_score: 0.9751; val_best_acc_score: 0.9254; val_best_f1_score: 0.9261; train_kl_reg_loss: 5620.4180; train_edge_recon_loss: 261414.7917; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 267035.2099; train_optim_loss: 267035.2099; val_kl_reg_loss: 5488.7905; val_edge_recon_loss: 264836.0820; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 270324.8722; val_optim_loss: 270324.8722
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9790; val_auprc_score: 0.9768; val_best_acc_score: 0.9290; val_best_f1_score: 0.9299; train_kl_reg_loss: 5579.5658; train_edge_recon_loss: 260975.3385; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266554.9044; train_optim_loss: 266554.9044; val_kl_reg_loss: 5416.1873; val_edge_recon_loss: 264752.0098; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 270168.1963; val_optim_loss: 270168.1963
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9822; val_auprc_score: 0.9799; val_best_acc_score: 0.9366; val_best_f1_score: 0.9370; train_kl_reg_loss: 5567.7234; train_edge_recon_loss: 260562.3357; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266130.0586; train_optim_loss: 266130.0586; val_kl_reg_loss: 5420.6527; val_edge_recon_loss: 263255.4395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268676.0909; val_optim_loss: 268676.0909
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9835; val_auprc_score: 0.9813; val_best_acc_score: 0.9394; val_best_f1_score: 0.9403; train_kl_reg_loss: 5563.1618; train_edge_recon_loss: 260185.4715; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265748.6332; train_optim_loss: 265748.6332; val_kl_reg_loss: 5554.1936; val_edge_recon_loss: 263287.7852; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268841.9790; val_optim_loss: 268841.9790
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9851; val_auprc_score: 0.9833; val_best_acc_score: 0.9417; val_best_f1_score: 0.9422; train_kl_reg_loss: 5559.6917; train_edge_recon_loss: 260120.0338; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265679.7252; train_optim_loss: 265679.7252; val_kl_reg_loss: 5578.0722; val_edge_recon_loss: 263683.1027; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269261.1756; val_optim_loss: 269261.1756
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9848; val_auprc_score: 0.9820; val_best_acc_score: 0.9426; val_best_f1_score: 0.9433; train_kl_reg_loss: 5569.5709; train_edge_recon_loss: 259807.6636; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265377.2344; train_optim_loss: 265377.2344; val_kl_reg_loss: 5500.1757; val_edge_recon_loss: 263529.6697; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269029.8463; val_optim_loss: 269029.8463
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9853; val_auprc_score: 0.9829; val_best_acc_score: 0.9441; val_best_f1_score: 0.9445; train_kl_reg_loss: 5564.1977; train_edge_recon_loss: 259797.3044; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265361.5020; train_optim_loss: 265361.5020; val_kl_reg_loss: 5523.7382; val_edge_recon_loss: 263367.1412; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268890.8793; val_optim_loss: 268890.8793

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9872; val_auprc_score: 0.9853; val_best_acc_score: 0.9476; val_best_f1_score: 0.9482; train_kl_reg_loss: 5552.0690; train_edge_recon_loss: 259238.6023; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264790.6719; train_optim_loss: 264790.6719; val_kl_reg_loss: 5467.6785; val_edge_recon_loss: 262683.4274; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268151.1065; val_optim_loss: 268151.1065
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9873; val_auprc_score: 0.9856; val_best_acc_score: 0.9482; val_best_f1_score: 0.9488; train_kl_reg_loss: 5533.5855; train_edge_recon_loss: 259287.1268; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264820.7127; train_optim_loss: 264820.7127; val_kl_reg_loss: 5435.2627; val_edge_recon_loss: 262983.5882; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268418.8523; val_optim_loss: 268418.8523
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9880; val_auprc_score: 0.9859; val_best_acc_score: 0.9504; val_best_f1_score: 0.9510; train_kl_reg_loss: 5529.5244; train_edge_recon_loss: 259196.1904; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264725.7149; train_optim_loss: 264725.7149; val_kl_reg_loss: 5427.3141; val_edge_recon_loss: 262516.4395; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267943.7523; val_optim_loss: 267943.7523
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9879; val_auprc_score: 0.9860; val_best_acc_score: 0.9499; val_best_f1_score: 0.9502; train_kl_reg_loss: 5523.8287; train_edge_recon_loss: 259252.7753; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264776.6035; train_optim_loss: 264776.6035; val_kl_reg_loss: 5506.9724; val_edge_recon_loss: 262909.9700; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268416.9423; val_optim_loss: 268416.9423
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9876; val_auprc_score: 0.9855; val_best_acc_score: 0.9501; val_best_f1_score: 0.9505; train_kl_reg_loss: 5516.0089; train_edge_recon_loss: 259207.3227; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264723.3318; train_optim_loss: 264723.3318; val_kl_reg_loss: 5423.9173; val_edge_recon_loss: 262895.2192; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268319.1366; val_optim_loss: 268319.1366
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9880; val_auprc_score: 0.9861; val_best_acc_score: 0.9506; val_best_f1_score: 0.9511; train_kl_reg_loss: 5518.1666; train_edge_recon_loss: 259202.5031; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264720.6693; train_optim_loss: 264720.6693; val_kl_reg_loss: 5418.5176; val_edge_recon_loss: 262572.3946; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267990.9116; val_optim_loss: 267990.9116
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9864; val_best_acc_score: 0.9505; val_best_f1_score: 0.9509; train_kl_reg_loss: 5519.9045; train_edge_recon_loss: 259034.5741; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264554.4787; train_optim_loss: 264554.4787; val_kl_reg_loss: 5434.3745; val_edge_recon_loss: 262452.8690; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267887.2435; val_optim_loss: 267887.2435
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9862; val_best_acc_score: 0.9501; val_best_f1_score: 0.9504; train_kl_reg_loss: 5515.7834; train_edge_recon_loss: 259134.5705; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264650.3543; train_optim_loss: 264650.3543; val_kl_reg_loss: 5454.1244; val_edge_recon_loss: 262896.0406; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268350.1645; val_optim_loss: 268350.1645
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9886; val_auprc_score: 0.9872; val_best_acc_score: 0.9513; val_best_f1_score: 0.9517; train_kl_reg_loss: 5517.0327; train_edge_recon_loss: 259028.0219; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264545.0544; train_optim_loss: 264545.0544; val_kl_reg_loss: 5484.8421; val_edge_recon_loss: 262590.7241; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268075.5662; val_optim_loss: 268075.5662
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9891; val_auprc_score: 0.9877; val_best_acc_score: 0.9528; val_best_f1_score: 0.9533; train_kl_reg_loss: 5510.8244; train_edge_recon_loss: 259170.0396; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264680.8638; train_optim_loss: 264680.8638; val_kl_reg_loss: 5405.1829; val_edge_recon_loss: 262312.0537; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267717.2374; val_optim_loss: 267717.2374
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9886; val_auprc_score: 0.9866; val_best_acc_score: 0.9517; val_best_f1_score: 0.9521; train_kl_reg_loss: 5510.3728; train_edge_recon_loss: 259153.9221; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264664.2946; train_optim_loss: 264664.2946; val_kl_reg_loss: 5346.8175; val_edge_recon_loss: 262507.9232; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267854.7412; val_optim_loss: 267854.7412
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9516; val_best_f1_score: 0.9521; train_kl_reg_loss: 5508.8830; train_edge_recon_loss: 259134.6213; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264643.5048; train_optim_loss: 264643.5048; val_kl_reg_loss: 5390.1968; val_edge_recon_loss: 262489.0196; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267879.2173; val_optim_loss: 267879.2173
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9871; val_best_acc_score: 0.9528; val_best_f1_score: 0.9533; train_kl_reg_loss: 5509.3959; train_edge_recon_loss: 259083.5312; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264592.9270; train_optim_loss: 264592.9270; val_kl_reg_loss: 5436.0004; val_edge_recon_loss: 262277.3145; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267713.3149; val_optim_loss: 267713.3149
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9516; val_best_f1_score: 0.9521; train_kl_reg_loss: 5505.6176; train_edge_recon_loss: 259050.0462; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264555.6637; train_optim_loss: 264555.6637; val_kl_reg_loss: 5418.4239; val_edge_recon_loss: 262696.3466; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268114.7719; val_optim_loss: 268114.7719
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9888; val_auprc_score: 0.9872; val_best_acc_score: 0.9521; val_best_f1_score: 0.9525; train_kl_reg_loss: 5508.7193; train_edge_recon_loss: 258936.1369; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264444.8566; train_optim_loss: 264444.8566; val_kl_reg_loss: 5370.7445; val_edge_recon_loss: 262428.9234; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267799.6673; val_optim_loss: 267799.6673
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9890; val_auprc_score: 0.9872; val_best_acc_score: 0.9522; val_best_f1_score: 0.9528; train_kl_reg_loss: 5505.4724; train_edge_recon_loss: 259032.8234; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264538.2963; train_optim_loss: 264538.2963; val_kl_reg_loss: 5330.4489; val_edge_recon_loss: 262195.5220; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267525.9695; val_optim_loss: 267525.9695
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9888; val_auprc_score: 0.9869; val_best_acc_score: 0.9526; val_best_f1_score: 0.9531; train_kl_reg_loss: 5509.3968; train_edge_recon_loss: 259048.0655; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264557.4622; train_optim_loss: 264557.4622; val_kl_reg_loss: 5403.1167; val_edge_recon_loss: 262489.5409; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267892.6562; val_optim_loss: 267892.6562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9893; val_auprc_score: 0.9877; val_best_acc_score: 0.9536; val_best_f1_score: 0.9541; train_kl_reg_loss: 5503.4035; train_edge_recon_loss: 259067.8867; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264571.2905; train_optim_loss: 264571.2905; val_kl_reg_loss: 5483.5120; val_edge_recon_loss: 262327.4781; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267810.9908; val_optim_loss: 267810.9908
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9888; val_auprc_score: 0.9869; val_best_acc_score: 0.9525; val_best_f1_score: 0.9528; train_kl_reg_loss: 5509.0710; train_edge_recon_loss: 258891.3935; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264400.4648; train_optim_loss: 264400.4648; val_kl_reg_loss: 5319.5863; val_edge_recon_loss: 262590.1994; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267909.7875; val_optim_loss: 267909.7875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9892; val_auprc_score: 0.9872; val_best_acc_score: 0.9536; val_best_f1_score: 0.9540; train_kl_reg_loss: 5505.3575; train_edge_recon_loss: 258953.4206; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264458.7784; train_optim_loss: 264458.7784; val_kl_reg_loss: 5331.3126; val_edge_recon_loss: 262363.8312; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267695.1446; val_optim_loss: 267695.1446

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9870; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 5505.4457; train_edge_recon_loss: 258910.3371; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264415.7834; train_optim_loss: 264415.7834; val_kl_reg_loss: 5387.8742; val_edge_recon_loss: 261918.5419; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267306.4159; val_optim_loss: 267306.4159
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9896; val_auprc_score: 0.9879; val_best_acc_score: 0.9544; val_best_f1_score: 0.9548; train_kl_reg_loss: 5502.9057; train_edge_recon_loss: 258926.6111; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264429.5167; train_optim_loss: 264429.5167; val_kl_reg_loss: 5401.4526; val_edge_recon_loss: 262150.7516; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267552.2045; val_optim_loss: 267552.2045
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9897; val_auprc_score: 0.9884; val_best_acc_score: 0.9539; val_best_f1_score: 0.9543; train_kl_reg_loss: 5505.1233; train_edge_recon_loss: 258811.4122; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264316.5350; train_optim_loss: 264316.5350; val_kl_reg_loss: 5403.3783; val_edge_recon_loss: 262345.3561; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267748.7341; val_optim_loss: 267748.7341
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9895; val_auprc_score: 0.9879; val_best_acc_score: 0.9536; val_best_f1_score: 0.9541; train_kl_reg_loss: 5502.3153; train_edge_recon_loss: 258905.1374; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264407.4532; train_optim_loss: 264407.4532; val_kl_reg_loss: 5398.8716; val_edge_recon_loss: 262207.2050; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267606.0770; val_optim_loss: 267606.0770
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9896; val_auprc_score: 0.9880; val_best_acc_score: 0.9543; val_best_f1_score: 0.9548; train_kl_reg_loss: 5501.2009; train_edge_recon_loss: 258913.0659; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264414.2671; train_optim_loss: 264414.2671; val_kl_reg_loss: 5412.8168; val_edge_recon_loss: 262257.4615; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267670.2764; val_optim_loss: 267670.2764

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9894; val_auprc_score: 0.9876; val_best_acc_score: 0.9535; val_best_f1_score: 0.9540; train_kl_reg_loss: 5501.8318; train_edge_recon_loss: 258939.0670; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264440.8990; train_optim_loss: 264440.8990; val_kl_reg_loss: 5396.2477; val_edge_recon_loss: 262107.3592; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267503.6060; val_optim_loss: 267503.6060
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9893; val_auprc_score: 0.9876; val_best_acc_score: 0.9538; val_best_f1_score: 0.9544; train_kl_reg_loss: 5500.9699; train_edge_recon_loss: 258826.8136; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264327.7833; train_optim_loss: 264327.7833; val_kl_reg_loss: 5396.7771; val_edge_recon_loss: 262424.7146; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267821.4901; val_optim_loss: 267821.4901
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9896; val_auprc_score: 0.9878; val_best_acc_score: 0.9541; val_best_f1_score: 0.9545; train_kl_reg_loss: 5500.6775; train_edge_recon_loss: 258906.4348; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264407.1123; train_optim_loss: 264407.1123; val_kl_reg_loss: 5400.2313; val_edge_recon_loss: 262207.7121; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267607.9420; val_optim_loss: 267607.9420
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9895; val_auprc_score: 0.9878; val_best_acc_score: 0.9543; val_best_f1_score: 0.9546; train_kl_reg_loss: 5506.2059; train_edge_recon_loss: 258804.6413; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264310.8470; train_optim_loss: 264310.8470; val_kl_reg_loss: 5403.8449; val_edge_recon_loss: 262243.1200; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267646.9659; val_optim_loss: 267646.9659

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 75 min 11 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9899
val AUPRC score: 0.9883
val best accuracy score: 0.9549
val best F1 score: 0.9552
val target rna MSE score: 13.7176
val source rna MSE score: 8.7141

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
