None
Run timestamp: 15072023_080316_149.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_149']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8922; val_auprc_score: 0.8860; val_best_acc_score: 0.8026; val_best_f1_score: 0.8165; train_kl_reg_loss: 81139.0440; train_edge_recon_loss: 3408629.5443; train_gene_expr_recon_loss: 12071219.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15560987.7083; train_optim_loss: 15560987.7083; val_kl_reg_loss: 94046.3310; val_edge_recon_loss: 3010063.9545; val_gene_expr_recon_loss: 10719009.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13823120.0909; val_optim_loss: 13823120.0909
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9293; val_auprc_score: 0.9190; val_best_acc_score: 0.8465; val_best_f1_score: 0.8531; train_kl_reg_loss: 107885.9602; train_edge_recon_loss: 2886065.1042; train_gene_expr_recon_loss: 10516932.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13510883.0781; train_optim_loss: 13510883.0781; val_kl_reg_loss: 95940.5685; val_edge_recon_loss: 2869316.6364; val_gene_expr_recon_loss: 10319284.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13284542.0909; val_optim_loss: 13284542.0909
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9516; val_auprc_score: 0.9408; val_best_acc_score: 0.8866; val_best_f1_score: 0.8917; train_kl_reg_loss: 93931.2796; train_edge_recon_loss: 2800872.9036; train_gene_expr_recon_loss: 10198282.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13093086.8229; train_optim_loss: 13093086.8229; val_kl_reg_loss: 86095.9695; val_edge_recon_loss: 2788568.1932; val_gene_expr_recon_loss: 10090508.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12965172.5000; val_optim_loss: 12965172.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9613; val_auprc_score: 0.9498; val_best_acc_score: 0.9054; val_best_f1_score: 0.9096; train_kl_reg_loss: 86695.5012; train_edge_recon_loss: 2742442.0156; train_gene_expr_recon_loss: 10011857.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12840995.4531; train_optim_loss: 12840995.4531; val_kl_reg_loss: 81272.3256; val_edge_recon_loss: 2756010.9205; val_gene_expr_recon_loss: 9895187.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12732470.7273; val_optim_loss: 12732470.7273
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9690; val_auprc_score: 0.9604; val_best_acc_score: 0.9174; val_best_f1_score: 0.9198; train_kl_reg_loss: 81731.1313; train_edge_recon_loss: 2712692.9492; train_gene_expr_recon_loss: 9837706.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12632130.7031; train_optim_loss: 12632130.7031; val_kl_reg_loss: 77341.5064; val_edge_recon_loss: 2730181.0682; val_gene_expr_recon_loss: 9803273.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12610795.8182; val_optim_loss: 12610795.8182
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9731; val_auprc_score: 0.9632; val_best_acc_score: 0.9270; val_best_f1_score: 0.9290; train_kl_reg_loss: 76384.5986; train_edge_recon_loss: 2696225.3281; train_gene_expr_recon_loss: 9689455.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12462065.0833; train_optim_loss: 12462065.0833; val_kl_reg_loss: 71345.8310; val_edge_recon_loss: 2725234.4886; val_gene_expr_recon_loss: 9634197.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12430778.0455; val_optim_loss: 12430778.0455
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9751; val_auprc_score: 0.9672; val_best_acc_score: 0.9297; val_best_f1_score: 0.9320; train_kl_reg_loss: 72021.1988; train_edge_recon_loss: 2686273.6003; train_gene_expr_recon_loss: 9554511.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12312805.9323; train_optim_loss: 12312805.9323; val_kl_reg_loss: 68615.9485; val_edge_recon_loss: 2720203.5227; val_gene_expr_recon_loss: 9539438.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12328257.8636; val_optim_loss: 12328257.8636
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9755; val_auprc_score: 0.9665; val_best_acc_score: 0.9349; val_best_f1_score: 0.9370; train_kl_reg_loss: 68641.5990; train_edge_recon_loss: 2680236.6354; train_gene_expr_recon_loss: 9438656.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12187534.5000; train_optim_loss: 12187534.5000; val_kl_reg_loss: 65333.8722; val_edge_recon_loss: 2703716.5682; val_gene_expr_recon_loss: 9428238.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12197288.5909; val_optim_loss: 12197288.5909
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9762; val_auprc_score: 0.9677; val_best_acc_score: 0.9346; val_best_f1_score: 0.9365; train_kl_reg_loss: 65972.4354; train_edge_recon_loss: 2673377.6354; train_gene_expr_recon_loss: 9333628.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12072978.5573; train_optim_loss: 12072978.5573; val_kl_reg_loss: 62955.8127; val_edge_recon_loss: 2702069.0795; val_gene_expr_recon_loss: 9340058.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12105083.7273; val_optim_loss: 12105083.7273
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9766; val_auprc_score: 0.9686; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 63904.6615; train_edge_recon_loss: 2668962.0417; train_gene_expr_recon_loss: 9237143.3802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11970010.0833; train_optim_loss: 11970010.0833; val_kl_reg_loss: 61488.9462; val_edge_recon_loss: 2700137.5682; val_gene_expr_recon_loss: 9289244.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12050871.3182; val_optim_loss: 12050871.3182
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9769; val_auprc_score: 0.9681; val_best_acc_score: 0.9379; val_best_f1_score: 0.9398; train_kl_reg_loss: 62231.5747; train_edge_recon_loss: 2664529.0690; train_gene_expr_recon_loss: 9161210.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11887970.9323; train_optim_loss: 11887970.9323; val_kl_reg_loss: 59842.7271; val_edge_recon_loss: 2697372.6932; val_gene_expr_recon_loss: 9223017.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11980233.1364; val_optim_loss: 11980233.1364
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9684; val_best_acc_score: 0.9381; val_best_f1_score: 0.9401; train_kl_reg_loss: 60807.7891; train_edge_recon_loss: 2662140.3490; train_gene_expr_recon_loss: 9072319.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11795267.3802; train_optim_loss: 11795267.3802; val_kl_reg_loss: 58092.3668; val_edge_recon_loss: 2696229.3977; val_gene_expr_recon_loss: 9158522.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11912844.2727; val_optim_loss: 11912844.2727
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9785; val_auprc_score: 0.9708; val_best_acc_score: 0.9399; val_best_f1_score: 0.9414; train_kl_reg_loss: 59511.0174; train_edge_recon_loss: 2657628.1966; train_gene_expr_recon_loss: 9016366.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11733505.3646; train_optim_loss: 11733505.3646; val_kl_reg_loss: 57591.8123; val_edge_recon_loss: 2678679.9886; val_gene_expr_recon_loss: 9111367.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11847639.2273; val_optim_loss: 11847639.2273
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9782; val_auprc_score: 0.9706; val_best_acc_score: 0.9398; val_best_f1_score: 0.9414; train_kl_reg_loss: 58313.6264; train_edge_recon_loss: 2653378.4961; train_gene_expr_recon_loss: 8947408.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11659100.5417; train_optim_loss: 11659100.5417; val_kl_reg_loss: 56247.9524; val_edge_recon_loss: 2688161.1477; val_gene_expr_recon_loss: 9095007.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11839416.5000; val_optim_loss: 11839416.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9779; val_auprc_score: 0.9702; val_best_acc_score: 0.9400; val_best_f1_score: 0.9415; train_kl_reg_loss: 57353.8691; train_edge_recon_loss: 2650587.2461; train_gene_expr_recon_loss: 8900318.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11608259.2292; train_optim_loss: 11608259.2292; val_kl_reg_loss: 55096.4775; val_edge_recon_loss: 2682468.2955; val_gene_expr_recon_loss: 9030152.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11767717.3182; val_optim_loss: 11767717.3182
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9785; val_auprc_score: 0.9708; val_best_acc_score: 0.9400; val_best_f1_score: 0.9416; train_kl_reg_loss: 56273.9564; train_edge_recon_loss: 2653047.3984; train_gene_expr_recon_loss: 8845280.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11554601.9219; train_optim_loss: 11554601.9219; val_kl_reg_loss: 54392.9345; val_edge_recon_loss: 2679523.8068; val_gene_expr_recon_loss: 9025529.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11759446.0909; val_optim_loss: 11759446.0909
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9771; val_auprc_score: 0.9690; val_best_acc_score: 0.9390; val_best_f1_score: 0.9408; train_kl_reg_loss: 55536.4159; train_edge_recon_loss: 2651112.3268; train_gene_expr_recon_loss: 8811123.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11517772.5104; train_optim_loss: 11517772.5104; val_kl_reg_loss: 53979.3164; val_edge_recon_loss: 2690026.3750; val_gene_expr_recon_loss: 9029052.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11773058.6364; val_optim_loss: 11773058.6364
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9782; val_auprc_score: 0.9706; val_best_acc_score: 0.9405; val_best_f1_score: 0.9424; train_kl_reg_loss: 54822.4570; train_edge_recon_loss: 2647693.0599; train_gene_expr_recon_loss: 8761614.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11464130.3281; train_optim_loss: 11464130.3281; val_kl_reg_loss: 52664.5952; val_edge_recon_loss: 2675759.6250; val_gene_expr_recon_loss: 8983072.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11711496.7273; val_optim_loss: 11711496.7273
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9777; val_auprc_score: 0.9699; val_best_acc_score: 0.9406; val_best_f1_score: 0.9422; train_kl_reg_loss: 54132.6129; train_edge_recon_loss: 2646988.4440; train_gene_expr_recon_loss: 8728339.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11429460.0833; train_optim_loss: 11429460.0833; val_kl_reg_loss: 52293.8345; val_edge_recon_loss: 2678977.6364; val_gene_expr_recon_loss: 8978324.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11709595.5455; val_optim_loss: 11709595.5455
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9771; val_auprc_score: 0.9687; val_best_acc_score: 0.9404; val_best_f1_score: 0.9424; train_kl_reg_loss: 53618.4669; train_edge_recon_loss: 2644893.9935; train_gene_expr_recon_loss: 8697368.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11395881.4635; train_optim_loss: 11395881.4635; val_kl_reg_loss: 51839.0270; val_edge_recon_loss: 2682175.9205; val_gene_expr_recon_loss: 8961952.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11695967.6818; val_optim_loss: 11695967.6818
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9802; val_auprc_score: 0.9738; val_best_acc_score: 0.9421; val_best_f1_score: 0.9438; train_kl_reg_loss: 52957.9342; train_edge_recon_loss: 2643859.8685; train_gene_expr_recon_loss: 8670267.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11367085.5260; train_optim_loss: 11367085.5260; val_kl_reg_loss: 50887.1763; val_edge_recon_loss: 2675333.5227; val_gene_expr_recon_loss: 8914978.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11641199.1818; val_optim_loss: 11641199.1818
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9778; val_auprc_score: 0.9699; val_best_acc_score: 0.9406; val_best_f1_score: 0.9425; train_kl_reg_loss: 52430.1317; train_edge_recon_loss: 2642113.2995; train_gene_expr_recon_loss: 8645791.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11340334.6094; train_optim_loss: 11340334.6094; val_kl_reg_loss: 50761.9265; val_edge_recon_loss: 2678102.5227; val_gene_expr_recon_loss: 8950084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11678948.4091; val_optim_loss: 11678948.4091
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9794; val_auprc_score: 0.9720; val_best_acc_score: 0.9437; val_best_f1_score: 0.9451; train_kl_reg_loss: 51847.1104; train_edge_recon_loss: 2642141.3646; train_gene_expr_recon_loss: 8625962.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11319951.1615; train_optim_loss: 11319951.1615; val_kl_reg_loss: 50265.7772; val_edge_recon_loss: 2666826.3977; val_gene_expr_recon_loss: 8927796.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11644888.5455; val_optim_loss: 11644888.5455
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9780; val_auprc_score: 0.9694; val_best_acc_score: 0.9420; val_best_f1_score: 0.9438; train_kl_reg_loss: 51355.6519; train_edge_recon_loss: 2639165.8438; train_gene_expr_recon_loss: 8599516.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11290038.1250; train_optim_loss: 11290038.1250; val_kl_reg_loss: 49685.1009; val_edge_recon_loss: 2673733.8182; val_gene_expr_recon_loss: 8933815.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11657234.4545; val_optim_loss: 11657234.4545
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9784; val_auprc_score: 0.9697; val_best_acc_score: 0.9436; val_best_f1_score: 0.9453; train_kl_reg_loss: 50892.4698; train_edge_recon_loss: 2637985.2799; train_gene_expr_recon_loss: 8584658.1276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11273535.8802; train_optim_loss: 11273535.8802; val_kl_reg_loss: 49373.7530; val_edge_recon_loss: 2670153.4432; val_gene_expr_recon_loss: 8908105.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11627632.4091; val_optim_loss: 11627632.4091
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9797; val_auprc_score: 0.9726; val_best_acc_score: 0.9442; val_best_f1_score: 0.9455; train_kl_reg_loss: 50385.4440; train_edge_recon_loss: 2637255.4128; train_gene_expr_recon_loss: 8568312.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11255953.1927; train_optim_loss: 11255953.1927; val_kl_reg_loss: 48809.6422; val_edge_recon_loss: 2672694.7386; val_gene_expr_recon_loss: 8893414.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11614919.0455; val_optim_loss: 11614919.0455
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9782; val_auprc_score: 0.9702; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 49882.0519; train_edge_recon_loss: 2635894.9505; train_gene_expr_recon_loss: 8549509.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11235286.1406; train_optim_loss: 11235286.1406; val_kl_reg_loss: 48088.0449; val_edge_recon_loss: 2672140.9886; val_gene_expr_recon_loss: 8921212.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11641441.9091; val_optim_loss: 11641441.9091
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9788; val_auprc_score: 0.9714; val_best_acc_score: 0.9425; val_best_f1_score: 0.9442; train_kl_reg_loss: 49417.9744; train_edge_recon_loss: 2637276.4609; train_gene_expr_recon_loss: 8526008.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11212702.4531; train_optim_loss: 11212702.4531; val_kl_reg_loss: 48326.5719; val_edge_recon_loss: 2670891.5114; val_gene_expr_recon_loss: 8908376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11627594.0000; val_optim_loss: 11627594.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9801; val_auprc_score: 0.9735; val_best_acc_score: 0.9454; val_best_f1_score: 0.9467; train_kl_reg_loss: 49168.7806; train_edge_recon_loss: 2637380.7122; train_gene_expr_recon_loss: 8519070.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11205620.2083; train_optim_loss: 11205620.2083; val_kl_reg_loss: 47690.0162; val_edge_recon_loss: 2669341.1818; val_gene_expr_recon_loss: 8917807.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11634838.5000; val_optim_loss: 11634838.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9799; val_auprc_score: 0.9730; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 48769.2122; train_edge_recon_loss: 2635364.6029; train_gene_expr_recon_loss: 8502882.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11187016.6406; train_optim_loss: 11187016.6406; val_kl_reg_loss: 47622.7651; val_edge_recon_loss: 2668491.0682; val_gene_expr_recon_loss: 8907619.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11623733.0909; val_optim_loss: 11623733.0909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9793; val_auprc_score: 0.9720; val_best_acc_score: 0.9447; val_best_f1_score: 0.9464; train_kl_reg_loss: 48973.8000; train_edge_recon_loss: 2629531.6367; train_gene_expr_recon_loss: 8432505.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11111010.5000; train_optim_loss: 11111010.5000; val_kl_reg_loss: 47417.7564; val_edge_recon_loss: 2661463.8182; val_gene_expr_recon_loss: 8869810.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11578692.2273; val_optim_loss: 11578692.2273
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9798; val_auprc_score: 0.9730; val_best_acc_score: 0.9433; val_best_f1_score: 0.9451; train_kl_reg_loss: 48910.8695; train_edge_recon_loss: 2630620.7930; train_gene_expr_recon_loss: 8420533.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11100065.4323; train_optim_loss: 11100065.4323; val_kl_reg_loss: 47450.3640; val_edge_recon_loss: 2664347.5795; val_gene_expr_recon_loss: 8875108.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11586906.5000; val_optim_loss: 11586906.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9782; val_auprc_score: 0.9712; val_best_acc_score: 0.9426; val_best_f1_score: 0.9441; train_kl_reg_loss: 48930.7934; train_edge_recon_loss: 2630488.2956; train_gene_expr_recon_loss: 8416355.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11095774.7396; train_optim_loss: 11095774.7396; val_kl_reg_loss: 47290.0259; val_edge_recon_loss: 2670643.9545; val_gene_expr_recon_loss: 8864517.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11582451.3182; val_optim_loss: 11582451.3182
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9801; val_auprc_score: 0.9729; val_best_acc_score: 0.9442; val_best_f1_score: 0.9457; train_kl_reg_loss: 48848.7957; train_edge_recon_loss: 2630942.2201; train_gene_expr_recon_loss: 8418598.8776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11098389.8646; train_optim_loss: 11098389.8646; val_kl_reg_loss: 47287.8853; val_edge_recon_loss: 2665339.1477; val_gene_expr_recon_loss: 8872670.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11585297.8636; val_optim_loss: 11585297.8636
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9787; val_auprc_score: 0.9706; val_best_acc_score: 0.9440; val_best_f1_score: 0.9454; train_kl_reg_loss: 48841.3548; train_edge_recon_loss: 2628202.1159; train_gene_expr_recon_loss: 8414909.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11091952.7240; train_optim_loss: 11091952.7240; val_kl_reg_loss: 47338.0456; val_edge_recon_loss: 2669382.7500; val_gene_expr_recon_loss: 8886198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11602918.7273; val_optim_loss: 11602918.7273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9788; val_auprc_score: 0.9704; val_best_acc_score: 0.9449; val_best_f1_score: 0.9463; train_kl_reg_loss: 48836.0813; train_edge_recon_loss: 2629906.3698; train_gene_expr_recon_loss: 8403626.5339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11082368.9844; train_optim_loss: 11082368.9844; val_kl_reg_loss: 47301.9222; val_edge_recon_loss: 2670383.1136; val_gene_expr_recon_loss: 8845879.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11563564.3182; val_optim_loss: 11563564.3182
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9808; val_auprc_score: 0.9747; val_best_acc_score: 0.9461; val_best_f1_score: 0.9474; train_kl_reg_loss: 48868.7053; train_edge_recon_loss: 2627597.3503; train_gene_expr_recon_loss: 8403354.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11079820.3750; train_optim_loss: 11079820.3750; val_kl_reg_loss: 47328.8461; val_edge_recon_loss: 2663019.3523; val_gene_expr_recon_loss: 8831494.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11541842.6364; val_optim_loss: 11541842.6364
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9790; val_auprc_score: 0.9716; val_best_acc_score: 0.9441; val_best_f1_score: 0.9457; train_kl_reg_loss: 48860.4410; train_edge_recon_loss: 2630844.5260; train_gene_expr_recon_loss: 8406505.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11086210.6979; train_optim_loss: 11086210.6979; val_kl_reg_loss: 47325.9782; val_edge_recon_loss: 2663542.1818; val_gene_expr_recon_loss: 8832664.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11543532.9545; val_optim_loss: 11543532.9545
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9791; val_auprc_score: 0.9714; val_best_acc_score: 0.9449; val_best_f1_score: 0.9463; train_kl_reg_loss: 48822.5790; train_edge_recon_loss: 2630647.7891; train_gene_expr_recon_loss: 8399886.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11079356.5677; train_optim_loss: 11079356.5677; val_kl_reg_loss: 47315.8287; val_edge_recon_loss: 2664742.1705; val_gene_expr_recon_loss: 8873890.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11585948.8636; val_optim_loss: 11585948.8636
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9803; val_auprc_score: 0.9736; val_best_acc_score: 0.9458; val_best_f1_score: 0.9471; train_kl_reg_loss: 48846.9491; train_edge_recon_loss: 2630735.6758; train_gene_expr_recon_loss: 8404979.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11084561.9531; train_optim_loss: 11084561.9531; val_kl_reg_loss: 47267.0144; val_edge_recon_loss: 2664252.8636; val_gene_expr_recon_loss: 8869595.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11581115.2273; val_optim_loss: 11581115.2273
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9793; val_auprc_score: 0.9713; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 48815.2185; train_edge_recon_loss: 2628139.5508; train_gene_expr_recon_loss: 8397132.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11074087.2656; train_optim_loss: 11074087.2656; val_kl_reg_loss: 47344.0131; val_edge_recon_loss: 2661733.8409; val_gene_expr_recon_loss: 8869364.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11578442.7273; val_optim_loss: 11578442.7273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9793; val_auprc_score: 0.9717; val_best_acc_score: 0.9449; val_best_f1_score: 0.9463; train_kl_reg_loss: 48823.9385; train_edge_recon_loss: 2630331.5443; train_gene_expr_recon_loss: 8399789.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11078945.4167; train_optim_loss: 11078945.4167; val_kl_reg_loss: 47370.8723; val_edge_recon_loss: 2665453.5341; val_gene_expr_recon_loss: 8856954.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11569779.0000; val_optim_loss: 11569779.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9795; val_auprc_score: 0.9722; val_best_acc_score: 0.9443; val_best_f1_score: 0.9457; train_kl_reg_loss: 48802.1545; train_edge_recon_loss: 2631918.4479; train_gene_expr_recon_loss: 8398950.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11079671.3594; train_optim_loss: 11079671.3594; val_kl_reg_loss: 47331.4256; val_edge_recon_loss: 2667028.3182; val_gene_expr_recon_loss: 8859568.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11573928.1818; val_optim_loss: 11573928.1818
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9803; val_auprc_score: 0.9732; val_best_acc_score: 0.9462; val_best_f1_score: 0.9475; train_kl_reg_loss: 48841.7319; train_edge_recon_loss: 2631456.0508; train_gene_expr_recon_loss: 8413671.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11093968.8958; train_optim_loss: 11093968.8958; val_kl_reg_loss: 47325.9821; val_edge_recon_loss: 2661957.3636; val_gene_expr_recon_loss: 8873445.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11582729.0909; val_optim_loss: 11582729.0909
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9783; val_auprc_score: 0.9707; val_best_acc_score: 0.9439; val_best_f1_score: 0.9454; train_kl_reg_loss: 48813.8571; train_edge_recon_loss: 2630978.3815; train_gene_expr_recon_loss: 8407420.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11087212.8125; train_optim_loss: 11087212.8125; val_kl_reg_loss: 47290.6291; val_edge_recon_loss: 2665127.0341; val_gene_expr_recon_loss: 8843122.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11555540.0000; val_optim_loss: 11555540.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 28 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9783
Val AUPRC score: 0.9706
Val best accuracy score: 0.9443
Val best F1 score: 0.9457
Val gene expr MSE score: 0.6868

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
