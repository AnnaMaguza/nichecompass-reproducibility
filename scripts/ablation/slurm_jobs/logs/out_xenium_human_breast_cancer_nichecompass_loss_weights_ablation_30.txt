None
Run timestamp: 01072023_233444_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9726; val_auprc_score: 0.9653; val_best_acc_score: 0.9236; val_best_f1_score: 0.9265; train_kl_reg_loss: 5101.5751; train_edge_recon_loss: 266202.1681; train_gene_expr_recon_loss: 8937.0300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280240.7724; train_optim_loss: 280240.7724; val_kl_reg_loss: 5090.8866; val_edge_recon_loss: 263433.2449; val_gene_expr_recon_loss: 8162.0665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276686.1986; val_optim_loss: 276686.1986
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9791; val_auprc_score: 0.9737; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 5113.4924; train_edge_recon_loss: 261709.5862; train_gene_expr_recon_loss: 7881.6089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274704.6879; train_optim_loss: 274704.6879; val_kl_reg_loss: 5036.5634; val_edge_recon_loss: 262270.9522; val_gene_expr_recon_loss: 7579.3834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274886.8994; val_optim_loss: 274886.8994
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9830; val_auprc_score: 0.9787; val_best_acc_score: 0.9433; val_best_f1_score: 0.9445; train_kl_reg_loss: 5141.5141; train_edge_recon_loss: 260883.0605; train_gene_expr_recon_loss: 7546.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273570.9622; train_optim_loss: 273570.9622; val_kl_reg_loss: 4991.2063; val_edge_recon_loss: 261939.9876; val_gene_expr_recon_loss: 7387.6323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274318.8271; val_optim_loss: 274318.8271
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9846; val_auprc_score: 0.9809; val_best_acc_score: 0.9462; val_best_f1_score: 0.9474; train_kl_reg_loss: 5157.0416; train_edge_recon_loss: 260544.9268; train_gene_expr_recon_loss: 7370.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273072.8618; train_optim_loss: 273072.8618; val_kl_reg_loss: 5013.6280; val_edge_recon_loss: 261669.1443; val_gene_expr_recon_loss: 7290.4606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273973.2327; val_optim_loss: 273973.2327
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9862; val_auprc_score: 0.9824; val_best_acc_score: 0.9510; val_best_f1_score: 0.9520; train_kl_reg_loss: 5165.1985; train_edge_recon_loss: 260132.4448; train_gene_expr_recon_loss: 7269.4836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272567.1270; train_optim_loss: 272567.1270; val_kl_reg_loss: 5033.7134; val_edge_recon_loss: 260926.3154; val_gene_expr_recon_loss: 7138.3842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273098.4129; val_optim_loss: 273098.4129
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9868; val_auprc_score: 0.9832; val_best_acc_score: 0.9526; val_best_f1_score: 0.9536; train_kl_reg_loss: 5174.7489; train_edge_recon_loss: 259994.9249; train_gene_expr_recon_loss: 7192.0373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272361.7109; train_optim_loss: 272361.7109; val_kl_reg_loss: 5002.9141; val_edge_recon_loss: 261115.5537; val_gene_expr_recon_loss: 7085.4822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273203.9521; val_optim_loss: 273203.9521
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9876; val_auprc_score: 0.9840; val_best_acc_score: 0.9542; val_best_f1_score: 0.9552; train_kl_reg_loss: 5185.8727; train_edge_recon_loss: 259760.6874; train_gene_expr_recon_loss: 7144.3792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272090.9388; train_optim_loss: 272090.9388; val_kl_reg_loss: 5086.1187; val_edge_recon_loss: 260679.6863; val_gene_expr_recon_loss: 7048.4610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272814.2656; val_optim_loss: 272814.2656
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9886; val_auprc_score: 0.9852; val_best_acc_score: 0.9565; val_best_f1_score: 0.9573; train_kl_reg_loss: 5195.2509; train_edge_recon_loss: 259661.4013; train_gene_expr_recon_loss: 7096.8243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271953.4767; train_optim_loss: 271953.4767; val_kl_reg_loss: 5037.5631; val_edge_recon_loss: 260377.6386; val_gene_expr_recon_loss: 7003.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272419.1770; val_optim_loss: 272419.1770
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9888; val_auprc_score: 0.9859; val_best_acc_score: 0.9566; val_best_f1_score: 0.9575; train_kl_reg_loss: 5206.8131; train_edge_recon_loss: 259499.6714; train_gene_expr_recon_loss: 7064.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271770.5134; train_optim_loss: 271770.5134; val_kl_reg_loss: 5046.7927; val_edge_recon_loss: 260020.9129; val_gene_expr_recon_loss: 6976.8323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272044.5385; val_optim_loss: 272044.5385
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 5214.7321; train_edge_recon_loss: 259402.9521; train_gene_expr_recon_loss: 7040.4207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271658.1047; train_optim_loss: 271658.1047; val_kl_reg_loss: 5095.6035; val_edge_recon_loss: 260209.4622; val_gene_expr_recon_loss: 6944.9762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272250.0415; val_optim_loss: 272250.0415
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9902; val_auprc_score: 0.9876; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 5222.4945; train_edge_recon_loss: 259275.3505; train_gene_expr_recon_loss: 7007.6871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271505.5318; train_optim_loss: 271505.5318; val_kl_reg_loss: 5230.5701; val_edge_recon_loss: 260409.9725; val_gene_expr_recon_loss: 6894.8358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272535.3780; val_optim_loss: 272535.3780
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9900; val_auprc_score: 0.9871; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 5232.1713; train_edge_recon_loss: 259173.6129; train_gene_expr_recon_loss: 6982.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271387.8163; train_optim_loss: 271387.8163; val_kl_reg_loss: 5156.2676; val_edge_recon_loss: 259969.3034; val_gene_expr_recon_loss: 6884.7846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272010.3551; val_optim_loss: 272010.3551
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9906; val_auprc_score: 0.9877; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 5239.8116; train_edge_recon_loss: 259087.1587; train_gene_expr_recon_loss: 6965.3638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271292.3345; train_optim_loss: 271292.3345; val_kl_reg_loss: 5166.4721; val_edge_recon_loss: 259645.2896; val_gene_expr_recon_loss: 6856.8773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271668.6389; val_optim_loss: 271668.6389
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9906; val_auprc_score: 0.9880; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 5251.5415; train_edge_recon_loss: 258921.8746; train_gene_expr_recon_loss: 6946.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271119.7235; train_optim_loss: 271119.7235; val_kl_reg_loss: 5315.1632; val_edge_recon_loss: 259966.7071; val_gene_expr_recon_loss: 6860.9495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272142.8159; val_optim_loss: 272142.8159
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9908; val_auprc_score: 0.9881; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 5252.5931; train_edge_recon_loss: 258924.6443; train_gene_expr_recon_loss: 6927.7723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271105.0096; train_optim_loss: 271105.0096; val_kl_reg_loss: 5199.0247; val_edge_recon_loss: 259682.9750; val_gene_expr_recon_loss: 6824.4927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271706.4929; val_optim_loss: 271706.4929
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9908; val_auprc_score: 0.9880; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 5258.6214; train_edge_recon_loss: 258947.0835; train_gene_expr_recon_loss: 6912.6522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271118.3571; train_optim_loss: 271118.3571; val_kl_reg_loss: 5241.0914; val_edge_recon_loss: 259557.9607; val_gene_expr_recon_loss: 6819.1460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271618.1954; val_optim_loss: 271618.1954
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9910; val_auprc_score: 0.9882; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 5266.2546; train_edge_recon_loss: 258798.0289; train_gene_expr_recon_loss: 6898.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270963.0927; train_optim_loss: 270963.0927; val_kl_reg_loss: 5109.9985; val_edge_recon_loss: 259517.8186; val_gene_expr_recon_loss: 6801.0528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271428.8696; val_optim_loss: 271428.8696
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9910; val_auprc_score: 0.9880; val_best_acc_score: 0.9636; val_best_f1_score: 0.9641; train_kl_reg_loss: 5266.7160; train_edge_recon_loss: 258749.2834; train_gene_expr_recon_loss: 6886.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270902.3182; train_optim_loss: 270902.3182; val_kl_reg_loss: 5199.3869; val_edge_recon_loss: 259507.3345; val_gene_expr_recon_loss: 6802.5960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271509.3155; val_optim_loss: 271509.3155
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9911; val_auprc_score: 0.9882; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 5272.4170; train_edge_recon_loss: 258707.4416; train_gene_expr_recon_loss: 6877.3446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270857.2029; train_optim_loss: 270857.2029; val_kl_reg_loss: 5228.0873; val_edge_recon_loss: 259613.4044; val_gene_expr_recon_loss: 6783.7248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271625.2179; val_optim_loss: 271625.2179
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 5274.3770; train_edge_recon_loss: 258674.7524; train_gene_expr_recon_loss: 6873.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270822.1915; train_optim_loss: 270822.1915; val_kl_reg_loss: 5164.9883; val_edge_recon_loss: 259667.3829; val_gene_expr_recon_loss: 6772.5280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271604.8983; val_optim_loss: 271604.8983
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9912; val_auprc_score: 0.9884; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 5279.3010; train_edge_recon_loss: 258639.4234; train_gene_expr_recon_loss: 6867.1943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270785.9184; train_optim_loss: 270785.9184; val_kl_reg_loss: 5293.7230; val_edge_recon_loss: 259247.9087; val_gene_expr_recon_loss: 6771.6622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271313.2939; val_optim_loss: 271313.2939
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9662; val_best_f1_score: 0.9668; train_kl_reg_loss: 5282.0118; train_edge_recon_loss: 258627.6123; train_gene_expr_recon_loss: 6859.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270769.3929; train_optim_loss: 270769.3929; val_kl_reg_loss: 5207.0948; val_edge_recon_loss: 259087.8197; val_gene_expr_recon_loss: 6772.6495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271067.5636; val_optim_loss: 271067.5636
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9918; val_auprc_score: 0.9892; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 5285.0109; train_edge_recon_loss: 258526.0879; train_gene_expr_recon_loss: 6855.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270666.7164; train_optim_loss: 270666.7164; val_kl_reg_loss: 5103.3321; val_edge_recon_loss: 259101.0010; val_gene_expr_recon_loss: 6781.3741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270985.7065; val_optim_loss: 270985.7065
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9919; val_auprc_score: 0.9894; val_best_acc_score: 0.9666; val_best_f1_score: 0.9671; train_kl_reg_loss: 5286.3127; train_edge_recon_loss: 258481.3199; train_gene_expr_recon_loss: 6848.1218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270615.7549; train_optim_loss: 270615.7549; val_kl_reg_loss: 5199.7731; val_edge_recon_loss: 259225.2021; val_gene_expr_recon_loss: 6766.7795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271191.7536; val_optim_loss: 271191.7536
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9925; val_auprc_score: 0.9903; val_best_acc_score: 0.9682; val_best_f1_score: 0.9686; train_kl_reg_loss: 5291.3829; train_edge_recon_loss: 258464.9998; train_gene_expr_recon_loss: 6841.9077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270598.2907; train_optim_loss: 270598.2907; val_kl_reg_loss: 5190.2425; val_edge_recon_loss: 258892.9752; val_gene_expr_recon_loss: 6757.4310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270840.6492; val_optim_loss: 270840.6492
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 5295.2234; train_edge_recon_loss: 258450.8112; train_gene_expr_recon_loss: 6839.1958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270585.2306; train_optim_loss: 270585.2306; val_kl_reg_loss: 5390.9242; val_edge_recon_loss: 259145.1862; val_gene_expr_recon_loss: 6742.7556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271278.8649; val_optim_loss: 271278.8649
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9899; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 5295.8968; train_edge_recon_loss: 258368.3372; train_gene_expr_recon_loss: 6833.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270497.9557; train_optim_loss: 270497.9557; val_kl_reg_loss: 5373.5410; val_edge_recon_loss: 258749.1042; val_gene_expr_recon_loss: 6731.3931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270854.0375; val_optim_loss: 270854.0375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9894; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 5298.7711; train_edge_recon_loss: 258346.7548; train_gene_expr_recon_loss: 6825.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270471.4049; train_optim_loss: 270471.4049; val_kl_reg_loss: 5315.2331; val_edge_recon_loss: 259132.9042; val_gene_expr_recon_loss: 6725.4251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271173.5614; val_optim_loss: 271173.5614
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9923; val_auprc_score: 0.9896; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 5301.0012; train_edge_recon_loss: 258301.8729; train_gene_expr_recon_loss: 6825.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270428.0478; train_optim_loss: 270428.0478; val_kl_reg_loss: 5197.3428; val_edge_recon_loss: 259124.0838; val_gene_expr_recon_loss: 6723.9181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271045.3440; val_optim_loss: 271045.3440

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5289.2741; train_edge_recon_loss: 258148.7419; train_gene_expr_recon_loss: 6790.7689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270228.7855; train_optim_loss: 270228.7855; val_kl_reg_loss: 5223.7076; val_edge_recon_loss: 258777.4878; val_gene_expr_recon_loss: 6706.0012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270707.1961; val_optim_loss: 270707.1961
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9931; val_auprc_score: 0.9909; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 5285.4601; train_edge_recon_loss: 258057.1358; train_gene_expr_recon_loss: 6783.2291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270125.8251; train_optim_loss: 270125.8251; val_kl_reg_loss: 5239.1174; val_edge_recon_loss: 258465.0720; val_gene_expr_recon_loss: 6702.4430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270406.6327; val_optim_loss: 270406.6327
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9934; val_auprc_score: 0.9911; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5280.7907; train_edge_recon_loss: 258031.3113; train_gene_expr_recon_loss: 6782.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270094.1412; train_optim_loss: 270094.1412; val_kl_reg_loss: 5212.3788; val_edge_recon_loss: 258312.6663; val_gene_expr_recon_loss: 6695.5718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270220.6179; val_optim_loss: 270220.6179
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9927; val_auprc_score: 0.9902; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 5281.4480; train_edge_recon_loss: 257983.6019; train_gene_expr_recon_loss: 6780.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270045.3237; train_optim_loss: 270045.3237; val_kl_reg_loss: 5213.8846; val_edge_recon_loss: 258706.2935; val_gene_expr_recon_loss: 6692.2980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270612.4741; val_optim_loss: 270612.4741
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9931; val_auprc_score: 0.9907; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 5280.6934; train_edge_recon_loss: 258034.8914; train_gene_expr_recon_loss: 6778.5494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270094.1342; train_optim_loss: 270094.1342; val_kl_reg_loss: 5230.0641; val_edge_recon_loss: 258649.1553; val_gene_expr_recon_loss: 6686.6190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270565.8380; val_optim_loss: 270565.8380
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9933; val_auprc_score: 0.9910; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5281.0469; train_edge_recon_loss: 257918.1782; train_gene_expr_recon_loss: 6778.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269977.4059; train_optim_loss: 269977.4059; val_kl_reg_loss: 5237.6061; val_edge_recon_loss: 258487.2918; val_gene_expr_recon_loss: 6687.9720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270412.8684; val_optim_loss: 270412.8684
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9933; val_auprc_score: 0.9910; val_best_acc_score: 0.9708; val_best_f1_score: 0.9711; train_kl_reg_loss: 5279.5760; train_edge_recon_loss: 257980.9386; train_gene_expr_recon_loss: 6776.2134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270036.7279; train_optim_loss: 270036.7279; val_kl_reg_loss: 5242.2593; val_edge_recon_loss: 258661.1260; val_gene_expr_recon_loss: 6673.0385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270576.4236; val_optim_loss: 270576.4236

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9932; val_auprc_score: 0.9909; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 5278.2304; train_edge_recon_loss: 257895.3379; train_gene_expr_recon_loss: 6772.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269946.3867; train_optim_loss: 269946.3867; val_kl_reg_loss: 5236.9881; val_edge_recon_loss: 258608.3206; val_gene_expr_recon_loss: 6682.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270527.3412; val_optim_loss: 270527.3412
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9930; val_auprc_score: 0.9906; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 5277.5745; train_edge_recon_loss: 257941.5026; train_gene_expr_recon_loss: 6771.3997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269990.4770; train_optim_loss: 269990.4770; val_kl_reg_loss: 5227.7646; val_edge_recon_loss: 258700.3159; val_gene_expr_recon_loss: 6685.1878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270613.2678; val_optim_loss: 270613.2678
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9705; val_best_f1_score: 0.9710; train_kl_reg_loss: 5278.3797; train_edge_recon_loss: 257934.5554; train_gene_expr_recon_loss: 6773.4200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269986.3550; train_optim_loss: 269986.3550; val_kl_reg_loss: 5241.3490; val_edge_recon_loss: 258409.7152; val_gene_expr_recon_loss: 6687.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270338.9469; val_optim_loss: 270338.9469
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9930; val_auprc_score: 0.9906; val_best_acc_score: 0.9707; val_best_f1_score: 0.9710; train_kl_reg_loss: 5279.2092; train_edge_recon_loss: 257904.5493; train_gene_expr_recon_loss: 6773.2520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269957.0111; train_optim_loss: 269957.0111; val_kl_reg_loss: 5237.7835; val_edge_recon_loss: 258558.8645; val_gene_expr_recon_loss: 6676.8804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270473.5289; val_optim_loss: 270473.5289

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 183 min 7 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9933
Val AUPRC score: 0.9911
Val best accuracy score: 0.9708
Val best F1 score: 0.9712
Val gene expr MSE score: 1.8207

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
