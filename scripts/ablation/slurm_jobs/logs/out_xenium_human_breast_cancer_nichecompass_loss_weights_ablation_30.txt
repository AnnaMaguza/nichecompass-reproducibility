None
Run timestamp: 01072023_121125_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9755; val_auprc_score: 0.9706; val_best_acc_score: 0.9249; val_best_f1_score: 0.9273; train_kl_reg_loss: 5240.3438; train_edge_recon_loss: 266311.4514; train_gene_expr_recon_loss: 8998.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280549.8693; train_optim_loss: 280549.8693; val_kl_reg_loss: 5424.6662; val_edge_recon_loss: 263480.1736; val_gene_expr_recon_loss: 8187.2948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277092.1355; val_optim_loss: 277092.1355
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9806; val_auprc_score: 0.9759; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 5275.0913; train_edge_recon_loss: 261642.7976; train_gene_expr_recon_loss: 7901.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 274819.5355; train_optim_loss: 274819.5355; val_kl_reg_loss: 5182.5679; val_edge_recon_loss: 262336.0513; val_gene_expr_recon_loss: 7672.5337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275191.1518; val_optim_loss: 275191.1518
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9824; val_auprc_score: 0.9782; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 5302.7673; train_edge_recon_loss: 260932.8208; train_gene_expr_recon_loss: 7572.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273808.2721; train_optim_loss: 273808.2721; val_kl_reg_loss: 5231.8555; val_edge_recon_loss: 261474.5403; val_gene_expr_recon_loss: 7414.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274120.9664; val_optim_loss: 274120.9664
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9852; val_auprc_score: 0.9815; val_best_acc_score: 0.9479; val_best_f1_score: 0.9490; train_kl_reg_loss: 5305.5446; train_edge_recon_loss: 260662.7070; train_gene_expr_recon_loss: 7410.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273379.0459; train_optim_loss: 273379.0459; val_kl_reg_loss: 5437.3282; val_edge_recon_loss: 261441.4898; val_gene_expr_recon_loss: 7304.0842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 274182.9015; val_optim_loss: 274182.9015
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9855; val_auprc_score: 0.9815; val_best_acc_score: 0.9485; val_best_f1_score: 0.9495; train_kl_reg_loss: 5312.1283; train_edge_recon_loss: 260161.3995; train_gene_expr_recon_loss: 7311.6294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272785.1572; train_optim_loss: 272785.1572; val_kl_reg_loss: 5115.9897; val_edge_recon_loss: 261304.9727; val_gene_expr_recon_loss: 7224.4802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273645.4414; val_optim_loss: 273645.4414
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9840; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 5322.6979; train_edge_recon_loss: 259913.1745; train_gene_expr_recon_loss: 7245.9284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272481.8016; train_optim_loss: 272481.8016; val_kl_reg_loss: 5130.6686; val_edge_recon_loss: 260842.7981; val_gene_expr_recon_loss: 7145.9061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273119.3709; val_optim_loss: 273119.3709
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9876; val_auprc_score: 0.9846; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 5337.4056; train_edge_recon_loss: 259796.7103; train_gene_expr_recon_loss: 7192.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272326.6643; train_optim_loss: 272326.6643; val_kl_reg_loss: 5240.9900; val_edge_recon_loss: 260700.6571; val_gene_expr_recon_loss: 7086.7098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273028.3566; val_optim_loss: 273028.3566
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9885; val_auprc_score: 0.9855; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 5341.3019; train_edge_recon_loss: 259643.7105; train_gene_expr_recon_loss: 7151.4238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272136.4360; train_optim_loss: 272136.4360; val_kl_reg_loss: 5171.6939; val_edge_recon_loss: 260515.4690; val_gene_expr_recon_loss: 7081.1301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272768.2937; val_optim_loss: 272768.2937
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9888; val_auprc_score: 0.9858; val_best_acc_score: 0.9562; val_best_f1_score: 0.9571; train_kl_reg_loss: 5351.7875; train_edge_recon_loss: 259459.0276; train_gene_expr_recon_loss: 7114.7974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271925.6127; train_optim_loss: 271925.6127; val_kl_reg_loss: 5373.6001; val_edge_recon_loss: 260229.1002; val_gene_expr_recon_loss: 7010.5754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272613.2755; val_optim_loss: 272613.2755
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9890; val_auprc_score: 0.9859; val_best_acc_score: 0.9571; val_best_f1_score: 0.9578; train_kl_reg_loss: 5363.6199; train_edge_recon_loss: 259371.0302; train_gene_expr_recon_loss: 7080.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271814.8970; train_optim_loss: 271814.8970; val_kl_reg_loss: 5165.0373; val_edge_recon_loss: 260345.1296; val_gene_expr_recon_loss: 6997.8135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272507.9807; val_optim_loss: 272507.9807
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9899; val_auprc_score: 0.9870; val_best_acc_score: 0.9602; val_best_f1_score: 0.9608; train_kl_reg_loss: 5366.2116; train_edge_recon_loss: 259316.8316; train_gene_expr_recon_loss: 7057.5061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271740.5494; train_optim_loss: 271740.5494; val_kl_reg_loss: 5246.4635; val_edge_recon_loss: 259661.2758; val_gene_expr_recon_loss: 6989.0745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271896.8136; val_optim_loss: 271896.8136
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9904; val_auprc_score: 0.9878; val_best_acc_score: 0.9606; val_best_f1_score: 0.9613; train_kl_reg_loss: 5372.6366; train_edge_recon_loss: 259159.9004; train_gene_expr_recon_loss: 7033.0887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271565.6256; train_optim_loss: 271565.6256; val_kl_reg_loss: 5204.7505; val_edge_recon_loss: 259772.2557; val_gene_expr_recon_loss: 6953.5268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271930.5334; val_optim_loss: 271930.5334
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9900; val_auprc_score: 0.9871; val_best_acc_score: 0.9604; val_best_f1_score: 0.9610; train_kl_reg_loss: 5382.2304; train_edge_recon_loss: 259127.1449; train_gene_expr_recon_loss: 7008.0448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271517.4204; train_optim_loss: 271517.4204; val_kl_reg_loss: 5352.0250; val_edge_recon_loss: 260109.2150; val_gene_expr_recon_loss: 6922.2173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272383.4555; val_optim_loss: 272383.4555
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9905; val_auprc_score: 0.9879; val_best_acc_score: 0.9618; val_best_f1_score: 0.9625; train_kl_reg_loss: 5385.0244; train_edge_recon_loss: 259104.6124; train_gene_expr_recon_loss: 6989.5054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271479.1419; train_optim_loss: 271479.1419; val_kl_reg_loss: 5369.0189; val_edge_recon_loss: 259899.7143; val_gene_expr_recon_loss: 6904.5958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272173.3286; val_optim_loss: 272173.3286
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 5393.6206; train_edge_recon_loss: 258974.5812; train_gene_expr_recon_loss: 6972.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271341.0494; train_optim_loss: 271341.0494; val_kl_reg_loss: 5296.2584; val_edge_recon_loss: 259738.1631; val_gene_expr_recon_loss: 6894.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271929.1030; val_optim_loss: 271929.1030

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9916; val_auprc_score: 0.9893; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 5381.1581; train_edge_recon_loss: 258749.8930; train_gene_expr_recon_loss: 6927.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 271058.7548; train_optim_loss: 271058.7548; val_kl_reg_loss: 5343.1768; val_edge_recon_loss: 259396.7794; val_gene_expr_recon_loss: 6845.6958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271585.6518; val_optim_loss: 271585.6518
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 5380.0759; train_edge_recon_loss: 258635.7955; train_gene_expr_recon_loss: 6918.0892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270933.9607; train_optim_loss: 270933.9607; val_kl_reg_loss: 5304.9655; val_edge_recon_loss: 259267.6878; val_gene_expr_recon_loss: 6862.2320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271434.8859; val_optim_loss: 271434.8859
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9914; val_auprc_score: 0.9888; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 5374.8790; train_edge_recon_loss: 258684.2376; train_gene_expr_recon_loss: 6917.7255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270976.8420; train_optim_loss: 270976.8420; val_kl_reg_loss: 5323.4553; val_edge_recon_loss: 259394.0751; val_gene_expr_recon_loss: 6850.6932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271568.2228; val_optim_loss: 271568.2228
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9650; val_best_f1_score: 0.9655; train_kl_reg_loss: 5375.0117; train_edge_recon_loss: 258545.6365; train_gene_expr_recon_loss: 6912.8347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270833.4829; train_optim_loss: 270833.4829; val_kl_reg_loss: 5298.1195; val_edge_recon_loss: 259426.7065; val_gene_expr_recon_loss: 6853.6353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271578.4610; val_optim_loss: 271578.4610
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9913; val_auprc_score: 0.9888; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 5373.8176; train_edge_recon_loss: 258523.8337; train_gene_expr_recon_loss: 6910.7752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270808.4261; train_optim_loss: 270808.4261; val_kl_reg_loss: 5324.3906; val_edge_recon_loss: 259323.2448; val_gene_expr_recon_loss: 6837.1479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271484.7815; val_optim_loss: 271484.7815
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9920; val_auprc_score: 0.9897; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 5371.7400; train_edge_recon_loss: 258645.2996; train_gene_expr_recon_loss: 6906.2471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270923.2866; train_optim_loss: 270923.2866; val_kl_reg_loss: 5272.1153; val_edge_recon_loss: 259339.9793; val_gene_expr_recon_loss: 6838.6735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271450.7673; val_optim_loss: 271450.7673

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9916; val_auprc_score: 0.9894; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 5374.4778; train_edge_recon_loss: 258435.6557; train_gene_expr_recon_loss: 6907.3254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270717.4594; train_optim_loss: 270717.4594; val_kl_reg_loss: 5313.0777; val_edge_recon_loss: 259492.1018; val_gene_expr_recon_loss: 6835.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271641.0375; val_optim_loss: 271641.0375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9920; val_auprc_score: 0.9895; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 5371.0287; train_edge_recon_loss: 258608.1543; train_gene_expr_recon_loss: 6902.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270881.7731; train_optim_loss: 270881.7731; val_kl_reg_loss: 5311.8534; val_edge_recon_loss: 259070.0133; val_gene_expr_recon_loss: 6840.9664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271222.8322; val_optim_loss: 271222.8322
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9919; val_auprc_score: 0.9896; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 5370.8331; train_edge_recon_loss: 258636.4293; train_gene_expr_recon_loss: 6905.8597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270913.1217; train_optim_loss: 270913.1217; val_kl_reg_loss: 5316.2865; val_edge_recon_loss: 259028.3105; val_gene_expr_recon_loss: 6836.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271180.6149; val_optim_loss: 271180.6149
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 5370.8266; train_edge_recon_loss: 258553.7508; train_gene_expr_recon_loss: 6903.0577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270827.6351; train_optim_loss: 270827.6351; val_kl_reg_loss: 5312.2855; val_edge_recon_loss: 259115.5307; val_gene_expr_recon_loss: 6830.2163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271258.0330; val_optim_loss: 271258.0330
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 5370.6760; train_edge_recon_loss: 258529.9280; train_gene_expr_recon_loss: 6899.0884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270799.6922; train_optim_loss: 270799.6922; val_kl_reg_loss: 5305.8521; val_edge_recon_loss: 259337.3848; val_gene_expr_recon_loss: 6851.1854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271494.4234; val_optim_loss: 271494.4234
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 5372.3312; train_edge_recon_loss: 258431.8993; train_gene_expr_recon_loss: 6903.9966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270708.2268; train_optim_loss: 270708.2268; val_kl_reg_loss: 5312.5675; val_edge_recon_loss: 258958.3288; val_gene_expr_recon_loss: 6838.4753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271109.3711; val_optim_loss: 271109.3711
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 5370.3314; train_edge_recon_loss: 258593.8998; train_gene_expr_recon_loss: 6900.2042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270864.4355; train_optim_loss: 270864.4355; val_kl_reg_loss: 5315.6383; val_edge_recon_loss: 259104.1599; val_gene_expr_recon_loss: 6834.6130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271254.4127; val_optim_loss: 271254.4127
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 5371.1903; train_edge_recon_loss: 258541.8650; train_gene_expr_recon_loss: 6899.8115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270812.8671; train_optim_loss: 270812.8671; val_kl_reg_loss: 5313.4843; val_edge_recon_loss: 259441.4368; val_gene_expr_recon_loss: 6830.3195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271585.2414; val_optim_loss: 271585.2414
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9919; val_auprc_score: 0.9896; val_best_acc_score: 0.9656; val_best_f1_score: 0.9661; train_kl_reg_loss: 5370.0673; train_edge_recon_loss: 258465.7288; train_gene_expr_recon_loss: 6899.2264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270735.0232; train_optim_loss: 270735.0232; val_kl_reg_loss: 5308.1719; val_edge_recon_loss: 259132.8304; val_gene_expr_recon_loss: 6830.5628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271271.5664; val_optim_loss: 271271.5664
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9920; val_auprc_score: 0.9897; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5371.4789; train_edge_recon_loss: 258571.9457; train_gene_expr_recon_loss: 6899.4901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270842.9144; train_optim_loss: 270842.9144; val_kl_reg_loss: 5315.5041; val_edge_recon_loss: 259058.7161; val_gene_expr_recon_loss: 6838.6489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271212.8692; val_optim_loss: 271212.8692

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 5370.6602; train_edge_recon_loss: 258545.5314; train_gene_expr_recon_loss: 6899.0793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270815.2710; train_optim_loss: 270815.2710; val_kl_reg_loss: 5311.2720; val_edge_recon_loss: 259230.2071; val_gene_expr_recon_loss: 6835.9482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271377.4253; val_optim_loss: 271377.4253
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9918; val_auprc_score: 0.9894; val_best_acc_score: 0.9651; val_best_f1_score: 0.9657; train_kl_reg_loss: 5370.2888; train_edge_recon_loss: 258463.8338; train_gene_expr_recon_loss: 6897.2446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270731.3673; train_optim_loss: 270731.3673; val_kl_reg_loss: 5308.7475; val_edge_recon_loss: 259394.9243; val_gene_expr_recon_loss: 6848.1830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271551.8564; val_optim_loss: 271551.8564
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9914; val_auprc_score: 0.9888; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 5367.2521; train_edge_recon_loss: 258530.9105; train_gene_expr_recon_loss: 6896.1474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270794.3095; train_optim_loss: 270794.3095; val_kl_reg_loss: 5311.8356; val_edge_recon_loss: 259285.3881; val_gene_expr_recon_loss: 6827.6666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271424.8913; val_optim_loss: 271424.8913
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 5370.6157; train_edge_recon_loss: 258519.7129; train_gene_expr_recon_loss: 6896.7476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270787.0766; train_optim_loss: 270787.0766; val_kl_reg_loss: 5311.3536; val_edge_recon_loss: 258803.1768; val_gene_expr_recon_loss: 6836.2398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270950.7701; val_optim_loss: 270950.7701
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9916; val_auprc_score: 0.9890; val_best_acc_score: 0.9653; val_best_f1_score: 0.9659; train_kl_reg_loss: 5371.1609; train_edge_recon_loss: 258462.6812; train_gene_expr_recon_loss: 6897.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270730.9853; train_optim_loss: 270730.9853; val_kl_reg_loss: 5315.2748; val_edge_recon_loss: 259505.4964; val_gene_expr_recon_loss: 6834.3272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271655.0982; val_optim_loss: 271655.0982
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 5370.7897; train_edge_recon_loss: 258535.5249; train_gene_expr_recon_loss: 6900.3303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270806.6454; train_optim_loss: 270806.6454; val_kl_reg_loss: 5306.8589; val_edge_recon_loss: 259276.1733; val_gene_expr_recon_loss: 6824.7833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271407.8131; val_optim_loss: 271407.8131
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9922; val_auprc_score: 0.9897; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 5366.7752; train_edge_recon_loss: 258574.5990; train_gene_expr_recon_loss: 6896.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270837.5825; train_optim_loss: 270837.5825; val_kl_reg_loss: 5307.9442; val_edge_recon_loss: 259029.7297; val_gene_expr_recon_loss: 6820.7482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271158.4219; val_optim_loss: 271158.4219
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9916; val_auprc_score: 0.9891; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 5370.0313; train_edge_recon_loss: 258556.1853; train_gene_expr_recon_loss: 6897.1446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270823.3612; train_optim_loss: 270823.3612; val_kl_reg_loss: 5312.5071; val_edge_recon_loss: 259393.5955; val_gene_expr_recon_loss: 6822.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271528.6729; val_optim_loss: 271528.6729

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9919; val_auprc_score: 0.9897; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 5370.5152; train_edge_recon_loss: 258504.8027; train_gene_expr_recon_loss: 6897.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270773.1713; train_optim_loss: 270773.1713; val_kl_reg_loss: 5312.1701; val_edge_recon_loss: 259216.3810; val_gene_expr_recon_loss: 6834.9440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271363.4955; val_optim_loss: 271363.4955
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9916; val_auprc_score: 0.9892; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 5370.4397; train_edge_recon_loss: 258513.5659; train_gene_expr_recon_loss: 6899.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270783.3586; train_optim_loss: 270783.3586; val_kl_reg_loss: 5312.7544; val_edge_recon_loss: 259339.8399; val_gene_expr_recon_loss: 6831.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271483.9925; val_optim_loss: 271483.9925
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9917; val_auprc_score: 0.9893; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 5369.9912; train_edge_recon_loss: 258541.4948; train_gene_expr_recon_loss: 6899.7774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270811.2635; train_optim_loss: 270811.2635; val_kl_reg_loss: 5311.5928; val_edge_recon_loss: 259426.8851; val_gene_expr_recon_loss: 6836.6870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271575.1650; val_optim_loss: 271575.1650
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9919; val_auprc_score: 0.9897; val_best_acc_score: 0.9657; val_best_f1_score: 0.9664; train_kl_reg_loss: 5369.8138; train_edge_recon_loss: 258551.0485; train_gene_expr_recon_loss: 6897.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270817.9991; train_optim_loss: 270817.9991; val_kl_reg_loss: 5310.9853; val_edge_recon_loss: 259301.2712; val_gene_expr_recon_loss: 6836.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 271448.6533; val_optim_loss: 271448.6533

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 206 min 51 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9919
Val AUPRC score: 0.9897
Val best accuracy score: 0.9653
Val best F1 score: 0.9659
Val gene expr MSE score: 1.8425

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
