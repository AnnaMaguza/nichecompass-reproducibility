None
Run timestamp: 18072023_024855_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9650; val_auprc_score: 0.9644; val_best_acc_score: 0.9020; val_best_f1_score: 0.9029; train_kl_reg_loss: 80391.3365; train_edge_recon_loss: 2903630.8273; train_gene_expr_recon_loss: 13868040.2548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16852062.4364; train_optim_loss: 16852062.4364; val_kl_reg_loss: 66034.1949; val_edge_recon_loss: 2752289.4507; val_gene_expr_recon_loss: 13058712.8779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15877036.5446; val_optim_loss: 15877036.5446
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9818; val_auprc_score: 0.9814; val_best_acc_score: 0.9311; val_best_f1_score: 0.9317; train_kl_reg_loss: 58311.5894; train_edge_recon_loss: 2697900.7695; train_gene_expr_recon_loss: 12836513.6279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15592725.9749; train_optim_loss: 15592725.9749; val_kl_reg_loss: 51671.1267; val_edge_recon_loss: 2694721.0610; val_gene_expr_recon_loss: 12698845.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15445237.2441; val_optim_loss: 15445237.2441
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9852; val_auprc_score: 0.9848; val_best_acc_score: 0.9386; val_best_f1_score: 0.9390; train_kl_reg_loss: 49700.9636; train_edge_recon_loss: 2668867.5743; train_gene_expr_recon_loss: 12605730.8237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15324299.3569; train_optim_loss: 15324299.3569; val_kl_reg_loss: 44323.2917; val_edge_recon_loss: 2680457.7324; val_gene_expr_recon_loss: 12555074.5587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15279855.5822; val_optim_loss: 15279855.5822
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9870; val_auprc_score: 0.9867; val_best_acc_score: 0.9429; val_best_f1_score: 0.9431; train_kl_reg_loss: 45528.6794; train_edge_recon_loss: 2656723.8395; train_gene_expr_recon_loss: 12490934.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15193186.8226; train_optim_loss: 15193186.8226; val_kl_reg_loss: 43442.1538; val_edge_recon_loss: 2674515.0411; val_gene_expr_recon_loss: 12466472.7230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15184429.9437; val_optim_loss: 15184429.9437
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9881; val_auprc_score: 0.9877; val_best_acc_score: 0.9449; val_best_f1_score: 0.9452; train_kl_reg_loss: 43387.3109; train_edge_recon_loss: 2650434.4805; train_gene_expr_recon_loss: 12422735.4924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15116557.2883; train_optim_loss: 15116557.2883; val_kl_reg_loss: 42437.5132; val_edge_recon_loss: 2667376.6796; val_gene_expr_recon_loss: 12427870.3474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15137684.5399; val_optim_loss: 15137684.5399
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9885; val_auprc_score: 0.9882; val_best_acc_score: 0.9466; val_best_f1_score: 0.9467; train_kl_reg_loss: 42170.8279; train_edge_recon_loss: 2645397.4010; train_gene_expr_recon_loss: 12371865.8446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15059434.0691; train_optim_loss: 15059434.0691; val_kl_reg_loss: 40264.0005; val_edge_recon_loss: 2664095.2230; val_gene_expr_recon_loss: 12415432.5023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15119791.7277; val_optim_loss: 15119791.7277
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9893; val_auprc_score: 0.9889; val_best_acc_score: 0.9489; val_best_f1_score: 0.9491; train_kl_reg_loss: 41128.3037; train_edge_recon_loss: 2643585.1605; train_gene_expr_recon_loss: 12337870.0890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15022583.5531; train_optim_loss: 15022583.5531; val_kl_reg_loss: 40222.3621; val_edge_recon_loss: 2661097.9589; val_gene_expr_recon_loss: 12364760.2113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15066080.4742; val_optim_loss: 15066080.4742
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9896; val_auprc_score: 0.9891; val_best_acc_score: 0.9494; val_best_f1_score: 0.9495; train_kl_reg_loss: 40240.4005; train_edge_recon_loss: 2640603.8131; train_gene_expr_recon_loss: 12308127.6405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14988971.8624; train_optim_loss: 14988971.8624; val_kl_reg_loss: 38921.8805; val_edge_recon_loss: 2661814.9014; val_gene_expr_recon_loss: 12363809.9624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15064546.7230; val_optim_loss: 15064546.7230
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9897; val_auprc_score: 0.9894; val_best_acc_score: 0.9493; val_best_f1_score: 0.9497; train_kl_reg_loss: 39572.9281; train_edge_recon_loss: 2637701.3552; train_gene_expr_recon_loss: 12293066.4322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14970340.7237; train_optim_loss: 14970340.7237; val_kl_reg_loss: 37688.4563; val_edge_recon_loss: 2660724.3063; val_gene_expr_recon_loss: 12343805.9906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15042218.7465; val_optim_loss: 15042218.7465
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9897; val_auprc_score: 0.9894; val_best_acc_score: 0.9496; val_best_f1_score: 0.9497; train_kl_reg_loss: 39068.1978; train_edge_recon_loss: 2637223.4297; train_gene_expr_recon_loss: 12276404.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14952696.4380; train_optim_loss: 14952696.4380; val_kl_reg_loss: 38900.6638; val_edge_recon_loss: 2656646.6913; val_gene_expr_recon_loss: 12339698.1690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15035245.5258; val_optim_loss: 15035245.5258
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9905; val_auprc_score: 0.9901; val_best_acc_score: 0.9515; val_best_f1_score: 0.9520; train_kl_reg_loss: 38577.3486; train_edge_recon_loss: 2635648.7376; train_gene_expr_recon_loss: 12259508.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14933734.3155; train_optim_loss: 14933734.3155; val_kl_reg_loss: 37498.0378; val_edge_recon_loss: 2654514.7441; val_gene_expr_recon_loss: 12335316.7371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15027329.5117; val_optim_loss: 15027329.5117
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9904; val_auprc_score: 0.9898; val_best_acc_score: 0.9517; val_best_f1_score: 0.9519; train_kl_reg_loss: 38316.5784; train_edge_recon_loss: 2633996.7892; train_gene_expr_recon_loss: 12250855.7253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14923169.0900; train_optim_loss: 14923169.0900; val_kl_reg_loss: 36697.0978; val_edge_recon_loss: 2656133.2735; val_gene_expr_recon_loss: 12324588.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15017418.6854; val_optim_loss: 15017418.6854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9908; val_auprc_score: 0.9903; val_best_acc_score: 0.9526; val_best_f1_score: 0.9529; train_kl_reg_loss: 37880.1451; train_edge_recon_loss: 2632366.4263; train_gene_expr_recon_loss: 12243942.6834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14914189.2611; train_optim_loss: 14914189.2611; val_kl_reg_loss: 37115.4492; val_edge_recon_loss: 2653488.8474; val_gene_expr_recon_loss: 12309648.7934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15000253.1080; val_optim_loss: 15000253.1080
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9907; val_auprc_score: 0.9903; val_best_acc_score: 0.9530; val_best_f1_score: 0.9533; train_kl_reg_loss: 37656.4074; train_edge_recon_loss: 2631718.5008; train_gene_expr_recon_loss: 12238145.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14907520.4710; train_optim_loss: 14907520.4710; val_kl_reg_loss: 36196.8105; val_edge_recon_loss: 2654655.5059; val_gene_expr_recon_loss: 12317965.8451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15008818.1831; val_optim_loss: 15008818.1831
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9907; val_auprc_score: 0.9902; val_best_acc_score: 0.9527; val_best_f1_score: 0.9528; train_kl_reg_loss: 37337.9311; train_edge_recon_loss: 2631778.2827; train_gene_expr_recon_loss: 12232465.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14901581.3543; train_optim_loss: 14901581.3543; val_kl_reg_loss: 36658.4824; val_edge_recon_loss: 2653759.5293; val_gene_expr_recon_loss: 12302192.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14992610.6197; val_optim_loss: 14992610.6197
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9912; val_auprc_score: 0.9907; val_best_acc_score: 0.9543; val_best_f1_score: 0.9546; train_kl_reg_loss: 37096.1084; train_edge_recon_loss: 2630282.3141; train_gene_expr_recon_loss: 12222031.8514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14889410.2752; train_optim_loss: 14889410.2752; val_kl_reg_loss: 36108.6195; val_edge_recon_loss: 2648630.1984; val_gene_expr_recon_loss: 12308223.7418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14992962.5822; val_optim_loss: 14992962.5822
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9914; val_auprc_score: 0.9911; val_best_acc_score: 0.9545; val_best_f1_score: 0.9547; train_kl_reg_loss: 36809.7385; train_edge_recon_loss: 2629363.9050; train_gene_expr_recon_loss: 12217341.0581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14883514.6934; train_optim_loss: 14883514.6934; val_kl_reg_loss: 36418.1771; val_edge_recon_loss: 2652082.6068; val_gene_expr_recon_loss: 12305363.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14993864.4789; val_optim_loss: 14993864.4789
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9915; val_auprc_score: 0.9912; val_best_acc_score: 0.9544; val_best_f1_score: 0.9546; train_kl_reg_loss: 36597.3305; train_edge_recon_loss: 2628681.1162; train_gene_expr_recon_loss: 12215737.8095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14881016.2569; train_optim_loss: 14881016.2569; val_kl_reg_loss: 35447.7184; val_edge_recon_loss: 2648030.0023; val_gene_expr_recon_loss: 12319248.1737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15002725.8967; val_optim_loss: 15002725.8967
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9914; val_auprc_score: 0.9910; val_best_acc_score: 0.9543; val_best_f1_score: 0.9545; train_kl_reg_loss: 36541.5293; train_edge_recon_loss: 2626930.1218; train_gene_expr_recon_loss: 12210099.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14873571.4542; train_optim_loss: 14873571.4542; val_kl_reg_loss: 35833.1647; val_edge_recon_loss: 2649531.3122; val_gene_expr_recon_loss: 12319408.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15004772.8873; val_optim_loss: 15004772.8873

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9918; val_auprc_score: 0.9915; val_best_acc_score: 0.9554; val_best_f1_score: 0.9555; train_kl_reg_loss: 38529.4877; train_edge_recon_loss: 2625790.7831; train_gene_expr_recon_loss: 12106925.7724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14771246.0607; train_optim_loss: 14771246.0607; val_kl_reg_loss: 38092.0304; val_edge_recon_loss: 2645507.5657; val_gene_expr_recon_loss: 12220703.8967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14904303.5023; val_optim_loss: 14904303.5023
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9922; val_auprc_score: 0.9918; val_best_acc_score: 0.9572; val_best_f1_score: 0.9572; train_kl_reg_loss: 38872.2056; train_edge_recon_loss: 2624632.2347; train_gene_expr_recon_loss: 12097487.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14760992.1743; train_optim_loss: 14760992.1743; val_kl_reg_loss: 38292.7391; val_edge_recon_loss: 2644169.6678; val_gene_expr_recon_loss: 12204377.7981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14886840.2019; val_optim_loss: 14886840.2019
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9920; val_auprc_score: 0.9916; val_best_acc_score: 0.9567; val_best_f1_score: 0.9568; train_kl_reg_loss: 39002.5927; train_edge_recon_loss: 2623611.9925; train_gene_expr_recon_loss: 12092924.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14755538.8299; train_optim_loss: 14755538.8299; val_kl_reg_loss: 38147.8027; val_edge_recon_loss: 2644532.1397; val_gene_expr_recon_loss: 12189313.8122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14871993.7465; val_optim_loss: 14871993.7465
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9920; val_auprc_score: 0.9916; val_best_acc_score: 0.9565; val_best_f1_score: 0.9567; train_kl_reg_loss: 38859.2344; train_edge_recon_loss: 2623862.2033; train_gene_expr_recon_loss: 12088133.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14750855.0031; train_optim_loss: 14750855.0031; val_kl_reg_loss: 38018.0985; val_edge_recon_loss: 2647487.3498; val_gene_expr_recon_loss: 12205403.6995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14890909.1033; val_optim_loss: 14890909.1033
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9922; val_auprc_score: 0.9919; val_best_acc_score: 0.9568; val_best_f1_score: 0.9570; train_kl_reg_loss: 38779.1188; train_edge_recon_loss: 2623332.7084; train_gene_expr_recon_loss: 12088482.2187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14750594.0445; train_optim_loss: 14750594.0445; val_kl_reg_loss: 38133.5510; val_edge_recon_loss: 2649234.1385; val_gene_expr_recon_loss: 12201648.3005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14889016.0188; val_optim_loss: 14889016.0188
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9921; val_auprc_score: 0.9917; val_best_acc_score: 0.9569; val_best_f1_score: 0.9569; train_kl_reg_loss: 38631.1836; train_edge_recon_loss: 2624147.8073; train_gene_expr_recon_loss: 12081064.9126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14743843.9089; train_optim_loss: 14743843.9089; val_kl_reg_loss: 37851.5261; val_edge_recon_loss: 2646129.9002; val_gene_expr_recon_loss: 12197004.7934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14880986.2347; val_optim_loss: 14880986.2347
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9918; val_best_acc_score: 0.9570; val_best_f1_score: 0.9573; train_kl_reg_loss: 38645.3739; train_edge_recon_loss: 2623418.9719; train_gene_expr_recon_loss: 12083452.2480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14745516.5950; train_optim_loss: 14745516.5950; val_kl_reg_loss: 37947.0313; val_edge_recon_loss: 2645109.1561; val_gene_expr_recon_loss: 12198681.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14881737.5962; val_optim_loss: 14881737.5962

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9921; val_auprc_score: 0.9917; val_best_acc_score: 0.9569; val_best_f1_score: 0.9572; train_kl_reg_loss: 38796.5571; train_edge_recon_loss: 2622096.0497; train_gene_expr_recon_loss: 12067016.5704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14727909.1811; train_optim_loss: 14727909.1811; val_kl_reg_loss: 38194.4748; val_edge_recon_loss: 2644878.3498; val_gene_expr_recon_loss: 12185847.6244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14868920.4272; val_optim_loss: 14868920.4272
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9923; val_auprc_score: 0.9920; val_best_acc_score: 0.9569; val_best_f1_score: 0.9571; train_kl_reg_loss: 38855.9925; train_edge_recon_loss: 2623197.0317; train_gene_expr_recon_loss: 12065634.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14727687.1805; train_optim_loss: 14727687.1805; val_kl_reg_loss: 38176.8835; val_edge_recon_loss: 2646117.8791; val_gene_expr_recon_loss: 12177861.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14862156.2582; val_optim_loss: 14862156.2582
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9921; val_best_acc_score: 0.9574; val_best_f1_score: 0.9576; train_kl_reg_loss: 38852.0400; train_edge_recon_loss: 2623457.8182; train_gene_expr_recon_loss: 12066821.2909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14729131.1586; train_optim_loss: 14729131.1586; val_kl_reg_loss: 38059.0228; val_edge_recon_loss: 2644428.8615; val_gene_expr_recon_loss: 12175283.4085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14857771.2629; val_optim_loss: 14857771.2629
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9917; val_best_acc_score: 0.9574; val_best_f1_score: 0.9577; train_kl_reg_loss: 38864.0485; train_edge_recon_loss: 2623555.2904; train_gene_expr_recon_loss: 12063894.9006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14726314.2344; train_optim_loss: 14726314.2344; val_kl_reg_loss: 38072.2311; val_edge_recon_loss: 2645789.4812; val_gene_expr_recon_loss: 12168400.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14852262.2770; val_optim_loss: 14852262.2770
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9922; val_auprc_score: 0.9918; val_best_acc_score: 0.9572; val_best_f1_score: 0.9574; train_kl_reg_loss: 38834.1275; train_edge_recon_loss: 2622768.7475; train_gene_expr_recon_loss: 12062930.4662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14724533.3443; train_optim_loss: 14724533.3443; val_kl_reg_loss: 38085.9967; val_edge_recon_loss: 2644010.3380; val_gene_expr_recon_loss: 12162539.8169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14844636.1737; val_optim_loss: 14844636.1737
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9924; val_auprc_score: 0.9920; val_best_acc_score: 0.9574; val_best_f1_score: 0.9577; train_kl_reg_loss: 38873.1447; train_edge_recon_loss: 2623397.0071; train_gene_expr_recon_loss: 12066776.2690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14729046.4176; train_optim_loss: 14729046.4176; val_kl_reg_loss: 38196.9472; val_edge_recon_loss: 2645461.5434; val_gene_expr_recon_loss: 12170740.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14854398.9296; val_optim_loss: 14854398.9296
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9921; val_auprc_score: 0.9916; val_best_acc_score: 0.9568; val_best_f1_score: 0.9570; train_kl_reg_loss: 38865.7806; train_edge_recon_loss: 2622851.4356; train_gene_expr_recon_loss: 12063852.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14725569.8587; train_optim_loss: 14725569.8587; val_kl_reg_loss: 38105.4394; val_edge_recon_loss: 2647673.7430; val_gene_expr_recon_loss: 12190792.2770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14876571.4648; val_optim_loss: 14876571.4648
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9924; val_auprc_score: 0.9919; val_best_acc_score: 0.9571; val_best_f1_score: 0.9575; train_kl_reg_loss: 38843.7770; train_edge_recon_loss: 2622526.1001; train_gene_expr_recon_loss: 12065690.9001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14727060.7687; train_optim_loss: 14727060.7687; val_kl_reg_loss: 38058.2004; val_edge_recon_loss: 2647074.1338; val_gene_expr_recon_loss: 12159981.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14845114.2582; val_optim_loss: 14845114.2582
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9924; val_auprc_score: 0.9921; val_best_acc_score: 0.9580; val_best_f1_score: 0.9581; train_kl_reg_loss: 38807.5607; train_edge_recon_loss: 2622788.9108; train_gene_expr_recon_loss: 12064978.1596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14726574.6164; train_optim_loss: 14726574.6164; val_kl_reg_loss: 38053.1291; val_edge_recon_loss: 2644961.3204; val_gene_expr_recon_loss: 12180854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14863868.4789; val_optim_loss: 14863868.4789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9922; val_auprc_score: 0.9917; val_best_acc_score: 0.9572; val_best_f1_score: 0.9574; train_kl_reg_loss: 38812.8144; train_edge_recon_loss: 2623843.5162; train_gene_expr_recon_loss: 12064878.9215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14727535.2522; train_optim_loss: 14727535.2522; val_kl_reg_loss: 38122.2182; val_edge_recon_loss: 2644923.3263; val_gene_expr_recon_loss: 12181042.9155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14864088.4366; val_optim_loss: 14864088.4366
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9924; val_auprc_score: 0.9921; val_best_acc_score: 0.9577; val_best_f1_score: 0.9578; train_kl_reg_loss: 38829.2654; train_edge_recon_loss: 2623129.6849; train_gene_expr_recon_loss: 12060749.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14722708.2145; train_optim_loss: 14722708.2145; val_kl_reg_loss: 38117.6065; val_edge_recon_loss: 2642406.9906; val_gene_expr_recon_loss: 12175924.6948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14856449.2911; val_optim_loss: 14856449.2911
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9923; val_auprc_score: 0.9920; val_best_acc_score: 0.9571; val_best_f1_score: 0.9574; train_kl_reg_loss: 38836.0046; train_edge_recon_loss: 2623566.3777; train_gene_expr_recon_loss: 12060220.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14722622.7054; train_optim_loss: 14722622.7054; val_kl_reg_loss: 38114.7153; val_edge_recon_loss: 2645517.5235; val_gene_expr_recon_loss: 12180972.1080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14864604.3568; val_optim_loss: 14864604.3568
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9923; val_auprc_score: 0.9920; val_best_acc_score: 0.9574; val_best_f1_score: 0.9575; train_kl_reg_loss: 38850.0919; train_edge_recon_loss: 2623169.4771; train_gene_expr_recon_loss: 12062565.4893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14724585.0696; train_optim_loss: 14724585.0696; val_kl_reg_loss: 38119.3892; val_edge_recon_loss: 2644386.9953; val_gene_expr_recon_loss: 12182044.5540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14864550.8826; val_optim_loss: 14864550.8826

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 300 min 52 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9921
Val AUPRC score: 0.9916
Val best accuracy score: 0.9570
Val best F1 score: 0.9572
Val gene expr MSE score: 8.3927

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
