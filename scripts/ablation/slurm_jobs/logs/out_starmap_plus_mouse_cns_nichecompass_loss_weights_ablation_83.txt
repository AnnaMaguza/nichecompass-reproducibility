None
Run timestamp: 31072023_101358_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9846; val_auprc_score: 0.9777; val_best_acc_score: 0.9562; val_best_f1_score: 0.9572; train_kl_reg_loss: 5856.9972; train_edge_recon_loss: 265177.4245; train_gene_expr_recon_loss: 22869.4534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 293903.8741; train_optim_loss: 293903.8741; val_kl_reg_loss: 5825.9688; val_edge_recon_loss: 258175.5822; val_gene_expr_recon_loss: 20825.9048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 284827.4570; val_optim_loss: 284827.4570
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9889; val_auprc_score: 0.9840; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 5745.4794; train_edge_recon_loss: 258305.7063; train_gene_expr_recon_loss: 20280.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 284331.4224; train_optim_loss: 284331.4224; val_kl_reg_loss: 5775.0428; val_edge_recon_loss: 256853.1437; val_gene_expr_recon_loss: 19702.0147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 282330.1998; val_optim_loss: 282330.1998
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9898; val_auprc_score: 0.9851; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 5733.2179; train_edge_recon_loss: 257461.9593; train_gene_expr_recon_loss: 19429.4749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 282624.6519; train_optim_loss: 282624.6519; val_kl_reg_loss: 5773.5947; val_edge_recon_loss: 256247.2508; val_gene_expr_recon_loss: 19088.7673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 281109.6142; val_optim_loss: 281109.6142
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9866; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 5731.8601; train_edge_recon_loss: 257120.9585; train_gene_expr_recon_loss: 18899.6567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 281752.4751; train_optim_loss: 281752.4751; val_kl_reg_loss: 5679.6901; val_edge_recon_loss: 255934.0248; val_gene_expr_recon_loss: 18663.5460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280277.2597; val_optim_loss: 280277.2597
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9900; val_best_acc_score: 0.9736; val_best_f1_score: 0.9741; train_kl_reg_loss: 5728.5260; train_edge_recon_loss: 256905.3922; train_gene_expr_recon_loss: 18559.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 281193.4805; train_optim_loss: 281193.4805; val_kl_reg_loss: 5765.9509; val_edge_recon_loss: 255963.7787; val_gene_expr_recon_loss: 18348.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280078.0159; val_optim_loss: 280078.0159
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9932; val_auprc_score: 0.9903; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 5720.4580; train_edge_recon_loss: 256782.4810; train_gene_expr_recon_loss: 18327.0834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280830.0224; train_optim_loss: 280830.0224; val_kl_reg_loss: 5682.8183; val_edge_recon_loss: 255502.7928; val_gene_expr_recon_loss: 18155.2343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279340.8473; val_optim_loss: 279340.8473
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 5724.3573; train_edge_recon_loss: 256525.5487; train_gene_expr_recon_loss: 18115.7219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280365.6275; train_optim_loss: 280365.6275; val_kl_reg_loss: 5656.0218; val_edge_recon_loss: 255384.9416; val_gene_expr_recon_loss: 17961.2299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 279002.1947; val_optim_loss: 279002.1947
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9942; val_auprc_score: 0.9916; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 5722.7960; train_edge_recon_loss: 256356.9042; train_gene_expr_recon_loss: 17983.4288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280063.1291; train_optim_loss: 280063.1291; val_kl_reg_loss: 5735.8042; val_edge_recon_loss: 255318.0415; val_gene_expr_recon_loss: 17819.7033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278873.5502; val_optim_loss: 278873.5502
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9946; val_auprc_score: 0.9923; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 5726.8887; train_edge_recon_loss: 256273.5142; train_gene_expr_recon_loss: 17870.4239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279870.8282; train_optim_loss: 279870.8282; val_kl_reg_loss: 5777.3922; val_edge_recon_loss: 255248.5341; val_gene_expr_recon_loss: 17736.7382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278762.6665; val_optim_loss: 278762.6665
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9947; val_auprc_score: 0.9923; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5726.9086; train_edge_recon_loss: 256127.1176; train_gene_expr_recon_loss: 17775.7659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279629.7925; train_optim_loss: 279629.7925; val_kl_reg_loss: 5762.0012; val_edge_recon_loss: 255412.4905; val_gene_expr_recon_loss: 17665.4087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278839.9006; val_optim_loss: 278839.9006
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9934; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 5728.9027; train_edge_recon_loss: 256057.1872; train_gene_expr_recon_loss: 17700.3251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279486.4141; train_optim_loss: 279486.4141; val_kl_reg_loss: 5725.2230; val_edge_recon_loss: 254959.0653; val_gene_expr_recon_loss: 17582.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278267.0461; val_optim_loss: 278267.0461
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9930; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5730.1646; train_edge_recon_loss: 255984.5200; train_gene_expr_recon_loss: 17633.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279347.6882; train_optim_loss: 279347.6882; val_kl_reg_loss: 5636.1504; val_edge_recon_loss: 254880.6288; val_gene_expr_recon_loss: 17526.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278043.0108; val_optim_loss: 278043.0108
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9955; val_auprc_score: 0.9933; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 5728.9228; train_edge_recon_loss: 255862.4532; train_gene_expr_recon_loss: 17582.4048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279173.7803; train_optim_loss: 279173.7803; val_kl_reg_loss: 5669.4817; val_edge_recon_loss: 254916.4926; val_gene_expr_recon_loss: 17480.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278066.3668; val_optim_loss: 278066.3668
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9942; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 5730.3910; train_edge_recon_loss: 255777.2507; train_gene_expr_recon_loss: 17513.9894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 279021.6319; train_optim_loss: 279021.6319; val_kl_reg_loss: 5657.0055; val_edge_recon_loss: 254572.4214; val_gene_expr_recon_loss: 17437.4700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277666.8975; val_optim_loss: 277666.8975
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9936; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 5729.4226; train_edge_recon_loss: 255737.9516; train_gene_expr_recon_loss: 17485.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278952.7437; train_optim_loss: 278952.7437; val_kl_reg_loss: 5692.7653; val_edge_recon_loss: 254607.7057; val_gene_expr_recon_loss: 17412.2002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277712.6716; val_optim_loss: 277712.6716
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9947; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 5732.3465; train_edge_recon_loss: 255622.8163; train_gene_expr_recon_loss: 17428.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278783.4209; train_optim_loss: 278783.4209; val_kl_reg_loss: 5722.1885; val_edge_recon_loss: 254479.8832; val_gene_expr_recon_loss: 17351.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277554.0015; val_optim_loss: 277554.0015
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9944; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 5732.1753; train_edge_recon_loss: 255606.7742; train_gene_expr_recon_loss: 17413.5269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278752.4769; train_optim_loss: 278752.4769; val_kl_reg_loss: 5691.6108; val_edge_recon_loss: 254475.3770; val_gene_expr_recon_loss: 17357.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277524.9708; val_optim_loss: 277524.9708
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9962; val_auprc_score: 0.9940; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 5732.7654; train_edge_recon_loss: 255472.6750; train_gene_expr_recon_loss: 17379.0097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278584.4504; train_optim_loss: 278584.4504; val_kl_reg_loss: 5845.1538; val_edge_recon_loss: 254563.4308; val_gene_expr_recon_loss: 17292.1239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277700.7080; val_optim_loss: 277700.7080
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9966; val_auprc_score: 0.9952; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 5730.2271; train_edge_recon_loss: 255541.0859; train_gene_expr_recon_loss: 17348.4489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278619.7619; train_optim_loss: 278619.7619; val_kl_reg_loss: 5645.5719; val_edge_recon_loss: 254480.0341; val_gene_expr_recon_loss: 17249.5746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277375.1808; val_optim_loss: 277375.1808
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9965; val_auprc_score: 0.9945; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 5733.1051; train_edge_recon_loss: 255376.5216; train_gene_expr_recon_loss: 17323.2937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278432.9204; train_optim_loss: 278432.9204; val_kl_reg_loss: 5753.3150; val_edge_recon_loss: 254426.7999; val_gene_expr_recon_loss: 17246.0507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277426.1660; val_optim_loss: 277426.1660
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9951; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 5734.0098; train_edge_recon_loss: 255390.9280; train_gene_expr_recon_loss: 17323.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278448.0875; train_optim_loss: 278448.0875; val_kl_reg_loss: 5727.1471; val_edge_recon_loss: 254252.0968; val_gene_expr_recon_loss: 17215.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277194.7633; val_optim_loss: 277194.7633
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9964; val_auprc_score: 0.9945; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 5733.2199; train_edge_recon_loss: 255370.2706; train_gene_expr_recon_loss: 17296.7093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278400.1997; train_optim_loss: 278400.1997; val_kl_reg_loss: 5722.3271; val_edge_recon_loss: 254505.2467; val_gene_expr_recon_loss: 17225.9159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277453.4918; val_optim_loss: 277453.4918
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9947; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 5733.4379; train_edge_recon_loss: 255287.3109; train_gene_expr_recon_loss: 17282.6530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278303.4020; train_optim_loss: 278303.4020; val_kl_reg_loss: 5562.6107; val_edge_recon_loss: 254109.6089; val_gene_expr_recon_loss: 17216.9248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276889.1429; val_optim_loss: 276889.1429
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9967; val_auprc_score: 0.9949; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 5734.8682; train_edge_recon_loss: 255235.2517; train_gene_expr_recon_loss: 17272.6609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278242.7811; train_optim_loss: 278242.7811; val_kl_reg_loss: 5846.2968; val_edge_recon_loss: 254049.4936; val_gene_expr_recon_loss: 17220.4696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277116.2597; val_optim_loss: 277116.2597
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9952; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 5733.9459; train_edge_recon_loss: 255255.8710; train_gene_expr_recon_loss: 17251.6385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278241.4558; train_optim_loss: 278241.4558; val_kl_reg_loss: 5696.6003; val_edge_recon_loss: 254030.1911; val_gene_expr_recon_loss: 17175.1585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276901.9524; val_optim_loss: 276901.9524
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9956; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 5731.7144; train_edge_recon_loss: 255301.4075; train_gene_expr_recon_loss: 17249.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278283.0696; train_optim_loss: 278283.0696; val_kl_reg_loss: 5732.3374; val_edge_recon_loss: 254200.8210; val_gene_expr_recon_loss: 17199.2236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 277132.3811; val_optim_loss: 277132.3811
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 5737.1941; train_edge_recon_loss: 255132.5664; train_gene_expr_recon_loss: 17233.0554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278102.8158; train_optim_loss: 278102.8158; val_kl_reg_loss: 5735.7683; val_edge_recon_loss: 254043.9416; val_gene_expr_recon_loss: 17139.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276919.1383; val_optim_loss: 276919.1383

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9957; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 5722.6165; train_edge_recon_loss: 255086.2138; train_gene_expr_recon_loss: 17201.1958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 278010.0259; train_optim_loss: 278010.0259; val_kl_reg_loss: 5716.1850; val_edge_recon_loss: 253929.1378; val_gene_expr_recon_loss: 17123.2449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276768.5671; val_optim_loss: 276768.5671
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9960; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 5717.6156; train_edge_recon_loss: 255052.2157; train_gene_expr_recon_loss: 17188.5643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277958.3961; train_optim_loss: 277958.3961; val_kl_reg_loss: 5703.6937; val_edge_recon_loss: 253703.2290; val_gene_expr_recon_loss: 17112.6238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276519.5492; val_optim_loss: 276519.5492
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9955; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 5714.9863; train_edge_recon_loss: 255037.0008; train_gene_expr_recon_loss: 17180.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277932.1344; train_optim_loss: 277932.1344; val_kl_reg_loss: 5716.9671; val_edge_recon_loss: 253812.0328; val_gene_expr_recon_loss: 17120.9563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276649.9544; val_optim_loss: 276649.9544
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9970; val_auprc_score: 0.9953; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 5716.3678; train_edge_recon_loss: 254973.4858; train_gene_expr_recon_loss: 17192.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277882.4525; train_optim_loss: 277882.4525; val_kl_reg_loss: 5695.3386; val_edge_recon_loss: 254080.2626; val_gene_expr_recon_loss: 17111.5001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276887.1004; val_optim_loss: 276887.1004
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9971; val_auprc_score: 0.9958; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 5713.2797; train_edge_recon_loss: 254985.1993; train_gene_expr_recon_loss: 17189.4413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277887.9202; train_optim_loss: 277887.9202; val_kl_reg_loss: 5700.8849; val_edge_recon_loss: 253844.3245; val_gene_expr_recon_loss: 17133.0898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276678.2982; val_optim_loss: 276678.2982
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9956; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 5712.8771; train_edge_recon_loss: 255005.3732; train_gene_expr_recon_loss: 17185.2970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277903.5474; train_optim_loss: 277903.5474; val_kl_reg_loss: 5716.6419; val_edge_recon_loss: 253891.9062; val_gene_expr_recon_loss: 17140.9681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276749.5138; val_optim_loss: 276749.5138

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 5714.6302; train_edge_recon_loss: 254939.0415; train_gene_expr_recon_loss: 17178.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277831.9054; train_optim_loss: 277831.9054; val_kl_reg_loss: 5696.2855; val_edge_recon_loss: 253980.1696; val_gene_expr_recon_loss: 17122.6498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276799.1076; val_optim_loss: 276799.1076
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9972; val_auprc_score: 0.9959; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 5712.7865; train_edge_recon_loss: 254917.6990; train_gene_expr_recon_loss: 17174.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277804.9360; train_optim_loss: 277804.9360; val_kl_reg_loss: 5697.1246; val_edge_recon_loss: 253863.2287; val_gene_expr_recon_loss: 17098.4097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276658.7628; val_optim_loss: 276658.7628
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9974; val_auprc_score: 0.9961; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 5711.6008; train_edge_recon_loss: 254973.5708; train_gene_expr_recon_loss: 17177.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277862.3188; train_optim_loss: 277862.3188; val_kl_reg_loss: 5697.4789; val_edge_recon_loss: 253930.0105; val_gene_expr_recon_loss: 17141.3690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276768.8607; val_optim_loss: 276768.8607
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 5711.5715; train_edge_recon_loss: 254987.4004; train_gene_expr_recon_loss: 17169.7982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 277868.7701; train_optim_loss: 277868.7701; val_kl_reg_loss: 5698.1020; val_edge_recon_loss: 253813.5020; val_gene_expr_recon_loss: 17110.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 276621.8617; val_optim_loss: 276621.8617

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 208 min 3 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9972
val AUPRC score: 0.9957
val best accuracy score: 0.9877
val best F1 score: 0.9878
val target rna MSE score: 0.6088
val source rna MSE score: 0.0454

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
