None
Run timestamp: 28072023_133158_88.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_88']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9888; val_auprc_score: 0.9854; val_best_acc_score: 0.9589; val_best_f1_score: 0.9598; train_kl_reg_loss: 7358.7836; train_edge_recon_loss: 267926.7798; train_gene_expr_recon_loss: 209910.8975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 485196.4613; train_optim_loss: 485196.4613; val_kl_reg_loss: 7096.3799; val_edge_recon_loss: 260717.0357; val_gene_expr_recon_loss: 191041.2510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 458854.6676; val_optim_loss: 458854.6676
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 7078.2293; train_edge_recon_loss: 260592.9647; train_gene_expr_recon_loss: 186630.8380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 454302.0319; train_optim_loss: 454302.0319; val_kl_reg_loss: 6874.4586; val_edge_recon_loss: 259619.4973; val_gene_expr_recon_loss: 180502.0299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446995.9859; val_optim_loss: 446995.9859
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9931; val_auprc_score: 0.9911; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 6836.0757; train_edge_recon_loss: 259723.4466; train_gene_expr_recon_loss: 178925.0044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445484.5273; train_optim_loss: 445484.5273; val_kl_reg_loss: 6659.5108; val_edge_recon_loss: 258546.5104; val_gene_expr_recon_loss: 175529.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440735.9820; val_optim_loss: 440735.9820
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 6694.6635; train_edge_recon_loss: 258973.2197; train_gene_expr_recon_loss: 174836.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440504.3971; train_optim_loss: 440504.3971; val_kl_reg_loss: 6646.1282; val_edge_recon_loss: 258127.8396; val_gene_expr_recon_loss: 172197.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436971.6445; val_optim_loss: 436971.6445
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 6591.9346; train_edge_recon_loss: 258496.0866; train_gene_expr_recon_loss: 172325.2415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437413.2627; train_optim_loss: 437413.2627; val_kl_reg_loss: 6450.4458; val_edge_recon_loss: 257394.0045; val_gene_expr_recon_loss: 170331.5195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434175.9703; val_optim_loss: 434175.9703
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6523.5943; train_edge_recon_loss: 258182.8913; train_gene_expr_recon_loss: 170693.1046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435399.5904; train_optim_loss: 435399.5904; val_kl_reg_loss: 6491.1702; val_edge_recon_loss: 257327.7613; val_gene_expr_recon_loss: 168833.6789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432652.6094; val_optim_loss: 432652.6094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6489.2565; train_edge_recon_loss: 257761.7214; train_gene_expr_recon_loss: 169588.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433839.7532; train_optim_loss: 433839.7532; val_kl_reg_loss: 6431.7558; val_edge_recon_loss: 256682.1697; val_gene_expr_recon_loss: 168112.7305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431226.6570; val_optim_loss: 431226.6570
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 6455.7825; train_edge_recon_loss: 257614.5427; train_gene_expr_recon_loss: 168765.4304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432835.7562; train_optim_loss: 432835.7562; val_kl_reg_loss: 6309.7634; val_edge_recon_loss: 256682.6719; val_gene_expr_recon_loss: 167622.8691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 430615.3059; val_optim_loss: 430615.3059
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6440.8381; train_edge_recon_loss: 257369.2933; train_gene_expr_recon_loss: 168071.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431881.7297; train_optim_loss: 431881.7297; val_kl_reg_loss: 6417.4307; val_edge_recon_loss: 256580.1352; val_gene_expr_recon_loss: 166891.6590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 429889.2273; val_optim_loss: 429889.2273
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 6431.4324; train_edge_recon_loss: 257175.5194; train_gene_expr_recon_loss: 167633.3480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431240.2994; train_optim_loss: 431240.2994; val_kl_reg_loss: 6374.2020; val_edge_recon_loss: 256377.9520; val_gene_expr_recon_loss: 166695.3520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 429447.5066; val_optim_loss: 429447.5066
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 6429.5909; train_edge_recon_loss: 257043.3153; train_gene_expr_recon_loss: 167185.2805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430658.1868; train_optim_loss: 430658.1868; val_kl_reg_loss: 6316.7776; val_edge_recon_loss: 256122.0730; val_gene_expr_recon_loss: 166555.3213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428994.1723; val_optim_loss: 428994.1723
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 6430.5114; train_edge_recon_loss: 256883.6307; train_gene_expr_recon_loss: 167012.2661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430326.4086; train_optim_loss: 430326.4086; val_kl_reg_loss: 6375.7918; val_edge_recon_loss: 256275.3787; val_gene_expr_recon_loss: 166447.6096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 429098.7812; val_optim_loss: 429098.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 6431.0353; train_edge_recon_loss: 256762.2151; train_gene_expr_recon_loss: 166522.9748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429716.2247; train_optim_loss: 429716.2247; val_kl_reg_loss: 6416.7219; val_edge_recon_loss: 256099.3158; val_gene_expr_recon_loss: 166106.2521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428622.2926; val_optim_loss: 428622.2926
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6438.0133; train_edge_recon_loss: 256680.7237; train_gene_expr_recon_loss: 166327.6366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429446.3741; train_optim_loss: 429446.3741; val_kl_reg_loss: 6456.6268; val_edge_recon_loss: 255892.8434; val_gene_expr_recon_loss: 166008.8873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428358.3574; val_optim_loss: 428358.3574
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6441.1098; train_edge_recon_loss: 256635.9267; train_gene_expr_recon_loss: 166143.5838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 429220.6206; train_optim_loss: 429220.6206; val_kl_reg_loss: 6419.3638; val_edge_recon_loss: 255800.8648; val_gene_expr_recon_loss: 165783.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428003.6797; val_optim_loss: 428003.6797
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6450.1844; train_edge_recon_loss: 256509.5051; train_gene_expr_recon_loss: 166004.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428964.5609; train_optim_loss: 428964.5609; val_kl_reg_loss: 6394.7051; val_edge_recon_loss: 255643.9705; val_gene_expr_recon_loss: 166135.5211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428174.1980; val_optim_loss: 428174.1980
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6461.2601; train_edge_recon_loss: 256368.2386; train_gene_expr_recon_loss: 165828.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428658.1708; train_optim_loss: 428658.1708; val_kl_reg_loss: 6429.1139; val_edge_recon_loss: 255679.5387; val_gene_expr_recon_loss: 165983.6736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428092.3273; val_optim_loss: 428092.3273
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6468.5721; train_edge_recon_loss: 256428.7028; train_gene_expr_recon_loss: 165476.4269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428373.7024; train_optim_loss: 428373.7024; val_kl_reg_loss: 6425.4350; val_edge_recon_loss: 255733.0617; val_gene_expr_recon_loss: 166425.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428584.1586; val_optim_loss: 428584.1586
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6479.9851; train_edge_recon_loss: 256273.5749; train_gene_expr_recon_loss: 165396.2797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428149.8397; train_optim_loss: 428149.8397; val_kl_reg_loss: 6431.9679; val_edge_recon_loss: 255726.7977; val_gene_expr_recon_loss: 166022.3102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428181.0742; val_optim_loss: 428181.0742

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6502.5043; train_edge_recon_loss: 256199.3009; train_gene_expr_recon_loss: 164816.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427518.4739; train_optim_loss: 427518.4739; val_kl_reg_loss: 6476.7012; val_edge_recon_loss: 255647.7670; val_gene_expr_recon_loss: 165932.1539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428056.6227; val_optim_loss: 428056.6227
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6504.7541; train_edge_recon_loss: 256140.6781; train_gene_expr_recon_loss: 164723.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427368.8746; train_optim_loss: 427368.8746; val_kl_reg_loss: 6452.6158; val_edge_recon_loss: 255331.0707; val_gene_expr_recon_loss: 165682.2990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427465.9859; val_optim_loss: 427465.9859
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6502.6424; train_edge_recon_loss: 256128.7315; train_gene_expr_recon_loss: 164620.8934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427252.2663; train_optim_loss: 427252.2663; val_kl_reg_loss: 6475.7843; val_edge_recon_loss: 255395.2777; val_gene_expr_recon_loss: 165756.9604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427628.0180; val_optim_loss: 427628.0180
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6502.9667; train_edge_recon_loss: 256177.8241; train_gene_expr_recon_loss: 164578.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427259.2065; train_optim_loss: 427259.2065; val_kl_reg_loss: 6448.8136; val_edge_recon_loss: 255187.3439; val_gene_expr_recon_loss: 165565.0955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427201.2520; val_optim_loss: 427201.2520
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6506.0868; train_edge_recon_loss: 256076.6027; train_gene_expr_recon_loss: 164580.2322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427162.9219; train_optim_loss: 427162.9219; val_kl_reg_loss: 6495.3739; val_edge_recon_loss: 255462.3576; val_gene_expr_recon_loss: 165970.3254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427928.0590; val_optim_loss: 427928.0590
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6500.4721; train_edge_recon_loss: 256171.9534; train_gene_expr_recon_loss: 164499.1686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427171.5946; train_optim_loss: 427171.5946; val_kl_reg_loss: 6448.7123; val_edge_recon_loss: 255353.7121; val_gene_expr_recon_loss: 165717.2594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427519.6855; val_optim_loss: 427519.6855
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6504.9102; train_edge_recon_loss: 256108.5080; train_gene_expr_recon_loss: 164557.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427171.0731; train_optim_loss: 427171.0731; val_kl_reg_loss: 6452.4834; val_edge_recon_loss: 255306.9193; val_gene_expr_recon_loss: 165661.0752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427420.4797; val_optim_loss: 427420.4797
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6504.5393; train_edge_recon_loss: 256117.5093; train_gene_expr_recon_loss: 164552.5294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427174.5772; train_optim_loss: 427174.5772; val_kl_reg_loss: 6461.4720; val_edge_recon_loss: 255564.3912; val_gene_expr_recon_loss: 165708.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427733.9895; val_optim_loss: 427733.9895

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6504.3693; train_edge_recon_loss: 256079.0708; train_gene_expr_recon_loss: 164418.3426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427001.7829; train_optim_loss: 427001.7829; val_kl_reg_loss: 6469.7839; val_edge_recon_loss: 255406.0555; val_gene_expr_recon_loss: 166010.6256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427886.4691; val_optim_loss: 427886.4691
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6507.3834; train_edge_recon_loss: 256044.7349; train_gene_expr_recon_loss: 164525.0203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427077.1389; train_optim_loss: 427077.1389; val_kl_reg_loss: 6466.8908; val_edge_recon_loss: 255317.6557; val_gene_expr_recon_loss: 165587.9775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427372.5234; val_optim_loss: 427372.5234
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6506.6359; train_edge_recon_loss: 256059.4241; train_gene_expr_recon_loss: 164487.2574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427053.3169; train_optim_loss: 427053.3169; val_kl_reg_loss: 6468.0127; val_edge_recon_loss: 255244.3912; val_gene_expr_recon_loss: 165245.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 426957.4762; val_optim_loss: 426957.4762
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6507.8253; train_edge_recon_loss: 256046.6064; train_gene_expr_recon_loss: 164466.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427020.7839; train_optim_loss: 427020.7839; val_kl_reg_loss: 6474.3101; val_edge_recon_loss: 255365.4195; val_gene_expr_recon_loss: 165711.1020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427550.8301; val_optim_loss: 427550.8301
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 6510.0082; train_edge_recon_loss: 256084.7359; train_gene_expr_recon_loss: 164414.6789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427009.4229; train_optim_loss: 427009.4229; val_kl_reg_loss: 6469.7011; val_edge_recon_loss: 255473.9953; val_gene_expr_recon_loss: 165342.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427286.4355; val_optim_loss: 427286.4355
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6508.4912; train_edge_recon_loss: 256048.6570; train_gene_expr_recon_loss: 164416.4229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426973.5713; train_optim_loss: 426973.5713; val_kl_reg_loss: 6473.6587; val_edge_recon_loss: 255387.0186; val_gene_expr_recon_loss: 165860.6309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427721.3066; val_optim_loss: 427721.3066
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6508.6432; train_edge_recon_loss: 256014.4769; train_gene_expr_recon_loss: 164426.7608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426949.8808; train_optim_loss: 426949.8808; val_kl_reg_loss: 6467.7868; val_edge_recon_loss: 255291.7518; val_gene_expr_recon_loss: 165536.2145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427295.7551; val_optim_loss: 427295.7551

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9873; val_best_f1_score: 0.9875; train_kl_reg_loss: 6509.5563; train_edge_recon_loss: 256090.2904; train_gene_expr_recon_loss: 164324.8825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426924.7288; train_optim_loss: 426924.7288; val_kl_reg_loss: 6469.8357; val_edge_recon_loss: 255382.4836; val_gene_expr_recon_loss: 165345.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427197.6621; val_optim_loss: 427197.6621
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6509.3182; train_edge_recon_loss: 256101.0010; train_gene_expr_recon_loss: 164419.2510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 427029.5707; train_optim_loss: 427029.5707; val_kl_reg_loss: 6471.0778; val_edge_recon_loss: 255272.3508; val_gene_expr_recon_loss: 165529.1795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427272.6078; val_optim_loss: 427272.6078
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6509.4930; train_edge_recon_loss: 255992.7247; train_gene_expr_recon_loss: 164194.1132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426696.3308; train_optim_loss: 426696.3308; val_kl_reg_loss: 6470.7498; val_edge_recon_loss: 255260.1180; val_gene_expr_recon_loss: 165566.6451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427297.5102; val_optim_loss: 427297.5102
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6509.9459; train_edge_recon_loss: 256047.7709; train_gene_expr_recon_loss: 164441.2950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426999.0121; train_optim_loss: 426999.0121; val_kl_reg_loss: 6471.0140; val_edge_recon_loss: 255274.9125; val_gene_expr_recon_loss: 165724.3719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427470.2996; val_optim_loss: 427470.2996

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 274 min 8 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9979
val AUPRC score: 0.9974
val best accuracy score: 0.9875
val best F1 score: 0.9876
val target rna MSE score: 0.5711
val source rna MSE score: 0.0277

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
