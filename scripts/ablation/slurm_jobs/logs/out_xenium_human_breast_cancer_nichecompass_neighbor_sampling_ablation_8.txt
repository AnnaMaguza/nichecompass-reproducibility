None
Run timestamp: 19072023_130523_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9600; val_auprc_score: 0.9512; val_best_acc_score: 0.8998; val_best_f1_score: 0.9053; train_kl_reg_loss: 49491.4025; train_edge_recon_loss: 26865835.6091; train_gene_expr_recon_loss: 7521994.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34437321.4568; train_optim_loss: 34437321.4568; val_kl_reg_loss: 48292.2322; val_edge_recon_loss: 26524360.9074; val_gene_expr_recon_loss: 7036766.7731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33609420.0000; val_optim_loss: 33609420.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9795; val_auprc_score: 0.9761; val_best_acc_score: 0.9302; val_best_f1_score: 0.9323; train_kl_reg_loss: 42282.1928; train_edge_recon_loss: 26307387.2788; train_gene_expr_recon_loss: 6865154.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33214823.7531; train_optim_loss: 33214823.7531; val_kl_reg_loss: 36222.0514; val_edge_recon_loss: 26330463.4630; val_gene_expr_recon_loss: 6794062.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33160747.6574; val_optim_loss: 33160747.6574
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9840; val_auprc_score: 0.9810; val_best_acc_score: 0.9417; val_best_f1_score: 0.9430; train_kl_reg_loss: 35517.6173; train_edge_recon_loss: 26122694.6759; train_gene_expr_recon_loss: 6727850.0252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32886062.2891; train_optim_loss: 32886062.2891; val_kl_reg_loss: 35284.0029; val_edge_recon_loss: 26217360.3056; val_gene_expr_recon_loss: 6710909.1065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32963553.4259; val_optim_loss: 32963553.4259
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9829; val_best_acc_score: 0.9461; val_best_f1_score: 0.9472; train_kl_reg_loss: 33691.3737; train_edge_recon_loss: 26050326.0144; train_gene_expr_recon_loss: 6664540.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32748558.3519; train_optim_loss: 32748558.3519; val_kl_reg_loss: 32324.6146; val_edge_recon_loss: 26153997.8889; val_gene_expr_recon_loss: 6669523.5671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32855846.1111; val_optim_loss: 32855846.1111
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9872; val_auprc_score: 0.9846; val_best_acc_score: 0.9492; val_best_f1_score: 0.9503; train_kl_reg_loss: 32366.7021; train_edge_recon_loss: 26015608.1379; train_gene_expr_recon_loss: 6631199.4344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32679174.2819; train_optim_loss: 32679174.2819; val_kl_reg_loss: 31040.0533; val_edge_recon_loss: 26126043.6852; val_gene_expr_recon_loss: 6652811.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32809895.0370; val_optim_loss: 32809895.0370
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9877; val_auprc_score: 0.9852; val_best_acc_score: 0.9513; val_best_f1_score: 0.9522; train_kl_reg_loss: 30992.4925; train_edge_recon_loss: 25979710.7006; train_gene_expr_recon_loss: 6605811.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32616514.7305; train_optim_loss: 32616514.7305; val_kl_reg_loss: 30249.6895; val_edge_recon_loss: 26072537.0741; val_gene_expr_recon_loss: 6635737.6181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32738524.4630; val_optim_loss: 32738524.4630
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9886; val_auprc_score: 0.9861; val_best_acc_score: 0.9540; val_best_f1_score: 0.9549; train_kl_reg_loss: 29799.1988; train_edge_recon_loss: 25947815.4681; train_gene_expr_recon_loss: 6590746.9550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32568361.6451; train_optim_loss: 32568361.6451; val_kl_reg_loss: 29141.9089; val_edge_recon_loss: 26053865.8981; val_gene_expr_recon_loss: 6639736.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32722744.0741; val_optim_loss: 32722744.0741
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9896; val_auprc_score: 0.9874; val_best_acc_score: 0.9566; val_best_f1_score: 0.9574; train_kl_reg_loss: 28881.5279; train_edge_recon_loss: 25921611.3549; train_gene_expr_recon_loss: 6582038.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32532531.4434; train_optim_loss: 32532531.4434; val_kl_reg_loss: 28434.2211; val_edge_recon_loss: 26049835.4444; val_gene_expr_recon_loss: 6618522.2824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32696791.8426; val_optim_loss: 32696791.8426
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9896; val_auprc_score: 0.9873; val_best_acc_score: 0.9577; val_best_f1_score: 0.9586; train_kl_reg_loss: 28880.4449; train_edge_recon_loss: 25903364.1420; train_gene_expr_recon_loss: 6568500.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32500745.4434; train_optim_loss: 32500745.4434; val_kl_reg_loss: 28438.3750; val_edge_recon_loss: 26009865.0926; val_gene_expr_recon_loss: 6607327.9861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32645631.4444; val_optim_loss: 32645631.4444
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9900; val_auprc_score: 0.9876; val_best_acc_score: 0.9587; val_best_f1_score: 0.9595; train_kl_reg_loss: 28366.4387; train_edge_recon_loss: 25893215.9290; train_gene_expr_recon_loss: 6562415.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32483997.3683; train_optim_loss: 32483997.3683; val_kl_reg_loss: 27915.7454; val_edge_recon_loss: 25986952.9722; val_gene_expr_recon_loss: 6597395.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32612264.7037; val_optim_loss: 32612264.7037
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9903; val_auprc_score: 0.9881; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 28443.9480; train_edge_recon_loss: 25863405.2346; train_gene_expr_recon_loss: 6549753.8269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32441602.9815; train_optim_loss: 32441602.9815; val_kl_reg_loss: 27560.8639; val_edge_recon_loss: 25987257.1667; val_gene_expr_recon_loss: 6591603.3657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32606421.4815; val_optim_loss: 32606421.4815
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9906; val_auprc_score: 0.9884; val_best_acc_score: 0.9612; val_best_f1_score: 0.9618; train_kl_reg_loss: 27754.6369; train_edge_recon_loss: 25860048.8004; train_gene_expr_recon_loss: 6544913.8688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32432717.2922; train_optim_loss: 32432717.2922; val_kl_reg_loss: 27179.8347; val_edge_recon_loss: 25995157.8333; val_gene_expr_recon_loss: 6584487.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32606825.1667; val_optim_loss: 32606825.1667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 27703.1137; train_edge_recon_loss: 25848609.4866; train_gene_expr_recon_loss: 6537664.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32413976.8673; train_optim_loss: 32413976.8673; val_kl_reg_loss: 27603.2835; val_edge_recon_loss: 25967621.3056; val_gene_expr_recon_loss: 6580963.4491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32576188.0278; val_optim_loss: 32576188.0278
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9910; val_auprc_score: 0.9888; val_best_acc_score: 0.9624; val_best_f1_score: 0.9630; train_kl_reg_loss: 27410.5534; train_edge_recon_loss: 25839923.2438; train_gene_expr_recon_loss: 6532439.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32399773.5021; train_optim_loss: 32399773.5021; val_kl_reg_loss: 26959.9614; val_edge_recon_loss: 25969660.3241; val_gene_expr_recon_loss: 6582802.2685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32579422.5556; val_optim_loss: 32579422.5556
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 27296.9042; train_edge_recon_loss: 25831023.7171; train_gene_expr_recon_loss: 6531305.4064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32389626.0566; train_optim_loss: 32389626.0566; val_kl_reg_loss: 26626.1780; val_edge_recon_loss: 25942810.6852; val_gene_expr_recon_loss: 6580344.1528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32549781.0648; val_optim_loss: 32549781.0648
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9909; val_auprc_score: 0.9885; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 27144.1452; train_edge_recon_loss: 25829398.1214; train_gene_expr_recon_loss: 6525637.4666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32382179.7407; train_optim_loss: 32382179.7407; val_kl_reg_loss: 26444.9116; val_edge_recon_loss: 25928085.9352; val_gene_expr_recon_loss: 6581098.6829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32535629.5648; val_optim_loss: 32535629.5648
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9893; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 26919.9041; train_edge_recon_loss: 25812726.9918; train_gene_expr_recon_loss: 6522361.0033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32362007.8848; train_optim_loss: 32362007.8848; val_kl_reg_loss: 26128.3328; val_edge_recon_loss: 25924156.3056; val_gene_expr_recon_loss: 6570206.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32520490.7037; val_optim_loss: 32520490.7037
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9920; val_auprc_score: 0.9901; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 26527.1893; train_edge_recon_loss: 25811952.7068; train_gene_expr_recon_loss: 6519959.9969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32358439.9033; train_optim_loss: 32358439.9033; val_kl_reg_loss: 25549.4371; val_edge_recon_loss: 25931464.6204; val_gene_expr_recon_loss: 6566598.1528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32523612.2685; val_optim_loss: 32523612.2685
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9916; val_auprc_score: 0.9892; val_best_acc_score: 0.9652; val_best_f1_score: 0.9658; train_kl_reg_loss: 26470.2189; train_edge_recon_loss: 25809917.7654; train_gene_expr_recon_loss: 6519357.2338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32355745.2356; train_optim_loss: 32355745.2356; val_kl_reg_loss: 25788.8957; val_edge_recon_loss: 25906611.2315; val_gene_expr_recon_loss: 6565328.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32497728.4259; val_optim_loss: 32497728.4259
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9916; val_auprc_score: 0.9895; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 26398.7305; train_edge_recon_loss: 25803131.1420; train_gene_expr_recon_loss: 6513085.7428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32342615.6060; train_optim_loss: 32342615.6060; val_kl_reg_loss: 26219.5224; val_edge_recon_loss: 25932179.9444; val_gene_expr_recon_loss: 6564475.2199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32522874.7130; val_optim_loss: 32522874.7130
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9897; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 26264.8225; train_edge_recon_loss: 25794929.2582; train_gene_expr_recon_loss: 6513016.7420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32334210.8488; train_optim_loss: 32334210.8488; val_kl_reg_loss: 25817.8820; val_edge_recon_loss: 25910882.4630; val_gene_expr_recon_loss: 6564907.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32501607.7963; val_optim_loss: 32501607.7963
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9916; val_auprc_score: 0.9892; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 26126.7588; train_edge_recon_loss: 25794672.9630; train_gene_expr_recon_loss: 6508513.3678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32329313.0772; train_optim_loss: 32329313.0772; val_kl_reg_loss: 26602.4450; val_edge_recon_loss: 25903311.3426; val_gene_expr_recon_loss: 6571425.8472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32501339.6296; val_optim_loss: 32501339.6296
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9919; val_auprc_score: 0.9899; val_best_acc_score: 0.9659; val_best_f1_score: 0.9664; train_kl_reg_loss: 26146.3962; train_edge_recon_loss: 25787215.5021; train_gene_expr_recon_loss: 6505990.7585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32319352.6842; train_optim_loss: 32319352.6842; val_kl_reg_loss: 25846.7824; val_edge_recon_loss: 25896056.2593; val_gene_expr_recon_loss: 6559218.5486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32481121.6111; val_optim_loss: 32481121.6111
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9923; val_auprc_score: 0.9902; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 25855.8202; train_edge_recon_loss: 25789143.1646; train_gene_expr_recon_loss: 6505140.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32320139.5823; train_optim_loss: 32320139.5823; val_kl_reg_loss: 25219.3638; val_edge_recon_loss: 25909089.6389; val_gene_expr_recon_loss: 6564975.5787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32499284.5833; val_optim_loss: 32499284.5833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 25699.5135; train_edge_recon_loss: 25780436.0082; train_gene_expr_recon_loss: 6503904.8058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32310040.3426; train_optim_loss: 32310040.3426; val_kl_reg_loss: 26079.2951; val_edge_recon_loss: 25888634.6481; val_gene_expr_recon_loss: 6564373.3819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32479087.2407; val_optim_loss: 32479087.2407
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9931; val_auprc_score: 0.9911; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 25577.8294; train_edge_recon_loss: 25780045.3076; train_gene_expr_recon_loss: 6504009.9547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32309633.0545; train_optim_loss: 32309633.0545; val_kl_reg_loss: 24309.0452; val_edge_recon_loss: 25847537.2963; val_gene_expr_recon_loss: 6552717.1343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32424563.5000; val_optim_loss: 32424563.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 25576.8191; train_edge_recon_loss: 25775252.5586; train_gene_expr_recon_loss: 6502154.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32302983.4516; train_optim_loss: 32302983.4516; val_kl_reg_loss: 25220.2309; val_edge_recon_loss: 25863962.3981; val_gene_expr_recon_loss: 6563105.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32452288.4167; val_optim_loss: 32452288.4167
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 25612.5103; train_edge_recon_loss: 25771391.8457; train_gene_expr_recon_loss: 6501421.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32298425.7840; train_optim_loss: 32298425.7840; val_kl_reg_loss: 25627.8121; val_edge_recon_loss: 25865688.6944; val_gene_expr_recon_loss: 6560837.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32452153.7037; val_optim_loss: 32452153.7037
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9926; val_auprc_score: 0.9908; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 25532.8739; train_edge_recon_loss: 25770218.8148; train_gene_expr_recon_loss: 6499560.5206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32295312.1862; train_optim_loss: 32295312.1862; val_kl_reg_loss: 24977.6292; val_edge_recon_loss: 25869467.9444; val_gene_expr_recon_loss: 6563075.4213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32457520.9352; val_optim_loss: 32457520.9352
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9901; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 25424.7641; train_edge_recon_loss: 25762158.0484; train_gene_expr_recon_loss: 6498167.2184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32285750.0237; train_optim_loss: 32285750.0237; val_kl_reg_loss: 24455.3482; val_edge_recon_loss: 25865398.6111; val_gene_expr_recon_loss: 6572089.2384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32461943.1667; val_optim_loss: 32461943.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 27028.1009; train_edge_recon_loss: 25752893.3056; train_gene_expr_recon_loss: 6443319.4681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32223240.8580; train_optim_loss: 32223240.8580; val_kl_reg_loss: 27629.6200; val_edge_recon_loss: 25847848.8056; val_gene_expr_recon_loss: 6502906.8449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32378385.1944; val_optim_loss: 32378385.1944
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9929; val_auprc_score: 0.9908; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 28031.9246; train_edge_recon_loss: 25744620.2891; train_gene_expr_recon_loss: 6436385.4925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32209037.7181; train_optim_loss: 32209037.7181; val_kl_reg_loss: 27973.2186; val_edge_recon_loss: 25855257.9815; val_gene_expr_recon_loss: 6511804.9190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32395036.0926; val_optim_loss: 32395036.0926
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 28428.0199; train_edge_recon_loss: 25740644.1790; train_gene_expr_recon_loss: 6436099.9396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32205172.1523; train_optim_loss: 32205172.1523; val_kl_reg_loss: 28007.7421; val_edge_recon_loss: 25853831.5093; val_gene_expr_recon_loss: 6507459.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32389298.6759; val_optim_loss: 32389298.6759
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 28484.7995; train_edge_recon_loss: 25736091.2881; train_gene_expr_recon_loss: 6431087.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32195663.6975; train_optim_loss: 32195663.6975; val_kl_reg_loss: 28014.6676; val_edge_recon_loss: 25843505.1204; val_gene_expr_recon_loss: 6491604.3287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32363124.1667; val_optim_loss: 32363124.1667
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 28601.4788; train_edge_recon_loss: 25732798.4239; train_gene_expr_recon_loss: 6433276.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32194676.2798; train_optim_loss: 32194676.2798; val_kl_reg_loss: 28275.6259; val_edge_recon_loss: 25817102.5463; val_gene_expr_recon_loss: 6501151.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32346529.8056; val_optim_loss: 32346529.8056
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 28672.2803; train_edge_recon_loss: 25738183.3909; train_gene_expr_recon_loss: 6431389.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32198245.4393; train_optim_loss: 32198245.4393; val_kl_reg_loss: 28343.4725; val_edge_recon_loss: 25846486.0185; val_gene_expr_recon_loss: 6499680.6852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32374510.2315; val_optim_loss: 32374510.2315
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9931; val_auprc_score: 0.9910; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 28870.6866; train_edge_recon_loss: 25743239.2685; train_gene_expr_recon_loss: 6432331.2680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32204441.2140; train_optim_loss: 32204441.2140; val_kl_reg_loss: 28544.3254; val_edge_recon_loss: 25851843.5370; val_gene_expr_recon_loss: 6500035.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32380423.7315; val_optim_loss: 32380423.7315
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9697; val_best_f1_score: 0.9701; train_kl_reg_loss: 28740.3054; train_edge_recon_loss: 25739616.7243; train_gene_expr_recon_loss: 6430710.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32199067.8292; train_optim_loss: 32199067.8292; val_kl_reg_loss: 28367.4470; val_edge_recon_loss: 25854924.4907; val_gene_expr_recon_loss: 6500692.5139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32383984.3981; val_optim_loss: 32383984.3981
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 28738.6524; train_edge_recon_loss: 25742275.7912; train_gene_expr_recon_loss: 6430486.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32201500.8076; train_optim_loss: 32201500.8076; val_kl_reg_loss: 28430.4491; val_edge_recon_loss: 25862828.0833; val_gene_expr_recon_loss: 6497137.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388395.6944; val_optim_loss: 32388395.6944

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 28919.6014; train_edge_recon_loss: 25734804.6893; train_gene_expr_recon_loss: 6422895.0592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32186619.3580; train_optim_loss: 32186619.3580; val_kl_reg_loss: 28535.1231; val_edge_recon_loss: 25818963.7870; val_gene_expr_recon_loss: 6492706.3310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32340205.2037; val_optim_loss: 32340205.2037
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 28954.0574; train_edge_recon_loss: 25731675.8097; train_gene_expr_recon_loss: 6420811.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32181441.4434; train_optim_loss: 32181441.4434; val_kl_reg_loss: 28565.8924; val_edge_recon_loss: 25823565.9722; val_gene_expr_recon_loss: 6495953.5972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32348085.4259; val_optim_loss: 32348085.4259
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 28977.7954; train_edge_recon_loss: 25740104.4424; train_gene_expr_recon_loss: 6419799.9920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32188882.2346; train_optim_loss: 32188882.2346; val_kl_reg_loss: 28639.4708; val_edge_recon_loss: 25852377.7593; val_gene_expr_recon_loss: 6498380.4954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32379397.7407; val_optim_loss: 32379397.7407
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9934; val_auprc_score: 0.9916; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 29013.8730; train_edge_recon_loss: 25739886.5885; train_gene_expr_recon_loss: 6420917.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32189818.0844; train_optim_loss: 32189818.0844; val_kl_reg_loss: 28638.0499; val_edge_recon_loss: 25833635.7593; val_gene_expr_recon_loss: 6499108.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32361381.7222; val_optim_loss: 32361381.7222
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 29026.5314; train_edge_recon_loss: 25738991.7706; train_gene_expr_recon_loss: 6420157.2418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32188175.5463; train_optim_loss: 32188175.5463; val_kl_reg_loss: 28640.7961; val_edge_recon_loss: 25833711.1481; val_gene_expr_recon_loss: 6485404.4537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32347756.4259; val_optim_loss: 32347756.4259

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 29019.7854; train_edge_recon_loss: 25734655.0113; train_gene_expr_recon_loss: 6419991.5453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32183666.3570; train_optim_loss: 32183666.3570; val_kl_reg_loss: 28623.2141; val_edge_recon_loss: 25821969.1574; val_gene_expr_recon_loss: 6489949.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32340541.5185; val_optim_loss: 32340541.5185
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9935; val_auprc_score: 0.9917; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 29011.3859; train_edge_recon_loss: 25728690.6060; train_gene_expr_recon_loss: 6421451.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32179153.7387; train_optim_loss: 32179153.7387; val_kl_reg_loss: 28615.4431; val_edge_recon_loss: 25833933.0000; val_gene_expr_recon_loss: 6488658.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32351206.5648; val_optim_loss: 32351206.5648
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 29015.9227; train_edge_recon_loss: 25736125.0936; train_gene_expr_recon_loss: 6418452.7191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32183593.7479; train_optim_loss: 32183593.7479; val_kl_reg_loss: 28654.2446; val_edge_recon_loss: 25844549.7870; val_gene_expr_recon_loss: 6493710.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32366914.8148; val_optim_loss: 32366914.8148
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 29042.6223; train_edge_recon_loss: 25736014.2613; train_gene_expr_recon_loss: 6419478.8097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32184535.6461; train_optim_loss: 32184535.6461; val_kl_reg_loss: 28618.4190; val_edge_recon_loss: 25832964.9907; val_gene_expr_recon_loss: 6494320.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32355903.5000; val_optim_loss: 32355903.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 537 min 13 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9934
Val AUPRC score: 0.9917
Val best accuracy score: 0.9700
Val best F1 score: 0.9705
Val gene expr MSE score: 1.6211

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
