None
Run timestamp: 01082023_132523_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9881; val_auprc_score: 0.9862; val_best_acc_score: 0.9497; val_best_f1_score: 0.9505; train_kl_reg_loss: 6054.9251; train_edge_recon_loss: 264676.4043; train_gene_expr_recon_loss: 116234.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 386965.6249; train_optim_loss: 386965.6249; val_kl_reg_loss: 5757.6629; val_edge_recon_loss: 262649.3289; val_gene_expr_recon_loss: 109179.8591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377586.8516; val_optim_loss: 377586.8516
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9901; val_auprc_score: 0.9882; val_best_acc_score: 0.9565; val_best_f1_score: 0.9572; train_kl_reg_loss: 5928.4951; train_edge_recon_loss: 261368.9624; train_gene_expr_recon_loss: 108408.2982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375705.7557; train_optim_loss: 375705.7557; val_kl_reg_loss: 5917.9249; val_edge_recon_loss: 262045.2297; val_gene_expr_recon_loss: 107833.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375796.4703; val_optim_loss: 375796.4703
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9581; val_best_f1_score: 0.9588; train_kl_reg_loss: 5921.3994; train_edge_recon_loss: 260724.1658; train_gene_expr_recon_loss: 107736.4963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374382.0612; train_optim_loss: 374382.0612; val_kl_reg_loss: 5690.6938; val_edge_recon_loss: 261564.4800; val_gene_expr_recon_loss: 107670.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374925.5012; val_optim_loss: 374925.5012
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9916; val_auprc_score: 0.9900; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 5923.4238; train_edge_recon_loss: 260362.1000; train_gene_expr_recon_loss: 107437.1936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373722.7174; train_optim_loss: 373722.7174; val_kl_reg_loss: 5904.8657; val_edge_recon_loss: 260638.8435; val_gene_expr_recon_loss: 107340.8888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373884.5976; val_optim_loss: 373884.5976
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9921; val_auprc_score: 0.9906; val_best_acc_score: 0.9623; val_best_f1_score: 0.9629; train_kl_reg_loss: 5929.7255; train_edge_recon_loss: 260015.7370; train_gene_expr_recon_loss: 107276.1962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373221.6586; train_optim_loss: 373221.6586; val_kl_reg_loss: 5901.0708; val_edge_recon_loss: 260624.9019; val_gene_expr_recon_loss: 107069.2654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373595.2379; val_optim_loss: 373595.2379
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9635; val_best_f1_score: 0.9639; train_kl_reg_loss: 5928.4184; train_edge_recon_loss: 259893.9358; train_gene_expr_recon_loss: 107167.0074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372989.3614; train_optim_loss: 372989.3614; val_kl_reg_loss: 5841.6183; val_edge_recon_loss: 260384.0596; val_gene_expr_recon_loss: 107260.4446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373486.1220; val_optim_loss: 373486.1220
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9924; val_auprc_score: 0.9910; val_best_acc_score: 0.9638; val_best_f1_score: 0.9643; train_kl_reg_loss: 5930.8436; train_edge_recon_loss: 259731.7421; train_gene_expr_recon_loss: 107115.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372777.8683; train_optim_loss: 372777.8683; val_kl_reg_loss: 5886.1108; val_edge_recon_loss: 260372.7312; val_gene_expr_recon_loss: 107053.8978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373312.7395; val_optim_loss: 373312.7395
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9926; val_auprc_score: 0.9910; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 5940.8800; train_edge_recon_loss: 259502.3417; train_gene_expr_recon_loss: 107104.0044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372547.2261; train_optim_loss: 372547.2261; val_kl_reg_loss: 6007.7133; val_edge_recon_loss: 259940.7331; val_gene_expr_recon_loss: 107009.8615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372958.3081; val_optim_loss: 372958.3081
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9931; val_auprc_score: 0.9917; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 5941.1955; train_edge_recon_loss: 259417.8514; train_gene_expr_recon_loss: 107035.1483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372394.1954; train_optim_loss: 372394.1954; val_kl_reg_loss: 5928.2392; val_edge_recon_loss: 259818.9231; val_gene_expr_recon_loss: 106937.1528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372684.3155; val_optim_loss: 372684.3155
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9660; val_best_f1_score: 0.9664; train_kl_reg_loss: 5942.5138; train_edge_recon_loss: 259360.4873; train_gene_expr_recon_loss: 107036.2323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372339.2334; train_optim_loss: 372339.2334; val_kl_reg_loss: 5905.1611; val_edge_recon_loss: 259898.3031; val_gene_expr_recon_loss: 106990.3950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372793.8592; val_optim_loss: 372793.8592
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9912; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 5949.5501; train_edge_recon_loss: 259321.5114; train_gene_expr_recon_loss: 106918.1638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372189.2253; train_optim_loss: 372189.2253; val_kl_reg_loss: 5963.0333; val_edge_recon_loss: 259736.5153; val_gene_expr_recon_loss: 107132.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372832.4465; val_optim_loss: 372832.4465
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9928; val_auprc_score: 0.9911; val_best_acc_score: 0.9663; val_best_f1_score: 0.9667; train_kl_reg_loss: 5950.1869; train_edge_recon_loss: 259244.9007; train_gene_expr_recon_loss: 106999.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372194.4991; train_optim_loss: 372194.4991; val_kl_reg_loss: 5913.0161; val_edge_recon_loss: 259884.3035; val_gene_expr_recon_loss: 107157.8425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372955.1620; val_optim_loss: 372955.1620
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9916; val_best_acc_score: 0.9672; val_best_f1_score: 0.9676; train_kl_reg_loss: 5954.3432; train_edge_recon_loss: 259189.7119; train_gene_expr_recon_loss: 106925.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372069.8583; train_optim_loss: 372069.8583; val_kl_reg_loss: 5943.5667; val_edge_recon_loss: 259364.0264; val_gene_expr_recon_loss: 106932.3268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372239.9193; val_optim_loss: 372239.9193
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9917; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 5960.6701; train_edge_recon_loss: 259061.7854; train_gene_expr_recon_loss: 106949.6169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371972.0722; train_optim_loss: 371972.0722; val_kl_reg_loss: 5959.9964; val_edge_recon_loss: 259564.4076; val_gene_expr_recon_loss: 106949.9283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372474.3326; val_optim_loss: 372474.3326
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9686; val_best_f1_score: 0.9690; train_kl_reg_loss: 5963.3719; train_edge_recon_loss: 259004.5118; train_gene_expr_recon_loss: 106932.1355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371900.0191; train_optim_loss: 371900.0191; val_kl_reg_loss: 5909.5301; val_edge_recon_loss: 259341.2062; val_gene_expr_recon_loss: 107125.0726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372375.8091; val_optim_loss: 372375.8091
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 5960.7056; train_edge_recon_loss: 258987.4472; train_gene_expr_recon_loss: 106911.5111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371859.6638; train_optim_loss: 371859.6638; val_kl_reg_loss: 5964.5352; val_edge_recon_loss: 259207.7351; val_gene_expr_recon_loss: 106880.0388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372052.3089; val_optim_loss: 372052.3089
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9934; val_auprc_score: 0.9918; val_best_acc_score: 0.9683; val_best_f1_score: 0.9687; train_kl_reg_loss: 5964.1219; train_edge_recon_loss: 258945.8348; train_gene_expr_recon_loss: 106893.1678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371803.1247; train_optim_loss: 371803.1247; val_kl_reg_loss: 5950.4999; val_edge_recon_loss: 259262.5632; val_gene_expr_recon_loss: 106866.3051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372079.3682; val_optim_loss: 372079.3682
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 5965.4528; train_edge_recon_loss: 258905.7783; train_gene_expr_recon_loss: 106948.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371819.6490; train_optim_loss: 371819.6490; val_kl_reg_loss: 5928.7798; val_edge_recon_loss: 259238.7731; val_gene_expr_recon_loss: 107283.5070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372451.0596; val_optim_loss: 372451.0596
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 5967.3750; train_edge_recon_loss: 258879.1795; train_gene_expr_recon_loss: 106938.6709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371785.2255; train_optim_loss: 371785.2255; val_kl_reg_loss: 5956.9438; val_edge_recon_loss: 259448.9982; val_gene_expr_recon_loss: 107066.0256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372471.9670; val_optim_loss: 372471.9670
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 5969.1431; train_edge_recon_loss: 258865.4919; train_gene_expr_recon_loss: 106890.1684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371724.8031; train_optim_loss: 371724.8031; val_kl_reg_loss: 5977.6824; val_edge_recon_loss: 259129.6922; val_gene_expr_recon_loss: 106946.6587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372054.0329; val_optim_loss: 372054.0329

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 5982.2371; train_edge_recon_loss: 258454.3896; train_gene_expr_recon_loss: 106066.0605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370502.6872; train_optim_loss: 370502.6872; val_kl_reg_loss: 5974.7820; val_edge_recon_loss: 258806.9932; val_gene_expr_recon_loss: 106014.6352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370796.4103; val_optim_loss: 370796.4103
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9943; val_auprc_score: 0.9931; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 5975.9312; train_edge_recon_loss: 258400.9276; train_gene_expr_recon_loss: 105953.5913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370330.4500; train_optim_loss: 370330.4500; val_kl_reg_loss: 5957.6285; val_edge_recon_loss: 258720.4553; val_gene_expr_recon_loss: 106051.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370729.7964; val_optim_loss: 370729.7964
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9942; val_auprc_score: 0.9929; val_best_acc_score: 0.9713; val_best_f1_score: 0.9716; train_kl_reg_loss: 5975.5542; train_edge_recon_loss: 258325.4171; train_gene_expr_recon_loss: 105909.2763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370210.2475; train_optim_loss: 370210.2475; val_kl_reg_loss: 5964.9390; val_edge_recon_loss: 258850.3093; val_gene_expr_recon_loss: 105922.9405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370738.1882; val_optim_loss: 370738.1882
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 5969.0828; train_edge_recon_loss: 258422.0843; train_gene_expr_recon_loss: 105838.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370229.8019; train_optim_loss: 370229.8019; val_kl_reg_loss: 5952.4168; val_edge_recon_loss: 258756.0919; val_gene_expr_recon_loss: 105997.1202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370705.6285; val_optim_loss: 370705.6285
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 5969.3708; train_edge_recon_loss: 258340.4051; train_gene_expr_recon_loss: 105804.2575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370114.0332; train_optim_loss: 370114.0332; val_kl_reg_loss: 5965.4924; val_edge_recon_loss: 258650.8085; val_gene_expr_recon_loss: 105939.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370555.5109; val_optim_loss: 370555.5109
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9724; val_best_f1_score: 0.9728; train_kl_reg_loss: 5968.2881; train_edge_recon_loss: 258342.5915; train_gene_expr_recon_loss: 105838.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370149.7639; train_optim_loss: 370149.7639; val_kl_reg_loss: 5954.0353; val_edge_recon_loss: 258682.7452; val_gene_expr_recon_loss: 106065.3660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370702.1467; val_optim_loss: 370702.1467
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9944; val_auprc_score: 0.9931; val_best_acc_score: 0.9718; val_best_f1_score: 0.9721; train_kl_reg_loss: 5968.2458; train_edge_recon_loss: 258275.3190; train_gene_expr_recon_loss: 105822.8192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370066.3840; train_optim_loss: 370066.3840; val_kl_reg_loss: 5957.7113; val_edge_recon_loss: 258643.8879; val_gene_expr_recon_loss: 105933.7508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370535.3503; val_optim_loss: 370535.3503
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 5964.0477; train_edge_recon_loss: 258258.7402; train_gene_expr_recon_loss: 105767.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369990.6158; train_optim_loss: 369990.6158; val_kl_reg_loss: 5961.4074; val_edge_recon_loss: 258540.6246; val_gene_expr_recon_loss: 105924.3049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370426.3367; val_optim_loss: 370426.3367
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9721; val_best_f1_score: 0.9724; train_kl_reg_loss: 5964.6001; train_edge_recon_loss: 258259.2756; train_gene_expr_recon_loss: 105781.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370004.9251; train_optim_loss: 370004.9251; val_kl_reg_loss: 5950.0009; val_edge_recon_loss: 258501.3553; val_gene_expr_recon_loss: 106008.2833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370459.6402; val_optim_loss: 370459.6402
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9945; val_auprc_score: 0.9933; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 5961.6861; train_edge_recon_loss: 258297.8799; train_gene_expr_recon_loss: 105758.5101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370018.0764; train_optim_loss: 370018.0764; val_kl_reg_loss: 5955.0492; val_edge_recon_loss: 258667.1466; val_gene_expr_recon_loss: 105898.5539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370520.7497; val_optim_loss: 370520.7497
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 5965.2119; train_edge_recon_loss: 258258.2831; train_gene_expr_recon_loss: 105741.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369965.0242; train_optim_loss: 369965.0242; val_kl_reg_loss: 5974.7652; val_edge_recon_loss: 258536.4750; val_gene_expr_recon_loss: 105810.1069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370321.3469; val_optim_loss: 370321.3469
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9725; val_best_f1_score: 0.9728; train_kl_reg_loss: 5964.4917; train_edge_recon_loss: 258180.1356; train_gene_expr_recon_loss: 105721.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369866.4137; train_optim_loss: 369866.4137; val_kl_reg_loss: 5948.4393; val_edge_recon_loss: 258461.8658; val_gene_expr_recon_loss: 105902.0126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370312.3170; val_optim_loss: 370312.3170
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9727; val_best_f1_score: 0.9730; train_kl_reg_loss: 5964.9368; train_edge_recon_loss: 258198.3379; train_gene_expr_recon_loss: 105706.4824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369869.7572; train_optim_loss: 369869.7572; val_kl_reg_loss: 5951.4430; val_edge_recon_loss: 258639.6244; val_gene_expr_recon_loss: 105899.6648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370490.7319; val_optim_loss: 370490.7319
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 5964.9806; train_edge_recon_loss: 258169.4986; train_gene_expr_recon_loss: 105692.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369826.6346; train_optim_loss: 369826.6346; val_kl_reg_loss: 5959.0083; val_edge_recon_loss: 258151.3373; val_gene_expr_recon_loss: 105836.4556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369946.8010; val_optim_loss: 369946.8010
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9723; val_best_f1_score: 0.9726; train_kl_reg_loss: 5961.7566; train_edge_recon_loss: 258248.2611; train_gene_expr_recon_loss: 105717.9761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369927.9940; train_optim_loss: 369927.9940; val_kl_reg_loss: 5949.2315; val_edge_recon_loss: 258665.2057; val_gene_expr_recon_loss: 105868.8817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370483.3189; val_optim_loss: 370483.3189
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 5965.9066; train_edge_recon_loss: 258178.6270; train_gene_expr_recon_loss: 105726.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369871.1705; train_optim_loss: 369871.1705; val_kl_reg_loss: 5961.1759; val_edge_recon_loss: 258658.9808; val_gene_expr_recon_loss: 105840.5295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370460.6868; val_optim_loss: 370460.6868
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9944; val_auprc_score: 0.9930; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 5962.2844; train_edge_recon_loss: 258195.3732; train_gene_expr_recon_loss: 105709.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369867.0700; train_optim_loss: 369867.0700; val_kl_reg_loss: 5948.5371; val_edge_recon_loss: 258611.6680; val_gene_expr_recon_loss: 105879.8408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370440.0464; val_optim_loss: 370440.0464
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5963.0760; train_edge_recon_loss: 258168.4734; train_gene_expr_recon_loss: 105675.0210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369806.5704; train_optim_loss: 369806.5704; val_kl_reg_loss: 5964.4073; val_edge_recon_loss: 258367.1903; val_gene_expr_recon_loss: 105868.6026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370200.2003; val_optim_loss: 370200.2003

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5965.2572; train_edge_recon_loss: 258116.6973; train_gene_expr_recon_loss: 105554.7898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369636.7442; train_optim_loss: 369636.7442; val_kl_reg_loss: 5960.9363; val_edge_recon_loss: 258333.0101; val_gene_expr_recon_loss: 105581.3315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369875.2780; val_optim_loss: 369875.2780
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9950; val_auprc_score: 0.9939; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 5966.0525; train_edge_recon_loss: 258105.8981; train_gene_expr_recon_loss: 105566.4259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369638.3763; train_optim_loss: 369638.3763; val_kl_reg_loss: 5958.6328; val_edge_recon_loss: 258511.4379; val_gene_expr_recon_loss: 105854.8072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370324.8784; val_optim_loss: 370324.8784
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 5963.6578; train_edge_recon_loss: 258132.0666; train_gene_expr_recon_loss: 105574.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369670.1185; train_optim_loss: 369670.1185; val_kl_reg_loss: 5961.2352; val_edge_recon_loss: 258427.9289; val_gene_expr_recon_loss: 105822.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370211.2450; val_optim_loss: 370211.2450
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 5962.4589; train_edge_recon_loss: 258122.8972; train_gene_expr_recon_loss: 105559.9279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369645.2839; train_optim_loss: 369645.2839; val_kl_reg_loss: 5963.4908; val_edge_recon_loss: 258364.4557; val_gene_expr_recon_loss: 105731.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370059.9306; val_optim_loss: 370059.9306
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9949; val_auprc_score: 0.9938; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 5963.6481; train_edge_recon_loss: 258080.7241; train_gene_expr_recon_loss: 105491.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369536.1185; train_optim_loss: 369536.1185; val_kl_reg_loss: 5957.2783; val_edge_recon_loss: 258517.5128; val_gene_expr_recon_loss: 105655.9283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370130.7203; val_optim_loss: 370130.7203

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 5961.6107; train_edge_recon_loss: 258054.7975; train_gene_expr_recon_loss: 105559.5015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369575.9097; train_optim_loss: 369575.9097; val_kl_reg_loss: 5956.4230; val_edge_recon_loss: 258365.2875; val_gene_expr_recon_loss: 105781.9593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370103.6698; val_optim_loss: 370103.6698
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 5963.4312; train_edge_recon_loss: 258137.0012; train_gene_expr_recon_loss: 105564.9376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369665.3698; train_optim_loss: 369665.3698; val_kl_reg_loss: 5955.4682; val_edge_recon_loss: 258582.8005; val_gene_expr_recon_loss: 105757.8978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370296.1660; val_optim_loss: 370296.1660
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 5963.5198; train_edge_recon_loss: 258075.1948; train_gene_expr_recon_loss: 105531.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369570.3873; train_optim_loss: 369570.3873; val_kl_reg_loss: 5958.4860; val_edge_recon_loss: 258319.1914; val_gene_expr_recon_loss: 105842.0980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370119.7762; val_optim_loss: 370119.7762
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 5963.0567; train_edge_recon_loss: 258197.4845; train_gene_expr_recon_loss: 105602.9104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369763.4518; train_optim_loss: 369763.4518; val_kl_reg_loss: 5955.2415; val_edge_recon_loss: 258421.3987; val_gene_expr_recon_loss: 105644.8715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370021.5110; val_optim_loss: 370021.5110

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 522 min 4 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9946
val AUPRC score: 0.9932
val best accuracy score: 0.9729
val best F1 score: 0.9732
val target rna MSE score: 1.4816
val source rna MSE score: 0.2132

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
