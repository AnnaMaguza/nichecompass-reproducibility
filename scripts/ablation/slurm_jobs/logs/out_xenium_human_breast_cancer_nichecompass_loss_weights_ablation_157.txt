None
Run timestamp: 15072023_034225_157.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_157']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9201; val_auprc_score: 0.8941; val_best_acc_score: 0.8578; val_best_f1_score: 0.8682; train_kl_reg_loss: 50111.2404; train_edge_recon_loss: 27349512.1735; train_gene_expr_recon_loss: 7819408.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35219031.9588; train_optim_loss: 35219031.9588; val_kl_reg_loss: 56252.4538; val_edge_recon_loss: 27105439.2632; val_gene_expr_recon_loss: 7189430.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34351122.1053; val_optim_loss: 34351122.1053
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9389; val_auprc_score: 0.9204; val_best_acc_score: 0.8794; val_best_f1_score: 0.8870; train_kl_reg_loss: 52925.0744; train_edge_recon_loss: 26498897.1676; train_gene_expr_recon_loss: 6955466.7750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33507289.0471; train_optim_loss: 33507289.0471; val_kl_reg_loss: 51209.2295; val_edge_recon_loss: 26857141.9737; val_gene_expr_recon_loss: 6839482.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33747833.3158; val_optim_loss: 33747833.3158
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9428; val_auprc_score: 0.9274; val_best_acc_score: 0.8819; val_best_f1_score: 0.8890; train_kl_reg_loss: 50513.8548; train_edge_recon_loss: 26400290.0588; train_gene_expr_recon_loss: 6685423.3324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33136227.2500; train_optim_loss: 33136227.2500; val_kl_reg_loss: 46447.4541; val_edge_recon_loss: 26866714.5789; val_gene_expr_recon_loss: 6633792.1908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33546954.2895; val_optim_loss: 33546954.2895
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9463; val_auprc_score: 0.9318; val_best_acc_score: 0.8849; val_best_f1_score: 0.8916; train_kl_reg_loss: 46359.3752; train_edge_recon_loss: 26338355.7176; train_gene_expr_recon_loss: 6514280.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32898995.4147; train_optim_loss: 32898995.4147; val_kl_reg_loss: 42732.9365; val_edge_recon_loss: 26810646.7632; val_gene_expr_recon_loss: 6484489.8618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33337869.5526; val_optim_loss: 33337869.5526
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9563; val_auprc_score: 0.9458; val_best_acc_score: 0.8967; val_best_f1_score: 0.9019; train_kl_reg_loss: 42359.6458; train_edge_recon_loss: 26266311.4941; train_gene_expr_recon_loss: 6399591.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32708262.4647; train_optim_loss: 32708262.4647; val_kl_reg_loss: 41223.4742; val_edge_recon_loss: 26706758.8684; val_gene_expr_recon_loss: 6390095.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33138077.5526; val_optim_loss: 33138077.5526
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9591; val_auprc_score: 0.9473; val_best_acc_score: 0.9036; val_best_f1_score: 0.9078; train_kl_reg_loss: 39821.7703; train_edge_recon_loss: 26222683.6147; train_gene_expr_recon_loss: 6320407.3551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32582912.7118; train_optim_loss: 32582912.7118; val_kl_reg_loss: 38025.5216; val_edge_recon_loss: 26730599.2368; val_gene_expr_recon_loss: 6331360.9276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33099985.7895; val_optim_loss: 33099985.7895
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9611; val_auprc_score: 0.9510; val_best_acc_score: 0.9049; val_best_f1_score: 0.9090; train_kl_reg_loss: 38580.1367; train_edge_recon_loss: 26196940.9735; train_gene_expr_recon_loss: 6260678.7890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32496199.8529; train_optim_loss: 32496199.8529; val_kl_reg_loss: 38374.0235; val_edge_recon_loss: 26701657.2895; val_gene_expr_recon_loss: 6296472.5658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33036503.9211; val_optim_loss: 33036503.9211
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9638; val_auprc_score: 0.9543; val_best_acc_score: 0.9102; val_best_f1_score: 0.9141; train_kl_reg_loss: 37992.4492; train_edge_recon_loss: 26155844.2206; train_gene_expr_recon_loss: 6219325.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32413162.4353; train_optim_loss: 32413162.4353; val_kl_reg_loss: 36575.2219; val_edge_recon_loss: 26649548.1842; val_gene_expr_recon_loss: 6252101.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32938224.5789; val_optim_loss: 32938224.5789
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9653; val_auprc_score: 0.9565; val_best_acc_score: 0.9122; val_best_f1_score: 0.9156; train_kl_reg_loss: 37250.0878; train_edge_recon_loss: 26129530.8559; train_gene_expr_recon_loss: 6185600.8029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32352381.7206; train_optim_loss: 32352381.7206; val_kl_reg_loss: 35447.4745; val_edge_recon_loss: 26664800.6316; val_gene_expr_recon_loss: 6242672.3289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32942920.4474; val_optim_loss: 32942920.4474
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9662; val_auprc_score: 0.9578; val_best_acc_score: 0.9136; val_best_f1_score: 0.9170; train_kl_reg_loss: 37350.8916; train_edge_recon_loss: 26107214.7382; train_gene_expr_recon_loss: 6156906.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32301471.7735; train_optim_loss: 32301471.7735; val_kl_reg_loss: 35903.2701; val_edge_recon_loss: 26625567.3158; val_gene_expr_recon_loss: 6204565.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32866036.4474; val_optim_loss: 32866036.4474
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9650; val_auprc_score: 0.9545; val_best_acc_score: 0.9134; val_best_f1_score: 0.9173; train_kl_reg_loss: 37445.3721; train_edge_recon_loss: 26108859.3265; train_gene_expr_recon_loss: 6134717.8235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32281022.5206; train_optim_loss: 32281022.5206; val_kl_reg_loss: 36599.1916; val_edge_recon_loss: 26584780.5263; val_gene_expr_recon_loss: 6182061.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32803441.1316; val_optim_loss: 32803441.1316
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9672; val_auprc_score: 0.9586; val_best_acc_score: 0.9152; val_best_f1_score: 0.9182; train_kl_reg_loss: 36957.1636; train_edge_recon_loss: 26110959.0235; train_gene_expr_recon_loss: 6116168.1419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32264084.3265; train_optim_loss: 32264084.3265; val_kl_reg_loss: 35451.3071; val_edge_recon_loss: 26552628.6316; val_gene_expr_recon_loss: 6175774.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32763854.6579; val_optim_loss: 32763854.6579
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9684; val_auprc_score: 0.9592; val_best_acc_score: 0.9177; val_best_f1_score: 0.9207; train_kl_reg_loss: 36264.7731; train_edge_recon_loss: 26086533.7029; train_gene_expr_recon_loss: 6101751.0772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32224549.5588; train_optim_loss: 32224549.5588; val_kl_reg_loss: 35133.8138; val_edge_recon_loss: 26515274.0000; val_gene_expr_recon_loss: 6157488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32707895.6579; val_optim_loss: 32707895.6579
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9676; val_auprc_score: 0.9589; val_best_acc_score: 0.9167; val_best_f1_score: 0.9197; train_kl_reg_loss: 36290.6547; train_edge_recon_loss: 26073262.9147; train_gene_expr_recon_loss: 6088760.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32198313.7794; train_optim_loss: 32198313.7794; val_kl_reg_loss: 35157.2188; val_edge_recon_loss: 26607730.6579; val_gene_expr_recon_loss: 6150917.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32793805.2105; val_optim_loss: 32793805.2105
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9677; val_auprc_score: 0.9583; val_best_acc_score: 0.9182; val_best_f1_score: 0.9215; train_kl_reg_loss: 36048.2898; train_edge_recon_loss: 26066527.2088; train_gene_expr_recon_loss: 6073460.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32176036.1588; train_optim_loss: 32176036.1588; val_kl_reg_loss: 34926.4033; val_edge_recon_loss: 26529894.1316; val_gene_expr_recon_loss: 6143577.9276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32708398.4474; val_optim_loss: 32708398.4474
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9672; val_auprc_score: 0.9582; val_best_acc_score: 0.9174; val_best_f1_score: 0.9202; train_kl_reg_loss: 35440.0176; train_edge_recon_loss: 26063272.4588; train_gene_expr_recon_loss: 6061108.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32159820.6853; train_optim_loss: 32159820.6853; val_kl_reg_loss: 35578.7506; val_edge_recon_loss: 26562641.7368; val_gene_expr_recon_loss: 6131666.9539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32729887.4737; val_optim_loss: 32729887.4737
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9689; val_auprc_score: 0.9605; val_best_acc_score: 0.9191; val_best_f1_score: 0.9219; train_kl_reg_loss: 35294.5896; train_edge_recon_loss: 26068328.7265; train_gene_expr_recon_loss: 6054186.6676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32157810.0059; train_optim_loss: 32157810.0059; val_kl_reg_loss: 33616.3229; val_edge_recon_loss: 26562855.2105; val_gene_expr_recon_loss: 6113290.7697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32709762.2368; val_optim_loss: 32709762.2368

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9692; val_auprc_score: 0.9614; val_best_acc_score: 0.9194; val_best_f1_score: 0.9222; train_kl_reg_loss: 35557.0923; train_edge_recon_loss: 26023847.1353; train_gene_expr_recon_loss: 6006269.3956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32065673.6735; train_optim_loss: 32065673.6735; val_kl_reg_loss: 35204.5768; val_edge_recon_loss: 26551542.2105; val_gene_expr_recon_loss: 6076093.9605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32662840.7105; val_optim_loss: 32662840.7105
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9693; val_auprc_score: 0.9606; val_best_acc_score: 0.9196; val_best_f1_score: 0.9226; train_kl_reg_loss: 36314.3670; train_edge_recon_loss: 26019476.8794; train_gene_expr_recon_loss: 5998520.2897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32054311.5206; train_optim_loss: 32054311.5206; val_kl_reg_loss: 35669.7352; val_edge_recon_loss: 26554245.3947; val_gene_expr_recon_loss: 6059560.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32649475.2895; val_optim_loss: 32649475.2895
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9689; val_auprc_score: 0.9603; val_best_acc_score: 0.9195; val_best_f1_score: 0.9226; train_kl_reg_loss: 37070.3758; train_edge_recon_loss: 26019053.5853; train_gene_expr_recon_loss: 5995881.5044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32052005.5029; train_optim_loss: 32052005.5029; val_kl_reg_loss: 36487.9398; val_edge_recon_loss: 26554819.4474; val_gene_expr_recon_loss: 6057600.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32648908.2895; val_optim_loss: 32648908.2895
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9709; val_auprc_score: 0.9632; val_best_acc_score: 0.9215; val_best_f1_score: 0.9246; train_kl_reg_loss: 37232.1171; train_edge_recon_loss: 26029033.3765; train_gene_expr_recon_loss: 5991540.6316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32057806.0912; train_optim_loss: 32057806.0912; val_kl_reg_loss: 36467.3044; val_edge_recon_loss: 26522686.0526; val_gene_expr_recon_loss: 6062160.3882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32621313.8947; val_optim_loss: 32621313.8947
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9705; val_auprc_score: 0.9625; val_best_acc_score: 0.9216; val_best_f1_score: 0.9244; train_kl_reg_loss: 37631.9117; train_edge_recon_loss: 26017415.3794; train_gene_expr_recon_loss: 5989172.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32044219.5147; train_optim_loss: 32044219.5147; val_kl_reg_loss: 36594.1760; val_edge_recon_loss: 26533527.3421; val_gene_expr_recon_loss: 6060855.7763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32630977.2895; val_optim_loss: 32630977.2895
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9697; val_auprc_score: 0.9613; val_best_acc_score: 0.9204; val_best_f1_score: 0.9233; train_kl_reg_loss: 37589.5297; train_edge_recon_loss: 26022875.1559; train_gene_expr_recon_loss: 5990096.4250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32050561.0882; train_optim_loss: 32050561.0882; val_kl_reg_loss: 36679.0525; val_edge_recon_loss: 26538467.0526; val_gene_expr_recon_loss: 6058005.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32633151.3421; val_optim_loss: 32633151.3421
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9709; val_auprc_score: 0.9632; val_best_acc_score: 0.9213; val_best_f1_score: 0.9244; train_kl_reg_loss: 37460.4832; train_edge_recon_loss: 26033904.3353; train_gene_expr_recon_loss: 5986751.0199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32058115.8441; train_optim_loss: 32058115.8441; val_kl_reg_loss: 36436.1645; val_edge_recon_loss: 26529527.8421; val_gene_expr_recon_loss: 6056723.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32622687.4211; val_optim_loss: 32622687.4211
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9702; val_auprc_score: 0.9619; val_best_acc_score: 0.9215; val_best_f1_score: 0.9245; train_kl_reg_loss: 37630.8555; train_edge_recon_loss: 26019561.8618; train_gene_expr_recon_loss: 5987691.8904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32044884.6471; train_optim_loss: 32044884.6471; val_kl_reg_loss: 36636.1209; val_edge_recon_loss: 26532322.6579; val_gene_expr_recon_loss: 6045159.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32614118.2105; val_optim_loss: 32614118.2105
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9709; val_auprc_score: 0.9635; val_best_acc_score: 0.9216; val_best_f1_score: 0.9247; train_kl_reg_loss: 37587.0289; train_edge_recon_loss: 26032523.9353; train_gene_expr_recon_loss: 5987289.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32057400.0029; train_optim_loss: 32057400.0029; val_kl_reg_loss: 36386.0585; val_edge_recon_loss: 26539445.1579; val_gene_expr_recon_loss: 6050883.0658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32626714.2632; val_optim_loss: 32626714.2632
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9708; val_auprc_score: 0.9629; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 37411.3866; train_edge_recon_loss: 26011883.4471; train_gene_expr_recon_loss: 5984517.6772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32033812.5118; train_optim_loss: 32033812.5118; val_kl_reg_loss: 36628.3289; val_edge_recon_loss: 26513019.2632; val_gene_expr_recon_loss: 6060001.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32609649.0789; val_optim_loss: 32609649.0789
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9709; val_auprc_score: 0.9632; val_best_acc_score: 0.9215; val_best_f1_score: 0.9242; train_kl_reg_loss: 37502.3987; train_edge_recon_loss: 26014302.4559; train_gene_expr_recon_loss: 5982720.3390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32034525.1912; train_optim_loss: 32034525.1912; val_kl_reg_loss: 36733.3036; val_edge_recon_loss: 26527256.0526; val_gene_expr_recon_loss: 6047366.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32611355.5789; val_optim_loss: 32611355.5789
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9700; val_auprc_score: 0.9618; val_best_acc_score: 0.9215; val_best_f1_score: 0.9246; train_kl_reg_loss: 37520.6477; train_edge_recon_loss: 26031754.5647; train_gene_expr_recon_loss: 5981629.6257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32050904.8382; train_optim_loss: 32050904.8382; val_kl_reg_loss: 36671.7291; val_edge_recon_loss: 26514215.7632; val_gene_expr_recon_loss: 6040952.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32591840.3684; val_optim_loss: 32591840.3684
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9703; val_auprc_score: 0.9619; val_best_acc_score: 0.9217; val_best_f1_score: 0.9249; train_kl_reg_loss: 37957.6012; train_edge_recon_loss: 26007985.6176; train_gene_expr_recon_loss: 5978310.3007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32024253.5029; train_optim_loss: 32024253.5029; val_kl_reg_loss: 37118.9962; val_edge_recon_loss: 26503542.8684; val_gene_expr_recon_loss: 6047382.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32588044.7632; val_optim_loss: 32588044.7632
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9701; val_auprc_score: 0.9621; val_best_acc_score: 0.9211; val_best_f1_score: 0.9241; train_kl_reg_loss: 37958.6043; train_edge_recon_loss: 26013588.8853; train_gene_expr_recon_loss: 5978865.5213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32030413.0176; train_optim_loss: 32030413.0176; val_kl_reg_loss: 36658.1377; val_edge_recon_loss: 26567365.5526; val_gene_expr_recon_loss: 6041137.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32645161.1053; val_optim_loss: 32645161.1053
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9709; val_auprc_score: 0.9630; val_best_acc_score: 0.9222; val_best_f1_score: 0.9252; train_kl_reg_loss: 37801.1497; train_edge_recon_loss: 26012973.1853; train_gene_expr_recon_loss: 5979134.2022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32029908.5382; train_optim_loss: 32029908.5382; val_kl_reg_loss: 36827.1946; val_edge_recon_loss: 26501997.0789; val_gene_expr_recon_loss: 6072097.4605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32610921.6316; val_optim_loss: 32610921.6316
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9697; val_auprc_score: 0.9608; val_best_acc_score: 0.9216; val_best_f1_score: 0.9246; train_kl_reg_loss: 37746.8229; train_edge_recon_loss: 26006574.7765; train_gene_expr_recon_loss: 5976439.4051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32020761.0059; train_optim_loss: 32020761.0059; val_kl_reg_loss: 36566.7860; val_edge_recon_loss: 26548976.7105; val_gene_expr_recon_loss: 6045143.9013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32630687.5526; val_optim_loss: 32630687.5526
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9699; val_auprc_score: 0.9614; val_best_acc_score: 0.9211; val_best_f1_score: 0.9242; train_kl_reg_loss: 37934.5085; train_edge_recon_loss: 26004948.1824; train_gene_expr_recon_loss: 5978831.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32021713.8206; train_optim_loss: 32021713.8206; val_kl_reg_loss: 36911.2814; val_edge_recon_loss: 26551098.6842; val_gene_expr_recon_loss: 6037026.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32625036.0526; val_optim_loss: 32625036.0526

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9707; val_auprc_score: 0.9623; val_best_acc_score: 0.9220; val_best_f1_score: 0.9249; train_kl_reg_loss: 37983.6840; train_edge_recon_loss: 26013804.4824; train_gene_expr_recon_loss: 5966735.0735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32018523.2353; train_optim_loss: 32018523.2353; val_kl_reg_loss: 36928.3100; val_edge_recon_loss: 26536716.7368; val_gene_expr_recon_loss: 6030452.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32604098.2105; val_optim_loss: 32604098.2105
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9710; val_auprc_score: 0.9631; val_best_acc_score: 0.9226; val_best_f1_score: 0.9257; train_kl_reg_loss: 37922.6731; train_edge_recon_loss: 26005005.8588; train_gene_expr_recon_loss: 5968761.0956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32011689.6235; train_optim_loss: 32011689.6235; val_kl_reg_loss: 36917.2939; val_edge_recon_loss: 26498977.1053; val_gene_expr_recon_loss: 6053007.0921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32588901.5000; val_optim_loss: 32588901.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9712; val_auprc_score: 0.9637; val_best_acc_score: 0.9228; val_best_f1_score: 0.9258; train_kl_reg_loss: 37914.5059; train_edge_recon_loss: 26007090.2971; train_gene_expr_recon_loss: 5970280.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32015285.0235; train_optim_loss: 32015285.0235; val_kl_reg_loss: 36781.3993; val_edge_recon_loss: 26500042.2368; val_gene_expr_recon_loss: 6036078.7566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32572902.5526; val_optim_loss: 32572902.5526
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9701; val_auprc_score: 0.9620; val_best_acc_score: 0.9223; val_best_f1_score: 0.9253; train_kl_reg_loss: 37835.8458; train_edge_recon_loss: 26000917.5794; train_gene_expr_recon_loss: 5968798.5375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32007551.9412; train_optim_loss: 32007551.9412; val_kl_reg_loss: 36840.2186; val_edge_recon_loss: 26506898.5789; val_gene_expr_recon_loss: 6023897.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32567636.0526; val_optim_loss: 32567636.0526
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9718; val_auprc_score: 0.9643; val_best_acc_score: 0.9229; val_best_f1_score: 0.9259; train_kl_reg_loss: 37892.4294; train_edge_recon_loss: 26014063.1559; train_gene_expr_recon_loss: 5967246.5338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32019202.0735; train_optim_loss: 32019202.0735; val_kl_reg_loss: 36900.9376; val_edge_recon_loss: 26497776.1053; val_gene_expr_recon_loss: 6029506.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32564183.3421; val_optim_loss: 32564183.3421
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9712; val_auprc_score: 0.9633; val_best_acc_score: 0.9229; val_best_f1_score: 0.9256; train_kl_reg_loss: 37964.0044; train_edge_recon_loss: 25998990.5294; train_gene_expr_recon_loss: 5966095.3103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32003049.8765; train_optim_loss: 32003049.8765; val_kl_reg_loss: 36925.4702; val_edge_recon_loss: 26507784.5000; val_gene_expr_recon_loss: 6059461.3224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32604171.1842; val_optim_loss: 32604171.1842
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9723; val_auprc_score: 0.9645; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 37909.9026; train_edge_recon_loss: 26009103.5971; train_gene_expr_recon_loss: 5966652.0515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32013665.6147; train_optim_loss: 32013665.6147; val_kl_reg_loss: 36872.3053; val_edge_recon_loss: 26432972.7632; val_gene_expr_recon_loss: 6037209.3487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32507054.2895; val_optim_loss: 32507054.2895
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9708; val_auprc_score: 0.9624; val_best_acc_score: 0.9223; val_best_f1_score: 0.9252; train_kl_reg_loss: 37854.3030; train_edge_recon_loss: 26022249.5000; train_gene_expr_recon_loss: 5971027.0779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32031130.8971; train_optim_loss: 32031130.8971; val_kl_reg_loss: 36825.9677; val_edge_recon_loss: 26518631.9474; val_gene_expr_recon_loss: 6044158.5197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32599616.4474; val_optim_loss: 32599616.4474
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9707; val_auprc_score: 0.9629; val_best_acc_score: 0.9208; val_best_f1_score: 0.9240; train_kl_reg_loss: 37823.6199; train_edge_recon_loss: 26011082.7294; train_gene_expr_recon_loss: 5966063.8250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32014970.1618; train_optim_loss: 32014970.1618; val_kl_reg_loss: 36694.7564; val_edge_recon_loss: 26555158.5526; val_gene_expr_recon_loss: 6033980.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32625834.0000; val_optim_loss: 32625834.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9713; val_auprc_score: 0.9633; val_best_acc_score: 0.9233; val_best_f1_score: 0.9260; train_kl_reg_loss: 37790.8682; train_edge_recon_loss: 26022087.0176; train_gene_expr_recon_loss: 5967786.8096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32027664.7147; train_optim_loss: 32027664.7147; val_kl_reg_loss: 36752.4332; val_edge_recon_loss: 26509492.7105; val_gene_expr_recon_loss: 6044914.1382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32591159.2368; val_optim_loss: 32591159.2368
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9712; val_auprc_score: 0.9634; val_best_acc_score: 0.9232; val_best_f1_score: 0.9261; train_kl_reg_loss: 37860.8563; train_edge_recon_loss: 26003283.3706; train_gene_expr_recon_loss: 5967832.2735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32008976.5353; train_optim_loss: 32008976.5353; val_kl_reg_loss: 36840.3626; val_edge_recon_loss: 26509227.2368; val_gene_expr_recon_loss: 6032245.5395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32578313.0000; val_optim_loss: 32578313.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9702; val_auprc_score: 0.9615; val_best_acc_score: 0.9224; val_best_f1_score: 0.9254; train_kl_reg_loss: 37872.6901; train_edge_recon_loss: 26001351.8088; train_gene_expr_recon_loss: 5967516.4162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32006740.8912; train_optim_loss: 32006740.8912; val_kl_reg_loss: 36882.0316; val_edge_recon_loss: 26512761.5789; val_gene_expr_recon_loss: 6052187.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32601831.4474; val_optim_loss: 32601831.4474
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9712; val_auprc_score: 0.9635; val_best_acc_score: 0.9229; val_best_f1_score: 0.9258; train_kl_reg_loss: 37870.0009; train_edge_recon_loss: 25999745.8235; train_gene_expr_recon_loss: 5966897.7059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32004513.5059; train_optim_loss: 32004513.5059; val_kl_reg_loss: 36829.2704; val_edge_recon_loss: 26514917.3684; val_gene_expr_recon_loss: 6034973.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32586719.9474; val_optim_loss: 32586719.9474
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9713; val_auprc_score: 0.9637; val_best_acc_score: 0.9227; val_best_f1_score: 0.9257; train_kl_reg_loss: 37848.5661; train_edge_recon_loss: 26008546.4559; train_gene_expr_recon_loss: 5965051.8176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32011446.8000; train_optim_loss: 32011446.8000; val_kl_reg_loss: 36884.4576; val_edge_recon_loss: 26493473.7895; val_gene_expr_recon_loss: 6035104.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32565462.2895; val_optim_loss: 32565462.2895
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9711; val_auprc_score: 0.9631; val_best_acc_score: 0.9229; val_best_f1_score: 0.9259; train_kl_reg_loss: 37876.2117; train_edge_recon_loss: 25993301.3382; train_gene_expr_recon_loss: 5967498.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31998675.7706; train_optim_loss: 31998675.7706; val_kl_reg_loss: 36905.4179; val_edge_recon_loss: 26500896.7632; val_gene_expr_recon_loss: 6051757.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32589559.7105; val_optim_loss: 32589559.7105

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 82 min 55 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9695
Val AUPRC score: 0.9615
Val best accuracy score: 0.9211
Val best F1 score: 0.9239
Val gene expr MSE score: 1.3986

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
