None
Run timestamp: 15072023_101505_156.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_156']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9846; val_auprc_score: 0.9790; val_best_acc_score: 0.9519; val_best_f1_score: 0.9531; train_kl_reg_loss: 22542.4449; train_edge_recon_loss: 26305585.2656; train_gene_expr_recon_loss: 1336069.2585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27664196.9235; train_optim_loss: 27664196.9235; val_kl_reg_loss: 20083.5296; val_edge_recon_loss: 25840587.6000; val_gene_expr_recon_loss: 1202764.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27063435.4250; val_optim_loss: 27063435.4250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9872; val_auprc_score: 0.9820; val_best_acc_score: 0.9587; val_best_f1_score: 0.9596; train_kl_reg_loss: 20765.9913; train_edge_recon_loss: 25742119.2851; train_gene_expr_recon_loss: 1167733.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26930618.6676; train_optim_loss: 26930618.6676; val_kl_reg_loss: 19894.5553; val_edge_recon_loss: 25727894.2000; val_gene_expr_recon_loss: 1133128.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26880917.6500; val_optim_loss: 26880917.6500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9863; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 19839.0183; train_edge_recon_loss: 25632709.0459; train_gene_expr_recon_loss: 1121581.4548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26774129.5299; train_optim_loss: 26774129.5299; val_kl_reg_loss: 19026.5608; val_edge_recon_loss: 25616775.1750; val_gene_expr_recon_loss: 1102180.7703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26737982.4000; val_optim_loss: 26737982.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9910; val_auprc_score: 0.9869; val_best_acc_score: 0.9686; val_best_f1_score: 0.9692; train_kl_reg_loss: 19503.8294; train_edge_recon_loss: 25566720.1947; train_gene_expr_recon_loss: 1094778.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26681002.7955; train_optim_loss: 26681002.7955; val_kl_reg_loss: 18947.2385; val_edge_recon_loss: 25580726.1750; val_gene_expr_recon_loss: 1081986.4547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26681659.7750; val_optim_loss: 26681659.7750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9920; val_auprc_score: 0.9884; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 19398.5259; train_edge_recon_loss: 25544871.7051; train_gene_expr_recon_loss: 1079195.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26643466.1140; train_optim_loss: 26643466.1140; val_kl_reg_loss: 19619.9606; val_edge_recon_loss: 25567461.1000; val_gene_expr_recon_loss: 1068258.3445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26655339.3250; val_optim_loss: 26655339.3250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9889; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 19333.3758; train_edge_recon_loss: 25510063.8387; train_gene_expr_recon_loss: 1066891.6646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26596288.8317; train_optim_loss: 26596288.8317; val_kl_reg_loss: 19412.3599; val_edge_recon_loss: 25549164.6500; val_gene_expr_recon_loss: 1057594.4187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26626171.5250; val_optim_loss: 26626171.5250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9919; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 19201.2018; train_edge_recon_loss: 25502061.0960; train_gene_expr_recon_loss: 1058576.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26579838.8623; train_optim_loss: 26579838.8623; val_kl_reg_loss: 18720.9740; val_edge_recon_loss: 25521459.1000; val_gene_expr_recon_loss: 1052028.1109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26592208.3000; val_optim_loss: 26592208.3000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9923; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 18862.6406; train_edge_recon_loss: 25484849.2184; train_gene_expr_recon_loss: 1051698.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26555410.1474; train_optim_loss: 26555410.1474; val_kl_reg_loss: 18651.0726; val_edge_recon_loss: 25505073.2500; val_gene_expr_recon_loss: 1043906.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26567630.7000; val_optim_loss: 26567630.7000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9948; val_auprc_score: 0.9924; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 18830.9763; train_edge_recon_loss: 25470572.8039; train_gene_expr_recon_loss: 1045320.3413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26534724.1363; train_optim_loss: 26534724.1363; val_kl_reg_loss: 18810.8002; val_edge_recon_loss: 25487143.6000; val_gene_expr_recon_loss: 1038825.0797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26544779.4250; val_optim_loss: 26544779.4250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9951; val_auprc_score: 0.9924; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 18671.7326; train_edge_recon_loss: 25450520.4006; train_gene_expr_recon_loss: 1040897.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26510089.3825; train_optim_loss: 26510089.3825; val_kl_reg_loss: 18838.9994; val_edge_recon_loss: 25491585.3000; val_gene_expr_recon_loss: 1033711.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26544135.6750; val_optim_loss: 26544135.6750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9934; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 18501.1027; train_edge_recon_loss: 25445448.7928; train_gene_expr_recon_loss: 1036988.3552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26500938.2448; train_optim_loss: 26500938.2448; val_kl_reg_loss: 18249.6639; val_edge_recon_loss: 25459963.8000; val_gene_expr_recon_loss: 1033286.2023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26511499.6250; val_optim_loss: 26511499.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9935; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 18194.6803; train_edge_recon_loss: 25436532.3950; train_gene_expr_recon_loss: 1032928.5857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26487655.6745; train_optim_loss: 26487655.6745; val_kl_reg_loss: 18318.4436; val_edge_recon_loss: 25451535.3250; val_gene_expr_recon_loss: 1026677.7203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26496531.4750; val_optim_loss: 26496531.4750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9940; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 18027.2008; train_edge_recon_loss: 25426051.0793; train_gene_expr_recon_loss: 1029500.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26473579.0431; train_optim_loss: 26473579.0431; val_kl_reg_loss: 17998.8219; val_edge_recon_loss: 25438318.8250; val_gene_expr_recon_loss: 1026271.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26482588.8500; val_optim_loss: 26482588.8500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9963; val_auprc_score: 0.9942; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 18085.4431; train_edge_recon_loss: 25417183.2267; train_gene_expr_recon_loss: 1027331.5821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26462600.2865; train_optim_loss: 26462600.2865; val_kl_reg_loss: 17661.4658; val_edge_recon_loss: 25427915.8500; val_gene_expr_recon_loss: 1023746.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26469323.8000; val_optim_loss: 26469323.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9937; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 17930.6317; train_edge_recon_loss: 25408463.9638; train_gene_expr_recon_loss: 1023968.5956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26450363.2462; train_optim_loss: 26450363.2462; val_kl_reg_loss: 17974.2027; val_edge_recon_loss: 25444930.9750; val_gene_expr_recon_loss: 1019563.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26482468.7500; val_optim_loss: 26482468.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9960; val_auprc_score: 0.9939; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 17721.3279; train_edge_recon_loss: 25402065.8554; train_gene_expr_recon_loss: 1021540.0103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26441327.1850; train_optim_loss: 26441327.1850; val_kl_reg_loss: 17819.9628; val_edge_recon_loss: 25404137.8500; val_gene_expr_recon_loss: 1019730.0773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26441687.8750; val_optim_loss: 26441687.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9945; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 17552.2852; train_edge_recon_loss: 25398053.2684; train_gene_expr_recon_loss: 1019297.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26434903.4715; train_optim_loss: 26434903.4715; val_kl_reg_loss: 17455.4342; val_edge_recon_loss: 25387251.1000; val_gene_expr_recon_loss: 1016298.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26421005.1750; val_optim_loss: 26421005.1750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9945; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 17576.8512; train_edge_recon_loss: 25395597.4604; train_gene_expr_recon_loss: 1016905.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26430079.9054; train_optim_loss: 26430079.9054; val_kl_reg_loss: 17299.9049; val_edge_recon_loss: 25403527.3250; val_gene_expr_recon_loss: 1014204.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26435031.8750; val_optim_loss: 26435031.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9947; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 17374.3098; train_edge_recon_loss: 25390959.4019; train_gene_expr_recon_loss: 1015868.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26424201.8860; train_optim_loss: 26424201.8860; val_kl_reg_loss: 17277.2779; val_edge_recon_loss: 25418116.4250; val_gene_expr_recon_loss: 1015404.0617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26450797.8250; val_optim_loss: 26450797.8250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9965; val_auprc_score: 0.9949; val_best_acc_score: 0.9865; val_best_f1_score: 0.9867; train_kl_reg_loss: 17366.2283; train_edge_recon_loss: 25390263.5299; train_gene_expr_recon_loss: 1014228.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26421857.9499; train_optim_loss: 26421857.9499; val_kl_reg_loss: 17519.1148; val_edge_recon_loss: 25435188.0000; val_gene_expr_recon_loss: 1009949.4680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26462656.5000; val_optim_loss: 26462656.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9946; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 17378.0644; train_edge_recon_loss: 25384128.9764; train_gene_expr_recon_loss: 1012596.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26414103.4103; train_optim_loss: 26414103.4103; val_kl_reg_loss: 16725.5875; val_edge_recon_loss: 25398403.3500; val_gene_expr_recon_loss: 1012187.8531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26427316.8500; val_optim_loss: 26427316.8500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9967; val_auprc_score: 0.9948; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 17309.8467; train_edge_recon_loss: 25372140.3004; train_gene_expr_recon_loss: 1006573.5693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26396023.7691; train_optim_loss: 26396023.7691; val_kl_reg_loss: 17295.3560; val_edge_recon_loss: 25401416.7250; val_gene_expr_recon_loss: 1006744.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26425456.3000; val_optim_loss: 26425456.3000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9953; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 17507.3391; train_edge_recon_loss: 25363395.4604; train_gene_expr_recon_loss: 1004998.5819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26385901.3908; train_optim_loss: 26385901.3908; val_kl_reg_loss: 17335.6229; val_edge_recon_loss: 25363277.5500; val_gene_expr_recon_loss: 1005748.0563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26386361.1250; val_optim_loss: 26386361.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9970; val_auprc_score: 0.9954; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 17562.7335; train_edge_recon_loss: 25362764.4868; train_gene_expr_recon_loss: 1005082.0954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26385409.3213; train_optim_loss: 26385409.3213; val_kl_reg_loss: 17395.5259; val_edge_recon_loss: 25369274.7750; val_gene_expr_recon_loss: 1003549.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26390220.0250; val_optim_loss: 26390220.0250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 17619.1686; train_edge_recon_loss: 25359557.0320; train_gene_expr_recon_loss: 1003971.0068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26381147.2128; train_optim_loss: 26381147.2128; val_kl_reg_loss: 17488.0551; val_edge_recon_loss: 25380450.3250; val_gene_expr_recon_loss: 1005429.2102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26403367.7500; val_optim_loss: 26403367.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9959; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 17596.9118; train_edge_recon_loss: 25360250.6871; train_gene_expr_recon_loss: 1003858.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26381705.7663; train_optim_loss: 26381705.7663; val_kl_reg_loss: 17351.6456; val_edge_recon_loss: 25373476.0750; val_gene_expr_recon_loss: 1004831.9078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26395659.6750; val_optim_loss: 26395659.6750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9952; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 17524.6402; train_edge_recon_loss: 25361358.7371; train_gene_expr_recon_loss: 1004071.0629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26382954.4645; train_optim_loss: 26382954.4645; val_kl_reg_loss: 17343.0258; val_edge_recon_loss: 25374014.2750; val_gene_expr_recon_loss: 1006049.3602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26397406.6500; val_optim_loss: 26397406.6500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9969; val_auprc_score: 0.9952; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 17522.9565; train_edge_recon_loss: 25358480.7232; train_gene_expr_recon_loss: 1003048.2370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26379051.8999; train_optim_loss: 26379051.8999; val_kl_reg_loss: 17364.7243; val_edge_recon_loss: 25385759.6500; val_gene_expr_recon_loss: 1006530.7406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26409655.1500; val_optim_loss: 26409655.1500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9952; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 17522.0126; train_edge_recon_loss: 25362686.5814; train_gene_expr_recon_loss: 1003342.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26383550.8345; train_optim_loss: 26383550.8345; val_kl_reg_loss: 17380.4855; val_edge_recon_loss: 25387822.4750; val_gene_expr_recon_loss: 1005631.6859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26410834.5000; val_optim_loss: 26410834.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9955; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 17522.5865; train_edge_recon_loss: 25365450.7622; train_gene_expr_recon_loss: 1003325.8936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26386299.2545; train_optim_loss: 26386299.2545; val_kl_reg_loss: 17364.5005; val_edge_recon_loss: 25375726.0500; val_gene_expr_recon_loss: 1007336.9227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26400427.6000; val_optim_loss: 26400427.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9969; val_auprc_score: 0.9949; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 17526.7719; train_edge_recon_loss: 25360984.8985; train_gene_expr_recon_loss: 1003211.1733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26381722.8957; train_optim_loss: 26381722.8957; val_kl_reg_loss: 17362.0028; val_edge_recon_loss: 25384869.4000; val_gene_expr_recon_loss: 1007720.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26409952.3000; val_optim_loss: 26409952.3000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 284 min 2 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9968
Val AUPRC score: 0.9951
Val best accuracy score: 0.9886
Val best F1 score: 0.9887
Val gene expr MSE score: 0.6497

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
