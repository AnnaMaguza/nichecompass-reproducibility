Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5216.7657; train_edge_recon_loss: 256793.7346; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262010.5002; train_optim_loss: 262010.5002; val_kl_reg_loss: 5201.4182; val_edge_recon_loss: 256012.9002; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261214.3188; val_optim_loss: 261214.3188
None
Run timestamp: 01072023_223719_28.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_28']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9835; val_auprc_score: 0.9798; val_best_acc_score: 0.9425; val_best_f1_score: 0.9437; train_kl_reg_loss: 5050.9045; train_edge_recon_loss: 264069.1210; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269120.0253; train_optim_loss: 269120.0253; val_kl_reg_loss: 4995.5949; val_edge_recon_loss: 261050.5093; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266046.1044; val_optim_loss: 266046.1044
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9892; val_auprc_score: 0.9865; val_best_acc_score: 0.9560; val_best_f1_score: 0.9567; train_kl_reg_loss: 5107.0335; train_edge_recon_loss: 260307.5541; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265414.5878; train_optim_loss: 265414.5878; val_kl_reg_loss: 4998.6136; val_edge_recon_loss: 261092.1599; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266090.7738; val_optim_loss: 266090.7738
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5217.4418; train_edge_recon_loss: 256760.9893; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261978.4310; train_optim_loss: 261978.4310; val_kl_reg_loss: 5201.4539; val_edge_recon_loss: 255975.3775; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261176.8308; val_optim_loss: 261176.8308
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9902; val_auprc_score: 0.9875; val_best_acc_score: 0.9609; val_best_f1_score: 0.9616; train_kl_reg_loss: 5105.6736; train_edge_recon_loss: 259488.6942; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264594.3679; train_optim_loss: 264594.3679; val_kl_reg_loss: 5118.6157; val_edge_recon_loss: 258914.1959; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264032.8123; val_optim_loss: 264032.8123
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5217.6337; train_edge_recon_loss: 256715.7682; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261933.4020; train_optim_loss: 261933.4020; val_kl_reg_loss: 5199.5782; val_edge_recon_loss: 256016.4184; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261215.9969; val_optim_loss: 261215.9969
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9916; val_auprc_score: 0.9892; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 5106.1902; train_edge_recon_loss: 259140.3195; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264246.5102; train_optim_loss: 264246.5102; val_kl_reg_loss: 5099.1996; val_edge_recon_loss: 258938.5782; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264037.7780; val_optim_loss: 264037.7780
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 5217.1150; train_edge_recon_loss: 256745.6762; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261962.7912; train_optim_loss: 261962.7912; val_kl_reg_loss: 5207.8600; val_edge_recon_loss: 255860.0205; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261067.8809; val_optim_loss: 261067.8809
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9657; val_best_f1_score: 0.9661; train_kl_reg_loss: 5108.2997; train_edge_recon_loss: 258834.7067; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263943.0065; train_optim_loss: 263943.0065; val_kl_reg_loss: 5159.3656; val_edge_recon_loss: 258607.0132; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263766.3785; val_optim_loss: 263766.3785
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9693; val_best_f1_score: 0.9697; train_kl_reg_loss: 5109.5806; train_edge_recon_loss: 258598.2501; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263707.8310; train_optim_loss: 263707.8310; val_kl_reg_loss: 4993.0238; val_edge_recon_loss: 258256.5501; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263249.5737; val_optim_loss: 263249.5737

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5215.8241; train_edge_recon_loss: 256705.9934; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261921.8177; train_optim_loss: 261921.8177; val_kl_reg_loss: 5201.6383; val_edge_recon_loss: 255955.8210; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261157.4597; val_optim_loss: 261157.4597
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 5108.9927; train_edge_recon_loss: 258425.1900; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263534.1828; train_optim_loss: 263534.1828; val_kl_reg_loss: 5175.3347; val_edge_recon_loss: 258014.0115; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263189.3469; val_optim_loss: 263189.3469
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9813; val_best_f1_score: 0.9814; train_kl_reg_loss: 5216.5212; train_edge_recon_loss: 256697.2814; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261913.8027; train_optim_loss: 261913.8027; val_kl_reg_loss: 5204.2993; val_edge_recon_loss: 255967.0898; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261171.3893; val_optim_loss: 261171.3893
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 5112.1145; train_edge_recon_loss: 258189.0403; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263301.1550; train_optim_loss: 263301.1550; val_kl_reg_loss: 5170.4690; val_edge_recon_loss: 257709.6948; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262880.1633; val_optim_loss: 262880.1633
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 5219.1869; train_edge_recon_loss: 256687.0613; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261906.2483; train_optim_loss: 261906.2483; val_kl_reg_loss: 5203.8885; val_edge_recon_loss: 255947.0677; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261150.9565; val_optim_loss: 261150.9565
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9929; val_auprc_score: 0.9904; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 5109.5136; train_edge_recon_loss: 258072.0859; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263181.5997; train_optim_loss: 263181.5997; val_kl_reg_loss: 4919.2872; val_edge_recon_loss: 258117.3927; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263036.6797; val_optim_loss: 263036.6797
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 5110.4318; train_edge_recon_loss: 257988.7464; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263099.1784; train_optim_loss: 263099.1784; val_kl_reg_loss: 5140.2686; val_edge_recon_loss: 257637.9158; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262778.1839; val_optim_loss: 262778.1839
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5217.9047; train_edge_recon_loss: 256713.2465; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261931.1512; train_optim_loss: 261931.1512; val_kl_reg_loss: 5203.2076; val_edge_recon_loss: 255861.5146; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261064.7219; val_optim_loss: 261064.7219

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 884 min 41 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9947
Val best accuracy score: 0.9814
Val best F1 score: 0.9816
Val gene expr MSE score: 5.0248

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 5110.2268; train_edge_recon_loss: 257829.8217; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262940.0486; train_optim_loss: 262940.0486; val_kl_reg_loss: 5025.4939; val_edge_recon_loss: 257247.5266; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262273.0202; val_optim_loss: 262273.0202
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 5111.4459; train_edge_recon_loss: 257746.7316; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262858.1777; train_optim_loss: 262858.1777; val_kl_reg_loss: 5043.0303; val_edge_recon_loss: 257464.6506; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262507.6807; val_optim_loss: 262507.6807
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9944; val_auprc_score: 0.9924; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 5108.8703; train_edge_recon_loss: 257706.0267; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262814.8968; train_optim_loss: 262814.8968; val_kl_reg_loss: 5013.1662; val_edge_recon_loss: 257165.9053; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262179.0713; val_optim_loss: 262179.0713
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 5111.3461; train_edge_recon_loss: 257562.4151; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262673.7613; train_optim_loss: 262673.7613; val_kl_reg_loss: 5001.4912; val_edge_recon_loss: 256919.8796; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261921.3705; val_optim_loss: 261921.3705
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 5108.8605; train_edge_recon_loss: 257468.2557; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262577.1161; train_optim_loss: 262577.1161; val_kl_reg_loss: 4843.9957; val_edge_recon_loss: 257122.2703; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261966.2654; val_optim_loss: 261966.2654
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 5108.6839; train_edge_recon_loss: 257430.2648; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262538.9490; train_optim_loss: 262538.9490; val_kl_reg_loss: 5126.2649; val_edge_recon_loss: 256839.6308; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261965.8957; val_optim_loss: 261965.8957
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9928; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 5107.8952; train_edge_recon_loss: 257382.8528; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262490.7479; train_optim_loss: 262490.7479; val_kl_reg_loss: 5143.2331; val_edge_recon_loss: 256650.7011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261793.9342; val_optim_loss: 261793.9342
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5106.2644; train_edge_recon_loss: 257361.8097; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262468.0740; train_optim_loss: 262468.0740; val_kl_reg_loss: 5202.8007; val_edge_recon_loss: 256775.6714; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261978.4721; val_optim_loss: 261978.4721
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9951; val_auprc_score: 0.9934; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 5106.0404; train_edge_recon_loss: 257296.1749; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262402.2153; train_optim_loss: 262402.2153; val_kl_reg_loss: 5015.1643; val_edge_recon_loss: 256642.3469; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261657.5114; val_optim_loss: 261657.5114
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9931; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 5103.7047; train_edge_recon_loss: 257278.4362; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262382.1410; train_optim_loss: 262382.1410; val_kl_reg_loss: 5073.0244; val_edge_recon_loss: 256666.2288; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261739.2535; val_optim_loss: 261739.2535
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 5107.6277; train_edge_recon_loss: 257185.6397; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262293.2678; train_optim_loss: 262293.2678; val_kl_reg_loss: 5301.4365; val_edge_recon_loss: 256778.1851; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262079.6216; val_optim_loss: 262079.6216
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9954; val_auprc_score: 0.9937; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 5104.7620; train_edge_recon_loss: 257204.5040; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262309.2663; train_optim_loss: 262309.2663; val_kl_reg_loss: 5115.6917; val_edge_recon_loss: 256441.5808; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261557.2727; val_optim_loss: 261557.2727
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9951; val_auprc_score: 0.9931; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 5105.9266; train_edge_recon_loss: 257072.6080; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262178.5345; train_optim_loss: 262178.5345; val_kl_reg_loss: 5014.6832; val_edge_recon_loss: 256420.2873; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261434.9703; val_optim_loss: 261434.9703
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5105.7919; train_edge_recon_loss: 257118.4510; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262224.2428; train_optim_loss: 262224.2428; val_kl_reg_loss: 5109.0809; val_edge_recon_loss: 256479.3059; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261588.3870; val_optim_loss: 261588.3870
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9935; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 5106.3300; train_edge_recon_loss: 257015.0830; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262121.4130; train_optim_loss: 262121.4130; val_kl_reg_loss: 4932.9005; val_edge_recon_loss: 256405.9152; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261338.8157; val_optim_loss: 261338.8157
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9935; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5103.4917; train_edge_recon_loss: 257041.2931; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262144.7849; train_optim_loss: 262144.7849; val_kl_reg_loss: 5072.0330; val_edge_recon_loss: 256290.8251; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261362.8582; val_optim_loss: 261362.8582
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9954; val_auprc_score: 0.9937; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 5105.4346; train_edge_recon_loss: 256989.0950; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262094.5297; train_optim_loss: 262094.5297; val_kl_reg_loss: 5129.6338; val_edge_recon_loss: 256495.4405; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261625.0738; val_optim_loss: 261625.0738
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 5104.8639; train_edge_recon_loss: 256969.6684; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262074.5322; train_optim_loss: 262074.5322; val_kl_reg_loss: 5106.5725; val_edge_recon_loss: 256296.6811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261403.2534; val_optim_loss: 261403.2534
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5102.1084; train_edge_recon_loss: 257023.7084; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262125.8168; train_optim_loss: 262125.8168; val_kl_reg_loss: 5024.0159; val_edge_recon_loss: 256426.1646; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261450.1805; val_optim_loss: 261450.1805

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5088.3607; train_edge_recon_loss: 256686.6906; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261775.0513; train_optim_loss: 261775.0513; val_kl_reg_loss: 5062.5168; val_edge_recon_loss: 256018.0499; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261080.5672; val_optim_loss: 261080.5672
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 5081.8498; train_edge_recon_loss: 256717.5236; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261799.3736; train_optim_loss: 261799.3736; val_kl_reg_loss: 5068.8539; val_edge_recon_loss: 255881.8025; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260950.6560; val_optim_loss: 260950.6560
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 5081.5539; train_edge_recon_loss: 256662.7108; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261744.2647; train_optim_loss: 261744.2647; val_kl_reg_loss: 5061.2122; val_edge_recon_loss: 255944.8583; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261006.0698; val_optim_loss: 261006.0698
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 5079.9116; train_edge_recon_loss: 256640.2869; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261720.1985; train_optim_loss: 261720.1985; val_kl_reg_loss: 5079.4426; val_edge_recon_loss: 255876.9643; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260956.4070; val_optim_loss: 260956.4070
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5077.7078; train_edge_recon_loss: 256653.4433; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261731.1512; train_optim_loss: 261731.1512; val_kl_reg_loss: 5058.7240; val_edge_recon_loss: 255977.1796; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261035.9039; val_optim_loss: 261035.9039
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 5078.8846; train_edge_recon_loss: 256606.4195; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261685.3043; train_optim_loss: 261685.3043; val_kl_reg_loss: 5070.5478; val_edge_recon_loss: 255871.9595; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260942.5077; val_optim_loss: 260942.5077
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 5076.2017; train_edge_recon_loss: 256596.9809; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261673.1828; train_optim_loss: 261673.1828; val_kl_reg_loss: 5063.3519; val_edge_recon_loss: 255984.8153; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261048.1671; val_optim_loss: 261048.1671
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 5077.2509; train_edge_recon_loss: 256617.6793; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261694.9302; train_optim_loss: 261694.9302; val_kl_reg_loss: 5056.7573; val_edge_recon_loss: 255824.8101; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260881.5675; val_optim_loss: 260881.5675
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5074.8404; train_edge_recon_loss: 256613.3316; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261688.1721; train_optim_loss: 261688.1721; val_kl_reg_loss: 5054.3157; val_edge_recon_loss: 255749.4751; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260803.7908; val_optim_loss: 260803.7908
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 5073.7137; train_edge_recon_loss: 256606.7000; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261680.4137; train_optim_loss: 261680.4137; val_kl_reg_loss: 5060.8336; val_edge_recon_loss: 255725.3375; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260786.1709; val_optim_loss: 260786.1709
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5075.9020; train_edge_recon_loss: 256586.7795; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261662.6814; train_optim_loss: 261662.6814; val_kl_reg_loss: 5059.5197; val_edge_recon_loss: 255954.0973; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261013.6169; val_optim_loss: 261013.6169
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9962; val_auprc_score: 0.9945; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5077.2133; train_edge_recon_loss: 256572.6709; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261649.8842; train_optim_loss: 261649.8842; val_kl_reg_loss: 5069.4936; val_edge_recon_loss: 255755.2063; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260824.6992; val_optim_loss: 260824.6992
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9959; val_auprc_score: 0.9944; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 5074.3388; train_edge_recon_loss: 256595.2877; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261669.6265; train_optim_loss: 261669.6265; val_kl_reg_loss: 5078.1478; val_edge_recon_loss: 255943.7853; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261021.9331; val_optim_loss: 261021.9331
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5074.8567; train_edge_recon_loss: 256572.1227; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261646.9792; train_optim_loss: 261646.9792; val_kl_reg_loss: 5040.6340; val_edge_recon_loss: 255706.9606; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260747.5951; val_optim_loss: 260747.5951
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5076.3448; train_edge_recon_loss: 256537.9639; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261614.3088; train_optim_loss: 261614.3088; val_kl_reg_loss: 5086.3820; val_edge_recon_loss: 255747.9944; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260834.3762; val_optim_loss: 260834.3762
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5076.6792; train_edge_recon_loss: 256550.8670; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261627.5461; train_optim_loss: 261627.5461; val_kl_reg_loss: 5081.0710; val_edge_recon_loss: 255863.4375; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260944.5088; val_optim_loss: 260944.5088
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9960; val_auprc_score: 0.9944; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5076.2476; train_edge_recon_loss: 256523.3603; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261599.6080; train_optim_loss: 261599.6080; val_kl_reg_loss: 5058.0593; val_edge_recon_loss: 255790.5111; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260848.5703; val_optim_loss: 260848.5703
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9961; val_auprc_score: 0.9946; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5074.8524; train_edge_recon_loss: 256578.0715; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261652.9240; train_optim_loss: 261652.9240; val_kl_reg_loss: 5056.6668; val_edge_recon_loss: 255780.4113; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260837.0777; val_optim_loss: 260837.0777

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 5073.9387; train_edge_recon_loss: 256516.6943; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261590.6330; train_optim_loss: 261590.6330; val_kl_reg_loss: 5067.3948; val_edge_recon_loss: 255629.8954; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260697.2897; val_optim_loss: 260697.2897
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5074.2053; train_edge_recon_loss: 256523.4218; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261597.6272; train_optim_loss: 261597.6272; val_kl_reg_loss: 5071.6816; val_edge_recon_loss: 255699.5047; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260771.1859; val_optim_loss: 260771.1859
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5074.9256; train_edge_recon_loss: 256460.3151; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261535.2407; train_optim_loss: 261535.2407; val_kl_reg_loss: 5056.6010; val_edge_recon_loss: 255665.8075; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260722.4084; val_optim_loss: 260722.4084
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9963; val_auprc_score: 0.9948; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 5072.4629; train_edge_recon_loss: 256546.8104; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261619.2731; train_optim_loss: 261619.2731; val_kl_reg_loss: 5064.9277; val_edge_recon_loss: 255553.8673; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260618.7946; val_optim_loss: 260618.7946
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5072.8511; train_edge_recon_loss: 256540.1828; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261613.0341; train_optim_loss: 261613.0341; val_kl_reg_loss: 5064.0809; val_edge_recon_loss: 255550.6000; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260614.6811; val_optim_loss: 260614.6811
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9961; val_auprc_score: 0.9944; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 5071.9098; train_edge_recon_loss: 256510.9760; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261582.8859; train_optim_loss: 261582.8859; val_kl_reg_loss: 5067.2216; val_edge_recon_loss: 255780.6194; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260847.8414; val_optim_loss: 260847.8414
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 5071.6556; train_edge_recon_loss: 256511.1955; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261582.8510; train_optim_loss: 261582.8510; val_kl_reg_loss: 5066.3861; val_edge_recon_loss: 255883.6075; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260949.9936; val_optim_loss: 260949.9936
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 5071.8721; train_edge_recon_loss: 256541.4918; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261613.3641; train_optim_loss: 261613.3641; val_kl_reg_loss: 5057.5694; val_edge_recon_loss: 255669.3330; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260726.9030; val_optim_loss: 260726.9030
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5071.5269; train_edge_recon_loss: 256590.3650; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261661.8919; train_optim_loss: 261661.8919; val_kl_reg_loss: 5062.9808; val_edge_recon_loss: 255739.1659; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260802.1469; val_optim_loss: 260802.1469

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 5072.4335; train_edge_recon_loss: 256547.6692; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261620.1028; train_optim_loss: 261620.1028; val_kl_reg_loss: 5062.5482; val_edge_recon_loss: 255739.4563; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260802.0047; val_optim_loss: 260802.0047
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5071.0306; train_edge_recon_loss: 256571.9367; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261642.9670; train_optim_loss: 261642.9670; val_kl_reg_loss: 5061.7375; val_edge_recon_loss: 255655.7580; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260717.4957; val_optim_loss: 260717.4957
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 5072.2411; train_edge_recon_loss: 256520.1286; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261592.3696; train_optim_loss: 261592.3696; val_kl_reg_loss: 5064.7768; val_edge_recon_loss: 255660.0264; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260724.8036; val_optim_loss: 260724.8036
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 5072.2620; train_edge_recon_loss: 256514.1051; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261586.3673; train_optim_loss: 261586.3673; val_kl_reg_loss: 5063.0274; val_edge_recon_loss: 255717.0164; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260780.0435; val_optim_loss: 260780.0435

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1232 min 7 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9945
Val best accuracy score: 0.9814
Val best F1 score: 0.9815
Val gene expr MSE score: 5.0120

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
