None
Run timestamp: 02072023_113406_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9716; val_auprc_score: 0.9588; val_best_acc_score: 0.9294; val_best_f1_score: 0.9310; train_kl_reg_loss: 2016.0531; train_edge_recon_loss: 28843.6919; train_gene_expr_recon_loss: 13846.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44706.0103; train_optim_loss: 44706.0103; val_kl_reg_loss: 2357.7207; val_edge_recon_loss: 26619.5267; val_gene_expr_recon_loss: 12437.1045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41414.3517; val_optim_loss: 41414.3517
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9768; val_auprc_score: 0.9669; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 2429.2710; train_edge_recon_loss: 27428.7821; train_gene_expr_recon_loss: 11912.2111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41770.2640; train_optim_loss: 41770.2640; val_kl_reg_loss: 2351.4016; val_edge_recon_loss: 26631.8668; val_gene_expr_recon_loss: 11451.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40434.2903; val_optim_loss: 40434.2903
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9798; val_auprc_score: 0.9709; val_best_acc_score: 0.9473; val_best_f1_score: 0.9485; train_kl_reg_loss: 2429.2088; train_edge_recon_loss: 27342.7601; train_gene_expr_recon_loss: 11330.5761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41102.5450; train_optim_loss: 41102.5450; val_kl_reg_loss: 2326.6988; val_edge_recon_loss: 26488.2703; val_gene_expr_recon_loss: 11118.0044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39932.9735; val_optim_loss: 39932.9735
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9818; val_auprc_score: 0.9735; val_best_acc_score: 0.9516; val_best_f1_score: 0.9528; train_kl_reg_loss: 2435.0255; train_edge_recon_loss: 27276.5975; train_gene_expr_recon_loss: 11010.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40721.8878; train_optim_loss: 40721.8878; val_kl_reg_loss: 2397.3136; val_edge_recon_loss: 26500.1008; val_gene_expr_recon_loss: 10816.1978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39713.6124; val_optim_loss: 39713.6124
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9826; val_auprc_score: 0.9752; val_best_acc_score: 0.9536; val_best_f1_score: 0.9547; train_kl_reg_loss: 2444.3329; train_edge_recon_loss: 27228.1338; train_gene_expr_recon_loss: 10790.2850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40462.7518; train_optim_loss: 40462.7518; val_kl_reg_loss: 2312.9814; val_edge_recon_loss: 26458.8825; val_gene_expr_recon_loss: 10622.3130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39394.1772; val_optim_loss: 39394.1772
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9824; val_auprc_score: 0.9748; val_best_acc_score: 0.9541; val_best_f1_score: 0.9552; train_kl_reg_loss: 2453.3888; train_edge_recon_loss: 27202.5974; train_gene_expr_recon_loss: 10610.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40266.9197; train_optim_loss: 40266.9197; val_kl_reg_loss: 2363.2702; val_edge_recon_loss: 26508.5520; val_gene_expr_recon_loss: 10447.5072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39319.3295; val_optim_loss: 39319.3295
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9841; val_auprc_score: 0.9773; val_best_acc_score: 0.9571; val_best_f1_score: 0.9579; train_kl_reg_loss: 2461.2298; train_edge_recon_loss: 27186.4285; train_gene_expr_recon_loss: 10452.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40100.1210; train_optim_loss: 40100.1210; val_kl_reg_loss: 2408.2337; val_edge_recon_loss: 26427.8831; val_gene_expr_recon_loss: 10318.3316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39154.4483; val_optim_loss: 39154.4483
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9845; val_auprc_score: 0.9784; val_best_acc_score: 0.9564; val_best_f1_score: 0.9575; train_kl_reg_loss: 2471.1008; train_edge_recon_loss: 27158.9614; train_gene_expr_recon_loss: 10324.4852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39954.5474; train_optim_loss: 39954.5474; val_kl_reg_loss: 2512.4348; val_edge_recon_loss: 26473.5728; val_gene_expr_recon_loss: 10193.1633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39179.1712; val_optim_loss: 39179.1712
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9837; val_auprc_score: 0.9765; val_best_acc_score: 0.9570; val_best_f1_score: 0.9581; train_kl_reg_loss: 2485.1034; train_edge_recon_loss: 27122.9233; train_gene_expr_recon_loss: 10215.6509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39823.6775; train_optim_loss: 39823.6775; val_kl_reg_loss: 2363.4407; val_edge_recon_loss: 26439.8202; val_gene_expr_recon_loss: 10147.8154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38951.0765; val_optim_loss: 38951.0765
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9844; val_auprc_score: 0.9783; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 2489.3094; train_edge_recon_loss: 27114.8903; train_gene_expr_recon_loss: 10125.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39729.4358; train_optim_loss: 39729.4358; val_kl_reg_loss: 2411.1939; val_edge_recon_loss: 26431.9614; val_gene_expr_recon_loss: 10032.9783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38876.1335; val_optim_loss: 38876.1335
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9851; val_auprc_score: 0.9786; val_best_acc_score: 0.9591; val_best_f1_score: 0.9599; train_kl_reg_loss: 2495.6610; train_edge_recon_loss: 27111.8896; train_gene_expr_recon_loss: 10055.4160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39662.9669; train_optim_loss: 39662.9669; val_kl_reg_loss: 2426.2019; val_edge_recon_loss: 26450.4873; val_gene_expr_recon_loss: 9969.3511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38846.0403; val_optim_loss: 38846.0403
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9854; val_auprc_score: 0.9791; val_best_acc_score: 0.9595; val_best_f1_score: 0.9604; train_kl_reg_loss: 2502.0912; train_edge_recon_loss: 27101.1488; train_gene_expr_recon_loss: 9973.7942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39577.0342; train_optim_loss: 39577.0342; val_kl_reg_loss: 2491.0139; val_edge_recon_loss: 26397.9829; val_gene_expr_recon_loss: 9902.7025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38791.6989; val_optim_loss: 38791.6989
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9863; val_auprc_score: 0.9807; val_best_acc_score: 0.9597; val_best_f1_score: 0.9605; train_kl_reg_loss: 2512.6370; train_edge_recon_loss: 27071.3435; train_gene_expr_recon_loss: 9908.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39492.1021; train_optim_loss: 39492.1021; val_kl_reg_loss: 2503.5548; val_edge_recon_loss: 26380.6200; val_gene_expr_recon_loss: 9849.0074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38733.1822; val_optim_loss: 38733.1822
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9858; val_auprc_score: 0.9796; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 2519.1842; train_edge_recon_loss: 27052.5405; train_gene_expr_recon_loss: 9850.6223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39422.3470; train_optim_loss: 39422.3470; val_kl_reg_loss: 2445.6511; val_edge_recon_loss: 26353.5293; val_gene_expr_recon_loss: 9798.8696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38598.0499; val_optim_loss: 38598.0499
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9814; val_best_acc_score: 0.9620; val_best_f1_score: 0.9628; train_kl_reg_loss: 2524.9345; train_edge_recon_loss: 27049.6722; train_gene_expr_recon_loss: 9789.7396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39364.3462; train_optim_loss: 39364.3462; val_kl_reg_loss: 2460.1640; val_edge_recon_loss: 26322.1040; val_gene_expr_recon_loss: 9740.5392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38522.8074; val_optim_loss: 38522.8074
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9861; val_auprc_score: 0.9799; val_best_acc_score: 0.9621; val_best_f1_score: 0.9631; train_kl_reg_loss: 2529.8917; train_edge_recon_loss: 27042.7314; train_gene_expr_recon_loss: 9744.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39316.7414; train_optim_loss: 39316.7414; val_kl_reg_loss: 2498.5180; val_edge_recon_loss: 26320.9157; val_gene_expr_recon_loss: 9723.1634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38542.5969; val_optim_loss: 38542.5969
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9868; val_auprc_score: 0.9817; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 2538.4792; train_edge_recon_loss: 27026.4148; train_gene_expr_recon_loss: 9714.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39278.9766; train_optim_loss: 39278.9766; val_kl_reg_loss: 2487.7971; val_edge_recon_loss: 26331.4068; val_gene_expr_recon_loss: 9689.2841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38508.4885; val_optim_loss: 38508.4885
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9866; val_auprc_score: 0.9808; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 2539.7433; train_edge_recon_loss: 27031.5697; train_gene_expr_recon_loss: 9675.6222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39246.9351; train_optim_loss: 39246.9351; val_kl_reg_loss: 2492.9774; val_edge_recon_loss: 26375.9698; val_gene_expr_recon_loss: 9656.1945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38525.1419; val_optim_loss: 38525.1419
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9872; val_auprc_score: 0.9819; val_best_acc_score: 0.9623; val_best_f1_score: 0.9631; train_kl_reg_loss: 2548.4400; train_edge_recon_loss: 27009.8791; train_gene_expr_recon_loss: 9626.9354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39185.2545; train_optim_loss: 39185.2545; val_kl_reg_loss: 2511.0932; val_edge_recon_loss: 26305.9529; val_gene_expr_recon_loss: 9627.6763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38444.7219; val_optim_loss: 38444.7219
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9870; val_auprc_score: 0.9819; val_best_acc_score: 0.9621; val_best_f1_score: 0.9630; train_kl_reg_loss: 2553.9412; train_edge_recon_loss: 26999.0492; train_gene_expr_recon_loss: 9597.5916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39150.5821; train_optim_loss: 39150.5821; val_kl_reg_loss: 2514.6295; val_edge_recon_loss: 26317.0425; val_gene_expr_recon_loss: 9624.8538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38456.5261; val_optim_loss: 38456.5261
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9878; val_auprc_score: 0.9833; val_best_acc_score: 0.9635; val_best_f1_score: 0.9642; train_kl_reg_loss: 2556.7109; train_edge_recon_loss: 26997.6937; train_gene_expr_recon_loss: 9560.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39114.9176; train_optim_loss: 39114.9176; val_kl_reg_loss: 2537.9471; val_edge_recon_loss: 26267.7915; val_gene_expr_recon_loss: 9565.9030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38371.6413; val_optim_loss: 38371.6413
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9878; val_auprc_score: 0.9823; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 2562.9054; train_edge_recon_loss: 26989.2504; train_gene_expr_recon_loss: 9531.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39083.4284; train_optim_loss: 39083.4284; val_kl_reg_loss: 2558.9156; val_edge_recon_loss: 26289.4191; val_gene_expr_recon_loss: 9544.4214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38392.7567; val_optim_loss: 38392.7567
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9878; val_auprc_score: 0.9823; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 2565.8859; train_edge_recon_loss: 26989.3060; train_gene_expr_recon_loss: 9506.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39061.5583; train_optim_loss: 39061.5583; val_kl_reg_loss: 2497.8950; val_edge_recon_loss: 26254.0952; val_gene_expr_recon_loss: 9540.9143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38292.9043; val_optim_loss: 38292.9043
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9869; val_auprc_score: 0.9813; val_best_acc_score: 0.9627; val_best_f1_score: 0.9635; train_kl_reg_loss: 2572.0444; train_edge_recon_loss: 26969.0123; train_gene_expr_recon_loss: 9476.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39018.0402; train_optim_loss: 39018.0402; val_kl_reg_loss: 2513.4953; val_edge_recon_loss: 26306.5765; val_gene_expr_recon_loss: 9491.4407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38311.5131; val_optim_loss: 38311.5131
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9877; val_auprc_score: 0.9828; val_best_acc_score: 0.9643; val_best_f1_score: 0.9650; train_kl_reg_loss: 2574.4806; train_edge_recon_loss: 26976.1811; train_gene_expr_recon_loss: 9457.9846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39008.6464; train_optim_loss: 39008.6464; val_kl_reg_loss: 2529.0767; val_edge_recon_loss: 26279.9577; val_gene_expr_recon_loss: 9487.0583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38296.0929; val_optim_loss: 38296.0929
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9879; val_auprc_score: 0.9830; val_best_acc_score: 0.9641; val_best_f1_score: 0.9648; train_kl_reg_loss: 2578.8824; train_edge_recon_loss: 26968.3770; train_gene_expr_recon_loss: 9437.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38985.0251; train_optim_loss: 38985.0251; val_kl_reg_loss: 2588.8088; val_edge_recon_loss: 26290.3828; val_gene_expr_recon_loss: 9489.8578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38369.0494; val_optim_loss: 38369.0494
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9881; val_auprc_score: 0.9831; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 2587.0050; train_edge_recon_loss: 26938.4237; train_gene_expr_recon_loss: 9415.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38941.2759; train_optim_loss: 38941.2759; val_kl_reg_loss: 2577.2036; val_edge_recon_loss: 26219.4099; val_gene_expr_recon_loss: 9483.1721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38279.7860; val_optim_loss: 38279.7860
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9884; val_auprc_score: 0.9837; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 2589.7764; train_edge_recon_loss: 26947.9894; train_gene_expr_recon_loss: 9398.5563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38936.3221; train_optim_loss: 38936.3221; val_kl_reg_loss: 2519.8851; val_edge_recon_loss: 26300.0279; val_gene_expr_recon_loss: 9438.9819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38258.8949; val_optim_loss: 38258.8949
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9887; val_auprc_score: 0.9846; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 2591.7899; train_edge_recon_loss: 26944.7545; train_gene_expr_recon_loss: 9383.1457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38919.6900; train_optim_loss: 38919.6900; val_kl_reg_loss: 2580.3885; val_edge_recon_loss: 26259.6606; val_gene_expr_recon_loss: 9460.8069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38300.8564; val_optim_loss: 38300.8564
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9880; val_auprc_score: 0.9832; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 2594.0465; train_edge_recon_loss: 26944.3693; train_gene_expr_recon_loss: 9360.6596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38899.0754; train_optim_loss: 38899.0754; val_kl_reg_loss: 2574.9855; val_edge_recon_loss: 26299.3373; val_gene_expr_recon_loss: 9454.7566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38329.0794; val_optim_loss: 38329.0794
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9884; val_auprc_score: 0.9840; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 2599.2185; train_edge_recon_loss: 26933.3215; train_gene_expr_recon_loss: 9345.5177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38878.0576; train_optim_loss: 38878.0576; val_kl_reg_loss: 2573.8097; val_edge_recon_loss: 26308.2894; val_gene_expr_recon_loss: 9419.4770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38301.5760; val_optim_loss: 38301.5760
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9893; val_auprc_score: 0.9844; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 2602.2663; train_edge_recon_loss: 26936.6154; train_gene_expr_recon_loss: 9324.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38863.8535; train_optim_loss: 38863.8535; val_kl_reg_loss: 2594.7848; val_edge_recon_loss: 26255.6023; val_gene_expr_recon_loss: 9425.0004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38275.3871; val_optim_loss: 38275.3871

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9889; val_auprc_score: 0.9844; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 2599.3176; train_edge_recon_loss: 26901.0805; train_gene_expr_recon_loss: 9287.2938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38787.6918; train_optim_loss: 38787.6918; val_kl_reg_loss: 2567.3467; val_edge_recon_loss: 26268.1694; val_gene_expr_recon_loss: 9393.9632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38229.4796; val_optim_loss: 38229.4796
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9880; val_auprc_score: 0.9824; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 2596.9785; train_edge_recon_loss: 26901.2852; train_gene_expr_recon_loss: 9282.3634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38780.6271; train_optim_loss: 38780.6271; val_kl_reg_loss: 2568.6974; val_edge_recon_loss: 26283.8710; val_gene_expr_recon_loss: 9389.2219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38241.7901; val_optim_loss: 38241.7901
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9894; val_auprc_score: 0.9851; val_best_acc_score: 0.9664; val_best_f1_score: 0.9669; train_kl_reg_loss: 2597.8803; train_edge_recon_loss: 26892.2816; train_gene_expr_recon_loss: 9278.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38768.4287; train_optim_loss: 38768.4287; val_kl_reg_loss: 2568.1807; val_edge_recon_loss: 26249.7239; val_gene_expr_recon_loss: 9376.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38194.3525; val_optim_loss: 38194.3525
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9883; val_auprc_score: 0.9836; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 2593.8081; train_edge_recon_loss: 26908.7991; train_gene_expr_recon_loss: 9260.3676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38762.9750; train_optim_loss: 38762.9750; val_kl_reg_loss: 2568.0591; val_edge_recon_loss: 26274.6094; val_gene_expr_recon_loss: 9406.5811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38249.2495; val_optim_loss: 38249.2495
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9889; val_auprc_score: 0.9848; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 2596.4881; train_edge_recon_loss: 26901.5869; train_gene_expr_recon_loss: 9268.8392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38766.9143; train_optim_loss: 38766.9143; val_kl_reg_loss: 2579.6102; val_edge_recon_loss: 26276.3337; val_gene_expr_recon_loss: 9402.9300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38258.8738; val_optim_loss: 38258.8738
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9852; val_best_acc_score: 0.9673; val_best_f1_score: 0.9679; train_kl_reg_loss: 2598.1872; train_edge_recon_loss: 26896.7131; train_gene_expr_recon_loss: 9266.6084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38761.5087; train_optim_loss: 38761.5087; val_kl_reg_loss: 2560.2430; val_edge_recon_loss: 26214.1877; val_gene_expr_recon_loss: 9369.1544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38143.5850; val_optim_loss: 38143.5850
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9891; val_auprc_score: 0.9844; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 2598.6693; train_edge_recon_loss: 26889.0678; train_gene_expr_recon_loss: 9265.3520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38753.0891; train_optim_loss: 38753.0891; val_kl_reg_loss: 2566.2524; val_edge_recon_loss: 26261.3435; val_gene_expr_recon_loss: 9424.1313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38251.7271; val_optim_loss: 38251.7271
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9889; val_auprc_score: 0.9840; val_best_acc_score: 0.9660; val_best_f1_score: 0.9665; train_kl_reg_loss: 2598.0907; train_edge_recon_loss: 26889.2054; train_gene_expr_recon_loss: 9267.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38755.2777; train_optim_loss: 38755.2777; val_kl_reg_loss: 2568.3529; val_edge_recon_loss: 26249.7727; val_gene_expr_recon_loss: 9410.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38228.2905; val_optim_loss: 38228.2905
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9898; val_auprc_score: 0.9859; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 2598.2962; train_edge_recon_loss: 26892.7461; train_gene_expr_recon_loss: 9259.0392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38750.0815; train_optim_loss: 38750.0815; val_kl_reg_loss: 2578.5740; val_edge_recon_loss: 26227.4959; val_gene_expr_recon_loss: 9370.7332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38176.8029; val_optim_loss: 38176.8029
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9891; val_auprc_score: 0.9850; val_best_acc_score: 0.9663; val_best_f1_score: 0.9670; train_kl_reg_loss: 2598.3875; train_edge_recon_loss: 26898.4939; train_gene_expr_recon_loss: 9254.5034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38751.3847; train_optim_loss: 38751.3847; val_kl_reg_loss: 2558.3249; val_edge_recon_loss: 26246.4454; val_gene_expr_recon_loss: 9393.7169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38198.4869; val_optim_loss: 38198.4869

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9879; val_auprc_score: 0.9826; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 2596.9250; train_edge_recon_loss: 26893.8054; train_gene_expr_recon_loss: 9250.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38741.2538; train_optim_loss: 38741.2538; val_kl_reg_loss: 2570.6244; val_edge_recon_loss: 26263.9576; val_gene_expr_recon_loss: 9411.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38245.9242; val_optim_loss: 38245.9242
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9896; val_auprc_score: 0.9857; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 2596.3449; train_edge_recon_loss: 26896.7938; train_gene_expr_recon_loss: 9238.3732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38731.5120; train_optim_loss: 38731.5120; val_kl_reg_loss: 2569.9960; val_edge_recon_loss: 26193.8936; val_gene_expr_recon_loss: 9406.4719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38170.3610; val_optim_loss: 38170.3610
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9883; val_auprc_score: 0.9835; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 2598.7622; train_edge_recon_loss: 26880.5686; train_gene_expr_recon_loss: 9243.7492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38723.0802; train_optim_loss: 38723.0802; val_kl_reg_loss: 2575.3407; val_edge_recon_loss: 26254.9001; val_gene_expr_recon_loss: 9398.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38228.9313; val_optim_loss: 38228.9313
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9891; val_auprc_score: 0.9845; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 2597.3514; train_edge_recon_loss: 26885.7726; train_gene_expr_recon_loss: 9239.3361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38722.4601; train_optim_loss: 38722.4601; val_kl_reg_loss: 2574.9950; val_edge_recon_loss: 26256.3134; val_gene_expr_recon_loss: 9400.5121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38231.8207; val_optim_loss: 38231.8207

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 36 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9900
Val AUPRC score: 0.9863
Val best accuracy score: 0.9669
Val best F1 score: 0.9675
Val gene expr MSE score: 0.6630

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
