None
Run timestamp: 14072023_140535_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9895; val_auprc_score: 0.9892; val_best_acc_score: 0.9490; val_best_f1_score: 0.9491; train_kl_reg_loss: 34705.8653; train_edge_recon_loss: 2705633.3492; train_gene_expr_recon_loss: 1395880.6798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4136219.8933; train_optim_loss: 4136219.8933; val_kl_reg_loss: 26572.4872; val_edge_recon_loss: 2639391.9668; val_gene_expr_recon_loss: 1315355.2536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3981319.6946; val_optim_loss: 3981319.6946
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9937; val_auprc_score: 0.9934; val_best_acc_score: 0.9618; val_best_f1_score: 0.9619; train_kl_reg_loss: 23306.8546; train_edge_recon_loss: 2618868.8440; train_gene_expr_recon_loss: 1295273.3649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3937449.0630; train_optim_loss: 3937449.0630; val_kl_reg_loss: 20131.0855; val_edge_recon_loss: 2620639.9699; val_gene_expr_recon_loss: 1286955.1151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3927726.1780; val_optim_loss: 3927726.1780
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9948; val_auprc_score: 0.9944; val_best_acc_score: 0.9662; val_best_f1_score: 0.9663; train_kl_reg_loss: 19462.0644; train_edge_recon_loss: 2605057.4006; train_gene_expr_recon_loss: 1279383.3790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3903902.8469; train_optim_loss: 3903902.8469; val_kl_reg_loss: 18215.9231; val_edge_recon_loss: 2612333.8109; val_gene_expr_recon_loss: 1276214.3204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3906764.0498; val_optim_loss: 3906764.0498
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9951; val_auprc_score: 0.9946; val_best_acc_score: 0.9672; val_best_f1_score: 0.9674; train_kl_reg_loss: 17650.6131; train_edge_recon_loss: 2598391.6923; train_gene_expr_recon_loss: 1271929.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3887971.5706; train_optim_loss: 3887971.5706; val_kl_reg_loss: 16753.2294; val_edge_recon_loss: 2605814.8908; val_gene_expr_recon_loss: 1274905.2603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3897473.3782; val_optim_loss: 3897473.3782
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9717; val_best_f1_score: 0.9718; train_kl_reg_loss: 16641.5942; train_edge_recon_loss: 2593935.0261; train_gene_expr_recon_loss: 1268180.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3878756.6469; train_optim_loss: 3878756.6469; val_kl_reg_loss: 15879.7823; val_edge_recon_loss: 2602594.4889; val_gene_expr_recon_loss: 1271678.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3890152.7215; val_optim_loss: 3890152.7215
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 16047.0843; train_edge_recon_loss: 2591191.1050; train_gene_expr_recon_loss: 1265255.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3872493.2830; train_optim_loss: 3872493.2830; val_kl_reg_loss: 15746.6790; val_edge_recon_loss: 2598882.9984; val_gene_expr_recon_loss: 1270376.5819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3885006.2682; val_optim_loss: 3885006.2682
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 15687.1211; train_edge_recon_loss: 2587769.4805; train_gene_expr_recon_loss: 1262817.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3866273.7286; train_optim_loss: 3866273.7286; val_kl_reg_loss: 15223.6329; val_edge_recon_loss: 2596864.4565; val_gene_expr_recon_loss: 1267235.1895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3879323.2888; val_optim_loss: 3879323.2888
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 15407.4919; train_edge_recon_loss: 2586762.5544; train_gene_expr_recon_loss: 1261173.6093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3863343.6522; train_optim_loss: 3863343.6522; val_kl_reg_loss: 15218.3891; val_edge_recon_loss: 2596409.0902; val_gene_expr_recon_loss: 1266218.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3877846.3212; val_optim_loss: 3877846.3212
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 15182.3296; train_edge_recon_loss: 2585416.1688; train_gene_expr_recon_loss: 1259492.0049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3860090.4997; train_optim_loss: 3860090.4997; val_kl_reg_loss: 14987.0786; val_edge_recon_loss: 2594222.2682; val_gene_expr_recon_loss: 1266202.2350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3875411.5767; val_optim_loss: 3875411.5767
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 15024.3137; train_edge_recon_loss: 2583938.2409; train_gene_expr_recon_loss: 1258374.6270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3857337.1821; train_optim_loss: 3857337.1821; val_kl_reg_loss: 14661.6440; val_edge_recon_loss: 2593811.9185; val_gene_expr_recon_loss: 1264147.1511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3872620.7247; val_optim_loss: 3872620.7247
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 14914.6203; train_edge_recon_loss: 2583048.7771; train_gene_expr_recon_loss: 1257374.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3855337.4702; train_optim_loss: 3855337.4702; val_kl_reg_loss: 14623.9896; val_edge_recon_loss: 2592357.5182; val_gene_expr_recon_loss: 1264003.3877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3870984.8979; val_optim_loss: 3870984.8979
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 14755.2603; train_edge_recon_loss: 2582289.4347; train_gene_expr_recon_loss: 1256444.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3853489.5382; train_optim_loss: 3853489.5382; val_kl_reg_loss: 14641.6753; val_edge_recon_loss: 2591551.9059; val_gene_expr_recon_loss: 1264201.4316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3870395.0134; val_optim_loss: 3870395.0134
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 14664.6977; train_edge_recon_loss: 2580808.9835; train_gene_expr_recon_loss: 1255484.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3850957.7136; train_optim_loss: 3850957.7136; val_kl_reg_loss: 14453.6173; val_edge_recon_loss: 2591677.8070; val_gene_expr_recon_loss: 1263322.8081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3869454.2334; val_optim_loss: 3869454.2334
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 14573.0505; train_edge_recon_loss: 2579997.2387; train_gene_expr_recon_loss: 1255240.8298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3849811.1174; train_optim_loss: 3849811.1174; val_kl_reg_loss: 14292.6197; val_edge_recon_loss: 2589253.0316; val_gene_expr_recon_loss: 1263049.6741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3866595.3212; val_optim_loss: 3866595.3212
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 14474.1163; train_edge_recon_loss: 2579887.3093; train_gene_expr_recon_loss: 1254497.9277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3848859.3519; train_optim_loss: 3848859.3519; val_kl_reg_loss: 14176.4810; val_edge_recon_loss: 2590337.8908; val_gene_expr_recon_loss: 1264380.2385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3868894.6187; val_optim_loss: 3868894.6187
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9788; val_best_f1_score: 0.9788; train_kl_reg_loss: 14449.0774; train_edge_recon_loss: 2578743.4448; train_gene_expr_recon_loss: 1254398.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3847590.6151; train_optim_loss: 3847590.6151; val_kl_reg_loss: 14101.8828; val_edge_recon_loss: 2589307.9264; val_gene_expr_recon_loss: 1264050.3034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3867460.1076; val_optim_loss: 3867460.1076
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 14362.4737; train_edge_recon_loss: 2578336.1404; train_gene_expr_recon_loss: 1253802.4116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3846501.0255; train_optim_loss: 3846501.0255; val_kl_reg_loss: 14292.4604; val_edge_recon_loss: 2588803.2413; val_gene_expr_recon_loss: 1261302.8536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3864398.5570; val_optim_loss: 3864398.5570
