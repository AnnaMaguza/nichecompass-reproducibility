None
Run timestamp: 01072023_083823_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9413; val_auprc_score: 0.9294; val_best_acc_score: 0.8724; val_best_f1_score: 0.8778; train_kl_reg_loss: 3461.5110; train_edge_recon_loss: 29803.3467; train_gene_expr_recon_loss: 75230.2521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108495.1098; train_optim_loss: 108495.1098; val_kl_reg_loss: 3059.5052; val_edge_recon_loss: 28860.3034; val_gene_expr_recon_loss: 68883.3642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100803.1729; val_optim_loss: 100803.1729
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9532; val_auprc_score: 0.9424; val_best_acc_score: 0.8903; val_best_f1_score: 0.8951; train_kl_reg_loss: 3110.9593; train_edge_recon_loss: 28665.5259; train_gene_expr_recon_loss: 67174.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98951.3624; train_optim_loss: 98951.3624; val_kl_reg_loss: 3038.0435; val_edge_recon_loss: 28271.8572; val_gene_expr_recon_loss: 65539.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96849.7470; val_optim_loss: 96849.7470
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9600; val_auprc_score: 0.9509; val_best_acc_score: 0.9009; val_best_f1_score: 0.9048; train_kl_reg_loss: 3055.8236; train_edge_recon_loss: 28357.0420; train_gene_expr_recon_loss: 64684.6144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96097.4801; train_optim_loss: 96097.4801; val_kl_reg_loss: 2963.2553; val_edge_recon_loss: 28253.2647; val_gene_expr_recon_loss: 63583.0303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94799.5501; val_optim_loss: 94799.5501
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9633; val_auprc_score: 0.9560; val_best_acc_score: 0.9050; val_best_f1_score: 0.9088; train_kl_reg_loss: 3046.2374; train_edge_recon_loss: 28192.0259; train_gene_expr_recon_loss: 63303.3743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94541.6375; train_optim_loss: 94541.6375; val_kl_reg_loss: 2962.6374; val_edge_recon_loss: 28094.4332; val_gene_expr_recon_loss: 62589.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93646.9981; val_optim_loss: 93646.9981
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9656; val_auprc_score: 0.9592; val_best_acc_score: 0.9071; val_best_f1_score: 0.9104; train_kl_reg_loss: 3058.8896; train_edge_recon_loss: 28075.2993; train_gene_expr_recon_loss: 62362.3297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93496.5187; train_optim_loss: 93496.5187; val_kl_reg_loss: 2983.0493; val_edge_recon_loss: 28051.2146; val_gene_expr_recon_loss: 61711.5732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92745.8370; val_optim_loss: 92745.8370
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9661; val_auprc_score: 0.9596; val_best_acc_score: 0.9083; val_best_f1_score: 0.9111; train_kl_reg_loss: 3066.3416; train_edge_recon_loss: 28006.5809; train_gene_expr_recon_loss: 61802.2104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92875.1329; train_optim_loss: 92875.1329; val_kl_reg_loss: 3010.0492; val_edge_recon_loss: 27994.2616; val_gene_expr_recon_loss: 61333.5081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92337.8189; val_optim_loss: 92337.8189
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9674; val_auprc_score: 0.9609; val_best_acc_score: 0.9097; val_best_f1_score: 0.9128; train_kl_reg_loss: 3076.0999; train_edge_recon_loss: 27950.8847; train_gene_expr_recon_loss: 61306.0942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92333.0790; train_optim_loss: 92333.0790; val_kl_reg_loss: 2984.1342; val_edge_recon_loss: 27974.8829; val_gene_expr_recon_loss: 61157.9929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92117.0097; val_optim_loss: 92117.0097
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9682; val_auprc_score: 0.9615; val_best_acc_score: 0.9122; val_best_f1_score: 0.9152; train_kl_reg_loss: 3081.5253; train_edge_recon_loss: 27896.7280; train_gene_expr_recon_loss: 61033.5060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92011.7594; train_optim_loss: 92011.7594; val_kl_reg_loss: 3057.5219; val_edge_recon_loss: 27877.0860; val_gene_expr_recon_loss: 60660.4354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91595.0431; val_optim_loss: 91595.0431
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9681; val_auprc_score: 0.9617; val_best_acc_score: 0.9115; val_best_f1_score: 0.9148; train_kl_reg_loss: 3086.3228; train_edge_recon_loss: 27866.4611; train_gene_expr_recon_loss: 60792.7511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91745.5349; train_optim_loss: 91745.5349; val_kl_reg_loss: 3032.9529; val_edge_recon_loss: 27870.5157; val_gene_expr_recon_loss: 60642.9362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91546.4051; val_optim_loss: 91546.4051
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9680; val_auprc_score: 0.9612; val_best_acc_score: 0.9115; val_best_f1_score: 0.9145; train_kl_reg_loss: 3090.3046; train_edge_recon_loss: 27831.8435; train_gene_expr_recon_loss: 60631.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91553.3097; train_optim_loss: 91553.3097; val_kl_reg_loss: 3020.7702; val_edge_recon_loss: 27846.9159; val_gene_expr_recon_loss: 60442.0963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91309.7825; val_optim_loss: 91309.7825
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9692; val_auprc_score: 0.9633; val_best_acc_score: 0.9137; val_best_f1_score: 0.9162; train_kl_reg_loss: 3091.8066; train_edge_recon_loss: 27819.2968; train_gene_expr_recon_loss: 60494.4714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91405.5747; train_optim_loss: 91405.5747; val_kl_reg_loss: 3019.4526; val_edge_recon_loss: 27867.9137; val_gene_expr_recon_loss: 60407.1963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91294.5626; val_optim_loss: 91294.5626
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9706; val_auprc_score: 0.9658; val_best_acc_score: 0.9147; val_best_f1_score: 0.9174; train_kl_reg_loss: 3094.0997; train_edge_recon_loss: 27788.2187; train_gene_expr_recon_loss: 60378.8572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91261.1756; train_optim_loss: 91261.1756; val_kl_reg_loss: 3015.2743; val_edge_recon_loss: 27811.9425; val_gene_expr_recon_loss: 60457.8978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91285.1147; val_optim_loss: 91285.1147
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9704; val_auprc_score: 0.9646; val_best_acc_score: 0.9156; val_best_f1_score: 0.9185; train_kl_reg_loss: 3099.0085; train_edge_recon_loss: 27751.5373; train_gene_expr_recon_loss: 60281.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91131.9518; train_optim_loss: 91131.9518; val_kl_reg_loss: 3025.3254; val_edge_recon_loss: 27765.1508; val_gene_expr_recon_loss: 60227.5728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91018.0489; val_optim_loss: 91018.0489
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9720; val_auprc_score: 0.9672; val_best_acc_score: 0.9157; val_best_f1_score: 0.9188; train_kl_reg_loss: 3102.4749; train_edge_recon_loss: 27734.2490; train_gene_expr_recon_loss: 60202.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91039.3946; train_optim_loss: 91039.3946; val_kl_reg_loss: 3031.9888; val_edge_recon_loss: 27813.6086; val_gene_expr_recon_loss: 59993.4933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90839.0908; val_optim_loss: 90839.0908
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9714; val_auprc_score: 0.9658; val_best_acc_score: 0.9176; val_best_f1_score: 0.9205; train_kl_reg_loss: 3100.6866; train_edge_recon_loss: 27722.6918; train_gene_expr_recon_loss: 60117.0785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90940.4569; train_optim_loss: 90940.4569; val_kl_reg_loss: 3042.2073; val_edge_recon_loss: 27745.2212; val_gene_expr_recon_loss: 60217.8608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91005.2897; val_optim_loss: 91005.2897
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9705; val_auprc_score: 0.9644; val_best_acc_score: 0.9166; val_best_f1_score: 0.9198; train_kl_reg_loss: 3103.4065; train_edge_recon_loss: 27700.1583; train_gene_expr_recon_loss: 60075.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90879.1057; train_optim_loss: 90879.1057; val_kl_reg_loss: 3083.0021; val_edge_recon_loss: 27730.3583; val_gene_expr_recon_loss: 60085.3420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90898.7027; val_optim_loss: 90898.7027
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9716; val_auprc_score: 0.9663; val_best_acc_score: 0.9183; val_best_f1_score: 0.9203; train_kl_reg_loss: 3104.3030; train_edge_recon_loss: 27691.1200; train_gene_expr_recon_loss: 60007.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90803.2159; train_optim_loss: 90803.2159; val_kl_reg_loss: 3013.0426; val_edge_recon_loss: 27701.4974; val_gene_expr_recon_loss: 60064.5362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90779.0761; val_optim_loss: 90779.0761
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9718; val_auprc_score: 0.9667; val_best_acc_score: 0.9176; val_best_f1_score: 0.9200; train_kl_reg_loss: 3103.5350; train_edge_recon_loss: 27677.9061; train_gene_expr_recon_loss: 59960.1194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90741.5603; train_optim_loss: 90741.5603; val_kl_reg_loss: 3007.0846; val_edge_recon_loss: 27766.6847; val_gene_expr_recon_loss: 59991.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90764.7905; val_optim_loss: 90764.7905
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9727; val_auprc_score: 0.9677; val_best_acc_score: 0.9190; val_best_f1_score: 0.9217; train_kl_reg_loss: 3107.7454; train_edge_recon_loss: 27660.1163; train_gene_expr_recon_loss: 59921.1144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90688.9760; train_optim_loss: 90688.9760; val_kl_reg_loss: 3019.8757; val_edge_recon_loss: 27661.8874; val_gene_expr_recon_loss: 59924.1257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90605.8886; val_optim_loss: 90605.8886
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9721; val_auprc_score: 0.9668; val_best_acc_score: 0.9188; val_best_f1_score: 0.9217; train_kl_reg_loss: 3107.3387; train_edge_recon_loss: 27652.6304; train_gene_expr_recon_loss: 59896.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90656.0750; train_optim_loss: 90656.0750; val_kl_reg_loss: 3069.8689; val_edge_recon_loss: 27672.5484; val_gene_expr_recon_loss: 59879.0553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90621.4725; val_optim_loss: 90621.4725
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9728; val_auprc_score: 0.9682; val_best_acc_score: 0.9189; val_best_f1_score: 0.9210; train_kl_reg_loss: 3108.0250; train_edge_recon_loss: 27635.0083; train_gene_expr_recon_loss: 59862.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90605.6377; train_optim_loss: 90605.6377; val_kl_reg_loss: 3004.5819; val_edge_recon_loss: 27714.9418; val_gene_expr_recon_loss: 59810.4606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90529.9840; val_optim_loss: 90529.9840
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9720; val_auprc_score: 0.9667; val_best_acc_score: 0.9187; val_best_f1_score: 0.9213; train_kl_reg_loss: 3106.8041; train_edge_recon_loss: 27640.4339; train_gene_expr_recon_loss: 59857.1572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90604.3953; train_optim_loss: 90604.3953; val_kl_reg_loss: 3048.3651; val_edge_recon_loss: 27688.0667; val_gene_expr_recon_loss: 59880.2921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90616.7236; val_optim_loss: 90616.7236
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9728; val_auprc_score: 0.9679; val_best_acc_score: 0.9195; val_best_f1_score: 0.9214; train_kl_reg_loss: 3102.7569; train_edge_recon_loss: 27648.2538; train_gene_expr_recon_loss: 59806.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90557.9133; train_optim_loss: 90557.9133; val_kl_reg_loss: 2998.2051; val_edge_recon_loss: 27694.5754; val_gene_expr_recon_loss: 59800.0514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90492.8323; val_optim_loss: 90492.8323
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9735; val_auprc_score: 0.9690; val_best_acc_score: 0.9204; val_best_f1_score: 0.9231; train_kl_reg_loss: 3110.4965; train_edge_recon_loss: 27608.8086; train_gene_expr_recon_loss: 59792.2503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90511.5555; train_optim_loss: 90511.5555; val_kl_reg_loss: 3010.5417; val_edge_recon_loss: 27612.1454; val_gene_expr_recon_loss: 59875.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90497.9728; val_optim_loss: 90497.9728
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9726; val_auprc_score: 0.9677; val_best_acc_score: 0.9193; val_best_f1_score: 0.9219; train_kl_reg_loss: 3107.1550; train_edge_recon_loss: 27618.3970; train_gene_expr_recon_loss: 59719.7992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90445.3513; train_optim_loss: 90445.3513; val_kl_reg_loss: 3058.8401; val_edge_recon_loss: 27637.3546; val_gene_expr_recon_loss: 59766.4406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90462.6350; val_optim_loss: 90462.6350
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9726; val_auprc_score: 0.9670; val_best_acc_score: 0.9203; val_best_f1_score: 0.9229; train_kl_reg_loss: 3110.4188; train_edge_recon_loss: 27595.0840; train_gene_expr_recon_loss: 59726.7323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90432.2350; train_optim_loss: 90432.2350; val_kl_reg_loss: 3043.3283; val_edge_recon_loss: 27638.3050; val_gene_expr_recon_loss: 59851.7254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90533.3587; val_optim_loss: 90533.3587
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9725; val_auprc_score: 0.9675; val_best_acc_score: 0.9181; val_best_f1_score: 0.9209; train_kl_reg_loss: 3108.9374; train_edge_recon_loss: 27607.5707; train_gene_expr_recon_loss: 59710.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90427.0537; train_optim_loss: 90427.0537; val_kl_reg_loss: 3095.4021; val_edge_recon_loss: 27620.4777; val_gene_expr_recon_loss: 59715.9843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90431.8641; val_optim_loss: 90431.8641
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9732; val_auprc_score: 0.9684; val_best_acc_score: 0.9191; val_best_f1_score: 0.9218; train_kl_reg_loss: 3111.7174; train_edge_recon_loss: 27584.3911; train_gene_expr_recon_loss: 59663.4052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90359.5139; train_optim_loss: 90359.5139; val_kl_reg_loss: 3009.4376; val_edge_recon_loss: 27666.3170; val_gene_expr_recon_loss: 59823.6362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90499.3909; val_optim_loss: 90499.3909
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9724; val_auprc_score: 0.9669; val_best_acc_score: 0.9201; val_best_f1_score: 0.9229; train_kl_reg_loss: 3109.8085; train_edge_recon_loss: 27581.0760; train_gene_expr_recon_loss: 59700.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90391.6881; train_optim_loss: 90391.6881; val_kl_reg_loss: 3042.9332; val_edge_recon_loss: 27654.0938; val_gene_expr_recon_loss: 59747.8587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90444.8857; val_optim_loss: 90444.8857
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9731; val_auprc_score: 0.9685; val_best_acc_score: 0.9195; val_best_f1_score: 0.9223; train_kl_reg_loss: 3109.4380; train_edge_recon_loss: 27584.0215; train_gene_expr_recon_loss: 59653.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90347.2222; train_optim_loss: 90347.2222; val_kl_reg_loss: 3047.6581; val_edge_recon_loss: 27629.1400; val_gene_expr_recon_loss: 59676.5019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90353.3000; val_optim_loss: 90353.3000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9738; val_auprc_score: 0.9693; val_best_acc_score: 0.9205; val_best_f1_score: 0.9233; train_kl_reg_loss: 3111.5631; train_edge_recon_loss: 27576.5180; train_gene_expr_recon_loss: 59644.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90332.9861; train_optim_loss: 90332.9861; val_kl_reg_loss: 3062.9224; val_edge_recon_loss: 27591.8604; val_gene_expr_recon_loss: 59679.1593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90333.9426; val_optim_loss: 90333.9426
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9740; val_auprc_score: 0.9693; val_best_acc_score: 0.9222; val_best_f1_score: 0.9245; train_kl_reg_loss: 3109.1920; train_edge_recon_loss: 27578.1846; train_gene_expr_recon_loss: 59609.9322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90297.3086; train_optim_loss: 90297.3086; val_kl_reg_loss: 3043.5736; val_edge_recon_loss: 27608.6314; val_gene_expr_recon_loss: 59666.6049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90318.8095; val_optim_loss: 90318.8095
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9729; val_auprc_score: 0.9677; val_best_acc_score: 0.9209; val_best_f1_score: 0.9236; train_kl_reg_loss: 3108.4313; train_edge_recon_loss: 27574.7364; train_gene_expr_recon_loss: 59572.3907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90255.5584; train_optim_loss: 90255.5584; val_kl_reg_loss: 3056.8135; val_edge_recon_loss: 27643.5089; val_gene_expr_recon_loss: 59620.3745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90320.6969; val_optim_loss: 90320.6969
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9728; val_auprc_score: 0.9670; val_best_acc_score: 0.9213; val_best_f1_score: 0.9238; train_kl_reg_loss: 3108.2627; train_edge_recon_loss: 27572.1876; train_gene_expr_recon_loss: 59592.1471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90272.5974; train_optim_loss: 90272.5974; val_kl_reg_loss: 3018.3656; val_edge_recon_loss: 27594.9840; val_gene_expr_recon_loss: 59726.3018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90339.6515; val_optim_loss: 90339.6515
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9732; val_auprc_score: 0.9682; val_best_acc_score: 0.9207; val_best_f1_score: 0.9234; train_kl_reg_loss: 3109.0228; train_edge_recon_loss: 27562.2127; train_gene_expr_recon_loss: 59594.2839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90265.5194; train_optim_loss: 90265.5194; val_kl_reg_loss: 3032.8880; val_edge_recon_loss: 27595.9332; val_gene_expr_recon_loss: 59825.1329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90453.9544; val_optim_loss: 90453.9544
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9722; val_auprc_score: 0.9669; val_best_acc_score: 0.9195; val_best_f1_score: 0.9224; train_kl_reg_loss: 3107.4632; train_edge_recon_loss: 27560.1738; train_gene_expr_recon_loss: 59566.3975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90234.0344; train_optim_loss: 90234.0344; val_kl_reg_loss: 3107.5806; val_edge_recon_loss: 27593.8822; val_gene_expr_recon_loss: 59780.4740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90481.9369; val_optim_loss: 90481.9369

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9740; val_auprc_score: 0.9694; val_best_acc_score: 0.9224; val_best_f1_score: 0.9251; train_kl_reg_loss: 3092.7476; train_edge_recon_loss: 27516.9422; train_gene_expr_recon_loss: 59210.0904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89819.7801; train_optim_loss: 89819.7801; val_kl_reg_loss: 3024.0334; val_edge_recon_loss: 27522.9663; val_gene_expr_recon_loss: 59381.0884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89928.0890; val_optim_loss: 89928.0890
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9740; val_auprc_score: 0.9687; val_best_acc_score: 0.9227; val_best_f1_score: 0.9253; train_kl_reg_loss: 3085.7985; train_edge_recon_loss: 27527.3678; train_gene_expr_recon_loss: 59179.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89792.9593; train_optim_loss: 89792.9593; val_kl_reg_loss: 3016.9609; val_edge_recon_loss: 27554.2652; val_gene_expr_recon_loss: 59364.3733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89935.5995; val_optim_loss: 89935.5995
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9731; val_auprc_score: 0.9680; val_best_acc_score: 0.9220; val_best_f1_score: 0.9245; train_kl_reg_loss: 3085.7726; train_edge_recon_loss: 27510.7862; train_gene_expr_recon_loss: 59173.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89770.0908; train_optim_loss: 89770.0908; val_kl_reg_loss: 3011.6487; val_edge_recon_loss: 27563.2149; val_gene_expr_recon_loss: 59378.6463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89953.5096; val_optim_loss: 89953.5096
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9747; val_auprc_score: 0.9706; val_best_acc_score: 0.9222; val_best_f1_score: 0.9246; train_kl_reg_loss: 3084.6708; train_edge_recon_loss: 27507.5872; train_gene_expr_recon_loss: 59157.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89749.6607; train_optim_loss: 89749.6607; val_kl_reg_loss: 3003.9721; val_edge_recon_loss: 27562.2242; val_gene_expr_recon_loss: 59313.8623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89880.0587; val_optim_loss: 89880.0587
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9744; val_auprc_score: 0.9698; val_best_acc_score: 0.9236; val_best_f1_score: 0.9259; train_kl_reg_loss: 3080.2685; train_edge_recon_loss: 27521.5852; train_gene_expr_recon_loss: 59179.9342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89781.7879; train_optim_loss: 89781.7879; val_kl_reg_loss: 3014.7289; val_edge_recon_loss: 27531.0187; val_gene_expr_recon_loss: 59580.4223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90126.1697; val_optim_loss: 90126.1697
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9735; val_auprc_score: 0.9688; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 3079.2342; train_edge_recon_loss: 27523.9351; train_gene_expr_recon_loss: 59159.7253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89762.8947; train_optim_loss: 89762.8947; val_kl_reg_loss: 3022.8684; val_edge_recon_loss: 27570.7725; val_gene_expr_recon_loss: 59463.8868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90057.5279; val_optim_loss: 90057.5279
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9743; val_auprc_score: 0.9695; val_best_acc_score: 0.9227; val_best_f1_score: 0.9251; train_kl_reg_loss: 3077.7179; train_edge_recon_loss: 27518.3810; train_gene_expr_recon_loss: 59140.7509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89736.8497; train_optim_loss: 89736.8497; val_kl_reg_loss: 3019.9202; val_edge_recon_loss: 27533.5435; val_gene_expr_recon_loss: 59237.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89790.9071; val_optim_loss: 89790.9071
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9737; val_auprc_score: 0.9690; val_best_acc_score: 0.9227; val_best_f1_score: 0.9250; train_kl_reg_loss: 3078.9087; train_edge_recon_loss: 27520.9890; train_gene_expr_recon_loss: 59141.9675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89741.8654; train_optim_loss: 89741.8654; val_kl_reg_loss: 3013.8734; val_edge_recon_loss: 27556.6012; val_gene_expr_recon_loss: 59428.1765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89998.6508; val_optim_loss: 89998.6508
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9740; val_auprc_score: 0.9692; val_best_acc_score: 0.9226; val_best_f1_score: 0.9251; train_kl_reg_loss: 3082.3050; train_edge_recon_loss: 27502.6073; train_gene_expr_recon_loss: 59149.7725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89734.6848; train_optim_loss: 89734.6848; val_kl_reg_loss: 3028.1844; val_edge_recon_loss: 27511.5553; val_gene_expr_recon_loss: 59369.6479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89909.3877; val_optim_loss: 89909.3877
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9740; val_auprc_score: 0.9692; val_best_acc_score: 0.9216; val_best_f1_score: 0.9238; train_kl_reg_loss: 3075.6446; train_edge_recon_loss: 27527.0941; train_gene_expr_recon_loss: 59138.5543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89741.2931; train_optim_loss: 89741.2931; val_kl_reg_loss: 3019.8320; val_edge_recon_loss: 27572.1486; val_gene_expr_recon_loss: 59429.9716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90021.9520; val_optim_loss: 90021.9520
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9740; val_auprc_score: 0.9692; val_best_acc_score: 0.9220; val_best_f1_score: 0.9245; train_kl_reg_loss: 3081.6302; train_edge_recon_loss: 27500.1219; train_gene_expr_recon_loss: 59125.2704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89707.0225; train_optim_loss: 89707.0225; val_kl_reg_loss: 3031.7081; val_edge_recon_loss: 27574.6815; val_gene_expr_recon_loss: 59265.4434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89871.8332; val_optim_loss: 89871.8332

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9741; val_auprc_score: 0.9692; val_best_acc_score: 0.9223; val_best_f1_score: 0.9247; train_kl_reg_loss: 3076.2233; train_edge_recon_loss: 27522.6090; train_gene_expr_recon_loss: 59076.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89675.2635; train_optim_loss: 89675.2635; val_kl_reg_loss: 3008.7987; val_edge_recon_loss: 27562.2060; val_gene_expr_recon_loss: 59281.5203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89852.5254; val_optim_loss: 89852.5254
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9739; val_auprc_score: 0.9689; val_best_acc_score: 0.9220; val_best_f1_score: 0.9244; train_kl_reg_loss: 3075.9364; train_edge_recon_loss: 27507.9088; train_gene_expr_recon_loss: 59099.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89683.2943; train_optim_loss: 89683.2943; val_kl_reg_loss: 3013.1059; val_edge_recon_loss: 27545.4600; val_gene_expr_recon_loss: 59387.4014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89945.9670; val_optim_loss: 89945.9670
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9745; val_auprc_score: 0.9698; val_best_acc_score: 0.9232; val_best_f1_score: 0.9255; train_kl_reg_loss: 3076.7732; train_edge_recon_loss: 27504.9061; train_gene_expr_recon_loss: 59097.9603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89679.6395; train_optim_loss: 89679.6395; val_kl_reg_loss: 3017.6927; val_edge_recon_loss: 27526.6016; val_gene_expr_recon_loss: 59373.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89917.3756; val_optim_loss: 89917.3756
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9742; val_auprc_score: 0.9695; val_best_acc_score: 0.9222; val_best_f1_score: 0.9249; train_kl_reg_loss: 3078.6212; train_edge_recon_loss: 27498.0975; train_gene_expr_recon_loss: 59062.5589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89639.2778; train_optim_loss: 89639.2778; val_kl_reg_loss: 3013.9910; val_edge_recon_loss: 27559.7372; val_gene_expr_recon_loss: 59233.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89806.8582; val_optim_loss: 89806.8582

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 87 min 40 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9748
Val AUPRC score: 0.9706
Val best accuracy score: 0.9233
Val best F1 score: 0.9254
Val gene expr MSE score: 1.4029

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
