None
Run timestamp: 01072023_212311_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9418; val_auprc_score: 0.9304; val_best_acc_score: 0.8744; val_best_f1_score: 0.8795; train_kl_reg_loss: 3716.7701; train_edge_recon_loss: 29976.3530; train_gene_expr_recon_loss: 75760.3364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109453.4595; train_optim_loss: 109453.4595; val_kl_reg_loss: 3205.9542; val_edge_recon_loss: 28951.4712; val_gene_expr_recon_loss: 69137.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101294.6550; val_optim_loss: 101294.6550
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9585; val_auprc_score: 0.9492; val_best_acc_score: 0.8987; val_best_f1_score: 0.9023; train_kl_reg_loss: 3182.5402; train_edge_recon_loss: 28744.8795; train_gene_expr_recon_loss: 67231.2267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99158.6465; train_optim_loss: 99158.6465; val_kl_reg_loss: 3065.2696; val_edge_recon_loss: 28399.8720; val_gene_expr_recon_loss: 65446.5896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96911.7314; val_optim_loss: 96911.7314
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9625; val_auprc_score: 0.9549; val_best_acc_score: 0.9035; val_best_f1_score: 0.9069; train_kl_reg_loss: 3080.6318; train_edge_recon_loss: 28393.1241; train_gene_expr_recon_loss: 64612.9505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96086.7065; train_optim_loss: 96086.7065; val_kl_reg_loss: 2941.1596; val_edge_recon_loss: 28244.1669; val_gene_expr_recon_loss: 63545.5793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94730.9060; val_optim_loss: 94730.9060
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9638; val_auprc_score: 0.9563; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 3054.8356; train_edge_recon_loss: 28204.4304; train_gene_expr_recon_loss: 63041.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94300.5439; train_optim_loss: 94300.5439; val_kl_reg_loss: 2973.5960; val_edge_recon_loss: 28127.1219; val_gene_expr_recon_loss: 62215.0012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93315.7196; val_optim_loss: 93315.7196
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9664; val_auprc_score: 0.9593; val_best_acc_score: 0.9099; val_best_f1_score: 0.9132; train_kl_reg_loss: 3048.0437; train_edge_recon_loss: 28098.6872; train_gene_expr_recon_loss: 62012.9475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93159.6784; train_optim_loss: 93159.6784; val_kl_reg_loss: 3009.2310; val_edge_recon_loss: 28088.0942; val_gene_expr_recon_loss: 61557.3023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92654.6273; val_optim_loss: 92654.6273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9690; val_auprc_score: 0.9621; val_best_acc_score: 0.9152; val_best_f1_score: 0.9181; train_kl_reg_loss: 3052.4089; train_edge_recon_loss: 28008.6555; train_gene_expr_recon_loss: 61388.7882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92449.8527; train_optim_loss: 92449.8527; val_kl_reg_loss: 2955.5982; val_edge_recon_loss: 27960.1548; val_gene_expr_recon_loss: 61092.5228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92008.2758; val_optim_loss: 92008.2758
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9687; val_auprc_score: 0.9614; val_best_acc_score: 0.9163; val_best_f1_score: 0.9189; train_kl_reg_loss: 3059.8829; train_edge_recon_loss: 27947.7486; train_gene_expr_recon_loss: 60882.3772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91890.0087; train_optim_loss: 91890.0087; val_kl_reg_loss: 2971.3979; val_edge_recon_loss: 27886.7531; val_gene_expr_recon_loss: 60584.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91442.5907; val_optim_loss: 91442.5907
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9687; val_auprc_score: 0.9614; val_best_acc_score: 0.9168; val_best_f1_score: 0.9197; train_kl_reg_loss: 3066.6040; train_edge_recon_loss: 27870.5870; train_gene_expr_recon_loss: 60594.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91532.1051; train_optim_loss: 91532.1051; val_kl_reg_loss: 3036.6484; val_edge_recon_loss: 27892.6490; val_gene_expr_recon_loss: 60138.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91067.6339; val_optim_loss: 91067.6339
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9696; val_auprc_score: 0.9628; val_best_acc_score: 0.9163; val_best_f1_score: 0.9188; train_kl_reg_loss: 3064.3835; train_edge_recon_loss: 27842.7248; train_gene_expr_recon_loss: 60311.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91218.8550; train_optim_loss: 91218.8550; val_kl_reg_loss: 3004.1153; val_edge_recon_loss: 27850.9804; val_gene_expr_recon_loss: 60165.1313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91020.2269; val_optim_loss: 91020.2269
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9718; val_auprc_score: 0.9662; val_best_acc_score: 0.9184; val_best_f1_score: 0.9208; train_kl_reg_loss: 3065.6223; train_edge_recon_loss: 27786.9470; train_gene_expr_recon_loss: 60108.0131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90960.5822; train_optim_loss: 90960.5822; val_kl_reg_loss: 2956.7862; val_edge_recon_loss: 27829.9757; val_gene_expr_recon_loss: 59988.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90775.3429; val_optim_loss: 90775.3429
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9702; val_auprc_score: 0.9631; val_best_acc_score: 0.9198; val_best_f1_score: 0.9226; train_kl_reg_loss: 3064.3961; train_edge_recon_loss: 27770.0657; train_gene_expr_recon_loss: 59999.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90834.2301; train_optim_loss: 90834.2301; val_kl_reg_loss: 2998.3775; val_edge_recon_loss: 27787.9710; val_gene_expr_recon_loss: 59887.2342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90673.5829; val_optim_loss: 90673.5829
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9716; val_auprc_score: 0.9658; val_best_acc_score: 0.9195; val_best_f1_score: 0.9220; train_kl_reg_loss: 3062.4882; train_edge_recon_loss: 27740.2618; train_gene_expr_recon_loss: 59846.8823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90649.6323; train_optim_loss: 90649.6323; val_kl_reg_loss: 2969.9121; val_edge_recon_loss: 27683.0814; val_gene_expr_recon_loss: 59812.8708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90465.8643; val_optim_loss: 90465.8643
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9724; val_auprc_score: 0.9668; val_best_acc_score: 0.9208; val_best_f1_score: 0.9230; train_kl_reg_loss: 3059.2848; train_edge_recon_loss: 27731.2814; train_gene_expr_recon_loss: 59768.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90558.6924; train_optim_loss: 90558.6924; val_kl_reg_loss: 3014.1486; val_edge_recon_loss: 27737.5652; val_gene_expr_recon_loss: 59792.7692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90544.4832; val_optim_loss: 90544.4832
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9709; val_auprc_score: 0.9641; val_best_acc_score: 0.9208; val_best_f1_score: 0.9231; train_kl_reg_loss: 3060.3586; train_edge_recon_loss: 27702.4841; train_gene_expr_recon_loss: 59683.5976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90446.4401; train_optim_loss: 90446.4401; val_kl_reg_loss: 3036.5450; val_edge_recon_loss: 27704.1334; val_gene_expr_recon_loss: 59746.7040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90487.3819; val_optim_loss: 90487.3819
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9732; val_auprc_score: 0.9682; val_best_acc_score: 0.9225; val_best_f1_score: 0.9248; train_kl_reg_loss: 3056.9892; train_edge_recon_loss: 27698.4415; train_gene_expr_recon_loss: 59625.1697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90380.6004; train_optim_loss: 90380.6004; val_kl_reg_loss: 2985.4107; val_edge_recon_loss: 27709.9542; val_gene_expr_recon_loss: 59532.0692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90227.4341; val_optim_loss: 90227.4341
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9731; val_auprc_score: 0.9681; val_best_acc_score: 0.9199; val_best_f1_score: 0.9229; train_kl_reg_loss: 3060.7330; train_edge_recon_loss: 27668.0231; train_gene_expr_recon_loss: 59562.5506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90291.3067; train_optim_loss: 90291.3067; val_kl_reg_loss: 2947.9477; val_edge_recon_loss: 27724.6404; val_gene_expr_recon_loss: 59507.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90179.6759; val_optim_loss: 90179.6759
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9740; val_auprc_score: 0.9691; val_best_acc_score: 0.9224; val_best_f1_score: 0.9246; train_kl_reg_loss: 3057.1522; train_edge_recon_loss: 27669.1233; train_gene_expr_recon_loss: 59515.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90241.3093; train_optim_loss: 90241.3093; val_kl_reg_loss: 2984.5774; val_edge_recon_loss: 27647.7096; val_gene_expr_recon_loss: 59610.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90242.3114; val_optim_loss: 90242.3114
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9734; val_auprc_score: 0.9683; val_best_acc_score: 0.9214; val_best_f1_score: 0.9240; train_kl_reg_loss: 3055.4782; train_edge_recon_loss: 27662.3829; train_gene_expr_recon_loss: 59473.9682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90191.8293; train_optim_loss: 90191.8293; val_kl_reg_loss: 2992.1918; val_edge_recon_loss: 27656.4958; val_gene_expr_recon_loss: 59458.7365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90107.4244; val_optim_loss: 90107.4244
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9727; val_auprc_score: 0.9668; val_best_acc_score: 0.9212; val_best_f1_score: 0.9239; train_kl_reg_loss: 3059.8257; train_edge_recon_loss: 27643.5355; train_gene_expr_recon_loss: 59410.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90113.9998; train_optim_loss: 90113.9998; val_kl_reg_loss: 2955.5946; val_edge_recon_loss: 27657.7805; val_gene_expr_recon_loss: 59656.3204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90269.6952; val_optim_loss: 90269.6952
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9723; val_auprc_score: 0.9665; val_best_acc_score: 0.9224; val_best_f1_score: 0.9248; train_kl_reg_loss: 3058.9284; train_edge_recon_loss: 27627.7647; train_gene_expr_recon_loss: 59399.4140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90086.1072; train_optim_loss: 90086.1072; val_kl_reg_loss: 3007.6528; val_edge_recon_loss: 27622.6337; val_gene_expr_recon_loss: 59493.5268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90123.8127; val_optim_loss: 90123.8127
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9735; val_auprc_score: 0.9682; val_best_acc_score: 0.9226; val_best_f1_score: 0.9249; train_kl_reg_loss: 3055.8924; train_edge_recon_loss: 27622.9288; train_gene_expr_recon_loss: 59323.3019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90002.1231; train_optim_loss: 90002.1231; val_kl_reg_loss: 3028.6378; val_edge_recon_loss: 27624.6335; val_gene_expr_recon_loss: 59502.8550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90156.1263; val_optim_loss: 90156.1263
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9731; val_auprc_score: 0.9673; val_best_acc_score: 0.9235; val_best_f1_score: 0.9257; train_kl_reg_loss: 3056.0422; train_edge_recon_loss: 27613.5550; train_gene_expr_recon_loss: 59288.2747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89957.8720; train_optim_loss: 89957.8720; val_kl_reg_loss: 2991.3580; val_edge_recon_loss: 27649.3136; val_gene_expr_recon_loss: 59501.8486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90142.5204; val_optim_loss: 90142.5204

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9744; val_auprc_score: 0.9690; val_best_acc_score: 0.9241; val_best_f1_score: 0.9265; train_kl_reg_loss: 3045.8214; train_edge_recon_loss: 27557.4006; train_gene_expr_recon_loss: 58994.0708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89597.2928; train_optim_loss: 89597.2928; val_kl_reg_loss: 2975.1189; val_edge_recon_loss: 27571.2174; val_gene_expr_recon_loss: 59183.1135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89729.4493; val_optim_loss: 89729.4493
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9740; val_auprc_score: 0.9684; val_best_acc_score: 0.9244; val_best_f1_score: 0.9265; train_kl_reg_loss: 3038.5682; train_edge_recon_loss: 27568.8764; train_gene_expr_recon_loss: 58951.5984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89559.0431; train_optim_loss: 89559.0431; val_kl_reg_loss: 2990.6936; val_edge_recon_loss: 27578.7377; val_gene_expr_recon_loss: 59125.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89694.8315; val_optim_loss: 89694.8315
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9742; val_auprc_score: 0.9692; val_best_acc_score: 0.9233; val_best_f1_score: 0.9260; train_kl_reg_loss: 3038.2347; train_edge_recon_loss: 27564.0701; train_gene_expr_recon_loss: 58944.3671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89546.6721; train_optim_loss: 89546.6721; val_kl_reg_loss: 2964.2303; val_edge_recon_loss: 27624.7457; val_gene_expr_recon_loss: 59190.8647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89779.8406; val_optim_loss: 89779.8406
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9739; val_auprc_score: 0.9688; val_best_acc_score: 0.9230; val_best_f1_score: 0.9255; train_kl_reg_loss: 3040.3056; train_edge_recon_loss: 27551.8478; train_gene_expr_recon_loss: 58931.4404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89523.5938; train_optim_loss: 89523.5938; val_kl_reg_loss: 2987.1326; val_edge_recon_loss: 27584.0837; val_gene_expr_recon_loss: 59086.9105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89658.1266; val_optim_loss: 89658.1266
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9748; val_auprc_score: 0.9696; val_best_acc_score: 0.9241; val_best_f1_score: 0.9263; train_kl_reg_loss: 3036.1501; train_edge_recon_loss: 27561.8555; train_gene_expr_recon_loss: 58925.4295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89523.4352; train_optim_loss: 89523.4352; val_kl_reg_loss: 2975.3587; val_edge_recon_loss: 27588.4569; val_gene_expr_recon_loss: 59066.5744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89630.3902; val_optim_loss: 89630.3902
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9745; val_auprc_score: 0.9691; val_best_acc_score: 0.9238; val_best_f1_score: 0.9262; train_kl_reg_loss: 3036.2492; train_edge_recon_loss: 27557.8166; train_gene_expr_recon_loss: 58928.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89522.5018; train_optim_loss: 89522.5018; val_kl_reg_loss: 2979.2267; val_edge_recon_loss: 27570.4423; val_gene_expr_recon_loss: 59122.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89672.0001; val_optim_loss: 89672.0001
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9754; val_auprc_score: 0.9707; val_best_acc_score: 0.9252; val_best_f1_score: 0.9275; train_kl_reg_loss: 3036.1139; train_edge_recon_loss: 27554.9508; train_gene_expr_recon_loss: 58896.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89487.5900; train_optim_loss: 89487.5900; val_kl_reg_loss: 2955.2833; val_edge_recon_loss: 27605.8041; val_gene_expr_recon_loss: 59043.0535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89604.1405; val_optim_loss: 89604.1405
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9750; val_auprc_score: 0.9703; val_best_acc_score: 0.9246; val_best_f1_score: 0.9272; train_kl_reg_loss: 3033.5926; train_edge_recon_loss: 27566.1661; train_gene_expr_recon_loss: 58915.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89515.2710; train_optim_loss: 89515.2710; val_kl_reg_loss: 2986.3076; val_edge_recon_loss: 27579.0834; val_gene_expr_recon_loss: 59196.1898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89761.5804; val_optim_loss: 89761.5804
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9743; val_auprc_score: 0.9693; val_best_acc_score: 0.9234; val_best_f1_score: 0.9258; train_kl_reg_loss: 3033.1378; train_edge_recon_loss: 27559.3550; train_gene_expr_recon_loss: 58888.2026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89480.6953; train_optim_loss: 89480.6953; val_kl_reg_loss: 2968.1707; val_edge_recon_loss: 27569.1708; val_gene_expr_recon_loss: 59019.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89556.3808; val_optim_loss: 89556.3808
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9742; val_auprc_score: 0.9694; val_best_acc_score: 0.9237; val_best_f1_score: 0.9257; train_kl_reg_loss: 3029.3528; train_edge_recon_loss: 27566.2108; train_gene_expr_recon_loss: 58897.3350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89492.8987; train_optim_loss: 89492.8987; val_kl_reg_loss: 2968.1541; val_edge_recon_loss: 27621.8728; val_gene_expr_recon_loss: 58961.3781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89551.4048; val_optim_loss: 89551.4048
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9750; val_auprc_score: 0.9704; val_best_acc_score: 0.9243; val_best_f1_score: 0.9269; train_kl_reg_loss: 3035.0930; train_edge_recon_loss: 27548.6437; train_gene_expr_recon_loss: 58906.1611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89489.8978; train_optim_loss: 89489.8978; val_kl_reg_loss: 2967.2023; val_edge_recon_loss: 27561.3121; val_gene_expr_recon_loss: 58910.3904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89438.9052; val_optim_loss: 89438.9052
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9749; val_auprc_score: 0.9700; val_best_acc_score: 0.9244; val_best_f1_score: 0.9270; train_kl_reg_loss: 3032.9730; train_edge_recon_loss: 27547.9571; train_gene_expr_recon_loss: 58881.8072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89462.7375; train_optim_loss: 89462.7375; val_kl_reg_loss: 2964.0247; val_edge_recon_loss: 27581.7137; val_gene_expr_recon_loss: 58894.7434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89440.4820; val_optim_loss: 89440.4820
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9743; val_auprc_score: 0.9693; val_best_acc_score: 0.9236; val_best_f1_score: 0.9257; train_kl_reg_loss: 3031.7129; train_edge_recon_loss: 27551.3085; train_gene_expr_recon_loss: 58865.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89448.3237; train_optim_loss: 89448.3237; val_kl_reg_loss: 2955.9592; val_edge_recon_loss: 27588.9719; val_gene_expr_recon_loss: 59025.7698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89570.7007; val_optim_loss: 89570.7007
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9747; val_auprc_score: 0.9701; val_best_acc_score: 0.9238; val_best_f1_score: 0.9264; train_kl_reg_loss: 3030.5594; train_edge_recon_loss: 27560.1309; train_gene_expr_recon_loss: 58887.8695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89478.5599; train_optim_loss: 89478.5599; val_kl_reg_loss: 2952.0585; val_edge_recon_loss: 27624.4820; val_gene_expr_recon_loss: 59082.8554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89659.3960; val_optim_loss: 89659.3960
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9742; val_auprc_score: 0.9693; val_best_acc_score: 0.9231; val_best_f1_score: 0.9257; train_kl_reg_loss: 3032.8832; train_edge_recon_loss: 27542.5870; train_gene_expr_recon_loss: 58856.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89432.0869; train_optim_loss: 89432.0869; val_kl_reg_loss: 2967.7812; val_edge_recon_loss: 27603.7532; val_gene_expr_recon_loss: 59328.2049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89899.7396; val_optim_loss: 89899.7396

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9745; val_auprc_score: 0.9696; val_best_acc_score: 0.9236; val_best_f1_score: 0.9256; train_kl_reg_loss: 3031.6001; train_edge_recon_loss: 27546.9924; train_gene_expr_recon_loss: 58811.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89390.4406; train_optim_loss: 89390.4406; val_kl_reg_loss: 2959.4698; val_edge_recon_loss: 27577.0730; val_gene_expr_recon_loss: 59016.5103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89553.0536; val_optim_loss: 89553.0536
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9746; val_auprc_score: 0.9698; val_best_acc_score: 0.9241; val_best_f1_score: 0.9264; train_kl_reg_loss: 3031.2829; train_edge_recon_loss: 27532.7126; train_gene_expr_recon_loss: 58828.6215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89392.6169; train_optim_loss: 89392.6169; val_kl_reg_loss: 2968.5892; val_edge_recon_loss: 27570.7211; val_gene_expr_recon_loss: 58940.1527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89479.4631; val_optim_loss: 89479.4631
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9737; val_auprc_score: 0.9687; val_best_acc_score: 0.9229; val_best_f1_score: 0.9252; train_kl_reg_loss: 3030.4356; train_edge_recon_loss: 27534.3788; train_gene_expr_recon_loss: 58815.5003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89380.3147; train_optim_loss: 89380.3147; val_kl_reg_loss: 2964.3241; val_edge_recon_loss: 27579.6619; val_gene_expr_recon_loss: 58946.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89490.2678; val_optim_loss: 89490.2678
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9740; val_auprc_score: 0.9683; val_best_acc_score: 0.9241; val_best_f1_score: 0.9264; train_kl_reg_loss: 3030.6855; train_edge_recon_loss: 27539.3308; train_gene_expr_recon_loss: 58825.8625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89395.8787; train_optim_loss: 89395.8787; val_kl_reg_loss: 2957.4772; val_edge_recon_loss: 27564.0125; val_gene_expr_recon_loss: 59032.4686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89553.9584; val_optim_loss: 89553.9584

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 62 min 38 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9742
Val AUPRC score: 0.9691
Val best accuracy score: 0.9233
Val best F1 score: 0.9256
Val gene expr MSE score: 1.4235

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
