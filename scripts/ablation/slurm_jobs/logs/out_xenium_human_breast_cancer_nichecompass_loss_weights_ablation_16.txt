None
Run timestamp: 14072023_055703_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9680; val_auprc_score: 0.9614; val_best_acc_score: 0.9124; val_best_f1_score: 0.9161; train_kl_reg_loss: 67852.7008; train_edge_recon_loss: 26785438.7246; train_gene_expr_recon_loss: 7309521.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34162813.2847; train_optim_loss: 34162813.2847; val_kl_reg_loss: 56462.8442; val_edge_recon_loss: 26511056.1254; val_gene_expr_recon_loss: 6835474.4983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33402993.4077; val_optim_loss: 33402993.4077
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9854; val_auprc_score: 0.9826; val_best_acc_score: 0.9440; val_best_f1_score: 0.9452; train_kl_reg_loss: 48559.8057; train_edge_recon_loss: 26218654.7440; train_gene_expr_recon_loss: 6733435.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33000650.2405; train_optim_loss: 33000650.2405; val_kl_reg_loss: 40683.2064; val_edge_recon_loss: 26197906.6551; val_gene_expr_recon_loss: 6661973.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32900563.0174; val_optim_loss: 32900563.0174
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 42107.2799; train_edge_recon_loss: 26037382.2234; train_gene_expr_recon_loss: 6632051.9876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32711541.4911; train_optim_loss: 32711541.4911; val_kl_reg_loss: 41756.9484; val_edge_recon_loss: 26126169.7909; val_gene_expr_recon_loss: 6603198.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32771124.6551; val_optim_loss: 32771124.6551
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9892; val_auprc_score: 0.9869; val_best_acc_score: 0.9550; val_best_f1_score: 0.9558; train_kl_reg_loss: 40198.0428; train_edge_recon_loss: 25976306.5725; train_gene_expr_recon_loss: 6579564.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32596069.1497; train_optim_loss: 32596069.1497; val_kl_reg_loss: 40626.4313; val_edge_recon_loss: 26056357.6028; val_gene_expr_recon_loss: 6563871.4895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32660855.4564; val_optim_loss: 32660855.4564
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 37800.0712; train_edge_recon_loss: 25929502.8379; train_gene_expr_recon_loss: 6552488.2163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32519791.1148; train_optim_loss: 32519791.1148; val_kl_reg_loss: 35352.3653; val_edge_recon_loss: 26021331.6028; val_gene_expr_recon_loss: 6545212.4216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32601896.4808; val_optim_loss: 32601896.4808
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9894; val_best_acc_score: 0.9618; val_best_f1_score: 0.9623; train_kl_reg_loss: 36309.3977; train_edge_recon_loss: 25879964.4818; train_gene_expr_recon_loss: 6537135.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32453409.3375; train_optim_loss: 32453409.3375; val_kl_reg_loss: 35166.6100; val_edge_recon_loss: 25981605.7422; val_gene_expr_recon_loss: 6533297.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32550069.8258; val_optim_loss: 32550069.8258
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9891; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 35627.9520; train_edge_recon_loss: 25859087.2250; train_gene_expr_recon_loss: 6522048.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32416763.7587; train_optim_loss: 32416763.7587; val_kl_reg_loss: 35251.2868; val_edge_recon_loss: 25938718.5017; val_gene_expr_recon_loss: 6510163.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32484133.7631; val_optim_loss: 32484133.7631
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9896; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 35005.7383; train_edge_recon_loss: 25841803.8914; train_gene_expr_recon_loss: 6512458.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32389268.2886; train_optim_loss: 32389268.2886; val_kl_reg_loss: 34457.8308; val_edge_recon_loss: 25999641.6794; val_gene_expr_recon_loss: 6518808.6446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32552908.1394; val_optim_loss: 32552908.1394
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 34480.9176; train_edge_recon_loss: 25816406.8759; train_gene_expr_recon_loss: 6505126.5704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32356014.3623; train_optim_loss: 32356014.3623; val_kl_reg_loss: 33871.7326; val_edge_recon_loss: 25911424.8990; val_gene_expr_recon_loss: 6516592.9303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32461889.5749; val_optim_loss: 32461889.5749
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 33663.1713; train_edge_recon_loss: 25812245.3615; train_gene_expr_recon_loss: 6497223.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32343132.2428; train_optim_loss: 32343132.2428; val_kl_reg_loss: 32764.0278; val_edge_recon_loss: 25891472.8780; val_gene_expr_recon_loss: 6512328.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32436565.6516; val_optim_loss: 32436565.6516
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 33227.3053; train_edge_recon_loss: 25793619.8410; train_gene_expr_recon_loss: 6489996.2374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32316843.3887; train_optim_loss: 32316843.3887; val_kl_reg_loss: 33390.9940; val_edge_recon_loss: 25867441.1010; val_gene_expr_recon_loss: 6517929.3780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32418761.4007; val_optim_loss: 32418761.4007
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 32750.9222; train_edge_recon_loss: 25783964.9527; train_gene_expr_recon_loss: 6484775.5528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32301491.4112; train_optim_loss: 32301491.4112; val_kl_reg_loss: 32064.4131; val_edge_recon_loss: 25882659.0871; val_gene_expr_recon_loss: 6500084.3432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32414807.9024; val_optim_loss: 32414807.9024
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9935; val_auprc_score: 0.9921; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 32250.5648; train_edge_recon_loss: 25773320.5112; train_gene_expr_recon_loss: 6479493.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32285064.6703; train_optim_loss: 32285064.6703; val_kl_reg_loss: 31954.7200; val_edge_recon_loss: 25850547.9791; val_gene_expr_recon_loss: 6505964.1934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388466.8571; val_optim_loss: 32388466.8571
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 31917.7289; train_edge_recon_loss: 25764522.8565; train_gene_expr_recon_loss: 6474690.4996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32271131.0908; train_optim_loss: 32271131.0908; val_kl_reg_loss: 30785.3177; val_edge_recon_loss: 25842471.5819; val_gene_expr_recon_loss: 6495024.1533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368281.1150; val_optim_loss: 32368281.1150
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 31616.4423; train_edge_recon_loss: 25759358.9201; train_gene_expr_recon_loss: 6472345.1941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32263320.5826; train_optim_loss: 32263320.5826; val_kl_reg_loss: 31155.1867; val_edge_recon_loss: 25862202.9965; val_gene_expr_recon_loss: 6488379.4408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32381737.6446; val_optim_loss: 32381737.6446
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 31195.3363; train_edge_recon_loss: 25748322.6656; train_gene_expr_recon_loss: 6472470.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32251988.4375; train_optim_loss: 32251988.4375; val_kl_reg_loss: 31540.2577; val_edge_recon_loss: 25844623.6307; val_gene_expr_recon_loss: 6499601.7683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32375765.6934; val_optim_loss: 32375765.6934
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 31105.7909; train_edge_recon_loss: 25744927.9449; train_gene_expr_recon_loss: 6467629.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32243663.6424; train_optim_loss: 32243663.6424; val_kl_reg_loss: 31418.1961; val_edge_recon_loss: 25816327.7909; val_gene_expr_recon_loss: 6486946.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32334692.1045; val_optim_loss: 32334692.1045
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 30868.6193; train_edge_recon_loss: 25745063.1971; train_gene_expr_recon_loss: 6465157.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32241089.3445; train_optim_loss: 32241089.3445; val_kl_reg_loss: 30654.9397; val_edge_recon_loss: 25852936.5157; val_gene_expr_recon_loss: 6496517.9251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32380109.3728; val_optim_loss: 32380109.3728
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9721; val_best_f1_score: 0.9724; train_kl_reg_loss: 30667.2701; train_edge_recon_loss: 25728020.3732; train_gene_expr_recon_loss: 6463392.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32222080.2754; train_optim_loss: 32222080.2754; val_kl_reg_loss: 30567.3783; val_edge_recon_loss: 25825167.7979; val_gene_expr_recon_loss: 6492939.3328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32348674.4878; val_optim_loss: 32348674.4878
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9719; val_best_f1_score: 0.9722; train_kl_reg_loss: 30430.6923; train_edge_recon_loss: 25727427.9581; train_gene_expr_recon_loss: 6459135.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32216993.8123; train_optim_loss: 32216993.8123; val_kl_reg_loss: 29721.1189; val_edge_recon_loss: 25847107.8118; val_gene_expr_recon_loss: 6511546.7178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388375.5958; val_optim_loss: 32388375.5958
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 30162.9305; train_edge_recon_loss: 25724549.8200; train_gene_expr_recon_loss: 6460957.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32215670.2188; train_optim_loss: 32215670.2188; val_kl_reg_loss: 30338.3437; val_edge_recon_loss: 25838330.6132; val_gene_expr_recon_loss: 6490013.7753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32358682.7666; val_optim_loss: 32358682.7666

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9945; val_auprc_score: 0.9931; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 32068.7679; train_edge_recon_loss: 25705191.3646; train_gene_expr_recon_loss: 6413862.9265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32151123.0621; train_optim_loss: 32151123.0621; val_kl_reg_loss: 32166.8604; val_edge_recon_loss: 25775098.6829; val_gene_expr_recon_loss: 6458306.9564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32265572.4808; val_optim_loss: 32265572.4808
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 32759.3358; train_edge_recon_loss: 25701724.6431; train_gene_expr_recon_loss: 6409619.7541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32144103.7704; train_optim_loss: 32144103.7704; val_kl_reg_loss: 32117.3647; val_edge_recon_loss: 25770384.9268; val_gene_expr_recon_loss: 6449325.5784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32251827.7352; val_optim_loss: 32251827.7352
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 32901.3518; train_edge_recon_loss: 25696039.2630; train_gene_expr_recon_loss: 6408131.1239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32137071.7580; train_optim_loss: 32137071.7580; val_kl_reg_loss: 32213.6654; val_edge_recon_loss: 25756561.5819; val_gene_expr_recon_loss: 6454813.5470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32243588.8502; val_optim_loss: 32243588.8502
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 33001.5506; train_edge_recon_loss: 25696150.8798; train_gene_expr_recon_loss: 6407550.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32136702.7067; train_optim_loss: 32136702.7067; val_kl_reg_loss: 32333.6882; val_edge_recon_loss: 25754559.0592; val_gene_expr_recon_loss: 6443601.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32230494.1185; val_optim_loss: 32230494.1185
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9947; val_auprc_score: 0.9934; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 32986.4345; train_edge_recon_loss: 25693285.6160; train_gene_expr_recon_loss: 6407270.6063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32133542.6610; train_optim_loss: 32133542.6610; val_kl_reg_loss: 32629.4101; val_edge_recon_loss: 25771292.4948; val_gene_expr_recon_loss: 6442070.5540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32245992.4739; val_optim_loss: 32245992.4739
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9950; val_auprc_score: 0.9938; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 33067.3821; train_edge_recon_loss: 25692912.1567; train_gene_expr_recon_loss: 6401780.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32127760.0341; train_optim_loss: 32127760.0341; val_kl_reg_loss: 32400.5946; val_edge_recon_loss: 25771054.7456; val_gene_expr_recon_loss: 6444779.1359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32248234.4948; val_optim_loss: 32248234.4948
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 33070.8476; train_edge_recon_loss: 25695345.6796; train_gene_expr_recon_loss: 6403442.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32131859.3863; train_optim_loss: 32131859.3863; val_kl_reg_loss: 32377.0615; val_edge_recon_loss: 25764003.9512; val_gene_expr_recon_loss: 6446503.6951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32242884.6690; val_optim_loss: 32242884.6690
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9947; val_auprc_score: 0.9932; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 33031.5939; train_edge_recon_loss: 25689577.4794; train_gene_expr_recon_loss: 6401306.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32123915.5244; train_optim_loss: 32123915.5244; val_kl_reg_loss: 32468.7460; val_edge_recon_loss: 25773563.7840; val_gene_expr_recon_loss: 6449259.2666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32255291.7770; val_optim_loss: 32255291.7770

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 33035.0751; train_edge_recon_loss: 25693607.3763; train_gene_expr_recon_loss: 6396359.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32123001.6912; train_optim_loss: 32123001.6912; val_kl_reg_loss: 32639.3723; val_edge_recon_loss: 25743656.0557; val_gene_expr_recon_loss: 6440892.1516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32217187.5749; val_optim_loss: 32217187.5749
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 33203.6882; train_edge_recon_loss: 25684274.0683; train_gene_expr_recon_loss: 6397167.4246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32114645.1831; train_optim_loss: 32114645.1831; val_kl_reg_loss: 32808.3003; val_edge_recon_loss: 25768295.3240; val_gene_expr_recon_loss: 6436205.2073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32237308.7596; val_optim_loss: 32237308.7596
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 33261.3659; train_edge_recon_loss: 25690348.2700; train_gene_expr_recon_loss: 6395287.4990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32118897.1404; train_optim_loss: 32118897.1404; val_kl_reg_loss: 32816.2304; val_edge_recon_loss: 25763167.7909; val_gene_expr_recon_loss: 6443954.9634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32239938.9338; val_optim_loss: 32239938.9338
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 33280.4351; train_edge_recon_loss: 25689440.2048; train_gene_expr_recon_loss: 6395703.3429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32118423.9977; train_optim_loss: 32118423.9977; val_kl_reg_loss: 32757.4070; val_edge_recon_loss: 25764786.7317; val_gene_expr_recon_loss: 6437244.3101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32234788.4669; val_optim_loss: 32234788.4669
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 33307.8980; train_edge_recon_loss: 25686309.9984; train_gene_expr_recon_loss: 6396723.4106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32116341.2948; train_optim_loss: 32116341.2948; val_kl_reg_loss: 32819.6572; val_edge_recon_loss: 25764377.4564; val_gene_expr_recon_loss: 6428474.1533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32225671.3240; val_optim_loss: 32225671.3240

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9753; val_best_f1_score: 0.9755; train_kl_reg_loss: 33301.1095; train_edge_recon_loss: 25693784.9697; train_gene_expr_recon_loss: 6395801.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32122887.9178; train_optim_loss: 32122887.9178; val_kl_reg_loss: 32827.9671; val_edge_recon_loss: 25755755.6376; val_gene_expr_recon_loss: 6438663.4652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32227247.1010; val_optim_loss: 32227247.1010
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 33303.2139; train_edge_recon_loss: 25689112.0566; train_gene_expr_recon_loss: 6392323.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32114739.1420; train_optim_loss: 32114739.1420; val_kl_reg_loss: 32836.8551; val_edge_recon_loss: 25765599.4007; val_gene_expr_recon_loss: 6437941.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32236377.4077; val_optim_loss: 32236377.4077
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 33302.5965; train_edge_recon_loss: 25686194.7486; train_gene_expr_recon_loss: 6393952.8701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32113450.1955; train_optim_loss: 32113450.1955; val_kl_reg_loss: 32833.0612; val_edge_recon_loss: 25756525.0453; val_gene_expr_recon_loss: 6431167.3310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32220525.4286; val_optim_loss: 32220525.4286
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 33291.3244; train_edge_recon_loss: 25691057.4205; train_gene_expr_recon_loss: 6395564.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32119913.0101; train_optim_loss: 32119913.0101; val_kl_reg_loss: 32851.8910; val_edge_recon_loss: 25750752.1672; val_gene_expr_recon_loss: 6439794.0941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32223398.1812; val_optim_loss: 32223398.1812

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 736 min 7 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9949
Val AUPRC score: 0.9936
Val best accuracy score: 0.9745
Val best F1 score: 0.9748
Val gene expr MSE score: 1.6330

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
