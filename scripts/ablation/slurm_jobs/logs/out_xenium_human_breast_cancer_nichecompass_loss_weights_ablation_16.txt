None
Run timestamp: 28062023_164600_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9407; val_auprc_score: 0.9202; val_best_acc_score: 0.8827; val_best_f1_score: 0.8897; train_kl_reg_loss: 2149.1103; train_edge_recon_loss: 28548.0262; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30697.1364; train_optim_loss: 30697.1364; val_kl_reg_loss: 2238.6286; val_edge_recon_loss: 26750.3067; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28988.9352; val_optim_loss: 28988.9352
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9544; val_auprc_score: 0.9395; val_best_acc_score: 0.8976; val_best_f1_score: 0.9022; train_kl_reg_loss: 2343.9772; train_edge_recon_loss: 27864.6382; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30208.6155; train_optim_loss: 30208.6155; val_kl_reg_loss: 2264.9369; val_edge_recon_loss: 26677.9140; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28942.8510; val_optim_loss: 28942.8510
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9626; val_auprc_score: 0.9502; val_best_acc_score: 0.9098; val_best_f1_score: 0.9133; train_kl_reg_loss: 2383.6236; train_edge_recon_loss: 27736.4535; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30120.0770; train_optim_loss: 30120.0770; val_kl_reg_loss: 2374.5008; val_edge_recon_loss: 26601.3101; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28975.8109; val_optim_loss: 28975.8109
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9655; val_auprc_score: 0.9551; val_best_acc_score: 0.9140; val_best_f1_score: 0.9170; train_kl_reg_loss: 2404.5723; train_edge_recon_loss: 27670.5556; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30075.1279; train_optim_loss: 30075.1279; val_kl_reg_loss: 2322.5827; val_edge_recon_loss: 26525.4706; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28848.0532; val_optim_loss: 28848.0532
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9645; val_auprc_score: 0.9522; val_best_acc_score: 0.9156; val_best_f1_score: 0.9189; train_kl_reg_loss: 2409.5120; train_edge_recon_loss: 27658.6007; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30068.1127; train_optim_loss: 30068.1127; val_kl_reg_loss: 2352.2640; val_edge_recon_loss: 26472.4695; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28824.7335; val_optim_loss: 28824.7335
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9654; val_auprc_score: 0.9537; val_best_acc_score: 0.9168; val_best_f1_score: 0.9199; train_kl_reg_loss: 2419.1726; train_edge_recon_loss: 27615.5961; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30034.7687; train_optim_loss: 30034.7687; val_kl_reg_loss: 2388.3203; val_edge_recon_loss: 26495.0188; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28883.3391; val_optim_loss: 28883.3391
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9683; val_auprc_score: 0.9574; val_best_acc_score: 0.9208; val_best_f1_score: 0.9238; train_kl_reg_loss: 2420.4027; train_edge_recon_loss: 27615.5798; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30035.9825; train_optim_loss: 30035.9825; val_kl_reg_loss: 2395.2967; val_edge_recon_loss: 26445.2011; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28840.4978; val_optim_loss: 28840.4978
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9692; val_auprc_score: 0.9587; val_best_acc_score: 0.9219; val_best_f1_score: 0.9248; train_kl_reg_loss: 2423.2441; train_edge_recon_loss: 27598.0546; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30021.2987; train_optim_loss: 30021.2987; val_kl_reg_loss: 2385.9223; val_edge_recon_loss: 26436.8599; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28822.7823; val_optim_loss: 28822.7823
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9690; val_auprc_score: 0.9570; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 2428.0058; train_edge_recon_loss: 27581.6484; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30009.6543; train_optim_loss: 30009.6543; val_kl_reg_loss: 2486.0776; val_edge_recon_loss: 26400.8165; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28886.8941; val_optim_loss: 28886.8941
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9694; val_auprc_score: 0.9586; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 2432.5681; train_edge_recon_loss: 27563.3091; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29995.8773; train_optim_loss: 29995.8773; val_kl_reg_loss: 2350.9223; val_edge_recon_loss: 26400.0300; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28750.9523; val_optim_loss: 28750.9523
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9692; val_auprc_score: 0.9585; val_best_acc_score: 0.9228; val_best_f1_score: 0.9252; train_kl_reg_loss: 2438.4155; train_edge_recon_loss: 27548.1511; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29986.5666; train_optim_loss: 29986.5666; val_kl_reg_loss: 2459.1426; val_edge_recon_loss: 26432.5194; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28891.6621; val_optim_loss: 28891.6621
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9595; val_best_acc_score: 0.9249; val_best_f1_score: 0.9275; train_kl_reg_loss: 2438.0031; train_edge_recon_loss: 27535.1211; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29973.1241; train_optim_loss: 29973.1241; val_kl_reg_loss: 2335.5521; val_edge_recon_loss: 26430.1095; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28765.6615; val_optim_loss: 28765.6615
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9714; val_auprc_score: 0.9607; val_best_acc_score: 0.9275; val_best_f1_score: 0.9298; train_kl_reg_loss: 2440.9369; train_edge_recon_loss: 27536.1548; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29977.0917; train_optim_loss: 29977.0917; val_kl_reg_loss: 2438.1495; val_edge_recon_loss: 26418.0025; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28856.1520; val_optim_loss: 28856.1520
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9731; val_auprc_score: 0.9642; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 2443.3596; train_edge_recon_loss: 27523.1811; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29966.5407; train_optim_loss: 29966.5407; val_kl_reg_loss: 2420.5234; val_edge_recon_loss: 26419.1697; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28839.6932; val_optim_loss: 28839.6932

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9727; val_auprc_score: 0.9626; val_best_acc_score: 0.9284; val_best_f1_score: 0.9306; train_kl_reg_loss: 2441.3055; train_edge_recon_loss: 27485.7645; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29927.0700; train_optim_loss: 29927.0700; val_kl_reg_loss: 2396.7268; val_edge_recon_loss: 26392.8476; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28789.5743; val_optim_loss: 28789.5743
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9742; val_auprc_score: 0.9653; val_best_acc_score: 0.9300; val_best_f1_score: 0.9322; train_kl_reg_loss: 2439.9625; train_edge_recon_loss: 27482.3201; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29922.2826; train_optim_loss: 29922.2826; val_kl_reg_loss: 2379.7275; val_edge_recon_loss: 26355.6924; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28735.4200; val_optim_loss: 28735.4200
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9737; val_auprc_score: 0.9644; val_best_acc_score: 0.9288; val_best_f1_score: 0.9310; train_kl_reg_loss: 2436.9262; train_edge_recon_loss: 27490.0502; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29926.9764; train_optim_loss: 29926.9764; val_kl_reg_loss: 2386.5486; val_edge_recon_loss: 26382.1090; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28768.6576; val_optim_loss: 28768.6576
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9734; val_auprc_score: 0.9636; val_best_acc_score: 0.9317; val_best_f1_score: 0.9337; train_kl_reg_loss: 2440.2470; train_edge_recon_loss: 27475.8636; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29916.1107; train_optim_loss: 29916.1107; val_kl_reg_loss: 2397.2845; val_edge_recon_loss: 26348.3167; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28745.6014; val_optim_loss: 28745.6014
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9735; val_auprc_score: 0.9638; val_best_acc_score: 0.9306; val_best_f1_score: 0.9329; train_kl_reg_loss: 2441.0742; train_edge_recon_loss: 27471.1768; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29912.2511; train_optim_loss: 29912.2511; val_kl_reg_loss: 2394.0544; val_edge_recon_loss: 26347.4711; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28741.5254; val_optim_loss: 28741.5254
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9734; val_auprc_score: 0.9639; val_best_acc_score: 0.9296; val_best_f1_score: 0.9316; train_kl_reg_loss: 2437.8172; train_edge_recon_loss: 27482.3128; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29920.1301; train_optim_loss: 29920.1301; val_kl_reg_loss: 2378.9879; val_edge_recon_loss: 26405.3664; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28784.3542; val_optim_loss: 28784.3542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9745; val_auprc_score: 0.9653; val_best_acc_score: 0.9311; val_best_f1_score: 0.9330; train_kl_reg_loss: 2436.0642; train_edge_recon_loss: 27477.4748; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29913.5390; train_optim_loss: 29913.5390; val_kl_reg_loss: 2379.8642; val_edge_recon_loss: 26323.2715; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28703.1358; val_optim_loss: 28703.1358
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9734; val_auprc_score: 0.9638; val_best_acc_score: 0.9296; val_best_f1_score: 0.9316; train_kl_reg_loss: 2438.1393; train_edge_recon_loss: 27471.3264; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29909.4656; train_optim_loss: 29909.4656; val_kl_reg_loss: 2392.1791; val_edge_recon_loss: 26376.4939; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28768.6730; val_optim_loss: 28768.6730
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9744; val_auprc_score: 0.9654; val_best_acc_score: 0.9311; val_best_f1_score: 0.9333; train_kl_reg_loss: 2437.6197; train_edge_recon_loss: 27476.7389; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29914.3586; train_optim_loss: 29914.3586; val_kl_reg_loss: 2386.6669; val_edge_recon_loss: 26363.0782; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28749.7450; val_optim_loss: 28749.7450
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9740; val_auprc_score: 0.9648; val_best_acc_score: 0.9309; val_best_f1_score: 0.9330; train_kl_reg_loss: 2438.9751; train_edge_recon_loss: 27467.3839; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29906.3591; train_optim_loss: 29906.3591; val_kl_reg_loss: 2388.5569; val_edge_recon_loss: 26368.8315; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28757.3885; val_optim_loss: 28757.3885
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9739; val_auprc_score: 0.9645; val_best_acc_score: 0.9300; val_best_f1_score: 0.9320; train_kl_reg_loss: 2436.4453; train_edge_recon_loss: 27481.0114; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29917.4566; train_optim_loss: 29917.4566; val_kl_reg_loss: 2394.1203; val_edge_recon_loss: 26374.3967; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28768.5171; val_optim_loss: 28768.5171

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9744; val_auprc_score: 0.9654; val_best_acc_score: 0.9308; val_best_f1_score: 0.9327; train_kl_reg_loss: 2441.7070; train_edge_recon_loss: 27463.2417; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29904.9487; train_optim_loss: 29904.9487; val_kl_reg_loss: 2392.1595; val_edge_recon_loss: 26348.0060; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28740.1654; val_optim_loss: 28740.1654
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9742; val_auprc_score: 0.9652; val_best_acc_score: 0.9300; val_best_f1_score: 0.9319; train_kl_reg_loss: 2437.1094; train_edge_recon_loss: 27487.0582; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29924.1676; train_optim_loss: 29924.1676; val_kl_reg_loss: 2387.1572; val_edge_recon_loss: 26389.2655; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28776.4226; val_optim_loss: 28776.4226
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9732; val_auprc_score: 0.9641; val_best_acc_score: 0.9296; val_best_f1_score: 0.9317; train_kl_reg_loss: 2436.5489; train_edge_recon_loss: 27473.7363; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29910.2852; train_optim_loss: 29910.2852; val_kl_reg_loss: 2388.9259; val_edge_recon_loss: 26370.6694; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28759.5952; val_optim_loss: 28759.5952
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9743; val_auprc_score: 0.9650; val_best_acc_score: 0.9319; val_best_f1_score: 0.9337; train_kl_reg_loss: 2436.7729; train_edge_recon_loss: 27468.6294; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29905.4023; train_optim_loss: 29905.4023; val_kl_reg_loss: 2389.8948; val_edge_recon_loss: 26356.2333; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28746.1280; val_optim_loss: 28746.1280

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 26 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9730
Val AUPRC score: 0.9624
Val best accuracy score: 0.9294
Val best F1 score: 0.9314
Val gene expr MSE score: 4.5715

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
