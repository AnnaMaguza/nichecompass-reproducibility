None
Run timestamp: 14072023_055703_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9680; val_auprc_score: 0.9614; val_best_acc_score: 0.9124; val_best_f1_score: 0.9161; train_kl_reg_loss: 67852.7008; train_edge_recon_loss: 26785438.7246; train_gene_expr_recon_loss: 7309521.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34162813.2847; train_optim_loss: 34162813.2847; val_kl_reg_loss: 56462.8442; val_edge_recon_loss: 26511056.1254; val_gene_expr_recon_loss: 6835474.4983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33402993.4077; val_optim_loss: 33402993.4077
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9854; val_auprc_score: 0.9826; val_best_acc_score: 0.9440; val_best_f1_score: 0.9452; train_kl_reg_loss: 48559.8057; train_edge_recon_loss: 26218654.7440; train_gene_expr_recon_loss: 6733435.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33000650.2405; train_optim_loss: 33000650.2405; val_kl_reg_loss: 40683.2064; val_edge_recon_loss: 26197906.6551; val_gene_expr_recon_loss: 6661973.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32900563.0174; val_optim_loss: 32900563.0174
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 42107.2799; train_edge_recon_loss: 26037382.2234; train_gene_expr_recon_loss: 6632051.9876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32711541.4911; train_optim_loss: 32711541.4911; val_kl_reg_loss: 41756.9484; val_edge_recon_loss: 26126169.7909; val_gene_expr_recon_loss: 6603198.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32771124.6551; val_optim_loss: 32771124.6551
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9892; val_auprc_score: 0.9869; val_best_acc_score: 0.9550; val_best_f1_score: 0.9558; train_kl_reg_loss: 40198.0428; train_edge_recon_loss: 25976306.5725; train_gene_expr_recon_loss: 6579564.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32596069.1497; train_optim_loss: 32596069.1497; val_kl_reg_loss: 40626.4313; val_edge_recon_loss: 26056357.6028; val_gene_expr_recon_loss: 6563871.4895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32660855.4564; val_optim_loss: 32660855.4564
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 37800.0712; train_edge_recon_loss: 25929502.8379; train_gene_expr_recon_loss: 6552488.2163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32519791.1148; train_optim_loss: 32519791.1148; val_kl_reg_loss: 35352.3653; val_edge_recon_loss: 26021331.6028; val_gene_expr_recon_loss: 6545212.4216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32601896.4808; val_optim_loss: 32601896.4808
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9894; val_best_acc_score: 0.9618; val_best_f1_score: 0.9623; train_kl_reg_loss: 36309.3977; train_edge_recon_loss: 25879964.4818; train_gene_expr_recon_loss: 6537135.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32453409.3375; train_optim_loss: 32453409.3375; val_kl_reg_loss: 35166.6100; val_edge_recon_loss: 25981605.7422; val_gene_expr_recon_loss: 6533297.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32550069.8258; val_optim_loss: 32550069.8258
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9891; val_best_acc_score: 0.9615; val_best_f1_score: 0.9622; train_kl_reg_loss: 35627.9520; train_edge_recon_loss: 25859087.2250; train_gene_expr_recon_loss: 6522048.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32416763.7587; train_optim_loss: 32416763.7587; val_kl_reg_loss: 35251.2868; val_edge_recon_loss: 25938718.5017; val_gene_expr_recon_loss: 6510163.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32484133.7631; val_optim_loss: 32484133.7631
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9896; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 35005.7383; train_edge_recon_loss: 25841803.8914; train_gene_expr_recon_loss: 6512458.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32389268.2886; train_optim_loss: 32389268.2886; val_kl_reg_loss: 34457.8308; val_edge_recon_loss: 25999641.6794; val_gene_expr_recon_loss: 6518808.6446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32552908.1394; val_optim_loss: 32552908.1394
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9906; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 34480.9176; train_edge_recon_loss: 25816406.8759; train_gene_expr_recon_loss: 6505126.5704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32356014.3623; train_optim_loss: 32356014.3623; val_kl_reg_loss: 33871.7326; val_edge_recon_loss: 25911424.8990; val_gene_expr_recon_loss: 6516592.9303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32461889.5749; val_optim_loss: 32461889.5749
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9910; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 33663.1713; train_edge_recon_loss: 25812245.3615; train_gene_expr_recon_loss: 6497223.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32343132.2428; train_optim_loss: 32343132.2428; val_kl_reg_loss: 32764.0278; val_edge_recon_loss: 25891472.8780; val_gene_expr_recon_loss: 6512328.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32436565.6516; val_optim_loss: 32436565.6516
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 33227.3053; train_edge_recon_loss: 25793619.8410; train_gene_expr_recon_loss: 6489996.2374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32316843.3887; train_optim_loss: 32316843.3887; val_kl_reg_loss: 33390.9940; val_edge_recon_loss: 25867441.1010; val_gene_expr_recon_loss: 6517929.3780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32418761.4007; val_optim_loss: 32418761.4007
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9915; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 32750.9222; train_edge_recon_loss: 25783964.9527; train_gene_expr_recon_loss: 6484775.5528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32301491.4112; train_optim_loss: 32301491.4112; val_kl_reg_loss: 32064.4131; val_edge_recon_loss: 25882659.0871; val_gene_expr_recon_loss: 6500084.3432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32414807.9024; val_optim_loss: 32414807.9024
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9935; val_auprc_score: 0.9921; val_best_acc_score: 0.9684; val_best_f1_score: 0.9688; train_kl_reg_loss: 32250.5648; train_edge_recon_loss: 25773320.5112; train_gene_expr_recon_loss: 6479493.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32285064.6703; train_optim_loss: 32285064.6703; val_kl_reg_loss: 31954.7200; val_edge_recon_loss: 25850547.9791; val_gene_expr_recon_loss: 6505964.1934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32388466.8571; val_optim_loss: 32388466.8571
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 31917.7289; train_edge_recon_loss: 25764522.8565; train_gene_expr_recon_loss: 6474690.4996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32271131.0908; train_optim_loss: 32271131.0908; val_kl_reg_loss: 30785.3177; val_edge_recon_loss: 25842471.5819; val_gene_expr_recon_loss: 6495024.1533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32368281.1150; val_optim_loss: 32368281.1150
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9923; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 31616.4423; train_edge_recon_loss: 25759358.9201; train_gene_expr_recon_loss: 6472345.1941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32263320.5826; train_optim_loss: 32263320.5826; val_kl_reg_loss: 31155.1867; val_edge_recon_loss: 25862202.9965; val_gene_expr_recon_loss: 6488379.4408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32381737.6446; val_optim_loss: 32381737.6446
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9696; val_best_f1_score: 0.9700; train_kl_reg_loss: 31195.3363; train_edge_recon_loss: 25748322.6656; train_gene_expr_recon_loss: 6472470.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32251988.4375; train_optim_loss: 32251988.4375; val_kl_reg_loss: 31540.2577; val_edge_recon_loss: 25844623.6307; val_gene_expr_recon_loss: 6499601.7683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32375765.6934; val_optim_loss: 32375765.6934
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 31105.7909; train_edge_recon_loss: 25744927.9449; train_gene_expr_recon_loss: 6467629.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32243663.6424; train_optim_loss: 32243663.6424; val_kl_reg_loss: 31418.1961; val_edge_recon_loss: 25816327.7909; val_gene_expr_recon_loss: 6486946.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32334692.1045; val_optim_loss: 32334692.1045
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 30868.6193; train_edge_recon_loss: 25745063.1971; train_gene_expr_recon_loss: 6465157.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32241089.3445; train_optim_loss: 32241089.3445; val_kl_reg_loss: 30654.9397; val_edge_recon_loss: 25852936.5157; val_gene_expr_recon_loss: 6496517.9251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32380109.3728; val_optim_loss: 32380109.3728
