None
Run timestamp: 15072023_130621_149.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_149']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9218; val_auprc_score: 0.9160; val_best_acc_score: 0.8411; val_best_f1_score: 0.8483; train_kl_reg_loss: 88790.1974; train_edge_recon_loss: 3039158.7062; train_gene_expr_recon_loss: 14256267.7098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17384216.6008; train_optim_loss: 17384216.6008; val_kl_reg_loss: 80590.1962; val_edge_recon_loss: 2839039.7932; val_gene_expr_recon_loss: 13201073.2818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16120703.2273; val_optim_loss: 16120703.2273
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9500; val_auprc_score: 0.9466; val_best_acc_score: 0.8835; val_best_f1_score: 0.8862; train_kl_reg_loss: 75276.9614; train_edge_recon_loss: 2747261.0939; train_gene_expr_recon_loss: 12848735.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15671273.5479; train_optim_loss: 15671273.5479; val_kl_reg_loss: 66559.9653; val_edge_recon_loss: 2766365.1545; val_gene_expr_recon_loss: 12644822.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15477748.0182; val_optim_loss: 15477748.0182
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9647; val_auprc_score: 0.9624; val_best_acc_score: 0.9048; val_best_f1_score: 0.9062; train_kl_reg_loss: 62032.8001; train_edge_recon_loss: 2708933.0084; train_gene_expr_recon_loss: 12413076.8615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15184042.6792; train_optim_loss: 15184042.6792; val_kl_reg_loss: 55943.5177; val_edge_recon_loss: 2741705.1477; val_gene_expr_recon_loss: 12348755.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15146404.6636; val_optim_loss: 15146404.6636
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9694; val_best_acc_score: 0.9143; val_best_f1_score: 0.9150; train_kl_reg_loss: 56053.8494; train_edge_recon_loss: 2684540.6510; train_gene_expr_recon_loss: 12171567.7373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14912162.2373; train_optim_loss: 14912162.2373; val_kl_reg_loss: 53202.5319; val_edge_recon_loss: 2727307.0795; val_gene_expr_recon_loss: 12153684.7364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14934194.3545; val_optim_loss: 14934194.3545
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9715; val_auprc_score: 0.9699; val_best_acc_score: 0.9160; val_best_f1_score: 0.9170; train_kl_reg_loss: 53132.9807; train_edge_recon_loss: 2673053.5537; train_gene_expr_recon_loss: 12024604.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14750791.3513; train_optim_loss: 14750791.3513; val_kl_reg_loss: 49512.7760; val_edge_recon_loss: 2714230.2159; val_gene_expr_recon_loss: 12046018.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14809761.7455; val_optim_loss: 14809761.7455
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9734; val_auprc_score: 0.9724; val_best_acc_score: 0.9204; val_best_f1_score: 0.9211; train_kl_reg_loss: 50541.5103; train_edge_recon_loss: 2668350.0820; train_gene_expr_recon_loss: 11935064.6253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14653956.2210; train_optim_loss: 14653956.2210; val_kl_reg_loss: 48620.2945; val_edge_recon_loss: 2710879.5795; val_gene_expr_recon_loss: 11974229.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14733729.5545; val_optim_loss: 14733729.5545
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9751; val_auprc_score: 0.9734; val_best_acc_score: 0.9225; val_best_f1_score: 0.9233; train_kl_reg_loss: 48844.5929; train_edge_recon_loss: 2661957.5509; train_gene_expr_recon_loss: 11865754.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14576556.7648; train_optim_loss: 14576556.7648; val_kl_reg_loss: 46224.0011; val_edge_recon_loss: 2707720.8045; val_gene_expr_recon_loss: 11920918.3091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14674863.1182; val_optim_loss: 14674863.1182
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9760; val_auprc_score: 0.9743; val_best_acc_score: 0.9234; val_best_f1_score: 0.9240; train_kl_reg_loss: 47230.3254; train_edge_recon_loss: 2659853.4857; train_gene_expr_recon_loss: 11825241.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14532325.3921; train_optim_loss: 14532325.3921; val_kl_reg_loss: 45132.7286; val_edge_recon_loss: 2705305.0773; val_gene_expr_recon_loss: 11890997.0364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14641434.7727; val_optim_loss: 14641434.7727
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9770; val_auprc_score: 0.9752; val_best_acc_score: 0.9253; val_best_f1_score: 0.9263; train_kl_reg_loss: 46291.8792; train_edge_recon_loss: 2655463.8170; train_gene_expr_recon_loss: 11790865.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14492621.4786; train_optim_loss: 14492621.4786; val_kl_reg_loss: 44985.4138; val_edge_recon_loss: 2697770.7023; val_gene_expr_recon_loss: 11860494.1636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14603250.3000; val_optim_loss: 14603250.3000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9768; val_auprc_score: 0.9748; val_best_acc_score: 0.9248; val_best_f1_score: 0.9257; train_kl_reg_loss: 45681.0810; train_edge_recon_loss: 2650947.9664; train_gene_expr_recon_loss: 11758943.0367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14455572.0916; train_optim_loss: 14455572.0916; val_kl_reg_loss: 43992.5118; val_edge_recon_loss: 2702867.3636; val_gene_expr_recon_loss: 11844751.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14591611.2636; val_optim_loss: 14591611.2636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9779; val_auprc_score: 0.9763; val_best_acc_score: 0.9264; val_best_f1_score: 0.9273; train_kl_reg_loss: 45166.4341; train_edge_recon_loss: 2650595.5262; train_gene_expr_recon_loss: 11737983.9409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14433745.8982; train_optim_loss: 14433745.8982; val_kl_reg_loss: 43616.4210; val_edge_recon_loss: 2698275.6341; val_gene_expr_recon_loss: 11824826.8909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14566718.9636; val_optim_loss: 14566718.9636
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9778; val_auprc_score: 0.9759; val_best_acc_score: 0.9267; val_best_f1_score: 0.9278; train_kl_reg_loss: 44648.4142; train_edge_recon_loss: 2647778.9300; train_gene_expr_recon_loss: 11725534.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14417962.2016; train_optim_loss: 14417962.2016; val_kl_reg_loss: 42859.9155; val_edge_recon_loss: 2695554.7432; val_gene_expr_recon_loss: 11858016.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14596430.8545; val_optim_loss: 14596430.8545
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9781; val_auprc_score: 0.9764; val_best_acc_score: 0.9273; val_best_f1_score: 0.9284; train_kl_reg_loss: 44073.7383; train_edge_recon_loss: 2647157.8709; train_gene_expr_recon_loss: 11707591.7811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14398823.3880; train_optim_loss: 14398823.3880; val_kl_reg_loss: 43089.8906; val_edge_recon_loss: 2694695.2432; val_gene_expr_recon_loss: 11790647.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14528432.5727; val_optim_loss: 14528432.5727
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9778; val_best_acc_score: 0.9283; val_best_f1_score: 0.9293; train_kl_reg_loss: 43548.2107; train_edge_recon_loss: 2644034.6530; train_gene_expr_recon_loss: 11700713.6303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14388296.4939; train_optim_loss: 14388296.4939; val_kl_reg_loss: 42201.7074; val_edge_recon_loss: 2691258.4000; val_gene_expr_recon_loss: 11799664.7364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14533124.8818; val_optim_loss: 14533124.8818
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9789; val_auprc_score: 0.9777; val_best_acc_score: 0.9272; val_best_f1_score: 0.9278; train_kl_reg_loss: 43098.5436; train_edge_recon_loss: 2643321.5023; train_gene_expr_recon_loss: 11689123.1507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14375543.1955; train_optim_loss: 14375543.1955; val_kl_reg_loss: 42181.6081; val_edge_recon_loss: 2697392.3932; val_gene_expr_recon_loss: 11802636.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14542210.7000; val_optim_loss: 14542210.7000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9790; val_auprc_score: 0.9772; val_best_acc_score: 0.9284; val_best_f1_score: 0.9292; train_kl_reg_loss: 42680.0056; train_edge_recon_loss: 2642651.8506; train_gene_expr_recon_loss: 11676088.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14361419.9369; train_optim_loss: 14361419.9369; val_kl_reg_loss: 41157.8586; val_edge_recon_loss: 2692377.6295; val_gene_expr_recon_loss: 11797114.8364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14530650.3182; val_optim_loss: 14530650.3182
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9785; val_auprc_score: 0.9771; val_best_acc_score: 0.9281; val_best_f1_score: 0.9287; train_kl_reg_loss: 42332.9085; train_edge_recon_loss: 2642039.1494; train_gene_expr_recon_loss: 11670330.1090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14354702.1690; train_optim_loss: 14354702.1690; val_kl_reg_loss: 40732.5642; val_edge_recon_loss: 2693110.7750; val_gene_expr_recon_loss: 11777878.7909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14511722.1000; val_optim_loss: 14511722.1000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9795; val_auprc_score: 0.9783; val_best_acc_score: 0.9299; val_best_f1_score: 0.9304; train_kl_reg_loss: 41827.4055; train_edge_recon_loss: 2641932.2839; train_gene_expr_recon_loss: 11664957.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14348717.2953; train_optim_loss: 14348717.2953; val_kl_reg_loss: 40974.9571; val_edge_recon_loss: 2686580.5136; val_gene_expr_recon_loss: 11795500.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14523056.2273; val_optim_loss: 14523056.2273
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9792; val_auprc_score: 0.9779; val_best_acc_score: 0.9291; val_best_f1_score: 0.9297; train_kl_reg_loss: 41569.2413; train_edge_recon_loss: 2641491.8753; train_gene_expr_recon_loss: 11658797.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14341858.3798; train_optim_loss: 14341858.3798; val_kl_reg_loss: 40916.1886; val_edge_recon_loss: 2692517.8773; val_gene_expr_recon_loss: 11773723.3455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14507157.3636; val_optim_loss: 14507157.3636
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9797; val_auprc_score: 0.9782; val_best_acc_score: 0.9292; val_best_f1_score: 0.9302; train_kl_reg_loss: 41406.5713; train_edge_recon_loss: 2638769.6637; train_gene_expr_recon_loss: 11652734.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14332910.6039; train_optim_loss: 14332910.6039; val_kl_reg_loss: 40083.9541; val_edge_recon_loss: 2692273.7727; val_gene_expr_recon_loss: 11776972.8091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14509330.5273; val_optim_loss: 14509330.5273
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9796; val_auprc_score: 0.9782; val_best_acc_score: 0.9304; val_best_f1_score: 0.9309; train_kl_reg_loss: 41236.0945; train_edge_recon_loss: 2637736.5644; train_gene_expr_recon_loss: 11650073.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14329045.8625; train_optim_loss: 14329045.8625; val_kl_reg_loss: 39791.7648; val_edge_recon_loss: 2690497.9318; val_gene_expr_recon_loss: 11785052.9182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14515342.6182; val_optim_loss: 14515342.6182
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9800; val_auprc_score: 0.9790; val_best_acc_score: 0.9306; val_best_f1_score: 0.9311; train_kl_reg_loss: 40840.1084; train_edge_recon_loss: 2638230.2592; train_gene_expr_recon_loss: 11643438.7566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14322509.1436; train_optim_loss: 14322509.1436; val_kl_reg_loss: 40436.7629; val_edge_recon_loss: 2688687.1273; val_gene_expr_recon_loss: 11765772.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14494896.7182; val_optim_loss: 14494896.7182
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9788; val_best_acc_score: 0.9312; val_best_f1_score: 0.9317; train_kl_reg_loss: 40673.5698; train_edge_recon_loss: 2637660.6095; train_gene_expr_recon_loss: 11640455.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14318789.4022; train_optim_loss: 14318789.4022; val_kl_reg_loss: 39394.6489; val_edge_recon_loss: 2687712.3795; val_gene_expr_recon_loss: 11753284.7364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14480391.8091; val_optim_loss: 14480391.8091
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9798; val_auprc_score: 0.9783; val_best_acc_score: 0.9297; val_best_f1_score: 0.9305; train_kl_reg_loss: 40708.9083; train_edge_recon_loss: 2639058.1141; train_gene_expr_recon_loss: 11732288.9919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14412056.0041; train_optim_loss: 14412056.0041; val_kl_reg_loss: 40128.9133; val_edge_recon_loss: 2689220.9864; val_gene_expr_recon_loss: 11805835.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14535185.4636; val_optim_loss: 14535185.4636
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9802; val_auprc_score: 0.9789; val_best_acc_score: 0.9301; val_best_f1_score: 0.9307; train_kl_reg_loss: 41024.7495; train_edge_recon_loss: 2634429.7419; train_gene_expr_recon_loss: 11639909.3401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14315363.8289; train_optim_loss: 14315363.8289; val_kl_reg_loss: 39629.7942; val_edge_recon_loss: 2690591.9386; val_gene_expr_recon_loss: 11743469.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14473691.2091; val_optim_loss: 14473691.2091
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9807; val_auprc_score: 0.9794; val_best_acc_score: 0.9320; val_best_f1_score: 0.9324; train_kl_reg_loss: 40346.4687; train_edge_recon_loss: 2635082.9221; train_gene_expr_recon_loss: 11631631.0377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14307060.4124; train_optim_loss: 14307060.4124; val_kl_reg_loss: 39520.2257; val_edge_recon_loss: 2684887.6841; val_gene_expr_recon_loss: 11753336.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14477743.9091; val_optim_loss: 14477743.9091
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9810; val_auprc_score: 0.9800; val_best_acc_score: 0.9321; val_best_f1_score: 0.9328; train_kl_reg_loss: 40053.8254; train_edge_recon_loss: 2634478.0484; train_gene_expr_recon_loss: 11627208.6436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14301740.5224; train_optim_loss: 14301740.5224; val_kl_reg_loss: 38870.5787; val_edge_recon_loss: 2686616.4614; val_gene_expr_recon_loss: 11755698.7364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14481185.7091; val_optim_loss: 14481185.7091
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9806; val_auprc_score: 0.9788; val_best_acc_score: 0.9319; val_best_f1_score: 0.9323; train_kl_reg_loss: 39920.0131; train_edge_recon_loss: 2634297.5028; train_gene_expr_recon_loss: 11619038.4450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14293255.9532; train_optim_loss: 14293255.9532; val_kl_reg_loss: 39187.0647; val_edge_recon_loss: 2686983.1114; val_gene_expr_recon_loss: 11744522.8364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14470692.9636; val_optim_loss: 14470692.9636
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9802; val_auprc_score: 0.9787; val_best_acc_score: 0.9312; val_best_f1_score: 0.9318; train_kl_reg_loss: 39633.5731; train_edge_recon_loss: 2635287.6316; train_gene_expr_recon_loss: 11619428.5550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14294349.7637; train_optim_loss: 14294349.7637; val_kl_reg_loss: 38940.9741; val_edge_recon_loss: 2688326.8909; val_gene_expr_recon_loss: 11764235.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14491503.7909; val_optim_loss: 14491503.7909
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9814; val_auprc_score: 0.9801; val_best_acc_score: 0.9337; val_best_f1_score: 0.9343; train_kl_reg_loss: 39474.8150; train_edge_recon_loss: 2633865.4038; train_gene_expr_recon_loss: 11619986.3157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14293326.5438; train_optim_loss: 14293326.5438; val_kl_reg_loss: 38410.6205; val_edge_recon_loss: 2685924.2250; val_gene_expr_recon_loss: 11750741.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14475076.4636; val_optim_loss: 14475076.4636
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9808; val_auprc_score: 0.9794; val_best_acc_score: 0.9317; val_best_f1_score: 0.9321; train_kl_reg_loss: 39192.1841; train_edge_recon_loss: 2633275.2836; train_gene_expr_recon_loss: 11621887.3004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14294354.7790; train_optim_loss: 14294354.7790; val_kl_reg_loss: 38207.9764; val_edge_recon_loss: 2685092.5682; val_gene_expr_recon_loss: 11753382.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14476683.5273; val_optim_loss: 14476683.5273
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9810; val_auprc_score: 0.9796; val_best_acc_score: 0.9327; val_best_f1_score: 0.9337; train_kl_reg_loss: 39111.7664; train_edge_recon_loss: 2632089.4066; train_gene_expr_recon_loss: 11618128.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14289329.4868; train_optim_loss: 14289329.4868; val_kl_reg_loss: 38012.4587; val_edge_recon_loss: 2685650.7795; val_gene_expr_recon_loss: 11739762.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14463425.4636; val_optim_loss: 14463425.4636
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9814; val_auprc_score: 0.9802; val_best_acc_score: 0.9327; val_best_f1_score: 0.9332; train_kl_reg_loss: 38944.5347; train_edge_recon_loss: 2631621.7421; train_gene_expr_recon_loss: 11610982.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14281548.8381; train_optim_loss: 14281548.8381; val_kl_reg_loss: 37746.8137; val_edge_recon_loss: 2685844.9500; val_gene_expr_recon_loss: 11745836.0636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14469427.8273; val_optim_loss: 14469427.8273
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9811; val_auprc_score: 0.9800; val_best_acc_score: 0.9326; val_best_f1_score: 0.9331; train_kl_reg_loss: 38786.4649; train_edge_recon_loss: 2633033.8885; train_gene_expr_recon_loss: 11612281.9481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14284102.3045; train_optim_loss: 14284102.3045; val_kl_reg_loss: 37342.9123; val_edge_recon_loss: 2684813.1182; val_gene_expr_recon_loss: 11746808.7818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14468964.8273; val_optim_loss: 14468964.8273
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9812; val_auprc_score: 0.9797; val_best_acc_score: 0.9326; val_best_f1_score: 0.9333; train_kl_reg_loss: 38581.0124; train_edge_recon_loss: 2631669.5983; train_gene_expr_recon_loss: 11611248.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14281499.1487; train_optim_loss: 14281499.1487; val_kl_reg_loss: 37742.1937; val_edge_recon_loss: 2684857.7386; val_gene_expr_recon_loss: 11745012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14467611.9727; val_optim_loss: 14467611.9727
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9816; val_auprc_score: 0.9798; val_best_acc_score: 0.9341; val_best_f1_score: 0.9350; train_kl_reg_loss: 38433.3370; train_edge_recon_loss: 2632603.9078; train_gene_expr_recon_loss: 11612505.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14283542.3116; train_optim_loss: 14283542.3116; val_kl_reg_loss: 37767.9793; val_edge_recon_loss: 2689810.2341; val_gene_expr_recon_loss: 11747968.8545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14475547.1000; val_optim_loss: 14475547.1000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9814; val_auprc_score: 0.9802; val_best_acc_score: 0.9333; val_best_f1_score: 0.9339; train_kl_reg_loss: 39184.3876; train_edge_recon_loss: 2628569.7923; train_gene_expr_recon_loss: 11518151.6711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14185905.8523; train_optim_loss: 14185905.8523; val_kl_reg_loss: 38247.3912; val_edge_recon_loss: 2685797.7932; val_gene_expr_recon_loss: 11647752.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14371797.5909; val_optim_loss: 14371797.5909
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9816; val_auprc_score: 0.9804; val_best_acc_score: 0.9336; val_best_f1_score: 0.9342; train_kl_reg_loss: 39357.2234; train_edge_recon_loss: 2628541.1163; train_gene_expr_recon_loss: 11507239.5550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14175137.9033; train_optim_loss: 14175137.9033; val_kl_reg_loss: 38575.6350; val_edge_recon_loss: 2681969.1318; val_gene_expr_recon_loss: 11655931.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14376476.6818; val_optim_loss: 14376476.6818
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9819; val_auprc_score: 0.9806; val_best_acc_score: 0.9343; val_best_f1_score: 0.9353; train_kl_reg_loss: 39289.9831; train_edge_recon_loss: 2628722.1041; train_gene_expr_recon_loss: 11506043.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14174055.4807; train_optim_loss: 14174055.4807; val_kl_reg_loss: 38520.6775; val_edge_recon_loss: 2678720.8000; val_gene_expr_recon_loss: 11663570.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14380811.9000; val_optim_loss: 14380811.9000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9817; val_auprc_score: 0.9804; val_best_acc_score: 0.9333; val_best_f1_score: 0.9339; train_kl_reg_loss: 39362.6129; train_edge_recon_loss: 2627694.4964; train_gene_expr_recon_loss: 11510235.4756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14177292.5886; train_optim_loss: 14177292.5886; val_kl_reg_loss: 38408.7723; val_edge_recon_loss: 2682585.7886; val_gene_expr_recon_loss: 11663673.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14384668.1000; val_optim_loss: 14384668.1000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9824; val_auprc_score: 0.9811; val_best_acc_score: 0.9354; val_best_f1_score: 0.9359; train_kl_reg_loss: 39192.3798; train_edge_recon_loss: 2628927.1815; train_gene_expr_recon_loss: 11507477.4521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14175596.9969; train_optim_loss: 14175596.9969; val_kl_reg_loss: 38311.0907; val_edge_recon_loss: 2680635.8545; val_gene_expr_recon_loss: 11648363.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14367310.6000; val_optim_loss: 14367310.6000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9817; val_auprc_score: 0.9805; val_best_acc_score: 0.9337; val_best_f1_score: 0.9343; train_kl_reg_loss: 39146.6430; train_edge_recon_loss: 2628838.3994; train_gene_expr_recon_loss: 11506842.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14174827.2352; train_optim_loss: 14174827.2352; val_kl_reg_loss: 38136.4164; val_edge_recon_loss: 2682097.7295; val_gene_expr_recon_loss: 11650427.7364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14370661.8818; val_optim_loss: 14370661.8818
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9821; val_auprc_score: 0.9807; val_best_acc_score: 0.9344; val_best_f1_score: 0.9350; train_kl_reg_loss: 39038.6532; train_edge_recon_loss: 2627604.1810; train_gene_expr_recon_loss: 11503523.1731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14170166.0010; train_optim_loss: 14170166.0010; val_kl_reg_loss: 38211.1940; val_edge_recon_loss: 2682773.1705; val_gene_expr_recon_loss: 11653917.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14374901.7000; val_optim_loss: 14374901.7000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9817; val_auprc_score: 0.9802; val_best_acc_score: 0.9350; val_best_f1_score: 0.9355; train_kl_reg_loss: 38987.6923; train_edge_recon_loss: 2627209.8549; train_gene_expr_recon_loss: 11501782.1721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167979.7251; train_optim_loss: 14167979.7251; val_kl_reg_loss: 38142.4093; val_edge_recon_loss: 2680575.3136; val_gene_expr_recon_loss: 11654103.6273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14372821.3364; val_optim_loss: 14372821.3364
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9823; val_auprc_score: 0.9811; val_best_acc_score: 0.9353; val_best_f1_score: 0.9358; train_kl_reg_loss: 38948.9136; train_edge_recon_loss: 2628350.1446; train_gene_expr_recon_loss: 11501230.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14168529.8788; train_optim_loss: 14168529.8788; val_kl_reg_loss: 38100.9729; val_edge_recon_loss: 2683307.4750; val_gene_expr_recon_loss: 11659457.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14380866.1727; val_optim_loss: 14380866.1727

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9820; val_auprc_score: 0.9808; val_best_acc_score: 0.9345; val_best_f1_score: 0.9350; train_kl_reg_loss: 39002.0884; train_edge_recon_loss: 2626777.1199; train_gene_expr_recon_loss: 11486215.5550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14151994.7841; train_optim_loss: 14151994.7841; val_kl_reg_loss: 38052.5692; val_edge_recon_loss: 2680908.2409; val_gene_expr_recon_loss: 11631268.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14350229.7000; val_optim_loss: 14350229.7000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9823; val_auprc_score: 0.9810; val_best_acc_score: 0.9356; val_best_f1_score: 0.9361; train_kl_reg_loss: 38990.6446; train_edge_recon_loss: 2627342.7146; train_gene_expr_recon_loss: 11486953.5621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14153286.9114; train_optim_loss: 14153286.9114; val_kl_reg_loss: 37972.4832; val_edge_recon_loss: 2675447.0386; val_gene_expr_recon_loss: 11657433.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14370852.9818; val_optim_loss: 14370852.9818
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9822; val_auprc_score: 0.9810; val_best_acc_score: 0.9350; val_best_f1_score: 0.9355; train_kl_reg_loss: 38930.4659; train_edge_recon_loss: 2627549.3149; train_gene_expr_recon_loss: 11488256.4440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14154736.2281; train_optim_loss: 14154736.2281; val_kl_reg_loss: 38009.4444; val_edge_recon_loss: 2680141.8386; val_gene_expr_recon_loss: 11635042.1545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14353193.3909; val_optim_loss: 14353193.3909
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9824; val_auprc_score: 0.9811; val_best_acc_score: 0.9357; val_best_f1_score: 0.9361; train_kl_reg_loss: 38938.0380; train_edge_recon_loss: 2627139.0519; train_gene_expr_recon_loss: 11486838.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14152915.4745; train_optim_loss: 14152915.4745; val_kl_reg_loss: 37994.0262; val_edge_recon_loss: 2679929.7068; val_gene_expr_recon_loss: 11644799.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14362722.9909; val_optim_loss: 14362722.9909
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9820; val_auprc_score: 0.9809; val_best_acc_score: 0.9340; val_best_f1_score: 0.9346; train_kl_reg_loss: 38889.9196; train_edge_recon_loss: 2627731.9129; train_gene_expr_recon_loss: 11486765.6191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14153387.4593; train_optim_loss: 14153387.4593; val_kl_reg_loss: 37990.2933; val_edge_recon_loss: 2683250.0409; val_gene_expr_recon_loss: 11632336.1636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14353576.4909; val_optim_loss: 14353576.4909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9820; val_auprc_score: 0.9808; val_best_acc_score: 0.9343; val_best_f1_score: 0.9350; train_kl_reg_loss: 38946.7704; train_edge_recon_loss: 2626226.0423; train_gene_expr_recon_loss: 11487626.9501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14152799.7556; train_optim_loss: 14152799.7556; val_kl_reg_loss: 37949.0466; val_edge_recon_loss: 2682518.3682; val_gene_expr_recon_loss: 11629650.8091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14350118.2182; val_optim_loss: 14350118.2182
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9818; val_auprc_score: 0.9802; val_best_acc_score: 0.9337; val_best_f1_score: 0.9344; train_kl_reg_loss: 38939.0081; train_edge_recon_loss: 2627576.8485; train_gene_expr_recon_loss: 11491128.2098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14157644.0703; train_optim_loss: 14157644.0703; val_kl_reg_loss: 37967.1422; val_edge_recon_loss: 2685332.4091; val_gene_expr_recon_loss: 11646851.3364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14370150.9091; val_optim_loss: 14370150.9091
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9820; val_auprc_score: 0.9809; val_best_acc_score: 0.9339; val_best_f1_score: 0.9345; train_kl_reg_loss: 38934.0840; train_edge_recon_loss: 2627192.8282; train_gene_expr_recon_loss: 11484649.6721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14150776.5866; train_optim_loss: 14150776.5866; val_kl_reg_loss: 37938.3980; val_edge_recon_loss: 2683370.4295; val_gene_expr_recon_loss: 11640571.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14361880.3000; val_optim_loss: 14361880.3000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9823; val_auprc_score: 0.9811; val_best_acc_score: 0.9348; val_best_f1_score: 0.9354; train_kl_reg_loss: 38931.1838; train_edge_recon_loss: 2627261.2678; train_gene_expr_recon_loss: 11482510.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14148702.7271; train_optim_loss: 14148702.7271; val_kl_reg_loss: 38012.3208; val_edge_recon_loss: 2682045.2864; val_gene_expr_recon_loss: 11640002.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14360060.5000; val_optim_loss: 14360060.5000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9825; val_auprc_score: 0.9815; val_best_acc_score: 0.9355; val_best_f1_score: 0.9361; train_kl_reg_loss: 38919.6844; train_edge_recon_loss: 2627140.7974; train_gene_expr_recon_loss: 11486739.3859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14152799.8605; train_optim_loss: 14152799.8605; val_kl_reg_loss: 37984.4739; val_edge_recon_loss: 2677207.1773; val_gene_expr_recon_loss: 11638890.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14354082.1636; val_optim_loss: 14354082.1636

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9828; val_auprc_score: 0.9817; val_best_acc_score: 0.9363; val_best_f1_score: 0.9367; train_kl_reg_loss: 38931.8703; train_edge_recon_loss: 2626723.5713; train_gene_expr_recon_loss: 11488355.9165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14154011.3544; train_optim_loss: 14154011.3544; val_kl_reg_loss: 37999.0575; val_edge_recon_loss: 2677762.7795; val_gene_expr_recon_loss: 11649652.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14365414.4000; val_optim_loss: 14365414.4000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9823; val_auprc_score: 0.9810; val_best_acc_score: 0.9354; val_best_f1_score: 0.9358; train_kl_reg_loss: 38933.5286; train_edge_recon_loss: 2627158.8483; train_gene_expr_recon_loss: 11486442.2566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14152534.6324; train_optim_loss: 14152534.6324; val_kl_reg_loss: 37986.9816; val_edge_recon_loss: 2679854.7614; val_gene_expr_recon_loss: 11623608.1091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14341449.8909; val_optim_loss: 14341449.8909
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9821; val_auprc_score: 0.9808; val_best_acc_score: 0.9352; val_best_f1_score: 0.9356; train_kl_reg_loss: 38929.1728; train_edge_recon_loss: 2627820.3447; train_gene_expr_recon_loss: 11486731.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14153481.2872; train_optim_loss: 14153481.2872; val_kl_reg_loss: 37963.4757; val_edge_recon_loss: 2680482.2045; val_gene_expr_recon_loss: 11633164.0364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14351609.7000; val_optim_loss: 14351609.7000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9819; val_auprc_score: 0.9806; val_best_acc_score: 0.9344; val_best_f1_score: 0.9349; train_kl_reg_loss: 38927.0742; train_edge_recon_loss: 2626901.8488; train_gene_expr_recon_loss: 11481615.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14147444.4206; train_optim_loss: 14147444.4206; val_kl_reg_loss: 37967.5247; val_edge_recon_loss: 2682737.4795; val_gene_expr_recon_loss: 11624269.6455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14344974.6636; val_optim_loss: 14344974.6636
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9824; val_auprc_score: 0.9813; val_best_acc_score: 0.9350; val_best_f1_score: 0.9355; train_kl_reg_loss: 38932.2987; train_edge_recon_loss: 2627850.4392; train_gene_expr_recon_loss: 11482740.0998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14149522.8442; train_optim_loss: 14149522.8442; val_kl_reg_loss: 37999.1460; val_edge_recon_loss: 2681418.2273; val_gene_expr_recon_loss: 11637473.4636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14356890.8545; val_optim_loss: 14356890.8545
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9823; val_auprc_score: 0.9809; val_best_acc_score: 0.9350; val_best_f1_score: 0.9355; train_kl_reg_loss: 38927.7060; train_edge_recon_loss: 2627003.6746; train_gene_expr_recon_loss: 11485437.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14151369.0957; train_optim_loss: 14151369.0957; val_kl_reg_loss: 37936.7550; val_edge_recon_loss: 2680289.1727; val_gene_expr_recon_loss: 11646596.2636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14364822.1818; val_optim_loss: 14364822.1818

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9822; val_auprc_score: 0.9809; val_best_acc_score: 0.9351; val_best_f1_score: 0.9355; train_kl_reg_loss: 38923.0625; train_edge_recon_loss: 2626652.9165; train_gene_expr_recon_loss: 11487327.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14152903.4756; train_optim_loss: 14152903.4756; val_kl_reg_loss: 37978.0345; val_edge_recon_loss: 2680017.5773; val_gene_expr_recon_loss: 11639973.9364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14357969.5273; val_optim_loss: 14357969.5273
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9818; val_auprc_score: 0.9805; val_best_acc_score: 0.9339; val_best_f1_score: 0.9347; train_kl_reg_loss: 38933.2320; train_edge_recon_loss: 2628561.3096; train_gene_expr_recon_loss: 11482843.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14150337.6701; train_optim_loss: 14150337.6701; val_kl_reg_loss: 37984.4172; val_edge_recon_loss: 2683809.2977; val_gene_expr_recon_loss: 11639721.6182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14361515.3818; val_optim_loss: 14361515.3818
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9823; val_auprc_score: 0.9810; val_best_acc_score: 0.9351; val_best_f1_score: 0.9356; train_kl_reg_loss: 38913.2164; train_edge_recon_loss: 2627237.3610; train_gene_expr_recon_loss: 11484614.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14150764.6436; train_optim_loss: 14150764.6436; val_kl_reg_loss: 37968.2977; val_edge_recon_loss: 2682332.2114; val_gene_expr_recon_loss: 11634721.3818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14355021.8818; val_optim_loss: 14355021.8818
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9820; val_auprc_score: 0.9808; val_best_acc_score: 0.9345; val_best_f1_score: 0.9350; train_kl_reg_loss: 38924.7190; train_edge_recon_loss: 2627394.8060; train_gene_expr_recon_loss: 11486917.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14153236.8758; train_optim_loss: 14153236.8758; val_kl_reg_loss: 38001.1314; val_edge_recon_loss: 2681040.0795; val_gene_expr_recon_loss: 11648043.1091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14367084.3091; val_optim_loss: 14367084.3091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 192 min 53 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
Val AUROC score: 0.9825
Val AUPRC score: 0.9813
Val best accuracy score: 0.9349
Val best F1 score: 0.9355
Val gene expr MSE score: 8.6956

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
