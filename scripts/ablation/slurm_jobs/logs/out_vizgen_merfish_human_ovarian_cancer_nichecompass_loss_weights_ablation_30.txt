None
Run timestamp: 03072023_091342_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9855; val_auprc_score: 0.9847; val_best_acc_score: 0.9394; val_best_f1_score: 0.9396; train_kl_reg_loss: 5583.8042; train_edge_recon_loss: 266207.2048; train_gene_expr_recon_loss: 18386.7341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 290177.7435; train_optim_loss: 290177.7435; val_kl_reg_loss: 5540.9657; val_edge_recon_loss: 262464.2214; val_gene_expr_recon_loss: 16405.2311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284410.4188; val_optim_loss: 284410.4188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9886; val_best_acc_score: 0.9502; val_best_f1_score: 0.9505; train_kl_reg_loss: 5608.1084; train_edge_recon_loss: 261420.9094; train_gene_expr_recon_loss: 15820.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282849.0719; train_optim_loss: 282849.0719; val_kl_reg_loss: 5494.6901; val_edge_recon_loss: 262061.5310; val_gene_expr_recon_loss: 15243.9824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282800.2050; val_optim_loss: 282800.2050
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9916; val_auprc_score: 0.9906; val_best_acc_score: 0.9566; val_best_f1_score: 0.9570; train_kl_reg_loss: 5608.9815; train_edge_recon_loss: 260660.4413; train_gene_expr_recon_loss: 14947.9629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281217.3858; train_optim_loss: 281217.3858; val_kl_reg_loss: 5585.7530; val_edge_recon_loss: 261488.3166; val_gene_expr_recon_loss: 14563.3991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281637.4699; val_optim_loss: 281637.4699
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9929; val_auprc_score: 0.9920; val_best_acc_score: 0.9607; val_best_f1_score: 0.9610; train_kl_reg_loss: 5624.1801; train_edge_recon_loss: 260328.5220; train_gene_expr_recon_loss: 14463.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280416.0909; train_optim_loss: 280416.0909; val_kl_reg_loss: 5467.6388; val_edge_recon_loss: 260816.0283; val_gene_expr_recon_loss: 14209.3447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280493.0096; val_optim_loss: 280493.0096
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9933; val_auprc_score: 0.9927; val_best_acc_score: 0.9618; val_best_f1_score: 0.9620; train_kl_reg_loss: 5635.0458; train_edge_recon_loss: 260074.0069; train_gene_expr_recon_loss: 14190.1915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279899.2447; train_optim_loss: 279899.2447; val_kl_reg_loss: 5566.5568; val_edge_recon_loss: 260633.5000; val_gene_expr_recon_loss: 13993.9866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280194.0426; val_optim_loss: 280194.0426
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9933; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 5652.8568; train_edge_recon_loss: 259785.4034; train_gene_expr_recon_loss: 14000.1587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279438.4191; train_optim_loss: 279438.4191; val_kl_reg_loss: 5625.7940; val_edge_recon_loss: 260202.3984; val_gene_expr_recon_loss: 13815.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279644.0444; val_optim_loss: 279644.0444
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9939; val_best_acc_score: 0.9663; val_best_f1_score: 0.9663; train_kl_reg_loss: 5677.0201; train_edge_recon_loss: 259594.6920; train_gene_expr_recon_loss: 13842.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279114.2373; train_optim_loss: 279114.2373; val_kl_reg_loss: 5659.2365; val_edge_recon_loss: 260300.2859; val_gene_expr_recon_loss: 13654.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279614.0970; val_optim_loss: 279614.0970
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9939; val_best_acc_score: 0.9666; val_best_f1_score: 0.9668; train_kl_reg_loss: 5697.4617; train_edge_recon_loss: 259413.3080; train_gene_expr_recon_loss: 13709.3778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278820.1476; train_optim_loss: 278820.1476; val_kl_reg_loss: 5427.3989; val_edge_recon_loss: 260133.8315; val_gene_expr_recon_loss: 13573.2893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279134.5196; val_optim_loss: 279134.5196
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9940; val_best_acc_score: 0.9673; val_best_f1_score: 0.9674; train_kl_reg_loss: 5708.4643; train_edge_recon_loss: 259260.5378; train_gene_expr_recon_loss: 13601.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278570.1174; train_optim_loss: 278570.1174; val_kl_reg_loss: 5606.3136; val_edge_recon_loss: 260317.4175; val_gene_expr_recon_loss: 13472.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279396.4617; val_optim_loss: 279396.4617
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9944; val_best_acc_score: 0.9684; val_best_f1_score: 0.9686; train_kl_reg_loss: 5721.3348; train_edge_recon_loss: 259129.1031; train_gene_expr_recon_loss: 13507.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278358.3009; train_optim_loss: 278358.3009; val_kl_reg_loss: 5782.7928; val_edge_recon_loss: 259999.3658; val_gene_expr_recon_loss: 13340.6808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279122.8411; val_optim_loss: 279122.8411
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9951; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 5734.6113; train_edge_recon_loss: 259031.7157; train_gene_expr_recon_loss: 13442.3294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278208.6560; train_optim_loss: 278208.6560; val_kl_reg_loss: 5756.4488; val_edge_recon_loss: 259711.3972; val_gene_expr_recon_loss: 13321.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278789.7290; val_optim_loss: 278789.7290
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9706; val_best_f1_score: 0.9708; train_kl_reg_loss: 5740.6697; train_edge_recon_loss: 258983.4489; train_gene_expr_recon_loss: 13387.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278111.3067; train_optim_loss: 278111.3067; val_kl_reg_loss: 5692.5589; val_edge_recon_loss: 259894.7550; val_gene_expr_recon_loss: 13242.9564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278830.2710; val_optim_loss: 278830.2710
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9707; val_best_f1_score: 0.9708; train_kl_reg_loss: 5748.4745; train_edge_recon_loss: 258874.1894; train_gene_expr_recon_loss: 13349.8272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277972.4912; train_optim_loss: 277972.4912; val_kl_reg_loss: 5582.8162; val_edge_recon_loss: 259373.0682; val_gene_expr_recon_loss: 13252.4657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278208.3516; val_optim_loss: 278208.3516
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 5754.1667; train_edge_recon_loss: 258825.2160; train_gene_expr_recon_loss: 13303.5617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277882.9444; train_optim_loss: 277882.9444; val_kl_reg_loss: 5663.3363; val_edge_recon_loss: 259678.3797; val_gene_expr_recon_loss: 13191.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278533.3619; val_optim_loss: 278533.3619
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 5760.3504; train_edge_recon_loss: 258714.5509; train_gene_expr_recon_loss: 13274.2730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277749.1746; train_optim_loss: 277749.1746; val_kl_reg_loss: 5720.5732; val_edge_recon_loss: 259607.6716; val_gene_expr_recon_loss: 13133.0254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278461.2707; val_optim_loss: 278461.2707
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9741; val_best_f1_score: 0.9742; train_kl_reg_loss: 5764.8669; train_edge_recon_loss: 258696.3115; train_gene_expr_recon_loss: 13249.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277710.8970; train_optim_loss: 277710.8970; val_kl_reg_loss: 5773.6729; val_edge_recon_loss: 259399.8693; val_gene_expr_recon_loss: 13108.8565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278282.4004; val_optim_loss: 278282.4004
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 5773.4238; train_edge_recon_loss: 258591.1208; train_gene_expr_recon_loss: 13230.7572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277595.3017; train_optim_loss: 277595.3017; val_kl_reg_loss: 5651.6916; val_edge_recon_loss: 259158.1922; val_gene_expr_recon_loss: 13106.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277916.3674; val_optim_loss: 277916.3674
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 5776.1788; train_edge_recon_loss: 258562.2979; train_gene_expr_recon_loss: 13202.1039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277540.5807; train_optim_loss: 277540.5807; val_kl_reg_loss: 5668.9072; val_edge_recon_loss: 259179.1558; val_gene_expr_recon_loss: 13094.4149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277942.4790; val_optim_loss: 277942.4790
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9745; val_best_f1_score: 0.9746; train_kl_reg_loss: 5780.6251; train_edge_recon_loss: 258500.4788; train_gene_expr_recon_loss: 13181.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277462.5247; train_optim_loss: 277462.5247; val_kl_reg_loss: 5686.8131; val_edge_recon_loss: 259193.8597; val_gene_expr_recon_loss: 13057.5190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277938.1928; val_optim_loss: 277938.1928
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 5785.6583; train_edge_recon_loss: 258431.2602; train_gene_expr_recon_loss: 13170.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277387.0657; train_optim_loss: 277387.0657; val_kl_reg_loss: 5661.6649; val_edge_recon_loss: 259129.7791; val_gene_expr_recon_loss: 13047.2464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277838.6904; val_optim_loss: 277838.6904
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 5786.4902; train_edge_recon_loss: 258492.5980; train_gene_expr_recon_loss: 13150.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277429.5846; train_optim_loss: 277429.5846; val_kl_reg_loss: 5877.0145; val_edge_recon_loss: 258795.5413; val_gene_expr_recon_loss: 13015.5876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277688.1446; val_optim_loss: 277688.1446
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 5793.5020; train_edge_recon_loss: 258363.5138; train_gene_expr_recon_loss: 13133.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277290.3490; train_optim_loss: 277290.3490; val_kl_reg_loss: 5621.9185; val_edge_recon_loss: 258811.0051; val_gene_expr_recon_loss: 13027.2312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277460.1565; val_optim_loss: 277460.1565
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9756; val_best_f1_score: 0.9757; train_kl_reg_loss: 5797.2692; train_edge_recon_loss: 258317.5511; train_gene_expr_recon_loss: 13127.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277242.6808; train_optim_loss: 277242.6808; val_kl_reg_loss: 5617.3245; val_edge_recon_loss: 259020.1711; val_gene_expr_recon_loss: 13030.9955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277668.4918; val_optim_loss: 277668.4918
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 5798.9210; train_edge_recon_loss: 258238.3555; train_gene_expr_recon_loss: 13112.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277149.7773; train_optim_loss: 277149.7773; val_kl_reg_loss: 5656.7543; val_edge_recon_loss: 258860.3071; val_gene_expr_recon_loss: 12987.4827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277504.5444; val_optim_loss: 277504.5444
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 5800.1589; train_edge_recon_loss: 258300.3164; train_gene_expr_recon_loss: 13094.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277195.4427; train_optim_loss: 277195.4427; val_kl_reg_loss: 5696.3726; val_edge_recon_loss: 258840.9661; val_gene_expr_recon_loss: 12987.9165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277525.2553; val_optim_loss: 277525.2553
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9765; val_best_f1_score: 0.9767; train_kl_reg_loss: 5803.3682; train_edge_recon_loss: 258236.5402; train_gene_expr_recon_loss: 13090.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277130.3069; train_optim_loss: 277130.3069; val_kl_reg_loss: 5774.6054; val_edge_recon_loss: 258770.4956; val_gene_expr_recon_loss: 12990.5127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277535.6124; val_optim_loss: 277535.6124

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9967; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 5797.2859; train_edge_recon_loss: 257914.9372; train_gene_expr_recon_loss: 13030.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276743.1903; train_optim_loss: 276743.1903; val_kl_reg_loss: 5769.8283; val_edge_recon_loss: 258372.6938; val_gene_expr_recon_loss: 12922.4550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277064.9758; val_optim_loss: 277064.9758
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 5791.1176; train_edge_recon_loss: 257951.6188; train_gene_expr_recon_loss: 13018.3950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276761.1313; train_optim_loss: 276761.1313; val_kl_reg_loss: 5748.8030; val_edge_recon_loss: 258378.6094; val_gene_expr_recon_loss: 12913.6987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277041.1092; val_optim_loss: 277041.1092
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9784; val_best_f1_score: 0.9784; train_kl_reg_loss: 5790.6192; train_edge_recon_loss: 257828.6425; train_gene_expr_recon_loss: 13017.7850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276637.0463; train_optim_loss: 276637.0463; val_kl_reg_loss: 5776.3197; val_edge_recon_loss: 258445.4587; val_gene_expr_recon_loss: 12921.0800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277142.8578; val_optim_loss: 277142.8578
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 5786.7482; train_edge_recon_loss: 257882.4916; train_gene_expr_recon_loss: 13011.5305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276680.7703; train_optim_loss: 276680.7703; val_kl_reg_loss: 5733.6410; val_edge_recon_loss: 258417.4958; val_gene_expr_recon_loss: 12920.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277071.1600; val_optim_loss: 277071.1600
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 5780.9200; train_edge_recon_loss: 257888.9790; train_gene_expr_recon_loss: 13014.2848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276684.1836; train_optim_loss: 276684.1836; val_kl_reg_loss: 5733.1846; val_edge_recon_loss: 258593.5159; val_gene_expr_recon_loss: 12905.4607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277232.1595; val_optim_loss: 277232.1595
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9790; val_best_f1_score: 0.9790; train_kl_reg_loss: 5780.0832; train_edge_recon_loss: 257853.8038; train_gene_expr_recon_loss: 13009.6488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276643.5356; train_optim_loss: 276643.5356; val_kl_reg_loss: 5740.4516; val_edge_recon_loss: 258310.0480; val_gene_expr_recon_loss: 12910.4890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276960.9871; val_optim_loss: 276960.9871
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 5780.6600; train_edge_recon_loss: 257835.6089; train_gene_expr_recon_loss: 13003.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276620.1350; train_optim_loss: 276620.1350; val_kl_reg_loss: 5719.2608; val_edge_recon_loss: 258225.4857; val_gene_expr_recon_loss: 12898.8784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276843.6241; val_optim_loss: 276843.6241
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9789; val_best_f1_score: 0.9790; train_kl_reg_loss: 5779.5195; train_edge_recon_loss: 257853.3494; train_gene_expr_recon_loss: 13003.3142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276636.1833; train_optim_loss: 276636.1833; val_kl_reg_loss: 5784.7391; val_edge_recon_loss: 258414.0572; val_gene_expr_recon_loss: 12900.5504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277099.3478; val_optim_loss: 277099.3478
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 5780.1742; train_edge_recon_loss: 257781.8199; train_gene_expr_recon_loss: 12999.6461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276561.6398; train_optim_loss: 276561.6398; val_kl_reg_loss: 5730.6308; val_edge_recon_loss: 258259.6691; val_gene_expr_recon_loss: 12907.6379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276897.9369; val_optim_loss: 276897.9369
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 5779.4490; train_edge_recon_loss: 257800.8579; train_gene_expr_recon_loss: 13002.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276583.2733; train_optim_loss: 276583.2733; val_kl_reg_loss: 5738.8909; val_edge_recon_loss: 258209.9974; val_gene_expr_recon_loss: 12913.7186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276862.6081; val_optim_loss: 276862.6081
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 5778.7706; train_edge_recon_loss: 257772.6314; train_gene_expr_recon_loss: 12998.2467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276549.6481; train_optim_loss: 276549.6481; val_kl_reg_loss: 5721.5284; val_edge_recon_loss: 258294.9204; val_gene_expr_recon_loss: 12907.2987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276923.7485; val_optim_loss: 276923.7485

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 5778.9377; train_edge_recon_loss: 257832.4034; train_gene_expr_recon_loss: 12993.2458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276604.5861; train_optim_loss: 276604.5861; val_kl_reg_loss: 5724.5431; val_edge_recon_loss: 258329.1634; val_gene_expr_recon_loss: 12899.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276952.8072; val_optim_loss: 276952.8072
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 5778.2345; train_edge_recon_loss: 257760.8572; train_gene_expr_recon_loss: 12992.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276531.7806; train_optim_loss: 276531.7806; val_kl_reg_loss: 5733.8753; val_edge_recon_loss: 258184.5631; val_gene_expr_recon_loss: 12893.7637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276812.2024; val_optim_loss: 276812.2024
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 5778.9662; train_edge_recon_loss: 257737.9044; train_gene_expr_recon_loss: 12989.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276506.3500; train_optim_loss: 276506.3500; val_kl_reg_loss: 5739.1549; val_edge_recon_loss: 258071.1085; val_gene_expr_recon_loss: 12896.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276707.2374; val_optim_loss: 276707.2374
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 5776.6333; train_edge_recon_loss: 257722.7758; train_gene_expr_recon_loss: 12993.4205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276492.8298; train_optim_loss: 276492.8298; val_kl_reg_loss: 5740.5857; val_edge_recon_loss: 258116.3690; val_gene_expr_recon_loss: 12894.9918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276751.9457; val_optim_loss: 276751.9457
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 5775.9555; train_edge_recon_loss: 257759.9098; train_gene_expr_recon_loss: 12989.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276525.8025; train_optim_loss: 276525.8025; val_kl_reg_loss: 5727.5740; val_edge_recon_loss: 258253.4781; val_gene_expr_recon_loss: 12898.0232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276879.0742; val_optim_loss: 276879.0742
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 5776.1517; train_edge_recon_loss: 257728.0106; train_gene_expr_recon_loss: 12988.5929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276492.7547; train_optim_loss: 276492.7547; val_kl_reg_loss: 5749.2224; val_edge_recon_loss: 258466.4251; val_gene_expr_recon_loss: 12897.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277112.8820; val_optim_loss: 277112.8820
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 5778.1454; train_edge_recon_loss: 257684.7482; train_gene_expr_recon_loss: 12992.7483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276455.6420; train_optim_loss: 276455.6420; val_kl_reg_loss: 5738.4361; val_edge_recon_loss: 258231.3820; val_gene_expr_recon_loss: 12891.6572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276861.4758; val_optim_loss: 276861.4758

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9793; val_best_f1_score: 0.9793; train_kl_reg_loss: 5777.4183; train_edge_recon_loss: 257758.3159; train_gene_expr_recon_loss: 12991.7602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276527.4946; train_optim_loss: 276527.4946; val_kl_reg_loss: 5729.3429; val_edge_recon_loss: 258397.1676; val_gene_expr_recon_loss: 12882.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277009.0251; val_optim_loss: 277009.0251
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5775.3238; train_edge_recon_loss: 257774.3842; train_gene_expr_recon_loss: 12989.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276538.7700; train_optim_loss: 276538.7700; val_kl_reg_loss: 5728.5714; val_edge_recon_loss: 258430.4394; val_gene_expr_recon_loss: 12892.8918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277051.9030; val_optim_loss: 277051.9030
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 5776.2924; train_edge_recon_loss: 257734.1378; train_gene_expr_recon_loss: 12986.7895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276497.2201; train_optim_loss: 276497.2201; val_kl_reg_loss: 5729.3134; val_edge_recon_loss: 258187.2729; val_gene_expr_recon_loss: 12903.0408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276819.6259; val_optim_loss: 276819.6259
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5776.8005; train_edge_recon_loss: 257760.5298; train_gene_expr_recon_loss: 12984.6861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276522.0166; train_optim_loss: 276522.0166; val_kl_reg_loss: 5734.3832; val_edge_recon_loss: 258312.8839; val_gene_expr_recon_loss: 12879.6175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276926.8852; val_optim_loss: 276926.8852

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 327 min 57 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9970
Val best accuracy score: 0.9796
Val best F1 score: 0.9797
Val gene expr MSE score: 8.8777

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
