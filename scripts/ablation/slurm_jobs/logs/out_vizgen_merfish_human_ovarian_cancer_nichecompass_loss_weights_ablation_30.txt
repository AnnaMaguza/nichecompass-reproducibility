None
Run timestamp: 06072023_062425_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9875; val_auprc_score: 0.9868; val_best_acc_score: 0.9442; val_best_f1_score: 0.9443; train_kl_reg_loss: 5626.8968; train_edge_recon_loss: 264759.9935; train_gene_expr_recon_loss: 17323.0578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 287709.9486; train_optim_loss: 287709.9486; val_kl_reg_loss: 5524.1597; val_edge_recon_loss: 262248.5663; val_gene_expr_recon_loss: 15597.4251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283370.1517; val_optim_loss: 283370.1517
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9907; val_auprc_score: 0.9901; val_best_acc_score: 0.9535; val_best_f1_score: 0.9537; train_kl_reg_loss: 5637.1434; train_edge_recon_loss: 260939.1103; train_gene_expr_recon_loss: 14948.2890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281524.5428; train_optim_loss: 281524.5428; val_kl_reg_loss: 5578.5367; val_edge_recon_loss: 261547.3586; val_gene_expr_recon_loss: 14457.8822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281583.7779; val_optim_loss: 281583.7779
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9605; val_best_f1_score: 0.9606; train_kl_reg_loss: 5666.8166; train_edge_recon_loss: 260322.1714; train_gene_expr_recon_loss: 14257.2085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280246.1964; train_optim_loss: 280246.1964; val_kl_reg_loss: 5511.9864; val_edge_recon_loss: 260545.9832; val_gene_expr_recon_loss: 13966.9217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280024.8917; val_optim_loss: 280024.8917
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9932; val_best_acc_score: 0.9648; val_best_f1_score: 0.9650; train_kl_reg_loss: 5689.5848; train_edge_recon_loss: 259894.4815; train_gene_expr_recon_loss: 13918.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279502.1599; train_optim_loss: 279502.1599; val_kl_reg_loss: 5708.8447; val_edge_recon_loss: 260212.8914; val_gene_expr_recon_loss: 13688.2654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279610.0038; val_optim_loss: 279610.0038
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9931; val_best_acc_score: 0.9640; val_best_f1_score: 0.9641; train_kl_reg_loss: 5714.7706; train_edge_recon_loss: 259585.7597; train_gene_expr_recon_loss: 13700.2455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279000.7761; train_optim_loss: 279000.7761; val_kl_reg_loss: 5651.5843; val_edge_recon_loss: 260524.3787; val_gene_expr_recon_loss: 13519.1414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279695.1046; val_optim_loss: 279695.1046
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9680; val_best_f1_score: 0.9683; train_kl_reg_loss: 5734.4812; train_edge_recon_loss: 259322.0692; train_gene_expr_recon_loss: 13556.7239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278613.2745; train_optim_loss: 278613.2745; val_kl_reg_loss: 5697.5398; val_edge_recon_loss: 260051.4575; val_gene_expr_recon_loss: 13358.7579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279107.7551; val_optim_loss: 279107.7551
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9691; val_best_f1_score: 0.9692; train_kl_reg_loss: 5749.8898; train_edge_recon_loss: 259303.4296; train_gene_expr_recon_loss: 13461.0845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278514.4040; train_optim_loss: 278514.4040; val_kl_reg_loss: 5611.1848; val_edge_recon_loss: 259945.6034; val_gene_expr_recon_loss: 13325.2093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278881.9969; val_optim_loss: 278881.9969
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9952; val_auprc_score: 0.9945; val_best_acc_score: 0.9701; val_best_f1_score: 0.9702; train_kl_reg_loss: 5762.7958; train_edge_recon_loss: 259062.2112; train_gene_expr_recon_loss: 13395.2961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278220.3033; train_optim_loss: 278220.3033; val_kl_reg_loss: 5700.7865; val_edge_recon_loss: 259938.9513; val_gene_expr_recon_loss: 13236.2452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278875.9836; val_optim_loss: 278875.9836
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9954; val_auprc_score: 0.9948; val_best_acc_score: 0.9701; val_best_f1_score: 0.9703; train_kl_reg_loss: 5771.0348; train_edge_recon_loss: 259018.9351; train_gene_expr_recon_loss: 13338.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278128.6556; train_optim_loss: 278128.6556; val_kl_reg_loss: 5590.0392; val_edge_recon_loss: 259690.0891; val_gene_expr_recon_loss: 13228.1469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278508.2748; val_optim_loss: 278508.2748
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9951; val_best_acc_score: 0.9711; val_best_f1_score: 0.9713; train_kl_reg_loss: 5783.3826; train_edge_recon_loss: 258825.1459; train_gene_expr_recon_loss: 13297.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277906.1717; train_optim_loss: 277906.1717; val_kl_reg_loss: 5763.8129; val_edge_recon_loss: 259711.1858; val_gene_expr_recon_loss: 13212.6337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278687.6319; val_optim_loss: 278687.6319
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 5787.3318; train_edge_recon_loss: 258785.0400; train_gene_expr_recon_loss: 13260.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277832.4813; train_optim_loss: 277832.4813; val_kl_reg_loss: 5863.8032; val_edge_recon_loss: 259458.9283; val_gene_expr_recon_loss: 13123.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278445.9296; val_optim_loss: 278445.9296
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9725; val_best_f1_score: 0.9727; train_kl_reg_loss: 5794.6845; train_edge_recon_loss: 258700.0589; train_gene_expr_recon_loss: 13233.2658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277728.0091; train_optim_loss: 277728.0091; val_kl_reg_loss: 5798.6669; val_edge_recon_loss: 259465.2595; val_gene_expr_recon_loss: 13112.1440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278376.0694; val_optim_loss: 278376.0694
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 5803.2928; train_edge_recon_loss: 258587.0201; train_gene_expr_recon_loss: 13203.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277593.5166; train_optim_loss: 277593.5166; val_kl_reg_loss: 5671.7375; val_edge_recon_loss: 259237.7457; val_gene_expr_recon_loss: 13070.5427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277980.0257; val_optim_loss: 277980.0257
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 5806.6732; train_edge_recon_loss: 258557.8612; train_gene_expr_recon_loss: 13182.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277547.3447; train_optim_loss: 277547.3447; val_kl_reg_loss: 5836.8771; val_edge_recon_loss: 259329.6376; val_gene_expr_recon_loss: 13045.5620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278212.0763; val_optim_loss: 278212.0763
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9957; val_best_acc_score: 0.9740; val_best_f1_score: 0.9740; train_kl_reg_loss: 5810.9470; train_edge_recon_loss: 258491.2100; train_gene_expr_recon_loss: 13161.7484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277463.9053; train_optim_loss: 277463.9053; val_kl_reg_loss: 5696.5674; val_edge_recon_loss: 259087.9727; val_gene_expr_recon_loss: 13044.3996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277828.9393; val_optim_loss: 277828.9393
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 5814.9431; train_edge_recon_loss: 258412.1892; train_gene_expr_recon_loss: 13154.7024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277381.8346; train_optim_loss: 277381.8346; val_kl_reg_loss: 5983.4765; val_edge_recon_loss: 259054.4614; val_gene_expr_recon_loss: 13017.9114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278055.8476; val_optim_loss: 278055.8476
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 5816.5066; train_edge_recon_loss: 258388.3075; train_gene_expr_recon_loss: 13136.1899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277341.0039; train_optim_loss: 277341.0039; val_kl_reg_loss: 5708.4454; val_edge_recon_loss: 258797.2149; val_gene_expr_recon_loss: 13023.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277528.8763; val_optim_loss: 277528.8763
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 5820.9296; train_edge_recon_loss: 258290.1000; train_gene_expr_recon_loss: 13123.3858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277234.4156; train_optim_loss: 277234.4156; val_kl_reg_loss: 5809.6643; val_edge_recon_loss: 258834.3952; val_gene_expr_recon_loss: 13018.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277662.9379; val_optim_loss: 277662.9379
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 5822.3331; train_edge_recon_loss: 258328.6746; train_gene_expr_recon_loss: 13122.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277273.8359; train_optim_loss: 277273.8359; val_kl_reg_loss: 5841.7824; val_edge_recon_loss: 258848.2987; val_gene_expr_recon_loss: 12996.7197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277686.8009; val_optim_loss: 277686.8009
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9753; val_best_f1_score: 0.9754; train_kl_reg_loss: 5826.1288; train_edge_recon_loss: 258237.7752; train_gene_expr_recon_loss: 13113.3799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277177.2836; train_optim_loss: 277177.2836; val_kl_reg_loss: 5721.8169; val_edge_recon_loss: 258766.3288; val_gene_expr_recon_loss: 12998.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277486.8674; val_optim_loss: 277486.8674
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 5828.5213; train_edge_recon_loss: 258195.4613; train_gene_expr_recon_loss: 13108.2565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277132.2391; train_optim_loss: 277132.2391; val_kl_reg_loss: 5886.0100; val_edge_recon_loss: 258561.1509; val_gene_expr_recon_loss: 12987.9820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277435.1429; val_optim_loss: 277435.1429
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9961; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 5829.6068; train_edge_recon_loss: 258131.3005; train_gene_expr_recon_loss: 13099.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277060.1209; train_optim_loss: 277060.1209; val_kl_reg_loss: 5815.9752; val_edge_recon_loss: 258752.6014; val_gene_expr_recon_loss: 12994.1930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277562.7686; val_optim_loss: 277562.7686
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 5832.2759; train_edge_recon_loss: 258121.7745; train_gene_expr_recon_loss: 13096.0374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277050.0880; train_optim_loss: 277050.0880; val_kl_reg_loss: 5931.1704; val_edge_recon_loss: 258560.5065; val_gene_expr_recon_loss: 12955.5426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277447.2201; val_optim_loss: 277447.2201
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 5835.7273; train_edge_recon_loss: 258032.5810; train_gene_expr_recon_loss: 13084.9953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276953.3038; train_optim_loss: 276953.3038; val_kl_reg_loss: 5779.3138; val_edge_recon_loss: 258326.5815; val_gene_expr_recon_loss: 12958.1665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277064.0613; val_optim_loss: 277064.0613
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 5836.9619; train_edge_recon_loss: 258008.7928; train_gene_expr_recon_loss: 13081.8111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276927.5656; train_optim_loss: 276927.5656; val_kl_reg_loss: 5915.1183; val_edge_recon_loss: 258554.5663; val_gene_expr_recon_loss: 12961.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277430.8345; val_optim_loss: 277430.8345
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9967; val_auprc_score: 0.9963; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 5838.3990; train_edge_recon_loss: 257993.5619; train_gene_expr_recon_loss: 13082.1423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276914.1031; train_optim_loss: 276914.1031; val_kl_reg_loss: 5865.8882; val_edge_recon_loss: 258531.3476; val_gene_expr_recon_loss: 12975.2423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277372.4781; val_optim_loss: 277372.4781
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 5840.7153; train_edge_recon_loss: 257892.0446; train_gene_expr_recon_loss: 13080.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276813.5694; train_optim_loss: 276813.5694; val_kl_reg_loss: 5902.3117; val_edge_recon_loss: 258375.2389; val_gene_expr_recon_loss: 12950.9290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277228.4792; val_optim_loss: 277228.4792
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9782; val_best_f1_score: 0.9782; train_kl_reg_loss: 5841.7766; train_edge_recon_loss: 257898.4530; train_gene_expr_recon_loss: 13076.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276816.9633; train_optim_loss: 276816.9633; val_kl_reg_loss: 5906.1733; val_edge_recon_loss: 258217.3690; val_gene_expr_recon_loss: 12947.0116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277070.5536; val_optim_loss: 277070.5536

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 5831.5739; train_edge_recon_loss: 257601.3669; train_gene_expr_recon_loss: 13000.2030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276433.1435; train_optim_loss: 276433.1435; val_kl_reg_loss: 5796.2262; val_edge_recon_loss: 258025.4565; val_gene_expr_recon_loss: 12876.3761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276698.0609; val_optim_loss: 276698.0609
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 5826.7293; train_edge_recon_loss: 257503.2679; train_gene_expr_recon_loss: 12990.4653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276320.4628; train_optim_loss: 276320.4628; val_kl_reg_loss: 5784.5649; val_edge_recon_loss: 257862.3548; val_gene_expr_recon_loss: 12883.5004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276530.4200; val_optim_loss: 276530.4200
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5820.8752; train_edge_recon_loss: 257513.9730; train_gene_expr_recon_loss: 12983.6258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276318.4740; train_optim_loss: 276318.4740; val_kl_reg_loss: 5764.9602; val_edge_recon_loss: 257975.9993; val_gene_expr_recon_loss: 12875.7359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276616.6951; val_optim_loss: 276616.6951
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9805; val_best_f1_score: 0.9805; train_kl_reg_loss: 5814.6763; train_edge_recon_loss: 257554.8247; train_gene_expr_recon_loss: 12987.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276356.8673; train_optim_loss: 276356.8673; val_kl_reg_loss: 5808.4054; val_edge_recon_loss: 257966.8158; val_gene_expr_recon_loss: 12883.0669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276658.2877; val_optim_loss: 276658.2877
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 5817.5834; train_edge_recon_loss: 257447.9613; train_gene_expr_recon_loss: 12979.5373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276245.0820; train_optim_loss: 276245.0820; val_kl_reg_loss: 5792.5442; val_edge_recon_loss: 257757.4971; val_gene_expr_recon_loss: 12866.7398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276416.7814; val_optim_loss: 276416.7814
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 5814.7399; train_edge_recon_loss: 257444.2466; train_gene_expr_recon_loss: 12977.6526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276236.6393; train_optim_loss: 276236.6393; val_kl_reg_loss: 5809.1576; val_edge_recon_loss: 257892.2163; val_gene_expr_recon_loss: 12869.8285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276571.2025; val_optim_loss: 276571.2025
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 5810.8888; train_edge_recon_loss: 257448.9898; train_gene_expr_recon_loss: 12976.5891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276236.4676; train_optim_loss: 276236.4676; val_kl_reg_loss: 5788.7795; val_edge_recon_loss: 258055.6109; val_gene_expr_recon_loss: 12864.2424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276708.6329; val_optim_loss: 276708.6329
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9809; val_best_f1_score: 0.9809; train_kl_reg_loss: 5810.9296; train_edge_recon_loss: 257459.8421; train_gene_expr_recon_loss: 12979.5483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276250.3201; train_optim_loss: 276250.3201; val_kl_reg_loss: 5749.2817; val_edge_recon_loss: 257759.5688; val_gene_expr_recon_loss: 12881.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276390.4529; val_optim_loss: 276390.4529
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 5809.2657; train_edge_recon_loss: 257409.7023; train_gene_expr_recon_loss: 12978.2406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276197.2089; train_optim_loss: 276197.2089; val_kl_reg_loss: 5787.9160; val_edge_recon_loss: 257854.1372; val_gene_expr_recon_loss: 12856.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276498.5144; val_optim_loss: 276498.5144
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9812; val_best_f1_score: 0.9812; train_kl_reg_loss: 5807.2366; train_edge_recon_loss: 257431.9157; train_gene_expr_recon_loss: 12973.1543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276212.3068; train_optim_loss: 276212.3068; val_kl_reg_loss: 5734.2493; val_edge_recon_loss: 257743.0852; val_gene_expr_recon_loss: 12862.5293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276339.8633; val_optim_loss: 276339.8633
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5807.9983; train_edge_recon_loss: 257459.0846; train_gene_expr_recon_loss: 12975.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276242.4920; train_optim_loss: 276242.4920; val_kl_reg_loss: 5773.5822; val_edge_recon_loss: 257583.6555; val_gene_expr_recon_loss: 12863.3670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276220.6046; val_optim_loss: 276220.6046
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5806.1889; train_edge_recon_loss: 257476.2545; train_gene_expr_recon_loss: 12973.4692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276255.9126; train_optim_loss: 276255.9126; val_kl_reg_loss: 5790.0756; val_edge_recon_loss: 257781.6523; val_gene_expr_recon_loss: 12866.7393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276438.4668; val_optim_loss: 276438.4668
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9815; val_best_f1_score: 0.9816; train_kl_reg_loss: 5807.1577; train_edge_recon_loss: 257434.9506; train_gene_expr_recon_loss: 12971.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276213.9026; train_optim_loss: 276213.9026; val_kl_reg_loss: 5754.1891; val_edge_recon_loss: 257657.2750; val_gene_expr_recon_loss: 12875.6252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276287.0905; val_optim_loss: 276287.0905
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5808.3758; train_edge_recon_loss: 257381.1147; train_gene_expr_recon_loss: 12970.7452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276160.2359; train_optim_loss: 276160.2359; val_kl_reg_loss: 5788.7035; val_edge_recon_loss: 257694.8096; val_gene_expr_recon_loss: 12857.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276340.5756; val_optim_loss: 276340.5756
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9816; val_best_f1_score: 0.9816; train_kl_reg_loss: 5808.2077; train_edge_recon_loss: 257367.0918; train_gene_expr_recon_loss: 12972.3725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276147.6725; train_optim_loss: 276147.6725; val_kl_reg_loss: 5787.3481; val_edge_recon_loss: 257570.5727; val_gene_expr_recon_loss: 12864.9647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276222.8856; val_optim_loss: 276222.8856

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 5806.8408; train_edge_recon_loss: 257353.0794; train_gene_expr_recon_loss: 12965.1687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276125.0889; train_optim_loss: 276125.0889; val_kl_reg_loss: 5779.5287; val_edge_recon_loss: 257697.9205; val_gene_expr_recon_loss: 12863.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276341.1582; val_optim_loss: 276341.1582
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9810; val_best_f1_score: 0.9811; train_kl_reg_loss: 5808.4971; train_edge_recon_loss: 257313.3250; train_gene_expr_recon_loss: 12960.1073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276081.9289; train_optim_loss: 276081.9289; val_kl_reg_loss: 5767.9466; val_edge_recon_loss: 257809.6918; val_gene_expr_recon_loss: 12861.0507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276438.6887; val_optim_loss: 276438.6887
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 5804.5495; train_edge_recon_loss: 257367.2342; train_gene_expr_recon_loss: 12960.5160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276132.2997; train_optim_loss: 276132.2997; val_kl_reg_loss: 5778.4914; val_edge_recon_loss: 257587.6251; val_gene_expr_recon_loss: 12854.5620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276220.6799; val_optim_loss: 276220.6799
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 5805.2106; train_edge_recon_loss: 257352.5614; train_gene_expr_recon_loss: 12958.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276116.1402; train_optim_loss: 276116.1402; val_kl_reg_loss: 5767.2274; val_edge_recon_loss: 257859.2829; val_gene_expr_recon_loss: 12850.2133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276476.7249; val_optim_loss: 276476.7249

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 380 min 25 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9972
Val best accuracy score: 0.9813
Val best F1 score: 0.9813
Val gene expr MSE score: 8.7030

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
