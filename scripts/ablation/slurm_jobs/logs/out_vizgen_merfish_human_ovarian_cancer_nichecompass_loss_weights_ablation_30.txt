None
Run timestamp: 03072023_091342_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9855; val_auprc_score: 0.9847; val_best_acc_score: 0.9394; val_best_f1_score: 0.9396; train_kl_reg_loss: 5583.8042; train_edge_recon_loss: 266207.2048; train_gene_expr_recon_loss: 18386.7341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 290177.7435; train_optim_loss: 290177.7435; val_kl_reg_loss: 5540.9657; val_edge_recon_loss: 262464.2214; val_gene_expr_recon_loss: 16405.2311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284410.4188; val_optim_loss: 284410.4188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9886; val_best_acc_score: 0.9502; val_best_f1_score: 0.9505; train_kl_reg_loss: 5608.1084; train_edge_recon_loss: 261420.9094; train_gene_expr_recon_loss: 15820.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282849.0719; train_optim_loss: 282849.0719; val_kl_reg_loss: 5494.6901; val_edge_recon_loss: 262061.5310; val_gene_expr_recon_loss: 15243.9824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282800.2050; val_optim_loss: 282800.2050
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9916; val_auprc_score: 0.9906; val_best_acc_score: 0.9566; val_best_f1_score: 0.9570; train_kl_reg_loss: 5608.9815; train_edge_recon_loss: 260660.4413; train_gene_expr_recon_loss: 14947.9629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281217.3858; train_optim_loss: 281217.3858; val_kl_reg_loss: 5585.7530; val_edge_recon_loss: 261488.3166; val_gene_expr_recon_loss: 14563.3991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281637.4699; val_optim_loss: 281637.4699
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9929; val_auprc_score: 0.9920; val_best_acc_score: 0.9607; val_best_f1_score: 0.9610; train_kl_reg_loss: 5624.1801; train_edge_recon_loss: 260328.5220; train_gene_expr_recon_loss: 14463.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280416.0909; train_optim_loss: 280416.0909; val_kl_reg_loss: 5467.6388; val_edge_recon_loss: 260816.0283; val_gene_expr_recon_loss: 14209.3447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280493.0096; val_optim_loss: 280493.0096
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9933; val_auprc_score: 0.9927; val_best_acc_score: 0.9618; val_best_f1_score: 0.9620; train_kl_reg_loss: 5635.0458; train_edge_recon_loss: 260074.0069; train_gene_expr_recon_loss: 14190.1915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279899.2447; train_optim_loss: 279899.2447; val_kl_reg_loss: 5566.5568; val_edge_recon_loss: 260633.5000; val_gene_expr_recon_loss: 13993.9866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280194.0426; val_optim_loss: 280194.0426
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9941; val_auprc_score: 0.9933; val_best_acc_score: 0.9650; val_best_f1_score: 0.9652; train_kl_reg_loss: 5652.8568; train_edge_recon_loss: 259785.4034; train_gene_expr_recon_loss: 14000.1587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279438.4191; train_optim_loss: 279438.4191; val_kl_reg_loss: 5625.7940; val_edge_recon_loss: 260202.3984; val_gene_expr_recon_loss: 13815.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279644.0444; val_optim_loss: 279644.0444
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9939; val_best_acc_score: 0.9663; val_best_f1_score: 0.9663; train_kl_reg_loss: 5677.0201; train_edge_recon_loss: 259594.6920; train_gene_expr_recon_loss: 13842.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279114.2373; train_optim_loss: 279114.2373; val_kl_reg_loss: 5659.2365; val_edge_recon_loss: 260300.2859; val_gene_expr_recon_loss: 13654.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279614.0970; val_optim_loss: 279614.0970
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9946; val_auprc_score: 0.9939; val_best_acc_score: 0.9666; val_best_f1_score: 0.9668; train_kl_reg_loss: 5697.4617; train_edge_recon_loss: 259413.3080; train_gene_expr_recon_loss: 13709.3778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278820.1476; train_optim_loss: 278820.1476; val_kl_reg_loss: 5427.3989; val_edge_recon_loss: 260133.8315; val_gene_expr_recon_loss: 13573.2893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279134.5196; val_optim_loss: 279134.5196
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9947; val_auprc_score: 0.9940; val_best_acc_score: 0.9673; val_best_f1_score: 0.9674; train_kl_reg_loss: 5708.4643; train_edge_recon_loss: 259260.5378; train_gene_expr_recon_loss: 13601.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278570.1174; train_optim_loss: 278570.1174; val_kl_reg_loss: 5606.3136; val_edge_recon_loss: 260317.4175; val_gene_expr_recon_loss: 13472.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279396.4617; val_optim_loss: 279396.4617
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9944; val_best_acc_score: 0.9684; val_best_f1_score: 0.9686; train_kl_reg_loss: 5721.3348; train_edge_recon_loss: 259129.1031; train_gene_expr_recon_loss: 13507.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278358.3009; train_optim_loss: 278358.3009; val_kl_reg_loss: 5782.7928; val_edge_recon_loss: 259999.3658; val_gene_expr_recon_loss: 13340.6808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279122.8411; val_optim_loss: 279122.8411
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9951; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 5734.6113; train_edge_recon_loss: 259031.7157; train_gene_expr_recon_loss: 13442.3294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278208.6560; train_optim_loss: 278208.6560; val_kl_reg_loss: 5756.4488; val_edge_recon_loss: 259711.3972; val_gene_expr_recon_loss: 13321.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278789.7290; val_optim_loss: 278789.7290
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9706; val_best_f1_score: 0.9708; train_kl_reg_loss: 5740.6697; train_edge_recon_loss: 258983.4489; train_gene_expr_recon_loss: 13387.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278111.3067; train_optim_loss: 278111.3067; val_kl_reg_loss: 5692.5589; val_edge_recon_loss: 259894.7550; val_gene_expr_recon_loss: 13242.9564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278830.2710; val_optim_loss: 278830.2710
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9707; val_best_f1_score: 0.9708; train_kl_reg_loss: 5748.4745; train_edge_recon_loss: 258874.1894; train_gene_expr_recon_loss: 13349.8272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277972.4912; train_optim_loss: 277972.4912; val_kl_reg_loss: 5582.8162; val_edge_recon_loss: 259373.0682; val_gene_expr_recon_loss: 13252.4657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278208.3516; val_optim_loss: 278208.3516
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9952; val_best_acc_score: 0.9719; val_best_f1_score: 0.9720; train_kl_reg_loss: 5754.1667; train_edge_recon_loss: 258825.2160; train_gene_expr_recon_loss: 13303.5617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277882.9444; train_optim_loss: 277882.9444; val_kl_reg_loss: 5663.3363; val_edge_recon_loss: 259678.3797; val_gene_expr_recon_loss: 13191.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278533.3619; val_optim_loss: 278533.3619
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9721; val_best_f1_score: 0.9722; train_kl_reg_loss: 5760.3504; train_edge_recon_loss: 258714.5509; train_gene_expr_recon_loss: 13274.2730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277749.1746; train_optim_loss: 277749.1746; val_kl_reg_loss: 5720.5732; val_edge_recon_loss: 259607.6716; val_gene_expr_recon_loss: 13133.0254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278461.2707; val_optim_loss: 278461.2707
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9741; val_best_f1_score: 0.9742; train_kl_reg_loss: 5764.8669; train_edge_recon_loss: 258696.3115; train_gene_expr_recon_loss: 13249.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277710.8970; train_optim_loss: 277710.8970; val_kl_reg_loss: 5773.6729; val_edge_recon_loss: 259399.8693; val_gene_expr_recon_loss: 13108.8565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278282.4004; val_optim_loss: 278282.4004
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9956; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 5773.4238; train_edge_recon_loss: 258591.1208; train_gene_expr_recon_loss: 13230.7572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277595.3017; train_optim_loss: 277595.3017; val_kl_reg_loss: 5651.6916; val_edge_recon_loss: 259158.1922; val_gene_expr_recon_loss: 13106.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277916.3674; val_optim_loss: 277916.3674
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 5776.1788; train_edge_recon_loss: 258562.2979; train_gene_expr_recon_loss: 13202.1039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277540.5807; train_optim_loss: 277540.5807; val_kl_reg_loss: 5668.9072; val_edge_recon_loss: 259179.1558; val_gene_expr_recon_loss: 13094.4149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277942.4790; val_optim_loss: 277942.4790
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9745; val_best_f1_score: 0.9746; train_kl_reg_loss: 5780.6251; train_edge_recon_loss: 258500.4788; train_gene_expr_recon_loss: 13181.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277462.5247; train_optim_loss: 277462.5247; val_kl_reg_loss: 5686.8131; val_edge_recon_loss: 259193.8597; val_gene_expr_recon_loss: 13057.5190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277938.1928; val_optim_loss: 277938.1928
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9731; val_best_f1_score: 0.9732; train_kl_reg_loss: 5785.6583; train_edge_recon_loss: 258431.2602; train_gene_expr_recon_loss: 13170.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277387.0657; train_optim_loss: 277387.0657; val_kl_reg_loss: 5661.6649; val_edge_recon_loss: 259129.7791; val_gene_expr_recon_loss: 13047.2464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277838.6904; val_optim_loss: 277838.6904
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9750; val_best_f1_score: 0.9752; train_kl_reg_loss: 5786.4902; train_edge_recon_loss: 258492.5980; train_gene_expr_recon_loss: 13150.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277429.5846; train_optim_loss: 277429.5846; val_kl_reg_loss: 5877.0145; val_edge_recon_loss: 258795.5413; val_gene_expr_recon_loss: 13015.5876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277688.1446; val_optim_loss: 277688.1446
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 5793.5020; train_edge_recon_loss: 258363.5138; train_gene_expr_recon_loss: 13133.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277290.3490; train_optim_loss: 277290.3490; val_kl_reg_loss: 5621.9185; val_edge_recon_loss: 258811.0051; val_gene_expr_recon_loss: 13027.2312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277460.1565; val_optim_loss: 277460.1565
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9756; val_best_f1_score: 0.9757; train_kl_reg_loss: 5797.2692; train_edge_recon_loss: 258317.5511; train_gene_expr_recon_loss: 13127.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277242.6808; train_optim_loss: 277242.6808; val_kl_reg_loss: 5617.3245; val_edge_recon_loss: 259020.1711; val_gene_expr_recon_loss: 13030.9955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277668.4918; val_optim_loss: 277668.4918
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 5798.9210; train_edge_recon_loss: 258238.3555; train_gene_expr_recon_loss: 13112.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277149.7773; train_optim_loss: 277149.7773; val_kl_reg_loss: 5656.7543; val_edge_recon_loss: 258860.3071; val_gene_expr_recon_loss: 12987.4827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277504.5444; val_optim_loss: 277504.5444
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 5800.1589; train_edge_recon_loss: 258300.3164; train_gene_expr_recon_loss: 13094.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277195.4427; train_optim_loss: 277195.4427; val_kl_reg_loss: 5696.3726; val_edge_recon_loss: 258840.9661; val_gene_expr_recon_loss: 12987.9165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277525.2553; val_optim_loss: 277525.2553
