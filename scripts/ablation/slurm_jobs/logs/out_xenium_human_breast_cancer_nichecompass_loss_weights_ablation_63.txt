None
Run timestamp: 28072023_153923_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 995239
Number of validation edges: 110582
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9644; val_auprc_score: 0.9612; val_best_acc_score: 0.9023; val_best_f1_score: 0.9039; train_kl_reg_loss: 2032.4088; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 121669.7846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 123702.1934; train_optim_loss: 123702.1934; val_kl_reg_loss: 1563.0159; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 111242.1446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 112805.1604; val_optim_loss: 112805.1604
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9724; val_auprc_score: 0.9701; val_best_acc_score: 0.9162; val_best_f1_score: 0.9171; train_kl_reg_loss: 1451.1251; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 109219.2739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110670.3990; train_optim_loss: 110670.3990; val_kl_reg_loss: 1323.2524; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 106471.6606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 107794.9129; val_optim_loss: 107794.9129
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9763; val_auprc_score: 0.9743; val_best_acc_score: 0.9219; val_best_f1_score: 0.9229; train_kl_reg_loss: 1344.6430; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 106227.0340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 107571.6770; train_optim_loss: 107571.6770; val_kl_reg_loss: 1298.4576; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104704.0499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 106002.5075; val_optim_loss: 106002.5075
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9769; val_auprc_score: 0.9751; val_best_acc_score: 0.9238; val_best_f1_score: 0.9238; train_kl_reg_loss: 1304.0778; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 105037.0910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 106341.1688; train_optim_loss: 106341.1688; val_kl_reg_loss: 1278.2095; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104029.6636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105307.8728; val_optim_loss: 105307.8728
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9755; val_auprc_score: 0.9735; val_best_acc_score: 0.9201; val_best_f1_score: 0.9210; train_kl_reg_loss: 1281.8040; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104533.7484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105815.5524; train_optim_loss: 105815.5524; val_kl_reg_loss: 1240.4673; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103770.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105011.4216; val_optim_loss: 105011.4216
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9785; val_auprc_score: 0.9770; val_best_acc_score: 0.9259; val_best_f1_score: 0.9262; train_kl_reg_loss: 1270.1928; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104215.9827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105486.1755; train_optim_loss: 105486.1755; val_kl_reg_loss: 1251.4040; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103673.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104925.1562; val_optim_loss: 104925.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9756; val_auprc_score: 0.9737; val_best_acc_score: 0.9206; val_best_f1_score: 0.9216; train_kl_reg_loss: 1261.9946; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 104011.7588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105273.7535; train_optim_loss: 105273.7535; val_kl_reg_loss: 1228.3901; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103362.7906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104591.1807; val_optim_loss: 104591.1807
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9761; val_auprc_score: 0.9738; val_best_acc_score: 0.9225; val_best_f1_score: 0.9234; train_kl_reg_loss: 1257.1548; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103918.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105175.3441; train_optim_loss: 105175.3441; val_kl_reg_loss: 1258.1655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103440.0132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104698.1787; val_optim_loss: 104698.1787
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9751; val_best_acc_score: 0.9251; val_best_f1_score: 0.9256; train_kl_reg_loss: 1253.4222; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103829.5454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105082.9676; train_optim_loss: 105082.9676; val_kl_reg_loss: 1225.0523; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103401.8624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104626.9148; val_optim_loss: 104626.9148
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9780; val_auprc_score: 0.9762; val_best_acc_score: 0.9249; val_best_f1_score: 0.9262; train_kl_reg_loss: 1250.8703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103779.0654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105029.9358; train_optim_loss: 105029.9358; val_kl_reg_loss: 1247.4342; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103381.1959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104628.6300; val_optim_loss: 104628.6300
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9778; val_auprc_score: 0.9762; val_best_acc_score: 0.9245; val_best_f1_score: 0.9256; train_kl_reg_loss: 1249.7116; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103773.5079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105023.2195; train_optim_loss: 105023.2195; val_kl_reg_loss: 1241.7985; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103245.3851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104487.1833; val_optim_loss: 104487.1833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9796; val_auprc_score: 0.9778; val_best_acc_score: 0.9284; val_best_f1_score: 0.9290; train_kl_reg_loss: 1248.6490; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103684.1856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104932.8346; train_optim_loss: 104932.8346; val_kl_reg_loss: 1244.5564; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103344.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104588.9380; val_optim_loss: 104588.9380
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9779; val_auprc_score: 0.9761; val_best_acc_score: 0.9250; val_best_f1_score: 0.9255; train_kl_reg_loss: 1245.8021; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103636.7899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104882.5920; train_optim_loss: 104882.5920; val_kl_reg_loss: 1232.3077; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103321.4049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104553.7125; val_optim_loss: 104553.7125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9779; val_auprc_score: 0.9759; val_best_acc_score: 0.9248; val_best_f1_score: 0.9258; train_kl_reg_loss: 1244.3412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103618.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104863.0988; train_optim_loss: 104863.0988; val_kl_reg_loss: 1208.2470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103209.5307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104417.7777; val_optim_loss: 104417.7777
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9794; val_auprc_score: 0.9780; val_best_acc_score: 0.9271; val_best_f1_score: 0.9275; train_kl_reg_loss: 1243.9902; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103591.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104835.2116; train_optim_loss: 104835.2116; val_kl_reg_loss: 1236.8134; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103196.2318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104433.0452; val_optim_loss: 104433.0452
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9801; val_auprc_score: 0.9787; val_best_acc_score: 0.9286; val_best_f1_score: 0.9296; train_kl_reg_loss: 1242.1893; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103539.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104782.1514; train_optim_loss: 104782.1514; val_kl_reg_loss: 1228.6799; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103194.7374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104423.4176; val_optim_loss: 104423.4176
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9798; val_auprc_score: 0.9784; val_best_acc_score: 0.9281; val_best_f1_score: 0.9288; train_kl_reg_loss: 1240.0010; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103553.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104793.7050; train_optim_loss: 104793.7050; val_kl_reg_loss: 1213.4053; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103154.6041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104368.0097; val_optim_loss: 104368.0097
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9786; val_auprc_score: 0.9770; val_best_acc_score: 0.9254; val_best_f1_score: 0.9264; train_kl_reg_loss: 1237.5987; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103469.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104706.6495; train_optim_loss: 104706.6495; val_kl_reg_loss: 1214.9442; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103266.9911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104481.9353; val_optim_loss: 104481.9353
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9802; val_auprc_score: 0.9789; val_best_acc_score: 0.9288; val_best_f1_score: 0.9292; train_kl_reg_loss: 1238.5291; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103471.9575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104710.4865; train_optim_loss: 104710.4865; val_kl_reg_loss: 1233.4451; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102960.1062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104193.5511; val_optim_loss: 104193.5511
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9787; val_auprc_score: 0.9772; val_best_acc_score: 0.9263; val_best_f1_score: 0.9268; train_kl_reg_loss: 1238.2427; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103458.2126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104696.4553; train_optim_loss: 104696.4553; val_kl_reg_loss: 1224.4566; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103257.2013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104481.6578; val_optim_loss: 104481.6578
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9793; val_auprc_score: 0.9775; val_best_acc_score: 0.9281; val_best_f1_score: 0.9285; train_kl_reg_loss: 1238.1557; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103433.3726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104671.5283; train_optim_loss: 104671.5283; val_kl_reg_loss: 1241.2575; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103197.8714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104439.1289; val_optim_loss: 104439.1289
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9794; val_auprc_score: 0.9776; val_best_acc_score: 0.9274; val_best_f1_score: 0.9287; train_kl_reg_loss: 1237.6493; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103470.7241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104708.3733; train_optim_loss: 104708.3733; val_kl_reg_loss: 1223.5014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103282.0823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104505.5839; val_optim_loss: 104505.5839
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9786; val_best_acc_score: 0.9287; val_best_f1_score: 0.9297; train_kl_reg_loss: 1237.4791; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103407.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104644.9371; train_optim_loss: 104644.9371; val_kl_reg_loss: 1228.0336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102852.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104080.5987; val_optim_loss: 104080.5987
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9813; val_auprc_score: 0.9801; val_best_acc_score: 0.9304; val_best_f1_score: 0.9314; train_kl_reg_loss: 1237.3582; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103399.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104637.2673; train_optim_loss: 104637.2673; val_kl_reg_loss: 1216.8373; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102956.5047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104173.3420; val_optim_loss: 104173.3420
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9802; val_auprc_score: 0.9788; val_best_acc_score: 0.9283; val_best_f1_score: 0.9295; train_kl_reg_loss: 1234.1616; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103386.8963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104621.0580; train_optim_loss: 104621.0580; val_kl_reg_loss: 1225.9872; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102988.2346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104214.2215; val_optim_loss: 104214.2215
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9794; val_auprc_score: 0.9777; val_best_acc_score: 0.9278; val_best_f1_score: 0.9288; train_kl_reg_loss: 1233.9881; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103401.0131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104635.0012; train_optim_loss: 104635.0012; val_kl_reg_loss: 1223.5843; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103241.9290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104465.5131; val_optim_loss: 104465.5131
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9804; val_auprc_score: 0.9792; val_best_acc_score: 0.9290; val_best_f1_score: 0.9301; train_kl_reg_loss: 1233.9823; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103406.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104640.3474; train_optim_loss: 104640.3474; val_kl_reg_loss: 1223.5646; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103243.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104467.2078; val_optim_loss: 104467.2078

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9827; val_auprc_score: 0.9818; val_best_acc_score: 0.9324; val_best_f1_score: 0.9333; train_kl_reg_loss: 1206.6603; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 103044.4607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104251.1210; train_optim_loss: 104251.1210; val_kl_reg_loss: 1193.1759; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102509.5576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103702.7333; val_optim_loss: 103702.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9819; val_auprc_score: 0.9807; val_best_acc_score: 0.9314; val_best_f1_score: 0.9325; train_kl_reg_loss: 1201.8331; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102960.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104162.0677; train_optim_loss: 104162.0677; val_kl_reg_loss: 1187.5390; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103606.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104793.6713; val_optim_loss: 104793.6713
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9825; val_auprc_score: 0.9814; val_best_acc_score: 0.9326; val_best_f1_score: 0.9337; train_kl_reg_loss: 1201.9795; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102979.8254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104181.8049; train_optim_loss: 104181.8049; val_kl_reg_loss: 1199.4020; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102253.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103452.5876; val_optim_loss: 103452.5876
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9824; val_auprc_score: 0.9815; val_best_acc_score: 0.9321; val_best_f1_score: 0.9331; train_kl_reg_loss: 1200.9862; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102894.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104095.3042; train_optim_loss: 104095.3042; val_kl_reg_loss: 1187.1811; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102441.1107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103628.2920; val_optim_loss: 103628.2920
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9823; val_auprc_score: 0.9811; val_best_acc_score: 0.9320; val_best_f1_score: 0.9330; train_kl_reg_loss: 1200.3676; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102869.3405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104069.7081; train_optim_loss: 104069.7081; val_kl_reg_loss: 1190.1228; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102230.8707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103420.9937; val_optim_loss: 103420.9937
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9833; val_auprc_score: 0.9824; val_best_acc_score: 0.9346; val_best_f1_score: 0.9353; train_kl_reg_loss: 1200.3218; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102942.0376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104142.3595; train_optim_loss: 104142.3595; val_kl_reg_loss: 1182.9767; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102424.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103607.9312; val_optim_loss: 103607.9312
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9829; val_auprc_score: 0.9818; val_best_acc_score: 0.9336; val_best_f1_score: 0.9344; train_kl_reg_loss: 1200.1131; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102916.7654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104116.8785; train_optim_loss: 104116.8785; val_kl_reg_loss: 1188.0138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102533.0351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103721.0488; val_optim_loss: 103721.0488
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9828; val_auprc_score: 0.9819; val_best_acc_score: 0.9333; val_best_f1_score: 0.9340; train_kl_reg_loss: 1201.3789; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102911.6950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104113.0740; train_optim_loss: 104113.0740; val_kl_reg_loss: 1184.2578; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102414.7513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103599.0092; val_optim_loss: 103599.0092
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9827; val_auprc_score: 0.9817; val_best_acc_score: 0.9330; val_best_f1_score: 0.9338; train_kl_reg_loss: 1200.7609; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102899.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104100.2397; train_optim_loss: 104100.2397; val_kl_reg_loss: 1184.7437; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102892.9137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104077.6575; val_optim_loss: 104077.6575

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9828; val_auprc_score: 0.9818; val_best_acc_score: 0.9336; val_best_f1_score: 0.9343; train_kl_reg_loss: 1198.5081; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102930.2330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104128.7412; train_optim_loss: 104128.7412; val_kl_reg_loss: 1184.8292; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103401.4960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104586.3252; val_optim_loss: 104586.3252
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9831; val_auprc_score: 0.9820; val_best_acc_score: 0.9339; val_best_f1_score: 0.9346; train_kl_reg_loss: 1197.3009; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102877.8871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104075.1879; train_optim_loss: 104075.1879; val_kl_reg_loss: 1185.9360; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 104019.3146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105205.2505; val_optim_loss: 105205.2505
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9829; val_auprc_score: 0.9818; val_best_acc_score: 0.9340; val_best_f1_score: 0.9346; train_kl_reg_loss: 1197.5778; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102961.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104159.4568; train_optim_loss: 104159.4568; val_kl_reg_loss: 1186.3215; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 102651.1861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 103837.5076; val_optim_loss: 103837.5076
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9829; val_auprc_score: 0.9819; val_best_acc_score: 0.9335; val_best_f1_score: 0.9342; train_kl_reg_loss: 1197.8185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 102980.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104178.6700; train_optim_loss: 104178.6700; val_kl_reg_loss: 1185.4460; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 103050.8268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104236.2730; val_optim_loss: 104236.2730

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 338 min 33 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9826
val AUPRC score: 0.9818
val best accuracy score: 0.9324
val best F1 score: 0.9334
val target rna MSE score: 1.4107
val source rna MSE score: 0.1265

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
