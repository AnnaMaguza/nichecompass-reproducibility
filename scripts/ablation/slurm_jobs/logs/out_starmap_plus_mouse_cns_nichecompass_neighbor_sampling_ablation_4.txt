None
Run timestamp: 13072023_092943_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9880; val_auprc_score: 0.9841; val_best_acc_score: 0.9582; val_best_f1_score: 0.9591; train_kl_reg_loss: 7822.9894; train_edge_recon_loss: 266105.8557; train_gene_expr_recon_loss: 121830.5748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395759.4201; train_optim_loss: 395759.4201; val_kl_reg_loss: 7448.8945; val_edge_recon_loss: 260588.3100; val_gene_expr_recon_loss: 111610.3960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379647.5992; val_optim_loss: 379647.5992
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9665; val_best_f1_score: 0.9672; train_kl_reg_loss: 7260.1395; train_edge_recon_loss: 260515.4887; train_gene_expr_recon_loss: 108033.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375808.9817; train_optim_loss: 375808.9817; val_kl_reg_loss: 7020.9246; val_edge_recon_loss: 259446.2340; val_gene_expr_recon_loss: 106350.9829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372818.1410; val_optim_loss: 372818.1410
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 6976.5230; train_edge_recon_loss: 259751.0896; train_gene_expr_recon_loss: 104172.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370900.5805; train_optim_loss: 370900.5805; val_kl_reg_loss: 6803.7301; val_edge_recon_loss: 258751.1701; val_gene_expr_recon_loss: 103457.9738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369012.8738; val_optim_loss: 369012.8738
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 6797.9807; train_edge_recon_loss: 259217.5939; train_gene_expr_recon_loss: 101769.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367784.8656; train_optim_loss: 367784.8656; val_kl_reg_loss: 6758.9192; val_edge_recon_loss: 258099.4227; val_gene_expr_recon_loss: 101678.5835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366536.9227; val_optim_loss: 366536.9227
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 6663.6377; train_edge_recon_loss: 258784.8080; train_gene_expr_recon_loss: 100491.7972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365940.2420; train_optim_loss: 365940.2420; val_kl_reg_loss: 6535.1107; val_edge_recon_loss: 257745.6668; val_gene_expr_recon_loss: 100542.3897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364823.1680; val_optim_loss: 364823.1680
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 6564.0346; train_edge_recon_loss: 258448.7989; train_gene_expr_recon_loss: 99394.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364407.0160; train_optim_loss: 364407.0160; val_kl_reg_loss: 6457.3527; val_edge_recon_loss: 257458.6266; val_gene_expr_recon_loss: 99983.5224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363899.5051; val_optim_loss: 363899.5051
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6490.4880; train_edge_recon_loss: 258020.2788; train_gene_expr_recon_loss: 98717.2571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363228.0239; train_optim_loss: 363228.0239; val_kl_reg_loss: 6409.1466; val_edge_recon_loss: 257163.9572; val_gene_expr_recon_loss: 99688.3687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363261.4719; val_optim_loss: 363261.4719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6433.6265; train_edge_recon_loss: 257743.6304; train_gene_expr_recon_loss: 98290.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362467.9717; train_optim_loss: 362467.9717; val_kl_reg_loss: 6439.0175; val_edge_recon_loss: 257140.4816; val_gene_expr_recon_loss: 99013.5777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362593.0770; val_optim_loss: 362593.0770
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 6392.0492; train_edge_recon_loss: 257436.7485; train_gene_expr_recon_loss: 97837.5168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361666.3142; train_optim_loss: 361666.3142; val_kl_reg_loss: 6267.7689; val_edge_recon_loss: 256649.6676; val_gene_expr_recon_loss: 98750.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361667.6789; val_optim_loss: 361667.6789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 6357.7359; train_edge_recon_loss: 257264.9023; train_gene_expr_recon_loss: 97603.1911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361225.8291; train_optim_loss: 361225.8291; val_kl_reg_loss: 6247.4252; val_edge_recon_loss: 256501.8383; val_gene_expr_recon_loss: 98917.1546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361666.4168; val_optim_loss: 361666.4168
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 6332.1063; train_edge_recon_loss: 257163.5395; train_gene_expr_recon_loss: 97306.7797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360802.4253; train_optim_loss: 360802.4253; val_kl_reg_loss: 6224.6671; val_edge_recon_loss: 256140.1609; val_gene_expr_recon_loss: 98552.6645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360917.4918; val_optim_loss: 360917.4918
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6318.4534; train_edge_recon_loss: 256934.0022; train_gene_expr_recon_loss: 97023.7551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360276.2104; train_optim_loss: 360276.2104; val_kl_reg_loss: 6367.5352; val_edge_recon_loss: 256218.0768; val_gene_expr_recon_loss: 98682.1050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361267.7184; val_optim_loss: 361267.7184
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 6300.2847; train_edge_recon_loss: 256903.2983; train_gene_expr_recon_loss: 96803.8158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360007.3991; train_optim_loss: 360007.3991; val_kl_reg_loss: 6304.5051; val_edge_recon_loss: 255906.7455; val_gene_expr_recon_loss: 98137.3005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360348.5508; val_optim_loss: 360348.5508
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6294.6128; train_edge_recon_loss: 256766.1935; train_gene_expr_recon_loss: 96532.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359593.0505; train_optim_loss: 359593.0505; val_kl_reg_loss: 6274.6371; val_edge_recon_loss: 256010.0213; val_gene_expr_recon_loss: 98346.9715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360631.6297; val_optim_loss: 360631.6297
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9962; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6289.1692; train_edge_recon_loss: 256663.3779; train_gene_expr_recon_loss: 96336.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359289.1157; train_optim_loss: 359289.1157; val_kl_reg_loss: 6245.1427; val_edge_recon_loss: 255761.6998; val_gene_expr_recon_loss: 98023.9661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360030.8082; val_optim_loss: 360030.8082
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6281.5989; train_edge_recon_loss: 256582.3366; train_gene_expr_recon_loss: 96286.6769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359150.6120; train_optim_loss: 359150.6120; val_kl_reg_loss: 6253.7998; val_edge_recon_loss: 255802.1604; val_gene_expr_recon_loss: 98172.3291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360228.2891; val_optim_loss: 360228.2891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9976; val_auprc_score: 0.9965; val_best_acc_score: 0.9870; val_best_f1_score: 0.9872; train_kl_reg_loss: 6283.8492; train_edge_recon_loss: 256446.0424; train_gene_expr_recon_loss: 96129.9126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358859.8042; train_optim_loss: 358859.8042; val_kl_reg_loss: 6240.6118; val_edge_recon_loss: 255619.4607; val_gene_expr_recon_loss: 97932.0160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359792.0879; val_optim_loss: 359792.0879
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6282.7137; train_edge_recon_loss: 256416.7479; train_gene_expr_recon_loss: 96025.3797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358724.8411; train_optim_loss: 358724.8411; val_kl_reg_loss: 6245.4772; val_edge_recon_loss: 255649.4197; val_gene_expr_recon_loss: 98381.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360276.5266; val_optim_loss: 360276.5266
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6278.0009; train_edge_recon_loss: 256408.1119; train_gene_expr_recon_loss: 95839.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358525.2321; train_optim_loss: 358525.2321; val_kl_reg_loss: 6185.4053; val_edge_recon_loss: 255622.1656; val_gene_expr_recon_loss: 98105.6507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359913.2219; val_optim_loss: 359913.2219
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6283.7983; train_edge_recon_loss: 256225.3464; train_gene_expr_recon_loss: 95708.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358217.5770; train_optim_loss: 358217.5770; val_kl_reg_loss: 6293.1093; val_edge_recon_loss: 255505.4930; val_gene_expr_recon_loss: 97938.7485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359737.3516; val_optim_loss: 359737.3516
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6280.4283; train_edge_recon_loss: 256281.5944; train_gene_expr_recon_loss: 95511.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358073.8818; train_optim_loss: 358073.8818; val_kl_reg_loss: 6278.6600; val_edge_recon_loss: 255575.8900; val_gene_expr_recon_loss: 98047.3592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359901.9090; val_optim_loss: 359901.9090
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6287.4756; train_edge_recon_loss: 256200.1014; train_gene_expr_recon_loss: 95469.1375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357956.7153; train_optim_loss: 357956.7153; val_kl_reg_loss: 6233.0124; val_edge_recon_loss: 255247.9332; val_gene_expr_recon_loss: 97975.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359455.9688; val_optim_loss: 359455.9688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6287.5294; train_edge_recon_loss: 256116.7499; train_gene_expr_recon_loss: 95330.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357735.1486; train_optim_loss: 357735.1486; val_kl_reg_loss: 6267.1525; val_edge_recon_loss: 255278.3229; val_gene_expr_recon_loss: 98321.8756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359867.3523; val_optim_loss: 359867.3523
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6286.9638; train_edge_recon_loss: 256194.5118; train_gene_expr_recon_loss: 95251.6679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357733.1436; train_optim_loss: 357733.1436; val_kl_reg_loss: 6281.0782; val_edge_recon_loss: 255127.9701; val_gene_expr_recon_loss: 98197.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359606.5340; val_optim_loss: 359606.5340
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6293.8372; train_edge_recon_loss: 256077.1109; train_gene_expr_recon_loss: 95197.9425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357568.8907; train_optim_loss: 357568.8907; val_kl_reg_loss: 6330.6681; val_edge_recon_loss: 255294.0488; val_gene_expr_recon_loss: 98316.6449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359941.3613; val_optim_loss: 359941.3613
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6299.3195; train_edge_recon_loss: 256025.4231; train_gene_expr_recon_loss: 95039.0141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357363.7572; train_optim_loss: 357363.7572; val_kl_reg_loss: 6282.9378; val_edge_recon_loss: 255196.3375; val_gene_expr_recon_loss: 98188.6194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359667.8941; val_optim_loss: 359667.8941

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6310.3299; train_edge_recon_loss: 255930.1501; train_gene_expr_recon_loss: 94410.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356650.8963; train_optim_loss: 356650.8963; val_kl_reg_loss: 6315.0574; val_edge_recon_loss: 255141.3248; val_gene_expr_recon_loss: 97770.8436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359227.2242; val_optim_loss: 359227.2242
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6309.3096; train_edge_recon_loss: 255891.3853; train_gene_expr_recon_loss: 94272.6674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356473.3625; train_optim_loss: 356473.3625; val_kl_reg_loss: 6308.8514; val_edge_recon_loss: 255222.0035; val_gene_expr_recon_loss: 97963.4848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359494.3414; val_optim_loss: 359494.3414
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 6305.4120; train_edge_recon_loss: 255952.2102; train_gene_expr_recon_loss: 94272.9906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356530.6132; train_optim_loss: 356530.6132; val_kl_reg_loss: 6297.0298; val_edge_recon_loss: 255047.3613; val_gene_expr_recon_loss: 97934.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359279.1641; val_optim_loss: 359279.1641
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 6306.0671; train_edge_recon_loss: 255900.5290; train_gene_expr_recon_loss: 94162.8813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356369.4766; train_optim_loss: 356369.4766; val_kl_reg_loss: 6286.4882; val_edge_recon_loss: 255133.8986; val_gene_expr_recon_loss: 97820.3287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359240.7156; val_optim_loss: 359240.7156
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6305.9202; train_edge_recon_loss: 255927.6874; train_gene_expr_recon_loss: 94173.3191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356406.9269; train_optim_loss: 356406.9269; val_kl_reg_loss: 6306.8213; val_edge_recon_loss: 255025.0709; val_gene_expr_recon_loss: 97835.0537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359166.9457; val_optim_loss: 359166.9457
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6305.0892; train_edge_recon_loss: 255873.0997; train_gene_expr_recon_loss: 94207.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356385.4036; train_optim_loss: 356385.4036; val_kl_reg_loss: 6292.7252; val_edge_recon_loss: 255113.7223; val_gene_expr_recon_loss: 98075.5914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359482.0387; val_optim_loss: 359482.0387
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 6304.6189; train_edge_recon_loss: 255880.2965; train_gene_expr_recon_loss: 94121.5498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356306.4653; train_optim_loss: 356306.4653; val_kl_reg_loss: 6292.7589; val_edge_recon_loss: 255177.7184; val_gene_expr_recon_loss: 98029.6800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359500.1574; val_optim_loss: 359500.1574
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6304.1476; train_edge_recon_loss: 255841.0313; train_gene_expr_recon_loss: 94108.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356253.7736; train_optim_loss: 356253.7736; val_kl_reg_loss: 6288.9465; val_edge_recon_loss: 255063.9234; val_gene_expr_recon_loss: 97885.0341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359237.9035; val_optim_loss: 359237.9035
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 6305.2468; train_edge_recon_loss: 255798.8082; train_gene_expr_recon_loss: 94105.3186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356209.3737; train_optim_loss: 356209.3737; val_kl_reg_loss: 6293.4554; val_edge_recon_loss: 255331.8453; val_gene_expr_recon_loss: 98083.5515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359708.8551; val_optim_loss: 359708.8551

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 6306.2018; train_edge_recon_loss: 255848.9765; train_gene_expr_recon_loss: 94025.4650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356180.6438; train_optim_loss: 356180.6438; val_kl_reg_loss: 6296.9092; val_edge_recon_loss: 254983.0365; val_gene_expr_recon_loss: 97985.6843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359265.6316; val_optim_loss: 359265.6316
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6305.1698; train_edge_recon_loss: 255825.7826; train_gene_expr_recon_loss: 93944.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356075.1069; train_optim_loss: 356075.1069; val_kl_reg_loss: 6294.0508; val_edge_recon_loss: 255164.5746; val_gene_expr_recon_loss: 98096.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359555.0031; val_optim_loss: 359555.0031
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 6304.5190; train_edge_recon_loss: 255877.9356; train_gene_expr_recon_loss: 93999.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356182.2753; train_optim_loss: 356182.2753; val_kl_reg_loss: 6291.9160; val_edge_recon_loss: 255289.7787; val_gene_expr_recon_loss: 98108.7849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359690.4805; val_optim_loss: 359690.4805
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 6307.3592; train_edge_recon_loss: 255839.7871; train_gene_expr_recon_loss: 94014.6599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356161.8052; train_optim_loss: 356161.8052; val_kl_reg_loss: 6292.8455; val_edge_recon_loss: 255317.4672; val_gene_expr_recon_loss: 98072.1119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359682.4258; val_optim_loss: 359682.4258

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 456 min 39 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9975
Val best accuracy score: 0.9883
Val best F1 score: 0.9884
Val gene expr MSE score: 0.6697

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
