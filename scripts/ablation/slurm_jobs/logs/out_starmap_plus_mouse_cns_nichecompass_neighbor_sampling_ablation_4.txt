None
Run timestamp: 12072023_130422_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9879; val_auprc_score: 0.9843; val_best_acc_score: 0.9577; val_best_f1_score: 0.9587; train_kl_reg_loss: 7765.2577; train_edge_recon_loss: 265851.4495; train_gene_expr_recon_loss: 122734.9184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396351.6253; train_optim_loss: 396351.6253; val_kl_reg_loss: 7459.6215; val_edge_recon_loss: 260581.6918; val_gene_expr_recon_loss: 111705.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379746.6871; val_optim_loss: 379746.6871
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9920; val_auprc_score: 0.9899; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 7238.1430; train_edge_recon_loss: 260482.2699; train_gene_expr_recon_loss: 108705.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376425.4755; train_optim_loss: 376425.4755; val_kl_reg_loss: 6865.0743; val_edge_recon_loss: 259277.3102; val_gene_expr_recon_loss: 105939.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372082.3098; val_optim_loss: 372082.3098
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 6964.1104; train_edge_recon_loss: 259814.2910; train_gene_expr_recon_loss: 104548.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371327.2808; train_optim_loss: 371327.2808; val_kl_reg_loss: 6835.9379; val_edge_recon_loss: 259142.6713; val_gene_expr_recon_loss: 103011.7288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368990.3383; val_optim_loss: 368990.3383
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 6802.9916; train_edge_recon_loss: 259302.0863; train_gene_expr_recon_loss: 102062.1345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368167.2120; train_optim_loss: 368167.2120; val_kl_reg_loss: 6777.5548; val_edge_recon_loss: 258476.0297; val_gene_expr_recon_loss: 101231.8335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366485.4199; val_optim_loss: 366485.4199
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 6697.0123; train_edge_recon_loss: 258899.8561; train_gene_expr_recon_loss: 100398.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365995.6413; train_optim_loss: 365995.6413; val_kl_reg_loss: 6588.4602; val_edge_recon_loss: 257849.5477; val_gene_expr_recon_loss: 99809.3900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364247.3988; val_optim_loss: 364247.3988
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 6615.9368; train_edge_recon_loss: 258588.4954; train_gene_expr_recon_loss: 99300.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364505.0809; train_optim_loss: 364505.0809; val_kl_reg_loss: 6611.8015; val_edge_recon_loss: 257919.1162; val_gene_expr_recon_loss: 99128.9436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363659.8598; val_optim_loss: 363659.8598
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 6553.8361; train_edge_recon_loss: 258197.3036; train_gene_expr_recon_loss: 98491.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363243.0497; train_optim_loss: 363243.0497; val_kl_reg_loss: 6487.4840; val_edge_recon_loss: 257611.0309; val_gene_expr_recon_loss: 98418.8347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362517.3480; val_optim_loss: 362517.3480
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6503.1098; train_edge_recon_loss: 258023.0123; train_gene_expr_recon_loss: 97784.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362310.9212; train_optim_loss: 362310.9212; val_kl_reg_loss: 6420.9416; val_edge_recon_loss: 257270.8936; val_gene_expr_recon_loss: 97904.1483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361595.9816; val_optim_loss: 361595.9816
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 6467.2722; train_edge_recon_loss: 257773.8285; train_gene_expr_recon_loss: 97393.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361634.6775; train_optim_loss: 361634.6775; val_kl_reg_loss: 6445.1805; val_edge_recon_loss: 257282.5332; val_gene_expr_recon_loss: 97869.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361597.4301; val_optim_loss: 361597.4301
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 6439.4465; train_edge_recon_loss: 257610.0362; train_gene_expr_recon_loss: 97054.6317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361104.1145; train_optim_loss: 361104.1145; val_kl_reg_loss: 6289.7340; val_edge_recon_loss: 257225.9648; val_gene_expr_recon_loss: 97252.6916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360768.3914; val_optim_loss: 360768.3914
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6419.6985; train_edge_recon_loss: 257452.6262; train_gene_expr_recon_loss: 96789.0724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360661.3964; train_optim_loss: 360661.3964; val_kl_reg_loss: 6490.4062; val_edge_recon_loss: 256824.4637; val_gene_expr_recon_loss: 97170.3413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360485.2109; val_optim_loss: 360485.2109
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6403.7406; train_edge_recon_loss: 257354.7881; train_gene_expr_recon_loss: 96478.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360236.9333; train_optim_loss: 360236.9333; val_kl_reg_loss: 6231.1005; val_edge_recon_loss: 256408.9500; val_gene_expr_recon_loss: 97023.7608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359663.8129; val_optim_loss: 359663.8129
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6391.0966; train_edge_recon_loss: 257230.8222; train_gene_expr_recon_loss: 96272.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359894.6045; train_optim_loss: 359894.6045; val_kl_reg_loss: 6326.6615; val_edge_recon_loss: 256708.1605; val_gene_expr_recon_loss: 96907.7061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359942.5258; val_optim_loss: 359942.5258
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 6386.1679; train_edge_recon_loss: 257110.8985; train_gene_expr_recon_loss: 96092.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359589.2016; train_optim_loss: 359589.2016; val_kl_reg_loss: 6368.3516; val_edge_recon_loss: 256598.6156; val_gene_expr_recon_loss: 96664.5188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359631.4832; val_optim_loss: 359631.4832
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 6379.1297; train_edge_recon_loss: 257000.4181; train_gene_expr_recon_loss: 95827.7120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359207.2598; train_optim_loss: 359207.2598; val_kl_reg_loss: 6286.3822; val_edge_recon_loss: 256307.7934; val_gene_expr_recon_loss: 96602.6410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359196.8156; val_optim_loss: 359196.8156
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 6373.0184; train_edge_recon_loss: 256973.3286; train_gene_expr_recon_loss: 95737.7554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359084.1024; train_optim_loss: 359084.1024; val_kl_reg_loss: 6355.0788; val_edge_recon_loss: 256115.8449; val_gene_expr_recon_loss: 96404.8643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358875.7859; val_optim_loss: 358875.7859
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6371.7959; train_edge_recon_loss: 256879.5101; train_gene_expr_recon_loss: 95523.3134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358774.6191; train_optim_loss: 358774.6191; val_kl_reg_loss: 6274.4541; val_edge_recon_loss: 256169.2492; val_gene_expr_recon_loss: 96284.0611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358727.7637; val_optim_loss: 358727.7637
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6372.7110; train_edge_recon_loss: 256736.1445; train_gene_expr_recon_loss: 95407.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358515.9675; train_optim_loss: 358515.9675; val_kl_reg_loss: 6343.6110; val_edge_recon_loss: 256038.3656; val_gene_expr_recon_loss: 96214.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358596.4805; val_optim_loss: 358596.4805
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 6370.6345; train_edge_recon_loss: 256707.6677; train_gene_expr_recon_loss: 95350.4051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358428.7078; train_optim_loss: 358428.7078; val_kl_reg_loss: 6342.6326; val_edge_recon_loss: 256377.8199; val_gene_expr_recon_loss: 96281.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359001.8793; val_optim_loss: 359001.8793
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6375.1860; train_edge_recon_loss: 256633.1850; train_gene_expr_recon_loss: 95140.9109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358149.2821; train_optim_loss: 358149.2821; val_kl_reg_loss: 6233.8542; val_edge_recon_loss: 255883.7369; val_gene_expr_recon_loss: 96172.8537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358290.4445; val_optim_loss: 358290.4445
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6374.1444; train_edge_recon_loss: 256603.5355; train_gene_expr_recon_loss: 95078.9556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358056.6356; train_optim_loss: 358056.6356; val_kl_reg_loss: 6266.6656; val_edge_recon_loss: 255918.2715; val_gene_expr_recon_loss: 96272.9835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358457.9219; val_optim_loss: 358457.9219
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6378.0870; train_edge_recon_loss: 256495.7375; train_gene_expr_recon_loss: 94919.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357793.4288; train_optim_loss: 357793.4288; val_kl_reg_loss: 6359.5399; val_edge_recon_loss: 255742.5299; val_gene_expr_recon_loss: 96205.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358307.2363; val_optim_loss: 358307.2363
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6376.7122; train_edge_recon_loss: 256473.5332; train_gene_expr_recon_loss: 94780.7566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357631.0018; train_optim_loss: 357631.0018; val_kl_reg_loss: 6349.8233; val_edge_recon_loss: 255789.0949; val_gene_expr_recon_loss: 96101.0511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358239.9707; val_optim_loss: 358239.9707
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6377.9621; train_edge_recon_loss: 256457.4229; train_gene_expr_recon_loss: 94804.1318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357639.5168; train_optim_loss: 357639.5168; val_kl_reg_loss: 6267.3154; val_edge_recon_loss: 255898.0412; val_gene_expr_recon_loss: 95982.9663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358148.3203; val_optim_loss: 358148.3203
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6380.5429; train_edge_recon_loss: 256445.7552; train_gene_expr_recon_loss: 94686.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357512.8561; train_optim_loss: 357512.8561; val_kl_reg_loss: 6339.3720; val_edge_recon_loss: 255714.3256; val_gene_expr_recon_loss: 95866.5728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357920.2703; val_optim_loss: 357920.2703
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 6382.8528; train_edge_recon_loss: 256331.7427; train_gene_expr_recon_loss: 94669.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357383.7134; train_optim_loss: 357383.7134; val_kl_reg_loss: 6359.7075; val_edge_recon_loss: 255657.4191; val_gene_expr_recon_loss: 95875.5243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357892.6496; val_optim_loss: 357892.6496
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6384.9271; train_edge_recon_loss: 256292.9126; train_gene_expr_recon_loss: 94455.2242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357133.0633; train_optim_loss: 357133.0633; val_kl_reg_loss: 6368.5416; val_edge_recon_loss: 255761.9680; val_gene_expr_recon_loss: 95832.5217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357963.0332; val_optim_loss: 357963.0332
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 6388.6677; train_edge_recon_loss: 256249.4228; train_gene_expr_recon_loss: 94466.9624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357105.0534; train_optim_loss: 357105.0534; val_kl_reg_loss: 6295.0657; val_edge_recon_loss: 255667.4830; val_gene_expr_recon_loss: 95916.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357878.9437; val_optim_loss: 357878.9437
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6388.0396; train_edge_recon_loss: 256249.7198; train_gene_expr_recon_loss: 94350.0314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356987.7906; train_optim_loss: 356987.7906; val_kl_reg_loss: 6368.3974; val_edge_recon_loss: 255489.7533; val_gene_expr_recon_loss: 95805.1935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357663.3449; val_optim_loss: 357663.3449
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6392.2181; train_edge_recon_loss: 256224.3245; train_gene_expr_recon_loss: 94354.2486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356970.7912; train_optim_loss: 356970.7912; val_kl_reg_loss: 6343.0737; val_edge_recon_loss: 255590.3008; val_gene_expr_recon_loss: 95995.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357928.7871; val_optim_loss: 357928.7871
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 6393.1747; train_edge_recon_loss: 256207.2970; train_gene_expr_recon_loss: 94317.7089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356918.1801; train_optim_loss: 356918.1801; val_kl_reg_loss: 6327.6922; val_edge_recon_loss: 255793.4527; val_gene_expr_recon_loss: 95724.6775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357845.8223; val_optim_loss: 357845.8223
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6395.9565; train_edge_recon_loss: 256158.1192; train_gene_expr_recon_loss: 94242.2076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356796.2840; train_optim_loss: 356796.2840; val_kl_reg_loss: 6361.0694; val_edge_recon_loss: 255554.2094; val_gene_expr_recon_loss: 95864.7003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357779.9805; val_optim_loss: 357779.9805
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9873; val_best_f1_score: 0.9873; train_kl_reg_loss: 6396.1256; train_edge_recon_loss: 256116.6118; train_gene_expr_recon_loss: 94119.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356632.0580; train_optim_loss: 356632.0580; val_kl_reg_loss: 6391.3021; val_edge_recon_loss: 255544.6250; val_gene_expr_recon_loss: 95739.0880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357675.0133; val_optim_loss: 357675.0133

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6398.3060; train_edge_recon_loss: 256001.8468; train_gene_expr_recon_loss: 93480.9225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355881.0751; train_optim_loss: 355881.0751; val_kl_reg_loss: 6364.1332; val_edge_recon_loss: 255553.1488; val_gene_expr_recon_loss: 95388.6384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357305.9203; val_optim_loss: 357305.9203
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6389.1478; train_edge_recon_loss: 255988.3184; train_gene_expr_recon_loss: 93385.9401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355763.4066; train_optim_loss: 355763.4066; val_kl_reg_loss: 6374.9322; val_edge_recon_loss: 255511.2508; val_gene_expr_recon_loss: 95017.8064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356903.9906; val_optim_loss: 356903.9906
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6390.0735; train_edge_recon_loss: 255984.4246; train_gene_expr_recon_loss: 93420.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355795.3738; train_optim_loss: 355795.3738; val_kl_reg_loss: 6381.4305; val_edge_recon_loss: 255287.8779; val_gene_expr_recon_loss: 95372.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357042.1457; val_optim_loss: 357042.1457
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6390.0028; train_edge_recon_loss: 255950.1714; train_gene_expr_recon_loss: 93277.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355617.7682; train_optim_loss: 355617.7682; val_kl_reg_loss: 6371.7561; val_edge_recon_loss: 255382.3527; val_gene_expr_recon_loss: 95393.9120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357148.0207; val_optim_loss: 357148.0207
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 6388.7328; train_edge_recon_loss: 255961.7341; train_gene_expr_recon_loss: 93324.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355675.0116; train_optim_loss: 355675.0116; val_kl_reg_loss: 6353.0482; val_edge_recon_loss: 255465.3797; val_gene_expr_recon_loss: 95275.6740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357094.1027; val_optim_loss: 357094.1027
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6386.4415; train_edge_recon_loss: 255943.4071; train_gene_expr_recon_loss: 93256.7352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355586.5831; train_optim_loss: 355586.5831; val_kl_reg_loss: 6363.7198; val_edge_recon_loss: 255502.4598; val_gene_expr_recon_loss: 95137.8586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357004.0359; val_optim_loss: 357004.0359

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6389.4648; train_edge_recon_loss: 255903.3011; train_gene_expr_recon_loss: 93213.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355506.0879; train_optim_loss: 355506.0879; val_kl_reg_loss: 6370.1058; val_edge_recon_loss: 255366.8002; val_gene_expr_recon_loss: 95280.4221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357017.3258; val_optim_loss: 357017.3258
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6386.9975; train_edge_recon_loss: 255953.7826; train_gene_expr_recon_loss: 93229.2909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355570.0716; train_optim_loss: 355570.0716; val_kl_reg_loss: 6368.5792; val_edge_recon_loss: 255492.5840; val_gene_expr_recon_loss: 95260.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357122.0449; val_optim_loss: 357122.0449
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6390.3633; train_edge_recon_loss: 255928.1428; train_gene_expr_recon_loss: 93274.9072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355593.4132; train_optim_loss: 355593.4132; val_kl_reg_loss: 6368.4190; val_edge_recon_loss: 255371.6508; val_gene_expr_recon_loss: 95167.0883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356907.1605; val_optim_loss: 356907.1605
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6387.8142; train_edge_recon_loss: 255985.2801; train_gene_expr_recon_loss: 93160.3955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355533.4900; train_optim_loss: 355533.4900; val_kl_reg_loss: 6368.5127; val_edge_recon_loss: 255287.5766; val_gene_expr_recon_loss: 94816.1217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356472.2098; val_optim_loss: 356472.2098
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6389.5178; train_edge_recon_loss: 255960.2617; train_gene_expr_recon_loss: 93149.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355498.9168; train_optim_loss: 355498.9168; val_kl_reg_loss: 6371.3993; val_edge_recon_loss: 255338.9922; val_gene_expr_recon_loss: 94868.8862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356579.2750; val_optim_loss: 356579.2750
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6386.7990; train_edge_recon_loss: 255921.9835; train_gene_expr_recon_loss: 93183.0902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355491.8732; train_optim_loss: 355491.8732; val_kl_reg_loss: 6371.0626; val_edge_recon_loss: 255557.8680; val_gene_expr_recon_loss: 95148.6002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357077.5328; val_optim_loss: 357077.5328
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6388.7424; train_edge_recon_loss: 255858.6098; train_gene_expr_recon_loss: 93175.7624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355423.1137; train_optim_loss: 355423.1137; val_kl_reg_loss: 6371.5850; val_edge_recon_loss: 255322.5336; val_gene_expr_recon_loss: 94977.0840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356671.2012; val_optim_loss: 356671.2012
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6387.6540; train_edge_recon_loss: 256004.5456; train_gene_expr_recon_loss: 93093.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355485.4843; train_optim_loss: 355485.4843; val_kl_reg_loss: 6364.9538; val_edge_recon_loss: 255220.6006; val_gene_expr_recon_loss: 95131.4309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356716.9852; val_optim_loss: 356716.9852

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6384.4785; train_edge_recon_loss: 255886.6688; train_gene_expr_recon_loss: 93151.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355422.6824; train_optim_loss: 355422.6824; val_kl_reg_loss: 6365.5236; val_edge_recon_loss: 255429.9260; val_gene_expr_recon_loss: 95082.6105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356878.0570; val_optim_loss: 356878.0570
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6386.9051; train_edge_recon_loss: 255933.4235; train_gene_expr_recon_loss: 93141.1895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355461.5174; train_optim_loss: 355461.5174; val_kl_reg_loss: 6372.4686; val_edge_recon_loss: 255326.4717; val_gene_expr_recon_loss: 95328.4112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357027.3512; val_optim_loss: 357027.3512
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6387.9061; train_edge_recon_loss: 255950.6339; train_gene_expr_recon_loss: 93114.2657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355452.8057; train_optim_loss: 355452.8057; val_kl_reg_loss: 6358.5846; val_edge_recon_loss: 255243.8143; val_gene_expr_recon_loss: 95064.4843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356666.8852; val_optim_loss: 356666.8852
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6387.7264; train_edge_recon_loss: 255959.2547; train_gene_expr_recon_loss: 93140.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355487.0978; train_optim_loss: 355487.0978; val_kl_reg_loss: 6365.4786; val_edge_recon_loss: 255145.9271; val_gene_expr_recon_loss: 95369.7040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356881.1074; val_optim_loss: 356881.1074

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 301 min 6 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9981
Val AUPRC score: 0.9976
Val best accuracy score: 0.9876
Val best F1 score: 0.9877
Val gene expr MSE score: 0.6189

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
