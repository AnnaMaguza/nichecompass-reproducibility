None
Run timestamp: 19072023_141517_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9789; val_auprc_score: 0.9723; val_best_acc_score: 0.9380; val_best_f1_score: 0.9395; train_kl_reg_loss: 84941.4970; train_edge_recon_loss: 26816596.5396; train_gene_expr_recon_loss: 11556311.6467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38457849.6857; train_optim_loss: 38457849.6857; val_kl_reg_loss: 101371.1805; val_edge_recon_loss: 26223636.7250; val_gene_expr_recon_loss: 10597956.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36922964.2500; val_optim_loss: 36922964.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9826; val_auprc_score: 0.9782; val_best_acc_score: 0.9441; val_best_f1_score: 0.9456; train_kl_reg_loss: 99295.3995; train_edge_recon_loss: 26015257.1961; train_gene_expr_recon_loss: 10295808.5438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36410361.1794; train_optim_loss: 36410361.1794; val_kl_reg_loss: 91358.1884; val_edge_recon_loss: 26093398.9250; val_gene_expr_recon_loss: 10119261.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36304018.6500; val_optim_loss: 36304018.6500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9852; val_auprc_score: 0.9813; val_best_acc_score: 0.9512; val_best_f1_score: 0.9525; train_kl_reg_loss: 87979.2007; train_edge_recon_loss: 25920816.2893; train_gene_expr_recon_loss: 9926766.0487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35935561.5688; train_optim_loss: 35935561.5688; val_kl_reg_loss: 79923.4555; val_edge_recon_loss: 25975218.9000; val_gene_expr_recon_loss: 9854639.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35909782.3000; val_optim_loss: 35909782.3000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9855; val_auprc_score: 0.9818; val_best_acc_score: 0.9518; val_best_f1_score: 0.9531; train_kl_reg_loss: 83593.1018; train_edge_recon_loss: 25892494.3338; train_gene_expr_recon_loss: 9756404.0125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35732491.4159; train_optim_loss: 35732491.4159; val_kl_reg_loss: 78467.0264; val_edge_recon_loss: 25938346.8000; val_gene_expr_recon_loss: 9704891.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35721705.9000; val_optim_loss: 35721705.9000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9868; val_auprc_score: 0.9835; val_best_acc_score: 0.9552; val_best_f1_score: 0.9563; train_kl_reg_loss: 75964.3540; train_edge_recon_loss: 25831989.4186; train_gene_expr_recon_loss: 9619046.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35527000.0278; train_optim_loss: 35527000.0278; val_kl_reg_loss: 72659.4896; val_edge_recon_loss: 25886064.0250; val_gene_expr_recon_loss: 9594536.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35553260.2500; val_optim_loss: 35553260.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9868; val_auprc_score: 0.9834; val_best_acc_score: 0.9552; val_best_f1_score: 0.9563; train_kl_reg_loss: 72888.3240; train_edge_recon_loss: 25790452.7844; train_gene_expr_recon_loss: 9485328.5118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35348669.6412; train_optim_loss: 35348669.6412; val_kl_reg_loss: 69899.5455; val_edge_recon_loss: 25863708.0000; val_gene_expr_recon_loss: 9491326.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35424934.5500; val_optim_loss: 35424934.5500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9877; val_auprc_score: 0.9846; val_best_acc_score: 0.9565; val_best_f1_score: 0.9576; train_kl_reg_loss: 71082.3413; train_edge_recon_loss: 25758621.0654; train_gene_expr_recon_loss: 9358098.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35187802.0473; train_optim_loss: 35187802.0473; val_kl_reg_loss: 67432.5514; val_edge_recon_loss: 25854676.2000; val_gene_expr_recon_loss: 9417422.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35339530.9000; val_optim_loss: 35339530.9000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9883; val_auprc_score: 0.9855; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 68627.0060; train_edge_recon_loss: 25739153.4186; train_gene_expr_recon_loss: 9284525.7538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35092306.1752; train_optim_loss: 35092306.1752; val_kl_reg_loss: 68830.8215; val_edge_recon_loss: 25819808.5500; val_gene_expr_recon_loss: 9327902.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35216541.8500; val_optim_loss: 35216541.8500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9885; val_auprc_score: 0.9856; val_best_acc_score: 0.9588; val_best_f1_score: 0.9599; train_kl_reg_loss: 67492.4554; train_edge_recon_loss: 25729399.5772; train_gene_expr_recon_loss: 9202074.4402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34998966.5981; train_optim_loss: 34998966.5981; val_kl_reg_loss: 65730.3484; val_edge_recon_loss: 25828123.0500; val_gene_expr_recon_loss: 9234307.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35128160.7500; val_optim_loss: 35128160.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9893; val_auprc_score: 0.9869; val_best_acc_score: 0.9602; val_best_f1_score: 0.9612; train_kl_reg_loss: 66287.4216; train_edge_recon_loss: 25710449.4687; train_gene_expr_recon_loss: 9140983.4478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34917720.3394; train_optim_loss: 34917720.3394; val_kl_reg_loss: 63671.4391; val_edge_recon_loss: 25817677.6250; val_gene_expr_recon_loss: 9274024.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35155373.7000; val_optim_loss: 35155373.7000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9892; val_auprc_score: 0.9865; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 65643.6396; train_edge_recon_loss: 25692754.2309; train_gene_expr_recon_loss: 9081984.6704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34840382.4979; train_optim_loss: 34840382.4979; val_kl_reg_loss: 63594.9581; val_edge_recon_loss: 25790599.6750; val_gene_expr_recon_loss: 9176256.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35030450.5500; val_optim_loss: 35030450.5500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9893; val_auprc_score: 0.9867; val_best_acc_score: 0.9607; val_best_f1_score: 0.9616; train_kl_reg_loss: 65090.0888; train_edge_recon_loss: 25686642.8401; train_gene_expr_recon_loss: 9046531.9013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34798264.8289; train_optim_loss: 34798264.8289; val_kl_reg_loss: 63339.8439; val_edge_recon_loss: 25781706.6000; val_gene_expr_recon_loss: 9143114.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34988161.4000; val_optim_loss: 34988161.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 65151.1004; train_edge_recon_loss: 25676918.0362; train_gene_expr_recon_loss: 9000273.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34742342.6426; train_optim_loss: 34742342.6426; val_kl_reg_loss: 63943.1168; val_edge_recon_loss: 25792190.0250; val_gene_expr_recon_loss: 9063637.9812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34919771.1000; val_optim_loss: 34919771.1000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9615; val_best_f1_score: 0.9623; train_kl_reg_loss: 65345.2447; train_edge_recon_loss: 25661846.3255; train_gene_expr_recon_loss: 8951256.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34678447.7997; train_optim_loss: 34678447.7997; val_kl_reg_loss: 64514.6875; val_edge_recon_loss: 25787430.9750; val_gene_expr_recon_loss: 9038972.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34890918.3500; val_optim_loss: 34890918.3500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9905; val_auprc_score: 0.9882; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 65064.6975; train_edge_recon_loss: 25664883.7024; train_gene_expr_recon_loss: 8924163.8727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34654112.3171; train_optim_loss: 34654112.3171; val_kl_reg_loss: 63119.8826; val_edge_recon_loss: 25762666.9750; val_gene_expr_recon_loss: 9054811.4313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34880598.3000; val_optim_loss: 34880598.3000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9902; val_auprc_score: 0.9879; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 65146.5914; train_edge_recon_loss: 25655020.1335; train_gene_expr_recon_loss: 8887959.0132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34608125.7997; train_optim_loss: 34608125.7997; val_kl_reg_loss: 63109.6212; val_edge_recon_loss: 25785189.1750; val_gene_expr_recon_loss: 9013910.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34862209.0500; val_optim_loss: 34862209.0500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9902; val_auprc_score: 0.9877; val_best_acc_score: 0.9631; val_best_f1_score: 0.9638; train_kl_reg_loss: 64828.3982; train_edge_recon_loss: 25645574.6843; train_gene_expr_recon_loss: 8874232.3533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34584635.3992; train_optim_loss: 34584635.3992; val_kl_reg_loss: 62600.8098; val_edge_recon_loss: 25762558.4000; val_gene_expr_recon_loss: 8993096.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34818255.3000; val_optim_loss: 34818255.3000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9883; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 64571.7209; train_edge_recon_loss: 25647393.8665; train_gene_expr_recon_loss: 8843875.1050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34555840.7260; train_optim_loss: 34555840.7260; val_kl_reg_loss: 63091.8889; val_edge_recon_loss: 25732186.2500; val_gene_expr_recon_loss: 8948932.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34744210.2500; val_optim_loss: 34744210.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9642; val_best_f1_score: 0.9650; train_kl_reg_loss: 65118.0137; train_edge_recon_loss: 25635113.1794; train_gene_expr_recon_loss: 8825280.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34525511.4854; train_optim_loss: 34525511.4854; val_kl_reg_loss: 63638.5612; val_edge_recon_loss: 25756827.3500; val_gene_expr_recon_loss: 8921740.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34742206.1750; val_optim_loss: 34742206.1750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9909; val_auprc_score: 0.9888; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 64926.6069; train_edge_recon_loss: 25640698.1697; train_gene_expr_recon_loss: 8802263.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34507888.6175; train_optim_loss: 34507888.6175; val_kl_reg_loss: 63315.1410; val_edge_recon_loss: 25727313.7750; val_gene_expr_recon_loss: 8938119.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34728748.4500; val_optim_loss: 34728748.4500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9909; val_auprc_score: 0.9886; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 64358.2045; train_edge_recon_loss: 25629928.0167; train_gene_expr_recon_loss: 8796335.6516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34490621.8498; train_optim_loss: 34490621.8498; val_kl_reg_loss: 64359.4821; val_edge_recon_loss: 25741323.8500; val_gene_expr_recon_loss: 8929770.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34735454.0500; val_optim_loss: 34735454.0500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9912; val_auprc_score: 0.9890; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 65084.5252; train_edge_recon_loss: 25631614.7010; train_gene_expr_recon_loss: 8777370.1446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34474069.3713; train_optim_loss: 34474069.3713; val_kl_reg_loss: 63071.4340; val_edge_recon_loss: 25728152.1250; val_gene_expr_recon_loss: 8912545.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34703769.7500; val_optim_loss: 34703769.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9917; val_auprc_score: 0.9897; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 64698.5709; train_edge_recon_loss: 25620224.3866; train_gene_expr_recon_loss: 8770462.3616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34455385.3185; train_optim_loss: 34455385.3185; val_kl_reg_loss: 63814.4172; val_edge_recon_loss: 25760159.0250; val_gene_expr_recon_loss: 8929863.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34753836.7000; val_optim_loss: 34753836.7000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9914; val_auprc_score: 0.9894; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 64828.9676; train_edge_recon_loss: 25611506.8929; train_gene_expr_recon_loss: 8744980.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34421316.2726; train_optim_loss: 34421316.2726; val_kl_reg_loss: 63357.2405; val_edge_recon_loss: 25720332.7000; val_gene_expr_recon_loss: 8924227.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34707917.0000; val_optim_loss: 34707917.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9917; val_auprc_score: 0.9895; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 64802.9703; train_edge_recon_loss: 25613663.2740; train_gene_expr_recon_loss: 8742521.3449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34420987.6328; train_optim_loss: 34420987.6328; val_kl_reg_loss: 63370.6236; val_edge_recon_loss: 25732523.6500; val_gene_expr_recon_loss: 8904157.8812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34700052.0500; val_optim_loss: 34700052.0500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9919; val_auprc_score: 0.9900; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 64594.1482; train_edge_recon_loss: 25614596.8762; train_gene_expr_recon_loss: 8722200.6467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34401391.6773; train_optim_loss: 34401391.6773; val_kl_reg_loss: 62862.1917; val_edge_recon_loss: 25718734.0750; val_gene_expr_recon_loss: 8917111.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34698708.1000; val_optim_loss: 34698708.1000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9917; val_auprc_score: 0.9896; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 64991.7800; train_edge_recon_loss: 25606748.1502; train_gene_expr_recon_loss: 8709593.0584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34381332.9597; train_optim_loss: 34381332.9597; val_kl_reg_loss: 63681.0008; val_edge_recon_loss: 25711830.6500; val_gene_expr_recon_loss: 8898776.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34674288.0000; val_optim_loss: 34674288.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 64643.3078; train_edge_recon_loss: 25613109.7524; train_gene_expr_recon_loss: 8708335.3275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34386088.4033; train_optim_loss: 34386088.4033; val_kl_reg_loss: 62350.5892; val_edge_recon_loss: 25711107.2000; val_gene_expr_recon_loss: 8866230.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34639688.0500; val_optim_loss: 34639688.0500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9683; val_best_f1_score: 0.9690; train_kl_reg_loss: 65059.5268; train_edge_recon_loss: 25594705.3574; train_gene_expr_recon_loss: 8700530.2218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34360295.1544; train_optim_loss: 34360295.1544; val_kl_reg_loss: 63160.3994; val_edge_recon_loss: 25711637.1000; val_gene_expr_recon_loss: 8880938.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34655735.4500; val_optim_loss: 34655735.4500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9923; val_auprc_score: 0.9905; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 64946.9440; train_edge_recon_loss: 25597850.3227; train_gene_expr_recon_loss: 8696276.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34359073.6968; train_optim_loss: 34359073.6968; val_kl_reg_loss: 62457.1929; val_edge_recon_loss: 25705485.7500; val_gene_expr_recon_loss: 8859849.8063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34627792.5500; val_optim_loss: 34627792.5500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9919; val_auprc_score: 0.9897; val_best_acc_score: 0.9694; val_best_f1_score: 0.9700; train_kl_reg_loss: 64353.2777; train_edge_recon_loss: 25596638.5563; train_gene_expr_recon_loss: 8682012.9145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34343004.6509; train_optim_loss: 34343004.6509; val_kl_reg_loss: 62893.2313; val_edge_recon_loss: 25730706.5500; val_gene_expr_recon_loss: 8850466.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34644066.5000; val_optim_loss: 34644066.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9923; val_auprc_score: 0.9905; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 64166.8600; train_edge_recon_loss: 25597855.1377; train_gene_expr_recon_loss: 8672261.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34334283.1850; train_optim_loss: 34334283.1850; val_kl_reg_loss: 63606.5660; val_edge_recon_loss: 25715917.7250; val_gene_expr_recon_loss: 8862090.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34641614.6000; val_optim_loss: 34641614.6000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 64350.6213; train_edge_recon_loss: 25594587.2323; train_gene_expr_recon_loss: 8670769.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34329706.8540; train_optim_loss: 34329706.8540; val_kl_reg_loss: 63328.8755; val_edge_recon_loss: 25700719.8500; val_gene_expr_recon_loss: 8867284.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34631333.7000; val_optim_loss: 34631333.7000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9925; val_auprc_score: 0.9907; val_best_acc_score: 0.9704; val_best_f1_score: 0.9710; train_kl_reg_loss: 64486.7712; train_edge_recon_loss: 25587999.9416; train_gene_expr_recon_loss: 8672424.6697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34324911.4298; train_optim_loss: 34324911.4298; val_kl_reg_loss: 63395.8971; val_edge_recon_loss: 25708467.8750; val_gene_expr_recon_loss: 8846645.0563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34618508.6500; val_optim_loss: 34618508.6500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9924; val_auprc_score: 0.9904; val_best_acc_score: 0.9709; val_best_f1_score: 0.9715; train_kl_reg_loss: 63975.9401; train_edge_recon_loss: 25589736.0695; train_gene_expr_recon_loss: 8652405.4423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34306117.4993; train_optim_loss: 34306117.4993; val_kl_reg_loss: 62842.2615; val_edge_recon_loss: 25686876.2250; val_gene_expr_recon_loss: 8826913.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34576632.5500; val_optim_loss: 34576632.5500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9929; val_auprc_score: 0.9909; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 64140.4395; train_edge_recon_loss: 25583526.2309; train_gene_expr_recon_loss: 8652686.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34300352.7260; train_optim_loss: 34300352.7260; val_kl_reg_loss: 64006.9967; val_edge_recon_loss: 25682409.6500; val_gene_expr_recon_loss: 8812330.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34558747.2000; val_optim_loss: 34558747.2000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 64691.2759; train_edge_recon_loss: 25572112.4924; train_gene_expr_recon_loss: 8647273.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34284077.0376; train_optim_loss: 34284077.0376; val_kl_reg_loss: 64050.1797; val_edge_recon_loss: 25685257.7000; val_gene_expr_recon_loss: 8811834.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34561142.7500; val_optim_loss: 34561142.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9925; val_auprc_score: 0.9902; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 64466.6644; train_edge_recon_loss: 25584467.4242; train_gene_expr_recon_loss: 8645443.0869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34294377.1572; train_optim_loss: 34294377.1572; val_kl_reg_loss: 63841.1681; val_edge_recon_loss: 25693291.3000; val_gene_expr_recon_loss: 8830688.0687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34587820.3000; val_optim_loss: 34587820.3000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 64911.4281; train_edge_recon_loss: 25573102.1001; train_gene_expr_recon_loss: 8635871.7796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34273885.3992; train_optim_loss: 34273885.3992; val_kl_reg_loss: 63175.1775; val_edge_recon_loss: 25670503.5500; val_gene_expr_recon_loss: 8819379.4812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34553058.2500; val_optim_loss: 34553058.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9931; val_auprc_score: 0.9914; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 64780.7945; train_edge_recon_loss: 25579966.5814; train_gene_expr_recon_loss: 8628618.1773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34273365.5271; train_optim_loss: 34273365.5271; val_kl_reg_loss: 64004.9955; val_edge_recon_loss: 25672308.9000; val_gene_expr_recon_loss: 8816437.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34552751.0000; val_optim_loss: 34552751.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 64478.7520; train_edge_recon_loss: 25569067.0709; train_gene_expr_recon_loss: 8617890.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34251435.8693; train_optim_loss: 34251435.8693; val_kl_reg_loss: 63649.7155; val_edge_recon_loss: 25684547.6750; val_gene_expr_recon_loss: 8803507.5563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34551704.9500; val_optim_loss: 34551704.9500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9929; val_auprc_score: 0.9908; val_best_acc_score: 0.9715; val_best_f1_score: 0.9720; train_kl_reg_loss: 64419.4630; train_edge_recon_loss: 25577805.6523; train_gene_expr_recon_loss: 8618126.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34260351.3658; train_optim_loss: 34260351.3658; val_kl_reg_loss: 62706.2417; val_edge_recon_loss: 25681550.8000; val_gene_expr_recon_loss: 8821273.1188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34565530.1000; val_optim_loss: 34565530.1000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 64129.2132; train_edge_recon_loss: 25577073.8776; train_gene_expr_recon_loss: 8625171.0967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34266374.1752; train_optim_loss: 34266374.1752; val_kl_reg_loss: 63449.3774; val_edge_recon_loss: 25686889.8000; val_gene_expr_recon_loss: 8804924.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34555263.3500; val_optim_loss: 34555263.3500
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9931; val_auprc_score: 0.9912; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 64805.5179; train_edge_recon_loss: 25563744.1224; train_gene_expr_recon_loss: 8620313.0987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34248862.7594; train_optim_loss: 34248862.7594; val_kl_reg_loss: 63059.1418; val_edge_recon_loss: 25646838.5000; val_gene_expr_recon_loss: 8823638.8187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34533536.5000; val_optim_loss: 34533536.5000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9933; val_auprc_score: 0.9915; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 65206.3277; train_edge_recon_loss: 25568447.3102; train_gene_expr_recon_loss: 8614848.5007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34248502.2253; train_optim_loss: 34248502.2253; val_kl_reg_loss: 64001.2337; val_edge_recon_loss: 25663108.7250; val_gene_expr_recon_loss: 8826563.7937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34553673.9000; val_optim_loss: 34553673.9000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9936; val_auprc_score: 0.9920; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 64341.5021; train_edge_recon_loss: 25557271.0960; train_gene_expr_recon_loss: 8613715.9179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34235328.4757; train_optim_loss: 34235328.4757; val_kl_reg_loss: 63344.7000; val_edge_recon_loss: 25650300.4250; val_gene_expr_recon_loss: 8799742.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34513387.6000; val_optim_loss: 34513387.6000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9935; val_auprc_score: 0.9918; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 64267.5064; train_edge_recon_loss: 25562513.4019; train_gene_expr_recon_loss: 8602730.4993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34229511.3741; train_optim_loss: 34229511.3741; val_kl_reg_loss: 63688.3222; val_edge_recon_loss: 25654639.3750; val_gene_expr_recon_loss: 8801609.5813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34519937.4500; val_optim_loss: 34519937.4500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9731; val_best_f1_score: 0.9736; train_kl_reg_loss: 64661.8037; train_edge_recon_loss: 25566886.6565; train_gene_expr_recon_loss: 8602418.9207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34233967.3157; train_optim_loss: 34233967.3157; val_kl_reg_loss: 62042.9887; val_edge_recon_loss: 25661027.3000; val_gene_expr_recon_loss: 8837378.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34560448.9000; val_optim_loss: 34560448.9000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9932; val_auprc_score: 0.9916; val_best_acc_score: 0.9723; val_best_f1_score: 0.9728; train_kl_reg_loss: 64346.5566; train_edge_recon_loss: 25561875.3408; train_gene_expr_recon_loss: 8593867.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34220089.1349; train_optim_loss: 34220089.1349; val_kl_reg_loss: 63049.2452; val_edge_recon_loss: 25684446.3750; val_gene_expr_recon_loss: 8769783.6188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34517279.1000; val_optim_loss: 34517279.1000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 64754.3008; train_edge_recon_loss: 25554968.7650; train_gene_expr_recon_loss: 8589805.6634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34209528.7622; train_optim_loss: 34209528.7622; val_kl_reg_loss: 63840.3710; val_edge_recon_loss: 25660397.6000; val_gene_expr_recon_loss: 8813968.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34538206.9000; val_optim_loss: 34538206.9000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 65139.1636; train_edge_recon_loss: 25540282.1697; train_gene_expr_recon_loss: 8500423.0403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34105844.3421; train_optim_loss: 34105844.3421; val_kl_reg_loss: 63967.3449; val_edge_recon_loss: 25654552.6500; val_gene_expr_recon_loss: 8733083.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34451603.0750; val_optim_loss: 34451603.0750
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 65389.7616; train_edge_recon_loss: 25541670.0445; train_gene_expr_recon_loss: 8479509.8463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34086569.6106; train_optim_loss: 34086569.6106; val_kl_reg_loss: 64193.6620; val_edge_recon_loss: 25648887.3000; val_gene_expr_recon_loss: 8710033.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34423114.4500; val_optim_loss: 34423114.4500
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 65875.3351; train_edge_recon_loss: 25536346.4312; train_gene_expr_recon_loss: 8463678.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34065899.9750; train_optim_loss: 34065899.9750; val_kl_reg_loss: 64745.4282; val_edge_recon_loss: 25620993.3000; val_gene_expr_recon_loss: 8714884.2937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34400623.0000; val_optim_loss: 34400623.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 65950.1023; train_edge_recon_loss: 25549721.6439; train_gene_expr_recon_loss: 8462156.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34077828.3950; train_optim_loss: 34077828.3950; val_kl_reg_loss: 65020.0544; val_edge_recon_loss: 25611787.3500; val_gene_expr_recon_loss: 8675741.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34352549.1750; val_optim_loss: 34352549.1750
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 66111.3559; train_edge_recon_loss: 25534620.1168; train_gene_expr_recon_loss: 8453235.4458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34053966.9569; train_optim_loss: 34053966.9569; val_kl_reg_loss: 65143.8646; val_edge_recon_loss: 25624707.1500; val_gene_expr_recon_loss: 8699214.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34389066.2000; val_optim_loss: 34389066.2000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 66374.7275; train_edge_recon_loss: 25539656.9958; train_gene_expr_recon_loss: 8451649.7670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34057681.5049; train_optim_loss: 34057681.5049; val_kl_reg_loss: 64843.0490; val_edge_recon_loss: 25634645.0000; val_gene_expr_recon_loss: 8664483.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34363972.2000; val_optim_loss: 34363972.2000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 66201.4090; train_edge_recon_loss: 25538196.8011; train_gene_expr_recon_loss: 8456267.1043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34060665.2990; train_optim_loss: 34060665.2990; val_kl_reg_loss: 64989.2026; val_edge_recon_loss: 25644651.6000; val_gene_expr_recon_loss: 8674012.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34383653.3500; val_optim_loss: 34383653.3500
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 66300.8908; train_edge_recon_loss: 25545221.0515; train_gene_expr_recon_loss: 8453190.7010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34064712.6231; train_optim_loss: 34064712.6231; val_kl_reg_loss: 64800.8964; val_edge_recon_loss: 25634214.3750; val_gene_expr_recon_loss: 8663843.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34362859.1750; val_optim_loss: 34362859.1750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 66328.9781; train_edge_recon_loss: 25537470.5007; train_gene_expr_recon_loss: 8439924.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34043724.3755; train_optim_loss: 34043724.3755; val_kl_reg_loss: 64593.5967; val_edge_recon_loss: 25627388.9000; val_gene_expr_recon_loss: 8646692.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34338674.8750; val_optim_loss: 34338674.8750
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 66300.4715; train_edge_recon_loss: 25538504.1780; train_gene_expr_recon_loss: 8432336.9840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34037141.6773; train_optim_loss: 34037141.6773; val_kl_reg_loss: 64825.5726; val_edge_recon_loss: 25654070.6000; val_gene_expr_recon_loss: 8675443.2063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34394339.2000; val_optim_loss: 34394339.2000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 66252.0419; train_edge_recon_loss: 25530711.5605; train_gene_expr_recon_loss: 8436905.1252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34033868.6954; train_optim_loss: 34033868.6954; val_kl_reg_loss: 65075.1354; val_edge_recon_loss: 25618126.9250; val_gene_expr_recon_loss: 8670375.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34353577.8250; val_optim_loss: 34353577.8250
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 66361.9924; train_edge_recon_loss: 25533729.4631; train_gene_expr_recon_loss: 8436092.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34036183.8804; train_optim_loss: 34036183.8804; val_kl_reg_loss: 65055.5868; val_edge_recon_loss: 25644146.4500; val_gene_expr_recon_loss: 8670633.5813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34379835.7750; val_optim_loss: 34379835.7750
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 66261.7231; train_edge_recon_loss: 25534578.6871; train_gene_expr_recon_loss: 8426787.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34027628.0111; train_optim_loss: 34027628.0111; val_kl_reg_loss: 64888.5108; val_edge_recon_loss: 25622584.9250; val_gene_expr_recon_loss: 8657311.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34344785.6500; val_optim_loss: 34344785.6500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9939; val_auprc_score: 0.9925; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 66418.9865; train_edge_recon_loss: 25536393.4882; train_gene_expr_recon_loss: 8436730.1106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34039542.5925; train_optim_loss: 34039542.5925; val_kl_reg_loss: 65042.3509; val_edge_recon_loss: 25654204.2000; val_gene_expr_recon_loss: 8655251.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34374498.2500; val_optim_loss: 34374498.2500
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 66344.5334; train_edge_recon_loss: 25534267.0153; train_gene_expr_recon_loss: 8434268.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34034880.4451; train_optim_loss: 34034880.4451; val_kl_reg_loss: 64925.5320; val_edge_recon_loss: 25612702.0000; val_gene_expr_recon_loss: 8645285.2063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34322913.0000; val_optim_loss: 34322913.0000
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9936; val_auprc_score: 0.9921; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 66268.9317; train_edge_recon_loss: 25539837.6300; train_gene_expr_recon_loss: 8427682.8227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34033789.4910; train_optim_loss: 34033789.4910; val_kl_reg_loss: 64910.8582; val_edge_recon_loss: 25646712.3500; val_gene_expr_recon_loss: 8646867.7063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34358490.9500; val_optim_loss: 34358490.9500
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 66279.7168; train_edge_recon_loss: 25530343.4576; train_gene_expr_recon_loss: 8433675.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34030299.0654; train_optim_loss: 34030299.0654; val_kl_reg_loss: 64909.3438; val_edge_recon_loss: 25647794.3000; val_gene_expr_recon_loss: 8654262.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34366965.9500; val_optim_loss: 34366965.9500
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9938; val_auprc_score: 0.9922; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 66348.8538; train_edge_recon_loss: 25541482.2587; train_gene_expr_recon_loss: 8433049.3547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34040880.4145; train_optim_loss: 34040880.4145; val_kl_reg_loss: 65035.6745; val_edge_recon_loss: 25630492.1500; val_gene_expr_recon_loss: 8669829.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34365357.8250; val_optim_loss: 34365357.8250
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9939; val_auprc_score: 0.9920; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 66321.4030; train_edge_recon_loss: 25540847.3964; train_gene_expr_recon_loss: 8422267.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34029436.0083; train_optim_loss: 34029436.0083; val_kl_reg_loss: 65079.9378; val_edge_recon_loss: 25615794.7000; val_gene_expr_recon_loss: 8665618.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34346492.7500; val_optim_loss: 34346492.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 66317.9952; train_edge_recon_loss: 25524680.8679; train_gene_expr_recon_loss: 8436172.8435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34027171.7858; train_optim_loss: 34027171.7858; val_kl_reg_loss: 64845.8785; val_edge_recon_loss: 25609465.6000; val_gene_expr_recon_loss: 8646008.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34320320.1500; val_optim_loss: 34320320.1500
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 66265.2665; train_edge_recon_loss: 25533463.7691; train_gene_expr_recon_loss: 8430566.7211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34030295.7803; train_optim_loss: 34030295.7803; val_kl_reg_loss: 64783.9524; val_edge_recon_loss: 25640473.8750; val_gene_expr_recon_loss: 8642528.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34347785.9250; val_optim_loss: 34347785.9250
Epoch 72/100 |██████████████------| 72.0% val_auroc_score: 0.9936; val_auprc_score: 0.9916; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 66260.6994; train_edge_recon_loss: 25537072.5424; train_gene_expr_recon_loss: 8424538.5229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34027871.7663; train_optim_loss: 34027871.7663; val_kl_reg_loss: 64999.5582; val_edge_recon_loss: 25641311.3250; val_gene_expr_recon_loss: 8665838.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34372149.4500; val_optim_loss: 34372149.4500
Epoch 73/100 |██████████████------| 73.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 66369.6897; train_edge_recon_loss: 25531581.2156; train_gene_expr_recon_loss: 8430961.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34028912.0250; train_optim_loss: 34028912.0250; val_kl_reg_loss: 64795.5573; val_edge_recon_loss: 25649551.8750; val_gene_expr_recon_loss: 8627438.0125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34341785.5750; val_optim_loss: 34341785.5750
Epoch 74/100 |██████████████------| 74.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 66258.2453; train_edge_recon_loss: 25538990.4117; train_gene_expr_recon_loss: 8428615.4305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34033864.0389; train_optim_loss: 34033864.0389; val_kl_reg_loss: 64853.5599; val_edge_recon_loss: 25607700.2500; val_gene_expr_recon_loss: 8650108.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34322662.5000; val_optim_loss: 34322662.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 75/100 |███████████████-----| 75.0% val_auroc_score: 0.9941; val_auprc_score: 0.9927; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 66402.4775; train_edge_recon_loss: 25533367.1293; train_gene_expr_recon_loss: 8432784.4513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34032554.1307; train_optim_loss: 34032554.1307; val_kl_reg_loss: 64697.9147; val_edge_recon_loss: 25609347.3750; val_gene_expr_recon_loss: 8653437.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34327482.4000; val_optim_loss: 34327482.4000
Epoch 76/100 |███████████████-----| 76.0% val_auroc_score: 0.9939; val_auprc_score: 0.9924; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 66341.9682; train_edge_recon_loss: 25539629.4854; train_gene_expr_recon_loss: 8429308.3637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34035279.7691; train_optim_loss: 34035279.7691; val_kl_reg_loss: 64623.4791; val_edge_recon_loss: 25638589.6750; val_gene_expr_recon_loss: 8657275.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34360488.6000; val_optim_loss: 34360488.6000
Epoch 77/100 |███████████████-----| 77.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 66318.0169; train_edge_recon_loss: 25535345.1349; train_gene_expr_recon_loss: 8426830.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34028493.7330; train_optim_loss: 34028493.7330; val_kl_reg_loss: 64619.5013; val_edge_recon_loss: 25652546.2750; val_gene_expr_recon_loss: 8638534.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34355700.0000; val_optim_loss: 34355700.0000
Epoch 78/100 |███████████████-----| 78.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 66248.2666; train_edge_recon_loss: 25543255.0765; train_gene_expr_recon_loss: 8424618.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34034121.3296; train_optim_loss: 34034121.3296; val_kl_reg_loss: 64974.5583; val_edge_recon_loss: 25604205.2750; val_gene_expr_recon_loss: 8668875.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34338055.1500; val_optim_loss: 34338055.1500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 279 min 6 sec.
Using best model state, which was in epoch 70.

--- MODEL EVALUATION ---
Val AUROC score: 0.9938
Val AUPRC score: 0.9923
Val best accuracy score: 0.9734
Val best F1 score: 0.9739
Val gene expr MSE score: 0.7075

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
