None
Run timestamp: 12072023_130422_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9879; val_auprc_score: 0.9843; val_best_acc_score: 0.9577; val_best_f1_score: 0.9587; train_kl_reg_loss: 7765.2577; train_edge_recon_loss: 265851.4495; train_gene_expr_recon_loss: 122734.9184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396351.6253; train_optim_loss: 396351.6253; val_kl_reg_loss: 7459.6215; val_edge_recon_loss: 260581.6918; val_gene_expr_recon_loss: 111705.3734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379746.6871; val_optim_loss: 379746.6871
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9920; val_auprc_score: 0.9899; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 7238.1430; train_edge_recon_loss: 260482.2699; train_gene_expr_recon_loss: 108705.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376425.4755; train_optim_loss: 376425.4755; val_kl_reg_loss: 6865.0743; val_edge_recon_loss: 259277.3102; val_gene_expr_recon_loss: 105939.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372082.3098; val_optim_loss: 372082.3098
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 6964.1104; train_edge_recon_loss: 259814.2910; train_gene_expr_recon_loss: 104548.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371327.2808; train_optim_loss: 371327.2808; val_kl_reg_loss: 6835.9379; val_edge_recon_loss: 259142.6713; val_gene_expr_recon_loss: 103011.7288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368990.3383; val_optim_loss: 368990.3383
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 6802.9916; train_edge_recon_loss: 259302.0863; train_gene_expr_recon_loss: 102062.1345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368167.2120; train_optim_loss: 368167.2120; val_kl_reg_loss: 6777.5548; val_edge_recon_loss: 258476.0297; val_gene_expr_recon_loss: 101231.8335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366485.4199; val_optim_loss: 366485.4199
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 6697.0123; train_edge_recon_loss: 258899.8561; train_gene_expr_recon_loss: 100398.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365995.6413; train_optim_loss: 365995.6413; val_kl_reg_loss: 6588.4602; val_edge_recon_loss: 257849.5477; val_gene_expr_recon_loss: 99809.3900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364247.3988; val_optim_loss: 364247.3988
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 6615.9368; train_edge_recon_loss: 258588.4954; train_gene_expr_recon_loss: 99300.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364505.0809; train_optim_loss: 364505.0809; val_kl_reg_loss: 6611.8015; val_edge_recon_loss: 257919.1162; val_gene_expr_recon_loss: 99128.9436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363659.8598; val_optim_loss: 363659.8598
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 6553.8361; train_edge_recon_loss: 258197.3036; train_gene_expr_recon_loss: 98491.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363243.0497; train_optim_loss: 363243.0497; val_kl_reg_loss: 6487.4840; val_edge_recon_loss: 257611.0309; val_gene_expr_recon_loss: 98418.8347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362517.3480; val_optim_loss: 362517.3480
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 6503.1098; train_edge_recon_loss: 258023.0123; train_gene_expr_recon_loss: 97784.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362310.9212; train_optim_loss: 362310.9212; val_kl_reg_loss: 6420.9416; val_edge_recon_loss: 257270.8936; val_gene_expr_recon_loss: 97904.1483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361595.9816; val_optim_loss: 361595.9816
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 6467.2722; train_edge_recon_loss: 257773.8285; train_gene_expr_recon_loss: 97393.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361634.6775; train_optim_loss: 361634.6775; val_kl_reg_loss: 6445.1805; val_edge_recon_loss: 257282.5332; val_gene_expr_recon_loss: 97869.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361597.4301; val_optim_loss: 361597.4301
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 6439.4465; train_edge_recon_loss: 257610.0362; train_gene_expr_recon_loss: 97054.6317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361104.1145; train_optim_loss: 361104.1145; val_kl_reg_loss: 6289.7340; val_edge_recon_loss: 257225.9648; val_gene_expr_recon_loss: 97252.6916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360768.3914; val_optim_loss: 360768.3914
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6419.6985; train_edge_recon_loss: 257452.6262; train_gene_expr_recon_loss: 96789.0724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360661.3964; train_optim_loss: 360661.3964; val_kl_reg_loss: 6490.4062; val_edge_recon_loss: 256824.4637; val_gene_expr_recon_loss: 97170.3413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360485.2109; val_optim_loss: 360485.2109
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6403.7406; train_edge_recon_loss: 257354.7881; train_gene_expr_recon_loss: 96478.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360236.9333; train_optim_loss: 360236.9333; val_kl_reg_loss: 6231.1005; val_edge_recon_loss: 256408.9500; val_gene_expr_recon_loss: 97023.7608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359663.8129; val_optim_loss: 359663.8129
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6391.0966; train_edge_recon_loss: 257230.8222; train_gene_expr_recon_loss: 96272.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359894.6045; train_optim_loss: 359894.6045; val_kl_reg_loss: 6326.6615; val_edge_recon_loss: 256708.1605; val_gene_expr_recon_loss: 96907.7061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359942.5258; val_optim_loss: 359942.5258
