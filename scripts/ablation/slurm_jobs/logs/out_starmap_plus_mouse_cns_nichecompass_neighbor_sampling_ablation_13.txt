None
Run timestamp: 07082023_114532_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9887; val_auprc_score: 0.9860; val_best_acc_score: 0.9582; val_best_f1_score: 0.9592; train_kl_reg_loss: 7243.5051; train_edge_recon_loss: 264408.6911; train_gene_expr_recon_loss: 197011.7866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 468663.9826; train_optim_loss: 468663.9826; val_kl_reg_loss: 6944.3339; val_edge_recon_loss: 261201.0538; val_gene_expr_recon_loss: 181659.9657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449805.3533; val_optim_loss: 449805.3533
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9914; val_auprc_score: 0.9894; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 6878.9667; train_edge_recon_loss: 260307.3370; train_gene_expr_recon_loss: 177501.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444688.2029; train_optim_loss: 444688.2029; val_kl_reg_loss: 6571.8613; val_edge_recon_loss: 260199.1487; val_gene_expr_recon_loss: 173758.1666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440529.1767; val_optim_loss: 440529.1767
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9920; val_auprc_score: 0.9903; val_best_acc_score: 0.9654; val_best_f1_score: 0.9660; train_kl_reg_loss: 6781.8878; train_edge_recon_loss: 259499.0617; train_gene_expr_recon_loss: 172607.6223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438888.5721; train_optim_loss: 438888.5721; val_kl_reg_loss: 6635.2188; val_edge_recon_loss: 259896.7627; val_gene_expr_recon_loss: 170396.9890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436928.9711; val_optim_loss: 436928.9711
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9932; val_auprc_score: 0.9919; val_best_acc_score: 0.9684; val_best_f1_score: 0.9690; train_kl_reg_loss: 6766.9262; train_edge_recon_loss: 259130.8705; train_gene_expr_recon_loss: 169939.2495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435837.0465; train_optim_loss: 435837.0465; val_kl_reg_loss: 6652.9713; val_edge_recon_loss: 259571.5255; val_gene_expr_recon_loss: 168543.5405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434768.0383; val_optim_loss: 434768.0383
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9935; val_auprc_score: 0.9921; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 6770.1137; train_edge_recon_loss: 258764.7039; train_gene_expr_recon_loss: 168357.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433892.4418; train_optim_loss: 433892.4418; val_kl_reg_loss: 6615.5963; val_edge_recon_loss: 259338.2557; val_gene_expr_recon_loss: 167668.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433622.4315; val_optim_loss: 433622.4315
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9709; val_best_f1_score: 0.9714; train_kl_reg_loss: 6778.4524; train_edge_recon_loss: 258599.6437; train_gene_expr_recon_loss: 167388.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432767.0439; train_optim_loss: 432767.0439; val_kl_reg_loss: 6482.9544; val_edge_recon_loss: 259007.1269; val_gene_expr_recon_loss: 166856.3821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432346.4631; val_optim_loss: 432346.4631
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 6782.1052; train_edge_recon_loss: 258420.2981; train_gene_expr_recon_loss: 166821.0127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432023.4156; train_optim_loss: 432023.4156; val_kl_reg_loss: 6643.9475; val_edge_recon_loss: 258959.2688; val_gene_expr_recon_loss: 166125.9300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431729.1460; val_optim_loss: 431729.1460
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 6798.8576; train_edge_recon_loss: 258273.3603; train_gene_expr_recon_loss: 166133.9247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431206.1424; train_optim_loss: 431206.1424; val_kl_reg_loss: 6716.1591; val_edge_recon_loss: 259073.0865; val_gene_expr_recon_loss: 165685.0696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431474.3163; val_optim_loss: 431474.3163
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 6810.0998; train_edge_recon_loss: 258116.4839; train_gene_expr_recon_loss: 165416.5043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430343.0884; train_optim_loss: 430343.0884; val_kl_reg_loss: 6757.4533; val_edge_recon_loss: 258661.8777; val_gene_expr_recon_loss: 162259.3012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 427678.6313; val_optim_loss: 427678.6313
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 6820.6796; train_edge_recon_loss: 257996.2077; train_gene_expr_recon_loss: 164095.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 428912.1245; train_optim_loss: 428912.1245; val_kl_reg_loss: 6655.1720; val_edge_recon_loss: 258656.0133; val_gene_expr_recon_loss: 163057.1461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 428368.3320; val_optim_loss: 428368.3320
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9942; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 6833.2815; train_edge_recon_loss: 257949.1160; train_gene_expr_recon_loss: 162211.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 426993.7196; train_optim_loss: 426993.7196; val_kl_reg_loss: 6702.2538; val_edge_recon_loss: 258498.4089; val_gene_expr_recon_loss: 157050.0151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 422250.6773; val_optim_loss: 422250.6773
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 6840.2184; train_edge_recon_loss: 257883.6859; train_gene_expr_recon_loss: 158380.7960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 423104.7005; train_optim_loss: 423104.7005; val_kl_reg_loss: 6817.5955; val_edge_recon_loss: 258394.9652; val_gene_expr_recon_loss: 157193.2626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 422405.8222; val_optim_loss: 422405.8222
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 6840.7846; train_edge_recon_loss: 257817.5415; train_gene_expr_recon_loss: 148980.5646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 413638.8907; train_optim_loss: 413638.8907; val_kl_reg_loss: 6812.7027; val_edge_recon_loss: 258234.8551; val_gene_expr_recon_loss: 150958.7111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 416006.2701; val_optim_loss: 416006.2701
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 6855.9364; train_edge_recon_loss: 257703.0160; train_gene_expr_recon_loss: 133029.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 397588.7427; train_optim_loss: 397588.7427; val_kl_reg_loss: 6821.6318; val_edge_recon_loss: 258461.9993; val_gene_expr_recon_loss: 101887.1705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367170.8026; val_optim_loss: 367170.8026
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9949; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 6858.8741; train_edge_recon_loss: 257583.2973; train_gene_expr_recon_loss: 116226.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 380668.3966; train_optim_loss: 380668.3966; val_kl_reg_loss: 6877.2477; val_edge_recon_loss: 258421.2942; val_gene_expr_recon_loss: 133634.7198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 398933.2615; val_optim_loss: 398933.2615
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 6869.9143; train_edge_recon_loss: 257578.8930; train_gene_expr_recon_loss: 104669.2377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369118.0452; train_optim_loss: 369118.0452; val_kl_reg_loss: 6817.0948; val_edge_recon_loss: 258356.4068; val_gene_expr_recon_loss: 105636.5165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370810.0181; val_optim_loss: 370810.0181
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 6875.6138; train_edge_recon_loss: 257441.1468; train_gene_expr_recon_loss: 101306.1973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365622.9579; train_optim_loss: 365622.9579; val_kl_reg_loss: 6742.0814; val_edge_recon_loss: 258043.6771; val_gene_expr_recon_loss: 99556.1575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 364341.9161; val_optim_loss: 364341.9161
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 6879.4594; train_edge_recon_loss: 257361.3896; train_gene_expr_recon_loss: 98809.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363050.0305; train_optim_loss: 363050.0305; val_kl_reg_loss: 6830.8554; val_edge_recon_loss: 257805.8493; val_gene_expr_recon_loss: 97599.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 362236.6613; val_optim_loss: 362236.6613
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9962; val_auprc_score: 0.9954; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 6884.2706; train_edge_recon_loss: 257334.8855; train_gene_expr_recon_loss: 97784.2802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362003.4363; train_optim_loss: 362003.4363; val_kl_reg_loss: 6895.3887; val_edge_recon_loss: 257918.9856; val_gene_expr_recon_loss: 99225.8183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 364040.1928; val_optim_loss: 364040.1928
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9790; val_best_f1_score: 0.9793; train_kl_reg_loss: 6885.4646; train_edge_recon_loss: 257323.7438; train_gene_expr_recon_loss: 97461.1116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361670.3198; train_optim_loss: 361670.3198; val_kl_reg_loss: 6846.3544; val_edge_recon_loss: 257908.2332; val_gene_expr_recon_loss: 96908.0251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 361662.6135; val_optim_loss: 361662.6135
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6891.6653; train_edge_recon_loss: 257266.2173; train_gene_expr_recon_loss: 97226.7647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 361384.6474; train_optim_loss: 361384.6474; val_kl_reg_loss: 6658.7396; val_edge_recon_loss: 257802.3321; val_gene_expr_recon_loss: 98615.4949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 363076.5678; val_optim_loss: 363076.5678
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 6894.9100; train_edge_recon_loss: 257151.2858; train_gene_expr_recon_loss: 96873.2219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360919.4174; train_optim_loss: 360919.4174; val_kl_reg_loss: 6742.3703; val_edge_recon_loss: 257712.5701; val_gene_expr_recon_loss: 95578.6371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360033.5779; val_optim_loss: 360033.5779
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 6897.1127; train_edge_recon_loss: 257163.8235; train_gene_expr_recon_loss: 95945.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360006.6265; train_optim_loss: 360006.6265; val_kl_reg_loss: 6855.4186; val_edge_recon_loss: 257518.2190; val_gene_expr_recon_loss: 118006.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 382380.5005; val_optim_loss: 382380.5005
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9967; val_auprc_score: 0.9957; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6899.3460; train_edge_recon_loss: 257116.6934; train_gene_expr_recon_loss: 96160.0185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360176.0581; train_optim_loss: 360176.0581; val_kl_reg_loss: 6777.5177; val_edge_recon_loss: 257544.8023; val_gene_expr_recon_loss: 96624.2585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360946.5774; val_optim_loss: 360946.5774
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 6900.5054; train_edge_recon_loss: 257107.5005; train_gene_expr_recon_loss: 96738.6995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360746.7055; train_optim_loss: 360746.7055; val_kl_reg_loss: 6914.1763; val_edge_recon_loss: 257752.2552; val_gene_expr_recon_loss: 96117.1100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360783.5411; val_optim_loss: 360783.5411
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6901.7246; train_edge_recon_loss: 257074.3877; train_gene_expr_recon_loss: 96440.7559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 360416.8683; train_optim_loss: 360416.8683; val_kl_reg_loss: 6699.4586; val_edge_recon_loss: 257555.8182; val_gene_expr_recon_loss: 95884.3251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360139.6019; val_optim_loss: 360139.6019

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6847.9321; train_edge_recon_loss: 256732.4295; train_gene_expr_recon_loss: 95041.3580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358621.7194; train_optim_loss: 358621.7194; val_kl_reg_loss: 6775.8388; val_edge_recon_loss: 257759.0301; val_gene_expr_recon_loss: 92664.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357199.0016; val_optim_loss: 357199.0016
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 6840.7157; train_edge_recon_loss: 256798.9072; train_gene_expr_recon_loss: 94781.5686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358421.1918; train_optim_loss: 358421.1918; val_kl_reg_loss: 6725.1349; val_edge_recon_loss: 257190.9184; val_gene_expr_recon_loss: 94235.8517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358151.9048; val_optim_loss: 358151.9048
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6842.6726; train_edge_recon_loss: 256749.4308; train_gene_expr_recon_loss: 94676.2663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358268.3694; train_optim_loss: 358268.3694; val_kl_reg_loss: 6766.1966; val_edge_recon_loss: 257162.4461; val_gene_expr_recon_loss: 96306.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 360235.2557; val_optim_loss: 360235.2557
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6839.8472; train_edge_recon_loss: 256830.2943; train_gene_expr_recon_loss: 94475.9976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358146.1392; train_optim_loss: 358146.1392; val_kl_reg_loss: 6775.2319; val_edge_recon_loss: 257274.1551; val_gene_expr_recon_loss: 93344.7147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357394.1027; val_optim_loss: 357394.1027
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 6838.4060; train_edge_recon_loss: 256811.0928; train_gene_expr_recon_loss: 94449.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358099.0308; train_optim_loss: 358099.0308; val_kl_reg_loss: 6762.4750; val_edge_recon_loss: 257150.7838; val_gene_expr_recon_loss: 95249.4139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 359162.6743; val_optim_loss: 359162.6743

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 6835.0502; train_edge_recon_loss: 256683.9740; train_gene_expr_recon_loss: 93816.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 357335.6609; train_optim_loss: 357335.6609; val_kl_reg_loss: 6754.1338; val_edge_recon_loss: 257111.5257; val_gene_expr_recon_loss: 94404.2417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358269.9001; val_optim_loss: 358269.9001
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 6824.8343; train_edge_recon_loss: 256677.8140; train_gene_expr_recon_loss: 93473.6326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 356976.2806; train_optim_loss: 356976.2806; val_kl_reg_loss: 6746.3207; val_edge_recon_loss: 257161.3127; val_gene_expr_recon_loss: 93387.0567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 357294.6908; val_optim_loss: 357294.6908
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 6828.5329; train_edge_recon_loss: 256714.6431; train_gene_expr_recon_loss: 93673.6772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 357216.8534; train_optim_loss: 357216.8534; val_kl_reg_loss: 6749.2534; val_edge_recon_loss: 257143.9965; val_gene_expr_recon_loss: 94673.0491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358566.2987; val_optim_loss: 358566.2987
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 6827.5744; train_edge_recon_loss: 256652.4775; train_gene_expr_recon_loss: 94029.4758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 357509.5277; train_optim_loss: 357509.5277; val_kl_reg_loss: 6739.5364; val_edge_recon_loss: 257155.4143; val_gene_expr_recon_loss: 94601.3217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 358496.2714; val_optim_loss: 358496.2714

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 112 min 18 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9972
val AUPRC score: 0.9967
val best accuracy score: 0.9812
val best F1 score: 0.9814
val target rna MSE score: 0.6475
val source rna MSE score: 0.1307

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
