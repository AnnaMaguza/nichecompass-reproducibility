None
Run timestamp: 24072023_201414_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '20', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '2', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9812; val_auprc_score: 0.9761; val_best_acc_score: 0.9412; val_best_f1_score: 0.9428; train_kl_reg_loss: 86038.1277; train_edge_recon_loss: 26457411.8221; train_gene_expr_recon_loss: 11076777.8440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37620227.7852; train_optim_loss: 37620227.7852; val_kl_reg_loss: 93705.3774; val_edge_recon_loss: 26082426.8744; val_gene_expr_recon_loss: 10345517.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36521649.6683; val_optim_loss: 36521649.6683
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9853; val_auprc_score: 0.9816; val_best_acc_score: 0.9507; val_best_f1_score: 0.9520; train_kl_reg_loss: 86356.2654; train_edge_recon_loss: 25929274.3602; train_gene_expr_recon_loss: 10047798.2466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36063428.8725; train_optim_loss: 36063428.8725; val_kl_reg_loss: 75567.9191; val_edge_recon_loss: 25993314.4824; val_gene_expr_recon_loss: 9841918.0578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35910800.5226; val_optim_loss: 35910800.5226
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9872; val_auprc_score: 0.9841; val_best_acc_score: 0.9546; val_best_f1_score: 0.9559; train_kl_reg_loss: 73906.4621; train_edge_recon_loss: 25814778.9642; train_gene_expr_recon_loss: 9695935.7950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35584621.1857; train_optim_loss: 35584621.1857; val_kl_reg_loss: 70575.0999; val_edge_recon_loss: 25923441.8492; val_gene_expr_recon_loss: 9628430.2261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35622447.2161; val_optim_loss: 35622447.2161
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9882; val_auprc_score: 0.9855; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 69617.4237; train_edge_recon_loss: 25768191.8926; train_gene_expr_recon_loss: 9506917.2883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35344726.6186; train_optim_loss: 35344726.6186; val_kl_reg_loss: 65881.5998; val_edge_recon_loss: 25868616.0804; val_gene_expr_recon_loss: 9480986.6935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35415484.4724; val_optim_loss: 35415484.4724
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9900; val_auprc_score: 0.9881; val_best_acc_score: 0.9599; val_best_f1_score: 0.9607; train_kl_reg_loss: 65576.5724; train_edge_recon_loss: 25736918.2002; train_gene_expr_recon_loss: 9403298.6971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35205793.5000; train_optim_loss: 35205793.5000; val_kl_reg_loss: 61988.1506; val_edge_recon_loss: 25867840.5729; val_gene_expr_recon_loss: 9456001.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385830.5930; val_optim_loss: 35385830.5930
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9881; val_auprc_score: 0.9850; val_best_acc_score: 0.9591; val_best_f1_score: 0.9600; train_kl_reg_loss: 66377.3171; train_edge_recon_loss: 25718697.1477; train_gene_expr_recon_loss: 9302497.5330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35087572.0123; train_optim_loss: 35087572.0123; val_kl_reg_loss: 69585.1455; val_edge_recon_loss: 25836423.7085; val_gene_expr_recon_loss: 9362650.0201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35268658.6734; val_optim_loss: 35268658.6734
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9899; val_auprc_score: 0.9876; val_best_acc_score: 0.9612; val_best_f1_score: 0.9621; train_kl_reg_loss: 67919.0158; train_edge_recon_loss: 25706964.7942; train_gene_expr_recon_loss: 9255203.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35030087.5548; train_optim_loss: 35030087.5548; val_kl_reg_loss: 67319.1633; val_edge_recon_loss: 25794606.8141; val_gene_expr_recon_loss: 9216882.0955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35078808.1206; val_optim_loss: 35078808.1206
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 67451.4443; train_edge_recon_loss: 25677337.7315; train_gene_expr_recon_loss: 9126280.5998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34871069.7662; train_optim_loss: 34871069.7662; val_kl_reg_loss: 63490.1204; val_edge_recon_loss: 25795833.9698; val_gene_expr_recon_loss: 9288162.2437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35147486.2814; val_optim_loss: 35147486.2814
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9905; val_auprc_score: 0.9881; val_best_acc_score: 0.9634; val_best_f1_score: 0.9643; train_kl_reg_loss: 66867.6252; train_edge_recon_loss: 25666719.5201; train_gene_expr_recon_loss: 8982501.6756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34716088.8166; train_optim_loss: 34716088.8166; val_kl_reg_loss: 67086.0552; val_edge_recon_loss: 25761897.9497; val_gene_expr_recon_loss: 8931138.7035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34760122.6633; val_optim_loss: 34760122.6633
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 66787.5002; train_edge_recon_loss: 25680981.5559; train_gene_expr_recon_loss: 8812756.9161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34560525.9933; train_optim_loss: 34560525.9933; val_kl_reg_loss: 64946.6639; val_edge_recon_loss: 25778711.7990; val_gene_expr_recon_loss: 8816488.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34660146.6030; val_optim_loss: 34660146.6030
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9912; val_auprc_score: 0.9891; val_best_acc_score: 0.9649; val_best_f1_score: 0.9657; train_kl_reg_loss: 67198.0656; train_edge_recon_loss: 25654875.8971; train_gene_expr_recon_loss: 8528514.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34250588.8859; train_optim_loss: 34250588.8859; val_kl_reg_loss: 65765.7661; val_edge_recon_loss: 25768545.6382; val_gene_expr_recon_loss: 8406498.4598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34240809.7688; val_optim_loss: 34240809.7688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9915; val_auprc_score: 0.9892; val_best_acc_score: 0.9655; val_best_f1_score: 0.9662; train_kl_reg_loss: 67929.0467; train_edge_recon_loss: 25639704.9564; train_gene_expr_recon_loss: 8420227.2122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34127861.2662; train_optim_loss: 34127861.2662; val_kl_reg_loss: 67656.4420; val_edge_recon_loss: 25756454.7538; val_gene_expr_recon_loss: 8152769.2085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33976880.3317; val_optim_loss: 33976880.3317
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9911; val_auprc_score: 0.9889; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 68558.6223; train_edge_recon_loss: 25639179.9966; train_gene_expr_recon_loss: 8247205.3688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33954943.9653; train_optim_loss: 33954943.9653; val_kl_reg_loss: 66694.6294; val_edge_recon_loss: 25787435.4874; val_gene_expr_recon_loss: 8343989.4422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34198119.4372; val_optim_loss: 34198119.4372
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9917; val_auprc_score: 0.9898; val_best_acc_score: 0.9661; val_best_f1_score: 0.9668; train_kl_reg_loss: 69123.3472; train_edge_recon_loss: 25649669.2081; train_gene_expr_recon_loss: 8180758.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33899550.9754; train_optim_loss: 33899550.9754; val_kl_reg_loss: 69200.3031; val_edge_recon_loss: 25760051.0251; val_gene_expr_recon_loss: 8090736.3241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33919987.5477; val_optim_loss: 33919987.5477
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 69687.6566; train_edge_recon_loss: 25628089.8043; train_gene_expr_recon_loss: 8064826.0836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33762603.5682; train_optim_loss: 33762603.5682; val_kl_reg_loss: 67814.0721; val_edge_recon_loss: 25751945.6181; val_gene_expr_recon_loss: 8139963.5075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33959723.1658; val_optim_loss: 33959723.1658
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 69416.4008; train_edge_recon_loss: 25632194.9799; train_gene_expr_recon_loss: 8004971.3870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33706582.7740; train_optim_loss: 33706582.7740; val_kl_reg_loss: 68848.2896; val_edge_recon_loss: 25752615.8593; val_gene_expr_recon_loss: 8140348.7764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33961812.9447; val_optim_loss: 33961812.9447
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9923; val_auprc_score: 0.9904; val_best_acc_score: 0.9682; val_best_f1_score: 0.9686; train_kl_reg_loss: 69873.5929; train_edge_recon_loss: 25623671.5727; train_gene_expr_recon_loss: 7963874.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33657419.1197; train_optim_loss: 33657419.1197; val_kl_reg_loss: 69102.1624; val_edge_recon_loss: 25740407.7990; val_gene_expr_recon_loss: 8227723.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34037233.3467; val_optim_loss: 34037233.3467
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9927; val_auprc_score: 0.9911; val_best_acc_score: 0.9687; val_best_f1_score: 0.9694; train_kl_reg_loss: 70829.8658; train_edge_recon_loss: 25615998.3848; train_gene_expr_recon_loss: 7929731.2889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33616559.5157; train_optim_loss: 33616559.5157; val_kl_reg_loss: 70791.5503; val_edge_recon_loss: 25708628.4623; val_gene_expr_recon_loss: 8049798.5176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33829218.6030; val_optim_loss: 33829218.6030
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9926; val_auprc_score: 0.9909; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 71812.5918; train_edge_recon_loss: 25629915.2013; train_gene_expr_recon_loss: 7896303.1868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33598030.9855; train_optim_loss: 33598030.9855; val_kl_reg_loss: 69065.2847; val_edge_recon_loss: 25784015.6382; val_gene_expr_recon_loss: 8016941.3065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33870022.2211; val_optim_loss: 33870022.2211
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9697; val_best_f1_score: 0.9702; train_kl_reg_loss: 70758.3655; train_edge_recon_loss: 25599782.9609; train_gene_expr_recon_loss: 7830716.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33501257.5056; train_optim_loss: 33501257.5056; val_kl_reg_loss: 69173.9307; val_edge_recon_loss: 25721497.2161; val_gene_expr_recon_loss: 7855098.9171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33645769.9196; val_optim_loss: 33645769.9196
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9927; val_auprc_score: 0.9907; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 71072.9878; train_edge_recon_loss: 25612362.8904; train_gene_expr_recon_loss: 7773656.8686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33457092.7528; train_optim_loss: 33457092.7528; val_kl_reg_loss: 68223.3518; val_edge_recon_loss: 25734530.8342; val_gene_expr_recon_loss: 7940042.1206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33742796.1106; val_optim_loss: 33742796.1106
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9927; val_auprc_score: 0.9909; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 71008.6312; train_edge_recon_loss: 25597551.6588; train_gene_expr_recon_loss: 7724231.0657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33392791.3613; train_optim_loss: 33392791.3613; val_kl_reg_loss: 70105.0370; val_edge_recon_loss: 25708150.5628; val_gene_expr_recon_loss: 7886742.6106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33664998.2312; val_optim_loss: 33664998.2312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9911; val_best_acc_score: 0.9700; val_best_f1_score: 0.9706; train_kl_reg_loss: 71810.3599; train_edge_recon_loss: 25599172.2539; train_gene_expr_recon_loss: 7687016.9122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33357999.4989; train_optim_loss: 33357999.4989; val_kl_reg_loss: 70814.6982; val_edge_recon_loss: 25732212.1709; val_gene_expr_recon_loss: 7802451.6332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33605478.4523; val_optim_loss: 33605478.4523
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9914; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 72335.5720; train_edge_recon_loss: 25601935.0291; train_gene_expr_recon_loss: 7662450.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33336721.0951; train_optim_loss: 33336721.0951; val_kl_reg_loss: 71308.9444; val_edge_recon_loss: 25714958.1206; val_gene_expr_recon_loss: 7788995.2638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33575262.3518; val_optim_loss: 33575262.3518
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9916; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 72460.0814; train_edge_recon_loss: 25591006.8255; train_gene_expr_recon_loss: 7631672.6751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33295139.5783; train_optim_loss: 33295139.5783; val_kl_reg_loss: 71847.2770; val_edge_recon_loss: 25710282.3417; val_gene_expr_recon_loss: 7766325.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33548455.3065; val_optim_loss: 33548455.3065
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9716; val_best_f1_score: 0.9720; train_kl_reg_loss: 72558.5453; train_edge_recon_loss: 25581987.1566; train_gene_expr_recon_loss: 7614420.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33268965.9362; train_optim_loss: 33268965.9362; val_kl_reg_loss: 72405.0740; val_edge_recon_loss: 25711344.2312; val_gene_expr_recon_loss: 7795704.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33579454.1206; val_optim_loss: 33579454.1206
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9935; val_auprc_score: 0.9920; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 73863.3291; train_edge_recon_loss: 25597123.2260; train_gene_expr_recon_loss: 7616308.3795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33287294.9217; train_optim_loss: 33287294.9217; val_kl_reg_loss: 74196.1968; val_edge_recon_loss: 25706785.2864; val_gene_expr_recon_loss: 7824953.1332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33605934.4724; val_optim_loss: 33605934.4724
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 73331.8760; train_edge_recon_loss: 25601818.3535; train_gene_expr_recon_loss: 7638215.5590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33313365.7752; train_optim_loss: 33313365.7752; val_kl_reg_loss: 71884.2101; val_edge_recon_loss: 25721346.5930; val_gene_expr_recon_loss: 8478754.5050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34271985.3467; val_optim_loss: 34271985.3467
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 76573.8434; train_edge_recon_loss: 25603369.1555; train_gene_expr_recon_loss: 7612568.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33292511.4609; train_optim_loss: 33292511.4609; val_kl_reg_loss: 77035.7831; val_edge_recon_loss: 25707250.0302; val_gene_expr_recon_loss: 7708674.2111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33492960.0402; val_optim_loss: 33492960.0402
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 75803.3830; train_edge_recon_loss: 25584549.7237; train_gene_expr_recon_loss: 7553674.4938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33214027.6040; train_optim_loss: 33214027.6040; val_kl_reg_loss: 75648.9276; val_edge_recon_loss: 25694263.2362; val_gene_expr_recon_loss: 7718136.8417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33488049.0352; val_optim_loss: 33488049.0352
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 76020.4192; train_edge_recon_loss: 25586785.9418; train_gene_expr_recon_loss: 7542867.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33205673.9754; train_optim_loss: 33205673.9754; val_kl_reg_loss: 75519.6225; val_edge_recon_loss: 25697327.2764; val_gene_expr_recon_loss: 7747160.2236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33520007.1658; val_optim_loss: 33520007.1658
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9940; val_auprc_score: 0.9924; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 77186.0886; train_edge_recon_loss: 25580125.7763; train_gene_expr_recon_loss: 7536602.1012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33193913.9295; train_optim_loss: 33193913.9295; val_kl_reg_loss: 73049.4957; val_edge_recon_loss: 25725870.1809; val_gene_expr_recon_loss: 7703766.7462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33502686.4623; val_optim_loss: 33502686.4623
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 77074.3117; train_edge_recon_loss: 25577215.7975; train_gene_expr_recon_loss: 7537243.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33191533.2371; train_optim_loss: 33191533.2371; val_kl_reg_loss: 73719.2397; val_edge_recon_loss: 25681701.3970; val_gene_expr_recon_loss: 7685157.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33440578.0603; val_optim_loss: 33440578.0603
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 76938.0466; train_edge_recon_loss: 25589822.2058; train_gene_expr_recon_loss: 7569970.0196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33236730.2942; train_optim_loss: 33236730.2942; val_kl_reg_loss: 77975.6936; val_edge_recon_loss: 25702721.0754; val_gene_expr_recon_loss: 7681483.8266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33462180.4623; val_optim_loss: 33462180.4623
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9945; val_auprc_score: 0.9934; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 83647.2154; train_edge_recon_loss: 25626619.8479; train_gene_expr_recon_loss: 7633219.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33343486.8535; train_optim_loss: 33343486.8535; val_kl_reg_loss: 84550.3833; val_edge_recon_loss: 25908639.2965; val_gene_expr_recon_loss: 7831066.3116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33824256.1005; val_optim_loss: 33824256.1005
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9943; val_auprc_score: 0.9931; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 415900.2533; train_edge_recon_loss: 25612766.0559; train_gene_expr_recon_loss: 7619668.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33648335.1051; train_optim_loss: 33648335.1051; val_kl_reg_loss: 81707.0243; val_edge_recon_loss: 25743524.0603; val_gene_expr_recon_loss: 7760960.3643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33586191.4573; val_optim_loss: 33586191.4573
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9943; val_auprc_score: 0.9929; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 86937.9513; train_edge_recon_loss: 25620381.9519; train_gene_expr_recon_loss: 7612631.8932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33319951.8143; train_optim_loss: 33319951.8143; val_kl_reg_loss: 10465890.6940; val_edge_recon_loss: 25705616.3920; val_gene_expr_recon_loss: 7722167.9598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43893675.1256; val_optim_loss: 43893675.1256

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 85595.7107; train_edge_recon_loss: 25564505.1611; train_gene_expr_recon_loss: 7468071.4586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33118172.3009; train_optim_loss: 33118172.3009; val_kl_reg_loss: 87160.6395; val_edge_recon_loss: 25686917.7487; val_gene_expr_recon_loss: 7599313.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33373392.0201; val_optim_loss: 33373392.0201
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9944; val_auprc_score: 0.9929; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 87062.7600; train_edge_recon_loss: 25565479.7282; train_gene_expr_recon_loss: 7427021.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33079564.4966; train_optim_loss: 33079564.4966; val_kl_reg_loss: 86212.4203; val_edge_recon_loss: 25688869.2864; val_gene_expr_recon_loss: 7578372.6784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33353454.1809; val_optim_loss: 33353454.1809
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 87029.2813; train_edge_recon_loss: 25562964.9463; train_gene_expr_recon_loss: 7405856.5892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33055850.7942; train_optim_loss: 33055850.7942; val_kl_reg_loss: 86265.8204; val_edge_recon_loss: 25679698.8945; val_gene_expr_recon_loss: 7566219.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33332183.8593; val_optim_loss: 33332183.8593
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 88114.2152; train_edge_recon_loss: 25562099.9128; train_gene_expr_recon_loss: 7395373.8110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33045587.9072; train_optim_loss: 33045587.9072; val_kl_reg_loss: 86727.6435; val_edge_recon_loss: 25673413.4271; val_gene_expr_recon_loss: 7544002.2211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33304143.3568; val_optim_loss: 33304143.3568
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9945; val_auprc_score: 0.9932; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 243944994072.1727; train_edge_recon_loss: 25557199.7170; train_gene_expr_recon_loss: 7378872.5861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243977930361.5358; train_optim_loss: 243977930361.5358; val_kl_reg_loss: 86663.8628; val_edge_recon_loss: 25678868.3719; val_gene_expr_recon_loss: 7528710.5101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33294242.7739; val_optim_loss: 33294242.7739
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9947; val_auprc_score: 0.9935; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 430914286.9250; train_edge_recon_loss: 25551542.7998; train_gene_expr_recon_loss: 7379712.5252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463845567.0380; train_optim_loss: 463845567.0380; val_kl_reg_loss: 87565.0380; val_edge_recon_loss: 25682709.3970; val_gene_expr_recon_loss: 7542312.7613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33312587.2663; val_optim_loss: 33312587.2663
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9950; val_auprc_score: 0.9939; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 88052.6628; train_edge_recon_loss: 25563011.0705; train_gene_expr_recon_loss: 7373784.2771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33024848.0190; train_optim_loss: 33024848.0190; val_kl_reg_loss: 85424.7369; val_edge_recon_loss: 25664690.1608; val_gene_expr_recon_loss: 7519113.6030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33269228.6633; val_optim_loss: 33269228.6633
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 163563.1984; train_edge_recon_loss: 25556157.9004; train_gene_expr_recon_loss: 7367310.3551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33087031.4888; train_optim_loss: 33087031.4888; val_kl_reg_loss: 86472.1613; val_edge_recon_loss: 25658230.4925; val_gene_expr_recon_loss: 7517484.7085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33262187.3769; val_optim_loss: 33262187.3769
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 88484.6004; train_edge_recon_loss: 25553860.2148; train_gene_expr_recon_loss: 7361778.9978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33004123.8110; train_optim_loss: 33004123.8110; val_kl_reg_loss: 86066.6484; val_edge_recon_loss: 25672323.5678; val_gene_expr_recon_loss: 7527812.9397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33286203.1759; val_optim_loss: 33286203.1759
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9747; val_best_f1_score: 0.9751; train_kl_reg_loss: 88051.8489; train_edge_recon_loss: 25556810.2114; train_gene_expr_recon_loss: 7356831.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33001693.3356; train_optim_loss: 33001693.3356; val_kl_reg_loss: 411480.8910; val_edge_recon_loss: 25660850.0302; val_gene_expr_recon_loss: 7514801.8970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33587132.7136; val_optim_loss: 33587132.7136
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9948; val_auprc_score: 0.9937; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 87319.7638; train_edge_recon_loss: 25550374.7685; train_gene_expr_recon_loss: 7350632.6728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32988327.2237; train_optim_loss: 32988327.2237; val_kl_reg_loss: 86130.0074; val_edge_recon_loss: 25652978.1608; val_gene_expr_recon_loss: 7517593.5276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33256701.6482; val_optim_loss: 33256701.6482
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9745; val_best_f1_score: 0.9749; train_kl_reg_loss: 87868.2816; train_edge_recon_loss: 25554612.8770; train_gene_expr_recon_loss: 7347596.8266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32990077.9676; train_optim_loss: 32990077.9676; val_kl_reg_loss: 86378.6115; val_edge_recon_loss: 25666188.2613; val_gene_expr_recon_loss: 7502353.0201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33254919.9296; val_optim_loss: 33254919.9296
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9950; val_auprc_score: 0.9938; val_best_acc_score: 0.9749; val_best_f1_score: 0.9753; train_kl_reg_loss: 86982.2410; train_edge_recon_loss: 25553805.2058; train_gene_expr_recon_loss: 7345502.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32986290.1085; train_optim_loss: 32986290.1085; val_kl_reg_loss: 85213.6926; val_edge_recon_loss: 25677108.4322; val_gene_expr_recon_loss: 7508138.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33270460.5528; val_optim_loss: 33270460.5528
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 86123.7953; train_edge_recon_loss: 25555156.8210; train_gene_expr_recon_loss: 7347141.0098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32988421.5615; train_optim_loss: 32988421.5615; val_kl_reg_loss: 84851.6522; val_edge_recon_loss: 25639044.3618; val_gene_expr_recon_loss: 7513532.3844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33237428.4322; val_optim_loss: 33237428.4322
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9951; val_auprc_score: 0.9942; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 87002.0025; train_edge_recon_loss: 25549846.0559; train_gene_expr_recon_loss: 7343534.6496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32980382.7013; train_optim_loss: 32980382.7013; val_kl_reg_loss: 85777.6344; val_edge_recon_loss: 25661678.6633; val_gene_expr_recon_loss: 7508893.1030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33256349.4472; val_optim_loss: 33256349.4472
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9754; val_best_f1_score: 0.9757; train_kl_reg_loss: 87916.4593; train_edge_recon_loss: 25549843.7796; train_gene_expr_recon_loss: 7339889.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32977649.3311; train_optim_loss: 32977649.3311; val_kl_reg_loss: 84620.3681; val_edge_recon_loss: 25665232.2412; val_gene_expr_recon_loss: 7498827.6809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33248680.2714; val_optim_loss: 33248680.2714
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 86870.5986; train_edge_recon_loss: 25547449.4463; train_gene_expr_recon_loss: 7337526.6188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32971846.6600; train_optim_loss: 32971846.6600; val_kl_reg_loss: 85871.1135; val_edge_recon_loss: 25637039.6583; val_gene_expr_recon_loss: 7499813.6884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33222724.4020; val_optim_loss: 33222724.4020
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 85940.0108; train_edge_recon_loss: 25552522.3423; train_gene_expr_recon_loss: 7333752.0173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32972214.3960; train_optim_loss: 32972214.3960; val_kl_reg_loss: 85338.1043; val_edge_recon_loss: 25651435.2965; val_gene_expr_recon_loss: 7499778.3065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33236551.6181; val_optim_loss: 33236551.6181
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 86194.0530; train_edge_recon_loss: 25550975.5817; train_gene_expr_recon_loss: 7330872.9894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32968042.6208; train_optim_loss: 32968042.6208; val_kl_reg_loss: 84712.6873; val_edge_recon_loss: 25663844.2111; val_gene_expr_recon_loss: 7496737.1432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33245294.1809; val_optim_loss: 33245294.1809
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 220408.5868; train_edge_recon_loss: 25548647.7696; train_gene_expr_recon_loss: 7331003.9569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33100060.2729; train_optim_loss: 33100060.2729; val_kl_reg_loss: 85029.9747; val_edge_recon_loss: 25651114.6231; val_gene_expr_recon_loss: 7494966.0276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33231110.5528; val_optim_loss: 33231110.5528
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9949; val_auprc_score: 0.9939; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 85527.8646; train_edge_recon_loss: 25544742.4866; train_gene_expr_recon_loss: 7328364.1655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32958634.5157; train_optim_loss: 32958634.5157; val_kl_reg_loss: 83879.8070; val_edge_recon_loss: 25675873.7789; val_gene_expr_recon_loss: 7488848.1658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33248601.6683; val_optim_loss: 33248601.6683

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9753; val_best_f1_score: 0.9756; train_kl_reg_loss: 85626.9767; train_edge_recon_loss: 25539221.6174; train_gene_expr_recon_loss: 7315693.3031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32940541.8949; train_optim_loss: 32940541.8949; val_kl_reg_loss: 83299.6474; val_edge_recon_loss: 25648426.9246; val_gene_expr_recon_loss: 7477702.3367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33209428.8945; val_optim_loss: 33209428.8945
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9951; val_auprc_score: 0.9941; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 85264.7538; train_edge_recon_loss: 25542773.4888; train_gene_expr_recon_loss: 7310963.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32939002.0671; train_optim_loss: 32939002.0671; val_kl_reg_loss: 83707.3165; val_edge_recon_loss: 25655411.7889; val_gene_expr_recon_loss: 7489508.1784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33228627.1055; val_optim_loss: 33228627.1055
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 85123.8654; train_edge_recon_loss: 25543092.7081; train_gene_expr_recon_loss: 7312507.7897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32940724.3423; train_optim_loss: 32940724.3423; val_kl_reg_loss: 84049.4218; val_edge_recon_loss: 25644742.2010; val_gene_expr_recon_loss: 7476373.2186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33205164.7940; val_optim_loss: 33205164.7940
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9951; val_auprc_score: 0.9940; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 34019676716.6706; train_edge_recon_loss: 25538512.0134; train_gene_expr_recon_loss: 7313673.6247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34052529150.6365; train_optim_loss: 34052529150.6365; val_kl_reg_loss: 83777.8221; val_edge_recon_loss: 25661230.9246; val_gene_expr_recon_loss: 7473372.4397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33218381.2864; val_optim_loss: 33218381.2864
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 84809.0797; train_edge_recon_loss: 25535148.7058; train_gene_expr_recon_loss: 7311379.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32931336.8210; train_optim_loss: 32931336.8210; val_kl_reg_loss: 83338.6493; val_edge_recon_loss: 25632450.2211; val_gene_expr_recon_loss: 7468869.3040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33184658.1608; val_optim_loss: 33184658.1608
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 85003.0383; train_edge_recon_loss: 25540371.7852; train_gene_expr_recon_loss: 7310465.5775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32935840.3993; train_optim_loss: 32935840.3993; val_kl_reg_loss: 83300.1325; val_edge_recon_loss: 25657978.9045; val_gene_expr_recon_loss: 7465488.2940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33206767.3668; val_optim_loss: 33206767.3668
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9950; val_auprc_score: 0.9939; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 85085.5917; train_edge_recon_loss: 25540218.4709; train_gene_expr_recon_loss: 7307873.8470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32933177.9273; train_optim_loss: 32933177.9273; val_kl_reg_loss: 83432.7239; val_edge_recon_loss: 25649222.1709; val_gene_expr_recon_loss: 7466032.6508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33198687.5779; val_optim_loss: 33198687.5779
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9951; val_auprc_score: 0.9939; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 1461099.9033; train_edge_recon_loss: 25551330.7651; train_gene_expr_recon_loss: 7311050.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34323481.3937; train_optim_loss: 34323481.3937; val_kl_reg_loss: 83514.3492; val_edge_recon_loss: 25657580.8342; val_gene_expr_recon_loss: 7472551.9623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33213647.0955; val_optim_loss: 33213647.0955
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9952; val_auprc_score: 0.9941; val_best_acc_score: 0.9756; val_best_f1_score: 0.9760; train_kl_reg_loss: 85833.9093; train_edge_recon_loss: 25546020.6510; train_gene_expr_recon_loss: 7307593.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32939448.5313; train_optim_loss: 32939448.5313; val_kl_reg_loss: 83543.3876; val_edge_recon_loss: 25664806.5528; val_gene_expr_recon_loss: 7476023.1683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33224373.1759; val_optim_loss: 33224373.1759

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 85003.7749; train_edge_recon_loss: 25541334.9765; train_gene_expr_recon_loss: 7304474.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32930812.7886; train_optim_loss: 32930812.7886; val_kl_reg_loss: 83490.0440; val_edge_recon_loss: 25654109.8995; val_gene_expr_recon_loss: 7464703.7286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33202303.6181; val_optim_loss: 33202303.6181
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9952; val_auprc_score: 0.9940; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 85077.4857; train_edge_recon_loss: 25537525.2148; train_gene_expr_recon_loss: 7299492.8412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32922095.5537; train_optim_loss: 32922095.5537; val_kl_reg_loss: 83723.4485; val_edge_recon_loss: 25653352.7437; val_gene_expr_recon_loss: 7456011.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33193087.4874; val_optim_loss: 33193087.4874
Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9953; val_auprc_score: 0.9941; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 85043.5793; train_edge_recon_loss: 25545814.5772; train_gene_expr_recon_loss: 7302470.9622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32933329.1130; train_optim_loss: 32933329.1130; val_kl_reg_loss: 83308.3925; val_edge_recon_loss: 25647645.6884; val_gene_expr_recon_loss: 7475669.7613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33206623.8693; val_optim_loss: 33206623.8693
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9954; val_auprc_score: 0.9943; val_best_acc_score: 0.9761; val_best_f1_score: 0.9765; train_kl_reg_loss: 85007.3634; train_edge_recon_loss: 25548055.1421; train_gene_expr_recon_loss: 7311030.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32944092.7327; train_optim_loss: 32944092.7327; val_kl_reg_loss: 2158161.2916; val_edge_recon_loss: 25639695.7789; val_gene_expr_recon_loss: 7465256.8040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35263113.9095; val_optim_loss: 35263113.9095

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 345 min 57 sec.
Using best model state, which was in epoch 63.

--- MODEL EVALUATION ---
Val AUROC score: 0.9953
Val AUPRC score: 0.9944
Val best accuracy score: 0.9755
Val best F1 score: 0.9759
Val gene expr MSE score: 0.6795

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
