None
Run timestamp: 24072023_201315_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9821; val_auprc_score: 0.9768; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 98578.0983; train_edge_recon_loss: 27070913.5478; train_gene_expr_recon_loss: 11960301.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39129792.7059; train_optim_loss: 39129792.7059; val_kl_reg_loss: 116217.5484; val_edge_recon_loss: 26237809.4754; val_gene_expr_recon_loss: 10966612.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37320639.4754; val_optim_loss: 37320639.4754
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9845; val_auprc_score: 0.9795; val_best_acc_score: 0.9500; val_best_f1_score: 0.9511; train_kl_reg_loss: 115674.6157; train_edge_recon_loss: 26060827.0221; train_gene_expr_recon_loss: 10650603.9559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36827105.5221; train_optim_loss: 36827105.5221; val_kl_reg_loss: 108525.7932; val_edge_recon_loss: 26018021.1803; val_gene_expr_recon_loss: 10525866.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36652413.5738; val_optim_loss: 36652413.5738
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9861; val_auprc_score: 0.9821; val_best_acc_score: 0.9520; val_best_f1_score: 0.9532; train_kl_reg_loss: 104931.4547; train_edge_recon_loss: 25946662.1213; train_gene_expr_recon_loss: 10324978.4412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36376572.0441; train_optim_loss: 36376572.0441; val_kl_reg_loss: 97014.1748; val_edge_recon_loss: 25974202.3279; val_gene_expr_recon_loss: 10310472.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36381688.9836; val_optim_loss: 36381688.9836
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9844; val_best_acc_score: 0.9560; val_best_f1_score: 0.9569; train_kl_reg_loss: 93112.4531; train_edge_recon_loss: 25874014.3125; train_gene_expr_recon_loss: 10148273.8897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36115400.6691; train_optim_loss: 36115400.6691; val_kl_reg_loss: 88628.4562; val_edge_recon_loss: 25836666.0984; val_gene_expr_recon_loss: 10135115.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36060409.4426; val_optim_loss: 36060409.4426
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9880; val_auprc_score: 0.9842; val_best_acc_score: 0.9595; val_best_f1_score: 0.9605; train_kl_reg_loss: 86714.2297; train_edge_recon_loss: 25823981.3566; train_gene_expr_recon_loss: 10009693.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35920389.1838; train_optim_loss: 35920389.1838; val_kl_reg_loss: 82858.4284; val_edge_recon_loss: 25871443.8033; val_gene_expr_recon_loss: 10056634.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36010936.9180; val_optim_loss: 36010936.9180
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9893; val_auprc_score: 0.9860; val_best_acc_score: 0.9617; val_best_f1_score: 0.9625; train_kl_reg_loss: 81850.1374; train_edge_recon_loss: 25769207.9669; train_gene_expr_recon_loss: 9924175.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35775233.4485; train_optim_loss: 35775233.4485; val_kl_reg_loss: 78312.2095; val_edge_recon_loss: 25815377.2131; val_gene_expr_recon_loss: 9976596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35870285.2459; val_optim_loss: 35870285.2459
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9893; val_auprc_score: 0.9862; val_best_acc_score: 0.9613; val_best_f1_score: 0.9623; train_kl_reg_loss: 77382.2497; train_edge_recon_loss: 25746148.0956; train_gene_expr_recon_loss: 9842119.0717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35665649.4338; train_optim_loss: 35665649.4338; val_kl_reg_loss: 75150.2732; val_edge_recon_loss: 25801531.5410; val_gene_expr_recon_loss: 9935930.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35812611.9344; val_optim_loss: 35812611.9344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 72981.8546; train_edge_recon_loss: 25712826.0074; train_gene_expr_recon_loss: 9781912.1682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35567720.0221; train_optim_loss: 35567720.0221; val_kl_reg_loss: 71446.1839; val_edge_recon_loss: 25752741.1148; val_gene_expr_recon_loss: 9867676.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35691863.8033; val_optim_loss: 35691863.8033
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9907; val_auprc_score: 0.9880; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 69775.5237; train_edge_recon_loss: 25690705.4485; train_gene_expr_recon_loss: 9742653.8952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35503134.9706; train_optim_loss: 35503134.9706; val_kl_reg_loss: 67938.5893; val_edge_recon_loss: 25748552.2951; val_gene_expr_recon_loss: 9817820.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35634311.5410; val_optim_loss: 35634311.5410
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9908; val_auprc_score: 0.9882; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 68115.0104; train_edge_recon_loss: 25674635.9044; train_gene_expr_recon_loss: 9692147.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35434898.1912; train_optim_loss: 35434898.1912; val_kl_reg_loss: 65611.9636; val_edge_recon_loss: 25749828.9180; val_gene_expr_recon_loss: 9801806.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35617247.1475; val_optim_loss: 35617247.1475
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 66106.3953; train_edge_recon_loss: 25660308.6213; train_gene_expr_recon_loss: 9657696.1415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35384111.1250; train_optim_loss: 35384111.1250; val_kl_reg_loss: 64248.3734; val_edge_recon_loss: 25734076.8852; val_gene_expr_recon_loss: 9777489.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35575814.8197; val_optim_loss: 35575814.8197
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9921; val_auprc_score: 0.9899; val_best_acc_score: 0.9690; val_best_f1_score: 0.9695; train_kl_reg_loss: 64172.1331; train_edge_recon_loss: 25656218.9706; train_gene_expr_recon_loss: 9614723.0423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35335114.1912; train_optim_loss: 35335114.1912; val_kl_reg_loss: 62722.8763; val_edge_recon_loss: 25699676.3934; val_gene_expr_recon_loss: 9748289.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35510688.3279; val_optim_loss: 35510688.3279
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9684; val_best_f1_score: 0.9689; train_kl_reg_loss: 63175.8871; train_edge_recon_loss: 25641331.3566; train_gene_expr_recon_loss: 9583230.9623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35287738.1581; train_optim_loss: 35287738.1581; val_kl_reg_loss: 62192.3452; val_edge_recon_loss: 25723603.0492; val_gene_expr_recon_loss: 9752786.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35538582.2295; val_optim_loss: 35538582.2295
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9700; val_best_f1_score: 0.9706; train_kl_reg_loss: 62079.9125; train_edge_recon_loss: 25633413.2206; train_gene_expr_recon_loss: 9563626.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35259119.5074; train_optim_loss: 35259119.5074; val_kl_reg_loss: 57672.0022; val_edge_recon_loss: 25713503.5410; val_gene_expr_recon_loss: 9756285.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35527460.6557; val_optim_loss: 35527460.6557
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9929; val_auprc_score: 0.9908; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 60528.0488; train_edge_recon_loss: 25615749.1691; train_gene_expr_recon_loss: 9554075.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35230352.4118; train_optim_loss: 35230352.4118; val_kl_reg_loss: 58456.9611; val_edge_recon_loss: 25662396.1967; val_gene_expr_recon_loss: 9681930.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35402784.1311; val_optim_loss: 35402784.1311
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9930; val_auprc_score: 0.9909; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 60121.6788; train_edge_recon_loss: 25611452.0993; train_gene_expr_recon_loss: 9517342.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35188916.4191; train_optim_loss: 35188916.4191; val_kl_reg_loss: 59300.9066; val_edge_recon_loss: 25641456.2623; val_gene_expr_recon_loss: 9687746.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35388503.4754; val_optim_loss: 35388503.4754
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 59589.6118; train_edge_recon_loss: 25597172.9301; train_gene_expr_recon_loss: 9485881.5092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35142644.0074; train_optim_loss: 35142644.0074; val_kl_reg_loss: 59555.9052; val_edge_recon_loss: 25649967.8033; val_gene_expr_recon_loss: 9681806.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35391330.4262; val_optim_loss: 35391330.4262
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 58755.0620; train_edge_recon_loss: 25604527.0662; train_gene_expr_recon_loss: 9467679.4522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35130961.6176; train_optim_loss: 35130961.6176; val_kl_reg_loss: 57156.5193; val_edge_recon_loss: 25651349.9672; val_gene_expr_recon_loss: 9671369.4262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35379875.9344; val_optim_loss: 35379875.9344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9730; val_best_f1_score: 0.9734; train_kl_reg_loss: 58615.1073; train_edge_recon_loss: 25597977.9449; train_gene_expr_recon_loss: 9460647.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35117240.1618; train_optim_loss: 35117240.1618; val_kl_reg_loss: 59511.5555; val_edge_recon_loss: 25629304.0656; val_gene_expr_recon_loss: 9658229.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35347045.8361; val_optim_loss: 35347045.8361
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 57900.5398; train_edge_recon_loss: 25579493.0147; train_gene_expr_recon_loss: 9436461.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35073855.0441; train_optim_loss: 35073855.0441; val_kl_reg_loss: 56718.1853; val_edge_recon_loss: 25627337.3115; val_gene_expr_recon_loss: 9657746.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35341801.5082; val_optim_loss: 35341801.5082
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 57018.2204; train_edge_recon_loss: 25587810.3640; train_gene_expr_recon_loss: 9424562.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35069391.1103; train_optim_loss: 35069391.1103; val_kl_reg_loss: 55944.8348; val_edge_recon_loss: 25626115.8689; val_gene_expr_recon_loss: 9617568.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35299629.1803; val_optim_loss: 35299629.1803
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9939; val_auprc_score: 0.9921; val_best_acc_score: 0.9744; val_best_f1_score: 0.9747; train_kl_reg_loss: 57029.0911; train_edge_recon_loss: 25582543.4522; train_gene_expr_recon_loss: 9403832.2114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35043404.7794; train_optim_loss: 35043404.7794; val_kl_reg_loss: 55287.0045; val_edge_recon_loss: 25643603.7377; val_gene_expr_recon_loss: 9640645.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35339535.7377; val_optim_loss: 35339535.7377
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9937; val_auprc_score: 0.9918; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 56795.8218; train_edge_recon_loss: 25577711.8199; train_gene_expr_recon_loss: 9389833.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35024340.6176; train_optim_loss: 35024340.6176; val_kl_reg_loss: 56494.4102; val_edge_recon_loss: 25620132.0656; val_gene_expr_recon_loss: 9618544.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35295170.9508; val_optim_loss: 35295170.9508
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9742; val_best_f1_score: 0.9747; train_kl_reg_loss: 56320.2480; train_edge_recon_loss: 25580420.6544; train_gene_expr_recon_loss: 9381846.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018587.6838; train_optim_loss: 35018587.6838; val_kl_reg_loss: 55604.7635; val_edge_recon_loss: 25642444.3279; val_gene_expr_recon_loss: 9633351.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331400.2623; val_optim_loss: 35331400.2623
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 56023.0045; train_edge_recon_loss: 25570693.3824; train_gene_expr_recon_loss: 9364164.5533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34990880.9779; train_optim_loss: 34990880.9779; val_kl_reg_loss: 55472.5508; val_edge_recon_loss: 25603073.5738; val_gene_expr_recon_loss: 9631438.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35289984.0000; val_optim_loss: 35289984.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 55885.2350; train_edge_recon_loss: 25559220.0478; train_gene_expr_recon_loss: 9353156.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34968261.6691; train_optim_loss: 34968261.6691; val_kl_reg_loss: 54932.8917; val_edge_recon_loss: 25621819.5410; val_gene_expr_recon_loss: 9623469.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35300222.4918; val_optim_loss: 35300222.4918
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 55772.4939; train_edge_recon_loss: 25555939.0110; train_gene_expr_recon_loss: 9352372.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34964083.8088; train_optim_loss: 34964083.8088; val_kl_reg_loss: 54399.2126; val_edge_recon_loss: 25656998.5574; val_gene_expr_recon_loss: 9619794.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35331192.3279; val_optim_loss: 35331192.3279
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 55134.1697; train_edge_recon_loss: 25560529.1103; train_gene_expr_recon_loss: 9330561.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34946224.4044; train_optim_loss: 34946224.4044; val_kl_reg_loss: 54384.3475; val_edge_recon_loss: 25620599.3770; val_gene_expr_recon_loss: 9634768.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35309752.3279; val_optim_loss: 35309752.3279
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9945; val_auprc_score: 0.9930; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 55229.9346; train_edge_recon_loss: 25550510.5882; train_gene_expr_recon_loss: 9328450.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34934190.7647; train_optim_loss: 34934190.7647; val_kl_reg_loss: 54675.2401; val_edge_recon_loss: 25619740.8525; val_gene_expr_recon_loss: 9622644.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297060.3279; val_optim_loss: 35297060.3279

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 57340.5167; train_edge_recon_loss: 25552856.1324; train_gene_expr_recon_loss: 9247115.0689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34857311.6912; train_optim_loss: 34857311.6912; val_kl_reg_loss: 58048.7898; val_edge_recon_loss: 25587665.4754; val_gene_expr_recon_loss: 9565300.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35211014.8197; val_optim_loss: 35211014.8197
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9943; val_auprc_score: 0.9928; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 59018.4856; train_edge_recon_loss: 25546311.5551; train_gene_expr_recon_loss: 9232413.3943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34837743.4191; train_optim_loss: 34837743.4191; val_kl_reg_loss: 58963.4718; val_edge_recon_loss: 25601782.0328; val_gene_expr_recon_loss: 9557808.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35218554.2295; val_optim_loss: 35218554.2295
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 59736.0898; train_edge_recon_loss: 25550979.2831; train_gene_expr_recon_loss: 9228960.8208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34839676.1691; train_optim_loss: 34839676.1691; val_kl_reg_loss: 59423.7489; val_edge_recon_loss: 25592974.7869; val_gene_expr_recon_loss: 9555565.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35207964.7213; val_optim_loss: 35207964.7213
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 59958.0018; train_edge_recon_loss: 25542211.6728; train_gene_expr_recon_loss: 9222089.7794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34824259.5294; train_optim_loss: 34824259.5294; val_kl_reg_loss: 59065.8548; val_edge_recon_loss: 25589087.1148; val_gene_expr_recon_loss: 9538975.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35187128.4590; val_optim_loss: 35187128.4590
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 59973.0082; train_edge_recon_loss: 25538106.9596; train_gene_expr_recon_loss: 9223199.8042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34821279.8235; train_optim_loss: 34821279.8235; val_kl_reg_loss: 59200.6565; val_edge_recon_loss: 25584756.1311; val_gene_expr_recon_loss: 9558325.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35202282.5574; val_optim_loss: 35202282.5574
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 60197.1549; train_edge_recon_loss: 25535477.8934; train_gene_expr_recon_loss: 9224414.0533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34820089.1103; train_optim_loss: 34820089.1103; val_kl_reg_loss: 59641.6571; val_edge_recon_loss: 25557555.4754; val_gene_expr_recon_loss: 9566146.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35183343.5410; val_optim_loss: 35183343.5410
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9943; val_auprc_score: 0.9927; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 60456.2429; train_edge_recon_loss: 25534454.5294; train_gene_expr_recon_loss: 9218897.5735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34813808.2794; train_optim_loss: 34813808.2794; val_kl_reg_loss: 59924.0126; val_edge_recon_loss: 25573208.2951; val_gene_expr_recon_loss: 9520496.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35153629.0492; val_optim_loss: 35153629.0492
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 60406.8694; train_edge_recon_loss: 25531424.0184; train_gene_expr_recon_loss: 9213399.5533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34805230.4632; train_optim_loss: 34805230.4632; val_kl_reg_loss: 59837.7196; val_edge_recon_loss: 25607062.8197; val_gene_expr_recon_loss: 9532979.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35199880.3279; val_optim_loss: 35199880.3279
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9942; val_auprc_score: 0.9920; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 60447.1176; train_edge_recon_loss: 25537026.4596; train_gene_expr_recon_loss: 9208518.1131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34805991.6250; train_optim_loss: 34805991.6250; val_kl_reg_loss: 59620.2835; val_edge_recon_loss: 25597484.1311; val_gene_expr_recon_loss: 9558243.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35215347.8689; val_optim_loss: 35215347.8689
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 60304.6933; train_edge_recon_loss: 25541640.6360; train_gene_expr_recon_loss: 9207451.8814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34809397.1912; train_optim_loss: 34809397.1912; val_kl_reg_loss: 59735.2238; val_edge_recon_loss: 25591512.7541; val_gene_expr_recon_loss: 9578300.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35229548.2623; val_optim_loss: 35229548.2623
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9762; val_best_f1_score: 0.9766; train_kl_reg_loss: 60244.6614; train_edge_recon_loss: 25531256.0956; train_gene_expr_recon_loss: 9205814.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34797315.4706; train_optim_loss: 34797315.4706; val_kl_reg_loss: 59493.6729; val_edge_recon_loss: 25589870.4590; val_gene_expr_recon_loss: 9563464.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35212828.1967; val_optim_loss: 35212828.1967

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 60089.5296; train_edge_recon_loss: 25528639.2757; train_gene_expr_recon_loss: 9195486.7858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34784215.5735; train_optim_loss: 34784215.5735; val_kl_reg_loss: 59579.6593; val_edge_recon_loss: 25583520.1311; val_gene_expr_recon_loss: 9555644.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35198744.5902; val_optim_loss: 35198744.5902
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9762; val_best_f1_score: 0.9765; train_kl_reg_loss: 60255.9522; train_edge_recon_loss: 25542096.3456; train_gene_expr_recon_loss: 9197701.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34800054.1397; train_optim_loss: 34800054.1397; val_kl_reg_loss: 59630.8616; val_edge_recon_loss: 25583325.1475; val_gene_expr_recon_loss: 9548598.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35191555.0164; val_optim_loss: 35191555.0164
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9946; val_auprc_score: 0.9932; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 60350.9796; train_edge_recon_loss: 25536547.7059; train_gene_expr_recon_loss: 9185777.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34782676.0772; train_optim_loss: 34782676.0772; val_kl_reg_loss: 59549.9704; val_edge_recon_loss: 25570829.4754; val_gene_expr_recon_loss: 9557067.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35187447.2787; val_optim_loss: 35187447.2787
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 60455.5794; train_edge_recon_loss: 25544055.8309; train_gene_expr_recon_loss: 9195429.2564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34799940.6029; train_optim_loss: 34799940.6029; val_kl_reg_loss: 59832.2205; val_edge_recon_loss: 25578189.6393; val_gene_expr_recon_loss: 9543288.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35181310.4918; val_optim_loss: 35181310.4918

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 120 min 21 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9929
Val best accuracy score: 0.9765
Val best F1 score: 0.9768
Val gene expr MSE score: 0.6416

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
