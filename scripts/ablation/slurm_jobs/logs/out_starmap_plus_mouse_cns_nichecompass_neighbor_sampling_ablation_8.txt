None
Run timestamp: 19072023_163453_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9810; val_auprc_score: 0.9741; val_best_acc_score: 0.9439; val_best_f1_score: 0.9454; train_kl_reg_loss: 92629.1031; train_edge_recon_loss: 27015725.0882; train_gene_expr_recon_loss: 11869121.5864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38977475.8603; train_optim_loss: 38977475.8603; val_kl_reg_loss: 102245.3571; val_edge_recon_loss: 26196978.5574; val_gene_expr_recon_loss: 11010584.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37309808.3934; val_optim_loss: 37309808.3934
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9836; val_auprc_score: 0.9783; val_best_acc_score: 0.9468; val_best_f1_score: 0.9481; train_kl_reg_loss: 104728.5656; train_edge_recon_loss: 26015260.3015; train_gene_expr_recon_loss: 10706284.2757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36826273.1618; train_optim_loss: 36826273.1618; val_kl_reg_loss: 97902.8665; val_edge_recon_loss: 26041477.2787; val_gene_expr_recon_loss: 10584358.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36723738.3607; val_optim_loss: 36723738.3607
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9859; val_auprc_score: 0.9814; val_best_acc_score: 0.9518; val_best_f1_score: 0.9530; train_kl_reg_loss: 94271.8062; train_edge_recon_loss: 25938409.9265; train_gene_expr_recon_loss: 10379384.8658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36412066.5882; train_optim_loss: 36412066.5882; val_kl_reg_loss: 84416.7614; val_edge_recon_loss: 25963167.3770; val_gene_expr_recon_loss: 10335941.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36383525.3115; val_optim_loss: 36383525.3115
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9873; val_auprc_score: 0.9830; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 83420.5278; train_edge_recon_loss: 25870214.2574; train_gene_expr_recon_loss: 10192932.7610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36146567.6029; train_optim_loss: 36146567.6029; val_kl_reg_loss: 77872.3393; val_edge_recon_loss: 25879828.3607; val_gene_expr_recon_loss: 10205990.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36163691.1475; val_optim_loss: 36163691.1475
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9891; val_auprc_score: 0.9856; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 78979.1095; train_edge_recon_loss: 25782282.7243; train_gene_expr_recon_loss: 10069131.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35930393.2059; train_optim_loss: 35930393.2059; val_kl_reg_loss: 75320.3312; val_edge_recon_loss: 25807268.5902; val_gene_expr_recon_loss: 10094657.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35977246.2295; val_optim_loss: 35977246.2295
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9892; val_auprc_score: 0.9853; val_best_acc_score: 0.9632; val_best_f1_score: 0.9640; train_kl_reg_loss: 74711.3301; train_edge_recon_loss: 25742194.9632; train_gene_expr_recon_loss: 9961056.1801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35777962.5294; train_optim_loss: 35777962.5294; val_kl_reg_loss: 69900.6217; val_edge_recon_loss: 25778276.7213; val_gene_expr_recon_loss: 10027182.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35875360.1967; val_optim_loss: 35875360.1967
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9648; val_best_f1_score: 0.9654; train_kl_reg_loss: 71253.2350; train_edge_recon_loss: 25721380.2757; train_gene_expr_recon_loss: 9887342.2169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35679975.6618; train_optim_loss: 35679975.6618; val_kl_reg_loss: 69198.2072; val_edge_recon_loss: 25745401.7377; val_gene_expr_recon_loss: 9955057.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35769657.5082; val_optim_loss: 35769657.5082
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9915; val_auprc_score: 0.9883; val_best_acc_score: 0.9679; val_best_f1_score: 0.9685; train_kl_reg_loss: 67520.1688; train_edge_recon_loss: 25689645.7757; train_gene_expr_recon_loss: 9847436.4724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35604602.4926; train_optim_loss: 35604602.4926; val_kl_reg_loss: 64805.9697; val_edge_recon_loss: 25725200.6230; val_gene_expr_recon_loss: 9947384.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35737391.8033; val_optim_loss: 35737391.8033
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 64842.8187; train_edge_recon_loss: 25666871.8346; train_gene_expr_recon_loss: 9794175.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35525890.2059; train_optim_loss: 35525890.2059; val_kl_reg_loss: 63145.3868; val_edge_recon_loss: 25737170.9836; val_gene_expr_recon_loss: 9894657.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35694973.7049; val_optim_loss: 35694973.7049
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9922; val_auprc_score: 0.9892; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 62454.8752; train_edge_recon_loss: 25639873.1103; train_gene_expr_recon_loss: 9749740.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35452068.9191; train_optim_loss: 35452068.9191; val_kl_reg_loss: 59268.9570; val_edge_recon_loss: 25681205.8033; val_gene_expr_recon_loss: 9883894.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35624369.1803; val_optim_loss: 35624369.1803
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9922; val_auprc_score: 0.9893; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 60182.0889; train_edge_recon_loss: 25634371.0221; train_gene_expr_recon_loss: 9712806.9439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35407359.8456; train_optim_loss: 35407359.8456; val_kl_reg_loss: 59264.6414; val_edge_recon_loss: 25690171.0820; val_gene_expr_recon_loss: 9853699.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35603135.2131; val_optim_loss: 35603135.2131
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9931; val_auprc_score: 0.9910; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 58641.1753; train_edge_recon_loss: 25618966.5110; train_gene_expr_recon_loss: 9687795.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35365403.4779; train_optim_loss: 35365403.4779; val_kl_reg_loss: 56389.2155; val_edge_recon_loss: 25647778.8852; val_gene_expr_recon_loss: 9843471.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35547639.7377; val_optim_loss: 35547639.7377
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9924; val_auprc_score: 0.9896; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 56794.5202; train_edge_recon_loss: 25609585.6912; train_gene_expr_recon_loss: 9659981.5790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35326361.8529; train_optim_loss: 35326361.8529; val_kl_reg_loss: 56116.2766; val_edge_recon_loss: 25664094.2623; val_gene_expr_recon_loss: 9839122.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35559333.3770; val_optim_loss: 35559333.3770
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9739; val_best_f1_score: 0.9742; train_kl_reg_loss: 55558.1437; train_edge_recon_loss: 25609550.7169; train_gene_expr_recon_loss: 9634021.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35299130.7574; train_optim_loss: 35299130.7574; val_kl_reg_loss: 53674.8369; val_edge_recon_loss: 25665381.7377; val_gene_expr_recon_loss: 9811959.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35531016.0656; val_optim_loss: 35531016.0656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 55145.5639; train_edge_recon_loss: 25594933.7574; train_gene_expr_recon_loss: 9613738.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35263817.8456; train_optim_loss: 35263817.8456; val_kl_reg_loss: 52410.4413; val_edge_recon_loss: 25663478.8525; val_gene_expr_recon_loss: 9795042.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35510931.2787; val_optim_loss: 35510931.2787
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 53874.7398; train_edge_recon_loss: 25587840.2904; train_gene_expr_recon_loss: 9582027.2169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35223742.2279; train_optim_loss: 35223742.2279; val_kl_reg_loss: 48114.4549; val_edge_recon_loss: 25634252.6557; val_gene_expr_recon_loss: 9828046.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35510413.7049; val_optim_loss: 35510413.7049
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 52477.1286; train_edge_recon_loss: 25584690.8860; train_gene_expr_recon_loss: 9570564.6636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35207732.5956; train_optim_loss: 35207732.5956; val_kl_reg_loss: 50995.1242; val_edge_recon_loss: 25636633.1148; val_gene_expr_recon_loss: 9818470.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35506098.4262; val_optim_loss: 35506098.4262
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9935; val_auprc_score: 0.9911; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 52437.1161; train_edge_recon_loss: 25569482.4338; train_gene_expr_recon_loss: 9544615.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35166534.6838; train_optim_loss: 35166534.6838; val_kl_reg_loss: 51680.6872; val_edge_recon_loss: 25587974.1311; val_gene_expr_recon_loss: 9809296.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35448951.0820; val_optim_loss: 35448951.0820
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 51748.0234; train_edge_recon_loss: 25580399.8088; train_gene_expr_recon_loss: 9526548.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35158696.2426; train_optim_loss: 35158696.2426; val_kl_reg_loss: 48557.1157; val_edge_recon_loss: 25604421.8689; val_gene_expr_recon_loss: 9822903.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35475882.7541; val_optim_loss: 35475882.7541
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 51050.6739; train_edge_recon_loss: 25573670.8346; train_gene_expr_recon_loss: 9515302.9136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35140024.3750; train_optim_loss: 35140024.3750; val_kl_reg_loss: 49699.8462; val_edge_recon_loss: 25624649.9016; val_gene_expr_recon_loss: 9794913.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35469263.5410; val_optim_loss: 35469263.5410
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 50818.0664; train_edge_recon_loss: 25561233.8824; train_gene_expr_recon_loss: 9487535.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35099587.7132; train_optim_loss: 35099587.7132; val_kl_reg_loss: 50175.0501; val_edge_recon_loss: 25625708.6885; val_gene_expr_recon_loss: 9811719.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35487602.9508; val_optim_loss: 35487602.9508
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 50335.1924; train_edge_recon_loss: 25562720.6250; train_gene_expr_recon_loss: 9472101.1342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35085157.0294; train_optim_loss: 35085157.0294; val_kl_reg_loss: 49127.7934; val_edge_recon_loss: 25585168.3934; val_gene_expr_recon_loss: 9770277.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35404573.5738; val_optim_loss: 35404573.5738
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 49999.4196; train_edge_recon_loss: 25553768.5625; train_gene_expr_recon_loss: 9456812.8915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35060580.9044; train_optim_loss: 35060580.9044; val_kl_reg_loss: 48895.8034; val_edge_recon_loss: 25605819.1148; val_gene_expr_recon_loss: 9805720.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35460435.7377; val_optim_loss: 35460435.7377
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 49710.2044; train_edge_recon_loss: 25546734.8309; train_gene_expr_recon_loss: 9444487.8989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35040933.0000; train_optim_loss: 35040933.0000; val_kl_reg_loss: 47964.0511; val_edge_recon_loss: 25615352.6557; val_gene_expr_recon_loss: 9803614.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35466931.6721; val_optim_loss: 35466931.6721
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9947; val_auprc_score: 0.9929; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 49090.1257; train_edge_recon_loss: 25548064.4081; train_gene_expr_recon_loss: 9421664.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018818.9485; train_optim_loss: 35018818.9485; val_kl_reg_loss: 49114.8375; val_edge_recon_loss: 25577749.1475; val_gene_expr_recon_loss: 9815324.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35442189.1803; val_optim_loss: 35442189.1803
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 48793.8429; train_edge_recon_loss: 25544646.3125; train_gene_expr_recon_loss: 9431185.8548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35024625.9338; train_optim_loss: 35024625.9338; val_kl_reg_loss: 45576.3123; val_edge_recon_loss: 25772765.7049; val_gene_expr_recon_loss: 9907384.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35725725.9672; val_optim_loss: 35725725.9672

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 49242.2771; train_edge_recon_loss: 25567151.6029; train_gene_expr_recon_loss: 9360767.4292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34977161.3971; train_optim_loss: 34977161.3971; val_kl_reg_loss: 50760.5839; val_edge_recon_loss: 25565497.5410; val_gene_expr_recon_loss: 9773592.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35389851.0820; val_optim_loss: 35389851.0820
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 52635.3955; train_edge_recon_loss: 25531640.3125; train_gene_expr_recon_loss: 9339253.0772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34923528.7794; train_optim_loss: 34923528.7794; val_kl_reg_loss: 52173.6863; val_edge_recon_loss: 25565993.1475; val_gene_expr_recon_loss: 9765895.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35384062.7541; val_optim_loss: 35384062.7541
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 53473.2765; train_edge_recon_loss: 25530130.3272; train_gene_expr_recon_loss: 9333008.7739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34916612.4118; train_optim_loss: 34916612.4118; val_kl_reg_loss: 52755.2465; val_edge_recon_loss: 25583234.8852; val_gene_expr_recon_loss: 9782504.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35418494.5574; val_optim_loss: 35418494.5574
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 54000.7829; train_edge_recon_loss: 25532465.8125; train_gene_expr_recon_loss: 9321544.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34908010.6250; train_optim_loss: 34908010.6250; val_kl_reg_loss: 53174.1532; val_edge_recon_loss: 25576256.1639; val_gene_expr_recon_loss: 9767011.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35396442.1639; val_optim_loss: 35396442.1639
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9946; val_auprc_score: 0.9926; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 54126.8192; train_edge_recon_loss: 25526151.1324; train_gene_expr_recon_loss: 9318202.6526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34898480.6397; train_optim_loss: 34898480.6397; val_kl_reg_loss: 53145.0035; val_edge_recon_loss: 25574584.4262; val_gene_expr_recon_loss: 9774853.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35402583.3443; val_optim_loss: 35402583.3443
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 54387.6484; train_edge_recon_loss: 25523203.4779; train_gene_expr_recon_loss: 9317425.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34895016.3676; train_optim_loss: 34895016.3676; val_kl_reg_loss: 53693.1418; val_edge_recon_loss: 25570501.6393; val_gene_expr_recon_loss: 9776521.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35400716.0000; val_optim_loss: 35400716.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 54712.8478; train_edge_recon_loss: 25530453.9265; train_gene_expr_recon_loss: 9300991.2996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34886158.0662; train_optim_loss: 34886158.0662; val_kl_reg_loss: 53699.6871; val_edge_recon_loss: 25572708.6557; val_gene_expr_recon_loss: 9770445.5246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35396853.7705; val_optim_loss: 35396853.7705
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 54812.8757; train_edge_recon_loss: 25519188.2904; train_gene_expr_recon_loss: 9299136.1314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34873137.3162; train_optim_loss: 34873137.3162; val_kl_reg_loss: 53760.2440; val_edge_recon_loss: 25545058.3279; val_gene_expr_recon_loss: 9761976.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35360794.5574; val_optim_loss: 35360794.5574
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 54918.2993; train_edge_recon_loss: 25513763.5404; train_gene_expr_recon_loss: 9307277.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34875959.1250; train_optim_loss: 34875959.1250; val_kl_reg_loss: 53829.0750; val_edge_recon_loss: 25578306.0328; val_gene_expr_recon_loss: 9746127.3443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35378262.5574; val_optim_loss: 35378262.5574
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 54904.7899; train_edge_recon_loss: 25523052.2132; train_gene_expr_recon_loss: 9298775.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34876732.2647; train_optim_loss: 34876732.2647; val_kl_reg_loss: 53994.3877; val_edge_recon_loss: 25588813.5738; val_gene_expr_recon_loss: 9819808.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35462616.5902; val_optim_loss: 35462616.5902
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 54877.4308; train_edge_recon_loss: 25529892.7831; train_gene_expr_recon_loss: 9292108.1912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34876878.4412; train_optim_loss: 34876878.4412; val_kl_reg_loss: 53834.1052; val_edge_recon_loss: 25583770.7541; val_gene_expr_recon_loss: 9776512.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35414117.7049; val_optim_loss: 35414117.7049
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9950; val_auprc_score: 0.9932; val_best_acc_score: 0.9786; val_best_f1_score: 0.9788; train_kl_reg_loss: 54934.3211; train_edge_recon_loss: 25522179.8419; train_gene_expr_recon_loss: 9301750.5423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34878864.7279; train_optim_loss: 34878864.7279; val_kl_reg_loss: 53878.4591; val_edge_recon_loss: 25577825.1148; val_gene_expr_recon_loss: 9756304.1639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35388007.7377; val_optim_loss: 35388007.7377

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 54980.6766; train_edge_recon_loss: 25530602.0551; train_gene_expr_recon_loss: 9297651.5699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34883234.2353; train_optim_loss: 34883234.2353; val_kl_reg_loss: 53976.5519; val_edge_recon_loss: 25548842.0656; val_gene_expr_recon_loss: 9778831.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35381650.6885; val_optim_loss: 35381650.6885
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 54961.0690; train_edge_recon_loss: 25529882.5625; train_gene_expr_recon_loss: 9296155.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34880999.1544; train_optim_loss: 34880999.1544; val_kl_reg_loss: 54018.3635; val_edge_recon_loss: 25574009.0492; val_gene_expr_recon_loss: 9799893.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35427921.3115; val_optim_loss: 35427921.3115
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 54973.6702; train_edge_recon_loss: 25524966.9522; train_gene_expr_recon_loss: 9300353.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34880294.3971; train_optim_loss: 34880294.3971; val_kl_reg_loss: 53968.3461; val_edge_recon_loss: 25580143.0492; val_gene_expr_recon_loss: 9776439.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35410550.5574; val_optim_loss: 35410550.5574
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9947; val_auprc_score: 0.9930; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 54985.3655; train_edge_recon_loss: 25521263.2647; train_gene_expr_recon_loss: 9291513.2353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34867761.7206; train_optim_loss: 34867761.7206; val_kl_reg_loss: 53991.5740; val_edge_recon_loss: 25596368.0656; val_gene_expr_recon_loss: 9785594.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35435953.7049; val_optim_loss: 35435953.7049

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 224 min 4 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9948
Val AUPRC score: 0.9929
Val best accuracy score: 0.9789
Val best F1 score: 0.9792
Val gene expr MSE score: 0.6397

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
