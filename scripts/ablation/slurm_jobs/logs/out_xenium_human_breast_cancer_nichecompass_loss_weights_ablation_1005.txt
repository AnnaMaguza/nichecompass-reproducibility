None
Run timestamp: 15072023_203618_1005.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1005']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9710; val_auprc_score: 0.9663; val_best_acc_score: 0.9163; val_best_f1_score: 0.9190; train_kl_reg_loss: 12318.5336; train_edge_recon_loss: 2731345.9908; train_gene_expr_recon_loss: 12987461.1246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15731125.6537; train_optim_loss: 15731125.6537; val_kl_reg_loss: 13282.4432; val_edge_recon_loss: 2693439.0736; val_gene_expr_recon_loss: 12403431.3767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15110152.8836; val_optim_loss: 15110152.8836
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9743; val_auprc_score: 0.9698; val_best_acc_score: 0.9232; val_best_f1_score: 0.9253; train_kl_reg_loss: 14243.4482; train_edge_recon_loss: 2653272.7273; train_gene_expr_recon_loss: 12180024.1361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14847540.3035; train_optim_loss: 14847540.3035; val_kl_reg_loss: 13867.1439; val_edge_recon_loss: 2680453.9932; val_gene_expr_recon_loss: 11982551.6986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14676872.7808; val_optim_loss: 14676872.7808
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9758; val_auprc_score: 0.9716; val_best_acc_score: 0.9263; val_best_f1_score: 0.9284; train_kl_reg_loss: 14526.8175; train_edge_recon_loss: 2642449.8679; train_gene_expr_recon_loss: 11915039.5092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14572016.2041; train_optim_loss: 14572016.2041; val_kl_reg_loss: 15059.3231; val_edge_recon_loss: 2666080.4503; val_gene_expr_recon_loss: 11829656.8493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14510796.6575; val_optim_loss: 14510796.6575
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9770; val_auprc_score: 0.9731; val_best_acc_score: 0.9270; val_best_f1_score: 0.9296; train_kl_reg_loss: 14680.5187; train_edge_recon_loss: 2637721.7064; train_gene_expr_recon_loss: 11794845.6774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14447247.8869; train_optim_loss: 14447247.8869; val_kl_reg_loss: 14615.0996; val_edge_recon_loss: 2665841.2432; val_gene_expr_recon_loss: 11766604.6233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14447060.9041; val_optim_loss: 14447060.9041
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9768; val_auprc_score: 0.9726; val_best_acc_score: 0.9280; val_best_f1_score: 0.9303; train_kl_reg_loss: 14759.7772; train_edge_recon_loss: 2634314.5757; train_gene_expr_recon_loss: 11741602.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14390676.3639; train_optim_loss: 14390676.3639; val_kl_reg_loss: 14580.4644; val_edge_recon_loss: 2657056.9863; val_gene_expr_recon_loss: 11712887.6575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14384525.1096; val_optim_loss: 14384525.1096
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9769; val_auprc_score: 0.9726; val_best_acc_score: 0.9276; val_best_f1_score: 0.9299; train_kl_reg_loss: 14817.5630; train_edge_recon_loss: 2631165.9687; train_gene_expr_recon_loss: 11709532.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14355515.7943; train_optim_loss: 14355515.7943; val_kl_reg_loss: 14037.5574; val_edge_recon_loss: 2661079.3202; val_gene_expr_recon_loss: 11717327.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14392444.1164; val_optim_loss: 14392444.1164
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9789; val_auprc_score: 0.9753; val_best_acc_score: 0.9312; val_best_f1_score: 0.9335; train_kl_reg_loss: 14840.3092; train_edge_recon_loss: 2627694.2617; train_gene_expr_recon_loss: 11692253.3479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14334787.9174; train_optim_loss: 14334787.9174; val_kl_reg_loss: 14828.8001; val_edge_recon_loss: 2651785.7842; val_gene_expr_recon_loss: 11692158.4315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14358773.0685; val_optim_loss: 14358773.0685
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9784; val_auprc_score: 0.9744; val_best_acc_score: 0.9305; val_best_f1_score: 0.9327; train_kl_reg_loss: 14817.6159; train_edge_recon_loss: 2625164.3700; train_gene_expr_recon_loss: 11676114.3127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14316096.2859; train_optim_loss: 14316096.2859; val_kl_reg_loss: 14381.3606; val_edge_recon_loss: 2659205.5428; val_gene_expr_recon_loss: 11708496.3973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14382083.2877; val_optim_loss: 14382083.2877
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9791; val_auprc_score: 0.9752; val_best_acc_score: 0.9331; val_best_f1_score: 0.9350; train_kl_reg_loss: 14835.7668; train_edge_recon_loss: 2623995.7240; train_gene_expr_recon_loss: 11670150.1873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14308981.6774; train_optim_loss: 14308981.6774; val_kl_reg_loss: 14683.9767; val_edge_recon_loss: 2648838.4914; val_gene_expr_recon_loss: 11669002.9521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14332525.3973; val_optim_loss: 14332525.3973
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9797; val_auprc_score: 0.9762; val_best_acc_score: 0.9336; val_best_f1_score: 0.9355; train_kl_reg_loss: 14819.7127; train_edge_recon_loss: 2621831.4925; train_gene_expr_recon_loss: 11668454.7875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14305105.9924; train_optim_loss: 14305105.9924; val_kl_reg_loss: 14174.7561; val_edge_recon_loss: 2645780.9110; val_gene_expr_recon_loss: 11680516.7260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14340472.3699; val_optim_loss: 14340472.3699
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9803; val_auprc_score: 0.9769; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 14794.0609; train_edge_recon_loss: 2620475.5617; train_gene_expr_recon_loss: 11664232.3135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14299501.9343; train_optim_loss: 14299501.9343; val_kl_reg_loss: 14611.5865; val_edge_recon_loss: 2646407.2757; val_gene_expr_recon_loss: 11672199.1712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14333218.0411; val_optim_loss: 14333218.0411
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9810; val_auprc_score: 0.9777; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 14788.5221; train_edge_recon_loss: 2620155.9100; train_gene_expr_recon_loss: 11666113.4717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14301057.9106; train_optim_loss: 14301057.9106; val_kl_reg_loss: 14716.2949; val_edge_recon_loss: 2642474.0360; val_gene_expr_recon_loss: 11662036.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14319227.2123; val_optim_loss: 14319227.2123
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9805; val_auprc_score: 0.9769; val_best_acc_score: 0.9353; val_best_f1_score: 0.9370; train_kl_reg_loss: 14763.9275; train_edge_recon_loss: 2618437.5688; train_gene_expr_recon_loss: 11659939.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14293141.1682; train_optim_loss: 14293141.1682; val_kl_reg_loss: 14648.8901; val_edge_recon_loss: 2644673.4384; val_gene_expr_recon_loss: 11673442.5411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14332764.8904; val_optim_loss: 14332764.8904
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9807; val_auprc_score: 0.9771; val_best_acc_score: 0.9362; val_best_f1_score: 0.9380; train_kl_reg_loss: 14741.8807; train_edge_recon_loss: 2618381.8437; train_gene_expr_recon_loss: 11654827.8914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14287951.6246; train_optim_loss: 14287951.6246; val_kl_reg_loss: 14645.7054; val_edge_recon_loss: 2646227.0051; val_gene_expr_recon_loss: 11662630.5548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14323503.2397; val_optim_loss: 14323503.2397
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9810; val_auprc_score: 0.9774; val_best_acc_score: 0.9371; val_best_f1_score: 0.9388; train_kl_reg_loss: 14717.9247; train_edge_recon_loss: 2617945.1627; train_gene_expr_recon_loss: 11654069.6422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14286732.7118; train_optim_loss: 14286732.7118; val_kl_reg_loss: 14109.9361; val_edge_recon_loss: 2642667.4521; val_gene_expr_recon_loss: 11658082.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14314860.3836; val_optim_loss: 14314860.3836
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9811; val_auprc_score: 0.9777; val_best_acc_score: 0.9368; val_best_f1_score: 0.9386; train_kl_reg_loss: 14661.0374; train_edge_recon_loss: 2616621.0870; train_gene_expr_recon_loss: 11647040.1827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14278322.2997; train_optim_loss: 14278322.2997; val_kl_reg_loss: 14640.5599; val_edge_recon_loss: 2642349.2003; val_gene_expr_recon_loss: 11656673.7260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14313663.4589; val_optim_loss: 14313663.4589
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9812; val_auprc_score: 0.9778; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 14636.7578; train_edge_recon_loss: 2617494.3798; train_gene_expr_recon_loss: 11646286.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14278417.7164; train_optim_loss: 14278417.7164; val_kl_reg_loss: 14345.4428; val_edge_recon_loss: 2644335.6935; val_gene_expr_recon_loss: 11670729.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14329410.1781; val_optim_loss: 14329410.1781
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9814; val_auprc_score: 0.9777; val_best_acc_score: 0.9369; val_best_f1_score: 0.9385; train_kl_reg_loss: 14602.2877; train_edge_recon_loss: 2616468.3727; train_gene_expr_recon_loss: 11645345.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14276416.6399; train_optim_loss: 14276416.6399; val_kl_reg_loss: 14360.8057; val_edge_recon_loss: 2642093.0925; val_gene_expr_recon_loss: 11681520.2466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14337974.1370; val_optim_loss: 14337974.1370
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9817; val_auprc_score: 0.9785; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 14572.0035; train_edge_recon_loss: 2613942.6170; train_gene_expr_recon_loss: 11638873.9121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14267388.5390; train_optim_loss: 14267388.5390; val_kl_reg_loss: 14588.3179; val_edge_recon_loss: 2638992.2637; val_gene_expr_recon_loss: 11660799.1096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14314379.6438; val_optim_loss: 14314379.6438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9818; val_auprc_score: 0.9783; val_best_acc_score: 0.9383; val_best_f1_score: 0.9401; train_kl_reg_loss: 14515.7373; train_edge_recon_loss: 2615539.8867; train_gene_expr_recon_loss: 11639093.3402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14269148.9602; train_optim_loss: 14269148.9602; val_kl_reg_loss: 14035.1031; val_edge_recon_loss: 2636024.0051; val_gene_expr_recon_loss: 11656340.0548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14306399.1644; val_optim_loss: 14306399.1644
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9819; val_auprc_score: 0.9782; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 14505.4684; train_edge_recon_loss: 2614538.8500; train_gene_expr_recon_loss: 11639552.7301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14268597.0413; train_optim_loss: 14268597.0413; val_kl_reg_loss: 14277.9767; val_edge_recon_loss: 2640065.9127; val_gene_expr_recon_loss: 11651725.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14306069.3219; val_optim_loss: 14306069.3219
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9786; val_best_acc_score: 0.9387; val_best_f1_score: 0.9403; train_kl_reg_loss: 14467.1708; train_edge_recon_loss: 2614897.9711; train_gene_expr_recon_loss: 11641081.1950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14270446.3379; train_optim_loss: 14270446.3379; val_kl_reg_loss: 14256.1246; val_edge_recon_loss: 2641233.1438; val_gene_expr_recon_loss: 11660833.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14316322.7329; val_optim_loss: 14316322.7329
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9819; val_auprc_score: 0.9783; val_best_acc_score: 0.9385; val_best_f1_score: 0.9402; train_kl_reg_loss: 14449.1477; train_edge_recon_loss: 2613037.6783; train_gene_expr_recon_loss: 11640426.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14267913.2362; train_optim_loss: 14267913.2362; val_kl_reg_loss: 14140.6102; val_edge_recon_loss: 2636702.9332; val_gene_expr_recon_loss: 11663094.5205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14313938.0411; val_optim_loss: 14313938.0411
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9817; val_auprc_score: 0.9782; val_best_acc_score: 0.9375; val_best_f1_score: 0.9390; train_kl_reg_loss: 14405.9643; train_edge_recon_loss: 2614020.4278; train_gene_expr_recon_loss: 11637340.8968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14265767.2905; train_optim_loss: 14265767.2905; val_kl_reg_loss: 14352.6940; val_edge_recon_loss: 2641273.5154; val_gene_expr_recon_loss: 11661495.6575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14317121.8630; val_optim_loss: 14317121.8630
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9823; val_auprc_score: 0.9784; val_best_acc_score: 0.9402; val_best_f1_score: 0.9417; train_kl_reg_loss: 14390.4868; train_edge_recon_loss: 2613948.8373; train_gene_expr_recon_loss: 11634091.8050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14262431.1284; train_optim_loss: 14262431.1284; val_kl_reg_loss: 14150.9989; val_edge_recon_loss: 2635137.1815; val_gene_expr_recon_loss: 11656552.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14305840.3630; val_optim_loss: 14305840.3630
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9821; val_auprc_score: 0.9785; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 14363.0893; train_edge_recon_loss: 2611521.2439; train_gene_expr_recon_loss: 11631214.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14257098.6697; train_optim_loss: 14257098.6697; val_kl_reg_loss: 14076.4355; val_edge_recon_loss: 2634698.0086; val_gene_expr_recon_loss: 11661862.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14310636.6233; val_optim_loss: 14310636.6233
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9821; val_auprc_score: 0.9787; val_best_acc_score: 0.9386; val_best_f1_score: 0.9402; train_kl_reg_loss: 14302.8033; train_edge_recon_loss: 2610992.6604; train_gene_expr_recon_loss: 11633329.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14258624.4595; train_optim_loss: 14258624.4595; val_kl_reg_loss: 14229.0978; val_edge_recon_loss: 2638219.0445; val_gene_expr_recon_loss: 11655909.8630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14308358.0411; val_optim_loss: 14308358.0411
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9818; val_auprc_score: 0.9783; val_best_acc_score: 0.9381; val_best_f1_score: 0.9399; train_kl_reg_loss: 14294.7365; train_edge_recon_loss: 2611970.5172; train_gene_expr_recon_loss: 11630164.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14256429.3180; train_optim_loss: 14256429.3180; val_kl_reg_loss: 14137.4570; val_edge_recon_loss: 2636846.9829; val_gene_expr_recon_loss: 11665663.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14316647.7808; val_optim_loss: 14316647.7808
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9822; val_auprc_score: 0.9787; val_best_acc_score: 0.9394; val_best_f1_score: 0.9412; train_kl_reg_loss: 14254.6045; train_edge_recon_loss: 2611700.0134; train_gene_expr_recon_loss: 11628568.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14254523.1361; train_optim_loss: 14254523.1361; val_kl_reg_loss: 14085.0822; val_edge_recon_loss: 2634309.4229; val_gene_expr_recon_loss: 11636764.7945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14285159.2877; val_optim_loss: 14285159.2877
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9826; val_auprc_score: 0.9788; val_best_acc_score: 0.9402; val_best_f1_score: 0.9417; train_kl_reg_loss: 14239.6863; train_edge_recon_loss: 2611606.5625; train_gene_expr_recon_loss: 11624454.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14250301.0780; train_optim_loss: 14250301.0780; val_kl_reg_loss: 13983.5525; val_edge_recon_loss: 2633656.3921; val_gene_expr_recon_loss: 11653183.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14300823.2603; val_optim_loss: 14300823.2603
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9828; val_auprc_score: 0.9792; val_best_acc_score: 0.9399; val_best_f1_score: 0.9415; train_kl_reg_loss: 14216.1855; train_edge_recon_loss: 2611547.7710; train_gene_expr_recon_loss: 11624541.3777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14250305.3394; train_optim_loss: 14250305.3394; val_kl_reg_loss: 14148.5351; val_edge_recon_loss: 2633892.5942; val_gene_expr_recon_loss: 11671020.7055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14319061.8356; val_optim_loss: 14319061.8356
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9821; val_auprc_score: 0.9784; val_best_acc_score: 0.9393; val_best_f1_score: 0.9409; train_kl_reg_loss: 14174.5957; train_edge_recon_loss: 2611508.4304; train_gene_expr_recon_loss: 11630646.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14256329.7271; train_optim_loss: 14256329.7271; val_kl_reg_loss: 14182.7646; val_edge_recon_loss: 2635998.9281; val_gene_expr_recon_loss: 11664859.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14315041.6370; val_optim_loss: 14315041.6370
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9824; val_auprc_score: 0.9788; val_best_acc_score: 0.9396; val_best_f1_score: 0.9411; train_kl_reg_loss: 14154.2928; train_edge_recon_loss: 2611819.1925; train_gene_expr_recon_loss: 11627420.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14253394.4388; train_optim_loss: 14253394.4388; val_kl_reg_loss: 13916.1025; val_edge_recon_loss: 2637080.8887; val_gene_expr_recon_loss: 11653100.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14304097.2329; val_optim_loss: 14304097.2329

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9821; val_auprc_score: 0.9785; val_best_acc_score: 0.9394; val_best_f1_score: 0.9408; train_kl_reg_loss: 14682.7033; train_edge_recon_loss: 2603476.1963; train_gene_expr_recon_loss: 11556176.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14174335.5336; train_optim_loss: 14174335.5336; val_kl_reg_loss: 14195.8211; val_edge_recon_loss: 2628209.7551; val_gene_expr_recon_loss: 11570802.8082; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14213208.3425; val_optim_loss: 14213208.3425
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9822; val_auprc_score: 0.9788; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 14152.0296; train_edge_recon_loss: 2603488.3819; train_gene_expr_recon_loss: 11546395.1009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14164035.5138; train_optim_loss: 14164035.5138; val_kl_reg_loss: 13818.2876; val_edge_recon_loss: 2625114.1849; val_gene_expr_recon_loss: 11581912.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14220844.8356; val_optim_loss: 14220844.8356
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9821; val_auprc_score: 0.9782; val_best_acc_score: 0.9395; val_best_f1_score: 0.9412; train_kl_reg_loss: 13959.2283; train_edge_recon_loss: 2602778.8997; train_gene_expr_recon_loss: 11540063.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14156801.7347; train_optim_loss: 14156801.7347; val_kl_reg_loss: 13702.9594; val_edge_recon_loss: 2625768.2072; val_gene_expr_recon_loss: 11596145.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14235616.3562; val_optim_loss: 14235616.3562
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9819; val_auprc_score: 0.9778; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 13862.7704; train_edge_recon_loss: 2603520.5763; train_gene_expr_recon_loss: 11538454.9274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14155838.2576; train_optim_loss: 14155838.2576; val_kl_reg_loss: 13673.0051; val_edge_recon_loss: 2625943.6815; val_gene_expr_recon_loss: 11597501.8288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14237118.4932; val_optim_loss: 14237118.4932
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9822; val_auprc_score: 0.9786; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 13790.3087; train_edge_recon_loss: 2602929.6900; train_gene_expr_recon_loss: 11537634.6774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14154354.6713; train_optim_loss: 14154354.6713; val_kl_reg_loss: 13579.5439; val_edge_recon_loss: 2625433.9195; val_gene_expr_recon_loss: 11595764.9110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14234778.3973; val_optim_loss: 14234778.3973

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9822; val_auprc_score: 0.9787; val_best_acc_score: 0.9396; val_best_f1_score: 0.9413; train_kl_reg_loss: 13834.4898; train_edge_recon_loss: 2601202.6260; train_gene_expr_recon_loss: 11526666.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14141703.3043; train_optim_loss: 14141703.3043; val_kl_reg_loss: 13715.0465; val_edge_recon_loss: 2627258.1404; val_gene_expr_recon_loss: 11579960.3425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14220933.5479; val_optim_loss: 14220933.5479
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9824; val_auprc_score: 0.9790; val_best_acc_score: 0.9397; val_best_f1_score: 0.9413; train_kl_reg_loss: 13885.5387; train_edge_recon_loss: 2602861.1714; train_gene_expr_recon_loss: 11527344.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14144091.3073; train_optim_loss: 14144091.3073; val_kl_reg_loss: 13709.9467; val_edge_recon_loss: 2623047.1010; val_gene_expr_recon_loss: 11578694.2740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14215451.2877; val_optim_loss: 14215451.2877
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9818; val_auprc_score: 0.9778; val_best_acc_score: 0.9397; val_best_f1_score: 0.9414; train_kl_reg_loss: 13878.6092; train_edge_recon_loss: 2601919.4851; train_gene_expr_recon_loss: 11523064.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14138862.8096; train_optim_loss: 14138862.8096; val_kl_reg_loss: 13714.1486; val_edge_recon_loss: 2624234.9247; val_gene_expr_recon_loss: 11572768.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14210717.7055; val_optim_loss: 14210717.7055
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9822; val_auprc_score: 0.9785; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 13865.9498; train_edge_recon_loss: 2600695.3586; train_gene_expr_recon_loss: 11528220.0115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14142781.3035; train_optim_loss: 14142781.3035; val_kl_reg_loss: 13677.4300; val_edge_recon_loss: 2623955.6147; val_gene_expr_recon_loss: 11576574.7945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214207.8219; val_optim_loss: 14214207.8219
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9817; val_auprc_score: 0.9777; val_best_acc_score: 0.9388; val_best_f1_score: 0.9405; train_kl_reg_loss: 13849.4645; train_edge_recon_loss: 2601699.1850; train_gene_expr_recon_loss: 11525328.8142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14140877.4855; train_optim_loss: 14140877.4855; val_kl_reg_loss: 13665.9714; val_edge_recon_loss: 2625142.6182; val_gene_expr_recon_loss: 11578406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14217214.5548; val_optim_loss: 14217214.5548
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9816; val_auprc_score: 0.9778; val_best_acc_score: 0.9392; val_best_f1_score: 0.9409; train_kl_reg_loss: 13836.1513; train_edge_recon_loss: 2601910.9421; train_gene_expr_recon_loss: 11523008.3777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14138755.4832; train_optim_loss: 14138755.4832; val_kl_reg_loss: 13661.2339; val_edge_recon_loss: 2627160.4812; val_gene_expr_recon_loss: 11566705.6986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14207527.4452; val_optim_loss: 14207527.4452
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9822; val_auprc_score: 0.9785; val_best_acc_score: 0.9397; val_best_f1_score: 0.9413; train_kl_reg_loss: 13814.7859; train_edge_recon_loss: 2602087.2060; train_gene_expr_recon_loss: 11526240.6789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14142142.6766; train_optim_loss: 14142142.6766; val_kl_reg_loss: 13621.9671; val_edge_recon_loss: 2623100.7380; val_gene_expr_recon_loss: 11557262.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14193985.0411; val_optim_loss: 14193985.0411
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9823; val_auprc_score: 0.9787; val_best_acc_score: 0.9395; val_best_f1_score: 0.9412; train_kl_reg_loss: 13804.4740; train_edge_recon_loss: 2602941.7664; train_gene_expr_recon_loss: 11528825.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14145571.9304; train_optim_loss: 14145571.9304; val_kl_reg_loss: 13615.7317; val_edge_recon_loss: 2623690.2329; val_gene_expr_recon_loss: 11564689.5342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14201995.5342; val_optim_loss: 14201995.5342
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9820; val_auprc_score: 0.9786; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 13798.9042; train_edge_recon_loss: 2602295.8450; train_gene_expr_recon_loss: 11529427.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14145522.2217; train_optim_loss: 14145522.2217; val_kl_reg_loss: 13589.7693; val_edge_recon_loss: 2623681.4264; val_gene_expr_recon_loss: 11577011.7397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214282.9384; val_optim_loss: 14214282.9384
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9820; val_auprc_score: 0.9784; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 13781.6317; train_edge_recon_loss: 2602361.3477; train_gene_expr_recon_loss: 11524414.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14140557.6170; train_optim_loss: 14140557.6170; val_kl_reg_loss: 13634.3614; val_edge_recon_loss: 2627377.0394; val_gene_expr_recon_loss: 11573936.1370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214947.5205; val_optim_loss: 14214947.5205
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9822; val_auprc_score: 0.9787; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 13779.2304; train_edge_recon_loss: 2601995.6542; train_gene_expr_recon_loss: 11525375.4817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14141150.3524; train_optim_loss: 14141150.3524; val_kl_reg_loss: 13584.2785; val_edge_recon_loss: 2621617.3973; val_gene_expr_recon_loss: 11568163.8836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14203365.5137; val_optim_loss: 14203365.5137

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9817; val_auprc_score: 0.9780; val_best_acc_score: 0.9392; val_best_f1_score: 0.9409; train_kl_reg_loss: 13766.8085; train_edge_recon_loss: 2601297.9128; train_gene_expr_recon_loss: 11526029.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14141094.5405; train_optim_loss: 14141094.5405; val_kl_reg_loss: 13590.8654; val_edge_recon_loss: 2624118.6866; val_gene_expr_recon_loss: 11563082.7260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14200792.2671; val_optim_loss: 14200792.2671
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9822; val_auprc_score: 0.9789; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 13771.3793; train_edge_recon_loss: 2602220.6332; train_gene_expr_recon_loss: 11526115.6208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14142107.6422; train_optim_loss: 14142107.6422; val_kl_reg_loss: 13586.0271; val_edge_recon_loss: 2625717.9897; val_gene_expr_recon_loss: 11559659.4384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14198963.4795; val_optim_loss: 14198963.4795
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9818; val_auprc_score: 0.9780; val_best_acc_score: 0.9390; val_best_f1_score: 0.9407; train_kl_reg_loss: 13771.0707; train_edge_recon_loss: 2602059.2672; train_gene_expr_recon_loss: 11525994.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14141824.3998; train_optim_loss: 14141824.3998; val_kl_reg_loss: 13587.3749; val_edge_recon_loss: 2627345.1045; val_gene_expr_recon_loss: 11579837.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14220769.6438; val_optim_loss: 14220769.6438
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9822; val_auprc_score: 0.9787; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 13771.5880; train_edge_recon_loss: 2601594.2542; train_gene_expr_recon_loss: 11524012.2278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14139378.0742; train_optim_loss: 14139378.0742; val_kl_reg_loss: 13593.6562; val_edge_recon_loss: 2622654.7534; val_gene_expr_recon_loss: 11574942.0479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14211190.4795; val_optim_loss: 14211190.4795

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 319 min 3 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9819
Val AUPRC score: 0.9780
Val best accuracy score: 0.9390
Val best F1 score: 0.9407
Val gene expr MSE score: 2.6345

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
