None
Run timestamp: 25072023_021042_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9822; val_auprc_score: 0.9793; val_best_acc_score: 0.9364; val_best_f1_score: 0.9379; train_kl_reg_loss: 16134.9554; train_edge_recon_loss: 2664934.5138; train_gene_expr_recon_loss: 757833.9459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3438903.4156; train_optim_loss: 3438903.4156; val_kl_reg_loss: 14772.3093; val_edge_recon_loss: 2640499.6376; val_gene_expr_recon_loss: 705843.2467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3361115.1934; val_optim_loss: 3361115.1934
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9880; val_auprc_score: 0.9854; val_best_acc_score: 0.9514; val_best_f1_score: 0.9521; train_kl_reg_loss: 13743.7782; train_edge_recon_loss: 2612944.0859; train_gene_expr_recon_loss: 692806.9856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3319494.8510; train_optim_loss: 3319494.8510; val_kl_reg_loss: 13129.0455; val_edge_recon_loss: 2623201.4068; val_gene_expr_recon_loss: 684469.2097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3320799.6646; val_optim_loss: 3320799.6646
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9904; val_auprc_score: 0.9885; val_best_acc_score: 0.9584; val_best_f1_score: 0.9590; train_kl_reg_loss: 12851.3617; train_edge_recon_loss: 2602175.8378; train_gene_expr_recon_loss: 680585.3684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3295612.5670; train_optim_loss: 3295612.5670; val_kl_reg_loss: 12360.7268; val_edge_recon_loss: 2605993.4765; val_gene_expr_recon_loss: 677962.7389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3296316.9373; val_optim_loss: 3296316.9373
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9916; val_auprc_score: 0.9901; val_best_acc_score: 0.9620; val_best_f1_score: 0.9626; train_kl_reg_loss: 12365.1174; train_edge_recon_loss: 2594552.5805; train_gene_expr_recon_loss: 675668.3239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3282586.0203; train_optim_loss: 3282586.0203; val_kl_reg_loss: 11941.6003; val_edge_recon_loss: 2602070.2578; val_gene_expr_recon_loss: 675060.0483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3289071.9024; val_optim_loss: 3289071.9024
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9920; val_auprc_score: 0.9902; val_best_acc_score: 0.9635; val_best_f1_score: 0.9640; train_kl_reg_loss: 11998.2384; train_edge_recon_loss: 2591253.6994; train_gene_expr_recon_loss: 672745.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3275997.5501; train_optim_loss: 3275997.5501; val_kl_reg_loss: 11657.1240; val_edge_recon_loss: 2598735.1063; val_gene_expr_recon_loss: 673742.8201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284135.0566; val_optim_loss: 3284135.0566
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 11790.4298; train_edge_recon_loss: 2588344.9161; train_gene_expr_recon_loss: 670967.1324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3271102.4784; train_optim_loss: 3271102.4784; val_kl_reg_loss: 11528.3897; val_edge_recon_loss: 2600798.0653; val_gene_expr_recon_loss: 672057.8247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3284384.2779; val_optim_loss: 3284384.2779
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9929; val_auprc_score: 0.9915; val_best_acc_score: 0.9662; val_best_f1_score: 0.9667; train_kl_reg_loss: 11578.3345; train_edge_recon_loss: 2586001.2976; train_gene_expr_recon_loss: 669827.1336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3267406.7639; train_optim_loss: 3267406.7639; val_kl_reg_loss: 11584.1181; val_edge_recon_loss: 2595492.7735; val_gene_expr_recon_loss: 669364.6150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3276441.5061; val_optim_loss: 3276441.5061
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9933; val_auprc_score: 0.9918; val_best_acc_score: 0.9675; val_best_f1_score: 0.9680; train_kl_reg_loss: 11422.8472; train_edge_recon_loss: 2584698.2171; train_gene_expr_recon_loss: 668667.8156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3264788.8813; train_optim_loss: 3264788.8813; val_kl_reg_loss: 11273.2599; val_edge_recon_loss: 2590068.8580; val_gene_expr_recon_loss: 669981.9340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3271324.0523; val_optim_loss: 3271324.0523
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9934; val_auprc_score: 0.9919; val_best_acc_score: 0.9681; val_best_f1_score: 0.9686; train_kl_reg_loss: 11329.9958; train_edge_recon_loss: 2582591.9017; train_gene_expr_recon_loss: 667803.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3261724.9718; train_optim_loss: 3261724.9718; val_kl_reg_loss: 11311.4635; val_edge_recon_loss: 2597574.6925; val_gene_expr_recon_loss: 670183.9702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3279070.1159; val_optim_loss: 3279070.1159
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9926; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 11233.6145; train_edge_recon_loss: 2581330.4890; train_gene_expr_recon_loss: 667096.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3259660.6020; train_optim_loss: 3259660.6020; val_kl_reg_loss: 11155.5427; val_edge_recon_loss: 2589787.7866; val_gene_expr_recon_loss: 668815.7855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269759.1159; val_optim_loss: 3269759.1159
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9940; val_auprc_score: 0.9927; val_best_acc_score: 0.9705; val_best_f1_score: 0.9708; train_kl_reg_loss: 11129.8738; train_edge_recon_loss: 2580265.3634; train_gene_expr_recon_loss: 666513.8735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3257909.1106; train_optim_loss: 3257909.1106; val_kl_reg_loss: 10911.1172; val_edge_recon_loss: 2586180.8937; val_gene_expr_recon_loss: 668391.4096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265483.4068; val_optim_loss: 3265483.4068
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9938; val_auprc_score: 0.9923; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 11087.7588; train_edge_recon_loss: 2578990.3980; train_gene_expr_recon_loss: 665802.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3255880.7447; train_optim_loss: 3255880.7447; val_kl_reg_loss: 11275.5811; val_edge_recon_loss: 2589924.0984; val_gene_expr_recon_loss: 668273.9832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3269473.6611; val_optim_loss: 3269473.6611
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9941; val_auprc_score: 0.9926; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 11027.4689; train_edge_recon_loss: 2577626.8171; train_gene_expr_recon_loss: 665681.1903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3254335.4740; train_optim_loss: 3254335.4740; val_kl_reg_loss: 10870.4807; val_edge_recon_loss: 2586873.1159; val_gene_expr_recon_loss: 668139.0928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265882.6908; val_optim_loss: 3265882.6908
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9940; val_auprc_score: 0.9925; val_best_acc_score: 0.9723; val_best_f1_score: 0.9726; train_kl_reg_loss: 10936.3495; train_edge_recon_loss: 2577790.1896; train_gene_expr_recon_loss: 665261.0890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3253987.6265; train_optim_loss: 3253987.6265; val_kl_reg_loss: 10800.1064; val_edge_recon_loss: 2588360.8075; val_gene_expr_recon_loss: 667997.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3267158.7404; val_optim_loss: 3267158.7404
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 10924.0028; train_edge_recon_loss: 2576621.4735; train_gene_expr_recon_loss: 664880.8502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3252426.3249; train_optim_loss: 3252426.3249; val_kl_reg_loss: 11075.8869; val_edge_recon_loss: 2586618.1246; val_gene_expr_recon_loss: 667632.9726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3265326.9974; val_optim_loss: 3265326.9974
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 10887.0367; train_edge_recon_loss: 2575500.8704; train_gene_expr_recon_loss: 664458.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250846.1276; train_optim_loss: 3250846.1276; val_kl_reg_loss: 10696.6407; val_edge_recon_loss: 2582763.5915; val_gene_expr_recon_loss: 668070.4848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3261530.7152; val_optim_loss: 3261530.7152
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9937; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 10845.9492; train_edge_recon_loss: 2575012.9153; train_gene_expr_recon_loss: 664321.8128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250180.6771; train_optim_loss: 3250180.6771; val_kl_reg_loss: 10694.2292; val_edge_recon_loss: 2579327.0087; val_gene_expr_recon_loss: 667432.8225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257454.0636; val_optim_loss: 3257454.0636
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9946; val_auprc_score: 0.9933; val_best_acc_score: 0.9736; val_best_f1_score: 0.9739; train_kl_reg_loss: 10814.4080; train_edge_recon_loss: 2575410.7958; train_gene_expr_recon_loss: 664045.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3250270.6292; train_optim_loss: 3250270.6292; val_kl_reg_loss: 10831.2159; val_edge_recon_loss: 2584694.6707; val_gene_expr_recon_loss: 667534.7846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3263060.6742; val_optim_loss: 3263060.6742
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9949; val_auprc_score: 0.9935; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 10786.3617; train_edge_recon_loss: 2574313.0081; train_gene_expr_recon_loss: 663819.6142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3248918.9809; train_optim_loss: 3248918.9809; val_kl_reg_loss: 10731.2085; val_edge_recon_loss: 2579810.5923; val_gene_expr_recon_loss: 667752.6522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3258294.4477; val_optim_loss: 3258294.4477
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 10773.2743; train_edge_recon_loss: 2574222.1514; train_gene_expr_recon_loss: 664105.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3249100.7530; train_optim_loss: 3249100.7530; val_kl_reg_loss: 10662.4547; val_edge_recon_loss: 2580060.6324; val_gene_expr_recon_loss: 666745.1794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3257468.2631; val_optim_loss: 3257468.2631
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9950; val_auprc_score: 0.9936; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 10733.5502; train_edge_recon_loss: 2573182.9711; train_gene_expr_recon_loss: 663432.5665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3247349.0892; train_optim_loss: 3247349.0892; val_kl_reg_loss: 10750.7855; val_edge_recon_loss: 2582463.5941; val_gene_expr_recon_loss: 666205.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3259420.2761; val_optim_loss: 3259420.2761

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9757; val_best_f1_score: 0.9761; train_kl_reg_loss: 11105.8425; train_edge_recon_loss: 2571155.1432; train_gene_expr_recon_loss: 658393.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3240654.1896; train_optim_loss: 3240654.1896; val_kl_reg_loss: 11239.3014; val_edge_recon_loss: 2576282.6873; val_gene_expr_recon_loss: 662543.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250065.7561; val_optim_loss: 3250065.7561
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 11218.4245; train_edge_recon_loss: 2570322.8822; train_gene_expr_recon_loss: 657337.9045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238879.2114; train_optim_loss: 3238879.2114; val_kl_reg_loss: 11089.5113; val_edge_recon_loss: 2574302.7230; val_gene_expr_recon_loss: 661470.2513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246862.4895; val_optim_loss: 3246862.4895
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9766; val_best_f1_score: 0.9768; train_kl_reg_loss: 11219.2701; train_edge_recon_loss: 2570107.5644; train_gene_expr_recon_loss: 656943.0075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238269.8408; train_optim_loss: 3238269.8408; val_kl_reg_loss: 11134.3956; val_edge_recon_loss: 2576840.9547; val_gene_expr_recon_loss: 661986.8354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249962.1864; val_optim_loss: 3249962.1864
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9957; val_auprc_score: 0.9947; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 11240.2665; train_edge_recon_loss: 2569899.1364; train_gene_expr_recon_loss: 657247.3324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238386.7345; train_optim_loss: 3238386.7345; val_kl_reg_loss: 11189.5101; val_edge_recon_loss: 2575514.1429; val_gene_expr_recon_loss: 661634.3160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248337.9739; val_optim_loss: 3248337.9739
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9764; val_best_f1_score: 0.9767; train_kl_reg_loss: 11271.0581; train_edge_recon_loss: 2569945.2499; train_gene_expr_recon_loss: 657181.5590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3238397.8673; train_optim_loss: 3238397.8673; val_kl_reg_loss: 11216.4096; val_edge_recon_loss: 2576620.9390; val_gene_expr_recon_loss: 662181.2781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250018.6254; val_optim_loss: 3250018.6254
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 11258.2241; train_edge_recon_loss: 2569705.3060; train_gene_expr_recon_loss: 656756.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237719.7135; train_optim_loss: 3237719.7135; val_kl_reg_loss: 11219.3047; val_edge_recon_loss: 2576748.2282; val_gene_expr_recon_loss: 661445.7206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249413.2448; val_optim_loss: 3249413.2448

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 11289.5046; train_edge_recon_loss: 2569807.7804; train_gene_expr_recon_loss: 656428.9095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237526.1978; train_optim_loss: 3237526.1978; val_kl_reg_loss: 11192.1510; val_edge_recon_loss: 2574702.7308; val_gene_expr_recon_loss: 661803.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247698.3563; val_optim_loss: 3247698.3563
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9955; val_auprc_score: 0.9942; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 11280.1429; train_edge_recon_loss: 2569123.7512; train_gene_expr_recon_loss: 655921.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236325.2366; train_optim_loss: 3236325.2366; val_kl_reg_loss: 11195.7826; val_edge_recon_loss: 2574960.0261; val_gene_expr_recon_loss: 661358.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247513.9521; val_optim_loss: 3247513.9521
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 11291.2190; train_edge_recon_loss: 2569318.7598; train_gene_expr_recon_loss: 656047.8373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236657.8182; train_optim_loss: 3236657.8182; val_kl_reg_loss: 11194.6677; val_edge_recon_loss: 2574504.5383; val_gene_expr_recon_loss: 660982.9436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246682.1507; val_optim_loss: 3246682.1507
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 11284.5839; train_edge_recon_loss: 2569664.0169; train_gene_expr_recon_loss: 655969.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236918.5300; train_optim_loss: 3236918.5300; val_kl_reg_loss: 11198.2721; val_edge_recon_loss: 2573894.0679; val_gene_expr_recon_loss: 661191.5438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246283.8798; val_optim_loss: 3246283.8798
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 11292.2667; train_edge_recon_loss: 2569685.2846; train_gene_expr_recon_loss: 655703.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236681.0659; train_optim_loss: 3236681.0659; val_kl_reg_loss: 11209.9765; val_edge_recon_loss: 2576007.6019; val_gene_expr_recon_loss: 660281.4122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247498.9782; val_optim_loss: 3247498.9782
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 11296.7572; train_edge_recon_loss: 2569638.5669; train_gene_expr_recon_loss: 655738.6301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236673.9511; train_optim_loss: 3236673.9511; val_kl_reg_loss: 11211.1401; val_edge_recon_loss: 2576787.9538; val_gene_expr_recon_loss: 661255.7167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249254.8127; val_optim_loss: 3249254.8127
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 11301.8767; train_edge_recon_loss: 2568984.7377; train_gene_expr_recon_loss: 655893.2450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236179.8607; train_optim_loss: 3236179.8607; val_kl_reg_loss: 11203.1844; val_edge_recon_loss: 2574689.9085; val_gene_expr_recon_loss: 661378.1971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247271.2901; val_optim_loss: 3247271.2901
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 11286.7467; train_edge_recon_loss: 2569339.0143; train_gene_expr_recon_loss: 655602.4960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236228.2574; train_optim_loss: 3236228.2574; val_kl_reg_loss: 11207.1585; val_edge_recon_loss: 2575870.7221; val_gene_expr_recon_loss: 660809.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247886.9826; val_optim_loss: 3247886.9826

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 11288.2848; train_edge_recon_loss: 2569331.1566; train_gene_expr_recon_loss: 655795.5337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236414.9768; train_optim_loss: 3236414.9768; val_kl_reg_loss: 11206.8471; val_edge_recon_loss: 2572988.4042; val_gene_expr_recon_loss: 660899.4678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245094.7195; val_optim_loss: 3245094.7195
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 11287.8775; train_edge_recon_loss: 2569106.1906; train_gene_expr_recon_loss: 655704.9853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236099.0526; train_optim_loss: 3236099.0526; val_kl_reg_loss: 11202.7668; val_edge_recon_loss: 2574757.9094; val_gene_expr_recon_loss: 660176.0690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246136.7639; val_optim_loss: 3246136.7639
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 11291.4316; train_edge_recon_loss: 2569145.3504; train_gene_expr_recon_loss: 655752.6831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236189.4673; train_optim_loss: 3236189.4673; val_kl_reg_loss: 11210.3710; val_edge_recon_loss: 2576013.6106; val_gene_expr_recon_loss: 661446.0355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248670.0192; val_optim_loss: 3248670.0192
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 11292.3422; train_edge_recon_loss: 2568867.6757; train_gene_expr_recon_loss: 655843.6846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236003.7028; train_optim_loss: 3236003.7028; val_kl_reg_loss: 11209.6289; val_edge_recon_loss: 2574271.5348; val_gene_expr_recon_loss: 660927.0699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3246408.2369; val_optim_loss: 3246408.2369
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 11291.8036; train_edge_recon_loss: 2568947.7709; train_gene_expr_recon_loss: 655773.3531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236012.9263; train_optim_loss: 3236012.9263; val_kl_reg_loss: 11204.2775; val_edge_recon_loss: 2573592.0671; val_gene_expr_recon_loss: 660249.0359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3245045.3833; val_optim_loss: 3245045.3833
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 11293.1982; train_edge_recon_loss: 2569191.5135; train_gene_expr_recon_loss: 655800.4228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236285.1327; train_optim_loss: 3236285.1327; val_kl_reg_loss: 11207.4489; val_edge_recon_loss: 2577481.1812; val_gene_expr_recon_loss: 661898.2827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250586.9164; val_optim_loss: 3250586.9164
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 11291.0752; train_edge_recon_loss: 2570016.8659; train_gene_expr_recon_loss: 655768.2387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3237076.1784; train_optim_loss: 3237076.1784; val_kl_reg_loss: 11209.7002; val_edge_recon_loss: 2574700.0618; val_gene_expr_recon_loss: 661688.1291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247597.8815; val_optim_loss: 3247597.8815
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 11288.4426; train_edge_recon_loss: 2569803.8241; train_gene_expr_recon_loss: 655700.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236792.7258; train_optim_loss: 3236792.7258; val_kl_reg_loss: 11209.0834; val_edge_recon_loss: 2576532.8746; val_gene_expr_recon_loss: 661226.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248968.9538; val_optim_loss: 3248968.9538
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 11293.3830; train_edge_recon_loss: 2568740.5579; train_gene_expr_recon_loss: 655833.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3235866.9960; train_optim_loss: 3235866.9960; val_kl_reg_loss: 11212.0950; val_edge_recon_loss: 2574943.2291; val_gene_expr_recon_loss: 660950.2154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247105.5497; val_optim_loss: 3247105.5497

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 11293.3017; train_edge_recon_loss: 2569616.3302; train_gene_expr_recon_loss: 655671.1948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236580.8257; train_optim_loss: 3236580.8257; val_kl_reg_loss: 11207.9438; val_edge_recon_loss: 2576280.7500; val_gene_expr_recon_loss: 661563.4238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3249052.1246; val_optim_loss: 3249052.1246
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9955; val_auprc_score: 0.9943; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 11293.2060; train_edge_recon_loss: 2569090.2099; train_gene_expr_recon_loss: 655717.3377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236100.7527; train_optim_loss: 3236100.7527; val_kl_reg_loss: 11207.9564; val_edge_recon_loss: 2576645.8876; val_gene_expr_recon_loss: 660171.2783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3248025.1176; val_optim_loss: 3248025.1176
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9956; val_auprc_score: 0.9944; val_best_acc_score: 0.9771; val_best_f1_score: 0.9774; train_kl_reg_loss: 11294.1581; train_edge_recon_loss: 2569051.6810; train_gene_expr_recon_loss: 655685.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236030.8942; train_optim_loss: 3236030.8942; val_kl_reg_loss: 11213.9504; val_edge_recon_loss: 2574902.7648; val_gene_expr_recon_loss: 661812.7247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3247929.4355; val_optim_loss: 3247929.4355
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9954; val_auprc_score: 0.9941; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 11291.8831; train_edge_recon_loss: 2569703.9035; train_gene_expr_recon_loss: 655639.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3236635.3133; train_optim_loss: 3236635.3133; val_kl_reg_loss: 11210.1359; val_edge_recon_loss: 2578017.4416; val_gene_expr_recon_loss: 661295.7966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3250523.3815; val_optim_loss: 3250523.3815

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 805 min 3 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9944
Val best accuracy score: 0.9771
Val best F1 score: 0.9774
Val gene expr MSE score: 1.6760

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
