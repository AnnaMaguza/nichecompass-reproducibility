None
Run timestamp: 03072023_191830_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9579; val_auprc_score: 0.9644; val_best_acc_score: 0.8913; val_best_f1_score: 0.8857; train_kl_reg_loss: 951.1007; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14983.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15935.0405; train_optim_loss: 15935.0405; val_kl_reg_loss: 798.2740; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13551.9182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14350.1922; val_optim_loss: 14350.1922
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9603; val_auprc_score: 0.9663; val_best_acc_score: 0.8946; val_best_f1_score: 0.8904; train_kl_reg_loss: 735.7262; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13566.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14301.9690; train_optim_loss: 14301.9690; val_kl_reg_loss: 673.8058; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13148.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13822.0141; val_optim_loss: 13822.0141
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9623; val_auprc_score: 0.9682; val_best_acc_score: 0.8950; val_best_f1_score: 0.8937; train_kl_reg_loss: 666.8090; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13289.7066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13956.5156; train_optim_loss: 13956.5156; val_kl_reg_loss: 637.7280; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12992.8089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13630.5369; val_optim_loss: 13630.5369
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9626; val_auprc_score: 0.9686; val_best_acc_score: 0.8985; val_best_f1_score: 0.8948; train_kl_reg_loss: 633.5003; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13174.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13808.4873; train_optim_loss: 13808.4873; val_kl_reg_loss: 617.6228; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12935.7436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13553.3664; val_optim_loss: 13553.3664
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9665; val_auprc_score: 0.9718; val_best_acc_score: 0.9021; val_best_f1_score: 0.9014; train_kl_reg_loss: 616.6764; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13111.4245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13728.1008; train_optim_loss: 13728.1008; val_kl_reg_loss: 606.4717; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12893.4864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13499.9581; val_optim_loss: 13499.9581
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9658; val_auprc_score: 0.9714; val_best_acc_score: 0.9028; val_best_f1_score: 0.9008; train_kl_reg_loss: 607.6041; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13076.1888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13683.7930; train_optim_loss: 13683.7930; val_kl_reg_loss: 610.3531; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12866.2080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13476.5611; val_optim_loss: 13476.5611
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9686; val_auprc_score: 0.9735; val_best_acc_score: 0.9076; val_best_f1_score: 0.9037; train_kl_reg_loss: 603.0930; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13050.1634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13653.2564; train_optim_loss: 13653.2564; val_kl_reg_loss: 601.6586; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12847.9612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13449.6198; val_optim_loss: 13449.6198
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9693; val_auprc_score: 0.9741; val_best_acc_score: 0.9084; val_best_f1_score: 0.9067; train_kl_reg_loss: 599.7122; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13030.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13630.5545; train_optim_loss: 13630.5545; val_kl_reg_loss: 575.4435; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12845.6972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13421.1407; val_optim_loss: 13421.1407
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9697; val_auprc_score: 0.9745; val_best_acc_score: 0.9107; val_best_f1_score: 0.9084; train_kl_reg_loss: 597.4548; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13016.3437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13613.7985; train_optim_loss: 13613.7985; val_kl_reg_loss: 591.9124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12828.8645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13420.7769; val_optim_loss: 13420.7769
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9713; val_auprc_score: 0.9758; val_best_acc_score: 0.9134; val_best_f1_score: 0.9103; train_kl_reg_loss: 595.0915; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13010.9777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13606.0692; train_optim_loss: 13606.0692; val_kl_reg_loss: 588.0124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12839.7085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13427.7209; val_optim_loss: 13427.7209
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9721; val_auprc_score: 0.9766; val_best_acc_score: 0.9143; val_best_f1_score: 0.9130; train_kl_reg_loss: 593.4993; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12998.7915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13592.2908; train_optim_loss: 13592.2908; val_kl_reg_loss: 577.3383; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12839.3305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13416.6689; val_optim_loss: 13416.6689
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9727; val_auprc_score: 0.9771; val_best_acc_score: 0.9154; val_best_f1_score: 0.9142; train_kl_reg_loss: 592.5496; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12994.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13586.8210; train_optim_loss: 13586.8210; val_kl_reg_loss: 589.9887; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12822.4242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13412.4129; val_optim_loss: 13412.4129
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9722; val_auprc_score: 0.9766; val_best_acc_score: 0.9154; val_best_f1_score: 0.9133; train_kl_reg_loss: 592.2868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12986.0499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13578.3367; train_optim_loss: 13578.3367; val_kl_reg_loss: 583.8700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12818.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13402.2535; val_optim_loss: 13402.2535
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9725; val_auprc_score: 0.9770; val_best_acc_score: 0.9165; val_best_f1_score: 0.9143; train_kl_reg_loss: 592.4241; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12981.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13574.4046; train_optim_loss: 13574.4046; val_kl_reg_loss: 582.0526; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12813.3641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13395.4167; val_optim_loss: 13395.4167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9736; val_auprc_score: 0.9778; val_best_acc_score: 0.9176; val_best_f1_score: 0.9145; train_kl_reg_loss: 592.9952; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12978.0276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13571.0228; train_optim_loss: 13571.0228; val_kl_reg_loss: 573.6950; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12818.6332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13392.3281; val_optim_loss: 13392.3281
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9728; val_auprc_score: 0.9772; val_best_acc_score: 0.9165; val_best_f1_score: 0.9135; train_kl_reg_loss: 593.5664; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12970.8985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13564.4649; train_optim_loss: 13564.4649; val_kl_reg_loss: 586.7711; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12825.2597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13412.0309; val_optim_loss: 13412.0309
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9739; val_auprc_score: 0.9780; val_best_acc_score: 0.9174; val_best_f1_score: 0.9162; train_kl_reg_loss: 594.0015; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12967.0070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13561.0086; train_optim_loss: 13561.0086; val_kl_reg_loss: 578.8685; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12833.7388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13412.6072; val_optim_loss: 13412.6072
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9735; val_auprc_score: 0.9776; val_best_acc_score: 0.9173; val_best_f1_score: 0.9159; train_kl_reg_loss: 594.6387; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12965.0908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13559.7295; train_optim_loss: 13559.7295; val_kl_reg_loss: 603.9494; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12812.3821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13416.3314; val_optim_loss: 13416.3314
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9750; val_auprc_score: 0.9789; val_best_acc_score: 0.9207; val_best_f1_score: 0.9188; train_kl_reg_loss: 595.3246; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12963.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13558.4012; train_optim_loss: 13558.4012; val_kl_reg_loss: 570.0391; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12827.9721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13398.0111; val_optim_loss: 13398.0111

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9760; val_auprc_score: 0.9799; val_best_acc_score: 0.9226; val_best_f1_score: 0.9200; train_kl_reg_loss: 593.9447; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12906.6672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13500.6119; train_optim_loss: 13500.6119; val_kl_reg_loss: 585.8857; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12802.5301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13388.4158; val_optim_loss: 13388.4158
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9753; val_auprc_score: 0.9793; val_best_acc_score: 0.9214; val_best_f1_score: 0.9188; train_kl_reg_loss: 593.6600; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12895.5530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13489.2130; train_optim_loss: 13489.2130; val_kl_reg_loss: 590.0447; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12783.6985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13373.7432; val_optim_loss: 13373.7432
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9759; val_auprc_score: 0.9797; val_best_acc_score: 0.9224; val_best_f1_score: 0.9196; train_kl_reg_loss: 594.2183; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12889.4736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13483.6918; train_optim_loss: 13483.6918; val_kl_reg_loss: 587.1882; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12782.1347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13369.3229; val_optim_loss: 13369.3229
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9755; val_auprc_score: 0.9793; val_best_acc_score: 0.9218; val_best_f1_score: 0.9191; train_kl_reg_loss: 594.6432; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12886.3751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13481.0183; train_optim_loss: 13481.0183; val_kl_reg_loss: 594.1371; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12779.2300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13373.3671; val_optim_loss: 13373.3671
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9759; val_auprc_score: 0.9797; val_best_acc_score: 0.9223; val_best_f1_score: 0.9205; train_kl_reg_loss: 595.0191; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12887.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13482.1155; train_optim_loss: 13482.1155; val_kl_reg_loss: 589.7802; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12763.0795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13352.8597; val_optim_loss: 13352.8597
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9759; val_auprc_score: 0.9798; val_best_acc_score: 0.9225; val_best_f1_score: 0.9203; train_kl_reg_loss: 595.1155; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12882.4294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13477.5450; train_optim_loss: 13477.5450; val_kl_reg_loss: 587.7653; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12779.4040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13367.1693; val_optim_loss: 13367.1693
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9755; val_auprc_score: 0.9794; val_best_acc_score: 0.9217; val_best_f1_score: 0.9189; train_kl_reg_loss: 595.2679; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12885.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13481.2425; train_optim_loss: 13481.2425; val_kl_reg_loss: 592.5700; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12782.0912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13374.6612; val_optim_loss: 13374.6612
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9760; val_auprc_score: 0.9797; val_best_acc_score: 0.9220; val_best_f1_score: 0.9204; train_kl_reg_loss: 595.4471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12882.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13477.4810; train_optim_loss: 13477.4810; val_kl_reg_loss: 592.0238; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12773.7563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13365.7802; val_optim_loss: 13365.7802
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9757; val_auprc_score: 0.9795; val_best_acc_score: 0.9215; val_best_f1_score: 0.9197; train_kl_reg_loss: 595.8124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12886.2642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13482.0766; train_optim_loss: 13482.0766; val_kl_reg_loss: 591.6554; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12787.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13379.5392; val_optim_loss: 13379.5392

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9761; val_auprc_score: 0.9799; val_best_acc_score: 0.9222; val_best_f1_score: 0.9211; train_kl_reg_loss: 596.2003; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12872.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13468.7142; train_optim_loss: 13468.7142; val_kl_reg_loss: 590.9813; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12784.9485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13375.9298; val_optim_loss: 13375.9298
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9761; val_auprc_score: 0.9799; val_best_acc_score: 0.9222; val_best_f1_score: 0.9210; train_kl_reg_loss: 596.0363; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12872.2877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13468.3240; train_optim_loss: 13468.3240; val_kl_reg_loss: 591.3973; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12776.4661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13367.8633; val_optim_loss: 13367.8633
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9761; val_auprc_score: 0.9799; val_best_acc_score: 0.9222; val_best_f1_score: 0.9211; train_kl_reg_loss: 595.8374; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12871.0088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13466.8462; train_optim_loss: 13466.8462; val_kl_reg_loss: 591.3456; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12789.6456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13380.9912; val_optim_loss: 13380.9912
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9761; val_auprc_score: 0.9798; val_best_acc_score: 0.9217; val_best_f1_score: 0.9207; train_kl_reg_loss: 595.9197; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12870.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13466.1864; train_optim_loss: 13466.1864; val_kl_reg_loss: 591.0101; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12772.1689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13363.1790; val_optim_loss: 13363.1790

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 357 min 37 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9758
Val AUPRC score: 0.9796
Val best accuracy score: 0.9220
Val best F1 score: 0.9199
Val gene expr MSE score: 8.5173

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
