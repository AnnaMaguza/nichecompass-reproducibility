None
Run timestamp: 06072023_192140_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9557; val_auprc_score: 0.9622; val_best_acc_score: 0.8862; val_best_f1_score: 0.8836; train_kl_reg_loss: 853.7087; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14390.5270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15244.2357; train_optim_loss: 15244.2357; val_kl_reg_loss: 625.6117; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13297.0914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13922.7031; val_optim_loss: 13922.7031
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9581; val_auprc_score: 0.9643; val_best_acc_score: 0.8870; val_best_f1_score: 0.8861; train_kl_reg_loss: 653.2715; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13328.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13982.0397; train_optim_loss: 13982.0397; val_kl_reg_loss: 609.8974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13002.1684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13612.0658; val_optim_loss: 13612.0658
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9630; val_auprc_score: 0.9689; val_best_acc_score: 0.8991; val_best_f1_score: 0.8944; train_kl_reg_loss: 611.2643; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13179.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13790.5383; train_optim_loss: 13790.5383; val_kl_reg_loss: 576.5265; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12946.0244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13522.5508; val_optim_loss: 13522.5508
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9655; val_auprc_score: 0.9709; val_best_acc_score: 0.9027; val_best_f1_score: 0.9005; train_kl_reg_loss: 596.8701; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13115.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13712.3003; train_optim_loss: 13712.3003; val_kl_reg_loss: 594.2014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12885.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13479.3154; val_optim_loss: 13479.3154
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9681; val_auprc_score: 0.9730; val_best_acc_score: 0.9075; val_best_f1_score: 0.9038; train_kl_reg_loss: 592.2940; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13081.9433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13674.2373; train_optim_loss: 13674.2373; val_kl_reg_loss: 583.8845; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12831.9094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13415.7939; val_optim_loss: 13415.7939
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9682; val_auprc_score: 0.9733; val_best_acc_score: 0.9067; val_best_f1_score: 0.9054; train_kl_reg_loss: 590.3112; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13041.6280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13631.9392; train_optim_loss: 13631.9392; val_kl_reg_loss: 579.1802; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12951.4026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13530.5829; val_optim_loss: 13530.5829
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9686; val_auprc_score: 0.9735; val_best_acc_score: 0.9082; val_best_f1_score: 0.9052; train_kl_reg_loss: 588.2237; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12989.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13577.8621; train_optim_loss: 13577.8621; val_kl_reg_loss: 576.5911; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12949.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13526.3857; val_optim_loss: 13526.3857
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9686; val_auprc_score: 0.9735; val_best_acc_score: 0.9071; val_best_f1_score: 0.9046; train_kl_reg_loss: 587.7502; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12534.1861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13121.9363; train_optim_loss: 13121.9363; val_kl_reg_loss: 580.7954; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13316.6370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13897.4324; val_optim_loss: 13897.4324
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9745; val_best_acc_score: 0.9086; val_best_f1_score: 0.9076; train_kl_reg_loss: 587.9656; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11682.9836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12270.9492; train_optim_loss: 12270.9492; val_kl_reg_loss: 578.9220; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11382.1028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11961.0248; val_optim_loss: 11961.0248
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9716; val_auprc_score: 0.9760; val_best_acc_score: 0.9126; val_best_f1_score: 0.9110; train_kl_reg_loss: 587.9427; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11153.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11741.6219; train_optim_loss: 11741.6219; val_kl_reg_loss: 577.8780; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11036.5446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11614.4226; val_optim_loss: 11614.4226
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9703; val_auprc_score: 0.9748; val_best_acc_score: 0.9108; val_best_f1_score: 0.9082; train_kl_reg_loss: 587.7424; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11065.1647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11652.9071; train_optim_loss: 11652.9071; val_kl_reg_loss: 566.2609; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10980.4990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11546.7600; val_optim_loss: 11546.7600
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9693; val_auprc_score: 0.9742; val_best_acc_score: 0.9090; val_best_f1_score: 0.9069; train_kl_reg_loss: 587.5881; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11001.6438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11589.2319; train_optim_loss: 11589.2319; val_kl_reg_loss: 585.7628; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10841.8635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11427.6263; val_optim_loss: 11427.6263
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9716; val_auprc_score: 0.9758; val_best_acc_score: 0.9131; val_best_f1_score: 0.9105; train_kl_reg_loss: 586.1438; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10988.5994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11574.7433; train_optim_loss: 11574.7433; val_kl_reg_loss: 586.6544; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10989.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11576.3593; val_optim_loss: 11576.3593
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9709; val_auprc_score: 0.9755; val_best_acc_score: 0.9130; val_best_f1_score: 0.9105; train_kl_reg_loss: 586.0728; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10966.4725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11552.5453; train_optim_loss: 11552.5453; val_kl_reg_loss: 590.2803; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10855.2256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11445.5059; val_optim_loss: 11445.5059
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9725; val_auprc_score: 0.9766; val_best_acc_score: 0.9145; val_best_f1_score: 0.9123; train_kl_reg_loss: 586.3580; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10962.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11549.0238; train_optim_loss: 11549.0238; val_kl_reg_loss: 583.2793; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10834.6945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11417.9738; val_optim_loss: 11417.9738
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9709; val_auprc_score: 0.9754; val_best_acc_score: 0.9119; val_best_f1_score: 0.9086; train_kl_reg_loss: 586.6717; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10953.2546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11539.9263; train_optim_loss: 11539.9263; val_kl_reg_loss: 577.2639; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10856.7475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11434.0114; val_optim_loss: 11434.0114
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9720; val_auprc_score: 0.9763; val_best_acc_score: 0.9126; val_best_f1_score: 0.9115; train_kl_reg_loss: 586.5069; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10952.7123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11539.2192; train_optim_loss: 11539.2192; val_kl_reg_loss: 575.0478; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10855.7230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11430.7707; val_optim_loss: 11430.7707
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9722; val_auprc_score: 0.9765; val_best_acc_score: 0.9136; val_best_f1_score: 0.9114; train_kl_reg_loss: 586.2485; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10948.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11534.5067; train_optim_loss: 11534.5067; val_kl_reg_loss: 591.9179; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10860.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11452.8126; val_optim_loss: 11452.8126
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9720; val_auprc_score: 0.9763; val_best_acc_score: 0.9132; val_best_f1_score: 0.9118; train_kl_reg_loss: 586.2853; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10950.5916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11536.8769; train_optim_loss: 11536.8769; val_kl_reg_loss: 577.9655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10862.0392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11440.0047; val_optim_loss: 11440.0047

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9747; val_auprc_score: 0.9787; val_best_acc_score: 0.9198; val_best_f1_score: 0.9170; train_kl_reg_loss: 584.9989; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10871.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11456.5759; train_optim_loss: 11456.5759; val_kl_reg_loss: 583.6798; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10820.7581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11404.4379; val_optim_loss: 11404.4379
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9751; val_auprc_score: 0.9789; val_best_acc_score: 0.9203; val_best_f1_score: 0.9186; train_kl_reg_loss: 584.7519; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10859.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11444.5287; train_optim_loss: 11444.5287; val_kl_reg_loss: 583.2416; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10802.9506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11386.1921; val_optim_loss: 11386.1921
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9750; val_auprc_score: 0.9788; val_best_acc_score: 0.9201; val_best_f1_score: 0.9184; train_kl_reg_loss: 585.2470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10857.2992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11442.5461; train_optim_loss: 11442.5461; val_kl_reg_loss: 579.8474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10827.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11407.7158; val_optim_loss: 11407.7158
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9750; val_auprc_score: 0.9789; val_best_acc_score: 0.9198; val_best_f1_score: 0.9179; train_kl_reg_loss: 585.5778; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10850.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11436.4045; train_optim_loss: 11436.4045; val_kl_reg_loss: 579.1105; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10806.5388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11385.6494; val_optim_loss: 11385.6494
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9750; val_auprc_score: 0.9789; val_best_acc_score: 0.9202; val_best_f1_score: 0.9180; train_kl_reg_loss: 585.9853; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10849.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11435.2613; train_optim_loss: 11435.2613; val_kl_reg_loss: 584.3036; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10792.2647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11376.5683; val_optim_loss: 11376.5683
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9751; val_auprc_score: 0.9790; val_best_acc_score: 0.9198; val_best_f1_score: 0.9185; train_kl_reg_loss: 586.1909; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10850.6660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11436.8569; train_optim_loss: 11436.8569; val_kl_reg_loss: 580.5202; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10798.3405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11378.8607; val_optim_loss: 11378.8607
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9746; val_auprc_score: 0.9787; val_best_acc_score: 0.9192; val_best_f1_score: 0.9175; train_kl_reg_loss: 586.4626; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10847.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11433.7271; train_optim_loss: 11433.7271; val_kl_reg_loss: 584.8721; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10810.5372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11395.4093; val_optim_loss: 11395.4093
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9761; val_auprc_score: 0.9798; val_best_acc_score: 0.9220; val_best_f1_score: 0.9210; train_kl_reg_loss: 586.6263; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10848.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11435.1219; train_optim_loss: 11435.1219; val_kl_reg_loss: 578.7189; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10802.3192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11381.0381; val_optim_loss: 11381.0381
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9755; val_auprc_score: 0.9794; val_best_acc_score: 0.9211; val_best_f1_score: 0.9200; train_kl_reg_loss: 587.0783; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10845.7619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11432.8402; train_optim_loss: 11432.8402; val_kl_reg_loss: 584.9378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10804.7771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11389.7149; val_optim_loss: 11389.7149

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9753; val_auprc_score: 0.9792; val_best_acc_score: 0.9202; val_best_f1_score: 0.9192; train_kl_reg_loss: 587.4593; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10825.0869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11412.5462; train_optim_loss: 11412.5462; val_kl_reg_loss: 582.5236; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10781.0818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11363.6054; val_optim_loss: 11363.6054
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9755; val_auprc_score: 0.9794; val_best_acc_score: 0.9206; val_best_f1_score: 0.9196; train_kl_reg_loss: 587.3476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10820.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11407.7233; train_optim_loss: 11407.7233; val_kl_reg_loss: 583.3790; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10784.9413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11368.3203; val_optim_loss: 11368.3203
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9757; val_auprc_score: 0.9796; val_best_acc_score: 0.9215; val_best_f1_score: 0.9204; train_kl_reg_loss: 587.3354; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10833.2492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11420.5846; train_optim_loss: 11420.5846; val_kl_reg_loss: 582.9896; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10811.8051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11394.7947; val_optim_loss: 11394.7947
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9757; val_auprc_score: 0.9794; val_best_acc_score: 0.9216; val_best_f1_score: 0.9205; train_kl_reg_loss: 587.5165; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10838.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11426.2646; train_optim_loss: 11426.2646; val_kl_reg_loss: 583.5418; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10781.3037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11364.8455; val_optim_loss: 11364.8455
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9757; val_auprc_score: 0.9795; val_best_acc_score: 0.9215; val_best_f1_score: 0.9205; train_kl_reg_loss: 587.4470; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10841.5247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11428.9717; train_optim_loss: 11428.9717; val_kl_reg_loss: 583.4014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10802.0281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11385.4295; val_optim_loss: 11385.4295

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9756; val_auprc_score: 0.9795; val_best_acc_score: 0.9211; val_best_f1_score: 0.9201; train_kl_reg_loss: 587.3968; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10836.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11423.4571; train_optim_loss: 11423.4571; val_kl_reg_loss: 583.4387; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10804.9214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11388.3602; val_optim_loss: 11388.3602
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9756; val_auprc_score: 0.9793; val_best_acc_score: 0.9215; val_best_f1_score: 0.9204; train_kl_reg_loss: 587.3517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10837.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11424.4666; train_optim_loss: 11424.4666; val_kl_reg_loss: 583.5793; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10815.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11399.2824; val_optim_loss: 11399.2824
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9758; val_auprc_score: 0.9797; val_best_acc_score: 0.9215; val_best_f1_score: 0.9205; train_kl_reg_loss: 587.4064; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10835.1442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11422.5506; train_optim_loss: 11422.5506; val_kl_reg_loss: 583.7759; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10809.4981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11393.2741; val_optim_loss: 11393.2741
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9755; val_auprc_score: 0.9794; val_best_acc_score: 0.9208; val_best_f1_score: 0.9198; train_kl_reg_loss: 587.3373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10839.0476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11426.3849; train_optim_loss: 11426.3849; val_kl_reg_loss: 583.6996; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10804.6249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11388.3245; val_optim_loss: 11388.3245

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 633 min 41 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9753
Val AUPRC score: 0.9792
Val best accuracy score: 0.9207
Val best F1 score: 0.9197
Val gene expr MSE score: 8.4957

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
