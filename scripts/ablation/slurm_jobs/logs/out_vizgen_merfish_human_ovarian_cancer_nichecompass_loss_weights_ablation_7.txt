None
Run timestamp: 05072023_210741_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9575; val_auprc_score: 0.9637; val_best_acc_score: 0.8853; val_best_f1_score: 0.8839; train_kl_reg_loss: 841.8868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14185.5615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15027.4483; train_optim_loss: 15027.4483; val_kl_reg_loss: 760.8110; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13062.9756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13823.7866; val_optim_loss: 13823.7866
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9621; val_auprc_score: 0.9677; val_best_acc_score: 0.8939; val_best_f1_score: 0.8929; train_kl_reg_loss: 665.7596; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13167.8087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13833.5683; train_optim_loss: 13833.5683; val_kl_reg_loss: 636.6928; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12873.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13510.5453; val_optim_loss: 13510.5453
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9647; val_auprc_score: 0.9699; val_best_acc_score: 0.8989; val_best_f1_score: 0.8957; train_kl_reg_loss: 624.3748; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13026.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13651.2775; train_optim_loss: 13651.2775; val_kl_reg_loss: 604.6710; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12790.3989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13395.0699; val_optim_loss: 13395.0699
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9662; val_auprc_score: 0.9714; val_best_acc_score: 0.9031; val_best_f1_score: 0.9012; train_kl_reg_loss: 610.0181; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12968.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13578.1553; train_optim_loss: 13578.1553; val_kl_reg_loss: 610.4666; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12747.9655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13358.4321; val_optim_loss: 13358.4321
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9674; val_auprc_score: 0.9722; val_best_acc_score: 0.9039; val_best_f1_score: 0.9017; train_kl_reg_loss: 604.4699; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12932.9204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13537.3903; train_optim_loss: 13537.3903; val_kl_reg_loss: 591.7155; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12716.6520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13308.3675; val_optim_loss: 13308.3675
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9680; val_auprc_score: 0.9729; val_best_acc_score: 0.9055; val_best_f1_score: 0.9043; train_kl_reg_loss: 602.6094; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12895.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13498.2605; train_optim_loss: 13498.2605; val_kl_reg_loss: 603.0287; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12521.9642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13124.9928; val_optim_loss: 13124.9928
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9697; val_auprc_score: 0.9742; val_best_acc_score: 0.9098; val_best_f1_score: 0.9069; train_kl_reg_loss: 601.0945; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12808.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13409.3445; train_optim_loss: 13409.3445; val_kl_reg_loss: 599.6087; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11812.7554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12412.3641; val_optim_loss: 12412.3641
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9711; val_auprc_score: 0.9755; val_best_acc_score: 0.9123; val_best_f1_score: 0.9088; train_kl_reg_loss: 600.6092; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12428.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13029.3695; train_optim_loss: 13029.3695; val_kl_reg_loss: 606.3752; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13092.3999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13698.7750; val_optim_loss: 13698.7750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9716; val_auprc_score: 0.9759; val_best_acc_score: 0.9122; val_best_f1_score: 0.9104; train_kl_reg_loss: 600.3897; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11600.5171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12200.9068; train_optim_loss: 12200.9068; val_kl_reg_loss: 592.8638; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11504.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12097.3508; val_optim_loss: 12097.3508
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9717; val_auprc_score: 0.9759; val_best_acc_score: 0.9124; val_best_f1_score: 0.9101; train_kl_reg_loss: 599.2839; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 11046.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11645.4032; train_optim_loss: 11645.4032; val_kl_reg_loss: 581.0514; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10824.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11405.5727; val_optim_loss: 11405.5727
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9720; val_auprc_score: 0.9762; val_best_acc_score: 0.9138; val_best_f1_score: 0.9114; train_kl_reg_loss: 598.5844; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10912.7145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11511.2990; train_optim_loss: 11511.2990; val_kl_reg_loss: 587.1148; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10853.3793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11440.4941; val_optim_loss: 11440.4941
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9731; val_auprc_score: 0.9771; val_best_acc_score: 0.9155; val_best_f1_score: 0.9124; train_kl_reg_loss: 597.3829; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10891.3103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11488.6932; train_optim_loss: 11488.6932; val_kl_reg_loss: 569.8980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10963.3351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11533.2331; val_optim_loss: 11533.2331
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9721; val_auprc_score: 0.9761; val_best_acc_score: 0.9133; val_best_f1_score: 0.9111; train_kl_reg_loss: 596.1296; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10845.7641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11441.8937; train_optim_loss: 11441.8937; val_kl_reg_loss: 595.6788; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10694.7633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11290.4421; val_optim_loss: 11290.4421
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9706; val_auprc_score: 0.9752; val_best_acc_score: 0.9103; val_best_f1_score: 0.9090; train_kl_reg_loss: 595.6129; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10817.6253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11413.2382; train_optim_loss: 11413.2382; val_kl_reg_loss: 581.3787; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10706.7103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11288.0890; val_optim_loss: 11288.0890
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9722; val_auprc_score: 0.9765; val_best_acc_score: 0.9131; val_best_f1_score: 0.9119; train_kl_reg_loss: 595.8185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10813.0405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11408.8589; train_optim_loss: 11408.8589; val_kl_reg_loss: 579.1608; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10717.5655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11296.7263; val_optim_loss: 11296.7263
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9723; val_auprc_score: 0.9764; val_best_acc_score: 0.9130; val_best_f1_score: 0.9117; train_kl_reg_loss: 595.8690; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10807.4205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11403.2895; train_optim_loss: 11403.2895; val_kl_reg_loss: 587.8721; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10701.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11289.7979; val_optim_loss: 11289.7979
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9725; val_auprc_score: 0.9766; val_best_acc_score: 0.9133; val_best_f1_score: 0.9122; train_kl_reg_loss: 596.2872; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10806.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11402.6604; train_optim_loss: 11402.6604; val_kl_reg_loss: 589.7165; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10730.1889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11319.9054; val_optim_loss: 11319.9054
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9740; val_auprc_score: 0.9778; val_best_acc_score: 0.9176; val_best_f1_score: 0.9161; train_kl_reg_loss: 596.9760; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10804.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11401.7092; train_optim_loss: 11401.7092; val_kl_reg_loss: 589.0788; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10714.4675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11303.5463; val_optim_loss: 11303.5463

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9756; val_auprc_score: 0.9793; val_best_acc_score: 0.9203; val_best_f1_score: 0.9189; train_kl_reg_loss: 596.5828; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10744.0240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11340.6068; train_optim_loss: 11340.6068; val_kl_reg_loss: 586.2938; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10685.5577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11271.8515; val_optim_loss: 11271.8515
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9762; val_auprc_score: 0.9799; val_best_acc_score: 0.9214; val_best_f1_score: 0.9199; train_kl_reg_loss: 597.3868; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10742.0597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11339.4465; train_optim_loss: 11339.4465; val_kl_reg_loss: 594.8578; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10676.8076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11271.6654; val_optim_loss: 11271.6654
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9764; val_auprc_score: 0.9799; val_best_acc_score: 0.9216; val_best_f1_score: 0.9206; train_kl_reg_loss: 598.1102; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10738.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11336.8451; train_optim_loss: 11336.8451; val_kl_reg_loss: 591.9182; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10669.6630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11261.5812; val_optim_loss: 11261.5812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9768; val_auprc_score: 0.9803; val_best_acc_score: 0.9228; val_best_f1_score: 0.9217; train_kl_reg_loss: 598.8832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10740.5543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11339.4375; train_optim_loss: 11339.4375; val_kl_reg_loss: 594.7188; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10644.9262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11239.6450; val_optim_loss: 11239.6450
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9765; val_auprc_score: 0.9801; val_best_acc_score: 0.9225; val_best_f1_score: 0.9214; train_kl_reg_loss: 599.0266; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10732.6939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11331.7205; train_optim_loss: 11331.7205; val_kl_reg_loss: 594.3025; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10670.0867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11264.3892; val_optim_loss: 11264.3892
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9802; val_best_acc_score: 0.9225; val_best_f1_score: 0.9216; train_kl_reg_loss: 599.4199; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10729.7922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11329.2121; train_optim_loss: 11329.2121; val_kl_reg_loss: 596.8760; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10659.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11256.2814; val_optim_loss: 11256.2814
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9764; val_auprc_score: 0.9800; val_best_acc_score: 0.9219; val_best_f1_score: 0.9209; train_kl_reg_loss: 599.8539; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10723.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11322.9935; train_optim_loss: 11322.9935; val_kl_reg_loss: 597.7312; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10698.4159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11296.1471; val_optim_loss: 11296.1471
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9767; val_auprc_score: 0.9803; val_best_acc_score: 0.9227; val_best_f1_score: 0.9215; train_kl_reg_loss: 599.9988; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10726.4690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11326.4678; train_optim_loss: 11326.4678; val_kl_reg_loss: 596.7766; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10673.9833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11270.7598; val_optim_loss: 11270.7598

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9770; val_auprc_score: 0.9805; val_best_acc_score: 0.9239; val_best_f1_score: 0.9226; train_kl_reg_loss: 600.9202; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10724.2455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11325.1658; train_optim_loss: 11325.1658; val_kl_reg_loss: 596.9503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10685.6905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11282.6407; val_optim_loss: 11282.6407
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9769; val_auprc_score: 0.9804; val_best_acc_score: 0.9232; val_best_f1_score: 0.9218; train_kl_reg_loss: 600.5517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10723.1917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11323.7433; train_optim_loss: 11323.7433; val_kl_reg_loss: 596.0807; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10671.9951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11268.0758; val_optim_loss: 11268.0758
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9769; val_auprc_score: 0.9805; val_best_acc_score: 0.9235; val_best_f1_score: 0.9221; train_kl_reg_loss: 600.3972; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10723.6838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11324.0809; train_optim_loss: 11324.0809; val_kl_reg_loss: 596.0412; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10673.6233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11269.6645; val_optim_loss: 11269.6645
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9773; val_auprc_score: 0.9808; val_best_acc_score: 0.9246; val_best_f1_score: 0.9231; train_kl_reg_loss: 600.5565; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 10720.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11321.5210; train_optim_loss: 11321.5210; val_kl_reg_loss: 595.7080; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 10684.6326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11280.3407; val_optim_loss: 11280.3407

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 397 min 22 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9770
Val AUPRC score: 0.9806
Val best accuracy score: 0.9232
Val best F1 score: 0.9221
Val gene expr MSE score: 8.5095

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
