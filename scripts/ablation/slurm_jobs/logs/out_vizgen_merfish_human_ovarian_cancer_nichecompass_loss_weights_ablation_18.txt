None
Run timestamp: 30062023_215512_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9868; val_auprc_score: 0.9868; val_best_acc_score: 0.9412; val_best_f1_score: 0.9413; train_kl_reg_loss: 2410.4898; train_edge_recon_loss: 28582.1544; train_gene_expr_recon_loss: 16124.5492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47117.1934; train_optim_loss: 47117.1934; val_kl_reg_loss: 2546.4678; val_edge_recon_loss: 27142.8317; val_gene_expr_recon_loss: 14394.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44083.3657; val_optim_loss: 44083.3657
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9914; val_auprc_score: 0.9913; val_best_acc_score: 0.9539; val_best_f1_score: 0.9539; train_kl_reg_loss: 2578.1547; train_edge_recon_loss: 27786.7847; train_gene_expr_recon_loss: 14139.7028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44504.6420; train_optim_loss: 44504.6420; val_kl_reg_loss: 2537.6739; val_edge_recon_loss: 26864.7162; val_gene_expr_recon_loss: 13665.9243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43068.3142; val_optim_loss: 43068.3142
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9932; val_auprc_score: 0.9931; val_best_acc_score: 0.9592; val_best_f1_score: 0.9591; train_kl_reg_loss: 2613.7508; train_edge_recon_loss: 27604.8157; train_gene_expr_recon_loss: 13658.1573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43876.7237; train_optim_loss: 43876.7237; val_kl_reg_loss: 2578.0896; val_edge_recon_loss: 26727.9692; val_gene_expr_recon_loss: 13368.1717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42674.2305; val_optim_loss: 42674.2305
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9939; val_best_acc_score: 0.9632; val_best_f1_score: 0.9632; train_kl_reg_loss: 2640.3762; train_edge_recon_loss: 27500.2655; train_gene_expr_recon_loss: 13402.3334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43542.9753; train_optim_loss: 43542.9753; val_kl_reg_loss: 2606.7258; val_edge_recon_loss: 26638.4273; val_gene_expr_recon_loss: 13163.9680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42409.1212; val_optim_loss: 42409.1212
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9943; val_auprc_score: 0.9943; val_best_acc_score: 0.9634; val_best_f1_score: 0.9633; train_kl_reg_loss: 2659.1676; train_edge_recon_loss: 27424.7877; train_gene_expr_recon_loss: 13244.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43328.7849; train_optim_loss: 43328.7849; val_kl_reg_loss: 2639.4295; val_edge_recon_loss: 26572.4375; val_gene_expr_recon_loss: 13051.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42263.1053; val_optim_loss: 42263.1053
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9951; val_auprc_score: 0.9947; val_best_acc_score: 0.9669; val_best_f1_score: 0.9669; train_kl_reg_loss: 2674.4307; train_edge_recon_loss: 27369.1103; train_gene_expr_recon_loss: 13143.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43186.9339; train_optim_loss: 43186.9339; val_kl_reg_loss: 2585.7181; val_edge_recon_loss: 26515.1466; val_gene_expr_recon_loss: 12981.0299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42081.8943; val_optim_loss: 42081.8943
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9955; val_auprc_score: 0.9952; val_best_acc_score: 0.9678; val_best_f1_score: 0.9679; train_kl_reg_loss: 2685.0022; train_edge_recon_loss: 27329.5887; train_gene_expr_recon_loss: 13071.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43085.7265; train_optim_loss: 43085.7265; val_kl_reg_loss: 2591.7767; val_edge_recon_loss: 26461.4238; val_gene_expr_recon_loss: 12934.6561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41987.8566; val_optim_loss: 41987.8566
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9955; val_auprc_score: 0.9953; val_best_acc_score: 0.9676; val_best_f1_score: 0.9676; train_kl_reg_loss: 2693.5477; train_edge_recon_loss: 27302.6569; train_gene_expr_recon_loss: 13015.7621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43011.9667; train_optim_loss: 43011.9667; val_kl_reg_loss: 2749.3490; val_edge_recon_loss: 26461.9668; val_gene_expr_recon_loss: 12870.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42081.7900; val_optim_loss: 42081.7900
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 2701.2079; train_edge_recon_loss: 27275.5463; train_gene_expr_recon_loss: 12978.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42954.8028; train_optim_loss: 42954.8028; val_kl_reg_loss: 2712.2634; val_edge_recon_loss: 26411.3781; val_gene_expr_recon_loss: 12842.2110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41965.8527; val_optim_loss: 41965.8527
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9960; val_auprc_score: 0.9958; val_best_acc_score: 0.9704; val_best_f1_score: 0.9706; train_kl_reg_loss: 2706.5366; train_edge_recon_loss: 27258.8032; train_gene_expr_recon_loss: 12939.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42905.0221; train_optim_loss: 42905.0221; val_kl_reg_loss: 2629.4059; val_edge_recon_loss: 26396.5577; val_gene_expr_recon_loss: 12814.4986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41840.4621; val_optim_loss: 41840.4621
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9714; val_best_f1_score: 0.9714; train_kl_reg_loss: 2714.4295; train_edge_recon_loss: 27229.1191; train_gene_expr_recon_loss: 12916.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42859.9297; train_optim_loss: 42859.9297; val_kl_reg_loss: 2739.6478; val_edge_recon_loss: 26410.5489; val_gene_expr_recon_loss: 12779.6640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41929.8607; val_optim_loss: 41929.8607
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9705; val_best_f1_score: 0.9704; train_kl_reg_loss: 2718.9898; train_edge_recon_loss: 27220.7293; train_gene_expr_recon_loss: 12897.6599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42837.3792; train_optim_loss: 42837.3792; val_kl_reg_loss: 2705.0770; val_edge_recon_loss: 26368.0232; val_gene_expr_recon_loss: 12769.2775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41842.3775; val_optim_loss: 41842.3775
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9706; val_best_f1_score: 0.9707; train_kl_reg_loss: 2723.6857; train_edge_recon_loss: 27208.7025; train_gene_expr_recon_loss: 12876.3324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42808.7205; train_optim_loss: 42808.7205; val_kl_reg_loss: 2709.5968; val_edge_recon_loss: 26360.3497; val_gene_expr_recon_loss: 12766.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41836.3630; val_optim_loss: 41836.3630
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9708; val_best_f1_score: 0.9708; train_kl_reg_loss: 2729.7459; train_edge_recon_loss: 27191.3746; train_gene_expr_recon_loss: 12859.0479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42780.1684; train_optim_loss: 42780.1684; val_kl_reg_loss: 2657.2886; val_edge_recon_loss: 26336.5548; val_gene_expr_recon_loss: 12739.8121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41733.6556; val_optim_loss: 41733.6556
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9720; val_best_f1_score: 0.9720; train_kl_reg_loss: 2732.9343; train_edge_recon_loss: 27182.9952; train_gene_expr_recon_loss: 12849.3133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42765.2429; train_optim_loss: 42765.2429; val_kl_reg_loss: 2686.7992; val_edge_recon_loss: 26350.1121; val_gene_expr_recon_loss: 12745.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41781.9606; val_optim_loss: 41781.9606
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9962; val_best_acc_score: 0.9713; val_best_f1_score: 0.9714; train_kl_reg_loss: 2734.4790; train_edge_recon_loss: 27180.2779; train_gene_expr_recon_loss: 12838.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42753.2137; train_optim_loss: 42753.2137; val_kl_reg_loss: 2680.1909; val_edge_recon_loss: 26343.8951; val_gene_expr_recon_loss: 12728.4599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41752.5460; val_optim_loss: 41752.5460
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9723; val_best_f1_score: 0.9722; train_kl_reg_loss: 2738.2008; train_edge_recon_loss: 27169.2907; train_gene_expr_recon_loss: 12828.5447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42736.0362; train_optim_loss: 42736.0362; val_kl_reg_loss: 2784.6039; val_edge_recon_loss: 26313.2488; val_gene_expr_recon_loss: 12716.7589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41814.6114; val_optim_loss: 41814.6114
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 2739.5073; train_edge_recon_loss: 27167.5932; train_gene_expr_recon_loss: 12820.4195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42727.5199; train_optim_loss: 42727.5199; val_kl_reg_loss: 2686.7357; val_edge_recon_loss: 26287.5155; val_gene_expr_recon_loss: 12718.0474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41692.2987; val_optim_loss: 41692.2987
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 2742.0471; train_edge_recon_loss: 27165.3357; train_gene_expr_recon_loss: 12811.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42718.6665; train_optim_loss: 42718.6665; val_kl_reg_loss: 2726.9271; val_edge_recon_loss: 26299.2443; val_gene_expr_recon_loss: 12702.1188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41728.2903; val_optim_loss: 41728.2903
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 2743.7111; train_edge_recon_loss: 27158.6420; train_gene_expr_recon_loss: 12805.6624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42708.0156; train_optim_loss: 42708.0156; val_kl_reg_loss: 2689.9579; val_edge_recon_loss: 26298.8433; val_gene_expr_recon_loss: 12707.1173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41695.9182; val_optim_loss: 41695.9182
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9736; val_best_f1_score: 0.9736; train_kl_reg_loss: 2747.7493; train_edge_recon_loss: 27142.4429; train_gene_expr_recon_loss: 12796.4677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42686.6599; train_optim_loss: 42686.6599; val_kl_reg_loss: 2744.1315; val_edge_recon_loss: 26299.0982; val_gene_expr_recon_loss: 12681.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41724.6751; val_optim_loss: 41724.6751
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9721; val_best_f1_score: 0.9721; train_kl_reg_loss: 2748.6706; train_edge_recon_loss: 27141.8265; train_gene_expr_recon_loss: 12798.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42688.6696; train_optim_loss: 42688.6696; val_kl_reg_loss: 2730.8476; val_edge_recon_loss: 26272.2123; val_gene_expr_recon_loss: 12703.4190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41706.4788; val_optim_loss: 41706.4788

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9749; val_best_f1_score: 0.9750; train_kl_reg_loss: 2749.3746; train_edge_recon_loss: 27109.9988; train_gene_expr_recon_loss: 12735.2890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42594.6624; train_optim_loss: 42594.6624; val_kl_reg_loss: 2714.2680; val_edge_recon_loss: 26264.5045; val_gene_expr_recon_loss: 12633.5183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41612.2909; val_optim_loss: 41612.2909
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 2747.8012; train_edge_recon_loss: 27104.2509; train_gene_expr_recon_loss: 12727.7931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42579.8452; train_optim_loss: 42579.8452; val_kl_reg_loss: 2711.1081; val_edge_recon_loss: 26266.6210; val_gene_expr_recon_loss: 12635.1611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41612.8906; val_optim_loss: 41612.8906
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 2745.2801; train_edge_recon_loss: 27110.0535; train_gene_expr_recon_loss: 12717.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42572.4890; train_optim_loss: 42572.4890; val_kl_reg_loss: 2706.9851; val_edge_recon_loss: 26257.5682; val_gene_expr_recon_loss: 12632.4482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41597.0018; val_optim_loss: 41597.0018
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 2745.8597; train_edge_recon_loss: 27105.9312; train_gene_expr_recon_loss: 12716.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42567.9860; train_optim_loss: 42567.9860; val_kl_reg_loss: 2707.3311; val_edge_recon_loss: 26237.4896; val_gene_expr_recon_loss: 12628.2155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41573.0365; val_optim_loss: 41573.0365
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 2745.1757; train_edge_recon_loss: 27110.1410; train_gene_expr_recon_loss: 12713.0284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42568.3450; train_optim_loss: 42568.3450; val_kl_reg_loss: 2712.3236; val_edge_recon_loss: 26259.1716; val_gene_expr_recon_loss: 12623.9284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41595.4235; val_optim_loss: 41595.4235
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 2745.3273; train_edge_recon_loss: 27107.5376; train_gene_expr_recon_loss: 12710.9450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42563.8100; train_optim_loss: 42563.8100; val_kl_reg_loss: 2709.5410; val_edge_recon_loss: 26253.3703; val_gene_expr_recon_loss: 12619.5212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41582.4326; val_optim_loss: 41582.4326
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 2746.6190; train_edge_recon_loss: 27099.1002; train_gene_expr_recon_loss: 12709.9385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42555.6576; train_optim_loss: 42555.6576; val_kl_reg_loss: 2721.3236; val_edge_recon_loss: 26255.1775; val_gene_expr_recon_loss: 12622.3999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41598.9011; val_optim_loss: 41598.9011
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 2743.4569; train_edge_recon_loss: 27111.2564; train_gene_expr_recon_loss: 12710.0543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42564.7676; train_optim_loss: 42564.7676; val_kl_reg_loss: 2719.2351; val_edge_recon_loss: 26247.1609; val_gene_expr_recon_loss: 12617.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41584.2085; val_optim_loss: 41584.2085

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 2744.3835; train_edge_recon_loss: 27106.7424; train_gene_expr_recon_loss: 12699.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42550.6023; train_optim_loss: 42550.6023; val_kl_reg_loss: 2710.2542; val_edge_recon_loss: 26251.7271; val_gene_expr_recon_loss: 12625.8589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41587.8403; val_optim_loss: 41587.8403
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9758; val_best_f1_score: 0.9758; train_kl_reg_loss: 2744.1818; train_edge_recon_loss: 27105.4147; train_gene_expr_recon_loss: 12697.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42547.4762; train_optim_loss: 42547.4762; val_kl_reg_loss: 2717.4962; val_edge_recon_loss: 26261.7565; val_gene_expr_recon_loss: 12609.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41588.4385; val_optim_loss: 41588.4385
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 2743.2475; train_edge_recon_loss: 27108.7040; train_gene_expr_recon_loss: 12699.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42551.2644; train_optim_loss: 42551.2644; val_kl_reg_loss: 2717.3804; val_edge_recon_loss: 26270.6201; val_gene_expr_recon_loss: 12616.9002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41604.9005; val_optim_loss: 41604.9005
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2744.6620; train_edge_recon_loss: 27102.6787; train_gene_expr_recon_loss: 12695.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42542.9170; train_optim_loss: 42542.9170; val_kl_reg_loss: 2720.4078; val_edge_recon_loss: 26247.7920; val_gene_expr_recon_loss: 12614.2815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41582.4816; val_optim_loss: 41582.4816

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 211 min 16 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9967
Val best accuracy score: 0.9749
Val best F1 score: 0.9750
Val gene expr MSE score: 8.9567

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
