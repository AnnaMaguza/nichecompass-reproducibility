None
Run timestamp: 06072023_233616_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9904; val_auprc_score: 0.9904; val_best_acc_score: 0.9508; val_best_f1_score: 0.9510; train_kl_reg_loss: 2452.9216; train_edge_recon_loss: 28199.9143; train_gene_expr_recon_loss: 15174.0902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45826.9260; train_optim_loss: 45826.9260; val_kl_reg_loss: 2516.6385; val_edge_recon_loss: 26841.4960; val_gene_expr_recon_loss: 13809.7012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43167.8357; val_optim_loss: 43167.8357
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9930; val_auprc_score: 0.9930; val_best_acc_score: 0.9592; val_best_f1_score: 0.9591; train_kl_reg_loss: 2603.3041; train_edge_recon_loss: 27577.5655; train_gene_expr_recon_loss: 13623.8176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43804.6871; train_optim_loss: 43804.6871; val_kl_reg_loss: 2578.9957; val_edge_recon_loss: 26640.0727; val_gene_expr_recon_loss: 13277.0576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42496.1260; val_optim_loss: 42496.1260
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9943; val_auprc_score: 0.9942; val_best_acc_score: 0.9636; val_best_f1_score: 0.9636; train_kl_reg_loss: 2651.0114; train_edge_recon_loss: 27425.8850; train_gene_expr_recon_loss: 13291.4918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43368.3882; train_optim_loss: 43368.3882; val_kl_reg_loss: 2561.9520; val_edge_recon_loss: 26538.0010; val_gene_expr_recon_loss: 13073.4497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42173.4025; val_optim_loss: 42173.4025
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9947; val_auprc_score: 0.9946; val_best_acc_score: 0.9653; val_best_f1_score: 0.9653; train_kl_reg_loss: 2675.6731; train_edge_recon_loss: 27345.0668; train_gene_expr_recon_loss: 13139.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43159.9719; train_optim_loss: 43159.9719; val_kl_reg_loss: 2700.9644; val_edge_recon_loss: 26487.5937; val_gene_expr_recon_loss: 12979.0251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42167.5834; val_optim_loss: 42167.5834
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9949; val_auprc_score: 0.9949; val_best_acc_score: 0.9661; val_best_f1_score: 0.9661; train_kl_reg_loss: 2689.7522; train_edge_recon_loss: 27297.9952; train_gene_expr_recon_loss: 13054.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43042.5696; train_optim_loss: 43042.5696; val_kl_reg_loss: 2558.0031; val_edge_recon_loss: 26411.2729; val_gene_expr_recon_loss: 12916.0566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41885.3326; val_optim_loss: 41885.3326
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9950; val_best_acc_score: 0.9672; val_best_f1_score: 0.9672; train_kl_reg_loss: 2701.1486; train_edge_recon_loss: 27260.6744; train_gene_expr_recon_loss: 12997.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42958.8531; train_optim_loss: 42958.8531; val_kl_reg_loss: 2613.4156; val_edge_recon_loss: 26364.7936; val_gene_expr_recon_loss: 12878.4472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41856.6564; val_optim_loss: 41856.6564
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9695; val_best_f1_score: 0.9697; train_kl_reg_loss: 2710.4130; train_edge_recon_loss: 27233.7375; train_gene_expr_recon_loss: 12963.1466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42907.2970; train_optim_loss: 42907.2970; val_kl_reg_loss: 2627.8189; val_edge_recon_loss: 26359.3312; val_gene_expr_recon_loss: 12838.6363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41825.7863; val_optim_loss: 41825.7863
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9713; val_best_f1_score: 0.9714; train_kl_reg_loss: 2716.7219; train_edge_recon_loss: 27214.7168; train_gene_expr_recon_loss: 12934.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42865.6706; train_optim_loss: 42865.6706; val_kl_reg_loss: 2774.0968; val_edge_recon_loss: 26338.6294; val_gene_expr_recon_loss: 12803.5579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41916.2839; val_optim_loss: 41916.2839
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9722; val_best_f1_score: 0.9722; train_kl_reg_loss: 2720.6600; train_edge_recon_loss: 27202.9454; train_gene_expr_recon_loss: 12915.1795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42838.7849; train_optim_loss: 42838.7849; val_kl_reg_loss: 2633.1198; val_edge_recon_loss: 26320.8537; val_gene_expr_recon_loss: 12808.5564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41762.5299; val_optim_loss: 41762.5299
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9711; val_best_f1_score: 0.9711; train_kl_reg_loss: 2724.6635; train_edge_recon_loss: 27188.4888; train_gene_expr_recon_loss: 12902.1101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42815.2625; train_optim_loss: 42815.2625; val_kl_reg_loss: 2675.3334; val_edge_recon_loss: 26356.9816; val_gene_expr_recon_loss: 12783.1310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41815.4459; val_optim_loss: 41815.4459
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9725; val_best_f1_score: 0.9725; train_kl_reg_loss: 2728.1771; train_edge_recon_loss: 27177.4556; train_gene_expr_recon_loss: 12882.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42787.6847; train_optim_loss: 42787.6847; val_kl_reg_loss: 2652.6988; val_edge_recon_loss: 26308.5596; val_gene_expr_recon_loss: 12779.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41740.7798; val_optim_loss: 41740.7798
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9726; val_best_f1_score: 0.9728; train_kl_reg_loss: 2732.0529; train_edge_recon_loss: 27163.0664; train_gene_expr_recon_loss: 12868.9693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42764.0886; train_optim_loss: 42764.0886; val_kl_reg_loss: 2718.9599; val_edge_recon_loss: 26298.6130; val_gene_expr_recon_loss: 12748.1318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41765.7047; val_optim_loss: 41765.7047
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9721; val_best_f1_score: 0.9721; train_kl_reg_loss: 2732.3410; train_edge_recon_loss: 27164.6229; train_gene_expr_recon_loss: 12865.3801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42762.3440; train_optim_loss: 42762.3440; val_kl_reg_loss: 2722.4263; val_edge_recon_loss: 26273.9210; val_gene_expr_recon_loss: 12752.3532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41748.7005; val_optim_loss: 41748.7005
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 2735.8891; train_edge_recon_loss: 27149.2350; train_gene_expr_recon_loss: 12859.2899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42744.4139; train_optim_loss: 42744.4139; val_kl_reg_loss: 2726.7909; val_edge_recon_loss: 26288.5837; val_gene_expr_recon_loss: 12767.2493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41782.6239; val_optim_loss: 41782.6239
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9741; val_best_f1_score: 0.9742; train_kl_reg_loss: 2738.6620; train_edge_recon_loss: 27143.8530; train_gene_expr_recon_loss: 12848.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42730.8019; train_optim_loss: 42730.8019; val_kl_reg_loss: 2728.7706; val_edge_recon_loss: 26255.4206; val_gene_expr_recon_loss: 12750.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41734.8649; val_optim_loss: 41734.8649
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9741; val_best_f1_score: 0.9741; train_kl_reg_loss: 2742.5954; train_edge_recon_loss: 27134.2437; train_gene_expr_recon_loss: 12838.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42715.7705; train_optim_loss: 42715.7705; val_kl_reg_loss: 2717.8529; val_edge_recon_loss: 26260.2782; val_gene_expr_recon_loss: 12750.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41728.3037; val_optim_loss: 41728.3037
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 2743.2670; train_edge_recon_loss: 27134.2886; train_gene_expr_recon_loss: 12839.4513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42717.0068; train_optim_loss: 42717.0068; val_kl_reg_loss: 2691.8354; val_edge_recon_loss: 26235.2907; val_gene_expr_recon_loss: 12725.7556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41652.8817; val_optim_loss: 41652.8817
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 2746.6079; train_edge_recon_loss: 27119.9807; train_gene_expr_recon_loss: 12829.7317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42696.3204; train_optim_loss: 42696.3204; val_kl_reg_loss: 2690.4143; val_edge_recon_loss: 26257.4588; val_gene_expr_recon_loss: 12737.9622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41685.8352; val_optim_loss: 41685.8352
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 2748.0529; train_edge_recon_loss: 27115.0274; train_gene_expr_recon_loss: 12834.8589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42697.9391; train_optim_loss: 42697.9391; val_kl_reg_loss: 2662.3575; val_edge_recon_loss: 26268.5437; val_gene_expr_recon_loss: 12741.5269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41672.4281; val_optim_loss: 41672.4281
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9743; val_best_f1_score: 0.9743; train_kl_reg_loss: 2748.4696; train_edge_recon_loss: 27121.4285; train_gene_expr_recon_loss: 12822.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42692.6167; train_optim_loss: 42692.6167; val_kl_reg_loss: 2731.8982; val_edge_recon_loss: 26235.5071; val_gene_expr_recon_loss: 12733.5798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41700.9851; val_optim_loss: 41700.9851
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 2753.5684; train_edge_recon_loss: 27104.3489; train_gene_expr_recon_loss: 12820.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42678.4308; train_optim_loss: 42678.4308; val_kl_reg_loss: 2741.0481; val_edge_recon_loss: 26249.1631; val_gene_expr_recon_loss: 12741.5639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41731.7751; val_optim_loss: 41731.7751

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 2753.3585; train_edge_recon_loss: 27068.0742; train_gene_expr_recon_loss: 12746.2356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42567.6683; train_optim_loss: 42567.6683; val_kl_reg_loss: 2720.7631; val_edge_recon_loss: 26215.9025; val_gene_expr_recon_loss: 12663.6646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41600.3302; val_optim_loss: 41600.3302
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9771; val_best_f1_score: 0.9771; train_kl_reg_loss: 2747.9577; train_edge_recon_loss: 27075.8367; train_gene_expr_recon_loss: 12732.7289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42556.5235; train_optim_loss: 42556.5235; val_kl_reg_loss: 2707.2981; val_edge_recon_loss: 26198.7096; val_gene_expr_recon_loss: 12637.9929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41544.0010; val_optim_loss: 41544.0010
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 2747.4814; train_edge_recon_loss: 27069.6997; train_gene_expr_recon_loss: 12729.2518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42546.4330; train_optim_loss: 42546.4330; val_kl_reg_loss: 2734.9146; val_edge_recon_loss: 26196.6610; val_gene_expr_recon_loss: 12653.8528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41585.4284; val_optim_loss: 41585.4284
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2746.2565; train_edge_recon_loss: 27074.9526; train_gene_expr_recon_loss: 12721.7218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42542.9310; train_optim_loss: 42542.9310; val_kl_reg_loss: 2736.4617; val_edge_recon_loss: 26214.7996; val_gene_expr_recon_loss: 12652.9788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41604.2401; val_optim_loss: 41604.2401
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9776; val_best_f1_score: 0.9776; train_kl_reg_loss: 2746.5844; train_edge_recon_loss: 27073.1429; train_gene_expr_recon_loss: 12718.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42537.9799; train_optim_loss: 42537.9799; val_kl_reg_loss: 2728.6244; val_edge_recon_loss: 26186.7439; val_gene_expr_recon_loss: 12649.2624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41564.6306; val_optim_loss: 41564.6306
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9770; val_best_f1_score: 0.9770; train_kl_reg_loss: 2747.7068; train_edge_recon_loss: 27068.0643; train_gene_expr_recon_loss: 12716.8135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42532.5847; train_optim_loss: 42532.5847; val_kl_reg_loss: 2731.8664; val_edge_recon_loss: 26196.1289; val_gene_expr_recon_loss: 12645.4100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41573.4052; val_optim_loss: 41573.4052

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9773; val_best_f1_score: 0.9773; train_kl_reg_loss: 2747.5128; train_edge_recon_loss: 27062.7578; train_gene_expr_recon_loss: 12707.5262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42517.7968; train_optim_loss: 42517.7968; val_kl_reg_loss: 2724.8991; val_edge_recon_loss: 26215.6035; val_gene_expr_recon_loss: 12622.3439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41562.8464; val_optim_loss: 41562.8464
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 2745.9850; train_edge_recon_loss: 27068.2094; train_gene_expr_recon_loss: 12704.2996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42518.4939; train_optim_loss: 42518.4939; val_kl_reg_loss: 2718.8707; val_edge_recon_loss: 26197.7073; val_gene_expr_recon_loss: 12651.7815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41568.3595; val_optim_loss: 41568.3595
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9774; val_best_f1_score: 0.9774; train_kl_reg_loss: 2747.0959; train_edge_recon_loss: 27062.5071; train_gene_expr_recon_loss: 12699.4042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42509.0072; train_optim_loss: 42509.0072; val_kl_reg_loss: 2732.6674; val_edge_recon_loss: 26189.8493; val_gene_expr_recon_loss: 12631.4767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41553.9934; val_optim_loss: 41553.9934
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9975; val_auprc_score: 0.9973; val_best_acc_score: 0.9777; val_best_f1_score: 0.9777; train_kl_reg_loss: 2745.9866; train_edge_recon_loss: 27065.7330; train_gene_expr_recon_loss: 12700.6452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42512.3648; train_optim_loss: 42512.3648; val_kl_reg_loss: 2732.3310; val_edge_recon_loss: 26194.1331; val_gene_expr_recon_loss: 12629.7185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41556.1826; val_optim_loss: 41556.1826

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 230 min 22 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9974
Val AUPRC score: 0.9972
Val best accuracy score: 0.9771
Val best F1 score: 0.9771
Val gene expr MSE score: 8.8456

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
