None
Run timestamp: 04072023_092735_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1691, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1691, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9891; val_auprc_score: 0.9890; val_best_acc_score: 0.9476; val_best_f1_score: 0.9477; train_kl_reg_loss: 2531.9875; train_edge_recon_loss: 28059.2273; train_gene_expr_recon_loss: 21826.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 52417.5066; train_optim_loss: 52417.5066; val_kl_reg_loss: 2537.7973; val_edge_recon_loss: 26404.6188; val_gene_expr_recon_loss: 20735.7548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49678.1708; val_optim_loss: 49678.1708
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9927; val_auprc_score: 0.9925; val_best_acc_score: 0.9582; val_best_f1_score: 0.9583; train_kl_reg_loss: 2665.8293; train_edge_recon_loss: 27512.7258; train_gene_expr_recon_loss: 20624.4279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50802.9831; train_optim_loss: 50802.9831; val_kl_reg_loss: 2609.4596; val_edge_recon_loss: 26314.8498; val_gene_expr_recon_loss: 20265.5292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49189.8386; val_optim_loss: 49189.8386
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9934; val_auprc_score: 0.9933; val_best_acc_score: 0.9605; val_best_f1_score: 0.9604; train_kl_reg_loss: 2683.1471; train_edge_recon_loss: 27432.4569; train_gene_expr_recon_loss: 20316.3335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50431.9374; train_optim_loss: 50431.9374; val_kl_reg_loss: 2690.3202; val_edge_recon_loss: 26261.0611; val_gene_expr_recon_loss: 20053.0574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49004.4388; val_optim_loss: 49004.4388
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9941; val_best_acc_score: 0.9625; val_best_f1_score: 0.9626; train_kl_reg_loss: 2701.9083; train_edge_recon_loss: 27403.7972; train_gene_expr_recon_loss: 20202.9588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50308.6643; train_optim_loss: 50308.6643; val_kl_reg_loss: 2666.1094; val_edge_recon_loss: 26206.2342; val_gene_expr_recon_loss: 19976.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48848.7970; val_optim_loss: 48848.7970
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9945; val_auprc_score: 0.9943; val_best_acc_score: 0.9639; val_best_f1_score: 0.9639; train_kl_reg_loss: 2719.3319; train_edge_recon_loss: 27369.8879; train_gene_expr_recon_loss: 20145.8622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50235.0821; train_optim_loss: 50235.0821; val_kl_reg_loss: 2790.1956; val_edge_recon_loss: 26242.0339; val_gene_expr_recon_loss: 19957.0414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48989.2709; val_optim_loss: 48989.2709
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9678; val_best_f1_score: 0.9678; train_kl_reg_loss: 2731.5484; train_edge_recon_loss: 27345.6484; train_gene_expr_recon_loss: 20097.4698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50174.6665; train_optim_loss: 50174.6665; val_kl_reg_loss: 2697.9171; val_edge_recon_loss: 26185.2806; val_gene_expr_recon_loss: 19897.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48780.3772; val_optim_loss: 48780.3772
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9954; val_auprc_score: 0.9953; val_best_acc_score: 0.9673; val_best_f1_score: 0.9673; train_kl_reg_loss: 2741.6579; train_edge_recon_loss: 27322.7270; train_gene_expr_recon_loss: 20070.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50134.4826; train_optim_loss: 50134.4826; val_kl_reg_loss: 2697.5261; val_edge_recon_loss: 26182.3567; val_gene_expr_recon_loss: 19876.7217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48756.6047; val_optim_loss: 48756.6047
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9955; val_auprc_score: 0.9952; val_best_acc_score: 0.9674; val_best_f1_score: 0.9675; train_kl_reg_loss: 2746.8665; train_edge_recon_loss: 27315.8613; train_gene_expr_recon_loss: 20054.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50117.5278; train_optim_loss: 50117.5278; val_kl_reg_loss: 2730.0851; val_edge_recon_loss: 26221.6647; val_gene_expr_recon_loss: 19879.4813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48831.2311; val_optim_loss: 48831.2311
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9955; val_auprc_score: 0.9953; val_best_acc_score: 0.9679; val_best_f1_score: 0.9680; train_kl_reg_loss: 2752.1901; train_edge_recon_loss: 27306.5362; train_gene_expr_recon_loss: 20030.8093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50089.5356; train_optim_loss: 50089.5356; val_kl_reg_loss: 2721.8988; val_edge_recon_loss: 26194.5367; val_gene_expr_recon_loss: 19835.5150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48751.9505; val_optim_loss: 48751.9505
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9955; val_best_acc_score: 0.9691; val_best_f1_score: 0.9691; train_kl_reg_loss: 2755.6926; train_edge_recon_loss: 27305.4386; train_gene_expr_recon_loss: 20010.5724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50071.7035; train_optim_loss: 50071.7035; val_kl_reg_loss: 2677.2931; val_edge_recon_loss: 26216.9420; val_gene_expr_recon_loss: 19831.4881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48725.7233; val_optim_loss: 48725.7233
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9701; val_best_f1_score: 0.9702; train_kl_reg_loss: 2760.8252; train_edge_recon_loss: 27292.9478; train_gene_expr_recon_loss: 20006.0714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50059.8444; train_optim_loss: 50059.8444; val_kl_reg_loss: 2754.5045; val_edge_recon_loss: 26203.2861; val_gene_expr_recon_loss: 19805.6579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48763.4485; val_optim_loss: 48763.4485
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9957; val_best_acc_score: 0.9691; val_best_f1_score: 0.9691; train_kl_reg_loss: 2764.8356; train_edge_recon_loss: 27287.7481; train_gene_expr_recon_loss: 19992.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50044.7674; train_optim_loss: 50044.7674; val_kl_reg_loss: 2735.1214; val_edge_recon_loss: 26204.9295; val_gene_expr_recon_loss: 19807.6241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48747.6749; val_optim_loss: 48747.6749
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9959; val_best_acc_score: 0.9697; val_best_f1_score: 0.9698; train_kl_reg_loss: 2767.6844; train_edge_recon_loss: 27282.4471; train_gene_expr_recon_loss: 19980.2543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50030.3858; train_optim_loss: 50030.3858; val_kl_reg_loss: 2750.4134; val_edge_recon_loss: 26176.6461; val_gene_expr_recon_loss: 19773.5055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48700.5653; val_optim_loss: 48700.5653
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9706; val_best_f1_score: 0.9706; train_kl_reg_loss: 2770.8220; train_edge_recon_loss: 27276.7498; train_gene_expr_recon_loss: 19981.5087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50029.0805; train_optim_loss: 50029.0805; val_kl_reg_loss: 2693.1865; val_edge_recon_loss: 26197.5592; val_gene_expr_recon_loss: 19803.7761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48694.5218; val_optim_loss: 48694.5218
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9961; val_auprc_score: 0.9959; val_best_acc_score: 0.9704; val_best_f1_score: 0.9705; train_kl_reg_loss: 2774.3139; train_edge_recon_loss: 27267.6295; train_gene_expr_recon_loss: 19967.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50008.9650; train_optim_loss: 50008.9650; val_kl_reg_loss: 2730.8724; val_edge_recon_loss: 26175.4770; val_gene_expr_recon_loss: 19808.9940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48715.3433; val_optim_loss: 48715.3433
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9711; val_best_f1_score: 0.9711; train_kl_reg_loss: 2778.0243; train_edge_recon_loss: 27254.8445; train_gene_expr_recon_loss: 19960.4238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49993.2925; train_optim_loss: 49993.2925; val_kl_reg_loss: 2719.5867; val_edge_recon_loss: 26183.8486; val_gene_expr_recon_loss: 19787.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48691.0213; val_optim_loss: 48691.0213
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9711; val_best_f1_score: 0.9712; train_kl_reg_loss: 2778.0559; train_edge_recon_loss: 27261.7175; train_gene_expr_recon_loss: 19958.9021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49998.6755; train_optim_loss: 49998.6755; val_kl_reg_loss: 2747.6529; val_edge_recon_loss: 26205.3990; val_gene_expr_recon_loss: 19782.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48735.4154; val_optim_loss: 48735.4154
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9726; val_best_f1_score: 0.9726; train_kl_reg_loss: 2779.3777; train_edge_recon_loss: 27258.0705; train_gene_expr_recon_loss: 19950.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49988.3756; train_optim_loss: 49988.3756; val_kl_reg_loss: 2690.9759; val_edge_recon_loss: 26159.2377; val_gene_expr_recon_loss: 19758.9723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48609.1861; val_optim_loss: 48609.1861
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9735; val_best_f1_score: 0.9735; train_kl_reg_loss: 2781.9991; train_edge_recon_loss: 27250.7922; train_gene_expr_recon_loss: 19940.5090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49973.3002; train_optim_loss: 49973.3002; val_kl_reg_loss: 2804.3570; val_edge_recon_loss: 26179.4482; val_gene_expr_recon_loss: 19757.6509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48741.4564; val_optim_loss: 48741.4564
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 2784.3285; train_edge_recon_loss: 27245.2370; train_gene_expr_recon_loss: 19939.2605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49968.8260; train_optim_loss: 49968.8260; val_kl_reg_loss: 2763.0781; val_edge_recon_loss: 26187.6478; val_gene_expr_recon_loss: 19786.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48737.2697; val_optim_loss: 48737.2697
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9725; val_best_f1_score: 0.9725; train_kl_reg_loss: 2784.4367; train_edge_recon_loss: 27250.4524; train_gene_expr_recon_loss: 19938.2659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49973.1550; train_optim_loss: 49973.1550; val_kl_reg_loss: 2782.0121; val_edge_recon_loss: 26196.5162; val_gene_expr_recon_loss: 19769.0878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48747.6161; val_optim_loss: 48747.6161
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 2786.1019; train_edge_recon_loss: 27244.3081; train_gene_expr_recon_loss: 19931.8557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49962.2657; train_optim_loss: 49962.2657; val_kl_reg_loss: 2698.0332; val_edge_recon_loss: 26161.0449; val_gene_expr_recon_loss: 19749.3034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48608.3814; val_optim_loss: 48608.3814
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 2787.6177; train_edge_recon_loss: 27240.7242; train_gene_expr_recon_loss: 19925.8735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49954.2154; train_optim_loss: 49954.2154; val_kl_reg_loss: 2819.4036; val_edge_recon_loss: 26169.2211; val_gene_expr_recon_loss: 19761.2741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48749.8985; val_optim_loss: 48749.8985
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9729; val_best_f1_score: 0.9730; train_kl_reg_loss: 2788.4850; train_edge_recon_loss: 27240.0950; train_gene_expr_recon_loss: 19921.5316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49950.1117; train_optim_loss: 49950.1117; val_kl_reg_loss: 2747.5765; val_edge_recon_loss: 26183.2898; val_gene_expr_recon_loss: 19752.2009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48683.0672; val_optim_loss: 48683.0672
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9967; val_best_acc_score: 0.9738; val_best_f1_score: 0.9738; train_kl_reg_loss: 2789.8715; train_edge_recon_loss: 27238.5800; train_gene_expr_recon_loss: 19920.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49949.1339; train_optim_loss: 49949.1339; val_kl_reg_loss: 2727.0857; val_edge_recon_loss: 26153.0007; val_gene_expr_recon_loss: 19750.6547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48630.7413; val_optim_loss: 48630.7413
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9743; val_best_f1_score: 0.9743; train_kl_reg_loss: 2791.2387; train_edge_recon_loss: 27233.2869; train_gene_expr_recon_loss: 19915.8764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49940.4020; train_optim_loss: 49940.4020; val_kl_reg_loss: 2731.3776; val_edge_recon_loss: 26151.6291; val_gene_expr_recon_loss: 19738.5002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48621.5068; val_optim_loss: 48621.5068

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9760; val_best_f1_score: 0.9760; train_kl_reg_loss: 2741.8988; train_edge_recon_loss: 27223.6402; train_gene_expr_recon_loss: 19722.8955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49688.4346; train_optim_loss: 49688.4346; val_kl_reg_loss: 2667.8844; val_edge_recon_loss: 26157.3153; val_gene_expr_recon_loss: 19576.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48401.5851; val_optim_loss: 48401.5851
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9763; val_best_f1_score: 0.9763; train_kl_reg_loss: 2692.1905; train_edge_recon_loss: 27273.1554; train_gene_expr_recon_loss: 19645.3121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49610.6580; train_optim_loss: 49610.6580; val_kl_reg_loss: 2647.0979; val_edge_recon_loss: 26155.3556; val_gene_expr_recon_loss: 19591.5100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48393.9634; val_optim_loss: 48393.9634
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2678.2922; train_edge_recon_loss: 27283.1844; train_gene_expr_recon_loss: 19622.7996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49584.2761; train_optim_loss: 49584.2761; val_kl_reg_loss: 2679.6688; val_edge_recon_loss: 26179.9417; val_gene_expr_recon_loss: 19576.0374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48435.6478; val_optim_loss: 48435.6478
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 2672.7853; train_edge_recon_loss: 27288.4254; train_gene_expr_recon_loss: 19608.4535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49569.6642; train_optim_loss: 49569.6642; val_kl_reg_loss: 2615.7069; val_edge_recon_loss: 26150.5995; val_gene_expr_recon_loss: 19576.0074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48342.3138; val_optim_loss: 48342.3138
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 2666.8631; train_edge_recon_loss: 27299.2591; train_gene_expr_recon_loss: 19604.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49570.7983; train_optim_loss: 49570.7983; val_kl_reg_loss: 2671.3083; val_edge_recon_loss: 26171.3325; val_gene_expr_recon_loss: 19557.1203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48399.7611; val_optim_loss: 48399.7611
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 2665.2712; train_edge_recon_loss: 27301.5081; train_gene_expr_recon_loss: 19601.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49568.7732; train_optim_loss: 49568.7732; val_kl_reg_loss: 2642.6838; val_edge_recon_loss: 26183.3031; val_gene_expr_recon_loss: 19546.2775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48372.2644; val_optim_loss: 48372.2644
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9766; val_best_f1_score: 0.9765; train_kl_reg_loss: 2664.8799; train_edge_recon_loss: 27299.1761; train_gene_expr_recon_loss: 19596.3458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49560.4018; train_optim_loss: 49560.4018; val_kl_reg_loss: 2646.7885; val_edge_recon_loss: 26187.8164; val_gene_expr_recon_loss: 19567.7186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48402.3233; val_optim_loss: 48402.3233
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9975; val_best_acc_score: 0.9771; val_best_f1_score: 0.9772; train_kl_reg_loss: 2665.2337; train_edge_recon_loss: 27297.0634; train_gene_expr_recon_loss: 19589.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49552.0749; train_optim_loss: 49552.0749; val_kl_reg_loss: 2626.2535; val_edge_recon_loss: 26164.5420; val_gene_expr_recon_loss: 19562.6852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48353.4808; val_optim_loss: 48353.4808

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 2663.1178; train_edge_recon_loss: 27294.5487; train_gene_expr_recon_loss: 19570.7276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49528.3941; train_optim_loss: 49528.3941; val_kl_reg_loss: 2640.1554; val_edge_recon_loss: 26171.5639; val_gene_expr_recon_loss: 19539.2033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48350.9227; val_optim_loss: 48350.9227
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9975; val_auprc_score: 0.9972; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 2663.3112; train_edge_recon_loss: 27290.4502; train_gene_expr_recon_loss: 19566.6487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49520.4100; train_optim_loss: 49520.4100; val_kl_reg_loss: 2645.3973; val_edge_recon_loss: 26158.0291; val_gene_expr_recon_loss: 19543.9913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48347.4177; val_optim_loss: 48347.4177
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 2662.2008; train_edge_recon_loss: 27290.5988; train_gene_expr_recon_loss: 19563.6617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49516.4612; train_optim_loss: 49516.4612; val_kl_reg_loss: 2640.8607; val_edge_recon_loss: 26178.3117; val_gene_expr_recon_loss: 19532.5506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48351.7230; val_optim_loss: 48351.7230
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2660.3333; train_edge_recon_loss: 27296.9559; train_gene_expr_recon_loss: 19561.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 49519.2831; train_optim_loss: 49519.2831; val_kl_reg_loss: 2638.7779; val_edge_recon_loss: 26166.2480; val_gene_expr_recon_loss: 19537.9074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48342.9332; val_optim_loss: 48342.9332

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 331 min 28 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9974
Val AUPRC score: 0.9972
Val best accuracy score: 0.9770
Val best F1 score: 0.9771
Val gene expr MSE score: 8.2094

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
