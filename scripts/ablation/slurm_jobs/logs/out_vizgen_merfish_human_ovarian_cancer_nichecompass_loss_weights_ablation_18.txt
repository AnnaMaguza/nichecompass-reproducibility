None
Run timestamp: 03072023_071446_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9872; val_auprc_score: 0.9873; val_best_acc_score: 0.9428; val_best_f1_score: 0.9428; train_kl_reg_loss: 2444.5832; train_edge_recon_loss: 28591.7332; train_gene_expr_recon_loss: 16049.2703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47085.5867; train_optim_loss: 47085.5867; val_kl_reg_loss: 2543.6036; val_edge_recon_loss: 27118.1546; val_gene_expr_recon_loss: 14398.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44059.8700; val_optim_loss: 44059.8700
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9916; val_best_acc_score: 0.9537; val_best_f1_score: 0.9538; train_kl_reg_loss: 2586.9840; train_edge_recon_loss: 27784.6629; train_gene_expr_recon_loss: 14056.7262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44428.3731; train_optim_loss: 44428.3731; val_kl_reg_loss: 2578.5028; val_edge_recon_loss: 26901.1657; val_gene_expr_recon_loss: 13568.9926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43048.6613; val_optim_loss: 43048.6613
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9936; val_auprc_score: 0.9935; val_best_acc_score: 0.9609; val_best_f1_score: 0.9609; train_kl_reg_loss: 2612.4207; train_edge_recon_loss: 27608.5754; train_gene_expr_recon_loss: 13555.3647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43776.3608; train_optim_loss: 43776.3608; val_kl_reg_loss: 2597.8266; val_edge_recon_loss: 26721.5829; val_gene_expr_recon_loss: 13255.4775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42574.8871; val_optim_loss: 42574.8871
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9943; val_auprc_score: 0.9940; val_best_acc_score: 0.9636; val_best_f1_score: 0.9636; train_kl_reg_loss: 2629.9797; train_edge_recon_loss: 27506.8666; train_gene_expr_recon_loss: 13294.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43431.8201; train_optim_loss: 43431.8201; val_kl_reg_loss: 2583.1182; val_edge_recon_loss: 26661.7151; val_gene_expr_recon_loss: 13032.1872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42277.0205; val_optim_loss: 42277.0205
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9947; val_auprc_score: 0.9946; val_best_acc_score: 0.9655; val_best_f1_score: 0.9654; train_kl_reg_loss: 2646.0474; train_edge_recon_loss: 27428.3196; train_gene_expr_recon_loss: 13126.3874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43200.7544; train_optim_loss: 43200.7544; val_kl_reg_loss: 2597.6946; val_edge_recon_loss: 26591.3274; val_gene_expr_recon_loss: 12937.1489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42126.1709; val_optim_loss: 42126.1709
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9950; val_auprc_score: 0.9948; val_best_acc_score: 0.9661; val_best_f1_score: 0.9662; train_kl_reg_loss: 2659.2374; train_edge_recon_loss: 27367.5557; train_gene_expr_recon_loss: 13027.6926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43054.4857; train_optim_loss: 43054.4857; val_kl_reg_loss: 2565.1198; val_edge_recon_loss: 26528.3925; val_gene_expr_recon_loss: 12843.6034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41937.1157; val_optim_loss: 41937.1157
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9953; val_auprc_score: 0.9952; val_best_acc_score: 0.9681; val_best_f1_score: 0.9682; train_kl_reg_loss: 2669.2990; train_edge_recon_loss: 27321.0457; train_gene_expr_recon_loss: 12944.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42934.8997; train_optim_loss: 42934.8997; val_kl_reg_loss: 2666.4169; val_edge_recon_loss: 26503.0777; val_gene_expr_recon_loss: 12782.5408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41952.0354; val_optim_loss: 41952.0354
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9957; val_auprc_score: 0.9956; val_best_acc_score: 0.9690; val_best_f1_score: 0.9690; train_kl_reg_loss: 2677.0143; train_edge_recon_loss: 27296.3176; train_gene_expr_recon_loss: 12894.9930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42868.3248; train_optim_loss: 42868.3248; val_kl_reg_loss: 2665.2564; val_edge_recon_loss: 26428.5456; val_gene_expr_recon_loss: 12745.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41838.9625; val_optim_loss: 41838.9625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9698; val_best_f1_score: 0.9699; train_kl_reg_loss: 2685.6988; train_edge_recon_loss: 27262.6185; train_gene_expr_recon_loss: 12853.2491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42801.5665; train_optim_loss: 42801.5665; val_kl_reg_loss: 2585.8276; val_edge_recon_loss: 26395.3804; val_gene_expr_recon_loss: 12716.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41697.5751; val_optim_loss: 41697.5751
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 2693.9081; train_edge_recon_loss: 27234.0349; train_gene_expr_recon_loss: 12824.3501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42752.2930; train_optim_loss: 42752.2930; val_kl_reg_loss: 2648.5985; val_edge_recon_loss: 26392.5466; val_gene_expr_recon_loss: 12664.4060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41705.5512; val_optim_loss: 41705.5512
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9960; val_auprc_score: 0.9957; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 2698.1066; train_edge_recon_loss: 27221.7892; train_gene_expr_recon_loss: 12797.0602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42716.9560; train_optim_loss: 42716.9560; val_kl_reg_loss: 2656.6038; val_edge_recon_loss: 26340.9561; val_gene_expr_recon_loss: 12672.5440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41670.1040; val_optim_loss: 41670.1040
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9961; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 2703.2793; train_edge_recon_loss: 27210.0698; train_gene_expr_recon_loss: 12779.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42692.6760; train_optim_loss: 42692.6760; val_kl_reg_loss: 2712.2997; val_edge_recon_loss: 26380.3209; val_gene_expr_recon_loss: 12650.5483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41743.1688; val_optim_loss: 41743.1688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9961; val_best_acc_score: 0.9716; val_best_f1_score: 0.9716; train_kl_reg_loss: 2708.3685; train_edge_recon_loss: 27190.6758; train_gene_expr_recon_loss: 12756.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42655.7806; train_optim_loss: 42655.7806; val_kl_reg_loss: 2674.6405; val_edge_recon_loss: 26358.9190; val_gene_expr_recon_loss: 12630.7112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41664.2707; val_optim_loss: 41664.2707
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9717; val_best_f1_score: 0.9717; train_kl_reg_loss: 2711.5537; train_edge_recon_loss: 27181.4396; train_gene_expr_recon_loss: 12748.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42641.2600; train_optim_loss: 42641.2600; val_kl_reg_loss: 2725.6067; val_edge_recon_loss: 26318.7119; val_gene_expr_recon_loss: 12594.4027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41638.7210; val_optim_loss: 41638.7210
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9720; val_best_f1_score: 0.9720; train_kl_reg_loss: 2714.4688; train_edge_recon_loss: 27171.1813; train_gene_expr_recon_loss: 12729.9839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42615.6340; train_optim_loss: 42615.6340; val_kl_reg_loss: 2706.8460; val_edge_recon_loss: 26340.0075; val_gene_expr_recon_loss: 12611.5751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41658.4289; val_optim_loss: 41658.4289
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9965; val_auprc_score: 0.9964; val_best_acc_score: 0.9725; val_best_f1_score: 0.9725; train_kl_reg_loss: 2716.0739; train_edge_recon_loss: 27171.3760; train_gene_expr_recon_loss: 12717.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42604.5853; train_optim_loss: 42604.5853; val_kl_reg_loss: 2651.0402; val_edge_recon_loss: 26306.1038; val_gene_expr_recon_loss: 12616.4210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41573.5650; val_optim_loss: 41573.5650
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9966; val_auprc_score: 0.9964; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 2720.1790; train_edge_recon_loss: 27154.3615; train_gene_expr_recon_loss: 12714.6209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42589.1614; train_optim_loss: 42589.1614; val_kl_reg_loss: 2705.7311; val_edge_recon_loss: 26303.1194; val_gene_expr_recon_loss: 12577.2424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41586.0932; val_optim_loss: 41586.0932
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9965; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 2721.3458; train_edge_recon_loss: 27150.6874; train_gene_expr_recon_loss: 12698.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42570.6340; train_optim_loss: 42570.6340; val_kl_reg_loss: 2662.0478; val_edge_recon_loss: 26313.7961; val_gene_expr_recon_loss: 12583.4131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41559.2571; val_optim_loss: 41559.2571
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9722; val_best_f1_score: 0.9722; train_kl_reg_loss: 2724.3786; train_edge_recon_loss: 27139.6276; train_gene_expr_recon_loss: 12690.4675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42554.4738; train_optim_loss: 42554.4738; val_kl_reg_loss: 2675.0492; val_edge_recon_loss: 26267.1997; val_gene_expr_recon_loss: 12573.6993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41515.9483; val_optim_loss: 41515.9483
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9966; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 2725.5773; train_edge_recon_loss: 27133.9410; train_gene_expr_recon_loss: 12682.2119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42541.7302; train_optim_loss: 42541.7302; val_kl_reg_loss: 2691.2384; val_edge_recon_loss: 26278.9849; val_gene_expr_recon_loss: 12559.9699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41530.1932; val_optim_loss: 41530.1932
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9970; val_auprc_score: 0.9967; val_best_acc_score: 0.9746; val_best_f1_score: 0.9747; train_kl_reg_loss: 2727.9411; train_edge_recon_loss: 27129.3397; train_gene_expr_recon_loss: 12675.8415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42533.1222; train_optim_loss: 42533.1222; val_kl_reg_loss: 2646.8625; val_edge_recon_loss: 26299.2939; val_gene_expr_recon_loss: 12554.7402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41500.8965; val_optim_loss: 41500.8965
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 2731.0263; train_edge_recon_loss: 27121.8098; train_gene_expr_recon_loss: 12670.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42523.6025; train_optim_loss: 42523.6025; val_kl_reg_loss: 2735.0954; val_edge_recon_loss: 26267.5049; val_gene_expr_recon_loss: 12542.7509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41545.3513; val_optim_loss: 41545.3513
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 2733.0825; train_edge_recon_loss: 27116.4396; train_gene_expr_recon_loss: 12665.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42515.0200; train_optim_loss: 42515.0200; val_kl_reg_loss: 2731.7264; val_edge_recon_loss: 26255.6906; val_gene_expr_recon_loss: 12534.4051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41521.8220; val_optim_loss: 41521.8220
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9728; val_best_f1_score: 0.9728; train_kl_reg_loss: 2734.7971; train_edge_recon_loss: 27114.7496; train_gene_expr_recon_loss: 12659.5350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42509.0816; train_optim_loss: 42509.0816; val_kl_reg_loss: 2722.6369; val_edge_recon_loss: 26280.1335; val_gene_expr_recon_loss: 12553.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41556.1637; val_optim_loss: 41556.1637
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9967; val_auprc_score: 0.9966; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 2735.6502; train_edge_recon_loss: 27115.5084; train_gene_expr_recon_loss: 12654.0157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42505.1744; train_optim_loss: 42505.1744; val_kl_reg_loss: 2720.6454; val_edge_recon_loss: 26298.1389; val_gene_expr_recon_loss: 12526.1610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41544.9453; val_optim_loss: 41544.9453

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2735.6376; train_edge_recon_loss: 27080.8849; train_gene_expr_recon_loss: 12606.4864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42423.0088; train_optim_loss: 42423.0088; val_kl_reg_loss: 2718.5318; val_edge_recon_loss: 26226.9735; val_gene_expr_recon_loss: 12513.8080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41459.3134; val_optim_loss: 41459.3134
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9762; val_best_f1_score: 0.9762; train_kl_reg_loss: 2735.3588; train_edge_recon_loss: 27075.5879; train_gene_expr_recon_loss: 12599.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42410.8831; train_optim_loss: 42410.8831; val_kl_reg_loss: 2712.3937; val_edge_recon_loss: 26237.4303; val_gene_expr_recon_loss: 12499.1446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41448.9685; val_optim_loss: 41448.9685
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 2734.3707; train_edge_recon_loss: 27076.0773; train_gene_expr_recon_loss: 12597.7765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42408.2244; train_optim_loss: 42408.2244; val_kl_reg_loss: 2690.4647; val_edge_recon_loss: 26237.3311; val_gene_expr_recon_loss: 12492.3478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41420.1437; val_optim_loss: 41420.1437
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 2734.3034; train_edge_recon_loss: 27074.7401; train_gene_expr_recon_loss: 12591.1631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42400.2067; train_optim_loss: 42400.2067; val_kl_reg_loss: 2698.2993; val_edge_recon_loss: 26237.0260; val_gene_expr_recon_loss: 12490.2009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41425.5263; val_optim_loss: 41425.5263
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2733.5729; train_edge_recon_loss: 27079.7168; train_gene_expr_recon_loss: 12590.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42403.9889; train_optim_loss: 42403.9889; val_kl_reg_loss: 2723.4842; val_edge_recon_loss: 26228.3859; val_gene_expr_recon_loss: 12499.3631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41451.2331; val_optim_loss: 41451.2331
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9970; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 2734.3650; train_edge_recon_loss: 27076.7379; train_gene_expr_recon_loss: 12586.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42397.7923; train_optim_loss: 42397.7923; val_kl_reg_loss: 2703.2421; val_edge_recon_loss: 26254.7743; val_gene_expr_recon_loss: 12483.4541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41441.4705; val_optim_loss: 41441.4705
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 2735.5552; train_edge_recon_loss: 27071.7893; train_gene_expr_recon_loss: 12582.1874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42389.5319; train_optim_loss: 42389.5319; val_kl_reg_loss: 2719.8426; val_edge_recon_loss: 26240.3392; val_gene_expr_recon_loss: 12491.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41451.3410; val_optim_loss: 41451.3410

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9767; val_best_f1_score: 0.9767; train_kl_reg_loss: 2735.2162; train_edge_recon_loss: 27069.9207; train_gene_expr_recon_loss: 12574.7411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42379.8781; train_optim_loss: 42379.8781; val_kl_reg_loss: 2711.9808; val_edge_recon_loss: 26251.1440; val_gene_expr_recon_loss: 12478.9940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41442.1188; val_optim_loss: 41442.1188
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2735.7380; train_edge_recon_loss: 27065.7945; train_gene_expr_recon_loss: 12580.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42381.7485; train_optim_loss: 42381.7485; val_kl_reg_loss: 2711.1911; val_edge_recon_loss: 26238.8727; val_gene_expr_recon_loss: 12467.1723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41417.2363; val_optim_loss: 41417.2363
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9772; val_best_f1_score: 0.9772; train_kl_reg_loss: 2734.4253; train_edge_recon_loss: 27071.1971; train_gene_expr_recon_loss: 12576.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42381.9606; train_optim_loss: 42381.9606; val_kl_reg_loss: 2713.1684; val_edge_recon_loss: 26220.0879; val_gene_expr_recon_loss: 12479.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41412.8285; val_optim_loss: 41412.8285
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9974; val_auprc_score: 0.9972; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 2734.1833; train_edge_recon_loss: 27075.4323; train_gene_expr_recon_loss: 12573.8346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42383.4502; train_optim_loss: 42383.4502; val_kl_reg_loss: 2702.7093; val_edge_recon_loss: 26245.8259; val_gene_expr_recon_loss: 12476.5541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41425.0893; val_optim_loss: 41425.0893
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9767; val_best_f1_score: 0.9768; train_kl_reg_loss: 2735.1321; train_edge_recon_loss: 27067.6429; train_gene_expr_recon_loss: 12575.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42378.2354; train_optim_loss: 42378.2354; val_kl_reg_loss: 2711.8140; val_edge_recon_loss: 26228.8633; val_gene_expr_recon_loss: 12475.3674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41416.0446; val_optim_loss: 41416.0446
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 2733.5725; train_edge_recon_loss: 27074.0275; train_gene_expr_recon_loss: 12576.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42384.0676; train_optim_loss: 42384.0676; val_kl_reg_loss: 2706.3299; val_edge_recon_loss: 26232.2010; val_gene_expr_recon_loss: 12476.7330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41415.2639; val_optim_loss: 41415.2639
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2733.3251; train_edge_recon_loss: 27074.6667; train_gene_expr_recon_loss: 12571.3703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42379.3620; train_optim_loss: 42379.3620; val_kl_reg_loss: 2708.0272; val_edge_recon_loss: 26235.5949; val_gene_expr_recon_loss: 12468.2077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41411.8298; val_optim_loss: 41411.8298
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9766; val_best_f1_score: 0.9767; train_kl_reg_loss: 2733.3755; train_edge_recon_loss: 27072.7137; train_gene_expr_recon_loss: 12577.3562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42383.4454; train_optim_loss: 42383.4454; val_kl_reg_loss: 2707.5534; val_edge_recon_loss: 26229.4288; val_gene_expr_recon_loss: 12483.7393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41420.7216; val_optim_loss: 41420.7216
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2735.1766; train_edge_recon_loss: 27066.8641; train_gene_expr_recon_loss: 12572.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42374.1397; train_optim_loss: 42374.1397; val_kl_reg_loss: 2710.0496; val_edge_recon_loss: 26242.5181; val_gene_expr_recon_loss: 12470.2742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41422.8417; val_optim_loss: 41422.8417
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 2734.5266; train_edge_recon_loss: 27069.8974; train_gene_expr_recon_loss: 12574.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42379.3042; train_optim_loss: 42379.3042; val_kl_reg_loss: 2705.4290; val_edge_recon_loss: 26244.8149; val_gene_expr_recon_loss: 12461.5134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41411.7571; val_optim_loss: 41411.7571
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9975; val_auprc_score: 0.9974; val_best_acc_score: 0.9773; val_best_f1_score: 0.9774; train_kl_reg_loss: 2733.2793; train_edge_recon_loss: 27075.2371; train_gene_expr_recon_loss: 12576.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42384.9598; train_optim_loss: 42384.9598; val_kl_reg_loss: 2704.9729; val_edge_recon_loss: 26213.3819; val_gene_expr_recon_loss: 12473.8109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41392.1657; val_optim_loss: 41392.1657
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2734.1216; train_edge_recon_loss: 27074.5541; train_gene_expr_recon_loss: 12574.3749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42383.0506; train_optim_loss: 42383.0506; val_kl_reg_loss: 2702.9559; val_edge_recon_loss: 26230.0687; val_gene_expr_recon_loss: 12475.8448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41408.8697; val_optim_loss: 41408.8697
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2734.1732; train_edge_recon_loss: 27073.8149; train_gene_expr_recon_loss: 12571.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42379.2324; train_optim_loss: 42379.2324; val_kl_reg_loss: 2709.9780; val_edge_recon_loss: 26228.0885; val_gene_expr_recon_loss: 12477.7041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41415.7707; val_optim_loss: 41415.7707
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9765; val_best_f1_score: 0.9766; train_kl_reg_loss: 2734.5107; train_edge_recon_loss: 27069.5958; train_gene_expr_recon_loss: 12571.7117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42375.8181; train_optim_loss: 42375.8181; val_kl_reg_loss: 2711.9631; val_edge_recon_loss: 26248.7112; val_gene_expr_recon_loss: 12469.8534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41430.5276; val_optim_loss: 41430.5276
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9973; val_auprc_score: 0.9972; val_best_acc_score: 0.9766; val_best_f1_score: 0.9766; train_kl_reg_loss: 2734.3956; train_edge_recon_loss: 27071.6058; train_gene_expr_recon_loss: 12569.0757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42375.0772; train_optim_loss: 42375.0772; val_kl_reg_loss: 2710.0739; val_edge_recon_loss: 26253.6824; val_gene_expr_recon_loss: 12476.4343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41440.1907; val_optim_loss: 41440.1907

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9974; val_auprc_score: 0.9973; val_best_acc_score: 0.9769; val_best_f1_score: 0.9769; train_kl_reg_loss: 2734.1363; train_edge_recon_loss: 27072.4476; train_gene_expr_recon_loss: 12572.7817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42379.3656; train_optim_loss: 42379.3656; val_kl_reg_loss: 2710.4674; val_edge_recon_loss: 26242.3910; val_gene_expr_recon_loss: 12475.5221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41428.3805; val_optim_loss: 41428.3805
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9768; val_best_f1_score: 0.9769; train_kl_reg_loss: 2734.9904; train_edge_recon_loss: 27069.0269; train_gene_expr_recon_loss: 12572.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42376.6216; train_optim_loss: 42376.6216; val_kl_reg_loss: 2711.9464; val_edge_recon_loss: 26250.1105; val_gene_expr_recon_loss: 12470.0318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41432.0888; val_optim_loss: 41432.0888
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9973; val_auprc_score: 0.9971; val_best_acc_score: 0.9765; val_best_f1_score: 0.9765; train_kl_reg_loss: 2734.2160; train_edge_recon_loss: 27069.9276; train_gene_expr_recon_loss: 12574.5513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42378.6949; train_optim_loss: 42378.6949; val_kl_reg_loss: 2710.0234; val_edge_recon_loss: 26241.9347; val_gene_expr_recon_loss: 12457.2192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41409.1774; val_optim_loss: 41409.1774
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9767; val_best_f1_score: 0.9767; train_kl_reg_loss: 2735.0107; train_edge_recon_loss: 27067.1217; train_gene_expr_recon_loss: 12572.3896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42374.5220; train_optim_loss: 42374.5220; val_kl_reg_loss: 2711.6789; val_edge_recon_loss: 26225.7866; val_gene_expr_recon_loss: 12474.4505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41411.9160; val_optim_loss: 41411.9160

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 346 min 41 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9973
Val best accuracy score: 0.9772
Val best F1 score: 0.9772
Val gene expr MSE score: 8.6385

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
