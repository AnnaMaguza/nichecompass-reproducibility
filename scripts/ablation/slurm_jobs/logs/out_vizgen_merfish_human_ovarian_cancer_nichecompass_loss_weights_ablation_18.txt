None
Run timestamp: 05072023_033005_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9901; val_auprc_score: 0.9899; val_best_acc_score: 0.9501; val_best_f1_score: 0.9502; train_kl_reg_loss: 2484.9134; train_edge_recon_loss: 28285.5192; train_gene_expr_recon_loss: 15274.5928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46045.0253; train_optim_loss: 46045.0253; val_kl_reg_loss: 2473.8570; val_edge_recon_loss: 26887.2982; val_gene_expr_recon_loss: 13792.5626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43153.7179; val_optim_loss: 43153.7179
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9937; val_auprc_score: 0.9935; val_best_acc_score: 0.9611; val_best_f1_score: 0.9613; train_kl_reg_loss: 2608.4072; train_edge_recon_loss: 27605.8872; train_gene_expr_recon_loss: 13634.9843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43849.2787; train_optim_loss: 43849.2787; val_kl_reg_loss: 2669.6539; val_edge_recon_loss: 26696.3726; val_gene_expr_recon_loss: 13220.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42586.8624; val_optim_loss: 42586.8624
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9945; val_auprc_score: 0.9944; val_best_acc_score: 0.9641; val_best_f1_score: 0.9641; train_kl_reg_loss: 2645.0378; train_edge_recon_loss: 27445.1685; train_gene_expr_recon_loss: 13291.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43381.8917; train_optim_loss: 43381.8917; val_kl_reg_loss: 2628.6605; val_edge_recon_loss: 26558.6023; val_gene_expr_recon_loss: 13017.4257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42204.6887; val_optim_loss: 42204.6887
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9948; val_auprc_score: 0.9947; val_best_acc_score: 0.9651; val_best_f1_score: 0.9651; train_kl_reg_loss: 2666.3390; train_edge_recon_loss: 27361.0393; train_gene_expr_recon_loss: 13135.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43163.0244; train_optim_loss: 43163.0244; val_kl_reg_loss: 2674.6105; val_edge_recon_loss: 26492.0333; val_gene_expr_recon_loss: 12924.1722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42090.8161; val_optim_loss: 42090.8161
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9953; val_auprc_score: 0.9950; val_best_acc_score: 0.9676; val_best_f1_score: 0.9677; train_kl_reg_loss: 2681.4541; train_edge_recon_loss: 27307.0784; train_gene_expr_recon_loss: 13053.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43041.6385; train_optim_loss: 43041.6385; val_kl_reg_loss: 2648.3485; val_edge_recon_loss: 26433.0944; val_gene_expr_recon_loss: 12849.9845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41931.4273; val_optim_loss: 41931.4273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9956; val_auprc_score: 0.9955; val_best_acc_score: 0.9686; val_best_f1_score: 0.9686; train_kl_reg_loss: 2692.2304; train_edge_recon_loss: 27270.8534; train_gene_expr_recon_loss: 12997.6521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42960.7358; train_optim_loss: 42960.7358; val_kl_reg_loss: 2595.5994; val_edge_recon_loss: 26390.0628; val_gene_expr_recon_loss: 12822.2265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41807.8888; val_optim_loss: 41807.8888
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9956; val_best_acc_score: 0.9697; val_best_f1_score: 0.9697; train_kl_reg_loss: 2702.2241; train_edge_recon_loss: 27241.6471; train_gene_expr_recon_loss: 12959.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42903.1202; train_optim_loss: 42903.1202; val_kl_reg_loss: 2717.6319; val_edge_recon_loss: 26326.9819; val_gene_expr_recon_loss: 12809.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41854.4978; val_optim_loss: 41854.4978
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9957; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 2709.0950; train_edge_recon_loss: 27225.5407; train_gene_expr_recon_loss: 12934.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42869.1803; train_optim_loss: 42869.1803; val_kl_reg_loss: 2723.2769; val_edge_recon_loss: 26345.7623; val_gene_expr_recon_loss: 12790.9510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41859.9902; val_optim_loss: 41859.9902
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9959; val_best_acc_score: 0.9713; val_best_f1_score: 0.9714; train_kl_reg_loss: 2715.8629; train_edge_recon_loss: 27210.0426; train_gene_expr_recon_loss: 12911.5394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42837.4449; train_optim_loss: 42837.4449; val_kl_reg_loss: 2635.3178; val_edge_recon_loss: 26313.1093; val_gene_expr_recon_loss: 12775.1802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41723.6074; val_optim_loss: 41723.6074
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9962; val_best_acc_score: 0.9717; val_best_f1_score: 0.9718; train_kl_reg_loss: 2720.6682; train_edge_recon_loss: 27186.5504; train_gene_expr_recon_loss: 12896.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42803.8160; train_optim_loss: 42803.8160; val_kl_reg_loss: 2707.4019; val_edge_recon_loss: 26294.8782; val_gene_expr_recon_loss: 12760.2957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41762.5761; val_optim_loss: 41762.5761
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9724; val_best_f1_score: 0.9724; train_kl_reg_loss: 2722.1602; train_edge_recon_loss: 27180.0711; train_gene_expr_recon_loss: 12887.5012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42789.7325; train_optim_loss: 42789.7325; val_kl_reg_loss: 2698.9134; val_edge_recon_loss: 26321.0337; val_gene_expr_recon_loss: 12741.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41761.7619; val_optim_loss: 41761.7619
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9717; val_best_f1_score: 0.9717; train_kl_reg_loss: 2726.4550; train_edge_recon_loss: 27166.3655; train_gene_expr_recon_loss: 12868.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42761.4540; train_optim_loss: 42761.4540; val_kl_reg_loss: 2670.5068; val_edge_recon_loss: 26306.6232; val_gene_expr_recon_loss: 12746.9843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41724.1142; val_optim_loss: 41724.1142
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9963; val_best_acc_score: 0.9727; val_best_f1_score: 0.9728; train_kl_reg_loss: 2729.8181; train_edge_recon_loss: 27159.0897; train_gene_expr_recon_loss: 12864.6072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42753.5150; train_optim_loss: 42753.5150; val_kl_reg_loss: 2725.0820; val_edge_recon_loss: 26274.5543; val_gene_expr_recon_loss: 12736.8757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41736.5119; val_optim_loss: 41736.5119

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9967; val_best_acc_score: 0.9745; val_best_f1_score: 0.9745; train_kl_reg_loss: 2733.8517; train_edge_recon_loss: 27107.8392; train_gene_expr_recon_loss: 12788.1020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42629.7929; train_optim_loss: 42629.7929; val_kl_reg_loss: 2716.0544; val_edge_recon_loss: 26236.9633; val_gene_expr_recon_loss: 12673.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41626.0396; val_optim_loss: 41626.0396
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9970; val_auprc_score: 0.9968; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 2730.0456; train_edge_recon_loss: 27110.5533; train_gene_expr_recon_loss: 12776.7925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42617.3914; train_optim_loss: 42617.3914; val_kl_reg_loss: 2681.5709; val_edge_recon_loss: 26242.3953; val_gene_expr_recon_loss: 12666.7853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41590.7514; val_optim_loss: 41590.7514
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9969; val_best_acc_score: 0.9752; val_best_f1_score: 0.9752; train_kl_reg_loss: 2729.1558; train_edge_recon_loss: 27112.2778; train_gene_expr_recon_loss: 12767.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42609.1522; train_optim_loss: 42609.1522; val_kl_reg_loss: 2700.8866; val_edge_recon_loss: 26238.4803; val_gene_expr_recon_loss: 12652.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41591.5283; val_optim_loss: 41591.5283
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9751; val_best_f1_score: 0.9751; train_kl_reg_loss: 2730.4207; train_edge_recon_loss: 27104.1059; train_gene_expr_recon_loss: 12761.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42596.3633; train_optim_loss: 42596.3633; val_kl_reg_loss: 2698.9412; val_edge_recon_loss: 26242.5086; val_gene_expr_recon_loss: 12654.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41596.1400; val_optim_loss: 41596.1400
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9969; val_best_acc_score: 0.9750; val_best_f1_score: 0.9750; train_kl_reg_loss: 2728.4758; train_edge_recon_loss: 27109.9266; train_gene_expr_recon_loss: 12756.2723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42594.6746; train_optim_loss: 42594.6746; val_kl_reg_loss: 2705.5239; val_edge_recon_loss: 26252.5071; val_gene_expr_recon_loss: 12646.4085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41604.4395; val_optim_loss: 41604.4395
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9759; val_best_f1_score: 0.9759; train_kl_reg_loss: 2729.4469; train_edge_recon_loss: 27105.7795; train_gene_expr_recon_loss: 12752.6446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42587.8709; train_optim_loss: 42587.8709; val_kl_reg_loss: 2719.1846; val_edge_recon_loss: 26233.4452; val_gene_expr_recon_loss: 12660.2554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41612.8853; val_optim_loss: 41612.8853

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9971; val_auprc_score: 0.9968; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 2731.2973; train_edge_recon_loss: 27094.7247; train_gene_expr_recon_loss: 12743.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42569.8361; train_optim_loss: 42569.8361; val_kl_reg_loss: 2705.7929; val_edge_recon_loss: 26230.3178; val_gene_expr_recon_loss: 12637.9256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41574.0363; val_optim_loss: 41574.0363
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2731.1552; train_edge_recon_loss: 27093.4758; train_gene_expr_recon_loss: 12743.2303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42567.8614; train_optim_loss: 42567.8614; val_kl_reg_loss: 2698.4185; val_edge_recon_loss: 26231.7589; val_gene_expr_recon_loss: 12642.0053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41572.1826; val_optim_loss: 41572.1826
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9760; val_best_f1_score: 0.9761; train_kl_reg_loss: 2728.0577; train_edge_recon_loss: 27111.8886; train_gene_expr_recon_loss: 12742.6903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42582.6366; train_optim_loss: 42582.6366; val_kl_reg_loss: 2704.2758; val_edge_recon_loss: 26206.6928; val_gene_expr_recon_loss: 12634.4096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41545.3782; val_optim_loss: 41545.3782
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9757; val_best_f1_score: 0.9757; train_kl_reg_loss: 2730.4360; train_edge_recon_loss: 27100.4024; train_gene_expr_recon_loss: 12739.2209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42570.0594; train_optim_loss: 42570.0594; val_kl_reg_loss: 2697.9552; val_edge_recon_loss: 26242.7179; val_gene_expr_recon_loss: 12638.5738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41579.2470; val_optim_loss: 41579.2470
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 2729.3333; train_edge_recon_loss: 27101.2949; train_gene_expr_recon_loss: 12739.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42570.4120; train_optim_loss: 42570.4120; val_kl_reg_loss: 2700.9645; val_edge_recon_loss: 26232.2009; val_gene_expr_recon_loss: 12637.3956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41570.5612; val_optim_loss: 41570.5612
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9761; val_best_f1_score: 0.9761; train_kl_reg_loss: 2728.3557; train_edge_recon_loss: 27107.3867; train_gene_expr_recon_loss: 12737.6683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42573.4107; train_optim_loss: 42573.4107; val_kl_reg_loss: 2700.8712; val_edge_recon_loss: 26225.1528; val_gene_expr_recon_loss: 12638.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41564.0525; val_optim_loss: 41564.0525
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9970; val_best_acc_score: 0.9757; val_best_f1_score: 0.9758; train_kl_reg_loss: 2730.1261; train_edge_recon_loss: 27097.6590; train_gene_expr_recon_loss: 12736.1878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42563.9729; train_optim_loss: 42563.9729; val_kl_reg_loss: 2701.4767; val_edge_recon_loss: 26236.3405; val_gene_expr_recon_loss: 12641.6756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41579.4927; val_optim_loss: 41579.4927

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9972; val_auprc_score: 0.9971; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 2728.6086; train_edge_recon_loss: 27102.2992; train_gene_expr_recon_loss: 12739.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42570.1930; train_optim_loss: 42570.1930; val_kl_reg_loss: 2705.7043; val_edge_recon_loss: 26237.0884; val_gene_expr_recon_loss: 12628.7740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41571.5667; val_optim_loss: 41571.5667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9756; val_best_f1_score: 0.9757; train_kl_reg_loss: 2729.9123; train_edge_recon_loss: 27097.6544; train_gene_expr_recon_loss: 12734.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42561.8028; train_optim_loss: 42561.8028; val_kl_reg_loss: 2707.6665; val_edge_recon_loss: 26232.5465; val_gene_expr_recon_loss: 12636.8194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41577.0325; val_optim_loss: 41577.0325
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9754; val_best_f1_score: 0.9754; train_kl_reg_loss: 2729.8854; train_edge_recon_loss: 27101.9354; train_gene_expr_recon_loss: 12734.6694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42566.4902; train_optim_loss: 42566.4902; val_kl_reg_loss: 2705.1493; val_edge_recon_loss: 26240.7270; val_gene_expr_recon_loss: 12638.0025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41583.8787; val_optim_loss: 41583.8787
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9970; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 2729.2781; train_edge_recon_loss: 27102.0933; train_gene_expr_recon_loss: 12735.3117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42566.6831; train_optim_loss: 42566.6831; val_kl_reg_loss: 2705.4913; val_edge_recon_loss: 26250.3491; val_gene_expr_recon_loss: 12630.4438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41586.2843; val_optim_loss: 41586.2843

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 211 min 17 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9972
Val AUPRC score: 0.9971
Val best accuracy score: 0.9756
Val best F1 score: 0.9757
Val gene expr MSE score: 8.5903

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
