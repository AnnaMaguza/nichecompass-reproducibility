None
Run timestamp: 05072023_003829_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9926; val_auprc_score: 0.9923; val_best_acc_score: 0.9584; val_best_f1_score: 0.9584; train_kl_reg_loss: 2175.4956; train_edge_recon_loss: 27640.1301; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29815.6258; train_optim_loss: 29815.6258; val_kl_reg_loss: 2296.5174; val_edge_recon_loss: 26068.3091; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28364.8266; val_optim_loss: 28364.8266
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9949; val_auprc_score: 0.9944; val_best_acc_score: 0.9671; val_best_f1_score: 0.9672; train_kl_reg_loss: 2268.1916; train_edge_recon_loss: 27227.1929; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29495.3844; train_optim_loss: 29495.3844; val_kl_reg_loss: 2201.3449; val_edge_recon_loss: 26018.3986; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28219.7435; val_optim_loss: 28219.7435
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9953; val_best_acc_score: 0.9698; val_best_f1_score: 0.9699; train_kl_reg_loss: 2280.1215; train_edge_recon_loss: 27160.9732; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29441.0947; train_optim_loss: 29441.0947; val_kl_reg_loss: 2300.7776; val_edge_recon_loss: 25971.7258; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28272.5034; val_optim_loss: 28272.5034
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 2287.0640; train_edge_recon_loss: 27126.0943; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29413.1583; train_optim_loss: 29413.1583; val_kl_reg_loss: 2180.4117; val_edge_recon_loss: 25925.3450; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28105.7567; val_optim_loss: 28105.7567
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9970; val_auprc_score: 0.9966; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 2291.1003; train_edge_recon_loss: 27094.3529; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29385.4532; train_optim_loss: 29385.4532; val_kl_reg_loss: 2274.6661; val_edge_recon_loss: 25885.7098; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28160.3759; val_optim_loss: 28160.3759
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9967; val_auprc_score: 0.9963; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 2293.5391; train_edge_recon_loss: 27075.8003; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29369.3393; train_optim_loss: 29369.3393; val_kl_reg_loss: 2268.1408; val_edge_recon_loss: 25887.1730; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28155.3138; val_optim_loss: 28155.3138
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 2294.3100; train_edge_recon_loss: 27061.2471; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29355.5571; train_optim_loss: 29355.5571; val_kl_reg_loss: 2248.8382; val_edge_recon_loss: 25855.1821; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28104.0203; val_optim_loss: 28104.0203
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9784; val_best_f1_score: 0.9785; train_kl_reg_loss: 2296.2299; train_edge_recon_loss: 27045.1076; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29341.3375; train_optim_loss: 29341.3375; val_kl_reg_loss: 2333.1867; val_edge_recon_loss: 25858.9491; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28192.1358; val_optim_loss: 28192.1358
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9800; val_best_f1_score: 0.9800; train_kl_reg_loss: 2297.7615; train_edge_recon_loss: 27031.8928; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29329.6543; train_optim_loss: 29329.6543; val_kl_reg_loss: 2329.9032; val_edge_recon_loss: 25831.0334; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28160.9367; val_optim_loss: 28160.9367
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 2299.0846; train_edge_recon_loss: 27024.0449; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29323.1295; train_optim_loss: 29323.1295; val_kl_reg_loss: 2261.1399; val_edge_recon_loss: 25821.5292; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28082.6691; val_optim_loss: 28082.6691
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9808; train_kl_reg_loss: 2300.7563; train_edge_recon_loss: 27013.4149; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29314.1712; train_optim_loss: 29314.1712; val_kl_reg_loss: 2257.0732; val_edge_recon_loss: 25815.3013; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28072.3746; val_optim_loss: 28072.3746
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 2303.1067; train_edge_recon_loss: 26997.4490; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29300.5557; train_optim_loss: 29300.5557; val_kl_reg_loss: 2282.6082; val_edge_recon_loss: 25808.3831; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28090.9913; val_optim_loss: 28090.9913
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9818; val_best_f1_score: 0.9818; train_kl_reg_loss: 2302.7730; train_edge_recon_loss: 26994.7306; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29297.5036; train_optim_loss: 29297.5036; val_kl_reg_loss: 2310.8026; val_edge_recon_loss: 25812.4620; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28123.2646; val_optim_loss: 28123.2646
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 2303.7152; train_edge_recon_loss: 26986.8825; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29290.5977; train_optim_loss: 29290.5977; val_kl_reg_loss: 2320.2442; val_edge_recon_loss: 25781.4140; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28101.6582; val_optim_loss: 28101.6582
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9820; val_best_f1_score: 0.9820; train_kl_reg_loss: 2303.8711; train_edge_recon_loss: 26983.5602; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29287.4313; train_optim_loss: 29287.4313; val_kl_reg_loss: 2279.7501; val_edge_recon_loss: 25794.9006; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28074.6507; val_optim_loss: 28074.6507

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9838; val_best_f1_score: 0.9838; train_kl_reg_loss: 2299.1607; train_edge_recon_loss: 26945.0188; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29244.1795; train_optim_loss: 29244.1795; val_kl_reg_loss: 2295.1588; val_edge_recon_loss: 25738.5042; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28033.6631; val_optim_loss: 28033.6631
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9836; val_best_f1_score: 0.9836; train_kl_reg_loss: 2299.4812; train_edge_recon_loss: 26935.0365; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29234.5177; train_optim_loss: 29234.5177; val_kl_reg_loss: 2289.4874; val_edge_recon_loss: 25744.6648; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28034.1522; val_optim_loss: 28034.1522
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9844; val_best_f1_score: 0.9844; train_kl_reg_loss: 2298.6347; train_edge_recon_loss: 26933.6041; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29232.2387; train_optim_loss: 29232.2387; val_kl_reg_loss: 2289.1378; val_edge_recon_loss: 25737.6997; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28026.8374; val_optim_loss: 28026.8374
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2296.4197; train_edge_recon_loss: 26940.3672; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29236.7869; train_optim_loss: 29236.7869; val_kl_reg_loss: 2296.9143; val_edge_recon_loss: 25727.1460; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28024.0603; val_optim_loss: 28024.0603
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9841; val_best_f1_score: 0.9841; train_kl_reg_loss: 2296.9039; train_edge_recon_loss: 26931.5702; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29228.4741; train_optim_loss: 29228.4741; val_kl_reg_loss: 2299.2601; val_edge_recon_loss: 25741.6322; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28040.8923; val_optim_loss: 28040.8923
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 2297.2486; train_edge_recon_loss: 26930.6320; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29227.8806; train_optim_loss: 29227.8806; val_kl_reg_loss: 2297.3374; val_edge_recon_loss: 25723.5909; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28020.9283; val_optim_loss: 28020.9283
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9843; val_best_f1_score: 0.9843; train_kl_reg_loss: 2296.8987; train_edge_recon_loss: 26927.2860; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29224.1847; train_optim_loss: 29224.1847; val_kl_reg_loss: 2296.0553; val_edge_recon_loss: 25736.6657; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28032.7211; val_optim_loss: 28032.7211
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9847; val_best_f1_score: 0.9847; train_kl_reg_loss: 2296.5058; train_edge_recon_loss: 26925.8376; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29222.3434; train_optim_loss: 29222.3434; val_kl_reg_loss: 2310.8499; val_edge_recon_loss: 25724.1703; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28035.0202; val_optim_loss: 28035.0202
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9844; val_best_f1_score: 0.9844; train_kl_reg_loss: 2296.5071; train_edge_recon_loss: 26926.3458; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29222.8528; train_optim_loss: 29222.8528; val_kl_reg_loss: 2283.4764; val_edge_recon_loss: 25722.5811; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28006.0575; val_optim_loss: 28006.0575
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 2296.1337; train_edge_recon_loss: 26925.6525; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29221.7862; train_optim_loss: 29221.7862; val_kl_reg_loss: 2294.6860; val_edge_recon_loss: 25723.6417; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28018.3276; val_optim_loss: 28018.3276
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9853; val_best_f1_score: 0.9853; train_kl_reg_loss: 2295.5463; train_edge_recon_loss: 26925.7279; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29221.2742; train_optim_loss: 29221.2742; val_kl_reg_loss: 2286.5149; val_edge_recon_loss: 25719.2732; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28005.7881; val_optim_loss: 28005.7881
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2296.5515; train_edge_recon_loss: 26923.0253; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29219.5768; train_optim_loss: 29219.5768; val_kl_reg_loss: 2314.7306; val_edge_recon_loss: 25724.2900; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28039.0206; val_optim_loss: 28039.0206
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9849; train_kl_reg_loss: 2295.9123; train_edge_recon_loss: 26921.8655; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29217.7778; train_optim_loss: 29217.7778; val_kl_reg_loss: 2307.3833; val_edge_recon_loss: 25722.9256; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28030.3089; val_optim_loss: 28030.3089
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2298.2620; train_edge_recon_loss: 26909.6601; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29207.9221; train_optim_loss: 29207.9221; val_kl_reg_loss: 2292.4257; val_edge_recon_loss: 25709.3889; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28001.8147; val_optim_loss: 28001.8147
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 2297.6828; train_edge_recon_loss: 26914.6591; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29212.3419; train_optim_loss: 29212.3419; val_kl_reg_loss: 2307.3806; val_edge_recon_loss: 25726.2725; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28033.6531; val_optim_loss: 28033.6531
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 2295.4414; train_edge_recon_loss: 26921.1002; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29216.5416; train_optim_loss: 29216.5416; val_kl_reg_loss: 2301.0688; val_edge_recon_loss: 25722.5573; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28023.6260; val_optim_loss: 28023.6260
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2296.9976; train_edge_recon_loss: 26913.4432; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29210.4408; train_optim_loss: 29210.4408; val_kl_reg_loss: 2300.9433; val_edge_recon_loss: 25727.6489; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28028.5922; val_optim_loss: 28028.5922
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9854; val_best_f1_score: 0.9854; train_kl_reg_loss: 2296.6746; train_edge_recon_loss: 26915.5700; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29212.2446; train_optim_loss: 29212.2446; val_kl_reg_loss: 2297.9158; val_edge_recon_loss: 25713.7313; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28011.6471; val_optim_loss: 28011.6471

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9856; val_best_f1_score: 0.9856; train_kl_reg_loss: 2294.9588; train_edge_recon_loss: 26912.5656; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29207.5244; train_optim_loss: 29207.5244; val_kl_reg_loss: 2296.2148; val_edge_recon_loss: 25696.9715; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27993.1863; val_optim_loss: 27993.1863
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 2294.2481; train_edge_recon_loss: 26915.9584; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29210.2065; train_optim_loss: 29210.2065; val_kl_reg_loss: 2296.4809; val_edge_recon_loss: 25720.9495; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28017.4304; val_optim_loss: 28017.4304
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9856; val_best_f1_score: 0.9856; train_kl_reg_loss: 2295.2995; train_edge_recon_loss: 26910.0973; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29205.3968; train_optim_loss: 29205.3968; val_kl_reg_loss: 2297.0100; val_edge_recon_loss: 25713.2821; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28010.2921; val_optim_loss: 28010.2921
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9855; val_best_f1_score: 0.9855; train_kl_reg_loss: 2294.1044; train_edge_recon_loss: 26913.6625; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29207.7669; train_optim_loss: 29207.7669; val_kl_reg_loss: 2296.6626; val_edge_recon_loss: 25712.7388; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28009.4014; val_optim_loss: 28009.4014
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9853; val_best_f1_score: 0.9853; train_kl_reg_loss: 2297.0767; train_edge_recon_loss: 26903.3700; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29200.4467; train_optim_loss: 29200.4467; val_kl_reg_loss: 2297.1479; val_edge_recon_loss: 25703.8671; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28001.0150; val_optim_loss: 28001.0150

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2296.2138; train_edge_recon_loss: 26908.4861; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29204.6998; train_optim_loss: 29204.6998; val_kl_reg_loss: 2296.2992; val_edge_recon_loss: 25702.1652; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27998.4643; val_optim_loss: 27998.4643
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9858; val_best_f1_score: 0.9858; train_kl_reg_loss: 2294.7952; train_edge_recon_loss: 26909.9961; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29204.7912; train_optim_loss: 29204.7912; val_kl_reg_loss: 2295.6381; val_edge_recon_loss: 25713.9330; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28009.5711; val_optim_loss: 28009.5711
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 2294.6530; train_edge_recon_loss: 26908.7125; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29203.3655; train_optim_loss: 29203.3655; val_kl_reg_loss: 2296.5625; val_edge_recon_loss: 25706.7290; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28003.2914; val_optim_loss: 28003.2914
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2294.8050; train_edge_recon_loss: 26909.7638; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29204.5688; train_optim_loss: 29204.5688; val_kl_reg_loss: 2295.1558; val_edge_recon_loss: 25708.6314; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28003.7872; val_optim_loss: 28003.7872

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 764 min 51 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9982
Val best accuracy score: 0.9854
Val best F1 score: 0.9855
Val gene expr MSE score: 13.8742

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
