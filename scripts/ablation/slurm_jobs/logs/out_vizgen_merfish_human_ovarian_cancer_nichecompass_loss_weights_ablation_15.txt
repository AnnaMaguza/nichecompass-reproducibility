None
Run timestamp: 14072023_204029_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9793; val_auprc_score: 0.9784; val_best_acc_score: 0.9264; val_best_f1_score: 0.9270; train_kl_reg_loss: 123849.2164; train_edge_recon_loss: 27398749.5640; train_gene_expr_recon_loss: 13795160.9705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41317759.7947; train_optim_loss: 41317759.7947; val_kl_reg_loss: 102840.0640; val_edge_recon_loss: 26538655.0253; val_gene_expr_recon_loss: 13063523.8797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39705018.8987; val_optim_loss: 39705018.8987
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9900; val_auprc_score: 0.9894; val_best_acc_score: 0.9511; val_best_f1_score: 0.9515; train_kl_reg_loss: 86068.2016; train_edge_recon_loss: 26257082.6857; train_gene_expr_recon_loss: 12921484.8857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39264635.8059; train_optim_loss: 39264635.8059; val_kl_reg_loss: 74254.9708; val_edge_recon_loss: 26290942.0380; val_gene_expr_recon_loss: 12852900.4810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39218097.4557; val_optim_loss: 39218097.4557
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9919; val_best_acc_score: 0.9592; val_best_f1_score: 0.9594; train_kl_reg_loss: 68938.4534; train_edge_recon_loss: 26083211.8340; train_gene_expr_recon_loss: 12780263.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38932414.2180; train_optim_loss: 38932414.2180; val_kl_reg_loss: 64024.4007; val_edge_recon_loss: 26141972.8671; val_gene_expr_recon_loss: 12771463.2405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38977460.4937; val_optim_loss: 38977460.4937
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9941; val_auprc_score: 0.9935; val_best_acc_score: 0.9642; val_best_f1_score: 0.9643; train_kl_reg_loss: 61565.2444; train_edge_recon_loss: 26001890.7152; train_gene_expr_recon_loss: 12711110.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38774566.2349; train_optim_loss: 38774566.2349; val_kl_reg_loss: 56834.7583; val_edge_recon_loss: 26094520.3038; val_gene_expr_recon_loss: 12693748.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38845103.8734; val_optim_loss: 38845103.8734
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9935; val_best_acc_score: 0.9642; val_best_f1_score: 0.9643; train_kl_reg_loss: 58113.3531; train_edge_recon_loss: 25948997.6055; train_gene_expr_recon_loss: 12655402.5176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38662513.4923; train_optim_loss: 38662513.4923; val_kl_reg_loss: 57102.8842; val_edge_recon_loss: 26066497.5000; val_gene_expr_recon_loss: 12653947.8987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38777548.2785; val_optim_loss: 38777548.2785
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9948; val_auprc_score: 0.9942; val_best_acc_score: 0.9668; val_best_f1_score: 0.9670; train_kl_reg_loss: 56317.1769; train_edge_recon_loss: 25915360.5035; train_gene_expr_recon_loss: 12617277.0851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38588954.7511; train_optim_loss: 38588954.7511; val_kl_reg_loss: 53975.7718; val_edge_recon_loss: 26018025.2152; val_gene_expr_recon_loss: 12618005.3101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38690006.2405; val_optim_loss: 38690006.2405
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9952; val_auprc_score: 0.9947; val_best_acc_score: 0.9688; val_best_f1_score: 0.9691; train_kl_reg_loss: 53678.9439; train_edge_recon_loss: 25904291.8108; train_gene_expr_recon_loss: 12596514.7458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38554485.4754; train_optim_loss: 38554485.4754; val_kl_reg_loss: 50767.0024; val_edge_recon_loss: 26007111.5000; val_gene_expr_recon_loss: 12606897.4715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38664775.8608; val_optim_loss: 38664775.8608
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9955; val_auprc_score: 0.9949; val_best_acc_score: 0.9698; val_best_f1_score: 0.9700; train_kl_reg_loss: 51895.2792; train_edge_recon_loss: 25883332.4662; train_gene_expr_recon_loss: 12569989.4371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38505217.1702; train_optim_loss: 38505217.1702; val_kl_reg_loss: 49896.4461; val_edge_recon_loss: 25993854.6709; val_gene_expr_recon_loss: 12592277.0285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38636028.0886; val_optim_loss: 38636028.0886
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9956; val_auprc_score: 0.9950; val_best_acc_score: 0.9705; val_best_f1_score: 0.9707; train_kl_reg_loss: 50398.6942; train_edge_recon_loss: 25867266.4473; train_gene_expr_recon_loss: 12556732.1188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38474397.2686; train_optim_loss: 38474397.2686; val_kl_reg_loss: 48735.3595; val_edge_recon_loss: 25968043.4937; val_gene_expr_recon_loss: 12584762.0823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38601540.9367; val_optim_loss: 38601540.9367
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9959; val_auprc_score: 0.9954; val_best_acc_score: 0.9715; val_best_f1_score: 0.9716; train_kl_reg_loss: 49622.6806; train_edge_recon_loss: 25843410.2461; train_gene_expr_recon_loss: 12542219.1150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38435252.0717; train_optim_loss: 38435252.0717; val_kl_reg_loss: 48086.7164; val_edge_recon_loss: 25993311.6709; val_gene_expr_recon_loss: 12589952.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38631350.7089; val_optim_loss: 38631350.7089
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9715; val_best_f1_score: 0.9717; train_kl_reg_loss: 48827.5573; train_edge_recon_loss: 25834879.8657; train_gene_expr_recon_loss: 12527393.5577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38411100.9789; train_optim_loss: 38411100.9789; val_kl_reg_loss: 48019.4612; val_edge_recon_loss: 25952877.4241; val_gene_expr_recon_loss: 12583239.9525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38584137.0253; val_optim_loss: 38584137.0253
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9955; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 48368.9015; train_edge_recon_loss: 25826572.9965; train_gene_expr_recon_loss: 12516729.7293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38391671.6526; train_optim_loss: 38391671.6526; val_kl_reg_loss: 47984.8957; val_edge_recon_loss: 25937413.4177; val_gene_expr_recon_loss: 12555780.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38541179.1392; val_optim_loss: 38541179.1392
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9965; val_auprc_score: 0.9960; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 47881.2610; train_edge_recon_loss: 25816656.2968; train_gene_expr_recon_loss: 12509999.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38374537.5274; train_optim_loss: 38374537.5274; val_kl_reg_loss: 46645.2938; val_edge_recon_loss: 25924715.4241; val_gene_expr_recon_loss: 12556008.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38527369.4684; val_optim_loss: 38527369.4684
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9741; val_best_f1_score: 0.9743; train_kl_reg_loss: 47365.5786; train_edge_recon_loss: 25810433.6857; train_gene_expr_recon_loss: 12501989.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38359789.0506; train_optim_loss: 38359789.0506; val_kl_reg_loss: 48016.6985; val_edge_recon_loss: 25919065.6013; val_gene_expr_recon_loss: 12573805.0348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38540887.2532; val_optim_loss: 38540887.2532
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 47241.3039; train_edge_recon_loss: 25798332.8165; train_gene_expr_recon_loss: 12492618.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38338192.7075; train_optim_loss: 38338192.7075; val_kl_reg_loss: 47309.2414; val_edge_recon_loss: 25902263.2089; val_gene_expr_recon_loss: 12548342.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38497914.7975; val_optim_loss: 38497914.7975
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9745; val_best_f1_score: 0.9747; train_kl_reg_loss: 46825.6515; train_edge_recon_loss: 25784875.8087; train_gene_expr_recon_loss: 12482755.5805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38314457.0520; train_optim_loss: 38314457.0520; val_kl_reg_loss: 47437.8284; val_edge_recon_loss: 25884916.2278; val_gene_expr_recon_loss: 12539521.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38471875.3671; val_optim_loss: 38471875.3671
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9962; val_best_acc_score: 0.9755; val_best_f1_score: 0.9756; train_kl_reg_loss: 46768.3165; train_edge_recon_loss: 25782891.5127; train_gene_expr_recon_loss: 12482138.7750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38311798.6217; train_optim_loss: 38311798.6217; val_kl_reg_loss: 46005.6465; val_edge_recon_loss: 25880613.9494; val_gene_expr_recon_loss: 12546396.9399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38473016.5316; val_optim_loss: 38473016.5316
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9747; val_best_f1_score: 0.9749; train_kl_reg_loss: 46479.7135; train_edge_recon_loss: 25781624.9304; train_gene_expr_recon_loss: 12478708.4698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38306813.1392; train_optim_loss: 38306813.1392; val_kl_reg_loss: 45484.2474; val_edge_recon_loss: 25888230.9494; val_gene_expr_recon_loss: 12557061.3354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38490776.5443; val_optim_loss: 38490776.5443
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9753; val_best_f1_score: 0.9754; train_kl_reg_loss: 46337.1419; train_edge_recon_loss: 25768863.6055; train_gene_expr_recon_loss: 12474568.6776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38289769.3980; train_optim_loss: 38289769.3980; val_kl_reg_loss: 45428.0055; val_edge_recon_loss: 25902187.2595; val_gene_expr_recon_loss: 12563870.6804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38511486.0253; val_optim_loss: 38511486.0253
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9762; val_best_f1_score: 0.9763; train_kl_reg_loss: 46219.7660; train_edge_recon_loss: 25771818.8221; train_gene_expr_recon_loss: 12468859.5246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38286898.1392; train_optim_loss: 38286898.1392; val_kl_reg_loss: 44887.6265; val_edge_recon_loss: 25878485.6456; val_gene_expr_recon_loss: 12539198.6329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38462571.9494; val_optim_loss: 38462571.9494
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 46163.8003; train_edge_recon_loss: 25763507.5352; train_gene_expr_recon_loss: 12465066.5461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38274737.8945; train_optim_loss: 38274737.8945; val_kl_reg_loss: 46093.4462; val_edge_recon_loss: 25860227.8671; val_gene_expr_recon_loss: 12529655.6139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38435976.8734; val_optim_loss: 38435976.8734
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 46085.4486; train_edge_recon_loss: 25765374.0323; train_gene_expr_recon_loss: 12457783.5788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38269243.1069; train_optim_loss: 38269243.1069; val_kl_reg_loss: 44812.3359; val_edge_recon_loss: 25863229.3101; val_gene_expr_recon_loss: 12548764.3291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38456806.0000; val_optim_loss: 38456806.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9770; train_kl_reg_loss: 45811.5010; train_edge_recon_loss: 25761268.8094; train_gene_expr_recon_loss: 12463929.8840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38271010.1716; train_optim_loss: 38271010.1716; val_kl_reg_loss: 45149.8961; val_edge_recon_loss: 25865489.3734; val_gene_expr_recon_loss: 12536577.1392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38447216.4304; val_optim_loss: 38447216.4304
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9964; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 45509.3515; train_edge_recon_loss: 25755327.6807; train_gene_expr_recon_loss: 12456326.1188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38257163.1463; train_optim_loss: 38257163.1463; val_kl_reg_loss: 45708.9397; val_edge_recon_loss: 25853923.8544; val_gene_expr_recon_loss: 12563783.7595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38463416.4810; val_optim_loss: 38463416.4810
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 45536.7604; train_edge_recon_loss: 25758372.6421; train_gene_expr_recon_loss: 12452708.9311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38256618.3319; train_optim_loss: 38256618.3319; val_kl_reg_loss: 44869.9494; val_edge_recon_loss: 25862775.3354; val_gene_expr_recon_loss: 12520961.7025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38428607.0506; val_optim_loss: 38428607.0506
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9965; val_best_acc_score: 0.9763; val_best_f1_score: 0.9764; train_kl_reg_loss: 45465.3031; train_edge_recon_loss: 25753883.3861; train_gene_expr_recon_loss: 12454975.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38254324.3755; train_optim_loss: 38254324.3755; val_kl_reg_loss: 46310.3874; val_edge_recon_loss: 25858226.1139; val_gene_expr_recon_loss: 12532950.6456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38437487.0633; val_optim_loss: 38437487.0633
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 45558.3847; train_edge_recon_loss: 25749288.2053; train_gene_expr_recon_loss: 12449497.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38244344.2278; train_optim_loss: 38244344.2278; val_kl_reg_loss: 46219.9111; val_edge_recon_loss: 25855558.8418; val_gene_expr_recon_loss: 12565193.4842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38466972.2152; val_optim_loss: 38466972.2152
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 45050.4022; train_edge_recon_loss: 25748046.2124; train_gene_expr_recon_loss: 12452005.9982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38245102.6020; train_optim_loss: 38245102.6020; val_kl_reg_loss: 44960.0887; val_edge_recon_loss: 25842518.1392; val_gene_expr_recon_loss: 12542577.6582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38430055.9367; val_optim_loss: 38430055.9367
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9972; val_auprc_score: 0.9968; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 45138.7926; train_edge_recon_loss: 25747749.6723; train_gene_expr_recon_loss: 12448825.4089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38241713.8368; train_optim_loss: 38241713.8368; val_kl_reg_loss: 43975.2281; val_edge_recon_loss: 25861478.3291; val_gene_expr_recon_loss: 12537957.5506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38443411.0759; val_optim_loss: 38443411.0759

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 48921.4445; train_edge_recon_loss: 25717858.4909; train_gene_expr_recon_loss: 12354302.2071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38121082.1139; train_optim_loss: 38121082.1139; val_kl_reg_loss: 49340.6890; val_edge_recon_loss: 25825675.4430; val_gene_expr_recon_loss: 12448127.2278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38323143.3544; val_optim_loss: 38323143.3544
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 50543.8529; train_edge_recon_loss: 25713508.3594; train_gene_expr_recon_loss: 12344398.9420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38108451.1364; train_optim_loss: 38108451.1364; val_kl_reg_loss: 50006.0866; val_edge_recon_loss: 25809334.6582; val_gene_expr_recon_loss: 12446876.0348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38306216.8734; val_optim_loss: 38306216.8734
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9791; val_best_f1_score: 0.9792; train_kl_reg_loss: 50649.9955; train_edge_recon_loss: 25716222.0485; train_gene_expr_recon_loss: 12342213.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38109085.6709; train_optim_loss: 38109085.6709; val_kl_reg_loss: 50233.6312; val_edge_recon_loss: 25819148.3544; val_gene_expr_recon_loss: 12432132.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38301514.2911; val_optim_loss: 38301514.2911
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 50624.0395; train_edge_recon_loss: 25713036.7707; train_gene_expr_recon_loss: 12333474.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38097135.7131; train_optim_loss: 38097135.7131; val_kl_reg_loss: 49948.1250; val_edge_recon_loss: 25802181.6076; val_gene_expr_recon_loss: 12441749.0791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38293878.8101; val_optim_loss: 38293878.8101
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 50809.0900; train_edge_recon_loss: 25714339.3087; train_gene_expr_recon_loss: 12332518.2827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38097666.7032; train_optim_loss: 38097666.7032; val_kl_reg_loss: 50057.8099; val_edge_recon_loss: 25797333.4810; val_gene_expr_recon_loss: 12427595.1139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38274986.4304; val_optim_loss: 38274986.4304
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 50719.4265; train_edge_recon_loss: 25715195.2053; train_gene_expr_recon_loss: 12331895.0767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38097809.6962; train_optim_loss: 38097809.6962; val_kl_reg_loss: 49833.7411; val_edge_recon_loss: 25818769.9620; val_gene_expr_recon_loss: 12444874.0222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38313477.7848; val_optim_loss: 38313477.7848
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9973; val_auprc_score: 0.9969; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 50775.4706; train_edge_recon_loss: 25709175.8298; train_gene_expr_recon_loss: 12329075.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38089026.4388; train_optim_loss: 38089026.4388; val_kl_reg_loss: 50130.9713; val_edge_recon_loss: 25815175.6962; val_gene_expr_recon_loss: 12422290.5854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38287597.3671; val_optim_loss: 38287597.3671
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9975; val_auprc_score: 0.9971; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 50482.7328; train_edge_recon_loss: 25710884.2229; train_gene_expr_recon_loss: 12326167.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38087534.1238; train_optim_loss: 38087534.1238; val_kl_reg_loss: 50040.8319; val_edge_recon_loss: 25825906.6709; val_gene_expr_recon_loss: 12449884.7722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38325832.1899; val_optim_loss: 38325832.1899
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 50465.9670; train_edge_recon_loss: 25708399.9430; train_gene_expr_recon_loss: 12324177.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38083042.9480; train_optim_loss: 38083042.9480; val_kl_reg_loss: 49599.5940; val_edge_recon_loss: 25829165.1266; val_gene_expr_recon_loss: 12431398.3892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38310163.0759; val_optim_loss: 38310163.0759

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 50587.4306; train_edge_recon_loss: 25711651.2940; train_gene_expr_recon_loss: 12313259.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38075498.2982; train_optim_loss: 38075498.2982; val_kl_reg_loss: 50072.4518; val_edge_recon_loss: 25805160.9241; val_gene_expr_recon_loss: 12425728.1741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38280961.5823; val_optim_loss: 38280961.5823
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9975; val_auprc_score: 0.9970; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 50887.3774; train_edge_recon_loss: 25704327.2314; train_gene_expr_recon_loss: 12311680.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38066895.0492; train_optim_loss: 38066895.0492; val_kl_reg_loss: 50276.6482; val_edge_recon_loss: 25802646.7089; val_gene_expr_recon_loss: 12426837.8006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38279761.1139; val_optim_loss: 38279761.1139
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 50955.1050; train_edge_recon_loss: 25709962.7616; train_gene_expr_recon_loss: 12304222.5907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38065140.4669; train_optim_loss: 38065140.4669; val_kl_reg_loss: 50245.1824; val_edge_recon_loss: 25815838.6203; val_gene_expr_recon_loss: 12438005.7437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38304089.5316; val_optim_loss: 38304089.5316
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9797; val_best_f1_score: 0.9798; train_kl_reg_loss: 51024.1285; train_edge_recon_loss: 25710883.3249; train_gene_expr_recon_loss: 12309166.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38071073.8594; train_optim_loss: 38071073.8594; val_kl_reg_loss: 50347.1669; val_edge_recon_loss: 25807087.4810; val_gene_expr_recon_loss: 12428459.7247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38285894.2785; val_optim_loss: 38285894.2785

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 745 min 35 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9975
Val AUPRC score: 0.9971
Val best accuracy score: 0.9795
Val best F1 score: 0.9796
Val gene expr MSE score: 8.3437

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
