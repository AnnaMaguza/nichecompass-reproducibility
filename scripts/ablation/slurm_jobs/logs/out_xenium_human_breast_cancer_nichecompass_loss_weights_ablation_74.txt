None
Run timestamp: 28072023_170107_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9664; val_auprc_score: 0.9585; val_best_acc_score: 0.9107; val_best_f1_score: 0.9142; train_kl_reg_loss: 3136.1616; train_edge_recon_loss: 29595.5626; train_gene_expr_recon_loss: 124695.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 157427.7089; train_optim_loss: 157427.7089; val_kl_reg_loss: 2963.7632; val_edge_recon_loss: 28195.6333; val_gene_expr_recon_loss: 113763.8186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 144923.2152; val_optim_loss: 144923.2152
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9753; val_auprc_score: 0.9702; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 2992.7464; train_edge_recon_loss: 28325.0293; train_gene_expr_recon_loss: 110811.6456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 142129.4214; train_optim_loss: 142129.4214; val_kl_reg_loss: 2918.1288; val_edge_recon_loss: 27599.2357; val_gene_expr_recon_loss: 107790.4599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 138307.8240; val_optim_loss: 138307.8240
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9788; val_auprc_score: 0.9751; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 2985.9893; train_edge_recon_loss: 28001.8130; train_gene_expr_recon_loss: 106775.2973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 137763.0996; train_optim_loss: 137763.0996; val_kl_reg_loss: 2924.6461; val_edge_recon_loss: 27442.3483; val_gene_expr_recon_loss: 105279.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 135646.1103; val_optim_loss: 135646.1103
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9825; val_auprc_score: 0.9802; val_best_acc_score: 0.9369; val_best_f1_score: 0.9385; train_kl_reg_loss: 2996.8101; train_edge_recon_loss: 27839.9854; train_gene_expr_recon_loss: 104909.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 135746.6724; train_optim_loss: 135746.6724; val_kl_reg_loss: 2949.4258; val_edge_recon_loss: 27263.2729; val_gene_expr_recon_loss: 103981.0999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 134193.7986; val_optim_loss: 134193.7986
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9831; val_auprc_score: 0.9804; val_best_acc_score: 0.9389; val_best_f1_score: 0.9405; train_kl_reg_loss: 3013.6985; train_edge_recon_loss: 27725.7231; train_gene_expr_recon_loss: 103944.8049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 134684.2265; train_optim_loss: 134684.2265; val_kl_reg_loss: 2975.8258; val_edge_recon_loss: 27203.3408; val_gene_expr_recon_loss: 103149.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 133328.7868; val_optim_loss: 133328.7868
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9836; val_auprc_score: 0.9811; val_best_acc_score: 0.9399; val_best_f1_score: 0.9412; train_kl_reg_loss: 3032.3878; train_edge_recon_loss: 27633.8148; train_gene_expr_recon_loss: 103346.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 134012.7614; train_optim_loss: 134012.7614; val_kl_reg_loss: 2993.8523; val_edge_recon_loss: 27141.1218; val_gene_expr_recon_loss: 102845.3821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132980.3558; val_optim_loss: 132980.3558
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9847; val_auprc_score: 0.9823; val_best_acc_score: 0.9427; val_best_f1_score: 0.9441; train_kl_reg_loss: 3041.5280; train_edge_recon_loss: 27587.2605; train_gene_expr_recon_loss: 103028.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 133657.0129; train_optim_loss: 133657.0129; val_kl_reg_loss: 2997.2402; val_edge_recon_loss: 27076.6539; val_gene_expr_recon_loss: 102510.2611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132584.1556; val_optim_loss: 132584.1556
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9858; val_auprc_score: 0.9838; val_best_acc_score: 0.9441; val_best_f1_score: 0.9453; train_kl_reg_loss: 3050.4193; train_edge_recon_loss: 27555.6510; train_gene_expr_recon_loss: 102767.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 133374.0066; train_optim_loss: 133374.0066; val_kl_reg_loss: 3010.9415; val_edge_recon_loss: 27037.6283; val_gene_expr_recon_loss: 102344.8077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132393.3772; val_optim_loss: 132393.3772
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9864; val_auprc_score: 0.9844; val_best_acc_score: 0.9459; val_best_f1_score: 0.9470; train_kl_reg_loss: 3060.6141; train_edge_recon_loss: 27519.8812; train_gene_expr_recon_loss: 102616.2638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 133196.7591; train_optim_loss: 133196.7591; val_kl_reg_loss: 2978.6250; val_edge_recon_loss: 27003.6303; val_gene_expr_recon_loss: 102369.9964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132352.2513; val_optim_loss: 132352.2513
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9865; val_auprc_score: 0.9846; val_best_acc_score: 0.9455; val_best_f1_score: 0.9466; train_kl_reg_loss: 3068.3536; train_edge_recon_loss: 27491.9521; train_gene_expr_recon_loss: 102468.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 133028.5299; train_optim_loss: 133028.5299; val_kl_reg_loss: 3030.9432; val_edge_recon_loss: 26979.0931; val_gene_expr_recon_loss: 102222.5597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132232.5959; val_optim_loss: 132232.5959
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9876; val_auprc_score: 0.9860; val_best_acc_score: 0.9478; val_best_f1_score: 0.9488; train_kl_reg_loss: 3074.7175; train_edge_recon_loss: 27471.3935; train_gene_expr_recon_loss: 102421.0999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132967.2111; train_optim_loss: 132967.2111; val_kl_reg_loss: 2996.8559; val_edge_recon_loss: 26982.6887; val_gene_expr_recon_loss: 102099.5072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132079.0517; val_optim_loss: 132079.0517
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9870; val_auprc_score: 0.9852; val_best_acc_score: 0.9466; val_best_f1_score: 0.9477; train_kl_reg_loss: 3081.2787; train_edge_recon_loss: 27451.2149; train_gene_expr_recon_loss: 102363.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132895.5607; train_optim_loss: 132895.5607; val_kl_reg_loss: 3015.5374; val_edge_recon_loss: 26983.7266; val_gene_expr_recon_loss: 102171.4045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132170.6685; val_optim_loss: 132170.6685
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9873; val_auprc_score: 0.9856; val_best_acc_score: 0.9470; val_best_f1_score: 0.9479; train_kl_reg_loss: 3083.8463; train_edge_recon_loss: 27442.5473; train_gene_expr_recon_loss: 102290.7317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132817.1253; train_optim_loss: 132817.1253; val_kl_reg_loss: 3048.8481; val_edge_recon_loss: 26984.8313; val_gene_expr_recon_loss: 102120.9266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132154.6060; val_optim_loss: 132154.6060
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9873; val_auprc_score: 0.9855; val_best_acc_score: 0.9477; val_best_f1_score: 0.9487; train_kl_reg_loss: 3088.5363; train_edge_recon_loss: 27430.1426; train_gene_expr_recon_loss: 102234.9730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132753.6522; train_optim_loss: 132753.6522; val_kl_reg_loss: 3095.3848; val_edge_recon_loss: 26990.2201; val_gene_expr_recon_loss: 101963.4035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132049.0088; val_optim_loss: 132049.0088
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9875; val_auprc_score: 0.9859; val_best_acc_score: 0.9471; val_best_f1_score: 0.9481; train_kl_reg_loss: 3091.1077; train_edge_recon_loss: 27415.2848; train_gene_expr_recon_loss: 102208.6867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132715.0791; train_optim_loss: 132715.0791; val_kl_reg_loss: 3080.4852; val_edge_recon_loss: 27009.0542; val_gene_expr_recon_loss: 101962.5400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132052.0801; val_optim_loss: 132052.0801
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9866; val_best_acc_score: 0.9488; val_best_f1_score: 0.9497; train_kl_reg_loss: 3093.1386; train_edge_recon_loss: 27412.0581; train_gene_expr_recon_loss: 102182.6502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132687.8469; train_optim_loss: 132687.8469; val_kl_reg_loss: 3079.4853; val_edge_recon_loss: 26930.1642; val_gene_expr_recon_loss: 102071.8447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132081.4945; val_optim_loss: 132081.4945
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9879; val_auprc_score: 0.9863; val_best_acc_score: 0.9486; val_best_f1_score: 0.9496; train_kl_reg_loss: 3095.8267; train_edge_recon_loss: 27405.4414; train_gene_expr_recon_loss: 102127.1035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132628.3718; train_optim_loss: 132628.3718; val_kl_reg_loss: 3020.6790; val_edge_recon_loss: 26943.6569; val_gene_expr_recon_loss: 101987.2412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131951.5771; val_optim_loss: 131951.5771
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9879; val_auprc_score: 0.9862; val_best_acc_score: 0.9487; val_best_f1_score: 0.9499; train_kl_reg_loss: 3097.0725; train_edge_recon_loss: 27395.8821; train_gene_expr_recon_loss: 102096.8269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132589.7814; train_optim_loss: 132589.7814; val_kl_reg_loss: 3071.7482; val_edge_recon_loss: 26935.4379; val_gene_expr_recon_loss: 102120.8348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132128.0206; val_optim_loss: 132128.0206
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9889; val_auprc_score: 0.9873; val_best_acc_score: 0.9504; val_best_f1_score: 0.9512; train_kl_reg_loss: 3097.6773; train_edge_recon_loss: 27396.3048; train_gene_expr_recon_loss: 102080.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132574.3915; train_optim_loss: 132574.3915; val_kl_reg_loss: 3006.6091; val_edge_recon_loss: 26930.1778; val_gene_expr_recon_loss: 102091.4982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132028.2850; val_optim_loss: 132028.2850
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9879; val_auprc_score: 0.9862; val_best_acc_score: 0.9486; val_best_f1_score: 0.9497; train_kl_reg_loss: 3098.8913; train_edge_recon_loss: 27388.0802; train_gene_expr_recon_loss: 102060.2275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132547.1990; train_optim_loss: 132547.1990; val_kl_reg_loss: 3061.4737; val_edge_recon_loss: 26925.2257; val_gene_expr_recon_loss: 101928.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131915.2087; val_optim_loss: 131915.2087
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9876; val_best_acc_score: 0.9495; val_best_f1_score: 0.9502; train_kl_reg_loss: 3101.0935; train_edge_recon_loss: 27378.6767; train_gene_expr_recon_loss: 102021.8269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132501.5970; train_optim_loss: 132501.5970; val_kl_reg_loss: 3084.9340; val_edge_recon_loss: 26902.1282; val_gene_expr_recon_loss: 102019.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132007.0553; val_optim_loss: 132007.0553
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9891; val_auprc_score: 0.9878; val_best_acc_score: 0.9510; val_best_f1_score: 0.9517; train_kl_reg_loss: 3103.4816; train_edge_recon_loss: 27366.7100; train_gene_expr_recon_loss: 101999.4983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132469.6899; train_optim_loss: 132469.6899; val_kl_reg_loss: 3053.9628; val_edge_recon_loss: 26877.0718; val_gene_expr_recon_loss: 101898.1877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131829.2221; val_optim_loss: 131829.2221
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9893; val_auprc_score: 0.9879; val_best_acc_score: 0.9514; val_best_f1_score: 0.9524; train_kl_reg_loss: 3104.6374; train_edge_recon_loss: 27362.7950; train_gene_expr_recon_loss: 102044.5133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132511.9457; train_optim_loss: 132511.9457; val_kl_reg_loss: 3099.2995; val_edge_recon_loss: 26903.1210; val_gene_expr_recon_loss: 101920.4111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131922.8319; val_optim_loss: 131922.8319
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9885; val_auprc_score: 0.9869; val_best_acc_score: 0.9498; val_best_f1_score: 0.9506; train_kl_reg_loss: 3102.6493; train_edge_recon_loss: 27365.1853; train_gene_expr_recon_loss: 102019.0224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132486.8569; train_optim_loss: 132486.8569; val_kl_reg_loss: 3072.5882; val_edge_recon_loss: 26888.0084; val_gene_expr_recon_loss: 101884.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131844.8094; val_optim_loss: 131844.8094
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9890; val_auprc_score: 0.9875; val_best_acc_score: 0.9511; val_best_f1_score: 0.9518; train_kl_reg_loss: 3104.5363; train_edge_recon_loss: 27360.2909; train_gene_expr_recon_loss: 101960.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132425.0418; train_optim_loss: 132425.0418; val_kl_reg_loss: 3109.0021; val_edge_recon_loss: 26867.8968; val_gene_expr_recon_loss: 102028.2291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132005.1278; val_optim_loss: 132005.1278
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9892; val_auprc_score: 0.9877; val_best_acc_score: 0.9516; val_best_f1_score: 0.9524; train_kl_reg_loss: 3105.6246; train_edge_recon_loss: 27351.0927; train_gene_expr_recon_loss: 101951.3685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132408.0860; train_optim_loss: 132408.0860; val_kl_reg_loss: 3011.4838; val_edge_recon_loss: 26882.6684; val_gene_expr_recon_loss: 101772.4897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131666.6417; val_optim_loss: 131666.6417
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9889; val_auprc_score: 0.9873; val_best_acc_score: 0.9511; val_best_f1_score: 0.9521; train_kl_reg_loss: 3105.2416; train_edge_recon_loss: 27359.7338; train_gene_expr_recon_loss: 101940.8245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132405.8001; train_optim_loss: 132405.8001; val_kl_reg_loss: 3067.5215; val_edge_recon_loss: 26867.6632; val_gene_expr_recon_loss: 101861.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131797.0979; val_optim_loss: 131797.0979
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9892; val_auprc_score: 0.9877; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 3105.8565; train_edge_recon_loss: 27353.5124; train_gene_expr_recon_loss: 101929.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132389.0338; train_optim_loss: 132389.0338; val_kl_reg_loss: 3073.6155; val_edge_recon_loss: 26873.9449; val_gene_expr_recon_loss: 101988.1480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131935.7087; val_optim_loss: 131935.7087
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9901; val_auprc_score: 0.9887; val_best_acc_score: 0.9537; val_best_f1_score: 0.9545; train_kl_reg_loss: 3105.7310; train_edge_recon_loss: 27349.4351; train_gene_expr_recon_loss: 101931.4296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132386.5955; train_optim_loss: 132386.5955; val_kl_reg_loss: 2988.3534; val_edge_recon_loss: 26898.5853; val_gene_expr_recon_loss: 101982.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131869.5291; val_optim_loss: 131869.5291
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9894; val_auprc_score: 0.9881; val_best_acc_score: 0.9523; val_best_f1_score: 0.9532; train_kl_reg_loss: 3106.0745; train_edge_recon_loss: 27349.9103; train_gene_expr_recon_loss: 101930.1167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 132386.1015; train_optim_loss: 132386.1015; val_kl_reg_loss: 3081.5368; val_edge_recon_loss: 26864.1268; val_gene_expr_recon_loss: 101777.4902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131723.1537; val_optim_loss: 131723.1537

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9895; val_auprc_score: 0.9880; val_best_acc_score: 0.9529; val_best_f1_score: 0.9538; train_kl_reg_loss: 3092.9210; train_edge_recon_loss: 27301.9917; train_gene_expr_recon_loss: 101500.3539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131895.2665; train_optim_loss: 131895.2665; val_kl_reg_loss: 3053.5913; val_edge_recon_loss: 26854.2193; val_gene_expr_recon_loss: 101462.4556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131370.2662; val_optim_loss: 131370.2662
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9903; val_auprc_score: 0.9891; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 3080.9358; train_edge_recon_loss: 27306.2617; train_gene_expr_recon_loss: 101419.6902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131806.8877; train_optim_loss: 131806.8877; val_kl_reg_loss: 3017.3180; val_edge_recon_loss: 26811.0928; val_gene_expr_recon_loss: 101461.5957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131290.0064; val_optim_loss: 131290.0064
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9903; val_auprc_score: 0.9890; val_best_acc_score: 0.9540; val_best_f1_score: 0.9548; train_kl_reg_loss: 3075.4452; train_edge_recon_loss: 27317.4670; train_gene_expr_recon_loss: 101505.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131898.1296; train_optim_loss: 131898.1296; val_kl_reg_loss: 3042.4387; val_edge_recon_loss: 26814.1352; val_gene_expr_recon_loss: 101565.2964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131421.8707; val_optim_loss: 131421.8707
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9903; val_auprc_score: 0.9892; val_best_acc_score: 0.9544; val_best_f1_score: 0.9552; train_kl_reg_loss: 3076.4899; train_edge_recon_loss: 27307.4233; train_gene_expr_recon_loss: 101453.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131837.8993; train_optim_loss: 131837.8993; val_kl_reg_loss: 3035.4753; val_edge_recon_loss: 26808.2879; val_gene_expr_recon_loss: 101410.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131254.5731; val_optim_loss: 131254.5731
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9901; val_auprc_score: 0.9890; val_best_acc_score: 0.9533; val_best_f1_score: 0.9541; train_kl_reg_loss: 3073.1257; train_edge_recon_loss: 27313.4373; train_gene_expr_recon_loss: 101425.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131811.8632; train_optim_loss: 131811.8632; val_kl_reg_loss: 3048.9818; val_edge_recon_loss: 26833.8414; val_gene_expr_recon_loss: 101603.4186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131486.2423; val_optim_loss: 131486.2423
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9899; val_auprc_score: 0.9886; val_best_acc_score: 0.9533; val_best_f1_score: 0.9542; train_kl_reg_loss: 3076.0159; train_edge_recon_loss: 27299.5644; train_gene_expr_recon_loss: 101443.5122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131819.0925; train_optim_loss: 131819.0925; val_kl_reg_loss: 3032.8927; val_edge_recon_loss: 26843.6568; val_gene_expr_recon_loss: 101557.9900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131434.5393; val_optim_loss: 131434.5393
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9902; val_auprc_score: 0.9890; val_best_acc_score: 0.9532; val_best_f1_score: 0.9541; train_kl_reg_loss: 3070.2208; train_edge_recon_loss: 27327.5567; train_gene_expr_recon_loss: 101396.3615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131794.1390; train_optim_loss: 131794.1390; val_kl_reg_loss: 3027.4316; val_edge_recon_loss: 26843.3114; val_gene_expr_recon_loss: 101709.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131580.5307; val_optim_loss: 131580.5307
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9903; val_auprc_score: 0.9891; val_best_acc_score: 0.9538; val_best_f1_score: 0.9546; train_kl_reg_loss: 3071.4564; train_edge_recon_loss: 27317.2920; train_gene_expr_recon_loss: 101401.1291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131789.8777; train_optim_loss: 131789.8777; val_kl_reg_loss: 3033.6530; val_edge_recon_loss: 26827.9387; val_gene_expr_recon_loss: 101395.8655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131257.4575; val_optim_loss: 131257.4575

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9901; val_auprc_score: 0.9888; val_best_acc_score: 0.9541; val_best_f1_score: 0.9548; train_kl_reg_loss: 3072.5011; train_edge_recon_loss: 27305.6552; train_gene_expr_recon_loss: 101370.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131748.8450; train_optim_loss: 131748.8450; val_kl_reg_loss: 3026.2698; val_edge_recon_loss: 26842.9045; val_gene_expr_recon_loss: 101538.0696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131407.2434; val_optim_loss: 131407.2434
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9901; val_auprc_score: 0.9890; val_best_acc_score: 0.9536; val_best_f1_score: 0.9544; train_kl_reg_loss: 3070.9362; train_edge_recon_loss: 27306.2226; train_gene_expr_recon_loss: 101366.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131743.6368; train_optim_loss: 131743.6368; val_kl_reg_loss: 3033.6402; val_edge_recon_loss: 26846.5204; val_gene_expr_recon_loss: 101579.7453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131459.9056; val_optim_loss: 131459.9056
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9908; val_auprc_score: 0.9896; val_best_acc_score: 0.9553; val_best_f1_score: 0.9560; train_kl_reg_loss: 3071.2487; train_edge_recon_loss: 27302.4952; train_gene_expr_recon_loss: 101360.3587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131734.1026; train_optim_loss: 131734.1026; val_kl_reg_loss: 3024.2569; val_edge_recon_loss: 26814.2698; val_gene_expr_recon_loss: 101517.4090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131355.9359; val_optim_loss: 131355.9359
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9902; val_auprc_score: 0.9889; val_best_acc_score: 0.9536; val_best_f1_score: 0.9545; train_kl_reg_loss: 3069.2331; train_edge_recon_loss: 27315.0914; train_gene_expr_recon_loss: 101351.1956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131735.5201; train_optim_loss: 131735.5201; val_kl_reg_loss: 3027.7974; val_edge_recon_loss: 26844.6128; val_gene_expr_recon_loss: 101554.5362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 131426.9463; val_optim_loss: 131426.9463

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 172 min 13 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9902
val AUPRC score: 0.9889
val best accuracy score: 0.9537
val best F1 score: 0.9545
val target rna MSE score: 1.3770
val source rna MSE score: 0.1622

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
