None
Run timestamp: 24072023_201318_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9762; val_best_acc_score: 0.9462; val_best_f1_score: 0.9475; train_kl_reg_loss: 96773.1783; train_edge_recon_loss: 26769220.5953; train_gene_expr_recon_loss: 11729489.5494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38595483.3992; train_optim_loss: 38595483.3992; val_kl_reg_loss: 111580.8288; val_edge_recon_loss: 26089609.7750; val_gene_expr_recon_loss: 10827221.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37028412.6500; val_optim_loss: 37028412.6500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9866; val_auprc_score: 0.9821; val_best_acc_score: 0.9544; val_best_f1_score: 0.9555; train_kl_reg_loss: 104372.2434; train_edge_recon_loss: 25979563.0097; train_gene_expr_recon_loss: 10587705.8275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36671641.0960; train_optim_loss: 36671641.0960; val_kl_reg_loss: 95234.0861; val_edge_recon_loss: 25957073.5750; val_gene_expr_recon_loss: 10431090.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36483398.5500; val_optim_loss: 36483398.5500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9843; val_best_acc_score: 0.9579; val_best_f1_score: 0.9589; train_kl_reg_loss: 89837.4686; train_edge_recon_loss: 25869590.9374; train_gene_expr_recon_loss: 10300760.6092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36260189.0904; train_optim_loss: 36260189.0904; val_kl_reg_loss: 87759.6529; val_edge_recon_loss: 25883498.8000; val_gene_expr_recon_loss: 10242119.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36213377.4500; val_optim_loss: 36213377.4500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9894; val_auprc_score: 0.9859; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 82126.3135; train_edge_recon_loss: 25787597.6551; train_gene_expr_recon_loss: 10121666.4534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35991390.4256; train_optim_loss: 35991390.4256; val_kl_reg_loss: 79169.5672; val_edge_recon_loss: 25811345.8250; val_gene_expr_recon_loss: 10086378.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35976893.5000; val_optim_loss: 35976893.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9908; val_auprc_score: 0.9876; val_best_acc_score: 0.9659; val_best_f1_score: 0.9666; train_kl_reg_loss: 75128.0160; train_edge_recon_loss: 25739282.0584; train_gene_expr_recon_loss: 10012325.7747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35826735.8609; train_optim_loss: 35826735.8609; val_kl_reg_loss: 71787.0631; val_edge_recon_loss: 25739849.1750; val_gene_expr_recon_loss: 10022325.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35833961.8500; val_optim_loss: 35833961.8500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9888; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 69783.5854; train_edge_recon_loss: 25696619.4520; train_gene_expr_recon_loss: 9936037.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35702440.5174; train_optim_loss: 35702440.5174; val_kl_reg_loss: 67137.6096; val_edge_recon_loss: 25709211.4250; val_gene_expr_recon_loss: 9965925.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35742274.5000; val_optim_loss: 35742274.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9926; val_auprc_score: 0.9904; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 65753.2653; train_edge_recon_loss: 25670493.4993; train_gene_expr_recon_loss: 9892937.9833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35629184.7677; train_optim_loss: 35629184.7677; val_kl_reg_loss: 64827.4868; val_edge_recon_loss: 25653640.7000; val_gene_expr_recon_loss: 9948323.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35666792.1500; val_optim_loss: 35666792.1500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 62611.7223; train_edge_recon_loss: 25643229.5271; train_gene_expr_recon_loss: 9843124.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35548965.2573; train_optim_loss: 35548965.2573; val_kl_reg_loss: 60840.9408; val_edge_recon_loss: 25642568.5250; val_gene_expr_recon_loss: 9903511.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35606920.9000; val_optim_loss: 35606920.9000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9936; val_auprc_score: 0.9918; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 59864.9262; train_edge_recon_loss: 25627555.3268; train_gene_expr_recon_loss: 9809683.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35497104.3171; train_optim_loss: 35497104.3171; val_kl_reg_loss: 59127.1267; val_edge_recon_loss: 25628202.6500; val_gene_expr_recon_loss: 9867970.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35555299.9500; val_optim_loss: 35555299.9500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9937; val_auprc_score: 0.9916; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 57329.8843; train_edge_recon_loss: 25610319.1905; train_gene_expr_recon_loss: 9778368.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35446017.8971; train_optim_loss: 35446017.8971; val_kl_reg_loss: 54472.7636; val_edge_recon_loss: 25636315.6750; val_gene_expr_recon_loss: 9855007.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35545795.5500; val_optim_loss: 35545795.5500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 55296.6745; train_edge_recon_loss: 25602001.1655; train_gene_expr_recon_loss: 9752916.0014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35410213.8414; train_optim_loss: 35410213.8414; val_kl_reg_loss: 53875.1514; val_edge_recon_loss: 25619628.9750; val_gene_expr_recon_loss: 9864322.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35537827.1000; val_optim_loss: 35537827.1000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 53911.2934; train_edge_recon_loss: 25583018.5619; train_gene_expr_recon_loss: 9728491.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35365421.4242; train_optim_loss: 35365421.4242; val_kl_reg_loss: 53766.4544; val_edge_recon_loss: 25594965.4000; val_gene_expr_recon_loss: 9837482.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35486214.3500; val_optim_loss: 35486214.3500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9947; val_auprc_score: 0.9928; val_best_acc_score: 0.9776; val_best_f1_score: 0.9778; train_kl_reg_loss: 52622.2746; train_edge_recon_loss: 25572417.1711; train_gene_expr_recon_loss: 9705835.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35330875.2935; train_optim_loss: 35330875.2935; val_kl_reg_loss: 53556.2743; val_edge_recon_loss: 25588302.7250; val_gene_expr_recon_loss: 9838926.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35480785.2000; val_optim_loss: 35480785.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9946; val_auprc_score: 0.9928; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 51594.8768; train_edge_recon_loss: 25563491.0515; train_gene_expr_recon_loss: 9690806.3408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35305892.3616; train_optim_loss: 35305892.3616; val_kl_reg_loss: 50106.9350; val_edge_recon_loss: 25608104.5500; val_gene_expr_recon_loss: 9822460.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35480672.0000; val_optim_loss: 35480672.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9951; val_auprc_score: 0.9936; val_best_acc_score: 0.9788; val_best_f1_score: 0.9791; train_kl_reg_loss: 50605.9784; train_edge_recon_loss: 25553403.3129; train_gene_expr_recon_loss: 9669572.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35273581.8192; train_optim_loss: 35273581.8192; val_kl_reg_loss: 50384.4587; val_edge_recon_loss: 25575993.2500; val_gene_expr_recon_loss: 9834153.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35460531.0500; val_optim_loss: 35460531.0500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9938; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 49699.3634; train_edge_recon_loss: 25546458.2809; train_gene_expr_recon_loss: 9644355.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35240513.3519; train_optim_loss: 35240513.3519; val_kl_reg_loss: 49270.2113; val_edge_recon_loss: 25586355.4250; val_gene_expr_recon_loss: 9808481.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35444107.6500; val_optim_loss: 35444107.6500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9957; val_auprc_score: 0.9939; val_best_acc_score: 0.9798; val_best_f1_score: 0.9801; train_kl_reg_loss: 48888.3401; train_edge_recon_loss: 25547287.5967; train_gene_expr_recon_loss: 9628413.2184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35224589.1182; train_optim_loss: 35224589.1182; val_kl_reg_loss: 49011.4492; val_edge_recon_loss: 25576624.4500; val_gene_expr_recon_loss: 9836031.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35461666.8500; val_optim_loss: 35461666.8500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9956; val_auprc_score: 0.9943; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 48170.7268; train_edge_recon_loss: 25537598.3338; train_gene_expr_recon_loss: 9614611.4534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35200380.4784; train_optim_loss: 35200380.4784; val_kl_reg_loss: 48340.3359; val_edge_recon_loss: 25564669.0250; val_gene_expr_recon_loss: 9823346.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35436356.1500; val_optim_loss: 35436356.1500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 47717.9477; train_edge_recon_loss: 25534073.4325; train_gene_expr_recon_loss: 9596912.8790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35178704.2949; train_optim_loss: 35178704.2949; val_kl_reg_loss: 47960.3454; val_edge_recon_loss: 25542473.6000; val_gene_expr_recon_loss: 9828836.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35419269.8500; val_optim_loss: 35419269.8500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9957; val_auprc_score: 0.9944; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 46974.3400; train_edge_recon_loss: 25526808.9569; train_gene_expr_recon_loss: 9581434.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35155218.2086; train_optim_loss: 35155218.2086; val_kl_reg_loss: 47488.1210; val_edge_recon_loss: 25545215.6750; val_gene_expr_recon_loss: 9817996.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35410700.1500; val_optim_loss: 35410700.1500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 46459.9215; train_edge_recon_loss: 25526527.4715; train_gene_expr_recon_loss: 9570640.9006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35143628.3227; train_optim_loss: 35143628.3227; val_kl_reg_loss: 46143.4813; val_edge_recon_loss: 25542137.7000; val_gene_expr_recon_loss: 9836146.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35424427.8500; val_optim_loss: 35424427.8500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 46085.8386; train_edge_recon_loss: 25513738.1224; train_gene_expr_recon_loss: 9552710.5675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35112534.4812; train_optim_loss: 35112534.4812; val_kl_reg_loss: 46503.5807; val_edge_recon_loss: 25549244.0000; val_gene_expr_recon_loss: 9840009.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35435757.0500; val_optim_loss: 35435757.0500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 45705.6340; train_edge_recon_loss: 25518824.4312; train_gene_expr_recon_loss: 9543565.5744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35108095.7218; train_optim_loss: 35108095.7218; val_kl_reg_loss: 46829.8562; val_edge_recon_loss: 25527664.9250; val_gene_expr_recon_loss: 9845363.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35419858.6000; val_optim_loss: 35419858.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 45470.5123; train_edge_recon_loss: 25518398.9374; train_gene_expr_recon_loss: 9534427.6113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35098296.9903; train_optim_loss: 35098296.9903; val_kl_reg_loss: 45182.6327; val_edge_recon_loss: 25544951.3000; val_gene_expr_recon_loss: 9835727.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35425860.9500; val_optim_loss: 35425860.9500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9953; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 48051.4324; train_edge_recon_loss: 25498118.8901; train_gene_expr_recon_loss: 9449634.5229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34995804.8289; train_optim_loss: 34995804.8289; val_kl_reg_loss: 49370.6225; val_edge_recon_loss: 25519564.1500; val_gene_expr_recon_loss: 9807784.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35376719.4500; val_optim_loss: 35376719.4500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 50184.9571; train_edge_recon_loss: 25510967.4353; train_gene_expr_recon_loss: 9434284.6766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34995437.0793; train_optim_loss: 34995437.0793; val_kl_reg_loss: 50311.8902; val_edge_recon_loss: 25526712.0750; val_gene_expr_recon_loss: 9794305.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35371329.4500; val_optim_loss: 35371329.4500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 50789.8212; train_edge_recon_loss: 25498776.7260; train_gene_expr_recon_loss: 9434323.4381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34983890.0195; train_optim_loss: 34983890.0195; val_kl_reg_loss: 50647.1998; val_edge_recon_loss: 25545583.1750; val_gene_expr_recon_loss: 9832980.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35429210.6000; val_optim_loss: 35429210.6000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 51150.4575; train_edge_recon_loss: 25501962.4812; train_gene_expr_recon_loss: 9425742.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34978855.3713; train_optim_loss: 34978855.3713; val_kl_reg_loss: 50924.5561; val_edge_recon_loss: 25524346.0500; val_gene_expr_recon_loss: 9796960.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35372230.9000; val_optim_loss: 35372230.9000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9827; val_best_f1_score: 0.9828; train_kl_reg_loss: 51247.1119; train_edge_recon_loss: 25498752.6481; train_gene_expr_recon_loss: 9429774.9958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34979774.7483; train_optim_loss: 34979774.7483; val_kl_reg_loss: 50863.7707; val_edge_recon_loss: 25530340.2750; val_gene_expr_recon_loss: 9814573.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35395776.8500; val_optim_loss: 35395776.8500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 51265.9597; train_edge_recon_loss: 25495007.8776; train_gene_expr_recon_loss: 9417284.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34963558.1085; train_optim_loss: 34963558.1085; val_kl_reg_loss: 51172.6843; val_edge_recon_loss: 25510391.0000; val_gene_expr_recon_loss: 9840991.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35402555.6000; val_optim_loss: 35402555.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9949; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 51441.0313; train_edge_recon_loss: 25492188.1446; train_gene_expr_recon_loss: 9410070.7886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34953700.0445; train_optim_loss: 34953700.0445; val_kl_reg_loss: 51235.4239; val_edge_recon_loss: 25519845.8750; val_gene_expr_recon_loss: 9802976.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35374058.2000; val_optim_loss: 35374058.2000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9825; val_best_f1_score: 0.9828; train_kl_reg_loss: 51623.1082; train_edge_recon_loss: 25497439.4576; train_gene_expr_recon_loss: 9413135.9499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34962198.5202; train_optim_loss: 34962198.5202; val_kl_reg_loss: 51362.5095; val_edge_recon_loss: 25519939.2250; val_gene_expr_recon_loss: 9786980.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35358281.8500; val_optim_loss: 35358281.8500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 51754.0884; train_edge_recon_loss: 25488945.3380; train_gene_expr_recon_loss: 9415890.7997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34956590.2364; train_optim_loss: 34956590.2364; val_kl_reg_loss: 51400.5991; val_edge_recon_loss: 25522145.1750; val_gene_expr_recon_loss: 9799376.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35372922.7500; val_optim_loss: 35372922.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9961; val_auprc_score: 0.9948; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 51802.1626; train_edge_recon_loss: 25497498.7288; train_gene_expr_recon_loss: 9415247.5160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34964548.4618; train_optim_loss: 34964548.4618; val_kl_reg_loss: 51557.4215; val_edge_recon_loss: 25528132.7250; val_gene_expr_recon_loss: 9801944.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35381634.8500; val_optim_loss: 35381634.8500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9825; val_best_f1_score: 0.9827; train_kl_reg_loss: 51841.0584; train_edge_recon_loss: 25485448.0918; train_gene_expr_recon_loss: 9410497.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34947786.4256; train_optim_loss: 34947786.4256; val_kl_reg_loss: 51551.7706; val_edge_recon_loss: 25533842.9250; val_gene_expr_recon_loss: 9783170.9812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35368565.6500; val_optim_loss: 35368565.6500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 51850.9244; train_edge_recon_loss: 25490916.7010; train_gene_expr_recon_loss: 9412247.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34955015.4604; train_optim_loss: 34955015.4604; val_kl_reg_loss: 51555.9465; val_edge_recon_loss: 25517645.3000; val_gene_expr_recon_loss: 9793579.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35362780.7500; val_optim_loss: 35362780.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 51881.9164; train_edge_recon_loss: 25494997.3046; train_gene_expr_recon_loss: 9411083.8289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34957963.0042; train_optim_loss: 34957963.0042; val_kl_reg_loss: 51533.1254; val_edge_recon_loss: 25533740.7500; val_gene_expr_recon_loss: 9798044.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35383318.5500; val_optim_loss: 35383318.5500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9965; val_auprc_score: 0.9951; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 51872.1314; train_edge_recon_loss: 25495321.5716; train_gene_expr_recon_loss: 9405665.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34952859.4604; train_optim_loss: 34952859.4604; val_kl_reg_loss: 51670.5712; val_edge_recon_loss: 25512225.6000; val_gene_expr_recon_loss: 9812674.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35376570.9500; val_optim_loss: 35376570.9500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 51892.1974; train_edge_recon_loss: 25492059.4159; train_gene_expr_recon_loss: 9407505.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34951456.6954; train_optim_loss: 34951456.6954; val_kl_reg_loss: 51614.9257; val_edge_recon_loss: 25525733.4750; val_gene_expr_recon_loss: 9804264.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35381613.6500; val_optim_loss: 35381613.6500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 51875.7077; train_edge_recon_loss: 25491479.5716; train_gene_expr_recon_loss: 9394699.9478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34938055.1989; train_optim_loss: 34938055.1989; val_kl_reg_loss: 51688.1132; val_edge_recon_loss: 25539190.0250; val_gene_expr_recon_loss: 9810282.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35401160.7500; val_optim_loss: 35401160.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 379 min 37 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9948
Val best accuracy score: 0.9826
Val best F1 score: 0.9827
Val gene expr MSE score: 0.6062

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
