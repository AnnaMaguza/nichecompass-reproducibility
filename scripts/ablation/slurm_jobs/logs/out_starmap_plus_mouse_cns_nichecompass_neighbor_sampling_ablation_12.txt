None
Run timestamp: 04082023_182619_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9884; val_auprc_score: 0.9844; val_best_acc_score: 0.9597; val_best_f1_score: 0.9605; train_kl_reg_loss: 7589.6730; train_edge_recon_loss: 267888.6400; train_gene_expr_recon_loss: 213952.9672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 489431.2805; train_optim_loss: 489431.2805; val_kl_reg_loss: 7430.1510; val_edge_recon_loss: 260578.4967; val_gene_expr_recon_loss: 196711.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 464719.7281; val_optim_loss: 464719.7281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 7275.6544; train_edge_recon_loss: 260631.5023; train_gene_expr_recon_loss: 190328.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 458235.1795; train_optim_loss: 458235.1795; val_kl_reg_loss: 7160.5611; val_edge_recon_loss: 259468.4408; val_gene_expr_recon_loss: 185820.4088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 452449.4117; val_optim_loss: 452449.4117
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9933; val_auprc_score: 0.9912; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 7011.7688; train_edge_recon_loss: 259762.3761; train_gene_expr_recon_loss: 182668.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449443.0514; train_optim_loss: 449443.0514; val_kl_reg_loss: 6886.1713; val_edge_recon_loss: 258770.0021; val_gene_expr_recon_loss: 180741.0686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446397.2418; val_optim_loss: 446397.2418
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9941; val_auprc_score: 0.9923; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 6845.5288; train_edge_recon_loss: 259234.4264; train_gene_expr_recon_loss: 178701.5238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444781.4797; train_optim_loss: 444781.4797; val_kl_reg_loss: 6694.1965; val_edge_recon_loss: 258196.3311; val_gene_expr_recon_loss: 177572.1590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442462.6875; val_optim_loss: 442462.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9953; val_auprc_score: 0.9936; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 6740.2381; train_edge_recon_loss: 258628.9395; train_gene_expr_recon_loss: 176184.5113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441553.6888; train_optim_loss: 441553.6888; val_kl_reg_loss: 6584.1455; val_edge_recon_loss: 257551.2951; val_gene_expr_recon_loss: 175617.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439753.4281; val_optim_loss: 439753.4281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9957; val_auprc_score: 0.9943; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6664.9651; train_edge_recon_loss: 258202.0356; train_gene_expr_recon_loss: 174400.8449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439267.8457; train_optim_loss: 439267.8457; val_kl_reg_loss: 6614.2441; val_edge_recon_loss: 257101.6547; val_gene_expr_recon_loss: 174088.3975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437804.2965; val_optim_loss: 437804.2965
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 6615.4669; train_edge_recon_loss: 257954.3416; train_gene_expr_recon_loss: 173276.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437845.8627; train_optim_loss: 437845.8627; val_kl_reg_loss: 6639.9197; val_edge_recon_loss: 257335.2732; val_gene_expr_recon_loss: 173112.2062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437087.3984; val_optim_loss: 437087.3984
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9963; val_auprc_score: 0.9948; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 6578.3194; train_edge_recon_loss: 257713.9923; train_gene_expr_recon_loss: 172528.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436821.2322; train_optim_loss: 436821.2322; val_kl_reg_loss: 6416.4044; val_edge_recon_loss: 256540.6150; val_gene_expr_recon_loss: 172998.6090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435955.6305; val_optim_loss: 435955.6305
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 6556.2944; train_edge_recon_loss: 257390.1054; train_gene_expr_recon_loss: 171812.7270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435759.1266; train_optim_loss: 435759.1266; val_kl_reg_loss: 6561.2421; val_edge_recon_loss: 256646.7424; val_gene_expr_recon_loss: 172237.5430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435445.5305; val_optim_loss: 435445.5305
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9969; val_auprc_score: 0.9960; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 6538.0246; train_edge_recon_loss: 257269.4598; train_gene_expr_recon_loss: 171225.4332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435032.9173; train_optim_loss: 435032.9173; val_kl_reg_loss: 6576.2527; val_edge_recon_loss: 256435.2420; val_gene_expr_recon_loss: 171764.0416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434775.5363; val_optim_loss: 434775.5363
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6523.7034; train_edge_recon_loss: 257129.8605; train_gene_expr_recon_loss: 170748.1439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434401.7075; train_optim_loss: 434401.7075; val_kl_reg_loss: 6584.0521; val_edge_recon_loss: 256288.8152; val_gene_expr_recon_loss: 171907.5197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434780.3883; val_optim_loss: 434780.3883
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 6527.7198; train_edge_recon_loss: 256913.3936; train_gene_expr_recon_loss: 170537.3288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433978.4422; train_optim_loss: 433978.4422; val_kl_reg_loss: 6474.6696; val_edge_recon_loss: 256112.8674; val_gene_expr_recon_loss: 171480.3992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434067.9363; val_optim_loss: 434067.9363
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 6520.2668; train_edge_recon_loss: 256849.8392; train_gene_expr_recon_loss: 170170.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433540.7915; train_optim_loss: 433540.7915; val_kl_reg_loss: 6485.3742; val_edge_recon_loss: 256068.0730; val_gene_expr_recon_loss: 171617.0816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434170.5273; val_optim_loss: 434170.5273
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9850; val_best_f1_score: 0.9852; train_kl_reg_loss: 6520.4338; train_edge_recon_loss: 256685.4169; train_gene_expr_recon_loss: 169869.5476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433075.3981; train_optim_loss: 433075.3981; val_kl_reg_loss: 6368.0980; val_edge_recon_loss: 255772.8848; val_gene_expr_recon_loss: 171069.0775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433210.0625; val_optim_loss: 433210.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6522.4455; train_edge_recon_loss: 256643.6561; train_gene_expr_recon_loss: 169719.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432885.6530; train_optim_loss: 432885.6530; val_kl_reg_loss: 6528.2255; val_edge_recon_loss: 255914.7012; val_gene_expr_recon_loss: 170933.9264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433376.8527; val_optim_loss: 433376.8527
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 6520.0832; train_edge_recon_loss: 256588.1699; train_gene_expr_recon_loss: 169555.2733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432663.5262; train_optim_loss: 432663.5262; val_kl_reg_loss: 6445.2896; val_edge_recon_loss: 255752.4908; val_gene_expr_recon_loss: 171682.2705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433880.0527; val_optim_loss: 433880.0527
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 6523.2897; train_edge_recon_loss: 256491.4550; train_gene_expr_recon_loss: 169458.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432473.1353; train_optim_loss: 432473.1353; val_kl_reg_loss: 6499.2040; val_edge_recon_loss: 255825.4080; val_gene_expr_recon_loss: 171178.0059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433502.6160; val_optim_loss: 433502.6160
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6530.5542; train_edge_recon_loss: 256426.5060; train_gene_expr_recon_loss: 169235.3278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432192.3882; train_optim_loss: 432192.3882; val_kl_reg_loss: 6400.5733; val_edge_recon_loss: 255644.7877; val_gene_expr_recon_loss: 171683.2549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433728.6180; val_optim_loss: 433728.6180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 6543.5323; train_edge_recon_loss: 256245.2598; train_gene_expr_recon_loss: 168692.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431481.1901; train_optim_loss: 431481.1901; val_kl_reg_loss: 6531.7561; val_edge_recon_loss: 255491.6377; val_gene_expr_recon_loss: 170556.1682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432579.5613; val_optim_loss: 432579.5613
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6547.1503; train_edge_recon_loss: 256257.5872; train_gene_expr_recon_loss: 168673.4431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431478.1815; train_optim_loss: 431478.1815; val_kl_reg_loss: 6508.9081; val_edge_recon_loss: 255630.2373; val_gene_expr_recon_loss: 170866.2916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433005.4395; val_optim_loss: 433005.4395
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9977; val_auprc_score: 0.9967; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6543.5549; train_edge_recon_loss: 256265.2565; train_gene_expr_recon_loss: 168556.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431365.3420; train_optim_loss: 431365.3420; val_kl_reg_loss: 6539.0750; val_edge_recon_loss: 255481.1850; val_gene_expr_recon_loss: 170853.0004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432873.2625; val_optim_loss: 432873.2625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6540.9496; train_edge_recon_loss: 256201.2272; train_gene_expr_recon_loss: 168515.9035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431258.0795; train_optim_loss: 431258.0795; val_kl_reg_loss: 6518.2623; val_edge_recon_loss: 255586.1098; val_gene_expr_recon_loss: 170855.8721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432960.2445; val_optim_loss: 432960.2445
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6542.2137; train_edge_recon_loss: 256124.4322; train_gene_expr_recon_loss: 168301.6213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430968.2670; train_optim_loss: 430968.2670; val_kl_reg_loss: 6515.4833; val_edge_recon_loss: 255316.7555; val_gene_expr_recon_loss: 170716.1479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432548.3867; val_optim_loss: 432548.3867
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6542.9107; train_edge_recon_loss: 256143.3590; train_gene_expr_recon_loss: 168404.8290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431091.0978; train_optim_loss: 431091.0978; val_kl_reg_loss: 6508.6536; val_edge_recon_loss: 255460.9574; val_gene_expr_recon_loss: 170741.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432710.6953; val_optim_loss: 432710.6953
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6545.1813; train_edge_recon_loss: 256117.5971; train_gene_expr_recon_loss: 168429.3561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431092.1342; train_optim_loss: 431092.1342; val_kl_reg_loss: 6507.7881; val_edge_recon_loss: 255375.1781; val_gene_expr_recon_loss: 170911.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432794.8961; val_optim_loss: 432794.8961
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6540.0099; train_edge_recon_loss: 256177.1536; train_gene_expr_recon_loss: 168252.5101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430969.6735; train_optim_loss: 430969.6735; val_kl_reg_loss: 6517.3423; val_edge_recon_loss: 255442.3045; val_gene_expr_recon_loss: 170765.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432725.0539; val_optim_loss: 432725.0539
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 6539.0854; train_edge_recon_loss: 256207.8969; train_gene_expr_recon_loss: 168327.1020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431074.0846; train_optim_loss: 431074.0846; val_kl_reg_loss: 6500.8439; val_edge_recon_loss: 255369.0066; val_gene_expr_recon_loss: 170657.1564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432527.0078; val_optim_loss: 432527.0078
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6540.1496; train_edge_recon_loss: 256194.1975; train_gene_expr_recon_loss: 168255.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430989.7835; train_optim_loss: 430989.7835; val_kl_reg_loss: 6530.6526; val_edge_recon_loss: 255526.5398; val_gene_expr_recon_loss: 170671.7602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432728.9535; val_optim_loss: 432728.9535
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9876; train_kl_reg_loss: 6543.5141; train_edge_recon_loss: 256120.1447; train_gene_expr_recon_loss: 168341.2919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431004.9505; train_optim_loss: 431004.9505; val_kl_reg_loss: 6529.2336; val_edge_recon_loss: 255211.7361; val_gene_expr_recon_loss: 170477.9975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432218.9664; val_optim_loss: 432218.9664
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6543.8760; train_edge_recon_loss: 256116.8139; train_gene_expr_recon_loss: 168222.2155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430882.9058; train_optim_loss: 430882.9058; val_kl_reg_loss: 6530.2866; val_edge_recon_loss: 255272.5420; val_gene_expr_recon_loss: 170357.9779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432160.8082; val_optim_loss: 432160.8082
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6541.6077; train_edge_recon_loss: 256119.2811; train_gene_expr_recon_loss: 168361.3632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431022.2520; train_optim_loss: 431022.2520; val_kl_reg_loss: 6534.9374; val_edge_recon_loss: 255415.2553; val_gene_expr_recon_loss: 170588.5100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432538.7039; val_optim_loss: 432538.7039
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6543.7174; train_edge_recon_loss: 256159.1812; train_gene_expr_recon_loss: 168135.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430837.9889; train_optim_loss: 430837.9889; val_kl_reg_loss: 6507.9709; val_edge_recon_loss: 255495.2633; val_gene_expr_recon_loss: 170556.9867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432560.2223; val_optim_loss: 432560.2223
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6543.5470; train_edge_recon_loss: 256094.6219; train_gene_expr_recon_loss: 168251.4930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430889.6616; train_optim_loss: 430889.6616; val_kl_reg_loss: 6520.5521; val_edge_recon_loss: 255416.1055; val_gene_expr_recon_loss: 170495.3715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432432.0320; val_optim_loss: 432432.0320
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 6545.1304; train_edge_recon_loss: 256057.4085; train_gene_expr_recon_loss: 168129.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430731.6994; train_optim_loss: 430731.6994; val_kl_reg_loss: 6506.6542; val_edge_recon_loss: 255434.8781; val_gene_expr_recon_loss: 170666.0910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432607.6242; val_optim_loss: 432607.6242

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 6547.0498; train_edge_recon_loss: 256091.3520; train_gene_expr_recon_loss: 168140.5970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430778.9984; train_optim_loss: 430778.9984; val_kl_reg_loss: 6518.4404; val_edge_recon_loss: 255294.2039; val_gene_expr_recon_loss: 170308.2404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432120.8879; val_optim_loss: 432120.8879
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 6546.6111; train_edge_recon_loss: 256137.6582; train_gene_expr_recon_loss: 167948.0374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430632.3060; train_optim_loss: 430632.3060; val_kl_reg_loss: 6526.3629; val_edge_recon_loss: 255214.8168; val_gene_expr_recon_loss: 170750.2320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432491.4117; val_optim_loss: 432491.4117
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9879; val_best_f1_score: 0.9879; train_kl_reg_loss: 6547.3472; train_edge_recon_loss: 256040.3857; train_gene_expr_recon_loss: 167967.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430555.5020; train_optim_loss: 430555.5020; val_kl_reg_loss: 6520.0250; val_edge_recon_loss: 255379.8799; val_gene_expr_recon_loss: 171020.3027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432920.2098; val_optim_loss: 432920.2098
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6546.6532; train_edge_recon_loss: 256080.1783; train_gene_expr_recon_loss: 168079.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430705.9019; train_optim_loss: 430705.9019; val_kl_reg_loss: 6520.7902; val_edge_recon_loss: 255325.2023; val_gene_expr_recon_loss: 170840.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432686.4691; val_optim_loss: 432686.4691
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 6546.3831; train_edge_recon_loss: 256074.7121; train_gene_expr_recon_loss: 168075.3285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430696.4234; train_optim_loss: 430696.4234; val_kl_reg_loss: 6507.4526; val_edge_recon_loss: 255267.9090; val_gene_expr_recon_loss: 170393.2473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432168.6094; val_optim_loss: 432168.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 6542.9168; train_edge_recon_loss: 256110.1867; train_gene_expr_recon_loss: 168137.5929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430790.6967; train_optim_loss: 430790.6967; val_kl_reg_loss: 6519.5546; val_edge_recon_loss: 255228.6928; val_gene_expr_recon_loss: 170619.9391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432368.1875; val_optim_loss: 432368.1875
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 6545.0986; train_edge_recon_loss: 256147.2975; train_gene_expr_recon_loss: 168106.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430798.9808; train_optim_loss: 430798.9808; val_kl_reg_loss: 6518.7959; val_edge_recon_loss: 255110.4729; val_gene_expr_recon_loss: 170701.5857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432330.8563; val_optim_loss: 432330.8563
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 6544.4974; train_edge_recon_loss: 256058.7390; train_gene_expr_recon_loss: 167992.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430595.4104; train_optim_loss: 430595.4104; val_kl_reg_loss: 6517.7779; val_edge_recon_loss: 255505.0521; val_gene_expr_recon_loss: 170689.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432712.3637; val_optim_loss: 432712.3637
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 6545.4731; train_edge_recon_loss: 256129.4538; train_gene_expr_recon_loss: 168025.9560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430700.8826; train_optim_loss: 430700.8826; val_kl_reg_loss: 6515.0856; val_edge_recon_loss: 255220.0566; val_gene_expr_recon_loss: 170557.0098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432292.1535; val_optim_loss: 432292.1535

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 277 min 34 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9981
val AUPRC score: 0.9976
val best accuracy score: 0.9876
val best F1 score: 0.9876
val target rna MSE score: 0.5842
val source rna MSE score: 0.0380

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
