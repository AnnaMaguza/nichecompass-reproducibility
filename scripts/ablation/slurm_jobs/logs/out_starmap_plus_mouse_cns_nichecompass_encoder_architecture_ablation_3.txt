None
Run timestamp: 05082023_011859_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9900; val_auprc_score: 0.9870; val_best_acc_score: 0.9636; val_best_f1_score: 0.9644; train_kl_reg_loss: 7294.4336; train_edge_recon_loss: 264032.6435; train_gene_expr_recon_loss: 199428.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 470755.5342; train_optim_loss: 470755.5342; val_kl_reg_loss: 6762.2591; val_edge_recon_loss: 259979.0500; val_gene_expr_recon_loss: 183138.3202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449879.6287; val_optim_loss: 449879.6287
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 6860.7147; train_edge_recon_loss: 259650.2938; train_gene_expr_recon_loss: 179502.1617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446013.1707; train_optim_loss: 446013.1707; val_kl_reg_loss: 6744.8855; val_edge_recon_loss: 259227.6040; val_gene_expr_recon_loss: 175649.9565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441622.4459; val_optim_loss: 441622.4459
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9719; val_best_f1_score: 0.9724; train_kl_reg_loss: 6668.6557; train_edge_recon_loss: 258757.8907; train_gene_expr_recon_loss: 175277.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440703.6052; train_optim_loss: 440703.6052; val_kl_reg_loss: 6610.2622; val_edge_recon_loss: 258249.6754; val_gene_expr_recon_loss: 173683.6461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438543.5829; val_optim_loss: 438543.5829
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 6602.9925; train_edge_recon_loss: 258285.2340; train_gene_expr_recon_loss: 173524.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438412.4160; train_optim_loss: 438412.4160; val_kl_reg_loss: 6455.8559; val_edge_recon_loss: 257971.3604; val_gene_expr_recon_loss: 172424.2458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 436851.4619; val_optim_loss: 436851.4619
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9951; val_auprc_score: 0.9937; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 6577.4474; train_edge_recon_loss: 257910.2703; train_gene_expr_recon_loss: 172718.7330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437206.4510; train_optim_loss: 437206.4510; val_kl_reg_loss: 6418.2039; val_edge_recon_loss: 257478.7579; val_gene_expr_recon_loss: 172059.7288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435956.6907; val_optim_loss: 435956.6907
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 6563.4344; train_edge_recon_loss: 257740.2191; train_gene_expr_recon_loss: 172007.8146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436311.4679; train_optim_loss: 436311.4679; val_kl_reg_loss: 6551.4594; val_edge_recon_loss: 257082.6994; val_gene_expr_recon_loss: 171791.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435426.1047; val_optim_loss: 435426.1047
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 6569.7023; train_edge_recon_loss: 257519.4251; train_gene_expr_recon_loss: 171671.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435760.6390; train_optim_loss: 435760.6390; val_kl_reg_loss: 6540.2891; val_edge_recon_loss: 257147.0048; val_gene_expr_recon_loss: 171633.4307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 435320.7255; val_optim_loss: 435320.7255
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 6569.7428; train_edge_recon_loss: 257347.4206; train_gene_expr_recon_loss: 171290.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435207.3448; train_optim_loss: 435207.3448; val_kl_reg_loss: 6550.4752; val_edge_recon_loss: 256959.0830; val_gene_expr_recon_loss: 171313.0438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434822.6019; val_optim_loss: 434822.6019
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9964; val_auprc_score: 0.9954; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 6581.4067; train_edge_recon_loss: 257130.5730; train_gene_expr_recon_loss: 171007.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434718.9814; train_optim_loss: 434718.9814; val_kl_reg_loss: 6460.7780; val_edge_recon_loss: 256717.0420; val_gene_expr_recon_loss: 171326.7395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434504.5599; val_optim_loss: 434504.5599
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9818; val_best_f1_score: 0.9819; train_kl_reg_loss: 6585.3763; train_edge_recon_loss: 257059.4233; train_gene_expr_recon_loss: 170897.4999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434542.2994; train_optim_loss: 434542.2994; val_kl_reg_loss: 6596.7180; val_edge_recon_loss: 256753.8961; val_gene_expr_recon_loss: 170907.4833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434258.0975; val_optim_loss: 434258.0975
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 6594.1211; train_edge_recon_loss: 256893.7368; train_gene_expr_recon_loss: 170679.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434166.9960; train_optim_loss: 434166.9960; val_kl_reg_loss: 6636.1441; val_edge_recon_loss: 256670.5037; val_gene_expr_recon_loss: 171192.2424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434498.8906; val_optim_loss: 434498.8906
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 6599.1129; train_edge_recon_loss: 256905.7090; train_gene_expr_recon_loss: 170588.2926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434093.1143; train_optim_loss: 434093.1143; val_kl_reg_loss: 6539.5566; val_edge_recon_loss: 256548.7683; val_gene_expr_recon_loss: 171064.0542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 434152.3799; val_optim_loss: 434152.3799
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9829; val_best_f1_score: 0.9831; train_kl_reg_loss: 6603.3931; train_edge_recon_loss: 256754.6015; train_gene_expr_recon_loss: 170452.3777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433810.3721; train_optim_loss: 433810.3721; val_kl_reg_loss: 6558.7554; val_edge_recon_loss: 256474.2483; val_gene_expr_recon_loss: 170528.8383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433561.8418; val_optim_loss: 433561.8418
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 6614.0780; train_edge_recon_loss: 256734.2873; train_gene_expr_recon_loss: 170472.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433820.5384; train_optim_loss: 433820.5384; val_kl_reg_loss: 6596.9098; val_edge_recon_loss: 256251.7311; val_gene_expr_recon_loss: 170913.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433762.1772; val_optim_loss: 433762.1772
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9968; val_auprc_score: 0.9960; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 6616.6526; train_edge_recon_loss: 256723.8342; train_gene_expr_recon_loss: 170282.5495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433623.0363; train_optim_loss: 433623.0363; val_kl_reg_loss: 6607.3131; val_edge_recon_loss: 256070.2042; val_gene_expr_recon_loss: 170725.1104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433402.6278; val_optim_loss: 433402.6278
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 6626.2335; train_edge_recon_loss: 256606.5328; train_gene_expr_recon_loss: 170247.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433480.5207; train_optim_loss: 433480.5207; val_kl_reg_loss: 6625.7456; val_edge_recon_loss: 256203.7843; val_gene_expr_recon_loss: 170901.4290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433730.9592; val_optim_loss: 433730.9592
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 6632.2718; train_edge_recon_loss: 256528.4716; train_gene_expr_recon_loss: 170166.7860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433327.5295; train_optim_loss: 433327.5295; val_kl_reg_loss: 6596.3777; val_edge_recon_loss: 256181.1019; val_gene_expr_recon_loss: 170687.2701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433464.7499; val_optim_loss: 433464.7499
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 6639.9897; train_edge_recon_loss: 256450.5913; train_gene_expr_recon_loss: 170150.8806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433241.4612; train_optim_loss: 433241.4612; val_kl_reg_loss: 6578.5999; val_edge_recon_loss: 256022.5725; val_gene_expr_recon_loss: 170356.4237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432957.5962; val_optim_loss: 432957.5962
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 6645.4003; train_edge_recon_loss: 256462.4636; train_gene_expr_recon_loss: 170057.4820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433165.3456; train_optim_loss: 433165.3456; val_kl_reg_loss: 6610.3075; val_edge_recon_loss: 255776.0941; val_gene_expr_recon_loss: 170767.5538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433153.9556; val_optim_loss: 433153.9556
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9848; val_best_f1_score: 0.9850; train_kl_reg_loss: 6646.8330; train_edge_recon_loss: 256403.1488; train_gene_expr_recon_loss: 169893.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432943.3859; train_optim_loss: 432943.3859; val_kl_reg_loss: 6615.4051; val_edge_recon_loss: 256014.6605; val_gene_expr_recon_loss: 170867.0626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433497.1277; val_optim_loss: 433497.1277
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6654.5550; train_edge_recon_loss: 256325.7533; train_gene_expr_recon_loss: 169945.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432925.7308; train_optim_loss: 432925.7308; val_kl_reg_loss: 6671.4765; val_edge_recon_loss: 255798.2907; val_gene_expr_recon_loss: 170504.7593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432974.5261; val_optim_loss: 432974.5261
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 6657.9632; train_edge_recon_loss: 256319.7872; train_gene_expr_recon_loss: 169877.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432854.8048; train_optim_loss: 432854.8048; val_kl_reg_loss: 6637.4071; val_edge_recon_loss: 256021.1260; val_gene_expr_recon_loss: 170850.0357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 433508.5690; val_optim_loss: 433508.5690

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6690.6484; train_edge_recon_loss: 256070.8423; train_gene_expr_recon_loss: 168817.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431578.8699; train_optim_loss: 431578.8699; val_kl_reg_loss: 6664.9026; val_edge_recon_loss: 255749.6635; val_gene_expr_recon_loss: 169851.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432265.9903; val_optim_loss: 432265.9903
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 6680.5920; train_edge_recon_loss: 256103.4267; train_gene_expr_recon_loss: 168527.1468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431311.1654; train_optim_loss: 431311.1654; val_kl_reg_loss: 6651.1024; val_edge_recon_loss: 255829.3310; val_gene_expr_recon_loss: 169228.1102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431708.5434; val_optim_loss: 431708.5434
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6679.7956; train_edge_recon_loss: 256038.9526; train_gene_expr_recon_loss: 168417.1158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431135.8643; train_optim_loss: 431135.8643; val_kl_reg_loss: 6670.5479; val_edge_recon_loss: 255794.0293; val_gene_expr_recon_loss: 169830.6355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432295.2113; val_optim_loss: 432295.2113
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 6683.4811; train_edge_recon_loss: 256065.3292; train_gene_expr_recon_loss: 168523.7210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431272.5313; train_optim_loss: 431272.5313; val_kl_reg_loss: 6644.1985; val_edge_recon_loss: 255866.4654; val_gene_expr_recon_loss: 169683.9538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432194.6185; val_optim_loss: 432194.6185
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9978; val_auprc_score: 0.9968; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 6682.5564; train_edge_recon_loss: 255987.8131; train_gene_expr_recon_loss: 168374.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431044.8615; train_optim_loss: 431044.8615; val_kl_reg_loss: 6671.4594; val_edge_recon_loss: 255599.7197; val_gene_expr_recon_loss: 169720.6934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431991.8735; val_optim_loss: 431991.8735
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6680.0051; train_edge_recon_loss: 256009.9145; train_gene_expr_recon_loss: 168286.0892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430976.0086; train_optim_loss: 430976.0086; val_kl_reg_loss: 6675.4714; val_edge_recon_loss: 255568.2289; val_gene_expr_recon_loss: 169625.2982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431868.9985; val_optim_loss: 431868.9985

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 6683.4117; train_edge_recon_loss: 256013.3733; train_gene_expr_recon_loss: 168135.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430832.2072; train_optim_loss: 430832.2072; val_kl_reg_loss: 6654.4394; val_edge_recon_loss: 255934.9308; val_gene_expr_recon_loss: 169874.5726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432463.9431; val_optim_loss: 432463.9431
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9852; val_best_f1_score: 0.9854; train_kl_reg_loss: 6682.0398; train_edge_recon_loss: 255989.3232; train_gene_expr_recon_loss: 168194.1881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430865.5511; train_optim_loss: 430865.5511; val_kl_reg_loss: 6662.6239; val_edge_recon_loss: 255771.1890; val_gene_expr_recon_loss: 169610.6378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432044.4509; val_optim_loss: 432044.4509
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6683.4241; train_edge_recon_loss: 255945.7559; train_gene_expr_recon_loss: 168167.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430796.7911; train_optim_loss: 430796.7911; val_kl_reg_loss: 6650.9887; val_edge_recon_loss: 255541.5595; val_gene_expr_recon_loss: 169647.8520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431840.4006; val_optim_loss: 431840.4006
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6683.9527; train_edge_recon_loss: 255996.2885; train_gene_expr_recon_loss: 168071.2832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430751.5239; train_optim_loss: 430751.5239; val_kl_reg_loss: 6657.4148; val_edge_recon_loss: 255589.5187; val_gene_expr_recon_loss: 169437.4465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431684.3804; val_optim_loss: 431684.3804
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9863; val_best_f1_score: 0.9865; train_kl_reg_loss: 6683.6525; train_edge_recon_loss: 256003.2191; train_gene_expr_recon_loss: 168171.6449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430858.5162; train_optim_loss: 430858.5162; val_kl_reg_loss: 6656.1569; val_edge_recon_loss: 255403.0398; val_gene_expr_recon_loss: 169532.2968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431591.4942; val_optim_loss: 431591.4942
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6682.8560; train_edge_recon_loss: 255977.8808; train_gene_expr_recon_loss: 168217.9945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430878.7314; train_optim_loss: 430878.7314; val_kl_reg_loss: 6656.3394; val_edge_recon_loss: 255514.9509; val_gene_expr_recon_loss: 169773.6213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431944.9110; val_optim_loss: 431944.9110
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9856; val_best_f1_score: 0.9858; train_kl_reg_loss: 6681.0947; train_edge_recon_loss: 256004.0165; train_gene_expr_recon_loss: 168125.7103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430810.8215; train_optim_loss: 430810.8215; val_kl_reg_loss: 6652.9159; val_edge_recon_loss: 255625.4347; val_gene_expr_recon_loss: 169741.2210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432019.5717; val_optim_loss: 432019.5717
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6684.6776; train_edge_recon_loss: 256036.3486; train_gene_expr_recon_loss: 168302.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431023.9094; train_optim_loss: 431023.9094; val_kl_reg_loss: 6661.6158; val_edge_recon_loss: 255523.5470; val_gene_expr_recon_loss: 169669.8723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431855.0350; val_optim_loss: 431855.0350
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 6684.2501; train_edge_recon_loss: 255985.9107; train_gene_expr_recon_loss: 168061.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430732.1225; train_optim_loss: 430732.1225; val_kl_reg_loss: 6657.4662; val_edge_recon_loss: 255744.5306; val_gene_expr_recon_loss: 169449.1752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431851.1712; val_optim_loss: 431851.1712

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 6683.6490; train_edge_recon_loss: 255966.0331; train_gene_expr_recon_loss: 168145.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430795.2971; train_optim_loss: 430795.2971; val_kl_reg_loss: 6656.9212; val_edge_recon_loss: 255525.0551; val_gene_expr_recon_loss: 169408.0150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431589.9920; val_optim_loss: 431589.9920
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6684.2794; train_edge_recon_loss: 256029.1308; train_gene_expr_recon_loss: 168049.6283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430763.0386; train_optim_loss: 430763.0386; val_kl_reg_loss: 6655.3193; val_edge_recon_loss: 255551.8304; val_gene_expr_recon_loss: 169326.6360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431533.7854; val_optim_loss: 431533.7854
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6682.7023; train_edge_recon_loss: 255957.7717; train_gene_expr_recon_loss: 168224.3657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430864.8394; train_optim_loss: 430864.8394; val_kl_reg_loss: 6657.9113; val_edge_recon_loss: 255678.3334; val_gene_expr_recon_loss: 169559.6637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431895.9070; val_optim_loss: 431895.9070
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6684.5539; train_edge_recon_loss: 256022.0870; train_gene_expr_recon_loss: 168003.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430710.4910; train_optim_loss: 430710.4910; val_kl_reg_loss: 6654.6654; val_edge_recon_loss: 255713.6366; val_gene_expr_recon_loss: 169542.4349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431910.7375; val_optim_loss: 431910.7375
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9978; val_auprc_score: 0.9971; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 6682.0018; train_edge_recon_loss: 255978.5755; train_gene_expr_recon_loss: 168129.1148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430789.6918; train_optim_loss: 430789.6918; val_kl_reg_loss: 6660.6536; val_edge_recon_loss: 255603.5511; val_gene_expr_recon_loss: 170313.2079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432577.4132; val_optim_loss: 432577.4132
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 6682.8749; train_edge_recon_loss: 255994.2239; train_gene_expr_recon_loss: 168165.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430842.9490; train_optim_loss: 430842.9490; val_kl_reg_loss: 6654.4384; val_edge_recon_loss: 255590.8499; val_gene_expr_recon_loss: 169437.0545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431682.3427; val_optim_loss: 431682.3427

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 6681.3371; train_edge_recon_loss: 256005.9168; train_gene_expr_recon_loss: 168034.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430721.3727; train_optim_loss: 430721.3727; val_kl_reg_loss: 6656.5447; val_edge_recon_loss: 255366.5718; val_gene_expr_recon_loss: 169513.1413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431536.2587; val_optim_loss: 431536.2587
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6682.3150; train_edge_recon_loss: 256025.2064; train_gene_expr_recon_loss: 168098.1760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430805.6977; train_optim_loss: 430805.6977; val_kl_reg_loss: 6655.5377; val_edge_recon_loss: 255853.4496; val_gene_expr_recon_loss: 169585.5486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 432094.5367; val_optim_loss: 432094.5367
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 6681.4785; train_edge_recon_loss: 256012.4998; train_gene_expr_recon_loss: 168140.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430834.6325; train_optim_loss: 430834.6325; val_kl_reg_loss: 6657.5563; val_edge_recon_loss: 255711.7279; val_gene_expr_recon_loss: 169599.6366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431968.9201; val_optim_loss: 431968.9201
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 6680.2823; train_edge_recon_loss: 256010.1727; train_gene_expr_recon_loss: 168100.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 430791.2782; train_optim_loss: 430791.2782; val_kl_reg_loss: 6654.1773; val_edge_recon_loss: 255701.3250; val_gene_expr_recon_loss: 169523.3607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431878.8627; val_optim_loss: 431878.8627

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 298 min 8 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9975
val AUPRC score: 0.9968
val best accuracy score: 0.9856
val best F1 score: 0.9857
val target rna MSE score: 0.5830
val source rna MSE score: 0.0701

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
