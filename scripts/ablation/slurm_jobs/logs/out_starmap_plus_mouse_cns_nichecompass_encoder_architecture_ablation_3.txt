None
Run timestamp: 20072023_111648_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9826; val_auprc_score: 0.9771; val_best_acc_score: 0.9459; val_best_f1_score: 0.9473; train_kl_reg_loss: 87469.0726; train_edge_recon_loss: 26461964.5964; train_gene_expr_recon_loss: 11118874.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37668307.9061; train_optim_loss: 37668307.9061; val_kl_reg_loss: 87341.6942; val_edge_recon_loss: 26015728.2975; val_gene_expr_recon_loss: 10328467.6074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36431537.6529; val_optim_loss: 36431537.6529
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9849; val_auprc_score: 0.9804; val_best_acc_score: 0.9523; val_best_f1_score: 0.9536; train_kl_reg_loss: 78301.5555; train_edge_recon_loss: 25880783.9586; train_gene_expr_recon_loss: 10158114.2253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36117199.7165; train_optim_loss: 36117199.7165; val_kl_reg_loss: 67287.6734; val_edge_recon_loss: 25900337.8595; val_gene_expr_recon_loss: 9996013.5331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35963638.9752; val_optim_loss: 35963638.9752
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9879; val_auprc_score: 0.9843; val_best_acc_score: 0.9592; val_best_f1_score: 0.9602; train_kl_reg_loss: 65413.5912; train_edge_recon_loss: 25761693.5122; train_gene_expr_recon_loss: 9947222.8224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35774329.9301; train_optim_loss: 35774329.9301; val_kl_reg_loss: 61168.7076; val_edge_recon_loss: 25803104.1240; val_gene_expr_recon_loss: 9910161.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35774434.8264; val_optim_loss: 35774434.8264
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9900; val_auprc_score: 0.9873; val_best_acc_score: 0.9649; val_best_f1_score: 0.9656; train_kl_reg_loss: 59750.3935; train_edge_recon_loss: 25711781.7331; train_gene_expr_recon_loss: 9843587.1622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35615119.2655; train_optim_loss: 35615119.2655; val_kl_reg_loss: 57622.6158; val_edge_recon_loss: 25721445.2810; val_gene_expr_recon_loss: 9825208.7893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35604276.6116; val_optim_loss: 35604276.6116
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9902; val_auprc_score: 0.9873; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 56250.7258; train_edge_recon_loss: 25663913.1624; train_gene_expr_recon_loss: 9774252.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35494416.0212; train_optim_loss: 35494416.0212; val_kl_reg_loss: 53199.0699; val_edge_recon_loss: 25700601.3719; val_gene_expr_recon_loss: 9764275.5992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35518075.9174; val_optim_loss: 35518075.9174
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9902; val_auprc_score: 0.9867; val_best_acc_score: 0.9679; val_best_f1_score: 0.9686; train_kl_reg_loss: 53705.7548; train_edge_recon_loss: 25638964.4022; train_gene_expr_recon_loss: 9737094.7977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35429764.9544; train_optim_loss: 35429764.9544; val_kl_reg_loss: 53375.3193; val_edge_recon_loss: 25716224.4959; val_gene_expr_recon_loss: 9746406.0868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35516005.7851; val_optim_loss: 35516005.7851
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9905; val_auprc_score: 0.9872; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 52472.1364; train_edge_recon_loss: 25627260.1261; train_gene_expr_recon_loss: 9680999.8914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35360732.1463; train_optim_loss: 35360732.1463; val_kl_reg_loss: 52643.9571; val_edge_recon_loss: 25675660.9091; val_gene_expr_recon_loss: 9715288.3079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35443593.1240; val_optim_loss: 35443593.1240
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9898; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 51284.2872; train_edge_recon_loss: 25597807.3622; train_gene_expr_recon_loss: 9641229.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35290321.3962; train_optim_loss: 35290321.3962; val_kl_reg_loss: 50368.8427; val_edge_recon_loss: 25659959.0496; val_gene_expr_recon_loss: 9675297.4236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35385625.2397; val_optim_loss: 35385625.2397
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 51263.5599; train_edge_recon_loss: 25594460.5311; train_gene_expr_recon_loss: 9589629.4024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35235353.4496; train_optim_loss: 35235353.4496; val_kl_reg_loss: 51453.8935; val_edge_recon_loss: 25642544.1983; val_gene_expr_recon_loss: 9694917.3967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35388915.5372; val_optim_loss: 35388915.5372
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9720; val_best_f1_score: 0.9725; train_kl_reg_loss: 50475.8770; train_edge_recon_loss: 25594028.3967; train_gene_expr_recon_loss: 9565773.4416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35210277.7423; train_optim_loss: 35210277.7423; val_kl_reg_loss: 49955.6859; val_edge_recon_loss: 25623141.3802; val_gene_expr_recon_loss: 9671317.4153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35344414.6116; val_optim_loss: 35344414.6116
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9723; val_best_f1_score: 0.9727; train_kl_reg_loss: 50246.4760; train_edge_recon_loss: 25584908.1951; train_gene_expr_recon_loss: 9550878.1139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35186032.7823; train_optim_loss: 35186032.7823; val_kl_reg_loss: 49276.6945; val_edge_recon_loss: 25635105.7686; val_gene_expr_recon_loss: 9665360.0764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35349742.5785; val_optim_loss: 35349742.5785
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9930; val_auprc_score: 0.9911; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 50028.9918; train_edge_recon_loss: 25583079.5242; train_gene_expr_recon_loss: 9518388.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35151497.0511; train_optim_loss: 35151497.0511; val_kl_reg_loss: 49575.9082; val_edge_recon_loss: 25645426.3802; val_gene_expr_recon_loss: 9655889.3347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35350891.4298; val_optim_loss: 35350891.4298
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9913; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 49569.9302; train_edge_recon_loss: 25574160.5762; train_gene_expr_recon_loss: 9506562.6091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35130293.1173; train_optim_loss: 35130293.1173; val_kl_reg_loss: 50448.9194; val_edge_recon_loss: 25624991.6612; val_gene_expr_recon_loss: 9661288.0041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35336728.6446; val_optim_loss: 35336728.6446
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9918; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 49957.0739; train_edge_recon_loss: 25565345.9080; train_gene_expr_recon_loss: 9486882.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35102185.8132; train_optim_loss: 35102185.8132; val_kl_reg_loss: 50000.4387; val_edge_recon_loss: 25597747.6694; val_gene_expr_recon_loss: 9655016.3533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35302764.3140; val_optim_loss: 35302764.3140
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9938; val_auprc_score: 0.9919; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 49719.9972; train_edge_recon_loss: 25564262.7851; train_gene_expr_recon_loss: 9470931.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35084913.9503; train_optim_loss: 35084913.9503; val_kl_reg_loss: 49433.4897; val_edge_recon_loss: 25595524.4876; val_gene_expr_recon_loss: 9652214.6570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35297172.4793; val_optim_loss: 35297172.4793
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 49592.4707; train_edge_recon_loss: 25552444.5246; train_gene_expr_recon_loss: 9457250.4452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35059287.4726; train_optim_loss: 35059287.4726; val_kl_reg_loss: 49002.6659; val_edge_recon_loss: 25578805.1818; val_gene_expr_recon_loss: 9659466.7521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35287274.6281; val_optim_loss: 35287274.6281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9935; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 49629.0211; train_edge_recon_loss: 25545746.3636; train_gene_expr_recon_loss: 9444725.7161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35040101.0943; train_optim_loss: 35040101.0943; val_kl_reg_loss: 49719.2123; val_edge_recon_loss: 25587003.6777; val_gene_expr_recon_loss: 9647461.3037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35284184.4132; val_optim_loss: 35284184.4132
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9759; val_best_f1_score: 0.9763; train_kl_reg_loss: 49595.7736; train_edge_recon_loss: 25548239.7478; train_gene_expr_recon_loss: 9437002.1855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35034837.6852; train_optim_loss: 35034837.6852; val_kl_reg_loss: 50632.4890; val_edge_recon_loss: 25595209.3802; val_gene_expr_recon_loss: 9638102.4669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35283944.2314; val_optim_loss: 35283944.2314
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9946; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 49732.4466; train_edge_recon_loss: 25548539.0410; train_gene_expr_recon_loss: 9420631.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35018903.2508; train_optim_loss: 35018903.2508; val_kl_reg_loss: 49654.7326; val_edge_recon_loss: 25575975.6364; val_gene_expr_recon_loss: 9648594.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35274224.4050; val_optim_loss: 35274224.4050
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9764; val_best_f1_score: 0.9768; train_kl_reg_loss: 49658.4387; train_edge_recon_loss: 25543337.5472; train_gene_expr_recon_loss: 9405355.1261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34998351.1459; train_optim_loss: 34998351.1459; val_kl_reg_loss: 49868.1934; val_edge_recon_loss: 25603500.3223; val_gene_expr_recon_loss: 9642987.9339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35296356.5785; val_optim_loss: 35296356.5785
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 49929.3305; train_edge_recon_loss: 25528596.9231; train_gene_expr_recon_loss: 9394585.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34973111.6935; train_optim_loss: 34973111.6935; val_kl_reg_loss: 49293.6235; val_edge_recon_loss: 25585046.5868; val_gene_expr_recon_loss: 9637007.1777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35271347.4298; val_optim_loss: 35271347.4298
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9948; val_auprc_score: 0.9931; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 49692.3274; train_edge_recon_loss: 25537833.3410; train_gene_expr_recon_loss: 9394338.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34981863.7644; train_optim_loss: 34981863.7644; val_kl_reg_loss: 50284.9145; val_edge_recon_loss: 25585317.1240; val_gene_expr_recon_loss: 9643326.7211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35278928.8843; val_optim_loss: 35278928.8843
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 49977.6545; train_edge_recon_loss: 25529913.0511; train_gene_expr_recon_loss: 9384880.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34964771.6981; train_optim_loss: 34964771.6981; val_kl_reg_loss: 50105.2031; val_edge_recon_loss: 25619052.0744; val_gene_expr_recon_loss: 9656327.4174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35325484.7438; val_optim_loss: 35325484.7438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 49886.5590; train_edge_recon_loss: 25526356.3543; train_gene_expr_recon_loss: 9383042.6924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34959285.5913; train_optim_loss: 34959285.5913; val_kl_reg_loss: 49670.2207; val_edge_recon_loss: 25579073.8595; val_gene_expr_recon_loss: 9643671.7624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35272415.9587; val_optim_loss: 35272415.9587
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 49943.3075; train_edge_recon_loss: 25521307.7138; train_gene_expr_recon_loss: 9373614.5522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34944865.5573; train_optim_loss: 34944865.5573; val_kl_reg_loss: 49557.3876; val_edge_recon_loss: 25571891.0413; val_gene_expr_recon_loss: 9649232.1653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35270680.5620; val_optim_loss: 35270680.5620
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 50339.5421; train_edge_recon_loss: 25512564.0101; train_gene_expr_recon_loss: 9356296.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34919200.2172; train_optim_loss: 34919200.2172; val_kl_reg_loss: 49290.8230; val_edge_recon_loss: 25604802.4298; val_gene_expr_recon_loss: 9647361.6612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35301455.0413; val_optim_loss: 35301455.0413
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 49976.0432; train_edge_recon_loss: 25519820.5900; train_gene_expr_recon_loss: 9349784.6351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34919581.2517; train_optim_loss: 34919581.2517; val_kl_reg_loss: 50551.6392; val_edge_recon_loss: 25583730.5289; val_gene_expr_recon_loss: 9632273.8161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35266555.9835; val_optim_loss: 35266555.9835
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9945; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 50302.8162; train_edge_recon_loss: 25514656.9931; train_gene_expr_recon_loss: 9360194.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34925154.0580; train_optim_loss: 34925154.0580; val_kl_reg_loss: 49703.8632; val_edge_recon_loss: 25567342.8760; val_gene_expr_recon_loss: 9659120.9752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35276167.5785; val_optim_loss: 35276167.5785
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 50001.6942; train_edge_recon_loss: 25511312.4068; train_gene_expr_recon_loss: 9350121.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34911436.0644; train_optim_loss: 34911436.0644; val_kl_reg_loss: 48320.3700; val_edge_recon_loss: 25566912.7273; val_gene_expr_recon_loss: 9653163.0124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35268396.1322; val_optim_loss: 35268396.1322
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9959; val_auprc_score: 0.9947; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 50209.0313; train_edge_recon_loss: 25516942.2577; train_gene_expr_recon_loss: 9339495.6555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34906646.9416; train_optim_loss: 34906646.9416; val_kl_reg_loss: 49743.8358; val_edge_recon_loss: 25575342.2645; val_gene_expr_recon_loss: 9658934.9628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35284020.9669; val_optim_loss: 35284020.9669
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 50412.5912; train_edge_recon_loss: 25500028.3166; train_gene_expr_recon_loss: 9338344.6325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34888785.5177; train_optim_loss: 34888785.5177; val_kl_reg_loss: 51067.6046; val_edge_recon_loss: 25547200.9752; val_gene_expr_recon_loss: 9631122.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35229390.9421; val_optim_loss: 35229390.9421
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9954; val_auprc_score: 0.9938; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 50350.3971; train_edge_recon_loss: 25503961.8251; train_gene_expr_recon_loss: 9342308.1291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34896620.3562; train_optim_loss: 34896620.3562; val_kl_reg_loss: 50640.8017; val_edge_recon_loss: 25560383.2727; val_gene_expr_recon_loss: 9669421.6033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35280445.7107; val_optim_loss: 35280445.7107
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 50370.6481; train_edge_recon_loss: 25507201.2296; train_gene_expr_recon_loss: 9327955.3288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34885527.1680; train_optim_loss: 34885527.1680; val_kl_reg_loss: 50504.7630; val_edge_recon_loss: 25567107.9174; val_gene_expr_recon_loss: 9643460.9897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35261073.6364; val_optim_loss: 35261073.6364
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9956; val_auprc_score: 0.9946; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 50675.1490; train_edge_recon_loss: 25506985.7128; train_gene_expr_recon_loss: 9332212.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34889873.8647; train_optim_loss: 34889873.8647; val_kl_reg_loss: 50186.9685; val_edge_recon_loss: 25561040.9587; val_gene_expr_recon_loss: 9647010.7748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35258238.6033; val_optim_loss: 35258238.6033
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 50689.1294; train_edge_recon_loss: 25498142.3083; train_gene_expr_recon_loss: 9320459.3422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34869290.8026; train_optim_loss: 34869290.8026; val_kl_reg_loss: 50326.7366; val_edge_recon_loss: 25543112.3802; val_gene_expr_recon_loss: 9649824.4855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35243263.6364; val_optim_loss: 35243263.6364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9802; val_best_f1_score: 0.9805; train_kl_reg_loss: 54369.7226; train_edge_recon_loss: 25479429.5904; train_gene_expr_recon_loss: 9202552.5762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34736351.9347; train_optim_loss: 34736351.9347; val_kl_reg_loss: 55212.3446; val_edge_recon_loss: 25511230.6446; val_gene_expr_recon_loss: 9597125.5145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35163568.5950; val_optim_loss: 35163568.5950
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9960; val_auprc_score: 0.9951; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 56301.7097; train_edge_recon_loss: 25493175.4975; train_gene_expr_recon_loss: 9179736.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34729213.3336; train_optim_loss: 34729213.3336; val_kl_reg_loss: 56328.9237; val_edge_recon_loss: 25535195.0579; val_gene_expr_recon_loss: 9581624.6178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35173148.7025; val_optim_loss: 35173148.7025
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 57508.8932; train_edge_recon_loss: 25485938.5081; train_gene_expr_recon_loss: 9174706.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34718153.4818; train_optim_loss: 34718153.4818; val_kl_reg_loss: 57358.5568; val_edge_recon_loss: 25509369.2397; val_gene_expr_recon_loss: 9573820.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35140548.3140; val_optim_loss: 35140548.3140
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 57794.8224; train_edge_recon_loss: 25483800.0433; train_gene_expr_recon_loss: 9167395.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34708990.2485; train_optim_loss: 34708990.2485; val_kl_reg_loss: 57459.5204; val_edge_recon_loss: 25536973.4298; val_gene_expr_recon_loss: 9582742.7128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35177175.6446; val_optim_loss: 35177175.6446
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 58168.6255; train_edge_recon_loss: 25470605.7644; train_gene_expr_recon_loss: 9158407.9775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34687182.4087; train_optim_loss: 34687182.4087; val_kl_reg_loss: 57629.8907; val_edge_recon_loss: 25523727.7190; val_gene_expr_recon_loss: 9548762.7355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35130120.3058; val_optim_loss: 35130120.3058
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9960; val_auprc_score: 0.9948; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 58266.4949; train_edge_recon_loss: 25476880.1758; train_gene_expr_recon_loss: 9157526.1742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34692672.8873; train_optim_loss: 34692672.8873; val_kl_reg_loss: 57554.4615; val_edge_recon_loss: 25535401.8760; val_gene_expr_recon_loss: 9564191.7769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35157148.2314; val_optim_loss: 35157148.2314
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9808; train_kl_reg_loss: 58294.9483; train_edge_recon_loss: 25471337.7405; train_gene_expr_recon_loss: 9155090.4455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34684723.1634; train_optim_loss: 34684723.1634; val_kl_reg_loss: 58038.2675; val_edge_recon_loss: 25524722.8512; val_gene_expr_recon_loss: 9576173.5310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35158934.4876; val_optim_loss: 35158934.4876
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 58319.7161; train_edge_recon_loss: 25486771.7616; train_gene_expr_recon_loss: 9158511.5062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34703602.9922; train_optim_loss: 34703602.9922; val_kl_reg_loss: 57489.3892; val_edge_recon_loss: 25531897.9917; val_gene_expr_recon_loss: 9573494.4959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35162881.7934; val_optim_loss: 35162881.7934
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9962; val_auprc_score: 0.9950; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 58348.9421; train_edge_recon_loss: 25480102.3636; train_gene_expr_recon_loss: 9151601.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34690053.2352; train_optim_loss: 34690053.2352; val_kl_reg_loss: 57664.6553; val_edge_recon_loss: 25504460.2397; val_gene_expr_recon_loss: 9553591.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35115716.7686; val_optim_loss: 35115716.7686
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 58394.9159; train_edge_recon_loss: 25473684.1335; train_gene_expr_recon_loss: 9146879.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34678958.3774; train_optim_loss: 34678958.3774; val_kl_reg_loss: 57732.5565; val_edge_recon_loss: 25536961.0165; val_gene_expr_recon_loss: 9581300.5413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35175994.1570; val_optim_loss: 35175994.1570
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 58468.4019; train_edge_recon_loss: 25468133.5076; train_gene_expr_recon_loss: 9146252.5529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34672854.4841; train_optim_loss: 34672854.4841; val_kl_reg_loss: 58078.6434; val_edge_recon_loss: 25526910.3058; val_gene_expr_recon_loss: 9566703.8822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35151692.9091; val_optim_loss: 35151692.9091
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 58467.6595; train_edge_recon_loss: 25477721.8711; train_gene_expr_recon_loss: 9141510.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34677699.7929; train_optim_loss: 34677699.7929; val_kl_reg_loss: 57858.9821; val_edge_recon_loss: 25525145.3306; val_gene_expr_recon_loss: 9576946.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35159950.6116; val_optim_loss: 35159950.6116
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 58314.7592; train_edge_recon_loss: 25474656.8900; train_gene_expr_recon_loss: 9137776.7050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34670748.3580; train_optim_loss: 34670748.3580; val_kl_reg_loss: 57527.8947; val_edge_recon_loss: 25539316.3636; val_gene_expr_recon_loss: 9579007.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35175851.6116; val_optim_loss: 35175851.6116

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9963; val_auprc_score: 0.9955; val_best_acc_score: 0.9812; val_best_f1_score: 0.9815; train_kl_reg_loss: 58535.8977; train_edge_recon_loss: 25474034.6424; train_gene_expr_recon_loss: 9131852.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34664422.5697; train_optim_loss: 34664422.5697; val_kl_reg_loss: 57930.8709; val_edge_recon_loss: 25518513.2810; val_gene_expr_recon_loss: 9561121.6467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35137565.7686; val_optim_loss: 35137565.7686
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 58628.2801; train_edge_recon_loss: 25469073.4128; train_gene_expr_recon_loss: 9119418.8562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34647120.5660; train_optim_loss: 34647120.5660; val_kl_reg_loss: 58150.5136; val_edge_recon_loss: 25528446.4298; val_gene_expr_recon_loss: 9570520.8285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35157117.7851; val_optim_loss: 35157117.7851
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 58717.3372; train_edge_recon_loss: 25473138.1914; train_gene_expr_recon_loss: 9123744.2195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34655599.7414; train_optim_loss: 34655599.7414; val_kl_reg_loss: 58174.4807; val_edge_recon_loss: 25537752.7686; val_gene_expr_recon_loss: 9557112.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35153039.4380; val_optim_loss: 35153039.4380
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 58837.8304; train_edge_recon_loss: 25476332.5605; train_gene_expr_recon_loss: 9122671.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34657841.7984; train_optim_loss: 34657841.7984; val_kl_reg_loss: 58138.0191; val_edge_recon_loss: 25530594.6942; val_gene_expr_recon_loss: 9538553.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35127285.9504; val_optim_loss: 35127285.9504

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 363 min 19 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9950
Val best accuracy score: 0.9811
Val best F1 score: 0.9813
Val gene expr MSE score: 0.6261

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
