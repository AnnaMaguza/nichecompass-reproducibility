None
Run timestamp: 15072023_074754_148.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_148']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9859; val_auprc_score: 0.9819; val_best_acc_score: 0.9516; val_best_f1_score: 0.9526; train_kl_reg_loss: 30028.2050; train_edge_recon_loss: 2665804.7768; train_gene_expr_recon_loss: 1178424.9154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3874257.8957; train_optim_loss: 3874257.8957; val_kl_reg_loss: 26857.2122; val_edge_recon_loss: 2607069.8781; val_gene_expr_recon_loss: 1081219.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3715147.0562; val_optim_loss: 3715147.0562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9894; val_auprc_score: 0.9861; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 25275.0634; train_edge_recon_loss: 2595664.1624; train_gene_expr_recon_loss: 1059392.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3680331.3748; train_optim_loss: 3680331.3748; val_kl_reg_loss: 23313.4703; val_edge_recon_loss: 2589699.7625; val_gene_expr_recon_loss: 1035282.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3648295.6969; val_optim_loss: 3648295.6969
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9887; val_best_acc_score: 0.9667; val_best_f1_score: 0.9673; train_kl_reg_loss: 22703.0218; train_edge_recon_loss: 2584394.1360; train_gene_expr_recon_loss: 1027039.5543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3634136.7079; train_optim_loss: 3634136.7079; val_kl_reg_loss: 21700.4451; val_edge_recon_loss: 2582779.1688; val_gene_expr_recon_loss: 1014520.9586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3619000.5656; val_optim_loss: 3619000.5656
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9924; val_auprc_score: 0.9900; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 20943.0720; train_edge_recon_loss: 2577753.8220; train_gene_expr_recon_loss: 1007597.0626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3606293.9604; train_optim_loss: 3606293.9604; val_kl_reg_loss: 20220.3857; val_edge_recon_loss: 2576643.1000; val_gene_expr_recon_loss: 1000298.1586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3597161.6313; val_optim_loss: 3597161.6313
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 19620.6716; train_edge_recon_loss: 2573714.9207; train_gene_expr_recon_loss: 997145.7803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3590481.3700; train_optim_loss: 3590481.3700; val_kl_reg_loss: 18901.9401; val_edge_recon_loss: 2574283.3156; val_gene_expr_recon_loss: 992912.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3586098.2313; val_optim_loss: 3586098.2313
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9943; val_auprc_score: 0.9924; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 18642.7101; train_edge_recon_loss: 2569523.9117; train_gene_expr_recon_loss: 989524.9532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3577691.5734; train_optim_loss: 3577691.5734; val_kl_reg_loss: 17816.7041; val_edge_recon_loss: 2569984.9312; val_gene_expr_recon_loss: 986338.1242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3574139.7687; val_optim_loss: 3574139.7687
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9947; val_auprc_score: 0.9931; val_best_acc_score: 0.9757; val_best_f1_score: 0.9760; train_kl_reg_loss: 17936.3373; train_edge_recon_loss: 2567307.1909; train_gene_expr_recon_loss: 983664.5147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3568908.0386; train_optim_loss: 3568908.0386; val_kl_reg_loss: 16958.2634; val_edge_recon_loss: 2568572.6344; val_gene_expr_recon_loss: 981059.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3566590.3344; val_optim_loss: 3566590.3344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9950; val_auprc_score: 0.9931; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 17257.4185; train_edge_recon_loss: 2564669.7681; train_gene_expr_recon_loss: 978471.5316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3560398.7201; train_optim_loss: 3560398.7201; val_kl_reg_loss: 16736.9845; val_edge_recon_loss: 2565667.1000; val_gene_expr_recon_loss: 980367.8969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3562771.9750; val_optim_loss: 3562771.9750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 16701.7965; train_edge_recon_loss: 2563332.6565; train_gene_expr_recon_loss: 974006.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3554041.1384; train_optim_loss: 3554041.1384; val_kl_reg_loss: 16286.5879; val_edge_recon_loss: 2565173.3000; val_gene_expr_recon_loss: 977070.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3558530.2875; val_optim_loss: 3558530.2875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 16294.5139; train_edge_recon_loss: 2560936.1513; train_gene_expr_recon_loss: 970833.1755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3548063.8397; train_optim_loss: 3548063.8397; val_kl_reg_loss: 15757.1812; val_edge_recon_loss: 2563317.6094; val_gene_expr_recon_loss: 976470.2680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3555545.0406; val_optim_loss: 3555545.0406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 15902.3059; train_edge_recon_loss: 2559281.9433; train_gene_expr_recon_loss: 967982.3364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3543166.5841; train_optim_loss: 3543166.5841; val_kl_reg_loss: 15782.0085; val_edge_recon_loss: 2560089.9594; val_gene_expr_recon_loss: 975360.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3551232.3000; val_optim_loss: 3551232.3000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9949; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 15603.4700; train_edge_recon_loss: 2558480.6930; train_gene_expr_recon_loss: 965582.8787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3539667.0421; train_optim_loss: 3539667.0421; val_kl_reg_loss: 15370.5510; val_edge_recon_loss: 2560447.5938; val_gene_expr_recon_loss: 974082.1031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3549900.2656; val_optim_loss: 3549900.2656
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 15332.2068; train_edge_recon_loss: 2557706.6116; train_gene_expr_recon_loss: 963245.8994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3536284.7173; train_optim_loss: 3536284.7173; val_kl_reg_loss: 15014.4437; val_edge_recon_loss: 2560295.0875; val_gene_expr_recon_loss: 973990.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3549299.9156; val_optim_loss: 3549299.9156
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9835; val_best_f1_score: 0.9837; train_kl_reg_loss: 15096.2160; train_edge_recon_loss: 2556070.9040; train_gene_expr_recon_loss: 961846.5677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3533013.6805; train_optim_loss: 3533013.6805; val_kl_reg_loss: 15086.6100; val_edge_recon_loss: 2558003.3875; val_gene_expr_recon_loss: 970100.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3543190.2844; val_optim_loss: 3543190.2844
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 14938.1014; train_edge_recon_loss: 2555898.0848; train_gene_expr_recon_loss: 959677.1526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3530513.3394; train_optim_loss: 3530513.3394; val_kl_reg_loss: 14833.8197; val_edge_recon_loss: 2558353.3156; val_gene_expr_recon_loss: 972416.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3545603.3125; val_optim_loss: 3545603.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 14798.5989; train_edge_recon_loss: 2554748.4360; train_gene_expr_recon_loss: 957000.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3526547.2816; train_optim_loss: 3526547.2816; val_kl_reg_loss: 14731.5444; val_edge_recon_loss: 2555093.3281; val_gene_expr_recon_loss: 970281.3688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3540106.2281; val_optim_loss: 3540106.2281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 14683.2763; train_edge_recon_loss: 2553622.1513; train_gene_expr_recon_loss: 955677.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3523983.3640; train_optim_loss: 3523983.3640; val_kl_reg_loss: 14586.9982; val_edge_recon_loss: 2555904.3687; val_gene_expr_recon_loss: 974489.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544981.3031; val_optim_loss: 3544981.3031
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9968; val_auprc_score: 0.9955; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 14562.5908; train_edge_recon_loss: 2553409.6690; train_gene_expr_recon_loss: 954229.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3522201.5497; train_optim_loss: 3522201.5497; val_kl_reg_loss: 14378.0674; val_edge_recon_loss: 2557626.8750; val_gene_expr_recon_loss: 972939.7859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3544944.7281; val_optim_loss: 3544944.7281
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 14446.1466; train_edge_recon_loss: 2553259.0014; train_gene_expr_recon_loss: 952103.8852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3519809.0316; train_optim_loss: 3519809.0316; val_kl_reg_loss: 14316.1660; val_edge_recon_loss: 2555615.6656; val_gene_expr_recon_loss: 972525.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3542457.7594; val_optim_loss: 3542457.7594
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 14376.9757; train_edge_recon_loss: 2551722.1568; train_gene_expr_recon_loss: 951056.6041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3517155.7385; train_optim_loss: 3517155.7385; val_kl_reg_loss: 14182.3160; val_edge_recon_loss: 2553465.6719; val_gene_expr_recon_loss: 973287.0594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3540935.0344; val_optim_loss: 3540935.0344

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9972; val_auprc_score: 0.9959; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 14755.4181; train_edge_recon_loss: 2550740.0539; train_gene_expr_recon_loss: 943252.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3508748.2907; train_optim_loss: 3508748.2907; val_kl_reg_loss: 14792.6584; val_edge_recon_loss: 2551217.4719; val_gene_expr_recon_loss: 969053.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535063.3531; val_optim_loss: 3535063.3531
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 14897.5871; train_edge_recon_loss: 2549872.6971; train_gene_expr_recon_loss: 942059.6014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3506829.8853; train_optim_loss: 3506829.8853; val_kl_reg_loss: 14774.5325; val_edge_recon_loss: 2553068.2594; val_gene_expr_recon_loss: 970115.2219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3537958.0156; val_optim_loss: 3537958.0156
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 14925.6577; train_edge_recon_loss: 2550604.7361; train_gene_expr_recon_loss: 941934.3968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3507464.7910; train_optim_loss: 3507464.7910; val_kl_reg_loss: 14769.8386; val_edge_recon_loss: 2552031.1469; val_gene_expr_recon_loss: 968878.3469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535679.3219; val_optim_loss: 3535679.3219
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 14932.9558; train_edge_recon_loss: 2550478.9503; train_gene_expr_recon_loss: 941050.2890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3506462.1971; train_optim_loss: 3506462.1971; val_kl_reg_loss: 14732.9020; val_edge_recon_loss: 2550097.7469; val_gene_expr_recon_loss: 970947.0336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3535777.6750; val_optim_loss: 3535777.6750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 14907.1186; train_edge_recon_loss: 2549703.9461; train_gene_expr_recon_loss: 941024.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3505635.6606; train_optim_loss: 3505635.6606; val_kl_reg_loss: 14731.8604; val_edge_recon_loss: 2552525.1500; val_gene_expr_recon_loss: 971229.2617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538486.2938; val_optim_loss: 3538486.2938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 14920.5774; train_edge_recon_loss: 2549880.9089; train_gene_expr_recon_loss: 940225.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3505026.6144; train_optim_loss: 3505026.6144; val_kl_reg_loss: 14783.2231; val_edge_recon_loss: 2552735.1969; val_gene_expr_recon_loss: 969008.9781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536527.4062; val_optim_loss: 3536527.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 14941.5771; train_edge_recon_loss: 2549949.7013; train_gene_expr_recon_loss: 939304.8533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3504196.1342; train_optim_loss: 3504196.1342; val_kl_reg_loss: 14792.8217; val_edge_recon_loss: 2551482.4000; val_gene_expr_recon_loss: 970594.6859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536869.8937; val_optim_loss: 3536869.8937
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 14957.1512; train_edge_recon_loss: 2548883.8373; train_gene_expr_recon_loss: 938851.9972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3502692.9868; train_optim_loss: 3502692.9868; val_kl_reg_loss: 14823.8927; val_edge_recon_loss: 2553620.3438; val_gene_expr_recon_loss: 969960.2219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3538404.4531; val_optim_loss: 3538404.4531
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9975; val_auprc_score: 0.9967; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 14956.2917; train_edge_recon_loss: 2550068.6481; train_gene_expr_recon_loss: 938927.6145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3503952.5483; train_optim_loss: 3503952.5483; val_kl_reg_loss: 14798.2591; val_edge_recon_loss: 2550429.9250; val_gene_expr_recon_loss: 971104.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3536332.9688; val_optim_loss: 3536332.9688

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 262 min 38 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9974
Val AUPRC score: 0.9965
Val best accuracy score: 0.9859
Val best F1 score: 0.9860
Val gene expr MSE score: 0.5986

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
