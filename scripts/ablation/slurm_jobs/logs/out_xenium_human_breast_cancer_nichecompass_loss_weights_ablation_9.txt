None
Run timestamp: 14072023_010848_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9373; val_auprc_score: 0.9191; val_best_acc_score: 0.8763; val_best_f1_score: 0.8847; train_kl_reg_loss: 19184.7785; train_edge_recon_loss: 26904569.7441; train_gene_expr_recon_loss: 906530.0253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27830284.5588; train_optim_loss: 27830284.5588; val_kl_reg_loss: 18467.3269; val_edge_recon_loss: 26801322.6316; val_gene_expr_recon_loss: 826007.7229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27645797.6579; val_optim_loss: 27645797.6579
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9524; val_auprc_score: 0.9396; val_best_acc_score: 0.8927; val_best_f1_score: 0.8982; train_kl_reg_loss: 16543.8100; train_edge_recon_loss: 26275297.5706; train_gene_expr_recon_loss: 802691.6604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27094533.0529; train_optim_loss: 27094533.0529; val_kl_reg_loss: 14061.5195; val_edge_recon_loss: 26691762.4211; val_gene_expr_recon_loss: 780655.4128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27486479.1053; val_optim_loss: 27486479.1053
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9607; val_auprc_score: 0.9493; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 14079.6833; train_edge_recon_loss: 26157909.2941; train_gene_expr_recon_loss: 767945.9048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26939934.8588; train_optim_loss: 26939934.8588; val_kl_reg_loss: 13167.1985; val_edge_recon_loss: 26579408.8684; val_gene_expr_recon_loss: 749769.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27342345.5263; val_optim_loss: 27342345.5263
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9639; val_auprc_score: 0.9527; val_best_acc_score: 0.9122; val_best_f1_score: 0.9160; train_kl_reg_loss: 13580.9443; train_edge_recon_loss: 26084748.0029; train_gene_expr_recon_loss: 741980.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26840309.1353; train_optim_loss: 26840309.1353; val_kl_reg_loss: 13360.7951; val_edge_recon_loss: 26556195.8947; val_gene_expr_recon_loss: 728275.7048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27297832.3421; val_optim_loss: 27297832.3421
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9682; val_auprc_score: 0.9594; val_best_acc_score: 0.9163; val_best_f1_score: 0.9192; train_kl_reg_loss: 13534.4806; train_edge_recon_loss: 26049258.0147; train_gene_expr_recon_loss: 724542.8006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26787335.2647; train_optim_loss: 26787335.2647; val_kl_reg_loss: 13360.9518; val_edge_recon_loss: 26527064.9474; val_gene_expr_recon_loss: 716740.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27257166.3947; val_optim_loss: 27257166.3947
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9701; val_auprc_score: 0.9614; val_best_acc_score: 0.9210; val_best_f1_score: 0.9236; train_kl_reg_loss: 13609.9281; train_edge_recon_loss: 26007661.1176; train_gene_expr_recon_loss: 711734.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26733005.4500; train_optim_loss: 26733005.4500; val_kl_reg_loss: 13090.7704; val_edge_recon_loss: 26458625.7632; val_gene_expr_recon_loss: 704235.8717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27175952.4474; val_optim_loss: 27175952.4474
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9678; val_auprc_score: 0.9582; val_best_acc_score: 0.9182; val_best_f1_score: 0.9209; train_kl_reg_loss: 13754.8577; train_edge_recon_loss: 25987377.6735; train_gene_expr_recon_loss: 702324.2866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26703456.7676; train_optim_loss: 26703456.7676; val_kl_reg_loss: 13725.6504; val_edge_recon_loss: 26524516.0526; val_gene_expr_recon_loss: 695039.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27233281.0000; val_optim_loss: 27233281.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9706; val_auprc_score: 0.9621; val_best_acc_score: 0.9221; val_best_f1_score: 0.9246; train_kl_reg_loss: 14132.3538; train_edge_recon_loss: 25979676.2559; train_gene_expr_recon_loss: 693881.5219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26687690.1618; train_optim_loss: 26687690.1618; val_kl_reg_loss: 14167.5637; val_edge_recon_loss: 26496688.3158; val_gene_expr_recon_loss: 686653.9704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27197509.8158; val_optim_loss: 27197509.8158
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9711; val_auprc_score: 0.9617; val_best_acc_score: 0.9227; val_best_f1_score: 0.9256; train_kl_reg_loss: 14374.3984; train_edge_recon_loss: 25952521.8471; train_gene_expr_recon_loss: 686700.1901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26653596.4559; train_optim_loss: 26653596.4559; val_kl_reg_loss: 14024.5311; val_edge_recon_loss: 26455168.7632; val_gene_expr_recon_loss: 682270.1003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27151463.3158; val_optim_loss: 27151463.3158
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9734; val_auprc_score: 0.9655; val_best_acc_score: 0.9264; val_best_f1_score: 0.9284; train_kl_reg_loss: 14615.7070; train_edge_recon_loss: 25957426.0794; train_gene_expr_recon_loss: 681315.9329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26653357.7088; train_optim_loss: 26653357.7088; val_kl_reg_loss: 14695.6380; val_edge_recon_loss: 26409493.0526; val_gene_expr_recon_loss: 678931.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27103120.5789; val_optim_loss: 27103120.5789
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9737; val_auprc_score: 0.9661; val_best_acc_score: 0.9272; val_best_f1_score: 0.9295; train_kl_reg_loss: 14779.3573; train_edge_recon_loss: 25936048.2735; train_gene_expr_recon_loss: 676191.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26627019.4559; train_optim_loss: 26627019.4559; val_kl_reg_loss: 14784.0552; val_edge_recon_loss: 26422665.2895; val_gene_expr_recon_loss: 673000.0600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27110449.3947; val_optim_loss: 27110449.3947
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9737; val_auprc_score: 0.9650; val_best_acc_score: 0.9283; val_best_f1_score: 0.9302; train_kl_reg_loss: 14860.2187; train_edge_recon_loss: 25932016.6529; train_gene_expr_recon_loss: 672519.4825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26619396.3706; train_optim_loss: 26619396.3706; val_kl_reg_loss: 14364.3930; val_edge_recon_loss: 26450055.8684; val_gene_expr_recon_loss: 670420.6283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27134840.7895; val_optim_loss: 27134840.7895
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9759; val_auprc_score: 0.9692; val_best_acc_score: 0.9302; val_best_f1_score: 0.9319; train_kl_reg_loss: 15185.3078; train_edge_recon_loss: 25920456.5353; train_gene_expr_recon_loss: 669057.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26604699.2706; train_optim_loss: 26604699.2706; val_kl_reg_loss: 14804.4106; val_edge_recon_loss: 26439726.9474; val_gene_expr_recon_loss: 666011.0436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27120542.3684; val_optim_loss: 27120542.3684
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9760; val_auprc_score: 0.9689; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 15418.4348; train_edge_recon_loss: 25914811.0559; train_gene_expr_recon_loss: 666167.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26596397.0471; train_optim_loss: 26596397.0471; val_kl_reg_loss: 15382.5180; val_edge_recon_loss: 26389801.8421; val_gene_expr_recon_loss: 663582.5428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27068766.9211; val_optim_loss: 27068766.9211
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9768; val_auprc_score: 0.9701; val_best_acc_score: 0.9322; val_best_f1_score: 0.9342; train_kl_reg_loss: 15583.8075; train_edge_recon_loss: 25913911.6735; train_gene_expr_recon_loss: 663842.2632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26593337.8118; train_optim_loss: 26593337.8118; val_kl_reg_loss: 15456.7673; val_edge_recon_loss: 26393242.3684; val_gene_expr_recon_loss: 658900.2697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27067599.3158; val_optim_loss: 27067599.3158
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9766; val_auprc_score: 0.9695; val_best_acc_score: 0.9323; val_best_f1_score: 0.9343; train_kl_reg_loss: 15830.9639; train_edge_recon_loss: 25898410.0706; train_gene_expr_recon_loss: 661059.5159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26575300.5647; train_optim_loss: 26575300.5647; val_kl_reg_loss: 15760.1324; val_edge_recon_loss: 26455807.5263; val_gene_expr_recon_loss: 660084.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27131652.2632; val_optim_loss: 27131652.2632
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9769; val_auprc_score: 0.9696; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 15953.5481; train_edge_recon_loss: 25893316.2765; train_gene_expr_recon_loss: 658936.5016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26568206.3618; train_optim_loss: 26568206.3618; val_kl_reg_loss: 15720.9937; val_edge_recon_loss: 26426536.2105; val_gene_expr_recon_loss: 655721.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27097978.3947; val_optim_loss: 27097978.3947
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9770; val_auprc_score: 0.9697; val_best_acc_score: 0.9334; val_best_f1_score: 0.9354; train_kl_reg_loss: 16196.5906; train_edge_recon_loss: 25887668.7059; train_gene_expr_recon_loss: 657377.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26561243.1353; train_optim_loss: 26561243.1353; val_kl_reg_loss: 15561.2943; val_edge_recon_loss: 26389412.9737; val_gene_expr_recon_loss: 655922.1941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27060896.6316; val_optim_loss: 27060896.6316
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9760; val_auprc_score: 0.9683; val_best_acc_score: 0.9327; val_best_f1_score: 0.9346; train_kl_reg_loss: 16095.4781; train_edge_recon_loss: 25888454.5118; train_gene_expr_recon_loss: 655411.4880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26559961.4324; train_optim_loss: 26559961.4324; val_kl_reg_loss: 16203.1142; val_edge_recon_loss: 26378029.7895; val_gene_expr_recon_loss: 652310.5222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27046543.4474; val_optim_loss: 27046543.4474
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9772; val_auprc_score: 0.9699; val_best_acc_score: 0.9340; val_best_f1_score: 0.9356; train_kl_reg_loss: 16335.3170; train_edge_recon_loss: 25876512.5676; train_gene_expr_recon_loss: 653967.6912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26546815.5500; train_optim_loss: 26546815.5500; val_kl_reg_loss: 15813.5744; val_edge_recon_loss: 26416168.2632; val_gene_expr_recon_loss: 650403.3248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27082385.2368; val_optim_loss: 27082385.2368
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9783; val_auprc_score: 0.9710; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 16249.8181; train_edge_recon_loss: 25879020.7118; train_gene_expr_recon_loss: 652659.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26547930.0529; train_optim_loss: 26547930.0529; val_kl_reg_loss: 16169.5475; val_edge_recon_loss: 26356720.1316; val_gene_expr_recon_loss: 650155.2007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27023044.8421; val_optim_loss: 27023044.8421
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9786; val_auprc_score: 0.9719; val_best_acc_score: 0.9366; val_best_f1_score: 0.9380; train_kl_reg_loss: 16498.5047; train_edge_recon_loss: 25880913.2353; train_gene_expr_recon_loss: 651245.9119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26548657.6853; train_optim_loss: 26548657.6853; val_kl_reg_loss: 16266.3969; val_edge_recon_loss: 26341548.9211; val_gene_expr_recon_loss: 648968.7903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27006784.1579; val_optim_loss: 27006784.1579
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9783; val_auprc_score: 0.9718; val_best_acc_score: 0.9361; val_best_f1_score: 0.9377; train_kl_reg_loss: 16701.8211; train_edge_recon_loss: 25857294.3618; train_gene_expr_recon_loss: 649989.8994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26523986.0824; train_optim_loss: 26523986.0824; val_kl_reg_loss: 16211.8416; val_edge_recon_loss: 26350205.1316; val_gene_expr_recon_loss: 649756.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27016173.5789; val_optim_loss: 27016173.5789
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9784; val_auprc_score: 0.9718; val_best_acc_score: 0.9374; val_best_f1_score: 0.9390; train_kl_reg_loss: 16657.9782; train_edge_recon_loss: 25859010.1029; train_gene_expr_recon_loss: 648917.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26524585.1235; train_optim_loss: 26524585.1235; val_kl_reg_loss: 16272.2902; val_edge_recon_loss: 26350889.0000; val_gene_expr_recon_loss: 648147.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27015308.6579; val_optim_loss: 27015308.6579
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9802; val_auprc_score: 0.9743; val_best_acc_score: 0.9400; val_best_f1_score: 0.9417; train_kl_reg_loss: 16805.0017; train_edge_recon_loss: 25853803.2618; train_gene_expr_recon_loss: 648382.1496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26518990.3941; train_optim_loss: 26518990.3941; val_kl_reg_loss: 16337.2166; val_edge_recon_loss: 26354906.7895; val_gene_expr_recon_loss: 646101.4613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27017345.4737; val_optim_loss: 27017345.4737
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9792; val_auprc_score: 0.9729; val_best_acc_score: 0.9385; val_best_f1_score: 0.9401; train_kl_reg_loss: 16567.0423; train_edge_recon_loss: 25859860.8824; train_gene_expr_recon_loss: 647701.9342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26524129.8618; train_optim_loss: 26524129.8618; val_kl_reg_loss: 15926.9891; val_edge_recon_loss: 26327943.0789; val_gene_expr_recon_loss: 646121.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26989991.3421; val_optim_loss: 26989991.3421
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9794; val_auprc_score: 0.9730; val_best_acc_score: 0.9389; val_best_f1_score: 0.9406; train_kl_reg_loss: 16750.5765; train_edge_recon_loss: 25849707.9529; train_gene_expr_recon_loss: 647280.3905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26513738.9265; train_optim_loss: 26513738.9265; val_kl_reg_loss: 16087.4483; val_edge_recon_loss: 26329241.3158; val_gene_expr_recon_loss: 645201.6077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26990530.3158; val_optim_loss: 26990530.3158
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9780; val_auprc_score: 0.9708; val_best_acc_score: 0.9371; val_best_f1_score: 0.9389; train_kl_reg_loss: 16823.9757; train_edge_recon_loss: 25854931.3676; train_gene_expr_recon_loss: 646668.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26518423.7147; train_optim_loss: 26518423.7147; val_kl_reg_loss: 16648.0811; val_edge_recon_loss: 26342078.5526; val_gene_expr_recon_loss: 644589.2303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27003315.8158; val_optim_loss: 27003315.8158
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9789; val_auprc_score: 0.9719; val_best_acc_score: 0.9397; val_best_f1_score: 0.9411; train_kl_reg_loss: 16838.3128; train_edge_recon_loss: 25852774.0735; train_gene_expr_recon_loss: 645926.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26515539.2471; train_optim_loss: 26515539.2471; val_kl_reg_loss: 16324.5053; val_edge_recon_loss: 26341934.2105; val_gene_expr_recon_loss: 644585.9737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27002844.5263; val_optim_loss: 27002844.5263
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9802; val_auprc_score: 0.9742; val_best_acc_score: 0.9394; val_best_f1_score: 0.9411; train_kl_reg_loss: 17072.0415; train_edge_recon_loss: 25842444.8882; train_gene_expr_recon_loss: 644892.8055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26504409.7529; train_optim_loss: 26504409.7529; val_kl_reg_loss: 16710.5890; val_edge_recon_loss: 26324373.2895; val_gene_expr_recon_loss: 643192.5238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26984276.5263; val_optim_loss: 26984276.5263
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9796; val_auprc_score: 0.9727; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 16968.7936; train_edge_recon_loss: 25832929.6088; train_gene_expr_recon_loss: 644373.4488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26494271.8471; train_optim_loss: 26494271.8471; val_kl_reg_loss: 16860.2589; val_edge_recon_loss: 26294877.0263; val_gene_expr_recon_loss: 642653.7294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26954391.0000; val_optim_loss: 26954391.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9805; val_auprc_score: 0.9740; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 17156.3316; train_edge_recon_loss: 25828784.8588; train_gene_expr_recon_loss: 643574.5813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26489515.8000; train_optim_loss: 26489515.8000; val_kl_reg_loss: 17165.9606; val_edge_recon_loss: 26288118.6316; val_gene_expr_recon_loss: 641690.3783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26946975.1316; val_optim_loss: 26946975.1316
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9809; val_auprc_score: 0.9748; val_best_acc_score: 0.9420; val_best_f1_score: 0.9433; train_kl_reg_loss: 17254.7147; train_edge_recon_loss: 25831004.4676; train_gene_expr_recon_loss: 643228.5478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26491487.7324; train_optim_loss: 26491487.7324; val_kl_reg_loss: 16553.5300; val_edge_recon_loss: 26322891.2632; val_gene_expr_recon_loss: 642582.8849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26982027.6842; val_optim_loss: 26982027.6842
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9801; val_auprc_score: 0.9736; val_best_acc_score: 0.9418; val_best_f1_score: 0.9433; train_kl_reg_loss: 17108.9659; train_edge_recon_loss: 25839921.7059; train_gene_expr_recon_loss: 642506.6843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26499537.3882; train_optim_loss: 26499537.3882; val_kl_reg_loss: 16659.4067; val_edge_recon_loss: 26345772.8421; val_gene_expr_recon_loss: 640072.8512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27002505.0000; val_optim_loss: 27002505.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9803; val_auprc_score: 0.9741; val_best_acc_score: 0.9420; val_best_f1_score: 0.9432; train_kl_reg_loss: 17143.0300; train_edge_recon_loss: 25833724.5206; train_gene_expr_recon_loss: 642676.9105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26493544.4618; train_optim_loss: 26493544.4618; val_kl_reg_loss: 16738.5628; val_edge_recon_loss: 26315126.1053; val_gene_expr_recon_loss: 642555.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26974420.2895; val_optim_loss: 26974420.2895
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9805; val_auprc_score: 0.9740; val_best_acc_score: 0.9414; val_best_f1_score: 0.9425; train_kl_reg_loss: 17272.4459; train_edge_recon_loss: 25828422.5500; train_gene_expr_recon_loss: 641609.2629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26487304.2147; train_optim_loss: 26487304.2147; val_kl_reg_loss: 17478.8084; val_edge_recon_loss: 26315952.2895; val_gene_expr_recon_loss: 639967.3676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26973398.5000; val_optim_loss: 26973398.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9812; val_auprc_score: 0.9745; val_best_acc_score: 0.9440; val_best_f1_score: 0.9450; train_kl_reg_loss: 17496.6282; train_edge_recon_loss: 25818897.5765; train_gene_expr_recon_loss: 638271.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26474665.3529; train_optim_loss: 26474665.3529; val_kl_reg_loss: 16996.0574; val_edge_recon_loss: 26243088.8421; val_gene_expr_recon_loss: 637882.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26897967.0263; val_optim_loss: 26897967.0263
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9812; val_auprc_score: 0.9754; val_best_acc_score: 0.9433; val_best_f1_score: 0.9446; train_kl_reg_loss: 17230.5188; train_edge_recon_loss: 25821611.1912; train_gene_expr_recon_loss: 637179.1089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26476020.8853; train_optim_loss: 26476020.8853; val_kl_reg_loss: 16530.8788; val_edge_recon_loss: 26291650.0526; val_gene_expr_recon_loss: 636841.4120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26945022.2895; val_optim_loss: 26945022.2895
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9820; val_auprc_score: 0.9766; val_best_acc_score: 0.9438; val_best_f1_score: 0.9452; train_kl_reg_loss: 17056.8202; train_edge_recon_loss: 25816394.3882; train_gene_expr_recon_loss: 637455.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26470906.7794; train_optim_loss: 26470906.7794; val_kl_reg_loss: 16555.2177; val_edge_recon_loss: 26269470.7895; val_gene_expr_recon_loss: 636215.6357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26922241.6842; val_optim_loss: 26922241.6842
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9816; val_auprc_score: 0.9759; val_best_acc_score: 0.9431; val_best_f1_score: 0.9446; train_kl_reg_loss: 17035.3606; train_edge_recon_loss: 25800018.4971; train_gene_expr_recon_loss: 636992.3310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26454046.1912; train_optim_loss: 26454046.1912; val_kl_reg_loss: 16660.1497; val_edge_recon_loss: 26271613.1053; val_gene_expr_recon_loss: 636990.8224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26925263.8421; val_optim_loss: 26925263.8421
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9819; val_auprc_score: 0.9759; val_best_acc_score: 0.9439; val_best_f1_score: 0.9452; train_kl_reg_loss: 17002.1205; train_edge_recon_loss: 25805440.0265; train_gene_expr_recon_loss: 636997.8425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26459440.0029; train_optim_loss: 26459440.0029; val_kl_reg_loss: 16392.3814; val_edge_recon_loss: 26276863.8421; val_gene_expr_recon_loss: 635347.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26928603.7368; val_optim_loss: 26928603.7368

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9826; val_auprc_score: 0.9772; val_best_acc_score: 0.9457; val_best_f1_score: 0.9469; train_kl_reg_loss: 16811.3253; train_edge_recon_loss: 25806656.3588; train_gene_expr_recon_loss: 636546.1044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26460013.7618; train_optim_loss: 26460013.7618; val_kl_reg_loss: 16437.1450; val_edge_recon_loss: 26226325.1579; val_gene_expr_recon_loss: 635808.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26878570.3684; val_optim_loss: 26878570.3684
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9814; val_auprc_score: 0.9752; val_best_acc_score: 0.9431; val_best_f1_score: 0.9443; train_kl_reg_loss: 16887.5058; train_edge_recon_loss: 25796181.8382; train_gene_expr_recon_loss: 636882.6480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26449952.0088; train_optim_loss: 26449952.0088; val_kl_reg_loss: 16466.0372; val_edge_recon_loss: 26320594.4737; val_gene_expr_recon_loss: 636172.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26973232.6316; val_optim_loss: 26973232.6316
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9824; val_auprc_score: 0.9768; val_best_acc_score: 0.9452; val_best_f1_score: 0.9465; train_kl_reg_loss: 16868.5068; train_edge_recon_loss: 25794096.2235; train_gene_expr_recon_loss: 636386.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26447351.4353; train_optim_loss: 26447351.4353; val_kl_reg_loss: 16453.2031; val_edge_recon_loss: 26270604.0789; val_gene_expr_recon_loss: 636177.8544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26923234.9737; val_optim_loss: 26923234.9737
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9820; val_auprc_score: 0.9758; val_best_acc_score: 0.9445; val_best_f1_score: 0.9455; train_kl_reg_loss: 16837.1494; train_edge_recon_loss: 25816129.3235; train_gene_expr_recon_loss: 636855.5639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26469822.0029; train_optim_loss: 26469822.0029; val_kl_reg_loss: 16421.8418; val_edge_recon_loss: 26261138.0263; val_gene_expr_recon_loss: 635575.5748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26913135.3684; val_optim_loss: 26913135.3684
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9816; val_auprc_score: 0.9757; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 16844.9719; train_edge_recon_loss: 25813155.7706; train_gene_expr_recon_loss: 636446.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26466447.7088; train_optim_loss: 26466447.7088; val_kl_reg_loss: 16436.2007; val_edge_recon_loss: 26270938.3421; val_gene_expr_recon_loss: 635095.0419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26922469.5789; val_optim_loss: 26922469.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9819; val_auprc_score: 0.9755; val_best_acc_score: 0.9443; val_best_f1_score: 0.9457; train_kl_reg_loss: 16862.1028; train_edge_recon_loss: 25800384.7529; train_gene_expr_recon_loss: 636287.8847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26453534.7618; train_optim_loss: 26453534.7618; val_kl_reg_loss: 16434.0593; val_edge_recon_loss: 26266153.0526; val_gene_expr_recon_loss: 636979.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26919566.1053; val_optim_loss: 26919566.1053
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9809; val_auprc_score: 0.9748; val_best_acc_score: 0.9434; val_best_f1_score: 0.9445; train_kl_reg_loss: 16861.9380; train_edge_recon_loss: 25797447.3529; train_gene_expr_recon_loss: 636099.0163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26450408.2765; train_optim_loss: 26450408.2765; val_kl_reg_loss: 16454.3200; val_edge_recon_loss: 26293758.4211; val_gene_expr_recon_loss: 636184.9301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26946397.6842; val_optim_loss: 26946397.6842
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9813; val_auprc_score: 0.9750; val_best_acc_score: 0.9435; val_best_f1_score: 0.9449; train_kl_reg_loss: 16872.4086; train_edge_recon_loss: 25797842.1676; train_gene_expr_recon_loss: 636040.9513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26450755.5059; train_optim_loss: 26450755.5059; val_kl_reg_loss: 16461.3555; val_edge_recon_loss: 26299567.7368; val_gene_expr_recon_loss: 636413.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26952442.8684; val_optim_loss: 26952442.8684
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9820; val_auprc_score: 0.9759; val_best_acc_score: 0.9450; val_best_f1_score: 0.9465; train_kl_reg_loss: 16869.1582; train_edge_recon_loss: 25808841.4559; train_gene_expr_recon_loss: 636410.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26462121.4529; train_optim_loss: 26462121.4529; val_kl_reg_loss: 16469.0578; val_edge_recon_loss: 26237885.6316; val_gene_expr_recon_loss: 636592.4326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26890947.1053; val_optim_loss: 26890947.1053

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 83 min 33 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9820
Val AUPRC score: 0.9764
Val best accuracy score: 0.9447
Val best F1 score: 0.9460
Val gene expr MSE score: 1.5562

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
