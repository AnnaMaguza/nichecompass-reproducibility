None
Run timestamp: 30062023_142713_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9234; val_auprc_score: 0.9158; val_best_acc_score: 0.8436; val_best_f1_score: 0.8477; train_kl_reg_loss: 2966.1649; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 74519.5024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 77485.6673; train_optim_loss: 77485.6673; val_kl_reg_loss: 2239.4840; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 68002.6676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 70242.1510; val_optim_loss: 70242.1510
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9344; val_auprc_score: 0.9300; val_best_acc_score: 0.8562; val_best_f1_score: 0.8596; train_kl_reg_loss: 2074.7722; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 66585.6156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 68660.3878; train_optim_loss: 68660.3878; val_kl_reg_loss: 1847.3816; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 64750.1187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 66597.5001; val_optim_loss: 66597.5001
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9364; val_auprc_score: 0.9328; val_best_acc_score: 0.8594; val_best_f1_score: 0.8622; train_kl_reg_loss: 1847.7709; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 64135.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 65983.1175; train_optim_loss: 65983.1175; val_kl_reg_loss: 1744.7293; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62981.9552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 64726.6844; val_optim_loss: 64726.6844
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9381; val_auprc_score: 0.9354; val_best_acc_score: 0.8613; val_best_f1_score: 0.8635; train_kl_reg_loss: 1757.6978; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 62793.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64551.0703; train_optim_loss: 64551.0703; val_kl_reg_loss: 1669.6823; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 62053.9654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 63723.6477; val_optim_loss: 63723.6477
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9391; val_auprc_score: 0.9370; val_best_acc_score: 0.8621; val_best_f1_score: 0.8642; train_kl_reg_loss: 1709.8622; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61957.7140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63667.5762; train_optim_loss: 63667.5762; val_kl_reg_loss: 1649.9600; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61340.6336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62990.5938; val_optim_loss: 62990.5938
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9408; val_auprc_score: 0.9391; val_best_acc_score: 0.8628; val_best_f1_score: 0.8656; train_kl_reg_loss: 1683.8879; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 61340.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 63024.5955; train_optim_loss: 63024.5955; val_kl_reg_loss: 1622.2817; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 61032.5109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62654.7925; val_optim_loss: 62654.7925
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9384; val_auprc_score: 0.9361; val_best_acc_score: 0.8599; val_best_f1_score: 0.8633; train_kl_reg_loss: 1666.4272; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60970.2759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62636.7031; train_optim_loss: 62636.7031; val_kl_reg_loss: 1604.6965; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60775.3314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62380.0280; val_optim_loss: 62380.0280
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9412; val_auprc_score: 0.9394; val_best_acc_score: 0.8631; val_best_f1_score: 0.8665; train_kl_reg_loss: 1651.0844; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60700.4093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62351.4937; train_optim_loss: 62351.4937; val_kl_reg_loss: 1591.6629; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60674.0944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 62265.7572; val_optim_loss: 62265.7572
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9398; val_auprc_score: 0.9385; val_best_acc_score: 0.8610; val_best_f1_score: 0.8640; train_kl_reg_loss: 1639.0855; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60499.0899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62138.1754; train_optim_loss: 62138.1754; val_kl_reg_loss: 1593.7770; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60322.1366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61915.9135; val_optim_loss: 61915.9135
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9416; val_auprc_score: 0.9406; val_best_acc_score: 0.8644; val_best_f1_score: 0.8656; train_kl_reg_loss: 1627.1619; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60314.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61941.5326; train_optim_loss: 61941.5326; val_kl_reg_loss: 1568.2013; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60103.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61671.2144; val_optim_loss: 61671.2144
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9413; val_best_acc_score: 0.8641; val_best_f1_score: 0.8666; train_kl_reg_loss: 1617.1083; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60241.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61858.4250; train_optim_loss: 61858.4250; val_kl_reg_loss: 1575.7867; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60285.5930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61861.3798; val_optim_loss: 61861.3798
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9383; val_auprc_score: 0.9373; val_best_acc_score: 0.8592; val_best_f1_score: 0.8625; train_kl_reg_loss: 1606.5132; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60081.7753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61688.2885; train_optim_loss: 61688.2885; val_kl_reg_loss: 1556.0280; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59948.9046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61504.9326; val_optim_loss: 61504.9326
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9416; val_auprc_score: 0.9410; val_best_acc_score: 0.8630; val_best_f1_score: 0.8657; train_kl_reg_loss: 1597.3147; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 60045.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61643.2139; train_optim_loss: 61643.2139; val_kl_reg_loss: 1556.3589; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 60008.4613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61564.8204; val_optim_loss: 61564.8204
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9416; val_auprc_score: 0.9412; val_best_acc_score: 0.8620; val_best_f1_score: 0.8650; train_kl_reg_loss: 1586.5678; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59944.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61531.3463; train_optim_loss: 61531.3463; val_kl_reg_loss: 1565.8043; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59920.3049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61486.1091; val_optim_loss: 61486.1091
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9397; val_auprc_score: 0.9395; val_best_acc_score: 0.8597; val_best_f1_score: 0.8621; train_kl_reg_loss: 1579.8074; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59872.0350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61451.8424; train_optim_loss: 61451.8424; val_kl_reg_loss: 1530.2014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59919.6246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61449.8261; val_optim_loss: 61449.8261
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9402; val_auprc_score: 0.9388; val_best_acc_score: 0.8613; val_best_f1_score: 0.8647; train_kl_reg_loss: 1572.0228; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59807.2476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61379.2705; train_optim_loss: 61379.2705; val_kl_reg_loss: 1537.9250; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59885.0937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61423.0187; val_optim_loss: 61423.0187
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9414; val_auprc_score: 0.9414; val_best_acc_score: 0.8622; val_best_f1_score: 0.8651; train_kl_reg_loss: 1565.0890; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59763.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61328.1984; train_optim_loss: 61328.1984; val_kl_reg_loss: 1523.1506; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59767.7678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61290.9185; val_optim_loss: 61290.9185
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9398; val_auprc_score: 0.9389; val_best_acc_score: 0.8622; val_best_f1_score: 0.8640; train_kl_reg_loss: 1558.0111; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59721.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61279.3340; train_optim_loss: 61279.3340; val_kl_reg_loss: 1529.0618; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59809.0762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61338.1379; val_optim_loss: 61338.1379
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9419; val_auprc_score: 0.9416; val_best_acc_score: 0.8645; val_best_f1_score: 0.8663; train_kl_reg_loss: 1551.6193; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59702.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61253.8529; train_optim_loss: 61253.8529; val_kl_reg_loss: 1526.4940; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59695.7153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61222.2092; val_optim_loss: 61222.2092
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9411; val_auprc_score: 0.9412; val_best_acc_score: 0.8623; val_best_f1_score: 0.8644; train_kl_reg_loss: 1546.4918; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59694.8450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61241.3368; train_optim_loss: 61241.3368; val_kl_reg_loss: 1514.9693; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59794.4848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61309.4543; val_optim_loss: 61309.4543
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9408; val_auprc_score: 0.9407; val_best_acc_score: 0.8616; val_best_f1_score: 0.8639; train_kl_reg_loss: 1541.2914; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59657.1457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61198.4370; train_optim_loss: 61198.4370; val_kl_reg_loss: 1528.8936; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59691.8318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61220.7254; val_optim_loss: 61220.7254
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9407; val_auprc_score: 0.9401; val_best_acc_score: 0.8616; val_best_f1_score: 0.8641; train_kl_reg_loss: 1535.4278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59611.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61146.7438; train_optim_loss: 61146.7438; val_kl_reg_loss: 1491.5458; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59747.8772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61239.4229; val_optim_loss: 61239.4229
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9398; val_auprc_score: 0.9398; val_best_acc_score: 0.8595; val_best_f1_score: 0.8632; train_kl_reg_loss: 1530.5355; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59591.5935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61122.1290; train_optim_loss: 61122.1290; val_kl_reg_loss: 1519.9433; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59678.7808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61198.7241; val_optim_loss: 61198.7241
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9411; val_auprc_score: 0.9410; val_best_acc_score: 0.8615; val_best_f1_score: 0.8636; train_kl_reg_loss: 1527.7222; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59590.8006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61118.5228; train_optim_loss: 61118.5228; val_kl_reg_loss: 1470.6464; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59717.9033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61188.5498; val_optim_loss: 61188.5498
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9415; val_auprc_score: 0.9416; val_best_acc_score: 0.8622; val_best_f1_score: 0.8645; train_kl_reg_loss: 1521.0700; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59549.9990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61071.0690; train_optim_loss: 61071.0690; val_kl_reg_loss: 1488.2669; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59700.6730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61188.9397; val_optim_loss: 61188.9397
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9411; val_auprc_score: 0.9406; val_best_acc_score: 0.8631; val_best_f1_score: 0.8641; train_kl_reg_loss: 1518.0220; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59524.0406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 61042.0626; train_optim_loss: 61042.0626; val_kl_reg_loss: 1480.5887; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59677.1807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61157.7695; val_optim_loss: 61157.7695
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9423; val_auprc_score: 0.9422; val_best_acc_score: 0.8643; val_best_f1_score: 0.8653; train_kl_reg_loss: 1512.4149; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59485.0685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60997.4834; train_optim_loss: 60997.4834; val_kl_reg_loss: 1485.9152; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59459.9498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60945.8649; val_optim_loss: 60945.8649
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9408; val_auprc_score: 0.9405; val_best_acc_score: 0.8624; val_best_f1_score: 0.8645; train_kl_reg_loss: 1509.1286; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59480.4161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60989.5447; train_optim_loss: 60989.5447; val_kl_reg_loss: 1465.7144; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59558.7419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61024.4564; val_optim_loss: 61024.4564
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9416; val_auprc_score: 0.9419; val_best_acc_score: 0.8636; val_best_f1_score: 0.8644; train_kl_reg_loss: 1505.9839; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59456.4216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60962.4056; train_optim_loss: 60962.4056; val_kl_reg_loss: 1471.9167; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59658.1358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61130.0523; val_optim_loss: 61130.0523
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9413; val_auprc_score: 0.9414; val_best_acc_score: 0.8625; val_best_f1_score: 0.8654; train_kl_reg_loss: 1501.5173; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59458.2590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60959.7764; train_optim_loss: 60959.7764; val_kl_reg_loss: 1468.4427; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59730.8466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61199.2891; val_optim_loss: 61199.2891
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9409; val_auprc_score: 0.9410; val_best_acc_score: 0.8618; val_best_f1_score: 0.8646; train_kl_reg_loss: 1496.7944; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59421.7254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60918.5199; train_optim_loss: 60918.5199; val_kl_reg_loss: 1470.6691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59634.2520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 61104.9211; val_optim_loss: 61104.9211

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9423; val_auprc_score: 0.9428; val_best_acc_score: 0.8635; val_best_f1_score: 0.8662; train_kl_reg_loss: 1469.5318; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59109.2626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60578.7945; train_optim_loss: 60578.7945; val_kl_reg_loss: 1438.8418; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59334.2985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60773.1403; val_optim_loss: 60773.1403
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9431; val_auprc_score: 0.9435; val_best_acc_score: 0.8639; val_best_f1_score: 0.8668; train_kl_reg_loss: 1465.7936; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59031.7835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60497.5771; train_optim_loss: 60497.5771; val_kl_reg_loss: 1434.8863; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59380.2201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60815.1061; val_optim_loss: 60815.1061
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9421; val_auprc_score: 0.9424; val_best_acc_score: 0.8627; val_best_f1_score: 0.8656; train_kl_reg_loss: 1463.3748; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59023.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60487.0206; train_optim_loss: 60487.0206; val_kl_reg_loss: 1440.0892; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59377.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60817.8430; val_optim_loss: 60817.8430
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9430; val_auprc_score: 0.9434; val_best_acc_score: 0.8632; val_best_f1_score: 0.8657; train_kl_reg_loss: 1461.7999; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58995.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60457.7377; train_optim_loss: 60457.7377; val_kl_reg_loss: 1433.1699; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59138.3350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60571.5052; val_optim_loss: 60571.5052
heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9422; val_auprc_score: 0.9427; val_best_acc_score: 0.8626; val_best_f1_score: 0.8650; train_kl_reg_loss: 1460.4214; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59002.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60463.4088; train_optim_loss: 60463.4088; val_kl_reg_loss: 1433.4991; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59297.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60730.6453; val_optim_loss: 60730.6453
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9422; val_auprc_score: 0.9425; val_best_acc_score: 0.8631; val_best_f1_score: 0.8655; train_kl_reg_loss: 1459.7903; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59007.6917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60467.4821; train_optim_loss: 60467.4821; val_kl_reg_loss: 1433.9451; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59187.9442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60621.8895; val_optim_loss: 60621.8895
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9422; val_auprc_score: 0.9427; val_best_acc_score: 0.8637; val_best_f1_score: 0.8656; train_kl_reg_loss: 1458.9670; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58995.3624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60454.3294; train_optim_loss: 60454.3294; val_kl_reg_loss: 1430.8649; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59207.9786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60638.8434; val_optim_loss: 60638.8434
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9431; val_auprc_score: 0.9438; val_best_acc_score: 0.8644; val_best_f1_score: 0.8662; train_kl_reg_loss: 1459.4625; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 59007.8101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60467.2726; train_optim_loss: 60467.2726; val_kl_reg_loss: 1429.1040; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59303.4676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60732.5716; val_optim_loss: 60732.5716

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9432; val_auprc_score: 0.9432; val_best_acc_score: 0.8645; val_best_f1_score: 0.8665; train_kl_reg_loss: 1456.9751; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58927.3580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60384.3331; train_optim_loss: 60384.3331; val_kl_reg_loss: 1430.3571; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59273.6892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60704.0464; val_optim_loss: 60704.0464
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9418; val_auprc_score: 0.9424; val_best_acc_score: 0.8633; val_best_f1_score: 0.8654; train_kl_reg_loss: 1456.2771; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58922.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60378.8377; train_optim_loss: 60378.8377; val_kl_reg_loss: 1427.2681; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59331.7252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60758.9934; val_optim_loss: 60758.9934
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9425; val_auprc_score: 0.9430; val_best_acc_score: 0.8645; val_best_f1_score: 0.8664; train_kl_reg_loss: 1456.0464; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58941.9360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60397.9824; train_optim_loss: 60397.9824; val_kl_reg_loss: 1428.9841; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59143.1888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60572.1725; val_optim_loss: 60572.1725
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9421; val_auprc_score: 0.9426; val_best_acc_score: 0.8643; val_best_f1_score: 0.8662; train_kl_reg_loss: 1456.2314; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 58930.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 60386.6748; train_optim_loss: 60386.6748; val_kl_reg_loss: 1426.6913; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 59381.9631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 60808.6545; val_optim_loss: 60808.6545

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 77 min 40 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9420
Val AUPRC score: 0.9423
Val best accuracy score: 0.8626
Val best F1 score: 0.8652
Val gene expr MSE score: 1.3823

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
