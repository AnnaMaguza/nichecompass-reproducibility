None
Run timestamp: 29062023_211035_39.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_39']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9876; val_auprc_score: 0.9818; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 6725.9688; train_edge_recon_loss: 263814.1467; train_gene_expr_recon_loss: 21324.8329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 291864.9481; train_optim_loss: 291864.9481; val_kl_reg_loss: 6633.0314; val_edge_recon_loss: 257134.6070; val_gene_expr_recon_loss: 20380.6464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284148.2832; val_optim_loss: 284148.2832
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9904; val_auprc_score: 0.9861; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 6791.4990; train_edge_recon_loss: 258091.6340; train_gene_expr_recon_loss: 20100.2615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 284983.3934; train_optim_loss: 284983.3934; val_kl_reg_loss: 6735.5394; val_edge_recon_loss: 256502.7211; val_gene_expr_recon_loss: 19686.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282924.2906; val_optim_loss: 282924.2906
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9928; val_auprc_score: 0.9898; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 6814.6401; train_edge_recon_loss: 257505.8024; train_gene_expr_recon_loss: 19590.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283911.1822; train_optim_loss: 283911.1822; val_kl_reg_loss: 6561.1169; val_edge_recon_loss: 255467.7926; val_gene_expr_recon_loss: 19335.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281364.2789; val_optim_loss: 281364.2789
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9902; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 6814.8412; train_edge_recon_loss: 257158.1768; train_gene_expr_recon_loss: 19293.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283266.0494; train_optim_loss: 283266.0494; val_kl_reg_loss: 6836.1281; val_edge_recon_loss: 255490.3598; val_gene_expr_recon_loss: 19050.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281376.6367; val_optim_loss: 281376.6367
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9947; val_auprc_score: 0.9926; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 6812.1531; train_edge_recon_loss: 256915.6503; train_gene_expr_recon_loss: 19106.9849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282834.7886; train_optim_loss: 282834.7886; val_kl_reg_loss: 6801.0133; val_edge_recon_loss: 255284.7236; val_gene_expr_recon_loss: 18866.2220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280951.9602; val_optim_loss: 280951.9602
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9953; val_auprc_score: 0.9932; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 6810.2055; train_edge_recon_loss: 256707.8450; train_gene_expr_recon_loss: 18963.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282481.8265; train_optim_loss: 282481.8265; val_kl_reg_loss: 6787.8969; val_edge_recon_loss: 255172.8252; val_gene_expr_recon_loss: 18836.0428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280796.7641; val_optim_loss: 280796.7641
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9957; val_auprc_score: 0.9939; val_best_acc_score: 0.9813; val_best_f1_score: 0.9816; train_kl_reg_loss: 6813.1235; train_edge_recon_loss: 256501.8401; train_gene_expr_recon_loss: 18859.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282174.2377; train_optim_loss: 282174.2377; val_kl_reg_loss: 6783.7151; val_edge_recon_loss: 255009.3619; val_gene_expr_recon_loss: 18729.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280522.3367; val_optim_loss: 280522.3367
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9959; val_auprc_score: 0.9939; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 6805.4531; train_edge_recon_loss: 256381.9875; train_gene_expr_recon_loss: 18799.3007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281986.7418; train_optim_loss: 281986.7418; val_kl_reg_loss: 6774.4592; val_edge_recon_loss: 254919.2621; val_gene_expr_recon_loss: 18671.2181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280364.9375; val_optim_loss: 280364.9375
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9963; val_auprc_score: 0.9946; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 6806.4062; train_edge_recon_loss: 256192.6373; train_gene_expr_recon_loss: 18745.4239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281744.4686; train_optim_loss: 281744.4686; val_kl_reg_loss: 6739.6109; val_edge_recon_loss: 254730.5227; val_gene_expr_recon_loss: 18641.0184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280111.1523; val_optim_loss: 280111.1523
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 6798.1152; train_edge_recon_loss: 256136.3156; train_gene_expr_recon_loss: 18701.2745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281635.7052; train_optim_loss: 281635.7052; val_kl_reg_loss: 6592.3866; val_edge_recon_loss: 254665.7732; val_gene_expr_recon_loss: 18651.3294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279909.4887; val_optim_loss: 279909.4887
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9967; val_auprc_score: 0.9951; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 6793.4531; train_edge_recon_loss: 256070.4451; train_gene_expr_recon_loss: 18677.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281541.8928; train_optim_loss: 281541.8928; val_kl_reg_loss: 6779.7882; val_edge_recon_loss: 254362.3426; val_gene_expr_recon_loss: 18598.1940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279740.3262; val_optim_loss: 279740.3262
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9967; val_auprc_score: 0.9952; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 6789.8705; train_edge_recon_loss: 255907.5764; train_gene_expr_recon_loss: 18654.3781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281351.8246; train_optim_loss: 281351.8246; val_kl_reg_loss: 6578.1585; val_edge_recon_loss: 254357.7666; val_gene_expr_recon_loss: 18553.0283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279488.9535; val_optim_loss: 279488.9535
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9971; val_auprc_score: 0.9959; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 6785.4450; train_edge_recon_loss: 255849.6152; train_gene_expr_recon_loss: 18640.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281275.5941; train_optim_loss: 281275.5941; val_kl_reg_loss: 6774.4544; val_edge_recon_loss: 254421.0203; val_gene_expr_recon_loss: 18599.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279795.0590; val_optim_loss: 279795.0590
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9971; val_auprc_score: 0.9956; val_best_acc_score: 0.9870; val_best_f1_score: 0.9872; train_kl_reg_loss: 6786.0421; train_edge_recon_loss: 255732.0748; train_gene_expr_recon_loss: 18627.0086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281145.1260; train_optim_loss: 281145.1260; val_kl_reg_loss: 6725.5615; val_edge_recon_loss: 254204.9381; val_gene_expr_recon_loss: 18567.1472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279497.6484; val_optim_loss: 279497.6484
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 6780.8700; train_edge_recon_loss: 255733.1632; train_gene_expr_recon_loss: 18610.4239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281124.4573; train_optim_loss: 281124.4573; val_kl_reg_loss: 6734.9383; val_edge_recon_loss: 254160.5703; val_gene_expr_recon_loss: 18563.4195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279458.9289; val_optim_loss: 279458.9289
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9974; val_auprc_score: 0.9961; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 6780.1193; train_edge_recon_loss: 255613.4386; train_gene_expr_recon_loss: 18607.2647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281000.8232; train_optim_loss: 281000.8232; val_kl_reg_loss: 6744.3095; val_edge_recon_loss: 253993.9443; val_gene_expr_recon_loss: 18498.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279236.4477; val_optim_loss: 279236.4477
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9975; val_auprc_score: 0.9964; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 6776.6137; train_edge_recon_loss: 255595.8675; train_gene_expr_recon_loss: 18586.0866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280958.5682; train_optim_loss: 280958.5682; val_kl_reg_loss: 6862.6141; val_edge_recon_loss: 254090.2117; val_gene_expr_recon_loss: 18526.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279478.9340; val_optim_loss: 279478.9340
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6774.1551; train_edge_recon_loss: 255580.9305; train_gene_expr_recon_loss: 18571.2543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280926.3399; train_optim_loss: 280926.3399; val_kl_reg_loss: 6781.3718; val_edge_recon_loss: 254112.8982; val_gene_expr_recon_loss: 18505.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279399.6227; val_optim_loss: 279399.6227
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9977; val_auprc_score: 0.9963; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 6774.6312; train_edge_recon_loss: 255473.9750; train_gene_expr_recon_loss: 18566.0770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280814.6830; train_optim_loss: 280814.6830; val_kl_reg_loss: 6830.0245; val_edge_recon_loss: 254076.5334; val_gene_expr_recon_loss: 18518.8063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279425.3637; val_optim_loss: 279425.3637
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 6771.3388; train_edge_recon_loss: 255497.5954; train_gene_expr_recon_loss: 18560.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280829.7069; train_optim_loss: 280829.7069; val_kl_reg_loss: 6716.6559; val_edge_recon_loss: 254060.1123; val_gene_expr_recon_loss: 18509.3054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279286.0727; val_optim_loss: 279286.0727

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9979; val_auprc_score: 0.9969; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 6745.1935; train_edge_recon_loss: 255337.4807; train_gene_expr_recon_loss: 18300.9862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280383.6609; train_optim_loss: 280383.6609; val_kl_reg_loss: 6727.0162; val_edge_recon_loss: 253649.5410; val_gene_expr_recon_loss: 18210.0012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278586.5605; val_optim_loss: 278586.5605
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9980; val_auprc_score: 0.9969; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 6734.6452; train_edge_recon_loss: 255344.3335; train_gene_expr_recon_loss: 18265.3044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280344.2840; train_optim_loss: 280344.2840; val_kl_reg_loss: 6704.3237; val_edge_recon_loss: 253754.1346; val_gene_expr_recon_loss: 18229.1324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278687.5902; val_optim_loss: 278687.5902
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9980; val_auprc_score: 0.9970; val_best_acc_score: 0.9899; val_best_f1_score: 0.9900; train_kl_reg_loss: 6731.1715; train_edge_recon_loss: 255326.8337; train_gene_expr_recon_loss: 18258.5075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280316.5125; train_optim_loss: 280316.5125; val_kl_reg_loss: 6726.9469; val_edge_recon_loss: 253808.0668; val_gene_expr_recon_loss: 18215.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278750.8004; val_optim_loss: 278750.8004
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9979; val_auprc_score: 0.9968; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 6729.5243; train_edge_recon_loss: 255237.8950; train_gene_expr_recon_loss: 18263.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280231.0484; train_optim_loss: 280231.0484; val_kl_reg_loss: 6742.4988; val_edge_recon_loss: 253853.4643; val_gene_expr_recon_loss: 18233.1234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278829.0875; val_optim_loss: 278829.0875
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9979; val_auprc_score: 0.9969; val_best_acc_score: 0.9903; val_best_f1_score: 0.9903; train_kl_reg_loss: 6725.4249; train_edge_recon_loss: 255270.5093; train_gene_expr_recon_loss: 18256.6236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280252.5578; train_optim_loss: 280252.5578; val_kl_reg_loss: 6713.2449; val_edge_recon_loss: 253785.0920; val_gene_expr_recon_loss: 18191.5927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278689.9297; val_optim_loss: 278689.9297

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 6725.9175; train_edge_recon_loss: 255220.8540; train_gene_expr_recon_loss: 18217.5572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280164.3291; train_optim_loss: 280164.3291; val_kl_reg_loss: 6718.5290; val_edge_recon_loss: 253784.7947; val_gene_expr_recon_loss: 18207.1961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278710.5207; val_optim_loss: 278710.5207
heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9901; val_best_f1_score: 0.9902; train_kl_reg_loss: 6722.3818; train_edge_recon_loss: 255313.9614; train_gene_expr_recon_loss: 18218.2258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280254.5688; train_optim_loss: 280254.5688; val_kl_reg_loss: 6715.7123; val_edge_recon_loss: 253737.2684; val_gene_expr_recon_loss: 18193.7433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278646.7250; val_optim_loss: 278646.7250
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 6723.4774; train_edge_recon_loss: 255251.0444; train_gene_expr_recon_loss: 18216.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280190.6182; train_optim_loss: 280190.6182; val_kl_reg_loss: 6705.9777; val_edge_recon_loss: 253796.1068; val_gene_expr_recon_loss: 18154.5040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278656.5891; val_optim_loss: 278656.5891
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9904; val_best_f1_score: 0.9905; train_kl_reg_loss: 6722.6024; train_edge_recon_loss: 255232.8205; train_gene_expr_recon_loss: 18220.2749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280175.6985; train_optim_loss: 280175.6985; val_kl_reg_loss: 6715.6203; val_edge_recon_loss: 253634.3023; val_gene_expr_recon_loss: 18206.8454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278556.7668; val_optim_loss: 278556.7668
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9980; val_auprc_score: 0.9970; val_best_acc_score: 0.9903; val_best_f1_score: 0.9903; train_kl_reg_loss: 6721.3591; train_edge_recon_loss: 255258.7977; train_gene_expr_recon_loss: 18203.2772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280183.4342; train_optim_loss: 280183.4342; val_kl_reg_loss: 6717.6636; val_edge_recon_loss: 253697.8215; val_gene_expr_recon_loss: 18216.3843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278631.8691; val_optim_loss: 278631.8691
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9979; val_auprc_score: 0.9967; val_best_acc_score: 0.9904; val_best_f1_score: 0.9904; train_kl_reg_loss: 6721.8962; train_edge_recon_loss: 255263.9832; train_gene_expr_recon_loss: 18214.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280200.7511; train_optim_loss: 280200.7511; val_kl_reg_loss: 6710.7149; val_edge_recon_loss: 253625.3729; val_gene_expr_recon_loss: 18163.4815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278499.5711; val_optim_loss: 278499.5711
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9981; val_auprc_score: 0.9969; val_best_acc_score: 0.9903; val_best_f1_score: 0.9903; train_kl_reg_loss: 6721.5032; train_edge_recon_loss: 255247.5360; train_gene_expr_recon_loss: 18222.4015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280191.4406; train_optim_loss: 280191.4406; val_kl_reg_loss: 6705.8057; val_edge_recon_loss: 253693.5473; val_gene_expr_recon_loss: 18160.0251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278559.3773; val_optim_loss: 278559.3773
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9903; val_best_f1_score: 0.9904; train_kl_reg_loss: 6721.5765; train_edge_recon_loss: 255280.8888; train_gene_expr_recon_loss: 18223.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280226.3303; train_optim_loss: 280226.3303; val_kl_reg_loss: 6699.6436; val_edge_recon_loss: 253621.8412; val_gene_expr_recon_loss: 18189.2511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278510.7355; val_optim_loss: 278510.7355
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9981; val_auprc_score: 0.9972; val_best_acc_score: 0.9906; val_best_f1_score: 0.9907; train_kl_reg_loss: 6720.0219; train_edge_recon_loss: 255316.9051; train_gene_expr_recon_loss: 18217.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280254.2129; train_optim_loss: 280254.2129; val_kl_reg_loss: 6712.5762; val_edge_recon_loss: 253650.3105; val_gene_expr_recon_loss: 18195.4885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278558.3758; val_optim_loss: 278558.3758
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9967; val_best_acc_score: 0.9900; val_best_f1_score: 0.9901; train_kl_reg_loss: 6720.5910; train_edge_recon_loss: 255259.0488; train_gene_expr_recon_loss: 18227.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280206.6703; train_optim_loss: 280206.6703; val_kl_reg_loss: 6706.8995; val_edge_recon_loss: 253873.8402; val_gene_expr_recon_loss: 18175.5838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278756.3223; val_optim_loss: 278756.3223

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9980; val_auprc_score: 0.9969; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 6719.1989; train_edge_recon_loss: 255291.0807; train_gene_expr_recon_loss: 18213.1338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280223.4129; train_optim_loss: 280223.4129; val_kl_reg_loss: 6712.7185; val_edge_recon_loss: 253666.9684; val_gene_expr_recon_loss: 18228.8866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278608.5730; val_optim_loss: 278608.5730
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9980; val_auprc_score: 0.9970; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 6722.1439; train_edge_recon_loss: 255251.2965; train_gene_expr_recon_loss: 18206.1393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280179.5799; train_optim_loss: 280179.5799; val_kl_reg_loss: 6713.1896; val_edge_recon_loss: 253712.7113; val_gene_expr_recon_loss: 18172.3431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278598.2434; val_optim_loss: 278598.2434
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9978; val_auprc_score: 0.9967; val_best_acc_score: 0.9901; val_best_f1_score: 0.9901; train_kl_reg_loss: 6723.3152; train_edge_recon_loss: 255221.8992; train_gene_expr_recon_loss: 18204.4571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280149.6705; train_optim_loss: 280149.6705; val_kl_reg_loss: 6714.3094; val_edge_recon_loss: 253942.5830; val_gene_expr_recon_loss: 18182.3307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278839.2242; val_optim_loss: 278839.2242
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9980; val_auprc_score: 0.9970; val_best_acc_score: 0.9902; val_best_f1_score: 0.9902; train_kl_reg_loss: 6720.2842; train_edge_recon_loss: 255274.7285; train_gene_expr_recon_loss: 18197.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280192.0894; train_optim_loss: 280192.0894; val_kl_reg_loss: 6712.7344; val_edge_recon_loss: 253828.6670; val_gene_expr_recon_loss: 18169.1687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278710.5680; val_optim_loss: 278710.5680

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 439 min 26 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9980
Val AUPRC score: 0.9970
Val best accuracy score: 0.9902
Val best F1 score: 0.9902
Val gene expr MSE score: 0.4690

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
