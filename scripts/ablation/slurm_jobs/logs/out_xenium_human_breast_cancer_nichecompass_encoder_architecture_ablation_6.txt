None
Run timestamp: 26072023_042448_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '128', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 669485
Number of validation edges: 74387
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9589; val_auprc_score: 0.9472; val_best_acc_score: 0.9042; val_best_f1_score: 0.9092; train_kl_reg_loss: 15094.5070; train_edge_recon_loss: 26553967.0495; train_gene_expr_recon_loss: 820248.9950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27389310.5288; train_optim_loss: 27389310.5288; val_kl_reg_loss: 13876.1711; val_edge_recon_loss: 26398436.6770; val_gene_expr_recon_loss: 754275.5932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27166588.4089; val_optim_loss: 27166588.4089
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9768; val_auprc_score: 0.9714; val_best_acc_score: 0.9301; val_best_f1_score: 0.9324; train_kl_reg_loss: 12621.2933; train_edge_recon_loss: 26035397.0136; train_gene_expr_recon_loss: 741863.4478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26789881.7729; train_optim_loss: 26789881.7729; val_kl_reg_loss: 12384.6228; val_edge_recon_loss: 26232512.9828; val_gene_expr_recon_loss: 728781.8061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26973679.4055; val_optim_loss: 26973679.4055
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9801; val_auprc_score: 0.9740; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 12395.4951; train_edge_recon_loss: 25920220.4829; train_gene_expr_recon_loss: 719500.0412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26652116.0371; train_optim_loss: 26652116.0371; val_kl_reg_loss: 12332.6955; val_edge_recon_loss: 26175023.1856; val_gene_expr_recon_loss: 706742.7598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26894098.6460; val_optim_loss: 26894098.6460
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9835; val_auprc_score: 0.9788; val_best_acc_score: 0.9461; val_best_f1_score: 0.9475; train_kl_reg_loss: 12428.9111; train_edge_recon_loss: 25876466.1407; train_gene_expr_recon_loss: 704123.6054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26593018.6416; train_optim_loss: 26593018.6416; val_kl_reg_loss: 12634.2609; val_edge_recon_loss: 26081312.4467; val_gene_expr_recon_loss: 693659.8765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26787606.6426; val_optim_loss: 26787606.6426
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9839; val_auprc_score: 0.9788; val_best_acc_score: 0.9466; val_best_f1_score: 0.9480; train_kl_reg_loss: 12483.1790; train_edge_recon_loss: 25832008.3158; train_gene_expr_recon_loss: 691050.5338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26535542.0409; train_optim_loss: 26535542.0409; val_kl_reg_loss: 12371.5520; val_edge_recon_loss: 26084543.0515; val_gene_expr_recon_loss: 680471.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26777386.4777; val_optim_loss: 26777386.4777
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9867; val_auprc_score: 0.9833; val_best_acc_score: 0.9506; val_best_f1_score: 0.9516; train_kl_reg_loss: 12606.2435; train_edge_recon_loss: 25829909.2961; train_gene_expr_recon_loss: 680100.4016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26522615.9469; train_optim_loss: 26522615.9469; val_kl_reg_loss: 12645.5933; val_edge_recon_loss: 26076891.0584; val_gene_expr_recon_loss: 673447.7834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26762984.5120; val_optim_loss: 26762984.5120
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9871; val_auprc_score: 0.9835; val_best_acc_score: 0.9533; val_best_f1_score: 0.9543; train_kl_reg_loss: 12736.3553; train_edge_recon_loss: 25807000.5441; train_gene_expr_recon_loss: 672139.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26491876.1591; train_optim_loss: 26491876.1591; val_kl_reg_loss: 12908.0377; val_edge_recon_loss: 26041177.5223; val_gene_expr_recon_loss: 669440.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26723526.4674; val_optim_loss: 26723526.4674
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9872; val_auprc_score: 0.9839; val_best_acc_score: 0.9530; val_best_f1_score: 0.9541; train_kl_reg_loss: 12960.4210; train_edge_recon_loss: 25792141.3929; train_gene_expr_recon_loss: 666543.9673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26471645.7729; train_optim_loss: 26471645.7729; val_kl_reg_loss: 13201.8599; val_edge_recon_loss: 26058618.6357; val_gene_expr_recon_loss: 663547.2996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26735367.8385; val_optim_loss: 26735367.8385
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9885; val_auprc_score: 0.9855; val_best_acc_score: 0.9564; val_best_f1_score: 0.9572; train_kl_reg_loss: 13039.3916; train_edge_recon_loss: 25784733.8318; train_gene_expr_recon_loss: 661438.9113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26459212.1418; train_optim_loss: 26459212.1418; val_kl_reg_loss: 13042.4645; val_edge_recon_loss: 26035166.9416; val_gene_expr_recon_loss: 656336.3806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26704545.7491; val_optim_loss: 26704545.7491
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9864; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 13122.5089; train_edge_recon_loss: 25780513.9285; train_gene_expr_recon_loss: 657566.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26451202.7964; train_optim_loss: 26451202.7964; val_kl_reg_loss: 13104.8941; val_edge_recon_loss: 26045937.4708; val_gene_expr_recon_loss: 655103.9957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26714146.3677; val_optim_loss: 26714146.3677
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9887; val_auprc_score: 0.9852; val_best_acc_score: 0.9581; val_best_f1_score: 0.9589; train_kl_reg_loss: 13262.9724; train_edge_recon_loss: 25764914.4707; train_gene_expr_recon_loss: 654292.5874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26432470.0218; train_optim_loss: 26432470.0218; val_kl_reg_loss: 13273.0874; val_edge_recon_loss: 26034740.5670; val_gene_expr_recon_loss: 651653.3433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26699667.0619; val_optim_loss: 26699667.0619
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9888; val_auprc_score: 0.9857; val_best_acc_score: 0.9574; val_best_f1_score: 0.9581; train_kl_reg_loss: 13343.5860; train_edge_recon_loss: 25757219.8639; train_gene_expr_recon_loss: 651955.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26422519.3860; train_optim_loss: 26422519.3860; val_kl_reg_loss: 13450.6535; val_edge_recon_loss: 26029563.9278; val_gene_expr_recon_loss: 646807.4155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26689821.9519; val_optim_loss: 26689821.9519
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9591; val_best_f1_score: 0.9599; train_kl_reg_loss: 13390.6881; train_edge_recon_loss: 25741298.9807; train_gene_expr_recon_loss: 650325.6019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26405015.2583; train_optim_loss: 26405015.2583; val_kl_reg_loss: 13703.4390; val_edge_recon_loss: 25996608.0172; val_gene_expr_recon_loss: 649658.2178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26659969.6942; val_optim_loss: 26659969.6942
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9897; val_auprc_score: 0.9865; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 13424.5908; train_edge_recon_loss: 25744216.0119; train_gene_expr_recon_loss: 648693.4720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26406334.0600; train_optim_loss: 26406334.0600; val_kl_reg_loss: 13396.9000; val_edge_recon_loss: 25980992.7285; val_gene_expr_recon_loss: 647048.6069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26641438.1821; val_optim_loss: 26641438.1821
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9893; val_auprc_score: 0.9861; val_best_acc_score: 0.9593; val_best_f1_score: 0.9601; train_kl_reg_loss: 13512.2821; train_edge_recon_loss: 25726532.9272; train_gene_expr_recon_loss: 647470.1883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26387515.4024; train_optim_loss: 26387515.4024; val_kl_reg_loss: 13315.3350; val_edge_recon_loss: 25953980.8900; val_gene_expr_recon_loss: 644592.7488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26611888.9863; val_optim_loss: 26611888.9863
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9896; val_auprc_score: 0.9863; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 13618.1649; train_edge_recon_loss: 25727088.0271; train_gene_expr_recon_loss: 645580.2059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26386286.3839; train_optim_loss: 26386286.3839; val_kl_reg_loss: 13595.1338; val_edge_recon_loss: 25958677.0309; val_gene_expr_recon_loss: 642697.4406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26614969.5704; val_optim_loss: 26614969.5704
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9895; val_auprc_score: 0.9861; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 13537.1099; train_edge_recon_loss: 25730596.3208; train_gene_expr_recon_loss: 646074.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26390208.0352; train_optim_loss: 26390208.0352; val_kl_reg_loss: 13562.0116; val_edge_recon_loss: 25961877.1203; val_gene_expr_recon_loss: 644621.5721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26620060.7320; val_optim_loss: 26620060.7320
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9897; val_auprc_score: 0.9867; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 13637.4026; train_edge_recon_loss: 25713049.0541; train_gene_expr_recon_loss: 644633.8277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26371320.2741; train_optim_loss: 26371320.2741; val_kl_reg_loss: 13466.3879; val_edge_recon_loss: 25978635.3643; val_gene_expr_recon_loss: 643683.3388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26635785.0928; val_optim_loss: 26635785.0928
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9902; val_auprc_score: 0.9875; val_best_acc_score: 0.9626; val_best_f1_score: 0.9633; train_kl_reg_loss: 13765.4232; train_edge_recon_loss: 25723422.7693; train_gene_expr_recon_loss: 642873.1767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26380061.3902; train_optim_loss: 26380061.3902; val_kl_reg_loss: 13564.8508; val_edge_recon_loss: 25926069.9931; val_gene_expr_recon_loss: 640319.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26579954.2062; val_optim_loss: 26579954.2062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9899; val_auprc_score: 0.9866; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 13745.1410; train_edge_recon_loss: 25715501.9186; train_gene_expr_recon_loss: 641899.8016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26371146.8675; train_optim_loss: 26371146.8675; val_kl_reg_loss: 13661.1789; val_edge_recon_loss: 25950059.2577; val_gene_expr_recon_loss: 643708.9154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26607429.3746; val_optim_loss: 26607429.3746
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9897; val_auprc_score: 0.9866; val_best_acc_score: 0.9614; val_best_f1_score: 0.9621; train_kl_reg_loss: 13834.7587; train_edge_recon_loss: 25701052.7930; train_gene_expr_recon_loss: 641212.0172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26356099.5645; train_optim_loss: 26356099.5645; val_kl_reg_loss: 14282.7527; val_edge_recon_loss: 25931267.8385; val_gene_expr_recon_loss: 643465.5276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26589016.0997; val_optim_loss: 26589016.0997
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9903; val_auprc_score: 0.9871; val_best_acc_score: 0.9630; val_best_f1_score: 0.9636; train_kl_reg_loss: 13821.1231; train_edge_recon_loss: 25707819.5198; train_gene_expr_recon_loss: 640681.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26362322.0241; train_optim_loss: 26362322.0241; val_kl_reg_loss: 13688.1985; val_edge_recon_loss: 25967655.5258; val_gene_expr_recon_loss: 638068.4521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26619412.2302; val_optim_loss: 26619412.2302
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9898; val_auprc_score: 0.9864; val_best_acc_score: 0.9618; val_best_f1_score: 0.9626; train_kl_reg_loss: 13874.9361; train_edge_recon_loss: 25696821.8172; train_gene_expr_recon_loss: 640004.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26350701.4494; train_optim_loss: 26350701.4494; val_kl_reg_loss: 14065.3364; val_edge_recon_loss: 25896551.0756; val_gene_expr_recon_loss: 641231.7698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26551848.1924; val_optim_loss: 26551848.1924
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9906; val_auprc_score: 0.9875; val_best_acc_score: 0.9634; val_best_f1_score: 0.9641; train_kl_reg_loss: 13881.7979; train_edge_recon_loss: 25702286.3678; train_gene_expr_recon_loss: 640115.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26356283.1730; train_optim_loss: 26356283.1730; val_kl_reg_loss: 13692.2180; val_edge_recon_loss: 25903145.5498; val_gene_expr_recon_loss: 637890.2519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26554727.9759; val_optim_loss: 26554727.9759
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9897; val_auprc_score: 0.9861; val_best_acc_score: 0.9631; val_best_f1_score: 0.9636; train_kl_reg_loss: 13958.0621; train_edge_recon_loss: 25691350.6997; train_gene_expr_recon_loss: 639203.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26344512.4913; train_optim_loss: 26344512.4913; val_kl_reg_loss: 13700.3392; val_edge_recon_loss: 25943042.0206; val_gene_expr_recon_loss: 642241.4129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26598983.7629; val_optim_loss: 26598983.7629
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9873; val_best_acc_score: 0.9633; val_best_f1_score: 0.9640; train_kl_reg_loss: 13937.3200; train_edge_recon_loss: 25697846.0768; train_gene_expr_recon_loss: 638753.2172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26350536.6129; train_optim_loss: 26350536.6129; val_kl_reg_loss: 13867.2702; val_edge_recon_loss: 25907431.3849; val_gene_expr_recon_loss: 639438.8751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26560737.5533; val_optim_loss: 26560737.5533
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9907; val_auprc_score: 0.9880; val_best_acc_score: 0.9642; val_best_f1_score: 0.9649; train_kl_reg_loss: 14112.4678; train_edge_recon_loss: 25682303.6486; train_gene_expr_recon_loss: 637730.3013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26334146.4118; train_optim_loss: 26334146.4118; val_kl_reg_loss: 14118.8808; val_edge_recon_loss: 25913459.2474; val_gene_expr_recon_loss: 635136.0442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26562714.2199; val_optim_loss: 26562714.2199

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9913; val_auprc_score: 0.9884; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 14318.3316; train_edge_recon_loss: 25643363.3141; train_gene_expr_recon_loss: 622284.6109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26279966.2531; train_optim_loss: 26279966.2531; val_kl_reg_loss: 14468.3875; val_edge_recon_loss: 25855956.3196; val_gene_expr_recon_loss: 620312.1122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26490736.8282; val_optim_loss: 26490736.8282
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9909; val_auprc_score: 0.9881; val_best_acc_score: 0.9649; val_best_f1_score: 0.9654; train_kl_reg_loss: 14588.0882; train_edge_recon_loss: 25641591.4032; train_gene_expr_recon_loss: 619103.8257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26275283.3099; train_optim_loss: 26275283.3099; val_kl_reg_loss: 14537.1044; val_edge_recon_loss: 25850986.7010; val_gene_expr_recon_loss: 619500.7704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26485024.5876; val_optim_loss: 26485024.5876
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9910; val_auprc_score: 0.9880; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 14677.1469; train_edge_recon_loss: 25639597.0835; train_gene_expr_recon_loss: 617246.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26271521.2040; train_optim_loss: 26271521.2040; val_kl_reg_loss: 14656.0015; val_edge_recon_loss: 25845748.7285; val_gene_expr_recon_loss: 619647.1072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26480051.8900; val_optim_loss: 26480051.8900
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9915; val_auprc_score: 0.9885; val_best_acc_score: 0.9663; val_best_f1_score: 0.9669; train_kl_reg_loss: 14696.3809; train_edge_recon_loss: 25627885.0071; train_gene_expr_recon_loss: 616834.6544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26259416.0199; train_optim_loss: 26259416.0199; val_kl_reg_loss: 14675.3116; val_edge_recon_loss: 25855648.2577; val_gene_expr_recon_loss: 616940.8358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26487264.4055; val_optim_loss: 26487264.4055
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9918; val_auprc_score: 0.9893; val_best_acc_score: 0.9669; val_best_f1_score: 0.9674; train_kl_reg_loss: 14695.2085; train_edge_recon_loss: 25634607.1157; train_gene_expr_recon_loss: 616534.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26265836.8106; train_optim_loss: 26265836.8106; val_kl_reg_loss: 14670.5274; val_edge_recon_loss: 25832479.8832; val_gene_expr_recon_loss: 617698.6262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26464849.0515; val_optim_loss: 26464849.0515
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9915; val_auprc_score: 0.9886; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 14723.0481; train_edge_recon_loss: 25629298.0061; train_gene_expr_recon_loss: 615767.2340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26259788.2913; train_optim_loss: 26259788.2913; val_kl_reg_loss: 14782.8916; val_edge_recon_loss: 25826668.7320; val_gene_expr_recon_loss: 616127.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26457578.6460; val_optim_loss: 26457578.6460
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9909; val_auprc_score: 0.9878; val_best_acc_score: 0.9661; val_best_f1_score: 0.9667; train_kl_reg_loss: 14763.6012; train_edge_recon_loss: 25629603.7580; train_gene_expr_recon_loss: 615102.6144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26259469.9759; train_optim_loss: 26259469.9759; val_kl_reg_loss: 14752.9926; val_edge_recon_loss: 25855875.5017; val_gene_expr_recon_loss: 615685.6195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26486314.1100; val_optim_loss: 26486314.1100
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9672; val_best_f1_score: 0.9677; train_kl_reg_loss: 14726.1547; train_edge_recon_loss: 25630830.4255; train_gene_expr_recon_loss: 614726.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26260283.4437; train_optim_loss: 26260283.4437; val_kl_reg_loss: 14639.4641; val_edge_recon_loss: 25833346.1856; val_gene_expr_recon_loss: 616464.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26464450.5223; val_optim_loss: 26464450.5223
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9663; val_best_f1_score: 0.9668; train_kl_reg_loss: 14742.2038; train_edge_recon_loss: 25634909.8979; train_gene_expr_recon_loss: 614365.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26264017.4338; train_optim_loss: 26264017.4338; val_kl_reg_loss: 14638.0109; val_edge_recon_loss: 25858147.1478; val_gene_expr_recon_loss: 614947.3618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26487732.4708; val_optim_loss: 26487732.4708
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9914; val_auprc_score: 0.9885; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 14697.2022; train_edge_recon_loss: 25623048.1866; train_gene_expr_recon_loss: 614092.3128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26251837.6746; train_optim_loss: 26251837.6746; val_kl_reg_loss: 14753.8815; val_edge_recon_loss: 25835394.9003; val_gene_expr_recon_loss: 615908.2873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26466057.1065; val_optim_loss: 26466057.1065

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9919; val_auprc_score: 0.9893; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 14762.0481; train_edge_recon_loss: 25627866.5792; train_gene_expr_recon_loss: 612669.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26255297.8341; train_optim_loss: 26255297.8341; val_kl_reg_loss: 14739.6542; val_edge_recon_loss: 25831546.8694; val_gene_expr_recon_loss: 613661.5855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26459948.0928; val_optim_loss: 26459948.0928
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9917; val_auprc_score: 0.9889; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 14740.6404; train_edge_recon_loss: 25629951.0656; train_gene_expr_recon_loss: 612108.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26256799.7045; train_optim_loss: 26256799.7045; val_kl_reg_loss: 14771.8838; val_edge_recon_loss: 25831878.3849; val_gene_expr_recon_loss: 614047.2687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26460697.4708; val_optim_loss: 26460697.4708
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 14729.1742; train_edge_recon_loss: 25629869.9889; train_gene_expr_recon_loss: 612415.4105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26257014.5796; train_optim_loss: 26257014.5796; val_kl_reg_loss: 14743.4952; val_edge_recon_loss: 25830151.8419; val_gene_expr_recon_loss: 612496.8092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26457392.1134; val_optim_loss: 26457392.1134
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 14762.9119; train_edge_recon_loss: 25630191.2567; train_gene_expr_recon_loss: 612301.1359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26257255.3007; train_optim_loss: 26257255.3007; val_kl_reg_loss: 14780.5014; val_edge_recon_loss: 25818253.1684; val_gene_expr_recon_loss: 614744.2678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26447777.9278; val_optim_loss: 26447777.9278
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 14767.6264; train_edge_recon_loss: 25618193.1027; train_gene_expr_recon_loss: 612113.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26245074.3961; train_optim_loss: 26245074.3961; val_kl_reg_loss: 14750.7461; val_edge_recon_loss: 25814213.2474; val_gene_expr_recon_loss: 613322.0841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26442286.0859; val_optim_loss: 26442286.0859
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9915; val_auprc_score: 0.9885; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 14756.2818; train_edge_recon_loss: 25628680.7559; train_gene_expr_recon_loss: 612160.9366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26255597.9969; train_optim_loss: 26255597.9969; val_kl_reg_loss: 14724.9669; val_edge_recon_loss: 25834354.8179; val_gene_expr_recon_loss: 613449.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26462529.4227; val_optim_loss: 26462529.4227
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 14765.5927; train_edge_recon_loss: 25627883.6857; train_gene_expr_recon_loss: 611880.4439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26254529.7274; train_optim_loss: 26254529.7274; val_kl_reg_loss: 14782.8645; val_edge_recon_loss: 25816719.7629; val_gene_expr_recon_loss: 613143.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26444646.1856; val_optim_loss: 26444646.1856
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9916; val_auprc_score: 0.9886; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 14771.1733; train_edge_recon_loss: 25624207.2984; train_gene_expr_recon_loss: 612012.2941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26250990.7773; train_optim_loss: 26250990.7773; val_kl_reg_loss: 14790.8947; val_edge_recon_loss: 25821186.6151; val_gene_expr_recon_loss: 614035.1487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26450012.6564; val_optim_loss: 26450012.6564
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 14772.3819; train_edge_recon_loss: 25619524.1973; train_gene_expr_recon_loss: 611717.5890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246014.1621; train_optim_loss: 26246014.1621; val_kl_reg_loss: 14776.0788; val_edge_recon_loss: 25832002.7869; val_gene_expr_recon_loss: 612875.2174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26459654.0309; val_optim_loss: 26459654.0309

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9677; val_best_f1_score: 0.9682; train_kl_reg_loss: 14765.7288; train_edge_recon_loss: 25616808.4137; train_gene_expr_recon_loss: 611879.1566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26243453.3126; train_optim_loss: 26243453.3126; val_kl_reg_loss: 14777.1402; val_edge_recon_loss: 25811630.0756; val_gene_expr_recon_loss: 613246.1752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26439653.3814; val_optim_loss: 26439653.3814
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9915; val_auprc_score: 0.9889; val_best_acc_score: 0.9668; val_best_f1_score: 0.9673; train_kl_reg_loss: 14777.6401; train_edge_recon_loss: 25617529.6785; train_gene_expr_recon_loss: 611690.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26243997.7484; train_optim_loss: 26243997.7484; val_kl_reg_loss: 14778.1915; val_edge_recon_loss: 25843689.7010; val_gene_expr_recon_loss: 612172.2733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26470640.1993; val_optim_loss: 26470640.1993
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9914; val_auprc_score: 0.9884; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 14774.7972; train_edge_recon_loss: 25625738.9402; train_gene_expr_recon_loss: 611624.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26252138.3590; train_optim_loss: 26252138.3590; val_kl_reg_loss: 14773.8316; val_edge_recon_loss: 25817455.6220; val_gene_expr_recon_loss: 613284.9698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26445514.3814; val_optim_loss: 26445514.3814
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9916; val_auprc_score: 0.9886; val_best_acc_score: 0.9682; val_best_f1_score: 0.9687; train_kl_reg_loss: 14773.2603; train_edge_recon_loss: 25620728.8993; train_gene_expr_recon_loss: 611569.5309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26247071.7113; train_optim_loss: 26247071.7113; val_kl_reg_loss: 14748.0135; val_edge_recon_loss: 25808351.1581; val_gene_expr_recon_loss: 614257.6799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26437356.8316; val_optim_loss: 26437356.8316
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9914; val_auprc_score: 0.9885; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 14768.1624; train_edge_recon_loss: 25619818.6504; train_gene_expr_recon_loss: 611444.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246031.4062; train_optim_loss: 26246031.4062; val_kl_reg_loss: 14774.5939; val_edge_recon_loss: 25835492.1340; val_gene_expr_recon_loss: 613388.4043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26463655.1306; val_optim_loss: 26463655.1306
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9914; val_auprc_score: 0.9884; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 14773.8681; train_edge_recon_loss: 25618589.4854; train_gene_expr_recon_loss: 611737.0724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26245100.4359; train_optim_loss: 26245100.4359; val_kl_reg_loss: 14782.8722; val_edge_recon_loss: 25819438.8729; val_gene_expr_recon_loss: 614137.5004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26448359.2509; val_optim_loss: 26448359.2509
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9914; val_auprc_score: 0.9881; val_best_acc_score: 0.9674; val_best_f1_score: 0.9679; train_kl_reg_loss: 14768.6545; train_edge_recon_loss: 25625352.4447; train_gene_expr_recon_loss: 611499.6800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26251620.7700; train_optim_loss: 26251620.7700; val_kl_reg_loss: 14773.7519; val_edge_recon_loss: 25824734.5395; val_gene_expr_recon_loss: 612713.2210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26452221.4845; val_optim_loss: 26452221.4845
