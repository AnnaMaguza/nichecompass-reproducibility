None
Run timestamp: 19072023_100322_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--add_fc_gps_instead_of_gp_dict_gps', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1818, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1818, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9727; val_auprc_score: 0.9648; val_best_acc_score: 0.9264; val_best_f1_score: 0.9277; train_kl_reg_loss: 287.2657; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 21384.5214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21671.7871; train_optim_loss: 21671.7871; val_kl_reg_loss: 255.6777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 20006.4959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20262.1737; val_optim_loss: 20262.1737
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9754; val_auprc_score: 0.9688; val_best_acc_score: 0.9330; val_best_f1_score: 0.9342; train_kl_reg_loss: 276.5533; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 20225.5222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20502.0754; train_optim_loss: 20502.0754; val_kl_reg_loss: 278.9000; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19530.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19809.3332; val_optim_loss: 19809.3332
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9777; val_auprc_score: 0.9726; val_best_acc_score: 0.9364; val_best_f1_score: 0.9372; train_kl_reg_loss: 300.3336; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19863.0494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20163.3830; train_optim_loss: 20163.3830; val_kl_reg_loss: 301.9139; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19237.6428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19539.5566; val_optim_loss: 19539.5566
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9797; val_auprc_score: 0.9757; val_best_acc_score: 0.9378; val_best_f1_score: 0.9386; train_kl_reg_loss: 319.3278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19621.3665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19940.6943; train_optim_loss: 19940.6943; val_kl_reg_loss: 320.2366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 19050.3397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19370.5764; val_optim_loss: 19370.5764
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9817; val_auprc_score: 0.9787; val_best_acc_score: 0.9409; val_best_f1_score: 0.9416; train_kl_reg_loss: 335.6277; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19392.5923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19728.2200; train_optim_loss: 19728.2200; val_kl_reg_loss: 327.7762; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18804.9523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19132.7284; val_optim_loss: 19132.7284
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9824; val_auprc_score: 0.9801; val_best_acc_score: 0.9425; val_best_f1_score: 0.9430; train_kl_reg_loss: 345.5033; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 19182.2368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19527.7401; train_optim_loss: 19527.7401; val_kl_reg_loss: 337.4986; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18654.7401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18992.2385; val_optim_loss: 18992.2385
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9833; val_auprc_score: 0.9814; val_best_acc_score: 0.9442; val_best_f1_score: 0.9446; train_kl_reg_loss: 350.7515; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18951.9476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19302.6991; train_optim_loss: 19302.6991; val_kl_reg_loss: 350.2466; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18525.8080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18876.0545; val_optim_loss: 18876.0545
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9848; val_auprc_score: 0.9842; val_best_acc_score: 0.9467; val_best_f1_score: 0.9472; train_kl_reg_loss: 363.1908; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18765.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19128.8703; train_optim_loss: 19128.8703; val_kl_reg_loss: 359.4452; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18272.7536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18632.1987; val_optim_loss: 18632.1987
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9849; val_auprc_score: 0.9850; val_best_acc_score: 0.9460; val_best_f1_score: 0.9460; train_kl_reg_loss: 382.7970; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18566.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18949.6203; train_optim_loss: 18949.6203; val_kl_reg_loss: 386.5963; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 18121.0842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18507.6807; val_optim_loss: 18507.6807
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9842; val_auprc_score: 0.9849; val_best_acc_score: 0.9461; val_best_f1_score: 0.9458; train_kl_reg_loss: 408.9400; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18372.1622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18781.1022; train_optim_loss: 18781.1022; val_kl_reg_loss: 418.5972; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17985.9735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18404.5708; val_optim_loss: 18404.5708
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9842; val_auprc_score: 0.9854; val_best_acc_score: 0.9468; val_best_f1_score: 0.9467; train_kl_reg_loss: 437.3022; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18208.3346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18645.6368; train_optim_loss: 18645.6368; val_kl_reg_loss: 442.4347; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17806.0077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18248.4424; val_optim_loss: 18248.4424
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9833; val_auprc_score: 0.9850; val_best_acc_score: 0.9456; val_best_f1_score: 0.9456; train_kl_reg_loss: 465.2867; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 18060.9470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18526.2336; train_optim_loss: 18526.2336; val_kl_reg_loss: 465.0191; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17680.4331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18145.4521; val_optim_loss: 18145.4521
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9838; val_auprc_score: 0.9860; val_best_acc_score: 0.9465; val_best_f1_score: 0.9459; train_kl_reg_loss: 491.3303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17933.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18425.2951; train_optim_loss: 18425.2951; val_kl_reg_loss: 494.8101; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17580.3817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18075.1917; val_optim_loss: 18075.1917
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9837; val_auprc_score: 0.9856; val_best_acc_score: 0.9456; val_best_f1_score: 0.9449; train_kl_reg_loss: 515.8876; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17810.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18326.0262; train_optim_loss: 18326.0262; val_kl_reg_loss: 517.9020; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17477.1426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17995.0447; val_optim_loss: 17995.0447
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9829; val_auprc_score: 0.9849; val_best_acc_score: 0.9444; val_best_f1_score: 0.9434; train_kl_reg_loss: 537.9738; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17706.1598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18244.1336; train_optim_loss: 18244.1336; val_kl_reg_loss: 539.9587; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17339.9867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17879.9454; val_optim_loss: 17879.9454
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9825; val_auprc_score: 0.9854; val_best_acc_score: 0.9430; val_best_f1_score: 0.9423; train_kl_reg_loss: 557.6400; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17603.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18161.0627; train_optim_loss: 18161.0627; val_kl_reg_loss: 554.3335; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17347.3376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17901.6710; val_optim_loss: 17901.6710
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9820; val_auprc_score: 0.9850; val_best_acc_score: 0.9430; val_best_f1_score: 0.9423; train_kl_reg_loss: 576.0948; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17531.4205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18107.5153; train_optim_loss: 18107.5153; val_kl_reg_loss: 582.9463; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17222.5491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17805.4955; val_optim_loss: 17805.4955
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9818; val_auprc_score: 0.9847; val_best_acc_score: 0.9425; val_best_f1_score: 0.9412; train_kl_reg_loss: 592.9302; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17461.0422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18053.9725; train_optim_loss: 18053.9725; val_kl_reg_loss: 592.1979; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17149.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17741.6255; val_optim_loss: 17741.6255
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9819; val_auprc_score: 0.9852; val_best_acc_score: 0.9414; val_best_f1_score: 0.9400; train_kl_reg_loss: 607.7196; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17387.0058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17994.7255; train_optim_loss: 17994.7255; val_kl_reg_loss: 611.1932; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17109.4100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17720.6030; val_optim_loss: 17720.6030
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9808; val_auprc_score: 0.9835; val_best_acc_score: 0.9408; val_best_f1_score: 0.9400; train_kl_reg_loss: 621.7888; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17328.2761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17950.0648; train_optim_loss: 17950.0648; val_kl_reg_loss: 612.1896; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17014.6946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17626.8842; val_optim_loss: 17626.8842
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9804; val_auprc_score: 0.9841; val_best_acc_score: 0.9401; val_best_f1_score: 0.9392; train_kl_reg_loss: 634.9468; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17264.1402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17899.0870; train_optim_loss: 17899.0870; val_kl_reg_loss: 626.7011; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 17054.9001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17681.6014; val_optim_loss: 17681.6014
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9806; val_auprc_score: 0.9844; val_best_acc_score: 0.9413; val_best_f1_score: 0.9400; train_kl_reg_loss: 646.7295; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17219.3665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17866.0961; train_optim_loss: 17866.0961; val_kl_reg_loss: 636.0404; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16993.4802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17629.5208; val_optim_loss: 17629.5208
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9809; val_auprc_score: 0.9840; val_best_acc_score: 0.9416; val_best_f1_score: 0.9402; train_kl_reg_loss: 657.0719; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17184.0679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17841.1398; train_optim_loss: 17841.1398; val_kl_reg_loss: 642.2285; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16965.0699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17607.2986; val_optim_loss: 17607.2986
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9802; val_auprc_score: 0.9844; val_best_acc_score: 0.9404; val_best_f1_score: 0.9389; train_kl_reg_loss: 666.8587; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17147.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17814.0160; train_optim_loss: 17814.0160; val_kl_reg_loss: 669.6266; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16926.6634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17596.2900; val_optim_loss: 17596.2900
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9801; val_auprc_score: 0.9844; val_best_acc_score: 0.9412; val_best_f1_score: 0.9394; train_kl_reg_loss: 677.8859; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17111.7566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17789.6425; train_optim_loss: 17789.6425; val_kl_reg_loss: 671.6770; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16889.7710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17561.4481; val_optim_loss: 17561.4481
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9792; val_auprc_score: 0.9837; val_best_acc_score: 0.9388; val_best_f1_score: 0.9369; train_kl_reg_loss: 686.3783; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17071.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17757.9585; train_optim_loss: 17757.9585; val_kl_reg_loss: 677.7378; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16869.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17547.2835; val_optim_loss: 17547.2835
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9796; val_auprc_score: 0.9839; val_best_acc_score: 0.9392; val_best_f1_score: 0.9383; train_kl_reg_loss: 694.3420; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17060.4602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17754.8022; train_optim_loss: 17754.8022; val_kl_reg_loss: 681.6147; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16886.1028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17567.7176; val_optim_loss: 17567.7176
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9797; val_auprc_score: 0.9839; val_best_acc_score: 0.9397; val_best_f1_score: 0.9388; train_kl_reg_loss: 701.7662; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 17002.7091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17704.4753; train_optim_loss: 17704.4753; val_kl_reg_loss: 702.1993; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16854.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17556.9357; val_optim_loss: 17556.9357
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9792; val_auprc_score: 0.9838; val_best_acc_score: 0.9383; val_best_f1_score: 0.9372; train_kl_reg_loss: 709.3329; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16971.0522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17680.3851; train_optim_loss: 17680.3851; val_kl_reg_loss: 707.6640; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16886.3901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17594.0542; val_optim_loss: 17594.0542
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9786; val_auprc_score: 0.9832; val_best_acc_score: 0.9382; val_best_f1_score: 0.9371; train_kl_reg_loss: 716.1898; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16952.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17668.8716; train_optim_loss: 17668.8716; val_kl_reg_loss: 711.2071; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16857.4887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17568.6958; val_optim_loss: 17568.6958

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9805; val_auprc_score: 0.9847; val_best_acc_score: 0.9414; val_best_f1_score: 0.9403; train_kl_reg_loss: 703.7876; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16809.2750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17513.0625; train_optim_loss: 17513.0625; val_kl_reg_loss: 689.2013; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16803.0051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17492.2064; val_optim_loss: 17492.2064
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9803; val_auprc_score: 0.9847; val_best_acc_score: 0.9405; val_best_f1_score: 0.9393; train_kl_reg_loss: 700.5018; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16746.1516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17446.6534; train_optim_loss: 17446.6534; val_kl_reg_loss: 688.2552; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16779.5677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17467.8229; val_optim_loss: 17467.8229
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9799; val_auprc_score: 0.9844; val_best_acc_score: 0.9406; val_best_f1_score: 0.9393; train_kl_reg_loss: 697.2845; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16697.9431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17395.2276; train_optim_loss: 17395.2276; val_kl_reg_loss: 683.6286; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16745.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17428.6815; val_optim_loss: 17428.6815
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9799; val_auprc_score: 0.9843; val_best_acc_score: 0.9402; val_best_f1_score: 0.9388; train_kl_reg_loss: 695.8394; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16685.5947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17381.4341; train_optim_loss: 17381.4341; val_kl_reg_loss: 683.7937; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16726.3299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17410.1234; val_optim_loss: 17410.1234
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9793; val_auprc_score: 0.9835; val_best_acc_score: 0.9395; val_best_f1_score: 0.9382; train_kl_reg_loss: 694.5856; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16653.8391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17348.4247; train_optim_loss: 17348.4247; val_kl_reg_loss: 679.5932; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16773.0213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17452.6142; val_optim_loss: 17452.6142
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9799; val_auprc_score: 0.9845; val_best_acc_score: 0.9401; val_best_f1_score: 0.9387; train_kl_reg_loss: 694.3028; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16645.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17340.1677; train_optim_loss: 17340.1677; val_kl_reg_loss: 682.3808; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16751.3183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17433.6993; val_optim_loss: 17433.6993
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9797; val_auprc_score: 0.9839; val_best_acc_score: 0.9395; val_best_f1_score: 0.9381; train_kl_reg_loss: 694.1241; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16633.5490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17327.6731; train_optim_loss: 17327.6731; val_kl_reg_loss: 682.9753; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16756.3450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17439.3206; val_optim_loss: 17439.3206
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9791; val_auprc_score: 0.9832; val_best_acc_score: 0.9380; val_best_f1_score: 0.9367; train_kl_reg_loss: 694.7671; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16634.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17329.0842; train_optim_loss: 17329.0842; val_kl_reg_loss: 684.0898; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16771.1517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17455.2415; val_optim_loss: 17455.2415

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9798; val_auprc_score: 0.9842; val_best_acc_score: 0.9403; val_best_f1_score: 0.9388; train_kl_reg_loss: 693.3979; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16610.7301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17304.1280; train_optim_loss: 17304.1280; val_kl_reg_loss: 682.0075; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16780.8450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17462.8526; val_optim_loss: 17462.8526
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9794; val_auprc_score: 0.9838; val_best_acc_score: 0.9395; val_best_f1_score: 0.9379; train_kl_reg_loss: 693.2599; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16595.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17288.6906; train_optim_loss: 17288.6906; val_kl_reg_loss: 681.6433; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16747.2202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17428.8635; val_optim_loss: 17428.8635
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9794; val_auprc_score: 0.9838; val_best_acc_score: 0.9395; val_best_f1_score: 0.9380; train_kl_reg_loss: 693.5497; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16606.6713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17300.2210; train_optim_loss: 17300.2210; val_kl_reg_loss: 681.9959; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16738.3681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17420.3641; val_optim_loss: 17420.3641
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9796; val_auprc_score: 0.9843; val_best_acc_score: 0.9403; val_best_f1_score: 0.9388; train_kl_reg_loss: 693.9475; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16605.0698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17299.0173; train_optim_loss: 17299.0173; val_kl_reg_loss: 681.8031; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 16758.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17439.9757; val_optim_loss: 17439.9757

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 26 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9796
Val AUPRC score: 0.9838
Val best accuracy score: 0.9387
Val best F1 score: 0.9375
Val gene expr MSE score: 0.4923

Computing neighbor graph...
