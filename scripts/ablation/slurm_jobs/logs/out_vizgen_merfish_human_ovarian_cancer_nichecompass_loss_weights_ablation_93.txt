None
Run timestamp: 18072023_012613_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9172; val_auprc_score: 0.9123; val_best_acc_score: 0.8368; val_best_f1_score: 0.8439; train_kl_reg_loss: 85419.8086; train_edge_recon_loss: 3049964.5601; train_gene_expr_recon_loss: 14139314.5204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17274698.8819; train_optim_loss: 17274698.8819; val_kl_reg_loss: 73310.5591; val_edge_recon_loss: 2855973.0273; val_gene_expr_recon_loss: 13152887.1182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16082170.7273; val_optim_loss: 16082170.7273
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9519; val_auprc_score: 0.9488; val_best_acc_score: 0.8852; val_best_f1_score: 0.8873; train_kl_reg_loss: 73549.6004; train_edge_recon_loss: 2746060.7355; train_gene_expr_recon_loss: 12825111.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15644721.3371; train_optim_loss: 15644721.3371; val_kl_reg_loss: 64917.6283; val_edge_recon_loss: 2771039.7932; val_gene_expr_recon_loss: 12598336.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15434293.8455; val_optim_loss: 15434293.8455
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9653; val_auprc_score: 0.9637; val_best_acc_score: 0.9058; val_best_f1_score: 0.9069; train_kl_reg_loss: 60957.2525; train_edge_recon_loss: 2705044.2912; train_gene_expr_recon_loss: 12419499.0285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15185500.5845; train_optim_loss: 15185500.5845; val_kl_reg_loss: 56101.9993; val_edge_recon_loss: 2738288.1227; val_gene_expr_recon_loss: 12320513.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15114903.5818; val_optim_loss: 15114903.5818
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9692; val_best_acc_score: 0.9139; val_best_f1_score: 0.9152; train_kl_reg_loss: 54825.6320; train_edge_recon_loss: 2684532.2862; train_gene_expr_recon_loss: 12185771.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14925128.9633; train_optim_loss: 14925128.9633; val_kl_reg_loss: 50533.9141; val_edge_recon_loss: 2723249.4750; val_gene_expr_recon_loss: 12151323.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14925106.6091; val_optim_loss: 14925106.6091
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9725; val_auprc_score: 0.9707; val_best_acc_score: 0.9169; val_best_f1_score: 0.9185; train_kl_reg_loss: 51397.9316; train_edge_recon_loss: 2672525.9425; train_gene_expr_recon_loss: 12040249.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14764173.6181; train_optim_loss: 14764173.6181; val_kl_reg_loss: 48769.8847; val_edge_recon_loss: 2716721.5136; val_gene_expr_recon_loss: 12049983.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14815474.8818; val_optim_loss: 14815474.8818
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9734; val_auprc_score: 0.9721; val_best_acc_score: 0.9183; val_best_f1_score: 0.9193; train_kl_reg_loss: 49531.7442; train_edge_recon_loss: 2666091.1034; train_gene_expr_recon_loss: 11950619.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14666242.1161; train_optim_loss: 14666242.1161; val_kl_reg_loss: 46056.6312; val_edge_recon_loss: 2707717.6045; val_gene_expr_recon_loss: 12023098.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14776872.8545; val_optim_loss: 14776872.8545
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9738; val_auprc_score: 0.9722; val_best_acc_score: 0.9202; val_best_f1_score: 0.9210; train_kl_reg_loss: 48385.5660; train_edge_recon_loss: 2662573.7561; train_gene_expr_recon_loss: 11879128.1752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14590087.5041; train_optim_loss: 14590087.5041; val_kl_reg_loss: 45849.2705; val_edge_recon_loss: 2717128.6136; val_gene_expr_recon_loss: 11929313.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14692291.8727; val_optim_loss: 14692291.8727
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9753; val_auprc_score: 0.9735; val_best_acc_score: 0.9226; val_best_f1_score: 0.9234; train_kl_reg_loss: 47213.0550; train_edge_recon_loss: 2661549.7245; train_gene_expr_recon_loss: 11827496.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14536259.2851; train_optim_loss: 14536259.2851; val_kl_reg_loss: 45558.9633; val_edge_recon_loss: 2707599.4500; val_gene_expr_recon_loss: 11864758.3727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14617916.7909; val_optim_loss: 14617916.7909
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9761; val_auprc_score: 0.9749; val_best_acc_score: 0.9237; val_best_f1_score: 0.9244; train_kl_reg_loss: 46291.6657; train_edge_recon_loss: 2657063.1711; train_gene_expr_recon_loss: 11784766.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14488121.0000; train_optim_loss: 14488121.0000; val_kl_reg_loss: 44745.9392; val_edge_recon_loss: 2707518.3977; val_gene_expr_recon_loss: 11867626.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14619890.5636; val_optim_loss: 14619890.5636
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9775; val_auprc_score: 0.9761; val_best_acc_score: 0.9264; val_best_f1_score: 0.9271; train_kl_reg_loss: 45338.9854; train_edge_recon_loss: 2653954.2444; train_gene_expr_recon_loss: 11763903.9409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14463197.1670; train_optim_loss: 14463197.1670; val_kl_reg_loss: 43979.3511; val_edge_recon_loss: 2698806.0545; val_gene_expr_recon_loss: 11834986.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14577771.9636; val_optim_loss: 14577771.9636
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9775; val_auprc_score: 0.9759; val_best_acc_score: 0.9258; val_best_f1_score: 0.9270; train_kl_reg_loss: 44804.0078; train_edge_recon_loss: 2651344.3340; train_gene_expr_recon_loss: 11741576.9532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14437725.3024; train_optim_loss: 14437725.3024; val_kl_reg_loss: 43330.1059; val_edge_recon_loss: 2701036.5023; val_gene_expr_recon_loss: 11822702.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14567069.4727; val_optim_loss: 14567069.4727
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9779; val_auprc_score: 0.9765; val_best_acc_score: 0.9277; val_best_f1_score: 0.9283; train_kl_reg_loss: 44449.0564; train_edge_recon_loss: 2648056.0046; train_gene_expr_recon_loss: 11725714.8961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14418219.9450; train_optim_loss: 14418219.9450; val_kl_reg_loss: 43952.6100; val_edge_recon_loss: 2693645.4864; val_gene_expr_recon_loss: 11813461.9273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14551059.9818; val_optim_loss: 14551059.9818
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9783; val_auprc_score: 0.9769; val_best_acc_score: 0.9281; val_best_f1_score: 0.9293; train_kl_reg_loss: 44158.9899; train_edge_recon_loss: 2644962.9616; train_gene_expr_recon_loss: 11713512.3167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14402634.2729; train_optim_loss: 14402634.2729; val_kl_reg_loss: 42678.2019; val_edge_recon_loss: 2693266.0818; val_gene_expr_recon_loss: 11813101.8909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14549046.2000; val_optim_loss: 14549046.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9789; val_auprc_score: 0.9773; val_best_acc_score: 0.9294; val_best_f1_score: 0.9302; train_kl_reg_loss: 43573.2707; train_edge_recon_loss: 2645307.2138; train_gene_expr_recon_loss: 11699705.8758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14388586.3585; train_optim_loss: 14388586.3585; val_kl_reg_loss: 42363.3303; val_edge_recon_loss: 2688383.0864; val_gene_expr_recon_loss: 11782592.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14513339.3091; val_optim_loss: 14513339.3091
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9791; val_auprc_score: 0.9779; val_best_acc_score: 0.9289; val_best_f1_score: 0.9298; train_kl_reg_loss: 43341.2265; train_edge_recon_loss: 2642931.2072; train_gene_expr_recon_loss: 11687533.4481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14373805.8951; train_optim_loss: 14373805.8951; val_kl_reg_loss: 42403.4792; val_edge_recon_loss: 2694976.4500; val_gene_expr_recon_loss: 11781594.8273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14518974.7636; val_optim_loss: 14518974.7636
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9793; val_auprc_score: 0.9780; val_best_acc_score: 0.9292; val_best_f1_score: 0.9300; train_kl_reg_loss: 42895.8401; train_edge_recon_loss: 2642795.4178; train_gene_expr_recon_loss: 11681286.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14366978.0692; train_optim_loss: 14366978.0692; val_kl_reg_loss: 41261.0793; val_edge_recon_loss: 2695713.8182; val_gene_expr_recon_loss: 11798156.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14535131.3455; val_optim_loss: 14535131.3455
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9780; val_auprc_score: 0.9761; val_best_acc_score: 0.9279; val_best_f1_score: 0.9284; train_kl_reg_loss: 42740.7389; train_edge_recon_loss: 2640238.1260; train_gene_expr_recon_loss: 11671220.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14354199.2251; train_optim_loss: 14354199.2251; val_kl_reg_loss: 41380.7965; val_edge_recon_loss: 2693684.9500; val_gene_expr_recon_loss: 11766409.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14501475.6909; val_optim_loss: 14501475.6909
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9802; val_auprc_score: 0.9787; val_best_acc_score: 0.9316; val_best_f1_score: 0.9322; train_kl_reg_loss: 42298.5586; train_edge_recon_loss: 2640839.5670; train_gene_expr_recon_loss: 11668632.5092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14351770.6181; train_optim_loss: 14351770.6181; val_kl_reg_loss: 40651.2382; val_edge_recon_loss: 2688842.4886; val_gene_expr_recon_loss: 11760416.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14489910.4000; val_optim_loss: 14489910.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9800; val_auprc_score: 0.9788; val_best_acc_score: 0.9302; val_best_f1_score: 0.9309; train_kl_reg_loss: 41937.7816; train_edge_recon_loss: 2637921.7925; train_gene_expr_recon_loss: 11661837.7688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14341697.3574; train_optim_loss: 14341697.3574; val_kl_reg_loss: 40640.8011; val_edge_recon_loss: 2688031.1341; val_gene_expr_recon_loss: 11748728.9364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14477400.8909; val_optim_loss: 14477400.8909
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9796; val_auprc_score: 0.9782; val_best_acc_score: 0.9296; val_best_f1_score: 0.9304; train_kl_reg_loss: 41769.6126; train_edge_recon_loss: 2637479.4560; train_gene_expr_recon_loss: 11653941.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14333190.8615; train_optim_loss: 14333190.8615; val_kl_reg_loss: 40481.5601; val_edge_recon_loss: 2688692.0841; val_gene_expr_recon_loss: 11757663.1636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14486836.8545; val_optim_loss: 14486836.8545
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9800; val_auprc_score: 0.9786; val_best_acc_score: 0.9302; val_best_f1_score: 0.9310; train_kl_reg_loss: 41387.0767; train_edge_recon_loss: 2638314.6645; train_gene_expr_recon_loss: 11646865.2566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14326567.0061; train_optim_loss: 14326567.0061; val_kl_reg_loss: 40042.1722; val_edge_recon_loss: 2686832.2795; val_gene_expr_recon_loss: 11745915.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14472790.2000; val_optim_loss: 14472790.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9803; val_auprc_score: 0.9788; val_best_acc_score: 0.9312; val_best_f1_score: 0.9320; train_kl_reg_loss: 41198.4636; train_edge_recon_loss: 2636524.7184; train_gene_expr_recon_loss: 11642919.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14320642.6497; train_optim_loss: 14320642.6497; val_kl_reg_loss: 39943.0490; val_edge_recon_loss: 2686213.6000; val_gene_expr_recon_loss: 11747277.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14473434.2182; val_optim_loss: 14473434.2182
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9811; val_auprc_score: 0.9798; val_best_acc_score: 0.9326; val_best_f1_score: 0.9334; train_kl_reg_loss: 41010.3058; train_edge_recon_loss: 2635689.2564; train_gene_expr_recon_loss: 11637697.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14314396.6487; train_optim_loss: 14314396.6487; val_kl_reg_loss: 39388.4485; val_edge_recon_loss: 2685106.3477; val_gene_expr_recon_loss: 11722701.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14447196.4000; val_optim_loss: 14447196.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9795; val_auprc_score: 0.9780; val_best_acc_score: 0.9300; val_best_f1_score: 0.9311; train_kl_reg_loss: 40642.1033; train_edge_recon_loss: 2636117.6026; train_gene_expr_recon_loss: 11638288.6466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14315048.3544; train_optim_loss: 14315048.3544; val_kl_reg_loss: 39962.6267; val_edge_recon_loss: 2686708.2705; val_gene_expr_recon_loss: 11753445.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14480116.6818; val_optim_loss: 14480116.6818
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9807; val_auprc_score: 0.9794; val_best_acc_score: 0.9310; val_best_f1_score: 0.9318; train_kl_reg_loss: 40524.5017; train_edge_recon_loss: 2635224.5642; train_gene_expr_recon_loss: 11634525.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14310274.8147; train_optim_loss: 14310274.8147; val_kl_reg_loss: 39187.7879; val_edge_recon_loss: 2685682.3409; val_gene_expr_recon_loss: 11724308.1909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14449178.2909; val_optim_loss: 14449178.2909
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9805; val_auprc_score: 0.9787; val_best_acc_score: 0.9315; val_best_f1_score: 0.9321; train_kl_reg_loss: 40192.2004; train_edge_recon_loss: 2636249.0659; train_gene_expr_recon_loss: 11631839.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14308281.0092; train_optim_loss: 14308281.0092; val_kl_reg_loss: 38725.0744; val_edge_recon_loss: 2685405.5818; val_gene_expr_recon_loss: 11741060.8273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14465191.5091; val_optim_loss: 14465191.5091
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9807; val_auprc_score: 0.9795; val_best_acc_score: 0.9313; val_best_f1_score: 0.9321; train_kl_reg_loss: 40036.5373; train_edge_recon_loss: 2633708.0349; train_gene_expr_recon_loss: 11626738.8228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14300483.3859; train_optim_loss: 14300483.3859; val_kl_reg_loss: 38795.9019; val_edge_recon_loss: 2688434.6841; val_gene_expr_recon_loss: 11742367.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14469598.1091; val_optim_loss: 14469598.1091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9816; val_auprc_score: 0.9798; val_best_acc_score: 0.9338; val_best_f1_score: 0.9347; train_kl_reg_loss: 40724.7927; train_edge_recon_loss: 2633400.9819; train_gene_expr_recon_loss: 11533553.3595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14207679.1405; train_optim_loss: 14207679.1405; val_kl_reg_loss: 39834.2877; val_edge_recon_loss: 2679913.1182; val_gene_expr_recon_loss: 11648947.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14368694.9818; val_optim_loss: 14368694.9818
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9816; val_auprc_score: 0.9805; val_best_acc_score: 0.9339; val_best_f1_score: 0.9346; train_kl_reg_loss: 41084.1064; train_edge_recon_loss: 2630329.8241; train_gene_expr_recon_loss: 11525698.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14197112.2169; train_optim_loss: 14197112.2169; val_kl_reg_loss: 39773.8377; val_edge_recon_loss: 2682922.7364; val_gene_expr_recon_loss: 11648963.7182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14371660.2636; val_optim_loss: 14371660.2636
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9813; val_auprc_score: 0.9798; val_best_acc_score: 0.9332; val_best_f1_score: 0.9339; train_kl_reg_loss: 41099.3148; train_edge_recon_loss: 2632090.8760; train_gene_expr_recon_loss: 11525104.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14198294.3381; train_optim_loss: 14198294.3381; val_kl_reg_loss: 39884.8376; val_edge_recon_loss: 2682049.7432; val_gene_expr_recon_loss: 11649865.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14371800.0273; val_optim_loss: 14371800.0273
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9821; val_auprc_score: 0.9810; val_best_acc_score: 0.9339; val_best_f1_score: 0.9342; train_kl_reg_loss: 41159.1739; train_edge_recon_loss: 2630419.7408; train_gene_expr_recon_loss: 11520763.4287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14192342.3432; train_optim_loss: 14192342.3432; val_kl_reg_loss: 39949.8972; val_edge_recon_loss: 2679672.6545; val_gene_expr_recon_loss: 11662679.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14382301.9909; val_optim_loss: 14382301.9909
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9810; val_auprc_score: 0.9797; val_best_acc_score: 0.9329; val_best_f1_score: 0.9334; train_kl_reg_loss: 41046.4937; train_edge_recon_loss: 2631068.1881; train_gene_expr_recon_loss: 11523685.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14195800.2994; train_optim_loss: 14195800.2994; val_kl_reg_loss: 39881.1555; val_edge_recon_loss: 2683398.8750; val_gene_expr_recon_loss: 11641126.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14364406.0182; val_optim_loss: 14364406.0182
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9814; val_auprc_score: 0.9800; val_best_acc_score: 0.9327; val_best_f1_score: 0.9335; train_kl_reg_loss: 40997.0978; train_edge_recon_loss: 2629286.4384; train_gene_expr_recon_loss: 11522898.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14193181.6578; train_optim_loss: 14193181.6578; val_kl_reg_loss: 39718.9437; val_edge_recon_loss: 2684551.3841; val_gene_expr_recon_loss: 11640156.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14364426.9909; val_optim_loss: 14364426.9909
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9816; val_auprc_score: 0.9802; val_best_acc_score: 0.9336; val_best_f1_score: 0.9343; train_kl_reg_loss: 40830.8012; train_edge_recon_loss: 2629708.1408; train_gene_expr_recon_loss: 11522621.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14193159.9969; train_optim_loss: 14193159.9969; val_kl_reg_loss: 39589.8465; val_edge_recon_loss: 2682070.0182; val_gene_expr_recon_loss: 11654535.3091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14376195.1545; val_optim_loss: 14376195.1545
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9818; val_auprc_score: 0.9806; val_best_acc_score: 0.9337; val_best_f1_score: 0.9343; train_kl_reg_loss: 40752.3392; train_edge_recon_loss: 2630715.8152; train_gene_expr_recon_loss: 11520738.4073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14192206.5682; train_optim_loss: 14192206.5682; val_kl_reg_loss: 39463.0237; val_edge_recon_loss: 2681142.7841; val_gene_expr_recon_loss: 11638300.5364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14358906.3273; val_optim_loss: 14358906.3273
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9815; val_auprc_score: 0.9802; val_best_acc_score: 0.9339; val_best_f1_score: 0.9344; train_kl_reg_loss: 40657.3177; train_edge_recon_loss: 2630774.7686; train_gene_expr_recon_loss: 11521383.4145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14192815.5112; train_optim_loss: 14192815.5112; val_kl_reg_loss: 39552.9009; val_edge_recon_loss: 2681694.2932; val_gene_expr_recon_loss: 11653760.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14375007.2545; val_optim_loss: 14375007.2545
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9820; val_auprc_score: 0.9807; val_best_acc_score: 0.9344; val_best_f1_score: 0.9350; train_kl_reg_loss: 40599.1002; train_edge_recon_loss: 2629534.2566; train_gene_expr_recon_loss: 11520147.7862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14190281.1446; train_optim_loss: 14190281.1446; val_kl_reg_loss: 39261.4497; val_edge_recon_loss: 2680024.9705; val_gene_expr_recon_loss: 11638094.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14357380.6818; val_optim_loss: 14357380.6818
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9815; val_auprc_score: 0.9800; val_best_acc_score: 0.9336; val_best_f1_score: 0.9342; train_kl_reg_loss: 40535.4469; train_edge_recon_loss: 2630061.1067; train_gene_expr_recon_loss: 11517480.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14188077.1079; train_optim_loss: 14188077.1079; val_kl_reg_loss: 39264.3349; val_edge_recon_loss: 2682748.7523; val_gene_expr_recon_loss: 11644892.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14366905.6909; val_optim_loss: 14366905.6909
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9818; val_auprc_score: 0.9807; val_best_acc_score: 0.9334; val_best_f1_score: 0.9342; train_kl_reg_loss: 40398.4384; train_edge_recon_loss: 2629977.7039; train_gene_expr_recon_loss: 11515534.2403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14185910.3819; train_optim_loss: 14185910.3819; val_kl_reg_loss: 39302.3095; val_edge_recon_loss: 2682882.5523; val_gene_expr_recon_loss: 11646408.8364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14368593.7273; val_optim_loss: 14368593.7273
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9821; val_auprc_score: 0.9807; val_best_acc_score: 0.9343; val_best_f1_score: 0.9350; train_kl_reg_loss: 40331.9525; train_edge_recon_loss: 2629395.7368; train_gene_expr_recon_loss: 11520975.1334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14190702.8259; train_optim_loss: 14190702.8259; val_kl_reg_loss: 39187.7071; val_edge_recon_loss: 2680424.5818; val_gene_expr_recon_loss: 11651643.3909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14371255.6545; val_optim_loss: 14371255.6545
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9814; val_auprc_score: 0.9796; val_best_acc_score: 0.9337; val_best_f1_score: 0.9344; train_kl_reg_loss: 40227.2706; train_edge_recon_loss: 2630143.1785; train_gene_expr_recon_loss: 11520281.3442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14190651.7994; train_optim_loss: 14190651.7994; val_kl_reg_loss: 39073.2779; val_edge_recon_loss: 2681068.2773; val_gene_expr_recon_loss: 11640254.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14360396.4000; val_optim_loss: 14360396.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9819; val_auprc_score: 0.9803; val_best_acc_score: 0.9349; val_best_f1_score: 0.9355; train_kl_reg_loss: 40288.8051; train_edge_recon_loss: 2629008.4432; train_gene_expr_recon_loss: 11501471.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14170769.1161; train_optim_loss: 14170769.1161; val_kl_reg_loss: 39104.3575; val_edge_recon_loss: 2678574.3432; val_gene_expr_recon_loss: 11633591.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14351269.7091; val_optim_loss: 14351269.7091
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9820; val_auprc_score: 0.9806; val_best_acc_score: 0.9342; val_best_f1_score: 0.9348; train_kl_reg_loss: 40287.8686; train_edge_recon_loss: 2629810.2862; train_gene_expr_recon_loss: 11506808.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14176907.0112; train_optim_loss: 14176907.0112; val_kl_reg_loss: 39106.9498; val_edge_recon_loss: 2677497.3614; val_gene_expr_recon_loss: 11624540.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14341144.7273; val_optim_loss: 14341144.7273
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9813; val_auprc_score: 0.9799; val_best_acc_score: 0.9330; val_best_f1_score: 0.9336; train_kl_reg_loss: 40272.7025; train_edge_recon_loss: 2629618.5652; train_gene_expr_recon_loss: 11507011.5713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14176902.8320; train_optim_loss: 14176902.8320; val_kl_reg_loss: 39130.6556; val_edge_recon_loss: 2683991.3159; val_gene_expr_recon_loss: 11626111.8091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349233.7818; val_optim_loss: 14349233.7818
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9821; val_auprc_score: 0.9811; val_best_acc_score: 0.9342; val_best_f1_score: 0.9349; train_kl_reg_loss: 40265.6717; train_edge_recon_loss: 2628941.1077; train_gene_expr_recon_loss: 11499013.4878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14168220.2688; train_optim_loss: 14168220.2688; val_kl_reg_loss: 39169.7416; val_edge_recon_loss: 2678702.1477; val_gene_expr_recon_loss: 11636175.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14354047.8182; val_optim_loss: 14354047.8182
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9820; val_auprc_score: 0.9804; val_best_acc_score: 0.9351; val_best_f1_score: 0.9357; train_kl_reg_loss: 40276.6106; train_edge_recon_loss: 2629042.4677; train_gene_expr_recon_loss: 11497819.4572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167138.5336; train_optim_loss: 14167138.5336; val_kl_reg_loss: 39109.6977; val_edge_recon_loss: 2676034.8227; val_gene_expr_recon_loss: 11627583.5818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14342728.0545; val_optim_loss: 14342728.0545
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9819; val_auprc_score: 0.9807; val_best_acc_score: 0.9344; val_best_f1_score: 0.9350; train_kl_reg_loss: 40283.1666; train_edge_recon_loss: 2629048.7133; train_gene_expr_recon_loss: 11498499.2831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167831.1731; train_optim_loss: 14167831.1731; val_kl_reg_loss: 39129.3354; val_edge_recon_loss: 2681159.8568; val_gene_expr_recon_loss: 11630265.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14350554.5909; val_optim_loss: 14350554.5909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9819; val_auprc_score: 0.9803; val_best_acc_score: 0.9343; val_best_f1_score: 0.9350; train_kl_reg_loss: 40274.1776; train_edge_recon_loss: 2628658.6011; train_gene_expr_recon_loss: 11498132.5051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167065.2892; train_optim_loss: 14167065.2892; val_kl_reg_loss: 39148.4873; val_edge_recon_loss: 2680847.5227; val_gene_expr_recon_loss: 11621050.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14341046.9091; val_optim_loss: 14341046.9091
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9822; val_auprc_score: 0.9810; val_best_acc_score: 0.9348; val_best_f1_score: 0.9354; train_kl_reg_loss: 40291.1149; train_edge_recon_loss: 2629813.9738; train_gene_expr_recon_loss: 11499614.3452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14169719.4491; train_optim_loss: 14169719.4491; val_kl_reg_loss: 39158.7195; val_edge_recon_loss: 2681457.4659; val_gene_expr_recon_loss: 11624924.2909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14345540.4455; val_optim_loss: 14345540.4455
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9818; val_auprc_score: 0.9804; val_best_acc_score: 0.9345; val_best_f1_score: 0.9348; train_kl_reg_loss: 40272.6457; train_edge_recon_loss: 2628273.2279; train_gene_expr_recon_loss: 11502456.8819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14171002.7668; train_optim_loss: 14171002.7668; val_kl_reg_loss: 39163.0495; val_edge_recon_loss: 2681049.1386; val_gene_expr_recon_loss: 11625368.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14345580.4364; val_optim_loss: 14345580.4364
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9815; val_auprc_score: 0.9802; val_best_acc_score: 0.9334; val_best_f1_score: 0.9342; train_kl_reg_loss: 40285.6874; train_edge_recon_loss: 2628874.1874; train_gene_expr_recon_loss: 11496442.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14165601.8605; train_optim_loss: 14165601.8605; val_kl_reg_loss: 39176.4638; val_edge_recon_loss: 2686204.9273; val_gene_expr_recon_loss: 11624603.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349985.2182; val_optim_loss: 14349985.2182
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9819; val_auprc_score: 0.9805; val_best_acc_score: 0.9348; val_best_f1_score: 0.9356; train_kl_reg_loss: 40290.6620; train_edge_recon_loss: 2629493.6861; train_gene_expr_recon_loss: 11500500.4409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14170284.7872; train_optim_loss: 14170284.7872; val_kl_reg_loss: 39148.0286; val_edge_recon_loss: 2679790.0091; val_gene_expr_recon_loss: 11629224.7545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14348162.8000; val_optim_loss: 14348162.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9823; val_auprc_score: 0.9811; val_best_acc_score: 0.9344; val_best_f1_score: 0.9351; train_kl_reg_loss: 40285.7517; train_edge_recon_loss: 2629358.9198; train_gene_expr_recon_loss: 11493543.0845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14163187.7709; train_optim_loss: 14163187.7709; val_kl_reg_loss: 39138.0462; val_edge_recon_loss: 2677173.6795; val_gene_expr_recon_loss: 11622239.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14338550.9818; val_optim_loss: 14338550.9818
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9819; val_auprc_score: 0.9806; val_best_acc_score: 0.9344; val_best_f1_score: 0.9351; train_kl_reg_loss: 40281.9344; train_edge_recon_loss: 2629212.5084; train_gene_expr_recon_loss: 11499836.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14169331.0071; train_optim_loss: 14169331.0071; val_kl_reg_loss: 39169.2637; val_edge_recon_loss: 2679038.8386; val_gene_expr_recon_loss: 11624530.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14342738.6273; val_optim_loss: 14342738.6273
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9819; val_auprc_score: 0.9805; val_best_acc_score: 0.9342; val_best_f1_score: 0.9347; train_kl_reg_loss: 40283.0107; train_edge_recon_loss: 2630031.2133; train_gene_expr_recon_loss: 11499923.4134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14170237.6405; train_optim_loss: 14170237.6405; val_kl_reg_loss: 39156.2013; val_edge_recon_loss: 2686709.1750; val_gene_expr_recon_loss: 11617704.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14343569.7727; val_optim_loss: 14343569.7727
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9818; val_auprc_score: 0.9803; val_best_acc_score: 0.9339; val_best_f1_score: 0.9347; train_kl_reg_loss: 40282.1240; train_edge_recon_loss: 2629668.1785; train_gene_expr_recon_loss: 11495374.1365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14165324.4358; train_optim_loss: 14165324.4358; val_kl_reg_loss: 39129.1715; val_edge_recon_loss: 2682269.2250; val_gene_expr_recon_loss: 11615772.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14337171.2545; val_optim_loss: 14337171.2545
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9815; val_auprc_score: 0.9802; val_best_acc_score: 0.9337; val_best_f1_score: 0.9344; train_kl_reg_loss: 40304.1130; train_edge_recon_loss: 2630662.9282; train_gene_expr_recon_loss: 11505956.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14176923.8411; train_optim_loss: 14176923.8411; val_kl_reg_loss: 39123.0446; val_edge_recon_loss: 2684834.0273; val_gene_expr_recon_loss: 11630920.0364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14354877.0455; val_optim_loss: 14354877.0455
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9820; val_auprc_score: 0.9805; val_best_acc_score: 0.9349; val_best_f1_score: 0.9351; train_kl_reg_loss: 40280.7104; train_edge_recon_loss: 2628098.7426; train_gene_expr_recon_loss: 11497794.4623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14166173.9257; train_optim_loss: 14166173.9257; val_kl_reg_loss: 39128.7212; val_edge_recon_loss: 2680552.3705; val_gene_expr_recon_loss: 11630131.1091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349812.2091; val_optim_loss: 14349812.2091
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9821; val_auprc_score: 0.9809; val_best_acc_score: 0.9348; val_best_f1_score: 0.9354; train_kl_reg_loss: 40291.3709; train_edge_recon_loss: 2629846.6527; train_gene_expr_recon_loss: 11501340.2322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14171478.2475; train_optim_loss: 14171478.2475; val_kl_reg_loss: 39130.8208; val_edge_recon_loss: 2682167.5841; val_gene_expr_recon_loss: 11625585.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14346883.9000; val_optim_loss: 14346883.9000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9822; val_auprc_score: 0.9806; val_best_acc_score: 0.9349; val_best_f1_score: 0.9353; train_kl_reg_loss: 40271.1948; train_edge_recon_loss: 2626778.9913; train_gene_expr_recon_loss: 11495292.4684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14162342.6690; train_optim_loss: 14162342.6690; val_kl_reg_loss: 39137.2178; val_edge_recon_loss: 2678500.0977; val_gene_expr_recon_loss: 11631860.3364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349497.6909; val_optim_loss: 14349497.6909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9819; val_auprc_score: 0.9806; val_best_acc_score: 0.9343; val_best_f1_score: 0.9349; train_kl_reg_loss: 40296.1056; train_edge_recon_loss: 2629264.8567; train_gene_expr_recon_loss: 11497188.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14166749.7230; train_optim_loss: 14166749.7230; val_kl_reg_loss: 39145.2437; val_edge_recon_loss: 2680788.8114; val_gene_expr_recon_loss: 11629710.0727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349644.1636; val_optim_loss: 14349644.1636
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9817; val_auprc_score: 0.9805; val_best_acc_score: 0.9339; val_best_f1_score: 0.9346; train_kl_reg_loss: 40285.4638; train_edge_recon_loss: 2630063.9519; train_gene_expr_recon_loss: 11497681.5540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14168030.9654; train_optim_loss: 14168030.9654; val_kl_reg_loss: 39173.2604; val_edge_recon_loss: 2681047.4773; val_gene_expr_recon_loss: 11636329.6182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14356550.3545; val_optim_loss: 14356550.3545
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9819; val_auprc_score: 0.9806; val_best_acc_score: 0.9342; val_best_f1_score: 0.9349; train_kl_reg_loss: 40278.0536; train_edge_recon_loss: 2628735.2286; train_gene_expr_recon_loss: 11498199.9155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167213.1945; train_optim_loss: 14167213.1945; val_kl_reg_loss: 39133.6786; val_edge_recon_loss: 2682172.8114; val_gene_expr_recon_loss: 11624729.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14346035.7636; val_optim_loss: 14346035.7636
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9818; val_auprc_score: 0.9803; val_best_acc_score: 0.9334; val_best_f1_score: 0.9341; train_kl_reg_loss: 40286.5704; train_edge_recon_loss: 2627806.7660; train_gene_expr_recon_loss: 11498118.6690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14166212.0153; train_optim_loss: 14166212.0153; val_kl_reg_loss: 39132.3048; val_edge_recon_loss: 2680591.4068; val_gene_expr_recon_loss: 11623259.5636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14342983.2818; val_optim_loss: 14342983.2818

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 191 min 7 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
Val AUROC score: 0.9817
Val AUPRC score: 0.9802
Val best accuracy score: 0.9342
Val best F1 score: 0.9350
Val gene expr MSE score: 8.2877

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
