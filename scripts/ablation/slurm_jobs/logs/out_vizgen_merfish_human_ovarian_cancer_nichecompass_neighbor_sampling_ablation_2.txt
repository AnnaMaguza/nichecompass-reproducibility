None
Run timestamp: 12072023_184557_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9873; val_auprc_score: 0.9871; val_best_acc_score: 0.9429; val_best_f1_score: 0.9433; train_kl_reg_loss: 9050.5422; train_edge_recon_loss: 271573.6699; train_gene_expr_recon_loss: 146105.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426729.2898; train_optim_loss: 426729.2898; val_kl_reg_loss: 7895.3550; val_edge_recon_loss: 267470.3097; val_gene_expr_recon_loss: 134527.8610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409893.5263; val_optim_loss: 409893.5263
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9912; val_best_acc_score: 0.9546; val_best_f1_score: 0.9546; train_kl_reg_loss: 7745.3597; train_edge_recon_loss: 264423.9839; train_gene_expr_recon_loss: 132186.6322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404355.9760; train_optim_loss: 404355.9760; val_kl_reg_loss: 7381.5385; val_edge_recon_loss: 265342.9739; val_gene_expr_recon_loss: 129660.7694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402385.2798; val_optim_loss: 402385.2798
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9923; val_auprc_score: 0.9921; val_best_acc_score: 0.9572; val_best_f1_score: 0.9572; train_kl_reg_loss: 7313.5874; train_edge_recon_loss: 262991.9915; train_gene_expr_recon_loss: 129133.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399439.4216; train_optim_loss: 399439.4216; val_kl_reg_loss: 7072.3733; val_edge_recon_loss: 264124.2088; val_gene_expr_recon_loss: 128293.5235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399490.1050; val_optim_loss: 399490.1050
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9934; val_auprc_score: 0.9930; val_best_acc_score: 0.9606; val_best_f1_score: 0.9608; train_kl_reg_loss: 7124.8453; train_edge_recon_loss: 262182.3742; train_gene_expr_recon_loss: 127693.4867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397000.7064; train_optim_loss: 397000.7064; val_kl_reg_loss: 6910.5713; val_edge_recon_loss: 263512.1526; val_gene_expr_recon_loss: 126951.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397374.3163; val_optim_loss: 397374.3163
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9940; val_auprc_score: 0.9937; val_best_acc_score: 0.9626; val_best_f1_score: 0.9627; train_kl_reg_loss: 7003.8616; train_edge_recon_loss: 261719.7319; train_gene_expr_recon_loss: 126880.6335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395604.2269; train_optim_loss: 395604.2269; val_kl_reg_loss: 6784.7633; val_edge_recon_loss: 263400.2479; val_gene_expr_recon_loss: 126478.2858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396663.2967; val_optim_loss: 396663.2967
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9939; val_best_acc_score: 0.9639; val_best_f1_score: 0.9641; train_kl_reg_loss: 6946.0939; train_edge_recon_loss: 261310.2766; train_gene_expr_recon_loss: 126335.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394591.4512; train_optim_loss: 394591.4512; val_kl_reg_loss: 6838.7698; val_edge_recon_loss: 262778.2498; val_gene_expr_recon_loss: 125978.4051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395595.4246; val_optim_loss: 395595.4246
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9942; val_best_acc_score: 0.9656; val_best_f1_score: 0.9659; train_kl_reg_loss: 6912.2256; train_edge_recon_loss: 261070.7044; train_gene_expr_recon_loss: 125909.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393892.7993; train_optim_loss: 393892.7993; val_kl_reg_loss: 6846.2206; val_edge_recon_loss: 262636.9636; val_gene_expr_recon_loss: 125656.8980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395140.0814; val_optim_loss: 395140.0814
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9947; val_auprc_score: 0.9944; val_best_acc_score: 0.9653; val_best_f1_score: 0.9655; train_kl_reg_loss: 6896.7133; train_edge_recon_loss: 260779.5924; train_gene_expr_recon_loss: 125597.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393274.1845; train_optim_loss: 393274.1845; val_kl_reg_loss: 6852.0938; val_edge_recon_loss: 262499.8049; val_gene_expr_recon_loss: 125439.1927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394791.0911; val_optim_loss: 394791.0911
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9948; val_auprc_score: 0.9946; val_best_acc_score: 0.9665; val_best_f1_score: 0.9666; train_kl_reg_loss: 6876.2284; train_edge_recon_loss: 260638.9811; train_gene_expr_recon_loss: 125367.4745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392882.6837; train_optim_loss: 392882.6837; val_kl_reg_loss: 6730.6499; val_edge_recon_loss: 262130.6649; val_gene_expr_recon_loss: 125207.5509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394068.8659; val_optim_loss: 394068.8659
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9953; val_auprc_score: 0.9950; val_best_acc_score: 0.9674; val_best_f1_score: 0.9676; train_kl_reg_loss: 6864.1690; train_edge_recon_loss: 260576.6659; train_gene_expr_recon_loss: 125130.2978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392571.1324; train_optim_loss: 392571.1324; val_kl_reg_loss: 6837.1035; val_edge_recon_loss: 262090.3706; val_gene_expr_recon_loss: 125032.2251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393959.6995; val_optim_loss: 393959.6995
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9945; val_best_acc_score: 0.9675; val_best_f1_score: 0.9676; train_kl_reg_loss: 6852.5258; train_edge_recon_loss: 260460.9032; train_gene_expr_recon_loss: 124977.9183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392291.3475; train_optim_loss: 392291.3475; val_kl_reg_loss: 6720.7714; val_edge_recon_loss: 261970.7573; val_gene_expr_recon_loss: 124894.3027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393585.8297; val_optim_loss: 393585.8297
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9954; val_auprc_score: 0.9950; val_best_acc_score: 0.9693; val_best_f1_score: 0.9695; train_kl_reg_loss: 6843.5253; train_edge_recon_loss: 260422.2878; train_gene_expr_recon_loss: 124855.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392121.4010; train_optim_loss: 392121.4010; val_kl_reg_loss: 6808.8580; val_edge_recon_loss: 261933.8230; val_gene_expr_recon_loss: 124715.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393457.7521; val_optim_loss: 393457.7521
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9954; val_auprc_score: 0.9950; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 6845.0505; train_edge_recon_loss: 260274.8805; train_gene_expr_recon_loss: 124712.1262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391832.0569; train_optim_loss: 391832.0569; val_kl_reg_loss: 6679.9711; val_edge_recon_loss: 261764.6606; val_gene_expr_recon_loss: 124562.5399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393007.1724; val_optim_loss: 393007.1724
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9948; val_best_acc_score: 0.9686; val_best_f1_score: 0.9688; train_kl_reg_loss: 6841.0961; train_edge_recon_loss: 260253.2217; train_gene_expr_recon_loss: 124628.9072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391723.2251; train_optim_loss: 391723.2251; val_kl_reg_loss: 6740.1957; val_edge_recon_loss: 261731.8897; val_gene_expr_recon_loss: 124526.1119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392998.1963; val_optim_loss: 392998.1963
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9954; val_auprc_score: 0.9951; val_best_acc_score: 0.9694; val_best_f1_score: 0.9696; train_kl_reg_loss: 6833.0007; train_edge_recon_loss: 260214.3296; train_gene_expr_recon_loss: 124570.8415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391618.1724; train_optim_loss: 391618.1724; val_kl_reg_loss: 6885.4574; val_edge_recon_loss: 261644.1440; val_gene_expr_recon_loss: 124430.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392960.3297; val_optim_loss: 392960.3297
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9702; val_best_f1_score: 0.9703; train_kl_reg_loss: 6824.6195; train_edge_recon_loss: 260065.2879; train_gene_expr_recon_loss: 124506.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391396.0251; train_optim_loss: 391396.0251; val_kl_reg_loss: 6770.0802; val_edge_recon_loss: 261728.4776; val_gene_expr_recon_loss: 124417.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392915.7384; val_optim_loss: 392915.7384
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9955; val_auprc_score: 0.9951; val_best_acc_score: 0.9693; val_best_f1_score: 0.9694; train_kl_reg_loss: 6822.4046; train_edge_recon_loss: 260025.2466; train_gene_expr_recon_loss: 124399.2328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391246.8837; train_optim_loss: 391246.8837; val_kl_reg_loss: 6788.7793; val_edge_recon_loss: 261596.2003; val_gene_expr_recon_loss: 124433.4683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392818.4481; val_optim_loss: 392818.4481
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9700; val_best_f1_score: 0.9701; train_kl_reg_loss: 6816.5627; train_edge_recon_loss: 259984.7006; train_gene_expr_recon_loss: 124350.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391151.7858; train_optim_loss: 391151.7858; val_kl_reg_loss: 6774.5568; val_edge_recon_loss: 261480.6261; val_gene_expr_recon_loss: 124222.7124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392477.8938; val_optim_loss: 392477.8938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9950; val_best_acc_score: 0.9697; val_best_f1_score: 0.9697; train_kl_reg_loss: 6819.7597; train_edge_recon_loss: 259915.4692; train_gene_expr_recon_loss: 124273.7401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391008.9694; train_optim_loss: 391008.9694; val_kl_reg_loss: 6799.0996; val_edge_recon_loss: 261591.6507; val_gene_expr_recon_loss: 124300.4124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392691.1623; val_optim_loss: 392691.1623
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9954; val_auprc_score: 0.9951; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 6818.4961; train_edge_recon_loss: 259824.5313; train_gene_expr_recon_loss: 124257.0056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390900.0328; train_optim_loss: 390900.0328; val_kl_reg_loss: 6847.2655; val_edge_recon_loss: 261517.5757; val_gene_expr_recon_loss: 124135.8990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392500.7406; val_optim_loss: 392500.7406
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9951; val_best_acc_score: 0.9709; val_best_f1_score: 0.9711; train_kl_reg_loss: 6814.6849; train_edge_recon_loss: 259857.3470; train_gene_expr_recon_loss: 124178.0507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390850.0829; train_optim_loss: 390850.0829; val_kl_reg_loss: 6770.6313; val_edge_recon_loss: 261451.0598; val_gene_expr_recon_loss: 124472.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392694.0971; val_optim_loss: 392694.0971
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9956; val_auprc_score: 0.9953; val_best_acc_score: 0.9707; val_best_f1_score: 0.9707; train_kl_reg_loss: 6812.1791; train_edge_recon_loss: 259779.9719; train_gene_expr_recon_loss: 124208.7843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390800.9353; train_optim_loss: 390800.9353; val_kl_reg_loss: 6718.6268; val_edge_recon_loss: 261478.4223; val_gene_expr_recon_loss: 124298.9152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392495.9655; val_optim_loss: 392495.9655

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9961; val_auprc_score: 0.9957; val_best_acc_score: 0.9719; val_best_f1_score: 0.9719; train_kl_reg_loss: 6832.5993; train_edge_recon_loss: 259482.6354; train_gene_expr_recon_loss: 123156.0931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389471.3277; train_optim_loss: 389471.3277; val_kl_reg_loss: 6788.1101; val_edge_recon_loss: 261126.0724; val_gene_expr_recon_loss: 123192.4438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391106.6253; val_optim_loss: 391106.6253
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 6828.0211; train_edge_recon_loss: 259456.8973; train_gene_expr_recon_loss: 122914.7307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389199.6489; train_optim_loss: 389199.6489; val_kl_reg_loss: 6759.3991; val_edge_recon_loss: 260963.9886; val_gene_expr_recon_loss: 123131.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390855.1452; val_optim_loss: 390855.1452
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 6822.5121; train_edge_recon_loss: 259428.8126; train_gene_expr_recon_loss: 122871.4921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389122.8172; train_optim_loss: 389122.8172; val_kl_reg_loss: 6756.6585; val_edge_recon_loss: 260859.1612; val_gene_expr_recon_loss: 123089.5763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390705.3964; val_optim_loss: 390705.3964
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 6814.8369; train_edge_recon_loss: 259428.4722; train_gene_expr_recon_loss: 122785.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389028.7375; train_optim_loss: 389028.7375; val_kl_reg_loss: 6735.6530; val_edge_recon_loss: 260955.2763; val_gene_expr_recon_loss: 122996.3732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390687.3013; val_optim_loss: 390687.3013
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9963; val_auprc_score: 0.9960; val_best_acc_score: 0.9731; val_best_f1_score: 0.9733; train_kl_reg_loss: 6810.7255; train_edge_recon_loss: 259352.3364; train_gene_expr_recon_loss: 122720.6480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388883.7099; train_optim_loss: 388883.7099; val_kl_reg_loss: 6740.2695; val_edge_recon_loss: 260923.3971; val_gene_expr_recon_loss: 122856.0920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390519.7581; val_optim_loss: 390519.7581
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 6802.3057; train_edge_recon_loss: 259437.0110; train_gene_expr_recon_loss: 122728.4335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388967.7502; train_optim_loss: 388967.7502; val_kl_reg_loss: 6744.6107; val_edge_recon_loss: 260862.5707; val_gene_expr_recon_loss: 122825.7899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390432.9720; val_optim_loss: 390432.9720
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9964; val_auprc_score: 0.9959; val_best_acc_score: 0.9735; val_best_f1_score: 0.9736; train_kl_reg_loss: 6801.3070; train_edge_recon_loss: 259368.8562; train_gene_expr_recon_loss: 122689.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388859.1842; train_optim_loss: 388859.1842; val_kl_reg_loss: 6742.1697; val_edge_recon_loss: 261092.5952; val_gene_expr_recon_loss: 122822.8304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390657.5957; val_optim_loss: 390657.5957
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 6793.0822; train_edge_recon_loss: 259418.4902; train_gene_expr_recon_loss: 122666.7561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388878.3285; train_optim_loss: 388878.3285; val_kl_reg_loss: 6758.0969; val_edge_recon_loss: 260601.3734; val_gene_expr_recon_loss: 122781.7133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390141.1841; val_optim_loss: 390141.1841
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 6792.3533; train_edge_recon_loss: 259358.9944; train_gene_expr_recon_loss: 122615.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388766.8632; train_optim_loss: 388766.8632; val_kl_reg_loss: 6751.7897; val_edge_recon_loss: 260664.9729; val_gene_expr_recon_loss: 122776.7094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390193.4718; val_optim_loss: 390193.4718
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9730; val_best_f1_score: 0.9731; train_kl_reg_loss: 6789.6082; train_edge_recon_loss: 259381.1465; train_gene_expr_recon_loss: 122622.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388792.8376; train_optim_loss: 388792.8376; val_kl_reg_loss: 6743.2157; val_edge_recon_loss: 261055.9434; val_gene_expr_recon_loss: 122702.0456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390501.2042; val_optim_loss: 390501.2042
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 6788.9176; train_edge_recon_loss: 259309.9721; train_gene_expr_recon_loss: 122590.4499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388689.3400; train_optim_loss: 388689.3400; val_kl_reg_loss: 6753.5261; val_edge_recon_loss: 260835.6278; val_gene_expr_recon_loss: 122749.7351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390338.8889; val_optim_loss: 390338.8889
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 6786.4078; train_edge_recon_loss: 259318.9026; train_gene_expr_recon_loss: 122597.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388702.8958; train_optim_loss: 388702.8958; val_kl_reg_loss: 6725.9560; val_edge_recon_loss: 260910.1562; val_gene_expr_recon_loss: 122771.5529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390407.6653; val_optim_loss: 390407.6653

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 6785.4597; train_edge_recon_loss: 259250.4179; train_gene_expr_recon_loss: 122445.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388481.0986; train_optim_loss: 388481.0986; val_kl_reg_loss: 6728.1511; val_edge_recon_loss: 260804.7171; val_gene_expr_recon_loss: 122506.6395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390039.5075; val_optim_loss: 390039.5075
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 6780.6408; train_edge_recon_loss: 259288.8600; train_gene_expr_recon_loss: 122429.6877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388499.1883; train_optim_loss: 388499.1883; val_kl_reg_loss: 6721.0948; val_edge_recon_loss: 260720.1466; val_gene_expr_recon_loss: 122583.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390024.3106; val_optim_loss: 390024.3106
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 6779.9825; train_edge_recon_loss: 259305.0792; train_gene_expr_recon_loss: 122425.7142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388510.7765; train_optim_loss: 388510.7765; val_kl_reg_loss: 6725.0708; val_edge_recon_loss: 260939.5611; val_gene_expr_recon_loss: 122707.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390372.0037; val_optim_loss: 390372.0037
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9965; val_auprc_score: 0.9963; val_best_acc_score: 0.9738; val_best_f1_score: 0.9738; train_kl_reg_loss: 6780.5263; train_edge_recon_loss: 259330.4170; train_gene_expr_recon_loss: 122441.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388552.1478; train_optim_loss: 388552.1478; val_kl_reg_loss: 6715.5360; val_edge_recon_loss: 260821.8927; val_gene_expr_recon_loss: 122593.8336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390131.2610; val_optim_loss: 390131.2610
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9736; val_best_f1_score: 0.9737; train_kl_reg_loss: 6778.0075; train_edge_recon_loss: 259234.7763; train_gene_expr_recon_loss: 122448.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388461.7672; train_optim_loss: 388461.7672; val_kl_reg_loss: 6712.5840; val_edge_recon_loss: 260691.2314; val_gene_expr_recon_loss: 122751.4389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390155.2529; val_optim_loss: 390155.2529
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 6778.8771; train_edge_recon_loss: 259265.1407; train_gene_expr_recon_loss: 122406.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388450.7964; train_optim_loss: 388450.7964; val_kl_reg_loss: 6716.0737; val_edge_recon_loss: 260738.6652; val_gene_expr_recon_loss: 122643.7460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390098.4864; val_optim_loss: 390098.4864

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 6777.7947; train_edge_recon_loss: 259237.4121; train_gene_expr_recon_loss: 122408.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388424.0543; train_optim_loss: 388424.0543; val_kl_reg_loss: 6717.6327; val_edge_recon_loss: 260706.7471; val_gene_expr_recon_loss: 122512.6317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389937.0131; val_optim_loss: 389937.0131
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 6777.8252; train_edge_recon_loss: 259276.1808; train_gene_expr_recon_loss: 122363.4269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388417.4329; train_optim_loss: 388417.4329; val_kl_reg_loss: 6717.9684; val_edge_recon_loss: 260909.9257; val_gene_expr_recon_loss: 122656.1219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390284.0163; val_optim_loss: 390284.0163
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9742; val_best_f1_score: 0.9743; train_kl_reg_loss: 6777.1146; train_edge_recon_loss: 259239.6967; train_gene_expr_recon_loss: 122395.9291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388412.7408; train_optim_loss: 388412.7408; val_kl_reg_loss: 6718.5054; val_edge_recon_loss: 260764.6488; val_gene_expr_recon_loss: 122586.1547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390069.3102; val_optim_loss: 390069.3102
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9737; val_best_f1_score: 0.9738; train_kl_reg_loss: 6777.4054; train_edge_recon_loss: 259276.5019; train_gene_expr_recon_loss: 122420.2464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388474.1542; train_optim_loss: 388474.1542; val_kl_reg_loss: 6717.1905; val_edge_recon_loss: 260707.3530; val_gene_expr_recon_loss: 122671.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390096.3985; val_optim_loss: 390096.3985
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9739; val_best_f1_score: 0.9741; train_kl_reg_loss: 6776.9664; train_edge_recon_loss: 259261.6184; train_gene_expr_recon_loss: 122407.9496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388446.5341; train_optim_loss: 388446.5341; val_kl_reg_loss: 6719.6193; val_edge_recon_loss: 260929.7643; val_gene_expr_recon_loss: 122708.9689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390358.3493; val_optim_loss: 390358.3493

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9966; val_auprc_score: 0.9963; val_best_acc_score: 0.9742; val_best_f1_score: 0.9742; train_kl_reg_loss: 6778.5576; train_edge_recon_loss: 259258.5065; train_gene_expr_recon_loss: 122370.5060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388407.5701; train_optim_loss: 388407.5701; val_kl_reg_loss: 6719.9722; val_edge_recon_loss: 260760.8458; val_gene_expr_recon_loss: 122532.2574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390013.0738; val_optim_loss: 390013.0738
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9965; val_auprc_score: 0.9962; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 6776.2696; train_edge_recon_loss: 259303.1602; train_gene_expr_recon_loss: 122372.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388451.5434; train_optim_loss: 388451.5434; val_kl_reg_loss: 6721.3267; val_edge_recon_loss: 260823.7372; val_gene_expr_recon_loss: 122612.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390157.3398; val_optim_loss: 390157.3398
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9964; val_auprc_score: 0.9960; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 6777.6758; train_edge_recon_loss: 259281.3118; train_gene_expr_recon_loss: 122424.4840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388483.4716; train_optim_loss: 388483.4716; val_kl_reg_loss: 6720.4813; val_edge_recon_loss: 260939.7094; val_gene_expr_recon_loss: 122683.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390344.1043; val_optim_loss: 390344.1043
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 6776.8955; train_edge_recon_loss: 259217.7432; train_gene_expr_recon_loss: 122378.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388372.8623; train_optim_loss: 388372.8623; val_kl_reg_loss: 6718.5877; val_edge_recon_loss: 260749.2838; val_gene_expr_recon_loss: 122650.7259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390118.5982; val_optim_loss: 390118.5982

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 365 min 32 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9964
Val AUPRC score: 0.9961
Val best accuracy score: 0.9736
Val best F1 score: 0.9737
Val gene expr MSE score: 9.3703

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
