None
Run timestamp: 04082023_212853_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'neighbor_sampling_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9734; val_auprc_score: 0.9722; val_best_acc_score: 0.9169; val_best_f1_score: 0.9181; train_kl_reg_loss: 8769.0450; train_edge_recon_loss: 276147.6079; train_gene_expr_recon_loss: 215719.2036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 500635.8560; train_optim_loss: 500635.8560; val_kl_reg_loss: 8260.3273; val_edge_recon_loss: 271290.4037; val_gene_expr_recon_loss: 197376.3446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 476927.0759; val_optim_loss: 476927.0759
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9794; val_auprc_score: 0.9781; val_best_acc_score: 0.9282; val_best_f1_score: 0.9292; train_kl_reg_loss: 8183.5101; train_edge_recon_loss: 265909.4961; train_gene_expr_recon_loss: 189761.4098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 463854.4155; train_optim_loss: 463854.4155; val_kl_reg_loss: 7733.7161; val_edge_recon_loss: 269479.3793; val_gene_expr_recon_loss: 185395.1119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 462608.2051; val_optim_loss: 462608.2051
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9814; val_auprc_score: 0.9802; val_best_acc_score: 0.9324; val_best_f1_score: 0.9328; train_kl_reg_loss: 7742.3489; train_edge_recon_loss: 264676.3362; train_gene_expr_recon_loss: 181108.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 453527.5747; train_optim_loss: 453527.5747; val_kl_reg_loss: 7473.0387; val_edge_recon_loss: 268707.6408; val_gene_expr_recon_loss: 178738.1955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454918.8744; val_optim_loss: 454918.8744
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9832; val_auprc_score: 0.9825; val_best_acc_score: 0.9363; val_best_f1_score: 0.9367; train_kl_reg_loss: 7526.1256; train_edge_recon_loss: 263805.8707; train_gene_expr_recon_loss: 176481.2043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447813.2001; train_optim_loss: 447813.2001; val_kl_reg_loss: 7098.8100; val_edge_recon_loss: 268018.7321; val_gene_expr_recon_loss: 175825.7381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450943.2810; val_optim_loss: 450943.2810
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9836; val_auprc_score: 0.9825; val_best_acc_score: 0.9377; val_best_f1_score: 0.9381; train_kl_reg_loss: 7407.9414; train_edge_recon_loss: 263169.5936; train_gene_expr_recon_loss: 173668.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444245.6337; train_optim_loss: 444245.6337; val_kl_reg_loss: 7227.5571; val_edge_recon_loss: 267540.6560; val_gene_expr_recon_loss: 173566.1575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448334.3682; val_optim_loss: 448334.3682
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9846; val_auprc_score: 0.9838; val_best_acc_score: 0.9407; val_best_f1_score: 0.9408; train_kl_reg_loss: 7327.2600; train_edge_recon_loss: 262784.5047; train_gene_expr_recon_loss: 171846.5390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441958.3036; train_optim_loss: 441958.3036; val_kl_reg_loss: 7123.7179; val_edge_recon_loss: 267375.3807; val_gene_expr_recon_loss: 171964.2641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446463.3608; val_optim_loss: 446463.3608
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9852; val_auprc_score: 0.9843; val_best_acc_score: 0.9411; val_best_f1_score: 0.9417; train_kl_reg_loss: 7271.1433; train_edge_recon_loss: 262492.4965; train_gene_expr_recon_loss: 170649.7185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440413.3588; train_optim_loss: 440413.3588; val_kl_reg_loss: 7079.9725; val_edge_recon_loss: 267192.3247; val_gene_expr_recon_loss: 170782.9438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445055.2423; val_optim_loss: 445055.2423
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9854; val_auprc_score: 0.9846; val_best_acc_score: 0.9419; val_best_f1_score: 0.9423; train_kl_reg_loss: 7245.1788; train_edge_recon_loss: 262225.9452; train_gene_expr_recon_loss: 169709.9756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 439181.0996; train_optim_loss: 439181.0996; val_kl_reg_loss: 7075.5402; val_edge_recon_loss: 266840.3624; val_gene_expr_recon_loss: 170020.7983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443936.7011; val_optim_loss: 443936.7011
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9857; val_auprc_score: 0.9846; val_best_acc_score: 0.9422; val_best_f1_score: 0.9425; train_kl_reg_loss: 7215.9103; train_edge_recon_loss: 261993.6440; train_gene_expr_recon_loss: 169074.2602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 438283.8145; train_optim_loss: 438283.8145; val_kl_reg_loss: 7052.6496; val_edge_recon_loss: 267002.6585; val_gene_expr_recon_loss: 169646.1986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 443701.5057; val_optim_loss: 443701.5057
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9859; val_auprc_score: 0.9850; val_best_acc_score: 0.9434; val_best_f1_score: 0.9436; train_kl_reg_loss: 7191.1935; train_edge_recon_loss: 261872.4208; train_gene_expr_recon_loss: 168562.5056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437626.1201; train_optim_loss: 437626.1201; val_kl_reg_loss: 7053.6106; val_edge_recon_loss: 266292.2804; val_gene_expr_recon_loss: 169179.4097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442525.3017; val_optim_loss: 442525.3017
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9867; val_auprc_score: 0.9857; val_best_acc_score: 0.9447; val_best_f1_score: 0.9449; train_kl_reg_loss: 7175.4448; train_edge_recon_loss: 261737.9758; train_gene_expr_recon_loss: 168180.0637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437093.4839; train_optim_loss: 437093.4839; val_kl_reg_loss: 7080.3409; val_edge_recon_loss: 266366.9203; val_gene_expr_recon_loss: 168724.5646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442171.8239; val_optim_loss: 442171.8239
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9866; val_auprc_score: 0.9854; val_best_acc_score: 0.9454; val_best_f1_score: 0.9458; train_kl_reg_loss: 7158.4844; train_edge_recon_loss: 261614.2640; train_gene_expr_recon_loss: 167871.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436644.3024; train_optim_loss: 436644.3024; val_kl_reg_loss: 6947.2550; val_edge_recon_loss: 266673.4193; val_gene_expr_recon_loss: 169113.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442733.8375; val_optim_loss: 442733.8375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9869; val_auprc_score: 0.9858; val_best_acc_score: 0.9457; val_best_f1_score: 0.9460; train_kl_reg_loss: 7154.1324; train_edge_recon_loss: 261533.7495; train_gene_expr_recon_loss: 167666.4708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436354.3529; train_optim_loss: 436354.3529; val_kl_reg_loss: 7099.2129; val_edge_recon_loss: 266519.8625; val_gene_expr_recon_loss: 168462.1825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 442081.2585; val_optim_loss: 442081.2585
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9865; val_auprc_score: 0.9854; val_best_acc_score: 0.9439; val_best_f1_score: 0.9441; train_kl_reg_loss: 7145.7551; train_edge_recon_loss: 261419.2961; train_gene_expr_recon_loss: 167460.1492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436025.1995; train_optim_loss: 436025.1995; val_kl_reg_loss: 7175.1036; val_edge_recon_loss: 266173.4509; val_gene_expr_recon_loss: 168106.4277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441454.9830; val_optim_loss: 441454.9830
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9876; val_auprc_score: 0.9868; val_best_acc_score: 0.9464; val_best_f1_score: 0.9467; train_kl_reg_loss: 7141.4076; train_edge_recon_loss: 261243.0639; train_gene_expr_recon_loss: 167254.1994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435638.6704; train_optim_loss: 435638.6704; val_kl_reg_loss: 6977.6983; val_edge_recon_loss: 266246.0419; val_gene_expr_recon_loss: 168496.4886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441720.2284; val_optim_loss: 441720.2284
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9874; val_auprc_score: 0.9864; val_best_acc_score: 0.9471; val_best_f1_score: 0.9474; train_kl_reg_loss: 7124.6695; train_edge_recon_loss: 261220.2268; train_gene_expr_recon_loss: 167121.4913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435466.3876; train_optim_loss: 435466.3876; val_kl_reg_loss: 6997.1821; val_edge_recon_loss: 266016.3067; val_gene_expr_recon_loss: 168114.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441128.1983; val_optim_loss: 441128.1983
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9874; val_auprc_score: 0.9867; val_best_acc_score: 0.9468; val_best_f1_score: 0.9470; train_kl_reg_loss: 7127.3991; train_edge_recon_loss: 261202.6606; train_gene_expr_recon_loss: 167023.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435353.8402; train_optim_loss: 435353.8402; val_kl_reg_loss: 7040.6191; val_edge_recon_loss: 265930.0734; val_gene_expr_recon_loss: 168036.2026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 441006.8972; val_optim_loss: 441006.8972
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9877; val_auprc_score: 0.9868; val_best_acc_score: 0.9465; val_best_f1_score: 0.9467; train_kl_reg_loss: 7125.8389; train_edge_recon_loss: 260993.7254; train_gene_expr_recon_loss: 166970.3668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435089.9312; train_optim_loss: 435089.9312; val_kl_reg_loss: 6975.3704; val_edge_recon_loss: 265916.6374; val_gene_expr_recon_loss: 167851.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440743.1898; val_optim_loss: 440743.1898
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9880; val_auprc_score: 0.9869; val_best_acc_score: 0.9482; val_best_f1_score: 0.9485; train_kl_reg_loss: 7118.0651; train_edge_recon_loss: 261059.5015; train_gene_expr_recon_loss: 166836.6391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 435014.2054; train_optim_loss: 435014.2054; val_kl_reg_loss: 6958.8859; val_edge_recon_loss: 265732.1518; val_gene_expr_recon_loss: 167998.9814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440690.0199; val_optim_loss: 440690.0199
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9879; val_auprc_score: 0.9869; val_best_acc_score: 0.9482; val_best_f1_score: 0.9483; train_kl_reg_loss: 7116.1987; train_edge_recon_loss: 261042.9276; train_gene_expr_recon_loss: 166789.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434948.8550; train_optim_loss: 434948.8550; val_kl_reg_loss: 7004.2664; val_edge_recon_loss: 265750.8811; val_gene_expr_recon_loss: 167875.3060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440630.4531; val_optim_loss: 440630.4531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9878; val_auprc_score: 0.9868; val_best_acc_score: 0.9472; val_best_f1_score: 0.9474; train_kl_reg_loss: 7121.2656; train_edge_recon_loss: 260926.5707; train_gene_expr_recon_loss: 166719.5503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434767.3865; train_optim_loss: 434767.3865; val_kl_reg_loss: 6986.0842; val_edge_recon_loss: 265535.0866; val_gene_expr_recon_loss: 167746.2470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440267.4173; val_optim_loss: 440267.4173
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9882; val_auprc_score: 0.9874; val_best_acc_score: 0.9485; val_best_f1_score: 0.9489; train_kl_reg_loss: 7121.4274; train_edge_recon_loss: 260837.1373; train_gene_expr_recon_loss: 166550.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434509.4791; train_optim_loss: 434509.4791; val_kl_reg_loss: 7127.7889; val_edge_recon_loss: 265861.1815; val_gene_expr_recon_loss: 167755.2116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440744.1818; val_optim_loss: 440744.1818
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9874; val_auprc_score: 0.9862; val_best_acc_score: 0.9477; val_best_f1_score: 0.9482; train_kl_reg_loss: 7113.8976; train_edge_recon_loss: 260859.7169; train_gene_expr_recon_loss: 166564.9309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434538.5459; train_optim_loss: 434538.5459; val_kl_reg_loss: 6998.8560; val_edge_recon_loss: 266227.6266; val_gene_expr_recon_loss: 167621.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440847.6952; val_optim_loss: 440847.6952
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9879; val_auprc_score: 0.9868; val_best_acc_score: 0.9491; val_best_f1_score: 0.9494; train_kl_reg_loss: 7109.4310; train_edge_recon_loss: 260779.1969; train_gene_expr_recon_loss: 166579.9027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434468.5309; train_optim_loss: 434468.5309; val_kl_reg_loss: 7057.0751; val_edge_recon_loss: 265628.5214; val_gene_expr_recon_loss: 167618.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440303.9347; val_optim_loss: 440303.9347
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9882; val_auprc_score: 0.9872; val_best_acc_score: 0.9494; val_best_f1_score: 0.9498; train_kl_reg_loss: 7111.7929; train_edge_recon_loss: 260655.4691; train_gene_expr_recon_loss: 166447.1171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 434214.3791; train_optim_loss: 434214.3791; val_kl_reg_loss: 7018.5471; val_edge_recon_loss: 265661.1676; val_gene_expr_recon_loss: 167590.3712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 440270.0832; val_optim_loss: 440270.0832

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9890; val_auprc_score: 0.9879; val_best_acc_score: 0.9505; val_best_f1_score: 0.9507; train_kl_reg_loss: 7104.2222; train_edge_recon_loss: 260446.6492; train_gene_expr_recon_loss: 165345.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432896.5980; train_optim_loss: 432896.5980; val_kl_reg_loss: 7012.6461; val_edge_recon_loss: 265249.2864; val_gene_expr_recon_loss: 166324.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438586.3102; val_optim_loss: 438586.3102
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9889; val_auprc_score: 0.9879; val_best_acc_score: 0.9502; val_best_f1_score: 0.9504; train_kl_reg_loss: 7102.4748; train_edge_recon_loss: 260379.2748; train_gene_expr_recon_loss: 165145.3069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432627.0563; train_optim_loss: 432627.0563; val_kl_reg_loss: 7006.1576; val_edge_recon_loss: 265691.6686; val_gene_expr_recon_loss: 166382.6618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 439080.4872; val_optim_loss: 439080.4872
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9889; val_auprc_score: 0.9878; val_best_acc_score: 0.9509; val_best_f1_score: 0.9513; train_kl_reg_loss: 7099.3020; train_edge_recon_loss: 260407.7738; train_gene_expr_recon_loss: 165111.6783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432618.7543; train_optim_loss: 432618.7543; val_kl_reg_loss: 6989.4749; val_edge_recon_loss: 265369.5612; val_gene_expr_recon_loss: 166417.4692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438776.5057; val_optim_loss: 438776.5057
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9883; val_best_acc_score: 0.9523; val_best_f1_score: 0.9527; train_kl_reg_loss: 7089.2700; train_edge_recon_loss: 260386.7244; train_gene_expr_recon_loss: 165117.7334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432593.7275; train_optim_loss: 432593.7275; val_kl_reg_loss: 6995.8078; val_edge_recon_loss: 265107.5446; val_gene_expr_recon_loss: 166463.6126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438566.9665; val_optim_loss: 438566.9665
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9895; val_auprc_score: 0.9886; val_best_acc_score: 0.9521; val_best_f1_score: 0.9524; train_kl_reg_loss: 7086.7238; train_edge_recon_loss: 260367.5716; train_gene_expr_recon_loss: 165046.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432500.6513; train_optim_loss: 432500.6513; val_kl_reg_loss: 6990.9879; val_edge_recon_loss: 265105.7709; val_gene_expr_recon_loss: 166060.1611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438156.9199; val_optim_loss: 438156.9199
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9896; val_auprc_score: 0.9888; val_best_acc_score: 0.9525; val_best_f1_score: 0.9529; train_kl_reg_loss: 7088.7466; train_edge_recon_loss: 260229.7486; train_gene_expr_recon_loss: 165026.8904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432345.3856; train_optim_loss: 432345.3856; val_kl_reg_loss: 6968.5818; val_edge_recon_loss: 265278.9247; val_gene_expr_recon_loss: 166154.0582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438401.5622; val_optim_loss: 438401.5622
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9891; val_auprc_score: 0.9880; val_best_acc_score: 0.9516; val_best_f1_score: 0.9518; train_kl_reg_loss: 7078.6140; train_edge_recon_loss: 260321.6890; train_gene_expr_recon_loss: 164973.6305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432373.9337; train_optim_loss: 432373.9337; val_kl_reg_loss: 6978.6310; val_edge_recon_loss: 265385.4679; val_gene_expr_recon_loss: 166221.8669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438585.9651; val_optim_loss: 438585.9651
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9895; val_auprc_score: 0.9886; val_best_acc_score: 0.9521; val_best_f1_score: 0.9525; train_kl_reg_loss: 7075.7794; train_edge_recon_loss: 260314.9387; train_gene_expr_recon_loss: 164992.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432383.0517; train_optim_loss: 432383.0517; val_kl_reg_loss: 6988.2581; val_edge_recon_loss: 265382.1528; val_gene_expr_recon_loss: 166343.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438713.4361; val_optim_loss: 438713.4361
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9519; val_best_f1_score: 0.9523; train_kl_reg_loss: 7072.1841; train_edge_recon_loss: 260313.1325; train_gene_expr_recon_loss: 164976.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432362.1830; train_optim_loss: 432362.1830; val_kl_reg_loss: 6982.9470; val_edge_recon_loss: 265215.5950; val_gene_expr_recon_loss: 166226.4050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438424.9452; val_optim_loss: 438424.9452

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9521; val_best_f1_score: 0.9525; train_kl_reg_loss: 7071.8400; train_edge_recon_loss: 260260.6151; train_gene_expr_recon_loss: 164882.0854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432214.5409; train_optim_loss: 432214.5409; val_kl_reg_loss: 6964.1725; val_edge_recon_loss: 265202.8616; val_gene_expr_recon_loss: 165922.9315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438089.9668; val_optim_loss: 438089.9668
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9898; val_auprc_score: 0.9889; val_best_acc_score: 0.9534; val_best_f1_score: 0.9537; train_kl_reg_loss: 7072.1942; train_edge_recon_loss: 260230.1636; train_gene_expr_recon_loss: 164719.5142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432021.8717; train_optim_loss: 432021.8717; val_kl_reg_loss: 6972.4179; val_edge_recon_loss: 264944.6459; val_gene_expr_recon_loss: 165853.3034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 437770.3682; val_optim_loss: 437770.3682
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9898; val_auprc_score: 0.9891; val_best_acc_score: 0.9526; val_best_f1_score: 0.9530; train_kl_reg_loss: 7072.0599; train_edge_recon_loss: 260235.8893; train_gene_expr_recon_loss: 164749.4196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432057.3693; train_optim_loss: 432057.3693; val_kl_reg_loss: 6980.0798; val_edge_recon_loss: 265150.1192; val_gene_expr_recon_loss: 165916.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438046.9881; val_optim_loss: 438046.9881
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9884; val_best_acc_score: 0.9516; val_best_f1_score: 0.9520; train_kl_reg_loss: 7073.8816; train_edge_recon_loss: 260236.9143; train_gene_expr_recon_loss: 164748.3112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432059.1068; train_optim_loss: 432059.1068; val_kl_reg_loss: 6968.4159; val_edge_recon_loss: 265255.3616; val_gene_expr_recon_loss: 166074.6597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438298.4372; val_optim_loss: 438298.4372
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9894; val_auprc_score: 0.9885; val_best_acc_score: 0.9521; val_best_f1_score: 0.9522; train_kl_reg_loss: 7075.0818; train_edge_recon_loss: 260191.6211; train_gene_expr_recon_loss: 164781.0844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432047.7876; train_optim_loss: 432047.7876; val_kl_reg_loss: 6954.4853; val_edge_recon_loss: 265244.6007; val_gene_expr_recon_loss: 166031.1714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438230.2554; val_optim_loss: 438230.2554
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9520; val_best_f1_score: 0.9524; train_kl_reg_loss: 7072.1574; train_edge_recon_loss: 260224.0906; train_gene_expr_recon_loss: 164818.5488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432114.7968; train_optim_loss: 432114.7968; val_kl_reg_loss: 6960.4049; val_edge_recon_loss: 265454.1933; val_gene_expr_recon_loss: 165958.4982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438373.0952; val_optim_loss: 438373.0952

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9892; val_auprc_score: 0.9882; val_best_acc_score: 0.9515; val_best_f1_score: 0.9520; train_kl_reg_loss: 7072.5072; train_edge_recon_loss: 260159.1835; train_gene_expr_recon_loss: 164772.4969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432004.1876; train_optim_loss: 432004.1876; val_kl_reg_loss: 6964.5588; val_edge_recon_loss: 265437.3774; val_gene_expr_recon_loss: 165917.7912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438319.7256; val_optim_loss: 438319.7256
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9893; val_auprc_score: 0.9885; val_best_acc_score: 0.9514; val_best_f1_score: 0.9518; train_kl_reg_loss: 7072.2010; train_edge_recon_loss: 260208.6643; train_gene_expr_recon_loss: 164779.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432060.0534; train_optim_loss: 432060.0534; val_kl_reg_loss: 6967.4507; val_edge_recon_loss: 265468.4767; val_gene_expr_recon_loss: 166205.0487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438640.9767; val_optim_loss: 438640.9767
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9895; val_auprc_score: 0.9886; val_best_acc_score: 0.9521; val_best_f1_score: 0.9525; train_kl_reg_loss: 7071.9694; train_edge_recon_loss: 260189.9332; train_gene_expr_recon_loss: 164761.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 432023.5891; train_optim_loss: 432023.5891; val_kl_reg_loss: 6967.5840; val_edge_recon_loss: 265200.0315; val_gene_expr_recon_loss: 165955.3205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438122.9355; val_optim_loss: 438122.9355
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9896; val_auprc_score: 0.9886; val_best_acc_score: 0.9521; val_best_f1_score: 0.9524; train_kl_reg_loss: 7071.9669; train_edge_recon_loss: 260117.8626; train_gene_expr_recon_loss: 164734.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 431924.2044; train_optim_loss: 431924.2044; val_kl_reg_loss: 6969.1290; val_edge_recon_loss: 265257.4378; val_gene_expr_recon_loss: 166153.2538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 438379.8224; val_optim_loss: 438379.8224

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 130 min 14 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9894
val AUPRC score: 0.9884
val best accuracy score: 0.9517
val best F1 score: 0.9521
val target rna MSE score: 3.4924
val source rna MSE score: 0.6509

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
