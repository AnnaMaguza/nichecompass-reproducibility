None
Run timestamp: 02072023_073546_2011.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_2011']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9855; val_auprc_score: 0.9825; val_best_acc_score: 0.9457; val_best_f1_score: 0.9469; train_kl_reg_loss: 5985.5096; train_edge_recon_loss: 266455.6534; train_gene_expr_recon_loss: 76483.0332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348924.1962; train_optim_loss: 348924.1962; val_kl_reg_loss: 5826.0634; val_edge_recon_loss: 263322.4638; val_gene_expr_recon_loss: 70582.0809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339730.6078; val_optim_loss: 339730.6078
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9896; val_best_acc_score: 0.9613; val_best_f1_score: 0.9618; train_kl_reg_loss: 5840.4165; train_edge_recon_loss: 262089.6327; train_gene_expr_recon_loss: 69366.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337296.5808; train_optim_loss: 337296.5808; val_kl_reg_loss: 5800.1658; val_edge_recon_loss: 261904.6687; val_gene_expr_recon_loss: 68102.5985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335807.4317; val_optim_loss: 335807.4317
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9911; val_best_acc_score: 0.9642; val_best_f1_score: 0.9645; train_kl_reg_loss: 5822.6555; train_edge_recon_loss: 260905.9070; train_gene_expr_recon_loss: 67898.8546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334627.4173; train_optim_loss: 334627.4173; val_kl_reg_loss: 5834.2878; val_edge_recon_loss: 262016.0487; val_gene_expr_recon_loss: 67218.4440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335068.7821; val_optim_loss: 335068.7821
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9935; val_auprc_score: 0.9921; val_best_acc_score: 0.9674; val_best_f1_score: 0.9677; train_kl_reg_loss: 5811.0877; train_edge_recon_loss: 260290.7044; train_gene_expr_recon_loss: 67350.4121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333452.2040; train_optim_loss: 333452.2040; val_kl_reg_loss: 5719.5423; val_edge_recon_loss: 260431.9067; val_gene_expr_recon_loss: 66902.8130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333054.2627; val_optim_loss: 333054.2627
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9926; val_best_acc_score: 0.9695; val_best_f1_score: 0.9698; train_kl_reg_loss: 5806.4010; train_edge_recon_loss: 259953.9910; train_gene_expr_recon_loss: 67018.0256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332778.4179; train_optim_loss: 332778.4179; val_kl_reg_loss: 5783.5573; val_edge_recon_loss: 259885.5642; val_gene_expr_recon_loss: 66749.4215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332418.5424; val_optim_loss: 332418.5424
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9946; val_auprc_score: 0.9934; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 5804.1553; train_edge_recon_loss: 259702.1599; train_gene_expr_recon_loss: 66840.0187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332346.3333; train_optim_loss: 332346.3333; val_kl_reg_loss: 5612.1883; val_edge_recon_loss: 259273.6972; val_gene_expr_recon_loss: 66550.8204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331436.7056; val_optim_loss: 331436.7056
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9950; val_auprc_score: 0.9938; val_best_acc_score: 0.9725; val_best_f1_score: 0.9727; train_kl_reg_loss: 5802.8397; train_edge_recon_loss: 259445.5444; train_gene_expr_recon_loss: 66660.0648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331908.4488; train_optim_loss: 331908.4488; val_kl_reg_loss: 5770.3872; val_edge_recon_loss: 259342.5481; val_gene_expr_recon_loss: 66482.0145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331594.9500; val_optim_loss: 331594.9500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9952; val_auprc_score: 0.9942; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5806.4457; train_edge_recon_loss: 259355.4945; train_gene_expr_recon_loss: 66556.8714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331718.8115; train_optim_loss: 331718.8115; val_kl_reg_loss: 6036.4050; val_edge_recon_loss: 259571.8928; val_gene_expr_recon_loss: 66391.5053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331999.8037; val_optim_loss: 331999.8037
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9949; val_auprc_score: 0.9937; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 5813.6983; train_edge_recon_loss: 259104.5142; train_gene_expr_recon_loss: 66472.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331391.1014; train_optim_loss: 331391.1014; val_kl_reg_loss: 5736.3378; val_edge_recon_loss: 259147.3118; val_gene_expr_recon_loss: 66291.4572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331175.1055; val_optim_loss: 331175.1055
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9956; val_auprc_score: 0.9947; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 5819.1797; train_edge_recon_loss: 259001.5379; train_gene_expr_recon_loss: 66407.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331228.6305; train_optim_loss: 331228.6305; val_kl_reg_loss: 5938.3956; val_edge_recon_loss: 259020.9903; val_gene_expr_recon_loss: 66315.5883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331274.9738; val_optim_loss: 331274.9738
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9952; val_auprc_score: 0.9941; val_best_acc_score: 0.9741; val_best_f1_score: 0.9744; train_kl_reg_loss: 5824.3263; train_edge_recon_loss: 258833.5323; train_gene_expr_recon_loss: 66305.4720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330963.3308; train_optim_loss: 330963.3308; val_kl_reg_loss: 5786.4274; val_edge_recon_loss: 259047.0173; val_gene_expr_recon_loss: 66247.1274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331080.5711; val_optim_loss: 331080.5711
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9957; val_auprc_score: 0.9945; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 5827.5725; train_edge_recon_loss: 258789.3024; train_gene_expr_recon_loss: 66280.0984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330896.9733; train_optim_loss: 330896.9733; val_kl_reg_loss: 5816.6190; val_edge_recon_loss: 258506.9826; val_gene_expr_recon_loss: 66049.6369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330373.2388; val_optim_loss: 330373.2388
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9958; val_auprc_score: 0.9950; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 5832.9516; train_edge_recon_loss: 258646.8175; train_gene_expr_recon_loss: 66237.1453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330716.9143; train_optim_loss: 330716.9143; val_kl_reg_loss: 5886.2583; val_edge_recon_loss: 258599.7173; val_gene_expr_recon_loss: 66106.7859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330592.7612; val_optim_loss: 330592.7612
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 5835.9701; train_edge_recon_loss: 258645.1449; train_gene_expr_recon_loss: 66214.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330695.5417; train_optim_loss: 330695.5417; val_kl_reg_loss: 5801.2648; val_edge_recon_loss: 258192.8225; val_gene_expr_recon_loss: 66031.2176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330025.3047; val_optim_loss: 330025.3047
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9959; val_auprc_score: 0.9948; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 5837.0290; train_edge_recon_loss: 258553.5084; train_gene_expr_recon_loss: 66154.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330544.5713; train_optim_loss: 330544.5713; val_kl_reg_loss: 5839.6064; val_edge_recon_loss: 258528.2452; val_gene_expr_recon_loss: 66108.1185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330475.9713; val_optim_loss: 330475.9713
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9957; val_auprc_score: 0.9946; val_best_acc_score: 0.9765; val_best_f1_score: 0.9768; train_kl_reg_loss: 5840.3353; train_edge_recon_loss: 258422.3257; train_gene_expr_recon_loss: 66107.1464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330369.8073; train_optim_loss: 330369.8073; val_kl_reg_loss: 5863.6998; val_edge_recon_loss: 258411.0661; val_gene_expr_recon_loss: 66119.6938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330394.4582; val_optim_loss: 330394.4582
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9947; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 5845.7976; train_edge_recon_loss: 258374.4379; train_gene_expr_recon_loss: 66092.9450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330313.1803; train_optim_loss: 330313.1803; val_kl_reg_loss: 5769.1462; val_edge_recon_loss: 258297.1107; val_gene_expr_recon_loss: 66067.6739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330133.9301; val_optim_loss: 330133.9301
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9955; val_auprc_score: 0.9944; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 5848.6545; train_edge_recon_loss: 258338.8347; train_gene_expr_recon_loss: 66053.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330240.8940; train_optim_loss: 330240.8940; val_kl_reg_loss: 5704.5808; val_edge_recon_loss: 258508.6897; val_gene_expr_recon_loss: 66068.6398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330281.9094; val_optim_loss: 330281.9094

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 5885.1967; train_edge_recon_loss: 258049.5386; train_gene_expr_recon_loss: 65577.8909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329512.6259; train_optim_loss: 329512.6259; val_kl_reg_loss: 5862.8692; val_edge_recon_loss: 257892.9062; val_gene_expr_recon_loss: 65587.5074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329343.2826; val_optim_loss: 329343.2826
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 5882.1275; train_edge_recon_loss: 258082.7896; train_gene_expr_recon_loss: 65519.1744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329484.0917; train_optim_loss: 329484.0917; val_kl_reg_loss: 5857.5130; val_edge_recon_loss: 257808.1266; val_gene_expr_recon_loss: 65468.4204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329134.0599; val_optim_loss: 329134.0599
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5878.7801; train_edge_recon_loss: 258024.0295; train_gene_expr_recon_loss: 65519.6374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329422.4470; train_optim_loss: 329422.4470; val_kl_reg_loss: 5835.8526; val_edge_recon_loss: 257820.6633; val_gene_expr_recon_loss: 65435.6274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329092.1448; val_optim_loss: 329092.1448
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9953; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 5878.2115; train_edge_recon_loss: 257936.0208; train_gene_expr_recon_loss: 65482.7291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329296.9616; train_optim_loss: 329296.9616; val_kl_reg_loss: 5850.9935; val_edge_recon_loss: 257799.9379; val_gene_expr_recon_loss: 65600.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329251.8359; val_optim_loss: 329251.8359
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 5874.1174; train_edge_recon_loss: 258015.4118; train_gene_expr_recon_loss: 65463.5440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329353.0733; train_optim_loss: 329353.0733; val_kl_reg_loss: 5838.9882; val_edge_recon_loss: 257675.7852; val_gene_expr_recon_loss: 65620.4403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329135.2149; val_optim_loss: 329135.2149
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 5874.0054; train_edge_recon_loss: 257949.5738; train_gene_expr_recon_loss: 65458.7058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329282.2853; train_optim_loss: 329282.2853; val_kl_reg_loss: 5838.5612; val_edge_recon_loss: 257671.3742; val_gene_expr_recon_loss: 65527.8084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329037.7438; val_optim_loss: 329037.7438
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9963; val_auprc_score: 0.9952; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 5874.2691; train_edge_recon_loss: 257978.0856; train_gene_expr_recon_loss: 65414.7064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329267.0613; train_optim_loss: 329267.0613; val_kl_reg_loss: 5856.5488; val_edge_recon_loss: 257647.8088; val_gene_expr_recon_loss: 65528.3442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329032.7009; val_optim_loss: 329032.7009
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9964; val_auprc_score: 0.9952; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5873.4507; train_edge_recon_loss: 257922.4174; train_gene_expr_recon_loss: 65440.9353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329236.8032; train_optim_loss: 329236.8032; val_kl_reg_loss: 5853.4157; val_edge_recon_loss: 257404.1534; val_gene_expr_recon_loss: 65463.2223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328720.7919; val_optim_loss: 328720.7919
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9964; val_auprc_score: 0.9953; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 5872.0417; train_edge_recon_loss: 257936.1422; train_gene_expr_recon_loss: 65433.6460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329241.8299; train_optim_loss: 329241.8299; val_kl_reg_loss: 5847.5780; val_edge_recon_loss: 257866.3960; val_gene_expr_recon_loss: 65515.8930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329229.8677; val_optim_loss: 329229.8677
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5872.3314; train_edge_recon_loss: 257902.7823; train_gene_expr_recon_loss: 65445.7952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329220.9091; train_optim_loss: 329220.9091; val_kl_reg_loss: 5848.0437; val_edge_recon_loss: 257680.7285; val_gene_expr_recon_loss: 65503.0804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329031.8522; val_optim_loss: 329031.8522
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5872.2210; train_edge_recon_loss: 257954.8236; train_gene_expr_recon_loss: 65407.0313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329234.0758; train_optim_loss: 329234.0758; val_kl_reg_loss: 5846.7035; val_edge_recon_loss: 257494.8233; val_gene_expr_recon_loss: 65432.1671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328773.6936; val_optim_loss: 328773.6936
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5868.5020; train_edge_recon_loss: 257947.4093; train_gene_expr_recon_loss: 65415.5343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329231.4458; train_optim_loss: 329231.4458; val_kl_reg_loss: 5835.9834; val_edge_recon_loss: 257493.6573; val_gene_expr_recon_loss: 65447.4298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328777.0706; val_optim_loss: 328777.0706

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5876.5308; train_edge_recon_loss: 257881.6803; train_gene_expr_recon_loss: 65376.6567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329134.8679; train_optim_loss: 329134.8679; val_kl_reg_loss: 5852.8142; val_edge_recon_loss: 257551.7359; val_gene_expr_recon_loss: 65473.5126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328878.0621; val_optim_loss: 328878.0621
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5874.7406; train_edge_recon_loss: 257910.6461; train_gene_expr_recon_loss: 65356.9920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329142.3782; train_optim_loss: 329142.3782; val_kl_reg_loss: 5852.6860; val_edge_recon_loss: 257441.1839; val_gene_expr_recon_loss: 65389.9105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328683.7796; val_optim_loss: 328683.7796
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5877.5908; train_edge_recon_loss: 257835.9174; train_gene_expr_recon_loss: 65333.4252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329046.9333; train_optim_loss: 329046.9333; val_kl_reg_loss: 5854.0500; val_edge_recon_loss: 257582.7166; val_gene_expr_recon_loss: 65536.5073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328973.2736; val_optim_loss: 328973.2736
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 5876.6160; train_edge_recon_loss: 257890.3548; train_gene_expr_recon_loss: 65317.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329084.4380; train_optim_loss: 329084.4380; val_kl_reg_loss: 5843.9931; val_edge_recon_loss: 257596.9761; val_gene_expr_recon_loss: 65485.8536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328926.8226; val_optim_loss: 328926.8226
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5875.5168; train_edge_recon_loss: 257866.1841; train_gene_expr_recon_loss: 65327.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329069.6446; train_optim_loss: 329069.6446; val_kl_reg_loss: 5851.2061; val_edge_recon_loss: 257572.3794; val_gene_expr_recon_loss: 65539.8286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328963.4139; val_optim_loss: 328963.4139
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5876.6472; train_edge_recon_loss: 257873.9613; train_gene_expr_recon_loss: 65318.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329069.0915; train_optim_loss: 329069.0915; val_kl_reg_loss: 5841.7697; val_edge_recon_loss: 257457.0256; val_gene_expr_recon_loss: 65367.3956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328666.1913; val_optim_loss: 328666.1913
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 5876.3942; train_edge_recon_loss: 257882.9675; train_gene_expr_recon_loss: 65348.8249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329108.1871; train_optim_loss: 329108.1871; val_kl_reg_loss: 5842.2969; val_edge_recon_loss: 257519.1412; val_gene_expr_recon_loss: 65352.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328714.0498; val_optim_loss: 328714.0498
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5875.2644; train_edge_recon_loss: 257870.2734; train_gene_expr_recon_loss: 65332.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329078.1428; train_optim_loss: 329078.1428; val_kl_reg_loss: 5843.9249; val_edge_recon_loss: 257675.4247; val_gene_expr_recon_loss: 65465.8604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328985.2087; val_optim_loss: 328985.2087
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 5877.0208; train_edge_recon_loss: 257823.8641; train_gene_expr_recon_loss: 65326.4435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329027.3285; train_optim_loss: 329027.3285; val_kl_reg_loss: 5847.3349; val_edge_recon_loss: 257568.1944; val_gene_expr_recon_loss: 65374.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328790.4130; val_optim_loss: 328790.4130
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9965; val_auprc_score: 0.9955; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5876.1937; train_edge_recon_loss: 257876.3882; train_gene_expr_recon_loss: 65332.3506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329084.9323; train_optim_loss: 329084.9323; val_kl_reg_loss: 5850.5169; val_edge_recon_loss: 257541.3235; val_gene_expr_recon_loss: 65447.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328839.6805; val_optim_loss: 328839.6805

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5874.8259; train_edge_recon_loss: 257923.6263; train_gene_expr_recon_loss: 65327.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329126.1488; train_optim_loss: 329126.1488; val_kl_reg_loss: 5842.9068; val_edge_recon_loss: 257611.6979; val_gene_expr_recon_loss: 65380.7537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328835.3589; val_optim_loss: 328835.3589
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5872.8872; train_edge_recon_loss: 257935.0278; train_gene_expr_recon_loss: 65313.8225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329121.7370; train_optim_loss: 329121.7370; val_kl_reg_loss: 5839.0716; val_edge_recon_loss: 257418.5691; val_gene_expr_recon_loss: 65505.5648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328763.2061; val_optim_loss: 328763.2061
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5873.7667; train_edge_recon_loss: 257899.5373; train_gene_expr_recon_loss: 65325.7867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329099.0910; train_optim_loss: 329099.0910; val_kl_reg_loss: 5845.3591; val_edge_recon_loss: 257440.3492; val_gene_expr_recon_loss: 65376.5581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328662.2670; val_optim_loss: 328662.2670
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5875.1995; train_edge_recon_loss: 257829.5870; train_gene_expr_recon_loss: 65288.2988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328993.0855; train_optim_loss: 328993.0855; val_kl_reg_loss: 5842.1408; val_edge_recon_loss: 257424.1339; val_gene_expr_recon_loss: 65265.6021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328531.8757; val_optim_loss: 328531.8757
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9967; val_auprc_score: 0.9958; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 5874.3060; train_edge_recon_loss: 257874.8030; train_gene_expr_recon_loss: 65340.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329089.7977; train_optim_loss: 329089.7977; val_kl_reg_loss: 5840.3432; val_edge_recon_loss: 257410.5893; val_gene_expr_recon_loss: 65401.4390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328652.3714; val_optim_loss: 328652.3714
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5875.5031; train_edge_recon_loss: 257788.1912; train_gene_expr_recon_loss: 65309.6098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328973.3042; train_optim_loss: 328973.3042; val_kl_reg_loss: 5845.1609; val_edge_recon_loss: 257672.0478; val_gene_expr_recon_loss: 65419.3346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328936.5432; val_optim_loss: 328936.5432
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9797; val_best_f1_score: 0.9799; train_kl_reg_loss: 5874.8753; train_edge_recon_loss: 257852.6131; train_gene_expr_recon_loss: 65325.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329052.8364; train_optim_loss: 329052.8364; val_kl_reg_loss: 5839.9117; val_edge_recon_loss: 257666.0819; val_gene_expr_recon_loss: 65446.8288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328952.8225; val_optim_loss: 328952.8225
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 5874.7950; train_edge_recon_loss: 257862.1426; train_gene_expr_recon_loss: 65324.1935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329061.1311; train_optim_loss: 329061.1311; val_kl_reg_loss: 5842.3041; val_edge_recon_loss: 257490.7371; val_gene_expr_recon_loss: 65354.5063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328687.5481; val_optim_loss: 328687.5481

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 5874.7033; train_edge_recon_loss: 257874.7235; train_gene_expr_recon_loss: 65347.7289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329097.1561; train_optim_loss: 329097.1561; val_kl_reg_loss: 5841.1461; val_edge_recon_loss: 257474.2113; val_gene_expr_recon_loss: 65363.5295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328678.8858; val_optim_loss: 328678.8858
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 5874.2370; train_edge_recon_loss: 257835.3435; train_gene_expr_recon_loss: 65340.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329050.3341; train_optim_loss: 329050.3341; val_kl_reg_loss: 5840.8261; val_edge_recon_loss: 257545.5144; val_gene_expr_recon_loss: 65384.5429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328770.8831; val_optim_loss: 328770.8831
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 5873.7808; train_edge_recon_loss: 257907.8978; train_gene_expr_recon_loss: 65330.2746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329111.9531; train_optim_loss: 329111.9531; val_kl_reg_loss: 5842.4441; val_edge_recon_loss: 257736.1645; val_gene_expr_recon_loss: 65520.1810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329098.7902; val_optim_loss: 329098.7902
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 5873.9269; train_edge_recon_loss: 257856.3964; train_gene_expr_recon_loss: 65345.0481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329075.3714; train_optim_loss: 329075.3714; val_kl_reg_loss: 5841.4146; val_edge_recon_loss: 257614.7897; val_gene_expr_recon_loss: 65439.1893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328895.3933; val_optim_loss: 328895.3933

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1042 min 15 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9955
Val best accuracy score: 0.9801
Val best F1 score: 0.9802
Val gene expr MSE score: 1.6609

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
