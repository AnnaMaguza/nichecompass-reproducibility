None
Run timestamp: 16072023_094352_2011.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2011']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 1319430
Number of validation edges: 146603
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9832; val_auprc_score: 0.9798; val_best_acc_score: 0.9399; val_best_f1_score: 0.9414; train_kl_reg_loss: 15565.7954; train_edge_recon_loss: 26408957.1102; train_gene_expr_recon_loss: 841942.6408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27266465.5718; train_optim_loss: 27266465.5718; val_kl_reg_loss: 12869.8251; val_edge_recon_loss: 26228207.6516; val_gene_expr_recon_loss: 778852.6065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27019930.1882; val_optim_loss: 27019930.1882
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9890; val_auprc_score: 0.9867; val_best_acc_score: 0.9546; val_best_f1_score: 0.9555; train_kl_reg_loss: 12686.8448; train_edge_recon_loss: 25962978.7432; train_gene_expr_recon_loss: 761261.2990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26736926.8642; train_optim_loss: 26736926.8642; val_kl_reg_loss: 12554.6315; val_edge_recon_loss: 26076233.4286; val_gene_expr_recon_loss: 743041.6847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26831829.7143; val_optim_loss: 26831829.7143
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9906; val_auprc_score: 0.9883; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 12800.5804; train_edge_recon_loss: 25856790.8022; train_gene_expr_recon_loss: 735794.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26605385.8953; train_optim_loss: 26605385.8953; val_kl_reg_loss: 13118.6381; val_edge_recon_loss: 25925718.8293; val_gene_expr_recon_loss: 729059.0385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26667896.5157; val_optim_loss: 26667896.5157
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9904; val_auprc_score: 0.9880; val_best_acc_score: 0.9607; val_best_f1_score: 0.9614; train_kl_reg_loss: 13046.3276; train_edge_recon_loss: 25802877.8379; train_gene_expr_recon_loss: 720889.9038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26536814.0690; train_optim_loss: 26536814.0690; val_kl_reg_loss: 13109.7406; val_edge_recon_loss: 26100371.1916; val_gene_expr_recon_loss: 715647.3036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26829128.2509; val_optim_loss: 26829128.2509
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9919; val_auprc_score: 0.9899; val_best_acc_score: 0.9646; val_best_f1_score: 0.9651; train_kl_reg_loss: 13311.3443; train_edge_recon_loss: 25775085.7548; train_gene_expr_recon_loss: 711496.6721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26499893.7882; train_optim_loss: 26499893.7882; val_kl_reg_loss: 13643.3356; val_edge_recon_loss: 25870659.6655; val_gene_expr_recon_loss: 707146.4867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26591449.4913; val_optim_loss: 26591449.4913
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9921; val_auprc_score: 0.9901; val_best_acc_score: 0.9655; val_best_f1_score: 0.9661; train_kl_reg_loss: 13475.0815; train_edge_recon_loss: 25753077.8068; train_gene_expr_recon_loss: 704823.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26471376.7060; train_optim_loss: 26471376.7060; val_kl_reg_loss: 13623.9718; val_edge_recon_loss: 25867088.8084; val_gene_expr_recon_loss: 702157.6413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26582870.4181; val_optim_loss: 26582870.4181
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 13589.5791; train_edge_recon_loss: 25736656.9829; train_gene_expr_recon_loss: 699917.7982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26450164.3615; train_optim_loss: 26450164.3615; val_kl_reg_loss: 13479.8730; val_edge_recon_loss: 25844846.1812; val_gene_expr_recon_loss: 696188.5841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26554514.7108; val_optim_loss: 26554514.7108
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9933; val_auprc_score: 0.9914; val_best_acc_score: 0.9697; val_best_f1_score: 0.9701; train_kl_reg_loss: 13675.8585; train_edge_recon_loss: 25720160.1800; train_gene_expr_recon_loss: 695996.0649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26429832.0869; train_optim_loss: 26429832.0869; val_kl_reg_loss: 13673.7255; val_edge_recon_loss: 25800596.6969; val_gene_expr_recon_loss: 695404.2239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26509674.6899; val_optim_loss: 26509674.6899
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9935; val_auprc_score: 0.9917; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 13736.7596; train_edge_recon_loss: 25702895.3406; train_gene_expr_recon_loss: 692958.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26409590.5725; train_optim_loss: 26409590.5725; val_kl_reg_loss: 13558.9348; val_edge_recon_loss: 25754681.2404; val_gene_expr_recon_loss: 691095.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26459335.1498; val_optim_loss: 26459335.1498
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 13802.1142; train_edge_recon_loss: 25687270.3825; train_gene_expr_recon_loss: 690813.2447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26391885.7292; train_optim_loss: 26391885.7292; val_kl_reg_loss: 13669.8463; val_edge_recon_loss: 25756448.0697; val_gene_expr_recon_loss: 697626.1437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26467744.0557; val_optim_loss: 26467744.0557
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9942; val_auprc_score: 0.9925; val_best_acc_score: 0.9733; val_best_f1_score: 0.9736; train_kl_reg_loss: 13768.8998; train_edge_recon_loss: 25682300.7199; train_gene_expr_recon_loss: 688973.5127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26385043.1482; train_optim_loss: 26385043.1482; val_kl_reg_loss: 13470.5048; val_edge_recon_loss: 25749006.2300; val_gene_expr_recon_loss: 688872.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26451349.1986; val_optim_loss: 26451349.1986
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 13717.0739; train_edge_recon_loss: 25665149.5035; train_gene_expr_recon_loss: 688013.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26366880.5136; train_optim_loss: 26366880.5136; val_kl_reg_loss: 13431.9945; val_edge_recon_loss: 25730571.9721; val_gene_expr_recon_loss: 686774.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26430778.4321; val_optim_loss: 26430778.4321
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9945; val_auprc_score: 0.9928; val_best_acc_score: 0.9750; val_best_f1_score: 0.9753; train_kl_reg_loss: 13749.3721; train_edge_recon_loss: 25657072.5291; train_gene_expr_recon_loss: 686452.4276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26357274.2917; train_optim_loss: 26357274.2917; val_kl_reg_loss: 13841.1754; val_edge_recon_loss: 25712859.8188; val_gene_expr_recon_loss: 686038.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26412739.4355; val_optim_loss: 26412739.4355
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9927; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 13722.2963; train_edge_recon_loss: 25651269.5663; train_gene_expr_recon_loss: 685492.1194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26350483.9853; train_optim_loss: 26350483.9853; val_kl_reg_loss: 13869.1187; val_edge_recon_loss: 25712930.5505; val_gene_expr_recon_loss: 686199.0314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26412998.6969; val_optim_loss: 26412998.6969
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9945; val_auprc_score: 0.9926; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 13712.2514; train_edge_recon_loss: 25644603.7277; train_gene_expr_recon_loss: 684653.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26342969.8371; train_optim_loss: 26342969.8371; val_kl_reg_loss: 13783.6192; val_edge_recon_loss: 25737470.2230; val_gene_expr_recon_loss: 684330.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26435583.9652; val_optim_loss: 26435583.9652
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9950; val_auprc_score: 0.9935; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 13740.2817; train_edge_recon_loss: 25633020.6369; train_gene_expr_recon_loss: 683888.8961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26330649.7820; train_optim_loss: 26330649.7820; val_kl_reg_loss: 13748.5004; val_edge_recon_loss: 25689531.6655; val_gene_expr_recon_loss: 685245.7835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26388525.9652; val_optim_loss: 26388525.9652
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9934; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 13674.2499; train_edge_recon_loss: 25633252.5756; train_gene_expr_recon_loss: 683368.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26330295.0109; train_optim_loss: 26330295.0109; val_kl_reg_loss: 13707.8627; val_edge_recon_loss: 25691534.8432; val_gene_expr_recon_loss: 681649.8826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26386892.5645; val_optim_loss: 26386892.5645
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9951; val_auprc_score: 0.9935; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 13687.1611; train_edge_recon_loss: 25627906.2863; train_gene_expr_recon_loss: 682067.6037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26323661.0419; train_optim_loss: 26323661.0419; val_kl_reg_loss: 14003.5127; val_edge_recon_loss: 25701334.8153; val_gene_expr_recon_loss: 682904.3323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26398242.6411; val_optim_loss: 26398242.6411
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9772; train_kl_reg_loss: 13741.7144; train_edge_recon_loss: 25614343.8635; train_gene_expr_recon_loss: 681311.7518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26309397.3328; train_optim_loss: 26309397.3328; val_kl_reg_loss: 13791.1116; val_edge_recon_loss: 25696612.2439; val_gene_expr_recon_loss: 682381.0150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26392784.3484; val_optim_loss: 26392784.3484
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9932; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 13755.3285; train_edge_recon_loss: 25613570.9457; train_gene_expr_recon_loss: 681120.8274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26308447.0946; train_optim_loss: 26308447.0946; val_kl_reg_loss: 13429.3357; val_edge_recon_loss: 25662194.7526; val_gene_expr_recon_loss: 680230.7067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26355854.8293; val_optim_loss: 26355854.8293
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 13676.0232; train_edge_recon_loss: 25607550.0822; train_gene_expr_recon_loss: 681049.2512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26302275.3429; train_optim_loss: 26302275.3429; val_kl_reg_loss: 13515.4425; val_edge_recon_loss: 25649323.3449; val_gene_expr_recon_loss: 680239.6605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26343078.4669; val_optim_loss: 26343078.4669
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9787; val_best_f1_score: 0.9790; train_kl_reg_loss: 13679.0419; train_edge_recon_loss: 25599996.6199; train_gene_expr_recon_loss: 680075.3425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26293751.0303; train_optim_loss: 26293751.0303; val_kl_reg_loss: 13672.9800; val_edge_recon_loss: 25653863.3728; val_gene_expr_recon_loss: 679281.1113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26346817.4146; val_optim_loss: 26346817.4146
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 13713.4129; train_edge_recon_loss: 25597857.6804; train_gene_expr_recon_loss: 679583.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26291154.8084; train_optim_loss: 26291154.8084; val_kl_reg_loss: 13843.4508; val_edge_recon_loss: 25663029.9582; val_gene_expr_recon_loss: 680214.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26357087.9233; val_optim_loss: 26357087.9233
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 13732.5874; train_edge_recon_loss: 25588392.3336; train_gene_expr_recon_loss: 679388.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26281513.7975; train_optim_loss: 26281513.7975; val_kl_reg_loss: 13977.3869; val_edge_recon_loss: 25665985.0314; val_gene_expr_recon_loss: 680289.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26360251.6376; val_optim_loss: 26360251.6376
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9933; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 13761.1322; train_edge_recon_loss: 25580896.4368; train_gene_expr_recon_loss: 679174.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26273832.2382; train_optim_loss: 26273832.2382; val_kl_reg_loss: 13817.5019; val_edge_recon_loss: 25652001.4286; val_gene_expr_recon_loss: 678903.2957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26344722.2160; val_optim_loss: 26344722.2160

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 13948.0687; train_edge_recon_loss: 25563281.4732; train_gene_expr_recon_loss: 672445.0793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26249674.6020; train_optim_loss: 26249674.6020; val_kl_reg_loss: 14047.3222; val_edge_recon_loss: 25603215.7631; val_gene_expr_recon_loss: 673873.9114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26291137.0174; val_optim_loss: 26291137.0174
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 14053.1283; train_edge_recon_loss: 25570426.8743; train_gene_expr_recon_loss: 671813.8071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26256293.8029; train_optim_loss: 26256293.8029; val_kl_reg_loss: 13967.4349; val_edge_recon_loss: 25604103.7909; val_gene_expr_recon_loss: 672559.5318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26290630.8153; val_optim_loss: 26290630.8153
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 14035.6476; train_edge_recon_loss: 25564609.3344; train_gene_expr_recon_loss: 671385.9021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26250030.8697; train_optim_loss: 26250030.8697; val_kl_reg_loss: 13945.5586; val_edge_recon_loss: 25604336.4878; val_gene_expr_recon_loss: 672443.3212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26290725.3937; val_optim_loss: 26290725.3937
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9954; val_auprc_score: 0.9937; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 13941.4678; train_edge_recon_loss: 25556069.9697; train_gene_expr_recon_loss: 671036.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26241048.2413; train_optim_loss: 26241048.2413; val_kl_reg_loss: 13837.3088; val_edge_recon_loss: 25595373.3101; val_gene_expr_recon_loss: 673141.8251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26282352.4181; val_optim_loss: 26282352.4181
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 13938.2153; train_edge_recon_loss: 25559676.8006; train_gene_expr_recon_loss: 670988.3832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26244603.3988; train_optim_loss: 26244603.3988; val_kl_reg_loss: 13808.8785; val_edge_recon_loss: 25613234.8293; val_gene_expr_recon_loss: 672260.2946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26299303.9791; val_optim_loss: 26299303.9791
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9942; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 13893.0669; train_edge_recon_loss: 25561413.7300; train_gene_expr_recon_loss: 671013.0489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246319.8371; train_optim_loss: 26246319.8371; val_kl_reg_loss: 13767.4762; val_edge_recon_loss: 25599773.4634; val_gene_expr_recon_loss: 672208.1790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26285749.1010; val_optim_loss: 26285749.1010
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9955; val_auprc_score: 0.9940; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 13875.7267; train_edge_recon_loss: 25557203.7238; train_gene_expr_recon_loss: 671371.6801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26242451.1265; train_optim_loss: 26242451.1265; val_kl_reg_loss: 13687.4054; val_edge_recon_loss: 25619750.3624; val_gene_expr_recon_loss: 671839.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26305277.1847; val_optim_loss: 26305277.1847
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13838.0643; train_edge_recon_loss: 25562152.2141; train_gene_expr_recon_loss: 670792.6742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26246782.9488; train_optim_loss: 26246782.9488; val_kl_reg_loss: 13815.4158; val_edge_recon_loss: 25613831.8815; val_gene_expr_recon_loss: 671931.7439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26299579.0732; val_optim_loss: 26299579.0732

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9956; val_auprc_score: 0.9941; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 13894.5924; train_edge_recon_loss: 25559274.5524; train_gene_expr_recon_loss: 669982.6249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26243151.7649; train_optim_loss: 26243151.7649; val_kl_reg_loss: 13796.7879; val_edge_recon_loss: 25600991.3937; val_gene_expr_recon_loss: 671437.4632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26286225.6516; val_optim_loss: 26286225.6516
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9801; val_best_f1_score: 0.9804; train_kl_reg_loss: 13877.5891; train_edge_recon_loss: 25557457.3157; train_gene_expr_recon_loss: 670203.9385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26241538.8053; train_optim_loss: 26241538.8053; val_kl_reg_loss: 13803.8098; val_edge_recon_loss: 25619360.5436; val_gene_expr_recon_loss: 671321.3839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26304485.7561; val_optim_loss: 26304485.7561
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9956; val_auprc_score: 0.9938; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13887.1465; train_edge_recon_loss: 25556309.2630; train_gene_expr_recon_loss: 670148.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26240345.2459; train_optim_loss: 26240345.2459; val_kl_reg_loss: 13817.5362; val_edge_recon_loss: 25606176.0418; val_gene_expr_recon_loss: 670610.3702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26290603.9373; val_optim_loss: 26290603.9373
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 13881.2305; train_edge_recon_loss: 25557680.2746; train_gene_expr_recon_loss: 669668.8986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26241230.3933; train_optim_loss: 26241230.3933; val_kl_reg_loss: 13762.1519; val_edge_recon_loss: 25617383.8328; val_gene_expr_recon_loss: 671664.4706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26302810.4460; val_optim_loss: 26302810.4460

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 723 min 48 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9939
Val best accuracy score: 0.9797
Val best F1 score: 0.9799
Val gene expr MSE score: 1.7048

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
