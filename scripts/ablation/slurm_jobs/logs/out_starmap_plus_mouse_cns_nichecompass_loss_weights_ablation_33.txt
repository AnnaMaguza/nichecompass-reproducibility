None
Run timestamp: 02072023_140613_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1813.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1361, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1361, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9647; val_auprc_score: 0.9516; val_best_acc_score: 0.9138; val_best_f1_score: 0.9168; train_kl_reg_loss: 7504.6656; train_edge_recon_loss: 277594.0500; train_gene_expr_recon_loss: 135989.6596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421088.3745; train_optim_loss: 421088.3745; val_kl_reg_loss: 8026.5872; val_edge_recon_loss: 267167.0597; val_gene_expr_recon_loss: 120044.0025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395237.6477; val_optim_loss: 395237.6477
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9750; val_auprc_score: 0.9634; val_best_acc_score: 0.9379; val_best_f1_score: 0.9395; train_kl_reg_loss: 7948.1379; train_edge_recon_loss: 263296.5683; train_gene_expr_recon_loss: 115284.4933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386529.1992; train_optim_loss: 386529.1992; val_kl_reg_loss: 7601.8252; val_edge_recon_loss: 263843.3793; val_gene_expr_recon_loss: 112262.8956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383708.1009; val_optim_loss: 383708.1009
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9777; val_auprc_score: 0.9684; val_best_acc_score: 0.9430; val_best_f1_score: 0.9446; train_kl_reg_loss: 7577.5800; train_edge_recon_loss: 262181.1558; train_gene_expr_recon_loss: 110051.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379810.5636; train_optim_loss: 379810.5636; val_kl_reg_loss: 7169.6396; val_edge_recon_loss: 263962.0916; val_gene_expr_recon_loss: 108239.4822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379371.2131; val_optim_loss: 379371.2131
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9797; val_auprc_score: 0.9704; val_best_acc_score: 0.9486; val_best_f1_score: 0.9501; train_kl_reg_loss: 7306.6323; train_edge_recon_loss: 261427.1624; train_gene_expr_recon_loss: 106947.5230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375681.3164; train_optim_loss: 375681.3164; val_kl_reg_loss: 7075.9455; val_edge_recon_loss: 263216.6278; val_gene_expr_recon_loss: 106168.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376461.2784; val_optim_loss: 376461.2784
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9811; val_auprc_score: 0.9730; val_best_acc_score: 0.9499; val_best_f1_score: 0.9512; train_kl_reg_loss: 7181.6254; train_edge_recon_loss: 260860.8512; train_gene_expr_recon_loss: 104778.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372820.5986; train_optim_loss: 372820.5986; val_kl_reg_loss: 6951.4108; val_edge_recon_loss: 263245.0206; val_gene_expr_recon_loss: 103675.6602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373872.0923; val_optim_loss: 373872.0923
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9815; val_auprc_score: 0.9738; val_best_acc_score: 0.9517; val_best_f1_score: 0.9531; train_kl_reg_loss: 7072.0418; train_edge_recon_loss: 260666.5063; train_gene_expr_recon_loss: 102897.5124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370636.0596; train_optim_loss: 370636.0596; val_kl_reg_loss: 6899.0066; val_edge_recon_loss: 262928.4851; val_gene_expr_recon_loss: 102557.6154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372385.1009; val_optim_loss: 372385.1009
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9836; val_auprc_score: 0.9764; val_best_acc_score: 0.9561; val_best_f1_score: 0.9572; train_kl_reg_loss: 6979.9351; train_edge_recon_loss: 260604.1665; train_gene_expr_recon_loss: 101316.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368900.8993; train_optim_loss: 368900.8993; val_kl_reg_loss: 6837.9121; val_edge_recon_loss: 261825.6115; val_gene_expr_recon_loss: 101003.6005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369667.1222; val_optim_loss: 369667.1222
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9828; val_auprc_score: 0.9751; val_best_acc_score: 0.9554; val_best_f1_score: 0.9565; train_kl_reg_loss: 6942.9249; train_edge_recon_loss: 260451.5894; train_gene_expr_recon_loss: 99956.6088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367351.1227; train_optim_loss: 367351.1227; val_kl_reg_loss: 6756.2127; val_edge_recon_loss: 262427.9801; val_gene_expr_recon_loss: 99804.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368988.4759; val_optim_loss: 368988.4759
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9832; val_auprc_score: 0.9755; val_best_acc_score: 0.9569; val_best_f1_score: 0.9581; train_kl_reg_loss: 6896.8300; train_edge_recon_loss: 260213.3302; train_gene_expr_recon_loss: 98805.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365915.2729; train_optim_loss: 365915.2729; val_kl_reg_loss: 6685.1360; val_edge_recon_loss: 262394.2230; val_gene_expr_recon_loss: 98761.7308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367841.0909; val_optim_loss: 367841.0909
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9841; val_auprc_score: 0.9774; val_best_acc_score: 0.9577; val_best_f1_score: 0.9587; train_kl_reg_loss: 6858.3247; train_edge_recon_loss: 260033.6285; train_gene_expr_recon_loss: 97892.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364784.6217; train_optim_loss: 364784.6217; val_kl_reg_loss: 6639.2824; val_edge_recon_loss: 261869.4411; val_gene_expr_recon_loss: 97960.8210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366469.5440; val_optim_loss: 366469.5440
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9852; val_auprc_score: 0.9791; val_best_acc_score: 0.9590; val_best_f1_score: 0.9601; train_kl_reg_loss: 6840.6589; train_edge_recon_loss: 259788.2020; train_gene_expr_recon_loss: 96977.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363606.5579; train_optim_loss: 363606.5579; val_kl_reg_loss: 6621.8027; val_edge_recon_loss: 261497.1754; val_gene_expr_recon_loss: 97112.1751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365231.1534; val_optim_loss: 365231.1534
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9850; val_auprc_score: 0.9791; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 6813.2141; train_edge_recon_loss: 259697.3944; train_gene_expr_recon_loss: 96257.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362767.8228; train_optim_loss: 362767.8228; val_kl_reg_loss: 6598.7396; val_edge_recon_loss: 261405.6953; val_gene_expr_recon_loss: 96775.5920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364780.0312; val_optim_loss: 364780.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9848; val_auprc_score: 0.9792; val_best_acc_score: 0.9577; val_best_f1_score: 0.9588; train_kl_reg_loss: 6790.5746; train_edge_recon_loss: 259553.2309; train_gene_expr_recon_loss: 95562.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361905.8906; train_optim_loss: 361905.8906; val_kl_reg_loss: 6644.1067; val_edge_recon_loss: 261832.5632; val_gene_expr_recon_loss: 96111.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364588.1335; val_optim_loss: 364588.1335
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9846; val_auprc_score: 0.9779; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 6780.4603; train_edge_recon_loss: 259372.1076; train_gene_expr_recon_loss: 94924.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361077.0897; train_optim_loss: 361077.0897; val_kl_reg_loss: 6625.8124; val_edge_recon_loss: 261561.1229; val_gene_expr_recon_loss: 95632.8054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363819.7401; val_optim_loss: 363819.7401
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9849; val_auprc_score: 0.9783; val_best_acc_score: 0.9602; val_best_f1_score: 0.9611; train_kl_reg_loss: 6761.6711; train_edge_recon_loss: 259462.9124; train_gene_expr_recon_loss: 94357.6221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360582.2052; train_optim_loss: 360582.2052; val_kl_reg_loss: 6594.9472; val_edge_recon_loss: 261248.6349; val_gene_expr_recon_loss: 95544.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363388.3168; val_optim_loss: 363388.3168
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9857; val_auprc_score: 0.9796; val_best_acc_score: 0.9614; val_best_f1_score: 0.9623; train_kl_reg_loss: 6753.1430; train_edge_recon_loss: 259374.5094; train_gene_expr_recon_loss: 93924.4468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360052.0985; train_optim_loss: 360052.0985; val_kl_reg_loss: 6517.4578; val_edge_recon_loss: 261307.4091; val_gene_expr_recon_loss: 94895.0462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362719.9105; val_optim_loss: 362719.9105
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9853; val_auprc_score: 0.9793; val_best_acc_score: 0.9611; val_best_f1_score: 0.9621; train_kl_reg_loss: 6742.8695; train_edge_recon_loss: 259095.8079; train_gene_expr_recon_loss: 93474.2562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359312.9323; train_optim_loss: 359312.9323; val_kl_reg_loss: 6570.5719; val_edge_recon_loss: 261642.1257; val_gene_expr_recon_loss: 94346.6048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362559.3040; val_optim_loss: 362559.3040
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9862; val_auprc_score: 0.9806; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 6715.4233; train_edge_recon_loss: 259136.7581; train_gene_expr_recon_loss: 93030.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358882.6766; train_optim_loss: 358882.6766; val_kl_reg_loss: 6682.9106; val_edge_recon_loss: 261116.9290; val_gene_expr_recon_loss: 94492.4155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362292.2543; val_optim_loss: 362292.2543
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9871; val_auprc_score: 0.9824; val_best_acc_score: 0.9618; val_best_f1_score: 0.9626; train_kl_reg_loss: 6713.3528; train_edge_recon_loss: 259114.0108; train_gene_expr_recon_loss: 92589.4737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358416.8381; train_optim_loss: 358416.8381; val_kl_reg_loss: 6628.1628; val_edge_recon_loss: 261209.5341; val_gene_expr_recon_loss: 94032.1928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361869.8920; val_optim_loss: 361869.8920
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9858; val_auprc_score: 0.9796; val_best_acc_score: 0.9618; val_best_f1_score: 0.9627; train_kl_reg_loss: 6711.3486; train_edge_recon_loss: 258887.0741; train_gene_expr_recon_loss: 92193.9992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357792.4220; train_optim_loss: 357792.4220; val_kl_reg_loss: 6582.6878; val_edge_recon_loss: 260824.6818; val_gene_expr_recon_loss: 93803.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361211.0838; val_optim_loss: 361211.0838
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9859; val_auprc_score: 0.9804; val_best_acc_score: 0.9614; val_best_f1_score: 0.9622; train_kl_reg_loss: 6701.3178; train_edge_recon_loss: 258819.6592; train_gene_expr_recon_loss: 91886.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357407.8317; train_optim_loss: 357407.8317; val_kl_reg_loss: 6473.0672; val_edge_recon_loss: 261454.1364; val_gene_expr_recon_loss: 93480.1278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361407.3338; val_optim_loss: 361407.3338
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9853; val_auprc_score: 0.9782; val_best_acc_score: 0.9622; val_best_f1_score: 0.9630; train_kl_reg_loss: 6695.9619; train_edge_recon_loss: 258849.7006; train_gene_expr_recon_loss: 91613.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357158.7244; train_optim_loss: 357158.7244; val_kl_reg_loss: 6500.6608; val_edge_recon_loss: 261141.2159; val_gene_expr_recon_loss: 93667.6051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361309.4787; val_optim_loss: 361309.4787
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9860; val_auprc_score: 0.9800; val_best_acc_score: 0.9627; val_best_f1_score: 0.9636; train_kl_reg_loss: 6694.3859; train_edge_recon_loss: 258835.5792; train_gene_expr_recon_loss: 91313.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356843.8701; train_optim_loss: 356843.8701; val_kl_reg_loss: 6518.6479; val_edge_recon_loss: 261251.5703; val_gene_expr_recon_loss: 93057.2532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360827.4744; val_optim_loss: 360827.4744
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9856; val_auprc_score: 0.9800; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 6691.2469; train_edge_recon_loss: 258674.0594; train_gene_expr_recon_loss: 91072.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356438.0330; train_optim_loss: 356438.0330; val_kl_reg_loss: 6568.1369; val_edge_recon_loss: 261348.2322; val_gene_expr_recon_loss: 93256.9613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361173.3324; val_optim_loss: 361173.3324
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9868; val_auprc_score: 0.9817; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 6690.8102; train_edge_recon_loss: 258682.0756; train_gene_expr_recon_loss: 90755.6847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356128.5695; train_optim_loss: 356128.5695; val_kl_reg_loss: 6550.7913; val_edge_recon_loss: 260928.0007; val_gene_expr_recon_loss: 92905.8626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360384.6506; val_optim_loss: 360384.6506
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9872; val_auprc_score: 0.9817; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 6686.5391; train_edge_recon_loss: 258661.6280; train_gene_expr_recon_loss: 90546.7933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355894.9611; train_optim_loss: 355894.9611; val_kl_reg_loss: 6533.7410; val_edge_recon_loss: 260644.1555; val_gene_expr_recon_loss: 92893.2976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360071.1974; val_optim_loss: 360071.1974
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9866; val_auprc_score: 0.9809; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 6674.7144; train_edge_recon_loss: 258539.1709; train_gene_expr_recon_loss: 90300.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355514.5309; train_optim_loss: 355514.5309; val_kl_reg_loss: 6546.2349; val_edge_recon_loss: 261167.0561; val_gene_expr_recon_loss: 92607.2777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360320.5653; val_optim_loss: 360320.5653
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9884; val_auprc_score: 0.9843; val_best_acc_score: 0.9647; val_best_f1_score: 0.9653; train_kl_reg_loss: 6683.2629; train_edge_recon_loss: 258587.8005; train_gene_expr_recon_loss: 90033.6012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355304.6662; train_optim_loss: 355304.6662; val_kl_reg_loss: 6502.6773; val_edge_recon_loss: 260775.7621; val_gene_expr_recon_loss: 92749.4815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360027.9219; val_optim_loss: 360027.9219
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9874; val_auprc_score: 0.9818; val_best_acc_score: 0.9651; val_best_f1_score: 0.9658; train_kl_reg_loss: 6671.9970; train_edge_recon_loss: 258448.1326; train_gene_expr_recon_loss: 89800.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354920.1649; train_optim_loss: 354920.1649; val_kl_reg_loss: 6599.8193; val_edge_recon_loss: 260535.4070; val_gene_expr_recon_loss: 92718.2752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359853.4972; val_optim_loss: 359853.4972
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9869; val_auprc_score: 0.9814; val_best_acc_score: 0.9637; val_best_f1_score: 0.9645; train_kl_reg_loss: 6677.2281; train_edge_recon_loss: 258423.8957; train_gene_expr_recon_loss: 89605.6357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354706.7568; train_optim_loss: 354706.7568; val_kl_reg_loss: 6571.2111; val_edge_recon_loss: 260444.0476; val_gene_expr_recon_loss: 92636.0803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359651.3381; val_optim_loss: 359651.3381
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9875; val_auprc_score: 0.9829; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 6682.0296; train_edge_recon_loss: 258368.0492; train_gene_expr_recon_loss: 89563.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354613.0858; train_optim_loss: 354613.0858; val_kl_reg_loss: 6553.4411; val_edge_recon_loss: 260683.3800; val_gene_expr_recon_loss: 92581.8558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359818.6747; val_optim_loss: 359818.6747
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9881; val_auprc_score: 0.9829; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 6687.9852; train_edge_recon_loss: 258211.3831; train_gene_expr_recon_loss: 89280.0638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354179.4323; train_optim_loss: 354179.4323; val_kl_reg_loss: 6557.8289; val_edge_recon_loss: 260284.5675; val_gene_expr_recon_loss: 92164.9212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359007.3182; val_optim_loss: 359007.3182
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9879; val_auprc_score: 0.9829; val_best_acc_score: 0.9649; val_best_f1_score: 0.9655; train_kl_reg_loss: 6688.9594; train_edge_recon_loss: 258106.2791; train_gene_expr_recon_loss: 89137.8150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353933.0521; train_optim_loss: 353933.0521; val_kl_reg_loss: 6574.8743; val_edge_recon_loss: 260221.4411; val_gene_expr_recon_loss: 92258.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359055.1364; val_optim_loss: 359055.1364
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9878; val_auprc_score: 0.9835; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 6680.5749; train_edge_recon_loss: 258202.1136; train_gene_expr_recon_loss: 88909.6423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353792.3299; train_optim_loss: 353792.3299; val_kl_reg_loss: 6578.2909; val_edge_recon_loss: 260477.7571; val_gene_expr_recon_loss: 92529.2908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359585.3395; val_optim_loss: 359585.3395
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9881; val_auprc_score: 0.9839; val_best_acc_score: 0.9643; val_best_f1_score: 0.9650; train_kl_reg_loss: 6682.3947; train_edge_recon_loss: 258268.3358; train_gene_expr_recon_loss: 88709.7753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353660.5060; train_optim_loss: 353660.5060; val_kl_reg_loss: 6496.1863; val_edge_recon_loss: 260906.3210; val_gene_expr_recon_loss: 92090.0128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359492.5213; val_optim_loss: 359492.5213
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9880; val_auprc_score: 0.9833; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 6677.6551; train_edge_recon_loss: 258089.6383; train_gene_expr_recon_loss: 88628.1802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353395.4738; train_optim_loss: 353395.4738; val_kl_reg_loss: 6562.6900; val_edge_recon_loss: 260359.8054; val_gene_expr_recon_loss: 92009.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358932.3565; val_optim_loss: 358932.3565
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9896; val_auprc_score: 0.9861; val_best_acc_score: 0.9671; val_best_f1_score: 0.9676; train_kl_reg_loss: 6678.0582; train_edge_recon_loss: 258135.9373; train_gene_expr_recon_loss: 88523.0036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353336.9993; train_optim_loss: 353336.9993; val_kl_reg_loss: 6498.8110; val_edge_recon_loss: 260111.9908; val_gene_expr_recon_loss: 92386.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358997.4162; val_optim_loss: 358997.4162
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9881; val_auprc_score: 0.9831; val_best_acc_score: 0.9658; val_best_f1_score: 0.9664; train_kl_reg_loss: 6681.0007; train_edge_recon_loss: 257960.4618; train_gene_expr_recon_loss: 88313.2425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352954.7052; train_optim_loss: 352954.7052; val_kl_reg_loss: 6589.4007; val_edge_recon_loss: 260482.7273; val_gene_expr_recon_loss: 92086.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359158.7372; val_optim_loss: 359158.7372
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9879; val_auprc_score: 0.9836; val_best_acc_score: 0.9647; val_best_f1_score: 0.9653; train_kl_reg_loss: 6689.6746; train_edge_recon_loss: 257961.2249; train_gene_expr_recon_loss: 88176.7323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352827.6317; train_optim_loss: 352827.6317; val_kl_reg_loss: 6573.8946; val_edge_recon_loss: 260447.2848; val_gene_expr_recon_loss: 92188.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359209.3253; val_optim_loss: 359209.3253
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9893; val_auprc_score: 0.9850; val_best_acc_score: 0.9668; val_best_f1_score: 0.9675; train_kl_reg_loss: 6692.9778; train_edge_recon_loss: 257880.0455; train_gene_expr_recon_loss: 88038.2067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352611.2308; train_optim_loss: 352611.2308; val_kl_reg_loss: 6486.8878; val_edge_recon_loss: 260091.1811; val_gene_expr_recon_loss: 92097.2259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358675.2912; val_optim_loss: 358675.2912
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9878; val_auprc_score: 0.9820; val_best_acc_score: 0.9646; val_best_f1_score: 0.9652; train_kl_reg_loss: 6682.2548; train_edge_recon_loss: 258039.3599; train_gene_expr_recon_loss: 87962.1521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352683.7687; train_optim_loss: 352683.7687; val_kl_reg_loss: 6539.6349; val_edge_recon_loss: 260906.2017; val_gene_expr_recon_loss: 92169.1222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359614.9602; val_optim_loss: 359614.9602
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9888; val_auprc_score: 0.9845; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 6690.6732; train_edge_recon_loss: 257924.7883; train_gene_expr_recon_loss: 87812.0731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352427.5345; train_optim_loss: 352427.5345; val_kl_reg_loss: 6599.1403; val_edge_recon_loss: 260188.3615; val_gene_expr_recon_loss: 92146.7255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358934.2259; val_optim_loss: 358934.2259
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9887; val_auprc_score: 0.9836; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 6699.4609; train_edge_recon_loss: 257828.6693; train_gene_expr_recon_loss: 87680.9471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352209.0758; train_optim_loss: 352209.0758; val_kl_reg_loss: 6624.5864; val_edge_recon_loss: 260514.2805; val_gene_expr_recon_loss: 92251.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359390.2557; val_optim_loss: 359390.2557
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9898; val_auprc_score: 0.9861; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 6695.6510; train_edge_recon_loss: 257929.2699; train_gene_expr_recon_loss: 87553.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352178.8914; train_optim_loss: 352178.8914; val_kl_reg_loss: 6515.0061; val_edge_recon_loss: 260093.9943; val_gene_expr_recon_loss: 92157.4712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358766.4787; val_optim_loss: 358766.4787

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9893; val_auprc_score: 0.9856; val_best_acc_score: 0.9671; val_best_f1_score: 0.9678; train_kl_reg_loss: 6668.6133; train_edge_recon_loss: 257686.4672; train_gene_expr_recon_loss: 86858.9002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351213.9814; train_optim_loss: 351213.9814; val_kl_reg_loss: 6553.2977; val_edge_recon_loss: 260052.4432; val_gene_expr_recon_loss: 91679.6080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358285.3494; val_optim_loss: 358285.3494
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9901; val_auprc_score: 0.9863; val_best_acc_score: 0.9689; val_best_f1_score: 0.9693; train_kl_reg_loss: 6663.5385; train_edge_recon_loss: 257688.1493; train_gene_expr_recon_loss: 86827.7937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351179.4827; train_optim_loss: 351179.4827; val_kl_reg_loss: 6539.8690; val_edge_recon_loss: 259468.8949; val_gene_expr_recon_loss: 91869.8288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357878.5938; val_optim_loss: 357878.5938
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9900; val_auprc_score: 0.9865; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 6657.4090; train_edge_recon_loss: 257651.9855; train_gene_expr_recon_loss: 86735.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351044.6226; train_optim_loss: 351044.6226; val_kl_reg_loss: 6552.8712; val_edge_recon_loss: 259835.2770; val_gene_expr_recon_loss: 91675.9982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358064.1477; val_optim_loss: 358064.1477
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9897; val_auprc_score: 0.9855; val_best_acc_score: 0.9676; val_best_f1_score: 0.9681; train_kl_reg_loss: 6654.0205; train_edge_recon_loss: 257614.0007; train_gene_expr_recon_loss: 86666.8645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350934.8848; train_optim_loss: 350934.8848; val_kl_reg_loss: 6543.8002; val_edge_recon_loss: 259954.7408; val_gene_expr_recon_loss: 91807.1896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358305.7273; val_optim_loss: 358305.7273
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9896; val_auprc_score: 0.9852; val_best_acc_score: 0.9673; val_best_f1_score: 0.9679; train_kl_reg_loss: 6656.3857; train_edge_recon_loss: 257768.5513; train_gene_expr_recon_loss: 86785.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351210.9098; train_optim_loss: 351210.9098; val_kl_reg_loss: 6524.7632; val_edge_recon_loss: 260148.3224; val_gene_expr_recon_loss: 91655.8015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358328.8849; val_optim_loss: 358328.8849
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9896; val_auprc_score: 0.9855; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 6643.4421; train_edge_recon_loss: 257639.2455; train_gene_expr_recon_loss: 86658.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350941.2236; train_optim_loss: 350941.2236; val_kl_reg_loss: 6516.7620; val_edge_recon_loss: 260042.0646; val_gene_expr_recon_loss: 91854.7390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358413.5682; val_optim_loss: 358413.5682

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9894; val_auprc_score: 0.9852; val_best_acc_score: 0.9669; val_best_f1_score: 0.9675; train_kl_reg_loss: 6637.7432; train_edge_recon_loss: 257778.9601; train_gene_expr_recon_loss: 86679.3874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351096.0908; train_optim_loss: 351096.0908; val_kl_reg_loss: 6516.5699; val_edge_recon_loss: 260399.8544; val_gene_expr_recon_loss: 91832.0305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358748.4545; val_optim_loss: 358748.4545
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9900; val_auprc_score: 0.9863; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 6642.3148; train_edge_recon_loss: 257527.6934; train_gene_expr_recon_loss: 86601.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350771.2866; train_optim_loss: 350771.2866; val_kl_reg_loss: 6533.8373; val_edge_recon_loss: 259819.3594; val_gene_expr_recon_loss: 91912.0614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358265.2557; val_optim_loss: 358265.2557
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9904; val_auprc_score: 0.9869; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 6648.8522; train_edge_recon_loss: 257661.4513; train_gene_expr_recon_loss: 86572.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350882.6520; train_optim_loss: 350882.6520; val_kl_reg_loss: 6523.1555; val_edge_recon_loss: 259649.1598; val_gene_expr_recon_loss: 91904.6623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358076.9787; val_optim_loss: 358076.9787
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9895; val_auprc_score: 0.9846; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 6647.9799; train_edge_recon_loss: 257587.2023; train_gene_expr_recon_loss: 86614.6471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350849.8286; train_optim_loss: 350849.8286; val_kl_reg_loss: 6524.0206; val_edge_recon_loss: 260015.2997; val_gene_expr_recon_loss: 91722.4705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358261.7884; val_optim_loss: 358261.7884

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 29 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9893
Val AUPRC score: 0.9853
Val best accuracy score: 0.9667
Val best F1 score: 0.9674
Val gene expr MSE score: 0.6552

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
