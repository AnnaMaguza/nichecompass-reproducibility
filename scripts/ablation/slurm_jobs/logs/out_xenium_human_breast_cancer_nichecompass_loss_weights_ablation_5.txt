None
Run timestamp: 13072023_224515_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1254, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1254, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9236; val_auprc_score: 0.9031; val_best_acc_score: 0.8570; val_best_f1_score: 0.8655; train_kl_reg_loss: 63487.9046; train_edge_recon_loss: 2884323.3897; train_gene_expr_recon_loss: 7332432.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10280244.0588; train_optim_loss: 10280244.0588; val_kl_reg_loss: 56518.9578; val_edge_recon_loss: 2777434.9803; val_gene_expr_recon_loss: 6769420.7039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9603374.6184; val_optim_loss: 9603374.6184
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9402; val_auprc_score: 0.9239; val_best_acc_score: 0.8778; val_best_f1_score: 0.8851; train_kl_reg_loss: 52547.7266; train_edge_recon_loss: 2705024.9798; train_gene_expr_recon_loss: 6610341.3103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9367914.0191; train_optim_loss: 9367914.0191; val_kl_reg_loss: 47576.7280; val_edge_recon_loss: 2734013.4211; val_gene_expr_recon_loss: 6479923.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9261513.7500; val_optim_loss: 9261513.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9464; val_auprc_score: 0.9324; val_best_acc_score: 0.8849; val_best_f1_score: 0.8921; train_kl_reg_loss: 45061.8351; train_edge_recon_loss: 2680955.1044; train_gene_expr_recon_loss: 6368511.2838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9094528.2353; train_optim_loss: 9094528.2353; val_kl_reg_loss: 41011.0043; val_edge_recon_loss: 2723332.7763; val_gene_expr_recon_loss: 6297471.3816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9061815.1842; val_optim_loss: 9061815.1842
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9522; val_auprc_score: 0.9401; val_best_acc_score: 0.8923; val_best_f1_score: 0.8981; train_kl_reg_loss: 40749.4552; train_edge_recon_loss: 2673003.3853; train_gene_expr_recon_loss: 6213213.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8926966.6176; train_optim_loss: 8926966.6176; val_kl_reg_loss: 38216.7523; val_edge_recon_loss: 2711919.9013; val_gene_expr_recon_loss: 6186311.2303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8936447.8947; val_optim_loss: 8936447.8947
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9552; val_auprc_score: 0.9438; val_best_acc_score: 0.8966; val_best_f1_score: 0.9019; train_kl_reg_loss: 38515.6948; train_edge_recon_loss: 2666459.2496; train_gene_expr_recon_loss: 6118240.8559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8823215.7985; train_optim_loss: 8823215.7985; val_kl_reg_loss: 36742.1242; val_edge_recon_loss: 2709716.6645; val_gene_expr_recon_loss: 6106378.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8852836.9737; val_optim_loss: 8852836.9737
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9576; val_auprc_score: 0.9468; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 37093.8963; train_edge_recon_loss: 2660889.2585; train_gene_expr_recon_loss: 6054687.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8752670.4890; train_optim_loss: 8752670.4890; val_kl_reg_loss: 35463.7974; val_edge_recon_loss: 2711009.2138; val_gene_expr_recon_loss: 6079784.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8826257.5526; val_optim_loss: 8826257.5526
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9592; val_auprc_score: 0.9490; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 36240.7393; train_edge_recon_loss: 2655688.9588; train_gene_expr_recon_loss: 6014659.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8706588.8228; train_optim_loss: 8706588.8228; val_kl_reg_loss: 34957.2668; val_edge_recon_loss: 2708070.1743; val_gene_expr_recon_loss: 6023429.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8766457.1316; val_optim_loss: 8766457.1316
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9606; val_auprc_score: 0.9509; val_best_acc_score: 0.9035; val_best_f1_score: 0.9080; train_kl_reg_loss: 35417.8420; train_edge_recon_loss: 2651971.2779; train_gene_expr_recon_loss: 5980749.0088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8668138.1206; train_optim_loss: 8668138.1206; val_kl_reg_loss: 34448.9744; val_edge_recon_loss: 2703294.5724; val_gene_expr_recon_loss: 5997018.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8734761.5921; val_optim_loss: 8734761.5921
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9623; val_auprc_score: 0.9526; val_best_acc_score: 0.9062; val_best_f1_score: 0.9105; train_kl_reg_loss: 34666.1248; train_edge_recon_loss: 2647719.2721; train_gene_expr_recon_loss: 5961288.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8643673.8831; train_optim_loss: 8643673.8831; val_kl_reg_loss: 33543.7432; val_edge_recon_loss: 2704730.4836; val_gene_expr_recon_loss: 5989929.0066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8728203.2895; val_optim_loss: 8728203.2895
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9634; val_auprc_score: 0.9544; val_best_acc_score: 0.9072; val_best_f1_score: 0.9118; train_kl_reg_loss: 34076.9866; train_edge_recon_loss: 2647869.8813; train_gene_expr_recon_loss: 5942906.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8624853.8140; train_optim_loss: 8624853.8140; val_kl_reg_loss: 32831.0211; val_edge_recon_loss: 2701794.0987; val_gene_expr_recon_loss: 5982014.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8716639.9934; val_optim_loss: 8716639.9934
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9660; val_auprc_score: 0.9581; val_best_acc_score: 0.9113; val_best_f1_score: 0.9151; train_kl_reg_loss: 33530.0780; train_edge_recon_loss: 2647574.9890; train_gene_expr_recon_loss: 5927154.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8608259.4912; train_optim_loss: 8608259.4912; val_kl_reg_loss: 32333.1218; val_edge_recon_loss: 2697441.4178; val_gene_expr_recon_loss: 5975878.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8705652.6184; val_optim_loss: 8705652.6184
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9666; val_auprc_score: 0.9587; val_best_acc_score: 0.9127; val_best_f1_score: 0.9162; train_kl_reg_loss: 32917.7315; train_edge_recon_loss: 2644543.0603; train_gene_expr_recon_loss: 5919423.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8596884.1522; train_optim_loss: 8596884.1522; val_kl_reg_loss: 31535.8426; val_edge_recon_loss: 2694764.8125; val_gene_expr_recon_loss: 5955865.7763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8682166.3947; val_optim_loss: 8682166.3947
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9672; val_auprc_score: 0.9593; val_best_acc_score: 0.9133; val_best_f1_score: 0.9169; train_kl_reg_loss: 32468.5127; train_edge_recon_loss: 2643302.2687; train_gene_expr_recon_loss: 5907576.9743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8583347.7522; train_optim_loss: 8583347.7522; val_kl_reg_loss: 31393.3355; val_edge_recon_loss: 2696231.1349; val_gene_expr_recon_loss: 5934984.7039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8662609.1842; val_optim_loss: 8662609.1842
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9674; val_auprc_score: 0.9597; val_best_acc_score: 0.9138; val_best_f1_score: 0.9176; train_kl_reg_loss: 32073.2018; train_edge_recon_loss: 2640493.8897; train_gene_expr_recon_loss: 5903272.1588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8575839.2537; train_optim_loss: 8575839.2537; val_kl_reg_loss: 31214.4525; val_edge_recon_loss: 2696374.4178; val_gene_expr_recon_loss: 5942692.1316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8670281.0263; val_optim_loss: 8670281.0263
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9675; val_auprc_score: 0.9593; val_best_acc_score: 0.9151; val_best_f1_score: 0.9183; train_kl_reg_loss: 31781.4419; train_edge_recon_loss: 2639855.2460; train_gene_expr_recon_loss: 5896071.5235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8567708.1941; train_optim_loss: 8567708.1941; val_kl_reg_loss: 30689.2001; val_edge_recon_loss: 2698415.8322; val_gene_expr_recon_loss: 5945319.4013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8674424.4211; val_optim_loss: 8674424.4211
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9688; val_auprc_score: 0.9610; val_best_acc_score: 0.9173; val_best_f1_score: 0.9200; train_kl_reg_loss: 31411.2686; train_edge_recon_loss: 2637729.0408; train_gene_expr_recon_loss: 5889497.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8558637.5000; train_optim_loss: 8558637.5000; val_kl_reg_loss: 30099.0845; val_edge_recon_loss: 2693016.8421; val_gene_expr_recon_loss: 5943722.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8666838.4474; val_optim_loss: 8666838.4474
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9700; val_auprc_score: 0.9625; val_best_acc_score: 0.9189; val_best_f1_score: 0.9218; train_kl_reg_loss: 31275.7433; train_edge_recon_loss: 2636972.8085; train_gene_expr_recon_loss: 5886684.3272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8554932.8941; train_optim_loss: 8554932.8941; val_kl_reg_loss: 30092.7022; val_edge_recon_loss: 2689545.1743; val_gene_expr_recon_loss: 5939399.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8659036.9474; val_optim_loss: 8659036.9474
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9696; val_auprc_score: 0.9624; val_best_acc_score: 0.9186; val_best_f1_score: 0.9213; train_kl_reg_loss: 30805.8545; train_edge_recon_loss: 2636986.6989; train_gene_expr_recon_loss: 5878816.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8546609.5559; train_optim_loss: 8546609.5559; val_kl_reg_loss: 29819.8938; val_edge_recon_loss: 2692129.2928; val_gene_expr_recon_loss: 5921583.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8643532.1974; val_optim_loss: 8643532.1974
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9704; val_auprc_score: 0.9635; val_best_acc_score: 0.9202; val_best_f1_score: 0.9228; train_kl_reg_loss: 30697.4559; train_edge_recon_loss: 2635387.4489; train_gene_expr_recon_loss: 5876350.7382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8542435.6537; train_optim_loss: 8542435.6537; val_kl_reg_loss: 29668.1151; val_edge_recon_loss: 2689104.6612; val_gene_expr_recon_loss: 5920680.1711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8639452.9211; val_optim_loss: 8639452.9211
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9708; val_auprc_score: 0.9632; val_best_acc_score: 0.9203; val_best_f1_score: 0.9230; train_kl_reg_loss: 30230.2825; train_edge_recon_loss: 2634368.6114; train_gene_expr_recon_loss: 5876682.7316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8541281.6162; train_optim_loss: 8541281.6162; val_kl_reg_loss: 29385.6707; val_edge_recon_loss: 2686489.0822; val_gene_expr_recon_loss: 5916110.5855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8631985.3684; val_optim_loss: 8631985.3684
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9711; val_auprc_score: 0.9640; val_best_acc_score: 0.9211; val_best_f1_score: 0.9237; train_kl_reg_loss: 30171.0982; train_edge_recon_loss: 2632625.7879; train_gene_expr_recon_loss: 5873753.4522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8536550.3301; train_optim_loss: 8536550.3301; val_kl_reg_loss: 29513.1974; val_edge_recon_loss: 2682275.1546; val_gene_expr_recon_loss: 5920379.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8632167.4211; val_optim_loss: 8632167.4211
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9717; val_auprc_score: 0.9652; val_best_acc_score: 0.9212; val_best_f1_score: 0.9240; train_kl_reg_loss: 30109.5652; train_edge_recon_loss: 2632756.3529; train_gene_expr_recon_loss: 5870442.9640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8533308.8500; train_optim_loss: 8533308.8500; val_kl_reg_loss: 28725.4556; val_edge_recon_loss: 2686775.6414; val_gene_expr_recon_loss: 5911932.0329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8627433.1316; val_optim_loss: 8627433.1316
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9702; val_auprc_score: 0.9624; val_best_acc_score: 0.9201; val_best_f1_score: 0.9229; train_kl_reg_loss: 29932.9892; train_edge_recon_loss: 2632087.7500; train_gene_expr_recon_loss: 5864330.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8526350.9419; train_optim_loss: 8526350.9419; val_kl_reg_loss: 29261.2501; val_edge_recon_loss: 2688846.9178; val_gene_expr_recon_loss: 5896458.4342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8614566.6250; val_optim_loss: 8614566.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9720; val_auprc_score: 0.9654; val_best_acc_score: 0.9225; val_best_f1_score: 0.9253; train_kl_reg_loss: 29550.8341; train_edge_recon_loss: 2632858.3489; train_gene_expr_recon_loss: 5865174.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8527583.2478; train_optim_loss: 8527583.2478; val_kl_reg_loss: 28895.9282; val_edge_recon_loss: 2683637.2862; val_gene_expr_recon_loss: 5922717.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8635250.5921; val_optim_loss: 8635250.5921
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9712; val_auprc_score: 0.9640; val_best_acc_score: 0.9220; val_best_f1_score: 0.9245; train_kl_reg_loss: 29383.8918; train_edge_recon_loss: 2631604.3890; train_gene_expr_recon_loss: 5862797.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8523786.1507; train_optim_loss: 8523786.1507; val_kl_reg_loss: 28699.2504; val_edge_recon_loss: 2684628.0493; val_gene_expr_recon_loss: 5906269.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8619596.5263; val_optim_loss: 8619596.5263
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9725; val_auprc_score: 0.9657; val_best_acc_score: 0.9244; val_best_f1_score: 0.9268; train_kl_reg_loss: 29225.4096; train_edge_recon_loss: 2632108.9971; train_gene_expr_recon_loss: 5861234.9287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522569.3456; train_optim_loss: 8522569.3456; val_kl_reg_loss: 28362.6377; val_edge_recon_loss: 2684440.6382; val_gene_expr_recon_loss: 5901484.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8614288.0526; val_optim_loss: 8614288.0526
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9714; val_auprc_score: 0.9639; val_best_acc_score: 0.9223; val_best_f1_score: 0.9249; train_kl_reg_loss: 29158.6617; train_edge_recon_loss: 2629990.3993; train_gene_expr_recon_loss: 5859360.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8518509.5140; train_optim_loss: 8518509.5140; val_kl_reg_loss: 28240.6376; val_edge_recon_loss: 2683451.6513; val_gene_expr_recon_loss: 5922153.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8633845.5000; val_optim_loss: 8633845.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9724; val_auprc_score: 0.9652; val_best_acc_score: 0.9236; val_best_f1_score: 0.9261; train_kl_reg_loss: 28809.5159; train_edge_recon_loss: 2631562.8813; train_gene_expr_recon_loss: 5858942.8162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8519315.2066; train_optim_loss: 8519315.2066; val_kl_reg_loss: 28232.7515; val_edge_recon_loss: 2682444.5789; val_gene_expr_recon_loss: 5909725.3487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8620402.6579; val_optim_loss: 8620402.6579
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9727; val_auprc_score: 0.9660; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 28871.6516; train_edge_recon_loss: 2629632.7092; train_gene_expr_recon_loss: 5854264.0390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8512768.3926; train_optim_loss: 8512768.3926; val_kl_reg_loss: 27864.6680; val_edge_recon_loss: 2680172.3487; val_gene_expr_recon_loss: 5906048.5526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8614085.5724; val_optim_loss: 8614085.5724
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9665; val_best_acc_score: 0.9228; val_best_f1_score: 0.9256; train_kl_reg_loss: 28647.3697; train_edge_recon_loss: 2628472.2640; train_gene_expr_recon_loss: 5855455.7206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8512575.3662; train_optim_loss: 8512575.3662; val_kl_reg_loss: 27625.0117; val_edge_recon_loss: 2682949.7072; val_gene_expr_recon_loss: 5902906.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8613480.7105; val_optim_loss: 8613480.7105
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9725; val_auprc_score: 0.9656; val_best_acc_score: 0.9234; val_best_f1_score: 0.9261; train_kl_reg_loss: 28450.3072; train_edge_recon_loss: 2628024.2110; train_gene_expr_recon_loss: 5854309.8728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8510784.3765; train_optim_loss: 8510784.3765; val_kl_reg_loss: 27399.5223; val_edge_recon_loss: 2681585.5164; val_gene_expr_recon_loss: 5914448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8623433.0132; val_optim_loss: 8623433.0132
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9725; val_auprc_score: 0.9653; val_best_acc_score: 0.9236; val_best_f1_score: 0.9261; train_kl_reg_loss: 28389.6142; train_edge_recon_loss: 2627492.1408; train_gene_expr_recon_loss: 5850500.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8506382.6221; train_optim_loss: 8506382.6221; val_kl_reg_loss: 27355.1100; val_edge_recon_loss: 2681168.9342; val_gene_expr_recon_loss: 5920710.0197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8629234.0132; val_optim_loss: 8629234.0132
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9728; val_auprc_score: 0.9662; val_best_acc_score: 0.9241; val_best_f1_score: 0.9267; train_kl_reg_loss: 28175.1243; train_edge_recon_loss: 2628153.5625; train_gene_expr_recon_loss: 5851539.6132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8507868.2882; train_optim_loss: 8507868.2882; val_kl_reg_loss: 27504.9471; val_edge_recon_loss: 2688036.8355; val_gene_expr_recon_loss: 5909316.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8624857.8553; val_optim_loss: 8624857.8553
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9740; val_auprc_score: 0.9675; val_best_acc_score: 0.9254; val_best_f1_score: 0.9276; train_kl_reg_loss: 28180.3525; train_edge_recon_loss: 2626286.5857; train_gene_expr_recon_loss: 5848076.4456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8502543.3735; train_optim_loss: 8502543.3735; val_kl_reg_loss: 26956.6850; val_edge_recon_loss: 2681343.0395; val_gene_expr_recon_loss: 5917956.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8626256.0658; val_optim_loss: 8626256.0658

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9740; val_auprc_score: 0.9679; val_best_acc_score: 0.9262; val_best_f1_score: 0.9283; train_kl_reg_loss: 28316.4210; train_edge_recon_loss: 2627036.4504; train_gene_expr_recon_loss: 5815734.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8471086.9132; train_optim_loss: 8471086.9132; val_kl_reg_loss: 27654.0108; val_edge_recon_loss: 2680551.3224; val_gene_expr_recon_loss: 5889396.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8597601.7500; val_optim_loss: 8597601.7500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9729; val_auprc_score: 0.9662; val_best_acc_score: 0.9247; val_best_f1_score: 0.9272; train_kl_reg_loss: 28678.1169; train_edge_recon_loss: 2626021.0327; train_gene_expr_recon_loss: 5814760.5640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8469459.7184; train_optim_loss: 8469459.7184; val_kl_reg_loss: 27943.0263; val_edge_recon_loss: 2682092.7303; val_gene_expr_recon_loss: 5875276.8355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8585312.6118; val_optim_loss: 8585312.6118
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9726; val_auprc_score: 0.9655; val_best_acc_score: 0.9239; val_best_f1_score: 0.9266; train_kl_reg_loss: 28730.7013; train_edge_recon_loss: 2624556.4290; train_gene_expr_recon_loss: 5812999.4846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8466286.6066; train_optim_loss: 8466286.6066; val_kl_reg_loss: 28111.4918; val_edge_recon_loss: 2683190.2533; val_gene_expr_recon_loss: 5883351.5066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8594653.2632; val_optim_loss: 8594653.2632
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9732; val_auprc_score: 0.9665; val_best_acc_score: 0.9250; val_best_f1_score: 0.9273; train_kl_reg_loss: 28802.9931; train_edge_recon_loss: 2624818.6268; train_gene_expr_recon_loss: 5808472.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8462094.5699; train_optim_loss: 8462094.5699; val_kl_reg_loss: 28115.6342; val_edge_recon_loss: 2681290.0526; val_gene_expr_recon_loss: 5883460.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8592866.1250; val_optim_loss: 8592866.1250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9732; val_auprc_score: 0.9662; val_best_acc_score: 0.9257; val_best_f1_score: 0.9282; train_kl_reg_loss: 28752.0791; train_edge_recon_loss: 2624545.0860; train_gene_expr_recon_loss: 5811821.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8465118.3316; train_optim_loss: 8465118.3316; val_kl_reg_loss: 28004.3401; val_edge_recon_loss: 2678541.1283; val_gene_expr_recon_loss: 5877340.3026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8583885.7500; val_optim_loss: 8583885.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9738; val_auprc_score: 0.9678; val_best_acc_score: 0.9260; val_best_f1_score: 0.9280; train_kl_reg_loss: 28738.5754; train_edge_recon_loss: 2623054.3438; train_gene_expr_recon_loss: 5809761.5206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8461554.4353; train_optim_loss: 8461554.4353; val_kl_reg_loss: 27956.7083; val_edge_recon_loss: 2681414.1316; val_gene_expr_recon_loss: 5881940.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8591311.3092; val_optim_loss: 8591311.3092
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9740; val_auprc_score: 0.9680; val_best_acc_score: 0.9256; val_best_f1_score: 0.9279; train_kl_reg_loss: 28753.2104; train_edge_recon_loss: 2625017.7548; train_gene_expr_recon_loss: 5811816.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8465587.1206; train_optim_loss: 8465587.1206; val_kl_reg_loss: 27875.8192; val_edge_recon_loss: 2679763.1513; val_gene_expr_recon_loss: 5865431.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8573070.3618; val_optim_loss: 8573070.3618
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9737; val_auprc_score: 0.9668; val_best_acc_score: 0.9262; val_best_f1_score: 0.9281; train_kl_reg_loss: 28683.6623; train_edge_recon_loss: 2625541.0338; train_gene_expr_recon_loss: 5808312.3441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8462537.0331; train_optim_loss: 8462537.0331; val_kl_reg_loss: 27936.0164; val_edge_recon_loss: 2677251.6908; val_gene_expr_recon_loss: 5877805.4671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8582993.2500; val_optim_loss: 8582993.2500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9728; val_auprc_score: 0.9659; val_best_acc_score: 0.9249; val_best_f1_score: 0.9272; train_kl_reg_loss: 28585.0233; train_edge_recon_loss: 2625144.1805; train_gene_expr_recon_loss: 5811828.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8465557.2368; train_optim_loss: 8465557.2368; val_kl_reg_loss: 27746.4870; val_edge_recon_loss: 2682300.3618; val_gene_expr_recon_loss: 5865128.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8575175.3618; val_optim_loss: 8575175.3618
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9744; val_auprc_score: 0.9681; val_best_acc_score: 0.9271; val_best_f1_score: 0.9293; train_kl_reg_loss: 28525.8026; train_edge_recon_loss: 2625402.9371; train_gene_expr_recon_loss: 5809110.3059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8463039.0507; train_optim_loss: 8463039.0507; val_kl_reg_loss: 27760.0787; val_edge_recon_loss: 2675735.7039; val_gene_expr_recon_loss: 5874748.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8578243.7961; val_optim_loss: 8578243.7961
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9731; val_auprc_score: 0.9665; val_best_acc_score: 0.9246; val_best_f1_score: 0.9268; train_kl_reg_loss: 28510.3158; train_edge_recon_loss: 2623803.4717; train_gene_expr_recon_loss: 5807291.3912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8459605.1831; train_optim_loss: 8459605.1831; val_kl_reg_loss: 27841.9272; val_edge_recon_loss: 2683318.3191; val_gene_expr_recon_loss: 5865227.9605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8576388.1250; val_optim_loss: 8576388.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9737; val_auprc_score: 0.9671; val_best_acc_score: 0.9253; val_best_f1_score: 0.9273; train_kl_reg_loss: 28606.2597; train_edge_recon_loss: 2621510.9114; train_gene_expr_recon_loss: 5802425.0375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8452542.2125; train_optim_loss: 8452542.2125; val_kl_reg_loss: 27817.6714; val_edge_recon_loss: 2680699.6020; val_gene_expr_recon_loss: 5875366.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8583883.4868; val_optim_loss: 8583883.4868
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9741; val_auprc_score: 0.9678; val_best_acc_score: 0.9275; val_best_f1_score: 0.9292; train_kl_reg_loss: 28599.9528; train_edge_recon_loss: 2625148.8346; train_gene_expr_recon_loss: 5804963.9118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8458712.6956; train_optim_loss: 8458712.6956; val_kl_reg_loss: 27844.5145; val_edge_recon_loss: 2677393.7796; val_gene_expr_recon_loss: 5881313.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8586551.3487; val_optim_loss: 8586551.3487
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9738; val_auprc_score: 0.9676; val_best_acc_score: 0.9255; val_best_f1_score: 0.9279; train_kl_reg_loss: 28611.3690; train_edge_recon_loss: 2623929.6460; train_gene_expr_recon_loss: 5806318.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8458859.8118; train_optim_loss: 8458859.8118; val_kl_reg_loss: 27881.0758; val_edge_recon_loss: 2678607.7368; val_gene_expr_recon_loss: 5876784.6776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8583273.5526; val_optim_loss: 8583273.5526
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9738; val_auprc_score: 0.9676; val_best_acc_score: 0.9254; val_best_f1_score: 0.9278; train_kl_reg_loss: 28585.0349; train_edge_recon_loss: 2625178.3985; train_gene_expr_recon_loss: 5804343.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8458106.7846; train_optim_loss: 8458106.7846; val_kl_reg_loss: 27849.1278; val_edge_recon_loss: 2679127.4046; val_gene_expr_recon_loss: 5883816.9737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8590793.4803; val_optim_loss: 8590793.4803

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 86 min 5 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9741
Val AUPRC score: 0.9680
Val best accuracy score: 0.9260
Val best F1 score: 0.9283
Val gene expr MSE score: 1.3678

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
