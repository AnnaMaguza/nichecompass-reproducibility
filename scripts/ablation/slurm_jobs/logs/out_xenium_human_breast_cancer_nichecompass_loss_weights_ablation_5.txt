None
Run timestamp: 30062023_140140_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
heaps
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9231; val_auprc_score: 0.9152; val_best_acc_score: 0.8423; val_best_f1_score: 0.8478; train_kl_reg_loss: 571.1262; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 8030.8772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8602.0034; train_optim_loss: 8602.0034; val_kl_reg_loss: 542.7197; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 7070.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7613.3642; val_optim_loss: 7613.3642
heaps
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9276; val_auprc_score: 0.9214; val_best_acc_score: 0.8483; val_best_f1_score: 0.8531; train_kl_reg_loss: 536.8292; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 7004.5108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7541.3401; train_optim_loss: 7541.3401; val_kl_reg_loss: 497.8655; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6681.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7179.2956; val_optim_loss: 7179.2956
heaps
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9294; val_auprc_score: 0.9246; val_best_acc_score: 0.8492; val_best_f1_score: 0.8547; train_kl_reg_loss: 512.5980; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6737.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7249.8316; train_optim_loss: 7249.8316; val_kl_reg_loss: 489.2988; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6485.1608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6974.4595; val_optim_loss: 6974.4595
heaps
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9296; val_auprc_score: 0.9232; val_best_acc_score: 0.8513; val_best_f1_score: 0.8561; train_kl_reg_loss: 501.8870; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6596.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7098.6188; train_optim_loss: 7098.6188; val_kl_reg_loss: 485.6094; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6384.8546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6870.4641; val_optim_loss: 6870.4641
heaps
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9238; val_best_acc_score: 0.8524; val_best_f1_score: 0.8573; train_kl_reg_loss: 495.8581; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6509.9253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7005.7833; train_optim_loss: 7005.7833; val_kl_reg_loss: 474.2068; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6325.4067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6799.6135; val_optim_loss: 6799.6135
heaps
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9296; val_auprc_score: 0.9233; val_best_acc_score: 0.8512; val_best_f1_score: 0.8569; train_kl_reg_loss: 492.2471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6451.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6944.2409; train_optim_loss: 6944.2409; val_kl_reg_loss: 486.2568; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6293.1242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6779.3810; val_optim_loss: 6779.3810
heaps
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9321; val_auprc_score: 0.9269; val_best_acc_score: 0.8533; val_best_f1_score: 0.8580; train_kl_reg_loss: 490.7458; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6411.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6901.9433; train_optim_loss: 6901.9433; val_kl_reg_loss: 480.7531; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6254.4736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6735.2267; val_optim_loss: 6735.2267
heaps
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9320; val_auprc_score: 0.9267; val_best_acc_score: 0.8531; val_best_f1_score: 0.8584; train_kl_reg_loss: 489.9839; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6387.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6877.4149; train_optim_loss: 6877.4149; val_kl_reg_loss: 473.8366; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6215.4481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6689.2847; val_optim_loss: 6689.2847
heaps
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9321; val_auprc_score: 0.9260; val_best_acc_score: 0.8551; val_best_f1_score: 0.8595; train_kl_reg_loss: 489.5508; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6362.5994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6852.1501; train_optim_loss: 6852.1501; val_kl_reg_loss: 491.7311; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6210.3106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6702.0417; val_optim_loss: 6702.0417
heaps
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9319; val_auprc_score: 0.9266; val_best_acc_score: 0.8540; val_best_f1_score: 0.8596; train_kl_reg_loss: 489.1226; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6348.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6837.8304; train_optim_loss: 6837.8304; val_kl_reg_loss: 479.2501; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6208.3798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6687.6299; val_optim_loss: 6687.6299
heaps
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9301; val_auprc_score: 0.9245; val_best_acc_score: 0.8518; val_best_f1_score: 0.8567; train_kl_reg_loss: 488.7533; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6336.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6825.2551; train_optim_loss: 6825.2551; val_kl_reg_loss: 482.1054; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6200.0254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6682.1309; val_optim_loss: 6682.1309
heaps
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9306; val_auprc_score: 0.9249; val_best_acc_score: 0.8532; val_best_f1_score: 0.8580; train_kl_reg_loss: 488.7723; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6321.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6810.4840; train_optim_loss: 6810.4840; val_kl_reg_loss: 485.1167; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6195.5603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6680.6770; val_optim_loss: 6680.6770
heaps
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9310; val_auprc_score: 0.9261; val_best_acc_score: 0.8528; val_best_f1_score: 0.8574; train_kl_reg_loss: 489.1306; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6314.9829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6804.1134; train_optim_loss: 6804.1134; val_kl_reg_loss: 489.6524; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6181.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6670.9909; val_optim_loss: 6670.9909
heaps
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9338; val_auprc_score: 0.9289; val_best_acc_score: 0.8565; val_best_f1_score: 0.8618; train_kl_reg_loss: 489.9415; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6308.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6798.9020; train_optim_loss: 6798.9020; val_kl_reg_loss: 479.5900; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6184.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6664.0683; val_optim_loss: 6664.0683
heaps
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9343; val_auprc_score: 0.9295; val_best_acc_score: 0.8568; val_best_f1_score: 0.8613; train_kl_reg_loss: 490.6052; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6302.6873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6793.2925; train_optim_loss: 6793.2925; val_kl_reg_loss: 499.1464; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6156.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6655.5168; val_optim_loss: 6655.5168
heaps
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9331; val_auprc_score: 0.9284; val_best_acc_score: 0.8553; val_best_f1_score: 0.8595; train_kl_reg_loss: 491.6876; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6298.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6790.1906; train_optim_loss: 6790.1906; val_kl_reg_loss: 485.9911; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6158.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6644.8295; val_optim_loss: 6644.8295
heaps
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9348; val_auprc_score: 0.9303; val_best_acc_score: 0.8583; val_best_f1_score: 0.8622; train_kl_reg_loss: 492.3626; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6289.5497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6781.9123; train_optim_loss: 6781.9123; val_kl_reg_loss: 484.1803; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6164.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6648.6856; val_optim_loss: 6648.6856
heaps
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9351; val_auprc_score: 0.9318; val_best_acc_score: 0.8571; val_best_f1_score: 0.8613; train_kl_reg_loss: 492.7573; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6285.4530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6778.2103; train_optim_loss: 6778.2103; val_kl_reg_loss: 488.1892; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6144.0606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6632.2499; val_optim_loss: 6632.2499
heaps
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9337; val_auprc_score: 0.9288; val_best_acc_score: 0.8571; val_best_f1_score: 0.8613; train_kl_reg_loss: 493.5404; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6281.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6774.9193; train_optim_loss: 6774.9193; val_kl_reg_loss: 485.4691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6151.0768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6636.5459; val_optim_loss: 6636.5459
heaps
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9352; val_auprc_score: 0.9305; val_best_acc_score: 0.8574; val_best_f1_score: 0.8618; train_kl_reg_loss: 493.8018; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6277.3699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6771.1717; train_optim_loss: 6771.1717; val_kl_reg_loss: 484.8734; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6151.5944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6636.4677; val_optim_loss: 6636.4677
heaps
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9342; val_auprc_score: 0.9299; val_best_acc_score: 0.8568; val_best_f1_score: 0.8608; train_kl_reg_loss: 494.2498; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6271.5644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6765.8142; train_optim_loss: 6765.8142; val_kl_reg_loss: 480.9974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6150.0852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6631.0825; val_optim_loss: 6631.0825
heaps
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9364; val_auprc_score: 0.9318; val_best_acc_score: 0.8602; val_best_f1_score: 0.8645; train_kl_reg_loss: 494.3044; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6267.4095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6761.7140; train_optim_loss: 6761.7140; val_kl_reg_loss: 481.5558; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6135.0183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6616.5741; val_optim_loss: 6616.5741
heaps
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9344; val_auprc_score: 0.9303; val_best_acc_score: 0.8564; val_best_f1_score: 0.8614; train_kl_reg_loss: 494.1401; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6267.8431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6761.9832; train_optim_loss: 6761.9832; val_kl_reg_loss: 490.0308; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6132.4761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6622.5069; val_optim_loss: 6622.5069
heaps
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9351; val_auprc_score: 0.9317; val_best_acc_score: 0.8569; val_best_f1_score: 0.8617; train_kl_reg_loss: 494.1151; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6263.0905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6757.2056; train_optim_loss: 6757.2056; val_kl_reg_loss: 485.0383; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6143.7858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6628.8242; val_optim_loss: 6628.8242
heaps
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9343; val_auprc_score: 0.9301; val_best_acc_score: 0.8564; val_best_f1_score: 0.8617; train_kl_reg_loss: 494.3345; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6261.9561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6756.2905; train_optim_loss: 6756.2905; val_kl_reg_loss: 478.5273; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6140.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6618.7503; val_optim_loss: 6618.7503
heaps
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9364; val_auprc_score: 0.9336; val_best_acc_score: 0.8577; val_best_f1_score: 0.8626; train_kl_reg_loss: 494.6685; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6256.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6751.6278; train_optim_loss: 6751.6278; val_kl_reg_loss: 482.5409; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6134.3773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6616.9182; val_optim_loss: 6616.9182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

heaps
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9367; val_auprc_score: 0.9331; val_best_acc_score: 0.8598; val_best_f1_score: 0.8637; train_kl_reg_loss: 491.3477; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6227.5831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6718.9308; train_optim_loss: 6718.9308; val_kl_reg_loss: 482.9936; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6125.0741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6608.0678; val_optim_loss: 6608.0678
heaps
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9361; val_auprc_score: 0.9328; val_best_acc_score: 0.8584; val_best_f1_score: 0.8632; train_kl_reg_loss: 491.5581; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6222.0067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6713.5649; train_optim_loss: 6713.5649; val_kl_reg_loss: 485.2899; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6093.0979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6578.3878; val_optim_loss: 6578.3878
heaps
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9361; val_auprc_score: 0.9332; val_best_acc_score: 0.8582; val_best_f1_score: 0.8622; train_kl_reg_loss: 491.7895; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6224.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6716.1835; train_optim_loss: 6716.1835; val_kl_reg_loss: 486.9504; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6105.4553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6592.4057; val_optim_loss: 6592.4057
heaps
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9371; val_auprc_score: 0.9346; val_best_acc_score: 0.8590; val_best_f1_score: 0.8630; train_kl_reg_loss: 491.9113; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6220.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6711.9890; train_optim_loss: 6711.9890; val_kl_reg_loss: 486.4862; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6112.3926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6598.8789; val_optim_loss: 6598.8789
heaps
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9367; val_auprc_score: 0.9342; val_best_acc_score: 0.8583; val_best_f1_score: 0.8626; train_kl_reg_loss: 491.6961; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6220.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6711.9982; train_optim_loss: 6711.9982; val_kl_reg_loss: 483.4584; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6093.9374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6577.3957; val_optim_loss: 6577.3957
heaps
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9358; val_auprc_score: 0.9325; val_best_acc_score: 0.8580; val_best_f1_score: 0.8623; train_kl_reg_loss: 492.0715; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6220.8774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6712.9489; train_optim_loss: 6712.9489; val_kl_reg_loss: 485.9470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6105.2071; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6591.1541; val_optim_loss: 6591.1541
heaps
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9360; val_auprc_score: 0.9328; val_best_acc_score: 0.8580; val_best_f1_score: 0.8626; train_kl_reg_loss: 492.2235; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6218.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6710.7196; train_optim_loss: 6710.7196; val_kl_reg_loss: 487.4008; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6103.6994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6591.1002; val_optim_loss: 6591.1002
heaps
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9359; val_auprc_score: 0.9323; val_best_acc_score: 0.8583; val_best_f1_score: 0.8627; train_kl_reg_loss: 492.3378; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6218.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6711.2506; train_optim_loss: 6711.2506; val_kl_reg_loss: 488.1726; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6099.0211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6587.1937; val_optim_loss: 6587.1937
heaps
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9360; val_auprc_score: 0.9324; val_best_acc_score: 0.8588; val_best_f1_score: 0.8634; train_kl_reg_loss: 492.4897; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6218.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6711.0831; train_optim_loss: 6711.0831; val_kl_reg_loss: 486.1191; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6104.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6590.4576; val_optim_loss: 6590.4576

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

heaps
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9370; val_auprc_score: 0.9336; val_best_acc_score: 0.8595; val_best_f1_score: 0.8638; train_kl_reg_loss: 492.0477; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6212.9055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6704.9532; train_optim_loss: 6704.9532; val_kl_reg_loss: 485.8858; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6100.4348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6586.3206; val_optim_loss: 6586.3206
heaps
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9367; val_auprc_score: 0.9337; val_best_acc_score: 0.8592; val_best_f1_score: 0.8630; train_kl_reg_loss: 492.0998; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6214.5688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6706.6686; train_optim_loss: 6706.6686; val_kl_reg_loss: 485.3717; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6083.3800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6568.7517; val_optim_loss: 6568.7517
heaps
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9367; val_auprc_score: 0.9334; val_best_acc_score: 0.8586; val_best_f1_score: 0.8633; train_kl_reg_loss: 491.8432; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6213.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6705.3682; train_optim_loss: 6705.3682; val_kl_reg_loss: 486.9361; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6094.9913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6581.9274; val_optim_loss: 6581.9274
heaps
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9369; val_auprc_score: 0.9331; val_best_acc_score: 0.8600; val_best_f1_score: 0.8640; train_kl_reg_loss: 492.3129; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6211.9493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6704.2623; train_optim_loss: 6704.2623; val_kl_reg_loss: 486.2711; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6106.7756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6593.0467; val_optim_loss: 6593.0467
heaps
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9374; val_auprc_score: 0.9345; val_best_acc_score: 0.8592; val_best_f1_score: 0.8632; train_kl_reg_loss: 492.0771; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6211.5925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6703.6697; train_optim_loss: 6703.6697; val_kl_reg_loss: 485.9794; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6109.8786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6595.8580; val_optim_loss: 6595.8580
heaps
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9356; val_auprc_score: 0.9323; val_best_acc_score: 0.8574; val_best_f1_score: 0.8613; train_kl_reg_loss: 492.1669; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6213.1807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6705.3476; train_optim_loss: 6705.3476; val_kl_reg_loss: 485.4136; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6080.8851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6566.2987; val_optim_loss: 6566.2987
heaps
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9355; val_auprc_score: 0.9321; val_best_acc_score: 0.8570; val_best_f1_score: 0.8619; train_kl_reg_loss: 492.1435; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6211.0594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6703.2028; train_optim_loss: 6703.2028; val_kl_reg_loss: 485.6099; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6086.1626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6571.7725; val_optim_loss: 6571.7725
heaps
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9369; val_auprc_score: 0.9338; val_best_acc_score: 0.8591; val_best_f1_score: 0.8633; train_kl_reg_loss: 492.1949; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6212.8378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6705.0327; train_optim_loss: 6705.0327; val_kl_reg_loss: 486.2464; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6097.1757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6583.4221; val_optim_loss: 6583.4221
heaps
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9368; val_auprc_score: 0.9336; val_best_acc_score: 0.8598; val_best_f1_score: 0.8636; train_kl_reg_loss: 492.2353; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6212.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6705.0633; train_optim_loss: 6705.0633; val_kl_reg_loss: 486.5740; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6088.2494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6574.8234; val_optim_loss: 6574.8234
heaps
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9370; val_auprc_score: 0.9336; val_best_acc_score: 0.8596; val_best_f1_score: 0.8642; train_kl_reg_loss: 492.1739; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6213.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6705.6072; train_optim_loss: 6705.6072; val_kl_reg_loss: 486.4008; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6098.8747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6585.2755; val_optim_loss: 6585.2755

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

heaps
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9376; val_auprc_score: 0.9345; val_best_acc_score: 0.8594; val_best_f1_score: 0.8632; train_kl_reg_loss: 492.2276; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6210.9541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6703.1817; train_optim_loss: 6703.1817; val_kl_reg_loss: 486.1531; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6087.8774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6574.0306; val_optim_loss: 6574.0306
heaps
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9376; val_auprc_score: 0.9342; val_best_acc_score: 0.8598; val_best_f1_score: 0.8640; train_kl_reg_loss: 492.1797; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6209.5161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6701.6958; train_optim_loss: 6701.6958; val_kl_reg_loss: 486.4622; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6092.0809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6578.5431; val_optim_loss: 6578.5431
heaps
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9359; val_auprc_score: 0.9324; val_best_acc_score: 0.8578; val_best_f1_score: 0.8622; train_kl_reg_loss: 492.2202; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6211.6350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6703.8552; train_optim_loss: 6703.8552; val_kl_reg_loss: 486.1531; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6095.2486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6581.4016; val_optim_loss: 6581.4016
heaps
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9372; val_auprc_score: 0.9340; val_best_acc_score: 0.8603; val_best_f1_score: 0.8642; train_kl_reg_loss: 492.1589; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 6209.4406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6701.5995; train_optim_loss: 6701.5995; val_kl_reg_loss: 485.9552; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 6109.1292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6595.0844; val_optim_loss: 6595.0844

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 82 min 25 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9375
Val AUPRC score: 0.9342
Val best accuracy score: 0.8596
Val best F1 score: 0.8644
Val gene expr MSE score: 1.4547

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
