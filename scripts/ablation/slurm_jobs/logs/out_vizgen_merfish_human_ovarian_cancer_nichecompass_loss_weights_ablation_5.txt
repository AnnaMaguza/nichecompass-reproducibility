None
Run timestamp: 03072023_191830_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9207; val_auprc_score: 0.9308; val_best_acc_score: 0.8378; val_best_f1_score: 0.8329; train_kl_reg_loss: 1044.9637; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 15978.7393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17023.7030; train_optim_loss: 17023.7030; val_kl_reg_loss: 958.6291; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 14058.0204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15016.6495; val_optim_loss: 15016.6495
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9263; val_auprc_score: 0.9361; val_best_acc_score: 0.8450; val_best_f1_score: 0.8395; train_kl_reg_loss: 927.9228; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13879.7110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14807.6338; train_optim_loss: 14807.6338; val_kl_reg_loss: 854.7419; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13342.5866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14197.3285; val_optim_loss: 14197.3285
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9287; val_auprc_score: 0.9386; val_best_acc_score: 0.8499; val_best_f1_score: 0.8430; train_kl_reg_loss: 841.3462; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13388.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14229.9830; train_optim_loss: 14229.9830; val_kl_reg_loss: 808.8796; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12972.7166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13781.5962; val_optim_loss: 13781.5962
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9287; val_auprc_score: 0.9380; val_best_acc_score: 0.8486; val_best_f1_score: 0.8436; train_kl_reg_loss: 799.2526; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13103.4178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13902.6705; train_optim_loss: 13902.6705; val_kl_reg_loss: 794.7707; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12735.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13529.8019; val_optim_loss: 13529.8019
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9299; val_auprc_score: 0.9391; val_best_acc_score: 0.8492; val_best_f1_score: 0.8454; train_kl_reg_loss: 775.3971; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12907.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13683.0168; train_optim_loss: 13683.0168; val_kl_reg_loss: 747.4078; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12601.4581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13348.8659; val_optim_loss: 13348.8659
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9298; val_auprc_score: 0.9388; val_best_acc_score: 0.8485; val_best_f1_score: 0.8464; train_kl_reg_loss: 760.2419; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12771.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13532.1395; train_optim_loss: 13532.1395; val_kl_reg_loss: 724.1868; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12505.7884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13229.9752; val_optim_loss: 13229.9752
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9309; val_auprc_score: 0.9399; val_best_acc_score: 0.8503; val_best_f1_score: 0.8474; train_kl_reg_loss: 751.5098; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12677.9687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13429.4785; train_optim_loss: 13429.4785; val_kl_reg_loss: 725.7727; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12439.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13165.5205; val_optim_loss: 13165.5205
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9327; val_auprc_score: 0.9414; val_best_acc_score: 0.8542; val_best_f1_score: 0.8495; train_kl_reg_loss: 745.5780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12603.0950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13348.6730; train_optim_loss: 13348.6730; val_kl_reg_loss: 720.4989; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12351.6604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13072.1594; val_optim_loss: 13072.1594
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9322; val_auprc_score: 0.9409; val_best_acc_score: 0.8522; val_best_f1_score: 0.8492; train_kl_reg_loss: 741.5796; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12548.2322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13289.8119; train_optim_loss: 13289.8119; val_kl_reg_loss: 719.1075; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12314.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13033.8746; val_optim_loss: 13033.8746
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9306; val_auprc_score: 0.9396; val_best_acc_score: 0.8504; val_best_f1_score: 0.8464; train_kl_reg_loss: 738.8440; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12504.5608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13243.4049; train_optim_loss: 13243.4049; val_kl_reg_loss: 724.8080; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12269.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12994.0776; val_optim_loss: 12994.0776
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9322; val_auprc_score: 0.9410; val_best_acc_score: 0.8512; val_best_f1_score: 0.8493; train_kl_reg_loss: 736.3906; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12470.8938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13207.2844; train_optim_loss: 13207.2844; val_kl_reg_loss: 719.3595; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12237.9943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12957.3539; val_optim_loss: 12957.3539
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9315; val_auprc_score: 0.9405; val_best_acc_score: 0.8516; val_best_f1_score: 0.8480; train_kl_reg_loss: 734.6594; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12444.8002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13179.4596; train_optim_loss: 13179.4596; val_kl_reg_loss: 728.9796; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12217.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12946.0070; val_optim_loss: 12946.0070
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9308; val_auprc_score: 0.9405; val_best_acc_score: 0.8505; val_best_f1_score: 0.8481; train_kl_reg_loss: 733.7471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12419.5145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13153.2616; train_optim_loss: 13153.2616; val_kl_reg_loss: 728.3246; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12192.5879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12920.9125; val_optim_loss: 12920.9125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9309; val_auprc_score: 0.9400; val_best_acc_score: 0.8512; val_best_f1_score: 0.8479; train_kl_reg_loss: 733.0682; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12408.0309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13141.0991; train_optim_loss: 13141.0991; val_kl_reg_loss: 720.9652; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12191.8096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12912.7748; val_optim_loss: 12912.7748
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9327; val_auprc_score: 0.9419; val_best_acc_score: 0.8544; val_best_f1_score: 0.8510; train_kl_reg_loss: 732.7669; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12385.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13118.4084; train_optim_loss: 13118.4084; val_kl_reg_loss: 723.8113; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12153.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12876.9716; val_optim_loss: 12876.9716
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9334; val_auprc_score: 0.9422; val_best_acc_score: 0.8542; val_best_f1_score: 0.8518; train_kl_reg_loss: 732.3792; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12374.4634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13106.8426; train_optim_loss: 13106.8426; val_kl_reg_loss: 726.0430; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12160.4491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12886.4922; val_optim_loss: 12886.4922
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9345; val_auprc_score: 0.9432; val_best_acc_score: 0.8566; val_best_f1_score: 0.8532; train_kl_reg_loss: 732.7611; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12359.2851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13092.0462; train_optim_loss: 13092.0462; val_kl_reg_loss: 720.3125; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12148.2616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12868.5742; val_optim_loss: 12868.5742
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9356; val_auprc_score: 0.9446; val_best_acc_score: 0.8584; val_best_f1_score: 0.8557; train_kl_reg_loss: 733.2167; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12345.1795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13078.3962; train_optim_loss: 13078.3962; val_kl_reg_loss: 716.6762; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12140.4386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12857.1147; val_optim_loss: 12857.1147
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9338; val_auprc_score: 0.9430; val_best_acc_score: 0.8544; val_best_f1_score: 0.8518; train_kl_reg_loss: 733.5800; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12342.0855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13075.6655; train_optim_loss: 13075.6655; val_kl_reg_loss: 718.5413; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12125.4146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12843.9559; val_optim_loss: 12843.9559
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9368; val_auprc_score: 0.9457; val_best_acc_score: 0.8605; val_best_f1_score: 0.8569; train_kl_reg_loss: 734.1620; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12331.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13066.0657; train_optim_loss: 13066.0657; val_kl_reg_loss: 715.7401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12122.5345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12838.2746; val_optim_loss: 12838.2746
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9374; val_auprc_score: 0.9460; val_best_acc_score: 0.8597; val_best_f1_score: 0.8573; train_kl_reg_loss: 734.7732; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12323.0429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13057.8161; train_optim_loss: 13057.8161; val_kl_reg_loss: 720.0267; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12110.0088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12830.0356; val_optim_loss: 12830.0356
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9371; val_auprc_score: 0.9457; val_best_acc_score: 0.8601; val_best_f1_score: 0.8579; train_kl_reg_loss: 735.1993; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12316.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13051.8976; train_optim_loss: 13051.8976; val_kl_reg_loss: 731.5744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12092.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12823.6838; val_optim_loss: 12823.6838
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9362; val_auprc_score: 0.9453; val_best_acc_score: 0.8598; val_best_f1_score: 0.8570; train_kl_reg_loss: 735.9834; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12306.3038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13042.2872; train_optim_loss: 13042.2872; val_kl_reg_loss: 727.0474; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12111.2814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12838.3288; val_optim_loss: 12838.3288
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9378; val_auprc_score: 0.9466; val_best_acc_score: 0.8613; val_best_f1_score: 0.8581; train_kl_reg_loss: 736.6948; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12303.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13040.1028; train_optim_loss: 13040.1028; val_kl_reg_loss: 725.1893; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12089.5390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12814.7284; val_optim_loss: 12814.7284
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9392; val_auprc_score: 0.9476; val_best_acc_score: 0.8637; val_best_f1_score: 0.8604; train_kl_reg_loss: 737.0719; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12297.3921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13034.4640; train_optim_loss: 13034.4640; val_kl_reg_loss: 732.9857; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12082.1157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12815.1015; val_optim_loss: 12815.1015
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9390; val_auprc_score: 0.9475; val_best_acc_score: 0.8635; val_best_f1_score: 0.8605; train_kl_reg_loss: 737.3390; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12293.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13030.8616; train_optim_loss: 13030.8616; val_kl_reg_loss: 728.3299; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12081.1121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12809.4420; val_optim_loss: 12809.4420
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9405; val_auprc_score: 0.9489; val_best_acc_score: 0.8647; val_best_f1_score: 0.8626; train_kl_reg_loss: 738.0403; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12291.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13029.3282; train_optim_loss: 13029.3282; val_kl_reg_loss: 733.3677; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12086.6300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12819.9976; val_optim_loss: 12819.9976
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9396; val_auprc_score: 0.9481; val_best_acc_score: 0.8635; val_best_f1_score: 0.8612; train_kl_reg_loss: 738.4709; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12277.7064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13016.1773; train_optim_loss: 13016.1773; val_kl_reg_loss: 732.4334; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12063.0275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12795.4608; val_optim_loss: 12795.4608
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9399; val_auprc_score: 0.9486; val_best_acc_score: 0.8654; val_best_f1_score: 0.8627; train_kl_reg_loss: 738.9573; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12281.2256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13020.1829; train_optim_loss: 13020.1829; val_kl_reg_loss: 734.1272; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12056.7690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12790.8962; val_optim_loss: 12790.8962
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9409; val_auprc_score: 0.9493; val_best_acc_score: 0.8665; val_best_f1_score: 0.8642; train_kl_reg_loss: 739.2818; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12269.7814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13009.0633; train_optim_loss: 13009.0633; val_kl_reg_loss: 728.7729; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12070.8659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12799.6387; val_optim_loss: 12799.6387
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9419; val_auprc_score: 0.9502; val_best_acc_score: 0.8677; val_best_f1_score: 0.8651; train_kl_reg_loss: 739.6823; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12265.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13005.0037; train_optim_loss: 13005.0037; val_kl_reg_loss: 723.5079; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12059.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12782.7863; val_optim_loss: 12782.7863
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9430; val_auprc_score: 0.9513; val_best_acc_score: 0.8682; val_best_f1_score: 0.8662; train_kl_reg_loss: 739.8481; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12265.3388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13005.1869; train_optim_loss: 13005.1869; val_kl_reg_loss: 724.6852; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12070.0434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12794.7285; val_optim_loss: 12794.7285
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9423; val_auprc_score: 0.9506; val_best_acc_score: 0.8672; val_best_f1_score: 0.8659; train_kl_reg_loss: 740.3010; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12260.9836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13001.2846; train_optim_loss: 13001.2846; val_kl_reg_loss: 731.6490; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12054.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12785.8661; val_optim_loss: 12785.8661
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9409; val_auprc_score: 0.9497; val_best_acc_score: 0.8666; val_best_f1_score: 0.8638; train_kl_reg_loss: 740.7259; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12257.9740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12998.6998; train_optim_loss: 12998.6998; val_kl_reg_loss: 740.7179; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12063.5961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12804.3141; val_optim_loss: 12804.3141
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9433; val_auprc_score: 0.9515; val_best_acc_score: 0.8698; val_best_f1_score: 0.8669; train_kl_reg_loss: 740.9647; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12248.7816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12989.7463; train_optim_loss: 12989.7463; val_kl_reg_loss: 733.0744; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12049.7018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12782.7763; val_optim_loss: 12782.7763
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9437; val_auprc_score: 0.9520; val_best_acc_score: 0.8716; val_best_f1_score: 0.8676; train_kl_reg_loss: 741.7931; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12246.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12988.7892; train_optim_loss: 12988.7892; val_kl_reg_loss: 733.5851; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12033.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12766.8248; val_optim_loss: 12766.8248
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9433; val_auprc_score: 0.9514; val_best_acc_score: 0.8701; val_best_f1_score: 0.8666; train_kl_reg_loss: 742.5103; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12247.8582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12990.3685; train_optim_loss: 12990.3685; val_kl_reg_loss: 732.0756; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12049.6195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12781.6950; val_optim_loss: 12781.6950
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9441; val_auprc_score: 0.9523; val_best_acc_score: 0.8718; val_best_f1_score: 0.8685; train_kl_reg_loss: 743.0514; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12241.7996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12984.8510; train_optim_loss: 12984.8510; val_kl_reg_loss: 740.4089; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12052.3147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12792.7236; val_optim_loss: 12792.7236
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9434; val_auprc_score: 0.9522; val_best_acc_score: 0.8713; val_best_f1_score: 0.8676; train_kl_reg_loss: 743.5843; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12242.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12986.4212; train_optim_loss: 12986.4212; val_kl_reg_loss: 742.8241; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12034.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12777.0615; val_optim_loss: 12777.0615
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9466; val_auprc_score: 0.9544; val_best_acc_score: 0.8748; val_best_f1_score: 0.8722; train_kl_reg_loss: 744.8898; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12237.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12982.2992; train_optim_loss: 12982.2992; val_kl_reg_loss: 729.0084; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12040.5359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12769.5443; val_optim_loss: 12769.5443

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9458; val_auprc_score: 0.9539; val_best_acc_score: 0.8739; val_best_f1_score: 0.8713; train_kl_reg_loss: 740.7003; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12192.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12933.4686; train_optim_loss: 12933.4686; val_kl_reg_loss: 735.6734; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11991.0803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12726.7536; val_optim_loss: 12726.7536
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9461; val_auprc_score: 0.9542; val_best_acc_score: 0.8756; val_best_f1_score: 0.8724; train_kl_reg_loss: 742.2793; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12180.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12922.9765; train_optim_loss: 12922.9765; val_kl_reg_loss: 737.1056; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12009.8252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12746.9307; val_optim_loss: 12746.9307
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9452; val_auprc_score: 0.9533; val_best_acc_score: 0.8733; val_best_f1_score: 0.8703; train_kl_reg_loss: 742.9235; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12175.6524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12918.5759; train_optim_loss: 12918.5759; val_kl_reg_loss: 736.1161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12009.3554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12745.4715; val_optim_loss: 12745.4715
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9455; val_auprc_score: 0.9537; val_best_acc_score: 0.8738; val_best_f1_score: 0.8710; train_kl_reg_loss: 743.3942; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12175.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12918.6558; train_optim_loss: 12918.6558; val_kl_reg_loss: 734.7148; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12003.7975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12738.5123; val_optim_loss: 12738.5123
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9464; val_auprc_score: 0.9545; val_best_acc_score: 0.8746; val_best_f1_score: 0.8723; train_kl_reg_loss: 743.5342; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12173.4934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12917.0276; train_optim_loss: 12917.0276; val_kl_reg_loss: 736.2786; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11998.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12734.3274; val_optim_loss: 12734.3274

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9457; val_auprc_score: 0.9538; val_best_acc_score: 0.8737; val_best_f1_score: 0.8714; train_kl_reg_loss: 743.3069; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12168.9363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12912.2433; train_optim_loss: 12912.2433; val_kl_reg_loss: 735.4909; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11988.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12723.7088; val_optim_loss: 12723.7088
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9457; val_auprc_score: 0.9537; val_best_acc_score: 0.8737; val_best_f1_score: 0.8715; train_kl_reg_loss: 743.2312; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12162.9178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12906.1490; train_optim_loss: 12906.1490; val_kl_reg_loss: 735.1476; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11985.3187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12720.4662; val_optim_loss: 12720.4662
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9461; val_auprc_score: 0.9542; val_best_acc_score: 0.8749; val_best_f1_score: 0.8724; train_kl_reg_loss: 743.3016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12165.7957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12909.0973; train_optim_loss: 12909.0973; val_kl_reg_loss: 735.3517; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11981.0306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12716.3823; val_optim_loss: 12716.3823
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9460; val_auprc_score: 0.9541; val_best_acc_score: 0.8745; val_best_f1_score: 0.8718; train_kl_reg_loss: 743.5426; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12169.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12912.5694; train_optim_loss: 12912.5694; val_kl_reg_loss: 735.8187; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12006.1714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12741.9900; val_optim_loss: 12741.9900
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9463; val_auprc_score: 0.9541; val_best_acc_score: 0.8747; val_best_f1_score: 0.8725; train_kl_reg_loss: 743.5690; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12166.3911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12909.9601; train_optim_loss: 12909.9601; val_kl_reg_loss: 735.9375; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12002.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12738.5404; val_optim_loss: 12738.5404
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9454; val_auprc_score: 0.9535; val_best_acc_score: 0.8739; val_best_f1_score: 0.8708; train_kl_reg_loss: 743.8011; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12167.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12910.9707; train_optim_loss: 12910.9707; val_kl_reg_loss: 736.1521; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11984.2100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12720.3621; val_optim_loss: 12720.3621
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9456; val_auprc_score: 0.9536; val_best_acc_score: 0.8744; val_best_f1_score: 0.8715; train_kl_reg_loss: 743.7954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12166.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12910.5605; train_optim_loss: 12910.5605; val_kl_reg_loss: 735.7542; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11983.5413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12719.2955; val_optim_loss: 12719.2955

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9456; val_auprc_score: 0.9536; val_best_acc_score: 0.8743; val_best_f1_score: 0.8718; train_kl_reg_loss: 743.7830; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12168.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12911.8938; train_optim_loss: 12911.8938; val_kl_reg_loss: 736.1907; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11985.6430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12721.8337; val_optim_loss: 12721.8337
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9457; val_auprc_score: 0.9534; val_best_acc_score: 0.8737; val_best_f1_score: 0.8715; train_kl_reg_loss: 743.6665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12164.7909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12908.4575; train_optim_loss: 12908.4575; val_kl_reg_loss: 736.2333; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11989.5014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12725.7346; val_optim_loss: 12725.7346
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9456; val_auprc_score: 0.9538; val_best_acc_score: 0.8736; val_best_f1_score: 0.8711; train_kl_reg_loss: 743.7703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12168.3659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12912.1362; train_optim_loss: 12912.1362; val_kl_reg_loss: 736.4914; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11987.9743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12724.4657; val_optim_loss: 12724.4657
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9457; val_auprc_score: 0.9539; val_best_acc_score: 0.8736; val_best_f1_score: 0.8714; train_kl_reg_loss: 743.7446; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12163.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12906.8783; train_optim_loss: 12906.8783; val_kl_reg_loss: 735.7871; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11986.0418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12721.8290; val_optim_loss: 12721.8290

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 56 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
Val AUROC score: 0.9452
Val AUPRC score: 0.9530
Val best accuracy score: 0.8736
Val best F1 score: 0.8713
Val gene expr MSE score: 8.6335

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
