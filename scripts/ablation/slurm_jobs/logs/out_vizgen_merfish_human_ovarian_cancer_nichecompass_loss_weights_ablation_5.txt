None
Run timestamp: 30062023_200059_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9202; val_auprc_score: 0.9300; val_best_acc_score: 0.8382; val_best_f1_score: 0.8333; train_kl_reg_loss: 1189.1397; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 16119.0908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17308.2305; train_optim_loss: 17308.2305; val_kl_reg_loss: 1062.2916; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 14051.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15114.0775; val_optim_loss: 15114.0775
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9253; val_auprc_score: 0.9347; val_best_acc_score: 0.8447; val_best_f1_score: 0.8397; train_kl_reg_loss: 994.2278; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13876.8843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14871.1121; train_optim_loss: 14871.1121; val_kl_reg_loss: 918.8294; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13317.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14236.4531; val_optim_loss: 14236.4531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9270; val_auprc_score: 0.9363; val_best_acc_score: 0.8463; val_best_f1_score: 0.8407; train_kl_reg_loss: 884.8782; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13392.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14277.0166; train_optim_loss: 14277.0166; val_kl_reg_loss: 828.5858; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12982.1099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13810.6957; val_optim_loss: 13810.6957
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9281; val_auprc_score: 0.9376; val_best_acc_score: 0.8463; val_best_f1_score: 0.8444; train_kl_reg_loss: 830.9833; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13107.5276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13938.5108; train_optim_loss: 13938.5108; val_kl_reg_loss: 805.0686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12751.5008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13556.5694; val_optim_loss: 13556.5694
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9279; val_auprc_score: 0.9373; val_best_acc_score: 0.8463; val_best_f1_score: 0.8438; train_kl_reg_loss: 799.3016; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12921.7093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13721.0108; train_optim_loss: 13721.0108; val_kl_reg_loss: 774.8777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12614.1854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13389.0631; val_optim_loss: 13389.0631
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9293; val_auprc_score: 0.9386; val_best_acc_score: 0.8503; val_best_f1_score: 0.8446; train_kl_reg_loss: 778.3897; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12788.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13566.4243; train_optim_loss: 13566.4243; val_kl_reg_loss: 751.8813; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12504.8142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13256.6955; val_optim_loss: 13256.6955
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9292; val_auprc_score: 0.9383; val_best_acc_score: 0.8478; val_best_f1_score: 0.8448; train_kl_reg_loss: 764.6805; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12696.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13460.9028; train_optim_loss: 13460.9028; val_kl_reg_loss: 747.5696; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12431.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13179.0030; val_optim_loss: 13179.0030
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9260; val_auprc_score: 0.9357; val_best_acc_score: 0.8441; val_best_f1_score: 0.8414; train_kl_reg_loss: 755.6612; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12621.5218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13377.1830; train_optim_loss: 13377.1830; val_kl_reg_loss: 740.5182; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12370.0295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13110.5477; val_optim_loss: 13110.5477
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9292; val_auprc_score: 0.9387; val_best_acc_score: 0.8483; val_best_f1_score: 0.8439; train_kl_reg_loss: 748.4960; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12561.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13310.2797; train_optim_loss: 13310.2797; val_kl_reg_loss: 732.8847; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12316.4573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13049.3420; val_optim_loss: 13049.3420
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9290; val_auprc_score: 0.9386; val_best_acc_score: 0.8477; val_best_f1_score: 0.8454; train_kl_reg_loss: 743.5146; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12518.0890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13261.6035; train_optim_loss: 13261.6035; val_kl_reg_loss: 720.3678; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12295.5968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13015.9646; val_optim_loss: 13015.9646
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9304; val_auprc_score: 0.9393; val_best_acc_score: 0.8497; val_best_f1_score: 0.8471; train_kl_reg_loss: 739.7703; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12486.1502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13225.9204; train_optim_loss: 13225.9204; val_kl_reg_loss: 722.6093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12252.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12974.7970; val_optim_loss: 12974.7970
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9286; val_auprc_score: 0.9380; val_best_acc_score: 0.8465; val_best_f1_score: 0.8447; train_kl_reg_loss: 736.9854; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12451.9283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13188.9137; train_optim_loss: 13188.9137; val_kl_reg_loss: 718.4950; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12230.2081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12948.7031; val_optim_loss: 12948.7031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9290; val_auprc_score: 0.9385; val_best_acc_score: 0.8480; val_best_f1_score: 0.8455; train_kl_reg_loss: 734.9054; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12431.4451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13166.3505; train_optim_loss: 13166.3505; val_kl_reg_loss: 720.0054; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12198.4508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12918.4563; val_optim_loss: 12918.4563
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9295; val_auprc_score: 0.9389; val_best_acc_score: 0.8485; val_best_f1_score: 0.8460; train_kl_reg_loss: 733.1213; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12408.3685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13141.4898; train_optim_loss: 13141.4898; val_kl_reg_loss: 719.3503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12200.3346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12919.6849; val_optim_loss: 12919.6849
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9310; val_auprc_score: 0.9404; val_best_acc_score: 0.8508; val_best_f1_score: 0.8482; train_kl_reg_loss: 732.0145; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12395.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13127.9380; train_optim_loss: 13127.9380; val_kl_reg_loss: 728.7470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12161.4563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12890.2033; val_optim_loss: 12890.2033
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9302; val_auprc_score: 0.9397; val_best_acc_score: 0.8498; val_best_f1_score: 0.8461; train_kl_reg_loss: 731.1590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12381.8256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13112.9846; train_optim_loss: 13112.9846; val_kl_reg_loss: 725.3586; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12161.5187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12886.8773; val_optim_loss: 12886.8773
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9316; val_auprc_score: 0.9411; val_best_acc_score: 0.8513; val_best_f1_score: 0.8488; train_kl_reg_loss: 730.3547; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12365.3902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13095.7448; train_optim_loss: 13095.7448; val_kl_reg_loss: 720.9557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12157.2876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12878.2433; val_optim_loss: 12878.2433
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9317; val_auprc_score: 0.9414; val_best_acc_score: 0.8529; val_best_f1_score: 0.8494; train_kl_reg_loss: 730.6286; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12357.6470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13088.2756; train_optim_loss: 13088.2756; val_kl_reg_loss: 719.8900; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12135.7199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12855.6099; val_optim_loss: 12855.6099
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9318; val_auprc_score: 0.9415; val_best_acc_score: 0.8530; val_best_f1_score: 0.8489; train_kl_reg_loss: 730.5913; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12348.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13078.9594; train_optim_loss: 13078.9594; val_kl_reg_loss: 727.7646; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12137.4706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12865.2352; val_optim_loss: 12865.2352
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9330; val_auprc_score: 0.9427; val_best_acc_score: 0.8549; val_best_f1_score: 0.8514; train_kl_reg_loss: 730.7074; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12340.0105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13070.7179; train_optim_loss: 13070.7179; val_kl_reg_loss: 714.9022; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12120.3367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12835.2390; val_optim_loss: 12835.2390
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9327; val_auprc_score: 0.9424; val_best_acc_score: 0.8531; val_best_f1_score: 0.8501; train_kl_reg_loss: 731.1456; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12330.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13062.0906; train_optim_loss: 13062.0906; val_kl_reg_loss: 717.9503; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12115.4012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12833.3514; val_optim_loss: 12833.3514
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9351; val_auprc_score: 0.9443; val_best_acc_score: 0.8578; val_best_f1_score: 0.8541; train_kl_reg_loss: 731.8143; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12323.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13055.1554; train_optim_loss: 13055.1554; val_kl_reg_loss: 711.4179; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12101.3008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12812.7188; val_optim_loss: 12812.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9358; val_auprc_score: 0.9450; val_best_acc_score: 0.8595; val_best_f1_score: 0.8561; train_kl_reg_loss: 732.3002; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12311.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13043.6323; train_optim_loss: 13043.6323; val_kl_reg_loss: 715.8579; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12110.1526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12826.0105; val_optim_loss: 12826.0105
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9353; val_auprc_score: 0.9448; val_best_acc_score: 0.8581; val_best_f1_score: 0.8544; train_kl_reg_loss: 732.6692; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12308.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13040.9735; train_optim_loss: 13040.9735; val_kl_reg_loss: 725.3306; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12104.0245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12829.3551; val_optim_loss: 12829.3551
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9350; val_auprc_score: 0.9444; val_best_acc_score: 0.8575; val_best_f1_score: 0.8550; train_kl_reg_loss: 733.6571; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12302.3258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13035.9829; train_optim_loss: 13035.9829; val_kl_reg_loss: 727.5753; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12099.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12827.4591; val_optim_loss: 12827.4591
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9355; val_auprc_score: 0.9449; val_best_acc_score: 0.8593; val_best_f1_score: 0.8545; train_kl_reg_loss: 734.3973; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12296.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13030.4989; train_optim_loss: 13030.4989; val_kl_reg_loss: 727.9124; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12097.4919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12825.4044; val_optim_loss: 12825.4044

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9364; val_auprc_score: 0.9457; val_best_acc_score: 0.8594; val_best_f1_score: 0.8565; train_kl_reg_loss: 730.7885; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12248.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12979.3148; train_optim_loss: 12979.3148; val_kl_reg_loss: 721.6545; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12061.6089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12783.2634; val_optim_loss: 12783.2634
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9369; val_auprc_score: 0.9461; val_best_acc_score: 0.8609; val_best_f1_score: 0.8570; train_kl_reg_loss: 731.6580; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12235.5393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12967.1973; train_optim_loss: 12967.1973; val_kl_reg_loss: 720.6061; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12050.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12770.9208; val_optim_loss: 12770.9208
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9363; val_auprc_score: 0.9452; val_best_acc_score: 0.8595; val_best_f1_score: 0.8568; train_kl_reg_loss: 732.1086; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12234.8067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12966.9153; train_optim_loss: 12966.9153; val_kl_reg_loss: 724.5451; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12055.4620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12780.0071; val_optim_loss: 12780.0071
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9372; val_auprc_score: 0.9461; val_best_acc_score: 0.8609; val_best_f1_score: 0.8578; train_kl_reg_loss: 732.7418; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12232.9633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12965.7050; train_optim_loss: 12965.7050; val_kl_reg_loss: 721.9440; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12055.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12777.3408; val_optim_loss: 12777.3408
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9360; val_auprc_score: 0.9454; val_best_acc_score: 0.8586; val_best_f1_score: 0.8563; train_kl_reg_loss: 732.8662; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12229.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12962.7196; train_optim_loss: 12962.7196; val_kl_reg_loss: 726.1341; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12046.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12772.4362; val_optim_loss: 12772.4362
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9371; val_auprc_score: 0.9463; val_best_acc_score: 0.8612; val_best_f1_score: 0.8581; train_kl_reg_loss: 733.2664; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12230.1656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12963.4320; train_optim_loss: 12963.4320; val_kl_reg_loss: 722.9150; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12057.6397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12780.5547; val_optim_loss: 12780.5547

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9371; val_auprc_score: 0.9463; val_best_acc_score: 0.8616; val_best_f1_score: 0.8581; train_kl_reg_loss: 732.5012; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12223.1343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12955.6355; train_optim_loss: 12955.6355; val_kl_reg_loss: 723.3236; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12038.3384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12761.6620; val_optim_loss: 12761.6620
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9368; val_auprc_score: 0.9459; val_best_acc_score: 0.8604; val_best_f1_score: 0.8569; train_kl_reg_loss: 732.9334; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12225.4374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12958.3708; train_optim_loss: 12958.3708; val_kl_reg_loss: 722.8650; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12049.2501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12772.1150; val_optim_loss: 12772.1150
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9369; val_auprc_score: 0.9461; val_best_acc_score: 0.8610; val_best_f1_score: 0.8573; train_kl_reg_loss: 732.6742; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12224.5506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12957.2248; train_optim_loss: 12957.2248; val_kl_reg_loss: 722.5769; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12049.1858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12771.7627; val_optim_loss: 12771.7627
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9371; val_auprc_score: 0.9463; val_best_acc_score: 0.8616; val_best_f1_score: 0.8579; train_kl_reg_loss: 732.8185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12221.7712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12954.5897; train_optim_loss: 12954.5897; val_kl_reg_loss: 723.3691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12035.6014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12758.9706; val_optim_loss: 12758.9706
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9377; val_auprc_score: 0.9467; val_best_acc_score: 0.8621; val_best_f1_score: 0.8582; train_kl_reg_loss: 733.0023; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12224.2004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12957.2027; train_optim_loss: 12957.2027; val_kl_reg_loss: 723.3351; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12062.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12786.1237; val_optim_loss: 12786.1237
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9376; val_auprc_score: 0.9467; val_best_acc_score: 0.8619; val_best_f1_score: 0.8580; train_kl_reg_loss: 732.9129; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12220.7330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12953.6459; train_optim_loss: 12953.6459; val_kl_reg_loss: 723.7833; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12044.8575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12768.6409; val_optim_loss: 12768.6409
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9366; val_auprc_score: 0.9455; val_best_acc_score: 0.8602; val_best_f1_score: 0.8565; train_kl_reg_loss: 732.9268; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12219.9353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12952.8620; train_optim_loss: 12952.8620; val_kl_reg_loss: 724.3771; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12042.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12766.6792; val_optim_loss: 12766.6792
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9365; val_auprc_score: 0.9457; val_best_acc_score: 0.8600; val_best_f1_score: 0.8563; train_kl_reg_loss: 732.9665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12216.6167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12949.5832; train_optim_loss: 12949.5832; val_kl_reg_loss: 722.8755; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12056.4781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12779.3536; val_optim_loss: 12779.3536

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9364; val_auprc_score: 0.9457; val_best_acc_score: 0.8605; val_best_f1_score: 0.8567; train_kl_reg_loss: 732.6224; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12218.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12951.0824; train_optim_loss: 12951.0824; val_kl_reg_loss: 723.2765; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12034.9552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12758.2317; val_optim_loss: 12758.2317
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9370; val_auprc_score: 0.9462; val_best_acc_score: 0.8616; val_best_f1_score: 0.8577; train_kl_reg_loss: 733.0784; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12216.2046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12949.2830; train_optim_loss: 12949.2830; val_kl_reg_loss: 723.7726; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12040.7136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12764.4862; val_optim_loss: 12764.4862
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9378; val_auprc_score: 0.9468; val_best_acc_score: 0.8622; val_best_f1_score: 0.8582; train_kl_reg_loss: 733.0951; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12216.7492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12949.8443; train_optim_loss: 12949.8443; val_kl_reg_loss: 723.4935; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12040.8124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12764.3059; val_optim_loss: 12764.3059
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9371; val_auprc_score: 0.9460; val_best_acc_score: 0.8617; val_best_f1_score: 0.8578; train_kl_reg_loss: 733.0565; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12218.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12951.6225; train_optim_loss: 12951.6225; val_kl_reg_loss: 723.9869; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12053.1147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12777.1016; val_optim_loss: 12777.1016
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9366; val_auprc_score: 0.9456; val_best_acc_score: 0.8610; val_best_f1_score: 0.8571; train_kl_reg_loss: 733.0483; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12222.0499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12955.0982; train_optim_loss: 12955.0982; val_kl_reg_loss: 723.1483; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12035.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12758.5848; val_optim_loss: 12758.5848

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9368; val_auprc_score: 0.9459; val_best_acc_score: 0.8611; val_best_f1_score: 0.8572; train_kl_reg_loss: 732.9765; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12219.6548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12952.6312; train_optim_loss: 12952.6312; val_kl_reg_loss: 723.5260; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12040.2985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12763.8244; val_optim_loss: 12763.8244
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9366; val_auprc_score: 0.9458; val_best_acc_score: 0.8609; val_best_f1_score: 0.8570; train_kl_reg_loss: 733.0921; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12221.8778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12954.9700; train_optim_loss: 12954.9700; val_kl_reg_loss: 723.5948; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12051.8704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12775.4651; val_optim_loss: 12775.4651
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9374; val_auprc_score: 0.9466; val_best_acc_score: 0.8612; val_best_f1_score: 0.8573; train_kl_reg_loss: 733.0469; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12220.8917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12953.9386; train_optim_loss: 12953.9386; val_kl_reg_loss: 723.5403; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12041.0798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12764.6201; val_optim_loss: 12764.6201
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9369; val_auprc_score: 0.9460; val_best_acc_score: 0.8611; val_best_f1_score: 0.8572; train_kl_reg_loss: 733.0104; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12219.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12952.6075; train_optim_loss: 12952.6075; val_kl_reg_loss: 723.5644; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12047.0828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12770.6472; val_optim_loss: 12770.6472

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 100 min 38 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9371
Val AUPRC score: 0.9463
Val best accuracy score: 0.8613
Val best F1 score: 0.8574
Val gene expr MSE score: 8.5828

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
