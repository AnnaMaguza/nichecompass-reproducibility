None
Run timestamp: 03072023_071446_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9148; val_auprc_score: 0.9256; val_best_acc_score: 0.8291; val_best_f1_score: 0.8254; train_kl_reg_loss: 1203.0735; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 15946.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17150.0133; train_optim_loss: 17150.0133; val_kl_reg_loss: 1076.1663; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13909.6831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14985.8494; val_optim_loss: 14985.8494
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9217; val_auprc_score: 0.9319; val_best_acc_score: 0.8401; val_best_f1_score: 0.8334; train_kl_reg_loss: 1010.3866; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13761.1218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14771.5085; train_optim_loss: 14771.5085; val_kl_reg_loss: 907.2636; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13194.4699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14101.7335; val_optim_loss: 14101.7335
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9212; val_auprc_score: 0.9316; val_best_acc_score: 0.8362; val_best_f1_score: 0.8331; train_kl_reg_loss: 903.4216; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13264.5716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14167.9932; train_optim_loss: 14167.9932; val_kl_reg_loss: 868.2370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12850.8056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13719.0425; val_optim_loss: 13719.0425
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9256; val_auprc_score: 0.9352; val_best_acc_score: 0.8431; val_best_f1_score: 0.8384; train_kl_reg_loss: 849.9338; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12987.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13837.8703; train_optim_loss: 13837.8703; val_kl_reg_loss: 826.0779; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12624.7711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13450.8490; val_optim_loss: 13450.8490
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9277; val_auprc_score: 0.9368; val_best_acc_score: 0.8464; val_best_f1_score: 0.8423; train_kl_reg_loss: 817.6373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12794.0444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13611.6817; train_optim_loss: 13611.6817; val_kl_reg_loss: 776.2407; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12494.9626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13271.2032; val_optim_loss: 13271.2032
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9277; val_auprc_score: 0.9367; val_best_acc_score: 0.8458; val_best_f1_score: 0.8419; train_kl_reg_loss: 796.9781; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12665.3551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13462.3333; train_optim_loss: 13462.3333; val_kl_reg_loss: 757.8922; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12393.5139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13151.4061; val_optim_loss: 13151.4061
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9281; val_auprc_score: 0.9371; val_best_acc_score: 0.8454; val_best_f1_score: 0.8422; train_kl_reg_loss: 783.6162; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12564.9987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13348.6149; train_optim_loss: 13348.6149; val_kl_reg_loss: 756.5946; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12285.7406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13042.3352; val_optim_loss: 13042.3352
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9280; val_auprc_score: 0.9372; val_best_acc_score: 0.8458; val_best_f1_score: 0.8425; train_kl_reg_loss: 774.4895; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12490.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13265.0632; train_optim_loss: 13265.0632; val_kl_reg_loss: 758.5055; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12226.8472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12985.3526; val_optim_loss: 12985.3526
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9290; val_auprc_score: 0.9380; val_best_acc_score: 0.8476; val_best_f1_score: 0.8436; train_kl_reg_loss: 767.6752; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12437.0403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13204.7155; train_optim_loss: 13204.7155; val_kl_reg_loss: 755.9071; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12182.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12938.2087; val_optim_loss: 12938.2087
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9287; val_auprc_score: 0.9380; val_best_acc_score: 0.8466; val_best_f1_score: 0.8435; train_kl_reg_loss: 762.9999; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12396.0680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13159.0679; train_optim_loss: 13159.0679; val_kl_reg_loss: 746.4789; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12141.3834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12887.8622; val_optim_loss: 12887.8622
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9299; val_auprc_score: 0.9389; val_best_acc_score: 0.8490; val_best_f1_score: 0.8456; train_kl_reg_loss: 759.2656; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12365.4806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13124.7462; train_optim_loss: 13124.7462; val_kl_reg_loss: 731.6186; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12136.8245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12868.4431; val_optim_loss: 12868.4431
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9310; val_auprc_score: 0.9395; val_best_acc_score: 0.8494; val_best_f1_score: 0.8476; train_kl_reg_loss: 756.3380; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12332.5125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13088.8506; train_optim_loss: 13088.8506; val_kl_reg_loss: 742.1754; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12101.1027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12843.2781; val_optim_loss: 12843.2781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9310; val_auprc_score: 0.9397; val_best_acc_score: 0.8507; val_best_f1_score: 0.8475; train_kl_reg_loss: 754.8312; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12305.2996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13060.1308; train_optim_loss: 13060.1308; val_kl_reg_loss: 741.2931; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12068.6044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12809.8976; val_optim_loss: 12809.8976
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9302; val_auprc_score: 0.9391; val_best_acc_score: 0.8492; val_best_f1_score: 0.8469; train_kl_reg_loss: 754.1362; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12287.5423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13041.6785; train_optim_loss: 13041.6785; val_kl_reg_loss: 737.8255; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12055.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12792.9094; val_optim_loss: 12792.9094
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9343; val_auprc_score: 0.9427; val_best_acc_score: 0.8560; val_best_f1_score: 0.8521; train_kl_reg_loss: 753.1013; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12275.0334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13028.1347; train_optim_loss: 13028.1347; val_kl_reg_loss: 734.1433; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12036.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12770.3036; val_optim_loss: 12770.3036
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9324; val_auprc_score: 0.9414; val_best_acc_score: 0.8524; val_best_f1_score: 0.8492; train_kl_reg_loss: 752.9293; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12259.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13012.6554; train_optim_loss: 13012.6554; val_kl_reg_loss: 748.4175; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12031.2560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12779.6736; val_optim_loss: 12779.6736
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9344; val_auprc_score: 0.9429; val_best_acc_score: 0.8553; val_best_f1_score: 0.8522; train_kl_reg_loss: 752.9151; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12244.2777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12997.1928; train_optim_loss: 12997.1928; val_kl_reg_loss: 742.3851; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12028.7238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12771.1089; val_optim_loss: 12771.1089
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9347; val_auprc_score: 0.9431; val_best_acc_score: 0.8558; val_best_f1_score: 0.8533; train_kl_reg_loss: 752.8519; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12234.8034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12987.6553; train_optim_loss: 12987.6553; val_kl_reg_loss: 746.8705; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.3161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12761.1866; val_optim_loss: 12761.1866
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9365; val_auprc_score: 0.9450; val_best_acc_score: 0.8588; val_best_f1_score: 0.8566; train_kl_reg_loss: 752.9578; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12223.4422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12976.4000; train_optim_loss: 12976.4000; val_kl_reg_loss: 734.9241; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11994.4692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12729.3933; val_optim_loss: 12729.3933
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9365; val_auprc_score: 0.9449; val_best_acc_score: 0.8588; val_best_f1_score: 0.8558; train_kl_reg_loss: 753.4147; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12212.6460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12966.0607; train_optim_loss: 12966.0607; val_kl_reg_loss: 732.6401; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12000.0540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12732.6942; val_optim_loss: 12732.6942
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9360; val_auprc_score: 0.9446; val_best_acc_score: 0.8579; val_best_f1_score: 0.8541; train_kl_reg_loss: 753.6422; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12208.1694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12961.8116; train_optim_loss: 12961.8116; val_kl_reg_loss: 745.7778; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11984.4248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12730.2026; val_optim_loss: 12730.2026
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9364; val_auprc_score: 0.9451; val_best_acc_score: 0.8591; val_best_f1_score: 0.8562; train_kl_reg_loss: 753.8850; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12197.6104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12951.4954; train_optim_loss: 12951.4954; val_kl_reg_loss: 743.0525; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11981.5936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12724.6461; val_optim_loss: 12724.6461
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9370; val_auprc_score: 0.9456; val_best_acc_score: 0.8603; val_best_f1_score: 0.8578; train_kl_reg_loss: 753.9850; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12193.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12947.5174; train_optim_loss: 12947.5174; val_kl_reg_loss: 749.8646; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11987.8729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12737.7376; val_optim_loss: 12737.7376
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9404; val_auprc_score: 0.9485; val_best_acc_score: 0.8644; val_best_f1_score: 0.8611; train_kl_reg_loss: 753.8922; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12184.0444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12937.9366; train_optim_loss: 12937.9366; val_kl_reg_loss: 738.7511; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11961.7754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12700.5265; val_optim_loss: 12700.5265
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9388; val_auprc_score: 0.9470; val_best_acc_score: 0.8631; val_best_f1_score: 0.8599; train_kl_reg_loss: 754.1008; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12177.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12931.3617; train_optim_loss: 12931.3617; val_kl_reg_loss: 740.2367; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11969.7913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12710.0280; val_optim_loss: 12710.0280
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9387; val_auprc_score: 0.9471; val_best_acc_score: 0.8628; val_best_f1_score: 0.8595; train_kl_reg_loss: 754.5099; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12175.2088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12929.7188; train_optim_loss: 12929.7188; val_kl_reg_loss: 741.9357; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11968.7574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12710.6932; val_optim_loss: 12710.6932
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9395; val_auprc_score: 0.9478; val_best_acc_score: 0.8631; val_best_f1_score: 0.8600; train_kl_reg_loss: 754.8361; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12163.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12918.3221; train_optim_loss: 12918.3221; val_kl_reg_loss: 745.9341; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11971.2702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12717.2044; val_optim_loss: 12717.2044
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9406; val_auprc_score: 0.9486; val_best_acc_score: 0.8647; val_best_f1_score: 0.8625; train_kl_reg_loss: 755.9164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12161.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12917.0996; train_optim_loss: 12917.0996; val_kl_reg_loss: 744.6765; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11970.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12715.6100; val_optim_loss: 12715.6100

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9416; val_auprc_score: 0.9496; val_best_acc_score: 0.8674; val_best_f1_score: 0.8640; train_kl_reg_loss: 752.7472; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12115.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12868.6449; train_optim_loss: 12868.6449; val_kl_reg_loss: 742.6587; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11909.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12652.2492; val_optim_loss: 12652.2492
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9417; val_auprc_score: 0.9498; val_best_acc_score: 0.8665; val_best_f1_score: 0.8638; train_kl_reg_loss: 754.2815; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12111.6689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12865.9503; train_optim_loss: 12865.9503; val_kl_reg_loss: 745.8806; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11924.0700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12669.9506; val_optim_loss: 12669.9506
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9406; val_auprc_score: 0.9490; val_best_acc_score: 0.8658; val_best_f1_score: 0.8628; train_kl_reg_loss: 754.7899; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12111.4897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12866.2795; train_optim_loss: 12866.2795; val_kl_reg_loss: 744.3827; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11914.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12658.8748; val_optim_loss: 12658.8748
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9406; val_auprc_score: 0.9485; val_best_acc_score: 0.8654; val_best_f1_score: 0.8631; train_kl_reg_loss: 755.1856; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12108.1871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12863.3726; train_optim_loss: 12863.3726; val_kl_reg_loss: 743.5976; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11902.2860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12645.8836; val_optim_loss: 12645.8836
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9415; val_auprc_score: 0.9496; val_best_acc_score: 0.8668; val_best_f1_score: 0.8641; train_kl_reg_loss: 755.5748; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12107.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12863.5407; train_optim_loss: 12863.5407; val_kl_reg_loss: 746.8955; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11900.9233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12647.8188; val_optim_loss: 12647.8188
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9415; val_auprc_score: 0.9497; val_best_acc_score: 0.8663; val_best_f1_score: 0.8640; train_kl_reg_loss: 755.5331; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12101.7751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12857.3081; train_optim_loss: 12857.3081; val_kl_reg_loss: 744.9711; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11907.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12652.8395; val_optim_loss: 12652.8395
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9419; val_auprc_score: 0.9501; val_best_acc_score: 0.8667; val_best_f1_score: 0.8643; train_kl_reg_loss: 755.7303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12102.9134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12858.6437; train_optim_loss: 12858.6437; val_kl_reg_loss: 745.9988; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11907.4566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12653.4554; val_optim_loss: 12653.4554
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9406; val_auprc_score: 0.9489; val_best_acc_score: 0.8659; val_best_f1_score: 0.8633; train_kl_reg_loss: 755.8284; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12099.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12855.5075; train_optim_loss: 12855.5075; val_kl_reg_loss: 750.4566; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11904.4573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12654.9138; val_optim_loss: 12654.9138

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9414; val_auprc_score: 0.9491; val_best_acc_score: 0.8659; val_best_f1_score: 0.8641; train_kl_reg_loss: 755.3233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12093.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12848.8724; train_optim_loss: 12848.8724; val_kl_reg_loss: 746.4823; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11892.5061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12638.9884; val_optim_loss: 12638.9884
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9414; val_auprc_score: 0.9493; val_best_acc_score: 0.8651; val_best_f1_score: 0.8633; train_kl_reg_loss: 755.4491; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12095.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12850.8152; train_optim_loss: 12850.8152; val_kl_reg_loss: 745.4751; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11912.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12658.0303; val_optim_loss: 12658.0303
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9417; val_auprc_score: 0.9497; val_best_acc_score: 0.8668; val_best_f1_score: 0.8645; train_kl_reg_loss: 755.6182; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12096.2503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12851.8685; train_optim_loss: 12851.8685; val_kl_reg_loss: 747.2782; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11903.7904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12651.0686; val_optim_loss: 12651.0686
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9413; val_auprc_score: 0.9496; val_best_acc_score: 0.8655; val_best_f1_score: 0.8634; train_kl_reg_loss: 755.5169; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12095.2982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12850.8151; train_optim_loss: 12850.8151; val_kl_reg_loss: 746.5040; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11909.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12656.0457; val_optim_loss: 12656.0457
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9417; val_auprc_score: 0.9495; val_best_acc_score: 0.8669; val_best_f1_score: 0.8648; train_kl_reg_loss: 755.7070; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12093.7915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12849.4985; train_optim_loss: 12849.4985; val_kl_reg_loss: 747.1697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11903.7945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12650.9643; val_optim_loss: 12650.9643

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9411; val_auprc_score: 0.9492; val_best_acc_score: 0.8661; val_best_f1_score: 0.8640; train_kl_reg_loss: 755.9037; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12093.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12849.5634; train_optim_loss: 12849.5634; val_kl_reg_loss: 746.9468; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11909.8559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12656.8026; val_optim_loss: 12656.8026
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9413; val_auprc_score: 0.9495; val_best_acc_score: 0.8653; val_best_f1_score: 0.8632; train_kl_reg_loss: 755.9277; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12097.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12853.9257; train_optim_loss: 12853.9257; val_kl_reg_loss: 746.4887; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11887.4404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12633.9292; val_optim_loss: 12633.9292
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9415; val_auprc_score: 0.9495; val_best_acc_score: 0.8663; val_best_f1_score: 0.8641; train_kl_reg_loss: 755.7423; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12091.9261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12847.6684; train_optim_loss: 12847.6684; val_kl_reg_loss: 746.2093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11896.3236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12642.5328; val_optim_loss: 12642.5328
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9420; val_auprc_score: 0.9499; val_best_acc_score: 0.8669; val_best_f1_score: 0.8647; train_kl_reg_loss: 755.6919; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12094.3553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12850.0472; train_optim_loss: 12850.0472; val_kl_reg_loss: 746.7384; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11910.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12657.4770; val_optim_loss: 12657.4770
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9418; val_auprc_score: 0.9495; val_best_acc_score: 0.8665; val_best_f1_score: 0.8636; train_kl_reg_loss: 755.6260; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12093.0342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12848.6602; train_optim_loss: 12848.6602; val_kl_reg_loss: 746.3421; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11892.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12639.2286; val_optim_loss: 12639.2286
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9412; val_auprc_score: 0.9494; val_best_acc_score: 0.8655; val_best_f1_score: 0.8635; train_kl_reg_loss: 755.5220; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12089.1505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12844.6725; train_optim_loss: 12844.6725; val_kl_reg_loss: 746.6291; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11892.7785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12639.4076; val_optim_loss: 12639.4076

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9415; val_auprc_score: 0.9494; val_best_acc_score: 0.8663; val_best_f1_score: 0.8642; train_kl_reg_loss: 755.6453; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12095.5157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12851.1610; train_optim_loss: 12851.1610; val_kl_reg_loss: 746.1970; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11894.4914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12640.6884; val_optim_loss: 12640.6884
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9420; val_auprc_score: 0.9501; val_best_acc_score: 0.8668; val_best_f1_score: 0.8645; train_kl_reg_loss: 755.5403; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12096.1157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12851.6559; train_optim_loss: 12851.6559; val_kl_reg_loss: 746.3622; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11891.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12637.3722; val_optim_loss: 12637.3722
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9409; val_auprc_score: 0.9491; val_best_acc_score: 0.8656; val_best_f1_score: 0.8635; train_kl_reg_loss: 755.5590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12094.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12849.8972; train_optim_loss: 12849.8972; val_kl_reg_loss: 746.6373; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11910.0577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12656.6950; val_optim_loss: 12656.6950
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9419; val_auprc_score: 0.9499; val_best_acc_score: 0.8669; val_best_f1_score: 0.8647; train_kl_reg_loss: 755.6517; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12097.0678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12852.7195; train_optim_loss: 12852.7195; val_kl_reg_loss: 746.4773; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11896.9007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12643.3781; val_optim_loss: 12643.3781

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 105 min 20 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9417
Val AUPRC score: 0.9497
Val best accuracy score: 0.8657
Val best F1 score: 0.8633
Val gene expr MSE score: 8.4201

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
