None
Run timestamp: 04072023_195051_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9197; val_auprc_score: 0.9303; val_best_acc_score: 0.8342; val_best_f1_score: 0.8306; train_kl_reg_loss: 1082.1841; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14961.3869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16043.5710; train_optim_loss: 16043.5710; val_kl_reg_loss: 858.6360; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13362.9025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14221.5384; val_optim_loss: 14221.5384
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9215; val_auprc_score: 0.9326; val_best_acc_score: 0.8388; val_best_f1_score: 0.8331; train_kl_reg_loss: 848.9169; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13280.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14129.0752; train_optim_loss: 14129.0752; val_kl_reg_loss: 794.2312; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12779.4237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13573.6549; val_optim_loss: 13573.6549
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9260; val_auprc_score: 0.9364; val_best_acc_score: 0.8449; val_best_f1_score: 0.8410; train_kl_reg_loss: 775.7655; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12904.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13679.7846; train_optim_loss: 13679.7846; val_kl_reg_loss: 733.1894; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12551.5779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13284.7673; val_optim_loss: 13284.7673
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9280; val_auprc_score: 0.9380; val_best_acc_score: 0.8473; val_best_f1_score: 0.8433; train_kl_reg_loss: 744.1853; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12721.6295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13465.8148; train_optim_loss: 13465.8148; val_kl_reg_loss: 714.5697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12410.1728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13124.7425; val_optim_loss: 13124.7425
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9298; val_auprc_score: 0.9395; val_best_acc_score: 0.8503; val_best_f1_score: 0.8458; train_kl_reg_loss: 729.3279; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12614.1138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13343.4417; train_optim_loss: 13343.4417; val_kl_reg_loss: 700.3146; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12338.8026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13039.1172; val_optim_loss: 13039.1172
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9298; val_auprc_score: 0.9391; val_best_acc_score: 0.8491; val_best_f1_score: 0.8458; train_kl_reg_loss: 720.4765; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12541.5375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13262.0140; train_optim_loss: 13262.0140; val_kl_reg_loss: 698.8582; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12292.2468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12991.1050; val_optim_loss: 12991.1050
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9294; val_auprc_score: 0.9392; val_best_acc_score: 0.8486; val_best_f1_score: 0.8462; train_kl_reg_loss: 717.1148; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12494.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13211.5276; train_optim_loss: 13211.5276; val_kl_reg_loss: 700.4392; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12235.5268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12935.9660; val_optim_loss: 12935.9660
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9300; val_auprc_score: 0.9398; val_best_acc_score: 0.8507; val_best_f1_score: 0.8469; train_kl_reg_loss: 715.7431; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12455.3278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13171.0710; train_optim_loss: 13171.0710; val_kl_reg_loss: 690.5550; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12222.5779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12913.1330; val_optim_loss: 12913.1330
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9303; val_auprc_score: 0.9401; val_best_acc_score: 0.8520; val_best_f1_score: 0.8474; train_kl_reg_loss: 714.6620; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12431.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13145.7149; train_optim_loss: 13145.7149; val_kl_reg_loss: 701.0388; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12202.0167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12903.0555; val_optim_loss: 12903.0555
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9305; val_auprc_score: 0.9406; val_best_acc_score: 0.8523; val_best_f1_score: 0.8481; train_kl_reg_loss: 714.7978; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12410.9429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13125.7407; train_optim_loss: 13125.7407; val_kl_reg_loss: 709.2670; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12174.6687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12883.9358; val_optim_loss: 12883.9358
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9318; val_auprc_score: 0.9419; val_best_acc_score: 0.8528; val_best_f1_score: 0.8501; train_kl_reg_loss: 715.2222; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12395.2907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13110.5129; train_optim_loss: 13110.5129; val_kl_reg_loss: 720.5127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12152.7998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12873.3124; val_optim_loss: 12873.3124
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9340; val_auprc_score: 0.9436; val_best_acc_score: 0.8573; val_best_f1_score: 0.8534; train_kl_reg_loss: 716.0646; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12380.1556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13096.2202; train_optim_loss: 13096.2202; val_kl_reg_loss: 704.7549; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12164.4374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12869.1923; val_optim_loss: 12869.1923
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9325; val_auprc_score: 0.9425; val_best_acc_score: 0.8541; val_best_f1_score: 0.8508; train_kl_reg_loss: 716.5651; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12371.5692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13088.1343; train_optim_loss: 13088.1343; val_kl_reg_loss: 703.3882; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12148.5973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12851.9855; val_optim_loss: 12851.9855
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9354; val_auprc_score: 0.9449; val_best_acc_score: 0.8595; val_best_f1_score: 0.8550; train_kl_reg_loss: 717.5682; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12362.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13079.5871; train_optim_loss: 13079.5871; val_kl_reg_loss: 705.9800; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12132.5051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12838.4850; val_optim_loss: 12838.4850
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9355; val_auprc_score: 0.9449; val_best_acc_score: 0.8592; val_best_f1_score: 0.8547; train_kl_reg_loss: 718.4386; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12353.0955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13071.5340; train_optim_loss: 13071.5340; val_kl_reg_loss: 713.3916; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12115.7098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12829.1014; val_optim_loss: 12829.1014
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9359; val_auprc_score: 0.9453; val_best_acc_score: 0.8598; val_best_f1_score: 0.8559; train_kl_reg_loss: 719.5832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12338.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13057.9797; train_optim_loss: 13057.9797; val_kl_reg_loss: 711.2363; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12106.7553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12817.9916; val_optim_loss: 12817.9916
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9361; val_auprc_score: 0.9457; val_best_acc_score: 0.8595; val_best_f1_score: 0.8552; train_kl_reg_loss: 721.1108; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12337.5485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13058.6592; train_optim_loss: 13058.6592; val_kl_reg_loss: 707.0086; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12102.8505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12809.8591; val_optim_loss: 12809.8591
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9384; val_auprc_score: 0.9479; val_best_acc_score: 0.8650; val_best_f1_score: 0.8598; train_kl_reg_loss: 722.2425; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12331.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13054.0147; train_optim_loss: 13054.0147; val_kl_reg_loss: 715.0423; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12113.8626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12828.9050; val_optim_loss: 12828.9050
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9389; val_auprc_score: 0.9483; val_best_acc_score: 0.8644; val_best_f1_score: 0.8609; train_kl_reg_loss: 723.8080; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12318.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13042.0920; train_optim_loss: 13042.0920; val_kl_reg_loss: 716.9420; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12103.9126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12820.8547; val_optim_loss: 12820.8547
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9393; val_auprc_score: 0.9483; val_best_acc_score: 0.8644; val_best_f1_score: 0.8604; train_kl_reg_loss: 725.4500; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12320.6535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13046.1035; train_optim_loss: 13046.1035; val_kl_reg_loss: 723.3949; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12100.1289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12823.5237; val_optim_loss: 12823.5237
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9377; val_auprc_score: 0.9471; val_best_acc_score: 0.8619; val_best_f1_score: 0.8585; train_kl_reg_loss: 726.7391; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12311.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13038.6055; train_optim_loss: 13038.6055; val_kl_reg_loss: 721.8814; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12096.6675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12818.5490; val_optim_loss: 12818.5490

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9406; val_auprc_score: 0.9497; val_best_acc_score: 0.8668; val_best_f1_score: 0.8626; train_kl_reg_loss: 722.7919; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12238.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12961.3377; train_optim_loss: 12961.3377; val_kl_reg_loss: 715.1131; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12038.1050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12753.2180; val_optim_loss: 12753.2180
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9406; val_auprc_score: 0.9498; val_best_acc_score: 0.8661; val_best_f1_score: 0.8623; train_kl_reg_loss: 724.2803; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12223.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12948.1535; train_optim_loss: 12948.1535; val_kl_reg_loss: 718.9358; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12045.4900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12764.4259; val_optim_loss: 12764.4259
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9405; val_auprc_score: 0.9496; val_best_acc_score: 0.8674; val_best_f1_score: 0.8629; train_kl_reg_loss: 724.9347; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12222.1178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12947.0525; train_optim_loss: 12947.0525; val_kl_reg_loss: 718.1280; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12030.6134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12748.7414; val_optim_loss: 12748.7414
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9397; val_auprc_score: 0.9488; val_best_acc_score: 0.8656; val_best_f1_score: 0.8613; train_kl_reg_loss: 725.5045; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12218.6717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12944.1762; train_optim_loss: 12944.1762; val_kl_reg_loss: 718.8814; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12041.7315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12760.6129; val_optim_loss: 12760.6129
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9401; val_auprc_score: 0.9492; val_best_acc_score: 0.8663; val_best_f1_score: 0.8620; train_kl_reg_loss: 726.0787; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12218.1368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12944.2155; train_optim_loss: 12944.2155; val_kl_reg_loss: 714.9327; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12028.3888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12743.3215; val_optim_loss: 12743.3215
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9418; val_auprc_score: 0.9510; val_best_acc_score: 0.8690; val_best_f1_score: 0.8649; train_kl_reg_loss: 726.2322; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12212.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12938.3684; train_optim_loss: 12938.3684; val_kl_reg_loss: 717.3500; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12023.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12741.2150; val_optim_loss: 12741.2150
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9412; val_auprc_score: 0.9502; val_best_acc_score: 0.8673; val_best_f1_score: 0.8635; train_kl_reg_loss: 726.3503; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12209.0633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12935.4136; train_optim_loss: 12935.4136; val_kl_reg_loss: 717.2230; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12020.4527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12737.6757; val_optim_loss: 12737.6757
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9411; val_auprc_score: 0.9501; val_best_acc_score: 0.8674; val_best_f1_score: 0.8638; train_kl_reg_loss: 726.8434; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12213.7642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12940.6076; train_optim_loss: 12940.6076; val_kl_reg_loss: 722.1243; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12032.5721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12754.6963; val_optim_loss: 12754.6963
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9409; val_auprc_score: 0.9500; val_best_acc_score: 0.8680; val_best_f1_score: 0.8631; train_kl_reg_loss: 727.4233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12210.1577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12937.5810; train_optim_loss: 12937.5810; val_kl_reg_loss: 717.7764; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12030.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12748.3793; val_optim_loss: 12748.3793
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9410; val_auprc_score: 0.9499; val_best_acc_score: 0.8672; val_best_f1_score: 0.8633; train_kl_reg_loss: 727.5836; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12205.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12932.6778; train_optim_loss: 12932.6778; val_kl_reg_loss: 717.5338; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12016.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12734.3793; val_optim_loss: 12734.3793
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9406; val_auprc_score: 0.9497; val_best_acc_score: 0.8667; val_best_f1_score: 0.8626; train_kl_reg_loss: 727.7551; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12204.9538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12932.7090; train_optim_loss: 12932.7090; val_kl_reg_loss: 722.7900; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12024.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12746.9670; val_optim_loss: 12746.9670
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9402; val_auprc_score: 0.9490; val_best_acc_score: 0.8662; val_best_f1_score: 0.8631; train_kl_reg_loss: 728.2877; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12205.3862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12933.6739; train_optim_loss: 12933.6739; val_kl_reg_loss: 722.4709; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.7627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12737.2336; val_optim_loss: 12737.2336
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9416; val_auprc_score: 0.9505; val_best_acc_score: 0.8680; val_best_f1_score: 0.8638; train_kl_reg_loss: 728.3100; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12199.5598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12927.8698; train_optim_loss: 12927.8698; val_kl_reg_loss: 723.2977; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12011.0506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12734.3483; val_optim_loss: 12734.3483
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9412; val_auprc_score: 0.9501; val_best_acc_score: 0.8666; val_best_f1_score: 0.8636; train_kl_reg_loss: 728.7514; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12202.1170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12930.8684; train_optim_loss: 12930.8684; val_kl_reg_loss: 719.6344; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12025.1739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12744.8083; val_optim_loss: 12744.8083
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9413; val_auprc_score: 0.9504; val_best_acc_score: 0.8675; val_best_f1_score: 0.8636; train_kl_reg_loss: 729.2476; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12203.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12932.4826; train_optim_loss: 12932.4826; val_kl_reg_loss: 722.2062; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.3142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12736.5204; val_optim_loss: 12736.5204
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9410; val_auprc_score: 0.9500; val_best_acc_score: 0.8671; val_best_f1_score: 0.8636; train_kl_reg_loss: 729.5429; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12206.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12935.7790; train_optim_loss: 12935.7790; val_kl_reg_loss: 721.9270; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.3810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12736.3080; val_optim_loss: 12736.3080
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9414; val_auprc_score: 0.9505; val_best_acc_score: 0.8683; val_best_f1_score: 0.8642; train_kl_reg_loss: 729.7949; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12200.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12930.1353; train_optim_loss: 12930.1353; val_kl_reg_loss: 723.0970; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12007.1551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12730.2521; val_optim_loss: 12730.2521
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9425; val_auprc_score: 0.9513; val_best_acc_score: 0.8693; val_best_f1_score: 0.8664; train_kl_reg_loss: 730.1550; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12199.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12929.3366; train_optim_loss: 12929.3366; val_kl_reg_loss: 723.1310; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12008.0924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12731.2234; val_optim_loss: 12731.2234
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9407; val_auprc_score: 0.9499; val_best_acc_score: 0.8672; val_best_f1_score: 0.8632; train_kl_reg_loss: 730.3636; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12200.0904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12930.4539; train_optim_loss: 12930.4539; val_kl_reg_loss: 725.8306; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12021.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12747.3134; val_optim_loss: 12747.3134
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9417; val_auprc_score: 0.9505; val_best_acc_score: 0.8679; val_best_f1_score: 0.8656; train_kl_reg_loss: 730.4884; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12196.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12926.5232; train_optim_loss: 12926.5232; val_kl_reg_loss: 722.8691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12020.5812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12743.4503; val_optim_loss: 12743.4503
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9417; val_auprc_score: 0.9508; val_best_acc_score: 0.8676; val_best_f1_score: 0.8649; train_kl_reg_loss: 730.9644; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12194.5915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12925.5560; train_optim_loss: 12925.5560; val_kl_reg_loss: 721.1092; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12017.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12738.9702; val_optim_loss: 12738.9702

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9414; val_auprc_score: 0.9504; val_best_acc_score: 0.8678; val_best_f1_score: 0.8645; train_kl_reg_loss: 730.0243; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12184.6004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12914.6246; train_optim_loss: 12914.6246; val_kl_reg_loss: 722.2100; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12001.1069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12723.3169; val_optim_loss: 12723.3169
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9416; val_auprc_score: 0.9507; val_best_acc_score: 0.8682; val_best_f1_score: 0.8653; train_kl_reg_loss: 730.2202; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12189.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12919.2979; train_optim_loss: 12919.2979; val_kl_reg_loss: 723.0129; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12002.9657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12725.9787; val_optim_loss: 12725.9787
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9414; val_auprc_score: 0.9505; val_best_acc_score: 0.8675; val_best_f1_score: 0.8641; train_kl_reg_loss: 730.3050; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12183.9950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12914.3000; train_optim_loss: 12914.3000; val_kl_reg_loss: 721.9189; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12001.3685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12723.2873; val_optim_loss: 12723.2873
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9421; val_auprc_score: 0.9507; val_best_acc_score: 0.8683; val_best_f1_score: 0.8652; train_kl_reg_loss: 730.5225; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12186.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12917.2015; train_optim_loss: 12917.2015; val_kl_reg_loss: 721.7370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11999.2570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12720.9940; val_optim_loss: 12720.9940
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9416; val_auprc_score: 0.9504; val_best_acc_score: 0.8678; val_best_f1_score: 0.8651; train_kl_reg_loss: 730.3954; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12182.5830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12912.9784; train_optim_loss: 12912.9784; val_kl_reg_loss: 722.1162; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12007.1659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12729.2821; val_optim_loss: 12729.2821
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9425; val_auprc_score: 0.9516; val_best_acc_score: 0.8694; val_best_f1_score: 0.8666; train_kl_reg_loss: 730.4832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12186.2244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12916.7076; train_optim_loss: 12916.7076; val_kl_reg_loss: 723.2484; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12009.0282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12732.2766; val_optim_loss: 12732.2766
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9419; val_auprc_score: 0.9507; val_best_acc_score: 0.8686; val_best_f1_score: 0.8661; train_kl_reg_loss: 730.6890; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12182.4574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12913.1464; train_optim_loss: 12913.1464; val_kl_reg_loss: 722.5392; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12736.7833; val_optim_loss: 12736.7833
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9420; val_auprc_score: 0.9512; val_best_acc_score: 0.8687; val_best_f1_score: 0.8655; train_kl_reg_loss: 730.8049; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12183.4969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12914.3017; train_optim_loss: 12914.3017; val_kl_reg_loss: 721.9992; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12012.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12734.6404; val_optim_loss: 12734.6404

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9424; val_auprc_score: 0.9514; val_best_acc_score: 0.8692; val_best_f1_score: 0.8666; train_kl_reg_loss: 730.5188; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12181.2650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12911.7839; train_optim_loss: 12911.7839; val_kl_reg_loss: 722.5542; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12006.6448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12729.1991; val_optim_loss: 12729.1991
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9414; val_auprc_score: 0.9504; val_best_acc_score: 0.8672; val_best_f1_score: 0.8646; train_kl_reg_loss: 730.5832; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12179.6063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12910.1895; train_optim_loss: 12910.1895; val_kl_reg_loss: 722.5404; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12011.4356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12733.9761; val_optim_loss: 12733.9761
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9431; val_auprc_score: 0.9519; val_best_acc_score: 0.8701; val_best_f1_score: 0.8674; train_kl_reg_loss: 730.8536; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12189.7453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12920.5989; train_optim_loss: 12920.5989; val_kl_reg_loss: 722.6974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11999.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12721.7419; val_optim_loss: 12721.7419
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9419; val_auprc_score: 0.9506; val_best_acc_score: 0.8678; val_best_f1_score: 0.8649; train_kl_reg_loss: 730.8063; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12185.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12916.0397; train_optim_loss: 12916.0397; val_kl_reg_loss: 722.6809; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12015.1059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12737.7868; val_optim_loss: 12737.7868

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 29 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9421
Val AUPRC score: 0.9510
Val best accuracy score: 0.8675
Val best F1 score: 0.8648
Val gene expr MSE score: 8.6046

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
