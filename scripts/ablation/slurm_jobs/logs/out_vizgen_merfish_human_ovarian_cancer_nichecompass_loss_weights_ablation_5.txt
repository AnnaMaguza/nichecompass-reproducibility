None
Run timestamp: 14072023_153735_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9147; val_auprc_score: 0.9113; val_best_acc_score: 0.8311; val_best_f1_score: 0.8393; train_kl_reg_loss: 88277.1210; train_edge_recon_loss: 3047183.9346; train_gene_expr_recon_loss: 14163425.7026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17298886.7668; train_optim_loss: 17298886.7668; val_kl_reg_loss: 78805.1838; val_edge_recon_loss: 2857016.8000; val_gene_expr_recon_loss: 13073940.9182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16009762.9000; val_optim_loss: 16009762.9000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9536; val_auprc_score: 0.9506; val_best_acc_score: 0.8862; val_best_f1_score: 0.8884; train_kl_reg_loss: 76949.0645; train_edge_recon_loss: 2745627.3791; train_gene_expr_recon_loss: 12796915.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15619491.9124; train_optim_loss: 15619491.9124; val_kl_reg_loss: 66835.8460; val_edge_recon_loss: 2774048.8159; val_gene_expr_recon_loss: 12534410.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15375295.2182; val_optim_loss: 15375295.2182
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9656; val_auprc_score: 0.9640; val_best_acc_score: 0.9052; val_best_f1_score: 0.9067; train_kl_reg_loss: 63014.4947; train_edge_recon_loss: 2709908.4399; train_gene_expr_recon_loss: 12387582.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15160504.9756; train_optim_loss: 15160504.9756; val_kl_reg_loss: 57159.8796; val_edge_recon_loss: 2741209.8818; val_gene_expr_recon_loss: 12230833.4455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15029203.2000; val_optim_loss: 15029203.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9709; val_auprc_score: 0.9694; val_best_acc_score: 0.9139; val_best_f1_score: 0.9151; train_kl_reg_loss: 56317.0501; train_edge_recon_loss: 2684860.8187; train_gene_expr_recon_loss: 12129572.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14870750.2424; train_optim_loss: 14870750.2424; val_kl_reg_loss: 52954.8725; val_edge_recon_loss: 2730309.5659; val_gene_expr_recon_loss: 12026899.3818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14810163.8273; val_optim_loss: 14810163.8273
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9742; val_auprc_score: 0.9727; val_best_acc_score: 0.9202; val_best_f1_score: 0.9213; train_kl_reg_loss: 53392.0275; train_edge_recon_loss: 2672606.3124; train_gene_expr_recon_loss: 11964812.2006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14690810.5295; train_optim_loss: 14690810.5295; val_kl_reg_loss: 50421.4873; val_edge_recon_loss: 2717067.5318; val_gene_expr_recon_loss: 11884798.0818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14652287.1636; val_optim_loss: 14652287.1636
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9749; val_auprc_score: 0.9736; val_best_acc_score: 0.9220; val_best_f1_score: 0.9227; train_kl_reg_loss: 51175.1458; train_edge_recon_loss: 2667244.3478; train_gene_expr_recon_loss: 11847504.7536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14565924.2424; train_optim_loss: 14565924.2424; val_kl_reg_loss: 48571.3904; val_edge_recon_loss: 2711316.4955; val_gene_expr_recon_loss: 11825075.3091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14584963.2818; val_optim_loss: 14584963.2818
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9764; val_auprc_score: 0.9749; val_best_acc_score: 0.9241; val_best_f1_score: 0.9250; train_kl_reg_loss: 49582.8802; train_edge_recon_loss: 2661227.7110; train_gene_expr_recon_loss: 11778743.1650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14489553.7566; train_optim_loss: 14489553.7566; val_kl_reg_loss: 47963.3646; val_edge_recon_loss: 2706688.3432; val_gene_expr_recon_loss: 11764670.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14519322.5364; val_optim_loss: 14519322.5364
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9781; val_auprc_score: 0.9771; val_best_acc_score: 0.9279; val_best_f1_score: 0.9284; train_kl_reg_loss: 48502.3305; train_edge_recon_loss: 2656789.7195; train_gene_expr_recon_loss: 11726974.7189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14432266.7719; train_optim_loss: 14432266.7719; val_kl_reg_loss: 46447.2006; val_edge_recon_loss: 2702982.6705; val_gene_expr_recon_loss: 11726664.6545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14476094.5364; val_optim_loss: 14476094.5364
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9758; val_best_acc_score: 0.9263; val_best_f1_score: 0.9271; train_kl_reg_loss: 47691.2190; train_edge_recon_loss: 2655392.6176; train_gene_expr_recon_loss: 11687483.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14390566.9817; train_optim_loss: 14390566.9817; val_kl_reg_loss: 46154.8944; val_edge_recon_loss: 2704056.2114; val_gene_expr_recon_loss: 11688363.8091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14438574.9000; val_optim_loss: 14438574.9000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9792; val_auprc_score: 0.9781; val_best_acc_score: 0.9292; val_best_f1_score: 0.9298; train_kl_reg_loss: 46683.3550; train_edge_recon_loss: 2653611.0000; train_gene_expr_recon_loss: 11658087.6191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14358381.9705; train_optim_loss: 14358381.9705; val_kl_reg_loss: 45515.5280; val_edge_recon_loss: 2698234.3432; val_gene_expr_recon_loss: 11674054.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14417804.6182; val_optim_loss: 14417804.6182
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9788; val_auprc_score: 0.9775; val_best_acc_score: 0.9282; val_best_f1_score: 0.9288; train_kl_reg_loss: 46095.3463; train_edge_recon_loss: 2650824.3401; train_gene_expr_recon_loss: 11633401.6721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14330321.3473; train_optim_loss: 14330321.3473; val_kl_reg_loss: 44354.6777; val_edge_recon_loss: 2701300.8136; val_gene_expr_recon_loss: 11654203.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14399859.3636; val_optim_loss: 14399859.3636
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9788; val_auprc_score: 0.9773; val_best_acc_score: 0.9285; val_best_f1_score: 0.9293; train_kl_reg_loss: 45587.3435; train_edge_recon_loss: 2647809.8317; train_gene_expr_recon_loss: 11618838.1640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14312235.3686; train_optim_loss: 14312235.3686; val_kl_reg_loss: 44332.8659; val_edge_recon_loss: 2700145.7000; val_gene_expr_recon_loss: 11652600.8727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14397079.4818; val_optim_loss: 14397079.4818
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9796; val_auprc_score: 0.9781; val_best_acc_score: 0.9295; val_best_f1_score: 0.9299; train_kl_reg_loss: 44909.8523; train_edge_recon_loss: 2648125.0163; train_gene_expr_recon_loss: 11604237.2678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14297272.1263; train_optim_loss: 14297272.1263; val_kl_reg_loss: 43538.9488; val_edge_recon_loss: 2694681.3159; val_gene_expr_recon_loss: 11621529.9182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14359750.1455; val_optim_loss: 14359750.1455
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9780; val_best_acc_score: 0.9292; val_best_f1_score: 0.9296; train_kl_reg_loss: 44558.1326; train_edge_recon_loss: 2645700.5418; train_gene_expr_recon_loss: 11586816.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14277075.1029; train_optim_loss: 14277075.1029; val_kl_reg_loss: 42965.7435; val_edge_recon_loss: 2695930.8636; val_gene_expr_recon_loss: 11629632.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14368529.5545; val_optim_loss: 14368529.5545
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9804; val_auprc_score: 0.9792; val_best_acc_score: 0.9307; val_best_f1_score: 0.9312; train_kl_reg_loss: 44024.1734; train_edge_recon_loss: 2644534.8320; train_gene_expr_recon_loss: 11576618.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14265177.7047; train_optim_loss: 14265177.7047; val_kl_reg_loss: 42472.1674; val_edge_recon_loss: 2698070.7682; val_gene_expr_recon_loss: 11601874.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14342417.0091; val_optim_loss: 14342417.0091
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9797; val_auprc_score: 0.9785; val_best_acc_score: 0.9294; val_best_f1_score: 0.9302; train_kl_reg_loss: 43707.5171; train_edge_recon_loss: 2643139.5064; train_gene_expr_recon_loss: 11569416.2281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14256263.2525; train_optim_loss: 14256263.2525; val_kl_reg_loss: 41784.6018; val_edge_recon_loss: 2698536.5591; val_gene_expr_recon_loss: 11609670.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14349991.6909; val_optim_loss: 14349991.6909
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9797; val_auprc_score: 0.9783; val_best_acc_score: 0.9300; val_best_f1_score: 0.9308; train_kl_reg_loss: 43325.8575; train_edge_recon_loss: 2643438.3597; train_gene_expr_recon_loss: 11555565.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14242330.0815; train_optim_loss: 14242330.0815; val_kl_reg_loss: 42713.8064; val_edge_recon_loss: 2696369.0023; val_gene_expr_recon_loss: 11599288.9636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14338371.7364; val_optim_loss: 14338371.7364
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9811; val_auprc_score: 0.9795; val_best_acc_score: 0.9330; val_best_f1_score: 0.9336; train_kl_reg_loss: 43018.1932; train_edge_recon_loss: 2642516.2304; train_gene_expr_recon_loss: 11553370.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14238904.6538; train_optim_loss: 14238904.6538; val_kl_reg_loss: 41349.9557; val_edge_recon_loss: 2691608.7273; val_gene_expr_recon_loss: 11589889.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14322848.2273; val_optim_loss: 14322848.2273
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9814; val_auprc_score: 0.9803; val_best_acc_score: 0.9337; val_best_f1_score: 0.9341; train_kl_reg_loss: 42734.6071; train_edge_recon_loss: 2640723.7197; train_gene_expr_recon_loss: 11540379.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14223837.5916; train_optim_loss: 14223837.5916; val_kl_reg_loss: 41095.0865; val_edge_recon_loss: 2688484.4318; val_gene_expr_recon_loss: 11603266.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14332846.5000; val_optim_loss: 14332846.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9806; val_auprc_score: 0.9798; val_best_acc_score: 0.9309; val_best_f1_score: 0.9315; train_kl_reg_loss: 42332.3975; train_edge_recon_loss: 2640824.7946; train_gene_expr_recon_loss: 11535363.2464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14218520.4379; train_optim_loss: 14218520.4379; val_kl_reg_loss: 40975.7708; val_edge_recon_loss: 2693849.7818; val_gene_expr_recon_loss: 11585779.0818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14320604.6727; val_optim_loss: 14320604.6727
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9811; val_auprc_score: 0.9797; val_best_acc_score: 0.9320; val_best_f1_score: 0.9326; train_kl_reg_loss: 42113.4709; train_edge_recon_loss: 2639819.7108; train_gene_expr_recon_loss: 11531124.2984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14213057.4613; train_optim_loss: 14213057.4613; val_kl_reg_loss: 41439.6523; val_edge_recon_loss: 2693735.9659; val_gene_expr_recon_loss: 11558367.8818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14293543.5091; val_optim_loss: 14293543.5091
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9813; val_auprc_score: 0.9803; val_best_acc_score: 0.9325; val_best_f1_score: 0.9331; train_kl_reg_loss: 41867.5385; train_edge_recon_loss: 2639391.1194; train_gene_expr_recon_loss: 11527369.1385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14208627.7892; train_optim_loss: 14208627.7892; val_kl_reg_loss: 40024.4362; val_edge_recon_loss: 2693011.3659; val_gene_expr_recon_loss: 11575366.9909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14308402.7818; val_optim_loss: 14308402.7818
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9814; val_auprc_score: 0.9803; val_best_acc_score: 0.9328; val_best_f1_score: 0.9333; train_kl_reg_loss: 41744.6040; train_edge_recon_loss: 2637267.4129; train_gene_expr_recon_loss: 11528066.2882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14207078.2974; train_optim_loss: 14207078.2974; val_kl_reg_loss: 40391.6274; val_edge_recon_loss: 2690336.0045; val_gene_expr_recon_loss: 11573108.4455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14303836.0545; val_optim_loss: 14303836.0545
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9809; val_auprc_score: 0.9798; val_best_acc_score: 0.9318; val_best_f1_score: 0.9323; train_kl_reg_loss: 41435.5784; train_edge_recon_loss: 2637309.7879; train_gene_expr_recon_loss: 11521646.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14200392.3371; train_optim_loss: 14200392.3371; val_kl_reg_loss: 39709.1153; val_edge_recon_loss: 2693559.5659; val_gene_expr_recon_loss: 11569828.0727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14303096.7636; val_optim_loss: 14303096.7636
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9817; val_auprc_score: 0.9805; val_best_acc_score: 0.9327; val_best_f1_score: 0.9333; train_kl_reg_loss: 41089.8941; train_edge_recon_loss: 2636771.4840; train_gene_expr_recon_loss: 11518312.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14196173.7088; train_optim_loss: 14196173.7088; val_kl_reg_loss: 40009.1080; val_edge_recon_loss: 2691030.1773; val_gene_expr_recon_loss: 11581012.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14312052.0182; val_optim_loss: 14312052.0182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9817; val_auprc_score: 0.9806; val_best_acc_score: 0.9325; val_best_f1_score: 0.9331; train_kl_reg_loss: 41685.6842; train_edge_recon_loss: 2634384.7902; train_gene_expr_recon_loss: 11431435.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14107505.9124; train_optim_loss: 14107505.9124; val_kl_reg_loss: 40916.4861; val_edge_recon_loss: 2687526.5341; val_gene_expr_recon_loss: 11495980.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14224423.1000; val_optim_loss: 14224423.1000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9822; val_auprc_score: 0.9813; val_best_acc_score: 0.9340; val_best_f1_score: 0.9342; train_kl_reg_loss: 42050.1363; train_edge_recon_loss: 2633958.7538; train_gene_expr_recon_loss: 11428362.2821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14104371.1680; train_optim_loss: 14104371.1680; val_kl_reg_loss: 40995.4093; val_edge_recon_loss: 2686978.9000; val_gene_expr_recon_loss: 11484159.1273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14212133.4091; val_optim_loss: 14212133.4091
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9821; val_auprc_score: 0.9811; val_best_acc_score: 0.9336; val_best_f1_score: 0.9341; train_kl_reg_loss: 42209.9165; train_edge_recon_loss: 2632945.0743; train_gene_expr_recon_loss: 11426639.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14101794.6334; train_optim_loss: 14101794.6334; val_kl_reg_loss: 41014.4484; val_edge_recon_loss: 2685269.2136; val_gene_expr_recon_loss: 11502008.9364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14228292.5727; val_optim_loss: 14228292.5727
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9818; val_auprc_score: 0.9804; val_best_acc_score: 0.9334; val_best_f1_score: 0.9340; train_kl_reg_loss: 42211.0463; train_edge_recon_loss: 2632682.3686; train_gene_expr_recon_loss: 11426356.0051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14101249.4063; train_optim_loss: 14101249.4063; val_kl_reg_loss: 40914.2974; val_edge_recon_loss: 2688899.1909; val_gene_expr_recon_loss: 11473261.0818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14203074.5727; val_optim_loss: 14203074.5727
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9820; val_auprc_score: 0.9806; val_best_acc_score: 0.9339; val_best_f1_score: 0.9346; train_kl_reg_loss: 42080.0738; train_edge_recon_loss: 2632913.7912; train_gene_expr_recon_loss: 11423633.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14098627.1538; train_optim_loss: 14098627.1538; val_kl_reg_loss: 40838.8147; val_edge_recon_loss: 2687289.3614; val_gene_expr_recon_loss: 11496118.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14224246.7273; val_optim_loss: 14224246.7273
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9820; val_auprc_score: 0.9809; val_best_acc_score: 0.9339; val_best_f1_score: 0.9344; train_kl_reg_loss: 42031.3442; train_edge_recon_loss: 2632894.3661; train_gene_expr_recon_loss: 11424298.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14099223.8024; train_optim_loss: 14099223.8024; val_kl_reg_loss: 40974.2948; val_edge_recon_loss: 2684288.0455; val_gene_expr_recon_loss: 11498313.7909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14223576.0818; val_optim_loss: 14223576.0818
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9818; val_auprc_score: 0.9804; val_best_acc_score: 0.9339; val_best_f1_score: 0.9343; train_kl_reg_loss: 41983.5367; train_edge_recon_loss: 2632119.4687; train_gene_expr_recon_loss: 11420893.2525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14094996.2760; train_optim_loss: 14094996.2760; val_kl_reg_loss: 40737.5152; val_edge_recon_loss: 2687603.7727; val_gene_expr_recon_loss: 11492257.7545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14220599.0636; val_optim_loss: 14220599.0636
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9821; val_auprc_score: 0.9810; val_best_acc_score: 0.9339; val_best_f1_score: 0.9343; train_kl_reg_loss: 41844.1685; train_edge_recon_loss: 2631921.3269; train_gene_expr_recon_loss: 11419302.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14093067.8177; train_optim_loss: 14093067.8177; val_kl_reg_loss: 40722.1005; val_edge_recon_loss: 2684949.1364; val_gene_expr_recon_loss: 11492833.5091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14218504.7364; val_optim_loss: 14218504.7364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9820; val_auprc_score: 0.9807; val_best_acc_score: 0.9343; val_best_f1_score: 0.9347; train_kl_reg_loss: 41837.5002; train_edge_recon_loss: 2631690.6889; train_gene_expr_recon_loss: 11408080.9817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14081609.1599; train_optim_loss: 14081609.1599; val_kl_reg_loss: 40734.7668; val_edge_recon_loss: 2686132.4977; val_gene_expr_recon_loss: 11473034.5545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14199901.8091; val_optim_loss: 14199901.8091
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9827; val_auprc_score: 0.9815; val_best_acc_score: 0.9353; val_best_f1_score: 0.9356; train_kl_reg_loss: 41845.1268; train_edge_recon_loss: 2632745.9272; train_gene_expr_recon_loss: 11409812.3310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14084403.3768; train_optim_loss: 14084403.3768; val_kl_reg_loss: 40652.2975; val_edge_recon_loss: 2682775.3591; val_gene_expr_recon_loss: 11472219.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14195647.4364; val_optim_loss: 14195647.4364
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9824; val_auprc_score: 0.9814; val_best_acc_score: 0.9350; val_best_f1_score: 0.9354; train_kl_reg_loss: 41829.6128; train_edge_recon_loss: 2631590.8760; train_gene_expr_recon_loss: 11408082.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14081502.7088; train_optim_loss: 14081502.7088; val_kl_reg_loss: 40689.7811; val_edge_recon_loss: 2687542.7977; val_gene_expr_recon_loss: 11479835.0727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14208067.6636; val_optim_loss: 14208067.6636
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9824; val_auprc_score: 0.9816; val_best_acc_score: 0.9350; val_best_f1_score: 0.9354; train_kl_reg_loss: 41838.3127; train_edge_recon_loss: 2632569.4272; train_gene_expr_recon_loss: 11402360.3452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14076768.0682; train_optim_loss: 14076768.0682; val_kl_reg_loss: 40744.3237; val_edge_recon_loss: 2685028.5523; val_gene_expr_recon_loss: 11472874.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14198647.3818; val_optim_loss: 14198647.3818
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9823; val_auprc_score: 0.9814; val_best_acc_score: 0.9345; val_best_f1_score: 0.9349; train_kl_reg_loss: 41844.2207; train_edge_recon_loss: 2632819.4623; train_gene_expr_recon_loss: 11403564.4929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14078228.1650; train_optim_loss: 14078228.1650; val_kl_reg_loss: 40708.2578; val_edge_recon_loss: 2687593.7750; val_gene_expr_recon_loss: 11481015.7818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14209317.8455; val_optim_loss: 14209317.8455
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9821; val_auprc_score: 0.9811; val_best_acc_score: 0.9346; val_best_f1_score: 0.9350; train_kl_reg_loss: 41873.4268; train_edge_recon_loss: 2630964.8386; train_gene_expr_recon_loss: 11405949.7994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14078788.0519; train_optim_loss: 14078788.0519; val_kl_reg_loss: 40669.0385; val_edge_recon_loss: 2688502.4409; val_gene_expr_recon_loss: 11458648.7182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14187820.2000; val_optim_loss: 14187820.2000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9820; val_auprc_score: 0.9809; val_best_acc_score: 0.9338; val_best_f1_score: 0.9342; train_kl_reg_loss: 41826.5736; train_edge_recon_loss: 2630843.8063; train_gene_expr_recon_loss: 11403718.5947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14076388.9521; train_optim_loss: 14076388.9521; val_kl_reg_loss: 40698.6891; val_edge_recon_loss: 2688571.0159; val_gene_expr_recon_loss: 11471519.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14200788.9727; val_optim_loss: 14200788.9727
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9821; val_auprc_score: 0.9808; val_best_acc_score: 0.9347; val_best_f1_score: 0.9351; train_kl_reg_loss: 41830.3045; train_edge_recon_loss: 2631473.0219; train_gene_expr_recon_loss: 11406172.1955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14079475.5234; train_optim_loss: 14079475.5234; val_kl_reg_loss: 40689.7587; val_edge_recon_loss: 2684826.3773; val_gene_expr_recon_loss: 11483640.7545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14209156.8182; val_optim_loss: 14209156.8182
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9821; val_auprc_score: 0.9811; val_best_acc_score: 0.9339; val_best_f1_score: 0.9343; train_kl_reg_loss: 41823.2648; train_edge_recon_loss: 2632122.6319; train_gene_expr_recon_loss: 11409177.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14083123.7556; train_optim_loss: 14083123.7556; val_kl_reg_loss: 40672.7395; val_edge_recon_loss: 2688926.6364; val_gene_expr_recon_loss: 11470384.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14199983.7182; val_optim_loss: 14199983.7182
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9826; val_auprc_score: 0.9817; val_best_acc_score: 0.9344; val_best_f1_score: 0.9349; train_kl_reg_loss: 41812.6707; train_edge_recon_loss: 2631425.1650; train_gene_expr_recon_loss: 11406306.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14079544.4420; train_optim_loss: 14079544.4420; val_kl_reg_loss: 40696.9913; val_edge_recon_loss: 2683040.9295; val_gene_expr_recon_loss: 11461064.6545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14184802.5455; val_optim_loss: 14184802.5455
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9822; val_auprc_score: 0.9811; val_best_acc_score: 0.9350; val_best_f1_score: 0.9354; train_kl_reg_loss: 41792.1158; train_edge_recon_loss: 2632677.4641; train_gene_expr_recon_loss: 11402998.0978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14077467.6792; train_optim_loss: 14077467.6792; val_kl_reg_loss: 40620.5830; val_edge_recon_loss: 2685022.9227; val_gene_expr_recon_loss: 11478609.1182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14204252.5818; val_optim_loss: 14204252.5818
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9819; val_auprc_score: 0.9807; val_best_acc_score: 0.9340; val_best_f1_score: 0.9346; train_kl_reg_loss: 41777.8260; train_edge_recon_loss: 2631347.8758; train_gene_expr_recon_loss: 11407394.3676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14080520.0764; train_optim_loss: 14080520.0764; val_kl_reg_loss: 40636.7626; val_edge_recon_loss: 2687740.3841; val_gene_expr_recon_loss: 11486329.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214707.0182; val_optim_loss: 14214707.0182
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9826; val_auprc_score: 0.9818; val_best_acc_score: 0.9351; val_best_f1_score: 0.9355; train_kl_reg_loss: 41775.8484; train_edge_recon_loss: 2632332.9913; train_gene_expr_recon_loss: 11403917.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14078026.3931; train_optim_loss: 14078026.3931; val_kl_reg_loss: 40657.0131; val_edge_recon_loss: 2686396.1864; val_gene_expr_recon_loss: 11471495.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14198548.9727; val_optim_loss: 14198548.9727
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9824; val_auprc_score: 0.9812; val_best_acc_score: 0.9344; val_best_f1_score: 0.9348; train_kl_reg_loss: 41792.5651; train_edge_recon_loss: 2632401.0400; train_gene_expr_recon_loss: 11402811.9348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14077005.5336; train_optim_loss: 14077005.5336; val_kl_reg_loss: 40592.4793; val_edge_recon_loss: 2686806.3773; val_gene_expr_recon_loss: 11479221.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14206620.2091; val_optim_loss: 14206620.2091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9824; val_auprc_score: 0.9813; val_best_acc_score: 0.9346; val_best_f1_score: 0.9350; train_kl_reg_loss: 41755.5097; train_edge_recon_loss: 2631901.9700; train_gene_expr_recon_loss: 11403104.1110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14076761.5886; train_optim_loss: 14076761.5886; val_kl_reg_loss: 40599.4590; val_edge_recon_loss: 2685433.1614; val_gene_expr_recon_loss: 11476593.3909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14202626.0000; val_optim_loss: 14202626.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9824; val_auprc_score: 0.9814; val_best_acc_score: 0.9347; val_best_f1_score: 0.9351; train_kl_reg_loss: 41754.5535; train_edge_recon_loss: 2632564.7118; train_gene_expr_recon_loss: 11402255.0672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14076574.3147; train_optim_loss: 14076574.3147; val_kl_reg_loss: 40623.4678; val_edge_recon_loss: 2686569.8977; val_gene_expr_recon_loss: 11487876.9455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14215070.2818; val_optim_loss: 14215070.2818
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9821; val_auprc_score: 0.9809; val_best_acc_score: 0.9343; val_best_f1_score: 0.9348; train_kl_reg_loss: 41765.0381; train_edge_recon_loss: 2630980.6125; train_gene_expr_recon_loss: 11403028.8055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14075774.4725; train_optim_loss: 14075774.4725; val_kl_reg_loss: 40610.4245; val_edge_recon_loss: 2683076.3886; val_gene_expr_recon_loss: 11476151.5636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14199838.4182; val_optim_loss: 14199838.4182
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9820; val_auprc_score: 0.9807; val_best_acc_score: 0.9345; val_best_f1_score: 0.9349; train_kl_reg_loss: 41773.3093; train_edge_recon_loss: 2632240.2459; train_gene_expr_recon_loss: 11403707.5448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14077721.0947; train_optim_loss: 14077721.0947; val_kl_reg_loss: 40613.4283; val_edge_recon_loss: 2686559.4364; val_gene_expr_recon_loss: 11470951.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14198124.0455; val_optim_loss: 14198124.0455

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 142 min 4 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9818
Val AUPRC score: 0.9804
Val best accuracy score: 0.9337
Val best F1 score: 0.9342
Val gene expr MSE score: 8.1663

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
