None
Run timestamp: 05072023_210741_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '30', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 502632
Number of validation edges: 55848
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9197; val_auprc_score: 0.9306; val_best_acc_score: 0.8361; val_best_f1_score: 0.8307; train_kl_reg_loss: 1035.0412; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 14843.1118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15878.1530; train_optim_loss: 15878.1530; val_kl_reg_loss: 868.5915; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 13257.8608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14126.4523; val_optim_loss: 14126.4523
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9228; val_auprc_score: 0.9330; val_best_acc_score: 0.8388; val_best_f1_score: 0.8351; train_kl_reg_loss: 842.5544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 13171.1063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14013.6607; train_optim_loss: 14013.6607; val_kl_reg_loss: 775.3683; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12688.2931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13463.6615; val_optim_loss: 13463.6615
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9276; val_auprc_score: 0.9372; val_best_acc_score: 0.8457; val_best_f1_score: 0.8421; train_kl_reg_loss: 780.3180; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12785.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13566.0818; train_optim_loss: 13566.0818; val_kl_reg_loss: 725.9861; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12442.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13168.9096; val_optim_loss: 13168.9096
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9275; val_auprc_score: 0.9373; val_best_acc_score: 0.8463; val_best_f1_score: 0.8423; train_kl_reg_loss: 752.6029; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12591.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13343.9763; train_optim_loss: 13343.9763; val_kl_reg_loss: 728.8044; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12308.4358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13037.2402; val_optim_loss: 13037.2402
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9293; val_auprc_score: 0.9387; val_best_acc_score: 0.8485; val_best_f1_score: 0.8443; train_kl_reg_loss: 739.4346; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12477.9105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13217.3451; train_optim_loss: 13217.3451; val_kl_reg_loss: 724.8451; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12226.3339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12951.1789; val_optim_loss: 12951.1789
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9302; val_auprc_score: 0.9395; val_best_acc_score: 0.8503; val_best_f1_score: 0.8465; train_kl_reg_loss: 733.1081; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12412.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13146.0647; train_optim_loss: 13146.0647; val_kl_reg_loss: 717.0334; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12184.3276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12901.3609; val_optim_loss: 12901.3609
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9297; val_auprc_score: 0.9395; val_best_acc_score: 0.8488; val_best_f1_score: 0.8454; train_kl_reg_loss: 730.8987; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12369.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13100.4454; train_optim_loss: 13100.4454; val_kl_reg_loss: 722.8163; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12151.3390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12874.1553; val_optim_loss: 12874.1553
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9294; val_auprc_score: 0.9395; val_best_acc_score: 0.8490; val_best_f1_score: 0.8459; train_kl_reg_loss: 730.9358; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12331.9879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13062.9237; train_optim_loss: 13062.9237; val_kl_reg_loss: 714.0136; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12118.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12832.5137; val_optim_loss: 12832.5137
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9343; val_auprc_score: 0.9433; val_best_acc_score: 0.8568; val_best_f1_score: 0.8522; train_kl_reg_loss: 732.6127; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12306.1237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13038.7363; train_optim_loss: 13038.7363; val_kl_reg_loss: 710.3405; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12085.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12796.2405; val_optim_loss: 12796.2405
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9358; val_auprc_score: 0.9448; val_best_acc_score: 0.8582; val_best_f1_score: 0.8548; train_kl_reg_loss: 734.7538; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12287.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13022.0585; train_optim_loss: 13022.0585; val_kl_reg_loss: 727.5325; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12067.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12795.3552; val_optim_loss: 12795.3552
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9349; val_auprc_score: 0.9442; val_best_acc_score: 0.8569; val_best_f1_score: 0.8547; train_kl_reg_loss: 737.0578; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12269.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13006.3724; train_optim_loss: 13006.3724; val_kl_reg_loss: 723.5624; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12048.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12772.5138; val_optim_loss: 12772.5138
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9353; val_auprc_score: 0.9448; val_best_acc_score: 0.8588; val_best_f1_score: 0.8557; train_kl_reg_loss: 739.3763; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12253.0492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12992.4255; train_optim_loss: 12992.4255; val_kl_reg_loss: 731.1427; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12049.1728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12780.3155; val_optim_loss: 12780.3155
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9373; val_auprc_score: 0.9464; val_best_acc_score: 0.8610; val_best_f1_score: 0.8564; train_kl_reg_loss: 741.7237; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12237.3044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12979.0281; train_optim_loss: 12979.0281; val_kl_reg_loss: 730.8227; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12046.2621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12777.0848; val_optim_loss: 12777.0848
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9385; val_auprc_score: 0.9474; val_best_acc_score: 0.8624; val_best_f1_score: 0.8595; train_kl_reg_loss: 743.7115; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12226.4031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12970.1146; train_optim_loss: 12970.1146; val_kl_reg_loss: 731.4915; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12017.1221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12748.6136; val_optim_loss: 12748.6136
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9387; val_auprc_score: 0.9476; val_best_acc_score: 0.8623; val_best_f1_score: 0.8598; train_kl_reg_loss: 745.8204; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12215.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12961.1733; train_optim_loss: 12961.1733; val_kl_reg_loss: 745.0874; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12014.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12759.3473; val_optim_loss: 12759.3473
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9401; val_auprc_score: 0.9489; val_best_acc_score: 0.8644; val_best_f1_score: 0.8607; train_kl_reg_loss: 747.3100; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12209.0150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12956.3250; train_optim_loss: 12956.3250; val_kl_reg_loss: 737.8419; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12007.3228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12745.1647; val_optim_loss: 12745.1647
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9405; val_auprc_score: 0.9493; val_best_acc_score: 0.8660; val_best_f1_score: 0.8628; train_kl_reg_loss: 748.9060; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12201.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12950.0368; train_optim_loss: 12950.0368; val_kl_reg_loss: 729.8217; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 12001.7768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12731.5985; val_optim_loss: 12731.5985
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9404; val_auprc_score: 0.9491; val_best_acc_score: 0.8654; val_best_f1_score: 0.8628; train_kl_reg_loss: 750.6277; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12195.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12946.0827; train_optim_loss: 12946.0827; val_kl_reg_loss: 735.7296; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11996.9361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12732.6657; val_optim_loss: 12732.6657
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9399; val_auprc_score: 0.9487; val_best_acc_score: 0.8644; val_best_f1_score: 0.8607; train_kl_reg_loss: 751.5584; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12182.6439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12934.2023; train_optim_loss: 12934.2023; val_kl_reg_loss: 749.8021; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11998.7924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12748.5946; val_optim_loss: 12748.5946
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9416; val_auprc_score: 0.9501; val_best_acc_score: 0.8672; val_best_f1_score: 0.8634; train_kl_reg_loss: 752.4975; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12181.2827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12933.7801; train_optim_loss: 12933.7801; val_kl_reg_loss: 736.9707; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11980.9954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12717.9661; val_optim_loss: 12717.9661
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9405; val_auprc_score: 0.9494; val_best_acc_score: 0.8660; val_best_f1_score: 0.8624; train_kl_reg_loss: 753.2381; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12175.8925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12929.1306; train_optim_loss: 12929.1306; val_kl_reg_loss: 750.6286; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11985.5175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12736.1460; val_optim_loss: 12736.1460
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9411; val_auprc_score: 0.9499; val_best_acc_score: 0.8669; val_best_f1_score: 0.8638; train_kl_reg_loss: 754.2374; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12169.7440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12923.9813; train_optim_loss: 12923.9813; val_kl_reg_loss: 739.6878; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11977.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12716.9329; val_optim_loss: 12716.9329
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9435; val_auprc_score: 0.9520; val_best_acc_score: 0.8699; val_best_f1_score: 0.8670; train_kl_reg_loss: 754.8601; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12164.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12918.9429; train_optim_loss: 12918.9429; val_kl_reg_loss: 742.0539; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11978.4166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12720.4704; val_optim_loss: 12720.4704
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9430; val_auprc_score: 0.9518; val_best_acc_score: 0.8702; val_best_f1_score: 0.8667; train_kl_reg_loss: 756.0129; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12164.7794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12920.7923; train_optim_loss: 12920.7923; val_kl_reg_loss: 745.8015; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11973.1897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12718.9912; val_optim_loss: 12718.9912
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9431; val_auprc_score: 0.9519; val_best_acc_score: 0.8707; val_best_f1_score: 0.8667; train_kl_reg_loss: 756.6807; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12155.1227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12911.8034; train_optim_loss: 12911.8034; val_kl_reg_loss: 749.2131; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11961.6369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12710.8500; val_optim_loss: 12710.8500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9445; val_auprc_score: 0.9529; val_best_acc_score: 0.8730; val_best_f1_score: 0.8690; train_kl_reg_loss: 757.5992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12156.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12914.2346; train_optim_loss: 12914.2346; val_kl_reg_loss: 743.4497; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11960.0654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12703.5152; val_optim_loss: 12703.5152
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9428; val_auprc_score: 0.9518; val_best_acc_score: 0.8695; val_best_f1_score: 0.8653; train_kl_reg_loss: 758.7189; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12150.9506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12909.6695; train_optim_loss: 12909.6695; val_kl_reg_loss: 746.6439; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11957.6467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12704.2906; val_optim_loss: 12704.2906
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9452; val_auprc_score: 0.9535; val_best_acc_score: 0.8740; val_best_f1_score: 0.8700; train_kl_reg_loss: 759.5793; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12147.6715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12907.2508; train_optim_loss: 12907.2508; val_kl_reg_loss: 757.4156; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11965.1580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12722.5735; val_optim_loss: 12722.5735
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9438; val_auprc_score: 0.9523; val_best_acc_score: 0.8723; val_best_f1_score: 0.8678; train_kl_reg_loss: 760.1360; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12143.8104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12903.9464; train_optim_loss: 12903.9464; val_kl_reg_loss: 757.0610; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11963.6081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12720.6692; val_optim_loss: 12720.6692
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9441; val_auprc_score: 0.9528; val_best_acc_score: 0.8721; val_best_f1_score: 0.8683; train_kl_reg_loss: 761.2159; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12142.3694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12903.5853; train_optim_loss: 12903.5853; val_kl_reg_loss: 763.3161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11942.6236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12705.9397; val_optim_loss: 12705.9397

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9459; val_auprc_score: 0.9541; val_best_acc_score: 0.8744; val_best_f1_score: 0.8710; train_kl_reg_loss: 758.8471; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12079.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12837.9730; train_optim_loss: 12837.9730; val_kl_reg_loss: 753.0786; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11908.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12661.7974; val_optim_loss: 12661.7974
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9473; val_auprc_score: 0.9553; val_best_acc_score: 0.8764; val_best_f1_score: 0.8736; train_kl_reg_loss: 760.3538; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12073.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12833.7150; train_optim_loss: 12833.7150; val_kl_reg_loss: 752.7143; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11891.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12643.7413; val_optim_loss: 12643.7413
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9465; val_auprc_score: 0.9546; val_best_acc_score: 0.8751; val_best_f1_score: 0.8721; train_kl_reg_loss: 761.1433; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12071.3682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12832.5114; train_optim_loss: 12832.5114; val_kl_reg_loss: 752.3882; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11894.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12647.0507; val_optim_loss: 12647.0507
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9455; val_auprc_score: 0.9539; val_best_acc_score: 0.8733; val_best_f1_score: 0.8704; train_kl_reg_loss: 761.2615; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12064.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12826.1671; train_optim_loss: 12826.1671; val_kl_reg_loss: 754.6450; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11871.5045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12626.1495; val_optim_loss: 12626.1495
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9464; val_auprc_score: 0.9546; val_best_acc_score: 0.8755; val_best_f1_score: 0.8718; train_kl_reg_loss: 761.4090; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12064.0146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12825.4236; train_optim_loss: 12825.4236; val_kl_reg_loss: 753.5394; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11908.2558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12661.7952; val_optim_loss: 12661.7952
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9465; val_auprc_score: 0.9544; val_best_acc_score: 0.8756; val_best_f1_score: 0.8728; train_kl_reg_loss: 761.7555; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12063.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12824.9482; train_optim_loss: 12824.9482; val_kl_reg_loss: 755.1963; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11892.1238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12647.3202; val_optim_loss: 12647.3202
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9456; val_auprc_score: 0.9541; val_best_acc_score: 0.8742; val_best_f1_score: 0.8707; train_kl_reg_loss: 761.7372; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12059.5968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12821.3340; train_optim_loss: 12821.3340; val_kl_reg_loss: 754.7402; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11891.7160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12646.4562; val_optim_loss: 12646.4562
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9467; val_auprc_score: 0.9548; val_best_acc_score: 0.8752; val_best_f1_score: 0.8732; train_kl_reg_loss: 761.9199; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12061.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12823.8494; train_optim_loss: 12823.8494; val_kl_reg_loss: 755.2219; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11890.9470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12646.1688; val_optim_loss: 12646.1688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9469; val_auprc_score: 0.9548; val_best_acc_score: 0.8751; val_best_f1_score: 0.8719; train_kl_reg_loss: 761.5414; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12056.4073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12817.9487; train_optim_loss: 12817.9487; val_kl_reg_loss: 755.4865; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11876.6438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12632.1303; val_optim_loss: 12632.1303
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9471; val_auprc_score: 0.9552; val_best_acc_score: 0.8759; val_best_f1_score: 0.8724; train_kl_reg_loss: 761.4946; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12049.6688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12811.1634; train_optim_loss: 12811.1634; val_kl_reg_loss: 755.9872; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11893.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12649.3635; val_optim_loss: 12649.3635
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9459; val_auprc_score: 0.9540; val_best_acc_score: 0.8746; val_best_f1_score: 0.8716; train_kl_reg_loss: 761.6638; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12047.3706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12809.0343; train_optim_loss: 12809.0343; val_kl_reg_loss: 756.2011; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11866.9429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12623.1440; val_optim_loss: 12623.1440
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9460; val_auprc_score: 0.9543; val_best_acc_score: 0.8745; val_best_f1_score: 0.8713; train_kl_reg_loss: 761.8010; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12048.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12810.4213; train_optim_loss: 12810.4213; val_kl_reg_loss: 756.8470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11885.2806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12642.1276; val_optim_loss: 12642.1276
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9469; val_auprc_score: 0.9551; val_best_acc_score: 0.8757; val_best_f1_score: 0.8728; train_kl_reg_loss: 762.0115; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12051.5382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12813.5496; train_optim_loss: 12813.5496; val_kl_reg_loss: 756.8741; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11888.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12645.7430; val_optim_loss: 12645.7430
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9472; val_auprc_score: 0.9553; val_best_acc_score: 0.8754; val_best_f1_score: 0.8730; train_kl_reg_loss: 762.0982; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12049.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12812.0894; train_optim_loss: 12812.0894; val_kl_reg_loss: 755.8221; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11880.8839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12636.7060; val_optim_loss: 12636.7060
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9456; val_auprc_score: 0.9537; val_best_acc_score: 0.8732; val_best_f1_score: 0.8708; train_kl_reg_loss: 762.2108; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12053.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12815.8619; train_optim_loss: 12815.8619; val_kl_reg_loss: 755.2399; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11880.8074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12636.0473; val_optim_loss: 12636.0473

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9468; val_auprc_score: 0.9549; val_best_acc_score: 0.8754; val_best_f1_score: 0.8719; train_kl_reg_loss: 761.7043; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12047.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12809.2632; train_optim_loss: 12809.2632; val_kl_reg_loss: 755.6027; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11882.1919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12637.7945; val_optim_loss: 12637.7945
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9464; val_auprc_score: 0.9544; val_best_acc_score: 0.8751; val_best_f1_score: 0.8721; train_kl_reg_loss: 761.9165; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12046.3178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12808.2342; train_optim_loss: 12808.2342; val_kl_reg_loss: 755.7687; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11885.3712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12641.1399; val_optim_loss: 12641.1399
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9463; val_auprc_score: 0.9545; val_best_acc_score: 0.8744; val_best_f1_score: 0.8717; train_kl_reg_loss: 761.9085; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12049.5679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12811.4764; train_optim_loss: 12811.4764; val_kl_reg_loss: 755.9734; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11890.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12646.9701; val_optim_loss: 12646.9701
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9466; val_auprc_score: 0.9548; val_best_acc_score: 0.8745; val_best_f1_score: 0.8721; train_kl_reg_loss: 761.9943; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 12049.3754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12811.3697; train_optim_loss: 12811.3697; val_kl_reg_loss: 755.7827; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 11887.9559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12643.7386; val_optim_loss: 12643.7386

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 53 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9460
Val AUPRC score: 0.9540
Val best accuracy score: 0.8739
Val best F1 score: 0.8711
Val gene expr MSE score: 8.6855

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
