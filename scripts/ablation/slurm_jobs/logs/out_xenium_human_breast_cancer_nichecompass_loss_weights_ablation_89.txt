None
Run timestamp: 08082023_193755_89.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_89']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9379; val_auprc_score: 0.9170; val_best_acc_score: 0.8779; val_best_f1_score: 0.8854; train_kl_reg_loss: 18119.3253; train_edge_recon_loss: 2728464.8526; train_gene_expr_recon_loss: 1322711.6039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4069295.7754; train_optim_loss: 4069295.7754; val_kl_reg_loss: 16901.7394; val_edge_recon_loss: 2697575.1776; val_gene_expr_recon_loss: 1212083.6020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3926560.5296; val_optim_loss: 3926560.5296
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9496; val_auprc_score: 0.9348; val_best_acc_score: 0.8906; val_best_f1_score: 0.8959; train_kl_reg_loss: 16325.3499; train_edge_recon_loss: 2639626.1577; train_gene_expr_recon_loss: 1170876.5765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3826828.0798; train_optim_loss: 3826828.0798; val_kl_reg_loss: 15538.7294; val_edge_recon_loss: 2688102.2632; val_gene_expr_recon_loss: 1141383.3174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3845024.3158; val_optim_loss: 3845024.3158
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9598; val_auprc_score: 0.9478; val_best_acc_score: 0.9042; val_best_f1_score: 0.9084; train_kl_reg_loss: 15100.2920; train_edge_recon_loss: 2631444.5151; train_gene_expr_recon_loss: 1117071.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3763616.0265; train_optim_loss: 3763616.0265; val_kl_reg_loss: 14360.8790; val_edge_recon_loss: 2678654.5921; val_gene_expr_recon_loss: 1100055.8043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3793071.2829; val_optim_loss: 3793071.2829
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9636; val_auprc_score: 0.9541; val_best_acc_score: 0.9087; val_best_f1_score: 0.9128; train_kl_reg_loss: 14602.9270; train_edge_recon_loss: 2624652.7901; train_gene_expr_recon_loss: 1083355.0681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3722610.7893; train_optim_loss: 3722610.7893; val_kl_reg_loss: 13973.4647; val_edge_recon_loss: 2675520.1316; val_gene_expr_recon_loss: 1075222.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3764715.8717; val_optim_loss: 3764715.8717
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9649; val_auprc_score: 0.9536; val_best_acc_score: 0.9127; val_best_f1_score: 0.9163; train_kl_reg_loss: 14276.4944; train_edge_recon_loss: 2619090.4765; train_gene_expr_recon_loss: 1060208.6195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3693575.5890; train_optim_loss: 3693575.5890; val_kl_reg_loss: 14143.6548; val_edge_recon_loss: 2668251.5461; val_gene_expr_recon_loss: 1052188.8273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3734584.0461; val_optim_loss: 3734584.0461
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9693; val_auprc_score: 0.9614; val_best_acc_score: 0.9181; val_best_f1_score: 0.9207; train_kl_reg_loss: 14018.7006; train_edge_recon_loss: 2616391.1327; train_gene_expr_recon_loss: 1045371.2295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3675781.0555; train_optim_loss: 3675781.0555; val_kl_reg_loss: 13430.1343; val_edge_recon_loss: 2668270.1118; val_gene_expr_recon_loss: 1043522.8627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3725223.0987; val_optim_loss: 3725223.0987
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9681; val_auprc_score: 0.9587; val_best_acc_score: 0.9181; val_best_f1_score: 0.9206; train_kl_reg_loss: 13765.1018; train_edge_recon_loss: 2614715.8298; train_gene_expr_recon_loss: 1034290.5631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3662771.4915; train_optim_loss: 3662771.4915; val_kl_reg_loss: 13557.0820; val_edge_recon_loss: 2666427.6447; val_gene_expr_recon_loss: 1032458.4984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3712443.2072; val_optim_loss: 3712443.2072
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9709; val_auprc_score: 0.9632; val_best_acc_score: 0.9209; val_best_f1_score: 0.9240; train_kl_reg_loss: 13649.1676; train_edge_recon_loss: 2612067.6732; train_gene_expr_recon_loss: 1026739.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3652456.7364; train_optim_loss: 3652456.7364; val_kl_reg_loss: 13232.3720; val_edge_recon_loss: 2659156.7500; val_gene_expr_recon_loss: 1029102.3224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3701491.4572; val_optim_loss: 3701491.4572
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9706; val_auprc_score: 0.9633; val_best_acc_score: 0.9208; val_best_f1_score: 0.9236; train_kl_reg_loss: 13504.5270; train_edge_recon_loss: 2609021.0518; train_gene_expr_recon_loss: 1020342.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3642867.8044; train_optim_loss: 3642867.8044; val_kl_reg_loss: 12661.4318; val_edge_recon_loss: 2667514.3388; val_gene_expr_recon_loss: 1023310.1521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3703485.9342; val_optim_loss: 3703485.9342
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9707; val_auprc_score: 0.9621; val_best_acc_score: 0.9239; val_best_f1_score: 0.9265; train_kl_reg_loss: 13260.7365; train_edge_recon_loss: 2609588.4213; train_gene_expr_recon_loss: 1016275.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3639124.2202; train_optim_loss: 3639124.2202; val_kl_reg_loss: 12918.8810; val_edge_recon_loss: 2661741.8717; val_gene_expr_recon_loss: 1019439.5987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3694100.3553; val_optim_loss: 3694100.3553
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9725; val_auprc_score: 0.9649; val_best_acc_score: 0.9249; val_best_f1_score: 0.9274; train_kl_reg_loss: 13183.4689; train_edge_recon_loss: 2607000.0621; train_gene_expr_recon_loss: 1012825.5753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3633009.1022; train_optim_loss: 3633009.1022; val_kl_reg_loss: 12672.7206; val_edge_recon_loss: 2659577.4079; val_gene_expr_recon_loss: 1016392.0979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3688642.2303; val_optim_loss: 3688642.2303
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9725; val_auprc_score: 0.9638; val_best_acc_score: 0.9264; val_best_f1_score: 0.9290; train_kl_reg_loss: 13005.6239; train_edge_recon_loss: 2607279.8937; train_gene_expr_recon_loss: 1010528.0106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3630813.5324; train_optim_loss: 3630813.5324; val_kl_reg_loss: 12911.6920; val_edge_recon_loss: 2653839.7336; val_gene_expr_recon_loss: 1011181.8117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3677933.2303; val_optim_loss: 3677933.2303
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9748; val_auprc_score: 0.9685; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 12879.0377; train_edge_recon_loss: 2605422.9750; train_gene_expr_recon_loss: 1008336.2511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3626638.2640; train_optim_loss: 3626638.2640; val_kl_reg_loss: 12431.4882; val_edge_recon_loss: 2658129.2632; val_gene_expr_recon_loss: 1011255.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3681816.2467; val_optim_loss: 3681816.2467
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9735; val_auprc_score: 0.9660; val_best_acc_score: 0.9270; val_best_f1_score: 0.9293; train_kl_reg_loss: 12854.0917; train_edge_recon_loss: 2602433.0312; train_gene_expr_recon_loss: 1006530.9224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3621818.0463; train_optim_loss: 3621818.0463; val_kl_reg_loss: 12735.3694; val_edge_recon_loss: 2657268.5230; val_gene_expr_recon_loss: 1012531.4515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3682535.3421; val_optim_loss: 3682535.3421
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9743; val_auprc_score: 0.9673; val_best_acc_score: 0.9286; val_best_f1_score: 0.9310; train_kl_reg_loss: 12818.0067; train_edge_recon_loss: 2603590.5982; train_gene_expr_recon_loss: 1005240.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3621648.6390; train_optim_loss: 3621648.6390; val_kl_reg_loss: 12400.7249; val_edge_recon_loss: 2658209.1118; val_gene_expr_recon_loss: 1010069.2081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3680679.0493; val_optim_loss: 3680679.0493
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9747; val_auprc_score: 0.9672; val_best_acc_score: 0.9304; val_best_f1_score: 0.9323; train_kl_reg_loss: 12734.3479; train_edge_recon_loss: 2602500.6915; train_gene_expr_recon_loss: 1003979.0311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3619214.0691; train_optim_loss: 3619214.0691; val_kl_reg_loss: 12108.0057; val_edge_recon_loss: 2656152.2993; val_gene_expr_recon_loss: 1007888.9498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3676149.2303; val_optim_loss: 3676149.2303
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9671; val_best_acc_score: 0.9294; val_best_f1_score: 0.9313; train_kl_reg_loss: 12683.8735; train_edge_recon_loss: 2602829.9419; train_gene_expr_recon_loss: 1003215.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3618729.3673; train_optim_loss: 3618729.3673; val_kl_reg_loss: 12270.1892; val_edge_recon_loss: 2656488.2171; val_gene_expr_recon_loss: 1006692.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675450.8914; val_optim_loss: 3675450.8914
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9749; val_auprc_score: 0.9678; val_best_acc_score: 0.9292; val_best_f1_score: 0.9317; train_kl_reg_loss: 12600.4208; train_edge_recon_loss: 2601284.0176; train_gene_expr_recon_loss: 1001914.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3615798.5857; train_optim_loss: 3615798.5857; val_kl_reg_loss: 12237.3612; val_edge_recon_loss: 2655168.0592; val_gene_expr_recon_loss: 1005766.6217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3673172.0329; val_optim_loss: 3673172.0329
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9297; val_best_f1_score: 0.9319; train_kl_reg_loss: 12521.6769; train_edge_recon_loss: 2600742.8228; train_gene_expr_recon_loss: 1001877.1623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3615141.6610; train_optim_loss: 3615141.6610; val_kl_reg_loss: 12197.8515; val_edge_recon_loss: 2653437.9079; val_gene_expr_recon_loss: 1005820.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3671456.6776; val_optim_loss: 3671456.6776
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9755; val_auprc_score: 0.9678; val_best_acc_score: 0.9313; val_best_f1_score: 0.9335; train_kl_reg_loss: 12450.6507; train_edge_recon_loss: 2601324.8978; train_gene_expr_recon_loss: 1000938.6511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3614714.1971; train_optim_loss: 3614714.1971; val_kl_reg_loss: 12142.2062; val_edge_recon_loss: 2653863.6875; val_gene_expr_recon_loss: 1006367.4161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3672373.3092; val_optim_loss: 3672373.3092
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9754; val_auprc_score: 0.9684; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 12431.9394; train_edge_recon_loss: 2600364.2717; train_gene_expr_recon_loss: 1000869.9080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3613666.1279; train_optim_loss: 3613666.1279; val_kl_reg_loss: 12314.7045; val_edge_recon_loss: 2651165.9342; val_gene_expr_recon_loss: 1002964.5847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3666445.2434; val_optim_loss: 3666445.2434
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9763; val_auprc_score: 0.9698; val_best_acc_score: 0.9312; val_best_f1_score: 0.9333; train_kl_reg_loss: 12409.5479; train_edge_recon_loss: 2600237.7257; train_gene_expr_recon_loss: 999550.9892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3612198.2662; train_optim_loss: 3612198.2662; val_kl_reg_loss: 12123.6303; val_edge_recon_loss: 2653215.9836; val_gene_expr_recon_loss: 1004360.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669700.5099; val_optim_loss: 3669700.5099
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9774; val_auprc_score: 0.9714; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 12370.7684; train_edge_recon_loss: 2599169.7132; train_gene_expr_recon_loss: 999712.9099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3611253.3934; train_optim_loss: 3611253.3934; val_kl_reg_loss: 11985.5765; val_edge_recon_loss: 2647101.3224; val_gene_expr_recon_loss: 1004731.0559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663817.9704; val_optim_loss: 3663817.9704
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9759; val_auprc_score: 0.9684; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 12300.1143; train_edge_recon_loss: 2599034.0415; train_gene_expr_recon_loss: 999162.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3610496.6779; train_optim_loss: 3610496.6779; val_kl_reg_loss: 12048.9681; val_edge_recon_loss: 2652583.7237; val_gene_expr_recon_loss: 1003870.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3668502.7401; val_optim_loss: 3668502.7401
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9311; val_best_f1_score: 0.9332; train_kl_reg_loss: 12284.1919; train_edge_recon_loss: 2597039.9654; train_gene_expr_recon_loss: 999363.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3608688.0599; train_optim_loss: 3608688.0599; val_kl_reg_loss: 11724.2654; val_edge_recon_loss: 2656530.0000; val_gene_expr_recon_loss: 1004424.3717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3672678.6316; val_optim_loss: 3672678.6316
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9771; val_auprc_score: 0.9704; val_best_acc_score: 0.9335; val_best_f1_score: 0.9355; train_kl_reg_loss: 12166.2066; train_edge_recon_loss: 2598956.7739; train_gene_expr_recon_loss: 998258.9679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3609381.9496; train_optim_loss: 3609381.9496; val_kl_reg_loss: 11710.5087; val_edge_recon_loss: 2650866.5691; val_gene_expr_recon_loss: 1005681.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3668258.2007; val_optim_loss: 3668258.2007
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9762; val_auprc_score: 0.9687; val_best_acc_score: 0.9330; val_best_f1_score: 0.9350; train_kl_reg_loss: 12176.8059; train_edge_recon_loss: 2596135.1261; train_gene_expr_recon_loss: 998233.9171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3606545.8493; train_optim_loss: 3606545.8493; val_kl_reg_loss: 11954.5063; val_edge_recon_loss: 2651458.5230; val_gene_expr_recon_loss: 1004799.1801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3668212.2105; val_optim_loss: 3668212.2105

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9779; val_auprc_score: 0.9718; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 12187.6971; train_edge_recon_loss: 2595457.5680; train_gene_expr_recon_loss: 993595.4640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601240.7279; train_optim_loss: 3601240.7279; val_kl_reg_loss: 11899.6350; val_edge_recon_loss: 2647503.5000; val_gene_expr_recon_loss: 999419.5123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658822.6546; val_optim_loss: 3658822.6546
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9768; val_auprc_score: 0.9705; val_best_acc_score: 0.9326; val_best_f1_score: 0.9348; train_kl_reg_loss: 12182.8883; train_edge_recon_loss: 2594963.6676; train_gene_expr_recon_loss: 992967.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600113.7011; train_optim_loss: 3600113.7011; val_kl_reg_loss: 11922.6658; val_edge_recon_loss: 2652316.5757; val_gene_expr_recon_loss: 998687.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3662926.3651; val_optim_loss: 3662926.3651
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9786; val_auprc_score: 0.9728; val_best_acc_score: 0.9354; val_best_f1_score: 0.9371; train_kl_reg_loss: 12188.7199; train_edge_recon_loss: 2594512.9732; train_gene_expr_recon_loss: 992643.2342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599344.9199; train_optim_loss: 3599344.9199; val_kl_reg_loss: 11919.3790; val_edge_recon_loss: 2647540.7599; val_gene_expr_recon_loss: 998395.8939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657856.0395; val_optim_loss: 3657856.0395
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9774; val_auprc_score: 0.9711; val_best_acc_score: 0.9344; val_best_f1_score: 0.9362; train_kl_reg_loss: 12183.3203; train_edge_recon_loss: 2595835.5960; train_gene_expr_recon_loss: 992251.0213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600269.9335; train_optim_loss: 3600269.9335; val_kl_reg_loss: 11877.1502; val_edge_recon_loss: 2647930.9638; val_gene_expr_recon_loss: 996579.4334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656387.5658; val_optim_loss: 3656387.5658
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9783; val_auprc_score: 0.9722; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 12201.5932; train_edge_recon_loss: 2595723.6893; train_gene_expr_recon_loss: 992500.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600426.1265; train_optim_loss: 3600426.1265; val_kl_reg_loss: 11957.9832; val_edge_recon_loss: 2646742.0888; val_gene_expr_recon_loss: 998967.7993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657667.8651; val_optim_loss: 3657667.8651
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9771; val_auprc_score: 0.9704; val_best_acc_score: 0.9339; val_best_f1_score: 0.9358; train_kl_reg_loss: 12192.2475; train_edge_recon_loss: 2594319.1287; train_gene_expr_recon_loss: 992130.3165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598641.6886; train_optim_loss: 3598641.6886; val_kl_reg_loss: 11933.4194; val_edge_recon_loss: 2648709.4770; val_gene_expr_recon_loss: 997301.7525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657944.6447; val_optim_loss: 3657944.6447
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9774; val_auprc_score: 0.9713; val_best_acc_score: 0.9337; val_best_f1_score: 0.9359; train_kl_reg_loss: 12173.9400; train_edge_recon_loss: 2596072.3551; train_gene_expr_recon_loss: 992103.9994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600350.2989; train_optim_loss: 3600350.2989; val_kl_reg_loss: 11865.1456; val_edge_recon_loss: 2652121.8783; val_gene_expr_recon_loss: 998202.3701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3662189.4079; val_optim_loss: 3662189.4079
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9781; val_auprc_score: 0.9722; val_best_acc_score: 0.9343; val_best_f1_score: 0.9365; train_kl_reg_loss: 12144.9654; train_edge_recon_loss: 2594609.6926; train_gene_expr_recon_loss: 992128.1392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598882.7941; train_optim_loss: 3598882.7941; val_kl_reg_loss: 11901.7575; val_edge_recon_loss: 2648178.0592; val_gene_expr_recon_loss: 1000516.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660596.1678; val_optim_loss: 3660596.1678

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9782; val_auprc_score: 0.9722; val_best_acc_score: 0.9359; val_best_f1_score: 0.9379; train_kl_reg_loss: 12170.1097; train_edge_recon_loss: 2595235.7210; train_gene_expr_recon_loss: 990815.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598221.0938; train_optim_loss: 3598221.0938; val_kl_reg_loss: 11884.4690; val_edge_recon_loss: 2648554.2829; val_gene_expr_recon_loss: 998365.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658803.8849; val_optim_loss: 3658803.8849
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9790; val_auprc_score: 0.9733; val_best_acc_score: 0.9358; val_best_f1_score: 0.9377; train_kl_reg_loss: 12155.2784; train_edge_recon_loss: 2595907.7772; train_gene_expr_recon_loss: 991223.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599286.5404; train_optim_loss: 3599286.5404; val_kl_reg_loss: 11871.7721; val_edge_recon_loss: 2644127.9507; val_gene_expr_recon_loss: 995712.6595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3651712.3816; val_optim_loss: 3651712.3816
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9778; val_auprc_score: 0.9718; val_best_acc_score: 0.9352; val_best_f1_score: 0.9372; train_kl_reg_loss: 12153.4243; train_edge_recon_loss: 2594147.3816; train_gene_expr_recon_loss: 991097.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3597398.4982; train_optim_loss: 3597398.4982; val_kl_reg_loss: 11868.0842; val_edge_recon_loss: 2648421.8257; val_gene_expr_recon_loss: 997849.1595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658139.0724; val_optim_loss: 3658139.0724
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9778; val_auprc_score: 0.9709; val_best_acc_score: 0.9354; val_best_f1_score: 0.9371; train_kl_reg_loss: 12142.6527; train_edge_recon_loss: 2595057.2540; train_gene_expr_recon_loss: 991245.3204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598445.2217; train_optim_loss: 3598445.2217; val_kl_reg_loss: 11857.4355; val_edge_recon_loss: 2646482.0000; val_gene_expr_recon_loss: 998655.4104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656994.8520; val_optim_loss: 3656994.8520
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9782; val_auprc_score: 0.9717; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 12135.5723; train_edge_recon_loss: 2596102.3585; train_gene_expr_recon_loss: 991263.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599501.0279; train_optim_loss: 3599501.0279; val_kl_reg_loss: 11860.0350; val_edge_recon_loss: 2651833.4112; val_gene_expr_recon_loss: 996854.1480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660547.5855; val_optim_loss: 3660547.5855
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9784; val_auprc_score: 0.9720; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 12136.5169; train_edge_recon_loss: 2594243.4838; train_gene_expr_recon_loss: 991353.6290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3597733.6250; train_optim_loss: 3597733.6250; val_kl_reg_loss: 11855.1565; val_edge_recon_loss: 2648918.5625; val_gene_expr_recon_loss: 997935.1521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658708.8783; val_optim_loss: 3658708.8783

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9776; val_auprc_score: 0.9712; val_best_acc_score: 0.9354; val_best_f1_score: 0.9371; train_kl_reg_loss: 12143.7861; train_edge_recon_loss: 2594927.0456; train_gene_expr_recon_loss: 991291.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598362.4037; train_optim_loss: 3598362.4037; val_kl_reg_loss: 11857.6335; val_edge_recon_loss: 2647517.9507; val_gene_expr_recon_loss: 999235.8363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658611.4013; val_optim_loss: 3658611.4013
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9774; val_auprc_score: 0.9713; val_best_acc_score: 0.9341; val_best_f1_score: 0.9359; train_kl_reg_loss: 12145.0568; train_edge_recon_loss: 2595027.5456; train_gene_expr_recon_loss: 991536.9346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598709.5360; train_optim_loss: 3598709.5360; val_kl_reg_loss: 11850.8553; val_edge_recon_loss: 2653528.3191; val_gene_expr_recon_loss: 997891.1349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663270.3026; val_optim_loss: 3663270.3026
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9777; val_auprc_score: 0.9717; val_best_acc_score: 0.9348; val_best_f1_score: 0.9365; train_kl_reg_loss: 12143.5041; train_edge_recon_loss: 2594935.1662; train_gene_expr_recon_loss: 991372.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598451.1680; train_optim_loss: 3598451.1680; val_kl_reg_loss: 11867.4587; val_edge_recon_loss: 2646266.4507; val_gene_expr_recon_loss: 998636.8742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656770.7796; val_optim_loss: 3656770.7796
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9773; val_auprc_score: 0.9707; val_best_acc_score: 0.9340; val_best_f1_score: 0.9359; train_kl_reg_loss: 12143.9817; train_edge_recon_loss: 2596052.9574; train_gene_expr_recon_loss: 991614.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599811.1070; train_optim_loss: 3599811.1070; val_kl_reg_loss: 11853.5550; val_edge_recon_loss: 2648842.8684; val_gene_expr_recon_loss: 998298.8207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658995.2303; val_optim_loss: 3658995.2303

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 70 min 0 sec.
Using best model state, which was in epoch 37.
