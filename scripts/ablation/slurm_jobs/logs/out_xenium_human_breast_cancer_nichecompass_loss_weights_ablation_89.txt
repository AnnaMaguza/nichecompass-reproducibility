None
Run timestamp: 11082023_103538_89.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_89']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 147600
Number of validation nodes: 16400
Number of training edges: 348099
Number of validation edges: 38677
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9370; val_auprc_score: 0.9180; val_best_acc_score: 0.8754; val_best_f1_score: 0.8839; train_kl_reg_loss: 19408.5417; train_edge_recon_loss: 2733898.7908; train_gene_expr_recon_loss: 1313935.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4067242.9412; train_optim_loss: 4067242.9412; val_kl_reg_loss: 17975.8395; val_edge_recon_loss: 2702654.5362; val_gene_expr_recon_loss: 1195602.7648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3916233.1513; val_optim_loss: 3916233.1513
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9507; val_auprc_score: 0.9367; val_best_acc_score: 0.8911; val_best_f1_score: 0.8972; train_kl_reg_loss: 17335.6099; train_edge_recon_loss: 2643751.0566; train_gene_expr_recon_loss: 1161068.7079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3822155.3732; train_optim_loss: 3822155.3732; val_kl_reg_loss: 15626.5755; val_edge_recon_loss: 2687669.3553; val_gene_expr_recon_loss: 1133721.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3837017.1414; val_optim_loss: 3837017.1414
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9591; val_auprc_score: 0.9485; val_best_acc_score: 0.9026; val_best_f1_score: 0.9072; train_kl_reg_loss: 15694.9063; train_edge_recon_loss: 2631874.7743; train_gene_expr_recon_loss: 1111574.8644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3759144.5426; train_optim_loss: 3759144.5426; val_kl_reg_loss: 14813.5216; val_edge_recon_loss: 2683517.3487; val_gene_expr_recon_loss: 1090364.9852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3788695.8454; val_optim_loss: 3788695.8454
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9647; val_auprc_score: 0.9552; val_best_acc_score: 0.9123; val_best_f1_score: 0.9156; train_kl_reg_loss: 15035.7979; train_edge_recon_loss: 2624576.5864; train_gene_expr_recon_loss: 1080302.9162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3719915.3011; train_optim_loss: 3719915.3011; val_kl_reg_loss: 14421.8075; val_edge_recon_loss: 2673461.8421; val_gene_expr_recon_loss: 1069326.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3757209.7895; val_optim_loss: 3757209.7895
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9657; val_auprc_score: 0.9557; val_best_acc_score: 0.9129; val_best_f1_score: 0.9162; train_kl_reg_loss: 14677.4479; train_edge_recon_loss: 2618233.9423; train_gene_expr_recon_loss: 1058373.6902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3691285.0824; train_optim_loss: 3691285.0824; val_kl_reg_loss: 14216.1832; val_edge_recon_loss: 2670190.9934; val_gene_expr_recon_loss: 1051994.1324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3736401.3092; val_optim_loss: 3736401.3092
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9680; val_auprc_score: 0.9597; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 14355.3535; train_edge_recon_loss: 2615594.9412; train_gene_expr_recon_loss: 1043454.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3673404.8401; train_optim_loss: 3673404.8401; val_kl_reg_loss: 14198.4147; val_edge_recon_loss: 2664730.8388; val_gene_expr_recon_loss: 1037897.7204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3716826.9868; val_optim_loss: 3716826.9868
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9702; val_auprc_score: 0.9630; val_best_acc_score: 0.9176; val_best_f1_score: 0.9207; train_kl_reg_loss: 14204.1676; train_edge_recon_loss: 2613450.3853; train_gene_expr_recon_loss: 1032584.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3660238.7570; train_optim_loss: 3660238.7570; val_kl_reg_loss: 13683.9370; val_edge_recon_loss: 2668432.1645; val_gene_expr_recon_loss: 1030534.0090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3712650.0855; val_optim_loss: 3712650.0855
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9703; val_auprc_score: 0.9636; val_best_acc_score: 0.9187; val_best_f1_score: 0.9216; train_kl_reg_loss: 13915.6993; train_edge_recon_loss: 2611565.8695; train_gene_expr_recon_loss: 1025274.6673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3650756.2379; train_optim_loss: 3650756.2379; val_kl_reg_loss: 13444.1349; val_edge_recon_loss: 2668579.8125; val_gene_expr_recon_loss: 1022713.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3704737.5757; val_optim_loss: 3704737.5757
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9706; val_auprc_score: 0.9632; val_best_acc_score: 0.9204; val_best_f1_score: 0.9229; train_kl_reg_loss: 13648.2760; train_edge_recon_loss: 2611403.4551; train_gene_expr_recon_loss: 1020170.1932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3645221.9246; train_optim_loss: 3645221.9246; val_kl_reg_loss: 13230.8883; val_edge_recon_loss: 2664965.5197; val_gene_expr_recon_loss: 1017532.3339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3695728.7303; val_optim_loss: 3695728.7303
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9718; val_auprc_score: 0.9643; val_best_acc_score: 0.9222; val_best_f1_score: 0.9247; train_kl_reg_loss: 13541.5560; train_edge_recon_loss: 2609425.7415; train_gene_expr_recon_loss: 1016132.2218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3639099.5195; train_optim_loss: 3639099.5195; val_kl_reg_loss: 12995.8894; val_edge_recon_loss: 2661452.7467; val_gene_expr_recon_loss: 1015122.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3689571.1217; val_optim_loss: 3689571.1217
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9725; val_auprc_score: 0.9652; val_best_acc_score: 0.9234; val_best_f1_score: 0.9265; train_kl_reg_loss: 13458.6495; train_edge_recon_loss: 2608224.3449; train_gene_expr_recon_loss: 1012731.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3634414.8680; train_optim_loss: 3634414.8680; val_kl_reg_loss: 13011.5949; val_edge_recon_loss: 2654852.8717; val_gene_expr_recon_loss: 1013917.9885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3681782.4572; val_optim_loss: 3681782.4572
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9731; val_auprc_score: 0.9657; val_best_acc_score: 0.9247; val_best_f1_score: 0.9272; train_kl_reg_loss: 13259.6241; train_edge_recon_loss: 2607438.6397; train_gene_expr_recon_loss: 1009532.6958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3630230.9636; train_optim_loss: 3630230.9636; val_kl_reg_loss: 12761.5640; val_edge_recon_loss: 2658942.2138; val_gene_expr_recon_loss: 1010453.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3682157.0954; val_optim_loss: 3682157.0954
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9714; val_auprc_score: 0.9632; val_best_acc_score: 0.9231; val_best_f1_score: 0.9257; train_kl_reg_loss: 13052.9953; train_edge_recon_loss: 2606660.2301; train_gene_expr_recon_loss: 1007876.3407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3627589.5680; train_optim_loss: 3627589.5680; val_kl_reg_loss: 12725.5275; val_edge_recon_loss: 2660781.8026; val_gene_expr_recon_loss: 1006704.2796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3680211.6118; val_optim_loss: 3680211.6118
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9731; val_auprc_score: 0.9665; val_best_acc_score: 0.9246; val_best_f1_score: 0.9269; train_kl_reg_loss: 12960.6024; train_edge_recon_loss: 2605846.2879; train_gene_expr_recon_loss: 1006175.0871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3624981.9761; train_optim_loss: 3624981.9761; val_kl_reg_loss: 12442.1340; val_edge_recon_loss: 2663831.8388; val_gene_expr_recon_loss: 1007932.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3684206.5691; val_optim_loss: 3684206.5691
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9722; val_auprc_score: 0.9644; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 12946.0926; train_edge_recon_loss: 2603790.6077; train_gene_expr_recon_loss: 1004765.1108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3621501.8048; train_optim_loss: 3621501.8048; val_kl_reg_loss: 12588.3783; val_edge_recon_loss: 2663347.5724; val_gene_expr_recon_loss: 1004880.1464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3680816.1020; val_optim_loss: 3680816.1020
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9733; val_auprc_score: 0.9658; val_best_acc_score: 0.9267; val_best_f1_score: 0.9296; train_kl_reg_loss: 12821.9416; train_edge_recon_loss: 2603779.3180; train_gene_expr_recon_loss: 1003991.8534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3620593.1195; train_optim_loss: 3620593.1195; val_kl_reg_loss: 12608.6096; val_edge_recon_loss: 2652496.1711; val_gene_expr_recon_loss: 1005054.9285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3670159.7039; val_optim_loss: 3670159.7039
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9676; val_best_acc_score: 0.9270; val_best_f1_score: 0.9293; train_kl_reg_loss: 12799.5522; train_edge_recon_loss: 2602276.6070; train_gene_expr_recon_loss: 1002978.6622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3618054.8250; train_optim_loss: 3618054.8250; val_kl_reg_loss: 12464.3636; val_edge_recon_loss: 2652822.7829; val_gene_expr_recon_loss: 1004153.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669440.9572; val_optim_loss: 3669440.9572
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9737; val_auprc_score: 0.9656; val_best_acc_score: 0.9271; val_best_f1_score: 0.9296; train_kl_reg_loss: 12672.4633; train_edge_recon_loss: 2603123.3610; train_gene_expr_recon_loss: 1002518.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3618314.7103; train_optim_loss: 3618314.7103; val_kl_reg_loss: 12308.7072; val_edge_recon_loss: 2655108.8388; val_gene_expr_recon_loss: 1003720.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3671138.1809; val_optim_loss: 3671138.1809
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9744; val_auprc_score: 0.9671; val_best_acc_score: 0.9282; val_best_f1_score: 0.9303; train_kl_reg_loss: 12600.1660; train_edge_recon_loss: 2602557.3761; train_gene_expr_recon_loss: 1001480.7504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3616638.2875; train_optim_loss: 3616638.2875; val_kl_reg_loss: 12265.7970; val_edge_recon_loss: 2656807.8487; val_gene_expr_recon_loss: 1005164.1793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3674237.8191; val_optim_loss: 3674237.8191
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9747; val_auprc_score: 0.9683; val_best_acc_score: 0.9271; val_best_f1_score: 0.9294; train_kl_reg_loss: 12551.0163; train_edge_recon_loss: 2601517.1691; train_gene_expr_recon_loss: 1001465.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3615533.7724; train_optim_loss: 3615533.7724; val_kl_reg_loss: 12259.4565; val_edge_recon_loss: 2654916.4079; val_gene_expr_recon_loss: 1004563.8035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3671739.6711; val_optim_loss: 3671739.6711
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9746; val_auprc_score: 0.9676; val_best_acc_score: 0.9288; val_best_f1_score: 0.9308; train_kl_reg_loss: 12473.2130; train_edge_recon_loss: 2602134.6221; train_gene_expr_recon_loss: 1000928.9579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3615536.7956; train_optim_loss: 3615536.7956; val_kl_reg_loss: 12213.1978; val_edge_recon_loss: 2651089.8684; val_gene_expr_recon_loss: 1002582.2262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665885.3026; val_optim_loss: 3665885.3026
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9754; val_auprc_score: 0.9687; val_best_acc_score: 0.9297; val_best_f1_score: 0.9316; train_kl_reg_loss: 12439.5804; train_edge_recon_loss: 2599749.1923; train_gene_expr_recon_loss: 1000363.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3612552.2125; train_optim_loss: 3612552.2125; val_kl_reg_loss: 12289.6978; val_edge_recon_loss: 2650767.9145; val_gene_expr_recon_loss: 1002371.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665429.5263; val_optim_loss: 3665429.5263
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9766; val_auprc_score: 0.9709; val_best_acc_score: 0.9306; val_best_f1_score: 0.9324; train_kl_reg_loss: 12338.4493; train_edge_recon_loss: 2599743.2136; train_gene_expr_recon_loss: 999994.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3612076.4029; train_optim_loss: 3612076.4029; val_kl_reg_loss: 11896.1900; val_edge_recon_loss: 2649524.6579; val_gene_expr_recon_loss: 1002093.0740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663513.9178; val_optim_loss: 3663513.9178
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9762; val_auprc_score: 0.9694; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 12303.7510; train_edge_recon_loss: 2598725.6783; train_gene_expr_recon_loss: 999640.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3610669.8140; train_optim_loss: 3610669.8140; val_kl_reg_loss: 12088.2305; val_edge_recon_loss: 2651393.1513; val_gene_expr_recon_loss: 1001403.8380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3664885.2303; val_optim_loss: 3664885.2303
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9752; val_auprc_score: 0.9679; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 12305.9199; train_edge_recon_loss: 2598064.0349; train_gene_expr_recon_loss: 999109.2731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3609479.2279; train_optim_loss: 3609479.2279; val_kl_reg_loss: 12093.4313; val_edge_recon_loss: 2655310.6020; val_gene_expr_recon_loss: 1001615.2262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669019.2533; val_optim_loss: 3669019.2533
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9761; val_auprc_score: 0.9689; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 12216.2798; train_edge_recon_loss: 2598341.2662; train_gene_expr_recon_loss: 999098.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3609656.4562; train_optim_loss: 3609656.4562; val_kl_reg_loss: 11940.6744; val_edge_recon_loss: 2651881.6612; val_gene_expr_recon_loss: 1001595.0995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665417.4605; val_optim_loss: 3665417.4605
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9758; val_auprc_score: 0.9694; val_best_acc_score: 0.9306; val_best_f1_score: 0.9330; train_kl_reg_loss: 12266.6262; train_edge_recon_loss: 2596570.7456; train_gene_expr_recon_loss: 998934.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3607771.3816; train_optim_loss: 3607771.3816; val_kl_reg_loss: 11910.6201; val_edge_recon_loss: 2655790.1316; val_gene_expr_recon_loss: 1002306.8002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3670007.5789; val_optim_loss: 3670007.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9768; val_auprc_score: 0.9702; val_best_acc_score: 0.9327; val_best_f1_score: 0.9346; train_kl_reg_loss: 12313.4502; train_edge_recon_loss: 2595143.2761; train_gene_expr_recon_loss: 993781.3676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601238.0893; train_optim_loss: 3601238.0893; val_kl_reg_loss: 11982.3097; val_edge_recon_loss: 2649199.1053; val_gene_expr_recon_loss: 995664.7056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656846.1118; val_optim_loss: 3656846.1118
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9775; val_auprc_score: 0.9711; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 12256.0664; train_edge_recon_loss: 2595331.7349; train_gene_expr_recon_loss: 992921.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600509.7342; train_optim_loss: 3600509.7342; val_kl_reg_loss: 12023.6640; val_edge_recon_loss: 2644225.4770; val_gene_expr_recon_loss: 997428.7327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3653677.8651; val_optim_loss: 3653677.8651
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9774; val_auprc_score: 0.9712; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 12294.1594; train_edge_recon_loss: 2594977.4706; train_gene_expr_recon_loss: 992634.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599906.5096; train_optim_loss: 3599906.5096; val_kl_reg_loss: 11985.3857; val_edge_recon_loss: 2646824.7862; val_gene_expr_recon_loss: 996849.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3655659.3651; val_optim_loss: 3655659.3651
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 12237.9521; train_edge_recon_loss: 2594904.1040; train_gene_expr_recon_loss: 992859.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600001.5904; train_optim_loss: 3600001.5904; val_kl_reg_loss: 11935.0791; val_edge_recon_loss: 2646140.6447; val_gene_expr_recon_loss: 997638.2401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3655713.9770; val_optim_loss: 3655713.9770
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9770; val_auprc_score: 0.9707; val_best_acc_score: 0.9327; val_best_f1_score: 0.9347; train_kl_reg_loss: 12215.9299; train_edge_recon_loss: 2595981.5915; train_gene_expr_recon_loss: 992896.4529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601093.9717; train_optim_loss: 3601093.9717; val_kl_reg_loss: 11988.0298; val_edge_recon_loss: 2649533.2961; val_gene_expr_recon_loss: 995810.3051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657331.6217; val_optim_loss: 3657331.6217
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9772; val_auprc_score: 0.9709; val_best_acc_score: 0.9330; val_best_f1_score: 0.9349; train_kl_reg_loss: 12208.7374; train_edge_recon_loss: 2594959.4504; train_gene_expr_recon_loss: 992663.7205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599831.9070; train_optim_loss: 3599831.9070; val_kl_reg_loss: 11891.3866; val_edge_recon_loss: 2649247.1480; val_gene_expr_recon_loss: 995553.8117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656692.3618; val_optim_loss: 3656692.3618

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9777; val_auprc_score: 0.9713; val_best_acc_score: 0.9345; val_best_f1_score: 0.9364; train_kl_reg_loss: 12174.5872; train_edge_recon_loss: 2596256.2735; train_gene_expr_recon_loss: 992062.8391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3600493.6941; train_optim_loss: 3600493.6941; val_kl_reg_loss: 11889.1988; val_edge_recon_loss: 2647566.2763; val_gene_expr_recon_loss: 997954.1118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657409.5625; val_optim_loss: 3657409.5625
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9768; val_auprc_score: 0.9699; val_best_acc_score: 0.9323; val_best_f1_score: 0.9343; train_kl_reg_loss: 12174.6625; train_edge_recon_loss: 2596550.8331; train_gene_expr_recon_loss: 992300.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601026.0460; train_optim_loss: 3601026.0460; val_kl_reg_loss: 11903.3686; val_edge_recon_loss: 2651505.4704; val_gene_expr_recon_loss: 994659.6768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658068.5132; val_optim_loss: 3658068.5132
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9779; val_auprc_score: 0.9720; val_best_acc_score: 0.9341; val_best_f1_score: 0.9357; train_kl_reg_loss: 12176.2316; train_edge_recon_loss: 2594852.1096; train_gene_expr_recon_loss: 991795.9101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598824.2548; train_optim_loss: 3598824.2548; val_kl_reg_loss: 11911.2064; val_edge_recon_loss: 2647689.0757; val_gene_expr_recon_loss: 994927.2689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3654527.5625; val_optim_loss: 3654527.5625
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9772; val_auprc_score: 0.9707; val_best_acc_score: 0.9334; val_best_f1_score: 0.9353; train_kl_reg_loss: 12180.2437; train_edge_recon_loss: 2595763.2276; train_gene_expr_recon_loss: 992047.3820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3599990.8551; train_optim_loss: 3599990.8551; val_kl_reg_loss: 11907.9128; val_edge_recon_loss: 2649862.6118; val_gene_expr_recon_loss: 995278.2574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657048.7928; val_optim_loss: 3657048.7928

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 56 min 10 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9772
val AUPRC score: 0.9706
val best accuracy score: 0.9335
val best F1 score: 0.9354
val target rna MSE score: 1.3059
val source rna MSE score: 0.2474

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
