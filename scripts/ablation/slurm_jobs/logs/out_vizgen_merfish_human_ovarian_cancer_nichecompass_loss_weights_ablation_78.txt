None
Run timestamp: 29072023_053044_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 978353
Number of validation edges: 108705
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9878; val_auprc_score: 0.9868; val_best_acc_score: 0.9451; val_best_f1_score: 0.9454; train_kl_reg_loss: 5608.7619; train_edge_recon_loss: 264153.0613; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 269761.8235; train_optim_loss: 269761.8235; val_kl_reg_loss: 5462.8156; val_edge_recon_loss: 261809.3288; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267272.1452; val_optim_loss: 267272.1452
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9907; val_auprc_score: 0.9896; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 5565.5424; train_edge_recon_loss: 260546.0682; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266111.6103; train_optim_loss: 266111.6103; val_kl_reg_loss: 5378.1295; val_edge_recon_loss: 260641.9481; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266020.0771; val_optim_loss: 266020.0771
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9927; val_auprc_score: 0.9918; val_best_acc_score: 0.9604; val_best_f1_score: 0.9606; train_kl_reg_loss: 5554.0199; train_edge_recon_loss: 260023.5055; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265577.5256; train_optim_loss: 265577.5256; val_kl_reg_loss: 5468.6326; val_edge_recon_loss: 260243.9466; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265712.5791; val_optim_loss: 265712.5791
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9931; val_auprc_score: 0.9922; val_best_acc_score: 0.9617; val_best_f1_score: 0.9618; train_kl_reg_loss: 5560.8616; train_edge_recon_loss: 259581.3596; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 265142.2214; train_optim_loss: 265142.2214; val_kl_reg_loss: 5541.5934; val_edge_recon_loss: 259958.8244; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265500.4190; val_optim_loss: 265500.4190
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9938; val_auprc_score: 0.9929; val_best_acc_score: 0.9649; val_best_f1_score: 0.9651; train_kl_reg_loss: 5557.1481; train_edge_recon_loss: 259312.5020; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264869.6500; train_optim_loss: 264869.6500; val_kl_reg_loss: 5288.9245; val_edge_recon_loss: 260175.8069; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265464.7317; val_optim_loss: 265464.7317
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9932; val_best_acc_score: 0.9663; val_best_f1_score: 0.9666; train_kl_reg_loss: 5555.5920; train_edge_recon_loss: 259169.7371; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264725.3292; train_optim_loss: 264725.3292; val_kl_reg_loss: 5664.7833; val_edge_recon_loss: 259659.1162; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265323.8977; val_optim_loss: 265323.8977
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9937; val_best_acc_score: 0.9684; val_best_f1_score: 0.9687; train_kl_reg_loss: 5551.3338; train_edge_recon_loss: 259023.5113; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264574.8452; train_optim_loss: 264574.8452; val_kl_reg_loss: 5472.5126; val_edge_recon_loss: 259606.2049; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265078.7176; val_optim_loss: 265078.7176
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9699; val_best_f1_score: 0.9701; train_kl_reg_loss: 5551.0851; train_edge_recon_loss: 258981.4753; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264532.5606; train_optim_loss: 264532.5606; val_kl_reg_loss: 5544.7642; val_edge_recon_loss: 259164.2740; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264709.0379; val_optim_loss: 264709.0379
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9953; val_auprc_score: 0.9944; val_best_acc_score: 0.9705; val_best_f1_score: 0.9706; train_kl_reg_loss: 5552.0341; train_edge_recon_loss: 258787.7996; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264339.8340; train_optim_loss: 264339.8340; val_kl_reg_loss: 5605.7317; val_edge_recon_loss: 259250.7772; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264856.5078; val_optim_loss: 264856.5078
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9949; val_best_acc_score: 0.9722; val_best_f1_score: 0.9723; train_kl_reg_loss: 5548.7985; train_edge_recon_loss: 258778.8062; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264327.6045; train_optim_loss: 264327.6045; val_kl_reg_loss: 5662.7115; val_edge_recon_loss: 259250.2501; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264912.9608; val_optim_loss: 264912.9608
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9959; val_auprc_score: 0.9953; val_best_acc_score: 0.9726; val_best_f1_score: 0.9727; train_kl_reg_loss: 5549.5916; train_edge_recon_loss: 258704.4249; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264254.0163; train_optim_loss: 264254.0163; val_kl_reg_loss: 5624.4575; val_edge_recon_loss: 259272.7075; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264897.1660; val_optim_loss: 264897.1660
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9720; val_best_f1_score: 0.9721; train_kl_reg_loss: 5548.9397; train_edge_recon_loss: 258661.7212; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264210.6608; train_optim_loss: 264210.6608; val_kl_reg_loss: 5483.2544; val_edge_recon_loss: 259055.1495; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264538.4038; val_optim_loss: 264538.4038
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9725; val_best_f1_score: 0.9727; train_kl_reg_loss: 5549.4889; train_edge_recon_loss: 258475.8843; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264025.3733; train_optim_loss: 264025.3733; val_kl_reg_loss: 5677.4469; val_edge_recon_loss: 258936.7799; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264614.2280; val_optim_loss: 264614.2280
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9733; val_best_f1_score: 0.9734; train_kl_reg_loss: 5546.3428; train_edge_recon_loss: 258466.1315; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264012.4745; train_optim_loss: 264012.4745; val_kl_reg_loss: 5301.3507; val_edge_recon_loss: 258820.5290; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264121.8798; val_optim_loss: 264121.8798
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9956; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 5547.8386; train_edge_recon_loss: 258400.8551; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263948.6936; train_optim_loss: 263948.6936; val_kl_reg_loss: 5525.5627; val_edge_recon_loss: 258656.0308; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264181.5936; val_optim_loss: 264181.5936
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 5546.9035; train_edge_recon_loss: 258370.3412; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263917.2447; train_optim_loss: 263917.2447; val_kl_reg_loss: 5533.6308; val_edge_recon_loss: 258964.9364; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264498.5678; val_optim_loss: 264498.5678
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9960; val_auprc_score: 0.9953; val_best_acc_score: 0.9738; val_best_f1_score: 0.9740; train_kl_reg_loss: 5544.3858; train_edge_recon_loss: 258267.1358; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263811.5218; train_optim_loss: 263811.5218; val_kl_reg_loss: 5471.8720; val_edge_recon_loss: 258677.6122; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264149.4836; val_optim_loss: 264149.4836
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9739; val_best_f1_score: 0.9740; train_kl_reg_loss: 5546.6084; train_edge_recon_loss: 258231.8725; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263778.4806; train_optim_loss: 263778.4806; val_kl_reg_loss: 5597.5379; val_edge_recon_loss: 258603.9313; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264201.4683; val_optim_loss: 264201.4683

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9774; val_best_f1_score: 0.9775; train_kl_reg_loss: 5527.0568; train_edge_recon_loss: 257928.7857; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263455.8428; train_optim_loss: 263455.8428; val_kl_reg_loss: 5472.9979; val_edge_recon_loss: 258068.4074; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263541.4044; val_optim_loss: 263541.4044
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 5521.1159; train_edge_recon_loss: 257746.4834; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263267.5996; train_optim_loss: 263267.5996; val_kl_reg_loss: 5542.1835; val_edge_recon_loss: 258066.9258; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263609.1089; val_optim_loss: 263609.1089
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9777; val_best_f1_score: 0.9778; train_kl_reg_loss: 5518.7872; train_edge_recon_loss: 257730.4304; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263249.2176; train_optim_loss: 263249.2176; val_kl_reg_loss: 5471.8000; val_edge_recon_loss: 258116.3939; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263588.1951; val_optim_loss: 263588.1951
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9776; val_best_f1_score: 0.9777; train_kl_reg_loss: 5511.0260; train_edge_recon_loss: 257713.5710; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263224.5972; train_optim_loss: 263224.5972; val_kl_reg_loss: 5521.0280; val_edge_recon_loss: 258041.6721; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263562.7017; val_optim_loss: 263562.7017
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9777; val_best_f1_score: 0.9779; train_kl_reg_loss: 5511.1100; train_edge_recon_loss: 257708.1124; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263219.2220; train_optim_loss: 263219.2220; val_kl_reg_loss: 5461.7537; val_edge_recon_loss: 258225.4935; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263687.2474; val_optim_loss: 263687.2474

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9778; val_best_f1_score: 0.9779; train_kl_reg_loss: 5507.4143; train_edge_recon_loss: 257765.5657; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263272.9801; train_optim_loss: 263272.9801; val_kl_reg_loss: 5464.1529; val_edge_recon_loss: 258083.4910; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263547.6443; val_optim_loss: 263547.6443
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 5507.4337; train_edge_recon_loss: 257707.2003; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263214.6339; train_optim_loss: 263214.6339; val_kl_reg_loss: 5474.1687; val_edge_recon_loss: 257753.6992; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263227.8680; val_optim_loss: 263227.8680
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9781; val_best_f1_score: 0.9782; train_kl_reg_loss: 5507.4488; train_edge_recon_loss: 257698.6099; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263206.0589; train_optim_loss: 263206.0589; val_kl_reg_loss: 5470.4013; val_edge_recon_loss: 257920.7280; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263391.1293; val_optim_loss: 263391.1293
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 5504.4611; train_edge_recon_loss: 257718.3920; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263222.8532; train_optim_loss: 263222.8532; val_kl_reg_loss: 5459.8854; val_edge_recon_loss: 257923.0708; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263382.9564; val_optim_loss: 263382.9564
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 5505.7947; train_edge_recon_loss: 257704.2741; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263210.0688; train_optim_loss: 263210.0688; val_kl_reg_loss: 5467.2444; val_edge_recon_loss: 257997.6502; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263464.8942; val_optim_loss: 263464.8942
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 5508.6255; train_edge_recon_loss: 257632.7927; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263141.4181; train_optim_loss: 263141.4181; val_kl_reg_loss: 5483.5812; val_edge_recon_loss: 257848.5722; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263332.1534; val_optim_loss: 263332.1534

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9969; val_auprc_score: 0.9962; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 5509.0807; train_edge_recon_loss: 257692.4967; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263201.5776; train_optim_loss: 263201.5776; val_kl_reg_loss: 5466.7481; val_edge_recon_loss: 257957.8231; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263424.5716; val_optim_loss: 263424.5716
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 5506.1312; train_edge_recon_loss: 257685.8703; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263192.0018; train_optim_loss: 263192.0018; val_kl_reg_loss: 5471.8293; val_edge_recon_loss: 257951.0972; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263422.9270; val_optim_loss: 263422.9270
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9972; val_auprc_score: 0.9966; val_best_acc_score: 0.9786; val_best_f1_score: 0.9787; train_kl_reg_loss: 5507.6484; train_edge_recon_loss: 257645.6358; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263153.2842; train_optim_loss: 263153.2842; val_kl_reg_loss: 5469.1031; val_edge_recon_loss: 257778.7876; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263247.8923; val_optim_loss: 263247.8923
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9971; val_auprc_score: 0.9966; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 5505.4262; train_edge_recon_loss: 257679.0621; train_gene_expr_recon_loss: 0.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263184.4886; train_optim_loss: 263184.4886; val_kl_reg_loss: 5469.8311; val_edge_recon_loss: 257886.1593; val_gene_expr_recon_loss: 0.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263355.9908; val_optim_loss: 263355.9908

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 197 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9971
val AUPRC score: 0.9966
val best accuracy score: 0.9783
val best F1 score: 0.9784
val target rna MSE score: 14.1566
val source rna MSE score: 7.6603

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
