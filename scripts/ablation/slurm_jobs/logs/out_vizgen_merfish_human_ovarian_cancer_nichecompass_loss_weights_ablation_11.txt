None
Run timestamp: 06072023_201927_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9648; val_auprc_score: 0.9698; val_best_acc_score: 0.8974; val_best_f1_score: 0.8973; train_kl_reg_loss: 3666.9708; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 138612.7502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142279.7210; train_optim_loss: 142279.7210; val_kl_reg_loss: 2493.0373; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 130280.5201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132773.5573; val_optim_loss: 132773.5573
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9701; val_auprc_score: 0.9746; val_best_acc_score: 0.9071; val_best_f1_score: 0.9062; train_kl_reg_loss: 2287.3078; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 129547.6398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131834.9476; train_optim_loss: 131834.9476; val_kl_reg_loss: 2015.3524; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127782.0982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129797.4505; val_optim_loss: 129797.4505
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9724; val_auprc_score: 0.9769; val_best_acc_score: 0.9154; val_best_f1_score: 0.9134; train_kl_reg_loss: 2094.4058; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128182.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130277.2345; train_optim_loss: 130277.2345; val_kl_reg_loss: 2016.3076; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127212.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129228.4514; val_optim_loss: 129228.4514
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9751; val_auprc_score: 0.9792; val_best_acc_score: 0.9184; val_best_f1_score: 0.9178; train_kl_reg_loss: 2029.2731; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127606.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129635.8100; train_optim_loss: 129635.8100; val_kl_reg_loss: 1994.7546; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126803.3612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128798.1158; val_optim_loss: 128798.1158
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9786; val_auprc_score: 0.9820; val_best_acc_score: 0.9277; val_best_f1_score: 0.9252; train_kl_reg_loss: 1996.7967; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127247.9311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129244.7277; train_optim_loss: 129244.7277; val_kl_reg_loss: 1967.6855; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126831.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128799.3717; val_optim_loss: 128799.3717
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9785; val_auprc_score: 0.9821; val_best_acc_score: 0.9272; val_best_f1_score: 0.9263; train_kl_reg_loss: 1980.6791; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127007.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128987.7182; train_optim_loss: 128987.7182; val_kl_reg_loss: 2016.6557; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126491.7837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128508.4397; val_optim_loss: 128508.4397
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9793; val_auprc_score: 0.9827; val_best_acc_score: 0.9296; val_best_f1_score: 0.9270; train_kl_reg_loss: 1972.5314; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126774.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128747.0604; train_optim_loss: 128747.0604; val_kl_reg_loss: 1907.4664; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126527.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128434.7569; val_optim_loss: 128434.7569
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9805; val_auprc_score: 0.9837; val_best_acc_score: 0.9329; val_best_f1_score: 0.9314; train_kl_reg_loss: 1966.8067; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126646.3207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128613.1275; train_optim_loss: 128613.1275; val_kl_reg_loss: 1929.5768; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126463.4865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128393.0632; val_optim_loss: 128393.0632
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9812; val_auprc_score: 0.9844; val_best_acc_score: 0.9347; val_best_f1_score: 0.9329; train_kl_reg_loss: 1963.6451; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126525.7494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128489.3945; train_optim_loss: 128489.3945; val_kl_reg_loss: 1939.0717; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126243.8326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128182.9044; val_optim_loss: 128182.9044
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9860; val_best_acc_score: 0.9380; val_best_f1_score: 0.9375; train_kl_reg_loss: 1963.0155; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126472.4222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128435.4378; train_optim_loss: 128435.4378; val_kl_reg_loss: 1984.3611; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126252.1243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128236.4855; val_optim_loss: 128236.4855
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9389; val_best_f1_score: 0.9374; train_kl_reg_loss: 1962.3185; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126347.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128309.4261; train_optim_loss: 128309.4261; val_kl_reg_loss: 1927.6292; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126167.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128094.7732; val_optim_loss: 128094.7732
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9840; val_auprc_score: 0.9866; val_best_acc_score: 0.9394; val_best_f1_score: 0.9379; train_kl_reg_loss: 1961.8682; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126228.6301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128190.4984; train_optim_loss: 128190.4984; val_kl_reg_loss: 1931.3864; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126126.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128058.3291; val_optim_loss: 128058.3291
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9849; val_auprc_score: 0.9874; val_best_acc_score: 0.9428; val_best_f1_score: 0.9419; train_kl_reg_loss: 1961.8826; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126179.5619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128141.4445; train_optim_loss: 128141.4445; val_kl_reg_loss: 1930.0777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126078.4418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128008.5199; val_optim_loss: 128008.5199
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9856; val_auprc_score: 0.9880; val_best_acc_score: 0.9446; val_best_f1_score: 0.9433; train_kl_reg_loss: 1962.1236; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126111.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128073.3727; train_optim_loss: 128073.3727; val_kl_reg_loss: 1960.7053; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125951.1666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127911.8719; val_optim_loss: 127911.8719
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9880; val_best_acc_score: 0.9434; val_best_f1_score: 0.9426; train_kl_reg_loss: 1962.1804; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126102.2542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128064.4346; train_optim_loss: 128064.4346; val_kl_reg_loss: 1953.6471; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126173.1989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128126.8461; val_optim_loss: 128126.8461
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9853; val_auprc_score: 0.9877; val_best_acc_score: 0.9433; val_best_f1_score: 0.9425; train_kl_reg_loss: 1963.9429; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126058.6062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128022.5491; train_optim_loss: 128022.5491; val_kl_reg_loss: 1884.8501; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126093.2100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127978.0602; val_optim_loss: 127978.0602
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9852; val_auprc_score: 0.9875; val_best_acc_score: 0.9438; val_best_f1_score: 0.9429; train_kl_reg_loss: 1962.6801; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125973.7105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127936.3906; train_optim_loss: 127936.3906; val_kl_reg_loss: 1935.6777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126140.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128076.3519; val_optim_loss: 128076.3519
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9870; val_auprc_score: 0.9891; val_best_acc_score: 0.9479; val_best_f1_score: 0.9465; train_kl_reg_loss: 1964.7389; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125966.8252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127931.5640; train_optim_loss: 127931.5640; val_kl_reg_loss: 1909.4394; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126107.5939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128017.0334; val_optim_loss: 128017.0334

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9883; val_auprc_score: 0.9900; val_best_acc_score: 0.9510; val_best_f1_score: 0.9498; train_kl_reg_loss: 1913.1097; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125039.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126952.9341; train_optim_loss: 126952.9341; val_kl_reg_loss: 1878.9492; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125441.1275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127320.0769; val_optim_loss: 127320.0769
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9891; val_auprc_score: 0.9908; val_best_acc_score: 0.9528; val_best_f1_score: 0.9525; train_kl_reg_loss: 1897.3712; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124881.9971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126779.3683; train_optim_loss: 126779.3683; val_kl_reg_loss: 1876.6587; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125398.0284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127274.6874; val_optim_loss: 127274.6874
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9907; val_best_acc_score: 0.9531; val_best_f1_score: 0.9527; train_kl_reg_loss: 1897.1497; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124801.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126699.1017; train_optim_loss: 126699.1017; val_kl_reg_loss: 1884.9093; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125366.8130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127251.7223; val_optim_loss: 127251.7223
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9910; val_best_acc_score: 0.9542; val_best_f1_score: 0.9536; train_kl_reg_loss: 1896.5675; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124741.6861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126638.2535; train_optim_loss: 126638.2535; val_kl_reg_loss: 1881.2127; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125438.8994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127320.1119; val_optim_loss: 127320.1119
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9894; val_auprc_score: 0.9912; val_best_acc_score: 0.9544; val_best_f1_score: 0.9536; train_kl_reg_loss: 1897.0390; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124782.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126680.0010; train_optim_loss: 126680.0010; val_kl_reg_loss: 1880.4631; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125229.9203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127110.3836; val_optim_loss: 127110.3836
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9898; val_auprc_score: 0.9914; val_best_acc_score: 0.9549; val_best_f1_score: 0.9540; train_kl_reg_loss: 1897.9866; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124673.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126571.5386; train_optim_loss: 126571.5386; val_kl_reg_loss: 1884.1408; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125014.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126898.1456; val_optim_loss: 126898.1456
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9898; val_auprc_score: 0.9914; val_best_acc_score: 0.9552; val_best_f1_score: 0.9542; train_kl_reg_loss: 1898.7434; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124733.1704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126631.9139; train_optim_loss: 126631.9139; val_kl_reg_loss: 1885.4566; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125325.7919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127211.2485; val_optim_loss: 127211.2485
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9898; val_auprc_score: 0.9914; val_best_acc_score: 0.9540; val_best_f1_score: 0.9535; train_kl_reg_loss: 1898.1414; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124649.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126547.3680; train_optim_loss: 126547.3680; val_kl_reg_loss: 1876.2429; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125307.1230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127183.3661; val_optim_loss: 127183.3661
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9898; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9538; train_kl_reg_loss: 1897.6977; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124618.7097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126516.4074; train_optim_loss: 126516.4074; val_kl_reg_loss: 1893.8802; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125356.9868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127250.8672; val_optim_loss: 127250.8672
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9897; val_auprc_score: 0.9913; val_best_acc_score: 0.9541; val_best_f1_score: 0.9539; train_kl_reg_loss: 1898.1883; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124619.6213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126517.8095; train_optim_loss: 126517.8095; val_kl_reg_loss: 1888.9877; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125421.8326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127310.8203; val_optim_loss: 127310.8203

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9550; val_best_f1_score: 0.9547; train_kl_reg_loss: 1898.8697; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124443.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126341.9332; train_optim_loss: 126341.9332; val_kl_reg_loss: 1880.6102; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125140.4678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127021.0778; val_optim_loss: 127021.0778
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9900; val_auprc_score: 0.9917; val_best_acc_score: 0.9555; val_best_f1_score: 0.9551; train_kl_reg_loss: 1898.1795; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124441.9539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126340.1333; train_optim_loss: 126340.1333; val_kl_reg_loss: 1879.3999; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124958.7300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126838.1302; val_optim_loss: 126838.1302
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9901; val_auprc_score: 0.9917; val_best_acc_score: 0.9560; val_best_f1_score: 0.9556; train_kl_reg_loss: 1897.7525; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124402.5525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126300.3049; train_optim_loss: 126300.3049; val_kl_reg_loss: 1880.0860; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125189.3304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127069.4169; val_optim_loss: 127069.4169
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9901; val_auprc_score: 0.9917; val_best_acc_score: 0.9558; val_best_f1_score: 0.9554; train_kl_reg_loss: 1897.5175; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124377.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126275.3462; train_optim_loss: 126275.3462; val_kl_reg_loss: 1881.3980; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124931.5183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126812.9162; val_optim_loss: 126812.9162
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9564; val_best_f1_score: 0.9560; train_kl_reg_loss: 1897.3479; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124394.5746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126291.9226; train_optim_loss: 126291.9226; val_kl_reg_loss: 1873.7359; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125079.0806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126952.8163; val_optim_loss: 126952.8163
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9902; val_auprc_score: 0.9916; val_best_acc_score: 0.9559; val_best_f1_score: 0.9555; train_kl_reg_loss: 1898.1802; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124403.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126301.3062; train_optim_loss: 126301.3062; val_kl_reg_loss: 1882.2467; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124963.5277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126845.7746; val_optim_loss: 126845.7746
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9566; val_best_f1_score: 0.9561; train_kl_reg_loss: 1897.4575; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124370.0668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126267.5243; train_optim_loss: 126267.5243; val_kl_reg_loss: 1880.2284; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125029.9362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126910.1646; val_optim_loss: 126910.1646
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9561; val_best_f1_score: 0.9557; train_kl_reg_loss: 1897.6461; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124418.4541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126316.1002; train_optim_loss: 126316.1002; val_kl_reg_loss: 1880.5155; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125009.4304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126889.9458; val_optim_loss: 126889.9458

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9562; val_best_f1_score: 0.9558; train_kl_reg_loss: 1897.2294; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124379.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126276.4052; train_optim_loss: 126276.4052; val_kl_reg_loss: 1878.7679; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124917.2832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126796.0511; val_optim_loss: 126796.0511
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9902; val_auprc_score: 0.9916; val_best_acc_score: 0.9562; val_best_f1_score: 0.9557; train_kl_reg_loss: 1898.0124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124303.4459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126201.4582; train_optim_loss: 126201.4582; val_kl_reg_loss: 1880.5300; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125215.9168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127096.4470; val_optim_loss: 127096.4470
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9903; val_auprc_score: 0.9917; val_best_acc_score: 0.9569; val_best_f1_score: 0.9564; train_kl_reg_loss: 1898.0943; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124332.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126230.9145; train_optim_loss: 126230.9145; val_kl_reg_loss: 1880.3928; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125171.2244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127051.6173; val_optim_loss: 127051.6173
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9562; val_best_f1_score: 0.9558; train_kl_reg_loss: 1898.2289; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124331.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126230.1637; train_optim_loss: 126230.1637; val_kl_reg_loss: 1881.1737; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125193.0325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127074.2060; val_optim_loss: 127074.2060
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9903; val_auprc_score: 0.9919; val_best_acc_score: 0.9563; val_best_f1_score: 0.9558; train_kl_reg_loss: 1898.7411; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124292.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126191.0346; train_optim_loss: 126191.0346; val_kl_reg_loss: 1881.7391; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124936.1011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126817.8403; val_optim_loss: 126817.8403

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9565; val_best_f1_score: 0.9560; train_kl_reg_loss: 1899.0586; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124240.1605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126139.2191; train_optim_loss: 126139.2191; val_kl_reg_loss: 1880.7575; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125110.4177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126991.1749; val_optim_loss: 126991.1749
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9565; val_best_f1_score: 0.9560; train_kl_reg_loss: 1898.4665; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124290.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126189.2451; train_optim_loss: 126189.2451; val_kl_reg_loss: 1881.0355; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125137.9754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127019.0111; val_optim_loss: 127019.0111
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9563; val_best_f1_score: 0.9559; train_kl_reg_loss: 1898.3733; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124318.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126216.8404; train_optim_loss: 126216.8404; val_kl_reg_loss: 1880.3815; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125012.8441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126893.2258; val_optim_loss: 126893.2258
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9567; val_best_f1_score: 0.9563; train_kl_reg_loss: 1898.2155; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124254.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126153.1549; train_optim_loss: 126153.1549; val_kl_reg_loss: 1880.1416; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125050.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126930.7225; val_optim_loss: 126930.7225

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 812 min 19 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9902
Val AUPRC score: 0.9917
Val best accuracy score: 0.9561
Val best F1 score: 0.9557
Val gene expr MSE score: 8.1018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
