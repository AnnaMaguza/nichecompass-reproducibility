
Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9893; val_auprc_score: 0.9909; val_best_acc_score: 0.9534; val_best_f1_score: 0.9529; train_kl_reg_loss: 2003.1962; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122939.1919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124942.3881; train_optim_loss: 124942.3881; val_kl_reg_loss: 1983.0066; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124174.6006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126157.6072; val_optim_loss: 126157.6072
None
Run timestamp: 03072023_202319_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9597; val_auprc_score: 0.9654; val_best_acc_score: 0.8924; val_best_f1_score: 0.8873; train_kl_reg_loss: 4389.0773; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 142374.7271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146763.8044; train_optim_loss: 146763.8044; val_kl_reg_loss: 2697.2229; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 133350.8651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136048.0878; val_optim_loss: 136048.0878
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9894; val_auprc_score: 0.9911; val_best_acc_score: 0.9533; val_best_f1_score: 0.9528; train_kl_reg_loss: 2003.0789; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122964.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124967.3399; train_optim_loss: 124967.3399; val_kl_reg_loss: 1983.8014; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124161.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126144.8561; val_optim_loss: 126144.8561
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9687; val_auprc_score: 0.9734; val_best_acc_score: 0.9072; val_best_f1_score: 0.9056; train_kl_reg_loss: 2628.0114; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 131657.8375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134285.8490; train_optim_loss: 134285.8490; val_kl_reg_loss: 2348.3173; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 129439.6363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131787.9529; val_optim_loss: 131787.9529
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9712; val_auprc_score: 0.9756; val_best_acc_score: 0.9116; val_best_f1_score: 0.9073; train_kl_reg_loss: 2285.2173; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 129165.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131450.8370; train_optim_loss: 131450.8370; val_kl_reg_loss: 2196.5164; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 128039.8833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130236.3997; val_optim_loss: 130236.3997
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9892; val_auprc_score: 0.9909; val_best_acc_score: 0.9535; val_best_f1_score: 0.9530; train_kl_reg_loss: 2002.4877; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122955.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124957.9428; train_optim_loss: 124957.9428; val_kl_reg_loss: 1982.6311; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124108.0305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126090.6615; val_optim_loss: 126090.6615
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9734; val_auprc_score: 0.9776; val_best_acc_score: 0.9161; val_best_f1_score: 0.9151; train_kl_reg_loss: 2144.8908; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128096.4770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130241.3679; train_optim_loss: 130241.3679; val_kl_reg_loss: 2096.0991; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127342.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129438.9317; val_optim_loss: 129438.9317
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9892; val_auprc_score: 0.9909; val_best_acc_score: 0.9533; val_best_f1_score: 0.9528; train_kl_reg_loss: 2002.1657; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 122937.2766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124939.4424; train_optim_loss: 124939.4424; val_kl_reg_loss: 1982.7222; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124172.1837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126154.9062; val_optim_loss: 126154.9062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9759; val_auprc_score: 0.9798; val_best_acc_score: 0.9229; val_best_f1_score: 0.9198; train_kl_reg_loss: 2076.3281; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127511.8019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129588.1299; train_optim_loss: 129588.1299; val_kl_reg_loss: 2033.0343; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126895.8761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128928.9103; val_optim_loss: 128928.9103
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9774; val_auprc_score: 0.9810; val_best_acc_score: 0.9237; val_best_f1_score: 0.9232; train_kl_reg_loss: 2037.3750; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127133.9717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129171.3467; train_optim_loss: 129171.3467; val_kl_reg_loss: 2025.1628; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126597.2840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128622.4466; val_optim_loss: 128622.4466

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 840 min 44 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9892
Val AUPRC score: 0.9909
Val best accuracy score: 0.9529
Val best F1 score: 0.9526
Val gene expr MSE score: 8.3318

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9790; val_auprc_score: 0.9825; val_best_acc_score: 0.9297; val_best_f1_score: 0.9274; train_kl_reg_loss: 2017.3830; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126854.1936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128871.5766; train_optim_loss: 128871.5766; val_kl_reg_loss: 1951.9340; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126434.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128386.8443; val_optim_loss: 128386.8443
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9796; val_auprc_score: 0.9829; val_best_acc_score: 0.9283; val_best_f1_score: 0.9276; train_kl_reg_loss: 2007.3973; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126690.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128697.4360; train_optim_loss: 128697.4360; val_kl_reg_loss: 2001.5387; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126296.7947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128298.3335; val_optim_loss: 128298.3335
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9809; val_auprc_score: 0.9841; val_best_acc_score: 0.9339; val_best_f1_score: 0.9327; train_kl_reg_loss: 2001.1573; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126460.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128462.0697; train_optim_loss: 128462.0697; val_kl_reg_loss: 1963.3139; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126082.3062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128045.6201; val_optim_loss: 128045.6201
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9821; val_auprc_score: 0.9851; val_best_acc_score: 0.9356; val_best_f1_score: 0.9333; train_kl_reg_loss: 1998.3488; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126287.3705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128285.7194; train_optim_loss: 128285.7194; val_kl_reg_loss: 1984.1843; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126028.6568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128012.8411; val_optim_loss: 128012.8411
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9820; val_auprc_score: 0.9849; val_best_acc_score: 0.9351; val_best_f1_score: 0.9345; train_kl_reg_loss: 1996.4610; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126222.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128218.4681; train_optim_loss: 128218.4681; val_kl_reg_loss: 1953.0833; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125987.0801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127940.1634; val_optim_loss: 127940.1634
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9836; val_auprc_score: 0.9864; val_best_acc_score: 0.9397; val_best_f1_score: 0.9386; train_kl_reg_loss: 1996.2663; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126106.7940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128103.0603; train_optim_loss: 128103.0603; val_kl_reg_loss: 2001.6422; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126010.3473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128011.9893; val_optim_loss: 128011.9893
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9846; val_auprc_score: 0.9871; val_best_acc_score: 0.9406; val_best_f1_score: 0.9391; train_kl_reg_loss: 1995.2679; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126004.5138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127999.7816; train_optim_loss: 127999.7816; val_kl_reg_loss: 1990.4292; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125864.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127855.3265; val_optim_loss: 127855.3265
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9841; val_auprc_score: 0.9867; val_best_acc_score: 0.9394; val_best_f1_score: 0.9390; train_kl_reg_loss: 1995.2124; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125857.3088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127852.5212; train_optim_loss: 127852.5212; val_kl_reg_loss: 1976.2106; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125883.6101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127859.8208; val_optim_loss: 127859.8208
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9844; val_auprc_score: 0.9869; val_best_acc_score: 0.9419; val_best_f1_score: 0.9408; train_kl_reg_loss: 1995.8656; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125777.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127773.6714; train_optim_loss: 127773.6714; val_kl_reg_loss: 2010.2223; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125766.0873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127776.3101; val_optim_loss: 127776.3101
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9853; val_auprc_score: 0.9877; val_best_acc_score: 0.9429; val_best_f1_score: 0.9411; train_kl_reg_loss: 1996.0364; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125744.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127740.9722; train_optim_loss: 127740.9722; val_kl_reg_loss: 1966.3224; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125583.9767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127550.2989; val_optim_loss: 127550.2989
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9865; val_auprc_score: 0.9886; val_best_acc_score: 0.9456; val_best_f1_score: 0.9453; train_kl_reg_loss: 1997.4929; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125725.8520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127723.3451; train_optim_loss: 127723.3451; val_kl_reg_loss: 1982.6440; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125827.7720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127810.4160; val_optim_loss: 127810.4160
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9854; val_auprc_score: 0.9878; val_best_acc_score: 0.9439; val_best_f1_score: 0.9432; train_kl_reg_loss: 1998.7496; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125654.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127653.4377; train_optim_loss: 127653.4377; val_kl_reg_loss: 2032.7686; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125658.6924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127691.4610; val_optim_loss: 127691.4610
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9861; val_auprc_score: 0.9884; val_best_acc_score: 0.9459; val_best_f1_score: 0.9446; train_kl_reg_loss: 2000.4410; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125609.0998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127609.5408; train_optim_loss: 127609.5408; val_kl_reg_loss: 1982.2123; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125571.2047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127553.4172; val_optim_loss: 127553.4172
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9865; val_auprc_score: 0.9886; val_best_acc_score: 0.9460; val_best_f1_score: 0.9444; train_kl_reg_loss: 2000.9362; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125520.8221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127521.7583; train_optim_loss: 127521.7583; val_kl_reg_loss: 1949.2529; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125478.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127427.5098; val_optim_loss: 127427.5098
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9875; val_auprc_score: 0.9895; val_best_acc_score: 0.9495; val_best_f1_score: 0.9488; train_kl_reg_loss: 2001.2723; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125491.8539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127493.1263; train_optim_loss: 127493.1263; val_kl_reg_loss: 1958.7703; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125596.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127554.9994; val_optim_loss: 127554.9994
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9875; val_auprc_score: 0.9896; val_best_acc_score: 0.9494; val_best_f1_score: 0.9486; train_kl_reg_loss: 2003.2542; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125445.8344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127449.0888; train_optim_loss: 127449.0888; val_kl_reg_loss: 1997.8456; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125442.7455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127440.5909; val_optim_loss: 127440.5909
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9864; val_auprc_score: 0.9886; val_best_acc_score: 0.9465; val_best_f1_score: 0.9458; train_kl_reg_loss: 2005.2864; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125389.9693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127395.2558; train_optim_loss: 127395.2558; val_kl_reg_loss: 2013.0755; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125753.3110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127766.3867; val_optim_loss: 127766.3867
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9877; val_auprc_score: 0.9896; val_best_acc_score: 0.9488; val_best_f1_score: 0.9480; train_kl_reg_loss: 2004.8987; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125409.9729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127414.8716; train_optim_loss: 127414.8716; val_kl_reg_loss: 1971.1077; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125491.6141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127462.7221; val_optim_loss: 127462.7221

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9889; val_auprc_score: 0.9907; val_best_acc_score: 0.9530; val_best_f1_score: 0.9523; train_kl_reg_loss: 1967.2342; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124692.6869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126659.9211; train_optim_loss: 126659.9211; val_kl_reg_loss: 1936.2326; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124999.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126935.7197; val_optim_loss: 126935.7197
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9893; val_auprc_score: 0.9910; val_best_acc_score: 0.9533; val_best_f1_score: 0.9523; train_kl_reg_loss: 1957.1497; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124559.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126516.5485; train_optim_loss: 126516.5485; val_kl_reg_loss: 1932.8804; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125122.9797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127055.8600; val_optim_loss: 127055.8600
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9891; val_auprc_score: 0.9908; val_best_acc_score: 0.9527; val_best_f1_score: 0.9519; train_kl_reg_loss: 1955.8378; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124482.3570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126438.1948; train_optim_loss: 126438.1948; val_kl_reg_loss: 1940.6232; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124925.2251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126865.8482; val_optim_loss: 126865.8482
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9897; val_auprc_score: 0.9912; val_best_acc_score: 0.9542; val_best_f1_score: 0.9539; train_kl_reg_loss: 1956.5640; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124459.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126416.4595; train_optim_loss: 126416.4595; val_kl_reg_loss: 1940.0989; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124961.6981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126901.7971; val_optim_loss: 126901.7971
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9896; val_auprc_score: 0.9913; val_best_acc_score: 0.9531; val_best_f1_score: 0.9529; train_kl_reg_loss: 1956.1581; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124473.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126429.5943; train_optim_loss: 126429.5943; val_kl_reg_loss: 1939.4529; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124926.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126866.2058; val_optim_loss: 126866.2058
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9897; val_auprc_score: 0.9911; val_best_acc_score: 0.9549; val_best_f1_score: 0.9545; train_kl_reg_loss: 1956.2156; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124410.8170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126367.0325; train_optim_loss: 126367.0325; val_kl_reg_loss: 1931.3777; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125030.3378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126961.7156; val_optim_loss: 126961.7156
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9895; val_auprc_score: 0.9912; val_best_acc_score: 0.9541; val_best_f1_score: 0.9537; train_kl_reg_loss: 1956.4544; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124427.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126383.7823; train_optim_loss: 126383.7823; val_kl_reg_loss: 1950.4470; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124908.2545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126858.7018; val_optim_loss: 126858.7018
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9897; val_auprc_score: 0.9914; val_best_acc_score: 0.9550; val_best_f1_score: 0.9545; train_kl_reg_loss: 1956.5261; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124395.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126352.3379; train_optim_loss: 126352.3379; val_kl_reg_loss: 1932.8627; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124841.7358; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126774.5982; val_optim_loss: 126774.5982
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9897; val_auprc_score: 0.9914; val_best_acc_score: 0.9555; val_best_f1_score: 0.9549; train_kl_reg_loss: 1956.6387; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124348.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126305.5393; train_optim_loss: 126305.5393; val_kl_reg_loss: 1937.0601; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124972.6279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126909.6878; val_optim_loss: 126909.6878
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9898; val_auprc_score: 0.9914; val_best_acc_score: 0.9555; val_best_f1_score: 0.9548; train_kl_reg_loss: 1956.5514; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124399.2157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126355.7671; train_optim_loss: 126355.7671; val_kl_reg_loss: 1928.6353; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124807.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126736.4839; val_optim_loss: 126736.4839
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9897; val_auprc_score: 0.9914; val_best_acc_score: 0.9554; val_best_f1_score: 0.9547; train_kl_reg_loss: 1956.8584; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124395.9135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126352.7719; train_optim_loss: 126352.7719; val_kl_reg_loss: 1942.3666; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124928.8055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126871.1719; val_optim_loss: 126871.1719
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9898; val_auprc_score: 0.9914; val_best_acc_score: 0.9557; val_best_f1_score: 0.9550; train_kl_reg_loss: 1957.0881; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124352.0571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126309.1453; train_optim_loss: 126309.1453; val_kl_reg_loss: 1953.0871; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124962.8820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126915.9691; val_optim_loss: 126915.9691
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9562; val_best_f1_score: 0.9555; train_kl_reg_loss: 1957.3566; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124368.7902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126326.1469; train_optim_loss: 126326.1469; val_kl_reg_loss: 1943.3838; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124915.0311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126858.4149; val_optim_loss: 126858.4149
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9898; val_auprc_score: 0.9913; val_best_acc_score: 0.9551; val_best_f1_score: 0.9543; train_kl_reg_loss: 1956.7872; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124355.9764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126312.7636; train_optim_loss: 126312.7636; val_kl_reg_loss: 1931.5816; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124876.7938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126808.3756; val_optim_loss: 126808.3756

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9556; val_best_f1_score: 0.9547; train_kl_reg_loss: 1955.3753; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124206.3393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126161.7146; train_optim_loss: 126161.7146; val_kl_reg_loss: 1938.5336; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124638.2638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126576.7975; val_optim_loss: 126576.7975
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9901; val_auprc_score: 0.9916; val_best_acc_score: 0.9557; val_best_f1_score: 0.9548; train_kl_reg_loss: 1955.4678; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124229.5141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126184.9818; train_optim_loss: 126184.9818; val_kl_reg_loss: 1936.4698; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124868.3079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126804.7778; val_optim_loss: 126804.7778
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9901; val_auprc_score: 0.9916; val_best_acc_score: 0.9556; val_best_f1_score: 0.9546; train_kl_reg_loss: 1954.2941; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124227.6969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126181.9909; train_optim_loss: 126181.9909; val_kl_reg_loss: 1934.0298; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124764.7452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126698.7753; val_optim_loss: 126698.7753
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9556; val_best_f1_score: 0.9547; train_kl_reg_loss: 1955.2579; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124212.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126167.7507; train_optim_loss: 126167.7507; val_kl_reg_loss: 1934.2251; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124742.5623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126676.7875; val_optim_loss: 126676.7875
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9919; val_best_acc_score: 0.9563; val_best_f1_score: 0.9554; train_kl_reg_loss: 1956.2431; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124214.6678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126170.9109; train_optim_loss: 126170.9109; val_kl_reg_loss: 1937.0188; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124827.7813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126764.7999; val_optim_loss: 126764.7999

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9554; val_best_f1_score: 0.9545; train_kl_reg_loss: 1955.4603; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124226.6435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126182.1037; train_optim_loss: 126182.1037; val_kl_reg_loss: 1937.7411; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124791.2723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126729.0136; val_optim_loss: 126729.0136
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9901; val_auprc_score: 0.9918; val_best_acc_score: 0.9557; val_best_f1_score: 0.9547; train_kl_reg_loss: 1955.7860; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124226.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126182.6217; train_optim_loss: 126182.6217; val_kl_reg_loss: 1936.5128; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124709.9399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126646.4530; val_optim_loss: 126646.4530
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9900; val_auprc_score: 0.9916; val_best_acc_score: 0.9554; val_best_f1_score: 0.9544; train_kl_reg_loss: 1955.2655; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124211.1150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126166.3806; train_optim_loss: 126166.3806; val_kl_reg_loss: 1938.0453; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124757.4906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126695.5358; val_optim_loss: 126695.5358
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9559; val_best_f1_score: 0.9549; train_kl_reg_loss: 1955.3930; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124204.8769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126160.2699; train_optim_loss: 126160.2699; val_kl_reg_loss: 1936.5454; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124752.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126688.8855; val_optim_loss: 126688.8855

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 533 min 45 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9899
Val AUPRC score: 0.9915
Val best accuracy score: 0.9557
Val best F1 score: 0.9548
Val gene expr MSE score: 8.2783

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
