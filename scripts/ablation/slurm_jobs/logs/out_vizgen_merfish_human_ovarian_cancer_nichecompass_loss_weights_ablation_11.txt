None
Run timestamp: 30062023_210459_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9569; val_auprc_score: 0.9627; val_best_acc_score: 0.8871; val_best_f1_score: 0.8823; train_kl_reg_loss: 4248.5664; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 143361.0901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147609.6563; train_optim_loss: 147609.6563; val_kl_reg_loss: 2845.6177; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 133952.8927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136798.5097; val_optim_loss: 136798.5097
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9659; val_auprc_score: 0.9709; val_best_acc_score: 0.9001; val_best_f1_score: 0.8995; train_kl_reg_loss: 2614.6683; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 132073.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134687.6850; train_optim_loss: 134687.6850; val_kl_reg_loss: 2467.7755; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 129765.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132233.2215; val_optim_loss: 132233.2215
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9690; val_auprc_score: 0.9737; val_best_acc_score: 0.9060; val_best_f1_score: 0.9022; train_kl_reg_loss: 2281.7781; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 129431.7744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131713.5525; train_optim_loss: 131713.5525; val_kl_reg_loss: 2134.9123; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 128113.3756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130248.2876; val_optim_loss: 130248.2876
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9724; val_auprc_score: 0.9767; val_best_acc_score: 0.9131; val_best_f1_score: 0.9124; train_kl_reg_loss: 2142.6184; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 128216.0264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130358.6448; train_optim_loss: 130358.6448; val_kl_reg_loss: 2067.1949; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 127327.1948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129394.3897; val_optim_loss: 129394.3897
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9746; val_auprc_score: 0.9786; val_best_acc_score: 0.9195; val_best_f1_score: 0.9169; train_kl_reg_loss: 2074.7961; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127622.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129697.1833; train_optim_loss: 129697.1833; val_kl_reg_loss: 2055.3113; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126977.9315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129033.2429; val_optim_loss: 129033.2429
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9769; val_auprc_score: 0.9805; val_best_acc_score: 0.9219; val_best_f1_score: 0.9200; train_kl_reg_loss: 2039.5335; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127183.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129223.3516; train_optim_loss: 129223.3516; val_kl_reg_loss: 2041.5288; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126761.3606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128802.8898; val_optim_loss: 128802.8898
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9767; val_auprc_score: 0.9805; val_best_acc_score: 0.9241; val_best_f1_score: 0.9226; train_kl_reg_loss: 2023.6073; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126897.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128920.6187; train_optim_loss: 128920.6187; val_kl_reg_loss: 2003.3848; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126521.5030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128524.8878; val_optim_loss: 128524.8878
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9793; val_auprc_score: 0.9827; val_best_acc_score: 0.9278; val_best_f1_score: 0.9253; train_kl_reg_loss: 2011.8087; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126644.5925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128656.4013; train_optim_loss: 128656.4013; val_kl_reg_loss: 1983.3364; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126418.7462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128402.0827; val_optim_loss: 128402.0827
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9805; val_auprc_score: 0.9836; val_best_acc_score: 0.9317; val_best_f1_score: 0.9308; train_kl_reg_loss: 2006.9321; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126522.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128529.7705; train_optim_loss: 128529.7705; val_kl_reg_loss: 1984.1288; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126257.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128241.4252; val_optim_loss: 128241.4252
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9808; val_auprc_score: 0.9839; val_best_acc_score: 0.9333; val_best_f1_score: 0.9311; train_kl_reg_loss: 2005.3493; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126311.2542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128316.6034; train_optim_loss: 128316.6034; val_kl_reg_loss: 1984.5893; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126155.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128139.6377; val_optim_loss: 128139.6377
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9822; val_auprc_score: 0.9852; val_best_acc_score: 0.9346; val_best_f1_score: 0.9342; train_kl_reg_loss: 2004.4992; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126197.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128202.3236; train_optim_loss: 128202.3236; val_kl_reg_loss: 1968.7567; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125966.2895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127935.0468; val_optim_loss: 127935.0468
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9831; val_auprc_score: 0.9857; val_best_acc_score: 0.9386; val_best_f1_score: 0.9373; train_kl_reg_loss: 2004.0248; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126063.3170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128067.3418; train_optim_loss: 128067.3418; val_kl_reg_loss: 1972.5978; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126091.0758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128063.6738; val_optim_loss: 128063.6738
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9833; val_auprc_score: 0.9860; val_best_acc_score: 0.9383; val_best_f1_score: 0.9361; train_kl_reg_loss: 2003.4152; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125965.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127969.2638; train_optim_loss: 127969.2638; val_kl_reg_loss: 1997.2458; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125995.6316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127992.8776; val_optim_loss: 127992.8776
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9832; val_auprc_score: 0.9859; val_best_acc_score: 0.9367; val_best_f1_score: 0.9364; train_kl_reg_loss: 2003.4704; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125883.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127887.1249; train_optim_loss: 127887.1249; val_kl_reg_loss: 2015.8309; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125952.7769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127968.6077; val_optim_loss: 127968.6077
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9843; val_auprc_score: 0.9868; val_best_acc_score: 0.9407; val_best_f1_score: 0.9398; train_kl_reg_loss: 2003.8647; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125893.9839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127897.8486; train_optim_loss: 127897.8486; val_kl_reg_loss: 1950.5115; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125881.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127831.7577; val_optim_loss: 127831.7577
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9842; val_auprc_score: 0.9867; val_best_acc_score: 0.9408; val_best_f1_score: 0.9397; train_kl_reg_loss: 2003.2591; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125762.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127766.0978; train_optim_loss: 127766.0978; val_kl_reg_loss: 2004.4075; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125975.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127979.6248; val_optim_loss: 127979.6248
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9849; val_auprc_score: 0.9874; val_best_acc_score: 0.9416; val_best_f1_score: 0.9397; train_kl_reg_loss: 2002.2098; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125692.0728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127694.2826; train_optim_loss: 127694.2826; val_kl_reg_loss: 2000.4508; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125754.8931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127755.3439; val_optim_loss: 127755.3439
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9851; val_auprc_score: 0.9875; val_best_acc_score: 0.9428; val_best_f1_score: 0.9421; train_kl_reg_loss: 2002.0907; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125649.1022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127651.1927; train_optim_loss: 127651.1927; val_kl_reg_loss: 1991.2247; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125837.0404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127828.2653; val_optim_loss: 127828.2653
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9851; val_auprc_score: 0.9875; val_best_acc_score: 0.9435; val_best_f1_score: 0.9427; train_kl_reg_loss: 2001.2890; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125625.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127627.0582; train_optim_loss: 127627.0582; val_kl_reg_loss: 2001.7685; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125712.6773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127714.4460; val_optim_loss: 127714.4460
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9863; val_auprc_score: 0.9885; val_best_acc_score: 0.9457; val_best_f1_score: 0.9442; train_kl_reg_loss: 2001.6211; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125580.1480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127581.7691; train_optim_loss: 127581.7691; val_kl_reg_loss: 1978.1056; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125728.0395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127706.1450; val_optim_loss: 127706.1450
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9860; val_auprc_score: 0.9882; val_best_acc_score: 0.9438; val_best_f1_score: 0.9428; train_kl_reg_loss: 2001.6360; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125538.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127540.3631; train_optim_loss: 127540.3631; val_kl_reg_loss: 1995.2009; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125500.2620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127495.4629; val_optim_loss: 127495.4629
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9871; val_auprc_score: 0.9891; val_best_acc_score: 0.9480; val_best_f1_score: 0.9472; train_kl_reg_loss: 2003.2038; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125440.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127443.8082; train_optim_loss: 127443.8082; val_kl_reg_loss: 1976.3771; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125777.4963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127753.8733; val_optim_loss: 127753.8733
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9867; val_auprc_score: 0.9889; val_best_acc_score: 0.9476; val_best_f1_score: 0.9468; train_kl_reg_loss: 2002.9918; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125442.6564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127445.6482; train_optim_loss: 127445.6482; val_kl_reg_loss: 2019.8763; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125655.9777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127675.8541; val_optim_loss: 127675.8541
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9865; val_auprc_score: 0.9887; val_best_acc_score: 0.9467; val_best_f1_score: 0.9454; train_kl_reg_loss: 2004.2379; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125438.0598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127442.2976; train_optim_loss: 127442.2976; val_kl_reg_loss: 1990.4564; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125638.4540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127628.9100; val_optim_loss: 127628.9100
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9879; val_auprc_score: 0.9898; val_best_acc_score: 0.9496; val_best_f1_score: 0.9483; train_kl_reg_loss: 2004.2661; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125344.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127348.3537; train_optim_loss: 127348.3537; val_kl_reg_loss: 1982.8252; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125546.5491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127529.3745; val_optim_loss: 127529.3745

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9886; val_auprc_score: 0.9904; val_best_acc_score: 0.9518; val_best_f1_score: 0.9509; train_kl_reg_loss: 1964.5373; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124639.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126604.2908; train_optim_loss: 126604.2908; val_kl_reg_loss: 1935.3492; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125276.7721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127212.1212; val_optim_loss: 127212.1212
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9891; val_auprc_score: 0.9908; val_best_acc_score: 0.9526; val_best_f1_score: 0.9515; train_kl_reg_loss: 1952.9328; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124522.9611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126475.8940; train_optim_loss: 126475.8940; val_kl_reg_loss: 1921.2859; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125055.6495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126976.9355; val_optim_loss: 126976.9355
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9890; val_auprc_score: 0.9907; val_best_acc_score: 0.9517; val_best_f1_score: 0.9516; train_kl_reg_loss: 1952.9285; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124491.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126444.2795; train_optim_loss: 126444.2795; val_kl_reg_loss: 1928.8261; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125112.2568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127041.0831; val_optim_loss: 127041.0831
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9892; val_auprc_score: 0.9908; val_best_acc_score: 0.9523; val_best_f1_score: 0.9522; train_kl_reg_loss: 1952.2191; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124469.4366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126421.6558; train_optim_loss: 126421.6558; val_kl_reg_loss: 1942.1473; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125040.4738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126982.6211; val_optim_loss: 126982.6211
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9893; val_auprc_score: 0.9910; val_best_acc_score: 0.9536; val_best_f1_score: 0.9532; train_kl_reg_loss: 1952.9806; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124418.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126371.0620; train_optim_loss: 126371.0620; val_kl_reg_loss: 1933.6323; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125015.5928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126949.2248; val_optim_loss: 126949.2248
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9896; val_auprc_score: 0.9913; val_best_acc_score: 0.9543; val_best_f1_score: 0.9539; train_kl_reg_loss: 1953.1728; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124430.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126383.5785; train_optim_loss: 126383.5785; val_kl_reg_loss: 1918.7422; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125082.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127001.4115; val_optim_loss: 127001.4115
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9893; val_auprc_score: 0.9910; val_best_acc_score: 0.9536; val_best_f1_score: 0.9531; train_kl_reg_loss: 1952.4007; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124415.6240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126368.0248; train_optim_loss: 126368.0248; val_kl_reg_loss: 1927.0978; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124990.1028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126917.2009; val_optim_loss: 126917.2009
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9896; val_auprc_score: 0.9912; val_best_acc_score: 0.9547; val_best_f1_score: 0.9542; train_kl_reg_loss: 1952.6486; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124420.0381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126372.6867; train_optim_loss: 126372.6867; val_kl_reg_loss: 1942.2370; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125070.3533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127012.5908; val_optim_loss: 127012.5908
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9896; val_auprc_score: 0.9913; val_best_acc_score: 0.9549; val_best_f1_score: 0.9543; train_kl_reg_loss: 1952.8148; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124360.0310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126312.8458; train_optim_loss: 126312.8458; val_kl_reg_loss: 1932.5091; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124925.4165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126857.9255; val_optim_loss: 126857.9255
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9896; val_auprc_score: 0.9913; val_best_acc_score: 0.9548; val_best_f1_score: 0.9542; train_kl_reg_loss: 1952.5629; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124382.6469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126335.2099; train_optim_loss: 126335.2099; val_kl_reg_loss: 1934.3040; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124986.5570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126920.8610; val_optim_loss: 126920.8610
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9895; val_auprc_score: 0.9911; val_best_acc_score: 0.9546; val_best_f1_score: 0.9540; train_kl_reg_loss: 1953.2417; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124343.7458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126296.9875; train_optim_loss: 126296.9875; val_kl_reg_loss: 1942.3810; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124957.8532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126900.2342; val_optim_loss: 126900.2342
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9896; val_auprc_score: 0.9913; val_best_acc_score: 0.9547; val_best_f1_score: 0.9539; train_kl_reg_loss: 1952.1981; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124345.7400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126297.9380; train_optim_loss: 126297.9380; val_kl_reg_loss: 1935.7520; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124884.2628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126820.0149; val_optim_loss: 126820.0149
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9897; val_auprc_score: 0.9914; val_best_acc_score: 0.9551; val_best_f1_score: 0.9542; train_kl_reg_loss: 1954.2922; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124309.7737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126264.0659; train_optim_loss: 126264.0659; val_kl_reg_loss: 1930.7460; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124891.5209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126822.2669; val_optim_loss: 126822.2669
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9897; val_auprc_score: 0.9913; val_best_acc_score: 0.9551; val_best_f1_score: 0.9543; train_kl_reg_loss: 1952.5561; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124298.4315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126250.9876; train_optim_loss: 126250.9876; val_kl_reg_loss: 1933.9909; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124928.5346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126862.5252; val_optim_loss: 126862.5252
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9901; val_auprc_score: 0.9916; val_best_acc_score: 0.9556; val_best_f1_score: 0.9547; train_kl_reg_loss: 1952.4310; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124353.0678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126305.4988; train_optim_loss: 126305.4988; val_kl_reg_loss: 1927.8697; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124983.1184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126910.9881; val_optim_loss: 126910.9881
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9899; val_auprc_score: 0.9915; val_best_acc_score: 0.9551; val_best_f1_score: 0.9542; train_kl_reg_loss: 1952.7293; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124303.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126256.0777; train_optim_loss: 126256.0777; val_kl_reg_loss: 1930.5661; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124901.8199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126832.3862; val_optim_loss: 126832.3862

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9898; val_auprc_score: 0.9915; val_best_acc_score: 0.9549; val_best_f1_score: 0.9539; train_kl_reg_loss: 1951.7230; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124217.2689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126168.9918; train_optim_loss: 126168.9918; val_kl_reg_loss: 1931.6074; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124790.2033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126721.8107; val_optim_loss: 126721.8107
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9899; val_auprc_score: 0.9915; val_best_acc_score: 0.9549; val_best_f1_score: 0.9539; train_kl_reg_loss: 1951.0322; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124202.6245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126153.6567; train_optim_loss: 126153.6567; val_kl_reg_loss: 1929.1691; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124906.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126835.9661; val_optim_loss: 126835.9661
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9549; val_best_f1_score: 0.9539; train_kl_reg_loss: 1950.4791; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124215.5311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126166.0101; train_optim_loss: 126166.0101; val_kl_reg_loss: 1933.4097; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124834.5255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126767.9351; val_optim_loss: 126767.9351
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9899; val_auprc_score: 0.9913; val_best_acc_score: 0.9549; val_best_f1_score: 0.9538; train_kl_reg_loss: 1950.4953; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124156.9591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126107.4544; train_optim_loss: 126107.4544; val_kl_reg_loss: 1929.9199; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124736.6050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126666.5249; val_optim_loss: 126666.5249
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9546; val_best_f1_score: 0.9538; train_kl_reg_loss: 1951.5084; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124179.7807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126131.2893; train_optim_loss: 126131.2893; val_kl_reg_loss: 1931.1741; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124955.4469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126886.6209; val_optim_loss: 126886.6209
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9900; val_auprc_score: 0.9914; val_best_acc_score: 0.9550; val_best_f1_score: 0.9542; train_kl_reg_loss: 1950.9005; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124200.3388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126151.2393; train_optim_loss: 126151.2393; val_kl_reg_loss: 1931.2480; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124850.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126781.9666; val_optim_loss: 126781.9666
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9899; val_auprc_score: 0.9915; val_best_acc_score: 0.9545; val_best_f1_score: 0.9541; train_kl_reg_loss: 1951.3181; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124222.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126173.7453; train_optim_loss: 126173.7453; val_kl_reg_loss: 1930.7161; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124956.6999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126887.4161; val_optim_loss: 126887.4161
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9549; val_best_f1_score: 0.9542; train_kl_reg_loss: 1951.1780; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124206.8999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126158.0779; train_optim_loss: 126158.0779; val_kl_reg_loss: 1934.5699; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124928.4720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126863.0416; val_optim_loss: 126863.0416

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9901; val_auprc_score: 0.9916; val_best_acc_score: 0.9549; val_best_f1_score: 0.9548; train_kl_reg_loss: 1951.9233; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124186.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126138.0161; train_optim_loss: 126138.0161; val_kl_reg_loss: 1931.1787; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124756.6473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126687.8261; val_optim_loss: 126687.8261
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9901; val_auprc_score: 0.9917; val_best_acc_score: 0.9551; val_best_f1_score: 0.9550; train_kl_reg_loss: 1951.2652; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124183.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126135.2165; train_optim_loss: 126135.2165; val_kl_reg_loss: 1931.7974; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124814.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126746.5724; val_optim_loss: 126746.5724
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9545; train_kl_reg_loss: 1951.4015; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124173.6509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126125.0523; train_optim_loss: 126125.0523; val_kl_reg_loss: 1930.6486; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124943.9775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126874.6260; val_optim_loss: 126874.6260
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9900; val_auprc_score: 0.9916; val_best_acc_score: 0.9547; val_best_f1_score: 0.9542; train_kl_reg_loss: 1951.2988; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124204.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126155.7664; train_optim_loss: 126155.7664; val_kl_reg_loss: 1930.9569; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124830.3893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126761.3466; val_optim_loss: 126761.3466

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 805 min 50 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9899
Val AUPRC score: 0.9915
Val best accuracy score: 0.9548
Val best F1 score: 0.9538
Val gene expr MSE score: 8.2396

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
