None
Run timestamp: 05072023_223856_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '0', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1690.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1370, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1370, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1455707
Number of validation edges: 161745
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9624; val_auprc_score: 0.9677; val_best_acc_score: 0.8923; val_best_f1_score: 0.8924; train_kl_reg_loss: 3585.2323; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 136114.7867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139700.0189; train_optim_loss: 139700.0189; val_kl_reg_loss: 2445.3045; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 128610.1754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131055.4799; val_optim_loss: 131055.4799
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9658; val_auprc_score: 0.9710; val_best_acc_score: 0.8999; val_best_f1_score: 0.8976; train_kl_reg_loss: 2260.6007; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 127938.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130199.2437; train_optim_loss: 130199.2437; val_kl_reg_loss: 2075.3398; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 126474.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128550.2690; val_optim_loss: 128550.2690
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9703; val_auprc_score: 0.9751; val_best_acc_score: 0.9116; val_best_f1_score: 0.9087; train_kl_reg_loss: 2076.0694; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126605.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128681.1979; train_optim_loss: 128681.1979; val_kl_reg_loss: 2027.9073; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125857.2631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127885.1705; val_optim_loss: 127885.1705
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9747; val_auprc_score: 0.9788; val_best_acc_score: 0.9189; val_best_f1_score: 0.9178; train_kl_reg_loss: 2011.3164; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 126012.8915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128024.2079; train_optim_loss: 128024.2079; val_kl_reg_loss: 1981.2749; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125251.1168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127232.3919; val_optim_loss: 127232.3919
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9778; val_auprc_score: 0.9814; val_best_acc_score: 0.9264; val_best_f1_score: 0.9237; train_kl_reg_loss: 1983.2308; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125729.8796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127713.1104; train_optim_loss: 127713.1104; val_kl_reg_loss: 2022.7854; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125374.2458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127397.0314; val_optim_loss: 127397.0314
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9786; val_auprc_score: 0.9821; val_best_acc_score: 0.9288; val_best_f1_score: 0.9266; train_kl_reg_loss: 1969.3768; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125416.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127385.7508; train_optim_loss: 127385.7508; val_kl_reg_loss: 1882.2576; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125180.2393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127062.4968; val_optim_loss: 127062.4968
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9803; val_auprc_score: 0.9835; val_best_acc_score: 0.9315; val_best_f1_score: 0.9304; train_kl_reg_loss: 1962.6974; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125233.0262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127195.7237; train_optim_loss: 127195.7237; val_kl_reg_loss: 1911.6138; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 125177.5251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127089.1386; val_optim_loss: 127089.1386
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9820; val_auprc_score: 0.9849; val_best_acc_score: 0.9340; val_best_f1_score: 0.9336; train_kl_reg_loss: 1956.9750; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 125122.3163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127079.2912; train_optim_loss: 127079.2912; val_kl_reg_loss: 1860.6530; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124973.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126833.8893; val_optim_loss: 126833.8893
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9826; val_auprc_score: 0.9853; val_best_acc_score: 0.9355; val_best_f1_score: 0.9352; train_kl_reg_loss: 1955.4343; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124980.5201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126935.9544; train_optim_loss: 126935.9544; val_kl_reg_loss: 1983.7007; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124933.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126917.1094; val_optim_loss: 126917.1094
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9814; val_auprc_score: 0.9845; val_best_acc_score: 0.9357; val_best_f1_score: 0.9336; train_kl_reg_loss: 1957.1460; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124871.4203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126828.5664; train_optim_loss: 126828.5664; val_kl_reg_loss: 1977.2421; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124775.3232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126752.5655; val_optim_loss: 126752.5655
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9831; val_auprc_score: 0.9858; val_best_acc_score: 0.9376; val_best_f1_score: 0.9354; train_kl_reg_loss: 1955.7005; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124775.6676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126731.3681; train_optim_loss: 126731.3681; val_kl_reg_loss: 1935.5645; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124818.3069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126753.8714; val_optim_loss: 126753.8714
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9842; val_auprc_score: 0.9868; val_best_acc_score: 0.9410; val_best_f1_score: 0.9398; train_kl_reg_loss: 1954.8831; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124705.0207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126659.9038; train_optim_loss: 126659.9038; val_kl_reg_loss: 1927.7953; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124815.8688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126743.6642; val_optim_loss: 126743.6642
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9877; val_best_acc_score: 0.9431; val_best_f1_score: 0.9413; train_kl_reg_loss: 1955.1006; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124621.0981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126576.1986; train_optim_loss: 126576.1986; val_kl_reg_loss: 1927.8095; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124546.7936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126474.6031; val_optim_loss: 126474.6031
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9854; val_auprc_score: 0.9877; val_best_acc_score: 0.9428; val_best_f1_score: 0.9424; train_kl_reg_loss: 1955.0857; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124510.4466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126465.5323; train_optim_loss: 126465.5323; val_kl_reg_loss: 1917.6843; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124671.7196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126589.4038; val_optim_loss: 126589.4038
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9855; val_auprc_score: 0.9877; val_best_acc_score: 0.9443; val_best_f1_score: 0.9434; train_kl_reg_loss: 1957.2885; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124508.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126465.3620; train_optim_loss: 126465.3620; val_kl_reg_loss: 1931.4713; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124670.8847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126602.3559; val_optim_loss: 126602.3559
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9868; val_auprc_score: 0.9889; val_best_acc_score: 0.9474; val_best_f1_score: 0.9462; train_kl_reg_loss: 1958.5958; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124457.7452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126416.3410; train_optim_loss: 126416.3410; val_kl_reg_loss: 1950.8492; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124753.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126704.6486; val_optim_loss: 126704.6486
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9851; val_auprc_score: 0.9874; val_best_acc_score: 0.9428; val_best_f1_score: 0.9411; train_kl_reg_loss: 1959.1292; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 124459.0626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126418.1919; train_optim_loss: 126418.1919; val_kl_reg_loss: 1938.1198; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124712.9230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126651.0426; val_optim_loss: 126651.0426

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9886; val_auprc_score: 0.9904; val_best_acc_score: 0.9504; val_best_f1_score: 0.9502; train_kl_reg_loss: 1948.7441; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123606.3757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125555.1197; train_optim_loss: 125555.1197; val_kl_reg_loss: 1928.0778; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124120.9369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126049.0146; val_optim_loss: 126049.0146
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9886; val_auprc_score: 0.9904; val_best_acc_score: 0.9513; val_best_f1_score: 0.9508; train_kl_reg_loss: 1946.8025; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123537.7902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125484.5926; train_optim_loss: 125484.5926; val_kl_reg_loss: 1939.8937; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124161.8544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126101.7482; val_optim_loss: 126101.7482
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9905; val_best_acc_score: 0.9526; val_best_f1_score: 0.9519; train_kl_reg_loss: 1948.4590; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123499.3028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125447.7618; train_optim_loss: 125447.7618; val_kl_reg_loss: 1934.5795; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124015.0669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125949.6464; val_optim_loss: 125949.6464
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9892; val_auprc_score: 0.9909; val_best_acc_score: 0.9536; val_best_f1_score: 0.9529; train_kl_reg_loss: 1949.6326; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123434.9404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125384.5730; train_optim_loss: 125384.5730; val_kl_reg_loss: 1938.2537; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124018.5338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125956.7874; val_optim_loss: 125956.7874
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9893; val_auprc_score: 0.9909; val_best_acc_score: 0.9535; val_best_f1_score: 0.9526; train_kl_reg_loss: 1948.5265; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123386.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125334.6800; train_optim_loss: 125334.6800; val_kl_reg_loss: 1934.4468; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124019.6881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125954.1350; val_optim_loss: 125954.1350
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9895; val_auprc_score: 0.9911; val_best_acc_score: 0.9538; val_best_f1_score: 0.9527; train_kl_reg_loss: 1950.4813; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123413.7781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125364.2594; train_optim_loss: 125364.2594; val_kl_reg_loss: 1927.9775; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123974.7403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125902.7179; val_optim_loss: 125902.7179
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9896; val_auprc_score: 0.9911; val_best_acc_score: 0.9538; val_best_f1_score: 0.9530; train_kl_reg_loss: 1949.7303; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123387.4248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125337.1551; train_optim_loss: 125337.1551; val_kl_reg_loss: 1929.7438; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124043.8665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125973.6103; val_optim_loss: 125973.6103
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9897; val_auprc_score: 0.9913; val_best_acc_score: 0.9537; val_best_f1_score: 0.9534; train_kl_reg_loss: 1950.9845; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123351.5186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125302.5031; train_optim_loss: 125302.5031; val_kl_reg_loss: 1931.8522; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123966.8515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125898.7037; val_optim_loss: 125898.7037
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9899; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9545; train_kl_reg_loss: 1950.8846; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123351.2111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125302.0957; train_optim_loss: 125302.0957; val_kl_reg_loss: 1937.0381; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123836.9560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125773.9944; val_optim_loss: 125773.9944
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9897; val_auprc_score: 0.9912; val_best_acc_score: 0.9538; val_best_f1_score: 0.9536; train_kl_reg_loss: 1951.5263; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123333.1363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125284.6626; train_optim_loss: 125284.6626; val_kl_reg_loss: 1936.5758; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123691.5350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125628.1108; val_optim_loss: 125628.1108
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9895; val_auprc_score: 0.9910; val_best_acc_score: 0.9537; val_best_f1_score: 0.9534; train_kl_reg_loss: 1951.4964; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123319.7854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125271.2817; train_optim_loss: 125271.2817; val_kl_reg_loss: 1932.2844; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123789.9320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125722.2164; val_optim_loss: 125722.2164
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9551; val_best_f1_score: 0.9547; train_kl_reg_loss: 1951.3886; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123314.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125265.6204; train_optim_loss: 125265.6204; val_kl_reg_loss: 1926.2849; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123741.8595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125668.1443; val_optim_loss: 125668.1443
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9896; val_auprc_score: 0.9912; val_best_acc_score: 0.9544; val_best_f1_score: 0.9540; train_kl_reg_loss: 1951.9263; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123286.2390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125238.1653; train_optim_loss: 125238.1653; val_kl_reg_loss: 1927.7360; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123710.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125638.3748; val_optim_loss: 125638.3748
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9555; val_best_f1_score: 0.9550; train_kl_reg_loss: 1952.4258; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123299.8927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125252.3185; train_optim_loss: 125252.3185; val_kl_reg_loss: 1947.0870; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 124034.8883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125981.9754; val_optim_loss: 125981.9754

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9900; val_auprc_score: 0.9915; val_best_acc_score: 0.9553; val_best_f1_score: 0.9548; train_kl_reg_loss: 1952.6753; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123162.2854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125114.9606; train_optim_loss: 125114.9606; val_kl_reg_loss: 1937.8508; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123900.0253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125837.8760; val_optim_loss: 125837.8760
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9901; val_auprc_score: 0.9917; val_best_acc_score: 0.9559; val_best_f1_score: 0.9553; train_kl_reg_loss: 1951.6387; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123165.0077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125116.6465; train_optim_loss: 125116.6465; val_kl_reg_loss: 1937.6788; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123831.4053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125769.0842; val_optim_loss: 125769.0842
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9901; val_auprc_score: 0.9915; val_best_acc_score: 0.9559; val_best_f1_score: 0.9553; train_kl_reg_loss: 1952.3726; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123186.3491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125138.7217; train_optim_loss: 125138.7217; val_kl_reg_loss: 1934.6818; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123864.2825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125798.9643; val_optim_loss: 125798.9643
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9901; val_auprc_score: 0.9916; val_best_acc_score: 0.9561; val_best_f1_score: 0.9554; train_kl_reg_loss: 1951.7040; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123154.1273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125105.8313; train_optim_loss: 125105.8313; val_kl_reg_loss: 1934.8923; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123676.2716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125611.1638; val_optim_loss: 125611.1638
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9901; val_auprc_score: 0.9917; val_best_acc_score: 0.9559; val_best_f1_score: 0.9553; train_kl_reg_loss: 1952.0361; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123152.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125104.3506; train_optim_loss: 125104.3506; val_kl_reg_loss: 1934.3341; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123796.0289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125730.3631; val_optim_loss: 125730.3631
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9562; val_best_f1_score: 0.9556; train_kl_reg_loss: 1952.5825; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123132.8312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125085.4136; train_optim_loss: 125085.4136; val_kl_reg_loss: 1935.3012; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123807.3305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125742.6316; val_optim_loss: 125742.6316
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9559; val_best_f1_score: 0.9552; train_kl_reg_loss: 1951.6325; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123082.6822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125034.3146; train_optim_loss: 125034.3146; val_kl_reg_loss: 1932.7857; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123580.2077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125512.9934; val_optim_loss: 125512.9934
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9902; val_auprc_score: 0.9916; val_best_acc_score: 0.9560; val_best_f1_score: 0.9554; train_kl_reg_loss: 1951.5263; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123064.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125015.7562; train_optim_loss: 125015.7562; val_kl_reg_loss: 1939.7407; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123798.1173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125737.8584; val_optim_loss: 125737.8584
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9561; val_best_f1_score: 0.9554; train_kl_reg_loss: 1951.9411; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123097.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125049.7939; train_optim_loss: 125049.7939; val_kl_reg_loss: 1935.9887; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123747.6011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125683.5898; val_optim_loss: 125683.5898
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9903; val_auprc_score: 0.9916; val_best_acc_score: 0.9565; val_best_f1_score: 0.9558; train_kl_reg_loss: 1952.5453; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123152.6376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125105.1830; train_optim_loss: 125105.1830; val_kl_reg_loss: 1931.9440; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123832.6189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125764.5630; val_optim_loss: 125764.5630
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9904; val_auprc_score: 0.9918; val_best_acc_score: 0.9565; val_best_f1_score: 0.9558; train_kl_reg_loss: 1951.8238; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123112.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125064.6165; train_optim_loss: 125064.6165; val_kl_reg_loss: 1931.9868; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123590.1828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125522.1696; val_optim_loss: 125522.1696

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9560; val_best_f1_score: 0.9553; train_kl_reg_loss: 1951.4208; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123036.9991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124988.4200; train_optim_loss: 124988.4200; val_kl_reg_loss: 1933.3903; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123588.2572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125521.6476; val_optim_loss: 125521.6476
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9903; val_auprc_score: 0.9918; val_best_acc_score: 0.9564; val_best_f1_score: 0.9556; train_kl_reg_loss: 1951.5574; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123035.5348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124987.0922; train_optim_loss: 124987.0922; val_kl_reg_loss: 1934.1258; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123798.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125732.9263; val_optim_loss: 125732.9263
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9560; val_best_f1_score: 0.9553; train_kl_reg_loss: 1952.1714; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123003.9798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124956.1512; train_optim_loss: 124956.1512; val_kl_reg_loss: 1934.8108; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123780.5647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125715.3754; val_optim_loss: 125715.3754
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9902; val_auprc_score: 0.9917; val_best_acc_score: 0.9561; val_best_f1_score: 0.9553; train_kl_reg_loss: 1952.5827; train_edge_recon_loss: 0.0000; train_gene_expr_recon_loss: 123057.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125009.7337; train_optim_loss: 125009.7337; val_kl_reg_loss: 1934.4570; val_edge_recon_loss: 0.0000; val_gene_expr_recon_loss: 123731.4067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125665.8637; val_optim_loss: 125665.8637

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 819 min 39 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9902
Val AUPRC score: 0.9915
Val best accuracy score: 0.9563
Val best F1 score: 0.9557
Val gene expr MSE score: 8.4411

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
