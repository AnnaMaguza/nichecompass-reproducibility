None
Run timestamp: 05072023_134355_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1692.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1386, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1386, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9942; val_auprc_score: 0.9940; val_best_acc_score: 0.9628; val_best_f1_score: 0.9629; train_kl_reg_loss: 7847.1621; train_edge_recon_loss: 268774.3142; train_gene_expr_recon_loss: 142850.8149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419472.2910; train_optim_loss: 419472.2910; val_kl_reg_loss: 7138.7166; val_edge_recon_loss: 263538.7259; val_gene_expr_recon_loss: 133610.6938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404288.1366; val_optim_loss: 404288.1366
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9964; val_auprc_score: 0.9961; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 6949.5074; train_edge_recon_loss: 262649.9259; train_gene_expr_recon_loss: 132382.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401982.0627; train_optim_loss: 401982.0627; val_kl_reg_loss: 6757.6027; val_edge_recon_loss: 261830.9994; val_gene_expr_recon_loss: 131206.2638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399794.8664; val_optim_loss: 399794.8664
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9969; val_auprc_score: 0.9966; val_best_acc_score: 0.9748; val_best_f1_score: 0.9749; train_kl_reg_loss: 6704.0506; train_edge_recon_loss: 261277.0459; train_gene_expr_recon_loss: 130965.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398946.6624; train_optim_loss: 398946.6624; val_kl_reg_loss: 6525.1649; val_edge_recon_loss: 260664.1641; val_gene_expr_recon_loss: 129717.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396906.6980; val_optim_loss: 396906.6980
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9974; val_auprc_score: 0.9971; val_best_acc_score: 0.9772; val_best_f1_score: 0.9773; train_kl_reg_loss: 6612.2278; train_edge_recon_loss: 260548.0449; train_gene_expr_recon_loss: 129979.7003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397139.9728; train_optim_loss: 397139.9728; val_kl_reg_loss: 6593.6568; val_edge_recon_loss: 260334.2317; val_gene_expr_recon_loss: 130217.9263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397145.8157; val_optim_loss: 397145.8157
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9788; val_best_f1_score: 0.9789; train_kl_reg_loss: 6569.1637; train_edge_recon_loss: 260134.7327; train_gene_expr_recon_loss: 125728.9158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392432.8122; train_optim_loss: 392432.8122; val_kl_reg_loss: 6546.8063; val_edge_recon_loss: 259885.4807; val_gene_expr_recon_loss: 130792.1130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397224.4002; val_optim_loss: 397224.4002
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 6550.1404; train_edge_recon_loss: 259780.5969; train_gene_expr_recon_loss: 115300.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381631.2937; train_optim_loss: 381631.2937; val_kl_reg_loss: 6533.2276; val_edge_recon_loss: 259435.2432; val_gene_expr_recon_loss: 111795.1309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377763.6017; val_optim_loss: 377763.6017
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 6536.5942; train_edge_recon_loss: 259567.8563; train_gene_expr_recon_loss: 109926.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376031.1516; train_optim_loss: 376031.1516; val_kl_reg_loss: 6571.6225; val_edge_recon_loss: 259342.2208; val_gene_expr_recon_loss: 109755.3395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375669.1830; val_optim_loss: 375669.1830
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 6528.0946; train_edge_recon_loss: 259337.9188; train_gene_expr_recon_loss: 109559.0168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375425.0302; train_optim_loss: 375425.0302; val_kl_reg_loss: 6516.8206; val_edge_recon_loss: 259181.1245; val_gene_expr_recon_loss: 109236.6530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374934.5986; val_optim_loss: 374934.5986
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9981; val_auprc_score: 0.9979; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 6517.9251; train_edge_recon_loss: 259159.3762; train_gene_expr_recon_loss: 108943.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374620.9055; train_optim_loss: 374620.9055; val_kl_reg_loss: 6388.4901; val_edge_recon_loss: 258933.1569; val_gene_expr_recon_loss: 108990.8475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374312.4954; val_optim_loss: 374312.4954
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 6512.8856; train_edge_recon_loss: 259111.0542; train_gene_expr_recon_loss: 108830.1498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374454.0895; train_optim_loss: 374454.0895; val_kl_reg_loss: 6492.6140; val_edge_recon_loss: 258725.5951; val_gene_expr_recon_loss: 108890.4554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374108.6643; val_optim_loss: 374108.6643
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 6511.6000; train_edge_recon_loss: 258968.0646; train_gene_expr_recon_loss: 108728.3818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374208.0461; train_optim_loss: 374208.0461; val_kl_reg_loss: 6449.1308; val_edge_recon_loss: 258573.7570; val_gene_expr_recon_loss: 108890.4944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373913.3813; val_optim_loss: 373913.3813
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9842; val_best_f1_score: 0.9842; train_kl_reg_loss: 6509.6887; train_edge_recon_loss: 258889.0248; train_gene_expr_recon_loss: 108678.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374077.0207; train_optim_loss: 374077.0207; val_kl_reg_loss: 6456.9240; val_edge_recon_loss: 258756.5394; val_gene_expr_recon_loss: 108904.7223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374118.1844; val_optim_loss: 374118.1844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9983; val_best_acc_score: 0.9844; val_best_f1_score: 0.9844; train_kl_reg_loss: 6510.6237; train_edge_recon_loss: 258726.9265; train_gene_expr_recon_loss: 108625.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373863.2899; train_optim_loss: 373863.2899; val_kl_reg_loss: 6499.0836; val_edge_recon_loss: 258424.9923; val_gene_expr_recon_loss: 108845.0711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373769.1464; val_optim_loss: 373769.1464
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 6509.9738; train_edge_recon_loss: 258659.3191; train_gene_expr_recon_loss: 108579.7507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373749.0436; train_optim_loss: 373749.0436; val_kl_reg_loss: 6569.1905; val_edge_recon_loss: 258409.8307; val_gene_expr_recon_loss: 108791.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373770.7942; val_optim_loss: 373770.7942
