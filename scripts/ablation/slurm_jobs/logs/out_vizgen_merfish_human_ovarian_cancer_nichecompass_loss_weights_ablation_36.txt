Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 6503.7621; train_edge_recon_loss: 257255.2878; train_gene_expr_recon_loss: 105406.8511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369165.9006; train_optim_loss: 369165.9006; val_kl_reg_loss: 6493.9974; val_edge_recon_loss: 256924.6925; val_gene_expr_recon_loss: 106044.0499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369462.7390; val_optim_loss: 369462.7390
None
Run timestamp: 07072023_075651_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch2', '--n_neighbors', '16', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'loss_weights_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 1385, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1385, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 210667
Number of validation nodes: 23407
Number of training edges: 1931624
Number of validation edges: 214624
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9942; val_auprc_score: 0.9938; val_best_acc_score: 0.9628; val_best_f1_score: 0.9629; train_kl_reg_loss: 8022.4023; train_edge_recon_loss: 269092.0299; train_gene_expr_recon_loss: 142957.0708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420071.5033; train_optim_loss: 420071.5033; val_kl_reg_loss: 7204.9557; val_edge_recon_loss: 264221.7467; val_gene_expr_recon_loss: 133888.0497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405314.7523; val_optim_loss: 405314.7523
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6498.6140; train_edge_recon_loss: 257234.1996; train_gene_expr_recon_loss: 105376.2697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369109.0839; train_optim_loss: 369109.0839; val_kl_reg_loss: 6470.1727; val_edge_recon_loss: 256779.9792; val_gene_expr_recon_loss: 106002.4782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369252.6305; val_optim_loss: 369252.6305
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9962; val_auprc_score: 0.9960; val_best_acc_score: 0.9714; val_best_f1_score: 0.9715; train_kl_reg_loss: 6951.3917; train_edge_recon_loss: 262674.3495; train_gene_expr_recon_loss: 132583.5401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402209.2809; train_optim_loss: 402209.2809; val_kl_reg_loss: 6668.1813; val_edge_recon_loss: 261661.9347; val_gene_expr_recon_loss: 131659.5279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399989.6444; val_optim_loss: 399989.6444
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6494.2730; train_edge_recon_loss: 257262.1611; train_gene_expr_recon_loss: 105358.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369115.1344; train_optim_loss: 369115.1344; val_kl_reg_loss: 6466.8964; val_edge_recon_loss: 256812.7073; val_gene_expr_recon_loss: 106011.5490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369291.1525; val_optim_loss: 369291.1525
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 6672.6121; train_edge_recon_loss: 261322.8282; train_gene_expr_recon_loss: 131227.0751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399222.5153; train_optim_loss: 399222.5153; val_kl_reg_loss: 6592.5941; val_edge_recon_loss: 260794.5715; val_gene_expr_recon_loss: 133467.9841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400855.1492; val_optim_loss: 400855.1492
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 6495.0506; train_edge_recon_loss: 257217.0110; train_gene_expr_recon_loss: 105336.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369048.3753; train_optim_loss: 369048.3753; val_kl_reg_loss: 6484.2583; val_edge_recon_loss: 256802.0016; val_gene_expr_recon_loss: 106003.0101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369289.2692; val_optim_loss: 369289.2692
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9972; val_auprc_score: 0.9969; val_best_acc_score: 0.9758; val_best_f1_score: 0.9759; train_kl_reg_loss: 6579.0832; train_edge_recon_loss: 260601.1072; train_gene_expr_recon_loss: 130136.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397317.0426; train_optim_loss: 397317.0426; val_kl_reg_loss: 6475.7638; val_edge_recon_loss: 260464.6120; val_gene_expr_recon_loss: 129819.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396759.8402; val_optim_loss: 396759.8402
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9976; val_auprc_score: 0.9974; val_best_acc_score: 0.9780; val_best_f1_score: 0.9780; train_kl_reg_loss: 6550.4257; train_edge_recon_loss: 260140.6343; train_gene_expr_recon_loss: 126036.3514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392727.4109; train_optim_loss: 392727.4109; val_kl_reg_loss: 6607.9207; val_edge_recon_loss: 259816.4443; val_gene_expr_recon_loss: 124331.5298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390755.8943; val_optim_loss: 390755.8943
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6490.3343; train_edge_recon_loss: 257199.7608; train_gene_expr_recon_loss: 105328.0518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369018.1470; train_optim_loss: 369018.1470; val_kl_reg_loss: 6469.9783; val_edge_recon_loss: 256855.9002; val_gene_expr_recon_loss: 106027.7591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369353.6362; val_optim_loss: 369353.6362
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9978; val_auprc_score: 0.9974; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 6536.1544; train_edge_recon_loss: 259834.4706; train_gene_expr_recon_loss: 115330.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381701.6007; train_optim_loss: 381701.6007; val_kl_reg_loss: 6410.4872; val_edge_recon_loss: 259409.1158; val_gene_expr_recon_loss: 109932.0141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375751.6169; val_optim_loss: 375751.6169
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 6490.0006; train_edge_recon_loss: 257203.1127; train_gene_expr_recon_loss: 105317.6590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369010.7725; train_optim_loss: 369010.7725; val_kl_reg_loss: 6456.6320; val_edge_recon_loss: 256864.5028; val_gene_expr_recon_loss: 105964.4902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369285.6249; val_optim_loss: 369285.6249
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9978; val_auprc_score: 0.9975; val_best_acc_score: 0.9795; val_best_f1_score: 0.9796; train_kl_reg_loss: 6524.6663; train_edge_recon_loss: 259608.7745; train_gene_expr_recon_loss: 109728.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375861.6389; train_optim_loss: 375861.6389; val_kl_reg_loss: 6383.2718; val_edge_recon_loss: 259360.8222; val_gene_expr_recon_loss: 110024.5211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375768.6148; val_optim_loss: 375768.6148

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 6491.4792; train_edge_recon_loss: 257149.1374; train_gene_expr_recon_loss: 105236.2501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368876.8667; train_optim_loss: 368876.8667; val_kl_reg_loss: 6489.7574; val_edge_recon_loss: 256752.4956; val_gene_expr_recon_loss: 105941.7524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369184.0053; val_optim_loss: 369184.0053
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9980; val_auprc_score: 0.9977; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 6522.7577; train_edge_recon_loss: 259354.3924; train_gene_expr_recon_loss: 109276.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375153.9787; train_optim_loss: 375153.9787; val_kl_reg_loss: 6628.0117; val_edge_recon_loss: 259056.5406; val_gene_expr_recon_loss: 109183.4203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374867.9720; val_optim_loss: 374867.9720
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 6496.3733; train_edge_recon_loss: 257196.5900; train_gene_expr_recon_loss: 105221.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368914.0296; train_optim_loss: 368914.0296; val_kl_reg_loss: 6486.4181; val_edge_recon_loss: 256722.8792; val_gene_expr_recon_loss: 105942.6513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369151.9492; val_optim_loss: 369151.9492
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 6514.0645; train_edge_recon_loss: 259246.6107; train_gene_expr_recon_loss: 108937.8696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374698.5448; train_optim_loss: 374698.5448; val_kl_reg_loss: 6430.1752; val_edge_recon_loss: 258876.2596; val_gene_expr_recon_loss: 109053.7403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374360.1750; val_optim_loss: 374360.1750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9981; val_auprc_score: 0.9978; val_best_acc_score: 0.9820; val_best_f1_score: 0.9820; train_kl_reg_loss: 6515.6123; train_edge_recon_loss: 259062.6668; train_gene_expr_recon_loss: 108853.4099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374431.6890; train_optim_loss: 374431.6890; val_kl_reg_loss: 6435.7866; val_edge_recon_loss: 258801.8208; val_gene_expr_recon_loss: 109043.6811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374281.2891; val_optim_loss: 374281.2891
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 6494.6205; train_edge_recon_loss: 257166.2356; train_gene_expr_recon_loss: 105230.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368891.3899; train_optim_loss: 368891.3899; val_kl_reg_loss: 6484.0350; val_edge_recon_loss: 256760.9041; val_gene_expr_recon_loss: 105935.7177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369180.6569; val_optim_loss: 369180.6569
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 6514.2575; train_edge_recon_loss: 258917.7749; train_gene_expr_recon_loss: 108794.2737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374226.3058; train_optim_loss: 374226.3058; val_kl_reg_loss: 6358.5014; val_edge_recon_loss: 258735.4003; val_gene_expr_recon_loss: 108923.4732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374017.3751; val_optim_loss: 374017.3751
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 6495.9568; train_edge_recon_loss: 257131.9049; train_gene_expr_recon_loss: 105217.7516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368845.6135; train_optim_loss: 368845.6135; val_kl_reg_loss: 6478.2032; val_edge_recon_loss: 256729.9655; val_gene_expr_recon_loss: 105924.0620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369132.2307; val_optim_loss: 369132.2307
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9835; val_best_f1_score: 0.9835; train_kl_reg_loss: 6511.7870; train_edge_recon_loss: 258810.8546; train_gene_expr_recon_loss: 108652.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373974.8141; train_optim_loss: 373974.8141; val_kl_reg_loss: 6659.0199; val_edge_recon_loss: 258594.1732; val_gene_expr_recon_loss: 109139.9941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374393.1874; val_optim_loss: 374393.1874
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 6494.5608; train_edge_recon_loss: 257149.9495; train_gene_expr_recon_loss: 105220.5544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368865.0645; train_optim_loss: 368865.0645; val_kl_reg_loss: 6485.2453; val_edge_recon_loss: 256840.6206; val_gene_expr_recon_loss: 105937.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369263.3983; val_optim_loss: 369263.3983
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9982; val_auprc_score: 0.9980; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 6509.3383; train_edge_recon_loss: 258747.0723; train_gene_expr_recon_loss: 108486.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373742.5846; train_optim_loss: 373742.5846; val_kl_reg_loss: 6404.7649; val_edge_recon_loss: 258498.7103; val_gene_expr_recon_loss: 108678.1496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373581.6250; val_optim_loss: 373581.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9983; val_auprc_score: 0.9981; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 6510.3042; train_edge_recon_loss: 258653.6876; train_gene_expr_recon_loss: 108475.2507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373639.2424; train_optim_loss: 373639.2424; val_kl_reg_loss: 6533.0064; val_edge_recon_loss: 258378.5354; val_gene_expr_recon_loss: 108456.1613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373367.7019; val_optim_loss: 373367.7019
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9989; val_auprc_score: 0.9985; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 6494.5493; train_edge_recon_loss: 257146.7958; train_gene_expr_recon_loss: 105223.4711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368864.8163; train_optim_loss: 368864.8163; val_kl_reg_loss: 6475.5759; val_edge_recon_loss: 256911.8913; val_gene_expr_recon_loss: 105967.5380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369355.0059; val_optim_loss: 369355.0059
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9835; val_best_f1_score: 0.9835; train_kl_reg_loss: 6508.1969; train_edge_recon_loss: 258609.4757; train_gene_expr_recon_loss: 108140.6496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373258.3223; train_optim_loss: 373258.3223; val_kl_reg_loss: 6520.2513; val_edge_recon_loss: 258355.9157; val_gene_expr_recon_loss: 108582.3589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373458.5260; val_optim_loss: 373458.5260
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6492.9176; train_edge_recon_loss: 257149.8613; train_gene_expr_recon_loss: 105214.0168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368856.7956; train_optim_loss: 368856.7956; val_kl_reg_loss: 6481.2530; val_edge_recon_loss: 256760.3216; val_gene_expr_recon_loss: 105961.5435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369203.1185; val_optim_loss: 369203.1185
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9846; val_best_f1_score: 0.9846; train_kl_reg_loss: 6508.1543; train_edge_recon_loss: 258523.8665; train_gene_expr_recon_loss: 108030.4843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373062.5053; train_optim_loss: 373062.5053; val_kl_reg_loss: 6542.9070; val_edge_recon_loss: 258286.5369; val_gene_expr_recon_loss: 108287.1670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373116.6116; val_optim_loss: 373116.6116
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 6493.6765; train_edge_recon_loss: 257103.0105; train_gene_expr_recon_loss: 105211.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368808.0927; train_optim_loss: 368808.0927; val_kl_reg_loss: 6482.2237; val_edge_recon_loss: 256842.5797; val_gene_expr_recon_loss: 105939.7335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369264.5370; val_optim_loss: 369264.5370
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 6506.8087; train_edge_recon_loss: 258524.5403; train_gene_expr_recon_loss: 108006.3799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373037.7290; train_optim_loss: 373037.7290; val_kl_reg_loss: 6494.4452; val_edge_recon_loss: 258123.7516; val_gene_expr_recon_loss: 107674.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372293.1064; val_optim_loss: 372293.1064

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 6494.7769; train_edge_recon_loss: 257168.7444; train_gene_expr_recon_loss: 105199.6286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368863.1496; train_optim_loss: 368863.1496; val_kl_reg_loss: 6484.3532; val_edge_recon_loss: 256664.0757; val_gene_expr_recon_loss: 105941.9921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369090.4214; val_optim_loss: 369090.4214
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 6508.1853; train_edge_recon_loss: 258377.8321; train_gene_expr_recon_loss: 107835.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372721.2911; train_optim_loss: 372721.2911; val_kl_reg_loss: 6617.2795; val_edge_recon_loss: 258317.1180; val_gene_expr_recon_loss: 108141.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373075.8350; val_optim_loss: 373075.8350
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 6508.1104; train_edge_recon_loss: 258357.7379; train_gene_expr_recon_loss: 107801.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372667.3049; train_optim_loss: 372667.3049; val_kl_reg_loss: 6462.7292; val_edge_recon_loss: 258050.0213; val_gene_expr_recon_loss: 108163.7842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372676.5347; val_optim_loss: 372676.5347
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6494.5454; train_edge_recon_loss: 257164.8750; train_gene_expr_recon_loss: 105206.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368865.8702; train_optim_loss: 368865.8702; val_kl_reg_loss: 6484.4370; val_edge_recon_loss: 256848.9020; val_gene_expr_recon_loss: 105917.7006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369251.0400; val_optim_loss: 369251.0400
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9984; val_auprc_score: 0.9982; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 6507.3722; train_edge_recon_loss: 258287.8066; train_gene_expr_recon_loss: 107742.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372538.1660; train_optim_loss: 372538.1660; val_kl_reg_loss: 6489.9653; val_edge_recon_loss: 258192.5839; val_gene_expr_recon_loss: 108045.2282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372727.7772; val_optim_loss: 372727.7772
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9990; val_auprc_score: 0.9988; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6493.9059; train_edge_recon_loss: 257195.3825; train_gene_expr_recon_loss: 105198.7375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368888.0260; train_optim_loss: 368888.0260; val_kl_reg_loss: 6480.3724; val_edge_recon_loss: 256617.2230; val_gene_expr_recon_loss: 105926.1390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369023.7344; val_optim_loss: 369023.7344
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9854; val_best_f1_score: 0.9854; train_kl_reg_loss: 6507.7805; train_edge_recon_loss: 258220.5988; train_gene_expr_recon_loss: 107600.1850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372328.5641; train_optim_loss: 372328.5641; val_kl_reg_loss: 6578.1134; val_edge_recon_loss: 257879.0085; val_gene_expr_recon_loss: 107892.5696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372349.6910; val_optim_loss: 372349.6910
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6493.7671; train_edge_recon_loss: 257136.6327; train_gene_expr_recon_loss: 105200.8445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368831.2444; train_optim_loss: 368831.2444; val_kl_reg_loss: 6482.2887; val_edge_recon_loss: 256713.0576; val_gene_expr_recon_loss: 105963.4218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369158.7686; val_optim_loss: 369158.7686

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9987; val_auprc_score: 0.9984; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 6573.0180; train_edge_recon_loss: 257871.4689; train_gene_expr_recon_loss: 106925.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371370.4474; train_optim_loss: 371370.4474; val_kl_reg_loss: 6526.4541; val_edge_recon_loss: 257554.9219; val_gene_expr_recon_loss: 107405.4725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371486.8494; val_optim_loss: 371486.8494
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9990; val_auprc_score: 0.9987; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 6494.0516; train_edge_recon_loss: 257180.9348; train_gene_expr_recon_loss: 105196.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368871.4233; train_optim_loss: 368871.4233; val_kl_reg_loss: 6481.5581; val_edge_recon_loss: 256903.0212; val_gene_expr_recon_loss: 105933.9579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369318.5366; val_optim_loss: 369318.5366
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 6558.2461; train_edge_recon_loss: 257840.0497; train_gene_expr_recon_loss: 106809.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371207.3768; train_optim_loss: 371207.3768; val_kl_reg_loss: 6529.5782; val_edge_recon_loss: 257632.1612; val_gene_expr_recon_loss: 107399.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371561.1281; val_optim_loss: 371561.1281
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9868; val_best_f1_score: 0.9868; train_kl_reg_loss: 6545.7527; train_edge_recon_loss: 257868.2779; train_gene_expr_recon_loss: 106776.6463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371190.6769; train_optim_loss: 371190.6769; val_kl_reg_loss: 6545.7534; val_edge_recon_loss: 257484.3387; val_gene_expr_recon_loss: 107350.1514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371380.2431; val_optim_loss: 371380.2431
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 6493.4412; train_edge_recon_loss: 257168.5896; train_gene_expr_recon_loss: 105205.0668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368867.0973; train_optim_loss: 368867.0973; val_kl_reg_loss: 6482.9527; val_edge_recon_loss: 256738.8511; val_gene_expr_recon_loss: 105935.8018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369157.6060; val_optim_loss: 369157.6060
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9871; val_best_f1_score: 0.9871; train_kl_reg_loss: 6543.2968; train_edge_recon_loss: 257854.1642; train_gene_expr_recon_loss: 106742.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371140.2375; train_optim_loss: 371140.2375; val_kl_reg_loss: 6480.3826; val_edge_recon_loss: 257600.1774; val_gene_expr_recon_loss: 107358.2150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371438.7745; val_optim_loss: 371438.7745
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 6493.6952; train_edge_recon_loss: 257128.4492; train_gene_expr_recon_loss: 105200.4616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368822.6057; train_optim_loss: 368822.6057; val_kl_reg_loss: 6482.0652; val_edge_recon_loss: 256675.9344; val_gene_expr_recon_loss: 105934.0827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369092.0823; val_optim_loss: 369092.0823
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9871; val_best_f1_score: 0.9871; train_kl_reg_loss: 6535.5381; train_edge_recon_loss: 257851.1335; train_gene_expr_recon_loss: 106725.9536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371112.6252; train_optim_loss: 371112.6252; val_kl_reg_loss: 6478.4721; val_edge_recon_loss: 257526.9730; val_gene_expr_recon_loss: 107334.1894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371339.6346; val_optim_loss: 371339.6346

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9989; val_auprc_score: 0.9986; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 6493.8468; train_edge_recon_loss: 257112.8565; train_gene_expr_recon_loss: 105207.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368813.7327; train_optim_loss: 368813.7327; val_kl_reg_loss: 6482.1013; val_edge_recon_loss: 256737.3044; val_gene_expr_recon_loss: 105926.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369145.4494; val_optim_loss: 369145.4494
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9988; val_auprc_score: 0.9987; val_best_acc_score: 0.9873; val_best_f1_score: 0.9873; train_kl_reg_loss: 6535.1584; train_edge_recon_loss: 257845.9006; train_gene_expr_recon_loss: 106718.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371099.6560; train_optim_loss: 371099.6560; val_kl_reg_loss: 6504.0246; val_edge_recon_loss: 257569.3497; val_gene_expr_recon_loss: 107309.3121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371382.6877; val_optim_loss: 371382.6877
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9989; val_auprc_score: 0.9987; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 6493.7185; train_edge_recon_loss: 257132.3114; train_gene_expr_recon_loss: 105202.4463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368828.4761; train_optim_loss: 368828.4761; val_kl_reg_loss: 6481.6835; val_edge_recon_loss: 256835.4866; val_gene_expr_recon_loss: 105926.0251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369243.1953; val_optim_loss: 369243.1953
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9988; val_auprc_score: 0.9986; val_best_acc_score: 0.9874; val_best_f1_score: 0.9874; train_kl_reg_loss: 6535.0306; train_edge_recon_loss: 257784.7728; train_gene_expr_recon_loss: 106698.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371017.8868; train_optim_loss: 371017.8868; val_kl_reg_loss: 6529.3363; val_edge_recon_loss: 257459.5990; val_gene_expr_recon_loss: 107364.9544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371353.8904; val_optim_loss: 371353.8904
